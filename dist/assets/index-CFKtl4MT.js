const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SimulationMarket-vVXknkil.js","assets/GameCard-ifn_jhmI.js","assets/GameButton-BiavmLtB.js","assets/Badge-BWekYQ3v.js","assets/SimulationVault-Bb6Wkq9B.js","assets/timer-DdpEg_Ld.js","assets/SimulationSkills-CfYtRbkt.js","assets/chevron-right-ClFHP4Mb.js","assets/SimulationProduction-Bte1H2eV.js","assets/SimulationHierarchy-DhKMGh5t.js","assets/PoliticalHub-CWsjA3-R.js","assets/SimulationProfile-Chk-jeGv.js","assets/SimulationWarRoom-Bad7oIJF.js","assets/SiegeEngine-BEwiUmMb.js"])))=>i.map(i=>d[i]);
var mA=Object.defineProperty;var pA=(t,e,n)=>e in t?mA(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var ze=(t,e,n)=>pA(t,typeof e!="symbol"?e+"":e,n);function gA(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const i in s)if(i!=="default"&&!(i in t)){const r=Object.getOwnPropertyDescriptor(s,i);r&&Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:()=>s[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();function G_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var V_={exports:{}},Ad={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bA=Symbol.for("react.transitional.element"),vA=Symbol.for("react.fragment");function F_(t,e,n){var s=null;if(n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),"key"in e){n={};for(var i in e)i!=="key"&&(n[i]=e[i])}else n=e;return e=n.ref,{$$typeof:bA,type:t,key:s,ref:e!==void 0?e:null,props:n}}Ad.Fragment=vA;Ad.jsx=F_;Ad.jsxs=F_;V_.exports=Ad;var l=V_.exports,z_={exports:{}},le={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mp=Symbol.for("react.transitional.element"),xA=Symbol.for("react.portal"),yA=Symbol.for("react.fragment"),_A=Symbol.for("react.strict_mode"),wA=Symbol.for("react.profiler"),EA=Symbol.for("react.consumer"),NA=Symbol.for("react.context"),kA=Symbol.for("react.forward_ref"),SA=Symbol.for("react.suspense"),TA=Symbol.for("react.memo"),$_=Symbol.for("react.lazy"),AA=Symbol.for("react.activity"),gb=Symbol.iterator;function RA(t){return t===null||typeof t!="object"?null:(t=gb&&t[gb]||t["@@iterator"],typeof t=="function"?t:null)}var K_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Y_=Object.assign,q_={};function Ga(t,e,n){this.props=t,this.context=e,this.refs=q_,this.updater=n||K_}Ga.prototype.isReactComponent={};Ga.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ga.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function W_(){}W_.prototype=Ga.prototype;function Dp(t,e,n){this.props=t,this.context=e,this.refs=q_,this.updater=n||K_}var Lp=Dp.prototype=new W_;Lp.constructor=Dp;Y_(Lp,Ga.prototype);Lp.isPureReactComponent=!0;var bb=Array.isArray;function Lh(){}var Ve={H:null,A:null,T:null,S:null},X_=Object.prototype.hasOwnProperty;function Pp(t,e,n){var s=n.ref;return{$$typeof:Mp,type:t,key:e,ref:s!==void 0?s:null,props:n}}function IA(t,e){return Pp(t.type,e,t.props)}function Bp(t){return typeof t=="object"&&t!==null&&t.$$typeof===Mp}function CA(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var vb=/\/+/g;function Ef(t,e){return typeof t=="object"&&t!==null&&t.key!=null?CA(""+t.key):e.toString(36)}function jA(t){switch(t.status){case"fulfilled":return t.value;case"rejected":throw t.reason;default:switch(typeof t.status=="string"?t.then(Lh,Lh):(t.status="pending",t.then(function(e){t.status==="pending"&&(t.status="fulfilled",t.value=e)},function(e){t.status==="pending"&&(t.status="rejected",t.reason=e)})),t.status){case"fulfilled":return t.value;case"rejected":throw t.reason}}throw t}function Lr(t,e,n,s,i){var r=typeof t;(r==="undefined"||r==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(r){case"bigint":case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Mp:case xA:a=!0;break;case $_:return a=t._init,Lr(a(t._payload),e,n,s,i)}}if(a)return i=i(t),a=s===""?"."+Ef(t,0):s,bb(i)?(n="",a!=null&&(n=a.replace(vb,"$&/")+"/"),Lr(i,e,n,"",function(u){return u})):i!=null&&(Bp(i)&&(i=IA(i,n+(i.key==null||t&&t.key===i.key?"":(""+i.key).replace(vb,"$&/")+"/")+a)),e.push(i)),1;a=0;var o=s===""?".":s+":";if(bb(t))for(var c=0;c<t.length;c++)s=t[c],r=o+Ef(s,c),a+=Lr(s,e,n,r,i);else if(c=RA(t),typeof c=="function")for(t=c.call(t),c=0;!(s=t.next()).done;)s=s.value,r=o+Ef(s,c++),a+=Lr(s,e,n,r,i);else if(r==="object"){if(typeof t.then=="function")return Lr(jA(t),e,n,s,i);throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.")}return a}function _c(t,e,n){if(t==null)return t;var s=[],i=0;return Lr(t,s,"","",function(r){return e.call(n,r,i++)}),s}function OA(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var xb=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},MA={map:_c,forEach:function(t,e,n){_c(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return _c(t,function(){e++}),e},toArray:function(t){return _c(t,function(e){return e})||[]},only:function(t){if(!Bp(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};le.Activity=AA;le.Children=MA;le.Component=Ga;le.Fragment=yA;le.Profiler=wA;le.PureComponent=Dp;le.StrictMode=_A;le.Suspense=SA;le.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Ve;le.__COMPILER_RUNTIME={__proto__:null,c:function(t){return Ve.H.useMemoCache(t)}};le.cache=function(t){return function(){return t.apply(null,arguments)}};le.cacheSignal=function(){return null};le.cloneElement=function(t,e,n){if(t==null)throw Error("The argument must be a React element, but you passed "+t+".");var s=Y_({},t.props),i=t.key;if(e!=null)for(r in e.key!==void 0&&(i=""+e.key),e)!X_.call(e,r)||r==="key"||r==="__self"||r==="__source"||r==="ref"&&e.ref===void 0||(s[r]=e[r]);var r=arguments.length-2;if(r===1)s.children=n;else if(1<r){for(var a=Array(r),o=0;o<r;o++)a[o]=arguments[o+2];s.children=a}return Pp(t.type,i,s)};le.createContext=function(t){return t={$$typeof:NA,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null},t.Provider=t,t.Consumer={$$typeof:EA,_context:t},t};le.createElement=function(t,e,n){var s,i={},r=null;if(e!=null)for(s in e.key!==void 0&&(r=""+e.key),e)X_.call(e,s)&&s!=="key"&&s!=="__self"&&s!=="__source"&&(i[s]=e[s]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var o=Array(a),c=0;c<a;c++)o[c]=arguments[c+2];i.children=o}if(t&&t.defaultProps)for(s in a=t.defaultProps,a)i[s]===void 0&&(i[s]=a[s]);return Pp(t,r,i)};le.createRef=function(){return{current:null}};le.forwardRef=function(t){return{$$typeof:kA,render:t}};le.isValidElement=Bp;le.lazy=function(t){return{$$typeof:$_,_payload:{_status:-1,_result:t},_init:OA}};le.memo=function(t,e){return{$$typeof:TA,type:t,compare:e===void 0?null:e}};le.startTransition=function(t){var e=Ve.T,n={};Ve.T=n;try{var s=t(),i=Ve.S;i!==null&&i(n,s),typeof s=="object"&&s!==null&&typeof s.then=="function"&&s.then(Lh,xb)}catch(r){xb(r)}finally{e!==null&&n.types!==null&&(e.types=n.types),Ve.T=e}};le.unstable_useCacheRefresh=function(){return Ve.H.useCacheRefresh()};le.use=function(t){return Ve.H.use(t)};le.useActionState=function(t,e,n){return Ve.H.useActionState(t,e,n)};le.useCallback=function(t,e){return Ve.H.useCallback(t,e)};le.useContext=function(t){return Ve.H.useContext(t)};le.useDebugValue=function(){};le.useDeferredValue=function(t,e){return Ve.H.useDeferredValue(t,e)};le.useEffect=function(t,e){return Ve.H.useEffect(t,e)};le.useEffectEvent=function(t){return Ve.H.useEffectEvent(t)};le.useId=function(){return Ve.H.useId()};le.useImperativeHandle=function(t,e,n){return Ve.H.useImperativeHandle(t,e,n)};le.useInsertionEffect=function(t,e){return Ve.H.useInsertionEffect(t,e)};le.useLayoutEffect=function(t,e){return Ve.H.useLayoutEffect(t,e)};le.useMemo=function(t,e){return Ve.H.useMemo(t,e)};le.useOptimistic=function(t,e){return Ve.H.useOptimistic(t,e)};le.useReducer=function(t,e,n){return Ve.H.useReducer(t,e,n)};le.useRef=function(t){return Ve.H.useRef(t)};le.useState=function(t){return Ve.H.useState(t)};le.useSyncExternalStore=function(t,e,n){return Ve.H.useSyncExternalStore(t,e,n)};le.useTransition=function(){return Ve.H.useTransition()};le.version="19.2.3";z_.exports=le;var _=z_.exports;const we=G_(_),DA=gA({__proto__:null,default:we},[_]);var Q_={exports:{}},Rd={},J_={exports:{}},Z_={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(U,O){var j=U.length;U.push(O);e:for(;0<j;){var I=j-1>>>1,H=U[I];if(0<i(H,O))U[I]=O,U[j]=H,j=I;else break e}}function n(U){return U.length===0?null:U[0]}function s(U){if(U.length===0)return null;var O=U[0],j=U.pop();if(j!==O){U[0]=j;e:for(var I=0,H=U.length,X=H>>>1;I<X;){var oe=2*(I+1)-1,Ie=U[oe],V=oe+1,me=U[V];if(0>i(Ie,j))V<H&&0>i(me,Ie)?(U[I]=me,U[V]=j,I=V):(U[I]=Ie,U[oe]=j,I=oe);else if(V<H&&0>i(me,j))U[I]=me,U[V]=j,I=V;else break e}}return O}function i(U,O){var j=U.sortIndex-O.sortIndex;return j!==0?j:U.id-O.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;t.unstable_now=function(){return r.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var c=[],u=[],d=1,f=null,h=3,m=!1,g=!1,v=!1,x=!1,p=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;function E(U){for(var O=n(u);O!==null;){if(O.callback===null)s(u);else if(O.startTime<=U)s(u),O.sortIndex=O.expirationTime,e(c,O);else break;O=n(u)}}function N(U){if(v=!1,E(U),!g)if(n(c)!==null)g=!0,A||(A=!0,B());else{var O=n(u);O!==null&&K(N,O.startTime-U)}}var A=!1,w=-1,T=5,k=-1;function R(){return x?!0:!(t.unstable_now()-k<T)}function C(){if(x=!1,A){var U=t.unstable_now();k=U;var O=!0;try{e:{g=!1,v&&(v=!1,b(w),w=-1),m=!0;var j=h;try{t:{for(E(U),f=n(c);f!==null&&!(f.expirationTime>U&&R());){var I=f.callback;if(typeof I=="function"){f.callback=null,h=f.priorityLevel;var H=I(f.expirationTime<=U);if(U=t.unstable_now(),typeof H=="function"){f.callback=H,E(U),O=!0;break t}f===n(c)&&s(c),E(U)}else s(c);f=n(c)}if(f!==null)O=!0;else{var X=n(u);X!==null&&K(N,X.startTime-U),O=!1}}break e}finally{f=null,h=j,m=!1}O=void 0}}finally{O?B():A=!1}}}var B;if(typeof y=="function")B=function(){y(C)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,$=z.port2;z.port1.onmessage=C,B=function(){$.postMessage(null)}}else B=function(){p(C,0)};function K(U,O){w=p(function(){U(t.unstable_now())},O)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(U){U.callback=null},t.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<U?Math.floor(1e3/U):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_next=function(U){switch(h){case 1:case 2:case 3:var O=3;break;default:O=h}var j=h;h=O;try{return U()}finally{h=j}},t.unstable_requestPaint=function(){x=!0},t.unstable_runWithPriority=function(U,O){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var j=h;h=U;try{return O()}finally{h=j}},t.unstable_scheduleCallback=function(U,O,j){var I=t.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?I+j:I):j=I,U){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=j+H,U={id:d++,callback:O,priorityLevel:U,startTime:j,expirationTime:H,sortIndex:-1},j>I?(U.sortIndex=j,e(u,U),n(c)===null&&U===n(u)&&(v?(b(w),w=-1):v=!0,K(N,j-I))):(U.sortIndex=H,e(c,U),g||m||(g=!0,A||(A=!0,B()))),U},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(U){var O=h;return function(){var j=h;h=O;try{return U.apply(this,arguments)}finally{h=j}}}})(Z_);J_.exports=Z_;var LA=J_.exports,e1={exports:{}},Ft={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PA=_;function t1(t){var e="https://react.dev/errors/"+t;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Vs(){}var Lt={d:{f:Vs,r:function(){throw Error(t1(522))},D:Vs,C:Vs,L:Vs,m:Vs,X:Vs,S:Vs,M:Vs},p:0,findDOMNode:null},BA=Symbol.for("react.portal");function UA(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:BA,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}var Co=PA.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function Id(t,e){if(t==="font")return"";if(typeof e=="string")return e==="use-credentials"?e:""}Ft.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Lt;Ft.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)throw Error(t1(299));return UA(t,e,null,n)};Ft.flushSync=function(t){var e=Co.T,n=Lt.p;try{if(Co.T=null,Lt.p=2,t)return t()}finally{Co.T=e,Lt.p=n,Lt.d.f()}};Ft.preconnect=function(t,e){typeof t=="string"&&(e?(e=e.crossOrigin,e=typeof e=="string"?e==="use-credentials"?e:"":void 0):e=null,Lt.d.C(t,e))};Ft.prefetchDNS=function(t){typeof t=="string"&&Lt.d.D(t)};Ft.preinit=function(t,e){if(typeof t=="string"&&e&&typeof e.as=="string"){var n=e.as,s=Id(n,e.crossOrigin),i=typeof e.integrity=="string"?e.integrity:void 0,r=typeof e.fetchPriority=="string"?e.fetchPriority:void 0;n==="style"?Lt.d.S(t,typeof e.precedence=="string"?e.precedence:void 0,{crossOrigin:s,integrity:i,fetchPriority:r}):n==="script"&&Lt.d.X(t,{crossOrigin:s,integrity:i,fetchPriority:r,nonce:typeof e.nonce=="string"?e.nonce:void 0})}};Ft.preinitModule=function(t,e){if(typeof t=="string")if(typeof e=="object"&&e!==null){if(e.as==null||e.as==="script"){var n=Id(e.as,e.crossOrigin);Lt.d.M(t,{crossOrigin:n,integrity:typeof e.integrity=="string"?e.integrity:void 0,nonce:typeof e.nonce=="string"?e.nonce:void 0})}}else e==null&&Lt.d.M(t)};Ft.preload=function(t,e){if(typeof t=="string"&&typeof e=="object"&&e!==null&&typeof e.as=="string"){var n=e.as,s=Id(n,e.crossOrigin);Lt.d.L(t,n,{crossOrigin:s,integrity:typeof e.integrity=="string"?e.integrity:void 0,nonce:typeof e.nonce=="string"?e.nonce:void 0,type:typeof e.type=="string"?e.type:void 0,fetchPriority:typeof e.fetchPriority=="string"?e.fetchPriority:void 0,referrerPolicy:typeof e.referrerPolicy=="string"?e.referrerPolicy:void 0,imageSrcSet:typeof e.imageSrcSet=="string"?e.imageSrcSet:void 0,imageSizes:typeof e.imageSizes=="string"?e.imageSizes:void 0,media:typeof e.media=="string"?e.media:void 0})}};Ft.preloadModule=function(t,e){if(typeof t=="string")if(e){var n=Id(e.as,e.crossOrigin);Lt.d.m(t,{as:typeof e.as=="string"&&e.as!=="script"?e.as:void 0,crossOrigin:n,integrity:typeof e.integrity=="string"?e.integrity:void 0})}else Lt.d.m(t)};Ft.requestFormReset=function(t){Lt.d.r(t)};Ft.unstable_batchedUpdates=function(t,e){return t(e)};Ft.useFormState=function(t,e,n){return Co.H.useFormState(t,e,n)};Ft.useFormStatus=function(){return Co.H.useHostTransitionStatus()};Ft.version="19.2.3";function n1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n1)}catch(t){console.error(t)}}n1(),e1.exports=Ft;var HA=e1.exports;/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pt=LA,s1=_,GA=HA;function P(t){var e="https://react.dev/errors/"+t;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Bl(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function r1(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function a1(t){if(t.tag===31){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function yb(t){if(Bl(t)!==t)throw Error(P(188))}function VA(t){var e=t.alternate;if(!e){if(e=Bl(t),e===null)throw Error(P(188));return e!==t?null:t}for(var n=t,s=e;;){var i=n.return;if(i===null)break;var r=i.alternate;if(r===null){if(s=i.return,s!==null){n=s;continue}break}if(i.child===r.child){for(r=i.child;r;){if(r===n)return yb(i),t;if(r===s)return yb(i),e;r=r.sibling}throw Error(P(188))}if(n.return!==s.return)n=i,s=r;else{for(var a=!1,o=i.child;o;){if(o===n){a=!0,n=i,s=r;break}if(o===s){a=!0,s=i,n=r;break}o=o.sibling}if(!a){for(o=r.child;o;){if(o===n){a=!0,n=r,s=i;break}if(o===s){a=!0,s=r,n=i;break}o=o.sibling}if(!a)throw Error(P(189))}}if(n.alternate!==s)throw Error(P(190))}if(n.tag!==3)throw Error(P(188));return n.stateNode.current===n?t:e}function o1(t){var e=t.tag;if(e===5||e===26||e===27||e===6)return t;for(t=t.child;t!==null;){if(e=o1(t),e!==null)return e;t=t.sibling}return null}var Fe=Object.assign,FA=Symbol.for("react.element"),wc=Symbol.for("react.transitional.element"),wo=Symbol.for("react.portal"),Ur=Symbol.for("react.fragment"),l1=Symbol.for("react.strict_mode"),Ph=Symbol.for("react.profiler"),c1=Symbol.for("react.consumer"),ps=Symbol.for("react.context"),Up=Symbol.for("react.forward_ref"),Bh=Symbol.for("react.suspense"),Uh=Symbol.for("react.suspense_list"),Hp=Symbol.for("react.memo"),$s=Symbol.for("react.lazy"),Hh=Symbol.for("react.activity"),zA=Symbol.for("react.memo_cache_sentinel"),_b=Symbol.iterator;function co(t){return t===null||typeof t!="object"?null:(t=_b&&t[_b]||t["@@iterator"],typeof t=="function"?t:null)}var $A=Symbol.for("react.client.reference");function Gh(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===$A?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ur:return"Fragment";case Ph:return"Profiler";case l1:return"StrictMode";case Bh:return"Suspense";case Uh:return"SuspenseList";case Hh:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case wo:return"Portal";case ps:return t.displayName||"Context";case c1:return(t._context.displayName||"Context")+".Consumer";case Up:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Hp:return e=t.displayName||null,e!==null?e:Gh(t.type)||"Memo";case $s:e=t._payload,t=t._init;try{return Gh(t(e))}catch{}}return null}var Eo=Array.isArray,ie=s1.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ne=GA.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,er={pending:!1,data:null,method:null,action:null},Vh=[],Hr=-1;function is(t){return{current:t}}function wt(t){0>Hr||(t.current=Vh[Hr],Vh[Hr]=null,Hr--)}function Be(t,e){Hr++,Vh[Hr]=t.current,t.current=e}var Jn=is(null),nl=is(null),ci=is(null),vu=is(null);function xu(t,e){switch(Be(ci,e),Be(nl,t),Be(Jn,null),e.nodeType){case 9:case 11:t=(t=e.documentElement)&&(t=t.namespaceURI)?Tv(t):0;break;default:if(t=e.tagName,e=e.namespaceURI)e=Tv(e),t=RE(e,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}wt(Jn),Be(Jn,t)}function xa(){wt(Jn),wt(nl),wt(ci)}function Fh(t){t.memoizedState!==null&&Be(vu,t);var e=Jn.current,n=RE(e,t.type);e!==n&&(Be(nl,t),Be(Jn,n))}function yu(t){nl.current===t&&(wt(Jn),wt(nl)),vu.current===t&&(wt(vu),hl._currentValue=er)}var Nf,wb;function Fi(t){if(Nf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Nf=e&&e[1]||"",wb=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Nf+t+wb}var kf=!1;function Sf(t,e){if(!t||kf)return"";kf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var s={DetermineComponentFrameRoot:function(){try{if(e){var f=function(){throw Error()};if(Object.defineProperty(f.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(f,[])}catch(m){var h=m}Reflect.construct(t,[],f)}else{try{f.call()}catch(m){h=m}t.call(f.prototype)}}else{try{throw Error()}catch(m){h=m}(f=t())&&typeof f.catch=="function"&&f.catch(function(){})}}catch(m){if(m&&h&&typeof m.stack=="string")return[m.stack,h.stack]}return[null,null]}};s.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var i=Object.getOwnPropertyDescriptor(s.DetermineComponentFrameRoot,"name");i&&i.configurable&&Object.defineProperty(s.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var r=s.DetermineComponentFrameRoot(),a=r[0],o=r[1];if(a&&o){var c=a.split(`
`),u=o.split(`
`);for(i=s=0;s<c.length&&!c[s].includes("DetermineComponentFrameRoot");)s++;for(;i<u.length&&!u[i].includes("DetermineComponentFrameRoot");)i++;if(s===c.length||i===u.length)for(s=c.length-1,i=u.length-1;1<=s&&0<=i&&c[s]!==u[i];)i--;for(;1<=s&&0<=i;s--,i--)if(c[s]!==u[i]){if(s!==1||i!==1)do if(s--,i--,0>i||c[s]!==u[i]){var d=`
`+c[s].replace(" at new "," at ");return t.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",t.displayName)),d}while(1<=s&&0<=i);break}}}finally{kf=!1,Error.prepareStackTrace=n}return(n=t?t.displayName||t.name:"")?Fi(n):""}function KA(t,e){switch(t.tag){case 26:case 27:case 5:return Fi(t.type);case 16:return Fi("Lazy");case 13:return t.child!==e&&e!==null?Fi("Suspense Fallback"):Fi("Suspense");case 19:return Fi("SuspenseList");case 0:case 15:return Sf(t.type,!1);case 11:return Sf(t.type.render,!1);case 1:return Sf(t.type,!0);case 31:return Fi("Activity");default:return""}}function Eb(t){try{var e="",n=null;do e+=KA(t,n),n=t,t=t.return;while(t);return e}catch(s){return`
Error generating stack: `+s.message+`
`+s.stack}}var zh=Object.prototype.hasOwnProperty,Gp=pt.unstable_scheduleCallback,Tf=pt.unstable_cancelCallback,YA=pt.unstable_shouldYield,qA=pt.unstable_requestPaint,on=pt.unstable_now,WA=pt.unstable_getCurrentPriorityLevel,u1=pt.unstable_ImmediatePriority,d1=pt.unstable_UserBlockingPriority,_u=pt.unstable_NormalPriority,XA=pt.unstable_LowPriority,f1=pt.unstable_IdlePriority,QA=pt.log,JA=pt.unstable_setDisableYieldValue,Ul=null,ln=null;function ti(t){if(typeof QA=="function"&&JA(t),ln&&typeof ln.setStrictMode=="function")try{ln.setStrictMode(Ul,t)}catch{}}var cn=Math.clz32?Math.clz32:tR,ZA=Math.log,eR=Math.LN2;function tR(t){return t>>>=0,t===0?32:31-(ZA(t)/eR|0)|0}var Ec=256,Nc=262144,kc=4194304;function zi(t){var e=t&42;if(e!==0)return e;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function Cd(t,e,n){var s=t.pendingLanes;if(s===0)return 0;var i=0,r=t.suspendedLanes,a=t.pingedLanes;t=t.warmLanes;var o=s&134217727;return o!==0?(s=o&~r,s!==0?i=zi(s):(a&=o,a!==0?i=zi(a):n||(n=o&~t,n!==0&&(i=zi(n))))):(o=s&~r,o!==0?i=zi(o):a!==0?i=zi(a):n||(n=s&~t,n!==0&&(i=zi(n)))),i===0?0:e!==0&&e!==i&&!(e&r)&&(r=i&-i,n=e&-e,r>=n||r===32&&(n&4194048)!==0)?e:i}function Hl(t,e){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&e)===0}function nR(t,e){switch(t){case 1:case 2:case 4:case 8:case 64:return e+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function h1(){var t=kc;return kc<<=1,!(kc&62914560)&&(kc=4194304),t}function Af(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Gl(t,e){t.pendingLanes|=e,e!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function sR(t,e,n,s,i,r){var a=t.pendingLanes;t.pendingLanes=n,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=n,t.entangledLanes&=n,t.errorRecoveryDisabledLanes&=n,t.shellSuspendCounter=0;var o=t.entanglements,c=t.expirationTimes,u=t.hiddenUpdates;for(n=a&~n;0<n;){var d=31-cn(n),f=1<<d;o[d]=0,c[d]=-1;var h=u[d];if(h!==null)for(u[d]=null,d=0;d<h.length;d++){var m=h[d];m!==null&&(m.lane&=-536870913)}n&=~f}s!==0&&m1(t,s,0),r!==0&&i===0&&t.tag!==0&&(t.suspendedLanes|=r&~(a&~e))}function m1(t,e,n){t.pendingLanes|=e,t.suspendedLanes&=~e;var s=31-cn(e);t.entangledLanes|=e,t.entanglements[s]=t.entanglements[s]|1073741824|n&261930}function p1(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-cn(n),i=1<<s;i&e|t[s]&e&&(t[s]|=e),n&=~i}}function g1(t,e){var n=e&-e;return n=n&42?1:Vp(n),n&(t.suspendedLanes|e)?0:n}function Vp(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function Fp(t){return t&=-t,2<t?8<t?t&134217727?32:268435456:8:2}function b1(){var t=Ne.p;return t!==0?t:(t=window.event,t===void 0?32:HE(t.type))}function Nb(t,e){var n=Ne.p;try{return Ne.p=t,e()}finally{Ne.p=n}}var Di=Math.random().toString(36).slice(2),Tt="__reactFiber$"+Di,Zt="__reactProps$"+Di,Va="__reactContainer$"+Di,$h="__reactEvents$"+Di,iR="__reactListeners$"+Di,rR="__reactHandles$"+Di,kb="__reactResources$"+Di,Vl="__reactMarker$"+Di;function zp(t){delete t[Tt],delete t[Zt],delete t[$h],delete t[iR],delete t[rR]}function Gr(t){var e=t[Tt];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Va]||n[Tt]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=jv(t);t!==null;){if(n=t[Tt])return n;t=jv(t)}return e}t=n,n=t.parentNode}return null}function Fa(t){if(t=t[Tt]||t[Va]){var e=t.tag;if(e===5||e===6||e===13||e===31||e===26||e===27||e===3)return t}return null}function No(t){var e=t.tag;if(e===5||e===26||e===27||e===6)return t.stateNode;throw Error(P(33))}function ia(t){var e=t[kb];return e||(e=t[kb]={hoistableStyles:new Map,hoistableScripts:new Map}),e}function yt(t){t[Vl]=!0}var v1=new Set,x1={};function wr(t,e){ya(t,e),ya(t+"Capture",e)}function ya(t,e){for(x1[t]=e,t=0;t<e.length;t++)v1.add(e[t])}var aR=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Sb={},Tb={};function oR(t){return zh.call(Tb,t)?!0:zh.call(Sb,t)?!1:aR.test(t)?Tb[t]=!0:(Sb[t]=!0,!1)}function qc(t,e,n){if(oR(e))if(n===null)t.removeAttribute(e);else{switch(typeof n){case"undefined":case"function":case"symbol":t.removeAttribute(e);return;case"boolean":var s=e.toLowerCase().slice(0,5);if(s!=="data-"&&s!=="aria-"){t.removeAttribute(e);return}}t.setAttribute(e,""+n)}}function Sc(t,e,n){if(n===null)t.removeAttribute(e);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(e);return}t.setAttribute(e,""+n)}}function os(t,e,n,s){if(s===null)t.removeAttribute(n);else{switch(typeof s){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(n);return}t.setAttributeNS(e,n,""+s)}}function vn(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function y1(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function lR(t,e,n){var s=Object.getOwnPropertyDescriptor(t.constructor.prototype,e);if(!t.hasOwnProperty(e)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var i=s.get,r=s.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,r.call(this,a)}}),Object.defineProperty(t,e,{enumerable:s.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Kh(t){if(!t._valueTracker){var e=y1(t)?"checked":"value";t._valueTracker=lR(t,e,""+t[e])}}function _1(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=y1(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function wu(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var cR=/[\n"\\]/g;function _n(t){return t.replace(cR,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function Yh(t,e,n,s,i,r,a,o){t.name="",a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"?t.type=a:t.removeAttribute("type"),e!=null?a==="number"?(e===0&&t.value===""||t.value!=e)&&(t.value=""+vn(e)):t.value!==""+vn(e)&&(t.value=""+vn(e)):a!=="submit"&&a!=="reset"||t.removeAttribute("value"),e!=null?qh(t,a,vn(e)):n!=null?qh(t,a,vn(n)):s!=null&&t.removeAttribute("value"),i==null&&r!=null&&(t.defaultChecked=!!r),i!=null&&(t.checked=i&&typeof i!="function"&&typeof i!="symbol"),o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"?t.name=""+vn(o):t.removeAttribute("name")}function w1(t,e,n,s,i,r,a,o){if(r!=null&&typeof r!="function"&&typeof r!="symbol"&&typeof r!="boolean"&&(t.type=r),e!=null||n!=null){if(!(r!=="submit"&&r!=="reset"||e!=null)){Kh(t);return}n=n!=null?""+vn(n):"",e=e!=null?""+vn(e):n,o||e===t.value||(t.value=e),t.defaultValue=e}s=s??i,s=typeof s!="function"&&typeof s!="symbol"&&!!s,t.checked=o?t.checked:!!s,t.defaultChecked=!!s,a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"&&(t.name=a),Kh(t)}function qh(t,e,n){e==="number"&&wu(t.ownerDocument)===t||t.defaultValue===""+n||(t.defaultValue=""+n)}function ra(t,e,n,s){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&s&&(t[n].defaultSelected=!0)}else{for(n=""+vn(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,s&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function E1(t,e,n){if(e!=null&&(e=""+vn(e),e!==t.value&&(t.value=e),n==null)){t.defaultValue!==e&&(t.defaultValue=e);return}t.defaultValue=n!=null?""+vn(n):""}function N1(t,e,n,s){if(e==null){if(s!=null){if(n!=null)throw Error(P(92));if(Eo(s)){if(1<s.length)throw Error(P(93));s=s[0]}n=s}n==null&&(n=""),e=n}n=vn(e),t.defaultValue=n,s=t.textContent,s===n&&s!==""&&s!==null&&(t.value=s),Kh(t)}function _a(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var uR=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ab(t,e,n){var s=e.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?s?t.setProperty(e,""):e==="float"?t.cssFloat="":t[e]="":s?t.setProperty(e,n):typeof n!="number"||n===0||uR.has(e)?e==="float"?t.cssFloat=n:t[e]=(""+n).trim():t[e]=n+"px"}function k1(t,e,n){if(e!=null&&typeof e!="object")throw Error(P(62));if(t=t.style,n!=null){for(var s in n)!n.hasOwnProperty(s)||e!=null&&e.hasOwnProperty(s)||(s.indexOf("--")===0?t.setProperty(s,""):s==="float"?t.cssFloat="":t[s]="");for(var i in e)s=e[i],e.hasOwnProperty(i)&&n[i]!==s&&Ab(t,i,s)}else for(var r in e)e.hasOwnProperty(r)&&Ab(t,r,e[r])}function $p(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dR=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),fR=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Wc(t){return fR.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function gs(){}var Wh=null;function Kp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Vr=null,aa=null;function Rb(t){var e=Fa(t);if(e&&(t=e.stateNode)){var n=t[Zt]||null;e:switch(t=e.stateNode,e.type){case"input":if(Yh(t,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+_n(""+e)+'"][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var i=s[Zt]||null;if(!i)throw Error(P(90));Yh(s,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(e=0;e<n.length;e++)s=n[e],s.form===t.form&&_1(s)}break e;case"textarea":E1(t,n.value,n.defaultValue);break e;case"select":e=n.value,e!=null&&ra(t,!!n.multiple,e,!1)}}}var Rf=!1;function S1(t,e,n){if(Rf)return t(e,n);Rf=!0;try{var s=t(e);return s}finally{if(Rf=!1,(Vr!==null||aa!==null)&&(Fd(),Vr&&(e=Vr,t=aa,aa=Vr=null,Rb(e),t)))for(e=0;e<t.length;e++)Rb(t[e])}}function sl(t,e){var n=t.stateNode;if(n===null)return null;var s=n[Zt]||null;if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(P(231,e,typeof n));return n}var Ts=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Xh=!1;if(Ts)try{var uo={};Object.defineProperty(uo,"passive",{get:function(){Xh=!0}}),window.addEventListener("test",uo,uo),window.removeEventListener("test",uo,uo)}catch{Xh=!1}var ni=null,Yp=null,Xc=null;function T1(){if(Xc)return Xc;var t,e=Yp,n=e.length,s,i="value"in ni?ni.value:ni.textContent,r=i.length;for(t=0;t<n&&e[t]===i[t];t++);var a=n-t;for(s=1;s<=a&&e[n-s]===i[r-s];s++);return Xc=i.slice(t,1<s?1-s:void 0)}function Qc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Tc(){return!0}function Ib(){return!1}function en(t){function e(n,s,i,r,a){this._reactName=n,this._targetInst=i,this.type=s,this.nativeEvent=r,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(n=t[o],this[o]=n?n(r):r[o]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?Tc:Ib,this.isPropagationStopped=Ib,this}return Fe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Tc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Tc)},persist:function(){},isPersistent:Tc}),e}var Er={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},jd=en(Er),Fl=Fe({},Er,{view:0,detail:0}),hR=en(Fl),If,Cf,fo,Od=Fe({},Fl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qp,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==fo&&(fo&&t.type==="mousemove"?(If=t.screenX-fo.screenX,Cf=t.screenY-fo.screenY):Cf=If=0,fo=t),If)},movementY:function(t){return"movementY"in t?t.movementY:Cf}}),Cb=en(Od),mR=Fe({},Od,{dataTransfer:0}),pR=en(mR),gR=Fe({},Fl,{relatedTarget:0}),jf=en(gR),bR=Fe({},Er,{animationName:0,elapsedTime:0,pseudoElement:0}),vR=en(bR),xR=Fe({},Er,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),yR=en(xR),_R=Fe({},Er,{data:0}),jb=en(_R),wR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ER={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},NR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kR(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=NR[t])?!!e[t]:!1}function qp(){return kR}var SR=Fe({},Fl,{key:function(t){if(t.key){var e=wR[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Qc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?ER[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qp,charCode:function(t){return t.type==="keypress"?Qc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Qc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),TR=en(SR),AR=Fe({},Od,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ob=en(AR),RR=Fe({},Fl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qp}),IR=en(RR),CR=Fe({},Er,{propertyName:0,elapsedTime:0,pseudoElement:0}),jR=en(CR),OR=Fe({},Od,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),MR=en(OR),DR=Fe({},Er,{newState:0,oldState:0}),LR=en(DR),PR=[9,13,27,32],Wp=Ts&&"CompositionEvent"in window,jo=null;Ts&&"documentMode"in document&&(jo=document.documentMode);var BR=Ts&&"TextEvent"in window&&!jo,A1=Ts&&(!Wp||jo&&8<jo&&11>=jo),Mb=" ",Db=!1;function R1(t,e){switch(t){case"keyup":return PR.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function I1(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Fr=!1;function UR(t,e){switch(t){case"compositionend":return I1(e);case"keypress":return e.which!==32?null:(Db=!0,Mb);case"textInput":return t=e.data,t===Mb&&Db?null:t;default:return null}}function HR(t,e){if(Fr)return t==="compositionend"||!Wp&&R1(t,e)?(t=T1(),Xc=Yp=ni=null,Fr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return A1&&e.locale!=="ko"?null:e.data;default:return null}}var GR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Lb(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!GR[t.type]:e==="textarea"}function C1(t,e,n,s){Vr?aa?aa.push(s):aa=[s]:Vr=s,e=Hu(e,"onChange"),0<e.length&&(n=new jd("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var Oo=null,il=null;function VR(t){SE(t,0)}function Md(t){var e=No(t);if(_1(e))return t}function Pb(t,e){if(t==="change")return e}var j1=!1;if(Ts){var Of;if(Ts){var Mf="oninput"in document;if(!Mf){var Bb=document.createElement("div");Bb.setAttribute("oninput","return;"),Mf=typeof Bb.oninput=="function"}Of=Mf}else Of=!1;j1=Of&&(!document.documentMode||9<document.documentMode)}function Ub(){Oo&&(Oo.detachEvent("onpropertychange",O1),il=Oo=null)}function O1(t){if(t.propertyName==="value"&&Md(il)){var e=[];C1(e,il,t,Kp(t)),S1(VR,e)}}function FR(t,e,n){t==="focusin"?(Ub(),Oo=e,il=n,Oo.attachEvent("onpropertychange",O1)):t==="focusout"&&Ub()}function zR(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Md(il)}function $R(t,e){if(t==="click")return Md(e)}function KR(t,e){if(t==="input"||t==="change")return Md(e)}function YR(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var dn=typeof Object.is=="function"?Object.is:YR;function rl(t,e){if(dn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var i=n[s];if(!zh.call(e,i)||!dn(t[i],e[i]))return!1}return!0}function Hb(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Gb(t,e){var n=Hb(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Hb(n)}}function M1(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?M1(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function D1(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var e=wu(t.document);e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=wu(t.document)}return e}function Xp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}var qR=Ts&&"documentMode"in document&&11>=document.documentMode,zr=null,Qh=null,Mo=null,Jh=!1;function Vb(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Jh||zr==null||zr!==wu(s)||(s=zr,"selectionStart"in s&&Xp(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Mo&&rl(Mo,s)||(Mo=s,s=Hu(Qh,"onSelect"),0<s.length&&(e=new jd("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=zr)))}function Gi(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var $r={animationend:Gi("Animation","AnimationEnd"),animationiteration:Gi("Animation","AnimationIteration"),animationstart:Gi("Animation","AnimationStart"),transitionrun:Gi("Transition","TransitionRun"),transitionstart:Gi("Transition","TransitionStart"),transitioncancel:Gi("Transition","TransitionCancel"),transitionend:Gi("Transition","TransitionEnd")},Df={},L1={};Ts&&(L1=document.createElement("div").style,"AnimationEvent"in window||(delete $r.animationend.animation,delete $r.animationiteration.animation,delete $r.animationstart.animation),"TransitionEvent"in window||delete $r.transitionend.transition);function Nr(t){if(Df[t])return Df[t];if(!$r[t])return t;var e=$r[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in L1)return Df[t]=e[n];return t}var P1=Nr("animationend"),B1=Nr("animationiteration"),U1=Nr("animationstart"),WR=Nr("transitionrun"),XR=Nr("transitionstart"),QR=Nr("transitioncancel"),H1=Nr("transitionend"),G1=new Map,Zh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Zh.push("scrollEnd");function zn(t,e){G1.set(t,e),wr(e,[t])}var Eu=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},bn=[],Kr=0,Qp=0;function Dd(){for(var t=Kr,e=Qp=Kr=0;e<t;){var n=bn[e];bn[e++]=null;var s=bn[e];bn[e++]=null;var i=bn[e];bn[e++]=null;var r=bn[e];if(bn[e++]=null,s!==null&&i!==null){var a=s.pending;a===null?i.next=i:(i.next=a.next,a.next=i),s.pending=i}r!==0&&V1(n,i,r)}}function Ld(t,e,n,s){bn[Kr++]=t,bn[Kr++]=e,bn[Kr++]=n,bn[Kr++]=s,Qp|=s,t.lanes|=s,t=t.alternate,t!==null&&(t.lanes|=s)}function Jp(t,e,n,s){return Ld(t,e,n,s),Nu(t)}function kr(t,e){return Ld(t,null,null,e),Nu(t)}function V1(t,e,n){t.lanes|=n;var s=t.alternate;s!==null&&(s.lanes|=n);for(var i=!1,r=t.return;r!==null;)r.childLanes|=n,s=r.alternate,s!==null&&(s.childLanes|=n),r.tag===22&&(t=r.stateNode,t===null||t._visibility&1||(i=!0)),t=r,r=r.return;return t.tag===3?(r=t.stateNode,i&&e!==null&&(i=31-cn(n),t=r.hiddenUpdates,s=t[i],s===null?t[i]=[e]:s.push(e),e.lane=n|536870912),r):null}function Nu(t){if(50<Fo)throw Fo=0,ym=null,Error(P(185));for(var e=t.return;e!==null;)t=e,e=t.return;return t.tag===3?t.stateNode:null}var Yr={};function JR(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function sn(t,e,n,s){return new JR(t,e,n,s)}function Zp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function ws(t,e){var n=t.alternate;return n===null?(n=sn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&65011712,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n.refCleanup=t.refCleanup,n}function F1(t,e){t.flags&=65011714;var n=t.alternate;return n===null?(t.childLanes=0,t.lanes=e,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,t.type=n.type,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),t}function Jc(t,e,n,s,i,r){var a=0;if(s=t,typeof t=="function")Zp(t)&&(a=1);else if(typeof t=="string")a=sC(t,n,Jn.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case Hh:return t=sn(31,n,e,i),t.elementType=Hh,t.lanes=r,t;case Ur:return tr(n.children,i,r,e);case l1:a=8,i|=24;break;case Ph:return t=sn(12,n,e,i|2),t.elementType=Ph,t.lanes=r,t;case Bh:return t=sn(13,n,e,i),t.elementType=Bh,t.lanes=r,t;case Uh:return t=sn(19,n,e,i),t.elementType=Uh,t.lanes=r,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case ps:a=10;break e;case c1:a=9;break e;case Up:a=11;break e;case Hp:a=14;break e;case $s:a=16,s=null;break e}a=29,n=Error(P(130,t===null?"null":typeof t,"")),s=null}return e=sn(a,n,e,i),e.elementType=t,e.type=s,e.lanes=r,e}function tr(t,e,n,s){return t=sn(7,t,s,e),t.lanes=n,t}function Lf(t,e,n){return t=sn(6,t,null,e),t.lanes=n,t}function z1(t){var e=sn(18,null,null,0);return e.stateNode=t,e}function Pf(t,e,n){return e=sn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}var Fb=new WeakMap;function wn(t,e){if(typeof t=="object"&&t!==null){var n=Fb.get(t);return n!==void 0?n:(e={value:t,source:e,stack:Eb(e)},Fb.set(t,e),e)}return{value:t,source:e,stack:Eb(e)}}var qr=[],Wr=0,ku=null,al=0,xn=[],yn=0,Ni=null,Wn=1,Xn="";function hs(t,e){qr[Wr++]=al,qr[Wr++]=ku,ku=t,al=e}function $1(t,e,n){xn[yn++]=Wn,xn[yn++]=Xn,xn[yn++]=Ni,Ni=t;var s=Wn;t=Xn;var i=32-cn(s)-1;s&=~(1<<i),n+=1;var r=32-cn(e)+i;if(30<r){var a=i-i%5;r=(s&(1<<a)-1).toString(32),s>>=a,i-=a,Wn=1<<32-cn(e)+i|n<<i|s,Xn=r+t}else Wn=1<<r|n<<i|s,Xn=t}function eg(t){t.return!==null&&(hs(t,1),$1(t,1,0))}function tg(t){for(;t===ku;)ku=qr[--Wr],qr[Wr]=null,al=qr[--Wr],qr[Wr]=null;for(;t===Ni;)Ni=xn[--yn],xn[yn]=null,Xn=xn[--yn],xn[yn]=null,Wn=xn[--yn],xn[yn]=null}function K1(t,e){xn[yn++]=Wn,xn[yn++]=Xn,xn[yn++]=Ni,Wn=e.id,Xn=e.overflow,Ni=t}var At=null,He=null,ve=!1,ui=null,En=!1,em=Error(P(519));function ki(t){var e=Error(P(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ol(wn(e,t)),em}function zb(t){var e=t.stateNode,n=t.type,s=t.memoizedProps;switch(e[Tt]=t,e[Zt]=s,n){case"dialog":pe("cancel",e),pe("close",e);break;case"iframe":case"object":case"embed":pe("load",e);break;case"video":case"audio":for(n=0;n<dl.length;n++)pe(dl[n],e);break;case"source":pe("error",e);break;case"img":case"image":case"link":pe("error",e),pe("load",e);break;case"details":pe("toggle",e);break;case"input":pe("invalid",e),w1(e,s.value,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name,!0);break;case"select":pe("invalid",e);break;case"textarea":pe("invalid",e),N1(e,s.value,s.defaultValue,s.children)}n=s.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||e.textContent===""+n||s.suppressHydrationWarning===!0||AE(e.textContent,n)?(s.popover!=null&&(pe("beforetoggle",e),pe("toggle",e)),s.onScroll!=null&&pe("scroll",e),s.onScrollEnd!=null&&pe("scrollend",e),s.onClick!=null&&(e.onclick=gs),e=!0):e=!1,e||ki(t,!0)}function $b(t){for(At=t.return;At;)switch(At.tag){case 5:case 31:case 13:En=!1;return;case 27:case 3:En=!0;return;default:At=At.return}}function Cr(t){if(t!==At)return!1;if(!ve)return $b(t),ve=!0,!1;var e=t.tag,n;if((n=e!==3&&e!==27)&&((n=e===5)&&(n=t.type,n=!(n!=="form"&&n!=="button")||km(t.type,t.memoizedProps)),n=!n),n&&He&&ki(t),$b(t),e===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(P(317));He=Cv(t)}else if(e===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(P(317));He=Cv(t)}else e===27?(e=He,Li(t.type)?(t=Rm,Rm=null,He=t):He=e):He=At?Tn(t.stateNode.nextSibling):null;return!0}function cr(){He=At=null,ve=!1}function Bf(){var t=ui;return t!==null&&(qt===null?qt=t:qt.push.apply(qt,t),ui=null),t}function ol(t){ui===null?ui=[t]:ui.push(t)}var tm=is(null),Sr=null,bs=null;function Ys(t,e,n){Be(tm,e._currentValue),e._currentValue=n}function Es(t){t._currentValue=tm.current,wt(tm)}function nm(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function sm(t,e,n,s){var i=t.child;for(i!==null&&(i.return=t);i!==null;){var r=i.dependencies;if(r!==null){var a=i.child;r=r.firstContext;e:for(;r!==null;){var o=r;r=i;for(var c=0;c<e.length;c++)if(o.context===e[c]){r.lanes|=n,o=r.alternate,o!==null&&(o.lanes|=n),nm(r.return,n,t),s||(a=null);break e}r=o.next}}else if(i.tag===18){if(a=i.return,a===null)throw Error(P(341));a.lanes|=n,r=a.alternate,r!==null&&(r.lanes|=n),nm(a,n,t),a=null}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===t){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}}function za(t,e,n,s){t=null;for(var i=e,r=!1;i!==null;){if(!r){if(i.flags&524288)r=!0;else if(i.flags&262144)break}if(i.tag===10){var a=i.alternate;if(a===null)throw Error(P(387));if(a=a.memoizedProps,a!==null){var o=i.type;dn(i.pendingProps.value,a.value)||(t!==null?t.push(o):t=[o])}}else if(i===vu.current){if(a=i.alternate,a===null)throw Error(P(387));a.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(t!==null?t.push(hl):t=[hl])}i=i.return}t!==null&&sm(e,t,n,s),e.flags|=262144}function Su(t){for(t=t.firstContext;t!==null;){if(!dn(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function ur(t){Sr=t,bs=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function It(t){return Y1(Sr,t)}function Ac(t,e){return Sr===null&&ur(t),Y1(t,e)}function Y1(t,e){var n=e._currentValue;if(e={context:e,memoizedValue:n,next:null},bs===null){if(t===null)throw Error(P(308));bs=e,t.dependencies={lanes:0,firstContext:e},t.flags|=524288}else bs=bs.next=e;return n}var ZR=typeof AbortController<"u"?AbortController:function(){var t=[],e=this.signal={aborted:!1,addEventListener:function(n,s){t.push(s)}};this.abort=function(){e.aborted=!0,t.forEach(function(n){return n()})}},eI=pt.unstable_scheduleCallback,tI=pt.unstable_NormalPriority,lt={$$typeof:ps,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ng(){return{controller:new ZR,data:new Map,refCount:0}}function zl(t){t.refCount--,t.refCount===0&&eI(tI,function(){t.controller.abort()})}var Do=null,im=0,wa=0,oa=null;function nI(t,e){if(Do===null){var n=Do=[];im=0,wa=Tg(),oa={status:"pending",value:void 0,then:function(s){n.push(s)}}}return im++,e.then(Kb,Kb),e}function Kb(){if(--im===0&&Do!==null){oa!==null&&(oa.status="fulfilled");var t=Do;Do=null,wa=0,oa=null;for(var e=0;e<t.length;e++)(0,t[e])()}}function sI(t,e){var n=[],s={status:"pending",value:null,reason:null,then:function(i){n.push(i)}};return t.then(function(){s.status="fulfilled",s.value=e;for(var i=0;i<n.length;i++)(0,n[i])(e)},function(i){for(s.status="rejected",s.reason=i,i=0;i<n.length;i++)(0,n[i])(void 0)}),s}var Yb=ie.S;ie.S=function(t,e){oE=on(),typeof e=="object"&&e!==null&&typeof e.then=="function"&&nI(t,e),Yb!==null&&Yb(t,e)};var nr=is(null);function sg(){var t=nr.current;return t!==null?t:Le.pooledCache}function Zc(t,e){e===null?Be(nr,nr.current):Be(nr,e.pool)}function q1(){var t=sg();return t===null?null:{parent:lt._currentValue,pool:t}}var $a=Error(P(460)),ig=Error(P(474)),Pd=Error(P(542)),Tu={then:function(){}};function qb(t){return t=t.status,t==="fulfilled"||t==="rejected"}function W1(t,e,n){switch(n=t[n],n===void 0?t.push(e):n!==e&&(e.then(gs,gs),e=n),e.status){case"fulfilled":return e.value;case"rejected":throw t=e.reason,Xb(t),t;default:if(typeof e.status=="string")e.then(gs,gs);else{if(t=Le,t!==null&&100<t.shellSuspendCounter)throw Error(P(482));t=e,t.status="pending",t.then(function(s){if(e.status==="pending"){var i=e;i.status="fulfilled",i.value=s}},function(s){if(e.status==="pending"){var i=e;i.status="rejected",i.reason=s}})}switch(e.status){case"fulfilled":return e.value;case"rejected":throw t=e.reason,Xb(t),t}throw sr=e,$a}}function $i(t){try{var e=t._init;return e(t._payload)}catch(n){throw n!==null&&typeof n=="object"&&typeof n.then=="function"?(sr=n,$a):n}}var sr=null;function Wb(){if(sr===null)throw Error(P(459));var t=sr;return sr=null,t}function Xb(t){if(t===$a||t===Pd)throw Error(P(483))}var la=null,ll=0;function Rc(t){var e=ll;return ll+=1,la===null&&(la=[]),W1(la,t,e)}function ho(t,e){e=e.props.ref,t.ref=e!==void 0?e:null}function Ic(t,e){throw e.$$typeof===FA?Error(P(525)):(t=Object.prototype.toString.call(e),Error(P(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)))}function X1(t){function e(p,b){if(t){var y=p.deletions;y===null?(p.deletions=[b],p.flags|=16):y.push(b)}}function n(p,b){if(!t)return null;for(;b!==null;)e(p,b),b=b.sibling;return null}function s(p){for(var b=new Map;p!==null;)p.key!==null?b.set(p.key,p):b.set(p.index,p),p=p.sibling;return b}function i(p,b){return p=ws(p,b),p.index=0,p.sibling=null,p}function r(p,b,y){return p.index=y,t?(y=p.alternate,y!==null?(y=y.index,y<b?(p.flags|=67108866,b):y):(p.flags|=67108866,b)):(p.flags|=1048576,b)}function a(p){return t&&p.alternate===null&&(p.flags|=67108866),p}function o(p,b,y,E){return b===null||b.tag!==6?(b=Lf(y,p.mode,E),b.return=p,b):(b=i(b,y),b.return=p,b)}function c(p,b,y,E){var N=y.type;return N===Ur?d(p,b,y.props.children,E,y.key):b!==null&&(b.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===$s&&$i(N)===b.type)?(b=i(b,y.props),ho(b,y),b.return=p,b):(b=Jc(y.type,y.key,y.props,null,p.mode,E),ho(b,y),b.return=p,b)}function u(p,b,y,E){return b===null||b.tag!==4||b.stateNode.containerInfo!==y.containerInfo||b.stateNode.implementation!==y.implementation?(b=Pf(y,p.mode,E),b.return=p,b):(b=i(b,y.children||[]),b.return=p,b)}function d(p,b,y,E,N){return b===null||b.tag!==7?(b=tr(y,p.mode,E,N),b.return=p,b):(b=i(b,y),b.return=p,b)}function f(p,b,y){if(typeof b=="string"&&b!==""||typeof b=="number"||typeof b=="bigint")return b=Lf(""+b,p.mode,y),b.return=p,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case wc:return y=Jc(b.type,b.key,b.props,null,p.mode,y),ho(y,b),y.return=p,y;case wo:return b=Pf(b,p.mode,y),b.return=p,b;case $s:return b=$i(b),f(p,b,y)}if(Eo(b)||co(b))return b=tr(b,p.mode,y,null),b.return=p,b;if(typeof b.then=="function")return f(p,Rc(b),y);if(b.$$typeof===ps)return f(p,Ac(p,b),y);Ic(p,b)}return null}function h(p,b,y,E){var N=b!==null?b.key:null;if(typeof y=="string"&&y!==""||typeof y=="number"||typeof y=="bigint")return N!==null?null:o(p,b,""+y,E);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case wc:return y.key===N?c(p,b,y,E):null;case wo:return y.key===N?u(p,b,y,E):null;case $s:return y=$i(y),h(p,b,y,E)}if(Eo(y)||co(y))return N!==null?null:d(p,b,y,E,null);if(typeof y.then=="function")return h(p,b,Rc(y),E);if(y.$$typeof===ps)return h(p,b,Ac(p,y),E);Ic(p,y)}return null}function m(p,b,y,E,N){if(typeof E=="string"&&E!==""||typeof E=="number"||typeof E=="bigint")return p=p.get(y)||null,o(b,p,""+E,N);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case wc:return p=p.get(E.key===null?y:E.key)||null,c(b,p,E,N);case wo:return p=p.get(E.key===null?y:E.key)||null,u(b,p,E,N);case $s:return E=$i(E),m(p,b,y,E,N)}if(Eo(E)||co(E))return p=p.get(y)||null,d(b,p,E,N,null);if(typeof E.then=="function")return m(p,b,y,Rc(E),N);if(E.$$typeof===ps)return m(p,b,y,Ac(b,E),N);Ic(b,E)}return null}function g(p,b,y,E){for(var N=null,A=null,w=b,T=b=0,k=null;w!==null&&T<y.length;T++){w.index>T?(k=w,w=null):k=w.sibling;var R=h(p,w,y[T],E);if(R===null){w===null&&(w=k);break}t&&w&&R.alternate===null&&e(p,w),b=r(R,b,T),A===null?N=R:A.sibling=R,A=R,w=k}if(T===y.length)return n(p,w),ve&&hs(p,T),N;if(w===null){for(;T<y.length;T++)w=f(p,y[T],E),w!==null&&(b=r(w,b,T),A===null?N=w:A.sibling=w,A=w);return ve&&hs(p,T),N}for(w=s(w);T<y.length;T++)k=m(w,p,T,y[T],E),k!==null&&(t&&k.alternate!==null&&w.delete(k.key===null?T:k.key),b=r(k,b,T),A===null?N=k:A.sibling=k,A=k);return t&&w.forEach(function(C){return e(p,C)}),ve&&hs(p,T),N}function v(p,b,y,E){if(y==null)throw Error(P(151));for(var N=null,A=null,w=b,T=b=0,k=null,R=y.next();w!==null&&!R.done;T++,R=y.next()){w.index>T?(k=w,w=null):k=w.sibling;var C=h(p,w,R.value,E);if(C===null){w===null&&(w=k);break}t&&w&&C.alternate===null&&e(p,w),b=r(C,b,T),A===null?N=C:A.sibling=C,A=C,w=k}if(R.done)return n(p,w),ve&&hs(p,T),N;if(w===null){for(;!R.done;T++,R=y.next())R=f(p,R.value,E),R!==null&&(b=r(R,b,T),A===null?N=R:A.sibling=R,A=R);return ve&&hs(p,T),N}for(w=s(w);!R.done;T++,R=y.next())R=m(w,p,T,R.value,E),R!==null&&(t&&R.alternate!==null&&w.delete(R.key===null?T:R.key),b=r(R,b,T),A===null?N=R:A.sibling=R,A=R);return t&&w.forEach(function(B){return e(p,B)}),ve&&hs(p,T),N}function x(p,b,y,E){if(typeof y=="object"&&y!==null&&y.type===Ur&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case wc:e:{for(var N=y.key;b!==null;){if(b.key===N){if(N=y.type,N===Ur){if(b.tag===7){n(p,b.sibling),E=i(b,y.props.children),E.return=p,p=E;break e}}else if(b.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===$s&&$i(N)===b.type){n(p,b.sibling),E=i(b,y.props),ho(E,y),E.return=p,p=E;break e}n(p,b);break}else e(p,b);b=b.sibling}y.type===Ur?(E=tr(y.props.children,p.mode,E,y.key),E.return=p,p=E):(E=Jc(y.type,y.key,y.props,null,p.mode,E),ho(E,y),E.return=p,p=E)}return a(p);case wo:e:{for(N=y.key;b!==null;){if(b.key===N)if(b.tag===4&&b.stateNode.containerInfo===y.containerInfo&&b.stateNode.implementation===y.implementation){n(p,b.sibling),E=i(b,y.children||[]),E.return=p,p=E;break e}else{n(p,b);break}else e(p,b);b=b.sibling}E=Pf(y,p.mode,E),E.return=p,p=E}return a(p);case $s:return y=$i(y),x(p,b,y,E)}if(Eo(y))return g(p,b,y,E);if(co(y)){if(N=co(y),typeof N!="function")throw Error(P(150));return y=N.call(y),v(p,b,y,E)}if(typeof y.then=="function")return x(p,b,Rc(y),E);if(y.$$typeof===ps)return x(p,b,Ac(p,y),E);Ic(p,y)}return typeof y=="string"&&y!==""||typeof y=="number"||typeof y=="bigint"?(y=""+y,b!==null&&b.tag===6?(n(p,b.sibling),E=i(b,y),E.return=p,p=E):(n(p,b),E=Lf(y,p.mode,E),E.return=p,p=E),a(p)):n(p,b)}return function(p,b,y,E){try{ll=0;var N=x(p,b,y,E);return la=null,N}catch(w){if(w===$a||w===Pd)throw w;var A=sn(29,w,null,p.mode);return A.lanes=E,A.return=p,A}finally{}}}var dr=X1(!0),Q1=X1(!1),Ks=!1;function rg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function rm(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function di(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function fi(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,Ee&2){var i=s.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),s.pending=e,e=Nu(t),V1(t,null,n),e}return Ld(t,s,e,n),Nu(t)}function Lo(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194048)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,p1(t,n)}}function Uf(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var i=null,r=null;if(n=n.firstBaseUpdate,n!==null){do{var a={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};r===null?i=r=a:r=r.next=a,n=n.next}while(n!==null);r===null?i=r=e:r=r.next=e}else i=r=e;n={baseState:s.baseState,firstBaseUpdate:i,lastBaseUpdate:r,shared:s.shared,callbacks:s.callbacks},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}var am=!1;function Po(){if(am){var t=oa;if(t!==null)throw t}}function Bo(t,e,n,s){am=!1;var i=t.updateQueue;Ks=!1;var r=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var c=o,u=c.next;c.next=null,a===null?r=u:a.next=u,a=c;var d=t.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==a&&(o===null?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=c))}if(r!==null){var f=i.baseState;a=0,d=u=c=null,o=r;do{var h=o.lane&-536870913,m=h!==o.lane;if(m?(be&h)===h:(s&h)===h){h!==0&&h===wa&&(am=!0),d!==null&&(d=d.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var g=t,v=o;h=e;var x=n;switch(v.tag){case 1:if(g=v.payload,typeof g=="function"){f=g.call(x,f,h);break e}f=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=v.payload,h=typeof g=="function"?g.call(x,f,h):g,h==null)break e;f=Fe({},f,h);break e;case 2:Ks=!0}}h=o.callback,h!==null&&(t.flags|=64,m&&(t.flags|=8192),m=i.callbacks,m===null?i.callbacks=[h]:m.push(h))}else m={lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(u=d=m,c=f):d=d.next=m,a|=h;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;m=o,o=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);d===null&&(c=f),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=d,r===null&&(i.shared.lanes=0),Ti|=a,t.lanes=a,t.memoizedState=f}}function J1(t,e){if(typeof t!="function")throw Error(P(191,t));t.call(e)}function Z1(t,e){var n=t.callbacks;if(n!==null)for(t.callbacks=null,t=0;t<n.length;t++)J1(n[t],e)}var Ea=is(null),Au=is(0);function Qb(t,e){t=Cs,Be(Au,t),Be(Ea,e),Cs=t|e.baseLanes}function om(){Be(Au,Cs),Be(Ea,Ea.current)}function ag(){Cs=Au.current,wt(Ea),wt(Au)}var fn=is(null),Sn=null;function qs(t){var e=t.alternate;Be(tt,tt.current&1),Be(fn,t),Sn===null&&(e===null||Ea.current!==null||e.memoizedState!==null)&&(Sn=t)}function lm(t){Be(tt,tt.current),Be(fn,t),Sn===null&&(Sn=t)}function ew(t){t.tag===22?(Be(tt,tt.current),Be(fn,t),Sn===null&&(Sn=t)):Ws()}function Ws(){Be(tt,tt.current),Be(fn,fn.current)}function nn(t){wt(fn),Sn===t&&(Sn=null),wt(tt)}var tt=is(0);function Ru(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||Tm(n)||Am(n)))return e}else if(e.tag===19&&(e.memoizedProps.revealOrder==="forwards"||e.memoizedProps.revealOrder==="backwards"||e.memoizedProps.revealOrder==="unstable_legacy-backwards"||e.memoizedProps.revealOrder==="together")){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var As=0,ce=null,Oe=null,at=null,Iu=!1,ca=!1,fr=!1,Cu=0,cl=0,ua=null,iI=0;function Je(){throw Error(P(321))}function og(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!dn(t[n],e[n]))return!1;return!0}function lg(t,e,n,s,i,r){return As=r,ce=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ie.H=t===null||t.memoizedState===null?Cw:xg,fr=!1,r=n(s,i),fr=!1,ca&&(r=nw(e,n,s,i)),tw(t),r}function tw(t){ie.H=ul;var e=Oe!==null&&Oe.next!==null;if(As=0,at=Oe=ce=null,Iu=!1,cl=0,ua=null,e)throw Error(P(300));t===null||ct||(t=t.dependencies,t!==null&&Su(t)&&(ct=!0))}function nw(t,e,n,s){ce=t;var i=0;do{if(ca&&(ua=null),cl=0,ca=!1,25<=i)throw Error(P(301));if(i+=1,at=Oe=null,t.updateQueue!=null){var r=t.updateQueue;r.lastEffect=null,r.events=null,r.stores=null,r.memoCache!=null&&(r.memoCache.index=0)}ie.H=jw,r=e(n,s)}while(ca);return r}function rI(){var t=ie.H,e=t.useState()[0];return e=typeof e.then=="function"?$l(e):e,t=t.useState()[0],(Oe!==null?Oe.memoizedState:null)!==t&&(ce.flags|=1024),e}function cg(){var t=Cu!==0;return Cu=0,t}function ug(t,e,n){e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~n}function dg(t){if(Iu){for(t=t.memoizedState;t!==null;){var e=t.queue;e!==null&&(e.pending=null),t=t.next}Iu=!1}As=0,at=Oe=ce=null,ca=!1,cl=Cu=0,ua=null}function Dt(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return at===null?ce.memoizedState=at=t:at=at.next=t,at}function nt(){if(Oe===null){var t=ce.alternate;t=t!==null?t.memoizedState:null}else t=Oe.next;var e=at===null?ce.memoizedState:at.next;if(e!==null)at=e,Oe=t;else{if(t===null)throw ce.alternate===null?Error(P(467)):Error(P(310));Oe=t,t={memoizedState:Oe.memoizedState,baseState:Oe.baseState,baseQueue:Oe.baseQueue,queue:Oe.queue,next:null},at===null?ce.memoizedState=at=t:at=at.next=t}return at}function Bd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function $l(t){var e=cl;return cl+=1,ua===null&&(ua=[]),t=W1(ua,t,e),e=ce,(at===null?e.memoizedState:at.next)===null&&(e=e.alternate,ie.H=e===null||e.memoizedState===null?Cw:xg),t}function Ud(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return $l(t);if(t.$$typeof===ps)return It(t)}throw Error(P(438,String(t)))}function fg(t){var e=null,n=ce.updateQueue;if(n!==null&&(e=n.memoCache),e==null){var s=ce.alternate;s!==null&&(s=s.updateQueue,s!==null&&(s=s.memoCache,s!=null&&(e={data:s.data.map(function(i){return i.slice()}),index:0})))}if(e==null&&(e={data:[],index:0}),n===null&&(n=Bd(),ce.updateQueue=n),n.memoCache=e,n=e.data[e.index],n===void 0)for(n=e.data[e.index]=Array(t),s=0;s<t;s++)n[s]=zA;return e.index++,n}function Rs(t,e){return typeof e=="function"?e(t):e}function eu(t){var e=nt();return hg(e,Oe,t)}function hg(t,e,n){var s=t.queue;if(s===null)throw Error(P(311));s.lastRenderedReducer=n;var i=t.baseQueue,r=s.pending;if(r!==null){if(i!==null){var a=i.next;i.next=r.next,r.next=a}e.baseQueue=i=r,s.pending=null}if(r=t.baseState,i===null)t.memoizedState=r;else{e=i.next;var o=a=null,c=null,u=e,d=!1;do{var f=u.lane&-536870913;if(f!==u.lane?(be&f)===f:(As&f)===f){var h=u.revertLane;if(h===0)c!==null&&(c=c.next={lane:0,revertLane:0,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),f===wa&&(d=!0);else if((As&h)===h){u=u.next,h===wa&&(d=!0);continue}else f={lane:0,revertLane:u.revertLane,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},c===null?(o=c=f,a=r):c=c.next=f,ce.lanes|=h,Ti|=h;f=u.action,fr&&n(r,f),r=u.hasEagerState?u.eagerState:n(r,f)}else h={lane:f,revertLane:u.revertLane,gesture:u.gesture,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},c===null?(o=c=h,a=r):c=c.next=h,ce.lanes|=f,Ti|=f;u=u.next}while(u!==null&&u!==e);if(c===null?a=r:c.next=o,!dn(r,t.memoizedState)&&(ct=!0,d&&(n=oa,n!==null)))throw n;t.memoizedState=r,t.baseState=a,t.baseQueue=c,s.lastRenderedState=r}return i===null&&(s.lanes=0),[t.memoizedState,s.dispatch]}function Hf(t){var e=nt(),n=e.queue;if(n===null)throw Error(P(311));n.lastRenderedReducer=t;var s=n.dispatch,i=n.pending,r=e.memoizedState;if(i!==null){n.pending=null;var a=i=i.next;do r=t(r,a.action),a=a.next;while(a!==i);dn(r,e.memoizedState)||(ct=!0),e.memoizedState=r,e.baseQueue===null&&(e.baseState=r),n.lastRenderedState=r}return[r,s]}function sw(t,e,n){var s=ce,i=nt(),r=ve;if(r){if(n===void 0)throw Error(P(407));n=n()}else n=e();var a=!dn((Oe||i).memoizedState,n);if(a&&(i.memoizedState=n,ct=!0),i=i.queue,mg(aw.bind(null,s,i,t),[t]),i.getSnapshot!==e||a||at!==null&&at.memoizedState.tag&1){if(s.flags|=2048,Na(9,{destroy:void 0},rw.bind(null,s,i,n,e),null),Le===null)throw Error(P(349));r||As&127||iw(s,e,n)}return n}function iw(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ce.updateQueue,e===null?(e=Bd(),ce.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function rw(t,e,n,s){e.value=n,e.getSnapshot=s,ow(e)&&lw(t)}function aw(t,e,n){return n(function(){ow(e)&&lw(t)})}function ow(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!dn(t,n)}catch{return!0}}function lw(t){var e=kr(t,2);e!==null&&Jt(e,t,2)}function cm(t){var e=Dt();if(typeof t=="function"){var n=t;if(t=n(),fr){ti(!0);try{n()}finally{ti(!1)}}}return e.memoizedState=e.baseState=t,e.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Rs,lastRenderedState:t},e}function cw(t,e,n,s){return t.baseState=n,hg(t,Oe,typeof s=="function"?s:Rs)}function aI(t,e,n,s,i){if(Gd(t))throw Error(P(485));if(t=e.action,t!==null){var r={payload:i,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(a){r.listeners.push(a)}};ie.T!==null?n(!0):r.isTransition=!1,s(r),n=e.pending,n===null?(r.next=e.pending=r,uw(e,r)):(r.next=n.next,e.pending=n.next=r)}}function uw(t,e){var n=e.action,s=e.payload,i=t.state;if(e.isTransition){var r=ie.T,a={};ie.T=a;try{var o=n(i,s),c=ie.S;c!==null&&c(a,o),Jb(t,e,o)}catch(u){um(t,e,u)}finally{r!==null&&a.types!==null&&(r.types=a.types),ie.T=r}}else try{r=n(i,s),Jb(t,e,r)}catch(u){um(t,e,u)}}function Jb(t,e,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(s){Zb(t,e,s)},function(s){return um(t,e,s)}):Zb(t,e,n)}function Zb(t,e,n){e.status="fulfilled",e.value=n,dw(e),t.state=n,e=t.pending,e!==null&&(n=e.next,n===e?t.pending=null:(n=n.next,e.next=n,uw(t,n)))}function um(t,e,n){var s=t.pending;if(t.pending=null,s!==null){s=s.next;do e.status="rejected",e.reason=n,dw(e),e=e.next;while(e!==s)}t.action=null}function dw(t){t=t.listeners;for(var e=0;e<t.length;e++)(0,t[e])()}function fw(t,e){return e}function ev(t,e){if(ve){var n=Le.formState;if(n!==null){e:{var s=ce;if(ve){if(He){t:{for(var i=He,r=En;i.nodeType!==8;){if(!r){i=null;break t}if(i=Tn(i.nextSibling),i===null){i=null;break t}}r=i.data,i=r==="F!"||r==="F"?i:null}if(i){He=Tn(i.nextSibling),s=i.data==="F!";break e}}ki(s)}s=!1}s&&(e=n[0])}}return n=Dt(),n.memoizedState=n.baseState=e,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:fw,lastRenderedState:e},n.queue=s,n=Aw.bind(null,ce,s),s.dispatch=n,s=cm(!1),r=vg.bind(null,ce,!1,s.queue),s=Dt(),i={state:e,dispatch:null,action:t,pending:null},s.queue=i,n=aI.bind(null,ce,i,r,n),i.dispatch=n,s.memoizedState=t,[e,n,!1]}function tv(t){var e=nt();return hw(e,Oe,t)}function hw(t,e,n){if(e=hg(t,e,fw)[0],t=eu(Rs)[0],typeof e=="object"&&e!==null&&typeof e.then=="function")try{var s=$l(e)}catch(a){throw a===$a?Pd:a}else s=e;e=nt();var i=e.queue,r=i.dispatch;return n!==e.memoizedState&&(ce.flags|=2048,Na(9,{destroy:void 0},oI.bind(null,i,n),null)),[s,r,t]}function oI(t,e){t.action=e}function nv(t){var e=nt(),n=Oe;if(n!==null)return hw(e,n,t);nt(),e=e.memoizedState,n=nt();var s=n.queue.dispatch;return n.memoizedState=t,[e,s,!1]}function Na(t,e,n,s){return t={tag:t,create:n,deps:s,inst:e,next:null},e=ce.updateQueue,e===null&&(e=Bd(),ce.updateQueue=e),n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t),t}function mw(){return nt().memoizedState}function tu(t,e,n,s){var i=Dt();ce.flags|=t,i.memoizedState=Na(1|e,{destroy:void 0},n,s===void 0?null:s)}function Hd(t,e,n,s){var i=nt();s=s===void 0?null:s;var r=i.memoizedState.inst;Oe!==null&&s!==null&&og(s,Oe.memoizedState.deps)?i.memoizedState=Na(e,r,n,s):(ce.flags|=t,i.memoizedState=Na(1|e,r,n,s))}function sv(t,e){tu(8390656,8,t,e)}function mg(t,e){Hd(2048,8,t,e)}function lI(t){ce.flags|=4;var e=ce.updateQueue;if(e===null)e=Bd(),ce.updateQueue=e,e.events=[t];else{var n=e.events;n===null?e.events=[t]:n.push(t)}}function pw(t){var e=nt().memoizedState;return lI({ref:e,nextImpl:t}),function(){if(Ee&2)throw Error(P(440));return e.impl.apply(void 0,arguments)}}function gw(t,e){return Hd(4,2,t,e)}function bw(t,e){return Hd(4,4,t,e)}function vw(t,e){if(typeof e=="function"){t=t();var n=e(t);return function(){typeof n=="function"?n():e(null)}}if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function xw(t,e,n){n=n!=null?n.concat([t]):null,Hd(4,4,vw.bind(null,e,t),n)}function pg(){}function yw(t,e){var n=nt();e=e===void 0?null:e;var s=n.memoizedState;return e!==null&&og(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function _w(t,e){var n=nt();e=e===void 0?null:e;var s=n.memoizedState;if(e!==null&&og(e,s[1]))return s[0];if(s=t(),fr){ti(!0);try{t()}finally{ti(!1)}}return n.memoizedState=[s,e],s}function gg(t,e,n){return n===void 0||As&1073741824&&!(be&261930)?t.memoizedState=e:(t.memoizedState=n,t=cE(),ce.lanes|=t,Ti|=t,n)}function ww(t,e,n,s){return dn(n,e)?n:Ea.current!==null?(t=gg(t,n,s),dn(t,e)||(ct=!0),t):!(As&42)||As&1073741824&&!(be&261930)?(ct=!0,t.memoizedState=n):(t=cE(),ce.lanes|=t,Ti|=t,e)}function Ew(t,e,n,s,i){var r=Ne.p;Ne.p=r!==0&&8>r?r:8;var a=ie.T,o={};ie.T=o,vg(t,!1,e,n);try{var c=i(),u=ie.S;if(u!==null&&u(o,c),c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=sI(c,s);Uo(t,e,d,un(t))}else Uo(t,e,s,un(t))}catch(f){Uo(t,e,{then:function(){},status:"rejected",reason:f},un())}finally{Ne.p=r,a!==null&&o.types!==null&&(a.types=o.types),ie.T=a}}function cI(){}function dm(t,e,n,s){if(t.tag!==5)throw Error(P(476));var i=Nw(t).queue;Ew(t,i,e,er,n===null?cI:function(){return kw(t),n(s)})}function Nw(t){var e=t.memoizedState;if(e!==null)return e;e={memoizedState:er,baseState:er,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Rs,lastRenderedState:er},next:null};var n={};return e.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Rs,lastRenderedState:n},next:null},t.memoizedState=e,t=t.alternate,t!==null&&(t.memoizedState=e),e}function kw(t){var e=Nw(t);e.next===null&&(e=t.alternate.memoizedState),Uo(t,e.next.queue,{},un())}function bg(){return It(hl)}function Sw(){return nt().memoizedState}function Tw(){return nt().memoizedState}function uI(t){for(var e=t.return;e!==null;){switch(e.tag){case 24:case 3:var n=un();t=di(n);var s=fi(e,t,n);s!==null&&(Jt(s,e,n),Lo(s,e,n)),e={cache:ng()},t.payload=e;return}e=e.return}}function dI(t,e,n){var s=un();n={lane:s,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},Gd(t)?Rw(e,n):(n=Jp(t,e,n,s),n!==null&&(Jt(n,t,s),Iw(n,e,s)))}function Aw(t,e,n){var s=un();Uo(t,e,n,s)}function Uo(t,e,n,s){var i={lane:s,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(Gd(t))Rw(e,i);else{var r=t.alternate;if(t.lanes===0&&(r===null||r.lanes===0)&&(r=e.lastRenderedReducer,r!==null))try{var a=e.lastRenderedState,o=r(a,n);if(i.hasEagerState=!0,i.eagerState=o,dn(o,a))return Ld(t,e,i,0),Le===null&&Dd(),!1}catch{}finally{}if(n=Jp(t,e,i,s),n!==null)return Jt(n,t,s),Iw(n,e,s),!0}return!1}function vg(t,e,n,s){if(s={lane:2,revertLane:Tg(),gesture:null,action:s,hasEagerState:!1,eagerState:null,next:null},Gd(t)){if(e)throw Error(P(479))}else e=Jp(t,n,s,2),e!==null&&Jt(e,t,2)}function Gd(t){var e=t.alternate;return t===ce||e!==null&&e===ce}function Rw(t,e){ca=Iu=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Iw(t,e,n){if(n&4194048){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,p1(t,n)}}var ul={readContext:It,use:Ud,useCallback:Je,useContext:Je,useEffect:Je,useImperativeHandle:Je,useLayoutEffect:Je,useInsertionEffect:Je,useMemo:Je,useReducer:Je,useRef:Je,useState:Je,useDebugValue:Je,useDeferredValue:Je,useTransition:Je,useSyncExternalStore:Je,useId:Je,useHostTransitionStatus:Je,useFormState:Je,useActionState:Je,useOptimistic:Je,useMemoCache:Je,useCacheRefresh:Je};ul.useEffectEvent=Je;var Cw={readContext:It,use:Ud,useCallback:function(t,e){return Dt().memoizedState=[t,e===void 0?null:e],t},useContext:It,useEffect:sv,useImperativeHandle:function(t,e,n){n=n!=null?n.concat([t]):null,tu(4194308,4,vw.bind(null,e,t),n)},useLayoutEffect:function(t,e){return tu(4194308,4,t,e)},useInsertionEffect:function(t,e){tu(4,2,t,e)},useMemo:function(t,e){var n=Dt();e=e===void 0?null:e;var s=t();if(fr){ti(!0);try{t()}finally{ti(!1)}}return n.memoizedState=[s,e],s},useReducer:function(t,e,n){var s=Dt();if(n!==void 0){var i=n(e);if(fr){ti(!0);try{n(e)}finally{ti(!1)}}}else i=e;return s.memoizedState=s.baseState=i,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:i},s.queue=t,t=t.dispatch=dI.bind(null,ce,t),[s.memoizedState,t]},useRef:function(t){var e=Dt();return t={current:t},e.memoizedState=t},useState:function(t){t=cm(t);var e=t.queue,n=Aw.bind(null,ce,e);return e.dispatch=n,[t.memoizedState,n]},useDebugValue:pg,useDeferredValue:function(t,e){var n=Dt();return gg(n,t,e)},useTransition:function(){var t=cm(!1);return t=Ew.bind(null,ce,t.queue,!0,!1),Dt().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,e,n){var s=ce,i=Dt();if(ve){if(n===void 0)throw Error(P(407));n=n()}else{if(n=e(),Le===null)throw Error(P(349));be&127||iw(s,e,n)}i.memoizedState=n;var r={value:n,getSnapshot:e};return i.queue=r,sv(aw.bind(null,s,r,t),[t]),s.flags|=2048,Na(9,{destroy:void 0},rw.bind(null,s,r,n,e),null),n},useId:function(){var t=Dt(),e=Le.identifierPrefix;if(ve){var n=Xn,s=Wn;n=(s&~(1<<32-cn(s)-1)).toString(32)+n,e="_"+e+"R_"+n,n=Cu++,0<n&&(e+="H"+n.toString(32)),e+="_"}else n=iI++,e="_"+e+"r_"+n.toString(32)+"_";return t.memoizedState=e},useHostTransitionStatus:bg,useFormState:ev,useActionState:ev,useOptimistic:function(t){var e=Dt();e.memoizedState=e.baseState=t;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return e.queue=n,e=vg.bind(null,ce,!0,n),n.dispatch=e,[t,e]},useMemoCache:fg,useCacheRefresh:function(){return Dt().memoizedState=uI.bind(null,ce)},useEffectEvent:function(t){var e=Dt(),n={impl:t};return e.memoizedState=n,function(){if(Ee&2)throw Error(P(440));return n.impl.apply(void 0,arguments)}}},xg={readContext:It,use:Ud,useCallback:yw,useContext:It,useEffect:mg,useImperativeHandle:xw,useInsertionEffect:gw,useLayoutEffect:bw,useMemo:_w,useReducer:eu,useRef:mw,useState:function(){return eu(Rs)},useDebugValue:pg,useDeferredValue:function(t,e){var n=nt();return ww(n,Oe.memoizedState,t,e)},useTransition:function(){var t=eu(Rs)[0],e=nt().memoizedState;return[typeof t=="boolean"?t:$l(t),e]},useSyncExternalStore:sw,useId:Sw,useHostTransitionStatus:bg,useFormState:tv,useActionState:tv,useOptimistic:function(t,e){var n=nt();return cw(n,Oe,t,e)},useMemoCache:fg,useCacheRefresh:Tw};xg.useEffectEvent=pw;var jw={readContext:It,use:Ud,useCallback:yw,useContext:It,useEffect:mg,useImperativeHandle:xw,useInsertionEffect:gw,useLayoutEffect:bw,useMemo:_w,useReducer:Hf,useRef:mw,useState:function(){return Hf(Rs)},useDebugValue:pg,useDeferredValue:function(t,e){var n=nt();return Oe===null?gg(n,t,e):ww(n,Oe.memoizedState,t,e)},useTransition:function(){var t=Hf(Rs)[0],e=nt().memoizedState;return[typeof t=="boolean"?t:$l(t),e]},useSyncExternalStore:sw,useId:Sw,useHostTransitionStatus:bg,useFormState:nv,useActionState:nv,useOptimistic:function(t,e){var n=nt();return Oe!==null?cw(n,Oe,t,e):(n.baseState=t,[t,n.queue.dispatch])},useMemoCache:fg,useCacheRefresh:Tw};jw.useEffectEvent=pw;function Gf(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:Fe({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var fm={enqueueSetState:function(t,e,n){t=t._reactInternals;var s=un(),i=di(s);i.payload=e,n!=null&&(i.callback=n),e=fi(t,i,s),e!==null&&(Jt(e,t,s),Lo(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=un(),i=di(s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=fi(t,i,s),e!==null&&(Jt(e,t,s),Lo(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=un(),s=di(n);s.tag=2,e!=null&&(s.callback=e),e=fi(t,s,n),e!==null&&(Jt(e,t,n),Lo(e,t,n))}};function iv(t,e,n,s,i,r,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,r,a):e.prototype&&e.prototype.isPureReactComponent?!rl(n,s)||!rl(i,r):!0}function rv(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&fm.enqueueReplaceState(e,e.state,null)}function hr(t,e){var n=e;if("ref"in e){n={};for(var s in e)s!=="ref"&&(n[s]=e[s])}if(t=t.defaultProps){n===e&&(n=Fe({},n));for(var i in t)n[i]===void 0&&(n[i]=t[i])}return n}function Ow(t){Eu(t)}function Mw(t){console.error(t)}function Dw(t){Eu(t)}function ju(t,e){try{var n=t.onUncaughtError;n(e.value,{componentStack:e.stack})}catch(s){setTimeout(function(){throw s})}}function av(t,e,n){try{var s=t.onCaughtError;s(n.value,{componentStack:n.stack,errorBoundary:e.tag===1?e.stateNode:null})}catch(i){setTimeout(function(){throw i})}}function hm(t,e,n){return n=di(n),n.tag=3,n.payload={element:null},n.callback=function(){ju(t,e)},n}function Lw(t){return t=di(t),t.tag=3,t}function Pw(t,e,n,s){var i=n.type.getDerivedStateFromError;if(typeof i=="function"){var r=s.value;t.payload=function(){return i(r)},t.callback=function(){av(e,n,s)}}var a=n.stateNode;a!==null&&typeof a.componentDidCatch=="function"&&(t.callback=function(){av(e,n,s),typeof i!="function"&&(hi===null?hi=new Set([this]):hi.add(this));var o=s.stack;this.componentDidCatch(s.value,{componentStack:o!==null?o:""})})}function fI(t,e,n,s,i){if(n.flags|=32768,s!==null&&typeof s=="object"&&typeof s.then=="function"){if(e=n.alternate,e!==null&&za(e,n,i,!0),n=fn.current,n!==null){switch(n.tag){case 31:case 13:return Sn===null?Pu():n.alternate===null&&et===0&&(et=3),n.flags&=-257,n.flags|=65536,n.lanes=i,s===Tu?n.flags|=16384:(e=n.updateQueue,e===null?n.updateQueue=new Set([s]):e.add(s),Jf(t,s,i)),!1;case 22:return n.flags|=65536,s===Tu?n.flags|=16384:(e=n.updateQueue,e===null?(e={transitions:null,markerInstances:null,retryQueue:new Set([s])},n.updateQueue=e):(n=e.retryQueue,n===null?e.retryQueue=new Set([s]):n.add(s)),Jf(t,s,i)),!1}throw Error(P(435,n.tag))}return Jf(t,s,i),Pu(),!1}if(ve)return e=fn.current,e!==null?(!(e.flags&65536)&&(e.flags|=256),e.flags|=65536,e.lanes=i,s!==em&&(t=Error(P(422),{cause:s}),ol(wn(t,n)))):(s!==em&&(e=Error(P(423),{cause:s}),ol(wn(e,n))),t=t.current.alternate,t.flags|=65536,i&=-i,t.lanes|=i,s=wn(s,n),i=hm(t.stateNode,s,i),Uf(t,i),et!==4&&(et=2)),!1;var r=Error(P(520),{cause:s});if(r=wn(r,n),Vo===null?Vo=[r]:Vo.push(r),et!==4&&(et=2),e===null)return!0;s=wn(s,n),n=e;do{switch(n.tag){case 3:return n.flags|=65536,t=i&-i,n.lanes|=t,t=hm(n.stateNode,s,t),Uf(n,t),!1;case 1:if(e=n.type,r=n.stateNode,(n.flags&128)===0&&(typeof e.getDerivedStateFromError=="function"||r!==null&&typeof r.componentDidCatch=="function"&&(hi===null||!hi.has(r))))return n.flags|=65536,i&=-i,n.lanes|=i,i=Lw(i),Pw(i,t,n,s),Uf(n,i),!1}n=n.return}while(n!==null);return!1}var yg=Error(P(461)),ct=!1;function St(t,e,n,s){e.child=t===null?Q1(e,null,n,s):dr(e,t.child,n,s)}function ov(t,e,n,s,i){n=n.render;var r=e.ref;if("ref"in s){var a={};for(var o in s)o!=="ref"&&(a[o]=s[o])}else a=s;return ur(e),s=lg(t,e,n,a,r,i),o=cg(),t!==null&&!ct?(ug(t,e,i),Is(t,e,i)):(ve&&o&&eg(e),e.flags|=1,St(t,e,s,i),e.child)}function lv(t,e,n,s,i){if(t===null){var r=n.type;return typeof r=="function"&&!Zp(r)&&r.defaultProps===void 0&&n.compare===null?(e.tag=15,e.type=r,Bw(t,e,r,s,i)):(t=Jc(n.type,null,s,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(r=t.child,!_g(t,i)){var a=r.memoizedProps;if(n=n.compare,n=n!==null?n:rl,n(a,s)&&t.ref===e.ref)return Is(t,e,i)}return e.flags|=1,t=ws(r,s),t.ref=e.ref,t.return=e,e.child=t}function Bw(t,e,n,s,i){if(t!==null){var r=t.memoizedProps;if(rl(r,s)&&t.ref===e.ref)if(ct=!1,e.pendingProps=s=r,_g(t,i))t.flags&131072&&(ct=!0);else return e.lanes=t.lanes,Is(t,e,i)}return mm(t,e,n,s,i)}function Uw(t,e,n,s){var i=s.children,r=t!==null?t.memoizedState:null;if(t===null&&e.stateNode===null&&(e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.mode==="hidden"){if(e.flags&128){if(r=r!==null?r.baseLanes|n:n,t!==null){for(s=e.child=t.child,i=0;s!==null;)i=i|s.lanes|s.childLanes,s=s.sibling;s=i&~r}else s=0,e.child=null;return cv(t,e,r,n,s)}if(n&536870912)e.memoizedState={baseLanes:0,cachePool:null},t!==null&&Zc(e,r!==null?r.cachePool:null),r!==null?Qb(e,r):om(),ew(e);else return s=e.lanes=536870912,cv(t,e,r!==null?r.baseLanes|n:n,n,s)}else r!==null?(Zc(e,r.cachePool),Qb(e,r),Ws(),e.memoizedState=null):(t!==null&&Zc(e,null),om(),Ws());return St(t,e,i,n),e.child}function ko(t,e){return t!==null&&t.tag===22||e.stateNode!==null||(e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),e.sibling}function cv(t,e,n,s,i){var r=sg();return r=r===null?null:{parent:lt._currentValue,pool:r},e.memoizedState={baseLanes:n,cachePool:r},t!==null&&Zc(e,null),om(),ew(e),t!==null&&za(t,e,s,!0),e.childLanes=i,null}function nu(t,e){return e=Ou({mode:e.mode,children:e.children},t.mode),e.ref=t.ref,t.child=e,e.return=t,e}function uv(t,e,n){return dr(e,t.child,null,n),t=nu(e,e.pendingProps),t.flags|=2,nn(e),e.memoizedState=null,t}function hI(t,e,n){var s=e.pendingProps,i=(e.flags&128)!==0;if(e.flags&=-129,t===null){if(ve){if(s.mode==="hidden")return t=nu(e,s),e.lanes=536870912,ko(null,t);if(lm(e),(t=He)?(t=CE(t,En),t=t!==null&&t.data==="&"?t:null,t!==null&&(e.memoizedState={dehydrated:t,treeContext:Ni!==null?{id:Wn,overflow:Xn}:null,retryLane:536870912,hydrationErrors:null},n=z1(t),n.return=e,e.child=n,At=e,He=null)):t=null,t===null)throw ki(e);return e.lanes=536870912,null}return nu(e,s)}var r=t.memoizedState;if(r!==null){var a=r.dehydrated;if(lm(e),i)if(e.flags&256)e.flags&=-257,e=uv(t,e,n);else if(e.memoizedState!==null)e.child=t.child,e.flags|=128,e=null;else throw Error(P(558));else if(ct||za(t,e,n,!1),i=(n&t.childLanes)!==0,ct||i){if(s=Le,s!==null&&(a=g1(s,n),a!==0&&a!==r.retryLane))throw r.retryLane=a,kr(t,a),Jt(s,t,a),yg;Pu(),e=uv(t,e,n)}else t=r.treeContext,He=Tn(a.nextSibling),At=e,ve=!0,ui=null,En=!1,t!==null&&K1(e,t),e=nu(e,s),e.flags|=4096;return e}return t=ws(t.child,{mode:s.mode,children:s.children}),t.ref=e.ref,e.child=t,t.return=e,t}function su(t,e){var n=e.ref;if(n===null)t!==null&&t.ref!==null&&(e.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(P(284));(t===null||t.ref!==n)&&(e.flags|=4194816)}}function mm(t,e,n,s,i){return ur(e),n=lg(t,e,n,s,void 0,i),s=cg(),t!==null&&!ct?(ug(t,e,i),Is(t,e,i)):(ve&&s&&eg(e),e.flags|=1,St(t,e,n,i),e.child)}function dv(t,e,n,s,i,r){return ur(e),e.updateQueue=null,n=nw(e,s,n,i),tw(t),s=cg(),t!==null&&!ct?(ug(t,e,r),Is(t,e,r)):(ve&&s&&eg(e),e.flags|=1,St(t,e,n,r),e.child)}function fv(t,e,n,s,i){if(ur(e),e.stateNode===null){var r=Yr,a=n.contextType;typeof a=="object"&&a!==null&&(r=It(a)),r=new n(s,r),e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=fm,e.stateNode=r,r._reactInternals=e,r=e.stateNode,r.props=s,r.state=e.memoizedState,r.refs={},rg(e),a=n.contextType,r.context=typeof a=="object"&&a!==null?It(a):Yr,r.state=e.memoizedState,a=n.getDerivedStateFromProps,typeof a=="function"&&(Gf(e,n,a,s),r.state=e.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(a=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),a!==r.state&&fm.enqueueReplaceState(r,r.state,null),Bo(e,s,r,i),Po(),r.state=e.memoizedState),typeof r.componentDidMount=="function"&&(e.flags|=4194308),s=!0}else if(t===null){r=e.stateNode;var o=e.memoizedProps,c=hr(n,o);r.props=c;var u=r.context,d=n.contextType;a=Yr,typeof d=="object"&&d!==null&&(a=It(d));var f=n.getDerivedStateFromProps;d=typeof f=="function"||typeof r.getSnapshotBeforeUpdate=="function",o=e.pendingProps!==o,d||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(o||u!==a)&&rv(e,r,s,a),Ks=!1;var h=e.memoizedState;r.state=h,Bo(e,s,r,i),Po(),u=e.memoizedState,o||h!==u||Ks?(typeof f=="function"&&(Gf(e,n,f,s),u=e.memoizedState),(c=Ks||iv(e,n,c,s,h,u,a))?(d||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount()),typeof r.componentDidMount=="function"&&(e.flags|=4194308)):(typeof r.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=u),r.props=s,r.state=u,r.context=a,s=c):(typeof r.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{r=e.stateNode,rm(t,e),a=e.memoizedProps,d=hr(n,a),r.props=d,f=e.pendingProps,h=r.context,u=n.contextType,c=Yr,typeof u=="object"&&u!==null&&(c=It(u)),o=n.getDerivedStateFromProps,(u=typeof o=="function"||typeof r.getSnapshotBeforeUpdate=="function")||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(a!==f||h!==c)&&rv(e,r,s,c),Ks=!1,h=e.memoizedState,r.state=h,Bo(e,s,r,i),Po();var m=e.memoizedState;a!==f||h!==m||Ks||t!==null&&t.dependencies!==null&&Su(t.dependencies)?(typeof o=="function"&&(Gf(e,n,o,s),m=e.memoizedState),(d=Ks||iv(e,n,d,s,h,m,c)||t!==null&&t.dependencies!==null&&Su(t.dependencies))?(u||typeof r.UNSAFE_componentWillUpdate!="function"&&typeof r.componentWillUpdate!="function"||(typeof r.componentWillUpdate=="function"&&r.componentWillUpdate(s,m,c),typeof r.UNSAFE_componentWillUpdate=="function"&&r.UNSAFE_componentWillUpdate(s,m,c)),typeof r.componentDidUpdate=="function"&&(e.flags|=4),typeof r.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof r.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=m),r.props=s,r.state=m,r.context=c,s=d):(typeof r.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),s=!1)}return r=s,su(t,e),s=(e.flags&128)!==0,r||s?(r=e.stateNode,n=s&&typeof n.getDerivedStateFromError!="function"?null:r.render(),e.flags|=1,t!==null&&s?(e.child=dr(e,t.child,null,i),e.child=dr(e,null,n,i)):St(t,e,n,i),e.memoizedState=r.state,t=e.child):t=Is(t,e,i),t}function hv(t,e,n,s){return cr(),e.flags|=256,St(t,e,n,s),e.child}var Vf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ff(t){return{baseLanes:t,cachePool:q1()}}function zf(t,e,n){return t=t!==null?t.childLanes&~n:0,e&&(t|=an),t}function Hw(t,e,n){var s=e.pendingProps,i=!1,r=(e.flags&128)!==0,a;if((a=r)||(a=t!==null&&t.memoizedState===null?!1:(tt.current&2)!==0),a&&(i=!0,e.flags&=-129),a=(e.flags&32)!==0,e.flags&=-33,t===null){if(ve){if(i?qs(e):Ws(),(t=He)?(t=CE(t,En),t=t!==null&&t.data!=="&"?t:null,t!==null&&(e.memoizedState={dehydrated:t,treeContext:Ni!==null?{id:Wn,overflow:Xn}:null,retryLane:536870912,hydrationErrors:null},n=z1(t),n.return=e,e.child=n,At=e,He=null)):t=null,t===null)throw ki(e);return Am(t)?e.lanes=32:e.lanes=536870912,null}var o=s.children;return s=s.fallback,i?(Ws(),i=e.mode,o=Ou({mode:"hidden",children:o},i),s=tr(s,i,n,null),o.return=e,s.return=e,o.sibling=s,e.child=o,s=e.child,s.memoizedState=Ff(n),s.childLanes=zf(t,a,n),e.memoizedState=Vf,ko(null,s)):(qs(e),pm(e,o))}var c=t.memoizedState;if(c!==null&&(o=c.dehydrated,o!==null)){if(r)e.flags&256?(qs(e),e.flags&=-257,e=$f(t,e,n)):e.memoizedState!==null?(Ws(),e.child=t.child,e.flags|=128,e=null):(Ws(),o=s.fallback,i=e.mode,s=Ou({mode:"visible",children:s.children},i),o=tr(o,i,n,null),o.flags|=2,s.return=e,o.return=e,s.sibling=o,e.child=s,dr(e,t.child,null,n),s=e.child,s.memoizedState=Ff(n),s.childLanes=zf(t,a,n),e.memoizedState=Vf,e=ko(null,s));else if(qs(e),Am(o)){if(a=o.nextSibling&&o.nextSibling.dataset,a)var u=a.dgst;a=u,s=Error(P(419)),s.stack="",s.digest=a,ol({value:s,source:null,stack:null}),e=$f(t,e,n)}else if(ct||za(t,e,n,!1),a=(n&t.childLanes)!==0,ct||a){if(a=Le,a!==null&&(s=g1(a,n),s!==0&&s!==c.retryLane))throw c.retryLane=s,kr(t,s),Jt(a,t,s),yg;Tm(o)||Pu(),e=$f(t,e,n)}else Tm(o)?(e.flags|=192,e.child=t.child,e=null):(t=c.treeContext,He=Tn(o.nextSibling),At=e,ve=!0,ui=null,En=!1,t!==null&&K1(e,t),e=pm(e,s.children),e.flags|=4096);return e}return i?(Ws(),o=s.fallback,i=e.mode,c=t.child,u=c.sibling,s=ws(c,{mode:"hidden",children:s.children}),s.subtreeFlags=c.subtreeFlags&65011712,u!==null?o=ws(u,o):(o=tr(o,i,n,null),o.flags|=2),o.return=e,s.return=e,s.sibling=o,e.child=s,ko(null,s),s=e.child,o=t.child.memoizedState,o===null?o=Ff(n):(i=o.cachePool,i!==null?(c=lt._currentValue,i=i.parent!==c?{parent:c,pool:c}:i):i=q1(),o={baseLanes:o.baseLanes|n,cachePool:i}),s.memoizedState=o,s.childLanes=zf(t,a,n),e.memoizedState=Vf,ko(t.child,s)):(qs(e),n=t.child,t=n.sibling,n=ws(n,{mode:"visible",children:s.children}),n.return=e,n.sibling=null,t!==null&&(a=e.deletions,a===null?(e.deletions=[t],e.flags|=16):a.push(t)),e.child=n,e.memoizedState=null,n)}function pm(t,e){return e=Ou({mode:"visible",children:e},t.mode),e.return=t,t.child=e}function Ou(t,e){return t=sn(22,t,null,e),t.lanes=0,t}function $f(t,e,n){return dr(e,t.child,null,n),t=pm(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function mv(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),nm(t.return,e,n)}function Kf(t,e,n,s,i,r){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:i,treeForkCount:r}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=s,a.tail=n,a.tailMode=i,a.treeForkCount=r)}function Gw(t,e,n){var s=e.pendingProps,i=s.revealOrder,r=s.tail;s=s.children;var a=tt.current,o=(a&2)!==0;if(o?(a=a&1|2,e.flags|=128):a&=1,Be(tt,a),St(t,e,s,n),s=ve?al:0,!o&&t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&mv(t,n,e);else if(t.tag===19)mv(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Ru(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Kf(e,!1,i,n,r,s);break;case"backwards":case"unstable_legacy-backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Ru(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Kf(e,!0,n,null,r,s);break;case"together":Kf(e,!1,null,null,void 0,s);break;default:e.memoizedState=null}return e.child}function Is(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ti|=e.lanes,!(n&e.childLanes))if(t!==null){if(za(t,e,n,!1),(n&e.childLanes)===0)return null}else return null;if(t!==null&&e.child!==t.child)throw Error(P(153));if(e.child!==null){for(t=e.child,n=ws(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ws(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function _g(t,e){return t.lanes&e?!0:(t=t.dependencies,!!(t!==null&&Su(t)))}function mI(t,e,n){switch(e.tag){case 3:xu(e,e.stateNode.containerInfo),Ys(e,lt,t.memoizedState.cache),cr();break;case 27:case 5:Fh(e);break;case 4:xu(e,e.stateNode.containerInfo);break;case 10:Ys(e,e.type,e.memoizedProps.value);break;case 31:if(e.memoizedState!==null)return e.flags|=128,lm(e),null;break;case 13:var s=e.memoizedState;if(s!==null)return s.dehydrated!==null?(qs(e),e.flags|=128,null):n&e.child.childLanes?Hw(t,e,n):(qs(e),t=Is(t,e,n),t!==null?t.sibling:null);qs(e);break;case 19:var i=(t.flags&128)!==0;if(s=(n&e.childLanes)!==0,s||(za(t,e,n,!1),s=(n&e.childLanes)!==0),i){if(s)return Gw(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Be(tt,tt.current),s)break;return null;case 22:return e.lanes=0,Uw(t,e,n,e.pendingProps);case 24:Ys(e,lt,t.memoizedState.cache)}return Is(t,e,n)}function Vw(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps)ct=!0;else{if(!_g(t,n)&&!(e.flags&128))return ct=!1,mI(t,e,n);ct=!!(t.flags&131072)}else ct=!1,ve&&e.flags&1048576&&$1(e,al,e.index);switch(e.lanes=0,e.tag){case 16:e:{var s=e.pendingProps;if(t=$i(e.elementType),e.type=t,typeof t=="function")Zp(t)?(s=hr(t,s),e.tag=1,e=fv(null,e,t,s,n)):(e.tag=0,e=mm(null,e,t,s,n));else{if(t!=null){var i=t.$$typeof;if(i===Up){e.tag=11,e=ov(null,e,t,s,n);break e}else if(i===Hp){e.tag=14,e=lv(null,e,t,s,n);break e}}throw e=Gh(t)||t,Error(P(306,e,""))}}return e;case 0:return mm(t,e,e.type,e.pendingProps,n);case 1:return s=e.type,i=hr(s,e.pendingProps),fv(t,e,s,i,n);case 3:e:{if(xu(e,e.stateNode.containerInfo),t===null)throw Error(P(387));s=e.pendingProps;var r=e.memoizedState;i=r.element,rm(t,e),Bo(e,s,null,n);var a=e.memoizedState;if(s=a.cache,Ys(e,lt,s),s!==r.cache&&sm(e,[lt],n,!0),Po(),s=a.element,r.isDehydrated)if(r={element:s,isDehydrated:!1,cache:a.cache},e.updateQueue.baseState=r,e.memoizedState=r,e.flags&256){e=hv(t,e,s,n);break e}else if(s!==i){i=wn(Error(P(424)),e),ol(i),e=hv(t,e,s,n);break e}else{switch(t=e.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(He=Tn(t.firstChild),At=e,ve=!0,ui=null,En=!0,n=Q1(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(cr(),s===i){e=Is(t,e,n);break e}St(t,e,s,n)}e=e.child}return e;case 26:return su(t,e),t===null?(n=Mv(e.type,null,e.pendingProps,null))?e.memoizedState=n:ve||(n=e.type,t=e.pendingProps,s=Gu(ci.current).createElement(n),s[Tt]=e,s[Zt]=t,Ct(s,n,t),yt(s),e.stateNode=s):e.memoizedState=Mv(e.type,t.memoizedProps,e.pendingProps,t.memoizedState),null;case 27:return Fh(e),t===null&&ve&&(s=e.stateNode=jE(e.type,e.pendingProps,ci.current),At=e,En=!0,i=He,Li(e.type)?(Rm=i,He=Tn(s.firstChild)):He=i),St(t,e,e.pendingProps.children,n),su(t,e),t===null&&(e.flags|=4194304),e.child;case 5:return t===null&&ve&&((i=s=He)&&(s=zI(s,e.type,e.pendingProps,En),s!==null?(e.stateNode=s,At=e,He=Tn(s.firstChild),En=!1,i=!0):i=!1),i||ki(e)),Fh(e),i=e.type,r=e.pendingProps,a=t!==null?t.memoizedProps:null,s=r.children,km(i,r)?s=null:a!==null&&km(i,a)&&(e.flags|=32),e.memoizedState!==null&&(i=lg(t,e,rI,null,null,n),hl._currentValue=i),su(t,e),St(t,e,s,n),e.child;case 6:return t===null&&ve&&((t=n=He)&&(n=$I(n,e.pendingProps,En),n!==null?(e.stateNode=n,At=e,He=null,t=!0):t=!1),t||ki(e)),null;case 13:return Hw(t,e,n);case 4:return xu(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=dr(e,null,s,n):St(t,e,s,n),e.child;case 11:return ov(t,e,e.type,e.pendingProps,n);case 7:return St(t,e,e.pendingProps,n),e.child;case 8:return St(t,e,e.pendingProps.children,n),e.child;case 12:return St(t,e,e.pendingProps.children,n),e.child;case 10:return s=e.pendingProps,Ys(e,e.type,s.value),St(t,e,s.children,n),e.child;case 9:return i=e.type._context,s=e.pendingProps.children,ur(e),i=It(i),s=s(i),e.flags|=1,St(t,e,s,n),e.child;case 14:return lv(t,e,e.type,e.pendingProps,n);case 15:return Bw(t,e,e.type,e.pendingProps,n);case 19:return Gw(t,e,n);case 31:return hI(t,e,n);case 22:return Uw(t,e,n,e.pendingProps);case 24:return ur(e),s=It(lt),t===null?(i=sg(),i===null&&(i=Le,r=ng(),i.pooledCache=r,r.refCount++,r!==null&&(i.pooledCacheLanes|=n),i=r),e.memoizedState={parent:s,cache:i},rg(e),Ys(e,lt,i)):(t.lanes&n&&(rm(t,e),Bo(e,null,null,n),Po()),i=t.memoizedState,r=e.memoizedState,i.parent!==s?(i={parent:s,cache:s},e.memoizedState=i,e.lanes===0&&(e.memoizedState=e.updateQueue.baseState=i),Ys(e,lt,s)):(s=r.cache,Ys(e,lt,s),s!==i.cache&&sm(e,[lt],n,!0))),St(t,e,e.pendingProps.children,n),e.child;case 29:throw e.pendingProps}throw Error(P(156,e.tag))}function ls(t){t.flags|=4}function Yf(t,e,n,s,i){if((e=(t.mode&32)!==0)&&(e=!1),e){if(t.flags|=16777216,(i&335544128)===i)if(t.stateNode.complete)t.flags|=8192;else if(fE())t.flags|=8192;else throw sr=Tu,ig}else t.flags&=-16777217}function pv(t,e){if(e.type!=="stylesheet"||e.state.loading&4)t.flags&=-16777217;else if(t.flags|=16777216,!DE(e))if(fE())t.flags|=8192;else throw sr=Tu,ig}function Cc(t,e){e!==null&&(t.flags|=4),t.flags&16384&&(e=t.tag!==22?h1():536870912,t.lanes|=e,ka|=e)}function mo(t,e){if(!ve)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function Ue(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,s|=i.subtreeFlags&65011712,s|=i.flags&65011712,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,s|=i.subtreeFlags,s|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function pI(t,e,n){var s=e.pendingProps;switch(tg(e),e.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ue(e),null;case 1:return Ue(e),null;case 3:return n=e.stateNode,s=null,t!==null&&(s=t.memoizedState.cache),e.memoizedState.cache!==s&&(e.flags|=2048),Es(lt),xa(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Cr(e)?ls(e):t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Bf())),Ue(e),null;case 26:var i=e.type,r=e.memoizedState;return t===null?(ls(e),r!==null?(Ue(e),pv(e,r)):(Ue(e),Yf(e,i,null,s,n))):r?r!==t.memoizedState?(ls(e),Ue(e),pv(e,r)):(Ue(e),e.flags&=-16777217):(t=t.memoizedProps,t!==s&&ls(e),Ue(e),Yf(e,i,t,s,n)),null;case 27:if(yu(e),n=ci.current,i=e.type,t!==null&&e.stateNode!=null)t.memoizedProps!==s&&ls(e);else{if(!s){if(e.stateNode===null)throw Error(P(166));return Ue(e),null}t=Jn.current,Cr(e)?zb(e):(t=jE(i,s,n),e.stateNode=t,ls(e))}return Ue(e),null;case 5:if(yu(e),i=e.type,t!==null&&e.stateNode!=null)t.memoizedProps!==s&&ls(e);else{if(!s){if(e.stateNode===null)throw Error(P(166));return Ue(e),null}if(r=Jn.current,Cr(e))zb(e);else{var a=Gu(ci.current);switch(r){case 1:r=a.createElementNS("http://www.w3.org/2000/svg",i);break;case 2:r=a.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;default:switch(i){case"svg":r=a.createElementNS("http://www.w3.org/2000/svg",i);break;case"math":r=a.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;case"script":r=a.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof s.is=="string"?a.createElement("select",{is:s.is}):a.createElement("select"),s.multiple?r.multiple=!0:s.size&&(r.size=s.size);break;default:r=typeof s.is=="string"?a.createElement(i,{is:s.is}):a.createElement(i)}}r[Tt]=e,r[Zt]=s;e:for(a=e.child;a!==null;){if(a.tag===5||a.tag===6)r.appendChild(a.stateNode);else if(a.tag!==4&&a.tag!==27&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===e)break e;for(;a.sibling===null;){if(a.return===null||a.return===e)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}e.stateNode=r;e:switch(Ct(r,i,s),i){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&ls(e)}}return Ue(e),Yf(e,e.type,t===null?null:t.memoizedProps,e.pendingProps,n),null;case 6:if(t&&e.stateNode!=null)t.memoizedProps!==s&&ls(e);else{if(typeof s!="string"&&e.stateNode===null)throw Error(P(166));if(t=ci.current,Cr(e)){if(t=e.stateNode,n=e.memoizedProps,s=null,i=At,i!==null)switch(i.tag){case 27:case 5:s=i.memoizedProps}t[Tt]=e,t=!!(t.nodeValue===n||s!==null&&s.suppressHydrationWarning===!0||AE(t.nodeValue,n)),t||ki(e,!0)}else t=Gu(t).createTextNode(s),t[Tt]=e,e.stateNode=t}return Ue(e),null;case 31:if(n=e.memoizedState,t===null||t.memoizedState!==null){if(s=Cr(e),n!==null){if(t===null){if(!s)throw Error(P(318));if(t=e.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(P(557));t[Tt]=e}else cr(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ue(e),t=!1}else n=Bf(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=n),t=!0;if(!t)return e.flags&256?(nn(e),e):(nn(e),null);if(e.flags&128)throw Error(P(558))}return Ue(e),null;case 13:if(s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(i=Cr(e),s!==null&&s.dehydrated!==null){if(t===null){if(!i)throw Error(P(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(P(317));i[Tt]=e}else cr(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ue(e),i=!1}else i=Bf(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=i),i=!0;if(!i)return e.flags&256?(nn(e),e):(nn(e),null)}return nn(e),e.flags&128?(e.lanes=n,e):(n=s!==null,t=t!==null&&t.memoizedState!==null,n&&(s=e.child,i=null,s.alternate!==null&&s.alternate.memoizedState!==null&&s.alternate.memoizedState.cachePool!==null&&(i=s.alternate.memoizedState.cachePool.pool),r=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(r=s.memoizedState.cachePool.pool),r!==i&&(s.flags|=2048)),n!==t&&n&&(e.child.flags|=8192),Cc(e,e.updateQueue),Ue(e),null);case 4:return xa(),t===null&&Ag(e.stateNode.containerInfo),Ue(e),null;case 10:return Es(e.type),Ue(e),null;case 19:if(wt(tt),s=e.memoizedState,s===null)return Ue(e),null;if(i=(e.flags&128)!==0,r=s.rendering,r===null)if(i)mo(s,!1);else{if(et!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(r=Ru(t),r!==null){for(e.flags|=128,mo(s,!1),t=r.updateQueue,e.updateQueue=t,Cc(e,t),e.subtreeFlags=0,t=n,n=e.child;n!==null;)F1(n,t),n=n.sibling;return Be(tt,tt.current&1|2),ve&&hs(e,s.treeForkCount),e.child}t=t.sibling}s.tail!==null&&on()>Du&&(e.flags|=128,i=!0,mo(s,!1),e.lanes=4194304)}else{if(!i)if(t=Ru(r),t!==null){if(e.flags|=128,i=!0,t=t.updateQueue,e.updateQueue=t,Cc(e,t),mo(s,!0),s.tail===null&&s.tailMode==="hidden"&&!r.alternate&&!ve)return Ue(e),null}else 2*on()-s.renderingStartTime>Du&&n!==536870912&&(e.flags|=128,i=!0,mo(s,!1),e.lanes=4194304);s.isBackwards?(r.sibling=e.child,e.child=r):(t=s.last,t!==null?t.sibling=r:e.child=r,s.last=r)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=on(),t.sibling=null,n=tt.current,Be(tt,i?n&1|2:n&1),ve&&hs(e,s.treeForkCount),t):(Ue(e),null);case 22:case 23:return nn(e),ag(),s=e.memoizedState!==null,t!==null?t.memoizedState!==null!==s&&(e.flags|=8192):s&&(e.flags|=8192),s?n&536870912&&!(e.flags&128)&&(Ue(e),e.subtreeFlags&6&&(e.flags|=8192)):Ue(e),n=e.updateQueue,n!==null&&Cc(e,n.retryQueue),n=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(n=t.memoizedState.cachePool.pool),s=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(s=e.memoizedState.cachePool.pool),s!==n&&(e.flags|=2048),t!==null&&wt(nr),null;case 24:return n=null,t!==null&&(n=t.memoizedState.cache),e.memoizedState.cache!==n&&(e.flags|=2048),Es(lt),Ue(e),null;case 25:return null;case 30:return null}throw Error(P(156,e.tag))}function gI(t,e){switch(tg(e),e.tag){case 1:return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Es(lt),xa(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 26:case 27:case 5:return yu(e),null;case 31:if(e.memoizedState!==null){if(nn(e),e.alternate===null)throw Error(P(340));cr()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 13:if(nn(e),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(P(340));cr()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return wt(tt),null;case 4:return xa(),null;case 10:return Es(e.type),null;case 22:case 23:return nn(e),ag(),t!==null&&wt(nr),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 24:return Es(lt),null;case 25:return null;default:return null}}function Fw(t,e){switch(tg(e),e.tag){case 3:Es(lt),xa();break;case 26:case 27:case 5:yu(e);break;case 4:xa();break;case 31:e.memoizedState!==null&&nn(e);break;case 13:nn(e);break;case 19:wt(tt);break;case 10:Es(e.type);break;case 22:case 23:nn(e),ag(),t!==null&&wt(nr);break;case 24:Es(lt)}}function Kl(t,e){try{var n=e.updateQueue,s=n!==null?n.lastEffect:null;if(s!==null){var i=s.next;n=i;do{if((n.tag&t)===t){s=void 0;var r=n.create,a=n.inst;s=r(),a.destroy=s}n=n.next}while(n!==i)}}catch(o){Se(e,e.return,o)}}function Si(t,e,n){try{var s=e.updateQueue,i=s!==null?s.lastEffect:null;if(i!==null){var r=i.next;s=r;do{if((s.tag&t)===t){var a=s.inst,o=a.destroy;if(o!==void 0){a.destroy=void 0,i=e;var c=n,u=o;try{u()}catch(d){Se(i,c,d)}}}s=s.next}while(s!==r)}}catch(d){Se(e,e.return,d)}}function zw(t){var e=t.updateQueue;if(e!==null){var n=t.stateNode;try{Z1(e,n)}catch(s){Se(t,t.return,s)}}}function $w(t,e,n){n.props=hr(t.type,t.memoizedProps),n.state=t.memoizedState;try{n.componentWillUnmount()}catch(s){Se(t,e,s)}}function Ho(t,e){try{var n=t.ref;if(n!==null){switch(t.tag){case 26:case 27:case 5:var s=t.stateNode;break;case 30:s=t.stateNode;break;default:s=t.stateNode}typeof n=="function"?t.refCleanup=n(s):n.current=s}}catch(i){Se(t,e,i)}}function Qn(t,e){var n=t.ref,s=t.refCleanup;if(n!==null)if(typeof s=="function")try{s()}catch(i){Se(t,e,i)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(i){Se(t,e,i)}else n.current=null}function Kw(t){var e=t.type,n=t.memoizedProps,s=t.stateNode;try{e:switch(e){case"button":case"input":case"select":case"textarea":n.autoFocus&&s.focus();break e;case"img":n.src?s.src=n.src:n.srcSet&&(s.srcset=n.srcSet)}}catch(i){Se(t,t.return,i)}}function qf(t,e,n){try{var s=t.stateNode;BI(s,t.type,n,e),s[Zt]=e}catch(i){Se(t,t.return,i)}}function Yw(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&Li(t.type)||t.tag===4}function Wf(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Yw(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&Li(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function gm(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(t,e):(e=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,e.appendChild(t),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=gs));else if(s!==4&&(s===27&&Li(t.type)&&(n=t.stateNode,e=null),t=t.child,t!==null))for(gm(t,e,n),t=t.sibling;t!==null;)gm(t,e,n),t=t.sibling}function Mu(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(s===27&&Li(t.type)&&(n=t.stateNode),t=t.child,t!==null))for(Mu(t,e,n),t=t.sibling;t!==null;)Mu(t,e,n),t=t.sibling}function qw(t){var e=t.stateNode,n=t.memoizedProps;try{for(var s=t.type,i=e.attributes;i.length;)e.removeAttributeNode(i[0]);Ct(e,s,n),e[Tt]=t,e[Zt]=n}catch(r){Se(t,t.return,r)}}var ms=!1,ot=!1,Xf=!1,gv=typeof WeakSet=="function"?WeakSet:Set,bt=null;function bI(t,e){if(t=t.containerInfo,Em=$u,t=D1(t),Xp(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var i=s.anchorOffset,r=s.focusNode;s=s.focusOffset;try{n.nodeType,r.nodeType}catch{n=null;break e}var a=0,o=-1,c=-1,u=0,d=0,f=t,h=null;t:for(;;){for(var m;f!==n||i!==0&&f.nodeType!==3||(o=a+i),f!==r||s!==0&&f.nodeType!==3||(c=a+s),f.nodeType===3&&(a+=f.nodeValue.length),(m=f.firstChild)!==null;)h=f,f=m;for(;;){if(f===t)break t;if(h===n&&++u===i&&(o=a),h===r&&++d===s&&(c=a),(m=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=m}n=o===-1||c===-1?null:{start:o,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Nm={focusedElem:t,selectionRange:n},$u=!1,bt=e;bt!==null;)if(e=bt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,bt=t;else for(;bt!==null;){switch(e=bt,r=e.alternate,t=e.flags,e.tag){case 0:if(t&4&&(t=e.updateQueue,t=t!==null?t.events:null,t!==null))for(n=0;n<t.length;n++)i=t[n],i.ref.impl=i.nextImpl;break;case 11:case 15:break;case 1:if(t&1024&&r!==null){t=void 0,n=e,i=r.memoizedProps,r=r.memoizedState,s=n.stateNode;try{var g=hr(n.type,i);t=s.getSnapshotBeforeUpdate(g,r),s.__reactInternalSnapshotBeforeUpdate=t}catch(v){Se(n,n.return,v)}}break;case 3:if(t&1024){if(t=e.stateNode.containerInfo,n=t.nodeType,n===9)Sm(t);else if(n===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":Sm(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(t&1024)throw Error(P(163))}if(t=e.sibling,t!==null){t.return=e.return,bt=t;break}bt=e.return}}function Ww(t,e,n){var s=n.flags;switch(n.tag){case 0:case 11:case 15:us(t,n),s&4&&Kl(5,n);break;case 1:if(us(t,n),s&4)if(t=n.stateNode,e===null)try{t.componentDidMount()}catch(a){Se(n,n.return,a)}else{var i=hr(n.type,e.memoizedProps);e=e.memoizedState;try{t.componentDidUpdate(i,e,t.__reactInternalSnapshotBeforeUpdate)}catch(a){Se(n,n.return,a)}}s&64&&zw(n),s&512&&Ho(n,n.return);break;case 3:if(us(t,n),s&64&&(t=n.updateQueue,t!==null)){if(e=null,n.child!==null)switch(n.child.tag){case 27:case 5:e=n.child.stateNode;break;case 1:e=n.child.stateNode}try{Z1(t,e)}catch(a){Se(n,n.return,a)}}break;case 27:e===null&&s&4&&qw(n);case 26:case 5:us(t,n),e===null&&s&4&&Kw(n),s&512&&Ho(n,n.return);break;case 12:us(t,n);break;case 31:us(t,n),s&4&&Jw(t,n);break;case 13:us(t,n),s&4&&Zw(t,n),s&64&&(t=n.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(n=SI.bind(null,n),KI(t,n))));break;case 22:if(s=n.memoizedState!==null||ms,!s){e=e!==null&&e.memoizedState!==null||ot,i=ms;var r=ot;ms=s,(ot=e)&&!r?ds(t,n,(n.subtreeFlags&8772)!==0):us(t,n),ms=i,ot=r}break;case 30:break;default:us(t,n)}}function Xw(t){var e=t.alternate;e!==null&&(t.alternate=null,Xw(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&zp(e)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var $e=null,Yt=!1;function cs(t,e,n){for(n=n.child;n!==null;)Qw(t,e,n),n=n.sibling}function Qw(t,e,n){if(ln&&typeof ln.onCommitFiberUnmount=="function")try{ln.onCommitFiberUnmount(Ul,n)}catch{}switch(n.tag){case 26:ot||Qn(n,e),cs(t,e,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:ot||Qn(n,e);var s=$e,i=Yt;Li(n.type)&&($e=n.stateNode,Yt=!1),cs(t,e,n),zo(n.stateNode),$e=s,Yt=i;break;case 5:ot||Qn(n,e);case 6:if(s=$e,i=Yt,$e=null,cs(t,e,n),$e=s,Yt=i,$e!==null)if(Yt)try{($e.nodeType===9?$e.body:$e.nodeName==="HTML"?$e.ownerDocument.body:$e).removeChild(n.stateNode)}catch(r){Se(n,e,r)}else try{$e.removeChild(n.stateNode)}catch(r){Se(n,e,r)}break;case 18:$e!==null&&(Yt?(t=$e,Rv(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,n.stateNode),Ra(t)):Rv($e,n.stateNode));break;case 4:s=$e,i=Yt,$e=n.stateNode.containerInfo,Yt=!0,cs(t,e,n),$e=s,Yt=i;break;case 0:case 11:case 14:case 15:Si(2,n,e),ot||Si(4,n,e),cs(t,e,n);break;case 1:ot||(Qn(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"&&$w(n,e,s)),cs(t,e,n);break;case 21:cs(t,e,n);break;case 22:ot=(s=ot)||n.memoizedState!==null,cs(t,e,n),ot=s;break;default:cs(t,e,n)}}function Jw(t,e){if(e.memoizedState===null&&(t=e.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{Ra(t)}catch(n){Se(e,e.return,n)}}}function Zw(t,e){if(e.memoizedState===null&&(t=e.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{Ra(t)}catch(n){Se(e,e.return,n)}}function vI(t){switch(t.tag){case 31:case 13:case 19:var e=t.stateNode;return e===null&&(e=t.stateNode=new gv),e;case 22:return t=t.stateNode,e=t._retryCache,e===null&&(e=t._retryCache=new gv),e;default:throw Error(P(435,t.tag))}}function jc(t,e){var n=vI(t);e.forEach(function(s){if(!n.has(s)){n.add(s);var i=TI.bind(null,t,s);s.then(i,i)}})}function $t(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var i=n[s],r=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 27:if(Li(o.type)){$e=o.stateNode,Yt=!1;break e}break;case 5:$e=o.stateNode,Yt=!1;break e;case 3:case 4:$e=o.stateNode.containerInfo,Yt=!0;break e}o=o.return}if($e===null)throw Error(P(160));Qw(r,a,i),$e=null,Yt=!1,r=i.alternate,r!==null&&(r.return=null),i.return=null}if(e.subtreeFlags&13886)for(e=e.child;e!==null;)eE(e,t),e=e.sibling}var Pn=null;function eE(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:$t(e,t),Kt(t),s&4&&(Si(3,t,t.return),Kl(3,t),Si(5,t,t.return));break;case 1:$t(e,t),Kt(t),s&512&&(ot||n===null||Qn(n,n.return)),s&64&&ms&&(t=t.updateQueue,t!==null&&(s=t.callbacks,s!==null&&(n=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=n===null?s:n.concat(s))));break;case 26:var i=Pn;if($t(e,t),Kt(t),s&512&&(ot||n===null||Qn(n,n.return)),s&4){var r=n!==null?n.memoizedState:null;if(s=t.memoizedState,n===null)if(s===null)if(t.stateNode===null){e:{s=t.type,n=t.memoizedProps,i=i.ownerDocument||i;t:switch(s){case"title":r=i.getElementsByTagName("title")[0],(!r||r[Vl]||r[Tt]||r.namespaceURI==="http://www.w3.org/2000/svg"||r.hasAttribute("itemprop"))&&(r=i.createElement(s),i.head.insertBefore(r,i.querySelector("head > title"))),Ct(r,s,n),r[Tt]=t,yt(r),s=r;break e;case"link":var a=Lv("link","href",i).get(s+(n.href||""));if(a){for(var o=0;o<a.length;o++)if(r=a[o],r.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&r.getAttribute("rel")===(n.rel==null?null:n.rel)&&r.getAttribute("title")===(n.title==null?null:n.title)&&r.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){a.splice(o,1);break t}}r=i.createElement(s),Ct(r,s,n),i.head.appendChild(r);break;case"meta":if(a=Lv("meta","content",i).get(s+(n.content||""))){for(o=0;o<a.length;o++)if(r=a[o],r.getAttribute("content")===(n.content==null?null:""+n.content)&&r.getAttribute("name")===(n.name==null?null:n.name)&&r.getAttribute("property")===(n.property==null?null:n.property)&&r.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&r.getAttribute("charset")===(n.charSet==null?null:n.charSet)){a.splice(o,1);break t}}r=i.createElement(s),Ct(r,s,n),i.head.appendChild(r);break;default:throw Error(P(468,s))}r[Tt]=t,yt(r),s=r}t.stateNode=s}else Pv(i,t.type,t.stateNode);else t.stateNode=Dv(i,s,t.memoizedProps);else r!==s?(r===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):r.count--,s===null?Pv(i,t.type,t.stateNode):Dv(i,s,t.memoizedProps)):s===null&&t.stateNode!==null&&qf(t,t.memoizedProps,n.memoizedProps)}break;case 27:$t(e,t),Kt(t),s&512&&(ot||n===null||Qn(n,n.return)),n!==null&&s&4&&qf(t,t.memoizedProps,n.memoizedProps);break;case 5:if($t(e,t),Kt(t),s&512&&(ot||n===null||Qn(n,n.return)),t.flags&32){i=t.stateNode;try{_a(i,"")}catch(g){Se(t,t.return,g)}}s&4&&t.stateNode!=null&&(i=t.memoizedProps,qf(t,i,n!==null?n.memoizedProps:i)),s&1024&&(Xf=!0);break;case 6:if($t(e,t),Kt(t),s&4){if(t.stateNode===null)throw Error(P(162));s=t.memoizedProps,n=t.stateNode;try{n.nodeValue=s}catch(g){Se(t,t.return,g)}}break;case 3:if(au=null,i=Pn,Pn=Vu(e.containerInfo),$t(e,t),Pn=i,Kt(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{Ra(e.containerInfo)}catch(g){Se(t,t.return,g)}Xf&&(Xf=!1,tE(t));break;case 4:s=Pn,Pn=Vu(t.stateNode.containerInfo),$t(e,t),Kt(t),Pn=s;break;case 12:$t(e,t),Kt(t);break;case 31:$t(e,t),Kt(t),s&4&&(s=t.updateQueue,s!==null&&(t.updateQueue=null,jc(t,s)));break;case 13:$t(e,t),Kt(t),t.child.flags&8192&&t.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(Vd=on()),s&4&&(s=t.updateQueue,s!==null&&(t.updateQueue=null,jc(t,s)));break;case 22:i=t.memoizedState!==null;var c=n!==null&&n.memoizedState!==null,u=ms,d=ot;if(ms=u||i,ot=d||c,$t(e,t),ot=d,ms=u,Kt(t),s&8192)e:for(e=t.stateNode,e._visibility=i?e._visibility&-2:e._visibility|1,i&&(n===null||c||ms||ot||Ki(t)),n=null,e=t;;){if(e.tag===5||e.tag===26){if(n===null){c=n=e;try{if(r=c.stateNode,i)a=r.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none";else{o=c.stateNode;var f=c.memoizedProps.style,h=f!=null&&f.hasOwnProperty("display")?f.display:null;o.style.display=h==null||typeof h=="boolean"?"":(""+h).trim()}}catch(g){Se(c,c.return,g)}}}else if(e.tag===6){if(n===null){c=e;try{c.stateNode.nodeValue=i?"":c.memoizedProps}catch(g){Se(c,c.return,g)}}}else if(e.tag===18){if(n===null){c=e;try{var m=c.stateNode;i?Iv(m,!0):Iv(c.stateNode,!1)}catch(g){Se(c,c.return,g)}}}else if((e.tag!==22&&e.tag!==23||e.memoizedState===null||e===t)&&e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;n===e&&(n=null),e=e.return}n===e&&(n=null),e.sibling.return=e.return,e=e.sibling}s&4&&(s=t.updateQueue,s!==null&&(n=s.retryQueue,n!==null&&(s.retryQueue=null,jc(t,n))));break;case 19:$t(e,t),Kt(t),s&4&&(s=t.updateQueue,s!==null&&(t.updateQueue=null,jc(t,s)));break;case 30:break;case 21:break;default:$t(e,t),Kt(t)}}function Kt(t){var e=t.flags;if(e&2){try{for(var n,s=t.return;s!==null;){if(Yw(s)){n=s;break}s=s.return}if(n==null)throw Error(P(160));switch(n.tag){case 27:var i=n.stateNode,r=Wf(t);Mu(t,r,i);break;case 5:var a=n.stateNode;n.flags&32&&(_a(a,""),n.flags&=-33);var o=Wf(t);Mu(t,o,a);break;case 3:case 4:var c=n.stateNode.containerInfo,u=Wf(t);gm(t,u,c);break;default:throw Error(P(161))}}catch(d){Se(t,t.return,d)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function tE(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var e=t;tE(e),e.tag===5&&e.flags&1024&&e.stateNode.reset(),t=t.sibling}}function us(t,e){if(e.subtreeFlags&8772)for(e=e.child;e!==null;)Ww(t,e.alternate,e),e=e.sibling}function Ki(t){for(t=t.child;t!==null;){var e=t;switch(e.tag){case 0:case 11:case 14:case 15:Si(4,e,e.return),Ki(e);break;case 1:Qn(e,e.return);var n=e.stateNode;typeof n.componentWillUnmount=="function"&&$w(e,e.return,n),Ki(e);break;case 27:zo(e.stateNode);case 26:case 5:Qn(e,e.return),Ki(e);break;case 22:e.memoizedState===null&&Ki(e);break;case 30:Ki(e);break;default:Ki(e)}t=t.sibling}}function ds(t,e,n){for(n=n&&(e.subtreeFlags&8772)!==0,e=e.child;e!==null;){var s=e.alternate,i=t,r=e,a=r.flags;switch(r.tag){case 0:case 11:case 15:ds(i,r,n),Kl(4,r);break;case 1:if(ds(i,r,n),s=r,i=s.stateNode,typeof i.componentDidMount=="function")try{i.componentDidMount()}catch(u){Se(s,s.return,u)}if(s=r,i=s.updateQueue,i!==null){var o=s.stateNode;try{var c=i.shared.hiddenCallbacks;if(c!==null)for(i.shared.hiddenCallbacks=null,i=0;i<c.length;i++)J1(c[i],o)}catch(u){Se(s,s.return,u)}}n&&a&64&&zw(r),Ho(r,r.return);break;case 27:qw(r);case 26:case 5:ds(i,r,n),n&&s===null&&a&4&&Kw(r),Ho(r,r.return);break;case 12:ds(i,r,n);break;case 31:ds(i,r,n),n&&a&4&&Jw(i,r);break;case 13:ds(i,r,n),n&&a&4&&Zw(i,r);break;case 22:r.memoizedState===null&&ds(i,r,n),Ho(r,r.return);break;case 30:break;default:ds(i,r,n)}e=e.sibling}}function wg(t,e){var n=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(n=t.memoizedState.cachePool.pool),t=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(t=e.memoizedState.cachePool.pool),t!==n&&(t!=null&&t.refCount++,n!=null&&zl(n))}function Eg(t,e){t=null,e.alternate!==null&&(t=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==t&&(e.refCount++,t!=null&&zl(t))}function Mn(t,e,n,s){if(e.subtreeFlags&10256)for(e=e.child;e!==null;)nE(t,e,n,s),e=e.sibling}function nE(t,e,n,s){var i=e.flags;switch(e.tag){case 0:case 11:case 15:Mn(t,e,n,s),i&2048&&Kl(9,e);break;case 1:Mn(t,e,n,s);break;case 3:Mn(t,e,n,s),i&2048&&(t=null,e.alternate!==null&&(t=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==t&&(e.refCount++,t!=null&&zl(t)));break;case 12:if(i&2048){Mn(t,e,n,s),t=e.stateNode;try{var r=e.memoizedProps,a=r.id,o=r.onPostCommit;typeof o=="function"&&o(a,e.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(c){Se(e,e.return,c)}}else Mn(t,e,n,s);break;case 31:Mn(t,e,n,s);break;case 13:Mn(t,e,n,s);break;case 23:break;case 22:r=e.stateNode,a=e.alternate,e.memoizedState!==null?r._visibility&2?Mn(t,e,n,s):Go(t,e):r._visibility&2?Mn(t,e,n,s):(r._visibility|=2,Pr(t,e,n,s,(e.subtreeFlags&10256)!==0||!1)),i&2048&&wg(a,e);break;case 24:Mn(t,e,n,s),i&2048&&Eg(e.alternate,e);break;default:Mn(t,e,n,s)}}function Pr(t,e,n,s,i){for(i=i&&((e.subtreeFlags&10256)!==0||!1),e=e.child;e!==null;){var r=t,a=e,o=n,c=s,u=a.flags;switch(a.tag){case 0:case 11:case 15:Pr(r,a,o,c,i),Kl(8,a);break;case 23:break;case 22:var d=a.stateNode;a.memoizedState!==null?d._visibility&2?Pr(r,a,o,c,i):Go(r,a):(d._visibility|=2,Pr(r,a,o,c,i)),i&&u&2048&&wg(a.alternate,a);break;case 24:Pr(r,a,o,c,i),i&&u&2048&&Eg(a.alternate,a);break;default:Pr(r,a,o,c,i)}e=e.sibling}}function Go(t,e){if(e.subtreeFlags&10256)for(e=e.child;e!==null;){var n=t,s=e,i=s.flags;switch(s.tag){case 22:Go(n,s),i&2048&&wg(s.alternate,s);break;case 24:Go(n,s),i&2048&&Eg(s.alternate,s);break;default:Go(n,s)}e=e.sibling}}var So=8192;function jr(t,e,n){if(t.subtreeFlags&So)for(t=t.child;t!==null;)sE(t,e,n),t=t.sibling}function sE(t,e,n){switch(t.tag){case 26:jr(t,e,n),t.flags&So&&t.memoizedState!==null&&iC(n,Pn,t.memoizedState,t.memoizedProps);break;case 5:jr(t,e,n);break;case 3:case 4:var s=Pn;Pn=Vu(t.stateNode.containerInfo),jr(t,e,n),Pn=s;break;case 22:t.memoizedState===null&&(s=t.alternate,s!==null&&s.memoizedState!==null?(s=So,So=16777216,jr(t,e,n),So=s):jr(t,e,n));break;default:jr(t,e,n)}}function iE(t){var e=t.alternate;if(e!==null&&(t=e.child,t!==null)){e.child=null;do e=t.sibling,t.sibling=null,t=e;while(t!==null)}}function po(t){var e=t.deletions;if(t.flags&16){if(e!==null)for(var n=0;n<e.length;n++){var s=e[n];bt=s,aE(s,t)}iE(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)rE(t),t=t.sibling}function rE(t){switch(t.tag){case 0:case 11:case 15:po(t),t.flags&2048&&Si(9,t,t.return);break;case 3:po(t);break;case 12:po(t);break;case 22:var e=t.stateNode;t.memoizedState!==null&&e._visibility&2&&(t.return===null||t.return.tag!==13)?(e._visibility&=-3,iu(t)):po(t);break;default:po(t)}}function iu(t){var e=t.deletions;if(t.flags&16){if(e!==null)for(var n=0;n<e.length;n++){var s=e[n];bt=s,aE(s,t)}iE(t)}for(t=t.child;t!==null;){switch(e=t,e.tag){case 0:case 11:case 15:Si(8,e,e.return),iu(e);break;case 22:n=e.stateNode,n._visibility&2&&(n._visibility&=-3,iu(e));break;default:iu(e)}t=t.sibling}}function aE(t,e){for(;bt!==null;){var n=bt;switch(n.tag){case 0:case 11:case 15:Si(8,n,e);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var s=n.memoizedState.cachePool.pool;s!=null&&s.refCount++}break;case 24:zl(n.memoizedState.cache)}if(s=n.child,s!==null)s.return=n,bt=s;else e:for(n=t;bt!==null;){s=bt;var i=s.sibling,r=s.return;if(Xw(s),s===n){bt=null;break e}if(i!==null){i.return=r,bt=i;break e}bt=r}}}var xI={getCacheForType:function(t){var e=It(lt),n=e.data.get(t);return n===void 0&&(n=t(),e.data.set(t,n)),n},cacheSignal:function(){return It(lt).controller.signal}},yI=typeof WeakMap=="function"?WeakMap:Map,Ee=0,Le=null,ge=null,be=0,ke=0,tn=null,si=!1,Ka=!1,Ng=!1,Cs=0,et=0,Ti=0,ir=0,kg=0,an=0,ka=0,Vo=null,qt=null,bm=!1,Vd=0,oE=0,Du=1/0,Lu=null,hi=null,ht=0,mi=null,Sa=null,Ns=0,vm=0,xm=null,lE=null,Fo=0,ym=null;function un(){return Ee&2&&be!==0?be&-be:ie.T!==null?Tg():b1()}function cE(){if(an===0)if(!(be&536870912)||ve){var t=Nc;Nc<<=1,!(Nc&3932160)&&(Nc=262144),an=t}else an=536870912;return t=fn.current,t!==null&&(t.flags|=32),an}function Jt(t,e,n){(t===Le&&(ke===2||ke===9)||t.cancelPendingCommit!==null)&&(Ta(t,0),ii(t,be,an,!1)),Gl(t,n),(!(Ee&2)||t!==Le)&&(t===Le&&(!(Ee&2)&&(ir|=n),et===4&&ii(t,be,an,!1)),rs(t))}function uE(t,e,n){if(Ee&6)throw Error(P(327));var s=!n&&(e&127)===0&&(e&t.expiredLanes)===0||Hl(t,e),i=s?EI(t,e):Qf(t,e,!0),r=s;do{if(i===0){Ka&&!s&&ii(t,e,0,!1);break}else{if(n=t.current.alternate,r&&!_I(n)){i=Qf(t,e,!1),r=!1;continue}if(i===2){if(r=e,t.errorRecoveryDisabledLanes&r)var a=0;else a=t.pendingLanes&-536870913,a=a!==0?a:a&536870912?536870912:0;if(a!==0){e=a;e:{var o=t;i=Vo;var c=o.current.memoizedState.isDehydrated;if(c&&(Ta(o,a).flags|=256),a=Qf(o,a,!1),a!==2){if(Ng&&!c){o.errorRecoveryDisabledLanes|=r,ir|=r,i=4;break e}r=qt,qt=i,r!==null&&(qt===null?qt=r:qt.push.apply(qt,r))}i=a}if(r=!1,i!==2)continue}}if(i===1){Ta(t,0),ii(t,e,0,!0);break}e:{switch(s=t,r=i,r){case 0:case 1:throw Error(P(345));case 4:if((e&4194048)!==e)break;case 6:ii(s,e,an,!si);break e;case 2:qt=null;break;case 3:case 5:break;default:throw Error(P(329))}if((e&62914560)===e&&(i=Vd+300-on(),10<i)){if(ii(s,e,an,!si),Cd(s,0,!0)!==0)break e;Ns=e,s.timeoutHandle=IE(bv.bind(null,s,n,qt,Lu,bm,e,an,ir,ka,si,r,"Throttled",-0,0),i);break e}bv(s,n,qt,Lu,bm,e,an,ir,ka,si,r,null,-0,0)}}break}while(!0);rs(t)}function bv(t,e,n,s,i,r,a,o,c,u,d,f,h,m){if(t.timeoutHandle=-1,f=e.subtreeFlags,f&8192||(f&16785408)===16785408){f={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:gs},sE(e,r,f);var g=(r&62914560)===r?Vd-on():(r&4194048)===r?oE-on():0;if(g=rC(f,g),g!==null){Ns=r,t.cancelPendingCommit=g(xv.bind(null,t,e,r,n,s,i,a,o,c,d,f,null,h,m)),ii(t,r,a,!u);return}}xv(t,e,r,n,s,i,a,o,c)}function _I(t){for(var e=t;;){var n=e.tag;if((n===0||n===11||n===15)&&e.flags&16384&&(n=e.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var s=0;s<n.length;s++){var i=n[s],r=i.getSnapshot;i=i.value;try{if(!dn(r(),i))return!1}catch{return!1}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ii(t,e,n,s){e&=~kg,e&=~ir,t.suspendedLanes|=e,t.pingedLanes&=~e,s&&(t.warmLanes|=e),s=t.expirationTimes;for(var i=e;0<i;){var r=31-cn(i),a=1<<r;s[r]=-1,i&=~a}n!==0&&m1(t,n,e)}function Fd(){return Ee&6?!0:(Yl(0),!1)}function Sg(){if(ge!==null){if(ke===0)var t=ge.return;else t=ge,bs=Sr=null,dg(t),la=null,ll=0,t=ge;for(;t!==null;)Fw(t.alternate,t),t=t.return;ge=null}}function Ta(t,e){var n=t.timeoutHandle;n!==-1&&(t.timeoutHandle=-1,GI(n)),n=t.cancelPendingCommit,n!==null&&(t.cancelPendingCommit=null,n()),Ns=0,Sg(),Le=t,ge=n=ws(t.current,null),be=e,ke=0,tn=null,si=!1,Ka=Hl(t,e),Ng=!1,ka=an=kg=ir=Ti=et=0,qt=Vo=null,bm=!1,e&8&&(e|=e&32);var s=t.entangledLanes;if(s!==0)for(t=t.entanglements,s&=e;0<s;){var i=31-cn(s),r=1<<i;e|=t[i],s&=~r}return Cs=e,Dd(),n}function dE(t,e){ce=null,ie.H=ul,e===$a||e===Pd?(e=Wb(),ke=3):e===ig?(e=Wb(),ke=4):ke=e===yg?8:e!==null&&typeof e=="object"&&typeof e.then=="function"?6:1,tn=e,ge===null&&(et=1,ju(t,wn(e,t.current)))}function fE(){var t=fn.current;return t===null?!0:(be&4194048)===be?Sn===null:(be&62914560)===be||be&536870912?t===Sn:!1}function hE(){var t=ie.H;return ie.H=ul,t===null?ul:t}function mE(){var t=ie.A;return ie.A=xI,t}function Pu(){et=4,si||(be&4194048)!==be&&fn.current!==null||(Ka=!0),!(Ti&134217727)&&!(ir&134217727)||Le===null||ii(Le,be,an,!1)}function Qf(t,e,n){var s=Ee;Ee|=2;var i=hE(),r=mE();(Le!==t||be!==e)&&(Lu=null,Ta(t,e)),e=!1;var a=et;e:do try{if(ke!==0&&ge!==null){var o=ge,c=tn;switch(ke){case 8:Sg(),a=6;break e;case 3:case 2:case 9:case 6:fn.current===null&&(e=!0);var u=ke;if(ke=0,tn=null,Xr(t,o,c,u),n&&Ka){a=0;break e}break;default:u=ke,ke=0,tn=null,Xr(t,o,c,u)}}wI(),a=et;break}catch(d){dE(t,d)}while(!0);return e&&t.shellSuspendCounter++,bs=Sr=null,Ee=s,ie.H=i,ie.A=r,ge===null&&(Le=null,be=0,Dd()),a}function wI(){for(;ge!==null;)pE(ge)}function EI(t,e){var n=Ee;Ee|=2;var s=hE(),i=mE();Le!==t||be!==e?(Lu=null,Du=on()+500,Ta(t,e)):Ka=Hl(t,e);e:do try{if(ke!==0&&ge!==null){e=ge;var r=tn;t:switch(ke){case 1:ke=0,tn=null,Xr(t,e,r,1);break;case 2:case 9:if(qb(r)){ke=0,tn=null,vv(e);break}e=function(){ke!==2&&ke!==9||Le!==t||(ke=7),rs(t)},r.then(e,e);break e;case 3:ke=7;break e;case 4:ke=5;break e;case 7:qb(r)?(ke=0,tn=null,vv(e)):(ke=0,tn=null,Xr(t,e,r,7));break;case 5:var a=null;switch(ge.tag){case 26:a=ge.memoizedState;case 5:case 27:var o=ge;if(a?DE(a):o.stateNode.complete){ke=0,tn=null;var c=o.sibling;if(c!==null)ge=c;else{var u=o.return;u!==null?(ge=u,zd(u)):ge=null}break t}}ke=0,tn=null,Xr(t,e,r,5);break;case 6:ke=0,tn=null,Xr(t,e,r,6);break;case 8:Sg(),et=6;break e;default:throw Error(P(462))}}NI();break}catch(d){dE(t,d)}while(!0);return bs=Sr=null,ie.H=s,ie.A=i,Ee=n,ge!==null?0:(Le=null,be=0,Dd(),et)}function NI(){for(;ge!==null&&!YA();)pE(ge)}function pE(t){var e=Vw(t.alternate,t,Cs);t.memoizedProps=t.pendingProps,e===null?zd(t):ge=e}function vv(t){var e=t,n=e.alternate;switch(e.tag){case 15:case 0:e=dv(n,e,e.pendingProps,e.type,void 0,be);break;case 11:e=dv(n,e,e.pendingProps,e.type.render,e.ref,be);break;case 5:dg(e);default:Fw(n,e),e=ge=F1(e,Cs),e=Vw(n,e,Cs)}t.memoizedProps=t.pendingProps,e===null?zd(t):ge=e}function Xr(t,e,n,s){bs=Sr=null,dg(e),la=null,ll=0;var i=e.return;try{if(fI(t,i,e,n,be)){et=1,ju(t,wn(n,t.current)),ge=null;return}}catch(r){if(i!==null)throw ge=i,r;et=1,ju(t,wn(n,t.current)),ge=null;return}e.flags&32768?(ve||s===1?t=!0:Ka||be&536870912?t=!1:(si=t=!0,(s===2||s===9||s===3||s===6)&&(s=fn.current,s!==null&&s.tag===13&&(s.flags|=16384))),gE(e,t)):zd(e)}function zd(t){var e=t;do{if(e.flags&32768){gE(e,si);return}t=e.return;var n=pI(e.alternate,e,Cs);if(n!==null){ge=n;return}if(e=e.sibling,e!==null){ge=e;return}ge=e=t}while(e!==null);et===0&&(et=5)}function gE(t,e){do{var n=gI(t.alternate,t);if(n!==null){n.flags&=32767,ge=n;return}if(n=t.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!e&&(t=t.sibling,t!==null)){ge=t;return}ge=t=n}while(t!==null);et=6,ge=null}function xv(t,e,n,s,i,r,a,o,c){t.cancelPendingCommit=null;do $d();while(ht!==0);if(Ee&6)throw Error(P(327));if(e!==null){if(e===t.current)throw Error(P(177));if(r=e.lanes|e.childLanes,r|=Qp,sR(t,n,r,a,o,c),t===Le&&(ge=Le=null,be=0),Sa=e,mi=t,Ns=n,vm=r,xm=i,lE=s,e.subtreeFlags&10256||e.flags&10256?(t.callbackNode=null,t.callbackPriority=0,AI(_u,function(){return _E(),null})):(t.callbackNode=null,t.callbackPriority=0),s=(e.flags&13878)!==0,e.subtreeFlags&13878||s){s=ie.T,ie.T=null,i=Ne.p,Ne.p=2,a=Ee,Ee|=4;try{bI(t,e,n)}finally{Ee=a,Ne.p=i,ie.T=s}}ht=1,bE(),vE(),xE()}}function bE(){if(ht===1){ht=0;var t=mi,e=Sa,n=(e.flags&13878)!==0;if(e.subtreeFlags&13878||n){n=ie.T,ie.T=null;var s=Ne.p;Ne.p=2;var i=Ee;Ee|=4;try{eE(e,t);var r=Nm,a=D1(t.containerInfo),o=r.focusedElem,c=r.selectionRange;if(a!==o&&o&&o.ownerDocument&&M1(o.ownerDocument.documentElement,o)){if(c!==null&&Xp(o)){var u=c.start,d=c.end;if(d===void 0&&(d=u),"selectionStart"in o)o.selectionStart=u,o.selectionEnd=Math.min(d,o.value.length);else{var f=o.ownerDocument||document,h=f&&f.defaultView||window;if(h.getSelection){var m=h.getSelection(),g=o.textContent.length,v=Math.min(c.start,g),x=c.end===void 0?v:Math.min(c.end,g);!m.extend&&v>x&&(a=x,x=v,v=a);var p=Gb(o,v),b=Gb(o,x);if(p&&b&&(m.rangeCount!==1||m.anchorNode!==p.node||m.anchorOffset!==p.offset||m.focusNode!==b.node||m.focusOffset!==b.offset)){var y=f.createRange();y.setStart(p.node,p.offset),m.removeAllRanges(),v>x?(m.addRange(y),m.extend(b.node,b.offset)):(y.setEnd(b.node,b.offset),m.addRange(y))}}}}for(f=[],m=o;m=m.parentNode;)m.nodeType===1&&f.push({element:m,left:m.scrollLeft,top:m.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<f.length;o++){var E=f[o];E.element.scrollLeft=E.left,E.element.scrollTop=E.top}}$u=!!Em,Nm=Em=null}finally{Ee=i,Ne.p=s,ie.T=n}}t.current=e,ht=2}}function vE(){if(ht===2){ht=0;var t=mi,e=Sa,n=(e.flags&8772)!==0;if(e.subtreeFlags&8772||n){n=ie.T,ie.T=null;var s=Ne.p;Ne.p=2;var i=Ee;Ee|=4;try{Ww(t,e.alternate,e)}finally{Ee=i,Ne.p=s,ie.T=n}}ht=3}}function xE(){if(ht===4||ht===3){ht=0,qA();var t=mi,e=Sa,n=Ns,s=lE;e.subtreeFlags&10256||e.flags&10256?ht=5:(ht=0,Sa=mi=null,yE(t,t.pendingLanes));var i=t.pendingLanes;if(i===0&&(hi=null),Fp(n),e=e.stateNode,ln&&typeof ln.onCommitFiberRoot=="function")try{ln.onCommitFiberRoot(Ul,e,void 0,(e.current.flags&128)===128)}catch{}if(s!==null){e=ie.T,i=Ne.p,Ne.p=2,ie.T=null;try{for(var r=t.onRecoverableError,a=0;a<s.length;a++){var o=s[a];r(o.value,{componentStack:o.stack})}}finally{ie.T=e,Ne.p=i}}Ns&3&&$d(),rs(t),i=t.pendingLanes,n&261930&&i&42?t===ym?Fo++:(Fo=0,ym=t):Fo=0,Yl(0)}}function yE(t,e){(t.pooledCacheLanes&=e)===0&&(e=t.pooledCache,e!=null&&(t.pooledCache=null,zl(e)))}function $d(){return bE(),vE(),xE(),_E()}function _E(){if(ht!==5)return!1;var t=mi,e=vm;vm=0;var n=Fp(Ns),s=ie.T,i=Ne.p;try{Ne.p=32>n?32:n,ie.T=null,n=xm,xm=null;var r=mi,a=Ns;if(ht=0,Sa=mi=null,Ns=0,Ee&6)throw Error(P(331));var o=Ee;if(Ee|=4,rE(r.current),nE(r,r.current,a,n),Ee=o,Yl(0,!1),ln&&typeof ln.onPostCommitFiberRoot=="function")try{ln.onPostCommitFiberRoot(Ul,r)}catch{}return!0}finally{Ne.p=i,ie.T=s,yE(t,e)}}function yv(t,e,n){e=wn(n,e),e=hm(t.stateNode,e,2),t=fi(t,e,2),t!==null&&(Gl(t,2),rs(t))}function Se(t,e,n){if(t.tag===3)yv(t,t,n);else for(;e!==null;){if(e.tag===3){yv(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(hi===null||!hi.has(s))){t=wn(n,t),n=Lw(2),s=fi(e,n,2),s!==null&&(Pw(n,s,e,t),Gl(s,2),rs(s));break}}e=e.return}}function Jf(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new yI;var i=new Set;s.set(e,i)}else i=s.get(e),i===void 0&&(i=new Set,s.set(e,i));i.has(n)||(Ng=!0,i.add(n),t=kI.bind(null,t,e,n),e.then(t,t))}function kI(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),t.pingedLanes|=t.suspendedLanes&n,t.warmLanes&=~n,Le===t&&(be&n)===n&&(et===4||et===3&&(be&62914560)===be&&300>on()-Vd?!(Ee&2)&&Ta(t,0):kg|=n,ka===be&&(ka=0)),rs(t)}function wE(t,e){e===0&&(e=h1()),t=kr(t,e),t!==null&&(Gl(t,e),rs(t))}function SI(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),wE(t,n)}function TI(t,e){var n=0;switch(t.tag){case 31:case 13:var s=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:s=t.stateNode;break;case 22:s=t.stateNode._retryCache;break;default:throw Error(P(314))}s!==null&&s.delete(e),wE(t,n)}function AI(t,e){return Gp(t,e)}var Bu=null,Br=null,_m=!1,Uu=!1,Zf=!1,ri=0;function rs(t){t!==Br&&t.next===null&&(Br===null?Bu=Br=t:Br=Br.next=t),Uu=!0,_m||(_m=!0,II())}function Yl(t,e){if(!Zf&&Uu){Zf=!0;do for(var n=!1,s=Bu;s!==null;){if(t!==0){var i=s.pendingLanes;if(i===0)var r=0;else{var a=s.suspendedLanes,o=s.pingedLanes;r=(1<<31-cn(42|t)+1)-1,r&=i&~(a&~o),r=r&201326741?r&201326741|1:r?r|2:0}r!==0&&(n=!0,_v(s,r))}else r=be,r=Cd(s,s===Le?r:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),!(r&3)||Hl(s,r)||(n=!0,_v(s,r));s=s.next}while(n);Zf=!1}}function RI(){EE()}function EE(){Uu=_m=!1;var t=0;ri!==0&&HI()&&(t=ri);for(var e=on(),n=null,s=Bu;s!==null;){var i=s.next,r=NE(s,e);r===0?(s.next=null,n===null?Bu=i:n.next=i,i===null&&(Br=n)):(n=s,(t!==0||r&3)&&(Uu=!0)),s=i}ht!==0&&ht!==5||Yl(t),ri!==0&&(ri=0)}function NE(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,i=t.expirationTimes,r=t.pendingLanes&-62914561;0<r;){var a=31-cn(r),o=1<<a,c=i[a];c===-1?(!(o&n)||o&s)&&(i[a]=nR(o,e)):c<=e&&(t.expiredLanes|=o),r&=~o}if(e=Le,n=be,n=Cd(t,t===e?n:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),s=t.callbackNode,n===0||t===e&&(ke===2||ke===9)||t.cancelPendingCommit!==null)return s!==null&&s!==null&&Tf(s),t.callbackNode=null,t.callbackPriority=0;if(!(n&3)||Hl(t,n)){if(e=n&-n,e===t.callbackPriority)return e;switch(s!==null&&Tf(s),Fp(n)){case 2:case 8:n=d1;break;case 32:n=_u;break;case 268435456:n=f1;break;default:n=_u}return s=kE.bind(null,t),n=Gp(n,s),t.callbackPriority=e,t.callbackNode=n,e}return s!==null&&s!==null&&Tf(s),t.callbackPriority=2,t.callbackNode=null,2}function kE(t,e){if(ht!==0&&ht!==5)return t.callbackNode=null,t.callbackPriority=0,null;var n=t.callbackNode;if($d()&&t.callbackNode!==n)return null;var s=be;return s=Cd(t,t===Le?s:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),s===0?null:(uE(t,s,e),NE(t,on()),t.callbackNode!=null&&t.callbackNode===n?kE.bind(null,t):null)}function _v(t,e){if($d())return null;uE(t,e,!0)}function II(){VI(function(){Ee&6?Gp(u1,RI):EE()})}function Tg(){if(ri===0){var t=wa;t===0&&(t=Ec,Ec<<=1,!(Ec&261888)&&(Ec=256)),ri=t}return ri}function wv(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:Wc(""+t)}function Ev(t,e){var n=e.ownerDocument.createElement("input");return n.name=e.name,n.value=e.value,t.id&&n.setAttribute("form",t.id),e.parentNode.insertBefore(n,e),t=new FormData(t),n.parentNode.removeChild(n),t}function CI(t,e,n,s,i){if(e==="submit"&&n&&n.stateNode===i){var r=wv((i[Zt]||null).action),a=s.submitter;a&&(e=(e=a[Zt]||null)?wv(e.formAction):a.getAttribute("formAction"),e!==null&&(r=e,a=null));var o=new jd("action","action",null,s,i);t.push({event:o,listeners:[{instance:null,listener:function(){if(s.defaultPrevented){if(ri!==0){var c=a?Ev(i,a):new FormData(i);dm(n,{pending:!0,data:c,method:i.method,action:r},null,c)}}else typeof r=="function"&&(o.preventDefault(),c=a?Ev(i,a):new FormData(i),dm(n,{pending:!0,data:c,method:i.method,action:r},r,c))},currentTarget:i}]})}}for(var eh=0;eh<Zh.length;eh++){var th=Zh[eh],jI=th.toLowerCase(),OI=th[0].toUpperCase()+th.slice(1);zn(jI,"on"+OI)}zn(P1,"onAnimationEnd");zn(B1,"onAnimationIteration");zn(U1,"onAnimationStart");zn("dblclick","onDoubleClick");zn("focusin","onFocus");zn("focusout","onBlur");zn(WR,"onTransitionRun");zn(XR,"onTransitionStart");zn(QR,"onTransitionCancel");zn(H1,"onTransitionEnd");ya("onMouseEnter",["mouseout","mouseover"]);ya("onMouseLeave",["mouseout","mouseover"]);ya("onPointerEnter",["pointerout","pointerover"]);ya("onPointerLeave",["pointerout","pointerover"]);wr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));wr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));wr("onBeforeInput",["compositionend","keypress","textInput","paste"]);wr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));wr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));wr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var dl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),MI=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(dl));function SE(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],i=s.event;s=s.listeners;e:{var r=void 0;if(e)for(var a=s.length-1;0<=a;a--){var o=s[a],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==r&&i.isPropagationStopped())break e;r=o,i.currentTarget=u;try{r(i)}catch(d){Eu(d)}i.currentTarget=null,r=c}else for(a=0;a<s.length;a++){if(o=s[a],c=o.instance,u=o.currentTarget,o=o.listener,c!==r&&i.isPropagationStopped())break e;r=o,i.currentTarget=u;try{r(i)}catch(d){Eu(d)}i.currentTarget=null,r=c}}}}function pe(t,e){var n=e[$h];n===void 0&&(n=e[$h]=new Set);var s=t+"__bubble";n.has(s)||(TE(e,t,2,!1),n.add(s))}function nh(t,e,n){var s=0;e&&(s|=4),TE(n,t,s,e)}var Oc="_reactListening"+Math.random().toString(36).slice(2);function Ag(t){if(!t[Oc]){t[Oc]=!0,v1.forEach(function(n){n!=="selectionchange"&&(MI.has(n)||nh(n,!1,t),nh(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Oc]||(e[Oc]=!0,nh("selectionchange",!1,e))}}function TE(t,e,n,s){switch(HE(e)){case 2:var i=lC;break;case 8:i=cC;break;default:i=jg}n=i.bind(null,e,n,t),i=void 0,!Xh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),s?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function sh(t,e,n,s,i){var r=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var a=s.tag;if(a===3||a===4){var o=s.stateNode.containerInfo;if(o===i)break;if(a===4)for(a=s.return;a!==null;){var c=a.tag;if((c===3||c===4)&&a.stateNode.containerInfo===i)return;a=a.return}for(;o!==null;){if(a=Gr(o),a===null)return;if(c=a.tag,c===5||c===6||c===26||c===27){s=r=a;continue e}o=o.parentNode}}s=s.return}S1(function(){var u=r,d=Kp(n),f=[];e:{var h=G1.get(t);if(h!==void 0){var m=jd,g=t;switch(t){case"keypress":if(Qc(n)===0)break e;case"keydown":case"keyup":m=TR;break;case"focusin":g="focus",m=jf;break;case"focusout":g="blur",m=jf;break;case"beforeblur":case"afterblur":m=jf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Cb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=pR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=IR;break;case P1:case B1:case U1:m=vR;break;case H1:m=jR;break;case"scroll":case"scrollend":m=hR;break;case"wheel":m=MR;break;case"copy":case"cut":case"paste":m=yR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Ob;break;case"toggle":case"beforetoggle":m=LR}var v=(e&4)!==0,x=!v&&(t==="scroll"||t==="scrollend"),p=v?h!==null?h+"Capture":null:h;v=[];for(var b=u,y;b!==null;){var E=b;if(y=E.stateNode,E=E.tag,E!==5&&E!==26&&E!==27||y===null||p===null||(E=sl(b,p),E!=null&&v.push(fl(b,E,y))),x)break;b=b.return}0<v.length&&(h=new m(h,g,null,n,d),f.push({event:h,listeners:v}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",h&&n!==Wh&&(g=n.relatedTarget||n.fromElement)&&(Gr(g)||g[Va]))break e;if((m||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,m?(g=n.relatedTarget||n.toElement,m=u,g=g?Gr(g):null,g!==null&&(x=Bl(g),v=g.tag,g!==x||v!==5&&v!==27&&v!==6)&&(g=null)):(m=null,g=u),m!==g)){if(v=Cb,E="onMouseLeave",p="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(v=Ob,E="onPointerLeave",p="onPointerEnter",b="pointer"),x=m==null?h:No(m),y=g==null?h:No(g),h=new v(E,b+"leave",m,n,d),h.target=x,h.relatedTarget=y,E=null,Gr(d)===u&&(v=new v(p,b+"enter",g,n,d),v.target=y,v.relatedTarget=x,E=v),x=E,m&&g)t:{for(v=DI,p=m,b=g,y=0,E=p;E;E=v(E))y++;E=0;for(var N=b;N;N=v(N))E++;for(;0<y-E;)p=v(p),y--;for(;0<E-y;)b=v(b),E--;for(;y--;){if(p===b||b!==null&&p===b.alternate){v=p;break t}p=v(p),b=v(b)}v=null}else v=null;m!==null&&Nv(f,h,m,v,!1),g!==null&&x!==null&&Nv(f,x,g,v,!0)}}e:{if(h=u?No(u):window,m=h.nodeName&&h.nodeName.toLowerCase(),m==="select"||m==="input"&&h.type==="file")var A=Pb;else if(Lb(h))if(j1)A=KR;else{A=zR;var w=FR}else m=h.nodeName,!m||m.toLowerCase()!=="input"||h.type!=="checkbox"&&h.type!=="radio"?u&&$p(u.elementType)&&(A=Pb):A=$R;if(A&&(A=A(t,u))){C1(f,A,n,d);break e}w&&w(t,h,u),t==="focusout"&&u&&h.type==="number"&&u.memoizedProps.value!=null&&qh(h,"number",h.value)}switch(w=u?No(u):window,t){case"focusin":(Lb(w)||w.contentEditable==="true")&&(zr=w,Qh=u,Mo=null);break;case"focusout":Mo=Qh=zr=null;break;case"mousedown":Jh=!0;break;case"contextmenu":case"mouseup":case"dragend":Jh=!1,Vb(f,n,d);break;case"selectionchange":if(qR)break;case"keydown":case"keyup":Vb(f,n,d)}var T;if(Wp)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else Fr?R1(t,n)&&(k="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&(A1&&n.locale!=="ko"&&(Fr||k!=="onCompositionStart"?k==="onCompositionEnd"&&Fr&&(T=T1()):(ni=d,Yp="value"in ni?ni.value:ni.textContent,Fr=!0)),w=Hu(u,k),0<w.length&&(k=new jb(k,t,null,n,d),f.push({event:k,listeners:w}),T?k.data=T:(T=I1(n),T!==null&&(k.data=T)))),(T=BR?UR(t,n):HR(t,n))&&(k=Hu(u,"onBeforeInput"),0<k.length&&(w=new jb("onBeforeInput","beforeinput",null,n,d),f.push({event:w,listeners:k}),w.data=T)),CI(f,t,u,n,d)}SE(f,e)})}function fl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Hu(t,e){for(var n=e+"Capture",s=[];t!==null;){var i=t,r=i.stateNode;if(i=i.tag,i!==5&&i!==26&&i!==27||r===null||(i=sl(t,n),i!=null&&s.unshift(fl(t,i,r)),i=sl(t,e),i!=null&&s.push(fl(t,i,r))),t.tag===3)return s;t=t.return}return[]}function DI(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function Nv(t,e,n,s,i){for(var r=e._reactName,a=[];n!==null&&n!==s;){var o=n,c=o.alternate,u=o.stateNode;if(o=o.tag,c!==null&&c===s)break;o!==5&&o!==26&&o!==27||u===null||(c=u,i?(u=sl(n,r),u!=null&&a.unshift(fl(n,u,c))):i||(u=sl(n,r),u!=null&&a.push(fl(n,u,c)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var LI=/\r\n?/g,PI=/\u0000|\uFFFD/g;function kv(t){return(typeof t=="string"?t:""+t).replace(LI,`
`).replace(PI,"")}function AE(t,e){return e=kv(e),kv(t)===e}function Ce(t,e,n,s,i,r){switch(n){case"children":typeof s=="string"?e==="body"||e==="textarea"&&s===""||_a(t,s):(typeof s=="number"||typeof s=="bigint")&&e!=="body"&&_a(t,""+s);break;case"className":Sc(t,"class",s);break;case"tabIndex":Sc(t,"tabindex",s);break;case"dir":case"role":case"viewBox":case"width":case"height":Sc(t,n,s);break;case"style":k1(t,s,r);break;case"data":if(e!=="object"){Sc(t,"data",s);break}case"src":case"href":if(s===""&&(e!=="a"||n!=="href")){t.removeAttribute(n);break}if(s==null||typeof s=="function"||typeof s=="symbol"||typeof s=="boolean"){t.removeAttribute(n);break}s=Wc(""+s),t.setAttribute(n,s);break;case"action":case"formAction":if(typeof s=="function"){t.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof r=="function"&&(n==="formAction"?(e!=="input"&&Ce(t,e,"name",i.name,i,null),Ce(t,e,"formEncType",i.formEncType,i,null),Ce(t,e,"formMethod",i.formMethod,i,null),Ce(t,e,"formTarget",i.formTarget,i,null)):(Ce(t,e,"encType",i.encType,i,null),Ce(t,e,"method",i.method,i,null),Ce(t,e,"target",i.target,i,null)));if(s==null||typeof s=="symbol"||typeof s=="boolean"){t.removeAttribute(n);break}s=Wc(""+s),t.setAttribute(n,s);break;case"onClick":s!=null&&(t.onclick=gs);break;case"onScroll":s!=null&&pe("scroll",t);break;case"onScrollEnd":s!=null&&pe("scrollend",t);break;case"dangerouslySetInnerHTML":if(s!=null){if(typeof s!="object"||!("__html"in s))throw Error(P(61));if(n=s.__html,n!=null){if(i.children!=null)throw Error(P(60));t.innerHTML=n}}break;case"multiple":t.multiple=s&&typeof s!="function"&&typeof s!="symbol";break;case"muted":t.muted=s&&typeof s!="function"&&typeof s!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(s==null||typeof s=="function"||typeof s=="boolean"||typeof s=="symbol"){t.removeAttribute("xlink:href");break}n=Wc(""+s),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":s!=null&&typeof s!="function"&&typeof s!="symbol"?t.setAttribute(n,""+s):t.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":s&&typeof s!="function"&&typeof s!="symbol"?t.setAttribute(n,""):t.removeAttribute(n);break;case"capture":case"download":s===!0?t.setAttribute(n,""):s!==!1&&s!=null&&typeof s!="function"&&typeof s!="symbol"?t.setAttribute(n,s):t.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":s!=null&&typeof s!="function"&&typeof s!="symbol"&&!isNaN(s)&&1<=s?t.setAttribute(n,s):t.removeAttribute(n);break;case"rowSpan":case"start":s==null||typeof s=="function"||typeof s=="symbol"||isNaN(s)?t.removeAttribute(n):t.setAttribute(n,s);break;case"popover":pe("beforetoggle",t),pe("toggle",t),qc(t,"popover",s);break;case"xlinkActuate":os(t,"http://www.w3.org/1999/xlink","xlink:actuate",s);break;case"xlinkArcrole":os(t,"http://www.w3.org/1999/xlink","xlink:arcrole",s);break;case"xlinkRole":os(t,"http://www.w3.org/1999/xlink","xlink:role",s);break;case"xlinkShow":os(t,"http://www.w3.org/1999/xlink","xlink:show",s);break;case"xlinkTitle":os(t,"http://www.w3.org/1999/xlink","xlink:title",s);break;case"xlinkType":os(t,"http://www.w3.org/1999/xlink","xlink:type",s);break;case"xmlBase":os(t,"http://www.w3.org/XML/1998/namespace","xml:base",s);break;case"xmlLang":os(t,"http://www.w3.org/XML/1998/namespace","xml:lang",s);break;case"xmlSpace":os(t,"http://www.w3.org/XML/1998/namespace","xml:space",s);break;case"is":qc(t,"is",s);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=dR.get(n)||n,qc(t,n,s))}}function wm(t,e,n,s,i,r){switch(n){case"style":k1(t,s,r);break;case"dangerouslySetInnerHTML":if(s!=null){if(typeof s!="object"||!("__html"in s))throw Error(P(61));if(n=s.__html,n!=null){if(i.children!=null)throw Error(P(60));t.innerHTML=n}}break;case"children":typeof s=="string"?_a(t,s):(typeof s=="number"||typeof s=="bigint")&&_a(t,""+s);break;case"onScroll":s!=null&&pe("scroll",t);break;case"onScrollEnd":s!=null&&pe("scrollend",t);break;case"onClick":s!=null&&(t.onclick=gs);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!x1.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(i=n.endsWith("Capture"),e=n.slice(2,i?n.length-7:void 0),r=t[Zt]||null,r=r!=null?r[n]:null,typeof r=="function"&&t.removeEventListener(e,r,i),typeof s=="function")){typeof r!="function"&&r!==null&&(n in t?t[n]=null:t.hasAttribute(n)&&t.removeAttribute(n)),t.addEventListener(e,s,i);break e}n in t?t[n]=s:s===!0?t.setAttribute(n,""):qc(t,n,s)}}}function Ct(t,e,n){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":pe("error",t),pe("load",t);var s=!1,i=!1,r;for(r in n)if(n.hasOwnProperty(r)){var a=n[r];if(a!=null)switch(r){case"src":s=!0;break;case"srcSet":i=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(P(137,e));default:Ce(t,e,r,a,n,null)}}i&&Ce(t,e,"srcSet",n.srcSet,n,null),s&&Ce(t,e,"src",n.src,n,null);return;case"input":pe("invalid",t);var o=r=a=i=null,c=null,u=null;for(s in n)if(n.hasOwnProperty(s)){var d=n[s];if(d!=null)switch(s){case"name":i=d;break;case"type":a=d;break;case"checked":c=d;break;case"defaultChecked":u=d;break;case"value":r=d;break;case"defaultValue":o=d;break;case"children":case"dangerouslySetInnerHTML":if(d!=null)throw Error(P(137,e));break;default:Ce(t,e,s,d,n,null)}}w1(t,r,o,c,u,a,i,!1);return;case"select":pe("invalid",t),s=a=r=null;for(i in n)if(n.hasOwnProperty(i)&&(o=n[i],o!=null))switch(i){case"value":r=o;break;case"defaultValue":a=o;break;case"multiple":s=o;default:Ce(t,e,i,o,n,null)}e=r,n=a,t.multiple=!!s,e!=null?ra(t,!!s,e,!1):n!=null&&ra(t,!!s,n,!0);return;case"textarea":pe("invalid",t),r=i=s=null;for(a in n)if(n.hasOwnProperty(a)&&(o=n[a],o!=null))switch(a){case"value":s=o;break;case"defaultValue":i=o;break;case"children":r=o;break;case"dangerouslySetInnerHTML":if(o!=null)throw Error(P(91));break;default:Ce(t,e,a,o,n,null)}N1(t,s,i,r);return;case"option":for(c in n)if(n.hasOwnProperty(c)&&(s=n[c],s!=null))switch(c){case"selected":t.selected=s&&typeof s!="function"&&typeof s!="symbol";break;default:Ce(t,e,c,s,n,null)}return;case"dialog":pe("beforetoggle",t),pe("toggle",t),pe("cancel",t),pe("close",t);break;case"iframe":case"object":pe("load",t);break;case"video":case"audio":for(s=0;s<dl.length;s++)pe(dl[s],t);break;case"image":pe("error",t),pe("load",t);break;case"details":pe("toggle",t);break;case"embed":case"source":case"link":pe("error",t),pe("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&(s=n[u],s!=null))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(P(137,e));default:Ce(t,e,u,s,n,null)}return;default:if($p(e)){for(d in n)n.hasOwnProperty(d)&&(s=n[d],s!==void 0&&wm(t,e,d,s,n,void 0));return}}for(o in n)n.hasOwnProperty(o)&&(s=n[o],s!=null&&Ce(t,e,o,s,n,null))}function BI(t,e,n,s){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,r=null,a=null,o=null,c=null,u=null,d=null;for(m in n){var f=n[m];if(n.hasOwnProperty(m)&&f!=null)switch(m){case"checked":break;case"value":break;case"defaultValue":c=f;default:s.hasOwnProperty(m)||Ce(t,e,m,null,s,f)}}for(var h in s){var m=s[h];if(f=n[h],s.hasOwnProperty(h)&&(m!=null||f!=null))switch(h){case"type":r=m;break;case"name":i=m;break;case"checked":u=m;break;case"defaultChecked":d=m;break;case"value":a=m;break;case"defaultValue":o=m;break;case"children":case"dangerouslySetInnerHTML":if(m!=null)throw Error(P(137,e));break;default:m!==f&&Ce(t,e,h,m,s,f)}}Yh(t,a,o,c,u,d,r,i);return;case"select":m=a=o=h=null;for(r in n)if(c=n[r],n.hasOwnProperty(r)&&c!=null)switch(r){case"value":break;case"multiple":m=c;default:s.hasOwnProperty(r)||Ce(t,e,r,null,s,c)}for(i in s)if(r=s[i],c=n[i],s.hasOwnProperty(i)&&(r!=null||c!=null))switch(i){case"value":h=r;break;case"defaultValue":o=r;break;case"multiple":a=r;default:r!==c&&Ce(t,e,i,r,s,c)}e=o,n=a,s=m,h!=null?ra(t,!!n,h,!1):!!s!=!!n&&(e!=null?ra(t,!!n,e,!0):ra(t,!!n,n?[]:"",!1));return;case"textarea":m=h=null;for(o in n)if(i=n[o],n.hasOwnProperty(o)&&i!=null&&!s.hasOwnProperty(o))switch(o){case"value":break;case"children":break;default:Ce(t,e,o,null,s,i)}for(a in s)if(i=s[a],r=n[a],s.hasOwnProperty(a)&&(i!=null||r!=null))switch(a){case"value":h=i;break;case"defaultValue":m=i;break;case"children":break;case"dangerouslySetInnerHTML":if(i!=null)throw Error(P(91));break;default:i!==r&&Ce(t,e,a,i,s,r)}E1(t,h,m);return;case"option":for(var g in n)if(h=n[g],n.hasOwnProperty(g)&&h!=null&&!s.hasOwnProperty(g))switch(g){case"selected":t.selected=!1;break;default:Ce(t,e,g,null,s,h)}for(c in s)if(h=s[c],m=n[c],s.hasOwnProperty(c)&&h!==m&&(h!=null||m!=null))switch(c){case"selected":t.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:Ce(t,e,c,h,s,m)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var v in n)h=n[v],n.hasOwnProperty(v)&&h!=null&&!s.hasOwnProperty(v)&&Ce(t,e,v,null,s,h);for(u in s)if(h=s[u],m=n[u],s.hasOwnProperty(u)&&h!==m&&(h!=null||m!=null))switch(u){case"children":case"dangerouslySetInnerHTML":if(h!=null)throw Error(P(137,e));break;default:Ce(t,e,u,h,s,m)}return;default:if($p(e)){for(var x in n)h=n[x],n.hasOwnProperty(x)&&h!==void 0&&!s.hasOwnProperty(x)&&wm(t,e,x,void 0,s,h);for(d in s)h=s[d],m=n[d],!s.hasOwnProperty(d)||h===m||h===void 0&&m===void 0||wm(t,e,d,h,s,m);return}}for(var p in n)h=n[p],n.hasOwnProperty(p)&&h!=null&&!s.hasOwnProperty(p)&&Ce(t,e,p,null,s,h);for(f in s)h=s[f],m=n[f],!s.hasOwnProperty(f)||h===m||h==null&&m==null||Ce(t,e,f,h,s,m)}function Sv(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function UI(){if(typeof performance.getEntriesByType=="function"){for(var t=0,e=0,n=performance.getEntriesByType("resource"),s=0;s<n.length;s++){var i=n[s],r=i.transferSize,a=i.initiatorType,o=i.duration;if(r&&o&&Sv(a)){for(a=0,o=i.responseEnd,s+=1;s<n.length;s++){var c=n[s],u=c.startTime;if(u>o)break;var d=c.transferSize,f=c.initiatorType;d&&Sv(f)&&(c=c.responseEnd,a+=d*(c<o?1:(o-u)/(c-u)))}if(--s,e+=8*(r+a)/(i.duration/1e3),t++,10<t)break}}if(0<t)return e/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var Em=null,Nm=null;function Gu(t){return t.nodeType===9?t:t.ownerDocument}function Tv(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function RE(t,e){if(t===0)switch(e){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&e==="foreignObject"?0:t}function km(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.children=="bigint"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ih=null;function HI(){var t=window.event;return t&&t.type==="popstate"?t===ih?!1:(ih=t,!0):(ih=null,!1)}var IE=typeof setTimeout=="function"?setTimeout:void 0,GI=typeof clearTimeout=="function"?clearTimeout:void 0,Av=typeof Promise=="function"?Promise:void 0,VI=typeof queueMicrotask=="function"?queueMicrotask:typeof Av<"u"?function(t){return Av.resolve(null).then(t).catch(FI)}:IE;function FI(t){setTimeout(function(){throw t})}function Li(t){return t==="head"}function Rv(t,e){var n=e,s=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"||n==="/&"){if(s===0){t.removeChild(i),Ra(e);return}s--}else if(n==="$"||n==="$?"||n==="$~"||n==="$!"||n==="&")s++;else if(n==="html")zo(t.ownerDocument.documentElement);else if(n==="head"){n=t.ownerDocument.head,zo(n);for(var r=n.firstChild;r;){var a=r.nextSibling,o=r.nodeName;r[Vl]||o==="SCRIPT"||o==="STYLE"||o==="LINK"&&r.rel.toLowerCase()==="stylesheet"||n.removeChild(r),r=a}}else n==="body"&&zo(t.ownerDocument.body);n=i}while(n);Ra(e)}function Iv(t,e){var n=t;t=0;do{var s=n.nextSibling;if(n.nodeType===1?e?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",n.getAttribute("style")===""&&n.removeAttribute("style")):n.nodeType===3&&(e?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(t===0)break;t--}else n!=="$"&&n!=="$?"&&n!=="$~"&&n!=="$!"||t++;n=s}while(n)}function Sm(t){var e=t.firstChild;for(e&&e.nodeType===10&&(e=e.nextSibling);e;){var n=e;switch(e=e.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":Sm(n),zp(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}t.removeChild(n)}}function zI(t,e,n,s){for(;t.nodeType===1;){var i=n;if(t.nodeName.toLowerCase()!==e.toLowerCase()){if(!s&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(s){if(!t[Vl])switch(e){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(r=t.getAttribute("rel"),r==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(r!==i.rel||t.getAttribute("href")!==(i.href==null||i.href===""?null:i.href)||t.getAttribute("crossorigin")!==(i.crossOrigin==null?null:i.crossOrigin)||t.getAttribute("title")!==(i.title==null?null:i.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(r=t.getAttribute("src"),(r!==(i.src==null?null:i.src)||t.getAttribute("type")!==(i.type==null?null:i.type)||t.getAttribute("crossorigin")!==(i.crossOrigin==null?null:i.crossOrigin))&&r&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(e==="input"&&t.type==="hidden"){var r=i.name==null?null:""+i.name;if(i.type==="hidden"&&t.getAttribute("name")===r)return t}else return t;if(t=Tn(t.nextSibling),t===null)break}return null}function $I(t,e,n){if(e==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!n||(t=Tn(t.nextSibling),t===null))return null;return t}function CE(t,e){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!e||(t=Tn(t.nextSibling),t===null))return null;return t}function Tm(t){return t.data==="$?"||t.data==="$~"}function Am(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function KI(t,e){var n=t.ownerDocument;if(t.data==="$~")t._reactRetry=e;else if(t.data!=="$?"||n.readyState!=="loading")e();else{var s=function(){e(),n.removeEventListener("DOMContentLoaded",s)};n.addEventListener("DOMContentLoaded",s),t._reactRetry=s}}function Tn(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?"||e==="$~"||e==="&"||e==="F!"||e==="F")break;if(e==="/$"||e==="/&")return null}}return t}var Rm=null;function Cv(t){t=t.nextSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"||n==="/&"){if(e===0)return Tn(t.nextSibling);e--}else n!=="$"&&n!=="$!"&&n!=="$?"&&n!=="$~"&&n!=="&"||e++}t=t.nextSibling}return null}function jv(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"){if(e===0)return t;e--}else n!=="/$"&&n!=="/&"||e++}t=t.previousSibling}return null}function jE(t,e,n){switch(e=Gu(n),t){case"html":if(t=e.documentElement,!t)throw Error(P(452));return t;case"head":if(t=e.head,!t)throw Error(P(453));return t;case"body":if(t=e.body,!t)throw Error(P(454));return t;default:throw Error(P(451))}}function zo(t){for(var e=t.attributes;e.length;)t.removeAttributeNode(e[0]);zp(t)}var Cn=new Map,Ov=new Set;function Vu(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var Bs=Ne.d;Ne.d={f:YI,r:qI,D:WI,C:XI,L:QI,m:JI,X:eC,S:ZI,M:tC};function YI(){var t=Bs.f(),e=Fd();return t||e}function qI(t){var e=Fa(t);e!==null&&e.tag===5&&e.type==="form"?kw(e):Bs.r(t)}var Ya=typeof document>"u"?null:document;function OE(t,e,n){var s=Ya;if(s&&typeof e=="string"&&e){var i=_n(e);i='link[rel="'+t+'"][href="'+i+'"]',typeof n=="string"&&(i+='[crossorigin="'+n+'"]'),Ov.has(i)||(Ov.add(i),t={rel:t,crossOrigin:n,href:e},s.querySelector(i)===null&&(e=s.createElement("link"),Ct(e,"link",t),yt(e),s.head.appendChild(e)))}}function WI(t){Bs.D(t),OE("dns-prefetch",t,null)}function XI(t,e){Bs.C(t,e),OE("preconnect",t,e)}function QI(t,e,n){Bs.L(t,e,n);var s=Ya;if(s&&t&&e){var i='link[rel="preload"][as="'+_n(e)+'"]';e==="image"&&n&&n.imageSrcSet?(i+='[imagesrcset="'+_n(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(i+='[imagesizes="'+_n(n.imageSizes)+'"]')):i+='[href="'+_n(t)+'"]';var r=i;switch(e){case"style":r=Aa(t);break;case"script":r=qa(t)}Cn.has(r)||(t=Fe({rel:"preload",href:e==="image"&&n&&n.imageSrcSet?void 0:t,as:e},n),Cn.set(r,t),s.querySelector(i)!==null||e==="style"&&s.querySelector(ql(r))||e==="script"&&s.querySelector(Wl(r))||(e=s.createElement("link"),Ct(e,"link",t),yt(e),s.head.appendChild(e)))}}function JI(t,e){Bs.m(t,e);var n=Ya;if(n&&t){var s=e&&typeof e.as=="string"?e.as:"script",i='link[rel="modulepreload"][as="'+_n(s)+'"][href="'+_n(t)+'"]',r=i;switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":r=qa(t)}if(!Cn.has(r)&&(t=Fe({rel:"modulepreload",href:t},e),Cn.set(r,t),n.querySelector(i)===null)){switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Wl(r)))return}s=n.createElement("link"),Ct(s,"link",t),yt(s),n.head.appendChild(s)}}}function ZI(t,e,n){Bs.S(t,e,n);var s=Ya;if(s&&t){var i=ia(s).hoistableStyles,r=Aa(t);e=e||"default";var a=i.get(r);if(!a){var o={loading:0,preload:null};if(a=s.querySelector(ql(r)))o.loading=5;else{t=Fe({rel:"stylesheet",href:t,"data-precedence":e},n),(n=Cn.get(r))&&Rg(t,n);var c=a=s.createElement("link");yt(c),Ct(c,"link",t),c._p=new Promise(function(u,d){c.onload=u,c.onerror=d}),c.addEventListener("load",function(){o.loading|=1}),c.addEventListener("error",function(){o.loading|=2}),o.loading|=4,ru(a,e,s)}a={type:"stylesheet",instance:a,count:1,state:o},i.set(r,a)}}}function eC(t,e){Bs.X(t,e);var n=Ya;if(n&&t){var s=ia(n).hoistableScripts,i=qa(t),r=s.get(i);r||(r=n.querySelector(Wl(i)),r||(t=Fe({src:t,async:!0},e),(e=Cn.get(i))&&Ig(t,e),r=n.createElement("script"),yt(r),Ct(r,"link",t),n.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},s.set(i,r))}}function tC(t,e){Bs.M(t,e);var n=Ya;if(n&&t){var s=ia(n).hoistableScripts,i=qa(t),r=s.get(i);r||(r=n.querySelector(Wl(i)),r||(t=Fe({src:t,async:!0,type:"module"},e),(e=Cn.get(i))&&Ig(t,e),r=n.createElement("script"),yt(r),Ct(r,"link",t),n.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},s.set(i,r))}}function Mv(t,e,n,s){var i=(i=ci.current)?Vu(i):null;if(!i)throw Error(P(446));switch(t){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(e=Aa(n.href),n=ia(i).hoistableStyles,s=n.get(e),s||(s={type:"style",instance:null,count:0,state:null},n.set(e,s)),s):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){t=Aa(n.href);var r=ia(i).hoistableStyles,a=r.get(t);if(a||(i=i.ownerDocument||i,a={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},r.set(t,a),(r=i.querySelector(ql(t)))&&!r._p&&(a.instance=r,a.state.loading=5),Cn.has(t)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Cn.set(t,n),r||nC(i,t,n,a.state))),e&&s===null)throw Error(P(528,""));return a}if(e&&s!==null)throw Error(P(529,""));return null;case"script":return e=n.async,n=n.src,typeof n=="string"&&e&&typeof e!="function"&&typeof e!="symbol"?(e=qa(n),n=ia(i).hoistableScripts,s=n.get(e),s||(s={type:"script",instance:null,count:0,state:null},n.set(e,s)),s):{type:"void",instance:null,count:0,state:null};default:throw Error(P(444,t))}}function Aa(t){return'href="'+_n(t)+'"'}function ql(t){return'link[rel="stylesheet"]['+t+"]"}function ME(t){return Fe({},t,{"data-precedence":t.precedence,precedence:null})}function nC(t,e,n,s){t.querySelector('link[rel="preload"][as="style"]['+e+"]")?s.loading=1:(e=t.createElement("link"),s.preload=e,e.addEventListener("load",function(){return s.loading|=1}),e.addEventListener("error",function(){return s.loading|=2}),Ct(e,"link",n),yt(e),t.head.appendChild(e))}function qa(t){return'[src="'+_n(t)+'"]'}function Wl(t){return"script[async]"+t}function Dv(t,e,n){if(e.count++,e.instance===null)switch(e.type){case"style":var s=t.querySelector('style[data-href~="'+_n(n.href)+'"]');if(s)return e.instance=s,yt(s),s;var i=Fe({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return s=(t.ownerDocument||t).createElement("style"),yt(s),Ct(s,"style",i),ru(s,n.precedence,t),e.instance=s;case"stylesheet":i=Aa(n.href);var r=t.querySelector(ql(i));if(r)return e.state.loading|=4,e.instance=r,yt(r),r;s=ME(n),(i=Cn.get(i))&&Rg(s,i),r=(t.ownerDocument||t).createElement("link"),yt(r);var a=r;return a._p=new Promise(function(o,c){a.onload=o,a.onerror=c}),Ct(r,"link",s),e.state.loading|=4,ru(r,n.precedence,t),e.instance=r;case"script":return r=qa(n.src),(i=t.querySelector(Wl(r)))?(e.instance=i,yt(i),i):(s=n,(i=Cn.get(r))&&(s=Fe({},n),Ig(s,i)),t=t.ownerDocument||t,i=t.createElement("script"),yt(i),Ct(i,"link",s),t.head.appendChild(i),e.instance=i);case"void":return null;default:throw Error(P(443,e.type))}else e.type==="stylesheet"&&!(e.state.loading&4)&&(s=e.instance,e.state.loading|=4,ru(s,n.precedence,t));return e.instance}function ru(t,e,n){for(var s=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),i=s.length?s[s.length-1]:null,r=i,a=0;a<s.length;a++){var o=s[a];if(o.dataset.precedence===e)r=o;else if(r!==i)break}r?r.parentNode.insertBefore(t,r.nextSibling):(e=n.nodeType===9?n.head:n,e.insertBefore(t,e.firstChild))}function Rg(t,e){t.crossOrigin==null&&(t.crossOrigin=e.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=e.referrerPolicy),t.title==null&&(t.title=e.title)}function Ig(t,e){t.crossOrigin==null&&(t.crossOrigin=e.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=e.referrerPolicy),t.integrity==null&&(t.integrity=e.integrity)}var au=null;function Lv(t,e,n){if(au===null){var s=new Map,i=au=new Map;i.set(n,s)}else i=au,s=i.get(n),s||(s=new Map,i.set(n,s));if(s.has(t))return s;for(s.set(t,null),n=n.getElementsByTagName(t),i=0;i<n.length;i++){var r=n[i];if(!(r[Vl]||r[Tt]||t==="link"&&r.getAttribute("rel")==="stylesheet")&&r.namespaceURI!=="http://www.w3.org/2000/svg"){var a=r.getAttribute(e)||"";a=t+a;var o=s.get(a);o?o.push(r):s.set(a,[r])}}return s}function Pv(t,e,n){t=t.ownerDocument||t,t.head.insertBefore(n,e==="title"?t.querySelector("head > title"):null)}function sC(t,e,n){if(n===1||e.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof e.precedence!="string"||typeof e.href!="string"||e.href==="")break;return!0;case"link":if(typeof e.rel!="string"||typeof e.href!="string"||e.href===""||e.onLoad||e.onError)break;switch(e.rel){case"stylesheet":return t=e.disabled,typeof e.precedence=="string"&&t==null;default:return!0}case"script":if(e.async&&typeof e.async!="function"&&typeof e.async!="symbol"&&!e.onLoad&&!e.onError&&e.src&&typeof e.src=="string")return!0}return!1}function DE(t){return!(t.type==="stylesheet"&&!(t.state.loading&3))}function iC(t,e,n,s){if(n.type==="stylesheet"&&(typeof s.media!="string"||matchMedia(s.media).matches!==!1)&&!(n.state.loading&4)){if(n.instance===null){var i=Aa(s.href),r=e.querySelector(ql(i));if(r){e=r._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(t.count++,t=Fu.bind(t),e.then(t,t)),n.state.loading|=4,n.instance=r,yt(r);return}r=e.ownerDocument||e,s=ME(s),(i=Cn.get(i))&&Rg(s,i),r=r.createElement("link"),yt(r);var a=r;a._p=new Promise(function(o,c){a.onload=o,a.onerror=c}),Ct(r,"link",s),n.instance=r}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(n,e),(e=n.state.preload)&&!(n.state.loading&3)&&(t.count++,n=Fu.bind(t),e.addEventListener("load",n),e.addEventListener("error",n))}}var rh=0;function rC(t,e){return t.stylesheets&&t.count===0&&ou(t,t.stylesheets),0<t.count||0<t.imgCount?function(n){var s=setTimeout(function(){if(t.stylesheets&&ou(t,t.stylesheets),t.unsuspend){var r=t.unsuspend;t.unsuspend=null,r()}},6e4+e);0<t.imgBytes&&rh===0&&(rh=62500*UI());var i=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&ou(t,t.stylesheets),t.unsuspend)){var r=t.unsuspend;t.unsuspend=null,r()}},(t.imgBytes>rh?50:800)+e);return t.unsuspend=n,function(){t.unsuspend=null,clearTimeout(s),clearTimeout(i)}}:null}function Fu(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)ou(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var zu=null;function ou(t,e){t.stylesheets=null,t.unsuspend!==null&&(t.count++,zu=new Map,e.forEach(aC,t),zu=null,Fu.call(t))}function aC(t,e){if(!(e.state.loading&4)){var n=zu.get(t);if(n)var s=n.get(null);else{n=new Map,zu.set(t,n);for(var i=t.querySelectorAll("link[data-precedence],style[data-precedence]"),r=0;r<i.length;r++){var a=i[r];(a.nodeName==="LINK"||a.getAttribute("media")!=="not all")&&(n.set(a.dataset.precedence,a),s=a)}s&&n.set(null,s)}i=e.instance,a=i.getAttribute("data-precedence"),r=n.get(a)||s,r===s&&n.set(null,i),n.set(a,i),this.count++,s=Fu.bind(this),i.addEventListener("load",s),i.addEventListener("error",s),r?r.parentNode.insertBefore(i,r.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(i,t.firstChild)),e.state.loading|=4}}var hl={$$typeof:ps,Provider:null,Consumer:null,_currentValue:er,_currentValue2:er,_threadCount:0};function oC(t,e,n,s,i,r,a,o,c){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Af(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Af(0),this.hiddenUpdates=Af(null),this.identifierPrefix=s,this.onUncaughtError=i,this.onCaughtError=r,this.onRecoverableError=a,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=c,this.incompleteTransitions=new Map}function LE(t,e,n,s,i,r,a,o,c,u,d,f){return t=new oC(t,e,n,a,c,u,d,f,o),e=1,r===!0&&(e|=24),r=sn(3,null,null,e),t.current=r,r.stateNode=t,e=ng(),e.refCount++,t.pooledCache=e,e.refCount++,r.memoizedState={element:s,isDehydrated:n,cache:e},rg(r),t}function PE(t){return t?(t=Yr,t):Yr}function BE(t,e,n,s,i,r){i=PE(i),s.context===null?s.context=i:s.pendingContext=i,s=di(e),s.payload={element:n},r=r===void 0?null:r,r!==null&&(s.callback=r),n=fi(t,s,e),n!==null&&(Jt(n,t,e),Lo(n,t,e))}function Bv(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Cg(t,e){Bv(t,e),(t=t.alternate)&&Bv(t,e)}function UE(t){if(t.tag===13||t.tag===31){var e=kr(t,67108864);e!==null&&Jt(e,t,67108864),Cg(t,67108864)}}function Uv(t){if(t.tag===13||t.tag===31){var e=un();e=Vp(e);var n=kr(t,e);n!==null&&Jt(n,t,e),Cg(t,e)}}var $u=!0;function lC(t,e,n,s){var i=ie.T;ie.T=null;var r=Ne.p;try{Ne.p=2,jg(t,e,n,s)}finally{Ne.p=r,ie.T=i}}function cC(t,e,n,s){var i=ie.T;ie.T=null;var r=Ne.p;try{Ne.p=8,jg(t,e,n,s)}finally{Ne.p=r,ie.T=i}}function jg(t,e,n,s){if($u){var i=Im(s);if(i===null)sh(t,e,s,Ku,n),Hv(t,s);else if(dC(i,t,e,n,s))s.stopPropagation();else if(Hv(t,s),e&4&&-1<uC.indexOf(t)){for(;i!==null;){var r=Fa(i);if(r!==null)switch(r.tag){case 3:if(r=r.stateNode,r.current.memoizedState.isDehydrated){var a=zi(r.pendingLanes);if(a!==0){var o=r;for(o.pendingLanes|=2,o.entangledLanes|=2;a;){var c=1<<31-cn(a);o.entanglements[1]|=c,a&=~c}rs(r),!(Ee&6)&&(Du=on()+500,Yl(0))}}break;case 31:case 13:o=kr(r,2),o!==null&&Jt(o,r,2),Fd(),Cg(r,2)}if(r=Im(s),r===null&&sh(t,e,s,Ku,n),r===i)break;i=r}i!==null&&s.stopPropagation()}else sh(t,e,s,null,n)}}function Im(t){return t=Kp(t),Og(t)}var Ku=null;function Og(t){if(Ku=null,t=Gr(t),t!==null){var e=Bl(t);if(e===null)t=null;else{var n=e.tag;if(n===13){if(t=r1(e),t!==null)return t;t=null}else if(n===31){if(t=a1(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null)}}return Ku=t,null}function HE(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(WA()){case u1:return 2;case d1:return 8;case _u:case XA:return 32;case f1:return 268435456;default:return 32}default:return 32}}var Cm=!1,pi=null,gi=null,bi=null,ml=new Map,pl=new Map,Xs=[],uC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Hv(t,e){switch(t){case"focusin":case"focusout":pi=null;break;case"dragenter":case"dragleave":gi=null;break;case"mouseover":case"mouseout":bi=null;break;case"pointerover":case"pointerout":ml.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":pl.delete(e.pointerId)}}function go(t,e,n,s,i,r){return t===null||t.nativeEvent!==r?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:r,targetContainers:[i]},e!==null&&(e=Fa(e),e!==null&&UE(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function dC(t,e,n,s,i){switch(e){case"focusin":return pi=go(pi,t,e,n,s,i),!0;case"dragenter":return gi=go(gi,t,e,n,s,i),!0;case"mouseover":return bi=go(bi,t,e,n,s,i),!0;case"pointerover":var r=i.pointerId;return ml.set(r,go(ml.get(r)||null,t,e,n,s,i)),!0;case"gotpointercapture":return r=i.pointerId,pl.set(r,go(pl.get(r)||null,t,e,n,s,i)),!0}return!1}function GE(t){var e=Gr(t.target);if(e!==null){var n=Bl(e);if(n!==null){if(e=n.tag,e===13){if(e=r1(n),e!==null){t.blockedOn=e,Nb(t.priority,function(){Uv(n)});return}}else if(e===31){if(e=a1(n),e!==null){t.blockedOn=e,Nb(t.priority,function(){Uv(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function lu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Im(t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);Wh=s,n.target.dispatchEvent(s),Wh=null}else return e=Fa(n),e!==null&&UE(e),t.blockedOn=n,!1;e.shift()}return!0}function Gv(t,e,n){lu(t)&&n.delete(e)}function fC(){Cm=!1,pi!==null&&lu(pi)&&(pi=null),gi!==null&&lu(gi)&&(gi=null),bi!==null&&lu(bi)&&(bi=null),ml.forEach(Gv),pl.forEach(Gv)}function Mc(t,e){t.blockedOn===e&&(t.blockedOn=null,Cm||(Cm=!0,pt.unstable_scheduleCallback(pt.unstable_NormalPriority,fC)))}var Dc=null;function Vv(t){Dc!==t&&(Dc=t,pt.unstable_scheduleCallback(pt.unstable_NormalPriority,function(){Dc===t&&(Dc=null);for(var e=0;e<t.length;e+=3){var n=t[e],s=t[e+1],i=t[e+2];if(typeof s!="function"){if(Og(s||n)===null)continue;break}var r=Fa(n);r!==null&&(t.splice(e,3),e-=3,dm(r,{pending:!0,data:i,method:n.method,action:s},s,i))}}))}function Ra(t){function e(c){return Mc(c,t)}pi!==null&&Mc(pi,t),gi!==null&&Mc(gi,t),bi!==null&&Mc(bi,t),ml.forEach(e),pl.forEach(e);for(var n=0;n<Xs.length;n++){var s=Xs[n];s.blockedOn===t&&(s.blockedOn=null)}for(;0<Xs.length&&(n=Xs[0],n.blockedOn===null);)GE(n),n.blockedOn===null&&Xs.shift();if(n=(t.ownerDocument||t).$$reactFormReplay,n!=null)for(s=0;s<n.length;s+=3){var i=n[s],r=n[s+1],a=i[Zt]||null;if(typeof r=="function")a||Vv(n);else if(a){var o=null;if(r&&r.hasAttribute("formAction")){if(i=r,a=r[Zt]||null)o=a.formAction;else if(Og(i)!==null)continue}else o=a.action;typeof o=="function"?n[s+1]=o:(n.splice(s,3),s-=3),Vv(n)}}}function VE(){function t(r){r.canIntercept&&r.info==="react-transition"&&r.intercept({handler:function(){return new Promise(function(a){return i=a})},focusReset:"manual",scroll:"manual"})}function e(){i!==null&&(i(),i=null),s||setTimeout(n,20)}function n(){if(!s&&!navigation.transition){var r=navigation.currentEntry;r&&r.url!=null&&navigation.navigate(r.url,{state:r.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var s=!1,i=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",e),navigation.addEventListener("navigateerror",e),setTimeout(n,100),function(){s=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",e),navigation.removeEventListener("navigateerror",e),i!==null&&(i(),i=null)}}}function Mg(t){this._internalRoot=t}Kd.prototype.render=Mg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(P(409));var n=e.current,s=un();BE(n,s,t,e,null,null)};Kd.prototype.unmount=Mg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;BE(t.current,2,null,t,null,null),Fd(),e[Va]=null}};function Kd(t){this._internalRoot=t}Kd.prototype.unstable_scheduleHydration=function(t){if(t){var e=b1();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Xs.length&&e!==0&&e<Xs[n].priority;n++);Xs.splice(n,0,t),n===0&&GE(t)}};var Fv=s1.version;if(Fv!=="19.2.3")throw Error(P(527,Fv,"19.2.3"));Ne.findDOMNode=function(t){var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(P(188)):(t=Object.keys(t).join(","),Error(P(268,t)));return t=VA(e),t=t!==null?o1(t):null,t=t===null?null:t.stateNode,t};var hC={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:ie,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Lc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Lc.isDisabled&&Lc.supportsFiber)try{Ul=Lc.inject(hC),ln=Lc}catch{}}Rd.createRoot=function(t,e){if(!i1(t))throw Error(P(299));var n=!1,s="",i=Ow,r=Mw,a=Dw;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onUncaughtError!==void 0&&(i=e.onUncaughtError),e.onCaughtError!==void 0&&(r=e.onCaughtError),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=LE(t,1,!1,null,null,n,s,null,i,r,a,VE),t[Va]=e.current,Ag(t),new Mg(e)};Rd.hydrateRoot=function(t,e,n){if(!i1(t))throw Error(P(299));var s=!1,i="",r=Ow,a=Mw,o=Dw,c=null;return n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onUncaughtError!==void 0&&(r=n.onUncaughtError),n.onCaughtError!==void 0&&(a=n.onCaughtError),n.onRecoverableError!==void 0&&(o=n.onRecoverableError),n.formState!==void 0&&(c=n.formState)),e=LE(t,1,!0,e,n??null,s,i,c,r,a,o,VE),e.context=PE(null),n=e.current,s=un(),s=Vp(s),i=di(s),i.callback=null,fi(n,i,s),n=s,e.current.lanes=n,Gl(e,n),rs(e),t[Va]=e.current,Ag(t),new Kd(e)};Rd.version="19.2.3";function FE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(FE)}catch(t){console.error(t)}}FE(),Q_.exports=Rd;var mC=Q_.exports;const pC=G_(mC);/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function gl(){return gl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},gl.apply(this,arguments)}var ai;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(ai||(ai={}));const zv="popstate";function gC(t){t===void 0&&(t={});function e(s,i){let{pathname:r,search:a,hash:o}=s.location;return jm("",{pathname:r,search:a,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(s,i){return typeof i=="string"?i:zE(i)}return vC(e,n,null,t)}function ut(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Dg(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function bC(){return Math.random().toString(36).substr(2,8)}function $v(t,e){return{usr:t.state,key:t.key,idx:e}}function jm(t,e,n,s){return n===void 0&&(n=null),gl({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Wa(e):e,{state:n,key:e&&e.key||s||bC()})}function zE(t){let{pathname:e="/",search:n="",hash:s=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function Wa(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function vC(t,e,n,s){s===void 0&&(s={});let{window:i=document.defaultView,v5Compat:r=!1}=s,a=i.history,o=ai.Pop,c=null,u=d();u==null&&(u=0,a.replaceState(gl({},a.state,{idx:u}),""));function d(){return(a.state||{idx:null}).idx}function f(){o=ai.Pop;let x=d(),p=x==null?null:x-u;u=x,c&&c({action:o,location:v.location,delta:p})}function h(x,p){o=ai.Push;let b=jm(v.location,x,p);u=d()+1;let y=$v(b,u),E=v.createHref(b);try{a.pushState(y,"",E)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;i.location.assign(E)}r&&c&&c({action:o,location:v.location,delta:1})}function m(x,p){o=ai.Replace;let b=jm(v.location,x,p);u=d();let y=$v(b,u),E=v.createHref(b);a.replaceState(y,"",E),r&&c&&c({action:o,location:v.location,delta:0})}function g(x){let p=i.location.origin!=="null"?i.location.origin:i.location.href,b=typeof x=="string"?x:zE(x);return b=b.replace(/ $/,"%20"),ut(p,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,p)}let v={get action(){return o},get location(){return t(i,a)},listen(x){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(zv,f),c=x,()=>{i.removeEventListener(zv,f),c=null}},createHref(x){return e(i,x)},createURL:g,encodeLocation(x){let p=g(x);return{pathname:p.pathname,search:p.search,hash:p.hash}},push:h,replace:m,go(x){return a.go(x)}};return v}var Kv;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Kv||(Kv={}));function xC(t,e,n){return n===void 0&&(n="/"),yC(t,e,n)}function yC(t,e,n,s){let i=typeof e=="string"?Wa(e):e,r=YE(i.pathname||"/",n);if(r==null)return null;let a=$E(t);_C(a);let o=null;for(let c=0;o==null&&c<a.length;++c){let u=OC(r);o=IC(a[c],u)}return o}function $E(t,e,n,s){e===void 0&&(e=[]),n===void 0&&(n=[]),s===void 0&&(s="");let i=(r,a,o)=>{let c={relativePath:o===void 0?r.path||"":o,caseSensitive:r.caseSensitive===!0,childrenIndex:a,route:r};c.relativePath.startsWith("/")&&(ut(c.relativePath.startsWith(s),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(s.length));let u=rr([s,c.relativePath]),d=n.concat(c);r.children&&r.children.length>0&&(ut(r.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),$E(r.children,e,d,u)),!(r.path==null&&!r.index)&&e.push({path:u,score:AC(u,r.index),routesMeta:d})};return t.forEach((r,a)=>{var o;if(r.path===""||!((o=r.path)!=null&&o.includes("?")))i(r,a);else for(let c of KE(r.path))i(r,a,c)}),e}function KE(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,i=n.endsWith("?"),r=n.replace(/\?$/,"");if(s.length===0)return i?[r,""]:[r];let a=KE(s.join("/")),o=[];return o.push(...a.map(c=>c===""?r:[r,c].join("/"))),i&&o.push(...a),o.map(c=>t.startsWith("/")&&c===""?"/":c)}function _C(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:RC(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const wC=/^:[\w-]+$/,EC=3,NC=2,kC=1,SC=10,TC=-2,Yv=t=>t==="*";function AC(t,e){let n=t.split("/"),s=n.length;return n.some(Yv)&&(s+=TC),e&&(s+=NC),n.filter(i=>!Yv(i)).reduce((i,r)=>i+(wC.test(r)?EC:r===""?kC:SC),s)}function RC(t,e){return t.length===e.length&&t.slice(0,-1).every((s,i)=>s===e[i])?t[t.length-1]-e[e.length-1]:0}function IC(t,e,n){let{routesMeta:s}=t,i={},r="/",a=[];for(let o=0;o<s.length;++o){let c=s[o],u=o===s.length-1,d=r==="/"?e:e.slice(r.length)||"/",f=CC({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),h=c.route;if(!f)return null;Object.assign(i,f.params),a.push({params:i,pathname:rr([r,f.pathname]),pathnameBase:BC(rr([r,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(r=rr([r,f.pathnameBase]))}return a}function CC(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=jC(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let r=i[0],a=r.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:s.reduce((u,d,f)=>{let{paramName:h,isOptional:m}=d;if(h==="*"){let v=o[f]||"";a=r.slice(0,r.length-v.length).replace(/(.)\/+$/,"$1")}const g=o[f];return m&&!g?u[h]=void 0:u[h]=(g||"").replace(/%2F/g,"/"),u},{}),pathname:r,pathnameBase:a,pattern:t}}function jC(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Dg(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,c)=>(s.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),s]}function OC(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Dg(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function YE(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}const MC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,DC=t=>MC.test(t);function LC(t,e){e===void 0&&(e="/");let{pathname:n,search:s="",hash:i=""}=typeof t=="string"?Wa(t):t,r;if(n)if(DC(n))r=n;else{if(n.includes("//")){let a=n;n=n.replace(/\/\/+/g,"/"),Dg(!1,"Pathnames cannot have embedded double slashes - normalizing "+(a+" -> "+n))}n.startsWith("/")?r=qv(n.substring(1),"/"):r=qv(n,e)}else r=e;return{pathname:r,search:UC(s),hash:HC(i)}}function qv(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function ah(t,e,n,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function PC(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function qE(t,e){let n=PC(t);return e?n.map((s,i)=>i===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function WE(t,e,n,s){s===void 0&&(s=!1);let i;typeof t=="string"?i=Wa(t):(i=gl({},t),ut(!i.pathname||!i.pathname.includes("?"),ah("?","pathname","search",i)),ut(!i.pathname||!i.pathname.includes("#"),ah("#","pathname","hash",i)),ut(!i.search||!i.search.includes("#"),ah("#","search","hash",i)));let r=t===""||i.pathname==="",a=r?"/":i.pathname,o;if(a==null)o=n;else{let f=e.length-1;if(!s&&a.startsWith("..")){let h=a.split("/");for(;h[0]==="..";)h.shift(),f-=1;i.pathname=h.join("/")}o=f>=0?e[f]:"/"}let c=LC(i,o),u=a&&a!=="/"&&a.endsWith("/"),d=(r||a===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const rr=t=>t.join("/").replace(/\/\/+/g,"/"),BC=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),UC=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,HC=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function GC(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const XE=["post","put","patch","delete"];new Set(XE);const VC=["get",...XE];new Set(VC);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function bl(){return bl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},bl.apply(this,arguments)}const Lg=_.createContext(null),FC=_.createContext(null),Xl=_.createContext(null),Yd=_.createContext(null),Pi=_.createContext({outlet:null,matches:[],isDataRoute:!1}),QE=_.createContext(null);function Ql(){return _.useContext(Yd)!=null}function qd(){return Ql()||ut(!1),_.useContext(Yd).location}function JE(t){_.useContext(Xl).static||_.useLayoutEffect(t)}function Xa(){let{isDataRoute:t}=_.useContext(Pi);return t?n2():zC()}function zC(){Ql()||ut(!1);let t=_.useContext(Lg),{basename:e,future:n,navigator:s}=_.useContext(Xl),{matches:i}=_.useContext(Pi),{pathname:r}=qd(),a=JSON.stringify(qE(i,n.v7_relativeSplatPath)),o=_.useRef(!1);return JE(()=>{o.current=!0}),_.useCallback(function(u,d){if(d===void 0&&(d={}),!o.current)return;if(typeof u=="number"){s.go(u);return}let f=WE(u,JSON.parse(a),r,d.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:rr([e,f.pathname])),(d.replace?s.replace:s.push)(f,d.state,d)},[e,s,a,r,t])}function ZE(){let{matches:t}=_.useContext(Pi),e=t[t.length-1];return e?e.params:{}}function $C(t,e){return KC(t,e)}function KC(t,e,n,s){Ql()||ut(!1);let{navigator:i}=_.useContext(Xl),{matches:r}=_.useContext(Pi),a=r[r.length-1],o=a?a.params:{};a&&a.pathname;let c=a?a.pathnameBase:"/";a&&a.route;let u=qd(),d;if(e){var f;let x=typeof e=="string"?Wa(e):e;c==="/"||(f=x.pathname)!=null&&f.startsWith(c)||ut(!1),d=x}else d=u;let h=d.pathname||"/",m=h;if(c!=="/"){let x=c.replace(/^\//,"").split("/");m="/"+h.replace(/^\//,"").split("/").slice(x.length).join("/")}let g=xC(t,{pathname:m}),v=QC(g&&g.map(x=>Object.assign({},x,{params:Object.assign({},o,x.params),pathname:rr([c,i.encodeLocation?i.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?c:rr([c,i.encodeLocation?i.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),r,n,s);return e&&v?_.createElement(Yd.Provider,{value:{location:bl({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:ai.Pop}},v):v}function YC(){let t=t2(),e=GC(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return _.createElement(_.Fragment,null,_.createElement("h2",null,"Unexpected Application Error!"),_.createElement("h3",{style:{fontStyle:"italic"}},e),n?_.createElement("pre",{style:i},n):null,null)}const qC=_.createElement(YC,null);class WC extends _.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?_.createElement(Pi.Provider,{value:this.props.routeContext},_.createElement(QE.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function XC(t){let{routeContext:e,match:n,children:s}=t,i=_.useContext(Lg);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),_.createElement(Pi.Provider,{value:e},s)}function QC(t,e,n,s){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),s===void 0&&(s=null),t==null){var r;if(!n)return null;if(n.errors)t=n.matches;else if((r=s)!=null&&r.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let a=t,o=(i=n)==null?void 0:i.errors;if(o!=null){let d=a.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);d>=0||ut(!1),a=a.slice(0,Math.min(a.length,d+1))}let c=!1,u=-1;if(n&&s&&s.v7_partialHydration)for(let d=0;d<a.length;d++){let f=a[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=d),f.route.id){let{loaderData:h,errors:m}=n,g=f.route.loader&&h[f.route.id]===void 0&&(!m||m[f.route.id]===void 0);if(f.route.lazy||g){c=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((d,f,h)=>{let m,g=!1,v=null,x=null;n&&(m=o&&f.route.id?o[f.route.id]:void 0,v=f.route.errorElement||qC,c&&(u<0&&h===0?(s2("route-fallback"),g=!0,x=null):u===h&&(g=!0,x=f.route.hydrateFallbackElement||null)));let p=e.concat(a.slice(0,h+1)),b=()=>{let y;return m?y=v:g?y=x:f.route.Component?y=_.createElement(f.route.Component,null):f.route.element?y=f.route.element:y=d,_.createElement(XC,{match:f,routeContext:{outlet:d,matches:p,isDataRoute:n!=null},children:y})};return n&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?_.createElement(WC,{location:n.location,revalidation:n.revalidation,component:v,error:m,children:b(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):b()},null)}var eN=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(eN||{}),tN=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(tN||{});function JC(t){let e=_.useContext(Lg);return e||ut(!1),e}function ZC(t){let e=_.useContext(FC);return e||ut(!1),e}function e2(t){let e=_.useContext(Pi);return e||ut(!1),e}function nN(t){let e=e2(),n=e.matches[e.matches.length-1];return n.route.id||ut(!1),n.route.id}function t2(){var t;let e=_.useContext(QE),n=ZC(),s=nN();return e!==void 0?e:(t=n.errors)==null?void 0:t[s]}function n2(){let{router:t}=JC(eN.UseNavigateStable),e=nN(tN.UseNavigateStable),n=_.useRef(!1);return JE(()=>{n.current=!0}),_.useCallback(function(i,r){r===void 0&&(r={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,bl({fromRouteId:e},r)))},[t,e])}const Wv={};function s2(t,e,n){Wv[t]||(Wv[t]=!0)}function i2(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function r2(t){let{to:e,replace:n,state:s,relative:i}=t;Ql()||ut(!1);let{future:r,static:a}=_.useContext(Xl),{matches:o}=_.useContext(Pi),{pathname:c}=qd(),u=Xa(),d=WE(e,qE(o,r.v7_relativeSplatPath),c,i==="path"),f=JSON.stringify(d);return _.useEffect(()=>u(JSON.parse(f),{replace:n,state:s,relative:i}),[u,f,i,n,s]),null}function To(t){ut(!1)}function a2(t){let{basename:e="/",children:n=null,location:s,navigationType:i=ai.Pop,navigator:r,static:a=!1,future:o}=t;Ql()&&ut(!1);let c=e.replace(/^\/*/,"/"),u=_.useMemo(()=>({basename:c,navigator:r,static:a,future:bl({v7_relativeSplatPath:!1},o)}),[c,o,r,a]);typeof s=="string"&&(s=Wa(s));let{pathname:d="/",search:f="",hash:h="",state:m=null,key:g="default"}=s,v=_.useMemo(()=>{let x=YE(d,c);return x==null?null:{location:{pathname:x,search:f,hash:h,state:m,key:g},navigationType:i}},[c,d,f,h,m,g,i]);return v==null?null:_.createElement(Xl.Provider,{value:u},_.createElement(Yd.Provider,{children:n,value:v}))}function o2(t){let{children:e,location:n}=t;return $C(Om(e),n)}new Promise(()=>{});function Om(t,e){e===void 0&&(e=[]);let n=[];return _.Children.forEach(t,(s,i)=>{if(!_.isValidElement(s))return;let r=[...e,i];if(s.type===_.Fragment){n.push.apply(n,Om(s.props.children,r));return}s.type!==To&&ut(!1),!s.props.index||!s.props.children||ut(!1);let a={id:s.props.id||r.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(a.children=Om(s.props.children,r)),n.push(a)}),n}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Mm(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let s=t[n];return e.concat(Array.isArray(s)?s.map(i=>[n,i]):[[n,s]])},[]))}function l2(t,e){let n=Mm(t);return e&&e.forEach((s,i)=>{n.has(i)||e.getAll(i).forEach(r=>{n.append(i,r)})}),n}const c2="6";try{window.__reactRouterVersion=c2}catch{}const u2="startTransition",Xv=DA[u2];function d2(t){let{basename:e,children:n,future:s,window:i}=t,r=_.useRef();r.current==null&&(r.current=gC({window:i,v5Compat:!0}));let a=r.current,[o,c]=_.useState({action:a.action,location:a.location}),{v7_startTransition:u}=s||{},d=_.useCallback(f=>{u&&Xv?Xv(()=>c(f)):c(f)},[c,u]);return _.useLayoutEffect(()=>a.listen(d),[a,d]),_.useEffect(()=>i2(s),[s]),_.createElement(a2,{basename:e,children:n,location:o.location,navigationType:o.action,navigator:a,future:s})}var Qv;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Qv||(Qv={}));var Jv;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Jv||(Jv={}));function f2(t){let e=_.useRef(Mm(t)),n=_.useRef(!1),s=qd(),i=_.useMemo(()=>l2(s.search,n.current?null:e.current),[s.search]),r=Xa(),a=_.useCallback((o,c)=>{const u=Mm(typeof o=="function"?o(i):o);n.current=!0,r("?"+u,c)},[r,i]);return[i,a]}const sN=_.createContext({setFullWidth:()=>{},setHideHeader:()=>{}}),iN=()=>_.useContext(sN),h2=({children:t})=>{const[,e]=_.useState(!1),[,n]=_.useState(!1);return l.jsx(sN.Provider,{value:{setFullWidth:e,setHideHeader:n},children:t})};/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m2=()=>{};var Zv={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rN={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F=function(t,e){if(!t)throw Qa(e)},Qa=function(t){return new Error("Firebase Database ("+rN.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aN=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let i=t.charCodeAt(s);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},p2=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const i=t[n++];if(i<128)e[s++]=String.fromCharCode(i);else if(i>191&&i<224){const r=t[n++];e[s++]=String.fromCharCode((i&31)<<6|r&63)}else if(i>239&&i<365){const r=t[n++],a=t[n++],o=t[n++],c=((i&7)<<18|(r&63)<<12|(a&63)<<6|o&63)-65536;e[s++]=String.fromCharCode(55296+(c>>10)),e[s++]=String.fromCharCode(56320+(c&1023))}else{const r=t[n++],a=t[n++];e[s++]=String.fromCharCode((i&15)<<12|(r&63)<<6|a&63)}}return e.join("")},Pg={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let i=0;i<t.length;i+=3){const r=t[i],a=i+1<t.length,o=a?t[i+1]:0,c=i+2<t.length,u=c?t[i+2]:0,d=r>>2,f=(r&3)<<4|o>>4;let h=(o&15)<<2|u>>6,m=u&63;c||(m=64,a||(h=64)),s.push(n[d],n[f],n[h],n[m])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(aN(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):p2(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let i=0;i<t.length;){const r=n[t.charAt(i++)],o=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const f=i<t.length?n[t.charAt(i)]:64;if(++i,r==null||o==null||u==null||f==null)throw new g2;const h=r<<2|o>>4;if(s.push(h),u!==64){const m=o<<4&240|u>>2;if(s.push(m),f!==64){const g=u<<6&192|f;s.push(g)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class g2 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const oN=function(t){const e=aN(t);return Pg.encodeByteArray(e,!0)},Yu=function(t){return oN(t).replace(/\./g,"")},qu=function(t){try{return Pg.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b2(t){return lN(void 0,t)}function lN(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!v2(n)||(t[n]=lN(t[n],e[n]));return t}function v2(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x2(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y2=()=>x2().__FIREBASE_DEFAULTS__,_2=()=>{if(typeof process>"u"||typeof Zv>"u")return;const t=Zv.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},w2=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&qu(t[1]);return e&&JSON.parse(e)},Bg=()=>{try{return m2()||y2()||_2()||w2()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},cN=t=>{var e,n;return(n=(e=Bg())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},E2=t=>{const e=cN(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),s]:[e.substring(0,n),s]},uN=()=>{var t;return(t=Bg())==null?void 0:t.config},dN=t=>{var e;return(e=Bg())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ja(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function fN(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N2(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",i=t.iat||0,r=t.sub||t.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${s}`,aud:s,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Yu(JSON.stringify(n)),Yu(JSON.stringify(a)),""].join(".")}const $o={};function k2(){const t={prod:[],emulator:[]};for(const e of Object.keys($o))$o[e]?t.emulator.push(e):t.prod.push(e);return t}function S2(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let ex=!1;function hN(t,e){if(typeof window>"u"||typeof document>"u"||!Ja(window.location.host)||$o[t]===e||$o[t]||ex)return;$o[t]=e;function n(h){return`__firebase__banner__${h}`}const s="__firebase__banner",r=k2().prod.length>0;function a(){const h=document.getElementById(s);h&&h.remove()}function o(h){h.style.display="flex",h.style.background="#7faaf0",h.style.position="fixed",h.style.bottom="5px",h.style.left="5px",h.style.padding=".5em",h.style.borderRadius="5px",h.style.alignItems="center"}function c(h,m){h.setAttribute("width","24"),h.setAttribute("id",m),h.setAttribute("height","24"),h.setAttribute("viewBox","0 0 24 24"),h.setAttribute("fill","none"),h.style.marginLeft="-6px"}function u(){const h=document.createElement("span");return h.style.cursor="pointer",h.style.marginLeft="16px",h.style.fontSize="24px",h.innerHTML=" &times;",h.onclick=()=>{ex=!0,a()},h}function d(h,m){h.setAttribute("id",m),h.innerText="Learn more",h.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",h.setAttribute("target","__blank"),h.style.paddingLeft="5px",h.style.textDecoration="underline"}function f(){const h=S2(s),m=n("text"),g=document.getElementById(m)||document.createElement("span"),v=n("learnmore"),x=document.getElementById(v)||document.createElement("a"),p=n("preprendIcon"),b=document.getElementById(p)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(h.created){const y=h.element;o(y),d(x,v);const E=u();c(b,p),y.append(b,g,x,E),document.body.appendChild(y)}r?(g.innerText="Preview backend disconnected.",b.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(b.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,g.innerText="Preview backend running in this workspace."),g.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Ug(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Vt())}function T2(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function A2(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function mN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function R2(){const t=Vt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function I2(){return rN.NODE_ADMIN===!0}function C2(){try{return typeof indexedDB=="object"}catch{return!1}}function j2(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(s);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var r;e(((r=i.error)==null?void 0:r.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O2="FirebaseError";class Bi extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=O2,Object.setPrototypeOf(this,Bi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Jl.prototype.create)}}class Jl{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},i=`${this.service}/${e}`,r=this.errors[e],a=r?M2(r,s):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new Bi(i,o,s)}}function M2(t,e){return t.replace(D2,(n,s)=>{const i=e[s];return i!=null?String(i):`<${s}?>`})}const D2=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vl(t){return JSON.parse(t)}function mt(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pN=function(t){let e={},n={},s={},i="";try{const r=t.split(".");e=vl(qu(r[0])||""),n=vl(qu(r[1])||""),i=r[2],s=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:s,signature:i}},L2=function(t){const e=pN(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},P2=function(t){const e=pN(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function mr(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function Wu(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Xu(t,e,n){const s={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(s[i]=e.call(n,t[i],i,t));return s}function pr(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const i of n){if(!s.includes(i))return!1;const r=t[i],a=e[i];if(tx(r)&&tx(a)){if(!pr(r,a))return!1}else if(r!==a)return!1}for(const i of s)if(!n.includes(i))return!1;return!0}function tx(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Za(t){const e=[];for(const[n,s]of Object.entries(t))Array.isArray(s)?s.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function Ao(t){const e={};return t.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[i,r]=s.split("=");e[decodeURIComponent(i)]=decodeURIComponent(r)}}),e}function Ro(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B2{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const s=this.W_;if(typeof e=="string")for(let f=0;f<16;f++)s[f]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let f=0;f<16;f++)s[f]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let f=16;f<80;f++){const h=s[f-3]^s[f-8]^s[f-14]^s[f-16];s[f]=(h<<1|h>>>31)&4294967295}let i=this.chain_[0],r=this.chain_[1],a=this.chain_[2],o=this.chain_[3],c=this.chain_[4],u,d;for(let f=0;f<80;f++){f<40?f<20?(u=o^r&(a^o),d=1518500249):(u=r^a^o,d=1859775393):f<60?(u=r&a|o&(r|a),d=2400959708):(u=r^a^o,d=3395469782);const h=(i<<5|i>>>27)+u+c+d+s[f]&4294967295;c=o,o=a,a=(r<<30|r>>>2)&4294967295,r=i,i=h}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+r&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+o&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const s=n-this.blockSize;let i=0;const r=this.buf_;let a=this.inbuf_;for(;i<n;){if(a===0)for(;i<=s;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<n;)if(r[a]=e.charCodeAt(i),++a,++i,a===this.blockSize){this.compress_(r),a=0;break}}else for(;i<n;)if(r[a]=e[i],++a,++i,a===this.blockSize){this.compress_(r),a=0;break}}this.inbuf_=a,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=n&255,n/=256;this.compress_(this.buf_);let s=0;for(let i=0;i<5;i++)for(let r=24;r>=0;r-=8)e[s]=this.chain_[i]>>r&255,++s;return e}}function U2(t,e){const n=new H2(t,e);return n.subscribe.bind(n)}class H2{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,s){let i;if(e===void 0&&n===void 0&&s===void 0)throw new Error("Missing Observer.");G2(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:s},i.next===void 0&&(i.next=oh),i.error===void 0&&(i.error=oh),i.complete===void 0&&(i.complete=oh);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),r}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function G2(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function oh(){}function Ia(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V2=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let i=t.charCodeAt(s);if(i>=55296&&i<=56319){const r=i-55296;s++,F(s<t.length,"Surrogate pair missing trail surrogate.");const a=t.charCodeAt(s)-56320;i=65536+(r<<10)+a}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},Wd=function(t){let e=0;for(let n=0;n<t.length;n++){const s=t.charCodeAt(n);s<128?e++:s<2048?e+=2:s>=55296&&s<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dt(t){return t&&t._delegate?t._delegate:t}class gr{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F2{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new Bn;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&s.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if($2(e))try{this.getOrInitializeService({instanceIdentifier:Yi})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const r=this.getOrInitializeService({instanceIdentifier:i});s.resolve(r)}catch{}}}}clearInstance(e=Yi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Yi){return this.instances.has(e)}getOptions(e=Yi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[r,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(r);s===o&&a.resolve(i)}return i}onInit(e,n){const s=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(s)??new Set;i.add(e),this.onInitCallbacks.set(s,i);const r=this.instances.get(s);return r&&e(r,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(s)for(const i of s)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:z2(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=Yi){return this.component?this.component.multipleInstances?e:Yi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function z2(t){return t===Yi?void 0:t}function $2(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K2{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new F2(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var je;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(je||(je={}));const Y2={debug:je.DEBUG,verbose:je.VERBOSE,info:je.INFO,warn:je.WARN,error:je.ERROR,silent:je.SILENT},q2=je.INFO,W2={[je.DEBUG]:"log",[je.VERBOSE]:"log",[je.INFO]:"info",[je.WARN]:"warn",[je.ERROR]:"error"},X2=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),i=W2[e];if(i)console[i](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Hg{constructor(e){this.name=e,this._logLevel=q2,this._logHandler=X2,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in je))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Y2[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,je.DEBUG,...e),this._logHandler(this,je.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,je.VERBOSE,...e),this._logHandler(this,je.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,je.INFO,...e),this._logHandler(this,je.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,je.WARN,...e),this._logHandler(this,je.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,je.ERROR,...e),this._logHandler(this,je.ERROR,...e)}}const Q2=(t,e)=>e.some(n=>t instanceof n);let nx,sx;function J2(){return nx||(nx=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Z2(){return sx||(sx=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const gN=new WeakMap,Dm=new WeakMap,bN=new WeakMap,lh=new WeakMap,Gg=new WeakMap;function ej(t){const e=new Promise((n,s)=>{const i=()=>{t.removeEventListener("success",r),t.removeEventListener("error",a)},r=()=>{n(vi(t.result)),i()},a=()=>{s(t.error),i()};t.addEventListener("success",r),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&gN.set(n,t)}).catch(()=>{}),Gg.set(e,t),e}function tj(t){if(Dm.has(t))return;const e=new Promise((n,s)=>{const i=()=>{t.removeEventListener("complete",r),t.removeEventListener("error",a),t.removeEventListener("abort",a)},r=()=>{n(),i()},a=()=>{s(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",r),t.addEventListener("error",a),t.addEventListener("abort",a)});Dm.set(t,e)}let Lm={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Dm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||bN.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return vi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function nj(t){Lm=t(Lm)}function sj(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(ch(this),e,...n);return bN.set(s,e.sort?e.sort():[e]),vi(s)}:Z2().includes(t)?function(...e){return t.apply(ch(this),e),vi(gN.get(this))}:function(...e){return vi(t.apply(ch(this),e))}}function ij(t){return typeof t=="function"?sj(t):(t instanceof IDBTransaction&&tj(t),Q2(t,J2())?new Proxy(t,Lm):t)}function vi(t){if(t instanceof IDBRequest)return ej(t);if(lh.has(t))return lh.get(t);const e=ij(t);return e!==t&&(lh.set(t,e),Gg.set(e,t)),e}const ch=t=>Gg.get(t);function rj(t,e,{blocked:n,upgrade:s,blocking:i,terminated:r}={}){const a=indexedDB.open(t,e),o=vi(a);return s&&a.addEventListener("upgradeneeded",c=>{s(vi(a.result),c.oldVersion,c.newVersion,vi(a.transaction),c)}),n&&a.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),o.then(c=>{r&&c.addEventListener("close",()=>r()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),o}const aj=["get","getKey","getAll","getAllKeys","count"],oj=["put","add","delete","clear"],uh=new Map;function ix(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(uh.get(e))return uh.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,i=oj.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(i||aj.includes(n)))return;const r=async function(a,...o){const c=this.transaction(a,i?"readwrite":"readonly");let u=c.store;return s&&(u=u.index(o.shift())),(await Promise.all([u[n](...o),i&&c.done]))[0]};return uh.set(e,r),r}nj(t=>({...t,get:(e,n,s)=>ix(e,n)||t.get(e,n,s),has:(e,n)=>!!ix(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lj{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(cj(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function cj(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Pm="@firebase/app",rx="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const js=new Hg("@firebase/app"),uj="@firebase/app-compat",dj="@firebase/analytics-compat",fj="@firebase/analytics",hj="@firebase/app-check-compat",mj="@firebase/app-check",pj="@firebase/auth",gj="@firebase/auth-compat",bj="@firebase/database",vj="@firebase/data-connect",xj="@firebase/database-compat",yj="@firebase/functions",_j="@firebase/functions-compat",wj="@firebase/installations",Ej="@firebase/installations-compat",Nj="@firebase/messaging",kj="@firebase/messaging-compat",Sj="@firebase/performance",Tj="@firebase/performance-compat",Aj="@firebase/remote-config",Rj="@firebase/remote-config-compat",Ij="@firebase/storage",Cj="@firebase/storage-compat",jj="@firebase/firestore",Oj="@firebase/ai",Mj="@firebase/firestore-compat",Dj="firebase",Lj="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bm="[DEFAULT]",Pj={[Pm]:"fire-core",[uj]:"fire-core-compat",[fj]:"fire-analytics",[dj]:"fire-analytics-compat",[mj]:"fire-app-check",[hj]:"fire-app-check-compat",[pj]:"fire-auth",[gj]:"fire-auth-compat",[bj]:"fire-rtdb",[vj]:"fire-data-connect",[xj]:"fire-rtdb-compat",[yj]:"fire-fn",[_j]:"fire-fn-compat",[wj]:"fire-iid",[Ej]:"fire-iid-compat",[Nj]:"fire-fcm",[kj]:"fire-fcm-compat",[Sj]:"fire-perf",[Tj]:"fire-perf-compat",[Aj]:"fire-rc",[Rj]:"fire-rc-compat",[Ij]:"fire-gcs",[Cj]:"fire-gcs-compat",[jj]:"fire-fst",[Mj]:"fire-fst-compat",[Oj]:"fire-vertex","fire-js":"fire-js",[Dj]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qu=new Map,Bj=new Map,Um=new Map;function ax(t,e){try{t.container.addComponent(e)}catch(n){js.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ca(t){const e=t.name;if(Um.has(e))return js.debug(`There were multiple attempts to register component ${e}.`),!1;Um.set(e,t);for(const n of Qu.values())ax(n,t);for(const n of Bj.values())ax(n,t);return!0}function Vg(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function rn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uj={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},xi=new Jl("app","Firebase",Uj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hj{constructor(e,n,s){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new gr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw xi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eo=Lj;function vN(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const s={name:Bm,automaticDataCollectionEnabled:!0,...e},i=s.name;if(typeof i!="string"||!i)throw xi.create("bad-app-name",{appName:String(i)});if(n||(n=uN()),!n)throw xi.create("no-options");const r=Qu.get(i);if(r){if(pr(n,r.options)&&pr(s,r.config))return r;throw xi.create("duplicate-app",{appName:i})}const a=new K2(i);for(const c of Um.values())a.addComponent(c);const o=new Hj(n,s,a);return Qu.set(i,o),o}function xN(t=Bm){const e=Qu.get(t);if(!e&&t===Bm&&uN())return vN();if(!e)throw xi.create("no-app",{appName:t});return e}function yi(t,e,n){let s=Pj[t]??t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),r=e.match(/\s|\//);if(i||r){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&r&&a.push("and"),r&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),js.warn(a.join(" "));return}Ca(new gr(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gj="firebase-heartbeat-database",Vj=1,xl="firebase-heartbeat-store";let dh=null;function yN(){return dh||(dh=rj(Gj,Vj,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(xl)}catch(n){console.warn(n)}}}}).catch(t=>{throw xi.create("idb-open",{originalErrorMessage:t.message})})),dh}async function Fj(t){try{const n=(await yN()).transaction(xl),s=await n.objectStore(xl).get(_N(t));return await n.done,s}catch(e){if(e instanceof Bi)js.warn(e.message);else{const n=xi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});js.warn(n.message)}}}async function ox(t,e){try{const s=(await yN()).transaction(xl,"readwrite");await s.objectStore(xl).put(e,_N(t)),await s.done}catch(n){if(n instanceof Bi)js.warn(n.message);else{const s=xi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});js.warn(s.message)}}}function _N(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zj=1024,$j=30;class Kj{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new qj(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=lx();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(a=>a.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:i}),this._heartbeatsCache.heartbeats.length>$j){const a=Wj(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){js.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=lx(),{heartbeatsToSend:s,unsentEntries:i}=Yj(this._heartbeatsCache.heartbeats),r=Yu(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(n){return js.warn(n),""}}}function lx(){return new Date().toISOString().substring(0,10)}function Yj(t,e=zj){const n=[];let s=t.slice();for(const i of t){const r=n.find(a=>a.agent===i.agent);if(r){if(r.dates.push(i.date),cx(n)>e){r.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),cx(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class qj{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return C2()?j2().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Fj(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return ox(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return ox(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function cx(t){return Yu(JSON.stringify({version:2,heartbeats:t})).length}function Wj(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let s=1;s<t.length;s++)t[s].date<n&&(n=t[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xj(t){Ca(new gr("platform-logger",e=>new lj(e),"PRIVATE")),Ca(new gr("heartbeat",e=>new Kj(e),"PRIVATE")),yi(Pm,rx,t),yi(Pm,rx,"esm2020"),yi("fire-js","")}Xj("");function wN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Qj=wN,EN=new Jl("auth","Firebase",wN());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ju=new Hg("@firebase/auth");function Jj(t,...e){Ju.logLevel<=je.WARN&&Ju.warn(`Auth (${eo}): ${t}`,...e)}function cu(t,...e){Ju.logLevel<=je.ERROR&&Ju.error(`Auth (${eo}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fn(t,...e){throw Fg(t,...e)}function Zn(t,...e){return Fg(t,...e)}function NN(t,e,n){const s={...Qj(),[e]:n};return new Jl("auth","Firebase",s).create(e,{appName:t.name})}function es(t){return NN(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Fg(t,...e){if(typeof t!="string"){const n=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=t.name),t._errorFactory.create(n,...s)}return EN.create(t,...e)}function ee(t,e,...n){if(!t)throw Fg(e,...n)}function vs(t){const e="INTERNAL ASSERTION FAILED: "+t;throw cu(e),new Error(e)}function Os(t,e){t||vs(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hm(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function Zj(){return ux()==="http:"||ux()==="https:"}function ux(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e5(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Zj()||A2()||"connection"in navigator)?navigator.onLine:!0}function t5(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zl{constructor(e,n){this.shortDelay=e,this.longDelay=n,Os(n>e,"Short delay should be less than long delay!"),this.isMobile=Ug()||mN()}get(){return e5()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zg(t,e){Os(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kN{static initialize(e,n,s){this.fetchImpl=e,n&&(this.headersImpl=n),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;vs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;vs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;vs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n5={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s5=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],i5=new Zl(3e4,6e4);function Us(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Hs(t,e,n,s,i={}){return SN(t,i,async()=>{let r={},a={};s&&(e==="GET"?a=s:r={body:JSON.stringify(s)});const o=Za({key:t.config.apiKey,...a}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:c,...r};return T2()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&Ja(t.emulatorConfig.host)&&(u.credentials="include"),kN.fetch()(await TN(t,t.config.apiHost,n,o),u)})}async function SN(t,e,n){t._canInitEmulator=!1;const s={...n5,...e};try{const i=new a5(t),r=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const a=await r.json();if("needConfirmation"in a)throw Pc(t,"account-exists-with-different-credential",a);if(r.ok&&!("errorMessage"in a))return a;{const o=r.ok?a.errorMessage:a.error.message,[c,u]=o.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Pc(t,"credential-already-in-use",a);if(c==="EMAIL_EXISTS")throw Pc(t,"email-already-in-use",a);if(c==="USER_DISABLED")throw Pc(t,"user-disabled",a);const d=s[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw NN(t,d,u);Fn(t,d)}}catch(i){if(i instanceof Bi)throw i;Fn(t,"network-request-failed",{message:String(i)})}}async function ec(t,e,n,s,i={}){const r=await Hs(t,e,n,s,i);return"mfaPendingCredential"in r&&Fn(t,"multi-factor-auth-required",{_serverResponse:r}),r}async function TN(t,e,n,s){const i=`${e}${n}?${s}`,r=t,a=r.config.emulator?zg(t.config,i):`${t.config.apiScheme}://${i}`;return s5.includes(n)&&(await r._persistenceManagerAvailable,r._getPersistenceType()==="COOKIE")?r._getPersistence()._getFinalTarget(a).toString():a}function r5(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class a5{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,s)=>{this.timer=setTimeout(()=>s(Zn(this.auth,"network-request-failed")),i5.get())})}}function Pc(t,e,n){const s={appName:t.name};n.email&&(s.email=n.email),n.phoneNumber&&(s.phoneNumber=n.phoneNumber);const i=Zn(t,e,s);return i.customData._tokenResponse=n,i}function dx(t){return t!==void 0&&t.enterprise!==void 0}class o5{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return r5(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function l5(t,e){return Hs(t,"GET","/v2/recaptchaConfig",Us(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c5(t,e){return Hs(t,"POST","/v1/accounts:delete",e)}async function Zu(t,e){return Hs(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ko(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function u5(t,e=!1){const n=dt(t),s=await n.getIdToken(e),i=$g(s);ee(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const r=typeof i.firebase=="object"?i.firebase:void 0,a=r==null?void 0:r.sign_in_provider;return{claims:i,token:s,authTime:Ko(fh(i.auth_time)),issuedAtTime:Ko(fh(i.iat)),expirationTime:Ko(fh(i.exp)),signInProvider:a||null,signInSecondFactor:(r==null?void 0:r.sign_in_second_factor)||null}}function fh(t){return Number(t)*1e3}function $g(t){const[e,n,s]=t.split(".");if(e===void 0||n===void 0||s===void 0)return cu("JWT malformed, contained fewer than 3 sections"),null;try{const i=qu(n);return i?JSON.parse(i):(cu("Failed to decode base64 JWT payload"),null)}catch(i){return cu("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function fx(t){const e=$g(t);return ee(e,"internal-error"),ee(typeof e.exp<"u","internal-error"),ee(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yl(t,e,n=!1){if(n)return e;try{return await e}catch(s){throw s instanceof Bi&&d5(s)&&t.auth.currentUser===t&&await t.auth.signOut(),s}}function d5({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f5{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gm{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ko(this.lastLoginAt),this.creationTime=Ko(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _l(t){var f;const e=t.auth,n=await t.getIdToken(),s=await yl(t,Zu(e,{idToken:n}));ee(s==null?void 0:s.users.length,e,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const r=(f=i.providerUserInfo)!=null&&f.length?AN(i.providerUserInfo):[],a=m5(t.providerData,r),o=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!(a!=null&&a.length),u=o?c:!1,d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Gm(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,d)}async function h5(t){const e=dt(t);await _l(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function m5(t,e){return[...t.filter(s=>!e.some(i=>i.providerId===s.providerId)),...e]}function AN(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p5(t,e){const n=await SN(t,{},async()=>{const s=Za({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:r}=t.config,a=await TN(t,i,"/v1/token",`key=${r}`),o=await t._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:o,body:s};return t.emulatorConfig&&Ja(t.emulatorConfig.host)&&(c.credentials="include"),kN.fetch()(a,c)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function g5(t,e){return Hs(t,"POST","/v2/accounts:revokeToken",Us(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class da{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ee(e.idToken,"internal-error"),ee(typeof e.idToken<"u","internal-error"),ee(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):fx(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ee(e.length!==0,"internal-error");const n=fx(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ee(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:s,refreshToken:i,expiresIn:r}=await p5(e,n);this.updateTokensAndExpiration(s,i,Number(r))}updateTokensAndExpiration(e,n,s){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,n){const{refreshToken:s,accessToken:i,expirationTime:r}=n,a=new da;return s&&(ee(typeof s=="string","internal-error",{appName:e}),a.refreshToken=s),i&&(ee(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),r&&(ee(typeof r=="number","internal-error",{appName:e}),a.expirationTime=r),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new da,this.toJSON())}_performRefresh(){return vs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fs(t,e){ee(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Hn{constructor({uid:e,auth:n,stsTokenManager:s,...i}){this.providerId="firebase",this.proactiveRefresh=new f5(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Gm(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await yl(this,this.stsTokenManager.getToken(this.auth,e));return ee(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return u5(this,e)}reload(){return h5(this)}_assign(e){this!==e&&(ee(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Hn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){ee(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),n&&await _l(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(rn(this.auth.app))return Promise.reject(es(this.auth));const e=await this.getIdToken();return await yl(this,c5(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const s=n.displayName??void 0,i=n.email??void 0,r=n.phoneNumber??void 0,a=n.photoURL??void 0,o=n.tenantId??void 0,c=n._redirectEventId??void 0,u=n.createdAt??void 0,d=n.lastLoginAt??void 0,{uid:f,emailVerified:h,isAnonymous:m,providerData:g,stsTokenManager:v}=n;ee(f&&v,e,"internal-error");const x=da.fromJSON(this.name,v);ee(typeof f=="string",e,"internal-error"),Fs(s,e.name),Fs(i,e.name),ee(typeof h=="boolean",e,"internal-error"),ee(typeof m=="boolean",e,"internal-error"),Fs(r,e.name),Fs(a,e.name),Fs(o,e.name),Fs(c,e.name),Fs(u,e.name),Fs(d,e.name);const p=new Hn({uid:f,auth:e,email:i,emailVerified:h,displayName:s,isAnonymous:m,photoURL:a,phoneNumber:r,tenantId:o,stsTokenManager:x,createdAt:u,lastLoginAt:d});return g&&Array.isArray(g)&&(p.providerData=g.map(b=>({...b}))),c&&(p._redirectEventId=c),p}static async _fromIdTokenResponse(e,n,s=!1){const i=new da;i.updateFromServerResponse(n);const r=new Hn({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:s});return await _l(r),r}static async _fromGetAccountInfoResponse(e,n,s){const i=n.users[0];ee(i.localId!==void 0,"internal-error");const r=i.providerUserInfo!==void 0?AN(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(r!=null&&r.length),o=new da;o.updateFromIdToken(s);const c=new Hn({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:r,metadata:new Gm(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(r!=null&&r.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hx=new Map;function xs(t){Os(t instanceof Function,"Expected a class definition");let e=hx.get(t);return e?(Os(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,hx.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}RN.type="NONE";const mx=RN;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uu(t,e,n){return`firebase:${t}:${e}:${n}`}class fa{constructor(e,n,s){this.persistence=e,this.auth=n,this.userKey=s;const{config:i,name:r}=this.auth;this.fullUserKey=uu(this.userKey,i.apiKey,r),this.fullPersistenceKey=uu("persistence",i.apiKey,r),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Zu(this.auth,{idToken:e}).catch(()=>{});return n?Hn._fromGetAccountInfoResponse(this.auth,n,e):null}return Hn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,s="authUser"){if(!n.length)return new fa(xs(mx),e,s);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let r=i[0]||xs(mx);const a=uu(s,e.config.apiKey,e.name);let o=null;for(const u of n)try{const d=await u._get(a);if(d){let f;if(typeof d=="string"){const h=await Zu(e,{idToken:d}).catch(()=>{});if(!h)break;f=await Hn._fromGetAccountInfoResponse(e,h,d)}else f=Hn._fromJSON(e,d);u!==r&&(o=f),r=u;break}}catch{}const c=i.filter(u=>u._shouldAllowMigration);return!r._shouldAllowMigration||!c.length?new fa(r,e,s):(r=c[0],o&&await r._set(a,o.toJSON()),await Promise.all(n.map(async u=>{if(u!==r)try{await u._remove(a)}catch{}})),new fa(r,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function px(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(ON(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(IN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(DN(e))return"Blackberry";if(LN(e))return"Webos";if(CN(e))return"Safari";if((e.includes("chrome/")||jN(e))&&!e.includes("edge/"))return"Chrome";if(MN(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=t.match(n);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function IN(t=Vt()){return/firefox\//i.test(t)}function CN(t=Vt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function jN(t=Vt()){return/crios\//i.test(t)}function ON(t=Vt()){return/iemobile/i.test(t)}function MN(t=Vt()){return/android/i.test(t)}function DN(t=Vt()){return/blackberry/i.test(t)}function LN(t=Vt()){return/webos/i.test(t)}function Kg(t=Vt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function b5(t=Vt()){var e;return Kg(t)&&!!((e=window.navigator)!=null&&e.standalone)}function v5(){return R2()&&document.documentMode===10}function PN(t=Vt()){return Kg(t)||MN(t)||LN(t)||DN(t)||/windows phone/i.test(t)||ON(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BN(t,e=[]){let n;switch(t){case"Browser":n=px(Vt());break;case"Worker":n=`${px(Vt())}-${t}`;break;default:n=t}const s=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${eo}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x5{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const s=r=>new Promise((a,o)=>{try{const c=e(r);a(c)}catch(c){o(c)}});s.onAbort=n,this.queue.push(s);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const s of this.queue)await s(e),s.onAbort&&n.push(s.onAbort)}catch(s){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function y5(t,e={}){return Hs(t,"GET","/v2/passwordPolicy",Us(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _5=6;class w5{constructor(e){var s;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??_5,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((s=e.allowedNonAlphanumericCharacters)==null?void 0:s.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const s=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;s&&(n.meetsMinPasswordLength=e.length>=s),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let s;for(let i=0;i<e.length;i++)s=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,n,s,i,r){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E5{constructor(e,n,s,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=s,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new gx(this),this.idTokenSubscription=new gx(this),this.beforeStateQueue=new x5(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=EN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(r=>this._resolvePersistenceManagerAvailable=r)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=xs(n)),this._initializationPromise=this.queue(async()=>{var s,i,r;if(!this._deleted&&(this.persistenceManager=await fa.create(this,e),(s=this._resolvePersistenceManagerAvailable)==null||s.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((r=this.currentUser)==null?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Zu(this,{idToken:e}),s=await Hn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(s)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(rn(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)==null?void 0:r._redirectEventId,o=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!a||a===o)&&(c!=null&&c.user)&&(s=c.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(a){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ee(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await _l(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=t5()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(rn(this.app))return Promise.reject(es(this));const n=e?dt(e):null;return n&&ee(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ee(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return rn(this.app)?Promise.reject(es(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return rn(this.app)?Promise.reject(es(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(xs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await y5(this),n=new w5(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Jl("auth","Firebase",e())}onAuthStateChanged(e,n,s){return this.registerStateListener(this.authStateSubscription,e,n,s)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,s){return this.registerStateListener(this.idTokenSubscription,e,n,s)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(s.tenantId=this.tenantId),await g5(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const s=await this.getOrInitRedirectPersistenceManager(n);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&xs(e)||this._popupRedirectResolver;ee(n,this,"argument-error"),this.redirectPersistenceManager=await fa.create(this,[xs(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,s;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((s=this.redirectUser)==null?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,s,i){if(this._deleted)return()=>{};const r=typeof n=="function"?n:n.next.bind(n);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(ee(o,this,"internal-error"),o.then(()=>{a||r(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,s,i);return()=>{a=!0,c()}}else{const c=e.addObserver(n);return()=>{a=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ee(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=BN(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(e["X-Firebase-AppCheck"]=s),e}async _getAppCheckToken(){var n;if(rn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&Jj(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Gs(t){return dt(t)}class gx{constructor(e){this.auth=e,this.observer=null,this.addObserver=U2(n=>this.observer=n)}get next(){return ee(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function N5(t){Xd=t}function UN(t){return Xd.loadJS(t)}function k5(){return Xd.recaptchaEnterpriseScript}function S5(){return Xd.gapiScript}function T5(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class A5{constructor(){this.enterprise=new R5}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class R5{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const I5="recaptcha-enterprise",HN="NO_RECAPTCHA";class C5{constructor(e){this.type=I5,this.auth=Gs(e)}async verify(e="verify",n=!1){async function s(r){if(!n){if(r.tenantId==null&&r._agentRecaptchaConfig!=null)return r._agentRecaptchaConfig.siteKey;if(r.tenantId!=null&&r._tenantRecaptchaConfigs[r.tenantId]!==void 0)return r._tenantRecaptchaConfigs[r.tenantId].siteKey}return new Promise(async(a,o)=>{l5(r,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const u=new o5(c);return r.tenantId==null?r._agentRecaptchaConfig=u:r._tenantRecaptchaConfigs[r.tenantId]=u,a(u.siteKey)}}).catch(c=>{o(c)})})}function i(r,a,o){const c=window.grecaptcha;dx(c)?c.enterprise.ready(()=>{c.enterprise.execute(r,{action:e}).then(u=>{a(u)}).catch(()=>{a(HN)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new A5().execute("siteKey",{action:"verify"}):new Promise((r,a)=>{s(this.auth).then(o=>{if(!n&&dx(window.grecaptcha))i(o,r,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let c=k5();c.length!==0&&(c+=o),UN(c).then(()=>{i(o,r,a)}).catch(u=>{a(u)})}}).catch(o=>{a(o)})})}}async function bx(t,e,n,s=!1,i=!1){const r=new C5(t);let a;if(i)a=HN;else try{a=await r.verify(n)}catch{a=await r.verify(n,!0)}const o={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in o){const c=o.phoneEnrollmentInfo.phoneNumber,u=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:u,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const c=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return s?Object.assign(o,{captchaResp:a}):Object.assign(o,{captchaResponse:a}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function ed(t,e,n,s,i){var r;if((r=t._getRecaptchaConfig())!=null&&r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await bx(t,e,n,n==="getOobCode");return s(t,a)}else return s(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await bx(t,e,n,n==="getOobCode");return s(t,o)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j5(t,e){const n=Vg(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),r=n.getOptions();if(pr(r,e??{}))return i;Fn(i,"already-initialized")}return n.initialize({options:e})}function O5(t,e){const n=(e==null?void 0:e.persistence)||[],s=(Array.isArray(n)?n:[n]).map(xs);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function M5(t,e,n){const s=Gs(t);ee(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const i=!1,r=GN(e),{host:a,port:o}=D5(e),c=o===null?"":`:${o}`,u={url:`${r}//${a}${c}/`},d=Object.freeze({host:a,port:o,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!s._canInitEmulator){ee(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),ee(pr(u,s.config.emulator)&&pr(d,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=u,s.emulatorConfig=d,s.settings.appVerificationDisabledForTesting=!0,Ja(a)?(fN(`${r}//${a}${c}`),hN("Auth",!0)):L5()}function GN(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function D5(t){const e=GN(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const s=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(s);if(i){const r=i[1];return{host:r,port:vx(s.substr(r.length+1))}}else{const[r,a]=s.split(":");return{host:r,port:vx(a)}}}function vx(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function L5(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yg{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return vs("not implemented")}_getIdTokenResponse(e){return vs("not implemented")}_linkToIdToken(e,n){return vs("not implemented")}_getReauthenticationResolver(e){return vs("not implemented")}}async function P5(t,e){return Hs(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B5(t,e){return ec(t,"POST","/v1/accounts:signInWithPassword",Us(t,e))}async function U5(t,e){return Hs(t,"POST","/v1/accounts:sendOobCode",Us(t,e))}async function H5(t,e){return U5(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function G5(t,e){return ec(t,"POST","/v1/accounts:signInWithEmailLink",Us(t,e))}async function V5(t,e){return ec(t,"POST","/v1/accounts:signInWithEmailLink",Us(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wl extends Yg{constructor(e,n,s,i=null){super("password",s),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new wl(e,n,"password")}static _fromEmailAndCode(e,n,s=null){return new wl(e,n,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ed(e,n,"signInWithPassword",B5);case"emailLink":return G5(e,{email:this._email,oobCode:this._password});default:Fn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const s={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ed(e,s,"signUpPassword",P5);case"emailLink":return V5(e,{idToken:n,email:this._email,oobCode:this._password});default:Fn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ha(t,e){return ec(t,"POST","/v1/accounts:signInWithIdp",Us(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F5="http://localhost";class br extends Yg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new br(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Fn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:i,...r}=n;if(!s||!i)return null;const a=new br(s,i);return a.idToken=r.idToken||void 0,a.accessToken=r.accessToken||void 0,a.secret=r.secret,a.nonce=r.nonce,a.pendingToken=r.pendingToken||null,a}_getIdTokenResponse(e){const n=this.buildRequest();return ha(e,n)}_linkToIdToken(e,n){const s=this.buildRequest();return s.idToken=n,ha(e,s)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ha(e,n)}buildRequest(){const e={requestUri:F5,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Za(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z5(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function $5(t){const e=Ao(Ro(t)).link,n=e?Ao(Ro(e)).deep_link_id:null,s=Ao(Ro(t)).deep_link_id;return(s?Ao(Ro(s)).link:null)||s||n||e||t}class qg{constructor(e){const n=Ao(Ro(e)),s=n.apiKey??null,i=n.oobCode??null,r=z5(n.mode??null);ee(s&&i&&r,"argument-error"),this.apiKey=s,this.operation=r,this.code=i,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=$5(e);try{return new qg(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(){this.providerId=Tr.PROVIDER_ID}static credential(e,n){return wl._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const s=qg.parseLink(n);return ee(s,"argument-error"),wl._fromEmailAndCode(e,s.code,s.tenantId)}}Tr.PROVIDER_ID="password";Tr.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Tr.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VN{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc extends VN{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs extends tc{constructor(){super("facebook.com")}static credential(e){return br._fromParams({providerId:Qs.PROVIDER_ID,signInMethod:Qs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qs.credentialFromTaggedObject(e)}static credentialFromError(e){return Qs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Qs.credential(e.oauthAccessToken)}catch{return null}}}Qs.FACEBOOK_SIGN_IN_METHOD="facebook.com";Qs.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js extends tc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return br._fromParams({providerId:Js.PROVIDER_ID,signInMethod:Js.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Js.credentialFromTaggedObject(e)}static credentialFromError(e){return Js.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:s}=e;if(!n&&!s)return null;try{return Js.credential(n,s)}catch{return null}}}Js.GOOGLE_SIGN_IN_METHOD="google.com";Js.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zs extends tc{constructor(){super("github.com")}static credential(e){return br._fromParams({providerId:Zs.PROVIDER_ID,signInMethod:Zs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Zs.credentialFromTaggedObject(e)}static credentialFromError(e){return Zs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Zs.credential(e.oauthAccessToken)}catch{return null}}}Zs.GITHUB_SIGN_IN_METHOD="github.com";Zs.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei extends tc{constructor(){super("twitter.com")}static credential(e,n){return br._fromParams({providerId:ei.PROVIDER_ID,signInMethod:ei.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return ei.credentialFromTaggedObject(e)}static credentialFromError(e){return ei.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:s}=e;if(!n||!s)return null;try{return ei.credential(n,s)}catch{return null}}}ei.TWITTER_SIGN_IN_METHOD="twitter.com";ei.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FN(t,e){return ec(t,"POST","/v1/accounts:signUp",Us(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,s,i=!1){const r=await Hn._fromIdTokenResponse(e,s,i),a=xx(s);return new Ms({user:r,providerId:a,_tokenResponse:s,operationType:n})}static async _forOperation(e,n,s){await e._updateTokensIfNecessary(s,!0);const i=xx(s);return new Ms({user:e,providerId:i,_tokenResponse:s,operationType:n})}}function xx(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K5(t){var i;if(rn(t.app))return Promise.reject(es(t));const e=Gs(t);if(await e._initializationPromise,(i=e.currentUser)!=null&&i.isAnonymous)return new Ms({user:e.currentUser,providerId:null,operationType:"signIn"});const n=await FN(e,{returnSecureToken:!0}),s=await Ms._fromIdTokenResponse(e,"signIn",n,!0);return await e._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td extends Bi{constructor(e,n,s,i){super(n.code,n.message),this.operationType=s,this.user=i,Object.setPrototypeOf(this,td.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,n,s,i){return new td(e,n,s,i)}}function zN(t,e,n,s){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(r=>{throw r.code==="auth/multi-factor-auth-required"?td._fromErrorAndOperation(t,r,e,s):r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y5(t){return new Set(t.map(({providerId:e})=>e).filter(e=>!!e))}async function $N(t,e,n=!1){const s=await yl(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Ms._forOperation(t,"link",s)}async function q5(t,e,n){await _l(e);const s=Y5(e.providerData);ee(s.has(n)===t,e.auth,"provider-already-linked")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function W5(t,e,n=!1){const{auth:s}=t;if(rn(s.app))return Promise.reject(es(s));const i="reauthenticate";try{const r=await yl(t,zN(s,i,e,t),n);ee(r.idToken,s,"internal-error");const a=$g(r.idToken);ee(a,s,"internal-error");const{sub:o}=a;return ee(t.uid===o,s,"user-mismatch"),Ms._forOperation(t,i,r)}catch(r){throw(r==null?void 0:r.code)==="auth/user-not-found"&&Fn(s,"user-mismatch"),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KN(t,e,n=!1){if(rn(t.app))return Promise.reject(es(t));const s="signIn",i=await zN(t,s,e),r=await Ms._fromIdTokenResponse(t,s,i);return n||await t._updateCurrentUser(r.user),r}async function X5(t,e){return KN(Gs(t),e)}async function Q5(t,e){const n=dt(t);return await q5(!1,n,e.providerId),$N(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YN(t){const e=Gs(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function J5(t,e,n){const s=Gs(t);await ed(s,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",H5)}async function Z5(t,e,n){if(rn(t.app))return Promise.reject(es(t));const s=Gs(t),a=await ed(s,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",FN).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&YN(t),c}),o=await Ms._fromIdTokenResponse(s,"signIn",a);return await s._updateCurrentUser(o.user),o}function eO(t,e,n){return rn(t.app)?Promise.reject(es(t)):X5(dt(t),Tr.credential(e,n)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&YN(t),s})}function tO(t,e,n,s){return dt(t).onIdTokenChanged(e,n,s)}function nO(t,e,n){return dt(t).beforeAuthStateChanged(e,n)}function sO(t,e,n,s){return dt(t).onAuthStateChanged(e,n,s)}function iO(t){return dt(t).signOut()}const nd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qN{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(nd,"1"),this.storage.removeItem(nd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rO=1e3,aO=10;class WN extends qN{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=PN(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const s=this.storage.getItem(n),i=this.localCache[n];s!==i&&e(n,i,s)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((a,o,c)=>{this.notifyListeners(a,c)});return}const s=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(s);!n&&this.localCache[s]===a||this.notifyListeners(s,a)},r=this.storage.getItem(s);v5()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,aO):i()}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:s}),!0)})},rO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}WN.type="LOCAL";const oO=WN;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XN extends qN{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}XN.type="SESSION";const QN=XN;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lO(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const s=new Qd(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:s,eventType:i,data:r}=n.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;n.ports[0].postMessage({status:"ack",eventId:s,eventType:i});const o=Array.from(a).map(async u=>u(n.origin,r)),c=await lO(o);n.ports[0].postMessage({status:"done",eventId:s,eventType:i,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Qd.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wg(t="",e=10){let n="";for(let s=0;s<e;s++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cO{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,s=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,a;return new Promise((o,c)=>{const u=Wg("",20);i.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},s);a={messageChannel:i,onMessage(f){const h=f;if(h.data.eventId===u)switch(h.data.status){case"ack":clearTimeout(d),r=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),o(h.data.response);break;default:clearTimeout(d),clearTimeout(r),c(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ts(){return window}function uO(t){ts().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JN(){return typeof ts().WorkerGlobalScope<"u"&&typeof ts().importScripts=="function"}async function dO(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function fO(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function hO(){return JN()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZN="firebaseLocalStorageDb",mO=1,sd="firebaseLocalStorage",ek="fbase_key";class nc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Jd(t,e){return t.transaction([sd],e?"readwrite":"readonly").objectStore(sd)}function pO(){const t=indexedDB.deleteDatabase(ZN);return new nc(t).toPromise()}function Vm(){const t=indexedDB.open(ZN,mO);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const s=t.result;try{s.createObjectStore(sd,{keyPath:ek})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const s=t.result;s.objectStoreNames.contains(sd)?e(s):(s.close(),await pO(),e(await Vm()))})})}async function yx(t,e,n){const s=Jd(t,!0).put({[ek]:e,value:n});return new nc(s).toPromise()}async function gO(t,e){const n=Jd(t,!1).get(e),s=await new nc(n).toPromise();return s===void 0?null:s.value}function _x(t,e){const n=Jd(t,!0).delete(e);return new nc(n).toPromise()}const bO=800,vO=3;class tk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Vm(),this.db)}async _withRetries(e){let n=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(n++>vO)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return JN()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Qd._getInstance(hO()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,s;if(this.activeServiceWorker=await dO(),!this.activeServiceWorker)return;this.sender=new cO(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(s=e[0])!=null&&s.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||fO()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Vm();return await yx(e,nd,"1"),await _x(e,nd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(s=>yx(s,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(s=>gO(s,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>_x(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const r=Jd(i,!1).getAll();return new nc(r).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],s=new Set;if(e.length!==0)for(const{fbase_key:i,value:r}of e)s.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!s.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),bO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}tk.type="LOCAL";const xO=tk;new Zl(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yO(t,e){return e?xs(e):(ee(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xg extends Yg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ha(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ha(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ha(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function _O(t){return KN(t.auth,new Xg(t),t.bypassAuthState)}function wO(t){const{auth:e,user:n}=t;return ee(n,e,"internal-error"),W5(n,new Xg(t),t.bypassAuthState)}async function EO(t){const{auth:e,user:n}=t;return ee(n,e,"internal-error"),$N(n,new Xg(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nk{constructor(e,n,s,i,r=!1){this.auth=e,this.resolver=s,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:s,postBody:i,tenantId:r,error:a,type:o}=e;if(a){this.reject(a);return}const c={auth:this.auth,requestUri:n,sessionId:s,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return _O;case"linkViaPopup":case"linkViaRedirect":return EO;case"reauthViaPopup":case"reauthViaRedirect":return wO;default:Fn(this.auth,"internal-error")}}resolve(e){Os(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Os(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NO=new Zl(2e3,1e4);class Qr extends nk{constructor(e,n,s,i,r){super(e,n,i,r),this.provider=s,this.authWindow=null,this.pollId=null,Qr.currentPopupAction&&Qr.currentPopupAction.cancel(),Qr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ee(e,this.auth,"internal-error"),e}async onExecution(){Os(this.filter.length===1,"Popup operations only handle one event");const e=Wg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Zn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Zn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Qr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,s;if((s=(n=this.authWindow)==null?void 0:n.window)!=null&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Zn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,NO.get())};e()}}Qr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kO="pendingRedirect",du=new Map;class SO extends nk{constructor(e,n,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,s),this.eventId=null}async execute(){let e=du.get(this.auth._key());if(!e){try{const s=await TO(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(n){e=()=>Promise.reject(n)}du.set(this.auth._key(),e)}return this.bypassAuthState||du.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function TO(t,e){const n=IO(e),s=RO(t);if(!await s._isAvailable())return!1;const i=await s._get(n)==="true";return await s._remove(n),i}function AO(t,e){du.set(t._key(),e)}function RO(t){return xs(t._redirectPersistence)}function IO(t){return uu(kO,t.config.apiKey,t.name)}async function CO(t,e,n=!1){if(rn(t.app))return Promise.reject(es(t));const s=Gs(t),i=yO(s,e),a=await new SO(s,i,n).execute();return a&&!n&&(delete a.user._redirectEventId,await s._persistUserIfCurrent(a.user),await s._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jO=10*60*1e3;class OO{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(n=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!MO(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var s;if(e.error&&!sk(e)){const i=((s=e.error.code)==null?void 0:s.split("auth/")[1])||"internal-error";n.onError(Zn(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const s=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=jO&&this.cachedEventUids.clear(),this.cachedEventUids.has(wx(e))}saveEventToCache(e){this.cachedEventUids.add(wx(e)),this.lastProcessedEventTime=Date.now()}}function wx(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function sk({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function MO(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return sk(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DO(t,e={}){return Hs(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LO=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,PO=/^https?/;async function BO(t){if(t.config.emulator)return;const{authorizedDomains:e}=await DO(t);for(const n of e)try{if(UO(n))return}catch{}Fn(t,"unauthorized-domain")}function UO(t){const e=Hm(),{protocol:n,hostname:s}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&s===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&a.hostname===s}if(!PO.test(n))return!1;if(LO.test(t))return s===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HO=new Zl(3e4,6e4);function Ex(){const t=ts().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function GO(t){return new Promise((e,n)=>{var i,r,a;function s(){Ex(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Ex(),n(Zn(t,"network-request-failed"))},timeout:HO.get()})}if((r=(i=ts().gapi)==null?void 0:i.iframes)!=null&&r.Iframe)e(gapi.iframes.getContext());else if((a=ts().gapi)!=null&&a.load)s();else{const o=T5("iframefcb");return ts()[o]=()=>{gapi.load?s():n(Zn(t,"network-request-failed"))},UN(`${S5()}?onload=${o}`).catch(c=>n(c))}}).catch(e=>{throw fu=null,e})}let fu=null;function VO(t){return fu=fu||GO(t),fu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FO=new Zl(5e3,15e3),zO="__/auth/iframe",$O="emulator/auth/iframe",KO={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},YO=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function qO(t){const e=t.config;ee(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?zg(e,$O):`https://${t.config.authDomain}/${zO}`,s={apiKey:e.apiKey,appName:t.name,v:eo},i=YO.get(t.config.apiHost);i&&(s.eid=i);const r=t._getFrameworks();return r.length&&(s.fw=r.join(",")),`${n}?${Za(s).slice(1)}`}async function WO(t){const e=await VO(t),n=ts().gapi;return ee(n,t,"internal-error"),e.open({where:document.body,url:qO(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:KO,dontclear:!0},s=>new Promise(async(i,r)=>{await s.restyle({setHideOnLeave:!1});const a=Zn(t,"network-request-failed"),o=ts().setTimeout(()=>{r(a)},FO.get());function c(){ts().clearTimeout(o),i(s)}s.ping(c).then(c,()=>{r(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XO={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},QO=500,JO=600,ZO="_blank",eM="http://localhost";class Nx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function tM(t,e,n,s=QO,i=JO){const r=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-s)/2,0).toString();let o="";const c={...XO,width:s.toString(),height:i.toString(),top:r,left:a},u=Vt().toLowerCase();n&&(o=jN(u)?ZO:n),IN(u)&&(e=e||eM,c.scrollbars="yes");const d=Object.entries(c).reduce((h,[m,g])=>`${h}${m}=${g},`,"");if(b5(u)&&o!=="_self")return nM(e||"",o),new Nx(null);const f=window.open(e||"",o,d);ee(f,t,"popup-blocked");try{f.focus()}catch{}return new Nx(f)}function nM(t,e){const n=document.createElement("a");n.href=t,n.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sM="__/auth/handler",iM="emulator/auth/handler",rM=encodeURIComponent("fac");async function kx(t,e,n,s,i,r){ee(t.config.authDomain,t,"auth-domain-config-required"),ee(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:s,v:eo,eventId:i};if(e instanceof VN){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",Wu(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries({}))a[d]=f}if(e instanceof tc){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(a.scopes=d.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const d of Object.keys(o))o[d]===void 0&&delete o[d];const c=await t._getAppCheckToken(),u=c?`#${rM}=${encodeURIComponent(c)}`:"";return`${aM(t)}?${Za(o).slice(1)}${u}`}function aM({config:t}){return t.emulator?zg(t,iM):`https://${t.authDomain}/${sM}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hh="webStorageSupport";class oM{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=QN,this._completeRedirectFn=CO,this._overrideRedirectResult=AO}async _openPopup(e,n,s,i){var a;Os((a=this.eventManagers[e._key()])==null?void 0:a.manager,"_initialize() not called before _openPopup()");const r=await kx(e,n,s,Hm(),i);return tM(e,r,Wg())}async _openRedirect(e,n,s,i){await this._originValidation(e);const r=await kx(e,n,s,Hm(),i);return uO(r),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:r}=this.eventManagers[n];return i?Promise.resolve(i):(Os(r,"If manager is not set, promise should be"),r)}const s=this.initAndGetManager(e);return this.eventManagers[n]={promise:s},s.catch(()=>{delete this.eventManagers[n]}),s}async initAndGetManager(e){const n=await WO(e),s=new OO(e);return n.register("authEvent",i=>(ee(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:s.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=n,s}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(hh,{type:hh},i=>{var a;const r=(a=i==null?void 0:i[0])==null?void 0:a[hh];r!==void 0&&n(!!r),Fn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=BO(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return PN()||CN()||Kg()}}const lM=oM;var Sx="@firebase/auth",Tx="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cM{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ee(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uM(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function dM(t){Ca(new gr("auth",(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),r=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=s.options;ee(a&&!a.includes(":"),"invalid-api-key",{appName:s.name});const c={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:BN(t)},u=new E5(s,i,r,c);return O5(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,s)=>{e.getProvider("auth-internal").initialize()})),Ca(new gr("auth-internal",e=>{const n=Gs(e.getProvider("auth").getImmediate());return(s=>new cM(s))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),yi(Sx,Tx,uM(t)),yi(Sx,Tx,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fM=5*60,hM=dN("authIdTokenMaxAge")||fM;let Ax=null;const mM=t=>async e=>{const n=e&&await e.getIdTokenResult(),s=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(s&&s>hM)return;const i=n==null?void 0:n.token;Ax!==i&&(Ax=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function pM(t=xN()){const e=Vg(t,"auth");if(e.isInitialized())return e.getImmediate();const n=j5(t,{popupRedirectResolver:lM,persistence:[xO,oO,QN]}),s=dN("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const r=new URL(s,location.origin);if(location.origin===r.origin){const a=mM(r.toString());nO(n,a,()=>a(n.currentUser)),tO(n,o=>a(o))}}const i=cN("auth");return i&&M5(n,`http://${i}`),n}function gM(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}N5({loadJS(t){return new Promise((e,n)=>{const s=document.createElement("script");s.setAttribute("src",t),s.onload=e,s.onerror=i=>{const r=Zn("internal-error");r.customData=i,n(r)},s.type="text/javascript",s.charset="UTF-8",gM().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});dM("Browser");var Rx={};const Ix="@firebase/database",Cx="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ik="";function bM(t){ik=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vM{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),mt(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:vl(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xM{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return $n(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rk=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new vM(e)}}catch{}return new xM},Qi=rk("localStorage"),yM=rk("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ma=new Hg("@firebase/database"),ak=function(){let t=1;return function(){return t++}}(),ok=function(t){const e=V2(t),n=new B2;n.update(e);const s=n.digest();return Pg.encodeByteArray(s)},sc=function(...t){let e="";for(let n=0;n<t.length;n++){const s=t[n];Array.isArray(s)||s&&typeof s=="object"&&typeof s.length=="number"?e+=sc.apply(null,s):typeof s=="object"?e+=mt(s):e+=s,e+=" "}return e};let Yo=null,jx=!0;const _M=function(t,e){F(!0,"Can't turn on custom loggers persistently."),ma.logLevel=je.VERBOSE,Yo=ma.log.bind(ma)},_t=function(...t){if(jx===!0&&(jx=!1,Yo===null&&yM.get("logging_enabled")===!0&&_M()),Yo){const e=sc.apply(null,t);Yo(e)}},ic=function(t){return function(...e){_t(t,...e)}},Fm=function(...t){const e="FIREBASE INTERNAL ERROR: "+sc(...t);ma.error(e)},Ds=function(...t){const e=`FIREBASE FATAL ERROR: ${sc(...t)}`;throw ma.error(e),new Error(e)},Ht=function(...t){const e="FIREBASE WARNING: "+sc(...t);ma.warn(e)},wM=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Ht("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Zd=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},EM=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},ja="[MIN_NAME]",vr="[MAX_NAME]",Ar=function(t,e){if(t===e)return 0;if(t===ja||e===vr)return-1;if(e===ja||t===vr)return 1;{const n=Ox(t),s=Ox(e);return n!==null?s!==null?n-s===0?t.length-e.length:n-s:-1:s!==null?1:t<e?-1:1}},NM=function(t,e){return t===e?0:t<e?-1:1},bo=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+mt(e))},Qg=function(t){if(typeof t!="object"||t===null)return mt(t);const e=[];for(const s in t)e.push(s);e.sort();let n="{";for(let s=0;s<e.length;s++)s!==0&&(n+=","),n+=mt(e[s]),n+=":",n+=Qg(t[e[s]]);return n+="}",n},lk=function(t,e){const n=t.length;if(n<=e)return[t];const s=[];for(let i=0;i<n;i+=e)i+e>n?s.push(t.substring(i,n)):s.push(t.substring(i,i+e));return s};function Nt(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const ck=function(t){F(!Zd(t),"Invalid JSON number");const e=11,n=52,s=(1<<e-1)-1;let i,r,a,o,c;t===0?(r=0,a=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-s)?(o=Math.min(Math.floor(Math.log(t)/Math.LN2),s),r=o+s,a=Math.round(t*Math.pow(2,n-o)-Math.pow(2,n))):(r=0,a=Math.round(t/Math.pow(2,1-s-n))));const u=[];for(c=n;c;c-=1)u.push(a%2?1:0),a=Math.floor(a/2);for(c=e;c;c-=1)u.push(r%2?1:0),r=Math.floor(r/2);u.push(i?1:0),u.reverse();const d=u.join("");let f="";for(c=0;c<64;c+=8){let h=parseInt(d.substr(c,8),2).toString(16);h.length===1&&(h="0"+h),f=f+h}return f.toLowerCase()},kM=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},SM=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function TM(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const s=new Error(t+" at "+e._path.toString()+": "+n);return s.code=t.toUpperCase(),s}const AM=new RegExp("^-?(0*)\\d{1,10}$"),RM=-2147483648,IM=2147483647,Ox=function(t){if(AM.test(t)){const e=Number(t);if(e>=RM&&e<=IM)return e}return null},to=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw Ht("Exception was thrown by user callback.",n),e},Math.floor(0))}},CM=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},qo=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jM{constructor(e,n){this.appCheckProvider=n,this.appName=e.name,rn(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(s=>this.appCheck=s)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((n,s)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)==null||n.get().then(s=>s.addTokenListener(e))}notifyForInvalidToken(){Ht(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OM{constructor(e,n,s){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=s,this.auth_=null,this.auth_=s.getImmediate({optional:!0}),this.auth_||s.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(_t("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,s)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Ht(e)}}class hu{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}hu.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jg="5",uk="v",dk="s",fk="r",hk="f",mk=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,pk="ls",gk="p",zm="ac",bk="websocket",vk="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xk{constructor(e,n,s,i,r=!1,a="",o=!1,c=!1,u=null){this.secure=n,this.namespace=s,this.webSocketOnly=i,this.nodeAdmin=r,this.persistenceKey=a,this.includeNamespaceInQueryParams=o,this.isUsingEmulator=c,this.emulatorOptions=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Qi.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Qi.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function MM(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function yk(t,e,n){F(typeof e=="string","typeof type must == string"),F(typeof n=="object","typeof params must == object");let s;if(e===bk)s=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===vk)s=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);MM(t)&&(n.ns=t.namespace);const i=[];return Nt(n,(r,a)=>{i.push(r+"="+a)}),s+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DM{constructor(){this.counters_={}}incrementCounter(e,n=1){$n(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return b2(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mh={},ph={};function Zg(t){const e=t.toString();return mh[e]||(mh[e]=new DM),mh[e]}function LM(t,e){const n=t.toString();return ph[n]||(ph[n]=e()),ph[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PM{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const s=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<s.length;++i)s[i]&&to(()=>{this.onMessage_(s[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mx="start",BM="close",UM="pLPCommand",HM="pRTLPCB",_k="id",wk="pw",Ek="ser",GM="cb",VM="seg",FM="ts",zM="d",$M="dframe",Nk=1870,kk=30,KM=Nk-kk,YM=25e3,qM=3e4;class Jr{constructor(e,n,s,i,r,a,o){this.connId=e,this.repoInfo=n,this.applicationId=s,this.appCheckToken=i,this.authToken=r,this.transportSessionId=a,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=ic(e),this.stats_=Zg(n),this.urlFn=c=>(this.appCheckToken&&(c[zm]=this.appCheckToken),yk(n,vk,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new PM(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(qM)),EM(()=>{if(this.isClosed_)return;this.scriptTagHolder=new e0((...r)=>{const[a,o,c,u,d]=r;if(this.incrementIncomingBytes_(r),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,a===Mx)this.id=o,this.password=c;else if(a===BM)o?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(o,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+a)},(...r)=>{const[a,o]=r;this.incrementIncomingBytes_(r),this.myPacketOrderer.handleResponse(a,o)},()=>{this.onClosed_()},this.urlFn);const s={};s[Mx]="t",s[Ek]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(s[GM]=this.scriptTagHolder.uniqueCallbackIdentifier),s[uk]=Jg,this.transportSessionId&&(s[dk]=this.transportSessionId),this.lastSessionId&&(s[pk]=this.lastSessionId),this.applicationId&&(s[gk]=this.applicationId),this.appCheckToken&&(s[zm]=this.appCheckToken),typeof location<"u"&&location.hostname&&mk.test(location.hostname)&&(s[fk]=hk);const i=this.urlFn(s);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Jr.forceAllow_=!0}static forceDisallow(){Jr.forceDisallow_=!0}static isAvailable(){return Jr.forceAllow_?!0:!Jr.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!kM()&&!SM()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=mt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=oN(n),i=lk(s,KM);for(let r=0;r<i.length;r++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[r]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const s={};s[$M]="t",s[_k]=e,s[wk]=n,this.myDisconnFrame.src=this.urlFn(s),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=mt(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class e0{constructor(e,n,s,i){this.onDisconnect=s,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=ak(),window[UM+this.uniqueCallbackIdentifier]=e,window[HM+this.uniqueCallbackIdentifier]=n,this.myIFrame=e0.createIFrame_();let r="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(r='<script>document.domain="'+document.domain+'";<\/script>');const a="<html><body>"+r+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(o){_t("frame writing exception"),o.stack&&_t(o.stack),_t(o)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||_t("No IE domain setting required")}catch{const s=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+s+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[_k]=this.myID,e[wk]=this.myPW,e[Ek]=this.currentSerial;let n=this.urlFn(e),s="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+kk+s.length<=Nk;){const a=this.pendingSegs.shift();s=s+"&"+VM+i+"="+a.seg+"&"+FM+i+"="+a.ts+"&"+zM+i+"="+a.d,i++}return n=n+s,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,s){this.pendingSegs.push({seg:e,ts:n,d:s}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const s=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(s,Math.floor(YM)),r=()=>{clearTimeout(i),s()};this.addTag(e,r)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const s=this.myIFrame.doc.createElement("script");s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){const i=s.readyState;(!i||i==="loaded"||i==="complete")&&(s.onload=s.onreadystatechange=null,s.parentNode&&s.parentNode.removeChild(s),n())},s.onerror=()=>{_t("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(s)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WM=16384,XM=45e3;let id=null;typeof MozWebSocket<"u"?id=MozWebSocket:typeof WebSocket<"u"&&(id=WebSocket);class Un{constructor(e,n,s,i,r,a,o){this.connId=e,this.applicationId=s,this.appCheckToken=i,this.authToken=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=ic(this.connId),this.stats_=Zg(n),this.connURL=Un.connectionURL_(n,a,o,i,s),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,s,i,r){const a={};return a[uk]=Jg,typeof location<"u"&&location.hostname&&mk.test(location.hostname)&&(a[fk]=hk),n&&(a[dk]=n),s&&(a[pk]=s),i&&(a[zm]=i),r&&(a[gk]=r),yk(e,bk,a)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Qi.set("previous_websocket_failure",!0);try{let s;I2(),this.mySock=new id(this.connURL,[],s)}catch(s){this.log_("Error instantiating WebSocket.");const i=s.message||s.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=s=>{this.handleIncomingFrame(s)},this.mySock.onerror=s=>{this.log_("WebSocket error.  Closing connection.");const i=s.message||s.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){Un.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,s=navigator.userAgent.match(n);s&&s.length>1&&parseFloat(s[1])<4.4&&(e=!0)}return!e&&id!==null&&!Un.forceDisallow_}static previouslyFailed(){return Qi.isInMemoryStorage||Qi.get("previous_websocket_failure")===!0}markConnectionHealthy(){Qi.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const s=vl(n);this.onMessage(s)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(F(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const s=this.extractFrameCount_(n);s!==null&&this.appendFrame_(s)}}send(e){this.resetKeepAlive();const n=mt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=lk(n,WM);s.length>1&&this.sendString_(String(s.length));for(let i=0;i<s.length;i++)this.sendString_(s[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(XM))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Un.responsesRequiredToBeHealthy=2;Un.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class El{static get ALL_TRANSPORTS(){return[Jr,Un]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const n=Un&&Un.isAvailable();let s=n&&!Un.previouslyFailed();if(e.webSocketOnly&&(n||Ht("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[Un];else{const i=this.transports_=[];for(const r of El.ALL_TRANSPORTS)r&&r.isAvailable()&&i.push(r);El.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}El.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QM=6e4,JM=5e3,ZM=10*1024,eD=100*1024,gh="t",Dx="d",tD="s",Lx="r",nD="e",Px="o",Bx="a",Ux="n",Hx="p",sD="h";class iD{constructor(e,n,s,i,r,a,o,c,u,d){this.id=e,this.repoInfo_=n,this.applicationId_=s,this.appCheckToken_=i,this.authToken_=r,this.onMessage_=a,this.onReady_=o,this.onDisconnect_=c,this.onKill_=u,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=ic("c:"+this.id+":"),this.transportManager_=new El(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),s=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,s)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=qo(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>eD?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>ZM?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(gh in e){const n=e[gh];n===Bx?this.upgradeIfSecondaryHealthy_():n===Lx?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===Px&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=bo("t",e),s=bo("d",e);if(n==="c")this.onSecondaryControl_(s);else if(n==="d")this.pendingDataMessages.push(s);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Hx,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Bx,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Ux,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=bo("t",e),s=bo("d",e);n==="c"?this.onControl_(s):n==="d"&&this.onDataMessage_(s)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=bo(gh,e);if(Dx in e){const s=e[Dx];if(n===sD){const i={...s};this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===Ux){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===tD?this.onConnectionShutdown_(s):n===Lx?this.onReset_(s):n===nD?Fm("Server Error: "+s):n===Px?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Fm("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,s=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Jg!==s&&Ht("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),s=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,s),qo(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(QM))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):qo(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(JM))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Hx,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Qi.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sk{put(e,n,s,i){}merge(e,n,s,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,s){}onDisconnectMerge(e,n,s){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tk{constructor(e){this.allowedEvents_=e,this.listeners_={},F(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const s=[...this.listeners_[e]];for(let i=0;i<s.length;i++)s[i].callback.apply(s[i].context,n)}}on(e,n,s){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:s});const i=this.getInitialEvent(e);i&&n.apply(s,i)}off(e,n,s){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let r=0;r<i.length;r++)if(i[r].callback===n&&(!s||s===i[r].context)){i.splice(r,1);return}}validateEventType_(e){F(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rd extends Tk{static getInstance(){return new rd}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Ug()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return F(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gx=32,Vx=768;class Re{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let s=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[s]=this.pieces_[i],s++);this.pieces_.length=s,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function _e(){return new Re("")}function ue(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Ai(t){return t.pieces_.length-t.pieceNum_}function Me(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Re(t.pieces_,e)}function t0(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function rD(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Nl(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function Ak(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Re(e,0)}function Xe(t,e){const n=[];for(let s=t.pieceNum_;s<t.pieces_.length;s++)n.push(t.pieces_[s]);if(e instanceof Re)for(let s=e.pieceNum_;s<e.pieces_.length;s++)n.push(e.pieces_[s]);else{const s=e.split("/");for(let i=0;i<s.length;i++)s[i].length>0&&n.push(s[i])}return new Re(n,0)}function fe(t){return t.pieceNum_>=t.pieces_.length}function Pt(t,e){const n=ue(t),s=ue(e);if(n===null)return e;if(n===s)return Pt(Me(t),Me(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function aD(t,e){const n=Nl(t,0),s=Nl(e,0);for(let i=0;i<n.length&&i<s.length;i++){const r=Ar(n[i],s[i]);if(r!==0)return r}return n.length===s.length?0:n.length<s.length?-1:1}function n0(t,e){if(Ai(t)!==Ai(e))return!1;for(let n=t.pieceNum_,s=e.pieceNum_;n<=t.pieces_.length;n++,s++)if(t.pieces_[n]!==e.pieces_[s])return!1;return!0}function Nn(t,e){let n=t.pieceNum_,s=e.pieceNum_;if(Ai(t)>Ai(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[s])return!1;++n,++s}return!0}class oD{constructor(e,n){this.errorPrefix_=n,this.parts_=Nl(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let s=0;s<this.parts_.length;s++)this.byteLength_+=Wd(this.parts_[s]);Rk(this)}}function lD(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Wd(e),Rk(t)}function cD(t){const e=t.parts_.pop();t.byteLength_-=Wd(e),t.parts_.length>0&&(t.byteLength_-=1)}function Rk(t){if(t.byteLength_>Vx)throw new Error(t.errorPrefix_+"has a key path longer than "+Vx+" bytes ("+t.byteLength_+").");if(t.parts_.length>Gx)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Gx+") or object contains a cycle "+qi(t))}function qi(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s0 extends Tk{static getInstance(){return new s0}constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const s=!document[e];s!==this.visible_&&(this.visible_=s,this.trigger("visible",s))},!1)}getInitialEvent(e){return F(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vo=1e3,uD=60*5*1e3,Fx=30*1e3,dD=1.3,fD=3e4,hD="server_kill",zx=3;class ks extends Sk{constructor(e,n,s,i,r,a,o,c){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=s,this.onConnectStatus_=i,this.onServerInfoUpdate_=r,this.authTokenProvider_=a,this.appCheckTokenProvider_=o,this.authOverride_=c,this.id=ks.nextPersistentConnectionId_++,this.log_=ic("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=vo,this.maxReconnectDelay_=uD,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");s0.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&rd.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,s){const i=++this.requestNumber_,r={r:i,a:e,b:n};this.log_(mt(r)),F(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),s&&(this.requestCBHash_[i]=s)}get(e){this.initConnection_();const n=new Bn,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:a=>{const o=a.d;a.s==="ok"?n.resolve(o):n.reject(o)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),n.promise}listen(e,n,s,i){this.initConnection_();const r=e._queryIdentifier,a=e._path.toString();this.log_("Listen called for "+a+" "+r),this.listens.has(a)||this.listens.set(a,new Map),F(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),F(!this.listens.get(a).has(r),"listen() called twice for same path/queryId.");const o={onComplete:i,hashFn:n,query:e,tag:s};this.listens.get(a).set(r,o),this.connected_&&this.sendListen_(o)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,s=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(s)})}sendListen_(e){const n=e.query,s=n._path.toString(),i=n._queryIdentifier;this.log_("Listen on "+s+" for "+i);const r={p:s},a="q";e.tag&&(r.q=n._queryObject,r.t=e.tag),r.h=e.hashFn(),this.sendRequest(a,r,o=>{const c=o.d,u=o.s;ks.warnOnListenWarnings_(c,n),(this.listens.get(s)&&this.listens.get(s).get(i))===e&&(this.log_("listen response",o),u!=="ok"&&this.removeListen_(s,i),e.onComplete&&e.onComplete(u,c))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&$n(e,"w")){const s=mr(e,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){const i='".indexOn": "'+n._queryParams.getIndex().toString()+'"',r=n._path.toString();Ht(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${r} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||P2(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Fx)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=L2(e)?"auth":"gauth",s={cred:e};this.authOverride_===null?s.noauth=!0:typeof this.authOverride_=="object"&&(s.authvar=this.authOverride_),this.sendRequest(n,s,i=>{const r=i.s,a=i.d||"error";this.authToken_===e&&(r==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(r,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,s=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,s)})}unlisten(e,n){const s=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+s+" "+i),F(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,i)&&this.connected_&&this.sendUnlisten_(s,i,e._queryObject,n)}sendUnlisten_(e,n,s,i){this.log_("Unlisten on "+e+" for "+n);const r={p:e},a="n";i&&(r.q=s,r.t=i),this.sendRequest(a,r)}onDisconnectPut(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:s})}onDisconnectMerge(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:s})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,s,i){const r={p:n,d:s};this.log_("onDisconnect "+e,r),this.sendRequest(e,r,a=>{i&&setTimeout(()=>{i(a.s,a.d)},Math.floor(0))})}put(e,n,s,i){this.putInternal("p",e,n,s,i)}merge(e,n,s,i){this.putInternal("m",e,n,s,i)}putInternal(e,n,s,i,r){this.initConnection_();const a={p:n,d:s};r!==void 0&&(a.h=r),this.outstandingPuts_.push({action:e,request:a,onComplete:i}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,s=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,s,r=>{this.log_(n+" response",r),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(r.s,r.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,s=>{if(s.s!=="ok"){const r=s.d;this.log_("reportStats","Error sending stats: "+r)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+mt(e));const n=e.r,s=this.requestCBHash_[n];s&&(delete this.requestCBHash_[n],s(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):Fm("Unrecognized action received from server: "+mt(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){F(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=vo,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=vo,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>fD&&(this.reconnectDelay_=vo),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*dD)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),s=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+ks.nextConnectionId_++,r=this.lastSessionId;let a=!1,o=null;const c=function(){o?o.close():(a=!0,s())},u=function(f){F(o,"sendRequest call when we're not connected not allowed."),o.sendRequest(f)};this.realtime_={close:c,sendRequest:u};const d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[f,h]=await Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);a?_t("getToken() completed but was canceled"):(_t("getToken() completed. Creating connection."),this.authToken_=f&&f.accessToken,this.appCheckToken_=h&&h.token,o=new iD(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,s,m=>{Ht(m+" ("+this.repoInfo_.toString()+")"),this.interrupt(hD)},r))}catch(f){this.log_("Failed to get token: "+f),a||(this.repoInfo_.nodeAdmin&&Ht(f),c())}}}interrupt(e){_t("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){_t("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Wu(this.interruptReasons_)&&(this.reconnectDelay_=vo,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let s;n?s=n.map(r=>Qg(r)).join("$"):s="default";const i=this.removeListen_(e,s);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,n){const s=new Re(e).toString();let i;if(this.listens.has(s)){const r=this.listens.get(s);i=r.get(n),r.delete(n),r.size===0&&this.listens.delete(s)}else i=void 0;return i}onAuthRevoked_(e,n){_t("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=zx&&(this.reconnectDelay_=Fx,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){_t("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=zx&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+ik.replace(/\./g,"-")]=1,Ug()?e["framework.cordova"]=1:mN()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=rd.getInstance().currentlyOnline();return Wu(this.interruptReasons_)&&e}}ks.nextPersistentConnectionId_=0;ks.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class he{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new he(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const s=new he(ja,e),i=new he(ja,n);return this.compare(s,i)!==0}minPost(){return he.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bc;class Ik extends ef{static get __EMPTY_NODE(){return Bc}static set __EMPTY_NODE(e){Bc=e}compare(e,n){return Ar(e.name,n.name)}isDefinedOn(e){throw Qa("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return he.MIN}maxPost(){return new he(vr,Bc)}makePost(e,n){return F(typeof e=="string","KeyIndex indexValue must always be a string."),new he(e,Bc)}toString(){return".key"}}const pa=new Ik;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc{constructor(e,n,s,i,r=null){this.isReverse_=i,this.resultGenerator_=r,this.nodeStack_=[];let a=1;for(;!e.isEmpty();)if(e=e,a=n?s(e.key,n):1,i&&(a*=-1),a<0)this.isReverse_?e=e.left:e=e.right;else if(a===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class vt{constructor(e,n,s,i,r){this.key=e,this.value=n,this.color=s??vt.RED,this.left=i??Wt.EMPTY_NODE,this.right=r??Wt.EMPTY_NODE}copy(e,n,s,i,r){return new vt(e??this.key,n??this.value,s??this.color,i??this.left,r??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let i=this;const r=s(e,i.key);return r<0?i=i.copy(null,null,null,i.left.insert(e,n,s),null):r===0?i=i.copy(null,n,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,n,s)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return Wt.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let s,i;if(s=this,n(e,s.key)<0)!s.left.isEmpty()&&!s.left.isRed_()&&!s.left.left.isRed_()&&(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),!s.right.isEmpty()&&!s.right.isRed_()&&!s.right.left.isRed_()&&(s=s.moveRedRight_()),n(e,s.key)===0){if(s.right.isEmpty())return Wt.EMPTY_NODE;i=s.right.min_(),s=s.copy(i.key,i.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,vt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,vt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}vt.RED=!0;vt.BLACK=!1;class mD{copy(e,n,s,i,r){return this}insert(e,n,s){return new vt(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Wt{constructor(e,n=Wt.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new Wt(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,vt.BLACK,null,null))}remove(e){return new Wt(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,vt.BLACK,null,null))}get(e){let n,s=this.root_;for(;!s.isEmpty();){if(n=this.comparator_(e,s.key),n===0)return s.value;n<0?s=s.left:n>0&&(s=s.right)}return null}getPredecessorKey(e){let n,s=this.root_,i=null;for(;!s.isEmpty();)if(n=this.comparator_(e,s.key),n===0){if(s.left.isEmpty())return i?i.key:null;for(s=s.left;!s.right.isEmpty();)s=s.right;return s.key}else n<0?s=s.left:n>0&&(i=s,s=s.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Uc(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Uc(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Uc(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Uc(this.root_,null,this.comparator_,!0,e)}}Wt.EMPTY_NODE=new mD;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pD(t,e){return Ar(t.name,e.name)}function i0(t,e){return Ar(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $m;function gD(t){$m=t}const Ck=function(t){return typeof t=="number"?"number:"+ck(t):"string:"+t},jk=function(t){if(t.isLeafNode()){const e=t.val();F(typeof e=="string"||typeof e=="number"||typeof e=="object"&&$n(e,".sv"),"Priority must be a string or number.")}else F(t===$m||t.isEmpty(),"priority of unexpected type.");F(t===$m||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $x;class gt{static set __childrenNodeConstructor(e){$x=e}static get __childrenNodeConstructor(){return $x}constructor(e,n=gt.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,F(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),jk(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new gt(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:gt.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return fe(e)?this:ue(e)===".priority"?this.priorityNode_:gt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:gt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const s=ue(e);return s===null?n:n.isEmpty()&&s!==".priority"?this:(F(s!==".priority"||Ai(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(s,gt.__childrenNodeConstructor.EMPTY_NODE.updateChild(Me(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Ck(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=ck(this.value_):e+=this.value_,this.lazyHash_=ok(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===gt.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof gt.__childrenNodeConstructor?-1:(F(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,s=typeof this.value_,i=gt.VALUE_TYPE_ORDER.indexOf(n),r=gt.VALUE_TYPE_ORDER.indexOf(s);return F(i>=0,"Unknown leaf type: "+n),F(r>=0,"Unknown leaf type: "+s),i===r?s==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:r-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}gt.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ok,Mk;function bD(t){Ok=t}function vD(t){Mk=t}class xD extends ef{compare(e,n){const s=e.node.getPriority(),i=n.node.getPriority(),r=s.compareTo(i);return r===0?Ar(e.name,n.name):r}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return he.MIN}maxPost(){return new he(vr,new gt("[PRIORITY-POST]",Mk))}makePost(e,n){const s=Ok(e);return new he(n,new gt("[PRIORITY-POST]",s))}toString(){return".priority"}}const Ye=new xD;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yD=Math.log(2);class _D{constructor(e){const n=r=>parseInt(Math.log(r)/yD,10),s=r=>parseInt(Array(r+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const i=s(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const ad=function(t,e,n,s){t.sort(e);const i=function(c,u){const d=u-c;let f,h;if(d===0)return null;if(d===1)return f=t[c],h=n?n(f):f,new vt(h,f.node,vt.BLACK,null,null);{const m=parseInt(d/2,10)+c,g=i(c,m),v=i(m+1,u);return f=t[m],h=n?n(f):f,new vt(h,f.node,vt.BLACK,g,v)}},r=function(c){let u=null,d=null,f=t.length;const h=function(g,v){const x=f-g,p=f;f-=g;const b=i(x+1,p),y=t[x],E=n?n(y):y;m(new vt(E,y.node,v,null,b))},m=function(g){u?(u.left=g,u=g):(d=g,u=g)};for(let g=0;g<c.count;++g){const v=c.nextBitIsOne(),x=Math.pow(2,c.count-(g+1));v?h(x,vt.BLACK):(h(x,vt.BLACK),h(x,vt.RED))}return d},a=new _D(t.length),o=r(a);return new Wt(s||e,o)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bh;const Or={};class ys{static get Default(){return F(Or&&Ye,"ChildrenNode.ts has not been loaded"),bh=bh||new ys({".priority":Or},{".priority":Ye}),bh}constructor(e,n){this.indexes_=e,this.indexSet_=n}get(e){const n=mr(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Wt?n:null}hasIndex(e){return $n(this.indexSet_,e.toString())}addIndex(e,n){F(e!==pa,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const s=[];let i=!1;const r=n.getIterator(he.Wrap);let a=r.getNext();for(;a;)i=i||e.isDefinedOn(a.node),s.push(a),a=r.getNext();let o;i?o=ad(s,e.getCompare()):o=Or;const c=e.toString(),u={...this.indexSet_};u[c]=e;const d={...this.indexes_};return d[c]=o,new ys(d,u)}addToIndexes(e,n){const s=Xu(this.indexes_,(i,r)=>{const a=mr(this.indexSet_,r);if(F(a,"Missing index implementation for "+r),i===Or)if(a.isDefinedOn(e.node)){const o=[],c=n.getIterator(he.Wrap);let u=c.getNext();for(;u;)u.name!==e.name&&o.push(u),u=c.getNext();return o.push(e),ad(o,a.getCompare())}else return Or;else{const o=n.get(e.name);let c=i;return o&&(c=c.remove(new he(e.name,o))),c.insert(e,e.node)}});return new ys(s,this.indexSet_)}removeFromIndexes(e,n){const s=Xu(this.indexes_,i=>{if(i===Or)return i;{const r=n.get(e.name);return r?i.remove(new he(e.name,r)):i}});return new ys(s,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xo;class te{static get EMPTY_NODE(){return xo||(xo=new te(new Wt(i0),null,ys.Default))}constructor(e,n,s){this.children_=e,this.priorityNode_=n,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&jk(this.priorityNode_),this.children_.isEmpty()&&F(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||xo}updatePriority(e){return this.children_.isEmpty()?this:new te(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?xo:n}}getChild(e){const n=ue(e);return n===null?this:this.getImmediateChild(n).getChild(Me(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(F(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const s=new he(e,n);let i,r;n.isEmpty()?(i=this.children_.remove(e),r=this.indexMap_.removeFromIndexes(s,this.children_)):(i=this.children_.insert(e,n),r=this.indexMap_.addToIndexes(s,this.children_));const a=i.isEmpty()?xo:this.priorityNode_;return new te(i,a,r)}}updateChild(e,n){const s=ue(e);if(s===null)return n;{F(ue(e)!==".priority"||Ai(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(s).updateChild(Me(e),n);return this.updateImmediateChild(s,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let s=0,i=0,r=!0;if(this.forEachChild(Ye,(a,o)=>{n[a]=o.val(e),s++,r&&te.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):r=!1}),!e&&r&&i<2*s){const a=[];for(const o in n)a[o]=n[o];return a}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+Ck(this.getPriority().val())+":"),this.forEachChild(Ye,(n,s)=>{const i=s.hash();i!==""&&(e+=":"+n+":"+i)}),this.lazyHash_=e===""?"":ok(e)}return this.lazyHash_}getPredecessorChildName(e,n,s){const i=this.resolveIndex_(s);if(i){const r=i.getPredecessorKey(new he(e,n));return r?r.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.minKey();return s&&s.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new he(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.maxKey();return s&&s.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new he(n,this.children_.get(n)):null}forEachChild(e,n){const s=this.resolveIndex_(e);return s?s.inorderTraversal(i=>n(i.name,i.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,he.Wrap);let r=i.peek();for(;r!=null&&n.compare(r,e)<0;)i.getNext(),r=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,he.Wrap);let r=i.peek();for(;r!=null&&n.compare(r,e)>0;)i.getNext(),r=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===rc?-1:0}withIndex(e){if(e===pa||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new te(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===pa||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const s=this.getIterator(Ye),i=n.getIterator(Ye);let r=s.getNext(),a=i.getNext();for(;r&&a;){if(r.name!==a.name||!r.node.equals(a.node))return!1;r=s.getNext(),a=i.getNext()}return r===null&&a===null}else return!1;else return!1}}resolveIndex_(e){return e===pa?null:this.indexMap_.get(e.toString())}}te.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class wD extends te{constructor(){super(new Wt(i0),te.EMPTY_NODE,ys.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return te.EMPTY_NODE}isEmpty(){return!1}}const rc=new wD;Object.defineProperties(he,{MIN:{value:new he(ja,te.EMPTY_NODE)},MAX:{value:new he(vr,rc)}});Ik.__EMPTY_NODE=te.EMPTY_NODE;gt.__childrenNodeConstructor=te;gD(rc);vD(rc);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ED=!0;function We(t,e=null){if(t===null)return te.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),F(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new gt(n,We(e))}if(!(t instanceof Array)&&ED){const n=[];let s=!1;if(Nt(t,(a,o)=>{if(a.substring(0,1)!=="."){const c=We(o);c.isEmpty()||(s=s||!c.getPriority().isEmpty(),n.push(new he(a,c)))}}),n.length===0)return te.EMPTY_NODE;const r=ad(n,pD,a=>a.name,i0);if(s){const a=ad(n,Ye.getCompare());return new te(r,We(e),new ys({".priority":a},{".priority":Ye}))}else return new te(r,We(e),ys.Default)}else{let n=te.EMPTY_NODE;return Nt(t,(s,i)=>{if($n(t,s)&&s.substring(0,1)!=="."){const r=We(i);(r.isLeafNode()||!r.isEmpty())&&(n=n.updateImmediateChild(s,r))}}),n.updatePriority(We(e))}}bD(We);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ND extends ef{constructor(e){super(),this.indexPath_=e,F(!fe(e)&&ue(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const s=this.extractChild(e.node),i=this.extractChild(n.node),r=s.compareTo(i);return r===0?Ar(e.name,n.name):r}makePost(e,n){const s=We(e),i=te.EMPTY_NODE.updateChild(this.indexPath_,s);return new he(n,i)}maxPost(){const e=te.EMPTY_NODE.updateChild(this.indexPath_,rc);return new he(vr,e)}toString(){return Nl(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kD extends ef{compare(e,n){const s=e.node.compareTo(n.node);return s===0?Ar(e.name,n.name):s}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return he.MIN}maxPost(){return he.MAX}makePost(e,n){const s=We(e);return new he(n,s)}toString(){return".value"}}const SD=new kD;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dk(t){return{type:"value",snapshotNode:t}}function Oa(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function kl(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Sl(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function TD(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r0{constructor(e){this.index_=e}updateChild(e,n,s,i,r,a){F(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const o=e.getImmediateChild(n);return o.getChild(i).equals(s.getChild(i))&&o.isEmpty()===s.isEmpty()||(a!=null&&(s.isEmpty()?e.hasChild(n)?a.trackChildChange(kl(n,o)):F(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?a.trackChildChange(Oa(n,s)):a.trackChildChange(Sl(n,s,o))),e.isLeafNode()&&s.isEmpty())?e:e.updateImmediateChild(n,s).withIndex(this.index_)}updateFullNode(e,n,s){return s!=null&&(e.isLeafNode()||e.forEachChild(Ye,(i,r)=>{n.hasChild(i)||s.trackChildChange(kl(i,r))}),n.isLeafNode()||n.forEachChild(Ye,(i,r)=>{if(e.hasChild(i)){const a=e.getImmediateChild(i);a.equals(r)||s.trackChildChange(Sl(i,r,a))}else s.trackChildChange(Oa(i,r))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?te.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tl{constructor(e){this.indexedFilter_=new r0(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Tl.getStartPost_(e),this.endPost_=Tl.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,s=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&s}updateChild(e,n,s,i,r,a){return this.matches(new he(n,s))||(s=te.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,s,i,r,a)}updateFullNode(e,n,s){n.isLeafNode()&&(n=te.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(te.EMPTY_NODE);const r=this;return n.forEachChild(Ye,(a,o)=>{r.matches(new he(a,o))||(i=i.updateImmediateChild(a,te.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AD{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const s=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?s<=0:s<0},this.withinEndPost=n=>{const s=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?s<=0:s<0},this.rangedFilter_=new Tl(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,s,i,r,a){return this.rangedFilter_.matches(new he(n,s))||(s=te.EMPTY_NODE),e.getImmediateChild(n).equals(s)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,s,i,r,a):this.fullLimitUpdateChild_(e,n,s,r,a)}updateFullNode(e,n,s){let i;if(n.isLeafNode()||n.isEmpty())i=te.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=te.EMPTY_NODE.withIndex(this.index_);let r;this.reverse_?r=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):r=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let a=0;for(;r.hasNext()&&a<this.limit_;){const o=r.getNext();if(this.withinDirectionalStart(o))if(this.withinDirectionalEnd(o))i=i.updateImmediateChild(o.name,o.node),a++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(te.EMPTY_NODE);let r;this.reverse_?r=i.getReverseIterator(this.index_):r=i.getIterator(this.index_);let a=0;for(;r.hasNext();){const o=r.getNext();a<this.limit_&&this.withinDirectionalStart(o)&&this.withinDirectionalEnd(o)?a++:i=i.updateImmediateChild(o.name,te.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,s,i,r){let a;if(this.reverse_){const f=this.index_.getCompare();a=(h,m)=>f(m,h)}else a=this.index_.getCompare();const o=e;F(o.numChildren()===this.limit_,"");const c=new he(n,s),u=this.reverse_?o.getFirstChild(this.index_):o.getLastChild(this.index_),d=this.rangedFilter_.matches(c);if(o.hasChild(n)){const f=o.getImmediateChild(n);let h=i.getChildAfterChild(this.index_,u,this.reverse_);for(;h!=null&&(h.name===n||o.hasChild(h.name));)h=i.getChildAfterChild(this.index_,h,this.reverse_);const m=h==null?1:a(h,c);if(d&&!s.isEmpty()&&m>=0)return r!=null&&r.trackChildChange(Sl(n,s,f)),o.updateImmediateChild(n,s);{r!=null&&r.trackChildChange(kl(n,f));const v=o.updateImmediateChild(n,te.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(r!=null&&r.trackChildChange(Oa(h.name,h.node)),v.updateImmediateChild(h.name,h.node)):v}}else return s.isEmpty()?e:d&&a(u,c)>=0?(r!=null&&(r.trackChildChange(kl(u.name,u.node)),r.trackChildChange(Oa(n,s))),o.updateImmediateChild(n,s).updateImmediateChild(u.name,te.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a0{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ye}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return F(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return F(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ja}hasEnd(){return this.endSet_}getIndexEndValue(){return F(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return F(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:vr}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return F(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ye}copy(){const e=new a0;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function RD(t){return t.loadsAllData()?new r0(t.getIndex()):t.hasLimit()?new AD(t):new Tl(t)}function ID(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function Kx(t){const e={};if(t.isDefault())return e;let n;if(t.index_===Ye?n="$priority":t.index_===SD?n="$value":t.index_===pa?n="$key":(F(t.index_ instanceof ND,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=mt(n),t.startSet_){const s=t.startAfterSet_?"startAfter":"startAt";e[s]=mt(t.indexStartValue_),t.startNameSet_&&(e[s]+=","+mt(t.indexStartName_))}if(t.endSet_){const s=t.endBeforeSet_?"endBefore":"endAt";e[s]=mt(t.indexEndValue_),t.endNameSet_&&(e[s]+=","+mt(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function Yx(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Ye&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od extends Sk{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(F(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,n,s,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=s,this.appCheckTokenProvider_=i,this.log_=ic("p:rest:"),this.listens_={}}listen(e,n,s,i){const r=e._path.toString();this.log_("Listen called for "+r+" "+e._queryIdentifier);const a=od.getListenId_(e,s),o={};this.listens_[a]=o;const c=Kx(e._queryParams);this.restRequest_(r+".json",c,(u,d)=>{let f=d;if(u===404&&(f=null,u=null),u===null&&this.onDataUpdate_(r,f,!1,s),mr(this.listens_,a)===o){let h;u?u===401?h="permission_denied":h="rest_error:"+u:h="ok",i(h,null)}})}unlisten(e,n){const s=od.getListenId_(e,n);delete this.listens_[s]}get(e){const n=Kx(e._queryParams),s=e._path.toString(),i=new Bn;return this.restRequest_(s+".json",n,(r,a)=>{let o=a;r===404&&(o=null,r=null),r===null?(this.onDataUpdate_(s,o,!1,null),i.resolve(o)):i.reject(new Error(o))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},s){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,r])=>{i&&i.accessToken&&(n.auth=i.accessToken),r&&r.token&&(n.ac=r.token);const a=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Za(n);this.log_("Sending REST request for "+a);const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(s&&o.readyState===4){this.log_("REST Response for "+a+" received. status:",o.status,"response:",o.responseText);let c=null;if(o.status>=200&&o.status<300){try{c=vl(o.responseText)}catch{Ht("Failed to parse JSON response for "+a+": "+o.responseText)}s(null,c)}else o.status!==401&&o.status!==404&&Ht("Got unsuccessful REST response for "+a+" Status: "+o.status),s(o.status);s=null}},o.open("GET",a,!0),o.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CD{constructor(){this.rootNode_=te.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ld(){return{value:null,children:new Map}}function no(t,e,n){if(fe(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const s=ue(e);t.children.has(s)||t.children.set(s,ld());const i=t.children.get(s);e=Me(e),no(i,e,n)}}function Km(t,e){if(fe(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(Ye,(s,i)=>{no(t,new Re(s),i)}),Km(t,e)}}else if(t.children.size>0){const n=ue(e);return e=Me(e),t.children.has(n)&&Km(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function Ym(t,e,n){t.value!==null?n(e,t.value):jD(t,(s,i)=>{const r=new Re(e.toString()+"/"+s);Ym(i,r,n)})}function jD(t,e){t.children.forEach((n,s)=>{e(s,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OD{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n={...e};return this.last_&&Nt(this.last_,(s,i)=>{n[s]=n[s]-i}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qx=10*1e3,MD=30*1e3,DD=5*60*1e3;class LD{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new OD(e);const s=qx+(MD-qx)*Math.random();qo(this.reportStats_.bind(this),Math.floor(s))}reportStats_(){const e=this.statsListener_.get(),n={};let s=!1;Nt(e,(i,r)=>{r>0&&$n(this.statsToReport_,i)&&(n[i]=r,s=!0)}),s&&this.server_.reportStats(n),qo(this.reportStats_.bind(this),Math.floor(Math.random()*2*DD))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gn;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Gn||(Gn={}));function o0(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function l0(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function c0(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cd{constructor(e,n,s){this.path=e,this.affectedTree=n,this.revert=s,this.type=Gn.ACK_USER_WRITE,this.source=o0()}operationForChild(e){if(fe(this.path)){if(this.affectedTree.value!=null)return F(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Re(e));return new cd(_e(),n,this.revert)}}else return F(ue(this.path)===e,"operationForChild called for unrelated child."),new cd(Me(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Al{constructor(e,n){this.source=e,this.path=n,this.type=Gn.LISTEN_COMPLETE}operationForChild(e){return fe(this.path)?new Al(this.source,_e()):new Al(this.source,Me(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr{constructor(e,n,s){this.source=e,this.path=n,this.snap=s,this.type=Gn.OVERWRITE}operationForChild(e){return fe(this.path)?new xr(this.source,_e(),this.snap.getImmediateChild(e)):new xr(this.source,Me(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{constructor(e,n,s){this.source=e,this.path=n,this.children=s,this.type=Gn.MERGE}operationForChild(e){if(fe(this.path)){const n=this.children.subtree(new Re(e));return n.isEmpty()?null:n.value?new xr(this.source,_e(),n.value):new Ma(this.source,_e(),n)}else return F(ue(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Ma(this.source,Me(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(e,n,s){this.node_=e,this.fullyInitialized_=n,this.filtered_=s}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(fe(e))return this.isFullyInitialized()&&!this.filtered_;const n=ue(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PD{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function BD(t,e,n,s){const i=[],r=[];return e.forEach(a=>{a.type==="child_changed"&&t.index_.indexedValueChanged(a.oldSnap,a.snapshotNode)&&r.push(TD(a.childName,a.snapshotNode))}),yo(t,i,"child_removed",e,s,n),yo(t,i,"child_added",e,s,n),yo(t,i,"child_moved",r,s,n),yo(t,i,"child_changed",e,s,n),yo(t,i,"value",e,s,n),i}function yo(t,e,n,s,i,r){const a=s.filter(o=>o.type===n);a.sort((o,c)=>HD(t,o,c)),a.forEach(o=>{const c=UD(t,o,r);i.forEach(u=>{u.respondsTo(o.type)&&e.push(u.createEvent(c,t.query_))})})}function UD(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function HD(t,e,n){if(e.childName==null||n.childName==null)throw Qa("Should only compare child_ events.");const s=new he(e.childName,e.snapshotNode),i=new he(n.childName,n.snapshotNode);return t.index_.compare(s,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tf(t,e){return{eventCache:t,serverCache:e}}function Wo(t,e,n,s){return tf(new Ri(e,n,s),t.serverCache)}function Lk(t,e,n,s){return tf(t.eventCache,new Ri(e,n,s))}function ud(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function yr(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vh;const GD=()=>(vh||(vh=new Wt(NM)),vh);class Pe{static fromObject(e){let n=new Pe(null);return Nt(e,(s,i)=>{n=n.set(new Re(s),i)}),n}constructor(e,n=GD()){this.value=e,this.children=n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:_e(),value:this.value};if(fe(e))return null;{const s=ue(e),i=this.children.get(s);if(i!==null){const r=i.findRootMostMatchingPathAndValue(Me(e),n);return r!=null?{path:Xe(new Re(s),r.path),value:r.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(fe(e))return this;{const n=ue(e),s=this.children.get(n);return s!==null?s.subtree(Me(e)):new Pe(null)}}set(e,n){if(fe(e))return new Pe(n,this.children);{const s=ue(e),r=(this.children.get(s)||new Pe(null)).set(Me(e),n),a=this.children.insert(s,r);return new Pe(this.value,a)}}remove(e){if(fe(e))return this.children.isEmpty()?new Pe(null):new Pe(null,this.children);{const n=ue(e),s=this.children.get(n);if(s){const i=s.remove(Me(e));let r;return i.isEmpty()?r=this.children.remove(n):r=this.children.insert(n,i),this.value===null&&r.isEmpty()?new Pe(null):new Pe(this.value,r)}else return this}}get(e){if(fe(e))return this.value;{const n=ue(e),s=this.children.get(n);return s?s.get(Me(e)):null}}setTree(e,n){if(fe(e))return n;{const s=ue(e),r=(this.children.get(s)||new Pe(null)).setTree(Me(e),n);let a;return r.isEmpty()?a=this.children.remove(s):a=this.children.insert(s,r),new Pe(this.value,a)}}fold(e){return this.fold_(_e(),e)}fold_(e,n){const s={};return this.children.inorderTraversal((i,r)=>{s[i]=r.fold_(Xe(e,i),n)}),n(e,this.value,s)}findOnPath(e,n){return this.findOnPath_(e,_e(),n)}findOnPath_(e,n,s){const i=this.value?s(n,this.value):!1;if(i)return i;if(fe(e))return null;{const r=ue(e),a=this.children.get(r);return a?a.findOnPath_(Me(e),Xe(n,r),s):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,_e(),n)}foreachOnPath_(e,n,s){if(fe(e))return this;{this.value&&s(n,this.value);const i=ue(e),r=this.children.get(i);return r?r.foreachOnPath_(Me(e),Xe(n,i),s):new Pe(null)}}foreach(e){this.foreach_(_e(),e)}foreach_(e,n){this.children.inorderTraversal((s,i)=>{i.foreach_(Xe(e,s),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,s)=>{s.value&&e(n,s.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(e){this.writeTree_=e}static empty(){return new Vn(new Pe(null))}}function Xo(t,e,n){if(fe(e))return new Vn(new Pe(n));{const s=t.writeTree_.findRootMostValueAndPath(e);if(s!=null){const i=s.path;let r=s.value;const a=Pt(i,e);return r=r.updateChild(a,n),new Vn(t.writeTree_.set(i,r))}else{const i=new Pe(n),r=t.writeTree_.setTree(e,i);return new Vn(r)}}}function qm(t,e,n){let s=t;return Nt(n,(i,r)=>{s=Xo(s,Xe(e,i),r)}),s}function Wx(t,e){if(fe(e))return Vn.empty();{const n=t.writeTree_.setTree(e,new Pe(null));return new Vn(n)}}function Wm(t,e){return Rr(t,e)!=null}function Rr(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Pt(n.path,e)):null}function Xx(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Ye,(s,i)=>{e.push(new he(s,i))}):t.writeTree_.children.inorderTraversal((s,i)=>{i.value!=null&&e.push(new he(s,i.value))}),e}function _i(t,e){if(fe(e))return t;{const n=Rr(t,e);return n!=null?new Vn(new Pe(n)):new Vn(t.writeTree_.subtree(e))}}function Xm(t){return t.writeTree_.isEmpty()}function Da(t,e){return Pk(_e(),t.writeTree_,e)}function Pk(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let s=null;return e.children.inorderTraversal((i,r)=>{i===".priority"?(F(r.value!==null,"Priority writes must always be leaf nodes"),s=r.value):n=Pk(Xe(t,i),r,n)}),!n.getChild(t).isEmpty()&&s!==null&&(n=n.updateChild(Xe(t,".priority"),s)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nf(t,e){return Gk(e,t)}function VD(t,e,n,s,i){F(s>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:s,visible:i}),i&&(t.visibleWrites=Xo(t.visibleWrites,e,n)),t.lastWriteId=s}function FD(t,e,n,s){F(s>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:s,visible:!0}),t.visibleWrites=qm(t.visibleWrites,e,n),t.lastWriteId=s}function zD(t,e){for(let n=0;n<t.allWrites.length;n++){const s=t.allWrites[n];if(s.writeId===e)return s}return null}function $D(t,e){const n=t.allWrites.findIndex(o=>o.writeId===e);F(n>=0,"removeWrite called with nonexistent writeId.");const s=t.allWrites[n];t.allWrites.splice(n,1);let i=s.visible,r=!1,a=t.allWrites.length-1;for(;i&&a>=0;){const o=t.allWrites[a];o.visible&&(a>=n&&KD(o,s.path)?i=!1:Nn(s.path,o.path)&&(r=!0)),a--}if(i){if(r)return YD(t),!0;if(s.snap)t.visibleWrites=Wx(t.visibleWrites,s.path);else{const o=s.children;Nt(o,c=>{t.visibleWrites=Wx(t.visibleWrites,Xe(s.path,c))})}return!0}else return!1}function KD(t,e){if(t.snap)return Nn(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&Nn(Xe(t.path,n),e))return!0;return!1}function YD(t){t.visibleWrites=Bk(t.allWrites,qD,_e()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function qD(t){return t.visible}function Bk(t,e,n){let s=Vn.empty();for(let i=0;i<t.length;++i){const r=t[i];if(e(r)){const a=r.path;let o;if(r.snap)Nn(n,a)?(o=Pt(n,a),s=Xo(s,o,r.snap)):Nn(a,n)&&(o=Pt(a,n),s=Xo(s,_e(),r.snap.getChild(o)));else if(r.children){if(Nn(n,a))o=Pt(n,a),s=qm(s,o,r.children);else if(Nn(a,n))if(o=Pt(a,n),fe(o))s=qm(s,_e(),r.children);else{const c=mr(r.children,ue(o));if(c){const u=c.getChild(Me(o));s=Xo(s,_e(),u)}}}else throw Qa("WriteRecord should have .snap or .children")}}return s}function Uk(t,e,n,s,i){if(!s&&!i){const r=Rr(t.visibleWrites,e);if(r!=null)return r;{const a=_i(t.visibleWrites,e);if(Xm(a))return n;if(n==null&&!Wm(a,_e()))return null;{const o=n||te.EMPTY_NODE;return Da(a,o)}}}else{const r=_i(t.visibleWrites,e);if(!i&&Xm(r))return n;if(!i&&n==null&&!Wm(r,_e()))return null;{const a=function(u){return(u.visible||i)&&(!s||!~s.indexOf(u.writeId))&&(Nn(u.path,e)||Nn(e,u.path))},o=Bk(t.allWrites,a,e),c=n||te.EMPTY_NODE;return Da(o,c)}}}function WD(t,e,n){let s=te.EMPTY_NODE;const i=Rr(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Ye,(r,a)=>{s=s.updateImmediateChild(r,a)}),s;if(n){const r=_i(t.visibleWrites,e);return n.forEachChild(Ye,(a,o)=>{const c=Da(_i(r,new Re(a)),o);s=s.updateImmediateChild(a,c)}),Xx(r).forEach(a=>{s=s.updateImmediateChild(a.name,a.node)}),s}else{const r=_i(t.visibleWrites,e);return Xx(r).forEach(a=>{s=s.updateImmediateChild(a.name,a.node)}),s}}function XD(t,e,n,s,i){F(s||i,"Either existingEventSnap or existingServerSnap must exist");const r=Xe(e,n);if(Wm(t.visibleWrites,r))return null;{const a=_i(t.visibleWrites,r);return Xm(a)?i.getChild(n):Da(a,i.getChild(n))}}function QD(t,e,n,s){const i=Xe(e,n),r=Rr(t.visibleWrites,i);if(r!=null)return r;if(s.isCompleteForChild(n)){const a=_i(t.visibleWrites,i);return Da(a,s.getNode().getImmediateChild(n))}else return null}function JD(t,e){return Rr(t.visibleWrites,e)}function ZD(t,e,n,s,i,r,a){let o;const c=_i(t.visibleWrites,e),u=Rr(c,_e());if(u!=null)o=u;else if(n!=null)o=Da(c,n);else return[];if(o=o.withIndex(a),!o.isEmpty()&&!o.isLeafNode()){const d=[],f=a.getCompare(),h=r?o.getReverseIteratorFrom(s,a):o.getIteratorFrom(s,a);let m=h.getNext();for(;m&&d.length<i;)f(m,s)!==0&&d.push(m),m=h.getNext();return d}else return[]}function e4(){return{visibleWrites:Vn.empty(),allWrites:[],lastWriteId:-1}}function dd(t,e,n,s){return Uk(t.writeTree,t.treePath,e,n,s)}function u0(t,e){return WD(t.writeTree,t.treePath,e)}function Qx(t,e,n,s){return XD(t.writeTree,t.treePath,e,n,s)}function fd(t,e){return JD(t.writeTree,Xe(t.treePath,e))}function t4(t,e,n,s,i,r){return ZD(t.writeTree,t.treePath,e,n,s,i,r)}function d0(t,e,n){return QD(t.writeTree,t.treePath,e,n)}function Hk(t,e){return Gk(Xe(t.treePath,e),t.writeTree)}function Gk(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n4{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,s=e.childName;F(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),F(s!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(s);if(i){const r=i.type;if(n==="child_added"&&r==="child_removed")this.changeMap.set(s,Sl(s,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&r==="child_added")this.changeMap.delete(s);else if(n==="child_removed"&&r==="child_changed")this.changeMap.set(s,kl(s,i.oldSnap));else if(n==="child_changed"&&r==="child_added")this.changeMap.set(s,Oa(s,e.snapshotNode));else if(n==="child_changed"&&r==="child_changed")this.changeMap.set(s,Sl(s,e.snapshotNode,i.oldSnap));else throw Qa("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(s,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s4{getCompleteChild(e){return null}getChildAfterChild(e,n,s){return null}}const Vk=new s4;class f0{constructor(e,n,s=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=s}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const s=this.optCompleteServerCache_!=null?new Ri(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return d0(this.writes_,e,s)}}getChildAfterChild(e,n,s){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:yr(this.viewCache_),r=t4(this.writes_,i,n,1,s,e);return r.length===0?null:r[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i4(t){return{filter:t}}function r4(t,e){F(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),F(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function a4(t,e,n,s,i){const r=new n4;let a,o;if(n.type===Gn.OVERWRITE){const u=n;u.source.fromUser?a=Qm(t,e,u.path,u.snap,s,i,r):(F(u.source.fromServer,"Unknown source."),o=u.source.tagged||e.serverCache.isFiltered()&&!fe(u.path),a=hd(t,e,u.path,u.snap,s,i,o,r))}else if(n.type===Gn.MERGE){const u=n;u.source.fromUser?a=l4(t,e,u.path,u.children,s,i,r):(F(u.source.fromServer,"Unknown source."),o=u.source.tagged||e.serverCache.isFiltered(),a=Jm(t,e,u.path,u.children,s,i,o,r))}else if(n.type===Gn.ACK_USER_WRITE){const u=n;u.revert?a=d4(t,e,u.path,s,i,r):a=c4(t,e,u.path,u.affectedTree,s,i,r)}else if(n.type===Gn.LISTEN_COMPLETE)a=u4(t,e,n.path,s,r);else throw Qa("Unknown operation type: "+n.type);const c=r.getChanges();return o4(e,a,c),{viewCache:a,changes:c}}function o4(t,e,n){const s=e.eventCache;if(s.isFullyInitialized()){const i=s.getNode().isLeafNode()||s.getNode().isEmpty(),r=ud(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!s.getNode().equals(r)||!s.getNode().getPriority().equals(r.getPriority()))&&n.push(Dk(ud(e)))}}function Fk(t,e,n,s,i,r){const a=e.eventCache;if(fd(s,n)!=null)return e;{let o,c;if(fe(n))if(F(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const u=yr(e),d=u instanceof te?u:te.EMPTY_NODE,f=u0(s,d);o=t.filter.updateFullNode(e.eventCache.getNode(),f,r)}else{const u=dd(s,yr(e));o=t.filter.updateFullNode(e.eventCache.getNode(),u,r)}else{const u=ue(n);if(u===".priority"){F(Ai(n)===1,"Can't have a priority with additional path components");const d=a.getNode();c=e.serverCache.getNode();const f=Qx(s,n,d,c);f!=null?o=t.filter.updatePriority(d,f):o=a.getNode()}else{const d=Me(n);let f;if(a.isCompleteForChild(u)){c=e.serverCache.getNode();const h=Qx(s,n,a.getNode(),c);h!=null?f=a.getNode().getImmediateChild(u).updateChild(d,h):f=a.getNode().getImmediateChild(u)}else f=d0(s,u,e.serverCache);f!=null?o=t.filter.updateChild(a.getNode(),u,f,d,i,r):o=a.getNode()}}return Wo(e,o,a.isFullyInitialized()||fe(n),t.filter.filtersNodes())}}function hd(t,e,n,s,i,r,a,o){const c=e.serverCache;let u;const d=a?t.filter:t.filter.getIndexedFilter();if(fe(n))u=d.updateFullNode(c.getNode(),s,null);else if(d.filtersNodes()&&!c.isFiltered()){const m=c.getNode().updateChild(n,s);u=d.updateFullNode(c.getNode(),m,null)}else{const m=ue(n);if(!c.isCompleteForPath(n)&&Ai(n)>1)return e;const g=Me(n),x=c.getNode().getImmediateChild(m).updateChild(g,s);m===".priority"?u=d.updatePriority(c.getNode(),x):u=d.updateChild(c.getNode(),m,x,g,Vk,null)}const f=Lk(e,u,c.isFullyInitialized()||fe(n),d.filtersNodes()),h=new f0(i,f,r);return Fk(t,f,n,i,h,o)}function Qm(t,e,n,s,i,r,a){const o=e.eventCache;let c,u;const d=new f0(i,e,r);if(fe(n))u=t.filter.updateFullNode(e.eventCache.getNode(),s,a),c=Wo(e,u,!0,t.filter.filtersNodes());else{const f=ue(n);if(f===".priority")u=t.filter.updatePriority(e.eventCache.getNode(),s),c=Wo(e,u,o.isFullyInitialized(),o.isFiltered());else{const h=Me(n),m=o.getNode().getImmediateChild(f);let g;if(fe(h))g=s;else{const v=d.getCompleteChild(f);v!=null?t0(h)===".priority"&&v.getChild(Ak(h)).isEmpty()?g=v:g=v.updateChild(h,s):g=te.EMPTY_NODE}if(m.equals(g))c=e;else{const v=t.filter.updateChild(o.getNode(),f,g,h,d,a);c=Wo(e,v,o.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function Jx(t,e){return t.eventCache.isCompleteForChild(e)}function l4(t,e,n,s,i,r,a){let o=e;return s.foreach((c,u)=>{const d=Xe(n,c);Jx(e,ue(d))&&(o=Qm(t,o,d,u,i,r,a))}),s.foreach((c,u)=>{const d=Xe(n,c);Jx(e,ue(d))||(o=Qm(t,o,d,u,i,r,a))}),o}function Zx(t,e,n){return n.foreach((s,i)=>{e=e.updateChild(s,i)}),e}function Jm(t,e,n,s,i,r,a,o){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,u;fe(n)?u=s:u=new Pe(null).setTree(n,s);const d=e.serverCache.getNode();return u.children.inorderTraversal((f,h)=>{if(d.hasChild(f)){const m=e.serverCache.getNode().getImmediateChild(f),g=Zx(t,m,h);c=hd(t,c,new Re(f),g,i,r,a,o)}}),u.children.inorderTraversal((f,h)=>{const m=!e.serverCache.isCompleteForChild(f)&&h.value===null;if(!d.hasChild(f)&&!m){const g=e.serverCache.getNode().getImmediateChild(f),v=Zx(t,g,h);c=hd(t,c,new Re(f),v,i,r,a,o)}}),c}function c4(t,e,n,s,i,r,a){if(fd(i,n)!=null)return e;const o=e.serverCache.isFiltered(),c=e.serverCache;if(s.value!=null){if(fe(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return hd(t,e,n,c.getNode().getChild(n),i,r,o,a);if(fe(n)){let u=new Pe(null);return c.getNode().forEachChild(pa,(d,f)=>{u=u.set(new Re(d),f)}),Jm(t,e,n,u,i,r,o,a)}else return e}else{let u=new Pe(null);return s.foreach((d,f)=>{const h=Xe(n,d);c.isCompleteForPath(h)&&(u=u.set(d,c.getNode().getChild(h)))}),Jm(t,e,n,u,i,r,o,a)}}function u4(t,e,n,s,i){const r=e.serverCache,a=Lk(e,r.getNode(),r.isFullyInitialized()||fe(n),r.isFiltered());return Fk(t,a,n,s,Vk,i)}function d4(t,e,n,s,i,r){let a;if(fd(s,n)!=null)return e;{const o=new f0(s,e,i),c=e.eventCache.getNode();let u;if(fe(n)||ue(n)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=dd(s,yr(e));else{const f=e.serverCache.getNode();F(f instanceof te,"serverChildren would be complete if leaf node"),d=u0(s,f)}d=d,u=t.filter.updateFullNode(c,d,r)}else{const d=ue(n);let f=d0(s,d,e.serverCache);f==null&&e.serverCache.isCompleteForChild(d)&&(f=c.getImmediateChild(d)),f!=null?u=t.filter.updateChild(c,d,f,Me(n),o,r):e.eventCache.getNode().hasChild(d)?u=t.filter.updateChild(c,d,te.EMPTY_NODE,Me(n),o,r):u=c,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(a=dd(s,yr(e)),a.isLeafNode()&&(u=t.filter.updateFullNode(u,a,r)))}return a=e.serverCache.isFullyInitialized()||fd(s,_e())!=null,Wo(e,u,a,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f4{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const s=this.query_._queryParams,i=new r0(s.getIndex()),r=RD(s);this.processor_=i4(r);const a=n.serverCache,o=n.eventCache,c=i.updateFullNode(te.EMPTY_NODE,a.getNode(),null),u=r.updateFullNode(te.EMPTY_NODE,o.getNode(),null),d=new Ri(c,a.isFullyInitialized(),i.filtersNodes()),f=new Ri(u,o.isFullyInitialized(),r.filtersNodes());this.viewCache_=tf(f,d),this.eventGenerator_=new PD(this.query_)}get query(){return this.query_}}function h4(t){return t.viewCache_.serverCache.getNode()}function m4(t){return ud(t.viewCache_)}function p4(t,e){const n=yr(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!fe(e)&&!n.getImmediateChild(ue(e)).isEmpty())?n.getChild(e):null}function ey(t){return t.eventRegistrations_.length===0}function g4(t,e){t.eventRegistrations_.push(e)}function ty(t,e,n){const s=[];if(n){F(e==null,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach(r=>{const a=r.createCancelEvent(n,i);a&&s.push(a)})}if(e){let i=[];for(let r=0;r<t.eventRegistrations_.length;++r){const a=t.eventRegistrations_[r];if(!a.matches(e))i.push(a);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(r+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return s}function ny(t,e,n,s){e.type===Gn.MERGE&&e.source.queryId!==null&&(F(yr(t.viewCache_),"We should always have a full cache before handling merges"),F(ud(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,r=a4(t.processor_,i,e,n,s);return r4(t.processor_,r.viewCache),F(r.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=r.viewCache,zk(t,r.changes,r.viewCache.eventCache.getNode(),null)}function b4(t,e){const n=t.viewCache_.eventCache,s=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Ye,(r,a)=>{s.push(Oa(r,a))}),n.isFullyInitialized()&&s.push(Dk(n.getNode())),zk(t,s,n.getNode(),e)}function zk(t,e,n,s){const i=s?[s]:t.eventRegistrations_;return BD(t.eventGenerator_,e,n,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let md;class $k{constructor(){this.views=new Map}}function v4(t){F(!md,"__referenceConstructor has already been defined"),md=t}function x4(){return F(md,"Reference.ts has not been loaded"),md}function y4(t){return t.views.size===0}function h0(t,e,n,s){const i=e.source.queryId;if(i!==null){const r=t.views.get(i);return F(r!=null,"SyncTree gave us an op for an invalid query."),ny(r,e,n,s)}else{let r=[];for(const a of t.views.values())r=r.concat(ny(a,e,n,s));return r}}function Kk(t,e,n,s,i){const r=e._queryIdentifier,a=t.views.get(r);if(!a){let o=dd(n,i?s:null),c=!1;o?c=!0:s instanceof te?(o=u0(n,s),c=!1):(o=te.EMPTY_NODE,c=!1);const u=tf(new Ri(o,c,!1),new Ri(s,i,!1));return new f4(e,u)}return a}function _4(t,e,n,s,i,r){const a=Kk(t,e,s,i,r);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,a),g4(a,n),b4(a,n)}function w4(t,e,n,s){const i=e._queryIdentifier,r=[];let a=[];const o=Ii(t);if(i==="default")for(const[c,u]of t.views.entries())a=a.concat(ty(u,n,s)),ey(u)&&(t.views.delete(c),u.query._queryParams.loadsAllData()||r.push(u.query));else{const c=t.views.get(i);c&&(a=a.concat(ty(c,n,s)),ey(c)&&(t.views.delete(i),c.query._queryParams.loadsAllData()||r.push(c.query)))}return o&&!Ii(t)&&r.push(new(x4())(e._repo,e._path)),{removed:r,events:a}}function Yk(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function wi(t,e){let n=null;for(const s of t.views.values())n=n||p4(s,e);return n}function qk(t,e){if(e._queryParams.loadsAllData())return sf(t);{const s=e._queryIdentifier;return t.views.get(s)}}function Wk(t,e){return qk(t,e)!=null}function Ii(t){return sf(t)!=null}function sf(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pd;function E4(t){F(!pd,"__referenceConstructor has already been defined"),pd=t}function N4(){return F(pd,"Reference.ts has not been loaded"),pd}let k4=1;class sy{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Pe(null),this.pendingWriteTree_=e4(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function m0(t,e,n,s,i){return VD(t.pendingWriteTree_,e,n,s,i),i?so(t,new xr(o0(),e,n)):[]}function S4(t,e,n,s){FD(t.pendingWriteTree_,e,n,s);const i=Pe.fromObject(n);return so(t,new Ma(o0(),e,i))}function oi(t,e,n=!1){const s=zD(t.pendingWriteTree_,e);if($D(t.pendingWriteTree_,e)){let r=new Pe(null);return s.snap!=null?r=r.set(_e(),!0):Nt(s.children,a=>{r=r.set(new Re(a),!0)}),so(t,new cd(s.path,r,n))}else return[]}function ac(t,e,n){return so(t,new xr(l0(),e,n))}function T4(t,e,n){const s=Pe.fromObject(n);return so(t,new Ma(l0(),e,s))}function A4(t,e){return so(t,new Al(l0(),e))}function R4(t,e,n){const s=p0(t,n);if(s){const i=g0(s),r=i.path,a=i.queryId,o=Pt(r,e),c=new Al(c0(a),o);return b0(t,r,c)}else return[]}function gd(t,e,n,s,i=!1){const r=e._path,a=t.syncPointTree_.get(r);let o=[];if(a&&(e._queryIdentifier==="default"||Wk(a,e))){const c=w4(a,e,n,s);y4(a)&&(t.syncPointTree_=t.syncPointTree_.remove(r));const u=c.removed;if(o=c.events,!i){const d=u.findIndex(h=>h._queryParams.loadsAllData())!==-1,f=t.syncPointTree_.findOnPath(r,(h,m)=>Ii(m));if(d&&!f){const h=t.syncPointTree_.subtree(r);if(!h.isEmpty()){const m=j4(h);for(let g=0;g<m.length;++g){const v=m[g],x=v.query,p=Zk(t,v);t.listenProvider_.startListening(Qo(x),Rl(t,x),p.hashFn,p.onComplete)}}}!f&&u.length>0&&!s&&(d?t.listenProvider_.stopListening(Qo(e),null):u.forEach(h=>{const m=t.queryToTagMap.get(af(h));t.listenProvider_.stopListening(Qo(h),m)}))}O4(t,u)}return o}function Xk(t,e,n,s){const i=p0(t,s);if(i!=null){const r=g0(i),a=r.path,o=r.queryId,c=Pt(a,e),u=new xr(c0(o),c,n);return b0(t,a,u)}else return[]}function I4(t,e,n,s){const i=p0(t,s);if(i){const r=g0(i),a=r.path,o=r.queryId,c=Pt(a,e),u=Pe.fromObject(n),d=new Ma(c0(o),c,u);return b0(t,a,d)}else return[]}function Zm(t,e,n,s=!1){const i=e._path;let r=null,a=!1;t.syncPointTree_.foreachOnPath(i,(h,m)=>{const g=Pt(h,i);r=r||wi(m,g),a=a||Ii(m)});let o=t.syncPointTree_.get(i);o?(a=a||Ii(o),r=r||wi(o,_e())):(o=new $k,t.syncPointTree_=t.syncPointTree_.set(i,o));let c;r!=null?c=!0:(c=!1,r=te.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((m,g)=>{const v=wi(g,_e());v&&(r=r.updateImmediateChild(m,v))}));const u=Wk(o,e);if(!u&&!e._queryParams.loadsAllData()){const h=af(e);F(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");const m=M4();t.queryToTagMap.set(h,m),t.tagToQueryMap.set(m,h)}const d=nf(t.pendingWriteTree_,i);let f=_4(o,e,n,d,r,c);if(!u&&!a&&!s){const h=qk(o,e);f=f.concat(D4(t,e,h))}return f}function rf(t,e,n){const i=t.pendingWriteTree_,r=t.syncPointTree_.findOnPath(e,(a,o)=>{const c=Pt(a,e),u=wi(o,c);if(u)return u});return Uk(i,e,r,n,!0)}function C4(t,e){const n=e._path;let s=null;t.syncPointTree_.foreachOnPath(n,(u,d)=>{const f=Pt(u,n);s=s||wi(d,f)});let i=t.syncPointTree_.get(n);i?s=s||wi(i,_e()):(i=new $k,t.syncPointTree_=t.syncPointTree_.set(n,i));const r=s!=null,a=r?new Ri(s,!0,!1):null,o=nf(t.pendingWriteTree_,e._path),c=Kk(i,e,o,r?a.getNode():te.EMPTY_NODE,r);return m4(c)}function so(t,e){return Qk(e,t.syncPointTree_,null,nf(t.pendingWriteTree_,_e()))}function Qk(t,e,n,s){if(fe(t.path))return Jk(t,e,n,s);{const i=e.get(_e());n==null&&i!=null&&(n=wi(i,_e()));let r=[];const a=ue(t.path),o=t.operationForChild(a),c=e.children.get(a);if(c&&o){const u=n?n.getImmediateChild(a):null,d=Hk(s,a);r=r.concat(Qk(o,c,u,d))}return i&&(r=r.concat(h0(i,t,s,n))),r}}function Jk(t,e,n,s){const i=e.get(_e());n==null&&i!=null&&(n=wi(i,_e()));let r=[];return e.children.inorderTraversal((a,o)=>{const c=n?n.getImmediateChild(a):null,u=Hk(s,a),d=t.operationForChild(a);d&&(r=r.concat(Jk(d,o,c,u)))}),i&&(r=r.concat(h0(i,t,s,n))),r}function Zk(t,e){const n=e.query,s=Rl(t,n);return{hashFn:()=>(h4(e)||te.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return s?R4(t,n._path,s):A4(t,n._path);{const r=TM(i,n);return gd(t,n,null,r)}}}}function Rl(t,e){const n=af(e);return t.queryToTagMap.get(n)}function af(t){return t._path.toString()+"$"+t._queryIdentifier}function p0(t,e){return t.tagToQueryMap.get(e)}function g0(t){const e=t.indexOf("$");return F(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Re(t.substr(0,e))}}function b0(t,e,n){const s=t.syncPointTree_.get(e);F(s,"Missing sync point for query tag that we're tracking");const i=nf(t.pendingWriteTree_,e);return h0(s,n,i,null)}function j4(t){return t.fold((e,n,s)=>{if(n&&Ii(n))return[sf(n)];{let i=[];return n&&(i=Yk(n)),Nt(s,(r,a)=>{i=i.concat(a)}),i}})}function Qo(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(N4())(t._repo,t._path):t}function O4(t,e){for(let n=0;n<e.length;++n){const s=e[n];if(!s._queryParams.loadsAllData()){const i=af(s),r=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(r)}}}function M4(){return k4++}function D4(t,e,n){const s=e._path,i=Rl(t,e),r=Zk(t,n),a=t.listenProvider_.startListening(Qo(e),i,r.hashFn,r.onComplete),o=t.syncPointTree_.subtree(s);if(i)F(!Ii(o.value),"If we're adding a query, it shouldn't be shadowed");else{const c=o.fold((u,d,f)=>{if(!fe(u)&&d&&Ii(d))return[sf(d).query];{let h=[];return d&&(h=h.concat(Yk(d).map(m=>m.query))),Nt(f,(m,g)=>{h=h.concat(g)}),h}});for(let u=0;u<c.length;++u){const d=c[u];t.listenProvider_.stopListening(Qo(d),Rl(t,d))}}return a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v0{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new v0(n)}node(){return this.node_}}class x0{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=Xe(this.path_,e);return new x0(this.syncTree_,n)}node(){return rf(this.syncTree_,this.path_)}}const L4=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},iy=function(t,e,n){if(!t||typeof t!="object")return t;if(F(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return P4(t[".sv"],e,n);if(typeof t[".sv"]=="object")return B4(t[".sv"],e);F(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},P4=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:F(!1,"Unexpected server value: "+t)}},B4=function(t,e,n){t.hasOwnProperty("increment")||F(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const s=t.increment;typeof s!="number"&&F(!1,"Unexpected increment value: "+s);const i=e.node();if(F(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return s;const a=i.getValue();return typeof a!="number"?s:a+s},eS=function(t,e,n,s){return _0(e,new x0(n,t),s)},y0=function(t,e,n){return _0(t,new v0(e),n)};function _0(t,e,n){const s=t.getPriority().val(),i=iy(s,e.getImmediateChild(".priority"),n);let r;if(t.isLeafNode()){const a=t,o=iy(a.getValue(),e,n);return o!==a.getValue()||i!==a.getPriority().val()?new gt(o,We(i)):t}else{const a=t;return r=a,i!==a.getPriority().val()&&(r=r.updatePriority(new gt(i))),a.forEachChild(Ye,(o,c)=>{const u=_0(c,e.getImmediateChild(o),n);u!==c&&(r=r.updateImmediateChild(o,u))}),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w0{constructor(e="",n=null,s={children:{},childCount:0}){this.name=e,this.parent=n,this.node=s}}function of(t,e){let n=e instanceof Re?e:new Re(e),s=t,i=ue(n);for(;i!==null;){const r=mr(s.node.children,i)||{children:{},childCount:0};s=new w0(i,s,r),n=Me(n),i=ue(n)}return s}function Ir(t){return t.node.value}function E0(t,e){t.node.value=e,ep(t)}function tS(t){return t.node.childCount>0}function U4(t){return Ir(t)===void 0&&!tS(t)}function lf(t,e){Nt(t.node.children,(n,s)=>{e(new w0(n,t,s))})}function nS(t,e,n,s){n&&e(t),lf(t,i=>{nS(i,e,!0)})}function H4(t,e,n){let s=t.parent;for(;s!==null;){if(e(s))return!0;s=s.parent}return!1}function oc(t){return new Re(t.parent===null?t.name:oc(t.parent)+"/"+t.name)}function ep(t){t.parent!==null&&G4(t.parent,t.name,t)}function G4(t,e,n){const s=U4(n),i=$n(t.node.children,e);s&&i?(delete t.node.children[e],t.node.childCount--,ep(t)):!s&&!i&&(t.node.children[e]=n.node,t.node.childCount++,ep(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V4=/[\[\].#$\/\u0000-\u001F\u007F]/,F4=/[\[\].#$\u0000-\u001F\u007F]/,xh=10*1024*1024,N0=function(t){return typeof t=="string"&&t.length!==0&&!V4.test(t)},sS=function(t){return typeof t=="string"&&t.length!==0&&!F4.test(t)},z4=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),sS(t)},k0=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Zd(t)||t&&typeof t=="object"&&$n(t,".sv")},bd=function(t,e,n,s){s&&e===void 0||lc(Ia(t,"value"),e,n)},lc=function(t,e,n){const s=n instanceof Re?new oD(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+qi(s));if(typeof e=="function")throw new Error(t+"contains a function "+qi(s)+" with contents = "+e.toString());if(Zd(e))throw new Error(t+"contains "+e.toString()+" "+qi(s));if(typeof e=="string"&&e.length>xh/3&&Wd(e)>xh)throw new Error(t+"contains a string greater than "+xh+" utf8 bytes "+qi(s)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,r=!1;if(Nt(e,(a,o)=>{if(a===".value")i=!0;else if(a!==".priority"&&a!==".sv"&&(r=!0,!N0(a)))throw new Error(t+" contains an invalid key ("+a+") "+qi(s)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);lD(s,a),lc(t,o,s),cD(s)}),i&&r)throw new Error(t+' contains ".value" child '+qi(s)+" in addition to actual children.")}},$4=function(t,e){let n,s;for(n=0;n<e.length;n++){s=e[n];const r=Nl(s);for(let a=0;a<r.length;a++)if(!(r[a]===".priority"&&a===r.length-1)){if(!N0(r[a]))throw new Error(t+"contains an invalid key ("+r[a]+") in path "+s.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(aD);let i=null;for(n=0;n<e.length;n++){if(s=e[n],i!==null&&Nn(i,s))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+s.toString());i=s}},iS=function(t,e,n,s){const i=Ia(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const r=[];Nt(e,(a,o)=>{const c=new Re(a);if(lc(i,o,Xe(n,c)),t0(c)===".priority"&&!k0(o))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");r.push(c)}),$4(i,r)},K4=function(t,e,n){if(Zd(e))throw new Error(Ia(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!k0(e))throw new Error(Ia(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},rS=function(t,e,n,s){if(!sS(n))throw new Error(Ia(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},Y4=function(t,e,n,s){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),rS(t,e,n)},li=function(t,e){if(ue(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},q4=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!N0(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!z4(n))throw new Error(Ia(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W4{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function cf(t,e){let n=null;for(let s=0;s<e.length;s++){const i=e[s],r=i.getPath();n!==null&&!n0(r,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:r}),n.events.push(i)}n&&t.eventLists_.push(n)}function aS(t,e,n){cf(t,n),oS(t,s=>n0(s,e))}function hn(t,e,n){cf(t,n),oS(t,s=>Nn(s,e)||Nn(e,s))}function oS(t,e){t.recursionDepth_++;let n=!0;for(let s=0;s<t.eventLists_.length;s++){const i=t.eventLists_[s];if(i){const r=i.path;e(r)?(X4(t.eventLists_[s]),t.eventLists_[s]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function X4(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const s=n.getEventRunner();Yo&&_t("event: "+n.toString()),to(s)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q4="repo_interrupt",J4=25;class Z4{constructor(e,n,s,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=s,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new W4,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=ld(),this.transactionQueueTree_=new w0,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function eL(t,e,n){if(t.stats_=Zg(t.repoInfo_),t.forceRestClient_||CM())t.server_=new od(t.repoInfo_,(s,i,r,a)=>{ry(t,s,i,r,a)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>ay(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{mt(n)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}t.persistentConnection_=new ks(t.repoInfo_,e,(s,i,r,a)=>{ry(t,s,i,r,a)},s=>{ay(t,s)},s=>{tL(t,s)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(s=>{t.server_.refreshAuthToken(s)}),t.appCheckProvider_.addTokenChangeListener(s=>{t.server_.refreshAppCheckToken(s.token)}),t.statsReporter_=LM(t.repoInfo_,()=>new LD(t.stats_,t.server_)),t.infoData_=new CD,t.infoSyncTree_=new sy({startListening:(s,i,r,a)=>{let o=[];const c=t.infoData_.getNode(s._path);return c.isEmpty()||(o=ac(t.infoSyncTree_,s._path,c),setTimeout(()=>{a("ok")},0)),o},stopListening:()=>{}}),S0(t,"connected",!1),t.serverSyncTree_=new sy({startListening:(s,i,r,a)=>(t.server_.listen(s,r,i,(o,c)=>{const u=a(o,c);hn(t.eventQueue_,s._path,u)}),[]),stopListening:(s,i)=>{t.server_.unlisten(s,i)}})}function lS(t){const n=t.infoData_.getNode(new Re(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function cc(t){return L4({timestamp:lS(t)})}function ry(t,e,n,s,i){t.dataUpdateCount++;const r=new Re(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let a=[];if(i)if(s){const c=Xu(n,u=>We(u));a=I4(t.serverSyncTree_,r,c,i)}else{const c=We(n);a=Xk(t.serverSyncTree_,r,c,i)}else if(s){const c=Xu(n,u=>We(u));a=T4(t.serverSyncTree_,r,c)}else{const c=We(n);a=ac(t.serverSyncTree_,r,c)}let o=r;a.length>0&&(o=La(t,r)),hn(t.eventQueue_,o,a)}function ay(t,e){S0(t,"connected",e),e===!1&&rL(t)}function tL(t,e){Nt(e,(n,s)=>{S0(t,n,s)})}function S0(t,e,n){const s=new Re("/.info/"+e),i=We(n);t.infoData_.updateSnapshot(s,i);const r=ac(t.infoSyncTree_,s,i);hn(t.eventQueue_,s,r)}function uf(t){return t.nextWriteId_++}function nL(t,e,n){const s=C4(t.serverSyncTree_,e);return s!=null?Promise.resolve(s):t.server_.get(e).then(i=>{const r=We(i).withIndex(e._queryParams.getIndex());Zm(t.serverSyncTree_,e,n,!0);let a;if(e._queryParams.loadsAllData())a=ac(t.serverSyncTree_,e._path,r);else{const o=Rl(t.serverSyncTree_,e);a=Xk(t.serverSyncTree_,e._path,r,o)}return hn(t.eventQueue_,e._path,a),gd(t.serverSyncTree_,e,n,null,!0),r},i=>(io(t,"get for query "+mt(e)+" failed: "+i),Promise.reject(new Error(i))))}function sL(t,e,n,s,i){io(t,"set",{path:e.toString(),value:n,priority:s});const r=cc(t),a=We(n,s),o=rf(t.serverSyncTree_,e),c=y0(a,o,r),u=uf(t),d=m0(t.serverSyncTree_,e,c,u,!0);cf(t.eventQueue_,d),t.server_.put(e.toString(),a.val(!0),(h,m)=>{const g=h==="ok";g||Ht("set at "+e+" failed: "+h);const v=oi(t.serverSyncTree_,u,!g);hn(t.eventQueue_,e,v),Ci(t,i,h,m)});const f=A0(t,e);La(t,f),hn(t.eventQueue_,f,[])}function iL(t,e,n,s){io(t,"update",{path:e.toString(),value:n});let i=!0;const r=cc(t),a={};if(Nt(n,(o,c)=>{i=!1,a[o]=eS(Xe(e,o),We(c),t.serverSyncTree_,r)}),i)_t("update() called with empty data.  Don't do anything."),Ci(t,s,"ok",void 0);else{const o=uf(t),c=S4(t.serverSyncTree_,e,a,o);cf(t.eventQueue_,c),t.server_.merge(e.toString(),n,(u,d)=>{const f=u==="ok";f||Ht("update at "+e+" failed: "+u);const h=oi(t.serverSyncTree_,o,!f),m=h.length>0?La(t,e):e;hn(t.eventQueue_,m,h),Ci(t,s,u,d)}),Nt(n,u=>{const d=A0(t,Xe(e,u));La(t,d)}),hn(t.eventQueue_,e,[])}}function rL(t){io(t,"onDisconnectEvents");const e=cc(t),n=ld();Ym(t.onDisconnect_,_e(),(i,r)=>{const a=eS(i,r,t.serverSyncTree_,e);no(n,i,a)});let s=[];Ym(n,_e(),(i,r)=>{s=s.concat(ac(t.serverSyncTree_,i,r));const a=A0(t,i);La(t,a)}),t.onDisconnect_=ld(),hn(t.eventQueue_,_e(),s)}function aL(t,e,n){t.server_.onDisconnectCancel(e.toString(),(s,i)=>{s==="ok"&&Km(t.onDisconnect_,e),Ci(t,n,s,i)})}function oy(t,e,n,s){const i=We(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(r,a)=>{r==="ok"&&no(t.onDisconnect_,e,i),Ci(t,s,r,a)})}function oL(t,e,n,s,i){const r=We(n,s);t.server_.onDisconnectPut(e.toString(),r.val(!0),(a,o)=>{a==="ok"&&no(t.onDisconnect_,e,r),Ci(t,i,a,o)})}function lL(t,e,n,s){if(Wu(n)){_t("onDisconnect().update() called with empty data.  Don't do anything."),Ci(t,s,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,r)=>{i==="ok"&&Nt(n,(a,o)=>{const c=We(o);no(t.onDisconnect_,Xe(e,a),c)}),Ci(t,s,i,r)})}function cL(t,e,n){let s;ue(e._path)===".info"?s=Zm(t.infoSyncTree_,e,n):s=Zm(t.serverSyncTree_,e,n),aS(t.eventQueue_,e._path,s)}function uL(t,e,n){let s;ue(e._path)===".info"?s=gd(t.infoSyncTree_,e,n):s=gd(t.serverSyncTree_,e,n),aS(t.eventQueue_,e._path,s)}function dL(t){t.persistentConnection_&&t.persistentConnection_.interrupt(Q4)}function io(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),_t(n,...e)}function Ci(t,e,n,s){e&&to(()=>{if(n==="ok")e(null);else{const i=(n||"error").toUpperCase();let r=i;s&&(r+=": "+s);const a=new Error(r);a.code=i,e(a)}})}function fL(t,e,n,s,i,r){io(t,"transaction on "+e);const a={path:e,update:n,onComplete:s,status:null,order:ak(),applyLocally:r,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},o=T0(t,e,void 0);a.currentInputSnapshot=o;const c=a.update(o.val());if(c===void 0)a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete&&a.onComplete(null,!1,a.currentInputSnapshot);else{lc("transaction failed: Data returned ",c,a.path),a.status=0;const u=of(t.transactionQueueTree_,e),d=Ir(u)||[];d.push(a),E0(u,d);let f;typeof c=="object"&&c!==null&&$n(c,".priority")?(f=mr(c,".priority"),F(k0(f),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):f=(rf(t.serverSyncTree_,e)||te.EMPTY_NODE).getPriority().val();const h=cc(t),m=We(c,f),g=y0(m,o,h);a.currentOutputSnapshotRaw=m,a.currentOutputSnapshotResolved=g,a.currentWriteId=uf(t);const v=m0(t.serverSyncTree_,e,g,a.currentWriteId,a.applyLocally);hn(t.eventQueue_,e,v),df(t,t.transactionQueueTree_)}}function T0(t,e,n){return rf(t.serverSyncTree_,e,n)||te.EMPTY_NODE}function df(t,e=t.transactionQueueTree_){if(e||ff(t,e),Ir(e)){const n=uS(t,e);F(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&hL(t,oc(e),n)}else tS(e)&&lf(e,n=>{df(t,n)})}function hL(t,e,n){const s=n.map(u=>u.currentWriteId),i=T0(t,e,s);let r=i;const a=i.hash();for(let u=0;u<n.length;u++){const d=n[u];F(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;const f=Pt(e,d.path);r=r.updateChild(f,d.currentOutputSnapshotRaw)}const o=r.val(!0),c=e;t.server_.put(c.toString(),o,u=>{io(t,"transaction put response",{path:c.toString(),status:u});let d=[];if(u==="ok"){const f=[];for(let h=0;h<n.length;h++)n[h].status=2,d=d.concat(oi(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&f.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();ff(t,of(t.transactionQueueTree_,e)),df(t,t.transactionQueueTree_),hn(t.eventQueue_,e,d);for(let h=0;h<f.length;h++)to(f[h])}else{if(u==="datastale")for(let f=0;f<n.length;f++)n[f].status===3?n[f].status=4:n[f].status=0;else{Ht("transaction at "+c.toString()+" failed: "+u);for(let f=0;f<n.length;f++)n[f].status=4,n[f].abortReason=u}La(t,e)}},a)}function La(t,e){const n=cS(t,e),s=oc(n),i=uS(t,n);return mL(t,i,s),s}function mL(t,e,n){if(e.length===0)return;const s=[];let i=[];const a=e.filter(o=>o.status===0).map(o=>o.currentWriteId);for(let o=0;o<e.length;o++){const c=e[o],u=Pt(n,c.path);let d=!1,f;if(F(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)d=!0,f=c.abortReason,i=i.concat(oi(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=J4)d=!0,f="maxretry",i=i.concat(oi(t.serverSyncTree_,c.currentWriteId,!0));else{const h=T0(t,c.path,a);c.currentInputSnapshot=h;const m=e[o].update(h.val());if(m!==void 0){lc("transaction failed: Data returned ",m,c.path);let g=We(m);typeof m=="object"&&m!=null&&$n(m,".priority")||(g=g.updatePriority(h.getPriority()));const x=c.currentWriteId,p=cc(t),b=y0(g,h,p);c.currentOutputSnapshotRaw=g,c.currentOutputSnapshotResolved=b,c.currentWriteId=uf(t),a.splice(a.indexOf(x),1),i=i.concat(m0(t.serverSyncTree_,c.path,b,c.currentWriteId,c.applyLocally)),i=i.concat(oi(t.serverSyncTree_,x,!0))}else d=!0,f="nodata",i=i.concat(oi(t.serverSyncTree_,c.currentWriteId,!0))}hn(t.eventQueue_,n,i),i=[],d&&(e[o].status=2,function(h){setTimeout(h,Math.floor(0))}(e[o].unwatcher),e[o].onComplete&&(f==="nodata"?s.push(()=>e[o].onComplete(null,!1,e[o].currentInputSnapshot)):s.push(()=>e[o].onComplete(new Error(f),!1,null))))}ff(t,t.transactionQueueTree_);for(let o=0;o<s.length;o++)to(s[o]);df(t,t.transactionQueueTree_)}function cS(t,e){let n,s=t.transactionQueueTree_;for(n=ue(e);n!==null&&Ir(s)===void 0;)s=of(s,n),e=Me(e),n=ue(e);return s}function uS(t,e){const n=[];return dS(t,e,n),n.sort((s,i)=>s.order-i.order),n}function dS(t,e,n){const s=Ir(e);if(s)for(let i=0;i<s.length;i++)n.push(s[i]);lf(e,i=>{dS(t,i,n)})}function ff(t,e){const n=Ir(e);if(n){let s=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[s]=n[i],s++);n.length=s,E0(e,n.length>0?n:void 0)}lf(e,s=>{ff(t,s)})}function A0(t,e){const n=oc(cS(t,e)),s=of(t.transactionQueueTree_,e);return H4(s,i=>{yh(t,i)}),yh(t,s),nS(s,i=>{yh(t,i)}),n}function yh(t,e){const n=Ir(e);if(n){const s=[];let i=[],r=-1;for(let a=0;a<n.length;a++)n[a].status===3||(n[a].status===1?(F(r===a-1,"All SENT items should be at beginning of queue."),r=a,n[a].status=3,n[a].abortReason="set"):(F(n[a].status===0,"Unexpected transaction status in abort"),n[a].unwatcher(),i=i.concat(oi(t.serverSyncTree_,n[a].currentWriteId,!0)),n[a].onComplete&&s.push(n[a].onComplete.bind(null,new Error("set"),!1,null))));r===-1?E0(e,void 0):n.length=r+1,hn(t.eventQueue_,oc(e),i);for(let a=0;a<s.length;a++)to(s[a])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pL(t){let e="";const n=t.split("/");for(let s=0;s<n.length;s++)if(n[s].length>0){let i=n[s];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function gL(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const s=n.split("=");s.length===2?e[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):Ht(`Invalid query segment '${n}' in query '${t}'`)}return e}const ly=function(t,e){const n=bL(t),s=n.namespace;n.domain==="firebase.com"&&Ds(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!s||s==="undefined")&&n.domain!=="localhost"&&Ds("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||wM();const i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new xk(n.host,n.secure,s,i,e,"",s!==n.subdomain),path:new Re(n.pathString)}},bL=function(t){let e="",n="",s="",i="",r="",a=!0,o="https",c=443;if(typeof t=="string"){let u=t.indexOf("//");u>=0&&(o=t.substring(0,u-1),t=t.substring(u+2));let d=t.indexOf("/");d===-1&&(d=t.length);let f=t.indexOf("?");f===-1&&(f=t.length),e=t.substring(0,Math.min(d,f)),d<f&&(i=pL(t.substring(d,f)));const h=gL(t.substring(Math.min(t.length,f)));u=e.indexOf(":"),u>=0?(a=o==="https"||o==="wss",c=parseInt(e.substring(u+1),10)):u=e.length;const m=e.slice(0,u);if(m.toLowerCase()==="localhost")n="localhost";else if(m.split(".").length<=2)n=m;else{const g=e.indexOf(".");s=e.substring(0,g).toLowerCase(),n=e.substring(g+1),r=s}"ns"in h&&(r=h.ns)}return{host:e,port:c,domain:n,subdomain:s,secure:a,scheme:o,pathString:i,namespace:r}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cy="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",vL=function(){let t=0;const e=[];return function(n){const s=n===t;t=n;let i;const r=new Array(8);for(i=7;i>=0;i--)r[i]=cy.charAt(n%64),n=Math.floor(n/64);F(n===0,"Cannot push at time == 0");let a=r.join("");if(s){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)a+=cy.charAt(e[i]);return F(a.length===20,"nextPushId: Length should be 20."),a}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xL{constructor(e,n,s,i){this.eventType=e,this.eventRegistration=n,this.snapshot=s,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+mt(this.snapshot.exportVal())}}class yL{constructor(e,n,s){this.eventRegistration=e,this.error=n,this.path=s}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return F(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _L{constructor(e,n){this._repo=e,this._path=n}cancel(){const e=new Bn;return aL(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){li("OnDisconnect.remove",this._path);const e=new Bn;return oy(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){li("OnDisconnect.set",this._path),bd("OnDisconnect.set",e,this._path,!1);const n=new Bn;return oy(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){li("OnDisconnect.setWithPriority",this._path),bd("OnDisconnect.setWithPriority",e,this._path,!1),K4("OnDisconnect.setWithPriority",n);const s=new Bn;return oL(this._repo,this._path,e,n,s.wrapCallback(()=>{})),s.promise}update(e){li("OnDisconnect.update",this._path),iS("OnDisconnect.update",e,this._path);const n=new Bn;return lL(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hf{constructor(e,n,s,i){this._repo=e,this._path=n,this._queryParams=s,this._orderByCalled=i}get key(){return fe(this._path)?null:t0(this._path)}get ref(){return new as(this._repo,this._path)}get _queryIdentifier(){const e=Yx(this._queryParams),n=Qg(e);return n==="{}"?"default":n}get _queryObject(){return Yx(this._queryParams)}isEqual(e){if(e=dt(e),!(e instanceof hf))return!1;const n=this._repo===e._repo,s=n0(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&s&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+rD(this._path)}}class as extends hf{constructor(e,n){super(e,n,new a0,!1)}get parent(){const e=Ak(this._path);return e===null?null:new as(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class Pa{constructor(e,n,s){this._node=e,this.ref=n,this._index=s}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new Re(e),s=Il(this.ref,e);return new Pa(this._node.getChild(n),s,Ye)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(s,i)=>e(new Pa(i,Il(this.ref,s),Ye)))}hasChild(e){const n=new Re(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function D(t,e){return t=dt(t),t._checkNotDeleted("ref"),e!==void 0?Il(t._root,e):t._root}function Il(t,e){return t=dt(t),ue(t._path)===null?Y4("child","path",e):rS("child","path",e),new as(t._repo,Xe(t._path,e))}function uy(t){return t=dt(t),new _L(t._repo,t._path)}function hS(t,e){t=dt(t),li("push",t._path),bd("push",e,t._path,!0);const n=lS(t._repo),s=vL(n),i=Il(t,s),r=Il(t,s);let a;return a=Promise.resolve(r),i.then=a.then.bind(a),i.catch=a.then.bind(a,void 0),i}function dy(t){return li("remove",t._path),Ba(t,null)}function Ba(t,e){t=dt(t),li("set",t._path),bd("set",e,t._path,!1);const n=new Bn;return sL(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function J(t,e){iS("update",e,t._path);const n=new Bn;return iL(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function xe(t){t=dt(t);const e=new fS(()=>{}),n=new mf(e);return nL(t._repo,t,n).then(s=>new Pa(s,new as(t._repo,t._path),t._queryParams.getIndex()))}class mf{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const s=n._queryParams.getIndex();return new xL("value",this,new Pa(e.snapshotNode,new as(n._repo,n._path),s))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new yL(this,e,n):null}matches(e){return e instanceof mf?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function wL(t,e,n,s,i){const r=new fS(n,void 0),a=new mf(r);return cL(t._repo,t,a),()=>uL(t._repo,t,a)}function Ke(t,e,n,s){return wL(t,"value",e)}class EL{}class NL extends EL{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new hf(e._repo,e._path,ID(e._queryParams,this._limit),e._orderByCalled)}}function kL(t){if(Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new NL(t)}function SL(t,...e){let n=dt(t);for(const s of e)n=s._apply(n);return n}v4(as);E4(as);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TL="FIREBASE_DATABASE_EMULATOR_HOST",tp={};let AL=!1;function RL(t,e,n,s){const i=e.lastIndexOf(":"),r=e.substring(0,i),a=Ja(r);t.repoInfo_=new xk(e,a,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0,n),s&&(t.authTokenProvider_=s)}function IL(t,e,n,s,i){let r=s||t.options.databaseURL;r===void 0&&(t.options.projectId||Ds("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),_t("Using default host for project ",t.options.projectId),r=`${t.options.projectId}-default-rtdb.firebaseio.com`);let a=ly(r,i),o=a.repoInfo,c;typeof process<"u"&&Rx&&(c=Rx[TL]),c?(r=`http://${c}?ns=${o.namespace}`,a=ly(r,i),o=a.repoInfo):a.repoInfo.secure;const u=new OM(t.name,t.options,e);q4("Invalid Firebase Database URL",a),fe(a.path)||Ds("Database URL must point to the root of a Firebase Database (not including a child path).");const d=jL(o,t,u,new jM(t,n));return new OL(d,t)}function CL(t,e){const n=tp[e];(!n||n[t.key]!==t)&&Ds(`Database ${e}(${t.repoInfo_}) has already been deleted.`),dL(t),delete n[t.key]}function jL(t,e,n,s){let i=tp[e.name];i||(i={},tp[e.name]=i);let r=i[t.toURLString()];return r&&Ds("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new Z4(t,AL,n,s),i[t.toURLString()]=r,r}class OL{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(eL(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new as(this._repo,_e())),this._rootInternal}_delete(){return this._rootInternal!==null&&(CL(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Ds("Cannot call "+e+" on a deleted database.")}}function ML(t=xN(),e){const n=Vg(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const s=E2("database");s&&DL(n,...s)}return n}function DL(t,e,n,s={}){t=dt(t),t._checkNotDeleted("useEmulator");const i=`${e}:${n}`,r=t._repoInternal;if(t._instanceStarted){if(i===t._repoInternal.repoInfo_.host&&pr(s,r.repoInfo_.emulatorOptions))return;Ds("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let a;if(r.repoInfo_.nodeAdmin)s.mockUserToken&&Ds('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new hu(hu.OWNER);else if(s.mockUserToken){const o=typeof s.mockUserToken=="string"?s.mockUserToken:N2(s.mockUserToken,t.app.options.projectId);a=new hu(o)}Ja(e)&&(fN(e),hN("Database",!0)),RL(r,i,s,a)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LL(t){bM(eo),Ca(new gr("database",(e,{instanceIdentifier:n})=>{const s=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),r=e.getProvider("app-check-internal");return IL(s,i,r,n)},"PUBLIC").setMultipleInstances(!0)),yi(Ix,Cx,t),yi(Ix,Cx,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PL={".sv":"timestamp"};function BL(){return PL}function mS(t){return{".sv":{increment:t}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UL{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function Ae(t,e,n){if(t=dt(t),li("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";const s=!0,i=new Bn,r=(o,c,u)=>{let d=null;o?i.reject(o):(d=new Pa(u,new as(t._repo,t._path),Ye),i.resolve(new UL(c,d)))},a=Ke(t,()=>{});return fL(t._repo,t._path,e,r,a,s),i.promise}ks.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};ks.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};LL();var HL="firebase",GL="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */yi(HL,GL,"app");const VL={apiKey:"AIzaSyBU11CvtAaUkADomFxcMuN6fH9ipx-VtAs",authDomain:"eiriksbok-simuleringfeudal.firebaseapp.com",databaseURL:"https://eiriksbok-simuleringfeudal-default-rtdb.europe-west1.firebasedatabase.app",projectId:"eiriksbok-simuleringfeudal",storageBucket:"eiriksbok-simuleringfeudal.firebasestorage.app",messagingSenderId:"772081963542",appId:"1:772081963542:web:05edb87535f629fd36db37",measurementId:"G-NDR8LNVQNX"},pS=vN(VL,"simulationApp"),L=ML(pS),Mr=pM(pS),gS=_.createContext(void 0),FL=({children:t})=>{const[e,n]=_.useState(null),[s,i]=_.useState(null),[r,a]=_.useState(!0),[o,c]=_.useState(null),[u,d]=_.useState(!0);_.useEffect(()=>{const x=sO(Mr,async p=>{if(p){n(p),d(p.isAnonymous);const b=D(L,`simulation_accounts/${p.uid}`),y=Ke(b,async E=>{if(E.exists())i(E.val()),a(!1);else{const N={uid:p.uid,displayName:p.displayName||`Eventyrer_${p.uid.slice(0,4)}`,globalXp:0,globalLevel:1,totalGoldEarned:0,unlockedAchievements:[],characterHistory:[],lastActive:Date.now()};await Ba(b,N),i(N),a(!1)}});return()=>y()}else{d(!0);try{await K5(Mr)}catch(b){console.error("Auth failed:",b),a(!1)}}});return()=>x()},[]);const f=async(x,p)=>{c(null);try{await eO(Mr,x,p)}catch(b){throw c(b.message),b}},h=async x=>{const p=x.trim().toLowerCase();if(!p||p.length<3)return!1;const b=D(L,`simulation_reserved_names/${p}`);return!(await xe(b)).exists()},m=async(x,p,b)=>{c(null);const y=b.trim(),E=y.toLowerCase();try{if(!await h(y))throw new Error("Navnet er allerede tatt.");if(e&&e.isAnonymous){const A=Tr.credential(x,p);await Q5(e,A);const w={};w[`simulation_accounts/${e.uid}/displayName`]=y,w[`simulation_reserved_names/${E}`]=e.uid,await J(D(L),w)}else{const A=await Z5(Mr,x,p),w={};w[`simulation_reserved_names/${E}`]=A.user.uid;const T={uid:A.user.uid,displayName:y,globalXp:0,globalLevel:1,totalGoldEarned:0,unlockedAchievements:[],characterHistory:[],lastActive:Date.now()};w[`simulation_accounts/${A.user.uid}`]=T,await J(D(L),w)}}catch(N){throw c(N.message),N}},g=async()=>{await iO(Mr)},v=async x=>{try{await J5(Mr,x)}catch(p){throw c(p.message),p}};return l.jsx(gS.Provider,{value:{user:e,account:s,loading:r,isAnonymous:u,error:o,login:f,register:m,logout:g,resetPassword:v,checkNameAvailability:h},children:t})},pf=()=>{const t=_.useContext(gS);if(!t)throw new Error("useSimulationAuth must be used within a SimulationAuthProvider");return t},bS=[{id:"Ashes of the Keep.mp3",title:"Festningens Aske",mood:"Dark"},{id:"Banner at the Old Stone Keep.mp3",title:"Gamle Steiner",mood:"Epic"},{id:"Banner at the Old Stone Keep (1).mp3",title:"Steinhallens Hymne",mood:"Epic"},{id:"Burning Banners Over Stone.mp3",title:"Brennende Bannere",mood:"Dark"},{id:"Candlelit Keep.mp3",title:"Lys i Hallen",mood:"Calm"},{id:"Candlelit Keep (1).mp3",title:"Nattens Vakt",mood:"Calm"},{id:"Crown of Quiet Rooms.mp3",title:"Stillhetens Krone",mood:"Mysterious"},{id:"Crown of Quiet Rooms (1).mp3",title:"Kongens Tvil",mood:"Mysterious"}],Xi=class Xi{constructor(){ze(this,"sfxVolume",.5);ze(this,"musicVolume",.3);ze(this,"currentMusic",null);ze(this,"currentMusicKey",null);ze(this,"playlist",[]);ze(this,"playlistIndex",0);ze(this,"isPlaylistActive",!1);ze(this,"ignoredTracks",new Set);ze(this,"audioContext",null);ze(this,"filterNode",null);ze(this,"isMuffledState",!1);ze(this,"activeFades",new Map);const e=localStorage.getItem("sim_sfx_volume"),n=localStorage.getItem("sim_music_volume"),s=localStorage.getItem("sim_music_muffled"),i=localStorage.getItem("sim_music_ignored");if(e&&(this.sfxVolume=parseFloat(e)),n&&(this.musicVolume=parseFloat(n)),s&&(this.isMuffledState=s==="true"),i)try{this.ignoredTracks=new Set(JSON.parse(i))}catch(r){console.error("Failed to parse ignored tracks",r)}this.playlist=bS.map(r=>r.id),this.shufflePlaylist()}shufflePlaylist(){this.playlist=this.playlist.sort(()=>Math.random()-.5)}initAudioContext(){if(!this.audioContext)try{this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.filterNode=this.audioContext.createBiquadFilter(),this.filterNode.type="lowpass",this.filterNode.frequency.setValueAtTime(this.isMuffledState?12e3:2e4,this.audioContext.currentTime),this.filterNode.connect(this.audioContext.destination)}catch(e){console.error("Failed to initialize AudioContext",e)}this.audioContext&&this.audioContext.state==="suspended"&&this.audioContext.resume()}static getInstance(){return Xi.instance||(Xi.instance=new Xi),Xi.instance}setSfxVolume(e){this.sfxVolume=Math.max(0,Math.min(1,e)),localStorage.setItem("sim_sfx_volume",this.sfxVolume.toString())}setMusicVolume(e){this.musicVolume=Math.max(0,Math.min(1,e)),localStorage.setItem("sim_music_volume",this.musicVolume.toString()),this.currentMusic&&(this.currentMusic.volume=this.musicVolume)}setMuffled(e){this.isMuffledState=e,localStorage.setItem("sim_music_muffled",e.toString()),this.filterNode&&this.audioContext&&this.filterNode.frequency.setTargetAtTime(e?15e3:2e4,this.audioContext.currentTime,.1)}toggleIgnoreTrack(e){this.ignoredTracks.has(e)?this.ignoredTracks.delete(e):this.ignoredTracks.add(e),localStorage.setItem("sim_music_ignored",JSON.stringify(Array.from(this.ignoredTracks))),this.ignoredTracks.has(e)&&this.currentMusicKey===e&&this.isPlaylistActive&&this.playNextInPlaylist()}isIgnored(e){return this.ignoredTracks.has(e)}getSfxVolume(){return this.sfxVolume}getMusicVolume(){return this.musicVolume}isMuffled(){return this.isMuffledState}getCurrentTrackId(){return this.currentMusicKey}playSfx(e){if(this.sfxVolume===0)return;const s=`/sounds/sfx/${e.includes(".")?e:`${e}.mp3`}`,i=new Audio(s);i.volume=this.sfxVolume,i.play().catch(()=>{})}startPlaylist(){this.isPlaylistActive&&this.currentMusic||(this.isPlaylistActive=!0,this.currentMusic||this.playNextInPlaylist())}playNextInPlaylist(){if(!this.isPlaylistActive)return;let e=0,n=!1;for(;e<this.playlist.length;){this.playlistIndex=(this.playlistIndex+1)%this.playlist.length;const s=this.playlist[this.playlistIndex];if(!this.ignoredTracks.has(s)){this.playMusic(s,2e3,!1),n=!0;break}e++}n||(console.warn("All tracks are ignored! Playing fallback."),this.playMusic(this.playlist[0],2e3,!1))}playPreviousInPlaylist(){if(!this.isPlaylistActive)return;let e=0,n=!1;for(;e<this.playlist.length;){this.playlistIndex=(this.playlistIndex-1+this.playlist.length)%this.playlist.length;const s=this.playlist[this.playlistIndex];if(!this.ignoredTracks.has(s)){this.playMusic(s,2e3,!1),n=!0;break}e++}n||this.playMusic(this.playlist[0],2e3,!1)}async resume(){this.audioContext||this.initAudioContext(),this.audioContext&&this.audioContext.state==="suspended"&&await this.audioContext.resume()}playMusic(e,n=1e3,s=!0){if(s&&(this.isPlaylistActive=!1),this.currentMusicKey===e&&this.currentMusic&&!this.currentMusic.paused){this.fadeIn(this.currentMusic,this.musicVolume,500);return}const r=`/sounds/music/${e.includes(".")?e:`${e}.mp3`}`,a=new Audio(r);if(a.loop=!this.isPlaylistActive,a.volume=0,this.initAudioContext(),this.audioContext&&this.filterNode)try{this.audioContext.createMediaElementSource(a).connect(this.filterNode)}catch(o){console.warn("Could not route through Web Audio API",o)}this.isPlaylistActive&&(a.onended=()=>{this.playNextInPlaylist()}),this.currentMusic&&this.fadeOut(this.currentMusic,n),this.currentMusic=a,this.currentMusicKey=e,a.play().then(()=>{this.fadeIn(a,this.musicVolume,n),this.audioContext&&this.audioContext.state==="suspended"&&this.audioContext.resume()}).catch(o=>{console.warn(`Failed to play music: ${e}`,o),this.currentMusic===a&&(this.currentMusic=null,this.currentMusicKey=null),this.isPlaylistActive&&setTimeout(()=>this.playNextInPlaylist(),2e3)})}stopMusic(e=1e3){this.isPlaylistActive=!1,this.currentMusic&&(this.fadeOut(this.currentMusic,e),this.currentMusic=null,this.currentMusicKey=null)}fadeOut(e,n){this.activeFades.has(e)&&clearInterval(this.activeFades.get(e));const s=e.volume,i=20,r=n/i,a=s/i;let o=0;const c=setInterval(()=>{o++;const u=Math.max(0,s-a*o);e.volume=u,u<=0&&(e.pause(),e.src="",clearInterval(c),this.activeFades.delete(e))},r);this.activeFades.set(e,c)}fadeIn(e,n,s){this.activeFades.has(e)&&(clearInterval(this.activeFades.get(e)),this.activeFades.delete(e));const i=20,r=s/i,a=n/i;let o=0;const c=setInterval(()=>{o++;const u=Math.min(n,a*o);e.volume=u,(u>=n||e.paused)&&clearInterval(c)},r)}};ze(Xi,"instance");let np=Xi;const it=np.getInstance(),vS=_.createContext(void 0),zL=({children:t})=>{const[e,n]=_.useState(it.getSfxVolume()),[s,i]=_.useState(it.getMusicVolume()),[r,a]=_.useState(it.isMuffled()),[o,c]=_.useState(it.getCurrentTrackId()),[u,d]=_.useState(0);_.useEffect(()=>{const w=setInterval(()=>{const T=it.getCurrentTrackId();T!==o&&c(T)},1e3);return()=>clearInterval(w)},[o]);const f=_.useCallback(w=>{it.setSfxVolume(w),n(w)},[]),h=_.useCallback(w=>{it.setMusicVolume(w),i(w)},[]),m=_.useCallback(w=>{it.setMuffled(w),a(w)},[]),g=_.useCallback(w=>{it.playSfx(w)},[]),v=_.useCallback(w=>{it.playMusic(w),c(w)},[]),x=_.useCallback(()=>{it.stopMusic(),c(null)},[]),p=_.useCallback(()=>{it.startPlaylist(),c(it.getCurrentTrackId())},[]),b=_.useCallback(()=>{it.playNextInPlaylist(),c(it.getCurrentTrackId())},[]),y=_.useCallback(()=>{it.playPreviousInPlaylist(),c(it.getCurrentTrackId())},[]),E=_.useCallback(w=>{it.toggleIgnoreTrack(w),d(T=>T+1)},[]),N=_.useCallback(w=>it.isIgnored(w),[u]),A=_.useCallback(()=>{it.resume()},[]);return l.jsx(vS.Provider,{value:{playSfx:g,playMusic:v,startPlaylist:p,stopMusic:x,playNext:b,playPrevious:y,toggleIgnoreTrack:E,isIgnored:N,currentTrackId:o,playlist:bS,sfxVolume:e,setSfxVolume:f,musicVolume:s,setMusicVolume:h,isMuffled:r,setMuffled:m,resume:A},children:t})},R0=()=>{const t=_.useContext(vS);if(!t)throw new Error("useAudio must be used within a SimulationAudioProvider");return t},xS=_.createContext(void 0),$L=({children:t})=>{const{pin:e,tab:n}=ZE(),s=C=>{if(!C)return"MAP";const B=C.toUpperCase();return B==="ACTIVITY"||B==="LOG"?"ACTIVITY":B},i=C=>C.toLowerCase(),[r,a]=_.useState(()=>s(n)),[o,c]=_.useState("global"),[u,d]=_.useState(null),[f,h]=_.useState(!1),[m,g]=_.useState(!1),[v,x]=_.useState(null),[p,b]=_.useState(null),[y,E]=_.useState(null),[N,A]=_.useState(null),[w,T]=_.useState(null),k=C=>{a(C);const B=i(C),z=`/sim/play/${e}/${B}`;window.history.replaceState({...window.history.state,idx:window.history.length},"",z)},R=C=>{h(C),C?k("MARKET"):r==="MARKET"&&k("MAP")};return l.jsx(xS.Provider,{value:{activeTab:r,setActiveTab:k,viewMode:o,setViewMode:c,viewingRegionId:u,setViewingRegionId:d,isMarketOpen:f,setMarketOpen:R,isMusicWindowOpen:m,setMusicWindowOpen:g,activeMinigame:v,setActiveMinigame:x,activeMinigameMethod:p,setActiveMinigameMethod:b,activeMinigameAction:y,setActiveMinigameAction:E,actionLoading:N,setActionLoading:A,productionContext:w,setProductionContext:T},children:t})},gf=()=>{const t=_.useContext(xS);if(!t)throw new Error("useSimulation must be used within a SimulationProvider");return t},KL="modulepreload",YL=function(t){return"/Simulation_StandAlone_Pro/"+t},fy={},Gt=function(e,n,s){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(n.map(c=>{if(c=YL(c),c in fy)return;fy[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":KL,u||(f.as="script"),f.crossOrigin="",f.href=c,o&&f.setAttribute("nonce",o),document.head.appendChild(f),u)return new Promise((h,m)=>{f.addEventListener("load",h),f.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&r(o.reason);return e().catch(r)})},q={MARKET:{SELL_RATIO:.8,PRICE_IMPACT_BUY:.005,PRICE_IMPACT_SELL:.005,MIN_PRICE_MULTIPLIER:.2,MAX_PRICE_MULTIPLIER:5,VISCOSITY:100},CONTRIBUTION_VALUES:{gold:1,wood:.5,stone:1,iron_ore:1,iron_ingot:5,plank:2,grain:.1,flour:.5,bread:1,meat:1,honey:1,cloth:1,wool:.5,default:.1},CAREERS:{SOLDIER:{COST:200,LEVEL_REQ:3},MERCHANT:{COST:500,LEVEL_REQ:3}},TAX:{PEASANT_RATE_DEFAULT:.15,PEASANT_RATE_CUT:.07,ROYAL_RATE:.2,LOYALTY_PENALTY_PEASANT:10,LOYALTY_PENALTY_BARON:5},GATHERING:{NO_TOOL_PENALTY:.75},YIELD:{WORK_GRAIN:12,CHOP_WOOD:8,MINE_ORE:6,QUARRY_STONE:10,FORAGE_BREAD:1,PLOW_BONUS:5,SUMMER_WOOD_BONUS:3},DURABILITY:{MAX:100,LOSS_WORK:5,LOSS_COMBAT_WEAPON:10,LOSS_COMBAT_ARMOR:15,REPAIR_AMOUNT:30},MINIGAME:{BASE_MULTIPLIER:.5,PERFORMANCE_WEIGHT:1,CRAFTING_WEIGHT:1.5,THRESHOLD_GREAT:.8},RELIGION:{PRAY_MIN:1,PRAY_MAX:5,XP_PRAY:2},COMBAT:{RAID_LOOT_FACTOR:.4,DEFEND_GOLD_BASE:20,XP_WIN:20,XP_LOSS:0},LUCKY_DROP:{CHANCE:.05,MULTIPLIER:2},PASSIVE_INCOME:{COW:2,ACCOUNTING_BOOKS:5,CARAVAN:10},SKILLS:{GATHERING_BONUS:.1,REFINING_BONUS:.1,CRAFTING_XP:25,REFINING_XP:10},COUP:{BASE_BRIBE_COST:500,HONEYMOON_DURATION:6e5,VACANCY_DURATION:3e5,RESTORE_ORDER_COST:600,LEGITIMACY_SHIELD_MULT:2,KING_VOTE_WEIGHT:15,PEASANT_VOTE_WEIGHT:1}},uc={WORK:{xp:5},CHOP:{xp:5},FORAGE:{xp:2}},vd=[0,100,300,700,1500,3e3,6e3],An={Spring:{label:"Vr",yieldMod:1,staminaMod:1,color:"#4ade80"},Summer:{label:"Sommer",yieldMod:1.2,staminaMod:1,color:"#fbbf24"},Autumn:{label:"Hst",yieldMod:1.5,staminaMod:1,color:"#f97316"},Winter:{label:"Vinter",yieldMod:.2,staminaMod:1.5,color:"#38bdf8"}},_s={Clear:{label:"Klart Vr",desc:"Ideelle forhold for alt arbeid.",mod:1,icon:"",speedMod:1,staminaMod:1},Rain:{label:"Regn",desc:"Glatte forhold. Minispill gr litt fortere.",mod:.9,icon:"",speedMod:1.2,staminaMod:1},Storm:{label:"Storm",desc:"Farlig vr. Hy stamina-kostnad og lavt utbytte!",mod:.5,icon:"",speedMod:1.5,staminaMod:2},Fog:{label:"Tke",desc:"Drlig sikt. Vanskeligere  treffe blinker.",mod:.8,icon:"",speedMod:.8,staminaMod:1}},dc={WORK:{bread:1,stamina:10},CHOP:{bread:1,stamina:15},FORAGE:{stamina:40},MINE:{bread:1,stamina:25},RAID:{bread:3,stamina:40},TAX:{stamina:20},TAX_PEASANTS:{stamina:25},TAX_ROYAL:{stamina:30},MILL:{grain:10,stamina:20},SMELT:{iron_ore:5,wood:2,stamina:15},SAWMILL:{wood:5,stamina:15},BAKERY:{flour:5,stamina:10},REFINE:{stamina:15},CRAFT:{stamina:30},QUARRY:{bread:1,stamina:20},REPAIR:{stamina:15},HUNT:{stamina:30},GATHER_WOOL:{stamina:15},GATHER_HONEY:{stamina:20},PRAY:{stamina:15},FEAST:{bread:30,gold:100,stamina:10},CONTRIBUTE:{stamina:10},CONSTRUCT:{stamina:20},SLEEP:{stamina:0},EAT:{bread:1,stamina:0},PLANT:{grain:5,stamina:25},HARVEST:{stamina:15},BAKE:{stamina:10},WEAVE:{stamina:15},MIX:{stamina:15},DEFEND:{stamina:30},EXPLORE:{stamina:25},PATROL:{stamina:10},MAINTAIN_CROP:{stamina:5}},sp={great_forge:{material:"iron_ingot",goldCost:20,staminaCost:15,slots:["MAIN_HAND","OFF_HAND","HEAD","BODY","FEET","AXE","PICKAXE","SCYTHE","HAMMER","BOW","TRAP"]},weavery:{material:"cloth",goldCost:10,staminaCost:10,slots:["BODY","FEET","HEAD"]},sawmill:{material:"plank",goldCost:5,staminaCost:10,slots:["OFF_HAND","MAIN_HAND"]}},xd={GOLD:"",GRAIN:"",WOOD:"",IRON_ORE:"",STONE:"",PLANK:"",IRON_INGOT:"",BREAD:"",SWORDS:"",ARMOR:"",CLOTH:"",WOOL:"",MEAT:"",HONEY:"",GLASS:"",FLOUR:"",EGG:"",OMELETTE:"",MANPOWER:"",FAVOR:""},mn={gold:{label:"Gull",icon:""},grain:{label:"Korn",icon:""},flour:{label:"Mel",icon:""},bread:{label:"Brd",icon:""},wood:{label:"Ved",icon:""},plank:{label:"Planker",icon:""},iron_ore:{label:"Jernmalm",icon:""},iron_ingot:{label:"Jernbarre",icon:""},stone:{label:"Stein",icon:""},swords:{label:"Beleiringsvpen",icon:""},armor:{label:"Beleiringsrustning",icon:""},favor:{label:"Gunst",icon:""},honey:{label:"Honning",icon:""},meat:{label:"Kjtt",icon:""},wool:{label:"Ull",icon:""},cloth:{label:"Stoff",icon:""},glass:{label:"Glass",icon:""},egg:{label:"Egg",icon:""},omelette:{label:"Omelett",icon:""}},Rt={KING:{gold:1e3,grain:500,flour:200,bread:50,wood:200,plank:50,iron_ore:0,iron_ingot:20,stone:100,swords:50,armor:20,favor:0,wool:50,cloth:20,honey:0,meat:0,glass:0,manpower:0,egg:0,omelette:0},BARON:{gold:300,grain:100,flour:50,bread:20,wood:50,plank:20,iron_ore:0,iron_ingot:10,stone:20,swords:10,armor:10,favor:0,wool:20,cloth:5,honey:0,meat:0,glass:0,manpower:0,egg:0,omelette:0},PEASANT:{gold:20,grain:30,flour:5,bread:10,wood:0,plank:0,iron_ore:0,iron_ingot:0,stone:0,swords:0,armor:0,favor:0,wool:10,cloth:0,honey:0,meat:0,glass:0,manpower:0,egg:0,omelette:0},SOLDIER:{gold:50,grain:10,flour:10,bread:10,wood:0,plank:0,iron_ore:0,iron_ingot:0,stone:0,swords:5,armor:2,favor:0,wool:0,cloth:0,honey:0,meat:0,glass:0,manpower:0,egg:0,omelette:0},MERCHANT:{gold:500,grain:50,flour:50,bread:20,wood:50,plank:20,iron_ore:0,iron_ingot:5,stone:50,swords:5,armor:2,favor:0,wool:20,cloth:10,honey:0,meat:0,glass:0,manpower:0,egg:0,omelette:0}},I0={PEASANT:[{id:"iron_plow",name:"Jernplog",description:"ker kornhst med +5.",cost:{gold:50,wood:10},benefit:"YIELD_GRAIN"},{id:"fence",name:"Solid Gjerde",description:"Beskytter mot smtyveri.",cost:{wood:50},benefit:"DEFENSE_REGION"},{id:"cow",name:"Melkeku",description:"Gir passivt 2 gull per minutt (simulert via actions).",cost:{gold:80},benefit:"PASSIVE_GOLD"},{id:"roof",name:"Tett Tak",description:"Bedre hvile. Mer utholdenhet.",cost:{wood:20,gold:10},benefit:"STAMINA_REGEN"}],BARON:[{id:"stone_keep",name:"Steintrn",description:"Gjr raiding av deg mye vanskeligere.",cost:{gold:200,wood:100},benefit:"FORTRESS"},{id:"armory",name:"Vpenkammer",description:"Dobbelt s effektiv rekruttering.",cost:{gold:150},benefit:"DRAFT_BONUS"},{id:"stables",name:"Staller",description:"Raskere raids.",cost:{gold:100,wood:50},benefit:"RAID_SPEED"}],KING:[{id:"cathedral",name:"Katedral",description:"ker din legitimitet og skattevilje.",cost:{gold:500,stone:200},benefit:"ROYAL_AUTHORITY"},{id:"royal_guard",name:"Kongelig Garde",description:"Uovervinnelig defensiv styrke.",cost:{gold:400,iron:100},benefit:"ELITE_DEFENSE"}],SOLDIER:[{id:"knight_armor",name:"Ridderrustning",description:"Du tar mindre skade og ser tffere ut.",cost:{gold:100,swords:5},benefit:"ARMOR"},{id:"warhorse",name:"Stridshest",description:"Gjr deg til en Ridder. 2x XP fra kamp.",cost:{gold:200,grain:100},benefit:"KNIGHT"}],MERCHANT:[{id:"trade_license",name:"Handelsbrev",description:"Bedre salgspriser p markedet.",cost:{gold:150},benefit:"MARKET_BONUS"},{id:"accounting_books",name:"Regnskapsbker",description:"Gir passivt 5 gull per minutt.",cost:{gold:200,wood:20},benefit:"PASSIVE_GOLD_HIGH"},{id:"caravan",name:"Karavane",description:"Tjen penger p handel med utlandet.",cost:{gold:300,wood:50},benefit:"CARAVAN"}]},jn={PEASANT:{FARMING:{level:1,xp:0,maxXp:100},WOODCUTTING:{level:1,xp:0,maxXp:100},MINING:{level:0,xp:0,maxXp:100},CRAFTING:{level:0,xp:0,maxXp:100},STEWARDSHIP:{level:0,xp:0,maxXp:100},COMBAT:{level:0,xp:0,maxXp:100},TRADING:{level:0,xp:0,maxXp:100},THEOLOGY:{level:0,xp:0,maxXp:100}},BARON:{FARMING:{level:3,xp:0,maxXp:300},WOODCUTTING:{level:3,xp:0,maxXp:300},MINING:{level:1,xp:0,maxXp:100},CRAFTING:{level:1,xp:0,maxXp:100},STEWARDSHIP:{level:5,xp:0,maxXp:1e3},COMBAT:{level:3,xp:0,maxXp:300},TRADING:{level:3,xp:0,maxXp:300},THEOLOGY:{level:1,xp:0,maxXp:100}},KING:{FARMING:{level:1,xp:0,maxXp:100},WOODCUTTING:{level:1,xp:0,maxXp:100},MINING:{level:1,xp:0,maxXp:100},CRAFTING:{level:1,xp:0,maxXp:100},STEWARDSHIP:{level:10,xp:0,maxXp:5e3},COMBAT:{level:5,xp:0,maxXp:1500},TRADING:{level:5,xp:0,maxXp:1500},THEOLOGY:{level:5,xp:0,maxXp:1500}},SOLDIER:{FARMING:{level:1,xp:0,maxXp:100},WOODCUTTING:{level:1,xp:0,maxXp:100},MINING:{level:0,xp:0,maxXp:100},CRAFTING:{level:1,xp:0,maxXp:100},STEWARDSHIP:{level:0,xp:0,maxXp:100},COMBAT:{level:5,xp:0,maxXp:1500},TRADING:{level:0,xp:0,maxXp:100},THEOLOGY:{level:0,xp:0,maxXp:100}},MERCHANT:{FARMING:{level:1,xp:0,maxXp:100},WOODCUTTING:{level:1,xp:0,maxXp:100},MINING:{level:0,xp:0,maxXp:100},CRAFTING:{level:2,xp:0,maxXp:200},STEWARDSHIP:{level:1,xp:0,maxXp:100},COMBAT:{level:0,xp:0,maxXp:100},TRADING:{level:5,xp:0,maxXp:1500},THEOLOGY:{level:0,xp:0,maxXp:100}}},qL={FARMING:{label:"Jordbruk",description:"Dyrking av mark, hsting av avlinger og husdyrhold.",color:"#10b981",bonuses:{2:"10% raskere hsting.",5:"Avlinger gir 20% mer utbytte.",10:"Mesterbonde: Lser opp avanserte avlinger."}},WOODCUTTING:{label:"Vedhogging",description:"Kunsten  felle trr og bearbeide tmmer.",color:"#8b5cf6",bonuses:{3:"15% raskere tmmerhogst.",7:"Sjanse for  finne sjelden kvae.",12:"Skovens vokter: kt utbytte fra alle trr."}},MINING:{label:"Gruvedrift",description:"Uthenting av malm og edle metaller fra fjellet.",color:"#f59e0b",bonuses:{4:"Bedre verktyeffektivitet i gruver.",8:"Lser opp utvinning av edelstener.",15:"Fjellkonge: Maksimalt utbytte fra dype rer."}},CRAFTING:{label:"Hndverk",description:"Smiing, snekring og tilvirking av avansert utstyr.",color:"#3b82f6",bonuses:{2:"Mindre materialsvinn ved refining.",5:"Bedre sjanse for hyere kvalitet.",10:"Stormester: Kan smie legendarisk utstyr."}},STEWARDSHIP:{label:"Godsforvaltning",description:"Administrasjon av land, folk og ressurser.",color:"#ec4899",bonuses:{5:"Redusert skattetrykk fra overordnede.",10:"kt passiv inntekt fra oppgraderinger.",20:"Rikets forvalter: Maksimal konomisk innsikt."}},COMBAT:{label:"Kamp",description:"Ferdighet i sverd, bue og forsvar av riket.",color:"#ef4444",bonuses:{3:"kt angrepskraft (+10%).",6:"Bedre forsvarsevne i beleiringer.",12:"Krigsherre: Fryktinngytende p slagmarken."}},TRADING:{label:"Handel",description:"Kjp, salg og markedsspekulering.",color:"#facc15",bonuses:{2:"Lavere gebyrer p markedet.",5:"Bedre priser ved handel med NPCs.",10:"Handelsfyrste: Kontroll over handelsruter."}},THEOLOGY:{label:"Teologi",description:"Tro, bnn og forstelse av det guddommelige.",color:"#6366f1",bonuses:{5:"Bnner gir mer stamina.",10:"Guddommelig beskyttelse mot ulykker.",15:"Helgen: Utstrler en aura av ro og verdighet."}}},ip={PEASANT:{},BARON:{MAIN_HAND:{id:"iron_sword",name:"Jernsverd",icon:"",type:"MAIN_HAND",durability:100,maxDurability:100,level:5,stats:{attack:10}},BODY:{id:"fine_clothes",name:"Fie Klr",icon:"",type:"BODY",durability:50,maxDurability:50,level:5,stats:{defense:2,speedBonus:1.1}}},KING:{MAIN_HAND:{id:"royal_scepter",name:"Kongens Septer",icon:"",type:"MAIN_HAND",durability:200,maxDurability:200,level:10,stats:{luckBonus:.2}},HEAD:{id:"crown",name:"Krone",icon:"",type:"HEAD",durability:100,maxDurability:100,level:10,stats:{luckBonus:.1}}},SOLDIER:{MAIN_HAND:{id:"iron_sword",name:"Jernsverd",icon:"",type:"MAIN_HAND",durability:100,maxDurability:100,level:3,stats:{attack:8}},OFF_HAND:{id:"wooden_shield",name:"Treskjold",icon:"",type:"OFF_HAND",durability:50,maxDurability:50,level:2,stats:{defense:5}},BODY:{id:"leather_armor",name:"Lrrustning",icon:"",type:"BODY",durability:80,maxDurability:80,level:2,stats:{defense:5}}},MERCHANT:{MAIN_HAND:{id:"walking_stick",name:"Vandrestav",icon:"",type:"MAIN_HAND",durability:50,maxDurability:50,level:2,stats:{speedBonus:1.05}},TRINKET:{id:"abacus",name:"Kuleramme",icon:"",type:"TRINKET",durability:100,maxDurability:100,level:3,stats:{yieldBonus:2}}}},Te={tools:{id:"tools",name:"Verkty",icon:"",type:"MAIN_HAND",durability:100,maxDurability:100,level:1,description:"Grunnleggende verkty."},weapon:{id:"weapon",name:"Enkelt Sverd",icon:"",type:"MAIN_HAND",durability:100,maxDurability:100,level:1,description:"Et enkelt sverd."},armor:{id:"armor",name:"Enkel Rustning",icon:"",type:"BODY",durability:100,maxDurability:100,level:1,description:"Beskyttende rustning."},stone_axe:{id:"stone_axe",name:"Steinks",icon:"",type:"AXE",durability:30,maxDurability:30,level:1,description:"Primitiv ks hugget fra mrke fjell. Sagnet sier at de frste fedrene brukte slike til  bane vei gjennom de tette skogene fr sivilisasjonens inntog. +1 Utbytte.",stats:{yieldBonus:1},relevantActions:["CHOP"],nextTierId:"iron_axe"},stone_pickaxe:{id:"stone_pickaxe",name:"Steinhakke",icon:"",type:"PICKAXE",durability:30,maxDurability:30,level:1,description:"En enkel hakke i flint og tre. Brukt i generasjoner av de som sker fjellets hemmeligheter. +1 Utbytte.",stats:{yieldBonus:1},relevantActions:["MINE"],nextTierId:"iron_pickaxe"},rusty_axe:{id:"rusty_axe",name:"Rusten ks",icon:"",type:"AXE",durability:50,maxDurability:50,level:1,description:"Et glemt relikvie fra en svunnen tid, n bare en skygge av sin fordums prakt. Slv og uplitelig.",stats:{yieldBonus:0},relevantActions:["CHOP"],nextTierId:"stone_axe"},iron_axe:{id:"iron_axe",name:"Jernks",icon:"",type:"AXE",durability:100,maxDurability:100,level:3,description:"Smid i landsbyens esse under fullmnen. Jernet synger nr det treffer treverket. +3 Utbytte.",stats:{yieldBonus:3},relevantActions:["CHOP"],nextTierId:"steel_axe"},iron_pickaxe:{id:"iron_pickaxe",name:"Jernhakke",icon:"",type:"PICKAXE",durability:100,maxDurability:100,level:3,description:"Tung og balansert. Laget for  trenge dypt inn i rikets rike rer. +3 Utbytte.",stats:{yieldBonus:3},relevantActions:["MINE"],nextTierId:"steel_pickaxe"},stone_chisel:{id:"stone_chisel",name:"Steinmeisel",icon:"",type:"CHISEL",durability:30,maxDurability:30,level:1,description:"En enkel meisel av herdet stein. Perfekt for  forme steinblokker. +1 Utbytte.",stats:{yieldBonus:1},relevantActions:["QUARRY"],nextTierId:"iron_chisel"},iron_chisel:{id:"iron_chisel",name:"Jernmeisel",icon:"",type:"CHISEL",durability:80,maxDurability:80,level:3,description:"Smid i landsbyens esse. Gjr steinhugging til en lek. +3 Utbytte.",stats:{yieldBonus:3},relevantActions:["QUARRY"],nextTierId:"steel_chisel"},royal_scepter:{id:"royal_scepter",name:"Kongens Septer",icon:"",type:"MAIN_HAND",durability:200,maxDurability:200,level:10,description:"Et symbol p guddommelig rett og folkets vilje. Det glitrer med en makt som kan bye selve skjebnen. +20% Flaks.",stats:{luckBonus:.2}},steel_axe:{id:"steel_axe",name:"Stlks",icon:"",type:"AXE",durability:200,maxDurability:200,level:8,description:"Mesterlig stl. +8 Utbytte, 20% raskere arbeid.",stats:{yieldBonus:8,speedBonus:1.2},relevantActions:["CHOP"]},steel_hja:{id:"steel_hja",name:"Stlhj",icon:"",type:"SCYTHE",durability:120,maxDurability:120,level:4,description:"Sylskarp hj. +5 Utbytte, 10% raskere hsting.",stats:{yieldBonus:5,speedBonus:1.1},relevantActions:["WORK","HST"]},stone_sickle:{id:"stone_sickle",name:"Steinsigd",icon:"",type:"SCYTHE",durability:40,maxDurability:40,level:1,description:"Enkel sigd for jordbruk. +1 Utbytte ved kornhsting.",stats:{yieldBonus:1},relevantActions:["WORK"]},blacksmith_hammer:{id:"blacksmith_hammer",name:"Smedhammer",icon:"",type:"HAMMER",durability:200,maxDurability:200,level:5,description:"Mesterverkty. 20% raskere smiing.",stats:{speedBonus:1.2},relevantActions:["CRAFT","REFINE","SMELT"]},shears:{id:"shears",name:"Saks",icon:"",type:"MAIN_HAND",durability:50,maxDurability:50,level:1,description:"Brukt til  klippe sauer. Helt ndvendig for ull-produksjon.",stats:{yieldBonus:2},relevantActions:["GATHER_WOOL"]},iron_sword:{id:"iron_sword",name:"Jernsverd",icon:"",type:"MAIN_HAND",durability:100,maxDurability:100,level:5,description:"Standard sverd. +10 Angrepskraft.",stats:{attack:10},relevantActions:["DEFEND","PATROL","EXPLORE","HUNT"],nextTierId:"steel_sword"},steel_sword:{id:"steel_sword",name:"Stlsverd",icon:"",type:"MAIN_HAND",durability:250,maxDurability:250,level:10,description:"Ddelig stl. +25 Angrep, 10% raskere hugg.",stats:{attack:25,speedBonus:1.1},relevantActions:["DEFEND","PATROL","EXPLORE","HUNT"]},tunic:{id:"tunic",name:"Slitt Tunika",icon:"",type:"BODY",durability:20,maxDurability:20,level:1,description:"Gammel og hullete. Minimal beskyttelse.",stats:{defense:1},relevantActions:["DEFEND","PATROL"],nextTierId:"leather_armor"},leather_armor:{id:"leather_armor",name:"Lrrustning",icon:"",type:"BODY",durability:80,maxDurability:80,level:3,description:"Herdet skinn. +5 Forsvar.",stats:{defense:5},relevantActions:["DEFEND","PATROL"],nextTierId:"iron_armor"},whetstone:{id:"whetstone",name:"Bryne",icon:"",type:"OFF_HAND",durability:10,maxDurability:10,level:1,description:"Bruk bryne for  holde verkty skarpe. Gir +1 i utbytte p de fleste sanke-oppgaver.",stats:{yieldBonus:1},relevantActions:["CHOP","MINE","QUARRY","WORK","GATHER_WOOL"]},hunting_bow:{id:"hunting_bow",name:"Jaktbue",icon:"",type:"BOW",durability:80,maxDurability:80,level:1,description:"En stdig bue av barlind. +2 Utbytte.",stats:{yieldBonus:2},relevantActions:["HUNT"],nextTierId:"longbow"},longbow:{id:"longbow",name:"Langbue",icon:"",type:"BOW",durability:150,maxDurability:150,level:5,description:"En mektig langbue som krever styrke  spenne. +5 Utbytte, 10% raskere.",stats:{yieldBonus:5,speedBonus:1.1},relevantActions:["HUNT"]},hunting_trap:{id:"hunting_trap",name:"Jaktfelle",icon:"",type:"TRAP",durability:30,maxDurability:30,level:1,description:"En enkel snarefangst-felle. +1 Utbytte ved smviltjakt.",stats:{yieldBonus:1},relevantActions:["HUNT","FORAGE"]},omelette:{id:"omelette",name:"Omelett",icon:"",type:"CONSUMABLE",durability:1,maxDurability:1,level:1,description:'En nringsrik frokost. Gir buff: "Lett til beins" (20% mindre stamina kostnad i 15 min).',stats:{},relevantActions:["CONSUME"]},bread:{id:"bread",name:"Brd",icon:"",type:"CONSUMABLE",durability:1,maxDurability:1,level:1,description:"Ferskt brd fra bakeriet. Gjenoppretter +20 Stamina.",stats:{},relevantActions:["CONSUME"]}},C0={grain:{label:"Kornker",seed:"grain",yieldResource:"grain",duration:3*60*1e3,minYield:15,maxYield:25,xp:20}},Bt={farm_house:{id:"farm_house",name:"Grdshuset",icon:"",locationId:"peasant_farm",description:"Ditt personlige hjem. Oppgraderinger gir bedre hvile og mer matlagingsplass.",levels:{1:{requirements:{},unlocks:["SLEEP","EAT"],bonus:"Base hvile"},2:{requirements:{wood:50,gold:100},unlocks:["FARM_UPGRADE"],bonus:"+20% Stamina fra peisen"},3:{requirements:{plank:20,stone:50,gold:300},unlocks:["FARM_UPGRADE_MASTER"],bonus:"+30% Stamina fra senga"},4:{requirements:{plank:50,stone:100,gold:600},unlocks:["FARM_UPGRADE_ELITE"],bonus:"+50% Stamina fra hvile"},5:{requirements:{plank:100,stone:200,gold:1e3,iron_ingot:20},unlocks:["FARM_UPGRADE_GODLY"],bonus:"Restaurerer all Stamina ved hvile"}}},sawmill:{id:"sawmill",name:"Sagbruk",icon:"",locationId:"village",description:"Gjr det mulig  foredle Ved til Tmmer.",levels:{1:{requirements:{},unlocks:["REFINE_PLANK_BASIC","hunting_bow"],bonus:"Base produksjon"},2:{requirements:{wood:100,stone:50,gold:100},unlocks:["REFINE_PLANK_FAST"],bonus:"+10% Woodcutting XP"},3:{requirements:{plank:50,stone:150,gold:300},unlocks:["REFINE_PLANK_MASTER","longbow"],bonus:"Lser opp Tier 3 verkty og Langbue"}}},windmill:{id:"windmill",name:"Vindmlle",icon:"",locationId:"village",description:"Gjr det mulig  foredle Korn til Mel mer effektivt.",levels:{1:{requirements:{},unlocks:["REFINE_FLOUR_BASIC"],bonus:"Base produksjon"},2:{requirements:{plank:30,stone:50,gold:150},unlocks:["REFINE_FLOUR_FAST"],bonus:"+10% Farming XP"},3:{requirements:{plank:100,stone:200,gold:500},unlocks:["REFINE_FLOUR_AUTO"],bonus:"Sjanse for dobbel avling"}}},smeltery:{id:"smeltery",name:"Smeltehytte",icon:"",locationId:"village",description:"Gjr det mulig  smelte Jernmalm til Jernbarrer.",levels:{1:{requirements:{},unlocks:["REFINE_IRON_BASIC"],bonus:"Base produksjon"},2:{requirements:{stone:150,wood:100,gold:200},unlocks:["REFINE_IRON_FAST"],bonus:"+10% Mining XP"},3:{requirements:{stone:300,plank:50,gold:600},unlocks:["REFINE_STEEL","glass"],bonus:"Lser opp Stl og Glass"}}},great_forge:{id:"great_forge",name:"Storsmie",icon:"",locationId:"village",description:"Gjr det mulig  lage avanserte verkty og vpen.",levels:{1:{requirements:{},unlocks:["stone_axe","stone_pickaxe","stone_sickle","whetstone","hunting_trap"],bonus:"Base produksjon"},2:{requirements:{iron_ingot:20,plank:30,gold:300},unlocks:["iron_axe","iron_pickaxe","iron_sword","leather_armor","shears","siege_swords","siege_armor"],bonus:"+10% Crafting XP"},3:{requirements:{iron_ingot:100,plank:100,gold:1e3},unlocks:["steel_axe","steel_sword","blacksmith_hammer","repair_advanced"],bonus:"Lser opp Mester-utstyr"}}},bakery:{id:"bakery",name:"Bakeri",icon:"",locationId:"village",description:"Gjr det mulig  bake Brd fra Mel.",levels:{1:{requirements:{},unlocks:["CRAFT_BREAD","CRAFT_omelette"],bonus:"Base produksjon"},2:{requirements:{stone:50,plank:20,gold:100},unlocks:["CRAFT_PIE"],bonus:"Bedre stamina fra mat"},3:{requirements:{stone:150,plank:50,gold:400},unlocks:["CRAFT_FEAST"],bonus:"Lser opp Gildemltid"}}},tavern:{id:"tavern",name:"Vertshuset",icon:"",locationId:"village",description:"Et sted for hvile og rykter. ker stamina-regenerering.",levels:{1:{requirements:{},unlocks:["ENTER_TAVERN","REST_BASIC","BUY_MEAL","OPEN_DICE_GAME","CHAT_LOCAL"],bonus:"Standard hvile"},2:{requirements:{wood:100,stone:50,gold:250},unlocks:["REST_COMFY"],bonus:"Dobbel stamina-regen"},3:{requirements:{plank:50,stone:150,gold:750},unlocks:["REST_ROYAL"],bonus:"Gjenoppretter all stamina raskt"}}},weavery:{id:"weavery",name:"Veveri",icon:"",locationId:"village",description:"Foredler Ull til Stoff for videre salg eller klr.",levels:{1:{requirements:{},unlocks:["REFINE_CLOTH_BASIC"],bonus:"Base produksjon"},2:{requirements:{plank:40,stone:30,gold:150},unlocks:["REFINE_CLOTH_FAST"],bonus:"+10% Trading XP"},3:{requirements:{plank:100,stone:100,gold:400},unlocks:["REFINE_CLOTH_MASTER"],bonus:"Lser opp Silke-produksjon"}}},well:{id:"well",name:"Bybrnn",icon:"",locationId:"village",description:"Gir tilgang til ferskvann for baking og hygiene.",levels:{1:{requirements:{},unlocks:["GATHER_WATER"],bonus:"Basiskilde"},2:{requirements:{stone:50,gold:50},unlocks:["GATHER_WATER_FAST"],bonus:"Bedre vanntilgang"},3:{requirements:{stone:150,gold:200},unlocks:["GATHER_WATER_MASTER"],bonus:"Hellig kilde: +5 Stamina ved drikking"}}},apothecary:{id:"apothecary",name:"Apoteker",icon:"",locationId:"village",description:"Fremstiller medisin og salver.",levels:{1:{requirements:{},unlocks:["CRAFT_MEDICINE"],bonus:"Basis urter"},2:{requirements:{plank:20,wood:50,gold:150},unlocks:["CRAFT_POISON"],bonus:"Kunnskap om gift"},3:{requirements:{plank:50,glass:20,gold:500},unlocks:["CRAFT_ELIXIR"],bonus:"Livseliksir"}}},watchtower:{id:"watchtower",name:"Vaktrn",icon:"",locationId:"village",description:"Bedre oversikt og forsvar av landsbyen.",levels:{1:{requirements:{},unlocks:["PATROL"],bonus:"+5 Forsvar"},2:{requirements:{stone:100,plank:50,gold:200},unlocks:["SCOUT"],bonus:"+15 Forsvar"},3:{requirements:{stone:300,plank:100,gold:800},unlocks:["VOLLEY"],bonus:"Bueskytter-sttte i kamp"}}},stables:{id:"stables",name:"Stall",icon:"",locationId:"village",description:"Muliggjr raskere reise og kavaleri.",levels:{1:{requirements:{},unlocks:["MOUNT_HORSE"],bonus:"Transport"},2:{requirements:{plank:50,wood:50,gold:150},unlocks:["BREED_WARHORSE"],bonus:"Stridshester"},3:{requirements:{plank:150,iron_ingot:20,gold:400},unlocks:["KNIGHT_TRAINING"],bonus:"Riddere"}}},manor_ost:{id:"manor_ost",name:"Slott st",icon:"",locationId:"castle",description:"Setet til den stlige herre. Krever enorme ressurser  bygge.",levels:{1:{requirements:{stone:500,plank:300,iron_ingot:50,gold:1e3},unlocks:["BARON_STATUS"],bonus:"Krav p regionen"}}},manor_vest:{id:"manor_vest",name:"Slott Vest",icon:"",locationId:"castle",description:"Setet til den vestlige herre. Krever enorme ressurser  bygge.",levels:{1:{requirements:{stone:500,plank:300,iron_ingot:50,gold:1e3},unlocks:["BARON_STATUS"],bonus:"Krav p regionen"}}},throne_room:{id:"throne_room",name:"Slottet",icon:"",locationId:"castle",description:"Kongens stol. Den frste Baronen som fullfrer denne blir Konge.",levels:{1:{requirements:{stone:2e3,plank:1e3,iron_ingot:200,gold:5e3},unlocks:["KING_STATUS"],bonus:"Krav p riket"}}}},_r={plank:{label:"Planker",icon:"",input:{wood:5},outputResource:"plank",outputAmount:1,buildingId:"sawmill",stamina:10,xp:5,skill:"WOODCUTTING"},flour:{label:"Fint Mel",icon:"",input:{grain:10},outputResource:"flour",outputAmount:10,buildingId:"windmill",stamina:15,xp:8,skill:"FARMING",duration:12e4},iron_ingot:{label:"Jernbarre",icon:"",input:{iron_ore:5,wood:2},outputResource:"iron_ingot",outputAmount:1,buildingId:"smeltery",stamina:20,xp:12,skill:"CRAFTING"},bread:{label:"Bondebrd",icon:"",input:{flour:2},outputResource:"bread",outputAmount:5,buildingId:"bakery",stamina:5,xp:3,skill:"CRAFTING"},pie:{label:"Kjttpai",icon:"",input:{flour:4,meat:2},outputResource:"bread",outputAmount:15,buildingId:"bakery",stamina:15,xp:10,skill:"CRAFTING"},mead:{label:"Mjd",icon:"",input:{honey:5},outputResource:"stamina",outputAmount:20,buildingId:"tavern",stamina:5,xp:5,skill:"CRAFTING"},cloth:{label:"Lin-stoff",icon:"",input:{wool:5},outputResource:"cloth",outputAmount:1,buildingId:"weavery",stamina:15,xp:10,skill:"CRAFTING"},glass:{label:"Glass",icon:"",input:{stone:10,wood:5},outputResource:"glass",outputAmount:1,buildingId:"smeltery",requiredLevel:3,stamina:25,xp:15,skill:"CRAFTING"},elixir:{label:"Livseliksir",icon:"",input:{honey:10,glass:1},outputResource:"stamina",outputAmount:100,buildingId:"apothecary",requiredLevel:3,stamina:30,xp:25,skill:"CRAFTING"}},Rn={stone_axe:{label:"Steinks",icon:"",input:{stone:10,wood:5,gold:5},outputItemId:"stone_axe",buildingId:"great_forge",level:1,stamina:15,xp:10,description:"Et enkelt redskap for tmmerhogst.",skill:"CRAFTING"},stone_pickaxe:{label:"Steinhakke",icon:"",input:{stone:10,wood:5,gold:5},outputItemId:"stone_pickaxe",buildingId:"great_forge",level:1,stamina:15,xp:10,description:"En primitiv hakke for gruvearbeid.",skill:"CRAFTING"},stone_sickle:{label:"Steinsigd",icon:"",input:{stone:5,wood:5,gold:10},outputItemId:"stone_sickle",buildingId:"great_forge",level:1,stamina:10,xp:5,description:"Enkel sigd for kornhsting.",skill:"CRAFTING"},whetstone:{label:"Bryne",icon:"",input:{stone:15,gold:20},outputItemId:"whetstone",buildingId:"great_forge",level:1,stamina:10,xp:5,description:"Brukt for  slipe verkty og ke utbyttet.",skill:"CRAFTING"},stone_chisel:{label:"Steinmeisel",icon:"",input:{stone:10,gold:10},outputItemId:"stone_chisel",buildingId:"great_forge",level:1,stamina:10,xp:8,description:"Ndvendig for  hugge stein i steinhuggeriet.",skill:"CRAFTING"},iron_chisel:{label:"Jernmeisel",icon:"",input:{iron_ingot:5,gold:80},outputItemId:"iron_chisel",buildingId:"great_forge",level:2,stamina:20,xp:15,description:"Effektiv mesiel for steinhugging.",skill:"CRAFTING"},iron_axe:{label:"Jernks",icon:"",input:{iron_ingot:5,plank:2,gold:50},outputItemId:"iron_axe",buildingId:"great_forge",level:2,stamina:25,xp:20,description:"Et solid verkty av jern.",skill:"CRAFTING"},iron_pickaxe:{label:"Jernhakke",icon:"",input:{iron_ingot:5,plank:2,gold:50},outputItemId:"iron_pickaxe",buildingId:"great_forge",level:2,stamina:25,xp:20,description:"Effektiv hakke for dypere graving.",skill:"CRAFTING"},iron_sword:{label:"Jernsverd",icon:"",input:{iron_ingot:10,plank:2,gold:100},outputItemId:"iron_sword",buildingId:"great_forge",level:2,stamina:40,xp:35,description:"Et skarpt sverd for krigere.",skill:"CRAFTING"},leather_armor:{label:"Lrrustning",icon:"",input:{cloth:10,gold:150},outputItemId:"leather_armor",buildingId:"great_forge",level:2,stamina:30,xp:25,description:"God beskyttelse for en reisende.",skill:"CRAFTING"},shears:{label:"Saks",icon:"",input:{iron_ingot:5,gold:100},outputItemId:"shears",buildingId:"great_forge",level:2,stamina:20,xp:15,description:"Ndvendig for  klippe sauer og f ull.",skill:"CRAFTING"},siege_swords:{label:"Beleiringsvpen (x10)",icon:"",input:{iron_ingot:5,plank:5,gold:50},outputItemId:"swords",outputAmount:10,buildingId:"great_forge",level:2,stamina:40,xp:30,description:"En kasse med vpen til garnisonen.",skill:"CRAFTING"},siege_armor:{label:"Beleiringsrustning (x10)",icon:"",input:{iron_ingot:5,cloth:5,gold:50},outputItemId:"armor",outputAmount:10,buildingId:"great_forge",level:2,stamina:40,xp:30,description:"En kasse med rustninger til garnisonen.",skill:"CRAFTING"},steel_axe:{label:"Stlks",icon:"",input:{iron_ingot:20,plank:10,gold:250},outputItemId:"steel_axe",buildingId:"great_forge",level:3,stamina:50,xp:50,description:"Mesterlig utformet ks av herdet stl.",skill:"CRAFTING"},steel_sword:{label:"Stlsverd",icon:"",input:{iron_ingot:30,plank:5,gold:500},outputItemId:"steel_sword",buildingId:"great_forge",level:3,stamina:80,xp:100,description:"Det ultimate vpenet for en herre.",skill:"CRAFTING"},blacksmith_hammer:{label:"Smedhammer",icon:"",input:{iron_ingot:15,plank:5,gold:200},outputItemId:"blacksmith_hammer",buildingId:"great_forge",level:3,stamina:40,xp:50,description:"Mesterverkty for en ekte smed.",skill:"CRAFTING"},omelette:{label:"Omelett",icon:"",input:{egg:3},outputItemId:"omelette",buildingId:"bakery",level:1,stamina:10,xp:8,description:"En mettende frokost. Gir energi-buff.",skill:"CRAFTING"},hunting_trap:{label:"Jaktfelle",icon:"",input:{wood:10,iron_ingot:2,gold:30},outputItemId:"hunting_trap",buildingId:"great_forge",level:1,stamina:20,xp:15,description:"En enkel snare for smvilt.",skill:"CRAFTING"},hunting_bow:{label:"Jaktbue",icon:"",input:{plank:5,cloth:5,gold:50},outputItemId:"hunting_bow",buildingId:"sawmill",level:1,stamina:25,xp:20,description:"En stdig bue for jakt.",skill:"CRAFTING"},longbow:{label:"Langbue",icon:"",input:{plank:15,cloth:10,iron_ingot:1,gold:250},outputItemId:"longbow",buildingId:"sawmill",level:3,stamina:40,xp:45,description:"En kraftig bue med lang rekkevidde.",skill:"CRAFTING"}},Cl={KING:{label:"Konge",description:"Styrer riket, krever skatt og dmmer i store saker."},BARON:{label:"Baron",description:"Styrer en region, krever inn skatt fra bnder, og beskytter mot krig."},PEASANT:{label:"Bonde",description:"Produserer mat og ressurser. Betaler skatt."},SOLDIER:{label:"Soldat",description:"Beskytter riket og deltar i raids."},MERCHANT:{label:"Kjpmann",description:"Tjener penger p handel og markedsspekulasjon."}},WL={PEASANT:["Trell","Leilending","Selveier","Storbondi","Odalbonde"],BARON:["Landmann","Vpner","Ridder","Baron","Grev"],KING:["Prins","Hertug","Konungr"],SOLDIER:["Rekrutt","Vakt","Kjempe","Hvding"],MERCHANT:["Gutt","Svenn","Mester","Hanseat"]},XL={PEASANT:[["Basis rettigheter som bonde."],["+10% resurseffektivitet ved innhsting."],["Redusert skattetreff (-5%) fra din lensherre."],["Lser opp bruk av spesialverkty og ploger."],["Fullstendig selveie: Maksimal frihet og prestisje."]],BARON:[["Rett til  kreve inn skatt i din region."],["+20% forsvarsstyrke for dine vakter."],["Lser opp bygging av avanserte steinborger."],["Hyere status i Tinget: Dine stemmer teller mer."],["Maksimal autoritet og kontroll over landegrenser."]],KING:[["Gunst fra understtene og rett til tronen."],["Nasjonal autoritet: Kan passere lover uten Tinget."],["Gudegitt makt: Maksimal legitimitet og kontroll."]],SOLDIER:[["Grunnleggende kamptrening og utstyr."],["+15% skade i raids og forsvar."],["Lser opp bruk av tunge rustninger og hester."],["Elite-kriger: Fryktet over hele riket."]],MERCHANT:[["Rett til  drive handel p markedsplassen."],["Bedre priser ved kjp og salg (+10%)."],["Lser opp utlandshandel og karavaner."],["Finansfyrste: Kontrollerer markedstrender."]]},xt={grain:{price:10,stock:500,demand:1},flour:{price:15,stock:100,demand:1},bread:{price:25,stock:50,demand:1},wood:{price:15,stock:300,demand:1},plank:{price:25,stock:100,demand:1},iron_ore:{price:30,stock:100,demand:1},iron_ingot:{price:60,stock:50,demand:1},stone:{price:20,stock:200,demand:1},swords:{price:80,stock:20,demand:1},armor:{price:120,stock:10,demand:1},wool:{price:12,stock:200,demand:1},cloth:{price:45,stock:50,demand:1},honey:{price:30,stock:50,demand:1},meat:{price:25,stock:100,demand:1},glass:{price:50,stock:20,demand:1},iron:{price:40,stock:0,demand:1}},QL=[{type:"RAID",title:"Vikinger p horisonten!",description:"Et vikingskip er sett nr kysten. Forsvar jordene fr de stjeler kornet!",locationId:"fields"},{type:"RAID",title:"Bandittleir funnet",description:"Banditter har sltt seg ned i skogen. De stjeler ved hver time!",locationId:"forest"},{type:"QUEST",title:"Den Hellige Gral?",description:"Rykter sier en eremitt ved klosteret har funnet noe verdifullt.",locationId:"village"},{type:"QUEST",title:"Markedsdag i nabolaget",description:"En sjelden mulighet for god handel p grensen.",locationId:"marketplace"}],JL=[{id:"tax_cut",label:"Skattekutt",description:"Alle skatter halveres i 10 minutter. Lojaliteten stiger."},{id:"peace",label:"Fredsavtale",description:"Ingen raids tillatt de neste 10 minuttene."},{id:"salt_tax",label:"Saltskatt",description:"ker kornprisene, men reduserer lojalitet."},{id:"conscription",label:"Verneplikt",description:"Soldater koster mindre  verve, men bnder jobber 20% tregere."}],hy=Object.freeze(Object.defineProperty({__proto__:null,ACTION_COSTS:dc,ACTION_ICONS:xd,CRAFTING_RECIPES:Rn,CROP_DATA:C0,GAME_BALANCE:q,INITIAL_EQUIPMENT:ip,INITIAL_MARKET:xt,INITIAL_RESOURCES:Rt,INITIAL_SKILLS:jn,ITEM_TEMPLATES:Te,LAW_TEMPLATES:JL,LEVEL_XP:vd,RANK_BENEFITS:XL,REFINERY_RECIPES:_r,REPAIR_CONFIG:sp,RESOURCE_DETAILS:mn,REWARDS:uc,ROLE_DEFINITIONS:Cl,ROLE_TITLES:WL,SEASONS:An,SKILL_DETAILS:qL,UPGRADES_LIST:I0,VILLAGE_BUILDINGS:Bt,WEATHER:_s,WORLD_EVENT_TEMPLATES:QL},Symbol.toStringTag,{value:"Module"}));/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZL=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),e3=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,s)=>s?s.toUpperCase():n.toLowerCase()),my=t=>{const e=e3(t);return e.charAt(0).toUpperCase()+e.slice(1)},yS=(...t)=>t.filter((e,n,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===n).join(" ").trim(),t3=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var n3={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s3=_.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:i="",children:r,iconNode:a,...o},c)=>_.createElement("svg",{ref:c,...n3,width:e,height:e,stroke:t,strokeWidth:s?Number(n)*24/Number(e):n,className:yS("lucide",i),...!r&&!t3(o)&&{"aria-hidden":"true"},...o},[...a.map(([u,d])=>_.createElement(u,d)),...Array.isArray(r)?r:[r]]));/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=(t,e)=>{const n=_.forwardRef(({className:s,...i},r)=>_.createElement(s3,{ref:r,iconNode:e,className:yS(`lucide-${ZL(my(t))}`,`lucide-${t}`,s),...i}));return n.displayName=my(t),n};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i3=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],py=ae("activity",i3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r3=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],ga=ae("arrow-right",r3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a3=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],o3=ae("brain",a3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l3=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],j0=ae("check",l3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c3=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],u3=ae("chevron-down",c3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],rp=ae("circle-alert",d3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f3=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],gy=ae("clock",f3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h3=[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]],_S=ae("coins",h3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m3=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],bf=ae("crown",m3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],g3=ae("disc",p3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b3=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],v3=ae("eye-off",b3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x3=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],y3=ae("eye",x3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _3=[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]],wS=ae("gift",_3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],E3=ae("globe",w3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N3=[["path",{d:"m15 12-9.373 9.373a1 1 0 0 1-3.001-3L12 9",key:"1hayfq"}],["path",{d:"m18 15 4-4",key:"16gjal"}],["path",{d:"m21.5 11.5-1.914-1.914A2 2 0 0 1 19 8.172v-.344a2 2 0 0 0-.586-1.414l-1.657-1.657A6 6 0 0 0 12.516 3H9l1.243 1.243A6 6 0 0 1 12 8.485V10l2 2h1.172a2 2 0 0 1 1.414.586L18.5 14.5",key:"15ts47"}]],k3=ae("hammer",N3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S3=[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]],O0=ae("handshake",S3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T3=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],A3=ae("layout-grid",T3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R3=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],by=ae("loader-circle",R3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I3=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],M0=ae("lock",I3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C3=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],j3=ae("mail",C3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O3=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],ES=ae("map-pin",O3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M3=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],D3=ae("map",M3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L3=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],P3=ae("menu",L3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B3=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],jl=ae("message-square",B3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U3=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],H3=ae("music",U3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G3=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],V3=ae("package",G3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F3=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],ap=ae("pause",F3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z3=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],yd=ae("play",z3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $3=[["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]],K3=ae("scroll",$3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y3=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],q3=ae("search",Y3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W3=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],NS=ae("send",W3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X3=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Q3=ae("settings",X3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J3=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],vy=ae("shield-check",J3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z3=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],D0=ae("shield",Z3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eP=[["path",{d:"M17.971 4.285A2 2 0 0 1 21 6v12a2 2 0 0 1-3.029 1.715l-9.997-5.998a2 2 0 0 1-.003-3.432z",key:"15892j"}],["path",{d:"M3 20V4",key:"1ptbpl"}]],tP=ae("skip-back",eP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nP=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],sP=ae("skip-forward",nP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iP=[["path",{d:"m11 19-6-6",key:"s7kpr"}],["path",{d:"m5 21-2-2",key:"1kw20b"}],["path",{d:"m8 16-4 4",key:"1oqv8h"}],["path",{d:"M9.5 17.5 21 6V3h-3L6.5 14.5",key:"pkxemp"}]],op=ae("sword",iP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rP=[["path",{d:"M12 19h8",key:"baeox8"}],["path",{d:"m4 17 6-6-6-6",key:"1yngyt"}]],aP=ae("terminal",rP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oP=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],lP=ae("trending-up",oP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cP=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],xy=ae("triangle-alert",cP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uP=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],dP=ae("trophy",uP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fP=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],vf=ae("user",fP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hP=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],L0=ae("users",hP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mP=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],pP=ae("volume-2",mP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gP=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ji=ae("x",gP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bP=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],vP=ae("zap",bP),xP=t=>{const e=Object.keys(t),n=[...e].sort(()=>Math.random()-.5),s={...t};if(e.length===0)return s;const r=n.shift();r&&(s[r]={...s[r],role:"KING",resources:JSON.parse(JSON.stringify(Rt.KING)),regionId:"capital",status:{hp:100,stamina:100,morale:100,legitimacy:100,authority:100,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:1,xp:0,reputation:50,contribution:0},equipment:{MAIN_HAND:{id:"tools",name:"Kongens Verkty",icon:"",type:"MAIN_HAND",level:1,durability:100,maxDurability:100},OFF_HAND:{id:"weapon",name:"Kongens Sverd",icon:"",type:"OFF_HAND",level:1,durability:100,maxDurability:100},BODY:{id:"armor",name:"Kongens Rustning",icon:"",type:"BODY",level:1,durability:100,maxDurability:100}}});const o=Math.min(2,n.length);for(let m=0;m<o;m++){const g=n.shift();if(g){const v=m===0?"region_ost":"region_vest";s[g]={...s[g],role:"BARON",resources:JSON.parse(JSON.stringify(Rt.BARON)),regionId:v,status:{hp:100,stamina:100,morale:100,legitimacy:80,authority:50,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:1,xp:0,reputation:40,contribution:0},equipment:{MAIN_HAND:{id:"tools",name:"Baronens Verkty",icon:"",type:"MAIN_HAND",level:1,durability:100,maxDurability:100},OFF_HAND:{id:"weapon",name:"Baronens Sverd",icon:"",type:"OFF_HAND",level:1,durability:100,maxDurability:100},BODY:{id:"armor",name:"Baronens Rustning",icon:"",type:"BODY",level:1,durability:100,maxDurability:100}}}}}let c=0;const u=()=>{const m=c%2===0?"region_ost":"region_vest";return c++,m},d=n.length;let f=0,h=0;d>=4?(f=Math.max(1,Math.floor(d/6)),h=Math.max(1,Math.floor(d/5))):d>0&&d<4&&(f=0,h=0);for(let m=0;m<f;m++){const g=n.shift();g&&(s[g]={...s[g],role:"MERCHANT",resources:JSON.parse(JSON.stringify(Rt.MERCHANT)),regionId:u(),status:{hp:100,stamina:100,morale:100,legitimacy:100,authority:30,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:1,xp:0,reputation:30,contribution:0},equipment:{MAIN_HAND:{id:"tools",name:"Hndverkty",icon:"",type:"MAIN_HAND",level:1,durability:100,maxDurability:100},OFF_HAND:{id:"weapon",name:"Kort sverd",icon:"",type:"OFF_HAND",level:1,durability:100,maxDurability:100},BODY:{id:"armor",name:"Kjpmannskappe",icon:"",type:"BODY",level:1,durability:100,maxDurability:100}}})}for(let m=0;m<h;m++){const g=n.shift();g&&(s[g]={...s[g],role:"SOLDIER",resources:JSON.parse(JSON.stringify(Rt.SOLDIER)),regionId:u(),status:{hp:100,stamina:100,morale:100,legitimacy:100,authority:50,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:1,xp:0,reputation:20,contribution:0},equipment:{MAIN_HAND:{id:"tools",name:"Feltverkty",icon:"",type:"MAIN_HAND",level:1,durability:100,maxDurability:100},OFF_HAND:{id:"weapon",name:"Soldatens Sverd",icon:"",type:"OFF_HAND",level:1,durability:100,maxDurability:100},BODY:{id:"armor",name:"Brynjekofte",icon:"",type:"BODY",level:1,durability:100,maxDurability:100}}})}for(;n.length>0;){const m=n.shift();m&&(s[m]={...s[m],role:"PEASANT",resources:JSON.parse(JSON.stringify(Rt.PEASANT)),regionId:u(),status:{hp:100,stamina:100,morale:80,legitimacy:100,authority:10,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:1,xp:0,reputation:10,contribution:0},equipment:{}})}return s},yP=(t,e)=>{const n={...t},s=[];return Object.values(n).forEach(i=>{if(i.role==="PEASANT"){const a=Math.ceil((i.resources.grain||0)*.15),o=Math.ceil((i.resources.gold||0)*(15/100));if(a>0||o>0){const c=Object.values(n).find(u=>u.role==="BARON"&&(u.regionId===i.regionId||i.regionId==="test_region"&&u.regionId==="test_region"));c&&(i.resources.grain=Math.max(0,i.resources.grain-a),i.resources.gold=Math.max(0,i.resources.gold-o),n[c.id].resources.grain+=a,n[c.id].resources.gold+=o,s.push(`${i.name} betalte ${a} korn og ${o} gull i skatt til ${c.name}`))}}}),Object.values(n).forEach(i=>{if(i.role==="BARON"){const r=Math.ceil((i.resources.grain||0)*(e/100)),a=Math.ceil((i.resources.gold||0)*(e/100));if(r>0||a>0){const o=Object.values(n).find(c=>c.role==="KING");o&&(i.resources.grain=Math.max(0,i.resources.grain-r),i.resources.gold=Math.max(0,i.resources.gold-a),n[o.id].resources.grain+=r,n[o.id].resources.gold+=a,s.push(`${i.name} betalte ${r} korn og ${a} gull i skatt til Kongen`))}}}),Object.values(n).forEach(i=>{if(i.role==="MERCHANT"||i.role==="SOLDIER"){const r=i.role==="MERCHANT"?e/50:e/100,a=Math.ceil((i.resources.gold||0)*r);if(a>0){const o=Object.values(n).find(c=>c.role==="KING");o&&(i.resources.gold=Math.max(0,i.resources.gold-a),n[o.id].resources.gold+=a,s.push(`${i.name} (${i.role}) betalte ${a} gull i skatt til Kongen`))}}}),{updatedPlayers:n,results:s}},_P=(t,e)=>{if(!t||Object.keys(t).length===0)return null;const n=q.CONTRIBUTION_VALUES,s=Object.entries(t).map(([a,o])=>{let c=0;return Object.entries(o.resources||{}).forEach(([u,d])=>{c+=d*(n[u]||.1)}),{pid:a,score:c,name:o.name}});s.sort((a,o)=>o.score-a.score);const i=s[0];if(!i)return null;const r=e==="throne_room"?"KING":"BARON";return{winningPlayerId:i.pid,role:r}},wP=(t,e)=>({pin:t,name:e,status:"PLAYING",settings:"feudal_europe",hostName:"Host",isPublic:!0,market:JSON.parse(JSON.stringify(xt)),world:{year:1100,season:"Spring",weather:"Clear",gameTick:0,lastTickAt:Date.now(),taxRateDetails:{kingTax:20},settlement:{buildings:Object.entries(Bt).reduce((n,[s])=>({...n,[s]:{id:s,level:0,progress:{},target:200,contributions:{}}}),{})}},markets:{capital:{...xt},region_vest:{...xt},region_ost:{...xt}},players:{},public_profiles:{},messages:[],regions:{region_vest:{id:"region_vest",name:"Baroniet Vest",taxRate:10,defenseLevel:50,rulerName:"Ingen"},region_ost:{id:"region_ost",name:"Baroniet st",taxRate:10,defenseLevel:50,rulerName:"Ingen"}},diplomacy:{},worldEvents:{}}),Hc=async(t,e)=>{var s,i;if(!t||!e)return;const n=D(L,`simulation_server_metadata/${t}`);if(e.isPublic===!1){await Ba(n,null);return}await Ba(n,{pin:t,name:e.name||`Rike #${t}`,status:e.status,playerCount:Object.keys(e.players||{}).length,worldYear:((s=e.world)==null?void 0:s.year)||1100,season:((i=e.world)==null?void 0:i.season)||"Spring",isPublic:!!e.isPublic,hostName:e.hostName||"Anonym Host",lastUpdated:Date.now()})},lp=30,EP=21,NP=120,kS=480,kP=["Spring","Summer","Autumn","Winter"],SP=t=>t%lp,Ss=t=>SP(t)<EP?"DAY":"NIGHT",TP=(t,e=0)=>{let n=t;if(e>0){const o=(Date.now()-e)/6e4;n+=Math.min(1,Math.max(0,o))}const i=n%lp/lp*24,r=(6+Math.floor(i))%24,a=Math.floor(i%1*60);return`${r.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`},AP=t=>{const e=Math.floor(t%kS/NP);return kP[e]||"Spring"},RP=(t,e=1)=>e+Math.floor(t/kS),Et=async(t,e)=>{const n=D(L,`simulation_rooms/${t}/messages`);await Ae(n,s=>{let i=[];Array.isArray(s)?i=s:s&&typeof s=="object"&&(i=Object.values(s));const r={id:`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,content:e,timestamp:Date.now(),type:"SYSTEM"};return i.push(r),i.length>50&&(i=i.sort((a,o)=>a.timestamp-o.timestamp).slice(i.length-50)),i})},Kn=(t,e,n,s={})=>{var m,g;let i=0,r=!1;t.equipment&&Object.keys(t.equipment).forEach(x=>{var E,N;const p=t.equipment[x];if(!p)return;let b=p.relevantActions;if(!b&&p.id){const A=Object.keys(Te).find(w=>p.id===w||p.id.startsWith(w+"_")||p.id.startsWith(w+"-"));A&&(b=(E=Te[A])==null?void 0:E.relevantActions)}if(!s.actionType||(b==null?void 0:b.includes(s.actionType))){const A=p.stats||((N=Te[p.id])==null?void 0:N.stats);A!=null&&A.yieldBonus&&(i+=A.yieldBonus),(x==="AXE"||x==="PICKAXE"||x==="SCYTHE"||x==="MAIN_HAND"||x==="OFF_HAND"||x==="BOW"||x==="TRAP"||x==="CHISEL")&&(r=!0)}});let a=e+i;const o=((m=t.skills)==null?void 0:m[n])||{level:0},c=s.isRefining?q.SKILLS.REFINING_BONUS:q.SKILLS.GATHERING_BONUS,u=1+o.level*c;a*=u;const d=s.actionType==="FORAGE"||s.actionType==="GATHER_HONEY";if(!s.isRefining&&!r&&!d){if(s.requiresTool)return 0;const v=(g=q.GATHERING)==null?void 0:g.NO_TOOL_PENALTY;a*=1-v}let f=1;s.regionId&&(s.actionType==="MINE"&&(s.regionId==="region_vest"?f=1.2:s.regionId==="region_ost"&&(f=.8)),s.actionType==="CHOP"&&(s.regionId==="region_vest"?f=.8:s.regionId==="region_ost"&&(f=1.2)));const h=(s.season||1)*(s.weather||1)*(s.law||1)*(s.upgrades||1)*f;if(a=Math.floor(a*h),s.performance!==void 0){const v=q.MINIGAME.BASE_MULTIPLIER+s.performance*q.MINIGAME.PERFORMANCE_WEIGHT;a=Math.ceil(a*v)}return Math.max(0,a)},fs=(t,e,n,s,i=0)=>{const r=An[e],a=_s[n],o=(r==null?void 0:r.staminaMod)||1,c=(a==null?void 0:a.staminaMod)||1,d=Ss(i)==="NIGHT"?1.2:1;let h=t*o*c*d;if(s&&s.length>0){const m=Date.now(),g=s.find(v=>v.type==="STAMINA_SAVE"&&v.expiresAt>m);g&&(h*=1-g.value)}return Math.ceil(h)},Xt=(t,e,n,s=1)=>{if(!t||!e||!n)return;const i=n.replace(/\./g,"_"),r=D(L,`simulation_rooms/${t}/stats/${e}`);J(r,{[i]:mS(s)}).catch(a=>console.error("Failed to log systemic stat:",a))},IP=async(t,e,n)=>{const{resource:s,type:i}=n,r=D(L,`simulation_rooms/${t}/players/${e}`),a=await xe(r);if(!a.exists())return{success:!1,error:"Player not found"};const o=a.val(),c=o.regionId||"capital",u=D(L,`simulation_rooms/${t}/markets/${c}/${s}`);let d={success:!1,amount:0};if(await Ae(u,m=>{if(m){if(i==="BUY"){if(m.stock<=0)return;d.price=m.price,d.cost=m.price,d.amount=1,m.stock-=1,m.price+=m.price*q.MARKET.PRICE_IMPACT_BUY,d.success=!0}else if(i==="SELL"){d.price=m.price;const g=m.price*q.MARKET.SELL_RATIO;d.revenue=g,d.amount=1,m.stock+=1,m.price-=m.price*q.MARKET.PRICE_IMPACT_SELL,d.success=!0}return m}}),!d.success)return{success:!1,error:"Handel feilet (Vare mangler eller utsolgt)"};let f=!1,h="";return await Ae(r,m=>{if(!m)return;m.resources||(m.resources={}),m.inventory||(m.inventory=[]);const g=s==="swords"||s==="armor",v={swords:"iron_sword",armor:"leather_armor"};if(i==="BUY"){const x=d.cost||0;if((m.resources.gold||0)<x)return;if(m.resources.gold=(m.resources.gold||0)-x,g){const p=v[s],b=Te[p];if(b){const y=JSON.parse(JSON.stringify(b));m.inventory.push(y),h=`Kjpte 1 ${b.name} for ${x.toFixed(2)}g`}else m.resources[s]=(m.resources[s]||0)+1,h=`Kjpte 1 ${s} (Resource) for ${x.toFixed(2)}g`}else m.resources[s]=(m.resources[s]||0)+1,h=`Kjpte 1 ${s} for ${x.toFixed(2)}g`;f=!0}else if(i==="SELL"){const x=d.revenue||0;if(g){const p=v[s],b=m.inventory.findIndex(E=>E.id===p);if(b===-1)return;m.inventory.splice(b,1),m.resources.gold=(m.resources.gold||0)+x;const y=Te[p];h=`Solgte 1 ${y?y.name:s} for ${x.toFixed(2)}g`,f=!0}else{if((m.resources[s]||0)<1)return;m.resources[s]-=1,m.resources.gold=(m.resources.gold||0)+x,h=`Solgte 1 ${s} for ${x.toFixed(2)}g`,f=!0}}return m}),f?(Et(t,`[${new Date().toLocaleTimeString()}] ${o.name}: ${h}`),{success:!0,data:{success:!0,timestamp:Date.now(),message:h,utbytte:i==="BUY"?[{resource:s,amount:1}]:[{resource:"gold",amount:d.revenue}],xp:[],durability:[]}}):{success:!1,error:"Transaksjon avbrutt (Mangler ressurser)"}},CP=async(t,e,n)=>{var x;const{buildingId:s,resource:i,amount:r}=n,a=D(L,`simulation_rooms/${t}/world/settlement/buildings/${s}`),o=D(L,`simulation_rooms/${t}/players/${e}`),c=await xe(o);if(!c.exists())return{success:!1,error:"Player missing"};const u=c.val();if((((x=u.resources)==null?void 0:x[i])||0)<r)return{success:!1,error:"Not enough resources"};let d=!1,f=0,h="",m=!1,g=0;if(await Ae(a,p=>{var C,B,z;if(!p)return{id:s,level:1,progress:{[i]:r},contributions:{[e]:{name:u.name,resources:{[i]:r}}}};const b=Bt[s];h=(b==null?void 0:b.name)||s;const E=(p.level===void 0?0:p.level)+1,N=(C=b==null?void 0:b.levels)==null?void 0:C[E];if(!N)return;const A=((B=N.requirements)==null?void 0:B[i])||0,w=((z=p.progress)==null?void 0:z[i])||0,T=A-w;if(T<=0)return;f=Math.min(r,T),p.progress||(p.progress={}),p.progress[i]=w+f,p.contributions||(p.contributions={}),p.contributions[e]||(p.contributions[e]={name:u.name,resources:{}});const k=p.contributions[e].resources;k[i]=(k[i]||0)+f;let R=!0;if(Object.entries(N.requirements).forEach(([$,K])=>{(p.progress[$]||0)<K&&(R=!1)}),R){p.level=E,p.progress={};const $=N.unlocks||[];if($.includes("BARON_STATUS")||$.includes("KING_STATUS")){const K=_P(p.contributions,s);K&&(p.pendingWinnerId=K.winningPlayerId,p.pendingRole=K.role)}p.contributions={},m=!0,g=E}return d=!0,Xt(t,"contributions",i,f),p}),!d)return{success:!1,error:"Kunne ikke bidra (Fullt eller ugyldig)"};if(m){const b=(await xe(a)).val();if(b.pendingWinnerId){const y=b.pendingWinnerId,E=b.pendingRole,N=D(L,`simulation_rooms/${t}/players/${y}`),w=(await xe(N)).val(),T={};if(T[`${y}/role`]=E,E==="BARON"){const R=s==="manor_ost"?"region_ost":"region_vest";T[`${y}/regionId`]=R;const C=D(L,`simulation_rooms/${t}/regions/${R}`);await J(C,{rulerId:y,rulerName:w.name})}else E==="KING"&&(T[`${y}/regionId`]="capital");await J(D(L,`simulation_rooms/${t}/players`),T),await J(D(L,`simulation_rooms/${t}/public_profiles`),T);const k=` ${w.name} har fullfrt ${h} og er n utnevnt til ${E==="BARON"?"Baron":"Konge"}!`;Et(t,k),await J(a,{pendingWinnerId:null,pendingRole:null})}}let v=`Bidro med ${f} ${i} til ${h}`;return m&&(v+=`  ${h} ndde niv ${g}!`),await Ae(o,p=>{var b;if(p)return((b=p.resources)==null?void 0:b[i])>=f&&(p.resources[i]-=f),p}),Et(t,`[${new Date().toLocaleTimeString()}] ${u.name}: ${v}`),{success:!0,data:{success:!0,timestamp:Date.now(),message:v,utbytte:[{resource:i,amount:-f}],xp:[],durability:[]}}},jP=async(t,e,n)=>{const s=D(L,`simulation_rooms/${t}/players`),i=await xe(s);if(!i.exists())return{success:!1,error:"No players"};const r=i.val();let a=0,o=0;const c=Object.keys(r).map(async f=>{const h=D(L,`simulation_rooms/${t}/players/${f}`);let m={gold:0,grain:0};await Ae(h,g=>{if(!g||g.role!=="PEASANT"||g.regionId!==e)return;const v=Math.floor((g.resources.gold||0)*q.TAX.PEASANT_RATE_DEFAULT),x=Math.floor((g.resources.grain||0)*q.TAX.PEASANT_RATE_DEFAULT);return v>0&&(g.resources.gold-=v,m.gold=v),x>0&&(g.resources.grain-=x,m.grain=x),g}),m.gold>0&&(a+=m.gold),m.grain>0&&(o+=m.grain)});await Promise.all(c);const u=D(L,`simulation_rooms/${t}/players/${e}`);await Ae(u,f=>{if(f)return f.resources.gold=(f.resources.gold||0)+a,f.resources.grain=(f.resources.grain||0)+o,f.status.legitimacy=Math.max(0,(f.status.legitimacy||100)-5),f});const d=`Skatteinnkreving fullfrt: ${a}g og ${o} korn.`;return Et(t,`[${new Date().toLocaleTimeString()}] ${d}`),{success:!0,data:{success:!0,timestamp:Date.now(),message:d,utbytte:[{resource:"gold",amount:a},{resource:"grain",amount:o}],xp:[],durability:[]}}},CV=async(t,e,n)=>{const s=D(L,`simulation_rooms/${t}/players/${e}`),i=await xe(s);if(!i.exists())return{success:!1,error:"Fant ikke spilleren."};const r=i.val();if(r.role!=="PEASANT")return{success:!1,error:"Du har alt en karriere."};if(n!=="SOLDIER"&&n!=="MERCHANT")return{success:!1,error:"Ugyldig karrierevalg."};const a=q.CAREERS[n];if(r.stats.level<a.LEVEL_REQ)return{success:!1,error:`Du m vre level ${a.LEVEL_REQ} for  bli ${n==="SOLDIER"?"Soldat":"Kjpmann"}.`};if((r.resources.gold||0)<a.COST)return{success:!1,error:`Du mangler ${a.COST-(r.resources.gold||0)} gull.`};let o=!1;return await Ae(s,c=>{if(c&&!(c.resources.gold<a.COST))return c.resources.gold-=a.COST,c.role=n,o=!0,c}),o?(Et(t,`[KARRIERE] ${r.name} er n en ${n}!`),{success:!0,message:`Gratulerer! Du er n en ${n==="SOLDIER"?"Soldat":"Kjpmann"}.`}):{success:!1,error:"Transaksjon feilet."}},OP=async(t,e)=>{var x,p;Xt(t,"coups","start",1);const n=D(L,`simulation_rooms/${t}/regions/${e}`),i=(await xe(n)).val(),r=i.rulerId,a=i.rulerName;if(r){const b=D(L,`simulation_rooms/${t}/players/${r}`);await Ae(b,y=>{if(y)return y.role="PEASANT",y.status.legitimacy=0,y}),await J(D(L,`simulation_rooms/${t}/public_profiles/${r}`),{role:"PEASANT"})}const o={},c=((x=i.coup)==null?void 0:x.contributions)||{},u=((p=i.coup)==null?void 0:p.preVotes)||{};Object.entries(c).sort((b,y)=>y[1].amount-b[1].amount).slice(0,3).forEach(([b,y])=>{o[b]={id:b,name:y.name,votes:0,weightedVotes:0,contribution:y.amount}});const d=Date.now(),f={startedAt:d,expiresAt:d+q.COUP.VACANCY_DURATION,candidates:o,votes:{}};let h=0;const m=D(L,`simulation_rooms/${t}/players`),v=(await xe(m)).val()||{};Object.entries(u).forEach(([b,y])=>{if(o[y]){const E=v[b];if(E){let N=q.COUP.PEASANT_VOTE_WEIGHT;E.role==="KING"&&(N=q.COUP.KING_VOTE_WEIGHT),f.votes[b]={candidateId:y,weight:N},o[y].votes+=1,o[y].weightedVotes+=N,h++}}}),await J(n,{rulerId:null,rulerName:"VAKANT",activeElection:f,"coup/bribeProgress":0,"coup/preVotes":null}),Et(t,` REVOLUSJON i ${i.name}! ${a} er styrtet. ${h} skyggelfter ble automatisk talt opp!`)},jV=async(t,e,n)=>{var y,E;const{regionId:s,amount:i}=n,r=D(L,`simulation_rooms/${t}/regions/${s}`),a=D(L,`simulation_rooms/${t}/players/${e}`),o=await xe(a);if(!o.exists())return{success:!1,error:"Fant ikke spilleren."};const c=o.val();if((((y=c.resources)==null?void 0:y.gold)||0)<i)return{success:!1,error:"Du har ikke nok gull."};const d=(await xe(r)).val();if(!d)return{success:!1,error:"Region finnes ikke."};const f=((E=d.coup)==null?void 0:E.lastRulerChange)||0,h=Date.now();if(h-f<q.COUP.HONEYMOON_DURATION&&c.role!=="KING")return{success:!1,error:`Regionen er for stabil. Prv igjen om ${Math.ceil((q.COUP.HONEYMOON_DURATION-(h-f))/6e4)} minutter.`};if(d.activeElection)return{success:!1,error:"Et valg pgr allerede."};let m=0,g=!1;if(await Ae(r,N=>{N||(N={id:s,name:s==="capital"?"Kongeriket":s==="region_vest"?"Baroniet Vest":"Baroniet st",rulerName:"Ingen",coup:{lastRulerChange:0,bribeProgress:0,contributions:{}}}),N.coup||(N.coup={lastRulerChange:0,bribeProgress:0,contributions:{}}),N.garrison||(N.garrison={swords:0,armor:0,morale:100}),N.fortification||(N.fortification={hp:1e3,maxHp:1e3,level:1});const A=N.coup.bribeProgress||0,w=i/q.COUP.BASE_BRIBE_COST*10;return e===d.rulerId?N.coup.bribeProgress=Math.max(0,A-w):(N.coup.bribeProgress=Math.min(100,A+w),N.coup.challengerId=e,N.coup.challengerName=c.name),N.coup.contributions||(N.coup.contributions={}),N.coup.contributions[e]||(N.coup.contributions[e]={name:c.name,amount:0}),N.coup.contributions[e].amount+=i,m=N.coup.bribeProgress,g=!0,N}),!g)return{success:!1,error:"Transaksjon feilet (Region oppdatert)."};await Ae(a,N=>{if(N)return N.resources.gold=(N.resources.gold||0)-i,N});const v=D(L,`simulation_rooms/${t}/players`),x=await xe(v);let p={};x.exists()&&(p=x.val());let b=d.rulerId;if(!b&&Object.keys(p).length>0){if(s==="capital"){const N=Object.values(p).find(A=>A.role==="KING");N&&(b=N.id)}else{const N=Object.values(p).find(A=>A.role==="BARON"&&A.regionId===s);N&&(b=N.id)}b&&await J(r,{rulerId:b})}if(b){const N=D(L,`simulation_rooms/${t}/players/${b}`),A=Math.floor(i/100);if(await Ae(N,w=>{if(w)return w.status&&(w.status.legitimacy=Math.max(0,(w.status.legitimacy||0)-A)),w}),Object.keys(p).length>0){const w=Object.keys(p).filter(T=>p[T].regionId===s&&T!==e&&(p[T].role==="PEASANT"||p[T].role==="SOLDIER"));if(w.length>0){const T=Math.floor(i/w.length);T>0&&await Promise.all(w.map(k=>{const R=D(L,`simulation_rooms/${t}/players/${k}/resources`);return J(R,{gold:mS(T)})})),Et(t,`[FOLKEGAVE] ${c.name} donerte ${i}g. ${w.length} innbyggere fikk ${T}g hver! (Opprr: ${m.toFixed(0)}%)`)}else Et(t,`[FOLKEGAVE] ${c.name} donerte ${i}g til saken, men fant ingen trengende i ${d.name}. (Opprr: ${m.toFixed(0)}%)`)}else Et(t,`[FOLKEGAVE] ${c.name} donerte ${i}g. (Opprr: ${m.toFixed(0)}%)`);return m>=100&&await OP(t,s),{success:!0,message:`Besteikkelse gjennomfrt! Opprr: ${m.toFixed(1)}%`}}return{success:!0,message:"Besteikkelse registrert."}},OV=async(t,e,n,s)=>{const i=D(L,`simulation_rooms/${t}/regions/${n}`);let r=!1;return await Ae(i,a=>{if(a)return a.coup||(a.coup={bribeProgress:0,contributions:{},preVotes:{}}),a.coup.preVotes||(a.coup.preVotes={}),a.coup.preVotes[e]=s,r=!0,a}),r?{success:!0,message:"Skyggelfte avgitt!"}:{success:!1,error:"Kunne ikke avgi lfte."}},MV=async(t,e,n)=>{const s=D(L,`simulation_rooms/${t}/regions/${n}`),i=D(L,`simulation_rooms/${t}/players/${e}`),r=q.COUP.RESTORE_ORDER_COST,a=await xe(i);if(!a.exists())return{success:!1,error:"Spiller mangler"};const o=a.val();if(o.resources.gold<r)return{success:!1,error:`Trenger ${r}g for  gjenopprette ro.`};let c=!1;return await Ae(s,u=>{if(!(!u||u.rulerId!==e)&&u.coup)return u.coup.bribeProgress=Math.max(0,(u.coup.bribeProgress||0)-25),c=!0,u}),c?(await Ae(i,u=>{if(u)return u.resources.gold-=r,u.status.legitimacy=Math.min(100,(u.status.legitimacy||0)+10),u}),Et(t,` ${o.name} har gjenopprettet ro i ${n} ved  dele ut midler til vaktene.`),{success:!0,message:"Ro gjenopprettet (-25% opprr)"}):{success:!1,error:"Kunne ikke gjenopprette ro."}},DV=async(t,e,n)=>{const{regionId:s,candidateId:i}=n,r=D(L,`simulation_rooms/${t}/regions/${s}`),a=D(L,`simulation_rooms/${t}/players/${e}`),o=await xe(a);if(!o.exists())return{success:!1};const c=o.val();let u=q.COUP.PEASANT_VOTE_WEIGHT;c.role==="KING"&&(u=q.COUP.KING_VOTE_WEIGHT);let d=!1;return await Ae(r,f=>{if(!f||!f.activeElection||Date.now()>f.activeElection.expiresAt)return;f.activeElection.votes||(f.activeElection.votes={});const h=f.activeElection.votes[e];if(h){const g=f.activeElection.candidates[h.candidateId];g&&(g.votes=Math.max(0,(g.votes||0)-1),g.weightedVotes=Math.max(0,(g.weightedVotes||0)-h.weight))}f.activeElection.votes[e]={candidateId:i,weight:u};const m=f.activeElection.candidates[i];return m&&(m.votes=(m.votes||0)+1,m.weightedVotes=(m.weightedVotes||0)+u),d=!0,f}),{success:d}},LV=async(t,e)=>{const n=D(L,`simulation_rooms/${t}/regions/${e}`),i=(await xe(n)).val(),r=(i==null?void 0:i.name)||e;let a=null;if(await Ae(n,o=>{if(!o||!o.activeElection||Date.now()<o.activeElection.expiresAt)return;const c=Object.values(o.activeElection.candidates);if(c.length===0)return o.rulerId=null,o.rulerName="Ingen Hersker",o.activeElection=null,o;const u=c.sort((d,f)=>f.weightedVotes-d.weightedVotes)[0];return a={winnerId:u.id,winnerName:u.name},o.rulerId=u.id,o.rulerName=u.name,o.activeElection=null,o.coup||(o.coup={lastRulerChange:Date.now(),bribeProgress:0,contributions:{}}),o.coup.lastRulerChange=Date.now(),o.coup.bribeProgress=0,o.coup.contributions={},o}),a){Xt(t,"coups","success",1);const o=a.winnerId,c=D(L,`simulation_rooms/${t}/players/${o}`),d=(await xe(c)).val(),f={};return f[`${o}/role`]="BARON",f[`${o}/regionId`]=e,await J(D(L,`simulation_rooms/${t}/players`),f),await J(D(L,`simulation_rooms/${t}/public_profiles`),f),Et(t,` KRONING: ${d.name} har vunnet valget og er n Baron av ${r}!`),{success:!0}}return{success:!1}},MP=async(t,e,n)=>{const s=D(L,`simulation_rooms/${t}/players/${e}`);let i=!1;return await Ae(s,r=>{if(r)return r.resources||(r.resources={}),r.resources.gold=(r.resources.gold||0)+n,i=!0,r}),i&&Et(t,` ADMIN: Gitt ${n}g til en spiller.`),{success:i}},DP=async(t,e,n,s)=>{const i=D(L,`simulation_rooms/${t}/players/${e}`),r=Te[n];if(!r)return{success:!1,error:"Invalid Item ID"};let a=!1;return await Ae(i,o=>{if(o){o.inventory||(o.inventory=[]);for(let c=0;c<s;c++){const u=JSON.parse(JSON.stringify(r));u.instanceId=`${n}_${Date.now()}_${Math.random().toString(36).substr(2,5)}`,o.inventory.push(u)}return a=!0,o}}),a&&Et(t,` ADMIN: Gitt ${s}x ${r.name} til en spiller.`),{success:a}},LP=async(t,e,n,s)=>{const i=D(L,`simulation_rooms/${t}/players/${e}`);let r=!1;return await Ae(i,a=>{if(a)return a.resources||(a.resources={}),a.resources[n]=(a.resources[n]||0)+s,a.resources[n]<0&&(a.resources[n]=0),r=!0,a}),r&&Et(t,` ADMIN: Gitt ${s}x ${n} til en spiller.`),{success:r}},PP=async(t,e,n,s)=>{var d;const i=D(L,`simulation_rooms/${t}/players/${e}`),r=D(L,`simulation_rooms/${t}/channels/${s}/messages`),a=await xe(i);if(!a.exists())return{success:!1,error:"Spiller mangler"};const o=a.val();let c=0;if(o.role!=="KING"&&(s==="global"?c=2:s!==o.regionId&&s!=="diplomacy"&&s.includes(e)&&s.length>20&&(c=5)),(((d=o.resources)==null?void 0:d.gold)||0)<c)return{success:!1,error:`Trenger ${c}g for  sende denne meldingen.`};let u=!1;if(c>0?await Ae(i,f=>{if(f&&!((f.resources.gold||0)<c))return f.resources.gold-=c,u=!0,f}):u=!0,!u)return{success:!1,error:"Har ikke rd."};try{const f=hS(r);return await J(f,{id:f.key,senderId:e,senderName:o.name,senderRole:o.role,content:n.trim(),timestamp:BL(),isPremiere:c>0}),{success:!0}}catch(f){return console.error("Chat Send Error:",f),{success:!1,error:`Kunne ikke sende melding: ${f.message||"Ukjent feil"}`}}},SS=(t,e,n)=>{_.useEffect(()=>{if(!t||e==="LOBBY")return;const s=setInterval(async()=>{const i=Date.now(),r=(n==null?void 0:n.lastTickAt)||0;if(!(i-r<1e3))if(i-r>=6e4){const a=D(L,`simulation_rooms/${t}/world`);try{await Ae(a,o=>{if(!o)return;const c=o.lastTickAt||0;if(Date.now()-c>=6e4){const u=(o.gameTick||0)+1;return o.gameTick=u,o.lastTickAt=Date.now(),o.season=AP(u),o.year=RP(u,1100),o}else return})}catch{}}else n!=null&&n.lastTickAt||J(D(L,`simulation_rooms/${t}/world`),{lastTickAt:Date.now()})},5e3);return()=>clearInterval(s)},[t,e,n==null?void 0:n.lastTickAt,n==null?void 0:n.gameTick])};class BP{constructor(e){ze(this,"genome");this.genome=e}decide(e,n){var c;const s=[],i=e.status.stamina,r=(1-i/100)*this.genome.weights.hungerThreshold*5;e.resources.bread>0&&i<80&&s.push({action:{type:"EAT"},score:r,reason:"Sulten"}),i<50&&s.push({action:{type:"SLEEP"},score:(1-i/100)*this.genome.weights.restFocus*3,reason:"Trtt"}),s.push({action:{type:"CHOP"},score:this.genome.weights.gatherWood*this.getNeedMultiplier(e,"wood"),reason:"Trengte ved"}),s.push({action:{type:"QUARRY"},score:this.genome.weights.gatherStone*this.getNeedMultiplier(e,"stone"),reason:"Trengte stein"}),s.push({action:{type:"MINE"},score:this.genome.weights.gatherIron*this.getNeedMultiplier(e,"iron_ore"),reason:"Trengte jernmalm"}),s.push({action:{type:"WORK"},score:this.genome.weights.gatherGrain*this.getNeedMultiplier(e,"grain"),reason:"Trengte korn"});const a=((c=n.markets)==null?void 0:c[e.regionId])||n.market;a&&Object.entries(e.resources).forEach(([u,d])=>{if(u==="gold")return;const f=a[u];if(f&&d>10){const h=f.price;s.push({action:{type:"SELL",itemId:u,amount:Math.floor(d/2)},score:this.genome.weights.marketAggression*(h/20)*(d/50),reason:`Selger ${u} for gull`})}}),e.resources.gold>200&&s.push({action:{type:"CONTRIBUTE_TO_UPGRADE",buildingId:"great_hall"},score:this.genome.weights.promotionFocus*(e.resources.gold/1e3),reason:"Vil bli mektigere"});const o=s.filter(u=>{const d=typeof u.action=="string"?u.action:u.action.type,f=dc[d];if(!f)return!0;if(i<(f.stamina||0))return!1;for(const[h,m]of Object.entries(f))if(h!=="stamina"&&(e.resources[h]||0)<m)return!1;return!0});return o.length===0?{action:"IDLE",score:0,reason:"Ingenting  gjre"}:(o.sort((u,d)=>d.score-u.score),o[0])}getNeedMultiplier(e,n){const s=e.resources[n]||0;return s<5?2:s<20?1.2:s>100?.5:1}}const UP=(t=0)=>({id:`genome_${Date.now()}_${Math.floor(Math.random()*1e3)}`,generation:t,weights:{gatherWood:Math.random()*2,gatherStone:Math.random()*2,gatherIron:Math.random()*2,gatherGrain:Math.random()*2,marketAggression:Math.random()*2,savingsFocus:Math.random()*2,upgradeFocus:Math.random()*2,hungerThreshold:.2+Math.random()*.6,restFocus:Math.random()*2,promotionFocus:Math.random()*2,contributionFocus:Math.random()*2}}),HP=(t,e=.1)=>{const n={...t.weights};return Object.keys(n).forEach(s=>{if(Math.random()<.2){const i=(Math.random()*2-1)*e;n[s]=Math.max(0,Math.min(2,n[s]+i))}}),{...t,id:`genome_${Date.now()}_${Math.floor(Math.random()*1e3)}`,weights:n,generation:t.generation+1,parents:[t.id],fitness:void 0}},yy="eiriksbok_ai_top_genomes";class cp{static calculateFitness(e,n){const s=(e.resources.gold||0)+Object.values(e.resources).reduce((o,c)=>o+(typeof c=="number"?c:0),0)*.5,r={PEASANT:1,SOLDIER:5,MERCHANT:10,BARON:50,KING:200}[e.role]||1,a=Math.max(1,(Date.now()-n)/6e4);return(s+r*100)/a}static saveTopGenomes(e){const n=[...e].filter(s=>s.fitness!==void 0).sort((s,i)=>(i.fitness||0)-(s.fitness||0)).slice(0,3);localStorage.setItem(yy,JSON.stringify(n))}static getTopGenomes(){const e=localStorage.getItem(yy);if(!e)return[];try{return JSON.parse(e)}catch{return[]}}static getNextGenerationGenome(){const e=this.getTopGenomes();if(e.length===0)return UP(0);const n=e[Math.floor(Math.random()*e.length)];return HP(n)}}const TS={CHOP:["AXE","OFF_HAND"],MINE:["PICKAXE","OFF_HAND"],QUARRY:["CHISEL","OFF_HAND"],WORK:["SCYTHE","OFF_HAND"],RAID:["MAIN_HAND","OFF_HAND","BODY","HEAD","FEET"],DEFEND:["MAIN_HAND","OFF_HAND","BODY","HEAD","FEET"],PATROL:["MAIN_HAND","OFF_HAND","BODY"],EXPLORE:["MAIN_HAND","OFF_HAND","BODY","HEAD","FEET"],CRAFT:["MAIN_HAND","AXE","PICKAXE","SCYTHE","HAMMER"],HUNT:["MAIN_HAND","BOW","TRAP"],FORAGE:["MAIN_HAND","TRAP"],GATHER_WOOL:["MAIN_HAND","OFF_HAND"],SAWMILL:["MAIN_HAND","OFF_HAND"],PLANT:["MAIN_HAND","OFF_HAND"],HARVEST:["SCYTHE","OFF_HAND","MAIN_HAND"]},up=(t,e)=>{const n=TS[e];return!n||!t.equipment?[]:n.map(s=>{var i;return(i=t.equipment)==null?void 0:i[s]}).filter(s=>{var i,r;if(!s)return!1;if((i=s.relevantActions)!=null&&i.includes(e))return!0;if(!s.relevantActions){const a=s.id.split("_").slice(0,2).join("_"),o=Te[s.id]||Te[a]||Object.values(Te).find(c=>s.id.startsWith(c.id));return(r=o==null?void 0:o.relevantActions)!=null&&r.includes(e)?!0:!o||!o.relevantActions}return!1})},ro=(t,e)=>{const n=TS[e];return!n||!t.equipment?[]:n.filter(s=>{var r,a,o;const i=(r=t.equipment)==null?void 0:r[s];if(!i)return!1;if((a=i.relevantActions)!=null&&a.includes(e))return!0;if(!i.relevantActions){const c=i.id.split("_").slice(0,2).join("_"),u=Te[i.id]||Te[c]||Object.values(Te).find(d=>i.id.startsWith(d.id));return(o=u==null?void 0:u.relevantActions)!=null&&o.includes(e)?!0:!u||!u.relevantActions}return!1})},AS=(t,e,n="Spring",s="Clear",i=0)=>{var d;let r=typeof e=="string"?e:e.type,a=typeof e=="object"?{...e}:{};r.startsWith("REFINE_")&&!_r[r]?(a.recipeId=r.replace("REFINE_","").toLowerCase(),r="REFINE"):r.startsWith("CRAFT_")&&!Rn[r]?(a.subType=r.replace("CRAFT_","").toLowerCase(),r="CRAFT"):Rn[r]&&(a.subType=r,r="CRAFT");const o=up(t,r);for(const f of o)if(f.durability<=0)return{success:!1,reason:`delagt: ${f.name}`};if(r==="GATHER_WOOL"&&o.length===0)return{success:!1,reason:"Du mangler Saks"};let c={};const u=dc[r];if(u&&(c={...u}),r==="REFINE"||r==="CRAFT"){let f;r==="REFINE"&&(f=_r[a.recipeId]),r==="CRAFT"&&(f=Rn[a.subType]),f&&(f.stamina!==void 0&&(c.stamina=f.stamina),f.input&&Object.entries(f.input).forEach(([h,m])=>{c[h]=(c[h]||0)+m}))}if(Object.keys(c).length>0){const f=An[n],h=_s[s],m=(f==null?void 0:f.staminaMod)||1,g=(h==null?void 0:h.staminaMod)||1,v=Ss(i)==="NIGHT",x=v?1.2:1,p=c.stamina||0;if(r==="SLEEP"&&!v)return{success:!1,reason:"Du kan bare sove nr det er natt"};if(r==="PLANT"&&n==="Winter")return{success:!1,reason:"Bakken er frossen - du kan ikke s om vinteren"};if(a.locationId==="farm_well"||a.locationId==="well_water"||r==="GATHER_WATER"){const N=a.locationId||(r==="GATHER_WATER"?"well_water":null);if(N){const A=(d=t.activeProcesses)==null?void 0:d.find(w=>w.type==="WELL"&&w.locationId===N);if(A&&A.readyAt>Date.now())return{success:!1,reason:"Brnnen fyller seg med vann..."}}}const y=Math.ceil(p*m*g*x);if((t.status.stamina||0)<y)return{success:!1,reason:`Du mangler ${Math.ceil(y-(t.status.stamina||0))} energi`};const E={bread:"brd",gold:"gull",wood:"tre",flour:"mel",grain:"korn",iron_ingot:"jernbarrer",plank:"planker",stone:"stein",meat:"kjtt",honey:"honning",wool:"ull",iron_ore:"jernmalm",cloth:"stoff",stamina:"energi"};for(const[N,A]of Object.entries(c)){if(N==="stamina")continue;const w=t.resources[N]||0;if(w<A){const T=E[N]||N;return{success:!1,reason:`Du mangler ${A-w} ${T}`}}}}return{success:!0}},RS=(t,e="Spring",n="Clear",s=0)=>{let i=typeof t=="string"?t:t.type,r=typeof t=="object"?{...t}:{};i.startsWith("REFINE_")&&!_r[i]?(r.recipeId=i.replace("REFINE_","").toLowerCase(),i="REFINE"):i.startsWith("CRAFT_")&&!Rn[i]?(r.subType=i.replace("CRAFT_","").toLowerCase(),i="CRAFT"):Rn[i]&&(r.subType=i,i="CRAFT");let a={};const o=dc[i];if(o&&(a={...o}),i==="REFINE"||i==="CRAFT"){let d;i==="REFINE"&&(d=_r[r.recipeId]),i==="CRAFT"&&(d=Rn[r.subType]),d&&(d.stamina!==void 0&&(a.stamina=d.stamina),d.input&&Object.entries(d.input).forEach(([f,h])=>{a[f]=(a[f]||0)+h}))}if(Object.keys(a).length===0)return null;const c=[];if(a.stamina){const d=An[e],f=_s[n],m=Ss(s)==="NIGHT"?1.2:1,g=((d==null?void 0:d.staminaMod)||1)*((f==null?void 0:f.staminaMod)||1)*m,v=Math.ceil(a.stamina*g);let x="-";a.stamina<0&&(x="+"),c.push(`${x}${Math.abs(v)}`)}const u={bread:"",gold:"",wood:"",flour:"",grain:"",iron_ingot:"",plank:"",stone:"",meat:"",honey:"",wool:"",iron_ore:"",cloth:""};for(const[d,f]of Object.entries(a)){if(d==="stamina")continue;const h=f,m=u[d]||d;c.push(`-${h}${m}`)}return c.join(" ")},GP=(t,e,n)=>{t.activeProcesses||(t.activeProcesses=[]),t.activeProcesses.push({id:`cd_${Date.now()}_${Math.random().toString(36).substr(2,5)}`,type:"COOLDOWN",locationId:e,itemId:"cooldown",notified:!1,startedAt:Date.now(),readyAt:Date.now()+n,duration:n})},VP=t=>{const{actor:e,action:n,localResult:s}=t,i=n.processId;if(!e.activeProcesses)return s.success=!1,s.message="Ingen aktive prosesser.",!1;const r=e.activeProcesses.find(o=>o.id===i);if(!r)return s.success=!1,s.message="Fant ikke avlingen (kanskje den allerede er ferdig?).",!1;if(r.type!=="CROP")return s.success=!1,s.message="Kan bare vedlikeholde avlinger.",!1;if(r.maintainCount===void 0&&(r.maintainCount=0),r.yieldBonus===void 0&&(r.yieldBonus=0),r.maintainCount>=3)return s.success=!1,s.message="Denne keren er allerede perfekt vedlikeholdt.",!1;r.maintainCount+=1,r.yieldBonus+=.05;const a=n.subType==="WEED"?"Lukte ugress":"Skremte vekk krka";return s.message=`${a}! (+5% Utbytte).`,!0},FP=t=>{var f;const{actor:e,action:n,localResult:s,timestamp:i}=t,r=n.cropId||"grain",a=C0[r];if(!a)return s.success=!1,s.message=`Ukjent grde: ${r}`,!1;if((((f=t.room.world)==null?void 0:f.season)||"Spring")==="Winter")return s.success=!1,s.message="Du kan ikke s om vinteren - bakken er frossen.",!1;e.activeProcesses||(e.activeProcesses=[]);const c=n.locationId||"grain_fields";if(e.activeProcesses.find(h=>h.type==="CROP"&&h.locationId===c))return s.success=!1,s.message="Det vokser allerede noe her.",!1;const d={id:Math.random().toString(36).substr(2,9),type:"CROP",itemId:r,locationId:c,startedAt:Date.now(),duration:a.duration,readyAt:Date.now()+a.duration,notified:!1};return e.activeProcesses.push(d),s.message=`Sdde ${a.label}. Klar om ${Math.ceil(a.duration/6e4)} min.`,!0},zP=t=>{var b,y,E;const{actor:e,action:n,localResult:s,trackXp:i,damageTool:r,room:a}=t,o=Date.now(),c=n.locationId||"grain_fields",u=(b=e.activeProcesses)==null?void 0:b.findIndex(N=>N.locationId===c&&N.readyAt<=o);if(u===void 0||u===-1)return s.success=!1,s.message="Ingenting er klart til innhsting her.",!1;const d=e.activeProcesses[u];let f="",h=0,m="",g=0,v="FARMING";const x=C0[d.itemId],p=_r[d.itemId];if(x){m=x.label,f=x.yieldResource;const N=n.performance||.5,A=x.minYield+(x.maxYield-x.minYield)*N,w=((y=a.world)==null?void 0:y.season)||"Spring",T=An[w],k=1+(d.yieldBonus||0);h=Math.ceil(A*((T==null?void 0:T.yieldMod)||1)*k),g=Math.ceil(x.xp*(1+N))}else if(p){m=p.label,f=p.outputResource;const N=((E=p.output)==null?void 0:E.amount)||p.outputAmount||1,A=n.performance||.5;h=Kn(e,N,"CRAFTING",{performance:A,isRefining:!0}),g=p.xp||10,v=p.skill||"CRAFTING"}else return s.success=!1,s.message="Ugyldig prosess-data.",!1;return e.activeProcesses.splice(u,1),ro(e,"WORK").forEach(N=>{r(N,q.DURABILITY.LOSS_WORK)}),e.resources[f]||(e.resources[f]=0),e.resources[f]+=h,s.utbytte.push({resource:f,amount:h}),s.message=`Hstet ${h} ${m}`,i(v,g),!0},$P=t=>{var x,p,b,y,E,N,A;const{actor:e,room:n,action:s,localResult:i,trackXp:r,damageTool:a}=t,o=((x=n.world)==null?void 0:x.activeLaws)||[];ro(e,"WORK").forEach(w=>{a(w,q.DURABILITY.LOSS_WORK)});let c=1;o.includes("conscription")&&(c=.8);const u=q.YIELD.WORK_GRAIN+((p=e.upgrades)!=null&&p.includes("iron_plow")?5:0),d=((b=n.world)==null?void 0:b.season)||"Spring",f=((y=n.world)==null?void 0:y.weather)||"Clear",h=An[d],m=_s[f],g=s.performance||.5,v=Kn(e,u,"FARMING",{season:(h==null?void 0:h.yieldMod)||1,weather:(m==null?void 0:m.yieldMod)||1,law:c,performance:g,actionType:"WORK",regionId:e.regionId});if(e.resources.grain=(e.resources.grain||0)+v,i.utbytte.push({resource:"grain",amount:v}),i.message=`Hstet ${v} korn`,r("FARMING",Math.ceil(uc.WORK.xp*(1+g))),Math.random()<q.LUCKY_DROP.CHANCE+(((A=(N=(E=e.equipment)==null?void 0:E.HEAD)==null?void 0:N.stats)==null?void 0:A.luckBonus)||0)){const w=Math.ceil(v*.5),T=v+w;e.resources.grain+=w,i.utbytte.push({resource:"grain",amount:w,bonus:!0}),i.message=`Innhstet ${T} korn! (inkl. ${w} flaks)`}return!0},KP=t=>{var f,h,m,g;const{actor:e,room:n,action:s,localResult:i,trackXp:r,damageTool:a}=t,o=((f=n.world)==null?void 0:f.season)||"Spring";ro(e,"CHOP").forEach(v=>{a(v,q.DURABILITY.LOSS_WORK)});let c=q.YIELD.CHOP_WOOD;o==="Summer"&&(c+=q.YIELD.SUMMER_WOOD_BONUS);const u=s.performance||.5,d=Kn(e,c,"WOODCUTTING",{performance:u,actionType:"CHOP",regionId:e.regionId});if(e.resources.wood=(e.resources.wood||0)+d,i.utbytte.push({resource:"wood",amount:d}),i.message=`Felte ${d} ved`,r("WOODCUTTING",Math.ceil(uc.CHOP.xp*(1+u))),Math.random()<q.LUCKY_DROP.CHANCE+(((g=(m=(h=e.equipment)==null?void 0:h.HEAD)==null?void 0:m.stats)==null?void 0:g.luckBonus)||0)){const v=Math.ceil(d*.5),x=d+v;e.resources.wood+=v,i.utbytte.push({resource:"wood",amount:v,bonus:!0}),i.message=`Felte ${x} ved! (inkl. ${v} flaks)`}return!0},_y=t=>{const{actor:e,action:n,localResult:s,trackXp:i,damageTool:r}=t,a=typeof n=="string"?n:n.type;ro(e,a).forEach(h=>{r(h,q.DURABILITY.LOSS_WORK)});const o="MINING",c=a==="MINE"?q.YIELD.MINE_ORE:q.YIELD.QUARRY_STONE,u=a==="MINE"?"iron_ore":"stone",d=n.performance||.5,f=Kn(e,c,o,{performance:d,actionType:a,regionId:e.regionId});return e.resources[u]=(e.resources[u]||0)+f,s.utbytte.push({resource:u,amount:f}),s.message=a==="MINE"?`Utvant ${f} jernmalm`:`Hogde ${f} stein`,i(o,Math.ceil(uc.WORK.xp*(1+d))),!0},YP=t=>{const{actor:e,action:n,localResult:s,trackXp:i,damageTool:r}=t;ro(e,"FORAGE").forEach(u=>{r(u,1)});const a=q.YIELD.FORAGE_BREAD,o=n.performance||.5,c=Kn(e,a,"FARMING",{performance:o,actionType:"FORAGE"});return e.resources||(e.resources={}),e.resources.bread=(e.resources.bread||0)+c,s.utbytte.push({resource:"bread",amount:c}),s.message=`Sanket ${c} ndproviant (brd/br)`,i("FARMING",Math.ceil(uc.FORAGE.xp*(1+o))),!0},qP=t=>{const{actor:e,action:n,localResult:s,trackXp:i,damageTool:r}=t;ro(e,"HUNT").forEach(u=>{r(u,2)});const a=8,o=n.performance||.5,c=Kn(e,a,"COMBAT",{performance:o,actionType:"HUNT"});return e.resources.meat=(e.resources.meat||0)+c,s.utbytte.push({resource:"meat",amount:c}),s.message=`Felte bytte og fikk ${c} kjtt`,i("COMBAT",Math.ceil(15*(1+o))),!0},WP=t=>{const{actor:e,action:n,localResult:s,trackXp:i}=t,r=6,a=n.performance||.5,o=Kn(e,r,"FARMING",{performance:a,actionType:"GATHER_WOOL",requiresTool:!0});return o===0?(s.message="Du trenger en Saks for  klippe sauene!",!1):(e.resources.wool=(e.resources.wool||0)+o,s.utbytte.push({resource:"wool",amount:o}),s.message=`Klippet sauer og fikk ${o} ull`,i("FARMING",Math.ceil(10*(1+a))),!0)},XP=t=>{const{actor:e,action:n,localResult:s,trackXp:i}=t,r=4,a=n.performance||.5,o=Kn(e,r,"FARMING",{performance:a,actionType:"GATHER_HONEY"});return e.resources.honey=(e.resources.honey||0)+o,s.utbytte.push({resource:"honey",amount:o}),s.message=`Hentet ${o} honning fra bikubene`,i("FARMING",Math.ceil(12*(1+a))),!0},QP=t=>{const{actor:e,localResult:n}=t,s=5;if((e.resources.grain||0)<s)return n.success=!1,n.message=`Mangler korn. Trenger ${s} korn for  mate hnene.`,!1;if(e.activeProcesses||(e.activeProcesses=[]),e.activeProcesses.find(o=>o.type==="COOP"&&o.locationId==="chicken_coop"&&o.readyAt>Date.now()))return n.success=!1,n.message="Hnene har allerede mat.",!1;e.resources.grain-=s,n.utbytte.push({resource:"grain",amount:-s});const r=24e4,a={id:Math.random().toString(36).substr(2,9),type:"COOP",itemId:"egg",locationId:"chicken_coop",startedAt:Date.now(),duration:r,readyAt:Date.now()+r,notified:!1};return e.activeProcesses.push(a),n.message="Matet hnene. Egg klare om 4 minutter.",!0},JP=t=>{var o;const{actor:e,localResult:n,trackXp:s}=t,i=Date.now(),r=(o=e.activeProcesses)==null?void 0:o.findIndex(c=>c.type==="COOP"&&c.locationId==="chicken_coop"&&c.readyAt<=i);if(r===void 0||r===-1)return n.success=!1,n.message="Ingen egg  hente enn.",!1;e.activeProcesses.splice(r,1);const a=Math.floor(Math.random()*3)+3;return e.resources.egg||(e.resources.egg=0),e.resources.egg+=a,n.utbytte.push({resource:"egg",amount:a}),n.message=`Samlet ${a} egg.`,s("FARMING",15),!0},ZP=t=>{var c,u,d,f;const{actor:e,room:n,action:s,localResult:i,trackXp:r}=t,a=s.subType,o=Rn[a];if(o){if((((f=(d=(u=(c=n.world)==null?void 0:c.settlement)==null?void 0:u.buildings)==null?void 0:d[o.buildingId])==null?void 0:f.level)||1)<o.level)return i.success=!1,i.message=`Mangler bygningsniv ${o.level} for  lage dette.`,!1;let m=!0;if(Object.entries(o.input).forEach(([g,v])=>{e.resources[g]<v&&(m=!1)}),m){Object.entries(o.input).forEach(([x,p])=>{e.resources[x]-=p});const g=o.outputItemId;if(mn[g]||g==="omelette"){const x=o.outputAmount||1;e.resources[g]=(e.resources[g]||0)+x,i.utbytte.push({resource:g,amount:x});const p=Te[g];i.message=`Laget ${x}x ${(p==null?void 0:p.name)||g}!`,r("CRAFTING",25*o.level),Xt(n.pin,"crafted",g,x)}else{const x=Te[g];if(x){const p={...x,id:`${x.id}_${Date.now()}_${Math.floor(Math.random()*1e3)}`};e.inventory||(e.inventory=[]),e.inventory.push(p),i.utbytte.push({resource:g,amount:1}),i.message=`Smidde ${p.name}!`,r("CRAFTING",25*o.level),Xt(n.pin,"crafted",g,1)}}}else return i.success=!1,i.message="Mangler ressurser for  smi.",!1}else{const h=s.subType||"SWORDS",m=s.performance||.5;let g=1;h==="SWORDS"&&(g=5),h==="ARMOR"&&(g=2);const v=Kn(e,g,"CRAFTING",{performance:m});let x="swords";h==="ARMOR"&&(x="armor"),e.resources[x]=(e.resources[x]||0)+v,i.utbytte.push({resource:x,amount:v}),i.message=`Smidde ${v} ${x}`,r("CRAFTING",Math.ceil(15*(1+m)))}return!0},Dr=t=>{var c,u,d,f,h,m;const{actor:e,room:n,action:s,localResult:i,trackXp:r}=t,a=s.recipeId,o=_r[a];if(o){const g=((f=(d=(u=(c=n.world)==null?void 0:c.settlement)==null?void 0:u.buildings)==null?void 0:d[o.buildingId])==null?void 0:f.level)||1;if(o.requiredLevel&&g<o.requiredLevel)return i.success=!1,i.message=`Utvidelse kreves: ${o.buildingId} m vre Niv ${o.requiredLevel}.`,!1;let v=!0;if(Object.entries(o.input).forEach(([x,p])=>{e.resources[x]<p&&(v=!1)}),v){if(o.duration){e.activeProcesses||(e.activeProcesses=[]);const N=s.locationId||o.buildingId;if(e.activeProcesses.find(T=>T.locationId===N))return i.success=!1,i.message="Det pgr allerede en prosess her.",!1;Object.entries(o.input).forEach(([T,k])=>{e.resources[T]-=k});const w={id:Math.random().toString(36).substr(2,9),type:a==="flour"?"MILL":"CRAFT",itemId:a,locationId:N,startedAt:Date.now(),duration:o.duration,readyAt:Date.now()+o.duration,notified:!1};return e.activeProcesses.push(w),i.message=`Startet ${o.label.toLowerCase()}. Ferdig om ${Math.ceil(o.duration/6e4)} minutter.`,!0}Object.entries(o.input).forEach(([N,A])=>{e.resources[N]-=A});const x=s.performance||.5,p=((h=o.output)==null?void 0:h.amount)||o.outputAmount||1,b=Kn(e,p,"CRAFTING",{performance:x,isRefining:!0}),y=e.resources[o.outputResource]||0;e.resources[o.outputResource]=y+b;const E=((m=mn[o.outputResource])==null?void 0:m.label)||o.outputResource;i.utbytte.push({resource:o.outputResource,amount:b}),i.message=`Produserte ${b} ${E}`,r("CRAFTING",q.SKILLS.REFINING_XP),Xt(n.pin,"crafted",o.outputResource,b)}else return i.success=!1,i.message="Mangler ressurser til raffinering.",!1}return!0},e6=t=>{var m;const{actor:e,action:n,localResult:s}=t,i=n.targetSlot,r=n.buildingId;if(!r||!sp[r])return s.success=!1,s.message="Ugyldig reparasjonsstasjon.",!1;const a=sp[r];if(!a.slots.includes(i))return s.success=!1,s.message=`Denne stasjonen kan ikke reparere ${i}.`,!1;const o=e.equipment[i];if(!o)return s.success=!1,s.message="Ingen gjenstand i dette sporet.",!1;if(o.durability>=o.maxDurability)return s.success=!1,s.message=`${o.name} er allerede i perfekt stand.`,!1;const c=a.goldCost,u=1,d=a.material,f=(e.resources.gold||0)>=c,h=(e.resources[d]||0)>=u;if(f&&h){e.resources.gold-=c,e.resources[d]-=u;const g=q.DURABILITY.REPAIR_AMOUNT,v=o.durability;o.durability=Math.min(o.maxDurability,o.durability+g);const x=o.durability-v;s.durability.push({slot:i,item:o.name,amount:x}),s.message=`Reparerte ${o.name} (+${x} holdbarhet).`}else{s.success=!1;const g=((m=mn[d])==null?void 0:m.label)||d;return s.message=`Mangler ${f?"":`${c} gull`}${!f&&!h?" og ":""}${h?"":`${u} ${g}`}.`,!1}return!0},t6=t=>{const{actor:e,action:n,localResult:s}=t,{itemId:i,slot:r}=n;e.inventory&&!Array.isArray(e.inventory)&&(e.inventory=Object.values(e.inventory)),e.inventory||(e.inventory=[]);const a=e.inventory.findIndex(o=>o.id===i);if(a!==-1){const o=e.inventory[a],c=e.equipment[r];e.inventory.splice(a,1),e.equipment[r]=o,c&&e.inventory.push(c),s.message=`Utstyrte ${o.name}`}return!0},n6=t=>{const{actor:e,action:n,localResult:s}=t,{slot:i}=n,r=e.equipment[i];return r&&(e.equipment[i]=null,e.inventory&&!Array.isArray(e.inventory)&&(e.inventory=Object.values(e.inventory)),e.inventory||(e.inventory=[]),e.inventory.push(r),s.message=`Tok av ${r.name}`),!0},s6=t=>{const{actor:e,room:n,localResult:s}=t;if(e.role!=="BARON"&&e.role!=="KING")return s.success=!1,!1;let i=0,r=0;return Object.values(n.players).forEach(a=>{if(a.role==="PEASANT"&&a.id!==e.id){const o=Math.floor((a.resources.gold||0)*q.TAX.PEASANT_RATE_DEFAULT),c=Math.floor((a.resources.grain||0)*q.TAX.PEASANT_RATE_DEFAULT);o>0&&(a.resources.gold-=o,i+=o),c>0&&(a.resources.grain-=c,r+=c)}}),e.resources.gold=(e.resources.gold||0)+i,e.resources.grain=(e.resources.grain||0)+r,i>0||r>0?(s.utbytte.push({resource:"gold",amount:i}),s.utbytte.push({resource:"grain",amount:r}),s.message=`Krevde inn skatt: ${i}g og ${r} korn fra bndene.`):s.message="Ingen skatt  kreve inn (bndene er blakke).",e.status.legitimacy=Math.max(0,(e.status.legitimacy||100)-5),!0},i6=t=>{const{actor:e,localResult:n}=t;if(e.role!=="BARON"&&e.role!=="KING")return n.success=!1,!1;const s=5,i=10;if((e.resources.gold||0)>=s&&(e.resources.grain||0)>=i)e.resources.gold-=s,e.resources.grain-=i,e.resources.manpower=(e.resources.manpower||0)+10,n.utbytte.push({resource:"manpower",amount:10}),n.message="Mobiliserte tropper (+10 Manpower).";else return n.success=!1,n.message="Mangler ressurser for  mobilisere.",!1;return!0},r6=t=>{const{actor:e,room:n,localResult:s}=t;if(e.role!=="KING")return!1;s.message="UTSTEDTE KONGELIG DEKRET: Ekstraskatt!";let i=0;return Object.values(n.players).forEach(r=>{r.role==="BARON"&&r.resources.gold>=20&&(r.resources.gold-=20,i+=20)}),e.resources.gold=(e.resources.gold||0)+i,s.utbytte.push({resource:"gold",amount:i}),!0},wy=t=>{const{actor:e,room:n,action:s,localResult:i}=t,{buildingId:r,resource:a,amount:o}=s,c=Bt[r];if(!c)return i.success=!1,i.message=`Fant ikke bygning med ID: ${r}`,!1;const u=r==="farm_house";let d;u?(e.buildings||(e.buildings={}),e.buildings[r]||(e.buildings[r]={level:1,progress:{}}),d=e.buildings[r]):(n.world||(n.world={season:"Spring",weather:"Clear",year:1066,gameTick:0,lastTickAt:Date.now(),taxRateDetails:{kingTax:.1},settlement:{buildings:{}}}),n.world.settlement||(n.world.settlement={buildings:{}}),n.world.settlement.buildings||(n.world.settlement.buildings={}),n.world.settlement.buildings[r]||(n.world.settlement.buildings[r]={id:r,level:1,progress:{},contributions:{}}),d=n.world.settlement.buildings[r]),d.progress||(d.progress={}),e.resources||(e.resources=JSON.parse(JSON.stringify(Rt.PEASANT))),(!d.level||d.level<1)&&(d.level=1);const f=d.level+1,h=c.levels[f];if(!h)return i.success=!1,i.message="Maksimalt niv ndd.",!1;const g=(h.requirements||{})[a]||0,v=d.progress[a]||0,x=g-v;if(x<=0)return i.success=!1,i.message="Ressurskravet er allerede oppfylt.",!1;const p=e.resources[a]||0,b=Math.min(o,x,p);if(b<=0)return i.success=!1,i.message=`Kan ikke bidra 0 (Har: ${p}, Trenger: ${x}, Bud: ${o})`,!1;if(e.resources[a]=p-b,d.progress[a]=v+b,!u){d.contributions||(d.contributions={}),d.contributions[e.id]||(d.contributions[e.id]={name:e.name,resources:{}});const E=d.contributions[e.id].resources;E[a]=(E[a]||0)+b}i.message=`Bidro med ${b} ${a} til ${c.name}.`,i.utbytte.push({resource:a,amount:-b});let y=!0;return Object.entries(h.requirements).forEach(([E,N])=>{(d.progress[E]||0)<N&&(y=!1)}),y&&(d.level=f,d.progress={},u||(d.contributions={}),i.message+=`  NYTT NIV: ${c.name} ndde Niv ${f}!`),!0},a6=t=>{var c;const{actor:e,room:n,action:s,localResult:i}=t,r=typeof s=="string"?s:s.type,a=s.buildingId||r.replace("UPGRADE_BUILDING_",""),o=Bt[a];if(o){n.world.settlement||(n.world.settlement={buildings:{}});const d=(((c=n.world.settlement.buildings[a])==null?void 0:c.level)||1)+1,f=o.levels[d];if(f){let h=!0;if(Object.entries(f.requirements||{}).forEach(([m,g])=>{(e.resources[m]||0)<g&&(h=!1)}),h)Object.entries(f.requirements||{}).forEach(([m,g])=>{e.resources[m]-=g}),n.world.settlement.buildings[a]||(n.world.settlement.buildings[a]={id:a,level:1,progress:{},contributions:{}}),n.world.settlement.buildings[a].level=d,i.message=`Oppgraderte ${o.name} til Niv ${d}!`;else return i.success=!1,i.message="Mangler ressurser for oppgradering.",!1}}return!0},o6=t=>{var o;const{actor:e,action:n,localResult:s}=t,i=n.upgradeId,r=e.role,a=I0[r];if(a){const c=a.find(u=>u.id===i);if(c&&!((o=e.upgrades)!=null&&o.includes(i))){let u=!0;if(Object.entries(c.cost).forEach(([d,f])=>{e.resources[d]<f&&(u=!1)}),u)Object.entries(c.cost).forEach(([d,f])=>{e.resources[d]-=f}),e.upgrades||(e.upgrades=[]),e.upgrades.push(i),s.message=`Oppgradering fullfrt: ${c.name}`;else return s.success=!1,s.message="Har ikke rd til oppgradering.",!1}}return!0},l6=t=>{var c,u;const{actor:e,action:n,localResult:s}=t,i=n.targetRole;if(!i)return s.success=!1,s.message="Ingen rolle spesifisert.",!1;if(e.role===i)return s.success=!1,s.message=`Du er allerede ${i}.`,!1;if(["SOLDIER","MERCHANT","BARON","KING"].includes(i)&&i!=="BARON"&&i!=="KING"){const d=(c=e.roleStats)==null?void 0:c.PEASANT,f=(d==null?void 0:d.level)||(e.role==="PEASANT"?e.stats.level:1),h=q.CAREERS[i];if(h&&f<h.LEVEL_REQ)return s.success=!1,s.message=`Du m vre Bonde Niv ${h.LEVEL_REQ} for  bli ${i}. (N: ${f})`,!1}const a=((u=q.CAREERS[i])==null?void 0:u.COST)||0;if((e.resources.gold||0)<a)return s.success=!1,s.message=`Det koster ${a}g  bli ${i}. (Har: ${e.resources.gold}g)`,!1;e.roleStats||(e.roleStats={}),e.roleStats[e.role]={level:e.stats.level,xp:e.stats.xp,skills:JSON.parse(JSON.stringify(e.skills))},a>0&&(e.resources.gold-=a,s.utbytte.push({resource:"gold",amount:-a}));const o=e.roleStats[i];return o?(e.stats.level=o.level,e.stats.xp=o.xp,e.skills=o.skills):(e.stats.level=1,e.stats.xp=0,e.skills=JSON.parse(JSON.stringify(jn[i]||jn.PEASANT))),e.role=i,s.message=`Gratulerer! Du er n ${i}.`,!0},c6=t=>{const{actor:e,room:n,action:s,localResult:i}=t,{amount:r,resource:a}=s;if(e.role!=="BARON"&&e.role!=="KING")return!1;const o=e.regionId||"capital";n.regions||(n.regions={}),n.regions[o]||(n.regions[o]={id:o,name:o,defenseLevel:1,taxRate:10,rulerName:e.name});const c=n.regions[o];if(c.garrison||(c.garrison={swords:0,armor:0,morale:100}),e.inventory){const u=a==="swords"?"iron_sword":"leather_armor";let d=0;for(let h=0;h<e.inventory.length&&!((e.inventory[h].id===u||a==="swords"&&e.inventory[h].type==="MAIN_HAND"||a==="armor"&&e.inventory[h].type==="BODY")&&e.inventory[h].id===u&&(d++,d>=r));h++);if(d<r)return i.success=!1,i.message=`Mangler ${r-d} ${a==="swords"?"Jernsverd":"Lrrustninger"} i inventory.`,!1;let f=0;return e.inventory=e.inventory.filter(h=>f<r&&h.id===u?(f++,!1):!0),c.garrison[a]+=r,i.message=`Forsterket garnisonen med ${r} ${a==="swords"?"sverd":"rustninger"}.`,!0}return!1},u6=t=>{const{actor:e,room:n,localResult:s}=t;if(e.role!=="BARON"&&e.role!=="KING")return!1;const i=10,r=10,a=50;if((e.resources.stone||0)<i||(e.resources.wood||0)<r)return s.success=!1,s.message="Mangler stein eller ved for reparasjon.",!1;const o=e.regionId||"capital";if(!n.regions[o])return!1;const c=n.regions[o];return c.fortification||(c.fortification={hp:1e3,maxHp:1e3,level:1}),c.fortification.hp>=c.fortification.maxHp?(s.success=!1,s.message="Murene er allerede feilfrie.",!1):(e.resources.stone-=i,e.resources.wood-=r,c.fortification.hp=Math.min(c.fortification.maxHp,c.fortification.hp+a),s.message=`Reparerte murer (+${a} HP).`,s.utbytte.push({resource:"stone",amount:-i}),!0)},d6=t=>{const{actor:e,room:n,action:s,localResult:i}=t,{newRate:r}=s;if(e.role!=="BARON"&&e.role!=="KING")return!1;const a=Math.max(0,Math.min(20,r)),o=e.regionId||"capital";return n.regions||(n.regions={}),n.regions[o]||(n.regions[o]={id:o,name:o,defenseLevel:1,taxRate:10,rulerName:e.name}),n.regions[o].taxRate=a,i.message=`Skatteniv satt til ${a}%.`,!0},f6=.15,Ey=15,h6=t=>{var u,d,f;const{actor:e,room:n,localResult:s,action:i}=t,r=((u=i.payload)==null?void 0:u.targetRegionId)||e.regionId;if(!r||r==="capital"||r==="unassigned")return s.success=!1,s.message="Du m angi en gyldig region for  starte beleiring.",!1;if(!n.regions)return console.error("CRITICAL: room.regions is undefined in handleStartSiege",n),s.success=!1,s.message="Systemfeil: Kunne ikke hente regiondata.",!1;const a=n.regions[r];if(!a)return s.success=!1,s.message="Regionen eksisterer ikke.",!1;if(a.activeSiege)return s.success=!1,s.message="Beleiring pgr allerede!",!1;if(a.rulerName===e.name)return s.success=!1,s.message="Du kan ikke beleire ditt eget slott!",!1;const o=((d=e.resources)==null?void 0:d.swords)||0;if(o<500)return s.success=!1,s.message=`Du trenger minst 500 sverd i forsyninger for  starte en beleiring! (Eier: ${o})`,!1;const c=((f=a.fortification)==null?void 0:f.hp)||1e3;return a.activeSiege={phase:"BREACH",startedAt:Date.now(),lastTick:Date.now(),attackers:{[e.id]:{lane:1,hp:100,name:e.name}},defenders:{},gateHp:c,maxGateHp:c},s.message=`Beleiringen av ${a.name} har startet!`,!0},m6=t=>{var m,g,v;const{actor:e,room:n,localResult:s,action:i}=t,r=((m=i.payload)==null?void 0:m.targetRegionId)||e.regionId;if(!r||!((g=n.regions[r])!=null&&g.activeSiege))return s.success=!1,s.message="Ingen aktiv beleiring her.",!1;const a=n.regions[r].activeSiege,o=a.attackers||{},c=a.defenders||{};if(o[e.id]||c[e.id])return s.message="Du deltar allerede.",!1;const u=e.regionId===r,d=["BARON","KING"].includes(e.role);if(!u&&!d)return s.success=!1,s.message="Bare innbyggere eller adelen kan delta i krigfring i dette omrdet.",!1;const f=((v=i.payload)==null?void 0:v.side)==="DEFENDER",h={damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0};return f?(a.defenders||(a.defenders={}),a.defenders[e.id]={lane:1,hp:100,name:e.name,stats:h},s.message="Du forsvarer murene!"):(a.attackers||(a.attackers={}),a.attackers[e.id]={lane:1,hp:100,name:e.name,stats:h},s.message="Du har sluttet deg til beleiringen!"),!0},p6=t=>{var d,f,h,m,g,v,x,p,b,y,E,N,A,w,T;const{actor:e,room:n,action:s,localResult:i}=t,r=((d=s.payload)==null?void 0:d.targetRegionId)||e.regionId;if(!r||!((f=n.regions[r])!=null&&f.activeSiege))return i.success=!1,i.message="Ingen aktiv beleiring funnet i dette omrdet.",!1;const a=n.regions[r].activeSiege,o=a.attackers||{},c=a.defenders||{},u=o[e.id]||c[e.id];if(!u)return i.message="Du m vre deltaker i beleiringen (angriper eller forsvarer) for  delta i kapplpet.",!1;if(a.phase==="BREACH"){if(s.subType==="ATTACK_GATE"){const R=(((h=e.resources)==null?void 0:h.swords)||0)>0,C=R?25:2;return R&&(e.resources.swords-=1),a.gateHp=Math.max(0,(a.gateHp||1e3)-C),u.stats=u.stats||{damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0},u.stats.damageDealt+=C,i.message=R?` Du hugger ls p porten! (-${C} HP). Du har ${e.resources.swords} sverd igjen.`:` Du slr p porten med nevene... det gjr nesten ingen skade. (-${C} HP)`,R&&i.utbytte.push({resource:"swords",amount:-1}),a.gateHp<=0&&(a.phase="COURTYARD",a.gateHp=0,i.message="PORTEN ER KNUST! Storm borggrden!"),!0}if(s.subType==="SHIELD_WALL")return!0}if(a.phase==="COURTYARD"){const k=a;if(k.bossHp||(k.bossHp=1e4,k.maxBossHp=1e4,k.bossTargetLane=1,k.nextBossAttack=Date.now()+5e3),s.subType==="MOVE_LANE"){const B=(m=s.payload)==null?void 0:m.lane;B>=0&&B<=2&&(u.lane=B,i.message=`Forflyttet til bane ${B===0?"Venstre":B===1?"Midten":"Hyre"}.`)}s.subType==="ATTACK_BOSS"&&(k.bossHp-=25,u.stats=u.stats||{damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0},u.stats.damageDealt+=25,i.message=`Angrep Bossen! HP: ${k.bossHp}`);const R=((v=(g=n.regions[r])==null?void 0:g.fortification)==null?void 0:v.level)||1,C=f6+R*.05;if(Date.now()>k.nextBossAttack){const B=k.bossTargetLane,z=u.lane===B,$=Math.random()<C;if(z||$){const K=(z?20:0)+($?Ey:0),U=((x=e.resources)==null?void 0:x.armor)||0,O=Math.min(U,K),j=K-O;O>0&&(e.resources.armor-=O,i.utbytte.push({resource:"armor",amount:-O})),u.hp-=j,u.stats=u.stats||{damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0},u.stats.damageTaken+=K,z&&(i.message+=O>=20?"  Rustningen din tok sttet fra bossen!":"  AU! Bossen traff deg!"),$&&(i.message+=O>=Ey?"  Rustningen din stoppet pilene!":`  Piler fra murene traff deg! (-${j} HP)`),j>0&&O>0&&(i.message+=` (Rustningen absorberte ${O} skade)`)}k.bossTargetLane=Math.floor(Math.random()*3),k.nextBossAttack=Date.now()+5e3}if(k.bossHp<=0){a.phase="THRONE_ROOM";const B=n.regions[r].rulerId,z=n.players[B||""],$=z&&Date.now()-(z.lastActive||0)<6e4,K={};$&&B&&z&&(K[B]={id:B,name:z.name,armor:100,progress:20,joinedAt:Date.now()}),a.throne={mode:$?"PVP":"PVE",occupation:0,plundered:!1,bossHp:$?(((p=z==null?void 0:z.status)==null?void 0:p.hp)||100)*5:5e3,maxBossHp:$?(((b=z==null?void 0:z.status)==null?void 0:b.hp)||100)*5:5e3,defendingPlayerId:B,occupiers:K},i.message="GARNISONSSJEFEN ER BESEIRET! Drene til Tronsalen sls opp!"}return!0}if(a.phase==="THRONE_ROOM"||a.phase==="THRONE"){let k=a.throne;(!k||!k.occupiers)&&(k=k||{},k.occupiers=k.occupiers||{},k.lastTick=Date.now(),a.throne=k);const R=Date.now();if(R-(k.lastTick||0)>1e3){const C=Math.floor((R-(k.lastTick||0))/1e3);k.lastTick=R;const B=Object.values(k.occupiers||{}),z=((E=(y=n.regions[r])==null?void 0:y.garrison)==null?void 0:E.armor)||0,$=Math.min(.8,z/100*.1);B.forEach(K=>{var oe;const O=K.id===n.regions[r].rulerId?1*(1-$):1;K.armor=Math.max(0,K.armor-O*C);const j=o[K.id]||c[K.id],X=1*(1+(((oe=j==null?void 0:j.stats)==null?void 0:oe.damageDealt)||0)/200)*C;if(K.progress=Math.min(100,K.progress+X),j&&(j.stats=j.stats||{damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0},j.stats.ticksOnThrone+=C),K.armor<=0)delete k.occupiers[K.id],i.message=`${K.name} falt fra tronen! (0 Beleiringsrustning)`;else if(K.progress>=100){delete n.regions[r].activeSiege;const Ie=n.regions[r];K.id===Ie.rulerId?i.message=` ${K.name} har knust opprret og gjenopprettet kontroll over ${Ie.name}!`:(i.message=` ${K.name} har vunnet kappelpet og TATT TRONEN med makt!`,i.siegeWinnerId=K.id,i.targetRegionId=r)}})}if(s.subType==="CLAIM_THRONE"){k.occupiers||(k.occupiers={});const C=10,B=e.resources.armor||0;return B<C?(i.message=`Mangler Beleiringsrustning! Du har ${B}, men trenger ${C}.`,!1):(e.resources.armor=0,k.occupiers[e.id]={id:e.id,name:e.name,armor:B,progress:0,joinedAt:Date.now()},i.message=`${e.name} kastet seg inn i kampen om tronen med ${B} rustning!`,!0)}if(s.subType==="DONATE_ARMOR"){const C=(N=s.payload)==null?void 0:N.targetId,B=k.occupiers[C];if(!B)return i.message="Ugyldig ml.",!1;const z=e.resources.armor||0;return z<1?(i.message="Du har ingen beleiringsrustning  gi!",!1):(e.resources.armor=z-1,B.armor+=1,u.stats=u.stats||{damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0},u.stats.armorDonated+=1,i.message=`Donerte rustning til ${B.name}`,!0)}if(s.subType==="SUNDER_ARMOR"){const C=(A=s.payload)==null?void 0:A.targetId,B=k.occupiers[C];if(!B)return i.success=!1,i.message="Ingen p tronen  angripe!",!1;B.armor=Math.max(0,B.armor-1),u.stats=u.stats||{damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0},u.stats.damageDealt+=1;const z=C===n.regions[r].rulerId,$=((T=(w=n.regions[r])==null?void 0:w.garrison)==null?void 0:T.armor)||0;return z&&$>0?i.message=` Du angriper ${B.name}! Angrepet er mindre effektivt pga. slottets garnison-skjold.`:i.message=` Angrep ${B.name} p tronen!`,!0}return s.subType==="TICK",!0}return!1},g6=t=>{var o,c,u,d,f,h;const{actor:e,room:n,localResult:s,trackXp:i,damageTool:r}=t;if(e.role!=="BARON")return s.success=!1,!1;const a=Object.values(n.players).find(m=>m.role==="BARON"&&m.id!==e.id);if(a){if((((o=n.world)==null?void 0:o.activeLaws)||[]).includes("peace"))return s.success=!1,s.message="Fredsavtale blokkerer raid!",!1;const g=e.resources.manpower||0;let v=a.resources.manpower||0,x=Math.random()*.5+.75;if((c=a.upgrades)!=null&&c.includes("stone_keep")&&(v+=30),(u=a.upgrades)!=null&&u.includes("fence")&&(v+=10),(d=e.upgrades)!=null&&d.includes("stables")&&(x+=.1),(f=e.equipment)!=null&&f.MAIN_HAND&&r("MAIN_HAND",q.DURABILITY.LOSS_COMBAT_WEAPON),(h=e.equipment)!=null&&h.BODY&&r("BODY",q.DURABILITY.LOSS_COMBAT_ARMOR),g*x>v){const p=Math.floor((a.resources.gold||0)*q.COMBAT.RAID_LOOT_FACTOR),b=Math.floor((a.resources.grain||0)*q.COMBAT.RAID_LOOT_FACTOR);a.resources.gold=Math.max(0,(a.resources.gold||0)-p),a.resources.grain=Math.max(0,(a.resources.grain||0)-b),e.resources.gold=(e.resources.gold||0)+p,e.resources.grain=(e.resources.grain||0)+b,e.resources.manpower=Math.max(0,e.resources.manpower-5),a.resources.manpower=Math.max(0,a.resources.manpower-8),s.utbytte.push({resource:"gold",amount:p}),s.utbytte.push({resource:"grain",amount:b}),s.message=`Plyndret ${a.name} for ${p}g og ${b} korn!`,i("COMBAT",50)}else return e.resources.manpower=Math.max(0,e.resources.manpower-10),s.success=!1,s.message=`Angrepet p ${a.name} ble sltt tilbake.`,i("COMBAT",10),!1}else return s.success=!1,s.message="Fant ingen annen baron  raide.",!1;return!0},b6=t=>{const{actor:e,action:n,localResult:s,trackXp:i}=t,r=n.performance||.5,a=Math.ceil(15*r);return e.resources.gold=(e.resources.gold||0)+a,i("COMBAT",10),s.utbytte.push({resource:"gold",amount:a}),s.message="Utfrte patrulje.",!0},v6=t=>{var d;const{actor:e,room:n,action:s,localResult:i}=t,{resource:r}=s,a=e.regionId||"capital";let o=((d=n.markets)==null?void 0:d[a])||n.market;if(o||(n.markets||(n.markets={}),o=JSON.parse(JSON.stringify(xt)),n.markets[a]=o),!o)return i.success=!1,i.message="Markedet er ikke tilgjengelig.",!1;if(!o[r]&&xt[r]&&(o[r]={...xt[r]}),!o[r])return i.success=!1,i.message="Markedet tilbyr ikke denne varen her.",!1;const c=o[r];if(!c)return i.success=!1,i.message="Varen finnes ikke p dette markedet.",!1;const u=c.price;return c.stock<=0?(i.success=!1,i.message="Varen er utsolgt.",!1):(e.resources.gold||0)<u?(i.success=!1,i.message="Du har ikke nok gull.",!1):(e.resources.gold=(e.resources.gold||0)-u,e.resources[r]=(e.resources[r]||0)+1,c.stock-=1,c.price+=c.price*q.MARKET.PRICE_IMPACT_BUY,i.message=`Kjpte 1 ${r} for ${u.toFixed(2)}g`,i.utbytte.push({resource:r,amount:1}),!0)},x6=t=>{var d;const{actor:e,room:n,action:s,localResult:i}=t,{resource:r}=s,a=e.regionId||"capital";let o=((d=n.markets)==null?void 0:d[a])||n.market;if(o||(n.markets||(n.markets={}),o=JSON.parse(JSON.stringify(xt)),n.markets[a]=o),!o)return i.success=!1,i.message="Markedet er ikke tilgjengelig.",!1;if(!o[r]&&xt[r]&&(console.log(`Lazy patching market: Adding missing ${r}`),o[r]={...xt[r]}),!o[r])return i.success=!1,i.message="Markedet tar ikke imot denne varen her.",!1;if((e.resources[r]||0)<1)return i.success=!1,i.message=`Du har ingen ${r}  selge.`,!1;const c=o[r];if(!c)return i.success=!1,i.message="Markedet tar ikke imot denne varen.",!1;const u=c.price*q.MARKET.SELL_RATIO;return e.resources[r]-=1,e.resources.gold=(e.resources.gold||0)+u,c.stock+=1,c.price-=c.price*q.MARKET.PRICE_IMPACT_SELL,i.message=`Solgte 1 ${r} for ${u.toFixed(2)}g`,!0},y6=t=>{var g,v;const{actor:e,room:n,action:s,localResult:i,trackXp:r}=t,{resource:a,targetRegionId:o,action:c}=s,u=e.regionId||"capital",d=((g=n.markets)==null?void 0:g[u])||n.market,f=(v=n.markets)==null?void 0:v[o];if(!d||!f||!d[a]||!f[a])return i.success=!1,i.message="Ugyldig handelsrute eller vare.",!1;const h=d[a],m=f[a];if(!h||!m)return i.success=!1,i.message="Varen handles ikke p disse markedene.",!1;if(c==="IMPORT"){const p=m.price*5;if((e.resources.gold||0)<p)return i.success=!1,i.message="Ikke nok gull til bulk-import.",!1;if(m.stock<5)return i.success=!1,i.message="Mangler bulk-lager ved kilden.",!1;e.resources.gold-=p,e.resources[a]=(e.resources[a]||0)+5,m.stock-=5,m.price+=m.price*.02,i.message=`Importerte 5 ${a} fra ${o} for ${p.toFixed(2)}g`}else{if((e.resources[a]||0)<5)return i.success=!1,i.message=`Mangler 5 ${a} for eksport.`,!1;const p=m.price*q.MARKET.SELL_RATIO*5;e.resources[a]-=5,e.resources.gold+=p,m.stock+=5,m.price-=m.price*.02,i.message=`Eksporterte 5 ${a} til ${o} for ${p.toFixed(2)}g`}return r("TRADING",25),!0},_6=t=>{var o;const{actor:e,room:n,localResult:s}=t;if(!(Ss(((o=n.world)==null?void 0:o.gameTick)||0)==="NIGHT"))return s.success=!1,s.message=" Du kan bare sove nr det er natt.",!1;const a=100-(e.status.stamina||0);return e.status.stamina=100,e.status.hp=Math.min(100,(e.status.hp||100)+20),e.activeBuffs||(e.activeBuffs=[]),e.activeBuffs=e.activeBuffs.filter(c=>c.type!=="STAMINA_SAVE"||c.label!=="Godt utvilt"),e.activeBuffs.push({id:"well_rested_"+Date.now(),type:"STAMINA_SAVE",value:.5,label:"Godt utvilt",description:"50% mindre stamina-forbruk etter en god natts svn.",expiresAt:Date.now()+3e5}),s.message="Du sov tungt gjennom natten. Vknet opp uthvilt og full av energi!",s.utbytte.push({resource:"stamina",amount:a}),!0},Gc=t=>{var d;const{actor:e,action:n,localResult:s}=t,i=typeof n=="string"?n:n.type,r=n.locationId;let a=30,o=0,c="Hvilte.";if(i==="EAT"&&(a=40,c="Satt ved varmen og spiste."),i==="FEAST"&&(a=100,o=20,c="Holdt gjestebud!"),i==="GATHER_WATER"||r==="farm_well"||r==="well_water"){e.activeProcesses||(e.activeProcesses=[]);const f=r||(i==="GATHER_WATER"?"well_water":null);if(f){const h=e.activeProcesses.find(m=>m.type==="WELL"&&m.locationId===f);if(h){if(h.readyAt>Date.now())return s.success=!1,s.message="Brnnen er tom. Den fyller seg med vann...",!1;e.activeProcesses=e.activeProcesses.filter(m=>m.id!==h.id)}a=5,c="Drakk friskt vann fra brnnen.",e.activeProcesses.push({id:"well_"+Date.now(),type:"WELL",itemId:"water",locationId:f,startedAt:Date.now(),duration:3e5,readyAt:Date.now()+3e5,notified:!1})}}return r==="village_square"&&(a=10,c="Hvilte p torget.",GP(e,"REST_SQUARE",6*60*1e3)),(d=e.upgrades)!=null&&d.includes("roof")&&(a+=20),r==="royal_chambers"&&(a=100,o=100,c="Hvilte ut i de kongelige kamrene. Fler deg som en konge igjen!",e.activeBuffs||(e.activeBuffs=[]),e.activeBuffs=e.activeBuffs.filter(f=>f.label!=="Kongelig Velvre"),e.activeBuffs.push({id:"royal_wellness_"+Date.now(),type:"STAMINA_SAVE",value:.6,label:"Kongelig Velvre",description:"Fyrstelig velvre reduserer stamina-forbruk med 60%.",expiresAt:Date.now()+6e5})),e.status.stamina=Math.min(100,(e.status.stamina||0)+a),o>0&&(e.status.hp=Math.min(100,(e.status.hp||100)+o)),s.utbytte.push({resource:"stamina",amount:a}),s.message=c,!0},w6=t=>{const{actor:e,localResult:n,trackXp:s}=t,i=Math.floor(Math.random()*5)+1;return e.resources.favor=(e.resources.favor||0)+i,n.utbytte.push({resource:"favor",amount:i}),s("THEOLOGY",10),n.message=`Ba til gudene. (+${i} velvilje)`,!0},E6=t=>{const{localResult:e}=t,n=["Baronen ser nervs ut i dag.","Hrte du ulvene i natt?","Prisen p korn gr opp.","Kongens soldater er p vei."];return e.message=`Sladder: "${n[Math.floor(Math.random()*n.length)]}"`,!0},N6=t=>{const{actor:e,action:n,localResult:s}=t,{amount:i,isWin:r,playerRoll:a,houseRoll:o}=n;return r?(e.resources.gold=(e.resources.gold||0)+i,s.utbytte.push({resource:"gold",amount:i}),s.message=`Vant ${i}g p terninger! (${a} mot ${o})`):(e.resources.gold=Math.max(0,(e.resources.gold||0)-i),s.message=`Tapte ${i}g p terninger. (${a} mot ${o})`),!0},k6=t=>{const{actor:e,localResult:n}=t,s=5;if((e.resources.gold||0)>=s){e.resources.gold-=s;const i=10;e.status.stamina=Math.min(100,(e.status.stamina||0)+i),n.utbytte.push({resource:"stamina",amount:i}),n.message="Kjpte et mltid i baren. (+10 Stamina)"}else return n.success=!1,n.message="Har ikke rd til mat (koster 5g).",!1;return!0},S6=t=>{const{actor:e,room:n,localResult:s}=t;return s.message=`${e.name} har valgt  trekke seg tilbake fra dette livet.`,delete n.players[e.id],!0},T6=t=>{const{actor:e,action:n,localResult:s,room:i}=t,r=n.itemId;if(n.isResource)return(e.resources[r]||0)<1?(s.success=!1,s.message="Du har ikke mer igjen.",!1):r==="omelette"?(e.activeBuffs||(e.activeBuffs=[]),e.activeBuffs=e.activeBuffs.filter(d=>d.type!=="STAMINA_SAVE"),e.activeBuffs.push({id:Math.random().toString(36).substr(2,9),type:"STAMINA_SAVE",value:.2,label:"Lett til beins",description:"Reduserer stamina-kostnad med 20%.",expiresAt:Date.now()+9e5,sourceItem:"omelette"}),e.resources.omelette--,s.message="Spiste Omelett. (20% stamina-spare buff)",s.utbytte.push({resource:"omelette",amount:-1}),Xt(i.pin,"consumed","omelette",1),!0):r==="bread"?(e.status.stamina=Math.min(100,(e.status.stamina||0)+20),e.resources.bread--,s.message="Spiste Brd. (+20 Stamina)",s.utbytte.push({resource:"stamina",amount:20}),s.utbytte.push({resource:"bread",amount:-1}),Xt(i.pin,"consumed","bread",1),!0):(s.success=!1,s.message="Kan ikke spises (ukjent ressurs).",!1);if(!e.inventory)return s.success=!1,s.message="Ryggsekk er tom.",!1;const o=e.inventory.findIndex(u=>u.id===r);if(o===-1)return s.success=!1,s.message="Fant ikke gjenstanden.",!1;const c=e.inventory[o];return c.id==="omelette"||c.id.startsWith("omelette_")?(e.activeBuffs||(e.activeBuffs=[]),e.activeBuffs=e.activeBuffs.filter(u=>u.type!=="STAMINA_SAVE"),e.activeBuffs.push({id:Math.random().toString(36).substr(2,9),type:"STAMINA_SAVE",value:.2,label:"Lett til beins",description:"Reduserer stamina-kostnad med 20%.",expiresAt:Date.now()+9e5,sourceItem:"omelette"}),e.inventory.splice(o,1),s.message="Spiste Omelett (Gjenstand).",s.utbytte.push({resource:"omelette",amount:-1}),Xt(i.pin,"consumed","omelette",1),!0):c.id==="bread"||c.id.startsWith("bread_")?(e.status.stamina=Math.min(100,(e.status.stamina||0)+20),e.inventory.splice(o,1),s.message="Spiste Brd (Gjenstand). (+20 Stamina)",s.utbytte.push({resource:"stamina",amount:20}),s.utbytte.push({resource:"stamina",amount:20}),s.utbytte.push({resource:"bread",amount:-1}),Xt(i.pin,"consumed","bread",1),!0):(s.success=!1,s.message="Kan ikke spises.",!1)},IS={WORK:$P,CHOP:KP,MINE:_y,QUARRY:_y,FORAGE:YP,HUNT:qP,GATHER_WOOL:WP,GATHER_HONEY:XP,PLANT:FP,HARVEST:zP,MAINTAIN_CROP:VP,CRAFT:ZP,REFINE:Dr,BAKE:Dr,MILL:Dr,SMELT:Dr,WEAVE:Dr,MIX:Dr,REPAIR:e6,EQUIP_ITEM:t6,UNEQUIP_ITEM:n6,TAX:s6,DRAFT:i6,DECREE:r6,CONSTRUCT:wy,CONTRIBUTE_TO_UPGRADE:wy,UPGRADE_BUILDING:a6,UPGRADE:o6,JOIN_ROLE:l6,REINFORCE_GARRISON:c6,REPAIR_WALLS:u6,SET_TAX:d6,START_SIEGE:h6,JOIN_SIEGE:m6,SIEGE_ACTION:p6,RAID:g6,PATROL:b6,SLEEP:_6,REST:Gc,EAT:Gc,FEAST:Gc,PRAY:w6,CHAT_LOCAL:E6,GAMBLE_RESULT:N6,BUY_MEAL:k6,RETIRE:S6,CONSUME:T6,FEED_CHICKENS:QP,COLLECT_EGGS:JP,GATHER_WATER:Gc,TRADE_ROUTE:y6,BUY:v6,SELL:x6},A6=(t,e,n,s)=>{var u,d;t.roleStats||(t.roleStats={});const i=t.role;t.roleStats[i]||(t.roleStats[i]={level:((u=t.stats)==null?void 0:u.level)||1,xp:((d=t.stats)==null?void 0:d.xp)||0,skills:JSON.parse(JSON.stringify(t.skills||jn[i]||jn.PEASANT))});const r=t.roleStats[i],a=r.skills[e];a&&(a.xp+=n||0,a.xp>=a.maxXp&&(a.level+=1,a.xp-=a.maxXp,a.maxXp=Math.floor(a.maxXp*1.5),s.push(` ${t.name} ble bedre i ${e}! (Niv ${a.level})`))),r.xp=(r.xp||0)+(n||0);const c=(f=>{const h=vd.findIndex(m=>f<m);return h===-1?vd.length:h})(r.xp);c>r.level&&(r.level=c,s.push(` ${t.name} har steget i rang som ${i} til Niv ${c}!`)),t.stats.xp=r.xp,t.stats.level=r.level,t.skills=r.skills};async function R6(t,e,n){var i,r,a;if(!t||!n)return;const s=D(L,`simulation_accounts/${t}`);try{const o=await xe(s);if(!o.exists())return;const c=o.val(),u=c.characterHistory||[],d={name:n.name,role:n.role,level:((i=n.stats)==null?void 0:i.level)||1,xp:((r=n.stats)==null?void 0:r.xp)||0,roomPin:e,timestamp:Date.now()},f=[...u,d],h=((a=n.stats)==null?void 0:a.xp)||0,m=(c.globalXp||0)+h,g=Math.floor(Math.sqrt(m/100))+1;await J(s,{characterHistory:f,globalXp:m,globalLevel:g,lastActive:Date.now()}),console.log(`Character life recorded for ${n.name} (${t})`)}catch(o){console.error("Failed to record character life:",o)}}async function I6(t,e,n){const s=typeof n=="string"?n:n.type,i=D(L,`simulation_rooms/${t}/players/${e}`),r=D(L,`simulation_rooms/${t}/regions`),a=D(L,`simulation_rooms/${t}/world`);try{const[o,c,u]=await Promise.all([xe(i),xe(r),xe(a)]);if(!o.exists())return{success:!1,error:"Spiller finnes ikke"};const d=o.val();d.resources||(d.resources=Rt[d.role]||Rt.PEASANT);const f=c.val()||{},h=u.val()||{},m={success:!0,timestamp:Date.now(),message:"",utbytte:[],xp:[],durability:[]},g={world:h,regions:f,players:{[e]:d},markets:{},messages:[]},v={actor:d,room:g,pin:t,action:n,timestamp:new Date().toLocaleTimeString(),localResult:m,trackXp:(N,A)=>{},damageTool:()=>!0},x=IS[s];if(!x)return{success:!1,error:"Ukjent handling"};if(!x(v)||!m.success)return{success:!1,data:m};const b={};b[`players/${e}`]=d;const y=m.siegeWinnerId,E=m.targetRegionId;if(y&&E){const N=f[E],A=N.rulerId;if(A&&A!==y){const T=await xe(D(L,`simulation_rooms/${t}/players/${A}`));if(T.exists()){const k=T.val();k.role="PEASANT",k.status&&(k.status.legitimacy=0),b[`players/${A}`]=k,b[`public_profiles/${A}/role`]="PEASANT",Xt(t,"roleChanges","PEASANT (Demoted)",1)}}const w=await xe(D(L,`simulation_rooms/${t}/players/${y}`));if(w.exists()){const T=w.val();T.role="BARON",T.regionId=E,T.status&&(T.status.legitimacy=100),b[`players/${y}`]=T,b[`public_profiles/${y}/role`]="BARON",b[`public_profiles/${y}/regionId`]=E,N.rulerId=y,N.rulerName=T.name}}return b.regions=f,await J(D(L,`simulation_rooms/${t}`),b),{success:!0,data:m}}catch(o){return console.error("Siege Transaction Failed",o),{success:!1,error:o.message||"Beleiring feilet"}}}const C6=["RAID","TAX","TAX_PEASANTS","TAX_ROYAL","TRADE","TRADE_ROUTE","CONTRIBUTE_TO_UPGRADE","BUY","SELL","CONTRIBUTE","CONSTRUCT","UPGRADE_BUILDING","START_SIEGE","JOIN_SIEGE","SIEGE_ACTION"],CS=async(t,e,n)=>{const s=typeof n=="string"?n:n.type;return C6.includes(s)?O6(t,e,n):j6(t,e,n)};async function j6(t,e,n){const s=D(L,`simulation_rooms/${t}/players/${e}`),i=D(L,`simulation_rooms/${t}/world`);let r=null;try{const a=await xe(i),o=a.exists()?a.val():{season:"Spring",weather:"Clear",activeLaws:[]};if(await Ae(s,c=>{var E,N,A;if(!c)return c;c.resources||(c.resources=JSON.parse(JSON.stringify(Rt[c.role]||Rt.PEASANT))),c.skills||(c.skills=JSON.parse(JSON.stringify(jn[c.role]||jn.PEASANT))),c.status||(c.status={stamina:100,hp:100,authority:0,gold:c.resources.gold||0,level:1,xp:0}),c.equipment||(c.equipment={HEAD:null,BODY:null,MAIN_HAND:null,OFF_HAND:null,FEET:null,TRINKET:null,AXE:null,PICKAXE:null,SCYTHE:null,HAMMER:null}),c.stats||(c.stats={level:1,xp:0}),c.activeBuffs||(c.activeBuffs=[]);const u={success:!0,timestamp:Date.now(),message:"",utbytte:[],xp:[],durability:[]},d=(w,T)=>{var B,z,$,K;const k=((z=(B=c.skills)==null?void 0:B[w])==null?void 0:z.level)||0,R=[];A6(c,w,T,R),R.length>0&&(u.message+=" "+R.join(" "));const C=((K=($=c.skills)==null?void 0:$[w])==null?void 0:K.level)||0;u.xp.push({skill:w,amount:T,levelUp:C>k})},f=c.stats.level||1,h=(w,T)=>{var R;const k=(R=c.equipment)==null?void 0:R[w];return k&&(k.durability=Math.max(0,k.durability-T),u.durability.push({slot:w,item:k.name||"Gjenstand",amount:T,broken:k.durability<=0}),k.durability<=0)?(u.message=` ${k.name} ble delagt!`,u.success=!1,!1):!0},m=Date.now(),g=m-(c.lastActive||m),v=Math.min(60,isNaN(g)?0:g/6e4);if(v>.1){let w=0;(E=c.upgrades)!=null&&E.includes("cow")&&(w+=v*q.PASSIVE_INCOME.COW),(N=c.upgrades)!=null&&N.includes("accounting_books")&&(w+=v*q.PASSIVE_INCOME.ACCOUNTING_BOOKS),(A=c.upgrades)!=null&&A.includes("caravan")&&(w+=v*q.PASSIVE_INCOME.CARAVAN),w>0&&(c.resources.gold=(c.resources.gold||0)+Math.floor(w));const T=v*2;c.status.stamina=Math.min(100,(c.status.stamina||0)+T)}const x=c.role,p=typeof n=="string"?n:n.type,b=dc[p];if(b){const w=fs(b.stamina||0,o.season,o.weather,c.activeBuffs,o.gameTick||0);for(const[T,k]of Object.entries(b)){if(T==="stamina")continue;const R=T;if((c.resources[R]||0)<k)return u.success=!1,u.message=` Mangler ${k} ${T}!`,r=u,c}if((c.status.stamina||0)<w)return u.success=!1,u.message=` For sliten! (${w} kreves)`,r=u,c;for(const[T,k]of Object.entries(b)){if(T==="stamina")continue;const R=T;c.resources[R]=(c.resources[R]||0)-k,Xt(t,"consumed",T,k)}c.status.stamina-=w}const y=IS[p];if(y){const w={actor:c,room:{world:o,players:{[e]:c},messages:[]},pin:t,action:n,timestamp:new Date().toLocaleTimeString(),localResult:u,trackXp:d,damageTool:h};if(y(w)===!1)return r=u,c}else u.success=!1,u.message=`Ukjent handling: ${p}`;return u.message||(u.message="Handling utfrt."),u.success&&Math.random()<.005&&(c.resources.gold=(c.resources.gold||0)+150,u.utbytte.push({id:"ancient_relic",name:"Gammel Relikvie",type:"ITEM",icon:"",amount:1,jackpot:!0}),u.message+="  ET JORDFUNN! Du fant en eldgammel relikvie!"),c.lastActive=Date.now(),r=u,p==="RETIRE"&&u.success&&(r.characterSnapshot=JSON.parse(JSON.stringify(c))),c.stats.level>f&&(r.newLevel=c.stats.level),c.role!==x&&Xt(t,"roleChanges",c.role,1),c}),r&&r.success){if(r.message&&await Et(t,`[${new Date().toLocaleTimeString()}] ${r.message}`),r.utbytte&&r.utbytte.length>0&&r.utbytte.forEach(c=>{const u=c.type==="ITEM"?"crafted":"produced";Xt(t,u,c.id||c.resource,c.amount||1)}),r.characterSnapshot){const c=r.characterSnapshot.uid||e;await R6(c,t,r.characterSnapshot)}if(r.newLevel)try{await J(D(L,`simulation_rooms/${t}/public_profiles/${e}`),{"stats/level":r.newLevel,lastActive:Date.now()})}catch(c){console.error("Failed to sync level",c)}}return{success:!!(r!=null&&r.success),data:r||void 0}}catch(a){return console.error("Action error:",a),{success:!1,error:a.message||"Handling feilet"}}}async function O6(t,e,n){const s=typeof n=="string"?n:n.type;try{return s==="BUY"||s==="SELL"||s==="TRADE_ROUTE"?await IP(t,e,n):s==="CONTRIBUTE"||s==="CONTRIBUTE_TO_UPGRADE"||s==="CONSTRUCT"||s==="UPGRADE_BUILDING"?await CP(t,e,n):s==="TAX"||s==="TAX_PEASANTS"||s==="TAX_ROYAL"?await jP(t,e,n):s==="START_SIEGE"||s==="JOIN_SIEGE"||s==="SIEGE_ACTION"?await I6(t,e,n):{success:!1,error:"Global handling not available."}}catch(i){return console.error("Global Action ERROR:",i),{success:!1,error:i.message||"Global handling feilet"}}}class M6{constructor(e,n){ze(this,"player");ze(this,"genome");ze(this,"brain");ze(this,"startTime");ze(this,"history",[]);ze(this,"status","RUNNING");ze(this,"lastActionAt",0);ze(this,"stuckThreshold",6e4);this.player=e,this.genome=n,this.brain=new BP(n),this.startTime=Date.now()}async tick(e,n){if(this.status!=="RUNNING")return;const s=this.brain.decide(this.player,e);if(this.history.push(s),this.history.length>20&&this.history.shift(),s.action==="IDLE"){Date.now()-this.lastActionAt>this.stuckThreshold&&(this.status="STUCK",this.dumpLog("Bottleneck detected: Stuck for > 60s"));return}this.lastActionAt=Date.now(),(await CS(n,this.player.id,s.action)).success,this.player.role==="KING"&&(this.status="SUCCESS")}getFitness(){return cp.calculateFitness(this.player,this.startTime)}dumpLog(e){const n={reason:e,genome:this.genome,history:this.history,playerState:this.player,timestamp:Date.now()};console.error("AI Training Lab - Game Balance Issue:",n),window.lastAILog=n}}const D6=({roomData:t,pin:e})=>{var N;const[n,s]=_.useState([]),[i,r]=_.useState(0),[a,o]=_.useState(!1),[c,u]=_.useState([]),[d,f]=_.useState({}),[h,m]=_.useState({}),[g,v]=_.useState(null),x=_.useRef(t);_.useEffect(()=>{x.current=t},[t]);const p=_.useRef(null),b=async()=>{const A={};for(let w=1;w<=5;w++){const T=`bot_${Date.now()}_${w}`,k={id:T,name:`BOT Alpha ${w}`,role:"PEASANT",regionId:Math.random()>.5?"region_ost":"region_vest",resources:{...Rt.PEASANT},status:{hp:100,stamina:100,morale:100,legitimacy:100,authority:50,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:1,xp:0,reputation:10,contribution:0},skills:{...jn.PEASANT},lastActive:Date.now(),online:!0};A[`simulation_rooms/${e}/players/${T}`]=k,A[`simulation_rooms/${e}/public_profiles/${T}`]={id:T,stats:{level:1},status:k.status,online:!0,lastActive:Date.now()}}try{await J(D(L),A)}catch(w){console.error("Failed to spawn bots",w)}},y=()=>{t.players&&o(!0)},E=()=>{o(!1),p.current&&cancelIdleCallback(p.current)};return _.useEffect(()=>{if(a){const A=async()=>{const w=x.current,T=Object.values(w.players||{}).filter(k=>k.name.includes("BOT"));await Promise.all(T.map(async k=>{let R=n.find(C=>C.player.id===k.id);if(R)R.player=k;else{const C=cp.getNextGenerationGenome();R=new M6(k,C),s(B=>[...B,R]),r(C.generation)}if(await R.tick(w,e),R.history.length>0){const C=R.history[R.history.length-1];let B=C.action.type||"IDLE";B==="SELL"&&C.action.itemId?B=`SELL (${C.action.itemId})`:B==="BUY"&&C.action.itemId&&(B=`BUY (${C.action.itemId})`),f(z=>({...z,[B]:(z[B]||0)+1})),m(z=>({...z,[R.player.id]:{name:R.player.name,action:B,reason:C.reason,score:C.score.toFixed(2),fitness:R.getFitness().toFixed(1),resources:{...R.player.resources},stamina:R.player.status.stamina}}))}if((R.status==="STUCK"||R.status==="DEAD")&&v(window.lastAILog),R.status==="SUCCESS"||R.status==="DEAD"||R.status==="STUCK"){const C=R.getFitness();R.genome.fitness=C,cp.saveTopGenomes([R.genome]),u(B=>[...B.slice(-19),C])}})),p.current=window.setTimeout(()=>A(),1e3)};A()}return()=>{p.current&&clearTimeout(p.current)}},[a,e]),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center bg-slate-900/50 p-6 rounded-2xl border border-white/10",children:[l.jsxs("div",{children:[l.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[l.jsx(o3,{className:"text-indigo-400"})," AI Training Lab"]}),l.jsx("p",{className:"text-slate-400 text-sm",children:"Genetisk Algoritme-optimalisering av spillbalanse"})]}),l.jsx("div",{className:"flex gap-3",children:a?l.jsxs("button",{onClick:E,className:"bg-red-600 hover:bg-red-500 px-4 py-2 rounded-lg flex items-center gap-2 font-bold transition-all",children:[l.jsx(ap,{size:18})," Stopp Trening"]}):l.jsxs("button",{onClick:y,className:"bg-indigo-600 hover:bg-indigo-500 px-4 py-2 rounded-lg flex items-center gap-2 font-bold transition-all",children:[l.jsx(yd,{size:18})," Start Trening"]})})]}),a&&Object.values(t.players||{}).filter(A=>A.name.includes("BOT")||A.id.startsWith("bot_")).length===0&&l.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/20 p-6 rounded-2xl flex items-center justify-between animate-in slide-in-from-top-2",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:"bg-amber-500/20 p-3 rounded-full text-amber-500",children:l.jsx(L0,{size:24})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-amber-500 font-black uppercase text-sm",children:"Ingen bot-subjekter funnet"}),l.jsx("p",{className:"text-amber-200/60 text-xs",children:"AI-en trenger kropper  kontrollere (navn med 'BOT' eller ID 'bot_')."})]})]}),l.jsx("button",{onClick:b,className:"bg-amber-500 hover:bg-amber-400 text-black px-6 py-3 rounded-xl font-black uppercase text-xs tracking-widest transition-all shadow-lg hover:scale-105",children:" Spawn Alpha Squad (5 stk)"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[l.jsxs("div",{className:"bg-slate-900/50 p-6 rounded-2xl border border-white/10",children:[l.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-xs uppercase font-black mb-2",children:[l.jsx(py,{size:14})," Generasjon"]}),l.jsx("div",{className:"text-4xl font-black",children:i})]}),l.jsxs("div",{className:"bg-slate-900/50 p-6 rounded-2xl border border-white/10 flex flex-col justify-between",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-xs uppercase font-black mb-2",children:[l.jsx(lP,{size:14})," Fitness Trend"]}),l.jsx("div",{className:"text-4xl font-black mb-4",children:c.length>0?(c.reduce((A,w)=>A+w,0)/c.length).toFixed(1):"0.0"})]}),l.jsxs("div",{className:"h-12 flex items-end gap-1 px-1",children:[c.map((A,w)=>{const T=Math.max(...c,1),k=A/T*100;return l.jsx("div",{className:"flex-1 bg-indigo-500/50 rounded-t-sm transition-all duration-500 hover:bg-indigo-400",style:{height:`${k}%`},title:`Fitness: ${A.toFixed(1)}`},w)}),c.length===0&&l.jsx("div",{className:"w-full h-[1px] bg-white/10"})]})]}),l.jsxs("div",{className:"bg-slate-900/50 p-6 rounded-2xl border border-white/10 text-amber-500",children:[l.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-xs uppercase font-black mb-2",children:[l.jsx(xy,{size:14})," Bottlenecks"]}),l.jsx("div",{className:"text-4xl font-black text-amber-500",children:n.filter(A=>A.status==="STUCK").length})]})]}),l.jsxs("div",{className:"bg-slate-900/50 p-6 rounded-2xl border border-white/10",children:[l.jsx("h3",{className:"text-sm font-bold uppercase tracking-widest text-slate-400 mb-4",children:"Decision Heatmap"}),l.jsxs("div",{className:"flex flex-wrap gap-4",children:[Object.entries(d).sort((A,w)=>w[1]-A[1]).map(([A,w])=>l.jsxs("div",{className:"bg-white/5 p-3 rounded-lg border border-white/5 flex flex-col items-center min-w-[80px]",children:[l.jsx("span",{className:"text-xs text-slate-500 uppercase",children:A}),l.jsx("span",{className:"text-lg font-bold",children:w})]},A)),Object.keys(d).length===0&&l.jsx("p",{className:"text-slate-600 italic",children:"Ingen data enn..."})]})]}),l.jsxs("div",{className:"bg-slate-900/50 p-6 rounded-2xl border border-white/10",children:[l.jsxs("h3",{className:"text-sm font-bold uppercase tracking-widest text-slate-400 mb-4 flex items-center gap-2",children:[l.jsx(py,{size:16,className:"text-indigo-400"})," Live Neural Feed"]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-left border-collapse",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"text-xs uppercase text-slate-500 border-b border-white/10",children:[l.jsx("th",{className:"p-3",children:"Subject"}),l.jsx("th",{className:"p-3",children:"Last Decision"}),l.jsx("th",{className:"p-3",children:"Reasoning"}),l.jsx("th",{className:"p-3",children:"Score"}),l.jsx("th",{className:"p-3",children:"Fitness"}),l.jsx("th",{className:"p-3",children:"Gold"}),l.jsx("th",{className:"p-3",children:"Stamina"})]})}),l.jsxs("tbody",{className:"text-sm",children:[Object.entries(h).map(([A,w])=>l.jsxs("tr",{className:"border-b border-white/5 hover:bg-white/5 transition-colors font-mono",children:[l.jsx("td",{className:"p-3 font-bold text-indigo-300",children:w.name}),l.jsx("td",{className:"p-3",children:l.jsx("span",{className:"bg-indigo-500/20 text-indigo-300 px-2 py-1 rounded text-xs font-bold border border-indigo-500/30",children:w.action})}),l.jsxs("td",{className:"p-3 text-slate-400 italic text-xs",children:['"',w.reason,'"']}),l.jsx("td",{className:"p-3 text-slate-300",children:w.score}),l.jsx("td",{className:"p-3 font-bold text-white",children:w.fitness}),l.jsx("td",{className:"p-3 text-amber-400",children:w.resources.gold}),l.jsx("td",{className:"p-3",children:l.jsx("div",{className:"w-16 h-1 bg-slate-700 rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-emerald-500",style:{width:`${w.stamina}%`}})})})]},A)),Object.keys(h).length===0&&l.jsx("tr",{children:l.jsx("td",{colSpan:7,className:"p-8 text-center text-slate-600 italic",children:"Venter p telemetri..."})})]})]})})]}),g&&l.jsxs("div",{className:"bg-red-950/30 border border-red-500/30 p-6 rounded-2xl",children:[l.jsxs("h3",{className:"text-red-400 font-bold flex items-center gap-2 mb-4",children:[l.jsx(xy,{size:18})," Game Balance Issue Detected"]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[l.jsxs("div",{className:"bg-black/40 p-4 rounded-lg",children:[l.jsx("p",{className:"text-slate-400 text-xs uppercase mb-2",children:"Grunn"}),l.jsx("p",{className:"font-mono",children:g.reason})]}),l.jsxs("div",{className:"bg-black/40 p-4 rounded-lg",children:[l.jsx("p",{className:"text-slate-400 text-xs uppercase mb-2",children:"Siste Handling"}),l.jsx("p",{className:"font-mono",children:((N=g.history[g.history.length-1])==null?void 0:N.action.type)||"None"})]})]}),l.jsx("pre",{className:"mt-4 p-4 bg-black/40 rounded-lg overflow-x-auto text-[10px] text-slate-300 custom-scrollbar",children:JSON.stringify(g,null,2)})]})]})},L6=()=>{var Mt,Yn,pn,Hi,qn,gc,bc,vc,xc;const[t,e]=_.useState(""),[n,s]=_.useState(null),[i,r]=_.useState([]),[a,o]=_.useState(!1),[c,u]=_.useState("LIST"),[d,f]=_.useState({}),[h,m]=_.useState({}),[g,v]=_.useState({}),{setFullWidth:x,setHideHeader:p}=iN(),[b,y]=_.useState(null);_.useEffect(()=>{Gt(()=>import("./SimulationEconomyBlueprint-D9Xp3cGy.js"),[]).then(S=>{y(()=>S.SimulationEconomyBlueprint)})},[]);const E=async S=>{if(window.confirm(`ER DU SIKKER? Dette vil slette rommet ${S} permanent! Denne handlingen kan ikke angres.`)){o(!0);try{await dy(D(L,`simulation_rooms/${S}`)),await dy(D(L,`simulation_server_metadata/${S}`))}catch(M){console.error(M),alert("Kunne ikke slette rommet.")}finally{o(!1)}}};_.useEffect(()=>(x(!0),p(!0),()=>{x(!1),p(!1)}),[x,p]),_.useEffect(()=>{const S=D(L,"simulation_rooms"),M=Ke(S,G=>{const Q=G.val();if(Q){const re=Object.entries(Q).map(([Z,Y])=>({...Y,pin:Y.pin||Z}));r(re.reverse())}else r([])});return()=>M()},[]),_.useEffect(()=>{if(!t)return;const S=`simulation_rooms/${t}`,M=Ke(D(L,`${S}/status`),Z=>{s(Y=>Y?{...Y,status:Z.val()||"LOBBY"}:null)}),G=Ke(D(L,`${S}/world`),Z=>{s(Y=>Y?{...Y,world:Z.val()}:null)}),Q=Ke(D(L,`${S}/markets`),Z=>{const Y=Z.val()||{};s(de=>de?{...de,markets:Y}:null)}),re=Ke(D(L,`${S}/regions`),Z=>{s(Y=>Y?{...Y,regions:Z.val()||{}}:null)});return()=>{M(),G(),Q(),re()}},[t]),SS(t,(n==null?void 0:n.status)||"LOBBY",n==null?void 0:n.world),_.useEffect(()=>{if(!t)return;const S=`simulation_rooms/${t}`,M=Ke(D(L,`${S}/messages`),G=>{s(Q=>Q?{...Q,messages:G.val()||[]}:null)});return()=>M()},[t]),_.useEffect(()=>{if(!t)return;const S=`simulation_rooms/${t}`,M=Ke(D(L,`${S}/players`),Z=>{const Y=Z.val()||{};s(de=>{if(!de)return null;const W=Object.keys(Y).length,ye=D(L,`simulation_server_metadata/${t}`);return setTimeout(()=>{xe(ye).then(jt=>{jt.exists()&&jt.val().playerCount!==W&&J(ye,{playerCount:W})})},5e3),{...de,players:Y}})}),G=Ke(D(L,`${S}/worldEvents`),Z=>{s(Y=>Y?{...Y,worldEvents:Z.val()||{}}:null)}),Q=Ke(D(L,`${S}/activeVote`),Z=>{s(Y=>Y?{...Y,activeVote:Z.val()}:null)}),re=Ke(D(L,`${S}/regions`),Z=>{s(Y=>Y?{...Y,regions:Z.val()||{}}:null)});return xe(D(L,S)).then(Z=>{if(Z.exists()){const Y=Z.val();s(de=>({...de,pin:Y.pin,status:Y.status,settings:Y.settings,hostName:Y.hostName,isPublic:Y.isPublic,world:Y.world,markets:Y.markets||{},market:Y.market||xt,players:(de==null?void 0:de.players)||{},messages:(de==null?void 0:de.messages)||[],regions:Y.regions||{},diplomacy:{},worldEvents:{}}))}}),()=>{M(),G(),Q(),re()}},[t]),_.useEffect(()=>(t&&c==="MANAGE"?document.title=`Host: ${t} | Eiriksbok`:document.title="Simuleringshallen | Eiriksbok",()=>{document.title="Eiriksbok"}),[t,c]);const N=async()=>{const S=prompt("Hva skal riket hete? (La st tomt for automatisk navn)");if(S===null)return;o(!0);const M=Math.floor(1e3+Math.random()*9e3).toString(),G=S.trim()||`Rike #${M}`,Q=wP(M,G);try{await Ba(D(L,`simulation_rooms/${M}`),Q),await Hc(M,Q),e(M),u("MANAGE")}catch(re){console.error(re),alert("Kunne ikke opprette rom.")}finally{o(!1)}},A=async()=>{if(!(!n||!n.players)){o(!0);try{const S=xP(n.players),M={region_vest:{id:"region_vest",name:"Baroniet Vest",taxRate:10,defenseLevel:50,rulerName:"Ingen"},region_ost:{id:"region_ost",name:"Baroniet st",taxRate:10,defenseLevel:50,rulerName:"Ingen"}},G={...n.markets};G.capital||(G.capital=JSON.parse(JSON.stringify(xt))),["region_vest","region_ost"].forEach(Y=>{G[Y]||(G[Y]=JSON.parse(JSON.stringify(xt)))}),Object.values(S).forEach(Y=>{if(Y.role==="BARON"){M[Y.regionId]={...M[Y.regionId],rulerName:Y.name};const de=JSON.parse(JSON.stringify(xt));Object.keys(de).forEach(W=>{const ye=de[W];ye.price=Math.floor(ye.price*(.8+Math.random()*.4)),ye.stock=Math.floor(ye.stock*(.8+Math.random()*.4))}),G[Y.regionId]=de}});const Q={};Object.values(S).forEach(Y=>{Q[Y.id]={id:Y.id,name:Y.name,role:Y.role,regionId:Y.regionId,stats:{level:Y.stats.level||1},status:{isJailed:!1,isFrozen:!1,legitimacy:100},online:!0,lastActive:Y.lastActive}});const re={};re[`simulation_rooms/${t}/players`]=S,re[`simulation_rooms/${t}/public_profiles`]=Q,re[`simulation_rooms/${t}/regions`]=M,re[`simulation_rooms/${t}/markets`]=G,re[`simulation_rooms/${t}/status`]="PLAYING",await J(D(L),re);const Z={...n,status:"PLAYING"};await Hc(t,Z)}catch(S){console.error(S),alert("Klarte ikke starte.")}finally{o(!1)}}},w=async()=>{var S,M;if(!(!n||!n.players)){o(!0);try{const G=((M=(S=n.world)==null?void 0:S.taxRateDetails)==null?void 0:M.kingTax)||20,{updatedPlayers:Q,results:re}=yP(n.players,G);await J(D(L,`simulation_rooms/${t}/players`),Q),alert(`Suksess! ${re.length} bnder og baroner ble skattlagt.`)}catch(G){console.error(G)}finally{o(!1)}}},T=async()=>{if(n!=null&&n.regions&&window.confirm("Vil du nullstille all politisk uro (bestikkelser) i alle regioner?")){o(!0);try{const S={};Object.keys(n.regions).forEach(M=>{S[`simulation_rooms/${t}/regions/${M}/coup/bribeProgress`]=0,S[`simulation_rooms/${t}/regions/${M}/coup/contributions`]={},S[`simulation_rooms/${t}/regions/${M}/coup/challengerId`]=null,S[`simulation_rooms/${t}/regions/${M}/coup/challengerName`]=null}),await J(D(L),S),alert("Politisk ro er gjenopprettet i alle regioner!")}catch(S){console.error(S)}finally{o(!1)}}},k=async()=>{if(!(!n||!n.players)){o(!0);try{const S={};Object.keys(n.players).forEach(M=>{S[`simulation_rooms/${t}/players/${M}/status/stamina`]=100}),await J(D(L),S),alert("All energi er gjenopprettet!")}catch(S){console.error(S)}finally{o(!1)}}},R=S=>S?Array.isArray(S)?S:Object.values(S).sort((M,G)=>M.timestamp-G.timestamp):[],C=async()=>{var re,Z;if(!n)return;const S=["Spring","Summer","Autumn","Winter"],G=(S.indexOf(((re=n.world)==null?void 0:re.season)||"Spring")+1)%S.length,Q=S[G];o(!0);try{const de=` rstiden har skiftet til ${((Z=An[Q])==null?void 0:Z.label)||Q}!`,W={id:`msg_${Date.now()}`,content:de,timestamp:Date.now(),type:"SEASON_CHANGE"},jt=[...R(n.messages),W].slice(-50),yc={};yc[`simulation_rooms/${t}/world/season`]=Q,yc[`simulation_rooms/${t}/messages`]=jt,await J(D(L),yc)}catch(Y){console.error(Y)}finally{o(!1)}},B=async()=>{if(!n)return;const S=["Clear","Rain","Storm","Fog"],G=(S.indexOf(n.world.weather||"Clear")+1)%S.length,Q=S[G];try{const Y=` Vret har skiftet til ${{Clear:"Klart",Rain:"Regn",Storm:"Storm",Fog:"Tke"}[Q]||Q}!`,de={id:`msg_${Date.now()}`,content:Y,timestamp:Date.now(),type:"WEATHER_CHANGE"},ye=[...R(n.messages),de].slice(-50),jt={};jt[`simulation_rooms/${t}/world/weather`]=Q,jt[`simulation_rooms/${t}/messages`]=ye,await J(D(L),jt)}catch(re){console.error(re)}},z=async()=>{if(!n)return;const{LAW_TEMPLATES:S}=await Gt(async()=>{const{LAW_TEMPLATES:Q}=await Promise.resolve().then(()=>hy);return{LAW_TEMPLATES:Q}},void 0),M=S[Math.floor(Math.random()*S.length)],G={lawId:M.id,title:M.label,votes:{},expiresAt:Date.now()+60*1e3};try{await J(D(L,`simulation_rooms/${t}`),{activeVote:G});const Q=` TINGET ER SATT! Det skal stemmes over loven: "${M.label}"!`,re={id:`msg_${Date.now()}`,content:Q,timestamp:Date.now(),type:"VOTE_START"},Y=[...R(n.messages),re].slice(-50);await J(D(L,`simulation_rooms/${t}`),{messages:Y}),setTimeout(()=>$(M.id),6e4)}catch(Q){console.error(Q)}},$=async S=>{var ye;const M=await xe(D(L,`simulation_rooms/${t}/activeVote`));if(!M.exists())return;const G=M.val(),Q=Object.values(G.votes||{}),re=Q.filter(jt=>jt==="YES").length,Z=Q.filter(jt=>jt==="NO").length;let Y="",de=((ye=n==null?void 0:n.world)==null?void 0:ye.activeLaws)||[];re>Z?(Y=` LOVEN ER VEDTATT! "${G.title}" er n gjeldende.`,de=[...de,S]):Y=` LOVEN BLE FORKASTET. "${G.title}" ble nedstemt.`;const W={id:`msg_${Date.now()}`,content:Y,timestamp:Date.now(),type:"VOTE_RESULT"};try{await J(D(L,`simulation_rooms/${t}/world`),{activeLaws:de});const jt=R(n==null?void 0:n.messages);await J(D(L,`simulation_rooms/${t}`),{activeVote:null,messages:[...jt,W].slice(-50)})}catch(jt){console.error(jt)}},K=async()=>{if(!n)return;const{WORLD_EVENT_TEMPLATES:S}=await Gt(async()=>{const{WORLD_EVENT_TEMPLATES:re}=await Promise.resolve().then(()=>hy);return{WORLD_EVENT_TEMPLATES:re}},void 0),M=S[Math.floor(Math.random()*S.length)],G=`event_${Date.now()}`,Q={...M,id:G,expiresAt:Date.now()+5*60*1e3};try{await J(D(L,`simulation_rooms/${t}/worldEvents`),{[G]:Q});const re=` HENDELSE: ${M.title}! Sjekk kartet!`,Z={id:`msg_${Date.now()}`,content:re,timestamp:Date.now(),type:"EVENT_SPAWN"},de=[...R(n.messages),Z].slice(-50);await J(D(L,`simulation_rooms/${t}`),{messages:de})}catch(re){console.error(re)}},U=async(S,M)=>{var re,Z,Y;if(!((Y=(Z=(re=n==null?void 0:n.world)==null?void 0:re.settlement)==null?void 0:Z.buildings)!=null&&Y[S]))return;const G=n.world.settlement.buildings[S],Q=Math.max(0,G.level+M);try{await J(D(L,`simulation_rooms/${t}/world/settlement/buildings/${S}`),{level:Q,progress:{}})}catch(de){console.error(de)}},[O,j]=_.useState({name:"",role:"PEASANT",level:1}),I=async()=>{if(!O.name){alert("Vennligst oppgi et navn.");return}o(!0);try{const S=`char_${Math.random().toString(36).substr(2,9)}`,M={id:S,name:O.name,role:O.role||"PEASANT",regionId:O.role==="KING"?"capital":Math.random()>.5?"region_ost":"region_vest",resources:Rt[O.role]||Rt.PEASANT,status:{hp:100,stamina:100,morale:100,legitimacy:100,authority:50,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:O.level,xp:0,reputation:10,contribution:0},skills:jn[O.role]||jn.PEASANT,lastActive:Date.now(),online:!0},G={};G[`simulation_rooms/${t}/players/${S}`]=M,G[`simulation_rooms/${t}/public_profiles/${S}`]={id:S,name:M.name,role:M.role,regionId:M.regionId,stats:{level:M.stats.level},status:{isJailed:!1,isFrozen:!1,legitimacy:100},online:!0,lastActive:M.lastActive},await J(D(L),G),j({name:"",role:"PEASANT",level:1})}catch(S){console.error(S),alert("Kunne ikke opprette karakter.")}finally{o(!1)}},H=async(S,M)=>{try{const G={};G[`simulation_rooms/${t}/players/${S}/stats/level`]=M,G[`simulation_rooms/${t}/public_profiles/${S}/stats/level`]=M,await J(D(L),G)}catch(G){console.error(G)}},X=async()=>{if(n){o(!0);try{await J(D(L,`simulation_rooms/${t}/world`),{settlement:{buildings:Object.entries(Bt).reduce((S,[M])=>({...S,[M]:{id:M,level:0,progress:{},target:200,contributions:{}}}),{})}})}catch(S){console.error(S)}finally{o(!1)}}},oe=async()=>{if(console.log("Attempting resetGame..."),!window.confirm("Er du sikker p at du vil starte spillet p nytt? Alle fremdrift slettes.")){console.log("Reset cancelled by user.");return}console.log("Reset confirmed. Pin:",t),o(!0);try{const S={};S[`simulation_rooms/${t}/status`]="LOBBY",S[`simulation_rooms/${t}/worldEvents`]={},S[`simulation_rooms/${t}/messages`]=[],S[`simulation_rooms/${t}/market`]=xt,S[`simulation_rooms/${t}/markets`]={capital:xt},S[`simulation_rooms/${t}/regions`]={},S[`simulation_rooms/${t}/world/monumentProgress`]=0,S[`simulation_rooms/${t}/world/activeLaws`]=[],S[`simulation_rooms/${t}/world/settlement`]={buildings:Object.entries(Bt).reduce((M,[G])=>({...M,[G]:{id:G,level:0,progress:{},target:200,contributions:{}}}),{})},Object.keys((n==null?void 0:n.players)||{}).forEach(M=>{S[`simulation_rooms/${t}/players/${M}/role`]="PEASANT",S[`simulation_rooms/${t}/players/${M}/regionId`]="capital",S[`simulation_rooms/${t}/players/${M}/resources`]=Rt.PEASANT,S[`simulation_rooms/${t}/players/${M}/status`]={stamina:100,legitimacy:100,authority:50},S[`simulation_rooms/${t}/players/${M}/equipment`]={};const G=`simulation_rooms/${t}/public_profiles/${M}`;S[`${G}/role`]="PEASANT",S[`${G}/regionId`]="capital",S[`${G}/stats/level`]=1,S[`simulation_rooms/${t}/players/${M}/roleStats`]=null}),console.log("Constructed updates:",S),await J(D(L),S),n&&s({...n,status:"LOBBY",messages:[]}),console.log("Update successful!"),alert("Spillet er nullstilt!")}catch(S){console.error("Reset failed:",S),alert("Kunne ikke nullstille spill: "+S)}finally{o(!1)}},Ie=async(S,M)=>{if(window.confirm(`Er du sikker p at du vil kaste ut ${M}?`))try{const G={};G[`simulation_rooms/${t}/players/${S}`]=null,G[`simulation_rooms/${t}/public_profiles/${S}`]=null,await J(D(L),G)}catch(G){console.error(G),alert("Kunne ikke kaste ut spiller.")}},V=async()=>{if(window.confirm("ER DU SIKKER? Dette vil kaste ut ALLE spillere fra rommet!"))try{const S={};S[`simulation_rooms/${t}/players`]={},await J(D(L),S),alert("Alle spillere er kastet ut.")}catch(S){console.error(S),alert("Kunne ikke utfre handlingen.")}},me=S=>{const M=`${window.location.origin}/sim/play/${t}?impersonate=${S}`;window.open(M,"_blank")},ne=async(S,M)=>{try{const G={};G[`simulation_rooms/${t}/players/${S}/role`]=M,G[`simulation_rooms/${t}/public_profiles/${S}/role`]=M,await J(D(L),G)}catch(G){console.error(G),alert("Kunne ikke endre rolle.")}},st=async(S,M)=>{try{const G={};G[`simulation_rooms/${t}/players/${S}/regionId`]=M,G[`simulation_rooms/${t}/public_profiles/${S}/regionId`]=M,await J(D(L),G)}catch(G){console.error(G),alert("Kunne ikke endre baroni.")}},zt=async()=>{if(!n)return;const S=!n.isPublic;try{await J(D(L,`simulation_rooms/${t}`),{isPublic:S}),await Hc(t,{...n,isPublic:S})}catch(M){console.error(M)}};if(c==="LIST")return l.jsxs("div",{className:"fixed inset-0 top-0 bg-slate-950 text-slate-200 p-12 overflow-y-auto custom-scrollbar font-sans z-20",children:[l.jsxs("div",{className:"fixed inset-0 pointer-events-none opacity-20",children:[l.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-indigo-600/20 blur-[120px] rounded-full"}),l.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-amber-600/10 blur-[120px] rounded-full"})]}),l.jsxs("div",{className:"max-w-5xl mx-auto relative z-10",children:[l.jsxs("div",{className:"flex justify-between items-center mb-12",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-5xl font-black text-white px-2 tracking-tighter",children:"Simuleringshallen"}),l.jsx("p",{className:"text-slate-500 font-bold uppercase tracking-widest text-[10px] mt-2 px-2",children:"Sentralt kontrollpanel for administratoren"})]}),l.jsxs("div",{className:"flex gap-4",children:[l.jsx("button",{onClick:async()=>{o(!0);try{const S=D(L,"simulation_server_metadata"),M=D(L,"simulation_rooms"),[G,Q]=await Promise.all([xe(S),xe(M)]),re=G.val()||{},Z=Q.val()||{};let Y=0;const de={};Object.keys(re).forEach(W=>{Z[W]||(de[`simulation_server_metadata/${W}`]=null,Y++)}),Y>0?(await J(D(L),de),alert(`Ryddet opp ${Y} dde serverkoblinger!`)):alert("Alt ser ryddig ut! Ingen dde linker funnet.")}catch(S){console.error(S),alert("Kunne ikke rydde opp "+S)}finally{o(!1)}},disabled:a,className:"bg-slate-800 hover:bg-rose-500/20 text-slate-400 hover:text-rose-400 border border-slate-700 hover:border-rose-500/50 px-6 py-5 rounded-2xl font-black text-xs uppercase tracking-widest transition-all",children:" Vask Serverlisten"}),l.jsx("button",{onClick:N,disabled:a,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-10 py-5 rounded-2xl font-black text-lg shadow-2xl shadow-indigo-600/30 transition-all hover:scale-105 active:scale-95",children:"+ Opprett Nytt Rike"})]})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map(S=>{var M,G;return l.jsxs("div",{className:"bg-slate-900/50 backdrop-blur-xl border border-white/5 p-8 rounded-[2.5rem] group hover:border-indigo-500/50 transition-all shadow-xl flex flex-col justify-between",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-start mb-2",children:[l.jsx("h2",{className:"text-2xl font-black text-white group-hover:text-indigo-400 transition-colors truncate pr-4",title:S.name||`Rike #${S.pin}`,children:S.name||`Rike #${S.pin}`}),l.jsx("span",{className:`px-2 py-0.5 rounded-full text-[8px] font-black uppercase tracking-widest ${S.status==="PLAYING"?"bg-emerald-500/20 text-emerald-400":"bg-amber-500/20 text-amber-400"} shrink-0`,children:typeof S.status=="string"?S.status:"KORRUPT"})]}),l.jsxs("div",{className:"text-[10px] font-mono text-slate-600 mb-6 uppercase tracking-widest",children:["PIN: ",l.jsx("span",{className:"text-slate-400 font-bold",children:S.pin})]}),l.jsxs("div",{className:"space-y-4 mb-8",children:[l.jsxs("div",{className:"flex items-center justify-between text-sm font-bold text-slate-500",children:[l.jsx("span",{children:"Innbyggere:"}),l.jsxs("span",{className:"text-white",children:[Object.keys(S.players||{}).length," sjeler"]})]}),l.jsxs("div",{className:"flex items-center justify-between text-sm font-bold text-slate-500",children:[l.jsx("span",{children:"rstid:"}),l.jsx("span",{className:"text-indigo-300",children:xt[(M=S.world)==null?void 0:M.season]||((G=S.world)==null?void 0:G.season)||"Ukjent"})]})]})]}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx("button",{onClick:()=>{e(S.pin),u("MANAGE")},className:"flex-1 bg-white/5 hover:bg-white/10 text-white py-4 rounded-2xl font-black uppercase tracking-widest text-xs transition-all border border-white/5",children:"Administrer "}),l.jsx("button",{onClick:()=>E(S.pin),className:"bg-rose-500/10 hover:bg-rose-500/20 text-rose-500 w-16 rounded-2xl flex items-center justify-center border border-rose-500/20 transition-all hover:scale-105 active:scale-95",title:"Slett rom",children:""})]})]},S.pin)})})]})]});if(!n)return null;const On=async()=>{if(window.confirm("Er du sikker? Dette vil regenerere 'public_profiles' basert p 'players'. Bruk kun hvis listen er tom.")){o(!0);try{const S=await xe(D(L,`simulation_rooms/${t}`));if(!S.exists())return;const M=S.val(),G=M.players||{},Q={};Object.entries(G).forEach(([re,Z])=>{var Y,de,W,ye;Q[`simulation_rooms/${t}/public_profiles/${re}`]={id:re,uid:Z.uid||null,name:Z.name,role:Z.role,regionId:Z.regionId,stats:{level:((Y=Z.stats)==null?void 0:Y.level)||1},status:{isJailed:((de=Z.status)==null?void 0:de.isJailed)||!1,isFrozen:((W=Z.status)==null?void 0:W.isFrozen)||!1,legitimacy:((ye=Z.status)==null?void 0:ye.legitimacy)||100},online:!0,lastActive:Z.lastActive||Date.now()}}),M.status||(Q[`simulation_rooms/${t}/status`]="LOBBY"),M.world||(Q[`simulation_rooms/${t}/world`]={year:1100,season:"Spring",weather:"Clear",gameTick:0,lastTickAt:Date.now(),taxRateDetails:{kingTax:20},settlement:{buildings:Object.entries(Bt).reduce((re,[Z])=>({...re,[Z]:{id:Z,level:0,progress:{},target:200,contributions:{}}}),{})}}),await J(D(L),Q),alert("Data reparert! Profiler er synkronisert."),await Hc(t,{...M,players:G})}catch(S){console.error(S),alert("Reparasjon feilet: "+S)}finally{o(!1)}}};return l.jsxs("div",{className:"fixed inset-0 top-0 bg-slate-950 text-slate-200 flex overflow-hidden font-sans selection:bg-indigo-500/30 z-20",children:[l.jsxs("div",{className:"fixed inset-0 pointer-events-none opacity-20",children:[l.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-indigo-600/20 blur-[120px] rounded-full animate-pulse"}),l.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-amber-600/10 blur-[120px] rounded-full"})]}),l.jsxs("aside",{className:"w-80 border-r border-white/10 bg-slate-900/50 backdrop-blur-xl flex flex-col z-20 shadow-2xl overflow-y-auto no-scrollbar",children:[l.jsxs("div",{className:"p-8 border-b border-white/5 bg-black/20",children:[l.jsx("button",{onClick:()=>u("LIST"),className:"text-indigo-400 font-black text-[10px] uppercase tracking-widest mb-4 hover:text-white transition-colors flex items-center gap-2",children:" Tilbake til oversikt"}),l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("h1",{className:"text-4xl font-mono font-black text-white",children:t}),l.jsx("span",{className:"text-[10px] font-black uppercase text-indigo-500 tracking-widest bg-indigo-500/10 px-3 py-1 rounded-full",children:"Admin"})]}),l.jsxs("p",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-6",children:[typeof n.status=="string"?n.status:"FEIL: DATA KORRUPT"," MODUS"]}),l.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[l.jsx("button",{onClick:A,disabled:n.status==="PLAYING"||a,className:`w-full py-4 rounded-xl font-black uppercase tracking-widest text-sm transition-all shadow-lg ${n.status==="PLAYING"?"bg-emerald-600/20 text-emerald-500 cursor-default":"bg-emerald-600 hover:bg-emerald-500 text-white shadow-emerald-600/20"}`,children:n.status==="PLAYING"?" SPILL AKTIVT":" START SPILL"}),l.jsxs("button",{onClick:zt,disabled:a,className:`w-full py-3 rounded-xl font-black uppercase tracking-widest text-[10px] transition-all border flex items-center justify-center gap-2 ${n.isPublic?"bg-indigo-600/10 text-indigo-400 border-indigo-500/20 hover:bg-indigo-600 hover:text-white":"bg-slate-800 text-slate-500 border-white/5 hover:border-indigo-500/20"}`,children:[n.isPublic?l.jsx(E3,{size:14}):l.jsx(M0,{size:14}),n.isPublic?"OFFENTLIG SERVER":"PRIVAT (KUN PIN)"]}),l.jsx("button",{onClick:On,disabled:a,className:"w-full py-3 rounded-xl font-black uppercase tracking-widest text-[10px] bg-amber-600/10 text-amber-500 hover:bg-amber-600 hover:text-white transition-all border border-amber-500/20",children:" REPARER DATA"}),l.jsx("button",{onClick:oe,disabled:a,className:"w-full py-3 rounded-xl font-black uppercase tracking-widest text-[10px] bg-rose-600/10 text-rose-500 hover:bg-rose-600 hover:text-white transition-all border border-rose-500/20",children:" NULLSTILL ALT"})]})]}),l.jsxs("div",{className:"p-8 space-y-8 flex-1 overflow-y-auto custom-scrollbar",children:[l.jsxs("section",{children:[l.jsx("h3",{className:"text-[10px] font-black uppercase text-slate-500 tracking-[0.2em] mb-4",children:"Verdensstyring"}),l.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[l.jsxs("div",{className:"bg-white/5 p-4 rounded-2xl border border-white/5 group",children:[l.jsxs("div",{className:"flex justify-between items-center mb-3",children:[l.jsxs("span",{className:"text-xs font-bold text-slate-400 italic",children:["rstid: ",((Yn=An[(Mt=n.world)==null?void 0:Mt.season])==null?void 0:Yn.label)||"Ukjent"]}),l.jsx("span",{className:"text-2xl group-hover:rotate-12 transition-transform",children:{Spring:"",Summer:"",Autumn:"",Winter:""}[((pn=n.world)==null?void 0:pn.season)||"Spring"]})]}),l.jsx("button",{onClick:C,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white py-2 rounded-lg font-black uppercase text-[10px] transition-all",children:"Neste rstid"})]}),l.jsxs("div",{className:"bg-white/5 p-4 rounded-2xl border border-white/5 group",children:[l.jsxs("div",{className:"flex justify-between items-center mb-3",children:[l.jsxs("span",{className:"text-xs font-bold text-slate-400 italic",children:["Vr: ",((Hi=n.world)==null?void 0:Hi.weather)||"Klart"]}),l.jsx("span",{className:"text-2xl group-hover:scale-110 transition-transform",children:""})]}),l.jsx("button",{onClick:B,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white py-2 rounded-lg font-black uppercase text-[10px] transition-all",children:"Endre Vr"})]})]})]}),l.jsxs("section",{children:[l.jsx("h3",{className:"text-[10px] font-black uppercase text-slate-500 tracking-[0.2em] mb-4",children:"Massehandlinger"}),l.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[l.jsx("button",{onClick:w,className:"w-full bg-amber-600/10 hover:bg-amber-600 text-amber-500 hover:text-white border border-amber-600/20 py-4 rounded-2xl font-black uppercase text-[10px] transition-all flex items-center justify-center gap-2",children:" Skattlegg Riket"}),l.jsx("button",{onClick:k,className:"w-full bg-blue-600/10 hover:bg-blue-600 text-blue-500 hover:text-white border border-blue-600/20 py-4 rounded-2xl font-black uppercase text-[10px] transition-all flex items-center justify-center gap-2 text-center",children:" Gjenopprett Stamina"}),l.jsx("button",{onClick:T,className:"w-full bg-indigo-600/10 hover:bg-indigo-600 text-indigo-500 hover:text-white border border-indigo-600/20 py-4 rounded-2xl font-black uppercase text-[10px] transition-all flex items-center justify-center gap-2 text-center",children:" Nullstill Politisk Uro"}),l.jsx("button",{onClick:V,className:"w-full bg-rose-600/10 hover:bg-rose-600 text-rose-500 hover:text-white border border-rose-600/20 py-4 rounded-2xl font-black uppercase text-[10px] transition-all flex items-center justify-center gap-2 text-center mt-2",children:" Kast ut alle"})]})]}),l.jsxs("section",{children:[l.jsx("h3",{className:"text-[10px] font-black uppercase text-slate-500 tracking-[0.2em] mb-4 text-center",children:"Intervensjoner"}),l.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsx("button",{onClick:K,className:"bg-rose-600/80 hover:bg-rose-600 text-white py-4 rounded-2xl font-black uppercase text-[10px] shadow-lg shadow-rose-600/20 transition-all active:scale-95",children:" Event"}),l.jsx("button",{onClick:z,disabled:!!n.activeVote,className:"bg-amber-600/80 hover:bg-amber-600 text-white py-4 rounded-2xl font-black uppercase text-[10px] shadow-lg shadow-amber-600/20 disabled:opacity-20 text-center transition-all active:scale-95",children:" Tinget"})]}),l.jsxs("section",{className:"bg-white/5 border border-white/5 rounded-[2.5rem] p-6 space-y-4 shadow-inner",children:[l.jsx("h3",{className:"text-[10px] font-black uppercase text-indigo-400 tracking-[0.2em] mb-2 px-2",children:"Legg til Karakter"}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("input",{type:"text",placeholder:"Navn...",value:O.name,onChange:S=>j({...O,name:S.target.value}),className:"w-full bg-black/40 border border-white/5 rounded-xl px-4 py-3 text-xs font-bold text-white placeholder:text-slate-600 focus:border-indigo-500/50 focus:ring-0 transition-all"}),l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsx("select",{value:O.role,onChange:S=>j({...O,role:S.target.value}),className:"bg-black/40 border border-white/5 rounded-xl px-3 py-2 text-[10px] font-black uppercase text-slate-400 focus:ring-0",children:Object.keys(Cl).map(S=>l.jsx("option",{value:S,children:S},S))}),l.jsxs("div",{className:"flex items-center gap-2 bg-black/40 border border-white/5 rounded-xl px-3 py-2",children:[l.jsx("span",{className:"text-[8px] font-black text-slate-600",children:"LVL"}),l.jsx("input",{type:"number",value:O.level,onChange:S=>j({...O,level:parseInt(S.target.value)}),className:"w-full bg-transparent border-none p-0 text-xs font-black text-white focus:ring-0 font-mono"})]})]}),l.jsx("button",{onClick:I,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-xl font-black uppercase text-[10px] shadow-lg shadow-indigo-600/20 transition-all active:scale-95",children:" SKAP KARAKTER"})]})]})]})]}),l.jsxs("section",{children:[l.jsx("h3",{className:"text-[10px] font-black uppercase text-slate-500 tracking-[0.2em] mb-4",children:"Landsby-fokus"}),(qn=n.world)!=null&&qn.settlement?l.jsx("div",{className:"text-xs text-slate-500 italic",children:"Landsbyen er initialisert."}):l.jsx("button",{onClick:X,className:"w-full bg-amber-500 text-black py-4 rounded-2xl font-black uppercase text-[10px] animate-pulse",children:"Initialiser Landsby"})]})]})]}),l.jsxs("main",{className:"flex-1 relative flex flex-col bg-slate-900/10 overflow-hidden no-scrollbar",children:[l.jsxs("header",{className:"h-16 border-b border-white/5 bg-slate-950/30 backdrop-blur-md flex items-center justify-between px-8 shrink-0 z-10",children:[l.jsxs("div",{className:"flex items-center gap-8",children:[l.jsxs("nav",{className:"flex items-center bg-white/5 p-1 rounded-xl border border-white/10",children:[l.jsx("button",{onClick:()=>u("MANAGE"),className:`px-4 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${c==="MANAGE"?"bg-indigo-600 text-white shadow-lg":"text-slate-500 hover:text-white"}`,children:"Overvking"}),l.jsx("button",{onClick:()=>u("ECONOMY"),className:`px-4 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${c==="ECONOMY"?"bg-indigo-600 text-white shadow-lg":"text-slate-500 hover:text-white"}`,children:"Blueprint"}),l.jsx("button",{onClick:()=>u("AI_LAB"),className:`px-4 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${c==="AI_LAB"?"bg-indigo-600 text-white shadow-lg":"text-slate-500 hover:text-white"}`,children:"AI Training Lab"})]}),l.jsx("div",{className:"h-4 w-[1px] bg-white/10 mx-2"}),l.jsxs("div",{className:"flex items-center gap-8",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Innbyggere:"}),l.jsx("span",{className:"text-sm font-bold text-white",children:Object.keys(n.players||{}).length})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"r i Riket:"}),l.jsx("span",{className:"text-sm font-bold text-white",children:((gc=n.world)==null?void 0:gc.year)||1100})]})]})]}),a&&l.jsx("div",{className:"text-[10px] font-black uppercase tracking-widest text-indigo-400 animate-pulse",children:"Prosesserer Endringer..."})]}),l.jsx("div",{className:"flex-1 p-8 overflow-y-auto custom-scrollbar no-scrollbar",children:c==="ECONOMY"?b?l.jsx(b,{}):l.jsx("div",{className:"p-20 text-center animate-pulse text-slate-500 font-black uppercase tracking-widest",children:"Laster Blueprint..."}):c==="AI_LAB"?l.jsx(D6,{roomData:n,pin:t}):l.jsxs("div",{className:"space-y-12 pb-20",children:[l.jsxs("section",{children:[l.jsx("h2",{className:"text-3xl font-black text-white px-2 mb-8 tracking-tighter",children:"Innbyggere i Riket"}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[Object.values(n.players||{}).map(S=>{var M,G,Q,re,Z,Y,de;return l.jsxs("div",{className:"relative bg-slate-900/80 border border-white/5 p-6 rounded-[2rem] hover:border-indigo-500/30 transition-all group",children:[l.jsx("button",{onClick:W=>{W.stopPropagation(),Ie(S.id,S.name)},className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-rose-500/10 text-rose-500 opacity-0 group-hover:opacity-100 transition-all hover:bg-rose-500 hover:text-white flex items-center justify-center font-bold text-xs",title:"Kast ut spiller",children:""}),l.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[l.jsx("div",{className:"w-12 h-12 bg-indigo-600/20 rounded-xl flex items-center justify-center text-2xl shrink-0 group-hover:scale-110 transition-transform overflow-hidden",children:S.avatar?l.jsx("img",{src:S.avatar,alt:S.role,className:"w-full h-full object-cover"}):{KING:"",BARON:"",PEASANT:"",SOLDIER:"",MERCHANT:""}[S.role]||""}),l.jsxs("div",{className:"min-w-0 flex-1",children:[l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("h3",{className:"text-lg font-black text-white truncate leading-tight",children:S.name}),l.jsxs("div",{className:"flex items-center gap-1 bg-white/5 px-2 py-0.5 rounded-lg border border-white/5",children:[l.jsx("span",{className:"text-[8px] font-black text-slate-500 uppercase",children:"LVL"}),l.jsx("input",{type:"number",value:((M=S.stats)==null?void 0:M.level)||1,onChange:W=>H(S.id,parseInt(W.target.value)),className:"w-8 bg-transparent border-none p-0 text-[10px] font-black text-indigo-400 focus:ring-0 text-center font-mono"})]})]}),l.jsxs("div",{className:"flex flex-col gap-1 mt-1",children:[l.jsx("select",{value:S.role,onChange:W=>ne(S.id,W.target.value),className:"bg-indigo-500/10 text-indigo-400 text-[10px] font-black uppercase tracking-widest border-none p-0 focus:ring-0 cursor-pointer hover:text-white transition-colors w-full text-left",children:Object.entries(Cl).map(([W,ye])=>l.jsx("option",{value:W,className:"bg-slate-900",children:ye.label},W))}),l.jsxs("select",{value:S.regionId||"region_ost",onChange:W=>st(S.id,W.target.value),className:"bg-white/5 text-slate-500 text-[9px] font-bold uppercase tracking-wider border-none p-0 focus:ring-0 cursor-pointer hover:text-slate-300 transition-colors w-full text-left",children:[l.jsx("option",{value:"capital",className:"bg-slate-900",children:"Hovedstaden"}),l.jsx("option",{value:"region_ost",className:"bg-slate-900",children:"Baroniet st"}),l.jsx("option",{value:"region_vest",className:"bg-slate-900",children:"Baroniet Vest"})]})]})]})]}),S.id.startsWith("bot_")&&((G=S.status)==null?void 0:G.thought)&&l.jsxs("div",{className:"mb-4 p-3 bg-indigo-500/10 rounded-xl border border-indigo-500/20",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx("span",{className:"text-[8px] font-black text-indigo-400 uppercase tracking-widest",children:"Mental Tilstand"}),l.jsx("div",{className:"flex-1 h-[1px] bg-indigo-500/20"})]}),l.jsxs("p",{className:"text-[10px] text-white/90 font-bold leading-relaxed mb-2",children:['"',S.status.thought,'"']}),l.jsxs("div",{className:"flex justify-between items-center text-[8px] font-black uppercase tracking-tighter text-indigo-400/60",children:[l.jsxs("span",{children:["Handling: ",S.status.lastAction]}),l.jsxs("span",{children:["Tid: ",S.status.lastTick?new Date(S.status.lastTick).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"N"]})]})]}),l.jsxs("div",{className:"space-y-3 mb-6",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between text-[8px] font-black uppercase text-slate-500 mb-1",children:[l.jsx("span",{children:"Stamina"}),l.jsxs("span",{className:"text-white",children:[S.status.stamina,"%"]})]}),l.jsx("div",{className:"h-1 bg-slate-800 rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-emerald-500",style:{width:`${S.status.stamina}%`}})})]}),l.jsxs("div",{className:"flex justify-between items-center text-xs font-bold",children:[l.jsx("span",{className:"text-slate-500",children:"Gull:"}),l.jsxs("span",{className:"text-amber-500 font-black",children:[S.resources.gold,""]})]})]}),l.jsxs("div",{className:"flex flex-wrap gap-1 mb-6",children:[(Q=S.upgrades)==null?void 0:Q.map(W=>l.jsx("span",{className:"text-[7px] font-black bg-indigo-500/10 text-indigo-400 px-1.5 py-0.5 rounded border border-indigo-500/20 uppercase tracking-tighter",children:W},W)),(!S.upgrades||S.upgrades.length===0)&&l.jsx("span",{className:"text-[7px] font-bold text-slate-700 uppercase italic",children:"Ingen oppgraderinger"})]}),l.jsxs("button",{onClick:()=>me(S.id),className:"w-full py-4 rounded-2xl bg-indigo-600/10 hover:bg-indigo-600 text-indigo-400 hover:text-white font-black uppercase text-[10px] tracking-widest transition-all border border-indigo-500/20 flex items-center justify-center gap-2 group/btn",children:[l.jsx("span",{className:"group-hover/btn:scale-125 transition-transform",children:""}),"Styr spiller"]}),l.jsxs("div",{className:"mt-4 pt-4 border-t border-white/5 flex flex-col gap-2",children:[l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{type:"number",placeholder:"Gull...",value:d[S.id]||"",onChange:W=>f({...d,[S.id]:parseInt(W.target.value)||0}),className:"flex-1 bg-black/40 border border-white/5 rounded-xl px-3 py-2 text-[10px] font-black text-white focus:border-indigo-500/50 transition-all font-mono"}),l.jsx("button",{onClick:()=>{const W=d[S.id]||0;W>0&&(MP(t,S.id,W),f({...d,[S.id]:0}))},className:"bg-emerald-600/20 hover:bg-emerald-600 text-emerald-400 hover:text-white border border-emerald-500/30 px-3 py-2 rounded-xl text-[8px] font-black uppercase transition-all",children:"GI GULL"})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("select",{value:((re=g[S.id])==null?void 0:re.resourceId)||"",onChange:W=>{var ye;return v({...g,[S.id]:{resourceId:W.target.value,amount:((ye=g[S.id])==null?void 0:ye.amount)||10}})},className:"flex-[2] bg-black/40 border border-white/5 rounded-xl px-2 py-2 text-[10px] font-bold text-amber-300 focus:border-amber-500/50 transition-all cursor-pointer",children:[l.jsx("option",{value:"",children:"Velg Ressurs..."}),Object.entries(mn).map(([W,ye])=>l.jsxs("option",{value:W,children:[ye.icon," ",ye.label]},W))]}),l.jsx("input",{type:"number",placeholder:"#",value:((Z=g[S.id])==null?void 0:Z.amount)||10,onChange:W=>{var ye;return v({...g,[S.id]:{resourceId:((ye=g[S.id])==null?void 0:ye.resourceId)||"",amount:parseInt(W.target.value)||1}})},className:"w-12 bg-black/40 border border-white/5 rounded-xl px-2 py-2 text-[10px] font-black text-white focus:border-amber-500/50 transition-all font-mono text-center"}),l.jsx("button",{onClick:()=>{const W=g[S.id];W&&W.resourceId&&W.amount>0&&(LP(t,S.id,W.resourceId,W.amount),v({...g,[S.id]:{resourceId:"",amount:10}}))},className:"bg-amber-600/20 hover:bg-amber-600 text-amber-400 hover:text-white border border-amber-500/30 px-3 py-2 rounded-xl text-[8px] font-black uppercase transition-all",children:"GI RESSURS"})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("select",{value:((Y=h[S.id])==null?void 0:Y.itemId)||"",onChange:W=>{var ye;return m({...h,[S.id]:{itemId:W.target.value,amount:((ye=h[S.id])==null?void 0:ye.amount)||1}})},className:"flex-[2] bg-black/40 border border-white/5 rounded-xl px-2 py-2 text-[10px] font-bold text-slate-300 focus:border-indigo-500/50 transition-all cursor-pointer",children:[l.jsx("option",{value:"",children:"Velg Gjenstand..."}),Object.values(Te).map(W=>l.jsxs("option",{value:W.id,children:[W.icon," ",W.name]},W.id))]}),l.jsx("input",{type:"number",placeholder:"#",value:((de=h[S.id])==null?void 0:de.amount)||1,onChange:W=>{var ye;return m({...h,[S.id]:{itemId:((ye=h[S.id])==null?void 0:ye.itemId)||"",amount:parseInt(W.target.value)||1}})},className:"w-12 bg-black/40 border border-white/5 rounded-xl px-2 py-2 text-[10px] font-black text-white focus:border-indigo-500/50 transition-all font-mono text-center"}),l.jsx("button",{onClick:()=>{const W=h[S.id];W&&W.itemId&&W.amount>0&&(DP(t,S.id,W.itemId,W.amount),m({...h,[S.id]:{itemId:"",amount:1}}))},className:"bg-indigo-600/20 hover:bg-indigo-600 text-indigo-400 hover:text-white border border-indigo-500/30 px-3 py-2 rounded-xl text-[8px] font-black uppercase transition-all",children:"GI ITEM"})]})]})]},S.id)}),Object.keys(n.players||{}).length===0&&l.jsxs("div",{className:"col-span-full py-20 text-center border-2 border-dashed border-white/5 rounded-[3rem]",children:[l.jsx("span",{className:"text-6xl block mb-4 opacity-20",children:""}),l.jsx("p",{className:"text-slate-500 font-bold uppercase tracking-widest text-xs",children:"Venter p at understter skal ankomme..."})]})]})]}),((bc=n.world)==null?void 0:bc.settlement)&&l.jsxs("section",{className:"bg-indigo-900/10 border border-indigo-500/10 p-10 rounded-[3rem] relative overflow-hidden group",children:[l.jsxs("div",{className:"relative z-10",children:[l.jsxs("h2",{className:"text-3xl font-black text-white mb-8 tracking-tighter flex items-center justify-between",children:["Landsbyutvikling",l.jsx("span",{className:"text-xs font-black uppercase tracking-widest text-indigo-400 bg-indigo-500/10 px-4 py-2 rounded-full",children:"Status Rapport"})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:Object.values(((xc=(vc=n.world)==null?void 0:vc.settlement)==null?void 0:xc.buildings)||{}).map(S=>{const M=Bt[S.id],G=S.progress/(S.target||200)*100;return l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex justify-between items-end",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-black text-white uppercase",children:M==null?void 0:M.name}),l.jsxs("p",{className:"text-[10px] text-slate-500 font-bold tracking-tight",children:["Niv ",S.level]})]}),l.jsxs("span",{className:"text-xs font-mono text-indigo-500",children:[Object.values(S.progress||{}).reduce((Q,re)=>Q+re,0)," / ",S.target||200]})]}),l.jsxs("div",{className:"h-4 bg-black/40 rounded-full overflow-hidden border border-white/5 relative group/progress",children:[l.jsx("div",{className:"h-full bg-gradient-to-r from-indigo-600 via-indigo-400 to-fuchsia-500 transition-all duration-1000 shadow-[0_0_15px_rgba(99,102,241,0.4)] relative",style:{width:`${G}%`},children:l.jsx("div",{className:"absolute inset-0 bg-white/20 animate-pulse"})}),l.jsxs("div",{className:"absolute inset-0 opacity-0 group-hover/progress:opacity-100 transition-opacity flex justify-between items-center px-1 pointer-events-none",children:[l.jsx("button",{onClick:Q=>{Q.stopPropagation(),U(S.id,-1)},className:"w-5 h-5 bg-white/10 hover:bg-rose-500 text-white rounded-full flex items-center justify-center text-[10px] font-black pointer-events-auto transition-all",children:"-"}),l.jsx("button",{onClick:Q=>{Q.stopPropagation(),U(S.id,1)},className:"w-5 h-5 bg-white/10 hover:bg-emerald-500 text-white rounded-full flex items-center justify-center text-[10px] font-black pointer-events-auto transition-all",children:"+"})]})]})]},S.id)})})]}),l.jsx("div",{className:"absolute top-[-20%] right-[-10%] text-[15rem] text-indigo-500 opacity-[0.03] pointer-events-none group-hover:rotate-6 transition-transform duration-[3000ms]",children:""})]})]})})]}),l.jsxs("aside",{className:"w-80 border-l border-white/10 bg-slate-900/50 backdrop-blur-xl flex flex-col z-20 shadow-2xl overflow-hidden",children:[l.jsxs("div",{className:"p-8 border-b border-white/5 bg-black/20 shrink-0",children:[l.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-amber-500 mb-6 flex items-center justify-between",children:["Rikets Formue",l.jsx("div",{className:"w-2 h-2 bg-amber-500 rounded-full animate-pulse shadow-[0_0_10px_rgba(245,158,11,0.5)]"})]}),l.jsxs("div",{className:"space-y-4",children:[Object.values(n.players||{}).sort((S,M)=>(M.resources.gold||0)-(S.resources.gold||0)).slice(0,5).map((S,M)=>l.jsxs("div",{className:"flex justify-between items-center group",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("span",{className:"text-xs font-black text-slate-600 font-mono",children:["#",M+1]}),l.jsx("span",{className:"text-sm font-bold text-white group-hover:translate-x-1 transition-transform",children:S.name})]}),l.jsxs("span",{className:"text-sm font-black text-amber-400",children:[S.resources.gold,""]})]},S.id)),Object.keys(n.players||{}).length===0&&l.jsx("p",{className:"text-[10px] text-slate-600 font-bold italic text-center py-4",children:"Ingen data tilgjengelig..."})]})]}),l.jsxs("div",{className:"p-8 border-b border-white/5 shrink-0",children:[l.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-indigo-400 mb-6",children:"Markedsanalyse"}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[Object.entries(n.market||{}).slice(0,4).map(([S,M])=>{const G=mn[S]||{label:S};return l.jsxs("div",{className:"bg-white/5 p-3 rounded-xl border border-white/5",children:[l.jsx("div",{className:"text-[8px] font-black uppercase text-slate-500 mb-1",children:G.label}),l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-xs font-black text-white",children:M.stock}),l.jsxs("span",{className:"text-[10px] font-mono text-emerald-400",children:[M.price.toFixed(1),"g"]})]})]},S)}),Object.entries(n.market||{}).slice(0,4).length===0&&l.jsx("div",{className:"col-span-2 text-[10px] text-slate-600 font-bold italic text-center py-4",children:"Ingen markedsdata..."})]})]}),l.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[l.jsx("div",{className:"p-8 pb-4 shrink-0",children:l.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-rose-500 flex items-center gap-2",children:[l.jsx("span",{className:"w-2 h-2 bg-rose-600 rounded-full animate-pulse shadow-[0_0_10px_rgba(225,29,72,0.5)]"}),"Global Logg"]})}),l.jsxs("div",{className:"flex-1 overflow-y-auto px-6 space-y-3 pb-8 custom-scrollbar",children:[R(n.messages).slice().reverse().map((S,M)=>l.jsx("div",{className:"bg-indigo-950/20 border-l-2 border-indigo-500/50 p-4 rounded-r-2xl animate-in slide-in-from-right-4 duration-300",children:l.jsx("p",{className:"text-[10px] font-medium leading-relaxed text-slate-400 antialiased italic font-serif opacity-80",children:typeof S=="object"?JSON.stringify(S):S})},M)),R(n.messages).length===0&&l.jsxs("div",{className:"h-full flex flex-col items-center justify-center opacity-20 py-20",children:[l.jsx("span",{className:"text-4xl mb-4",children:""}),l.jsx("p",{className:"text-[8px] font-black uppercase tracking-[0.2em]",children:"Arkivet er tomt"})]})]})]})]}),l.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .custom-scrollbar::-webkit-scrollbar {
                    width: 4px;
                }
                .custom-scrollbar::-webkit-scrollbar-track {
                    background: transparent;
                }
                .custom-scrollbar::-webkit-scrollbar-thumb {
                    background: rgba(255, 255, 255, 0.1);
                    border-radius: 10px;
                }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover {
                    background: rgba(255, 255, 255, 0.2);
                }
                .no-scrollbar::-webkit-scrollbar {
                    display: none;
                }
            `}})]})};function P6(t,e){const{user:n,authLoading:s}=pf(),[i,r]=_.useState(null),[a,o]=_.useState(null),[c,u]=_.useState({}),[d,f]=_.useState("LOBBY"),[h,m]=_.useState({}),[g,v]=_.useState({}),[x,p]=_.useState([]),[b,y]=_.useState(null),[E,N]=_.useState({}),[A,w]=_.useState({}),[T,k]=_.useState(!1),[R,C]=_.useState(!1),[B,z]=_.useState(!1),$=_.useRef(null),K=_.useRef(null);return _.useEffect(()=>{if(s)return;const U=localStorage.getItem("sim_player_id");let O=e;if(O||(n!=null&&n.uid?O=n.uid:O=U),!O||!t)return;const j=`simulation_rooms/${t}`,I=D(L,`${j}/players/${O}`),H=Ke(I,S=>{if(k(!0),S.exists()){$.current&&(clearTimeout($.current),$.current=null);const M=S.val();if(t==="TEST"&&M.regionId==="unassigned"&&M.role!=="KING"){const Q=Math.random()>.5?"region_east":"region_west";J(I,{regionId:Q})}const G={...M,id:O};r(G),K.current=G,C(!0)}else R?$.current||($.current=setTimeout(()=>{z(!0),r(null),C(!1),K.current=null},5e3)):r(null)}),X=D(L,`${j}/world`),oe=Ke(X,S=>{const M=S.val();M&&o(M)}),Ie=D(L,`${j}/status`),V=Ke(Ie,S=>{const M=S.val();M&&f(M||"LOBBY")}),me=D(L,`${j}/markets`),ne=Ke(me,S=>{const M=S.val();M&&m(M)}),st=D(L,`${j}/messages`),zt=Ke(st,S=>{const M=S.val();M&&p(M)}),On=D(L,`${j}/activeVote`),Mt=Ke(On,S=>{y(S.val())}),Yn=D(L,`${j}/diplomacy`),pn=Ke(Yn,S=>{N(S.val()||{})}),Hi=D(L,`${j}/trades`),qn=Ke(Hi,S=>{w(S.val()||{})}),gc=D(L,`${j}/public_profiles`),bc=Ke(gc,S=>{const M=S.val()||{};u(M)}),vc=D(L,`${j}/regions`),xc=Ke(vc,S=>{v(S.val()||{})});return()=>{H(),oe(),V(),ne(),zt(),Mt(),pn(),bc(),qn(),xc()}},[t,e,n==null?void 0:n.uid,s,R]),_.useEffect(()=>{if(!i||!t)return;const U=D(L,`simulation_rooms/${t}/players/${i.id}`),O=D(L,`simulation_rooms/${t}/public_profiles/${i.id}`);uy(U).update({online:!1}),uy(O).update({online:!1});const j=setInterval(()=>{const I=Date.now();J(U,{lastActive:I,online:!0}),J(O,{lastActive:I,online:!0})},3e4);return J(U,{lastActive:Date.now(),online:!0}),J(O,{lastActive:Date.now(),online:!0}),()=>clearInterval(j)},[t,i==null?void 0:i.id]),_.useEffect(()=>{if(!t||!t.startsWith("v"))return;const U=localStorage.getItem("nexus_active_vessel");if(U)try{const O=JSON.parse(U);if(O.id===t){console.log("Nexus Vessel Detected. Injecting Mock Data...",O);const j={id:O.id,uid:(n==null?void 0:n.uid)||"nexus_user",name:O.name,role:O.role.toUpperCase(),regionId:"nexus_region",resources:{gold:O.gold,grain:100,flour:0,bread:5,wood:50,plank:0,iron_ore:0,iron_ingot:0,stone:0,swords:0,armor:0,favor:0,wool:0,cloth:0,honey:0,meat:0,glass:0,manpower:10,egg:0,omelette:0},stats:{xp:0,level:1,reputation:50,contribution:0},status:{hp:O.health,morale:100,stamina:100,legitimacy:100,authority:100,loyalty:100,isJailed:!1,isFrozen:!1},equipment:{},skills:{FARMING:{level:1,xp:0,maxXp:100},WOODCUTTING:{level:1,xp:0,maxXp:100},MINING:{level:1,xp:0,maxXp:100},CRAFTING:{level:1,xp:0,maxXp:100},STEWARDSHIP:{level:1,xp:0,maxXp:100},COMBAT:{level:1,xp:0,maxXp:100},TRADING:{level:1,xp:0,maxXp:100},THEOLOGY:{level:1,xp:0,maxXp:100}},upgrades:[],lastActive:Date.now()};r(j),C(!0),k(!0),f("PLAYING"),o({year:1250,season:"Spring",weather:"Clear",gameTick:100,lastTickAt:Date.now(),taxRateDetails:{kingTax:10},settlement:{buildings:{}}})}}catch(O){console.error("Failed to parse Nexus vessel data",O)}},[t,n==null?void 0:n.uid]),SS(t,d,a),{player:i,world:a,players:c,roomStatus:d,markets:h,regions:g,messages:x,activeVote:b,diplomacy:E,trades:A,hasAttemptedPlayerLoad:T,hasActiveSession:R,isRetired:B,setIsRetired:z,setPlayer:r,lastValidPlayer:K.current}}function jS(t,e,n,s,i,r,a){const[o,c]=_.useState(null),[u,d]=_.useState(null),f=_.useCallback(()=>{d(null)},[]),h=_.useCallback(async m=>{var y;if(!t||!e||o)return;const g=typeof m=="string"?m:m.type,v=typeof m=="object"?m.method:null;if(["WORK","CHOP","CRAFT","DEFEND","EXPLORE","MINE","QUARRY","PATROL","FORAGE","REFINE","SMELT","BAKE","WEAVE","MIX","PLANT","HARVEST","GATHER_WOOL","HUNT","SAWMILL"].includes(g)&&!a&&!m.performance){const E=(n==null?void 0:n.season)||"Spring",N=(n==null?void 0:n.weather)||"Clear",A=(n==null?void 0:n.gameTick)||0,w=AS(e,m,E,N,A);if(!w.success){alert(`Du har ikke rd til dette: ${w.reason}`),d({success:!1,timestamp:Date.now(),message:`Kan ikke utfre: ${w.reason}`,utbytte:[],xp:[],durability:[]});return}let T=g;if(g==="REFINE"){const C=m.recipeId;(C==="iron_ingot"||C==="glass"||C==="smelt")&&(T="SMELT"),(C==="bread"||C==="pie"||C==="mead"||C==="bake")&&(T="BAKE"),(C==="cloth"||C==="weave")&&(T="WEAVE"),C==="plank"&&(T="SAWMILL")}g==="CRAFT"&&m.subType==="omelette"&&(T="BAKE");const R=(e.activeProcesses||[]).find(C=>{var B;return(C.locationId===m.locationId||m.locationId&&((B=C.locationId)==null?void 0:B.startsWith(m.locationId)))&&C.readyAt<=Date.now()});if(!(g==="REFINE"&&m.recipeId==="flour"||g==="HARVEST"&&((R==null?void 0:R.type)==="MILL"||(R==null?void 0:R.type)==="CRAFT"))){s(T),v&&i(v),r(m),d(null);return}}const p=g==="EQUIP_ITEM"||g==="UNEQUIP_ITEM";m.performance&&!p&&(s(null),r(null),i(null)),p||c(g);const b=new Promise((E,N)=>{setTimeout(()=>N(new Error("Handlingen tok for lang tid (Timeout)")),3e4)});try{const E=await Promise.race([CS(t,e.id,m),b]);p||(E.data?d(E.data):E.success||d({success:!1,timestamp:Date.now(),message:`Handlingen feilet: ${((y=E.error)==null?void 0:y.message)||E.error||"Ukjent feil"}`,utbytte:[],xp:[],durability:[]}))}catch(E){console.error("Action Timeout/Error:",E),p||d({success:!1,timestamp:Date.now(),message:` ${E.message||"Ukjent feil"}`,utbytte:[],xp:[],durability:[]})}p||c(null),s(null),r(null),i(null)},[t,e,o,n,a,s,i,r]);return{actionLoading:o,actionResult:u,handleAction:h,handleClearActionResult:f,setActionLoading:c}}const dp=({resource:t,amount:e,size:n="md",showLabel:s=!1})=>{const i=mn[t]||{label:t,icon:""},r={sm:"text-xl",md:"text-3xl",lg:"text-7xl"};return l.jsxs("div",{className:"flex items-center gap-2",title:i.label,children:[l.jsx("span",{className:`${r[n]}`,children:i.icon}),l.jsxs("div",{className:"flex flex-col",children:[s&&l.jsx("span",{className:"text-xs uppercase text-game-stone_light font-bold tracking-wider",children:i.label}),e!==void 0&&l.jsx("span",{className:`font-mono font-bold text-white ${n==="lg"?"text-xl":"text-sm"}`,children:e.toLocaleString()})]})]})},P0=_.createContext({});function B0(t){const e=_.useRef(null);return e.current===null&&(e.current=t()),e.current}const U0=typeof window<"u",OS=U0?_.useLayoutEffect:_.useEffect,xf=_.createContext(null);function H0(t,e){t.indexOf(e)===-1&&t.push(e)}function G0(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}const Ls=(t,e,n)=>n>e?e:n<t?t:n;let V0=()=>{};const Ps={},MS=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function DS(t){return typeof t=="object"&&t!==null}const LS=t=>/^0[^.\s]+$/u.test(t);function F0(t){let e;return()=>(e===void 0&&(e=t()),e)}const In=t=>t,B6=(t,e)=>n=>e(t(n)),fc=(...t)=>t.reduce(B6),Ol=(t,e,n)=>{const s=e-t;return s===0?1:(n-t)/s};class z0{constructor(){this.subscriptions=[]}add(e){return H0(this.subscriptions,e),()=>G0(this.subscriptions,e)}notify(e,n,s){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,n,s);else for(let r=0;r<i;r++){const a=this.subscriptions[r];a&&a(e,n,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const ns=t=>t*1e3,kn=t=>t/1e3;function PS(t,e){return e?t*(1e3/e):0}const BS=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,U6=1e-7,H6=12;function G6(t,e,n,s,i){let r,a,o=0;do a=e+(n-e)/2,r=BS(a,s,i)-t,r>0?n=a:e=a;while(Math.abs(r)>U6&&++o<H6);return a}function hc(t,e,n,s){if(t===e&&n===s)return In;const i=r=>G6(r,0,1,t,n);return r=>r===0||r===1?r:BS(i(r),e,s)}const US=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,HS=t=>e=>1-t(1-e),GS=hc(.33,1.53,.69,.99),$0=HS(GS),VS=US($0),FS=t=>(t*=2)<1?.5*$0(t):.5*(2-Math.pow(2,-10*(t-1))),K0=t=>1-Math.sin(Math.acos(t)),zS=HS(K0),$S=US(K0),V6=hc(.42,0,1,1),F6=hc(0,0,.58,1),KS=hc(.42,0,.58,1),z6=t=>Array.isArray(t)&&typeof t[0]!="number",YS=t=>Array.isArray(t)&&typeof t[0]=="number",$6={linear:In,easeIn:V6,easeInOut:KS,easeOut:F6,circIn:K0,circInOut:$S,circOut:zS,backIn:$0,backInOut:VS,backOut:GS,anticipate:FS},K6=t=>typeof t=="string",Ny=t=>{if(YS(t)){V0(t.length===4);const[e,n,s,i]=t;return hc(e,n,s,i)}else if(K6(t))return $6[t];return t},Vc=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function Y6(t,e){let n=new Set,s=new Set,i=!1,r=!1;const a=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function c(d){a.has(d)&&(u.schedule(d),t()),d(o)}const u={schedule:(d,f=!1,h=!1)=>{const g=h&&i?n:s;return f&&a.add(d),g.has(d)||g.add(d),d},cancel:d=>{s.delete(d),a.delete(d)},process:d=>{if(o=d,i){r=!0;return}i=!0,[n,s]=[s,n],n.forEach(c),n.clear(),i=!1,r&&(r=!1,u.process(d))}};return u}const q6=40;function qS(t,e){let n=!1,s=!0;const i={delta:0,timestamp:0,isProcessing:!1},r=()=>n=!0,a=Vc.reduce((y,E)=>(y[E]=Y6(r),y),{}),{setup:o,read:c,resolveKeyframes:u,preUpdate:d,update:f,preRender:h,render:m,postRender:g}=a,v=()=>{const y=Ps.useManualTiming?i.timestamp:performance.now();n=!1,Ps.useManualTiming||(i.delta=s?1e3/60:Math.max(Math.min(y-i.timestamp,q6),1)),i.timestamp=y,i.isProcessing=!0,o.process(i),c.process(i),u.process(i),d.process(i),f.process(i),h.process(i),m.process(i),g.process(i),i.isProcessing=!1,n&&e&&(s=!1,t(v))},x=()=>{n=!0,s=!0,i.isProcessing||t(v)};return{schedule:Vc.reduce((y,E)=>{const N=a[E];return y[E]=(A,w=!1,T=!1)=>(n||x(),N.schedule(A,w,T)),y},{}),cancel:y=>{for(let E=0;E<Vc.length;E++)a[Vc[E]].cancel(y)},state:i,steps:a}}const{schedule:qe,cancel:Oi,state:kt,steps:_h}=qS(typeof requestAnimationFrame<"u"?requestAnimationFrame:In,!0);let mu;function W6(){mu=void 0}const Qt={now:()=>(mu===void 0&&Qt.set(kt.isProcessing||Ps.useManualTiming?kt.timestamp:performance.now()),mu),set:t=>{mu=t,queueMicrotask(W6)}},WS=t=>e=>typeof e=="string"&&e.startsWith(t),XS=WS("--"),X6=WS("var(--"),Y0=t=>X6(t)?Q6.test(t.split("/*")[0].trim()):!1,Q6=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,ao={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Ml={...ao,transform:t=>Ls(0,1,t)},Fc={...ao,default:1},Jo=t=>Math.round(t*1e5)/1e5,q0=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function J6(t){return t==null}const Z6=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,W0=(t,e)=>n=>!!(typeof n=="string"&&Z6.test(n)&&n.startsWith(t)||e&&!J6(n)&&Object.prototype.hasOwnProperty.call(n,e)),QS=(t,e,n)=>s=>{if(typeof s!="string")return s;const[i,r,a,o]=s.match(q0);return{[t]:parseFloat(i),[e]:parseFloat(r),[n]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},eB=t=>Ls(0,255,t),wh={...ao,transform:t=>Math.round(eB(t))},Ji={test:W0("rgb","red"),parse:QS("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:s=1})=>"rgba("+wh.transform(t)+", "+wh.transform(e)+", "+wh.transform(n)+", "+Jo(Ml.transform(s))+")"};function tB(t){let e="",n="",s="",i="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),s=t.substring(5,7),i=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),s=t.substring(3,4),i=t.substring(4,5),e+=e,n+=n,s+=s,i+=i),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(s,16),alpha:i?parseInt(i,16)/255:1}}const fp={test:W0("#"),parse:tB,transform:Ji.transform},mc=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),zs=mc("deg"),ss=mc("%"),se=mc("px"),nB=mc("vh"),sB=mc("vw"),ky={...ss,parse:t=>ss.parse(t)/100,transform:t=>ss.transform(t*100)},Zr={test:W0("hsl","hue"),parse:QS("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:s=1})=>"hsla("+Math.round(t)+", "+ss.transform(Jo(e))+", "+ss.transform(Jo(n))+", "+Jo(Ml.transform(s))+")"},rt={test:t=>Ji.test(t)||fp.test(t)||Zr.test(t),parse:t=>Ji.test(t)?Ji.parse(t):Zr.test(t)?Zr.parse(t):fp.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Ji.transform(t):Zr.transform(t),getAnimatableNone:t=>{const e=rt.parse(t);return e.alpha=0,rt.transform(e)}},iB=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function rB(t){var e,n;return isNaN(t)&&typeof t=="string"&&(((e=t.match(q0))==null?void 0:e.length)||0)+(((n=t.match(iB))==null?void 0:n.length)||0)>0}const JS="number",ZS="color",aB="var",oB="var(",Sy="${}",lB=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Dl(t){const e=t.toString(),n=[],s={color:[],number:[],var:[]},i=[];let r=0;const o=e.replace(lB,c=>(rt.test(c)?(s.color.push(r),i.push(ZS),n.push(rt.parse(c))):c.startsWith(oB)?(s.var.push(r),i.push(aB),n.push(c)):(s.number.push(r),i.push(JS),n.push(parseFloat(c))),++r,Sy)).split(Sy);return{values:n,split:o,indexes:s,types:i}}function eT(t){return Dl(t).values}function tT(t){const{split:e,types:n}=Dl(t),s=e.length;return i=>{let r="";for(let a=0;a<s;a++)if(r+=e[a],i[a]!==void 0){const o=n[a];o===JS?r+=Jo(i[a]):o===ZS?r+=rt.transform(i[a]):r+=i[a]}return r}}const cB=t=>typeof t=="number"?0:rt.test(t)?rt.getAnimatableNone(t):t;function uB(t){const e=eT(t);return tT(t)(e.map(cB))}const Mi={test:rB,parse:eT,createTransformer:tT,getAnimatableNone:uB};function Eh(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function dB({hue:t,saturation:e,lightness:n,alpha:s}){t/=360,e/=100,n/=100;let i=0,r=0,a=0;if(!e)i=r=a=n;else{const o=n<.5?n*(1+e):n+e-n*e,c=2*n-o;i=Eh(c,o,t+1/3),r=Eh(c,o,t),a=Eh(c,o,t-1/3)}return{red:Math.round(i*255),green:Math.round(r*255),blue:Math.round(a*255),alpha:s}}function _d(t,e){return n=>n>0?e:t}const Qe=(t,e,n)=>t+(e-t)*n,Nh=(t,e,n)=>{const s=t*t,i=n*(e*e-s)+s;return i<0?0:Math.sqrt(i)},fB=[fp,Ji,Zr],hB=t=>fB.find(e=>e.test(t));function Ty(t){const e=hB(t);if(!e)return!1;let n=e.parse(t);return e===Zr&&(n=dB(n)),n}const Ay=(t,e)=>{const n=Ty(t),s=Ty(e);if(!n||!s)return _d(t,e);const i={...n};return r=>(i.red=Nh(n.red,s.red,r),i.green=Nh(n.green,s.green,r),i.blue=Nh(n.blue,s.blue,r),i.alpha=Qe(n.alpha,s.alpha,r),Ji.transform(i))},hp=new Set(["none","hidden"]);function mB(t,e){return hp.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function pB(t,e){return n=>Qe(t,e,n)}function X0(t){return typeof t=="number"?pB:typeof t=="string"?Y0(t)?_d:rt.test(t)?Ay:vB:Array.isArray(t)?nT:typeof t=="object"?rt.test(t)?Ay:gB:_d}function nT(t,e){const n=[...t],s=n.length,i=t.map((r,a)=>X0(r)(r,e[a]));return r=>{for(let a=0;a<s;a++)n[a]=i[a](r);return n}}function gB(t,e){const n={...t,...e},s={};for(const i in n)t[i]!==void 0&&e[i]!==void 0&&(s[i]=X0(t[i])(t[i],e[i]));return i=>{for(const r in s)n[r]=s[r](i);return n}}function bB(t,e){const n=[],s={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const r=e.types[i],a=t.indexes[r][s[r]],o=t.values[a]??0;n[i]=o,s[r]++}return n}const vB=(t,e)=>{const n=Mi.createTransformer(e),s=Dl(t),i=Dl(e);return s.indexes.var.length===i.indexes.var.length&&s.indexes.color.length===i.indexes.color.length&&s.indexes.number.length>=i.indexes.number.length?hp.has(t)&&!i.values.length||hp.has(e)&&!s.values.length?mB(t,e):fc(nT(bB(s,i),i.values),n):_d(t,e)};function sT(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?Qe(t,e,n):X0(t)(t,e)}const xB=t=>{const e=({timestamp:n})=>t(n);return{start:(n=!0)=>qe.update(e,n),stop:()=>Oi(e),now:()=>kt.isProcessing?kt.timestamp:Qt.now()}},iT=(t,e,n=10)=>{let s="";const i=Math.max(Math.round(e/n),2);for(let r=0;r<i;r++)s+=Math.round(t(r/(i-1))*1e4)/1e4+", ";return`linear(${s.substring(0,s.length-2)})`},wd=2e4;function Q0(t){let e=0;const n=50;let s=t.next(e);for(;!s.done&&e<wd;)e+=n,s=t.next(e);return e>=wd?1/0:e}function yB(t,e=100,n){const s=n({...t,keyframes:[0,e]}),i=Math.min(Q0(s),wd);return{type:"keyframes",ease:r=>s.next(i*r).value/e,duration:kn(i)}}const _B=5;function rT(t,e,n){const s=Math.max(e-_B,0);return PS(n-t(s),e-s)}const Ze={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},kh=.001;function wB({duration:t=Ze.duration,bounce:e=Ze.bounce,velocity:n=Ze.velocity,mass:s=Ze.mass}){let i,r,a=1-e;a=Ls(Ze.minDamping,Ze.maxDamping,a),t=Ls(Ze.minDuration,Ze.maxDuration,kn(t)),a<1?(i=u=>{const d=u*a,f=d*t,h=d-n,m=mp(u,a),g=Math.exp(-f);return kh-h/m*g},r=u=>{const f=u*a*t,h=f*n+n,m=Math.pow(a,2)*Math.pow(u,2)*t,g=Math.exp(-f),v=mp(Math.pow(u,2),a);return(-i(u)+kh>0?-1:1)*((h-m)*g)/v}):(i=u=>{const d=Math.exp(-u*t),f=(u-n)*t+1;return-kh+d*f},r=u=>{const d=Math.exp(-u*t),f=(n-u)*(t*t);return d*f});const o=5/t,c=NB(i,r,o);if(t=ns(t),isNaN(c))return{stiffness:Ze.stiffness,damping:Ze.damping,duration:t};{const u=Math.pow(c,2)*s;return{stiffness:u,damping:a*2*Math.sqrt(s*u),duration:t}}}const EB=12;function NB(t,e,n){let s=n;for(let i=1;i<EB;i++)s=s-t(s)/e(s);return s}function mp(t,e){return t*Math.sqrt(1-e*e)}const kB=["duration","bounce"],SB=["stiffness","damping","mass"];function Ry(t,e){return e.some(n=>t[n]!==void 0)}function TB(t){let e={velocity:Ze.velocity,stiffness:Ze.stiffness,damping:Ze.damping,mass:Ze.mass,isResolvedFromDuration:!1,...t};if(!Ry(t,SB)&&Ry(t,kB))if(t.visualDuration){const n=t.visualDuration,s=2*Math.PI/(n*1.2),i=s*s,r=2*Ls(.05,1,1-(t.bounce||0))*Math.sqrt(i);e={...e,mass:Ze.mass,stiffness:i,damping:r}}else{const n=wB(t);e={...e,...n,mass:Ze.mass},e.isResolvedFromDuration=!0}return e}function Ed(t=Ze.visualDuration,e=Ze.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:s,restDelta:i}=n;const r=n.keyframes[0],a=n.keyframes[n.keyframes.length-1],o={done:!1,value:r},{stiffness:c,damping:u,mass:d,duration:f,velocity:h,isResolvedFromDuration:m}=TB({...n,velocity:-kn(n.velocity||0)}),g=h||0,v=u/(2*Math.sqrt(c*d)),x=a-r,p=kn(Math.sqrt(c/d)),b=Math.abs(x)<5;s||(s=b?Ze.restSpeed.granular:Ze.restSpeed.default),i||(i=b?Ze.restDelta.granular:Ze.restDelta.default);let y;if(v<1){const N=mp(p,v);y=A=>{const w=Math.exp(-v*p*A);return a-w*((g+v*p*x)/N*Math.sin(N*A)+x*Math.cos(N*A))}}else if(v===1)y=N=>a-Math.exp(-p*N)*(x+(g+p*x)*N);else{const N=p*Math.sqrt(v*v-1);y=A=>{const w=Math.exp(-v*p*A),T=Math.min(N*A,300);return a-w*((g+v*p*x)*Math.sinh(T)+N*x*Math.cosh(T))/N}}const E={calculatedDuration:m&&f||null,next:N=>{const A=y(N);if(m)o.done=N>=f;else{let w=N===0?g:0;v<1&&(w=N===0?ns(g):rT(y,N,A));const T=Math.abs(w)<=s,k=Math.abs(a-A)<=i;o.done=T&&k}return o.value=o.done?a:A,o},toString:()=>{const N=Math.min(Q0(E),wd),A=iT(w=>E.next(N*w).value,N,30);return N+"ms "+A},toTransition:()=>{}};return E}Ed.applyToOptions=t=>{const e=yB(t,100,Ed);return t.ease=e.ease,t.duration=ns(e.duration),t.type="keyframes",t};function pp({keyframes:t,velocity:e=0,power:n=.8,timeConstant:s=325,bounceDamping:i=10,bounceStiffness:r=500,modifyTarget:a,min:o,max:c,restDelta:u=.5,restSpeed:d}){const f=t[0],h={done:!1,value:f},m=T=>o!==void 0&&T<o||c!==void 0&&T>c,g=T=>o===void 0?c:c===void 0||Math.abs(o-T)<Math.abs(c-T)?o:c;let v=n*e;const x=f+v,p=a===void 0?x:a(x);p!==x&&(v=p-f);const b=T=>-v*Math.exp(-T/s),y=T=>p+b(T),E=T=>{const k=b(T),R=y(T);h.done=Math.abs(k)<=u,h.value=h.done?p:R};let N,A;const w=T=>{m(h.value)&&(N=T,A=Ed({keyframes:[h.value,g(h.value)],velocity:rT(y,T,h.value),damping:i,stiffness:r,restDelta:u,restSpeed:d}))};return w(0),{calculatedDuration:null,next:T=>{let k=!1;return!A&&N===void 0&&(k=!0,E(T),w(T)),N!==void 0&&T>=N?A.next(T-N):(!k&&E(T),h)}}}function AB(t,e,n){const s=[],i=n||Ps.mix||sT,r=t.length-1;for(let a=0;a<r;a++){let o=i(t[a],t[a+1]);if(e){const c=Array.isArray(e)?e[a]||In:e;o=fc(c,o)}s.push(o)}return s}function RB(t,e,{clamp:n=!0,ease:s,mixer:i}={}){const r=t.length;if(V0(r===e.length),r===1)return()=>e[0];if(r===2&&e[0]===e[1])return()=>e[1];const a=t[0]===t[1];t[0]>t[r-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=AB(e,s,i),c=o.length,u=d=>{if(a&&d<t[0])return e[0];let f=0;if(c>1)for(;f<t.length-2&&!(d<t[f+1]);f++);const h=Ol(t[f],t[f+1],d);return o[f](h)};return n?d=>u(Ls(t[0],t[r-1],d)):u}function IB(t,e){const n=t[t.length-1];for(let s=1;s<=e;s++){const i=Ol(0,e,s);t.push(Qe(n,1,i))}}function CB(t){const e=[0];return IB(e,t.length-1),e}function jB(t,e){return t.map(n=>n*e)}function OB(t,e){return t.map(()=>e||KS).splice(0,t.length-1)}function Zo({duration:t=300,keyframes:e,times:n,ease:s="easeInOut"}){const i=z6(s)?s.map(Ny):Ny(s),r={done:!1,value:e[0]},a=jB(n&&n.length===e.length?n:CB(e),t),o=RB(a,e,{ease:Array.isArray(i)?i:OB(e,i)});return{calculatedDuration:t,next:c=>(r.value=o(c),r.done=c>=t,r)}}const MB=t=>t!==null;function J0(t,{repeat:e,repeatType:n="loop"},s,i=1){const r=t.filter(MB),o=i<0||e&&n!=="loop"&&e%2===1?0:r.length-1;return!o||s===void 0?r[o]:s}const DB={decay:pp,inertia:pp,tween:Zo,keyframes:Zo,spring:Ed};function aT(t){typeof t.type=="string"&&(t.type=DB[t.type])}class Z0{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,n){return this.finished.then(e,n)}}const LB=t=>t/100;class eb extends Z0{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var s,i;const{motionValue:n}=this.options;n&&n.updatedAt!==Qt.now()&&this.tick(Qt.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(i=(s=this.options).onStop)==null||i.call(s))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;aT(e);const{type:n=Zo,repeat:s=0,repeatDelay:i=0,repeatType:r,velocity:a=0}=e;let{keyframes:o}=e;const c=n||Zo;c!==Zo&&typeof o[0]!="number"&&(this.mixKeyframes=fc(LB,sT(o[0],o[1])),o=[0,100]);const u=c({...e,keyframes:o});r==="mirror"&&(this.mirroredGenerator=c({...e,keyframes:[...o].reverse(),velocity:-a})),u.calculatedDuration===null&&(u.calculatedDuration=Q0(u));const{calculatedDuration:d}=u;this.calculatedDuration=d,this.resolvedDuration=d+i,this.totalDuration=this.resolvedDuration*(s+1)-i,this.generator=u}updateTime(e){const n=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(e,n=!1){const{generator:s,totalDuration:i,mixKeyframes:r,mirroredGenerator:a,resolvedDuration:o,calculatedDuration:c}=this;if(this.startTime===null)return s.next(0);const{delay:u=0,keyframes:d,repeat:f,repeatType:h,repeatDelay:m,type:g,onUpdate:v,finalKeyframe:x}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-i/this.speed,this.startTime)),n?this.currentTime=e:this.updateTime(e);const p=this.currentTime-u*(this.playbackSpeed>=0?1:-1),b=this.playbackSpeed>=0?p<0:p>i;this.currentTime=Math.max(p,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let y=this.currentTime,E=s;if(f){const T=Math.min(this.currentTime,i)/o;let k=Math.floor(T),R=T%1;!R&&T>=1&&(R=1),R===1&&k--,k=Math.min(k,f+1),!!(k%2)&&(h==="reverse"?(R=1-R,m&&(R-=m/o)):h==="mirror"&&(E=a)),y=Ls(0,1,R)*o}const N=b?{done:!1,value:d[0]}:E.next(y);r&&(N.value=r(N.value));let{done:A}=N;!b&&c!==null&&(A=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const w=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&A);return w&&g!==pp&&(N.value=J0(d,this.options,x,this.speed)),v&&v(N.value),w&&this.finish(),N}then(e,n){return this.finished.then(e,n)}get duration(){return kn(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+kn(e)}get time(){return kn(this.currentTime)}set time(e){var n;e=ns(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(n=this.driver)==null||n.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Qt.now());const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=kn(this.currentTime))}play(){var i,r;if(this.isStopped)return;const{driver:e=xB,startTime:n}=this.options;this.driver||(this.driver=e(a=>this.tick(a))),(r=(i=this.options).onPlay)==null||r.call(i);const s=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=s):this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime||(this.startTime=n??s),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Qt.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,n;this.notifyFinished(),this.teardown(),this.state="finished",(n=(e=this.options).onComplete)==null||n.call(e)}cancel(){var e,n;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(n=(e=this.options).onCancel)==null||n.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var n;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(n=this.driver)==null||n.stop(),e.observe(this)}}function PB(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const Zi=t=>t*180/Math.PI,gp=t=>{const e=Zi(Math.atan2(t[1],t[0]));return bp(e)},BB={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:gp,rotateZ:gp,skewX:t=>Zi(Math.atan(t[1])),skewY:t=>Zi(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},bp=t=>(t=t%360,t<0&&(t+=360),t),Iy=gp,Cy=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),jy=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),UB={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Cy,scaleY:jy,scale:t=>(Cy(t)+jy(t))/2,rotateX:t=>bp(Zi(Math.atan2(t[6],t[5]))),rotateY:t=>bp(Zi(Math.atan2(-t[2],t[0]))),rotateZ:Iy,rotate:Iy,skewX:t=>Zi(Math.atan(t[4])),skewY:t=>Zi(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function vp(t){return t.includes("scale")?1:0}function xp(t,e){if(!t||t==="none")return vp(e);const n=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let s,i;if(n)s=UB,i=n;else{const o=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);s=BB,i=o}if(!i)return vp(e);const r=s[e],a=i[1].split(",").map(GB);return typeof r=="function"?r(a):a[r]}const HB=(t,e)=>{const{transform:n="none"}=getComputedStyle(t);return xp(n,e)};function GB(t){return parseFloat(t.trim())}const oo=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],lo=new Set(oo),Oy=t=>t===ao||t===se,VB=new Set(["x","y","z"]),FB=oo.filter(t=>!VB.has(t));function zB(t){const e=[];return FB.forEach(n=>{const s=t.getValue(n);s!==void 0&&(e.push([n,s.get()]),s.set(n.startsWith("scale")?1:0))}),e}const ar={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>xp(e,"x"),y:(t,{transform:e})=>xp(e,"y")};ar.translateX=ar.x;ar.translateY=ar.y;const or=new Set;let yp=!1,_p=!1,wp=!1;function oT(){if(_p){const t=Array.from(or).filter(s=>s.needsMeasurement),e=new Set(t.map(s=>s.element)),n=new Map;e.forEach(s=>{const i=zB(s);i.length&&(n.set(s,i),s.render())}),t.forEach(s=>s.measureInitialState()),e.forEach(s=>{s.render();const i=n.get(s);i&&i.forEach(([r,a])=>{var o;(o=s.getValue(r))==null||o.set(a)})}),t.forEach(s=>s.measureEndState()),t.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}_p=!1,yp=!1,or.forEach(t=>t.complete(wp)),or.clear()}function lT(){or.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(_p=!0)})}function $B(){wp=!0,lT(),oT(),wp=!1}class tb{constructor(e,n,s,i,r,a=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=s,this.motionValue=i,this.element=r,this.isAsync=a}scheduleResolve(){this.state="scheduled",this.isAsync?(or.add(this),yp||(yp=!0,qe.read(lT),qe.resolveKeyframes(oT))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:s,motionValue:i}=this;if(e[0]===null){const r=i==null?void 0:i.get(),a=e[e.length-1];if(r!==void 0)e[0]=r;else if(s&&n){const o=s.readValue(n,a);o!=null&&(e[0]=o)}e[0]===void 0&&(e[0]=a),i&&r===void 0&&i.set(e[0])}PB(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),or.delete(this)}cancel(){this.state==="scheduled"&&(or.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const KB=t=>t.startsWith("--");function YB(t,e,n){KB(e)?t.style.setProperty(e,n):t.style[e]=n}const qB=F0(()=>window.ScrollTimeline!==void 0),WB={};function XB(t,e){const n=F0(t);return()=>WB[e]??n()}const cT=XB(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Io=([t,e,n,s])=>`cubic-bezier(${t}, ${e}, ${n}, ${s})`,My={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Io([0,.65,.55,1]),circOut:Io([.55,0,1,.45]),backIn:Io([.31,.01,.66,-.59]),backOut:Io([.33,1.53,.69,.99])};function uT(t,e){if(t)return typeof t=="function"?cT()?iT(t,e):"ease-out":YS(t)?Io(t):Array.isArray(t)?t.map(n=>uT(n,e)||My.easeOut):My[t]}function QB(t,e,n,{delay:s=0,duration:i=300,repeat:r=0,repeatType:a="loop",ease:o="easeOut",times:c}={},u=void 0){const d={[e]:n};c&&(d.offset=c);const f=uT(o,i);Array.isArray(f)&&(d.easing=f);const h={delay:s,duration:i,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:r+1,direction:a==="reverse"?"alternate":"normal"};return u&&(h.pseudoElement=u),t.animate(d,h)}function dT(t){return typeof t=="function"&&"applyToOptions"in t}function JB({type:t,...e}){return dT(t)&&cT()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class ZB extends Z0{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:n,name:s,keyframes:i,pseudoElement:r,allowFlatten:a=!1,finalKeyframe:o,onComplete:c}=e;this.isPseudoElement=!!r,this.allowFlatten=a,this.options=e,V0(typeof e.type!="string");const u=JB(e);this.animation=QB(n,s,i,u,r),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!r){const d=J0(i,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(d):YB(n,s,d),this.animation.cancel()}c==null||c(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,n;(n=(e=this.animation).finish)==null||n.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,n;this.isPseudoElement||(n=(e=this.animation).commitStyles)==null||n.call(e)}get duration(){var n,s;const e=((s=(n=this.animation.effect)==null?void 0:n.getComputedTiming)==null?void 0:s.call(n).duration)||0;return kn(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+kn(e)}get time(){return kn(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=ns(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:n}){var s;return this.allowFlatten&&((s=this.animation.effect)==null||s.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&qB()?(this.animation.timeline=e,In):n(this)}}const fT={anticipate:FS,backInOut:VS,circInOut:$S};function eU(t){return t in fT}function tU(t){typeof t.ease=="string"&&eU(t.ease)&&(t.ease=fT[t.ease])}const Dy=10;class nU extends ZB{constructor(e){tU(e),aT(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:n,onUpdate:s,onComplete:i,element:r,...a}=this.options;if(!n)return;if(e!==void 0){n.set(e);return}const o=new eb({...a,autoplay:!1}),c=ns(this.finishedTime??this.time);n.setWithVelocity(o.sample(c-Dy).value,o.sample(c).value,Dy),o.stop()}}const Ly=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Mi.test(t)||t==="0")&&!t.startsWith("url("));function sU(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function iU(t,e,n,s){const i=t[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const r=t[t.length-1],a=Ly(i,e),o=Ly(r,e);return!a||!o?!1:sU(t)||(n==="spring"||dT(n))&&s}function Ep(t){t.duration=0,t.type="keyframes"}const rU=new Set(["opacity","clipPath","filter","transform"]),aU=F0(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function oU(t){var d;const{motionValue:e,name:n,repeatDelay:s,repeatType:i,damping:r,type:a}=t;if(!(((d=e==null?void 0:e.owner)==null?void 0:d.current)instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:u}=e.owner.getProps();return aU()&&n&&rU.has(n)&&(n!=="transform"||!u)&&!c&&!s&&i!=="mirror"&&r!==0&&a!=="inertia"}const lU=40;class cU extends Z0{constructor({autoplay:e=!0,delay:n=0,type:s="keyframes",repeat:i=0,repeatDelay:r=0,repeatType:a="loop",keyframes:o,name:c,motionValue:u,element:d,...f}){var g;super(),this.stop=()=>{var v,x;this._animation&&(this._animation.stop(),(v=this.stopTimeline)==null||v.call(this)),(x=this.keyframeResolver)==null||x.cancel()},this.createdAt=Qt.now();const h={autoplay:e,delay:n,type:s,repeat:i,repeatDelay:r,repeatType:a,name:c,motionValue:u,element:d,...f},m=(d==null?void 0:d.KeyframeResolver)||tb;this.keyframeResolver=new m(o,(v,x,p)=>this.onKeyframesResolved(v,x,h,!p),c,u,d),(g=this.keyframeResolver)==null||g.scheduleResolve()}onKeyframesResolved(e,n,s,i){this.keyframeResolver=void 0;const{name:r,type:a,velocity:o,delay:c,isHandoff:u,onUpdate:d}=s;this.resolvedAt=Qt.now(),iU(e,r,a,o)||((Ps.instantAnimations||!c)&&(d==null||d(J0(e,s,n))),e[0]=e[e.length-1],Ep(s),s.repeat=0);const h={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>lU?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...s,keyframes:e},m=!u&&oU(h)?new nU({...h,element:h.motionValue.owner.current}):new eb(h);m.finished.then(()=>this.notifyFinished()).catch(In),this.pendingTimeline&&(this.stopTimeline=m.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=m}get finished(){return this._animation?this.animation.finished:this._finished}then(e,n){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),$B()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}const uU=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function dU(t){const e=uU.exec(t);if(!e)return[,];const[,n,s,i]=e;return[`--${n??s}`,i]}function hT(t,e,n=1){const[s,i]=dU(t);if(!s)return;const r=window.getComputedStyle(e).getPropertyValue(s);if(r){const a=r.trim();return MS(a)?parseFloat(a):a}return Y0(i)?hT(i,e,n+1):i}function nb(t,e){return(t==null?void 0:t[e])??(t==null?void 0:t.default)??t}const mT=new Set(["width","height","top","left","right","bottom",...oo]),fU={test:t=>t==="auto",parse:t=>t},pT=t=>e=>e.test(t),gT=[ao,se,ss,zs,sB,nB,fU],Py=t=>gT.find(pT(t));function hU(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||LS(t):!0}const mU=new Set(["brightness","contrast","saturate","opacity"]);function pU(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[s]=n.match(q0)||[];if(!s)return t;const i=n.replace(s,"");let r=mU.has(e)?1:0;return s!==n&&(r*=100),e+"("+r+i+")"}const gU=/\b([a-z-]*)\(.*?\)/gu,Np={...Mi,getAnimatableNone:t=>{const e=t.match(gU);return e?e.map(pU).join(" "):t}},By={...ao,transform:Math.round},bU={rotate:zs,rotateX:zs,rotateY:zs,rotateZ:zs,scale:Fc,scaleX:Fc,scaleY:Fc,scaleZ:Fc,skew:zs,skewX:zs,skewY:zs,distance:se,translateX:se,translateY:se,translateZ:se,x:se,y:se,z:se,perspective:se,transformPerspective:se,opacity:Ml,originX:ky,originY:ky,originZ:se},sb={borderWidth:se,borderTopWidth:se,borderRightWidth:se,borderBottomWidth:se,borderLeftWidth:se,borderRadius:se,radius:se,borderTopLeftRadius:se,borderTopRightRadius:se,borderBottomRightRadius:se,borderBottomLeftRadius:se,width:se,maxWidth:se,height:se,maxHeight:se,top:se,right:se,bottom:se,left:se,padding:se,paddingTop:se,paddingRight:se,paddingBottom:se,paddingLeft:se,margin:se,marginTop:se,marginRight:se,marginBottom:se,marginLeft:se,backgroundPositionX:se,backgroundPositionY:se,...bU,zIndex:By,fillOpacity:Ml,strokeOpacity:Ml,numOctaves:By},vU={...sb,color:rt,backgroundColor:rt,outlineColor:rt,fill:rt,stroke:rt,borderColor:rt,borderTopColor:rt,borderRightColor:rt,borderBottomColor:rt,borderLeftColor:rt,filter:Np,WebkitFilter:Np},bT=t=>vU[t];function vT(t,e){let n=bT(t);return n!==Np&&(n=Mi),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const xU=new Set(["auto","none","0"]);function yU(t,e,n){let s=0,i;for(;s<t.length&&!i;){const r=t[s];typeof r=="string"&&!xU.has(r)&&Dl(r).values.length&&(i=t[s]),s++}if(i&&n)for(const r of e)t[r]=vT(n,i)}class _U extends tb{constructor(e,n,s,i,r){super(e,n,s,i,r,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:s}=this;if(!n||!n.current)return;super.readKeyframes();for(let c=0;c<e.length;c++){let u=e[c];if(typeof u=="string"&&(u=u.trim(),Y0(u))){const d=hT(u,n.current);d!==void 0&&(e[c]=d),c===e.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!mT.has(s)||e.length!==2)return;const[i,r]=e,a=Py(i),o=Py(r);if(a!==o)if(Oy(a)&&Oy(o))for(let c=0;c<e.length;c++){const u=e[c];typeof u=="string"&&(e[c]=parseFloat(u))}else ar[s]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,s=[];for(let i=0;i<e.length;i++)(e[i]===null||hU(e[i]))&&s.push(i);s.length&&yU(e,s,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:s}=this;if(!e||!e.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=ar[s](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const i=n[n.length-1];i!==void 0&&e.getValue(s,i).jump(i,!1)}measureEndState(){var o;const{element:e,name:n,unresolvedKeyframes:s}=this;if(!e||!e.current)return;const i=e.getValue(n);i&&i.jump(this.measuredOrigin,!1);const r=s.length-1,a=s[r];s[r]=ar[n](e.measureViewportBox(),window.getComputedStyle(e.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),(o=this.removedTransforms)!=null&&o.length&&this.removedTransforms.forEach(([c,u])=>{e.getValue(c).set(u)}),this.resolveNoneKeyframes()}}function wU(t,e,n){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let s=document;const i=(n==null?void 0:n[t])??s.querySelectorAll(t);return i?Array.from(i):[]}return Array.from(t)}const xT=(t,e)=>e&&typeof t=="number"?e.transform(t):t;function yT(t){return DS(t)&&"offsetHeight"in t}const Uy=30,EU=t=>!isNaN(parseFloat(t));class NU{constructor(e,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=s=>{var r;const i=Qt.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&((r=this.events.change)==null||r.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=Qt.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=EU(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new z0);const s=this.events[e].add(n);return e==="change"?()=>{s(),qe.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,n,s){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-s}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Qt.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>Uy)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,Uy);return PS(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,n;(e=this.dependents)==null||e.clear(),(n=this.events.destroy)==null||n.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Ua(t,e){return new NU(t,e)}const{schedule:ib}=qS(queueMicrotask,!1),Ln={x:!1,y:!1};function _T(){return Ln.x||Ln.y}function kU(t){return t==="x"||t==="y"?Ln[t]?null:(Ln[t]=!0,()=>{Ln[t]=!1}):Ln.x||Ln.y?null:(Ln.x=Ln.y=!0,()=>{Ln.x=Ln.y=!1})}function wT(t,e){const n=wU(t),s=new AbortController,i={passive:!0,...e,signal:s.signal};return[n,i,()=>s.abort()]}function Hy(t){return!(t.pointerType==="touch"||_T())}function SU(t,e,n={}){const[s,i,r]=wT(t,n),a=o=>{if(!Hy(o))return;const{target:c}=o,u=e(c,o);if(typeof u!="function"||!c)return;const d=f=>{Hy(f)&&(u(f),c.removeEventListener("pointerleave",d))};c.addEventListener("pointerleave",d,i)};return s.forEach(o=>{o.addEventListener("pointerenter",a,i)}),r}const ET=(t,e)=>e?t===e?!0:ET(t,e.parentElement):!1,rb=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,TU=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function AU(t){return TU.has(t.tagName)||t.tabIndex!==-1}const pu=new WeakSet;function Gy(t){return e=>{e.key==="Enter"&&t(e)}}function Sh(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const RU=(t,e)=>{const n=t.currentTarget;if(!n)return;const s=Gy(()=>{if(pu.has(n))return;Sh(n,"down");const i=Gy(()=>{Sh(n,"up")}),r=()=>Sh(n,"cancel");n.addEventListener("keyup",i,e),n.addEventListener("blur",r,e)});n.addEventListener("keydown",s,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",s),e)};function Vy(t){return rb(t)&&!_T()}function IU(t,e,n={}){const[s,i,r]=wT(t,n),a=o=>{const c=o.currentTarget;if(!Vy(o))return;pu.add(c);const u=e(c,o),d=(m,g)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",h),pu.has(c)&&pu.delete(c),Vy(m)&&typeof u=="function"&&u(m,{success:g})},f=m=>{d(m,c===window||c===document||n.useGlobalTarget||ET(c,m.target))},h=m=>{d(m,!1)};window.addEventListener("pointerup",f,i),window.addEventListener("pointercancel",h,i)};return s.forEach(o=>{(n.useGlobalTarget?window:o).addEventListener("pointerdown",a,i),yT(o)&&(o.addEventListener("focus",u=>RU(u,i)),!AU(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),r}function NT(t){return DS(t)&&"ownerSVGElement"in t}function CU(t){return NT(t)&&t.tagName==="svg"}const Ot=t=>!!(t&&t.getVelocity),jU=[...gT,rt,Mi],OU=t=>jU.find(pT(t)),ab=_.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function Fy(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function MU(...t){return e=>{let n=!1;const s=t.map(i=>{const r=Fy(i,e);return!n&&typeof r=="function"&&(n=!0),r});if(n)return()=>{for(let i=0;i<s.length;i++){const r=s[i];typeof r=="function"?r():Fy(t[i],null)}}}}function DU(...t){return _.useCallback(MU(...t),t)}class LU extends _.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const s=n.offsetParent,i=yT(s)&&s.offsetWidth||0,r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft,r.right=i-r.width-r.left}return null}componentDidUpdate(){}render(){return this.props.children}}function PU({children:t,isPresent:e,anchorX:n,root:s}){const i=_.useId(),r=_.useRef(null),a=_.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=_.useContext(ab),c=DU(r,t==null?void 0:t.ref);return _.useInsertionEffect(()=>{const{width:u,height:d,top:f,left:h,right:m}=a.current;if(e||!r.current||!u||!d)return;const g=n==="left"?`left: ${h}`:`right: ${m}`;r.current.dataset.motionPopId=i;const v=document.createElement("style");o&&(v.nonce=o);const x=s??document.head;return x.appendChild(v),v.sheet&&v.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${u}px !important;
            height: ${d}px !important;
            ${g}px !important;
            top: ${f}px !important;
          }
        `),()=>{x.contains(v)&&x.removeChild(v)}},[e]),l.jsx(LU,{isPresent:e,childRef:r,sizeRef:a,children:_.cloneElement(t,{ref:c})})}const BU=({children:t,initial:e,isPresent:n,onExitComplete:s,custom:i,presenceAffectsLayout:r,mode:a,anchorX:o,root:c})=>{const u=B0(UU),d=_.useId();let f=!0,h=_.useMemo(()=>(f=!1,{id:d,initial:e,isPresent:n,custom:i,onExitComplete:m=>{u.set(m,!0);for(const g of u.values())if(!g)return;s&&s()},register:m=>(u.set(m,!1),()=>u.delete(m))}),[n,u,s]);return r&&f&&(h={...h}),_.useMemo(()=>{u.forEach((m,g)=>u.set(g,!1))},[n]),_.useEffect(()=>{!n&&!u.size&&s&&s()},[n]),a==="popLayout"&&(t=l.jsx(PU,{isPresent:n,anchorX:o,root:c,children:t})),l.jsx(xf.Provider,{value:h,children:t})};function UU(){return new Map}function kT(t=!0){const e=_.useContext(xf);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:s,register:i}=e,r=_.useId();_.useEffect(()=>{if(t)return i(r)},[t]);const a=_.useCallback(()=>t&&s&&s(r),[r,s,t]);return!n&&s?[!1,a]:[!0]}const zc=t=>t.key||"";function zy(t){const e=[];return _.Children.forEach(t,n=>{_.isValidElement(n)&&e.push(n)}),e}const Ei=({children:t,custom:e,initial:n=!0,onExitComplete:s,presenceAffectsLayout:i=!0,mode:r="sync",propagate:a=!1,anchorX:o="left",root:c})=>{const[u,d]=kT(a),f=_.useMemo(()=>zy(t),[t]),h=a&&!u?[]:f.map(zc),m=_.useRef(!0),g=_.useRef(f),v=B0(()=>new Map),[x,p]=_.useState(f),[b,y]=_.useState(f);OS(()=>{m.current=!1,g.current=f;for(let A=0;A<b.length;A++){const w=zc(b[A]);h.includes(w)?v.delete(w):v.get(w)!==!0&&v.set(w,!1)}},[b,h.length,h.join("-")]);const E=[];if(f!==x){let A=[...f];for(let w=0;w<b.length;w++){const T=b[w],k=zc(T);h.includes(k)||(A.splice(w,0,T),E.push(T))}return r==="wait"&&E.length&&(A=E),y(zy(A)),p(f),null}const{forceRender:N}=_.useContext(P0);return l.jsx(l.Fragment,{children:b.map(A=>{const w=zc(A),T=a&&!u?!1:f===b||h.includes(w),k=()=>{if(v.has(w))v.set(w,!0);else return;let R=!0;v.forEach(C=>{C||(R=!1)}),R&&(N==null||N(),y(g.current),a&&(d==null||d()),s&&s())};return l.jsx(BU,{isPresent:T,initial:!m.current||n?void 0:!1,custom:e,presenceAffectsLayout:i,mode:r,root:c,onExitComplete:T?void 0:k,anchorX:o,children:A},w)})})},ST=_.createContext({strict:!1}),$y={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Ha={};for(const t in $y)Ha[t]={isEnabled:e=>$y[t].some(n=>!!e[n])};function HU(t){for(const e in t)Ha[e]={...Ha[e],...t[e]}}const GU=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Nd(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||GU.has(t)}let TT=t=>!Nd(t);function VU(t){typeof t=="function"&&(TT=e=>e.startsWith("on")?!Nd(e):t(e))}try{VU(require("@emotion/is-prop-valid").default)}catch{}function FU(t,e,n){const s={};for(const i in t)i==="values"&&typeof t.values=="object"||(TT(i)||n===!0&&Nd(i)||!e&&!Nd(i)||t.draggable&&i.startsWith("onDrag"))&&(s[i]=t[i]);return s}const yf=_.createContext({});function _f(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function Ll(t){return typeof t=="string"||Array.isArray(t)}const ob=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],lb=["initial",...ob];function wf(t){return _f(t.animate)||lb.some(e=>Ll(t[e]))}function AT(t){return!!(wf(t)||t.variants)}function zU(t,e){if(wf(t)){const{initial:n,animate:s}=t;return{initial:n===!1||Ll(n)?n:void 0,animate:Ll(s)?s:void 0}}return t.inherit!==!1?e:{}}function $U(t){const{initial:e,animate:n}=zU(t,_.useContext(yf));return _.useMemo(()=>({initial:e,animate:n}),[Ky(e),Ky(n)])}function Ky(t){return Array.isArray(t)?t.join(" "):t}function Yy(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const _o={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(se.test(t))t=parseFloat(t);else return t;const n=Yy(t,e.target.x),s=Yy(t,e.target.y);return`${n}% ${s}%`}},KU={correct:(t,{treeScale:e,projectionDelta:n})=>{const s=t,i=Mi.parse(t);if(i.length>5)return s;const r=Mi.createTransformer(t),a=typeof i[0]!="number"?1:0,o=n.x.scale*e.x,c=n.y.scale*e.y;i[0+a]/=o,i[1+a]/=c;const u=Qe(o,c,.5);return typeof i[2+a]=="number"&&(i[2+a]/=u),typeof i[3+a]=="number"&&(i[3+a]/=u),r(i)}},kp={borderRadius:{..._o,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:_o,borderTopRightRadius:_o,borderBottomLeftRadius:_o,borderBottomRightRadius:_o,boxShadow:KU};function RT(t,{layout:e,layoutId:n}){return lo.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!kp[t]||t==="opacity")}const YU={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},qU=oo.length;function WU(t,e,n){let s="",i=!0;for(let r=0;r<qU;r++){const a=oo[r],o=t[a];if(o===void 0)continue;let c=!0;if(typeof o=="number"?c=o===(a.startsWith("scale")?1:0):c=parseFloat(o)===0,!c||n){const u=xT(o,sb[a]);if(!c){i=!1;const d=YU[a]||a;s+=`${d}(${u}) `}n&&(e[a]=u)}}return s=s.trim(),n?s=n(e,i?"":s):i&&(s="none"),s}function cb(t,e,n){const{style:s,vars:i,transformOrigin:r}=t;let a=!1,o=!1;for(const c in e){const u=e[c];if(lo.has(c)){a=!0;continue}else if(XS(c)){i[c]=u;continue}else{const d=xT(u,sb[c]);c.startsWith("origin")?(o=!0,r[c]=d):s[c]=d}}if(e.transform||(a||n?s.transform=WU(e,t.transform,n):s.transform&&(s.transform="none")),o){const{originX:c="50%",originY:u="50%",originZ:d=0}=r;s.transformOrigin=`${c} ${u} ${d}`}}const ub=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function IT(t,e,n){for(const s in e)!Ot(e[s])&&!RT(s,n)&&(t[s]=e[s])}function XU({transformTemplate:t},e){return _.useMemo(()=>{const n=ub();return cb(n,e,t),Object.assign({},n.vars,n.style)},[e])}function QU(t,e){const n=t.style||{},s={};return IT(s,n,t),Object.assign(s,XU(t,e)),s}function JU(t,e){const n={},s=QU(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=s,n}const ZU={offset:"stroke-dashoffset",array:"stroke-dasharray"},eH={offset:"strokeDashoffset",array:"strokeDasharray"};function tH(t,e,n=1,s=0,i=!0){t.pathLength=1;const r=i?ZU:eH;t[r.offset]=se.transform(-s);const a=se.transform(e),o=se.transform(n);t[r.array]=`${a} ${o}`}function CT(t,{attrX:e,attrY:n,attrScale:s,pathLength:i,pathSpacing:r=1,pathOffset:a=0,...o},c,u,d){if(cb(t,o,u),c){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:f,style:h}=t;f.transform&&(h.transform=f.transform,delete f.transform),(h.transform||f.transformOrigin)&&(h.transformOrigin=f.transformOrigin??"50% 50%",delete f.transformOrigin),h.transform&&(h.transformBox=(d==null?void 0:d.transformBox)??"fill-box",delete f.transformBox),e!==void 0&&(f.x=e),n!==void 0&&(f.y=n),s!==void 0&&(f.scale=s),i!==void 0&&tH(f,i,r,a,!1)}const jT=()=>({...ub(),attrs:{}}),OT=t=>typeof t=="string"&&t.toLowerCase()==="svg";function nH(t,e,n,s){const i=_.useMemo(()=>{const r=jT();return CT(r,e,OT(s),t.transformTemplate,t.style),{...r.attrs,style:{...r.style}}},[e]);if(t.style){const r={};IT(r,t.style,t),i.style={...r,...i.style}}return i}const sH=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function db(t){return typeof t!="string"||t.includes("-")?!1:!!(sH.indexOf(t)>-1||/[A-Z]/u.test(t))}function iH(t,e,n,{latestValues:s},i,r=!1){const o=(db(t)?nH:JU)(e,s,i,t),c=FU(e,typeof t=="string",r),u=t!==_.Fragment?{...c,...o,ref:n}:{},{children:d}=e,f=_.useMemo(()=>Ot(d)?d.get():d,[d]);return _.createElement(t,{...u,children:f})}function qy(t){const e=[{},{}];return t==null||t.values.forEach((n,s)=>{e[0][s]=n.get(),e[1][s]=n.getVelocity()}),e}function fb(t,e,n,s){if(typeof e=="function"){const[i,r]=qy(s);e=e(n!==void 0?n:t.custom,i,r)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[i,r]=qy(s);e=e(n!==void 0?n:t.custom,i,r)}return e}function gu(t){return Ot(t)?t.get():t}function rH({scrapeMotionValuesFromProps:t,createRenderState:e},n,s,i){return{latestValues:aH(n,s,i,t),renderState:e()}}function aH(t,e,n,s){const i={},r=s(t,{});for(const h in r)i[h]=gu(r[h]);let{initial:a,animate:o}=t;const c=wf(t),u=AT(t);e&&u&&!c&&t.inherit!==!1&&(a===void 0&&(a=e.initial),o===void 0&&(o=e.animate));let d=n?n.initial===!1:!1;d=d||a===!1;const f=d?o:a;if(f&&typeof f!="boolean"&&!_f(f)){const h=Array.isArray(f)?f:[f];for(let m=0;m<h.length;m++){const g=fb(t,h[m]);if(g){const{transitionEnd:v,transition:x,...p}=g;for(const b in p){let y=p[b];if(Array.isArray(y)){const E=d?y.length-1:0;y=y[E]}y!==null&&(i[b]=y)}for(const b in v)i[b]=v[b]}}}return i}const MT=t=>(e,n)=>{const s=_.useContext(yf),i=_.useContext(xf),r=()=>rH(t,e,s,i);return n?r():B0(r)};function hb(t,e,n){var r;const{style:s}=t,i={};for(const a in s)(Ot(s[a])||e.style&&Ot(e.style[a])||RT(a,t)||((r=n==null?void 0:n.getValue(a))==null?void 0:r.liveStyle)!==void 0)&&(i[a]=s[a]);return i}const oH=MT({scrapeMotionValuesFromProps:hb,createRenderState:ub});function DT(t,e,n){const s=hb(t,e,n);for(const i in t)if(Ot(t[i])||Ot(e[i])){const r=oo.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;s[r]=t[i]}return s}const lH=MT({scrapeMotionValuesFromProps:DT,createRenderState:jT}),cH=Symbol.for("motionComponentSymbol");function ea(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function uH(t,e,n){return _.useCallback(s=>{s&&t.onMount&&t.onMount(s),e&&(s?e.mount(s):e.unmount()),n&&(typeof n=="function"?n(s):ea(n)&&(n.current=s))},[e])}const mb=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),dH="framerAppearId",LT="data-"+mb(dH),PT=_.createContext({});function fH(t,e,n,s,i){var v,x;const{visualElement:r}=_.useContext(yf),a=_.useContext(ST),o=_.useContext(xf),c=_.useContext(ab).reducedMotion,u=_.useRef(null);s=s||a.renderer,!u.current&&s&&(u.current=s(t,{visualState:e,parent:r,props:n,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:c}));const d=u.current,f=_.useContext(PT);d&&!d.projection&&i&&(d.type==="html"||d.type==="svg")&&hH(u.current,n,i,f);const h=_.useRef(!1);_.useInsertionEffect(()=>{d&&h.current&&d.update(n,o)});const m=n[LT],g=_.useRef(!!m&&!((v=window.MotionHandoffIsComplete)!=null&&v.call(window,m))&&((x=window.MotionHasOptimisedAnimation)==null?void 0:x.call(window,m)));return OS(()=>{d&&(h.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),d.scheduleRenderMicrotask(),g.current&&d.animationState&&d.animationState.animateChanges())}),_.useEffect(()=>{d&&(!g.current&&d.animationState&&d.animationState.animateChanges(),g.current&&(queueMicrotask(()=>{var p;(p=window.MotionHandoffMarkAsComplete)==null||p.call(window,m)}),g.current=!1),d.enteringChildren=void 0)}),d}function hH(t,e,n,s){const{layoutId:i,layout:r,drag:a,dragConstraints:o,layoutScroll:c,layoutRoot:u,layoutCrossfade:d}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:BT(t.parent)),t.projection.setOptions({layoutId:i,layout:r,alwaysMeasureLayout:!!a||o&&ea(o),visualElement:t,animationType:typeof r=="string"?r:"both",initialPromotionConfig:s,crossfade:d,layoutScroll:c,layoutRoot:u})}function BT(t){if(t)return t.options.allowProjection!==!1?t.projection:BT(t.parent)}function Th(t,{forwardMotionProps:e=!1}={},n,s){n&&HU(n);const i=db(t)?lH:oH;function r(o,c){let u;const d={..._.useContext(ab),...o,layoutId:mH(o)},{isStatic:f}=d,h=$U(o),m=i(o,f);if(!f&&U0){pH();const g=gH(d);u=g.MeasureLayout,h.visualElement=fH(t,m,d,s,g.ProjectionNode)}return l.jsxs(yf.Provider,{value:h,children:[u&&h.visualElement?l.jsx(u,{visualElement:h.visualElement,...d}):null,iH(t,o,uH(m,h.visualElement,c),m,f,e)]})}r.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const a=_.forwardRef(r);return a[cH]=t,a}function mH({layoutId:t}){const e=_.useContext(P0).id;return e&&t!==void 0?e+"-"+t:t}function pH(t,e){_.useContext(ST).strict}function gH(t){const{drag:e,layout:n}=Ha;if(!e&&!n)return{};const s={...e,...n};return{MeasureLayout:e!=null&&e.isEnabled(t)||n!=null&&n.isEnabled(t)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}function bH(t,e){if(typeof Proxy>"u")return Th;const n=new Map,s=(r,a)=>Th(r,a,t,e),i=(r,a)=>s(r,a);return new Proxy(i,{get:(r,a)=>a==="create"?s:(n.has(a)||n.set(a,Th(a,void 0,t,e)),n.get(a))})}function UT({top:t,left:e,right:n,bottom:s}){return{x:{min:e,max:n},y:{min:t,max:s}}}function vH({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function xH(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),s=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:s.y,right:s.x}}function Ah(t){return t===void 0||t===1}function Sp({scale:t,scaleX:e,scaleY:n}){return!Ah(t)||!Ah(e)||!Ah(n)}function Wi(t){return Sp(t)||HT(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function HT(t){return Wy(t.x)||Wy(t.y)}function Wy(t){return t&&t!=="0%"}function kd(t,e,n){const s=t-n,i=e*s;return n+i}function Xy(t,e,n,s,i){return i!==void 0&&(t=kd(t,i,s)),kd(t,n,s)+e}function Tp(t,e=0,n=1,s,i){t.min=Xy(t.min,e,n,s,i),t.max=Xy(t.max,e,n,s,i)}function GT(t,{x:e,y:n}){Tp(t.x,e.translate,e.scale,e.originPoint),Tp(t.y,n.translate,n.scale,n.originPoint)}const Qy=.999999999999,Jy=1.0000000000001;function yH(t,e,n,s=!1){const i=n.length;if(!i)return;e.x=e.y=1;let r,a;for(let o=0;o<i;o++){r=n[o],a=r.projectionDelta;const{visualElement:c}=r.options;c&&c.props.style&&c.props.style.display==="contents"||(s&&r.options.layoutScroll&&r.scroll&&r!==r.root&&na(t,{x:-r.scroll.offset.x,y:-r.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,GT(t,a)),s&&Wi(r.latestValues)&&na(t,r.latestValues))}e.x<Jy&&e.x>Qy&&(e.x=1),e.y<Jy&&e.y>Qy&&(e.y=1)}function ta(t,e){t.min=t.min+e,t.max=t.max+e}function Zy(t,e,n,s,i=.5){const r=Qe(t.min,t.max,i);Tp(t,e,n,r,s)}function na(t,e){Zy(t.x,e.x,e.scaleX,e.scale,e.originX),Zy(t.y,e.y,e.scaleY,e.scale,e.originY)}function VT(t,e){return UT(xH(t.getBoundingClientRect(),e))}function _H(t,e,n){const s=VT(t,n),{scroll:i}=e;return i&&(ta(s.x,i.offset.x),ta(s.y,i.offset.y)),s}const e_=()=>({translate:0,scale:1,origin:0,originPoint:0}),sa=()=>({x:e_(),y:e_()}),t_=()=>({min:0,max:0}),ft=()=>({x:t_(),y:t_()}),Ap={current:null},FT={current:!1};function wH(){if(FT.current=!0,!!U0)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>Ap.current=t.matches;t.addEventListener("change",e),e()}else Ap.current=!1}const EH=new WeakMap;function NH(t,e,n){for(const s in e){const i=e[s],r=n[s];if(Ot(i))t.addValue(s,i);else if(Ot(r))t.addValue(s,Ua(i,{owner:t}));else if(r!==i)if(t.hasValue(s)){const a=t.getValue(s);a.liveStyle===!0?a.jump(i):a.hasAnimated||a.set(i)}else{const a=t.getStaticValue(s);t.addValue(s,Ua(a!==void 0?a:i,{owner:t}))}}for(const s in n)e[s]===void 0&&t.removeValue(s);return e}const n_=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class kH{scrapeMotionValuesFromProps(e,n,s){return{}}constructor({parent:e,props:n,presenceContext:s,reducedMotionConfig:i,blockInitialAnimation:r,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=tb,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=Qt.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,qe.render(this.render,!1,!0))};const{latestValues:c,renderState:u}=a;this.latestValues=c,this.baseTarget={...c},this.initialValues=n.initial?{...c}:{},this.renderState=u,this.parent=e,this.props=n,this.presenceContext=s,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=o,this.blockInitialAnimation=!!r,this.isControllingVariants=wf(n),this.isVariantNode=AT(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:d,...f}=this.scrapeMotionValuesFromProps(n,{},this);for(const h in f){const m=f[h];c[h]!==void 0&&Ot(m)&&m.set(c[h])}}mount(e){var n;this.current=e,EH.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((s,i)=>this.bindToMotionValue(i,s)),FT.current||wH(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Ap.current,(n=this.parent)==null||n.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),Oi(this.notifyUpdate),Oi(this.render),this.valueSubscriptions.forEach(n=>n()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(e=this.parent)==null||e.removeChild(this);for(const n in this.events)this.events[n].clear();for(const n in this.features){const s=this.features[n];s&&(s.unmount(),s.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const s=lo.has(e);s&&this.onBindTransform&&this.onBindTransform();const i=n.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&qe.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let r;window.MotionCheckAppearSync&&(r=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{i(),r&&r(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Ha){const n=Ha[e];if(!n)continue;const{isEnabled:s,Feature:i}=n;if(!this.features[e]&&i&&s(this.props)&&(this.features[e]=new i(this)),this.features[e]){const r=this.features[e];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ft()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let s=0;s<n_.length;s++){const i=n_[s];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const r="on"+i,a=e[r];a&&(this.propEventSubscriptions[i]=this.on(i,a))}this.prevMotionValues=NH(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const s=this.values.get(e);n!==s&&(s&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let s=this.values.get(e);return s===void 0&&n!==void 0&&(s=Ua(n===null?void 0:n,{owner:this}),this.addValue(e,s)),s}readValue(e,n){let s=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return s!=null&&(typeof s=="string"&&(MS(s)||LS(s))?s=parseFloat(s):!OU(s)&&Mi.test(n)&&(s=vT(e,n)),this.setBaseTarget(e,Ot(s)?s.get():s)),Ot(s)?s.get():s}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var r;const{initial:n}=this.props;let s;if(typeof n=="string"||typeof n=="object"){const a=fb(this.props,n,(r=this.presenceContext)==null?void 0:r.custom);a&&(s=a[e])}if(n&&s!==void 0)return s;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!Ot(i)?i:this.initialValues[e]!==void 0&&s===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new z0),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}scheduleRenderMicrotask(){ib.render(this.render)}}class zT extends kH{constructor(){super(...arguments),this.KeyframeResolver=_U}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:s}){delete n[e],delete s[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Ot(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function $T(t,{style:e,vars:n},s,i){const r=t.style;let a;for(a in e)r[a]=e[a];i==null||i.applyProjectionStyles(r,s);for(a in n)r.setProperty(a,n[a])}function SH(t){return window.getComputedStyle(t)}class TH extends zT{constructor(){super(...arguments),this.type="html",this.renderInstance=$T}readValueFromInstance(e,n){var s;if(lo.has(n))return(s=this.projection)!=null&&s.isProjecting?vp(n):HB(e,n);{const i=SH(e),r=(XS(n)?i.getPropertyValue(n):i[n])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:n}){return VT(e,n)}build(e,n,s){cb(e,n,s.transformTemplate)}scrapeMotionValuesFromProps(e,n,s){return hb(e,n,s)}}const KT=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function AH(t,e,n,s){$T(t,e,void 0,s);for(const i in e.attrs)t.setAttribute(KT.has(i)?i:mb(i),e.attrs[i])}class RH extends zT{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=ft}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(lo.has(n)){const s=bT(n);return s&&s.default||0}return n=KT.has(n)?n:mb(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,s){return DT(e,n,s)}build(e,n,s){CT(e,n,this.isSVGTag,s.transformTemplate,s.style)}renderInstance(e,n,s,i){AH(e,n,s,i)}mount(e){this.isSVGTag=OT(e.tagName),super.mount(e)}}const IH=(t,e)=>db(t)?new RH(e):new TH(e,{allowProjection:t!==_.Fragment});function ba(t,e,n){const s=t.getProps();return fb(s,e,n!==void 0?n:s.custom,t)}const Rp=t=>Array.isArray(t);function CH(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Ua(n))}function jH(t){return Rp(t)?t[t.length-1]||0:t}function OH(t,e){const n=ba(t,e);let{transitionEnd:s={},transition:i={},...r}=n||{};r={...r,...s};for(const a in r){const o=jH(r[a]);CH(t,a,o)}}function MH(t){return!!(Ot(t)&&t.add)}function Ip(t,e){const n=t.getValue("willChange");if(MH(n))return n.add(e);if(!n&&Ps.WillChange){const s=new Ps.WillChange("auto");t.addValue("willChange",s),s.add(e)}}function YT(t){return t.props[LT]}const DH=t=>t!==null;function LH(t,{repeat:e,repeatType:n="loop"},s){const i=t.filter(DH),r=e&&n!=="loop"&&e%2===1?0:i.length-1;return i[r]}const PH={type:"spring",stiffness:500,damping:25,restSpeed:10},BH=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),UH={type:"keyframes",duration:.8},HH={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},GH=(t,{keyframes:e})=>e.length>2?UH:lo.has(t)?t.startsWith("scale")?BH(e[1]):PH:HH;function VH({when:t,delay:e,delayChildren:n,staggerChildren:s,staggerDirection:i,repeat:r,repeatType:a,repeatDelay:o,from:c,elapsed:u,...d}){return!!Object.keys(d).length}const pb=(t,e,n,s={},i,r)=>a=>{const o=nb(s,t)||{},c=o.delay||s.delay||0;let{elapsed:u=0}=s;u=u-ns(c);const d={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...o,delay:-u,onUpdate:h=>{e.set(h),o.onUpdate&&o.onUpdate(h)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:t,motionValue:e,element:r?void 0:i};VH(o)||Object.assign(d,GH(t,d)),d.duration&&(d.duration=ns(d.duration)),d.repeatDelay&&(d.repeatDelay=ns(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let f=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(Ep(d),d.delay===0&&(f=!0)),(Ps.instantAnimations||Ps.skipAnimations)&&(f=!0,Ep(d),d.delay=0),d.allowFlatten=!o.type&&!o.ease,f&&!r&&e.get()!==void 0){const h=LH(d.keyframes,o);if(h!==void 0){qe.update(()=>{d.onUpdate(h),d.onComplete()});return}}return o.isSync?new eb(d):new cU(d)};function FH({protectedKeys:t,needsAnimating:e},n){const s=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,s}function qT(t,e,{delay:n=0,transitionOverride:s,type:i}={}){let{transition:r=t.getDefaultTransition(),transitionEnd:a,...o}=e;s&&(r=s);const c=[],u=i&&t.animationState&&t.animationState.getState()[i];for(const d in o){const f=t.getValue(d,t.latestValues[d]??null),h=o[d];if(h===void 0||u&&FH(u,d))continue;const m={delay:n,...nb(r||{},d)},g=f.get();if(g!==void 0&&!f.isAnimating&&!Array.isArray(h)&&h===g&&!m.velocity)continue;let v=!1;if(window.MotionHandoffAnimation){const p=YT(t);if(p){const b=window.MotionHandoffAnimation(p,d,qe);b!==null&&(m.startTime=b,v=!0)}}Ip(t,d),f.start(pb(d,f,h,t.shouldReduceMotion&&mT.has(d)?{type:!1}:m,t,v));const x=f.animation;x&&c.push(x)}return a&&Promise.all(c).then(()=>{qe.update(()=>{a&&OH(t,a)})}),c}function WT(t,e,n,s=0,i=1){const r=Array.from(t).sort((u,d)=>u.sortNodePosition(d)).indexOf(e),a=t.size,o=(a-1)*s;return typeof n=="function"?n(r,a):i===1?r*s:o-r*s}function Cp(t,e,n={}){var c;const s=ba(t,e,n.type==="exit"?(c=t.presenceContext)==null?void 0:c.custom:void 0);let{transition:i=t.getDefaultTransition()||{}}=s||{};n.transitionOverride&&(i=n.transitionOverride);const r=s?()=>Promise.all(qT(t,s,n)):()=>Promise.resolve(),a=t.variantChildren&&t.variantChildren.size?(u=0)=>{const{delayChildren:d=0,staggerChildren:f,staggerDirection:h}=i;return zH(t,e,u,d,f,h,n)}:()=>Promise.resolve(),{when:o}=i;if(o){const[u,d]=o==="beforeChildren"?[r,a]:[a,r];return u().then(()=>d())}else return Promise.all([r(),a(n.delay)])}function zH(t,e,n=0,s=0,i=0,r=1,a){const o=[];for(const c of t.variantChildren)c.notify("AnimationStart",e),o.push(Cp(c,e,{...a,delay:n+(typeof s=="function"?0:s)+WT(t.variantChildren,c,s,i,r)}).then(()=>c.notify("AnimationComplete",e)));return Promise.all(o)}function $H(t,e,n={}){t.notify("AnimationStart",e);let s;if(Array.isArray(e)){const i=e.map(r=>Cp(t,r,n));s=Promise.all(i)}else if(typeof e=="string")s=Cp(t,e,n);else{const i=typeof e=="function"?ba(t,e,n.custom):e;s=Promise.all(qT(t,i,n))}return s.then(()=>{t.notify("AnimationComplete",e)})}function XT(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let s=0;s<n;s++)if(e[s]!==t[s])return!1;return!0}const KH=lb.length;function QT(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?QT(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<KH;n++){const s=lb[n],i=t.props[s];(Ll(i)||i===!1)&&(e[s]=i)}return e}const YH=[...ob].reverse(),qH=ob.length;function WH(t){return e=>Promise.all(e.map(({animation:n,options:s})=>$H(t,n,s)))}function XH(t){let e=WH(t),n=s_(),s=!0;const i=c=>(u,d)=>{var h;const f=ba(t,d,c==="exit"?(h=t.presenceContext)==null?void 0:h.custom:void 0);if(f){const{transition:m,transitionEnd:g,...v}=f;u={...u,...v,...g}}return u};function r(c){e=c(t)}function a(c){const{props:u}=t,d=QT(t.parent)||{},f=[],h=new Set;let m={},g=1/0;for(let x=0;x<qH;x++){const p=YH[x],b=n[p],y=u[p]!==void 0?u[p]:d[p],E=Ll(y),N=p===c?b.isActive:null;N===!1&&(g=x);let A=y===d[p]&&y!==u[p]&&E;if(A&&s&&t.manuallyAnimateOnMount&&(A=!1),b.protectedKeys={...m},!b.isActive&&N===null||!y&&!b.prevProp||_f(y)||typeof y=="boolean")continue;const w=QH(b.prevProp,y);let T=w||p===c&&b.isActive&&!A&&E||x>g&&E,k=!1;const R=Array.isArray(y)?y:[y];let C=R.reduce(i(p),{});N===!1&&(C={});const{prevResolvedValues:B={}}=b,z={...B,...C},$=O=>{T=!0,h.has(O)&&(k=!0,h.delete(O)),b.needsAnimating[O]=!0;const j=t.getValue(O);j&&(j.liveStyle=!1)};for(const O in z){const j=C[O],I=B[O];if(m.hasOwnProperty(O))continue;let H=!1;Rp(j)&&Rp(I)?H=!XT(j,I):H=j!==I,H?j!=null?$(O):h.add(O):j!==void 0&&h.has(O)?$(O):b.protectedKeys[O]=!0}b.prevProp=y,b.prevResolvedValues=C,b.isActive&&(m={...m,...C}),s&&t.blockInitialAnimation&&(T=!1);const K=A&&w;T&&(!K||k)&&f.push(...R.map(O=>{const j={type:p};if(typeof O=="string"&&s&&!K&&t.manuallyAnimateOnMount&&t.parent){const{parent:I}=t,H=ba(I,O);if(I.enteringChildren&&H){const{delayChildren:X}=H.transition||{};j.delay=WT(I.enteringChildren,t,X)}}return{animation:O,options:j}}))}if(h.size){const x={};if(typeof u.initial!="boolean"){const p=ba(t,Array.isArray(u.initial)?u.initial[0]:u.initial);p&&p.transition&&(x.transition=p.transition)}h.forEach(p=>{const b=t.getBaseTarget(p),y=t.getValue(p);y&&(y.liveStyle=!0),x[p]=b??null}),f.push({animation:x})}let v=!!f.length;return s&&(u.initial===!1||u.initial===u.animate)&&!t.manuallyAnimateOnMount&&(v=!1),s=!1,v?e(f):Promise.resolve()}function o(c,u){var f;if(n[c].isActive===u)return Promise.resolve();(f=t.variantChildren)==null||f.forEach(h=>{var m;return(m=h.animationState)==null?void 0:m.setActive(c,u)}),n[c].isActive=u;const d=a(c);for(const h in n)n[h].protectedKeys={};return d}return{animateChanges:a,setActive:o,setAnimateFunction:r,getState:()=>n,reset:()=>{n=s_()}}}function QH(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!XT(e,t):!1}function Vi(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function s_(){return{animate:Vi(!0),whileInView:Vi(),whileHover:Vi(),whileTap:Vi(),whileDrag:Vi(),whileFocus:Vi(),exit:Vi()}}class Ui{constructor(e){this.isMounted=!1,this.node=e}update(){}}class JH extends Ui{constructor(e){super(e),e.animationState||(e.animationState=XH(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();_f(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let ZH=0;class e8 extends Ui{constructor(){super(...arguments),this.id=ZH++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===s)return;const i=this.node.animationState.setActive("exit",!e);n&&!e&&i.then(()=>{n(this.id)})}mount(){const{register:e,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const t8={animation:{Feature:JH},exit:{Feature:e8}};function Pl(t,e,n,s={passive:!0}){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n)}function pc(t){return{point:{x:t.pageX,y:t.pageY}}}const n8=t=>e=>rb(e)&&t(e,pc(e));function el(t,e,n,s){return Pl(t,e,n8(n),s)}const JT=1e-4,s8=1-JT,i8=1+JT,ZT=.01,r8=0-ZT,a8=0+ZT;function Ut(t){return t.max-t.min}function o8(t,e,n){return Math.abs(t-e)<=n}function i_(t,e,n,s=.5){t.origin=s,t.originPoint=Qe(e.min,e.max,t.origin),t.scale=Ut(n)/Ut(e),t.translate=Qe(n.min,n.max,t.origin)-t.originPoint,(t.scale>=s8&&t.scale<=i8||isNaN(t.scale))&&(t.scale=1),(t.translate>=r8&&t.translate<=a8||isNaN(t.translate))&&(t.translate=0)}function tl(t,e,n,s){i_(t.x,e.x,n.x,s?s.originX:void 0),i_(t.y,e.y,n.y,s?s.originY:void 0)}function r_(t,e,n){t.min=n.min+e.min,t.max=t.min+Ut(e)}function l8(t,e,n){r_(t.x,e.x,n.x),r_(t.y,e.y,n.y)}function a_(t,e,n){t.min=e.min-n.min,t.max=t.min+Ut(e)}function Sd(t,e,n){a_(t.x,e.x,n.x),a_(t.y,e.y,n.y)}function gn(t){return[t("x"),t("y")]}const eA=({current:t})=>t?t.ownerDocument.defaultView:null,o_=(t,e)=>Math.abs(t-e);function c8(t,e){const n=o_(t.x,e.x),s=o_(t.y,e.y);return Math.sqrt(n**2+s**2)}class tA{constructor(e,n,{transformPagePoint:s,contextWindow:i=window,dragSnapToOrigin:r=!1,distanceThreshold:a=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=Ih(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,g=c8(h.offset,{x:0,y:0})>=this.distanceThreshold;if(!m&&!g)return;const{point:v}=h,{timestamp:x}=kt;this.history.push({...v,timestamp:x});const{onStart:p,onMove:b}=this.handlers;m||(p&&p(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),b&&b(this.lastMoveEvent,h)},this.handlePointerMove=(h,m)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=Rh(m,this.transformPagePoint),qe.update(this.updatePoint,!0)},this.handlePointerUp=(h,m)=>{this.end();const{onEnd:g,onSessionEnd:v,resumeAnimation:x}=this.handlers;if(this.dragSnapToOrigin&&x&&x(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const p=Ih(h.type==="pointercancel"?this.lastMoveEventInfo:Rh(m,this.transformPagePoint),this.history);this.startEvent&&g&&g(h,p),v&&v(h,p)},!rb(e))return;this.dragSnapToOrigin=r,this.handlers=n,this.transformPagePoint=s,this.distanceThreshold=a,this.contextWindow=i||window;const o=pc(e),c=Rh(o,this.transformPagePoint),{point:u}=c,{timestamp:d}=kt;this.history=[{...u,timestamp:d}];const{onSessionStart:f}=n;f&&f(e,Ih(c,this.history)),this.removeListeners=fc(el(this.contextWindow,"pointermove",this.handlePointerMove),el(this.contextWindow,"pointerup",this.handlePointerUp),el(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Oi(this.updatePoint)}}function Rh(t,e){return e?{point:e(t.point)}:t}function l_(t,e){return{x:t.x-e.x,y:t.y-e.y}}function Ih({point:t},e){return{point:t,delta:l_(t,nA(e)),offset:l_(t,u8(e)),velocity:d8(e,.1)}}function u8(t){return t[0]}function nA(t){return t[t.length-1]}function d8(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,s=null;const i=nA(t);for(;n>=0&&(s=t[n],!(i.timestamp-s.timestamp>ns(e)));)n--;if(!s)return{x:0,y:0};const r=kn(i.timestamp-s.timestamp);if(r===0)return{x:0,y:0};const a={x:(i.x-s.x)/r,y:(i.y-s.y)/r};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function f8(t,{min:e,max:n},s){return e!==void 0&&t<e?t=s?Qe(e,t,s.min):Math.max(t,e):n!==void 0&&t>n&&(t=s?Qe(n,t,s.max):Math.min(t,n)),t}function c_(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function h8(t,{top:e,left:n,bottom:s,right:i}){return{x:c_(t.x,n,i),y:c_(t.y,e,s)}}function u_(t,e){let n=e.min-t.min,s=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,s]=[s,n]),{min:n,max:s}}function m8(t,e){return{x:u_(t.x,e.x),y:u_(t.y,e.y)}}function p8(t,e){let n=.5;const s=Ut(t),i=Ut(e);return i>s?n=Ol(e.min,e.max-s,t.min):s>i&&(n=Ol(t.min,t.max-i,e.min)),Ls(0,1,n)}function g8(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const jp=.35;function b8(t=jp){return t===!1?t=0:t===!0&&(t=jp),{x:d_(t,"left","right"),y:d_(t,"top","bottom")}}function d_(t,e,n){return{min:f_(t,e),max:f_(t,n)}}function f_(t,e){return typeof t=="number"?t:t[e]||0}const v8=new WeakMap;class x8{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ft(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:n=!1,distanceThreshold:s}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const r=f=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(pc(f).point)},a=(f,h)=>{const{drag:m,dragPropagation:g,onDragStart:v}=this.getProps();if(m&&!g&&(this.openDragLock&&this.openDragLock(),this.openDragLock=kU(m),!this.openDragLock))return;this.latestPointerEvent=f,this.latestPanInfo=h,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),gn(p=>{let b=this.getAxisMotionValue(p).get()||0;if(ss.test(b)){const{projection:y}=this.visualElement;if(y&&y.layout){const E=y.layout.layoutBox[p];E&&(b=Ut(E)*(parseFloat(b)/100))}}this.originPoint[p]=b}),v&&qe.postRender(()=>v(f,h)),Ip(this.visualElement,"transform");const{animationState:x}=this.visualElement;x&&x.setActive("whileDrag",!0)},o=(f,h)=>{this.latestPointerEvent=f,this.latestPanInfo=h;const{dragPropagation:m,dragDirectionLock:g,onDirectionLock:v,onDrag:x}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:p}=h;if(g&&this.currentDirection===null){this.currentDirection=y8(p),this.currentDirection!==null&&v&&v(this.currentDirection);return}this.updateAxis("x",h.point,p),this.updateAxis("y",h.point,p),this.visualElement.render(),x&&x(f,h)},c=(f,h)=>{this.latestPointerEvent=f,this.latestPanInfo=h,this.stop(f,h),this.latestPointerEvent=null,this.latestPanInfo=null},u=()=>gn(f=>{var h;return this.getAnimationState(f)==="paused"&&((h=this.getAxisMotionValue(f).animation)==null?void 0:h.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new tA(e,{onSessionStart:r,onStart:a,onMove:o,onSessionEnd:c,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,distanceThreshold:s,contextWindow:eA(this.visualElement)})}stop(e,n){const s=e||this.latestPointerEvent,i=n||this.latestPanInfo,r=this.isDragging;if(this.cancel(),!r||!i||!s)return;const{velocity:a}=i;this.startAnimation(a);const{onDragEnd:o}=this.getProps();o&&qe.postRender(()=>o(s,i))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,s){const{drag:i}=this.getProps();if(!s||!$c(e,i,this.currentDirection))return;const r=this.getAxisMotionValue(e);let a=this.originPoint[e]+s[e];this.constraints&&this.constraints[e]&&(a=f8(a,this.constraints[e],this.elastic[e])),r.set(a)}resolveConstraints(){var r;const{dragConstraints:e,dragElastic:n}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(r=this.visualElement.projection)==null?void 0:r.layout,i=this.constraints;e&&ea(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&s?this.constraints=h8(s.layoutBox,e):this.constraints=!1,this.elastic=b8(n),i!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&gn(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=g8(s.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!ea(e))return!1;const s=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const r=_H(s,i.root,this.visualElement.getTransformPagePoint());let a=m8(i.layout.layoutBox,r);if(n){const o=n(vH(a));this.hasMutatedConstraints=!!o,o&&(a=UT(o))}return a}startAnimation(e){const{drag:n,dragMomentum:s,dragElastic:i,dragTransition:r,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),c=this.constraints||{},u=gn(d=>{if(!$c(d,n,this.currentDirection))return;let f=c&&c[d]||{};a&&(f={min:0,max:0});const h=i?200:1e6,m=i?40:1e7,g={type:"inertia",velocity:s?e[d]:0,bounceStiffness:h,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...r,...f};return this.startAxisValueAnimation(d,g)});return Promise.all(u).then(o)}startAxisValueAnimation(e,n){const s=this.getAxisMotionValue(e);return Ip(this.visualElement,e),s.start(pb(e,s,0,n,this.visualElement,!1))}stopAnimation(){gn(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){gn(e=>{var n;return(n=this.getAxisMotionValue(e).animation)==null?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)==null?void 0:n.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,s=this.visualElement.getProps(),i=s[n];return i||this.visualElement.getValue(e,(s.initial?s.initial[e]:void 0)||0)}snapToCursor(e){gn(n=>{const{drag:s}=this.getProps();if(!$c(n,s,this.currentDirection))return;const{projection:i}=this.visualElement,r=this.getAxisMotionValue(n);if(i&&i.layout){const{min:a,max:o}=i.layout.layoutBox[n];r.set(e[n]-Qe(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:s}=this.visualElement;if(!ea(n)||!s||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};gn(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const c=o.get();i[a]=p8({min:c,max:c},this.constraints[a])}});const{transformTemplate:r}=this.visualElement.getProps();this.visualElement.current.style.transform=r?r({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),gn(a=>{if(!$c(a,e,null))return;const o=this.getAxisMotionValue(a),{min:c,max:u}=this.constraints[a];o.set(Qe(c,u,i[a]))})}addListeners(){if(!this.visualElement.current)return;v8.set(this.visualElement,this);const e=this.visualElement.current,n=el(e,"pointerdown",c=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(c)}),s=()=>{const{dragConstraints:c}=this.getProps();ea(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,r=i.addEventListener("measure",s);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),qe.read(s);const a=Pl(window,"resize",()=>this.scalePositionWithinConstraints()),o=i.addEventListener("didUpdate",({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&(gn(d=>{const f=this.getAxisMotionValue(d);f&&(this.originPoint[d]+=c[d].translate,f.set(f.get()+c[d].translate))}),this.visualElement.render())});return()=>{a(),n(),r(),o&&o()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:s=!1,dragPropagation:i=!1,dragConstraints:r=!1,dragElastic:a=jp,dragMomentum:o=!0}=e;return{...e,drag:n,dragDirectionLock:s,dragPropagation:i,dragConstraints:r,dragElastic:a,dragMomentum:o}}}function $c(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function y8(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class _8 extends Ui{constructor(e){super(e),this.removeGroupControls=In,this.removeListeners=In,this.controls=new x8(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||In}unmount(){this.removeGroupControls(),this.removeListeners()}}const h_=t=>(e,n)=>{t&&qe.postRender(()=>t(e,n))};class w8 extends Ui{constructor(){super(...arguments),this.removePointerDownListener=In}onPointerDown(e){this.session=new tA(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:eA(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:s,onPanEnd:i}=this.node.getProps();return{onSessionStart:h_(e),onStart:h_(n),onMove:s,onEnd:(r,a)=>{delete this.session,i&&qe.postRender(()=>i(r,a))}}}mount(){this.removePointerDownListener=el(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const bu={hasAnimatedSinceResize:!0,hasEverUpdated:!1};let Ch=!1;class E8 extends _.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:s,layoutId:i}=this.props,{projection:r}=e;r&&(n.group&&n.group.add(r),s&&s.register&&i&&s.register(r),Ch&&r.root.didUpdate(),r.addEventListener("animationComplete",()=>{this.safeToRemove()}),r.setOptions({...r.options,onExitComplete:()=>this.safeToRemove()})),bu.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:s,drag:i,isPresent:r}=this.props,{projection:a}=s;return a&&(a.isPresent=r,Ch=!0,i||e.layoutDependency!==n||n===void 0||e.isPresent!==r?a.willUpdate():this.safeToRemove(),e.isPresent!==r&&(r?a.promote():a.relegate()||qe.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),ib.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:s}=this.props,{projection:i}=e;Ch=!0,i&&(i.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(i),s&&s.deregister&&s.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function sA(t){const[e,n]=kT(),s=_.useContext(P0);return l.jsx(E8,{...t,layoutGroup:s,switchLayoutGroup:_.useContext(PT),isPresent:e,safeToRemove:n})}function N8(t,e,n){const s=Ot(t)?t:Ua(t);return s.start(pb("",s,e,n)),s.animation}const k8=(t,e)=>t.depth-e.depth;class S8{constructor(){this.children=[],this.isDirty=!1}add(e){H0(this.children,e),this.isDirty=!0}remove(e){G0(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(k8),this.isDirty=!1,this.children.forEach(e)}}function T8(t,e){const n=Qt.now(),s=({timestamp:i})=>{const r=i-n;r>=e&&(Oi(s),t(r-e))};return qe.setup(s,!0),()=>Oi(s)}const iA=["TopLeft","TopRight","BottomLeft","BottomRight"],A8=iA.length,m_=t=>typeof t=="string"?parseFloat(t):t,p_=t=>typeof t=="number"||se.test(t);function R8(t,e,n,s,i,r){i?(t.opacity=Qe(0,n.opacity??1,I8(s)),t.opacityExit=Qe(e.opacity??1,0,C8(s))):r&&(t.opacity=Qe(e.opacity??1,n.opacity??1,s));for(let a=0;a<A8;a++){const o=`border${iA[a]}Radius`;let c=g_(e,o),u=g_(n,o);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||p_(c)===p_(u)?(t[o]=Math.max(Qe(m_(c),m_(u),s),0),(ss.test(u)||ss.test(c))&&(t[o]+="%")):t[o]=u}(e.rotate||n.rotate)&&(t.rotate=Qe(e.rotate||0,n.rotate||0,s))}function g_(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const I8=rA(0,.5,zS),C8=rA(.5,.95,In);function rA(t,e,n){return s=>s<t?0:s>e?1:n(Ol(t,e,s))}function b_(t,e){t.min=e.min,t.max=e.max}function Dn(t,e){b_(t.x,e.x),b_(t.y,e.y)}function v_(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function x_(t,e,n,s,i){return t-=e,t=kd(t,1/n,s),i!==void 0&&(t=kd(t,1/i,s)),t}function j8(t,e=0,n=1,s=.5,i,r=t,a=t){if(ss.test(e)&&(e=parseFloat(e),e=Qe(a.min,a.max,e/100)-a.min),typeof e!="number")return;let o=Qe(r.min,r.max,s);t===r&&(o-=e),t.min=x_(t.min,e,n,o,i),t.max=x_(t.max,e,n,o,i)}function y_(t,e,[n,s,i],r,a){j8(t,e[n],e[s],e[i],e.scale,r,a)}const O8=["x","scaleX","originX"],M8=["y","scaleY","originY"];function __(t,e,n,s){y_(t.x,e,O8,n?n.x:void 0,s?s.x:void 0),y_(t.y,e,M8,n?n.y:void 0,s?s.y:void 0)}function w_(t){return t.translate===0&&t.scale===1}function aA(t){return w_(t.x)&&w_(t.y)}function E_(t,e){return t.min===e.min&&t.max===e.max}function D8(t,e){return E_(t.x,e.x)&&E_(t.y,e.y)}function N_(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function oA(t,e){return N_(t.x,e.x)&&N_(t.y,e.y)}function k_(t){return Ut(t.x)/Ut(t.y)}function S_(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class L8{constructor(){this.members=[]}add(e){H0(this.members,e),e.scheduleRender()}remove(e){if(G0(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(i=>e===i);if(n===0)return!1;let s;for(let i=n;i>=0;i--){const r=this.members[i];if(r.isPresent!==!1){s=r;break}}return s?(this.promote(s),!0):!1}promote(e,n){const s=this.lead;if(e!==s&&(this.prevLead=s,this.lead=e,e.show(),s)){s.instance&&s.scheduleRender(),e.scheduleRender(),e.resumeFrom=s,n&&(e.resumeFrom.preserveOpacity=!0),s.snapshot&&(e.snapshot=s.snapshot,e.snapshot.latestValues=s.animationValues||s.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:s}=e;n.onExitComplete&&n.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function P8(t,e,n){let s="";const i=t.x.translate/e.x,r=t.y.translate/e.y,a=(n==null?void 0:n.z)||0;if((i||r||a)&&(s=`translate3d(${i}px, ${r}px, ${a}px) `),(e.x!==1||e.y!==1)&&(s+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:u,rotate:d,rotateX:f,rotateY:h,skewX:m,skewY:g}=n;u&&(s=`perspective(${u}px) ${s}`),d&&(s+=`rotate(${d}deg) `),f&&(s+=`rotateX(${f}deg) `),h&&(s+=`rotateY(${h}deg) `),m&&(s+=`skewX(${m}deg) `),g&&(s+=`skewY(${g}deg) `)}const o=t.x.scale*e.x,c=t.y.scale*e.y;return(o!==1||c!==1)&&(s+=`scale(${o}, ${c})`),s||"none"}const jh=["","X","Y","Z"],B8=1e3;let U8=0;function Oh(t,e,n,s){const{latestValues:i}=e;i[t]&&(n[t]=i[t],e.setStaticValue(t,0),s&&(s[t]=0))}function lA(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=YT(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:i,layoutId:r}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",qe,!(i||r))}const{parent:s}=t;s&&!s.hasCheckedOptimisedAppear&&lA(s)}function cA({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:s,resetTransform:i}){return class{constructor(a={},o=e==null?void 0:e()){this.id=U8++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(V8),this.nodes.forEach(K8),this.nodes.forEach(Y8),this.nodes.forEach(F8)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new S8)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new z0),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const c=this.eventHandlers.get(a);c&&c.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a){if(this.instance)return;this.isSVG=NT(a)&&!CU(a),this.instance=a;const{layoutId:o,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||o)&&(this.isLayoutDirty=!0),t){let d,f=0;const h=()=>this.root.updateBlockedByResize=!1;qe.read(()=>{f=window.innerWidth}),t(a,()=>{const m=window.innerWidth;m!==f&&(f=m,this.root.updateBlockedByResize=!0,d&&d(),d=T8(h,250),bu.hasAnimatedSinceResize&&(bu.hasAnimatedSinceResize=!1,this.nodes.forEach(R_)))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&u&&(o||c)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:f,hasRelativeLayoutChanged:h,layout:m})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const g=this.options.transition||u.getDefaultTransition()||J8,{onLayoutAnimationStart:v,onLayoutAnimationComplete:x}=u.getProps(),p=!this.targetLayout||!oA(this.targetLayout,m),b=!f&&h;if(this.options.layoutRoot||this.resumeFrom||b||f&&(p||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const y={...nb(g,"layout"),onPlay:v,onComplete:x};(u.shouldReduceMotion||this.options.layoutRoot)&&(y.delay=0,y.type=!1),this.startAnimation(y),this.setAnimationOrigin(d,b)}else f||R_(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=m})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Oi(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(q8),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&lA(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const f=this.path[d];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:o,layout:c}=this.options;if(o===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(T_);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(A_);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach($8),this.nodes.forEach(H8),this.nodes.forEach(G8)):this.nodes.forEach(A_),this.clearAllSnapshots();const o=Qt.now();kt.delta=Ls(0,1e3/60,o-kt.timestamp),kt.timestamp=o,kt.isProcessing=!0,_h.update.process(kt),_h.preRender.process(kt),_h.render.process(kt),kt.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,ib.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(z8),this.sharedNodes.forEach(W8)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,qe.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){qe.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Ut(this.snapshot.measuredBox.x)&&!Ut(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=ft(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o&&this.instance){const c=s(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:c,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!i)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!aA(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;a&&this.instance&&(o||Wi(this.latestValues)||d)&&(i(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let c=this.removeElementScroll(o);return a&&(c=this.removeTransform(c)),Z8(c),{animationId:this.root.animationId,measuredBox:o,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var u;const{visualElement:a}=this.options;if(!a)return ft();const o=a.measureViewportBox();if(!(((u=this.scroll)==null?void 0:u.wasRoot)||this.path.some(eG))){const{scroll:d}=this.root;d&&(ta(o.x,d.offset.x),ta(o.y,d.offset.y))}return o}removeElementScroll(a){var c;const o=ft();if(Dn(o,a),(c=this.scroll)!=null&&c.wasRoot)return o;for(let u=0;u<this.path.length;u++){const d=this.path[u],{scroll:f,options:h}=d;d!==this.root&&f&&h.layoutScroll&&(f.wasRoot&&Dn(o,a),ta(o.x,f.offset.x),ta(o.y,f.offset.y))}return o}applyTransform(a,o=!1){const c=ft();Dn(c,a);for(let u=0;u<this.path.length;u++){const d=this.path[u];!o&&d.options.layoutScroll&&d.scroll&&d!==d.root&&na(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),Wi(d.latestValues)&&na(c,d.latestValues)}return Wi(this.latestValues)&&na(c,this.latestValues),c}removeTransform(a){const o=ft();Dn(o,a);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!Wi(u.latestValues))continue;Sp(u.latestValues)&&u.updateSnapshot();const d=ft(),f=u.measurePageBox();Dn(d,f),__(o,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return Wi(this.latestValues)&&__(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==kt.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var m;const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==o;if(!(a||c&&this.isSharedProjectionDirty||this.isProjectionDirty||(m=this.parent)!=null&&m.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:f}=this.options;if(!this.layout||!(d||f))return;this.resolvedRelativeTargetAt=kt.timestamp;const h=this.getClosestProjectingParent();h&&this.linkedParentVersion!==h.layoutVersion&&!h.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(h&&h.layout?this.createRelativeTarget(h,this.layout.layoutBox,h.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=ft(),this.targetWithTransforms=ft()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),l8(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Dn(this.target,this.layout.layoutBox),GT(this.target,this.targetDelta)):Dn(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,h&&!!h.resumingFrom==!!this.resumingFrom&&!h.options.layoutScroll&&h.target&&this.animationProgress!==1?this.createRelativeTarget(h,this.target,h.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||Sp(this.parent.latestValues)||HT(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(a,o,c){this.relativeParent=a,this.linkedParentVersion=a.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ft(),this.relativeTargetOrigin=ft(),Sd(this.relativeTargetOrigin,o,c),Dn(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){var g;const a=this.getLead(),o=!!this.resumingFrom||this!==a;let c=!0;if((this.isProjectionDirty||(g=this.parent)!=null&&g.isProjectionDirty)&&(c=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===kt.timestamp&&(c=!1),c)return;const{layout:u,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||d))return;Dn(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,h=this.treeScale.y;yH(this.layoutCorrected,this.treeScale,this.path,o),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=ft());const{target:m}=a;if(!m){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(v_(this.prevProjectionDelta.x,this.projectionDelta.x),v_(this.prevProjectionDelta.y,this.projectionDelta.y)),tl(this.projectionDelta,this.layoutCorrected,m,this.latestValues),(this.treeScale.x!==f||this.treeScale.y!==h||!S_(this.projectionDelta.x,this.prevProjectionDelta.x)||!S_(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",m))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var o;if((o=this.options.visualElement)==null||o.scheduleRender(),a){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=sa(),this.projectionDelta=sa(),this.projectionDeltaWithTransform=sa()}setAnimationOrigin(a,o=!1){const c=this.snapshot,u=c?c.latestValues:{},d={...this.latestValues},f=sa();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const h=ft(),m=c?c.source:void 0,g=this.layout?this.layout.source:void 0,v=m!==g,x=this.getStack(),p=!x||x.members.length<=1,b=!!(v&&!p&&this.options.crossfade===!0&&!this.path.some(Q8));this.animationProgress=0;let y;this.mixTargetDelta=E=>{const N=E/1e3;I_(f.x,a.x,N),I_(f.y,a.y,N),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Sd(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),X8(this.relativeTarget,this.relativeTargetOrigin,h,N),y&&D8(this.relativeTarget,y)&&(this.isProjectionDirty=!1),y||(y=ft()),Dn(y,this.relativeTarget)),v&&(this.animationValues=d,R8(d,u,this.latestValues,N,b,p)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=N},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){var o,c,u;this.notifyListeners("animationStart"),(o=this.currentAnimation)==null||o.stop(),(u=(c=this.resumingFrom)==null?void 0:c.currentAnimation)==null||u.stop(),this.pendingAnimation&&(Oi(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=qe.update(()=>{bu.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Ua(0)),this.currentAnimation=N8(this.motionValue,[0,1e3],{...a,velocity:0,isSync:!0,onUpdate:d=>{this.mixTargetDelta(d),a.onUpdate&&a.onUpdate(d)},onStop:()=>{},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(B8),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:c,layout:u,latestValues:d}=a;if(!(!o||!c||!u)){if(this!==a&&this.layout&&u&&uA(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||ft();const f=Ut(this.layout.layoutBox.x);c.x.min=a.target.x.min,c.x.max=c.x.min+f;const h=Ut(this.layout.layoutBox.y);c.y.min=a.target.y.min,c.y.max=c.y.min+h}Dn(o,c),na(o,d),tl(this.projectionDeltaWithTransform,this.layoutCorrected,o,d)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new L8),this.sharedNodes.get(a).add(o);const u=o.options.initialPromotionConfig;o.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())==null?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())==null?void 0:o.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:c}=a;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(o=!0),!o)return;const u={};c.z&&Oh("z",a,u,this.animationValues);for(let d=0;d<jh.length;d++)Oh(`rotate${jh[d]}`,a,u,this.animationValues),Oh(`skew${jh[d]}`,a,u,this.animationValues);a.render();for(const d in u)a.setStaticValue(d,u[d]),this.animationValues&&(this.animationValues[d]=u[d]);a.scheduleRender()}applyProjectionStyles(a,o){if(!this.instance||this.isSVG)return;if(!this.isVisible){a.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,a.visibility="",a.opacity="",a.pointerEvents=gu(o==null?void 0:o.pointerEvents)||"",a.transform=c?c(this.latestValues,""):"none";return}const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){this.options.layoutId&&(a.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,a.pointerEvents=gu(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!Wi(this.latestValues)&&(a.transform=c?c({},""):"none",this.hasProjected=!1);return}a.visibility="";const d=u.animationValues||u.latestValues;this.applyTransformsToTarget();let f=P8(this.projectionDeltaWithTransform,this.treeScale,d);c&&(f=c(d,f)),a.transform=f;const{x:h,y:m}=this.projectionDelta;a.transformOrigin=`${h.origin*100}% ${m.origin*100}% 0`,u.animationValues?a.opacity=u===this?d.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:a.opacity=u===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const g in kp){if(d[g]===void 0)continue;const{correct:v,applyTo:x,isCSSVariable:p}=kp[g],b=f==="none"?d[g]:v(d[g],u);if(x){const y=x.length;for(let E=0;E<y;E++)a[x[E]]=b}else p?this.options.visualElement.renderState.vars[g]=b:a[g]=b}this.options.layoutId&&(a.pointerEvents=u===this?gu(o==null?void 0:o.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)==null?void 0:o.stop()}),this.root.nodes.forEach(T_),this.root.sharedNodes.clear()}}}function H8(t){t.updateLayout()}function G8(t){var n;const e=((n=t.resumeFrom)==null?void 0:n.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:i}=t.layout,{animationType:r}=t.options,a=e.source!==t.layout.source;r==="size"?gn(f=>{const h=a?e.measuredBox[f]:e.layoutBox[f],m=Ut(h);h.min=s[f].min,h.max=h.min+m}):uA(r,e.layoutBox,s)&&gn(f=>{const h=a?e.measuredBox[f]:e.layoutBox[f],m=Ut(s[f]);h.max=h.min+m,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[f].max=t.relativeTarget[f].min+m)});const o=sa();tl(o,s,e.layoutBox);const c=sa();a?tl(c,t.applyTransform(i,!0),e.measuredBox):tl(c,s,e.layoutBox);const u=!aA(o);let d=!1;if(!t.resumeFrom){const f=t.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:h,layout:m}=f;if(h&&m){const g=ft();Sd(g,e.layoutBox,h.layoutBox);const v=ft();Sd(v,s,m.layoutBox),oA(g,v)||(d=!0),f.options.layoutRoot&&(t.relativeTarget=v,t.relativeTargetOrigin=g,t.relativeParent=f)}}}t.notifyListeners("didUpdate",{layout:s,snapshot:e,delta:c,layoutDelta:o,hasLayoutChanged:u,hasRelativeLayoutChanged:d})}else if(t.isLead()){const{onExitComplete:s}=t.options;s&&s()}t.options.transition=void 0}function V8(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function F8(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function z8(t){t.clearSnapshot()}function T_(t){t.clearMeasurements()}function A_(t){t.isLayoutDirty=!1}function $8(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function R_(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function K8(t){t.resolveTargetDelta()}function Y8(t){t.calcProjection()}function q8(t){t.resetSkewAndRotation()}function W8(t){t.removeLeadSnapshot()}function I_(t,e,n){t.translate=Qe(e.translate,0,n),t.scale=Qe(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function C_(t,e,n,s){t.min=Qe(e.min,n.min,s),t.max=Qe(e.max,n.max,s)}function X8(t,e,n,s){C_(t.x,e.x,n.x,s),C_(t.y,e.y,n.y,s)}function Q8(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const J8={duration:.45,ease:[.4,0,.1,1]},j_=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),O_=j_("applewebkit/")&&!j_("chrome/")?Math.round:In;function M_(t){t.min=O_(t.min),t.max=O_(t.max)}function Z8(t){M_(t.x),M_(t.y)}function uA(t,e,n){return t==="position"||t==="preserve-aspect"&&!o8(k_(e),k_(n),.2)}function eG(t){var e;return t!==t.root&&((e=t.scroll)==null?void 0:e.wasRoot)}const tG=cA({attachResizeListener:(t,e)=>Pl(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Mh={current:void 0},dA=cA({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!Mh.current){const t=new tG({});t.mount(window),t.setOptions({layoutScroll:!0}),Mh.current=t}return Mh.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),nG={pan:{Feature:w8},drag:{Feature:_8,ProjectionNode:dA,MeasureLayout:sA}};function D_(t,e,n){const{props:s}=t;t.animationState&&s.whileHover&&t.animationState.setActive("whileHover",n==="Start");const i="onHover"+n,r=s[i];r&&qe.postRender(()=>r(e,pc(e)))}class sG extends Ui{mount(){const{current:e}=this.node;e&&(this.unmount=SU(e,(n,s)=>(D_(this.node,s,"Start"),i=>D_(this.node,i,"End"))))}unmount(){}}class iG extends Ui{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=fc(Pl(this.node.current,"focus",()=>this.onFocus()),Pl(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function L_(t,e,n){const{props:s}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&s.whileTap&&t.animationState.setActive("whileTap",n==="Start");const i="onTap"+(n==="End"?"":n),r=s[i];r&&qe.postRender(()=>r(e,pc(e)))}class rG extends Ui{mount(){const{current:e}=this.node;e&&(this.unmount=IU(e,(n,s)=>(L_(this.node,s,"Start"),(i,{success:r})=>L_(this.node,i,r?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Op=new WeakMap,Dh=new WeakMap,aG=t=>{const e=Op.get(t.target);e&&e(t)},oG=t=>{t.forEach(aG)};function lG({root:t,...e}){const n=t||document;Dh.has(n)||Dh.set(n,{});const s=Dh.get(n),i=JSON.stringify(e);return s[i]||(s[i]=new IntersectionObserver(oG,{root:t,...e})),s[i]}function cG(t,e,n){const s=lG(e);return Op.set(t,n),s.observe(t),()=>{Op.delete(t),s.unobserve(t)}}const uG={some:0,all:1};class dG extends Ui{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:s,amount:i="some",once:r}=e,a={root:n?n.current:void 0,rootMargin:s,threshold:typeof i=="number"?i:uG[i]},o=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,r&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:f}=this.node.getProps(),h=u?d:f;h&&h(c)};return cG(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(fG(e,n))&&this.startObserver()}unmount(){}}function fG({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const hG={inView:{Feature:dG},tap:{Feature:rG},focus:{Feature:iG},hover:{Feature:sG}},mG={layout:{ProjectionNode:dA,MeasureLayout:sA}},pG={...t8,...hG,...nG,...mG},De=bH(pG,IH),P_=(t,e=800)=>{const[n,s]=_.useState(t),i=_.useRef(t);return _.useEffect(()=>{if(i.current===t)return;const r=i.current,a=t;let o=null;const c=u=>{o||(o=u);const d=Math.min((u-o)/e,1);s(r+(a-r)*d),d<1?requestAnimationFrame(c):i.current=t};requestAnimationFrame(c)},[t,e]),n},gG=({room:t,player:e,onAction:n})=>{var T,k,R,C,B,z,$,K,U,O,j;const{activeTab:s,setActiveTab:i}=gf(),{playSfx:r}=R0(),[a,o]=_.useState(!1),[c,u]=_.useState({tick:((T=t.world)==null?void 0:T.gameTick)||0,time:Date.now()});_.useEffect(()=>{var I,H;((I=t.world)==null?void 0:I.gameTick)!==c.tick&&u({tick:((H=t.world)==null?void 0:H.gameTick)||0,time:Date.now()})},[(k=t.world)==null?void 0:k.gameTick,c.tick]);const d=(R=t.regions)==null?void 0:R[e.regionId||"capital"],f=(((C=d==null?void 0:d.coup)==null?void 0:C.bribeProgress)||0)>0||!!(d!=null&&d.activeElection);_.useEffect(()=>{const I=H=>{if(H.target instanceof HTMLInputElement||H.target instanceof HTMLTextAreaElement)return;const X=H.key.toLowerCase(),oe={m:"MAP",l:"ACTIVITY",p:"PROFILE",i:"INVENTORY",f:"SKILLS",d:"DIPLOMACY",h:"HIERARCHY"};if(oe[X]){if(X==="d"&&e.role==="PEASANT")return;i(oe[X]),r("ui_click.ogg")}};return window.addEventListener("keydown",I),()=>window.removeEventListener("keydown",I)},[i,e.role,r]);const[,h]=_.useState(0);_.useEffect(()=>{const I=setInterval(()=>h(H=>H+1),1e3);return()=>clearInterval(I)},[]);const m=e.status.stamina||0,g=e.status.hp||0,v=e.stats.xp||0,x=e.stats.level||1,p=vd[x]||1e3,b=Math.min(100,v/p*100),y=P_(m),E=P_(g),N=[{id:"MAP",label:"Kart",icon:D3,short:"M"},{id:"ACTIVITY",label:"Live",icon:jl,short:"L"},{id:"INVENTORY",label:"Eiendeler",icon:V3,short:"I"},{id:"SKILLS",label:"Ferdigheter",icon:K3,short:"F"},...e.role!=="PEASANT"?[{id:"DIPLOMACY",label:"Diplomati",icon:jl,short:"D"}]:[],{id:"HIERARCHY",label:"Samfunn",icon:A3,short:"H"}],A=((B=t.world)==null?void 0:B.year)||1100,w=(($=An[(z=t.world)==null?void 0:z.season])==null?void 0:$.label)||((K=t.world)==null?void 0:K.season);return l.jsxs("header",{className:"flex-none h-16 md:h-20 border-b border-white/5 bg-slate-950/80 backdrop-blur-xl flex items-center justify-between px-4 md:px-8 z-50 relative shrink-0 transition-all",children:[l.jsxs("div",{className:"flex items-center gap-6 md:gap-8",children:[l.jsxs("div",{className:"flex flex-col",children:[l.jsxs("div",{className:"flex items-baseline gap-2",children:[l.jsx("span",{className:"text-3xl md:text-4xl font-black text-white tracking-tighter leading-none tabular-nums shadow-indigo-500/50 drop-shadow-lg",children:TP(c.tick,c.time)}),l.jsxs("span",{className:"text-sm md:text-base font-bold text-slate-500 uppercase tracking-widest",children:["R ",A]})]}),l.jsxs("div",{className:"flex items-center gap-3 text-[10px] md:text-xs font-bold uppercase tracking-widest text-slate-400 mt-1",children:[l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("span",{className:((U=t.world)==null?void 0:U.season)==="Winter"?"text-blue-300 drop-shadow-[0_0_8px_rgba(147,197,253,0.5)]":"text-amber-400 drop-shadow-[0_0_8px_rgba(251,191,36,0.5)]",children:w}),l.jsx("span",{className:"text-slate-600",children:""}),l.jsx("span",{className:"",title:Ss(((O=t.world)==null?void 0:O.gameTick)||0)==="DAY"?"Dag":"Natt",children:Ss(((j=t.world)==null?void 0:j.gameTick)||0)==="DAY"?" Dag":" Natt"})]}),f&&l.jsx("button",{onClick:()=>{i("POLITICS"),r("ui_click.ogg")},className:"flex items-center gap-2 bg-rose-600/20 border border-rose-500/50 px-2 py-0.5 rounded-full animate-pulse group hover:bg-rose-500 hover:text-white transition-all ml-2",title:"Uro i regionen! Klikk for  se politisk status.",children:l.jsx("span",{className:"text-[10px] font-black italic tracking-tighter",children:" URO"})})]})]}),l.jsx("nav",{className:"hidden md:flex items-center gap-1 bg-white/5 p-1 rounded-xl border border-white/5",children:N.map(I=>{const H=s===I.id,X=I.icon;return l.jsxs("button",{onClick:()=>{i(I.id),r("ui_click.ogg")},className:`
                                    relative px-4 py-2 rounded-lg flex items-center gap-2 transition-all group overflow-hidden
                                    ${H?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-400 hover:text-white hover:bg-white/5"}
                                `,children:[l.jsx(X,{size:16,className:H?"animate-pulse":""}),l.jsx("span",{className:"text-xs font-bold uppercase tracking-wider ",children:I.label}),I.short&&l.jsx("span",{className:`text-[10px] absolute top-0.5 right-1 font-mono font-bold transition-opacity ${H?"text-indigo-300":"text-slate-700 group-hover:text-slate-500"}`,children:I.short})]},I.id)})})]}),l.jsxs("div",{className:"flex items-center gap-4 md:gap-6",children:[e.activeBuffs&&e.activeBuffs.length>0&&l.jsx("div",{className:"flex items-center gap-2 mr-2",children:e.activeBuffs.map(I=>l.jsx(vG,{buff:I},I.id))}),l.jsxs("div",{className:"hidden lg:flex items-center bg-slate-900/50 rounded-full border border-white/5 overflow-hidden transition-all duration-300",children:[l.jsxs("button",{onClick:()=>{i("INVENTORY"),r("ui_click.ogg")},className:"flex items-center gap-2 hover:bg-white/5 px-4 py-1.5 transition-colors cursor-pointer group active:scale-95",title:"pne Eiendeler (I)",children:[l.jsx(dp,{resource:"gold",amount:e.resources.gold,size:"sm"}),l.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500 group-hover:text-slate-300 transition-colors ml-1",children:"Gull"})]}),l.jsx("div",{className:"w-px h-4 bg-white/10"}),l.jsxs("button",{onClick:()=>{e.resources.bread?(n==null||n({type:"CONSUME",itemId:"bread",isResource:!0}),r("eat.ogg")):(i("INVENTORY"),r("ui_click.ogg"))},disabled:!e.resources.bread,className:`flex items-center gap-3 px-4 py-1.5 transition-all cursor-pointer group border-l border-white/0 active:scale-95 ${e.resources.bread?"hover:bg-emerald-500/10 hover:border-emerald-500/20":"opacity-40 cursor-not-allowed"}`,title:e.resources.bread?"Spis Brd (+20 Stamina)":"Tomt for brd",children:[l.jsx(dp,{resource:"bread",amount:e.resources.bread||0,size:"sm"}),l.jsx("div",{className:"flex flex-col items-start -space-y-1",children:l.jsx("span",{className:`text-[10px] font-black uppercase tracking-widest transition-colors ${e.resources.bread?"text-slate-500 group-hover:text-emerald-400":"text-slate-600"}`,children:e.resources.bread?"Spis":"Tom"})})]})]}),l.jsxs("div",{className:"flex flex-col gap-1 w-24 md:w-32",children:[l.jsxs("div",{className:"h-1.5 bg-slate-800 rounded-full overflow-hidden relative group",children:[l.jsx(De.div,{className:"absolute inset-y-0 left-0 bg-rose-500 rounded-full",initial:{width:0},animate:{width:`${E}%`}}),l.jsxs("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 flex items-center justify-center text-[8px] font-black text-white bg-black/50 transition-opacity",children:["HP ",Math.round(E),"%"]})]}),l.jsxs("div",{className:"h-1.5 bg-slate-800 rounded-full overflow-hidden relative group",children:[l.jsx(De.div,{className:"absolute inset-y-0 left-0 bg-amber-400 shadow-[0_0_10px_rgba(251,191,36,0.5)]",initial:{width:0},animate:{width:`${y}%`}}),l.jsxs("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 flex items-center justify-center text-[8px] font-black text-black bg-white/50 transition-opacity",children:["STA ",Math.round(y),"%"]})]}),l.jsx("div",{className:"h-1 bg-slate-800/50 rounded-full overflow-hidden relative group mt-0.5",children:l.jsx(De.div,{className:"absolute inset-y-0 left-0 bg-indigo-500",initial:{width:0},animate:{width:`${b}%`}})})]}),l.jsxs("button",{onClick:()=>{i("PROFILE"),r("ui_click.ogg")},className:"group flex items-center gap-3 bg-white/0 hover:bg-white/5 pl-4 pr-1 py-1 rounded-2xl border border-transparent hover:border-white/10 transition-all active:scale-95",title:"Min Karakter (P)",children:[l.jsx("div",{className:"hidden lg:flex flex-col items-end",children:l.jsx("span",{className:"text-xl font-black italic tracking-tighter text-white leading-none",children:e.name})}),l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-600 p-0.5 shadow-lg overflow-hidden group-hover:shadow-indigo-500/20",children:e.avatar?l.jsx("img",{src:e.avatar,alt:"Profile",className:"w-full h-full object-cover rounded-[10px]"}):l.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-900 rounded-[10px] text-lg",children:e.role==="KING"?"":""})}),l.jsx("div",{className:"absolute -bottom-1 -right-1 w-5 h-5 bg-slate-900 rounded-full flex items-center justify-center border border-white/10 text-[9px] font-black text-white z-10",children:x})]})]}),l.jsx(bG,{icon:Q3,onClick:()=>i("SETTINGS"),title:"Innstillinger"}),l.jsx("button",{className:"md:hidden text-white p-2",onClick:()=>o(!a),children:a?l.jsx(ji,{}):l.jsx(P3,{})})]}),l.jsx(Ei,{children:a&&l.jsxs(De.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"absolute top-16 left-0 right-0 bg-slate-900 border-b border-white/10 p-4 shadow-2xl md:hidden flex flex-col gap-2 z-40",children:[N.map(I=>l.jsxs("button",{onClick:()=>{i(I.id),o(!1)},className:`w-full p-4 rounded-xl text-left font-black uppercase flex items-center gap-4 ${s===I.id?"bg-indigo-600 text-white":"bg-white/5 text-slate-400"}`,children:[l.jsx(I.icon,{size:20}),I.label]},I.id)),l.jsx("div",{className:"h-px bg-white/5 my-2"}),l.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 font-bold uppercase tracking-widest px-2",children:[l.jsxs("span",{children:["r ",A]}),l.jsx("span",{children:w})]})]})})]})},bG=({icon:t,onClick:e,title:n,className:s})=>l.jsx("button",{onClick:e,title:n,className:`hidden md:flex p-2 text-slate-400 hover:text-white hover:bg-white/5 rounded-lg transition-all ${s}`,children:l.jsx(t,{size:20})}),vG=({buff:t})=>{const[e,n]=_.useState(Math.max(0,Math.ceil((t.expiresAt-Date.now())/6e4)));return _.useEffect(()=>{const s=setInterval(()=>{const i=Math.max(0,Math.ceil((t.expiresAt-Date.now())/6e4));n(i)},1e4);return()=>clearInterval(s)},[t.expiresAt]),Date.now()>t.expiresAt?null:l.jsxs("div",{className:"group relative flex items-center justify-center w-8 h-8 rounded-full bg-emerald-500/10 border border-emerald-500/30 text-emerald-400 cursor-help",children:[l.jsx("span",{className:"text-lg",children:""}),l.jsxs("span",{className:"absolute -bottom-1 -right-1 text-[8px] font-black bg-slate-900 px-1 rounded-full border border-white/10",children:[e,"m"]}),l.jsxs("div",{className:"absolute top-full mt-2 left-1/2 -translate-x-1/2 bg-slate-900 p-2 rounded-lg border border-white/10 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none w-32 text-center z-50",children:[l.jsx("p",{className:"text-[10px] font-bold text-white mb-0.5",children:t.label}),l.jsxs("p",{className:"text-[9px] text-emerald-400",children:[t.value*100,"% mindre stamina"]})]})]})},fA=we.memo(({src:t,placeholderSrc:e,alt:n,className:s,imgClassName:i="object-cover w-full h-full",priority:r=!1,disableMotion:a=!1})=>{const[o,c]=_.useState(!1),[u,d]=_.useState(e||t);return _.useEffect(()=>{c(!1),e&&d(e);const f=new Image;f.src=t,f.onload=()=>{d(t),c(!0)}},[t,e]),l.jsx("div",{className:`relative overflow-hidden ${s}`,children:l.jsx(De.img,{src:u,alt:n,loading:r?"eager":"lazy",className:`${i} transition-all duration-700 ease-in-out`,initial:{filter:"blur(20px)",scale:a?1:1.1},animate:{filter:o?"blur(0px)":"blur(20px)",scale:a||o?1:1.1},style:{willChange:"filter, transform"}},t)})});fA.displayName="ProgressiveImage";const lr=[{id:"fields",label:"krene",icon:"",top:"22%",left:"42%",vest:{top:"35%",left:"70%"},ost:{top:"35%",left:"45%"},roles:["PEASANT","BARON","KING"],actions:[],isHub:!0},{id:"forest",label:"Skogen",icon:"",top:"25%",left:"80%",vest:{top:"15%",left:"60%"},ost:{top:"27%",left:"14%"},roles:["PEASANT","BARON","KING"],actions:[],isHub:!0},{id:"castle",label:"Slottet",icon:"",top:"66%",left:"86%",vest:{top:"40%",left:"30%"},ost:{top:"40%",left:"68%"},roles:["PEASANT","BARON","KING","SOLDIER"],actions:[{id:"OPEN_CONSTRUCTION",label:"Bidra til bygging",cost:"Ressurser"}],isHub:!0},{id:"peasant_farm",label:"Husmannsplassen",icon:"",top:"30%",left:"60%",vest:{top:"85%",left:"72%"},ost:{top:"75%",left:"30%"},roles:["PEASANT","BARON","KING"],actions:[],isHub:!0},{id:"market",label:"Markedet",icon:"",top:"70%",left:"25%",vest:{top:"70%",left:"37%"},ost:{top:"70%",left:"63%"},roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],actions:[{id:"MARKET_VIEW",label:"pne Handel",cost:"Gratis"},{id:"JOIN_ROLE",label:"Bli Kjpmann",cost:"500g + Niv 3",targetRole:"MERCHANT"}]},{id:"village",label:"Landsbyen",icon:"",top:"42%",left:"42%",vest:{top:"50%",left:"52%"},ost:{top:"55%",left:"44%"},roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],actions:[],isHub:!0},{id:"mine",label:"Gruve-distriktet",icon:"",top:"12%",left:"25%",vest:{top:"13%",left:"39%"},ost:{top:"20%",left:"60%"},roles:["PEASANT","BARON","KING"],actions:[],isHub:!0},{id:"monastery",label:"Klosteret",icon:"",top:"16%",left:"55%",vest:{top:"50%",left:"78%"},ost:{top:"50%",left:"27%"},roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],actions:[],isHub:!0},{id:"border",label:"Grensen",icon:"",top:"85%",left:"80%",vest:{top:"15%",left:"10%"},ost:{top:"15%",left:"10%"},roles:["BARON"],actions:[{id:"RAID",label:"Plyndre Nabo",cost:"-40"}]},{id:"throne_room",label:"Tronsalen",icon:"",top:"40%",left:"50%",roles:["KING"],parentId:"castle",actions:[{id:"TAX_ROYAL",label:"Kongelig Skatt",cost:"King Only"},{id:"DECREE",label:"Utsted Dekret",cost:"King Only"}]},{id:"barracks",label:"Kasernen",icon:"",top:"60%",left:"30%",roles:["PEASANT","BARON","KING","SOLDIER"],parentId:"castle",actions:[{id:"DRAFT",label:"Verve Soldater",cost:"-5g -10"},{id:"JOIN_ROLE",label:"Bli Soldat",cost:"200g + Niv 3",targetRole:"SOLDIER"}]},{id:"royal_chambers",label:"Kongens Kammer",icon:"",top:"30%",left:"70%",roles:["BARON","KING"],parentId:"castle",actions:[{id:"REST",label:"Hvile i Kammeret",cost:"Full rest + Velvre"}]},{id:"castle_construction",label:"Byggeplass",icon:"",top:"75%",left:"80%",roles:["PEASANT","BARON","KING","SOLDIER"],parentId:"castle",actions:[{id:"OPEN_CONSTRUCTION",label:"Bidra til bygging",cost:"Ressurser"}]},{id:"village_square",label:"Landsbytorg",icon:"",top:"50%",left:"50%",village:{top:"48%",left:"50%"},roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],parentId:"village",actions:[{id:"REST",label:"Hvile p torget",cost:"+10"}]},{id:"tavern",label:"Vertshuset",icon:"",top:"35%",left:"75%",village:{top:"75%",left:"80%"},roles:["PEASANT","BARON","KING","SOLDIER"],parentId:"village",actions:[{id:"ENTER_TAVERN",label:"G inn",cost:"Gratis"},{id:"REST_BASIC",label:"Hvile i Salen",cost:"Gratis"},{id:"REST_COMFY",label:"Bestille Kammer",cost:"-5g"},{id:"REST_ROYAL",label:"Kongelig Suite",cost:"-20g"}],isHub:!0,isInterior:!0},{id:"bakery",label:"Bakeri",icon:"",top:"80%",left:"30%",village:{top:"38%",left:"35%"},roles:["PEASANT","BARON"],parentId:"village",actions:[],isHub:!0,isInterior:!0},{id:"great_forge",label:"Storsmie",icon:"",top:"35%",left:"15%",village:{top:"48%",left:"23%"},roles:["PEASANT","BARON"],parentId:"village",actions:[],isHub:!0,isInterior:!0},{id:"windmill",label:"Vindmlle",icon:"",top:"20%",left:"37%",village:{top:"25%",left:"17%"},roles:["PEASANT","BARON","KING"],parentId:"village",actions:[{id:"REFINE_flour",label:"Male Mel",cost:"-15 -10korn"}],isHub:!0,isInterior:!0},{id:"smeltery",label:"Smeltehytte",icon:"",top:"60%",left:"95%",village:{top:"75%",left:"12%"},roles:["PEASANT","BARON"],parentId:"village",actions:[{id:"REFINE_IRON_BASIC",label:"Smelte Jern",cost:"-20 -5malm"},{id:"REFINE_IRON_FAST",label:"Industri-smelting",cost:"-30 -10malm"},{id:"REFINE_STEEL",label:"Smelte Stl",cost:"-50 -20malm"}],isHub:!0,isInterior:!0},{id:"sawmill",label:"Sagbruk",icon:"",top:"55%",left:"15%",village:{top:"70%",left:"45%"},roles:["PEASANT","BARON"],parentId:"village",actions:[{id:"REFINE_PLANK_BASIC",label:"Sag Planker",cost:"-10 -5ved"},{id:"REFINE_PLANK_FAST",label:"Hurtig-saging",cost:"-15 -5ved"}],isHub:!0,isInterior:!0},{id:"weavery",label:"Veveri",icon:"",top:"50%",left:"85%",village:{top:"45%",left:"65%"},roles:["PEASANT","BARON","MERCHANT"],parentId:"village",actions:[],isHub:!0,isInterior:!0},{id:"watchtower",label:"Vaktrn",icon:"",top:"15%",left:"68%",village:{top:"25%",left:"82%"},roles:["BARON","SOLDIER"],parentId:"village",actions:[],isHub:!0,isInterior:!0},{id:"stables",label:"Stall",icon:"",top:"80%",left:"80%",village:{top:"45%",left:"90%"},roles:["BARON","SOLDIER","KING"],parentId:"village",actions:[],isHub:!0,isInterior:!0},{id:"well",label:"Bybrnn",icon:"",top:"69%",left:"60%",village:{top:"48%",left:"50%"},roles:["PEASANT","BARON"],parentId:"village",actions:[],isHub:!0},{id:"apothecary",label:"Apoteker",icon:"",top:"20%",left:"82%",village:{top:"60%",left:"92%"},roles:["PEASANT","BARON","KING","MERCHANT"],parentId:"village",actions:[],isHub:!0,isInterior:!0},{id:"forge_anvil",label:"Ambolt",icon:"",top:"50%",left:"40%",roles:["PEASANT","BARON"],parentId:"great_forge",actions:[{id:"OPEN_CRAFTING",label:"pne Smia",cost:"Gratis"}]},{id:"forge_upgrades",label:"Tegneark",icon:"",top:"40%",left:"75%",roles:["PEASANT","BARON"],parentId:"great_forge",actions:[{id:"BUILDING_UPGRADE_great_forge",label:"Oppgrader Smia",cost:"Varierer"}]},{id:"bakery_oven",label:"Bakerovn",icon:"",top:"50%",left:"50%",roles:["PEASANT","BARON"],parentId:"bakery",actions:[{id:"REFINE",label:"pne Bakeriet",cost:"Gratis"}]},{id:"bakery_upgrades",label:"Tegneark",icon:"",top:"30%",left:"80%",roles:["PEASANT","BARON"],parentId:"bakery",actions:[{id:"BUILDING_UPGRADE_bakery",label:"Oppgrader Bakeriet",cost:"Varierer"}]},{id:"windmill_stones",label:"Kvernsteiner",icon:"",top:"50%",left:"40%",roles:["PEASANT","BARON"],parentId:"windmill",actions:[{id:"REFINE",label:"pne Mlla",cost:"Gratis"}]},{id:"windmill_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON"],parentId:"windmill",actions:[{id:"BUILDING_UPGRADE_windmill",label:"Oppgrader Mlla",cost:"Varierer"}]},{id:"sawmill_blade",label:"Saga",icon:"",top:"50%",left:"40%",roles:["PEASANT","BARON"],parentId:"sawmill",actions:[{id:"REFINE",label:"pne Sagbruket",cost:"Gratis"}]},{id:"sawmill_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON"],parentId:"sawmill",actions:[{id:"BUILDING_UPGRADE_sawmill",label:"Oppgrader Sagbruket",cost:"Varierer"}]},{id:"smeltery_furnace",label:"Smelteovn",icon:"",top:"50%",left:"30%",roles:["PEASANT","BARON"],parentId:"smeltery",actions:[{id:"REFINE",label:"pne Smeltehytta",cost:"Gratis"}]},{id:"smeltery_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON"],parentId:"smeltery",actions:[{id:"BUILDING_UPGRADE_smeltery",label:"Oppgrader Smeltehytta",cost:"Varierer"}]},{id:"weavery_loom",label:"Vevstol",icon:"",top:"50%",left:"40%",roles:["PEASANT","BARON","MERCHANT"],parentId:"weavery",actions:[{id:"REFINE",label:"pne Veveriet",cost:"Gratis"}]},{id:"weavery_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON"],parentId:"weavery",actions:[{id:"BUILDING_UPGRADE_weavery",label:"Oppgrader Veveriet",cost:"Varierer"}]},{id:"stables_stall",label:"Stallplass",icon:"",top:"50%",left:"40%",roles:["BARON","SOLDIER","KING"],parentId:"stables",actions:[{id:"MOUNT_HORSE",label:"Ri ut",cost:"-5"}]},{id:"stables_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["BARON","KING"],parentId:"stables",actions:[{id:"BUILDING_UPGRADE_stables",label:"Oppgrader Stallen",cost:"Varierer"}]},{id:"watchtower_top",label:"Vaktpost",icon:"",top:"30%",left:"50%",roles:["PEASANT","BARON","SOLDIER"],parentId:"watchtower",actions:[{id:"OPEN_GARRISON",label:"pne Garnisonen",cost:"Gratis"},{id:"PATROL",label:"Patruljer",cost:"-30"}]},{id:"watchtower_upgrades",label:"Tegneark",icon:"",top:"50%",left:"80%",roles:["BARON"],parentId:"watchtower",actions:[{id:"BUILDING_UPGRADE_watchtower",label:"Oppgrader Trnet",cost:"Varierer"}]},{id:"apothecary_bench",label:"Arbeidsbenk",icon:"",top:"50%",left:"40%",roles:["PEASANT","BARON"],parentId:"apothecary",actions:[{id:"OPEN_CRAFTING",label:"pne Apoteket",cost:"Gratis"}]},{id:"apothecary_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON"],parentId:"apothecary",actions:[{id:"BUILDING_UPGRADE_apothecary",label:"Oppgrader Apoteket",cost:"Varierer"}]},{id:"well_water",label:"Brnnkum",icon:"",top:"50%",left:"50%",roles:["PEASANT","BARON"],parentId:"well",actions:[{id:"GATHER_WATER",label:"Hent Vann",cost:"-10"}]},{id:"well_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON"],parentId:"well",actions:[{id:"BUILDING_UPGRADE_well",label:"Oppgrader Brnnen",cost:"Varierer"}]},{id:"tavern_bar",label:"Baren",icon:"",top:"30%",left:"30%",roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],parentId:"tavern",actions:[{id:"BUY_MEAL",label:"Kjp Mltid",cost:"-5g +10"},{id:"REST_BASIC",label:"Hvile i Salen",cost:"Gratis"},{id:"REST_COMFY",label:"Bestille Kammer",cost:"-5g"},{id:"REST_ROYAL",label:"Kongelig Suite",cost:"-20g"}]},{id:"tavern_gambling",label:"Spillebordet",icon:"",top:"50%",left:"50%",roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],parentId:"tavern",actions:[{id:"OPEN_DICE_GAME",label:"Spill Terninger",cost:"Min. 0.5g"}]},{id:"tavern_gossip",label:"Lokalbefolkningen",icon:"",top:"40%",left:"70%",roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],parentId:"tavern",actions:[{id:"CHAT_LOCAL",label:"Snakk med folk",cost:"Gratis"}]},{id:"tavern_upgrades",label:"Tegneark",icon:"",top:"25%",left:"85%",roles:["PEASANT","BARON","KING"],parentId:"tavern",actions:[{id:"BUILDING_UPGRADE_tavern",label:"Oppgrader Vertshuset",cost:"Varierer"}]},{id:"grain_fields",label:"Kornker",icon:"",top:"50%",left:"20%",roles:["PEASANT","BARON","KING"],parentId:"fields",actions:[{id:"PLANT",label:"S Korn",cost:"-5 korn -25"}]},{id:"sheep_pasture",label:"Sauebeite",icon:"",top:"35%",left:"65%",roles:["PEASANT","BARON","KING"],parentId:"fields",actions:[{id:"GATHER_WOOL",label:"Klipp Sauer",cost:"-15"}]},{id:"beehives",label:"Bikuber",icon:"",top:"75%",left:"70%",roles:["PEASANT","BARON","KING"],parentId:"fields",actions:[{id:"GATHER_HONEY",label:"Samle Honning",cost:"-20"}]},{id:"mine_shaft",label:"Jern-gruva",icon:"",top:"50%",left:"12%",roles:["PEASANT","BARON","KING"],parentId:"mine",actions:[{id:"MINE",label:"Bryte Malm",cost:"-25 -1"}]},{id:"quarry_poi",label:"Steinhuggeriet",icon:"",top:"40%",left:"85%",roles:["PEASANT","BARON","KING"],parentId:"mine",actions:[{id:"QUARRY",label:"Hugge Stein",cost:"-20 -1"}]},{id:"forest_clearing",label:"Hogstfeltet",icon:"",top:"60%",left:"30%",roles:["PEASANT","BARON","KING"],parentId:"forest",actions:[{id:"CHOP",label:"Hugge Ved",cost:"-15 -1"}]},{id:"hunting_grounds",label:"Jaktmarker",icon:"",top:"30%",left:"75%",roles:["PEASANT","BARON","KING"],parentId:"forest",actions:[{id:"HUNT",label:"Dra p Jakt",cost:"-30"}]},{id:"forest_forage",label:"Brplukking",icon:"",top:"60%",left:"90%",roles:["PEASANT","BARON","KING"],parentId:"forest",actions:[{id:"FORAGE",label:"Sanke Mat (Nd)",cost:"-40"}]},{id:"monastery_chapel",label:"Klosterkirken",icon:"",top:"50%",left:"50%",roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],parentId:"monastery",actions:[{id:"PRAY",label:"Be en Bnn",cost:"-15"}]},{id:"farm_house",label:"Inne i Stugo",icon:"",top:"52%",left:"58%",roles:["PEASANT"],parentId:"peasant_farm",actions:[],isHub:!0,isInterior:!0},{id:"stugo_bed",label:"Senga",icon:"",top:"65%",left:"42%",roles:["PEASANT"],parentId:"farm_house",actions:[{id:"SLEEP",label:"Sove tungt",cost:"Full "}]},{id:"stugo_fireplace",label:"Peisen",icon:"",top:"55%",left:"80%",roles:["PEASANT"],parentId:"farm_house",actions:[{id:"EAT",label:"Sitte ved varmen",cost:"-1 +40"}]},{id:"farm_well",label:"Brnnen",icon:"",top:"60%",left:"27%",roles:["PEASANT"],parentId:"peasant_farm",actions:[{id:"REST",label:"Drikke vann",cost:"+5"}]},{id:"farm_upgrade_spot",label:"Tegneark",icon:"",top:"40%",left:"15%",roles:["PEASANT"],parentId:"farm_house",actions:[{id:"BUILDING_UPGRADE_farm_house",label:"Bygg ut grden",cost:"Varierer"}]},{id:"chicken_coop",label:"Hnsehus",icon:"",top:"40%",left:"75%",roles:["PEASANT"],parentId:"peasant_farm",actions:[{id:"OPEN_CHICKEN_COOP",label:"G inn til hnene",cost:"Gratis"}]}],B_=[{id:"pilegrim",name:"Sigurd Pilegrim",role:"Vandrer mot Nidaros",description:"Han sitter masserer sine sre ftter. En bredbremmet hatt med et kamskjell ligger p bordet, og vandringsstaven er slitt glatt av tusenvis av grep.",conversation:{start:{text:"Fred vre med deg, reisende. Kjenner du veien nordover? Mine ftter verker som om jeg har gtt p gldende kull, men sjelen... sjelen trekkes mot Hellig Olavs by.",options:[{label:"Hvorfor denne lange reisen?",nextId:"why"},{label:"Er det farlig langs veien?",nextId:"danger"},{label:"Fortell om kamskjellet.",nextId:"shell"},{label:"Lykke til videre. (G)",nextId:"EXIT"}]},why:{text:"For bot og bedring! Vi brer alle synder, min venn. Men i Nidaros, ved kongens skrin, er himmelen nrmere jorden. Det sies at en pilegrimsferd kan korte ned tiden i skjrsilden med mange r.",options:[{label:"Tror du virkelig p det?",nextId:"believe"},{label:"Hva hper du  finne?",nextId:"hope"}]},believe:{text:"Jeg *m* tro. Jeg har sett halte kaste krykkene og blinde f synet tilbake ved katedralen. Olavs kraft er sterk, selv om han har vrt dd i hundrevis av r. Han er Norges evige konge.",options:[{label:"Fortell om Olav.",nextId:"olav"}]},hope:{text:"Tilgivelse. Og kanskje litt sjelefred. Livet er hardt, vinteren er lang.  vite at man har gjort denne ofringen... det gir styrke.",options:[{label:"Forstelig.",nextId:"start"}]},danger:{text:" ja! Dovrefjell er ndelst. Snstormer kan komme midt p sommeren. Og i dalene lurer landeveisrvere som ser p oss pilegrimer som vandrende pengesekker. Men vi reiser ofte i flokk for beskyttelse.",options:[{label:"Har du blitt ranet?",nextId:"robbed"},{label:"Hvor sover dere?",nextId:"sjelehus"}]},robbed:{text:"Nesten. En gang, nr Gudbrandsdalen, s vi skygger i skogen. Vi sang salmer s hyt vi kunne, og drev dem bort med troens styrke! ...og kanskje fordi vi var frti stykker.",options:[{label:"God taktikk.",nextId:"danger"}]},sjelehus:{text:"Det finnes sjelehus  herberger bygget for Guds skyld  langs ruten. Der fr vi tak over hodet og enkel mat. Ofte deler vi rom med dyrene for varmen.",options:[{label:"Hres... koselig ut.",nextId:"danger"}]},shell:{text:"Ah, Ib-skjellet! Symbolet p St. Jakob. Dette viser at jeg har vandret helt til Santiago de Compostela i Spania. Jeg har sett verden, min venn. Fra nordlyset her til de solbrente slettene i sr.",options:[{label:"Du er en bereist mann.",nextId:"start"}]},olav:{text:"Han falt p Stiklestad i 1030. De sier at da de gravde ham opp et r senere, var kroppen like frisk, og hret og neglene hadde vokst! Det var beviset. Han kristnet oss med sverd, men reddet oss med sin hellighet.",options:[{label:"En mektig legende.",nextId:"start"}]}}},{id:"hansa",name:"Gerhard fra Lbeck",role:"Hansa-kjpmann",description:"Kledd i kostbar ull og pels. Han studerer en lang regnskapsrull med rynket panne og nipper til en vin som ser langt bedre ut enn husets vanlige.",conversation:{start:{text:"*Mumler p tysk* ...zwei schock, drei stck... Ah! En lokal? Si meg, har fiskerne i nord ftt opp farten? Mine skip venter i Bergen. Tid er penger, som vi sier i Lbeck.",options:[{label:"Hvem er du?",nextId:"intro"},{label:"Hvorfor er trrfisken s viktig?",nextId:"stockfish"},{label:"Hva er Hansaen egentlig?",nextId:"hansa_deep"},{label:"Jeg lar deg arbeide. (G)",nextId:"EXIT"}]},intro:{text:"Gerhard, handelsmann av Det Tyske Hanseforbund. Vi srger for at dere fr korn og mel, og at dere fr solgt den... vel, illeluktende fisken deres. En god byttehandel, *nicht wahr*?",options:[{label:"Vi klarer oss vel selv?",nextId:"monitor"},{label:"Takk for kornet.",nextId:"grain"}]},grain:{text:"Ja, det burde dere. Uten vrt baltiske korn ville mange nordmenn sultet nr avlingene svikter. Vi binder Nord-Europa sammen med vre kogger.",options:[{label:"Kogger?",nextId:"cog"}]},monitor:{text:"Haha! Tror du det? Uten oss ville fisken deres rtnet p stranden. Vi har nettverket. Vi har markedene i sr  katolikkene trenger fisk til fasten, og vi leverer.",options:[{label:"Dere tar stor fortjeneste.",nextId:"monopoly"}]},monopoly:{text:"Risiko koster! Stormer, pirater, kriger. Vi tar risikoen, vi tar profitten. Og vi har Kongens velsignelse... og privilegier. Vi dmmer vre egne p Bryggen.",options:[{label:"Egne lover?",nextId:"laws"}]},laws:{text:"Ja. En hanseat dmmes etter hansas lov, ikke norsk lov. Det... skaper litt friksjon med byborgerne, innrmmer jeg. Men handelen m flyte!",options:[{label:"Hres urettferdig ut.",nextId:"start"}]},stockfish:{text:'Det er "Det hvite gullet"! Trket i den kalde norske vinden blir den hard som tre og holder i revis. Perfekt mat for soldater og munker i hele Europa. Vi bytter det mot korn, klr, vin og krydder.',options:[{label:"En viktig ressurs.",nextId:"start"}]},hansa_deep:{text:"Et brorskap av handelsbyer. Lbeck, Hamburg, Rostock, Visby... og vrt kontor i Bergen. Vi beskytter hverandre mot konger som vil skattlegge oss for hardt, og mot sjrvere. Sammen er vi sterkere enn noe kongerike.",options:[{label:"Morsomt at du nevner pirater...",nextId:"pirates"},{label:"Imponerende.",nextId:"start"}]},pirates:{text:"Vitaliebrdrene... en plage! De herjer i stersjen. Men Hansaen har sine egne skip. Vi kan bite fra oss. Ikke tro at en kjpmann ikke kan svinge et sverd.",options:[{label:"Notert.",nextId:"EXIT"}]},cog:{text:"Vre skip. Brede, hye, med plass til enorme mengder last. De er ikke raske som vikingenes langskip, men de bygget vr rikdom. Ett skip kan f hele Bergen med korn.",options:[{label:"Teknologi er makt.",nextId:"start"}]}}},{id:"leilending",name:"Tormod",role:"Sliten Leilending",description:"Hendene hans er grove som bark, og ryggen er byd av r med plying. Han drikker tynt l og ser tankefullt ned i kruset.",conversation:{start:{text:"Enda en hst, enda en landskyld  betale. Livet til en leilending er  s for andre og hste smuler selv. Skl for det.",options:[{label:"Hva er landskyld?",nextId:"rent"},{label:"Hvorfor eier du ikke jorda?",nextId:"own"},{label:"Hvordan var det fr?",nextId:"plague"},{label:"Gr det s drlig? (G)",nextId:"EXIT"}]},rent:{text:"Leieavgiften. Jeg driver grden, men Kirken eier grunnen. Hvert r m jeg gi dem en fjerdedel av kornet, tre skippund smr og to kyr. Det som er igjen... det skal f familien min gjennom vinteren.",options:[{label:"Hva hvis avlingen svikter?",nextId:"fail"},{label:"Hvem bestemmer prisen?",nextId:"laws"}]},fail:{text:"Da sulter vi. Eller vi m lne skorn av jordeieren, og da havner vi dypere i gjeld. Det er en sirkel det er vanskelig  bryte.",options:[{label:"Trist skjebne.",nextId:"start"}]},own:{text:"F bnder eier sin egen jord n. Adelen og Kirken har kjpt opp nesten alt. Men jeg har i det minste *bygslebrev*. S lenge jeg betaler og driver jorda, kan de ikke kaste meg ut. Det er norsk lov.",options:[{label:"En viss trygghet.",nextId:"laws"}]},laws:{text:"Ja, Landsloven til Magnus Lagabte. Den gir oss rettigheter. Jordeieren kan ikke bare ta grden fordi han vil. Og jeg kan kreve at snnen min fr overta bygselen. Vi er ikke slaver, vi er frie menn... bare fattige.",options:[{label:"Viktig forskjell.",nextId:"start"}]},plague:{text:"*Han senker stemmen* Bestefar fortalte om Den Store Dden. Da to av tre dde. Etterp... etterp var det gode tider for de som overlevde. Masse ledig jord! Lav landskyld! N? N er vi mange igjen, og jordeierne strammer grepet.",options:[{label:"degrder?",nextId:"deserted"},{label:"Tidene skifter.",nextId:"start"}]},deserted:{text:"Ja, du kan fortsatt se ruinene i skogen. Grder der folk bodde fr, som n er grodd igjen. Noen sier det spker der, at de dde gr igjen og passer p arveslvet sitt.",options:[{label:"Grss.",nextId:"start"}]}}},{id:"steinhugger",name:"Master William",role:"Engelsk Steinhugger",description:"Han tegner geometriske figurer i slt l p bordet. Fingrene er hvite av steinstv.",conversation:{start:{text:"Ser du? Hvis du lfter buen *her*, og krysser hvelvet *slik*... da kan du bygge hyere enn fjellene! Ah, unnskyld. Jeg drmmer om stein.",options:[{label:"Bygger du katedralen?",nextId:"nidaros"},{label:"Du er ikke herfra?",nextId:"english"},{label:"Stein er bare stein. (G)",nextId:"EXIT"}]},nidaros:{text:"Kristkirken i Nidaros, ja! Verdens nordligste gotiske katedral. Vi hugger Kleberstein. Den er myk som smr nr den brytes, men blir hard som jern i luften. Et mirakulst materiale.",options:[{label:"Fortell om stilen.",nextId:"gothic"},{label:"Hvor lenge holder dere p?",nextId:"time"}]},gothic:{text:"Gotikk! Det er lysets arkitektur. I gamle dager bygget de tykke vegger og sm vinduer (romansk stil). N? Vi bruker strebepilarer p utsiden til  bre taket, s vi kan fylle veggene med glassmalerier. Guds lys strmmer inn!",options:[{label:"Hres vakkert ut.",nextId:"symbolism"}]},symbolism:{text:"Det er mer enn vakkert. Kirken er et bilde p himmelen. Hver syle, hver bue peker oppover. Nr bonden kommer inn fra gjrma, skal han fle at han trer inn i Guds rike.",options:[{label:"Mektig.",nextId:"start"}]},english:{text:"Nei, jeg kom fra Lincoln. Erkebiskopen hentet hndverkere fra England. Vi tar med oss kunnskapen om de nye stilene. Det er et internasjonalt laug, steinhuggerne. Vi reiser dit Gud og gullet kaller oss.",options:[{label:"Et reisende liv.",nextId:"start"}]},time:{text:'Haha! "Hvor lenge?" Min oldefar begynte. Jeg fortsetter. Mine barnebarn vil kanskje se spiret reise seg. En katedral bygges ikke for oss, men for evigheten.',options:[{label:"En tlmodighetsprve.",nextId:"EXIT"}]}}},{id:"vaering",name:"Halvdan",role:"Veteran fra Vringgarden",description:"Han brer en kappe av falmet, men kostbar silke. Et stygt arr deler venstre yenbryn i to. Han drikker ikke l, men vin fra en liten flaske.",conversation:{start:{text:"Dette stedet... det er kaldt, mrkt og lukter av vt hund. I Miklagard skinte solen p gulltakene hver dag, og keiserens hager duftet av sjasmin.",options:[{label:"Hvor er Miklagard?",nextId:"miklagard"},{label:"Var du en kriger?",nextId:"guard"},{label:"Hjemme best. (G)",nextId:"EXIT"}]},miklagard:{text:'"Den Store Byen". Konstantinopel! Verdens sentrum. Der mtes st og vest. Gatene er brolagt med marmor, og de har badehus med varmt vann i veggene! Kan du tenke deg? Varmt vann uten  koke det over bl!',options:[{label:"Utrolig.",nextId:"hagia"},{label:"Savner du det?",nextId:"miss"}]},hagia:{text:"Og Hagia Sofia... Guds Helligdoms Kirke. Kuppelen er s stor at den ser ut som om den henger i en gullkjede fra himmelen. Jeg har sett menn grte bare av  g inn der.",options:[{label:"M vre et syn.",nextId:"start"}]},guard:{text:'Vringgarden. Keiserens livvakt. Vi nordboere er hye, sterke og... vel, vi sviker ikke for penger. Grekerne er slueste folk, men de stoler bare p vre kser. "Pelekysphoroi" kaller de oss. ksebrere.',options:[{label:"Mtte dere slss?",nextId:"fight"},{label:"Ble du rik?",nextId:"rich"}]},fight:{text:"Mot sarasenere, mot bulgarere, mot opprrske generaler. Jeg har sett gresk ild  flytende flammer som brenner p vann! Det er djevelens verk, men effektivt.",options:[{label:"Gresk ild?",nextId:"start"}]},rich:{text:'Keiseren er sjeners. Nr han dr, har vi rett til  g gjennom skattkammeret og ta det vi kan bre. "Polutasvarf", kaller vi det. Palass-plyndring. Det er slik jeg fikk denne kappen... og denne ringen.',options:[{label:"En god pensjon.",nextId:"start"}]},miss:{text:"Hver vinter. Men her er min slekt, min jord. Og her snakker folk et sprk man kan forst. Men jeg vil alltid drmme om det Gyldne Horn.",options:[{label:"Skl for minnene.",nextId:"EXIT"}]}}},{id:"munk",name:"Broder Johannes",role:"Lrd Skrivermunk",description:"Fingrene hans er flekkete av blekk. Han myser, som om han er vant til  lese i drlig lys, og snakker lavmelt.",conversation:{start:{text:"Hysj. Hrer du stillheten? Nei, selvsagt ikke. Her er det sty. I skriptoriet hrer man bare fjrpennens skraping mot pergamentet. Guds ord som festes til huden.",options:[{label:"Hva skriver du?",nextId:"write"},{label:"Er du ikke ensom?",nextId:"lonely"},{label:"Jeg lar deg vre i fred. (G)",nextId:"EXIT"}]},write:{text:'Akkurat n? En kopi av "Kongespeilet"  *Konungs skuggsj*. En lrebok for prinser. Den forteller om hflighet, handel, stjernene og Guds orden. En klok konge m vre lrd, ikke bare sterk.',options:[{label:"Er bker dyre?",nextId:"expensive"},{label:"Hvem leser disse?",nextId:"readers"}]},expensive:{text:"Ufattelig. Et stort bibelverk krever skinnet fra 300 kalver! Tenk p flokken... og arbeidet.  forberede skinnet, blande blekket, male initialene med bladgull. En bok kan koste mer enn en grd.",options:[{label:"En skatt alts.",nextId:"start"}]},readers:{text:"De geistlige, kongen, og noen f adelige. Men kunnskapen risler nedover. Det vi bevarer i bibliotekene, er verdens hukommelse. Uten oss ville historien forsvinne i mrket.",options:[{label:"Et viktig ansvar.",nextId:"start"}]},lonely:{text:"Aldri. Jeg er omgitt av apostler, helgener og kirkefedrene. Augustin, Thomas Aquinas... de taler til meg gjennom sidene. Og brdrene i klosteret er min familie. Vi ber sammen, arbeider sammen.",options:[{label:"Ora et labora?",nextId:"rule"},{label:"Hres fredelig ut.",nextId:"start"}]},rule:{text:"Be og arbeid. Ja. Det er St. Benedikts regel. Lediggang er fienden av sjelen. S vi dyrker urter, brygger l (som dette, Guds gave!), og kopierer bker.",options:[{label:"Skl for let.",nextId:"EXIT"}]}}},{id:"pestlege",name:"Doktor Pestus",role:"Pestlege",description:"Han sitter litt for seg selv. En merkelig maske med nebb henger rundt halsen hans, og han lukter sterkt av eddik og trkede blomster.",conversation:{start:{text:"Ikke kom for nr! Balansen i vskene dine ser... urolig ut. Er du sangvinsk? Eller melankolsk? Luften her er tykk av miasma.",options:[{label:"Miasma?",nextId:"miasma"},{label:"Hva er masken til?",nextId:"mask"},{label:"Jeg er frisk! (G)",nextId:"EXIT"}]},miasma:{text:"Drlig luft! Sykdom kommer av rtten luft som stiger opp fra jorden eller fra syke kropper. Den forstyrrer balansen i kroppen  blod, slim, gul og svart galle. Pesten... den er den verste ubalansen.",options:[{label:"Svartedauden?",nextId:"plague"},{label:"Hvordan kurerer man det?",nextId:"cure"}]},plague:{text:"Den store dden. Den kom med et skip til Bergen i 1349. Jeg s hele landsbyer tmmes. Prester dde mens de ga den siste olje. Det var som om Gud hadde forlatt oss. De som overlevde... vi er merket.",options:[{label:"Forferdelig.",nextId:"social"}]},social:{text:"Men se rundt deg! De frre vi er, jo mer verdt er hver mann. Bndene krever bedre lnn n. Tjenestepikene gr med silke. Verden er snudd p hodet etter pesten.",options:[{label:"En ny tid.",nextId:"start"}]},mask:{text:"Nebbet fylles med urter. Nellik, roser, mynte. Sterk lukt motvirker den drlige luften. Det er som et filter mot dden selv. Og kappen er innsatt med voks s pestloppene glir av.",options:[{label:"Smart oppfinnelse.",nextId:"cure"}]},cure:{text:'relating for  fjerne ondt blod. Kopping. Og Theriak  en blanding av over 60 ingredienser, inkludert ormekjtt og opium. Det beste rdet? "Cito, longe, tarde." Dra fort, dra langt, kom sent tilbake.',options:[{label:"Skal huske det.",nextId:"EXIT"}]}}},{id:"birkebeiner",name:"Gunnar",role:"Birkebeiner-opprrer",description:"En hardfr mann med slitte klr, men sverdet ved beltet er velstelt. Han ser mistenksomt mot dren hver gang den pnes.",conversation:{start:{text:"Hvem holder du med? Kongen eller Kirken? Baglerne eller Birkebeinerne? Svar fort, fr let blir varmt.",options:[{label:"Birkebeinerne!",nextId:"birkebeiner"},{label:"Jeg blander meg ikke.",nextId:"neutral"},{label:"Baglerne?",nextId:"bagler"},{label:"Ingen. (G)",nextId:"EXIT"}]},birkebeiner:{text:"Godt svar! Vi er kong Sverres menn. Mange av oss startet med ingenting, med never rundt leggene i snen. Men vi kjemper for norges rettmessige konge mot biskopenes tyranni!",options:[{label:"Hvorfor hater dere biskopene?",nextId:"church"},{label:"Fortell om Kong Sverre.",nextId:"sverre"}]},bagler:{text:"*Han spytter p gulvet* Kirkens lpegutter. De vil at paven i Roma skal styre Norge, ikke kongen. Pass deg, ellers tror jeg du er en spion.",options:[{label:"Jeg mente det ikke snn.",nextId:"start"}]},neutral:{text:"Ingen kan vre nytrale i borgerkrig. Nr bror dreper bror, m man velge side. Men kanskje det er klokest  holde kjeft, ja.",options:[{label:"Nettopp.",nextId:"start"}]},church:{text:'Erkebiskopen vil ha makt. Han nekter  krone Sverre! Han lyste ham i bann! Men Sverre talte Roma midt imot. "En tale mot biskopene", kalte han det. Han sa at kirken er rtten, og at kongen er innsatt av Gud, ikke av Paven.',options:[{label:"Sterke ord.",nextId:"start"}]},sverre:{text:"En prest fra Fryene som ble konge! Han er liten av vekst, men en kjempe i klkt. Han lrte oss  slss p en ny mte. Ikke bare storme frem, men bruke terrenget, sl til og forsvinne. Gerilja, kaller de det visst i sr.",options:[{label:"En taktiker.",nextId:"EXIT"}]}}},{id:"kone",name:"Ragnhild",role:"Klok Kone",description:"En eldre kvinne med grtt hr flettet med fargerike bnd. Hun har en kurv full av trkede planter og rtter p bordet.",conversation:{start:{text:"Har du en plage, ungen min? En verkebyll? Kjrlighetssorg? Eller kanskje kua di har sluttet  melke? Naturen har en bot for alt, hvis man vet hvor man skal lete.",options:[{label:"Er du en heks?",nextId:"witch"},{label:"Har du noe mot sr?",nextId:"herbs"},{label:"Jeg tror p bnner. (G)",nextId:"EXIT"}]},witch:{text:"Hysj! Ikke bruk det ordet. Prestene brenner folk for mindre. Jeg er en hjelper. Jeg bruker bare Guds skaperverk. Er det trolldom  vite at groblad stanser bldning? Nei, det er kunnskap.",options:[{label:"Unnskyld.",nextId:"signs"},{label:"Hva med magi?",nextId:"magic"}]},herbs:{text:"Groblad for sr. Ryllik for feber. Og johannesurt for de tunge tankene som kommer om vinteren. Og honning... honning er bra for alt. Det holder betennelsen borte.",options:[{label:"Nyttig  vite.",nextId:"start"}]},signs:{text:"Man m lese tegnene. Hvis rogna brer mye br, blir vinteren sntung. Hvis krka skriker mot nord, kommer det gjester. Det er ikke magi, det er  lytte til verden.",options:[{label:"Klokt.",nextId:"start"}]},magic:{text:"*Hun lener seg frem* Det finnes krefter... de underjordiske. Nissen p lven, Huldra i skogen. Man m vise dem respekt. Ofre litt grt, litt l. Kirken liker det ikke, men bonden vet at det er best  holde seg inne med dem.",options:[{label:"Best  vre forsiktig.",nextId:"EXIT"}]}}},{id:"skald",name:"Einar Skald",role:"Hoff-poet",description:"Han sitter med lukkede yne og trommer rytmisk p bordet. Plutselig slr han ut med hnden og deklamerer en strofe.",conversation:{start:{text:'"Sverdets sang, blodets brang, ravnens fang..." Nei, nei. Det mangler bokstavrim. En god drpa skal vre som et vevd teppe, hver ord skal lse det neste.',options:[{label:"Hva er en drpa?",nextId:"drapa"},{label:"Fortell en saga!",nextId:"saga"},{label:"Du virker intens. (G)",nextId:"EXIT"}]},drapa:{text:'Det ypperste av kvad! Et hyllingsdikt til en fyrste eller konge. Det m ha "stef"  et omkved som gjentas. Hvis jeg gjr en feil i versefoten foran Jarlen, kan jeg miste hodet. Eller verre, miste min re.',options:[{label:"Hres vanskelig ut.",nextId:"oral"},{label:"Hva er versefot?",nextId:"poetry"}]},saga:{text:'Ah, historiene. Ikke bare dikt, men sannheten om vre forfedre. Som historien om Egil Skallagrimsson... kriger og poet. Han reddet sitt eget liv ved  dikte "Hodelsningen" til Eirik Blodks. Ord er makt, min venn.',options:[{label:"Fortell om Egil.",nextId:"egil"}]},egil:{text:"Han var stygg som juling, men sterk som en bjrn. Og han kunne drepe med et sverd i n hnd og dikte med den andre. En gang spydde han over en hirdmann som prvde  fornrme ham! En ekte helt.",options:[{label:"Fargerik type.",nextId:"start"}]},oral:{text:"Vi brer historien i hodet. Bker kan brenne, men et godt kvede lever p folkemunne i tusen r. Det er min oppgave.  srge for at kongens bedrifter aldri glemmes. Jeg er levende historie.",options:[{label:"Imponerende hukommelse.",nextId:"start"}]},poetry:{text:'Det er regler! Fornyrdislag, Ljogahtt... du m bruke "Kenninger". Du sier ikke "sverd", du sier "sr-isl". Du sier ikke "blod", du sier "sverd-vann". Det gjr sprket rikt og gtefullt.',options:[{label:"Vakkert sprk.",nextId:"EXIT"}]}}}];function xG(t,e,n){const{setActiveTab:s,setProductionContext:i,viewMode:r,setViewMode:a,viewingRegionId:o,setViewingRegionId:c,activeTab:u}=gf(),d=o||t.regionId||"capital",[f,h]=_.useState(null),[m,g]=_.useState(null),[v,x]=_.useState(null),[p,b]=_.useState(null),[y,E]=_.useState("start"),[N,A]=_.useState(!1),[w,T]=_.useState(!1),[k,R]=_.useState(!1),C=_.useCallback(O=>{if(O==="kingdom")return 0;if(O==="global")return 1;const j=lr.find(I=>I.id===O);return j!=null&&j.parentId?3:2},[]),[B,z]=_.useState(r),[$,K]=_.useState("in");if(r!==B){const O=C(B),j=C(r);j>O?K("in"):j<O&&K("out"),z(r)}_.useEffect(()=>{const O=j=>{if(j.key==="Escape"){if(u!=="MAP")return;if(v){x(null);return}if(N){A(!1);return}if(w){T(!1);return}if(p){b(null);return}if(m){g(null);return}if(f){h(null);return}if(r!=="kingdom"){const I=lr.find(X=>X.id===r),H=I!=null&&I.parentId?lr.find(X=>X.id===I.parentId):null;a(r==="global"?"kingdom":H?H.id:"global")}}};return window.addEventListener("keydown",O),()=>window.removeEventListener("keydown",O)},[r,v,N,w,p,m,f,a,u]);const U=_.useCallback((O,j)=>{const I=typeof j=="string"?j:j.type||j.id,H=V=>V==="windmill_stones"?{buildingId:"windmill",type:"REFINE"}:V==="sawmill_blade"?{buildingId:"sawmill",type:"REFINE"}:V==="smeltery_furnace"?{buildingId:"smeltery",type:"REFINE"}:V==="bakery_oven"?{buildingId:"bakery",type:"REFINE"}:V==="weavery_loom"?{buildingId:"weavery",type:"REFINE"}:V==="forge_anvil"?{buildingId:"great_forge",type:"CRAFT"}:V==="apothecary_bench"?{buildingId:"apothecary",type:"CRAFT"}:null;if(I==="OPEN_CHICKEN_COOP"){T(!0),h(null);return}if(I==="OPEN_GARRISON"){i({buildingId:"watchtower",type:"CRAFT",initialView:"PRODUCE"}),s("PRODUCTION"),h(null);return}if(I==="OPEN_CONSTRUCTION"){R(!0),h(null);return}const X=H(O);if(X&&(I==="OPEN_CRAFTING"||I==="CRAFT"||I==="REFINE"||I.startsWith("REFINE_")||I.startsWith("CRAFT_")||Rn[I]||I==="REPAIR")){i({...X,initialView:I==="REPAIR"?"REPAIR":"PRODUCE"}),s("PRODUCTION"),h(null);return}const oe=d===t.regionId,Ie=t.role==="KING";if(!oe&&!Ie&&I!=="MARKET_VIEW"){alert("Du har ingen myndighet i dette baroniet.");return}if(I==="MARKET_VIEW")n();else if(I.startsWith("REFINE_")){const V=I.replace("REFINE_","").split("_")[0].toLowerCase();e({type:"REFINE",recipeId:{plank:"plank",flour:"flour",iron:"iron_ingot",steel:"iron_ingot",cloth:"cloth"}[V]||V})}else if(I.startsWith("CRAFT_")){const V=I.replace("CRAFT_","").toLowerCase();e(V==="bread"||V==="pie"||V==="mead"?{type:"REFINE",recipeId:V}:{type:"CRAFT",subType:V})}else if(I in Rn)e({type:"CRAFT",subType:I});else if(I.startsWith("BUILDING_UPGRADE_")){const V=I.replace("BUILDING_UPGRADE_","");x(V)}else if(I==="OPEN_DICE_GAME")A(!0);else if(I==="CHAT_LOCAL"){const V=B_[Math.floor(Math.random()*B_.length)];b(V),E("start")}else e(I==="BUY_MEAL"?{type:"BUY_MEAL"}:j);h(null)},[d,t,e,n,s,i,h]);return{viewMode:r,setViewMode:a,viewingRegionId:d,setViewingRegionId:c,selectedPOI:f,setSelectedPOI:h,selectedEvent:m,setSelectedEvent:g,upgradingBuildingId:v,setUpgradingBuildingId:x,dialogNPC:p,setDialogNPC:b,dialogStep:y,setDialogStep:E,isDiceGameOpen:N,setIsDiceGameOpen:A,isChickenCoopOpen:w,setIsChickenCoopOpen:T,isConstructionOpen:k,setIsConstructionOpen:R,direction:$,handlePOIAction:U}}const yG=({playerGold:t,onClose:e,onPlay:n})=>{const[s,i]=_.useState(1),[r,a]=_.useState(!1),[o,c]=_.useState([1,1]),[u,d]=_.useState([1,1]),[f,h]=_.useState("Plasser din innsats..."),[m,g]=_.useState(t);we.useEffect(()=>{g(t)},[t]);const v=()=>Math.floor(Math.random()*6)+1,x=()=>{if(r)return;if(s>t){h("Du har ikke nok gull!");return}if(s<.5){h("Minstesats er 0.5g");return}a(!0),h("Terningene ruller...");let y=0;const E=10,N=setInterval(()=>{c([v(),v()]),d([v(),v()]),y++,y>=E&&(clearInterval(N),p())},100)},p=()=>{const y=v(),E=v(),N=v(),A=v(),w=y+E,T=N+A;c([y,E]),d([N,A]);const k=w>T;k?(h(`DU VANT! ${w} mot ${T}`),g(R=>R+s)):(h(`HUSET VANT. ${T} mot ${w}`),g(R=>Math.max(0,R-s))),n({amount:s,isWin:k,playerRoll:w,houseRoll:T}),a(!1)},b=(y,E)=>l.jsx("div",{className:`w-16 h-16 rounded-xl shadow-[inset_0_0_10px_rgba(0,0,0,0.5)] flex bg-gradient-to-br ${E==="player"?"from-white to-slate-200 text-black":"from-red-600 to-red-800 text-white"} relative transition-transform duration-100 ${r?"animate-bounce":""}`,children:l.jsx("div",{className:"grid grid-cols-3 grid-rows-3 w-full h-full p-2 gap-1",children:[...Array(9)].map((N,A)=>{let w=!1;return y===1&&A===4&&(w=!0),y===2&&(A===0||A===8)&&(w=!0),y===3&&(A===0||A===4||A===8)&&(w=!0),y===4&&(A===0||A===2||A===6||A===8)&&(w=!0),y===5&&(A===0||A===2||A===4||A===6||A===8)&&(w=!0),y===6&&(A===0||A===2||A===3||A===5||A===6||A===8)&&(w=!0),l.jsx("div",{className:"flex items-center justify-center",children:w&&l.jsx("div",{className:`w-3 h-3 rounded-full ${E==="player"?"bg-black":"bg-white"} shadow-sm`})},A)})})});return l.jsxs("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/90 backdrop-blur-sm animate-in fade-in duration-500",children:[l.jsxs("div",{className:"absolute inset-0 z-0 opacity-50",children:[l.jsx("img",{src:"/Simulation_StandAlone_Pro/poi/tavern_dice_bg.png",alt:"Tavern Table",className:"w-full h-full object-cover"}),l.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-transparent to-black"})]}),l.jsxs("div",{className:"relative z-10 bg-[#1a472a]/90 border-[4px] border-[#5d4037] rounded-[2rem] shadow-[0_50px_100px_rgba(0,0,0,0.8)] w-full max-w-2xl overflow-hidden backdrop-blur-md",children:[l.jsx("div",{className:"absolute inset-0 border-2 border-[#8d6e63] rounded-[1.2rem] pointer-events-none opacity-50"}),l.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-[#d7ccc8] hover:text-white transition-colors bg-black/20 hover:bg-black/40 rounded-full w-8 h-8 flex items-center justify-center font-bold z-50",children:""}),l.jsxs("div",{className:"p-8 flex flex-col items-center gap-8 relative",children:[l.jsxs("div",{className:"text-center space-y-1",children:[l.jsx("h2",{className:"text-3xl font-black text-[#ffecb3] uppercase tracking-widest drop-shadow-md",style:{fontFamily:"serif"},children:"Spillebordet"}),l.jsx("div",{className:"text-[#a5d6a7] font-bold tracking-wider text-sm",children:"Huset vinner ved uavgjort"}),l.jsx("div",{className:"text-xs text-white/50 uppercase tracking-widest font-black",children:"Lykke til!"})]}),l.jsxs("div",{className:"flex justify-between w-full px-8 gap-8",children:[l.jsxs("div",{className:"flex flex-col items-center gap-4",children:[l.jsxs("span",{className:"text-[#90caf9] font-black uppercase tracking-widest text-xs",children:["Deg (",o[0]+o[1],")"]}),l.jsxs("div",{className:"flex gap-3",children:[b(o[0],"player"),b(o[1],"player")]})]}),l.jsx("div",{className:"flex items-center justify-center",children:l.jsx("span",{className:"text-2xl font-black text-white/20",children:"VS"})}),l.jsxs("div",{className:"flex flex-col items-center gap-4",children:[l.jsxs("span",{className:"text-[#ef9a9a] font-black uppercase tracking-widest text-xs",children:["Huset (",u[0]+u[1],")"]}),l.jsxs("div",{className:"flex gap-3",children:[b(u[0],"house"),b(u[1],"house")]})]})]}),l.jsx("div",{className:`h-12 flex items-center justify-center w-full bg-black/30 rounded-xl border border-white/5 transition-all ${f.includes("VANT")?"bg-green-900/40 border-green-500/30":f.includes("tapte")?"bg-red-900/40 border-red-500/30":""}`,children:l.jsx("span",{className:"font-bold text-lg text-[#fff8e1] tracking-wide",children:f})}),l.jsxs("div",{className:"w-full bg-black/20 p-6 rounded-2xl border border-white/5 flex flex-col gap-4",children:[l.jsxs("div",{className:"flex justify-between items-center text-[#d7ccc8] font-bold text-sm uppercase tracking-widest",children:[l.jsx("span",{children:"Innsats"}),l.jsxs("span",{children:["Din Saldo: ",l.jsxs("span",{className:"text-[#ffd54f]",children:[m.toFixed(1),"g"]})]})]}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("input",{type:"range",min:.5,max:Math.min(t,100),step:.5,value:s,onChange:y=>i(parseFloat(y.target.value)),className:"w-full h-3 bg-black/50 rounded-lg appearance-none cursor-pointer accent-[#ffb74d]",disabled:r}),l.jsxs("div",{className:"bg-black/40 px-4 py-2 rounded-xl text-[#ffd54f] font-black min-w-[5rem] text-center border border-white/10",children:[s,"g"]})]}),l.jsx("div",{className:"grid grid-cols-4 gap-2",children:[1,5,10,50].map(y=>l.jsxs("button",{onClick:()=>i(y),disabled:y>t||r,className:`py-1 rounded-lg text-xs font-bold uppercase tracking-widest transition-colors ${s===y?"bg-[#ffb74d] text-black":"bg-white/5 text-[#d7ccc8] hover:bg-white/10"}`,children:[y,"g"]},y))}),l.jsx("button",{onClick:x,disabled:r||t<s,className:`w-full py-4 rounded-xl font-black uppercase tracking-widest text-lg shadow-lg transform transition-all active:scale-[0.98] ${r?"bg-gray-600 cursor-not-allowed opacity-50":"bg-gradient-to-r from-[#ffca28] to-[#ff6f00] text-black hover:brightness-110 shadow-orange-900/40"}`,children:r?"Ruller...":"KAST TERNINGENE!"})]})]})]})]})};class _G{constructor(){ze(this,"listeners",[])}subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(n=>n!==e)}}emit(e){this.listeners.forEach(n=>n(e))}spawnFloatingText(e,n,s,i){const r=(Math.random()-.5)*4,a=(Math.random()-.5)*4;this.emit({id:Math.random().toString(36).substr(2,9),type:"FLOATING_TEXT",text:e,x:n+r,y:s+a,color:i,duration:1500})}spawnFlyingResource(e,n,s,i,r){this.emit({id:Math.random().toString(36).substr(2,9),type:"FLYING_RESOURCE",resource:e,startPoint:{x:n,y:s},endPoint:{x:i,y:r},duration:1e3})}spawnParticles(e,n,s){this.emit({id:Math.random().toString(36).substr(2,9),type:"PARTICLE",x:e,y:n,color:s,duration:800})}}const Ge=new _G,wG=({onComplete:t})=>{const[e,n]=_.useState([]),[s,i]=_.useState(!1),r=20,a=o=>{if(s)return;const c=o.currentTarget.getBoundingClientRect(),u=(o.clientX-c.left)/c.width*100,d=(o.clientY-c.top)/c.height*100,f={x:u,y:d,id:Date.now()};Ge.spawnParticles(u,d,"bg-emerald-400"),n(h=>{const m=[...h,f];return m.length>=r&&(i(!0),setTimeout(()=>t(1),1500)),m})};return l.jsxs("div",{onClick:a,className:"w-full h-[600px] relative overflow-hidden cursor-crosshair group active:scale-[0.99] transition-transform select-none",style:{backgroundImage:'url("/images/minigames/agriculture_bg.png")',backgroundSize:"cover",backgroundPosition:"center"},children:[l.jsx("div",{className:"absolute inset-0 bg-black/40 z-0 pointer-events-none"}),l.jsx("div",{className:"absolute top-10 left-1/2 -translate-x-1/2 pointer-events-none z-20 text-center",children:s?l.jsx("div",{className:"animate-in zoom-in duration-300",children:l.jsx("h2",{className:"text-5xl font-black text-emerald-400 drop-shadow-[0_4px_0_rgba(0,0,0,0.5)] uppercase tracking-tighter animate-bounce",children:"Mestrerlig Sdd! "})}):l.jsxs(l.Fragment,{children:[l.jsx("h2",{className:"text-3xl font-black text-white drop-shadow-md mb-2",children:"S dine fr"}),l.jsxs("div",{className:"bg-black/40 px-4 py-1 rounded-full text-emerald-400 font-bold uppercase tracking-widest text-sm inline-block",children:[e.length," / ",r]})]})}),e.map(o=>l.jsx("div",{className:"absolute w-4 h-4 bg-emerald-400 rounded-full shadow-[0_0_10px_rgba(52,211,153,0.8)] animate-in zoom-in duration-300",style:{left:`${o.x}%`,top:`${o.y}%`,transform:"translate(-50%, -50%)"},children:l.jsx("div",{className:"absolute -top-4 left-1/2 -translate-x-1/2 w-0.5 h-3 bg-white/50"})},o.id)),l.jsx("div",{className:"absolute inset-0 pointer-events-none z-10 hidden group-hover:block",children:l.jsx("div",{className:"absolute w-8 h-8 border-2 border-white/50 rounded-full -translate-x-1/2 -translate-y-1/2"})})]})},EG=(t,e)=>{if(e)return e.find(n=>{var r;if(!n)return!1;const s=Object.keys(Te).find(a=>n.id===a||n.id.startsWith(a+"_")),i=s?Te[s]:null;return(r=i==null?void 0:i.relevantActions)==null?void 0:r.includes(t)})},Kc=({onComplete:t,equipment:e=[],isMining:n,isQuarrying:s,isForaging:i,speedMultiplier:r=1,possibleYield:a=10,resourceName:o="Ressurs"})=>{const[c,u]=_.useState(0),[d,f]=_.useState([]),[h,m]=_.useState(!1),[g,v]=_.useState(!1),[x,p]=_.useState(!1),b=_.useRef(1),[y,E]=_.useState(50),N=_.useRef(1);_.useEffect(()=>{const T=k=>{k.code==="Space"&&(k.preventDefault(),A())};return window.addEventListener("keydown",T),()=>window.removeEventListener("keydown",T)},[d,h,c,y,e,r,x]),_.useEffect(()=>{if(d.length>=5||h||x)return;const T=setInterval(()=>{u(k=>{let R=2/r,C=k+R*b.current;return C>100?(b.current=-1,100):C<0?(b.current=1,0):C}),E(k=>{let C=k+.3*N.current;return Math.random()<.02&&(N.current*=-1),C>80?(N.current=-1,80):C<20?(N.current=1,20):C})},16);return()=>clearInterval(T)},[d.length,h,r,x]);const A=()=>{var U;if(d.length>=5||h||x)return;const T=Math.abs(c-y);let k=T<5?1:T<15?.7:T<25?.4:.1;const C=EG(n?"MINE":s?"QUARRY":i?"FORAGE":"WORK",e),B=((U=C==null?void 0:C.stats)==null?void 0:U.yieldBonus)||0,z=Math.ceil(a/5*(.5+k)),$=Math.ceil(B/5*(.5+k));T<15?(v(!0),p(!0),Ge.spawnParticles(50,40,T<5?"bg-amber-400":"bg-white"),T<5?Ge.spawnFloatingText(`PERFEKT! + ${z} ${$>0?`(+${$})`:""} `,50,40,"text-amber-400 font-black text-2xl"):Ge.spawnFloatingText(`Bra! +${z}`,50,40,"text-white font-bold"),setTimeout(()=>{v(!1),p(!1)},100)):Ge.spawnFloatingText("Svakt...",50,40,"text-slate-500 font-bold");const K=[...d,k];f(K),K.length===5&&(m(!0),setTimeout(()=>t(K.reduce((O,j)=>O+j,0)/5),800))},w=n||s?'url("/images/minigames/mining_bg.png")':i?'url("/images/minigames/foraging_bg.png")':'url("/images/minigames/agriculture_bg.png")';return l.jsxs("div",{className:`p-8 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden ${g?"animate-shake":""} `,style:{backgroundImage:w,backgroundSize:"cover",backgroundPosition:"center"},children:[l.jsx("div",{className:`absolute inset-0 bg-black/70 z-0 transition-all duration-75 ${x?"bg-indigo-900/50 mix-blend-hard-light":""}`}),l.jsxs("div",{className:`relative z-10 w-full flex flex-col items-center transition-all duration-75 ${x?"scale-105 brightness-150 contrast-125":""}`,children:[l.jsx("h2",{className:"text-4xl font-black text-white mb-8 drop-shadow-lg tracking-tighter uppercase",children:n?"Gruvedrift":s?"Steinhugger":i?"Sanking":"Kornhsting"}),h?l.jsx("div",{className:"py-12 animate-bounce text-5xl font-black text-amber-500 uppercase tracking-tighter drop-shadow-[0_0_20px_rgba(245,158,11,0.5)]",children:"FERDIG! "}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"mb-4 text-xs font-black text-amber-500 uppercase tracking-widest",children:o}),l.jsxs("div",{className:"w-full h-8 bg-white/5 rounded-full mb-12 relative border border-white/10 overflow-hidden shadow-inner",children:[l.jsx("div",{className:"absolute inset-y-0 bg-amber-500/30 border-x border-amber-500/50 transition-all duration-75 linear",style:{left:`${y-8}%`,right:`${100-(y+8)}%`}}),l.jsx("div",{className:"absolute inset-y-0 w-0.5 bg-amber-400/80 z-0",style:{left:`${y}%`}}),l.jsx("div",{className:"absolute inset-y-0 w-1 bg-white shadow-[0_0_20px_white] z-10",style:{left:`${c}% `}})]}),l.jsx("button",{onClick:A,className:`w-full bg-amber-500 hover:bg-amber-400 text-slate-950 py-7 rounded-[2rem] font-black text-2xl shadow-2xl transition-all uppercase tracking-widest border-b-4 border-amber-700 ${x?"scale-95 brightness-125":"active:scale-95"}`,children:"KLIKK N! "})]})]})]})},NG=({onComplete:t,speedMultiplier:e=1})=>{const[n,s]=_.useState(50),[i,r]=_.useState(50),[a,o]=_.useState(0),[c,u]=_.useState(!1),[d,f]=_.useState(!1),[h,m]=_.useState(!1),g=_.useRef(1);_.useEffect(()=>{if(c||h)return;const x=setInterval(()=>{s(p=>{let b=p+.8*g.current*e;return b>90?(g.current=-1,90):b<10?(g.current=1,10):b})},16);return()=>clearInterval(x)},[c,e,h]),_.useEffect(()=>{const x=p=>{p.code==="Space"&&(p.preventDefault(),v({clientX:window.innerWidth/2,clientY:window.innerHeight/2}))};return window.addEventListener("keydown",x),()=>window.removeEventListener("keydown",x)},[c,i,n,h]);const v=x=>{if(c||h)return;const p=Math.abs(i-n),b=x.clientX,y=x.clientY;p<12?(f(!0),m(!0),o(E=>{const N=E+1;return N>=5&&(u(!0),Ge.spawnFloatingText("MESTERVERK! ",b,y-60,"text-amber-400 text-3xl font-black"),setTimeout(()=>t(1),1200)),N}),Ge.spawnParticles(b,y,"bg-amber-400"),Ge.spawnFloatingText("KLANG!",b,y-40,"text-amber-500 font-black"),setTimeout(()=>{f(!1),m(!1)},100)):p<25?(Ge.spawnFloatingText("Treff",b,y-40,"text-white font-bold"),Ge.spawnParticles(b,y,"bg-white")):Ge.spawnFloatingText("BOM!",b,y-40,"text-slate-500 font-bold")};return l.jsxs("div",{onMouseMove:x=>{const p=x.currentTarget.getBoundingClientRect();r((x.clientX-p.left)/p.width*100)},onClick:v,className:`p-12 min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden cursor-crosshair ${d?"animate-shake":""}`,style:{backgroundImage:'url("/images/minigames/smithing_bg.png")',backgroundSize:"cover"},children:[l.jsx("div",{className:`absolute inset-0 bg-black/70 z-0 transition-all duration-75 ${h?"bg-amber-900/40 mix-blend-hard-light":""}`}),l.jsxs("div",{className:`relative z-10 text-center mb-12 transition-all duration-75 ${h?"scale-105 brightness-150 contrast-125":""}`,children:[l.jsx("h2",{className:"text-4xl font-black text-white uppercase tracking-tighter drop-shadow-xl",children:"Smedarbeid"}),l.jsxs("div",{className:"text-amber-500 font-black uppercase tracking-widest text-xs mt-2 bg-black/40 px-4 py-1 rounded-full border border-amber-500/20",children:["Slag: ",a," / 5"]})]}),l.jsxs("div",{className:`relative z-10 w-full max-w-2xl space-y-4 transition-all duration-75 ${h?"scale-105":""}`,children:[l.jsxs("div",{className:"w-full h-24 bg-slate-900/50 rounded-2xl border-2 border-white/10 shadow-2xl flex items-center px-4 overflow-hidden",children:[l.jsx("div",{className:"absolute inset-0 bg-amber-500/5 transition-all duration-1000",style:{opacity:a/5}}),l.jsxs("div",{className:"relative w-full h-4 bg-white/5 rounded-full overflow-hidden",children:[l.jsx("div",{className:"absolute inset-y-0 w-24 bg-amber-500/40 blur-sm mix-blend-screen transition-all duration-75",style:{left:`${n}%`,transform:"translateX(-50%)"}}),l.jsx("div",{className:"absolute inset-y-0 w-12 bg-white/40 blur-[2px]",style:{left:`${n}%`,transform:"translateX(-50%)"}}),l.jsx("div",{className:"absolute inset-y-0 w-1 bg-white shadow-[0_0_15px_white] z-20",style:{left:`${i}%`,transform:"translateX(-50%)"}})]})]}),l.jsxs("div",{className:"flex items-center gap-4 px-2",children:[l.jsx("div",{className:"flex-1 h-2 bg-black/40 rounded-full overflow-hidden border border-white/5",children:l.jsx("div",{className:"h-full bg-gradient-to-r from-amber-600 to-amber-400 transition-all duration-500",style:{width:`${a/5*100}%`}})}),l.jsxs("span",{className:"text-[10px] font-black text-amber-500 uppercase tracking-widest",children:[Math.round(a/5*100),"%"]})]})]}),c&&l.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm animate-in fade-in zoom-in duration-300",children:l.jsx("div",{className:"text-6xl font-black text-amber-500 animate-bounce drop-shadow-[0_0_30px_rgba(245,158,11,0.5)]",children:"FERDIG! "})}),l.jsx("div",{className:`mt-12 text-slate-400 text-sm font-bold uppercase tracking-widest animate-pulse relative z-10 transition-opacity ${h?"opacity-0":"opacity-100"}`,children:"Klikk nr markren er over den gldende sonen"})]})},kG=({onComplete:t,speedMultiplier:e=1,icon:n=""})=>{const[s,i]=_.useState(0),[r,a]=_.useState(!1),[o,c]=_.useState(null),[u,d]=_.useState(0),[f,h]=_.useState(80),m=_.useRef(-1);_.useEffect(()=>{if(r||o)return;const v=setInterval(()=>{i(p=>{const b=p+1*e;return b>=100?(c("BRENT! "),setTimeout(()=>{c(null),i(0)},1e3),0):b})},50),x=setInterval(()=>{h(p=>{let y=p+.8*m.current;return y>90?(m.current=-1,90):y<40?(m.current=1,40):y})},50);return()=>{clearInterval(v),clearInterval(x)}},[r,o,e]),_.useEffect(()=>{const v=x=>{x.code==="Space"&&(x.preventDefault(),g())};return window.addEventListener("keydown",v),()=>window.removeEventListener("keydown",v)},[r,o,s,f]);const g=()=>{if(r||o)return;const v=f-10,x=f+10;s>v&&s<x?(c("PERFEKT GYLLEN! "),d(p=>{const b=p+1;return b>=3&&(a(!0),setTimeout(()=>t(1),1e3)),b})):s<v?c("R... "):c("LITT BRENT... "),setTimeout(()=>{c(null),i(0)},1e3)};return l.jsxs("div",{className:"p-12 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden",style:{backgroundImage:'url("/images/minigames/bakery_bg.png")',backgroundSize:"cover"},children:[l.jsx("div",{className:"absolute inset-0 bg-black/70 z-0"}),l.jsx("h2",{className:"relative z-10 text-4xl font-black text-white mb-8 tracking-tighter uppercase italic",children:"Bakeri: Steking "}),l.jsxs("div",{className:"relative z-10 w-64 h-64 bg-slate-900 border-8 border-amber-900 rounded-3xl flex items-center justify-center overflow-hidden mb-12 shadow-2xl",children:[l.jsx("div",{className:"absolute inset-0 bg-orange-500/10 animate-pulse"}),l.jsx("div",{className:"text-8xl transition-all duration-300 transform",style:{filter:`grayscale(${100-s}%) sepia(${s}%)`,transform:`scale(${.8+s/500})`},children:n}),o&&l.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center text-white font-black text-2xl p-4 animate-in zoom-in",children:o})]}),l.jsxs("div",{className:`relative z-10 w-full max-w-sm h-8 bg-white/10 rounded-full mb-12 border ${s>f-10&&s<f+10?"border-emerald-500 shadow-[0_0_15px_rgba(16,185,129,0.5)]":"border-white/10"} overflow-hidden transition-all shadow-2xl`,children:[l.jsx("div",{className:"absolute inset-y-0 bg-emerald-500/30 border-x border-emerald-500/50 transition-all duration-75 ease-linear",style:{left:`${f-10}%`,right:`${100-(f+10)}%`},children:s>f-10&&s<f+10&&l.jsx("div",{className:"absolute inset-0 bg-emerald-400/20 animate-pulse"})}),l.jsx("div",{className:"h-full bg-orange-500 transition-all duration-75 relative z-10 opacity-80",style:{width:`${s}% `}}),l.jsx("div",{className:"absolute top-0 bottom-0 w-1 bg-white/50 z-20",style:{left:`${f}%`}})]}),l.jsx("div",{className:"relative z-10 flex gap-4 mb-8",children:[...Array(3)].map((v,x)=>l.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center text-2xl border-2 transition-all ${u>x?"bg-amber-500 border-amber-300 scale-110 shadow-lg":"bg-white/5 border-white/10 opacity-30"} `,children:n},x))}),l.jsx("button",{onClick:g,className:"relative z-10 w-full max-w-sm bg-amber-600 hover:bg-amber-500 text-white py-6 rounded-2xl font-black text-2xl shadow-xl active:scale-95 transition-all uppercase tracking-widest border-b-8 border-amber-800",children:"TA UT N! "})]})},SG=(t,e)=>{if(e)return e.find(n=>{var r;if(!n)return!1;const s=Object.keys(Te).find(a=>n.id===a||n.id.startsWith(a+"_")),i=s?Te[s]:null;return(r=i==null?void 0:i.relevantActions)==null?void 0:r.includes(t)})},TG=({onComplete:t,equipment:e=[]})=>{const[n,s]=_.useState(0),[i,r]=_.useState(!1),[a,o]=_.useState(!1),[c,u]=_.useState(0),[d,f]=_.useState({x:50,y:50}),[h,m]=_.useState(!1),g=()=>f({x:20+Math.random()*60,y:20+Math.random()*60}),v=p=>{if(a)return;o(!0),r(!0);const b=n+1;s(b);const y=b>5,E=b>2?`${b}x COMBO!`:y?"FLAWLESS!":"TREFF!",N=y?"text-amber-400 font-display":"text-white";Ge.spawnFloatingText(E,p.clientX,p.clientY-40,N),Ge.spawnParticles(p.clientX,p.clientY,y?"bg-amber-400":"bg-white"),setTimeout(()=>{o(!1),r(!1),u(A=>(A+1>=10&&(m(!0),Ge.spawnFloatingText("FULLFRT! ",p.clientX,p.clientY-100,"text-emerald-400 text-2xl"),setTimeout(()=>t(1),1200)),A+1)),g()},80)},x=SG("CHOP",e);return l.jsxs("div",{className:`p-8 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden ${i?"animate-shake":""} `,style:{backgroundImage:'url("/images/minigames/forestry_bg.png")',backgroundSize:"cover"},children:[l.jsx("div",{className:"absolute inset-0 bg-black/60 z-0"}),l.jsx("div",{className:"relative z-10 w-full mb-8",children:l.jsxs("div",{className:"flex flex-col items-center gap-2",children:[l.jsx("h2",{className:"text-4xl font-black text-white drop-shadow-lg tracking-tighter uppercase",children:"Tmmerhogging"}),l.jsxs("div",{className:"flex gap-4",children:[l.jsxs("div",{className:"text-amber-400 font-black uppercase tracking-widest text-xs px-4 py-1 bg-black/40 rounded-full inline-block border border-amber-500/20",children:["Framdrift: ",c,"/10"]}),n>0&&l.jsxs("div",{className:"text-rose-500 font-black uppercase tracking-widest text-xs px-4 py-1 bg-rose-500/10 rounded-full inline-block border border-rose-500/30 animate-bounce",children:["COMBO: x",n]}),x&&l.jsxs("div",{className:"text-indigo-400 font-black uppercase tracking-widest text-xs px-4 py-1 bg-indigo-500/10 rounded-full inline-block border border-indigo-500/30",children:[x.icon," ",x.name]})]})]})}),l.jsxs("div",{className:`relative z-10 w-full h-96 bg-white/5 rounded-[3rem] border border-white/10 shadow-inner overflow-hidden ${a?"opacity-90 grayscale-[0.5]":""}`,children:[l.jsx("div",{className:"absolute bottom-0 left-0 h-2 bg-indigo-500/50 transition-all duration-300 z-0",style:{width:`${c/10*100}%`}}),h?l.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-4",children:[l.jsx("div",{className:"animate-bounce text-5xl font-black text-amber-500 uppercase tracking-tighter drop-shadow-2xl",children:"VEDHOGST FERDIG! "}),l.jsxs("div",{className:"text-xl font-black text-white uppercase tracking-widest bg-indigo-600 px-8 py-2 rounded-full shadow-lg",children:["Maks Combo: ",n]})]}):l.jsx("button",{onClick:v,className:`absolute w-20 h-20 bg-rose-500 rounded-full border-4 border-white shadow-[0_0_30px_rose] transition-all active:scale-90 ${a?"scale-110 brightness-150":"animate-pulse cursor-pointer"}`,style:{left:`${d.x}%`,top:`${d.y}%`,transform:"translate(-50%, -50%)"},children:""})]})]})},AG=(t,e)=>{if(e)return e.find(n=>{var r;if(!n)return!1;const s=Object.keys(Te).find(a=>n.id===a||n.id.startsWith(a+"_")),i=s?Te[s]:null;return(r=i==null?void 0:i.relevantActions)==null?void 0:r.includes(t)})},U_=({onComplete:t,equipment:e=[],speedMultiplier:n=1,possibleYield:s=10,resourceName:i="Korn"})=>{const[r,a]=_.useState(0),[o,c]=_.useState(0),[u,d]=_.useState(!1),[f,h]=_.useState(!1),[m,g]=_.useState(!1),v=()=>{u||m||a(x=>{var b;const p=x+2*n;if(p>=100){const y=AG("WORK",e),E=((b=y==null?void 0:y.stats)==null?void 0:b.yieldBonus)||0,N=Math.ceil(s/5*1.25),A=Math.ceil(E/5*1.25);return h(!0),g(!0),Ge.spawnFloatingText(`+ ${N} ${i} ${A>0?`(+${A})`:""} `,50,40,"text-amber-400 font-black text-xl"),Ge.spawnParticles(50,50,"bg-emerald-400"),setTimeout(()=>{h(!1),g(!1)},100),c(w=>(w+1>=5&&(d(!0),setTimeout(()=>t(1),800)),w+1)),0}return p})};return l.jsxs("div",{onMouseMove:v,className:`p-8 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden ${f?"animate-shake":""} `,style:{backgroundImage:'url("/images/minigames/agriculture_bg.png")',backgroundSize:"cover"},children:[l.jsx("div",{className:`absolute inset-0 bg-black/50 z-0 transition-all duration-75 ${m?"bg-emerald-900/40 mix-blend-hard-light":""}`}),l.jsxs("div",{className:`relative z-10 w-full flex flex-col items-center transition-all duration-75 ${m?"scale-105 brightness-150 contrast-125":""}`,children:[l.jsx("h2",{className:"text-3xl font-black text-white mb-4",children:"Scythe Sweep"}),l.jsx("div",{className:"w-full h-4 bg-white/10 rounded-full mb-8 border border-white/20 overflow-hidden",children:l.jsx("div",{className:"h-full bg-amber-400 transition-all duration-75",style:{width:`${r}% `}})}),l.jsx("div",{className:"grid grid-cols-5 gap-2",children:[...Array(5)].map((x,p)=>l.jsx("div",{className:`w-8 h-8 rounded-lg border-2 ${o>p?"bg-amber-500 border-amber-300":"border-white/20"} `},p))}),l.jsx("div",{className:"mt-8 text-slate-400 text-sm font-bold uppercase tracking-widest animate-pulse",children:"Beveg musen raskt frem og tilbake!"})]})]})},RG=({onComplete:t,speedMultiplier:e=1})=>{const[n,s]=_.useState(0),[i,r]=_.useState(0),[a,o]=_.useState(!1),[c,u]=_.useState(50),[d,f]=_.useState(1);_.useEffect(()=>{if(a)return;const m=setInterval(()=>{s(g=>{let v=3/e,x=g+v*d;return x>100?(f(-1),100):x<0?(f(1),0):x})},16);return()=>clearInterval(m)},[d,a,e]);const h=()=>{Math.abs(n-c)<10&&(r(g=>(Ge.spawnFloatingText("FANT DEN! ",50,40,"text-sky-400"),g+1>=3&&(o(!0),setTimeout(()=>t(1),800)),g+1)),u(20+Math.random()*60))};return l.jsxs("div",{className:"p-12 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden",style:{backgroundImage:'url("/images/minigames/foraging_bg.png")',backgroundSize:"cover"},children:[l.jsx("div",{className:"absolute inset-0 bg-black/70 z-0"}),l.jsx("h2",{className:"relative z-10 text-4xl font-black text-white mb-12 tracking-tighter uppercase italic",children:"Snarefiske "}),l.jsxs("div",{className:"relative z-10 w-full max-w-sm h-12 bg-white/5 rounded-full border border-white/10 mb-12 shadow-inner",children:[l.jsx("div",{className:"absolute inset-y-0 w-20 bg-amber-500/40 border-x-2 border-amber-500/50 rounded-lg blur-[2px]",style:{left:`${c}% `,transform:"translateX(-50%)"}}),l.jsx("div",{className:"absolute inset-y-0 w-2 bg-white shadow-[0_0_15px_white]",style:{left:`${n}% `}})]}),l.jsx("div",{className:"relative z-10 flex gap-4 mb-12",children:[...Array(3)].map((m,g)=>l.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center text-2xl border-2 transition-all ${i>g?"bg-amber-500 border-amber-300 scale-110":"bg-white/5 border-white/10 opacity-30 shadow-inner"} `,children:""},g))}),l.jsx("button",{onClick:h,className:"relative z-10 w-full max-w-md bg-sky-500 hover:bg-sky-400 text-white py-7 rounded-[2rem] font-black text-2xl shadow-2xl active:scale-95 transition-all uppercase tracking-widest border-b-4 border-sky-700",children:"HAL INN! "})]})},IG=({onComplete:t,speedMultiplier:e=1})=>{const[n,s]=_.useState("right"),[i,r]=_.useState(0),[a,o]=_.useState(!1),[c,u]=_.useState(null),d=f=>{a||f!==n&&(s(f),r(h=>{const m=h+5*e;return m>=100?(o(!0),setTimeout(()=>t(1),1e3),100):m}),u(f==="left"?"":""),setTimeout(()=>u(null),200))};return _.useEffect(()=>{const f=h=>{(h.key==="ArrowLeft"||h.key==="a"||h.key==="A")&&d("left"),(h.key==="ArrowRight"||h.key==="d"||h.key==="D")&&d("right")};return window.addEventListener("keydown",f),()=>window.removeEventListener("keydown",f)},[n,a]),l.jsxs("div",{className:"p-12 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden",style:{backgroundImage:'url("/images/minigames/weavery_bg.png")',backgroundSize:"cover"},children:[l.jsx("div",{className:"absolute inset-0 bg-black/70 z-0"}),l.jsx("h2",{className:"relative z-10 text-4xl font-black text-white mb-8 tracking-tighter uppercase italic",children:"Veveri: Vevstol "}),l.jsxs("div",{className:`relative z-10 w-full max-w-lg aspect-video bg-slate-900/50 border-4 rounded-3xl p-8 mb-12 flex flex-col justify-between overflow-hidden transition-all ${c?"brightness-125":""} ${n==="left"?"border-indigo-500/50 shadow-[inset_20px_0_40px_rgba(99,102,241,0.1)]":"border-emerald-500/50 shadow-[inset_-20px_0_40px_rgba(16,185,129,0.1)]"} `,children:[l.jsxs("div",{className:"flex justify-between items-center mb-8 relative h-32",children:[l.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 text-6xl transition-all duration-300 ease-out z-20",style:{left:n==="left"?"0%":"calc(100% - 4rem)",transform:`translateY(-50%) rotate(${n==="left"?"0deg":"180deg"})`},children:""}),l.jsx("div",{className:`text-6xl transition-all duration-500 ${n==="left"?"scale-110 opacity-100 rotate-12":"scale-75 opacity-20"} `,children:""}),l.jsx("div",{className:"absolute inset-x-0 h-1 bg-white/20 top-1/2 -translate-y-1/2 pointer-events-none"}),l.jsx("div",{className:`text-6xl transition-all duration-500 ${n==="right"?"scale-110 opacity-100 -rotate-12":"scale-75 opacity-20"} `,children:""})]}),l.jsx("div",{className:"text-sm font-black text-indigo-300 uppercase tracking-[0.3em] h-8 animate-pulse",children:c||"Veksle mellom Venstre / Hyre"})]}),l.jsxs("div",{className:"relative z-10 flex gap-12 mb-8",children:[l.jsx("button",{onClick:()=>d("left"),className:`w-28 h-28 rounded-[2rem] flex items-center justify-center text-4xl border-4 transition-all active:scale-90 ${n==="right"?"bg-indigo-600 border-indigo-400 scale-110 shadow-[0_0_30px_rgba(99,102,241,0.5)]":"bg-white/5 border-white/10 opacity-30 shadow-inner"} `,children:""}),l.jsx("button",{onClick:()=>d("right"),className:`w-28 h-28 rounded-[2rem] flex items-center justify-center text-4xl border-4 transition-all active:scale-90 ${n==="left"?"bg-emerald-600 border-emerald-400 scale-110 shadow-[0_0_30px_rgba(16,185,129,0.5)]":"bg-white/5 border-white/10 opacity-30 shadow-inner"} `,children:""})]}),l.jsx("div",{className:"relative z-10 w-full max-w-sm h-4 bg-white/10 rounded-full border border-white/10 overflow-hidden",children:l.jsx("div",{className:"h-full bg-indigo-500 transition-all duration-300",style:{width:`${i}% `}})})]})},CG=({onComplete:t,speedMultiplier:e=1})=>{var g;const[n,s]=_.useState([]),[i,r]=_.useState([]),[a,o]=_.useState(0),[c,u]=_.useState(!1),[d,f]=_.useState(null),h=[{id:"red",icon:"",label:"Rdurt"},{id:"blue",icon:"",label:"Blbr"},{id:"green",icon:"",label:"Grnnmose"},{id:"yellow",icon:"",label:"Gulrot"}];_.useEffect(()=>{const v=[];for(let x=0;x<5;x++)v.push(h[Math.floor(Math.random()*h.length)].id);s(v)},[]);const m=v=>{if(!(c||d))if(v===n[a]){const x=a+1;r(p=>[...p,v]),o(x),f("RIKTIG! "),setTimeout(()=>f(null),500),x>=n.length&&(u(!0),setTimeout(()=>t(1),1e3))}else f("FEIL... "),o(0),r([]),setTimeout(()=>f(null),1e3)};return l.jsxs("div",{className:"p-12 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden",style:{backgroundImage:'url("/images/minigames/apothecary_bg.png")',backgroundSize:"cover"},children:[l.jsx("div",{className:"absolute inset-0 bg-black/70 z-0"}),l.jsx("h2",{className:"relative z-10 text-4xl font-black text-white mb-8 tracking-tighter uppercase italic",children:"Apoteker: Brygging "}),l.jsx("div",{className:"relative z-10 mb-12 flex gap-4 h-24 items-center",children:n.map((v,x)=>{var p;return l.jsx("div",{className:`w-16 h-16 rounded-2xl flex items-center justify-center text-3xl transition-all border-2 border-white/10 ${a>x?"opacity-10 scale-90":"bg-black/40 scale-100"} `,children:(p=h.find(b=>b.id===v))==null?void 0:p.icon},x)})}),d&&l.jsx("div",{className:`relative z-10 text-3xl font-black mb-8 animate-in zoom-in ${d.includes("FEIL")?"text-rose-500":"text-emerald-400"} `,children:d}),l.jsxs("div",{className:"relative z-10 w-48 h-64 bg-white/5 border-4 border-white/20 rounded-b-[4rem] rounded-t-3xl overflow-hidden mb-12 shadow-inner",children:[l.jsx("div",{className:"absolute bottom-0 inset-x-0 transition-all duration-1000 ease-out",style:{height:`${a/n.length*100}%`,backgroundColor:a>0?(g=h.find(v=>v.id===n[a-1]))==null?void 0:g.id:"transparent",opacity:.6},children:l.jsx("div",{className:"absolute top-0 inset-x-0 h-4 bg-white/20 animate-pulse pointer-events-none"})}),l.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-6xl opacity-20 transition-transform duration-500 scale-125",children:""})]}),l.jsx("div",{className:"relative z-10 grid grid-cols-2 gap-4",children:h.map(v=>l.jsxs("button",{onClick:()=>m(v.id),className:`w-32 h-32 bg-slate-900/80 border-2 rounded-3xl flex flex-col items-center justify-center transition-all active:scale-90 shadow-xl group ${d==="RIKTIG! "&&n[a-1]===v.id?"border-emerald-500 scale-105 shadow-emerald-500/20":"border-white/20 hover:border-white/40"} `,children:[l.jsx("span",{className:"text-4xl mb-2 group-hover:scale-110 transition-transform",children:v.icon}),l.jsx("span",{className:"font-bold text-white uppercase text-sm",children:v.label})]},v.id))})]})},jG=({onComplete:t,speedMultiplier:e=1})=>{const[n,s]=_.useState(0),[i,r]=_.useState(0),[a,o]=_.useState(!0),[c,u]=_.useState(0),[d,f]=_.useState(!1),[h,m]=_.useState(1);_.useEffect(()=>{if(d)return;const v=setInterval(()=>{u(x=>{let p=x+h*3*e;return p>=100?(m(-1),100):p<=0?(m(1),0):p})},16);return()=>clearInterval(v)},[h,d,e]);const g=_.useCallback(v=>{if(d)return;const x=Math.abs(c-50),p=x<15,b=x>35;let y=0,E="",N="";p?(y=1,E="PERFEKT!",N="text-amber-400"):b?(y=.1,E="BOM!",N="text-rose-400"):(y=.5,E="BRA!",N="text-emerald-400");const A="clientX"in v?v.clientX:v.touches[0].clientX,w="clientY"in v?v.clientY:v.touches[0].clientY;Ge.spawnFloatingText(E,A,w-40,N),y>.1&&Ge.spawnParticles(A,w,y===1?"bg-amber-400":"bg-emerald-400"),r(k=>k+1),o(!a);const T=y*10;s(k=>{const R=k+T;return R>=100?(f(!0),Ge.spawnFloatingText("PLANKER FERDIG! ",A,w-100,"text-emerald-400 text-2xl font-black"),setTimeout(()=>t(1),1e3),100):R})},[c,d,a,t]);return l.jsxs("div",{className:"p-12 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden",children:[l.jsxs("div",{className:"absolute inset-0 bg-slate-950 z-0",children:[l.jsx("div",{className:"absolute inset-0 opacity-20 bg-[url('/images/textures/wood_pattern.png')] bg-repeat"}),l.jsx("div",{className:"absolute inset-x-0 bottom-0 h-32 bg-gradient-to-t from-indigo-500/10 to-transparent"})]}),l.jsxs("div",{className:"relative z-10 w-full mb-12",children:[l.jsx("h2",{className:"text-5xl font-black text-white uppercase tracking-tighter mb-2 italic drop-shadow-[0_0_20px_rgba(255,255,255,0.2)]",children:"Saging"}),l.jsx("p",{className:"text-slate-400 font-bold uppercase tracking-[0.3em] text-xs",children:"Pull og Push i takt for perfekte planker"})]}),l.jsxs("div",{className:"relative z-10 w-full max-w-2xl h-64 bg-slate-900/50 rounded-[3rem] border border-white/5 shadow-2xl overflow-hidden flex items-center justify-center group cursor-pointer",onClick:g,children:[l.jsx("div",{className:"absolute inset-y-0 left-0 bg-indigo-500/20 transition-all duration-500 z-0",style:{width:`${n}%`}}),l.jsxs("div",{className:"relative w-4/5 h-16 bg-[#3d2b1f] rounded-lg border-2 border-[#2a1d15] shadow-2xl flex items-center",children:[l.jsx("div",{className:"absolute inset-0 opacity-30 bg-[url('/images/textures/bark.png')] bg-cover mix-blend-overlay"}),l.jsx("div",{className:`absolute top-1/2 left-1/2 -translate-y-1/2 -translate-x-1/2 transition-transform duration-300 ${a?"-rotate-12 translate-x-4":"rotate-12 -translate-x-4"}`,children:l.jsx("div",{className:"text-6xl filter drop-shadow-[0_0_15px_rgba(255,255,255,0.3)]",children:""})}),l.jsxs("div",{className:"absolute bottom-0 left-1/2 -translate-x-1/2 flex gap-1 opacity-40",children:[l.jsx("div",{className:"w-1 h-1 bg-amber-200 rounded-full animate-ping"}),l.jsx("div",{className:"w-1 h-1 bg-amber-400 rounded-full animate-ping delay-75"}),l.jsx("div",{className:"w-1 h-1 bg-amber-100 rounded-full animate-ping delay-150"})]})]})]}),l.jsxs("div",{className:"relative z-10 mt-12 w-full max-w-md h-12 bg-black/40 rounded-full border border-white/10 p-1 flex items-center shadow-inner",children:[l.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 w-1/4 h-3/4 bg-amber-500/20 blur-sm rounded-full"}),l.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 w-[2px] h-full bg-amber-500/50"}),l.jsx("div",{className:"absolute w-8 h-8 bg-white rounded-full shadow-[0_0_20px_white] flex items-center justify-center transition-all duration-16 ease-linear",style:{left:`${c}%`,transform:"translateX(-50%)"},children:l.jsx("div",{className:"w-4 h-4 bg-indigo-500 rounded-full animate-pulse"})})]}),l.jsxs("div",{className:"relative z-10 mt-8",children:[l.jsxs("div",{className:"text-3xl font-black text-indigo-400 italic",children:[n.toFixed(0),"%"]}),l.jsxs("div",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mt-2",children:["Stroke: ",i]})]}),l.jsx("div",{className:"absolute inset-0 z-20 cursor-pointer",onClick:g})]})},OG=({onComplete:t,speedMultiplier:e=1})=>{const[n,s]=_.useState(20),[i]=_.useState({min:60,max:85}),[r,a]=_.useState(0),[o,c]=_.useState(!1),u=_.useRef(null),d=_.useRef(null),f=m=>{if(!o){if(d.current===void 0||d.current===null){d.current=m,u.current=requestAnimationFrame(f);return}if(d.current!==void 0){const g=m-d.current;s(v=>Math.max(0,v-.015*g*e)),s(v=>(v>=i.min&&v<=i.max&&a(x=>{const p=x+.01*g;return p>=100&&!o&&(c(!0),Ge.spawnFloatingText("PERFEKT TEMPERATUR! ",window.innerWidth/2,window.innerHeight/2,"text-orange-500 text-4xl font-black"),setTimeout(()=>t(1),1e3)),p}),v))}d.current=m,u.current=requestAnimationFrame(f)}};_.useEffect(()=>(u.current=requestAnimationFrame(f),()=>{u.current&&cancelAnimationFrame(u.current)}),[o]);const h=()=>{o||(s(m=>Math.min(100,m+12)),Ge.spawnParticles(window.innerWidth/2,window.innerHeight/2+100,"bg-orange-500"),Ge.spawnFloatingText("PUST!",window.innerWidth/2,window.innerHeight/2+50,"text-slate-400 font-bold text-xs uppercase"))};return l.jsxs("div",{onClick:h,className:"p-12 min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden cursor-pointer select-none",style:{backgroundImage:'url("/images/minigames/smeltery_bg.png")',backgroundSize:"cover"},children:[l.jsx("div",{className:"absolute inset-0 bg-black/80 z-0"}),l.jsxs("div",{className:"relative z-10 text-center mb-12",children:[l.jsx("h2",{className:"text-4xl font-black text-white uppercase tracking-tighter drop-shadow-xl",children:"Smelting"}),l.jsx("div",{className:"text-orange-500 font-black uppercase tracking-widest text-xs mt-2 bg-black/40 px-4 py-1 rounded-full border border-orange-500/20",children:"Hold varmen i den oransje sonen"})]}),l.jsxs("div",{className:"relative z-10 flex gap-12 items-end h-80",children:[l.jsxs("div",{className:"w-20 h-full bg-slate-900/80 rounded-full border-4 border-white/10 relative overflow-hidden shadow-2xl",children:[l.jsx("div",{className:"absolute w-full bg-orange-500/30 border-y-2 border-orange-500/50 flex items-center justify-center",style:{bottom:`${i.min}%`,height:`${i.max-i.min}%`},children:l.jsx("div",{className:"w-full h-full bg-orange-500/10 animate-pulse"})}),l.jsx("div",{className:`absolute bottom-0 w-full transition-all duration-75 shadow-[0_0_30px_rgba(249,115,22,0.5)] ${n>i.max?"bg-white":"bg-gradient-to-t from-red-600 via-orange-500 to-yellow-400"}`,style:{height:`${n}%`},children:l.jsx("div",{className:"absolute top-0 inset-x-0 h-4 bg-white/50 blur-[2px]"})})]}),l.jsxs("div",{className:"flex flex-col gap-4",children:[l.jsx("div",{className:"text-xs font-black text-slate-500 uppercase tracking-widest text-center",children:"Fremgang"}),l.jsx("div",{className:"w-12 h-64 bg-slate-900/80 rounded-2xl border-2 border-white/5 relative overflow-hidden",children:l.jsx("div",{className:"absolute bottom-0 w-full bg-indigo-500 transition-all duration-300",style:{height:`${r}%`}})}),l.jsxs("div",{className:"text-xl font-black text-white text-center",children:[Math.round(r),"%"]})]})]}),l.jsx("div",{className:"mt-16 text-slate-400 text-sm font-bold uppercase tracking-widest animate-pulse relative z-10 text-center max-w-xs",children:"Klikk for  pumpe blsebelgen og ke varmen"}),o&&l.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm animate-in fade-in zoom-in duration-300",children:l.jsx("div",{className:"text-6xl font-black text-orange-500 animate-bounce drop-shadow-[0_0_30px_rgba(249,115,22,0.5)]",children:"FERDIG! "})})]})},va={WORK:[{id:"sickle",label:"Sigd",icon:"",desc:"Presisjons-hsting for hy kvalitet."},{id:"sweep",label:"Lj",icon:"",desc:"Rask innhsting av store omrder."}],CHOP:[{id:"axe",label:"ks",icon:"",desc:"Fell trr med r makt."}],FORAGE:[{id:"gather",label:"Sanking",icon:"",desc:"Let etter mat og urter i skogen."},{id:"traps",label:"Snarefangst",icon:"",desc:"Sett feller for smvilt."}],MINE:[{id:"pickaxe",label:"Hakke",icon:"",desc:"Hugg ut malm fra fjellet."}],QUARRY:[{id:"chisel",label:"Meisel",icon:"",desc:"Hugg ut steinblokker."}],CRAFT:[{id:"hammer",label:"Smiing",icon:"",desc:"Form metallet p ambolten."}],BAKE:[{id:"oven",label:"Steking",icon:"",desc:"Stek brd i ovnen."}],WEAVE:[{id:"loom",label:"Veving",icon:"",desc:"Vev trd til stoffer."}],MIX:[{id:"brew",label:"Brygging",icon:"",desc:"Bland urter til medisiner."}],SMELT:[{id:"furnace",label:"Smelting",icon:"",desc:"Smelt malm til barrer."}],PLANT:[{id:"manual",label:"Hndsing",icon:"",desc:"S fr for hnd."}],HUNT:[{id:"bow",label:"Bueskyting",icon:"",desc:"Presisjonsjakt fra avstand."},{id:"trap",label:"Fellefangst",icon:"",desc:"Sett ut snarer for smvilt."}],SAWMILL:[{id:"saw",label:"Saging",icon:"",desc:"Sag opp tmmer til planker."}],GATHER_WOOL:[{id:"shears",label:"Saks",icon:"",desc:"Klipp ullen av sauene."}]},MG=({item:t})=>{const e=t.durability/t.maxDurability*100;return l.jsx("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 z-[110] animate-in slide-in-from-bottom-4 fade-in duration-500",children:l.jsxs("div",{className:"bg-slate-900/90 border border-white/10 rounded-full px-6 py-3 flex items-center gap-4 backdrop-blur-md shadow-2xl",children:[l.jsx("div",{className:"text-3xl drop-shadow-[0_0_10px_rgba(255,255,255,0.2)]",children:t.icon}),l.jsxs("div",{className:"flex flex-col gap-1",children:[l.jsx("div",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:t.name}),l.jsxs("div",{className:"flex items-center gap-2 text-xs font-bold text-slate-300",children:[l.jsx("div",{className:`w-2 h-2 rounded-full ${e>20?"bg-emerald-500":"bg-rose-500"} animate-pulse`}),l.jsx("span",{children:"Slitasje"}),l.jsxs("span",{children:[Math.round(e),"%"]})]})]})]})})},DG=(t,e)=>{if(e)return e.find(n=>{var r;if(!n)return!1;const s=Object.keys(Te).find(a=>n.id===a||n.id.startsWith(a+"_")),i=s?Te[s]:null;return(r=i==null?void 0:i.relevantActions)==null?void 0:r.includes(t)})},LG=({type:t,onComplete:e,onCancel:n,equipment:s,skills:i,playerUpgrades:r,currentSeason:a="Spring",currentWeather:o="Clear",totalTicks:c=0,selectedMethod:u,action:d})=>{var E,N,A;const[f,h]=we.useState(u||null);we.useEffect(()=>{const w=va[t];w&&w.length===1&&!f&&h(w[0].id)},[t,f]);const m=we.useMemo(()=>DG(t,s||[]),[t,s]),g=we.useMemo(()=>{var k,R;const w=An[a],T=_s[o];return{speedMultiplier:((T==null?void 0:T.speedMod)||1)*(((k=m==null?void 0:m.stats)==null?void 0:k.speedBonus)||1),staminaCostMod:((w==null?void 0:w.staminaMod)||1)*((T==null?void 0:T.staminaMod)||1),yieldMod:(((R=m==null?void 0:m.stats)==null?void 0:R.yieldBonus)||0)+((w==null?void 0:w.yieldMod)||1)}},[a,o,m]),v=we.useMemo(()=>{var B,z;const w={skills:i||{},equipment:{}};s&&s.forEach($=>{const K=$.slot||$.type;$&&K&&(w.equipment[K]=$)});let T=10,k="FARMING",R=t;switch(t){case"MINE":T=q.YIELD.MINE_ORE,k="MINING";break;case"QUARRY":T=q.YIELD.QUARRY_STONE,k="MINING";break;case"CHOP":T=q.YIELD.CHOP_WOOD,a==="Summer"&&(T+=q.YIELD.SUMMER_WOOD_BONUS),k="WOODCUTTING";break;case"WORK":case"HARVEST":T=q.YIELD.WORK_GRAIN,r!=null&&r.includes("iron_plow")&&(T+=q.YIELD.PLOW_BONUS),k="FARMING";break;case"FORAGE":T=q.YIELD.FORAGE_BREAD,k="FARMING";break}const C={season:((B=An[a])==null?void 0:B.yieldMod)||1,weather:((z=_s[o])==null?void 0:z.yieldMod)||1,actionType:R,upgrades:1};try{const $=Kn(w,T,k,C);return isNaN($)?1.5:$}catch($){return console.error("Yield Calc Error:",$),1.5}},[t,i,s,r,a,o]),x=we.useMemo(()=>{let w=10;switch(t){case"MINE":w=q.YIELD.MINE_ORE;break;case"QUARRY":w=q.YIELD.QUARRY_STONE;break;case"CHOP":w=q.YIELD.CHOP_WOOD;break;case"WORK":case"HARVEST":w=q.YIELD.WORK_GRAIN;break;case"FORAGE":w=q.YIELD.FORAGE_BREAD;break}return v<=2||v<w*.4},[v,t]),p=w=>{h(w)},[b,y]=we.useState(!1);return x&&!b&&(t==="MINE"||t==="QUARRY"||t==="CHOP"||t==="WORK"||t==="HARVEST"||t==="FORAGE")&&f?l.jsx("div",{className:"fixed inset-0 z-[150] flex items-center justify-center bg-black/80 backdrop-blur-md animate-in fade-in zoom-in duration-300",children:l.jsxs("div",{className:"bg-slate-900 border-2 border-rose-500 rounded-3xl p-8 max-w-md w-full text-center shadow-[0_0_50px_rgba(244,63,94,0.3)]",children:[l.jsx("div",{className:"text-6xl mb-6",children:""}),l.jsx("h2",{className:"text-3xl font-black text-white uppercase tracking-tighter mb-4",children:"Manglende Verkty!"}),l.jsxs("p",{className:"text-slate-300 font-medium mb-8 leading-relaxed",children:["Du forsker  utfre ",l.jsx("span",{className:"text-rose-400 font-bold",children:t})," uten riktig verkty. Effektiviteten din er redusert med 80%."]}),l.jsxs("div",{className:"flex flex-col gap-3",children:[l.jsx("button",{onClick:()=>y(!0),className:"w-full py-4 bg-rose-600 hover:bg-rose-500 text-white rounded-xl font-black uppercase tracking-widest shadow-lg active:scale-95 transition-all",children:"Fortsett likevel"}),l.jsx("button",{onClick:n,className:"w-full py-4 bg-white/5 hover:bg-white/10 text-slate-400 hover:text-white rounded-xl font-bold uppercase tracking-widest transition-all",children:"Avbryt"})]})]})}):!f&&va[t]?l.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-slate-950/80 backdrop-blur-md animate-in fade-in duration-300",children:l.jsxs("div",{className:"max-w-4xl w-full p-8",children:[l.jsx("h2",{className:"text-4xl font-black text-white text-center mb-12 uppercase tracking-tighter drop-shadow-lg",children:"Velg Metode"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:va[t].map(w=>l.jsxs("button",{onClick:()=>p(w.id),className:"group relative bg-slate-900 border-2 border-slate-700 hover:border-indigo-500 rounded-3xl p-8 transition-all hover:-translate-y-2 hover:shadow-[0_0_50px_rgba(79,70,229,0.3)] text-left overflow-hidden",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-500/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),l.jsxs("div",{className:"relative z-10 flex flex-col items-center text-center gap-6",children:[l.jsx("div",{className:"text-6xl group-hover:scale-110 transition-transform duration-300",children:w.icon}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-2xl font-black text-white mb-2 uppercase tracking-wide group-hover:text-indigo-400 transition-colors",children:w.label}),l.jsx("p",{className:"text-slate-400 font-medium leading-relaxed",children:w.desc})]}),l.jsx("div",{className:"mt-4 pt-4 border-t border-white/5 w-full",children:(()=>{const T=RS(t,a,o,c);return T?l.jsx("div",{className:"flex items-center justify-center gap-2 text-sm font-bold text-slate-500",children:l.jsx("span",{children:T})}):null})()})]})]},w.id))}),l.jsx("button",{onClick:n,className:"mt-12 mx-auto block text-slate-500 font-bold hover:text-white transition-colors uppercase tracking-widest text-sm",children:"Avbryt"})]})}):l.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-slate-950/90 backdrop-blur-xl animate-in fade-in duration-300",children:[l.jsx("div",{className:"absolute top-8 right-8 z-[110]",children:l.jsx("button",{onClick:n,className:"bg-black/40 hover:bg-rose-500/20 text-white/50 hover:text-rose-400 w-12 h-12 rounded-full flex items-center justify-center transition-all",children:""})}),l.jsx("div",{className:"absolute top-8 left-8 z-[110] flex gap-4",children:l.jsxs("div",{className:"bg-black/40 backdrop-blur-md px-4 py-2 rounded-2xl border border-white/5 flex items-center gap-3",children:[l.jsx("span",{className:"text-2xl",title:((E=An[a])==null?void 0:E.label)||a,children:a==="Winter"?"":a==="Summer"?"":a==="Autumn"?"":""}),l.jsx("span",{className:"text-2xl",title:((N=_s[o])==null?void 0:N.label)||o,children:(A=_s[o])==null?void 0:A.icon}),l.jsx("div",{className:"h-4 w-[1px] bg-white/10 mx-2"}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-[10px] uppercase font-bold text-slate-500 tracking-wider",children:"Forhold"}),l.jsxs("span",{className:`text-xs font-bold ${g.speedMultiplier<1?"text-rose-400":"text-emerald-400"}`,children:[Math.round(g.speedMultiplier*100),"% Hastighet"]})]})]})}),l.jsxs("div",{className:"w-full max-w-5xl bg-slate-900 rounded-[3rem] shadow-2xl relative overflow-hidden border border-white/5",children:[(()=>{var w,T;switch(t){case"PLANT":return l.jsx(wG,{onComplete:e});case"HARVEST":case"WORK":return f==="sweep"||f==="scythe"?l.jsx(U_,{onComplete:e,equipment:s,speedMultiplier:g.speedMultiplier}):l.jsx(Kc,{onComplete:e,equipment:s,speedMultiplier:g.speedMultiplier,possibleYield:v});case"CHOP":return l.jsx(TG,{onComplete:e,equipment:s,speedMultiplier:g.speedMultiplier,possibleYield:v});case"SAWMILL":return l.jsx(jG,{onComplete:e,speedMultiplier:g.speedMultiplier});case"FORAGE":return f==="traps"?l.jsx(RG,{onComplete:e,speedMultiplier:g.speedMultiplier}):l.jsx(Kc,{isForaging:!0,onComplete:e,equipment:s,speedMultiplier:g.speedMultiplier,resourceName:"Mat/Urter",possibleYield:v});case"MINE":return l.jsx(Kc,{isMining:!0,onComplete:e,equipment:s,speedMultiplier:g.speedMultiplier,resourceName:"Malm",possibleYield:v});case"QUARRY":return l.jsx(Kc,{isQuarrying:!0,onComplete:e,equipment:s,speedMultiplier:g.speedMultiplier,resourceName:"Stein",possibleYield:v});case"CRAFT":case"REPAIR":return l.jsx(NG,{onComplete:e,speedMultiplier:g.speedMultiplier});case"SMELT":return l.jsx(OG,{onComplete:e,speedMultiplier:g.speedMultiplier});case"BAKE":const k=d!=null&&d.subType?((w=Te[d.subType])==null?void 0:w.icon)||"":((T=mn[d==null?void 0:d.recipeId])==null?void 0:T.icon)||"";return l.jsx(kG,{onComplete:e,speedMultiplier:g.speedMultiplier,icon:k});case"WEAVE":return l.jsx(IG,{onComplete:e,speedMultiplier:g.speedMultiplier});case"MIX":return l.jsx(CG,{onComplete:e,speedMultiplier:g.speedMultiplier});case"GATHER_WOOL":return l.jsx(U_,{onComplete:e,equipment:s,speedMultiplier:g.speedMultiplier});default:return l.jsxs("div",{className:"p-12 text-center",children:[l.jsxs("h2",{className:"text-2xl font-bold text-white mb-4",children:["Ukjent Minispill: ",t]}),l.jsx("button",{onClick:()=>e(.5),className:"px-6 py-3 bg-indigo-600 rounded-xl font-bold text-white",children:"Fullfr (Skip)"})]})}})(),m&&l.jsx(MG,{item:m})]})]})},PG=({poi:t,player:e,room:n,viewingRegionId:s,onAction:i,onClose:r})=>{var A,w,T;const a=_.useRef(null),o=s==="region_ost"&&t.ost?t.ost.top:t.top,c=s==="region_ost"&&t.ost?t.ost.left:t.left,[u,d]=_.useState({x:"3rem",y:"-50%"}),[f,h]=_.useState(!1),m=((A=n.world)==null?void 0:A.season)||"Spring",g=((w=n.world)==null?void 0:w.weather)||"Clear",v=_.useMemo(()=>{var U,O,j;const k=t.id in Bt?t.id:t.parentId,R=Bt[k],B=((j=(O=(((U=n.world)==null?void 0:U.settlement)||{}).buildings)==null?void 0:O[k])==null?void 0:j.level)||1;let z=[];if(R)for(let I=1;I<=B;I++)R.levels[I]&&(z=[...z,...R.levels[I].unlocks]);const $=t.actions.filter(I=>{if(I.id==="TAX_PEASANTS"&&e.role!=="BARON"||I.id==="TAX_ROYAL"&&e.role!=="KING"||I.id==="DECREE"&&e.role!=="KING"||I.id==="RAID"&&e.role!=="BARON"||I.id==="FEAST"&&e.role!=="KING"&&e.role!=="BARON")return!1;const H=["OPEN_CRAFTING","CRAFT","REFINE","MARKET_VIEW","OPEN_GARRISON"];return!(R&&!I.id.startsWith("BUILDING_UPGRADE_")&&!H.includes(I.id)&&!z.includes(I.id))});return["windmill_stones","sawmill_blade","smeltery_furnace","bakery_oven","weavery_loom","forge_anvil"].includes(t.id)?$.filter(I=>I.id==="OPEN_CRAFTING"||I.id==="REFINE"||I.id==="CRAFT"||I.id.startsWith("REFINE_")||I.id.startsWith("CRAFT_")||I.id in Rn).slice(0,1):$},[t,e.role,(T=n.world)==null?void 0:T.settlement]);_.useLayoutEffect(()=>{if(!a.current)return;const k=a.current.getBoundingClientRect(),R=a.current.offsetParent;if(!R){h(!0);return}const C=R.getBoundingClientRect(),B=parseFloat(c),z=parseFloat(o),$=B<50?"3rem":"calc(-100% - 3rem)",K=z/100*C.height-k.height/2,U=K+k.height;let O="-50%";K<20?O=`calc(-50% + ${20-K}px)`:U>C.height-20&&(O=`calc(-50% - ${U-(C.height-20)}px)`),d({x:$,y:O}),h(!0)},[o,c,v.length]);const x=k=>{var K,U,O;const R=[],C=up(e,k);if(C.forEach(j=>{var I,H,X;(I=j.stats)!=null&&I.speedBonus&&j.stats.speedBonus!==1&&R.push({source:j.name,type:"Fart",value:`+${Math.round((j.stats.speedBonus-1)*100)}%`,icon:j.icon,isBonus:!0}),(H=j.stats)!=null&&H.yieldBonus&&R.push({source:j.name,type:"Utbytte",value:`+${j.stats.yieldBonus}`,icon:j.icon,isBonus:!0}),(X=j.stats)!=null&&X.luckBonus&&R.push({source:j.name,type:"Flaks",value:`+${Math.round(j.stats.luckBonus*100)}%`,icon:j.icon,isBonus:!0})}),e.upgrades){const j=I0[e.role]||[];e.upgrades.forEach(I=>{const H=j.find(X=>X.id===I);H&&(H.benefit==="YIELD_GRAIN"&&(k==="WORK"||k==="MILL")&&R.push({source:H.name,type:"Utbytte",value:"+5",icon:"",isBonus:!0}),H.benefit==="RAID_SPEED"&&k==="RAID"&&R.push({source:H.name,type:"Fart",value:"Raskere",icon:"",isBonus:!0}))})}const B=t.id==="tavern"||t.id==="bakery"||t.id==="great_forge"||t.id==="weavery"||t.id==="sawmill"||t.id==="windmill"||t.id==="smeltery"?t.id:t.parentId,$=((O=(U=(((K=n.world)==null?void 0:K.settlement)||{}).buildings)==null?void 0:U[B])==null?void 0:O.level)||1;if($>=2&&R.push({source:"Bygningsbonus (Lvl 2)",type:"Utbytte",value:"+10% XP",icon:"",isBonus:!0}),$>=3&&R.push({source:"Bygningsbonus (Lvl 3)",type:"Utbytte",value:"Master Tier",icon:"",isBonus:!0}),va[k]){const j=va[k][0];j.id==="manual"||j.id==="gather"||C.some(X=>{var oe;return((oe=X.type)==null?void 0:oe.toLowerCase().includes(j.id.toLowerCase()))||X.id.toLowerCase().includes(j.id.toLowerCase())})||R.push({source:"System",type:"ADVARSEL",value:`Du mangler ${j.label}, utbytte redusert med 80%`,icon:"",isBonus:!1})}return R},p=_.useMemo(()=>{var k;return(k=e.activeProcesses)==null?void 0:k.find(R=>!(R.locationId!==t.id||R.type==="COOP"||R.type==="WELL"&&R.readyAt<=Date.now()))},[e.activeProcesses,t.id]),b=()=>{if(!p)return 0;const k=Date.now();return Math.max(0,p.readyAt-k)},[y,E]=_.useState(b());_.useEffect(()=>{if(!p)return;const k=setInterval(()=>{const R=b();E(R),R<=0&&clearInterval(k)},1e3);return()=>clearInterval(k)},[p]);const N=k=>{const R=Math.floor(k/6e4),C=Math.floor(k%6e4/1e3);return`${R}m ${C}s`};return l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"absolute inset-0 z-[90]",onClick:r}),l.jsx("div",{ref:a,style:{top:o,left:c,transform:`translate(${u.x}, ${u.y})`,visibility:f?"visible":"hidden",opacity:f?1:0},className:`absolute z-[100] ${f?"animate-in fade-in zoom-in":""} duration-200 pointer-events-auto`,children:l.jsxs("div",{className:"bg-slate-900/90 backdrop-blur-3xl border border-white/10 rounded-[2.5rem] p-6 shadow-[0_40px_100px_rgba(0,0,0,0.8)] min-w-[320px] w-max max-w-[400px] relative transition-all duration-500 overflow-hidden group/tooltip",children:[l.jsx("div",{className:"absolute -top-24 -left-24 w-48 h-48 bg-indigo-500/10 blur-[80px] pointer-events-none group-hover/tooltip:bg-indigo-500/20 transition-all duration-1000"}),l.jsxs("div",{className:"flex items-center justify-between mb-6 relative z-10",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("div",{className:"w-14 h-14 rounded-2xl bg-white/5 border border-white/10 flex items-center justify-center text-3xl shadow-inner relative overflow-hidden group/icon",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-0 group-hover/icon:opacity-100 transition-opacity"}),t.icon]}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("h3",{className:"font-display font-black text-white text-xl uppercase tracking-tighter leading-none",children:t.label}),l.jsx("span",{className:"text-xs font-black text-indigo-400 uppercase tracking-[.2em] mt-1 opacity-90",children:"Landemerke"})]})]}),l.jsx("div",{className:"flex items-center gap-3",children:l.jsx("button",{onClick:r,className:"text-white/60 hover:text-white transition-all bg-white/10 hover:bg-white/20 rounded-full w-10 h-10 flex items-center justify-center border border-white/10 hover:border-white/30 active:scale-90",children:""})})]}),l.jsxs("div",{className:"space-y-3",children:[p?l.jsx("div",{className:"w-full relative py-4",children:y<=0?l.jsxs("div",{className:"relative group/harvest",children:[l.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-emerald-500 to-teal-500 rounded-3xl blur opacity-25 group-hover/harvest:opacity-50 transition duration-1000 group-hover:duration-200"}),l.jsxs("button",{onClick:()=>i({type:"HARVEST",locationId:t.id}),disabled:e.status.stamina<fs(15,m,g),className:`w-full relative px-6 py-8 border rounded-3xl flex items-center justify-between overflow-hidden active:scale-[0.98] transition-all
                                                ${e.status.stamina<fs(15,m,g)?"bg-red-900/20 border-red-500/30 cursor-not-allowed grayscale opacity-80":"bg-slate-900 border-emerald-500/50 hover:bg-emerald-950/30"}`,children:[l.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-emerald-500/10 blur-3xl -mr-16 -mt-16"}),l.jsxs("div",{className:"flex flex-col items-start z-10",children:[l.jsx("span",{className:`text-2xl font-black uppercase tracking-tighter italic ${e.status.stamina<fs(15,m,g)?"text-slate-500":"text-white"}`,children:"Innhsting"}),l.jsx("span",{className:`text-xs font-black uppercase tracking-[0.2em] mt-1 ${e.status.stamina<fs(15,m,g)?"text-red-400":"text-emerald-400"}`,children:e.status.stamina<fs(15,m,g)?`Mangler energi (${Math.ceil(e.status.stamina)}/${fs(15,m,g).toFixed(0)})`:"Klar til  hentes!"})]}),l.jsx("div",{className:`w-14 h-14 rounded-2xl flex items-center justify-center text-3xl shadow-[0_0_20px_rgba(16,185,129,0.3)] ${e.status.stamina<fs(15,m,g)?"bg-slate-800 text-slate-600":"bg-emerald-500/20 animate-bounce"}`,children:e.status.stamina<fs(15,m,g)?l.jsx(vP,{size:24,className:"text-red-500"}):""})]})]}):l.jsxs("div",{className:"p-8 bg-white/5 border border-white/10 rounded-[2rem] flex flex-col items-center gap-6 relative overflow-hidden group/timer",children:[l.jsx("div",{className:"absolute -bottom-12 -right-12 w-24 h-24 bg-indigo-500/5 blur-2xl rounded-full"}),l.jsxs("div",{className:"relative w-24 h-24",children:[l.jsxs("svg",{className:"w-full h-full -rotate-90",viewBox:"0 0 36 36",children:[l.jsx("circle",{cx:"18",cy:"18",r:"16",fill:"none",className:"stroke-white/5",strokeWidth:"2"}),l.jsx("circle",{cx:"18",cy:"18",r:"16",fill:"none",className:"stroke-emerald-500 transition-all duration-1000 ease-linear",strokeWidth:"2",strokeDasharray:"100",strokeDashoffset:100-(1-y/p.duration)*100,strokeLinecap:"round"})]}),l.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:l.jsx("span",{className:"text-3xl animate-pulse",children:p.type==="MILL"?"":p.type==="WELL"?"":""})})]}),l.jsxs("div",{className:"flex flex-col items-center gap-1",children:[l.jsx("span",{className:"text-sm font-black text-slate-400 uppercase tracking-widest leading-none",children:p.type==="WELL"?"Brnnen fyller seg med vann":"Venter p produksjon"}),l.jsx("span",{className:"text-2xl font-mono font-black text-white",children:N(y)})]}),l.jsx("div",{className:"w-full h-1 bg-white/5 rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-emerald-500 transition-all duration-1000 ease-linear",style:{width:`${(1-y/p.duration)*100}%`}})})]})}):l.jsx("div",{className:"space-y-6",children:v.map(k=>{var j,I,H,X;const R=((j=n.world)==null?void 0:j.season)||"Spring",C=((I=n.world)==null?void 0:I.weather)||"Clear",B=x(k.id);let z=!0,$="";const K=["CRAFT","REFINE","OPEN_CRAFTING","BAKE","SMELT","MILL","WEAVE","MIX","OPEN_CHICKEN_COOP","OPEN_DICE_GAME","MARKET_VIEW","OPEN_GARRISON"];if(s!==e.regionId&&e.role!=="KING"&&k.id!=="MARKET_VIEW")z=!1,$="Dette er ikke ditt baroni";else if(!K.includes(k.id)){const oe=AS(e,k.id,R,C,((H=n.world)==null?void 0:H.gameTick)||0);oe.success||(z=!1,$=oe.reason||"Krav ikke mtt")}const U=RS(k.id,R,C,((X=n.world)==null?void 0:X.gameTick)||0),O=va[k.id];return l.jsxs("div",{className:"w-full animate-in fade-in slide-in-from-bottom-2 duration-500",children:[l.jsxs("div",{className:"flex items-center justify-between px-1 mb-3",children:[l.jsx("h4",{className:"text-xs font-black text-slate-300 uppercase tracking-[0.3em]",children:k.label}),U&&l.jsx("span",{className:"text-xs font-black text-indigo-400 uppercase tracking-widest",children:U})]}),O?l.jsx("div",{className:"grid grid-cols-1 gap-4",children:O.map(oe=>{const Ie=up(e,k.id),V=Ie.find(ne=>{var st;return((st=ne.type)==null?void 0:st.toLowerCase().includes(oe.id.toLowerCase()))||ne.id.toLowerCase().includes(oe.id.toLowerCase())})||Ie[0],me=V?V.durability/V.maxDurability*100:null;return l.jsxs("button",{onClick:()=>i({type:k.id,method:oe.id,locationId:t.id}),disabled:!z,className:`group relative flex items-center gap-6 w-full p-5 rounded-[2rem] border transition-all duration-300 ${z?"bg-white/5 border-white/10 hover:border-indigo-500/50 hover:bg-indigo-500/5 active:scale-[0.98]":"bg-black/20 border-white/5 cursor-not-allowed"}`,children:[l.jsx("div",{className:`w-16 h-16 rounded-2xl bg-white/5 flex-shrink-0 flex items-center justify-center text-4xl group-hover:scale-110 transition-transform duration-500 ${!z&&"opacity-40"}`,children:oe.icon}),l.jsxs("div",{className:"flex-1 flex flex-col justify-center min-w-0 items-start",children:[l.jsx("span",{className:"font-display font-black text-white text-xl uppercase tracking-tighter group-hover:text-indigo-400 transition-colors truncate",children:oe.label}),z?l.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[l.jsx("span",{className:"text-[10px] text-slate-400 font-black uppercase tracking-widest truncate opacity-60",children:oe.desc}),B.length>0&&l.jsx("div",{className:"flex gap-1.5",children:B.filter(ne=>!ne.isBonus||ne.value.includes("+")).slice(0,1).map((ne,st)=>l.jsx("span",{className:"text-[10px] text-emerald-400 font-black px-2 py-0.5 bg-emerald-400/10 rounded-full",children:ne.value},st))})]}):l.jsx("span",{className:"text-xs font-black text-rose-500 uppercase tracking-widest mt-0.5",children:$})]}),l.jsxs("div",{className:"flex flex-col items-end gap-3 ml-2",children:[me!==null&&z&&l.jsx("div",{className:"w-10 h-1.5 bg-white/10 rounded-full overflow-hidden shadow-inner",children:l.jsx("div",{className:`h-full transition-all duration-1000 ${me>50?"bg-indigo-500 shadow-[0_0_8px_rgba(99,102,241,0.5)]":me>20?"bg-amber-500":"bg-rose-500"}`,style:{width:`${me}%`}})}),l.jsx(ga,{size:22,className:`transition-all ${z?"text-white/20 group-hover:text-indigo-400 group-hover:translate-x-1":"text-white/5"}`})]})]},oe.id)})}):l.jsx("button",{onClick:()=>i({...k,type:k.id,locationId:t.id}),disabled:!z,className:`w-full group relative overflow-hidden p-5 rounded-3xl border transition-all duration-300 ${z?"bg-white/5 border-white/10 hover:border-indigo-500/50 hover:bg-indigo-500/5 active:scale-[0.98]":"bg-black/20 border-white/5 opacity-50 cursor-not-allowed"}`,children:l.jsxs("div",{className:"flex items-center justify-between relative z-10",children:[l.jsxs("div",{className:"flex flex-col items-start",children:[l.jsx("span",{className:"text-xl font-black text-white group-hover:text-indigo-400 transition-colors uppercase tracking-tight",children:k.label}),!z&&l.jsx("span",{className:"text-sm font-black text-rose-500 uppercase tracking-widest mt-1",children:$})]}),l.jsx(ga,{size:20,className:"text-white/20 group-hover:text-indigo-400 group-hover:translate-x-1 transition-all"})]})})]},k.id)})}),(()=>{var $,K,U,O,j;const k=v.map(I=>I.id),R=Object.values(e.equipment||{}),z=Object.values(Te).filter(I=>{var H;return(H=I.relevantActions)==null?void 0:H.some(X=>k.includes(X))}).map(I=>{if(R.find(X=>X.id===I.id||X.id.startsWith(I.id+"_"))){const X=I.nextTierId;return X?Te[X]:null}else return I.level===1?I:null}).filter(Boolean).filter((I,H,X)=>X.findIndex(oe=>(oe==null?void 0:oe.id)===(I==null?void 0:I.id))===H).sort((I,H)=>{if(!I||!H)return 0;const X=I.type==="MAIN_HAND"||I.type==="AXE"||I.type==="PICKAXE"||I.type==="SCYTHE"||I.type==="BOW"||I.type==="CHISEL"?1:0;return(H.type==="MAIN_HAND"||H.type==="AXE"||H.type==="PICKAXE"||H.type==="SCYTHE"||H.type==="BOW"||H.type==="CHISEL"?1:0)-X});if(z.length>0){const I=z[0];if(!I)return null;const H=Object.values(Rn).find(zt=>zt.outputItemId===I.id),X=(($=n.world)==null?void 0:$.settlement)||{buildings:{}},oe=(H==null?void 0:H.buildingId)||"great_forge",Ie=((U=(K=X.buildings)==null?void 0:K[oe])==null?void 0:U.level)||1,V=(H==null?void 0:H.level)||1,me=Ie<V,ne=((O=Bt[oe])==null?void 0:O.name)||"Smien",st=R.find(zt=>{var Yn;if(!zt)return!1;const On=Object.keys(Te).find(pn=>zt.id===pn||zt.id.startsWith(pn+"_")),Mt=On?Te[On]:null;return(Yn=Mt==null?void 0:Mt.relevantActions)==null?void 0:Yn.some(pn=>k.includes(pn))});return l.jsx("div",{className:"mt-8 pt-8 border-t border-white/5 relative z-10",children:l.jsxs("div",{className:"flex flex-col gap-4",children:[l.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[l.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-amber-500 to-transparent flex-1"}),l.jsx("span",{className:`text-xs font-black uppercase tracking-[0.2em] ${me?"text-slate-400":"text-amber-500 animate-pulse"}`,children:me?`Krever niv ${V}`:"Utvikling venter"}),l.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-amber-500 to-transparent flex-1"})]}),l.jsxs("div",{className:"flex items-center justify-between gap-6 px-4",children:[l.jsxs("div",{className:"flex flex-col items-center gap-2 group/evolve",children:[l.jsx("div",{className:"w-16 h-16 rounded-[1.5rem] bg-white/5 border border-white/10 flex items-center justify-center text-3xl opacity-40 transition-all group-hover/evolve:opacity-60",children:(st==null?void 0:st.icon)||""}),l.jsx("span",{className:"text-[9px] font-black text-slate-500 uppercase tracking-widest",children:"N"})]}),l.jsxs("div",{className:"flex flex-col items-center flex-1 gap-2 pt-2",children:[l.jsxs("div",{className:"relative w-full flex justify-center",children:[l.jsx("div",{className:"absolute top-1/2 left-0 w-full h-px bg-gradient-to-r from-indigo-500/0 via-indigo-500/30 to-indigo-500/0"}),l.jsx(ga,{className:"text-indigo-500/50 w-6 h-6 animate-pulse relative z-10"})]}),((j=I.stats)==null?void 0:j.yieldBonus)&&l.jsxs("span",{className:"text-[10px] font-black text-emerald-400 bg-emerald-400/10 px-2 py-0.5 rounded-full border border-emerald-400/20",children:["+",I.stats.yieldBonus," Utbytte"]})]}),l.jsxs("div",{className:"flex flex-col items-center gap-2 group/next",children:[l.jsx("div",{className:`w-20 h-20 rounded-[2rem] flex items-center justify-center text-4xl border-2 shadow-2xl transition-all duration-500 ${me?"bg-slate-900/50 border-white/5 grayscale":"bg-indigo-600/20 border-indigo-500/50 shadow-indigo-500/20 hover:scale-110 active:scale-95"}`,children:I.icon}),l.jsx("span",{className:`text-xs font-black uppercase tracking-tight ${me?"text-slate-500":"text-amber-500"}`,children:I.name})]})]}),l.jsx("p",{className:"text-xs text-slate-400 text-center font-medium italic px-6 mt-2",children:me?`Forbedre ${ne} til niv ${V} for  lse opp.`:`Besk ${ne} i landsbyen for  smi din ${I.name}.`})]})})}return null})()]})]})})]})},BG=({weather:t,season:e,hideClouds:n,isInterior:s})=>{const i=_.useMemo(()=>Array.from({length:12}).map((d,f)=>({id:f,top:`${Math.random()*100}%`,delay:Math.random()*60,duration:40+Math.random()*60,scale:.5+Math.random()*1.5,opacity:.1+Math.random()*.3})),[]),r=_.useMemo(()=>Array.from({length:10}).map((d,f)=>({id:f,left:`${Math.random()*100}%`,delay:Math.random()*20,duration:10+Math.random()*20,size:5+Math.random()*10,rotation:Math.random()*360,drift:50+Math.random()*150})),[]),a=_.useMemo(()=>Array.from({length:5}).map((d,f)=>({id:f,left:`${10+Math.random()*80}%`,top:`${-10+Math.random()*40}%`,rotation:f*45+Math.random()*20,delay:f*2})),[]),o=()=>e==="Autumn"?"":e==="Spring"?"":e==="Winter"?"":"",u=100*(t==="Storm"?2.5:t==="Rain"?1.5:1);return l.jsxs("div",{className:"absolute inset-0 pointer-events-none overflow-hidden z-[5]",children:[t==="Clear"&&!s&&l.jsx("div",{className:"absolute inset-0 opacity-40",children:a.map(d=>l.jsx("div",{className:"absolute w-[400px] h-[800px] animate-sunbeam",style:{left:d.left,top:d.top,background:"radial-gradient(ellipse at top, rgba(253, 224, 71, 0.15) 0%, transparent 70%)",transform:`rotate(${d.rotation}deg)`,animationDelay:`${d.delay}s`}},d.id))}),!n&&!s&&l.jsx("div",{className:"absolute inset-0",children:i.map(d=>l.jsx("div",{className:"absolute text-white animate-cloud-drift select-none",style:{top:d.top,fontSize:`${d.scale*4}rem`,opacity:t==="Storm"?d.opacity*2:d.opacity,filter:"blur(8px)",animationDuration:`${t==="Storm"?d.duration/2:d.duration}s`,animationDelay:`-${d.delay}s`,color:t==="Storm"?"#475569":"white"},children:""},d.id))}),t==="Fog"&&!s&&l.jsx("div",{className:"absolute inset-0 bg-slate-400/10 backdrop-blur-[2px] animate-mist"}),!s&&l.jsx("div",{className:"absolute inset-0",children:r.map(d=>l.jsx("div",{className:"absolute animate-particle opacity-0",style:{left:d.left,fontSize:`${d.size}px`,animationDuration:`${d.duration}s`,animationDelay:`${d.delay}s`,filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.1))","--wind-drift":`${u+d.drift}px`,"--wind-rotation":`${720+d.rotation}deg`},children:o()},d.id))}),(t==="Clear"||s)&&l.jsx("div",{className:"absolute inset-0",children:Array.from({length:15}).map((d,f)=>l.jsx("div",{className:"absolute w-1 h-1 bg-white/40 rounded-full animate-dust-float",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDuration:`${6+Math.random()*8}s`,animationDelay:`${Math.random()*10}s`,filter:"blur(1px)"}},`dust-${f}`))}),(t==="Rain"||t==="Storm")&&!s&&l.jsx("div",{className:"absolute inset-0 bg-indigo-900/10 mix-blend-overlay"})]})},UG=({player:t,room:e})=>{const[n,s]=_.useState(Date.now()),{handleAction:i}=jS(e==null?void 0:e.pin,t,(e==null?void 0:e.world)||null,()=>{},()=>{},()=>{},null),[r,a]=_.useState({});_.useEffect(()=>{const m=setInterval(()=>{var v;const g=Date.now();if(s(g),Math.random()<.05){const x=((v=t.activeProcesses)==null?void 0:v.filter(p=>p.type==="CROP"&&p.readyAt>g))||[];if(x.length>0){const p=x[Math.floor(Math.random()*x.length)];if(!r[p.id]){const b=Math.random()>.5?"CROW":"WEED";a(y=>({...y,[p.id]:{type:b,expiresAt:g+1e4}}))}}}a(x=>{const p={...x};let b=!1;return Object.entries(p).forEach(([y,E])=>{E.expiresAt<g&&(delete p[y],b=!0)}),b?p:x})},1e3);return()=>clearInterval(m)},[t.activeProcesses,r]);const o=_.useCallback((m,g)=>{a(v=>{const x={...v};return delete x[m],x}),i({type:"MAINTAIN_CROP",processId:m,subType:g})},[i]),c=t.activeProcesses||[],u=n,d=c.filter(m=>!(!(m.type==="CROP"||m.type==="COOP"||m.type==="MILL"||m.type==="WELL")||m.type==="WELL"&&m.readyAt>0&&u>m.readyAt+1e4)),f=(t.activeBuffs||[]).filter(m=>m.expiresAt>u);if(d.length===0&&f.length===0)return null;d.sort((m,g)=>m.readyAt-g.readyAt);const h=m=>{const g=Math.floor(m/6e4),v=Math.floor(m%6e4/1e3);return`${g}m ${v}s`};return l.jsxs("div",{className:"absolute top-6 right-6 z-[60] flex flex-col gap-2 pointer-events-none items-end",children:[f.map(m=>{const g=Math.max(0,m.expiresAt-u);return l.jsxs("div",{className:"group bg-indigo-900/90 backdrop-blur-md border border-indigo-500/30 rounded-xl p-3 shadow-xl pointer-events-auto flex items-center gap-4 transition-all hover:bg-indigo-900/100 hover:scale-105 animate-in slide-in-from-right-4 duration-300 relative",children:[l.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center border bg-indigo-500/20 border-indigo-500 text-indigo-300",children:l.jsx("span",{className:"text-xl",children:""})}),l.jsxs("div",{className:"flex flex-col min-w-[120px]",children:[l.jsx("span",{className:"text-xs font-bold text-indigo-300 uppercase tracking-wider",children:m.label}),l.jsx("div",{className:"flex items-center gap-2",children:l.jsx("span",{className:"text-sm font-black text-white",children:h(g)})})]}),m.description&&l.jsx("div",{className:"absolute right-full top-1/2 -translate-y-1/2 mr-3 w-48 bg-slate-900/95 border border-indigo-500/30 p-3 rounded-xl shadow-2xl opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none translate-x-2 group-hover:translate-x-0",children:l.jsx("p",{className:"text-[10px] text-indigo-100 leading-tight",children:m.description})})]},m.id)}),d.map(m=>{const g=Math.max(0,m.readyAt-u),v=g<=0;let x="Avling Gror",p=l.jsx(gy,{size:20}),b="Innhsting Klar!";const y=mn[m.itemId];m.type==="COOP"?(x="Hner Spiser",p=l.jsx("span",{className:"text-xl",children:""}),b="Egg klare!"):m.type==="MILL"?(x="Kverner korn",p=l.jsx("span",{className:"text-xl",children:""}),b="Mel klart!"):m.type==="WELL"?(x="Brnnen fyller seg",p=l.jsx("span",{className:"text-xl",children:""}),b="Brnnen er klar!"):y?(p=l.jsx("span",{className:"text-xl",children:y.icon}),x=`${y.label} gror`,b=`${y.label} klar!`):p=v?l.jsx(j0,{size:20}):l.jsx(gy,{size:20});const E=r[m.id],N=!!E&&!v;return l.jsxs("div",{className:`relative bg-slate-900/90 backdrop-blur-md border rounded-xl p-3 shadow-xl pointer-events-auto flex items-center gap-4 transition-all hover:bg-slate-900/95 animate-in slide-in-from-right-4 duration-300 ${m.type==="WELL"&&v?"animate-pulse":""} ${N?"border-rose-500/50 hover:border-rose-400 cursor-pointer group":"border-white/10"}`,onClick:N?()=>o(m.id,E.type):void 0,children:[N&&l.jsx("div",{className:"absolute -top-3 -right-3 z-50 animate-bounce",children:l.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center shadow-lg border-2 border-white ${E.type==="CROW"?"bg-slate-800":"bg-emerald-700"}`,children:l.jsx("span",{className:"text-lg",children:E.type==="CROW"?"":""})})}),m.yieldBonus&&m.yieldBonus>0&&l.jsxs("div",{className:"absolute -bottom-2 -right-2 px-2 py-0.5 bg-emerald-600 text-white text-[10px] font-black rounded-full shadow-lg border border-emerald-400 z-10",children:["+",Math.round(m.yieldBonus*100),"%"]}),l.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center border ${v?"bg-emerald-500/20 border-emerald-500 text-emerald-400 animate-pulse":"bg-slate-800 border-white/10 text-slate-400"}`,children:p}),l.jsxs("div",{className:"flex flex-col min-w-[120px]",children:[l.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:v?b:N?E.type==="CROW"?"Fjern Krke!":"Luk ugress!":x}),l.jsx("div",{className:"flex items-center gap-2",children:l.jsx("span",{className:`text-sm font-black ${v?"text-emerald-400":N?"text-rose-400":"text-white"}`,children:v?"Hent n":h(g)})})]})]},m.id)})]})},Td=({title:t,subtitle:e,icon:n,headerRight:s,children:i,onClose:r,className:a,maxWidth:o})=>(_.useEffect(()=>{const c=u=>{u.key==="Escape"&&r()};return window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[r]),l.jsxs("div",{className:"absolute inset-0 z-40 flex items-center justify-center p-4 md:p-8",children:[l.jsx(De.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:r,className:"absolute inset-0 bg-black/20 backdrop-blur-[1px] cursor-pointer"}),l.jsxs(De.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{type:"spring",stiffness:260,damping:25,mass:1},className:`relative w-full ${o||"max-w-5xl"} max-h-full bg-slate-950/90 backdrop-blur-md border border-white/10 rounded-3xl shadow-2xl overflow-hidden flex flex-col pointer-events-auto will-change-transform`,children:[l.jsxs("div",{className:"flex-none flex justify-between items-center px-6 py-4 border-b border-white/10 bg-gradient-to-r from-white/5 to-transparent min-h-[72px]",children:[l.jsxs("div",{className:"flex items-center gap-5 overflow-hidden",children:[n&&l.jsx("div",{className:"w-12 h-12 bg-white/5 rounded-2xl flex items-center justify-center text-3xl shadow-inner border border-white/5 shrink-0",children:n}),l.jsxs("div",{className:"flex flex-col min-w-0",children:[t&&l.jsx("h2",{className:"text-xl font-display font-black text-white tracking-tighter uppercase truncate",children:t}),e&&l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest truncate opacity-80",children:e})]}),s&&l.jsx("div",{className:"hidden sm:flex items-center pl-4 border-l border-white/10 ml-2",children:s})]}),l.jsx("button",{onClick:r,className:"w-8 h-8 bg-white/5 hover:bg-rose-500/20 text-slate-400 hover:text-rose-500 rounded-full flex items-center justify-center transition-all group",title:"Lukk vindu",children:l.jsx("span",{className:"text-lg group-hover:rotate-90 transition-transform",children:""})})]}),l.jsx("div",{className:`flex-1 overflow-y-auto custom-scrollbar p-6 ${a||""}`,children:i})]})]})),HG=({player:t,activeProcesses:e,onAction:n,onClose:s})=>{const i=e.filter(v=>v.type==="COOP"&&v.locationId==="chicken_coop"),r=i.length>0,a=i[0],[o,c]=_.useState(0);_.useEffect(()=>{if(!a){c(0);return}const v=()=>{const p=Math.max(0,a.readyAt-Date.now());c(p)};v();const x=setInterval(v,1e3);return()=>clearInterval(x)},[a]);const u=r&&o<=0,d=t.resources.grain||0,f=()=>{n({type:"FEED_CHICKENS",locationId:"chicken_coop"})},h=()=>{n({type:"COLLECT_EGGS",locationId:"chicken_coop"})},m=a?a.readyAt-a.startedAt:1,g=a?1-o/m:0;return l.jsx(Td,{title:"Hnsehuset",icon:l.jsx("span",{className:"text-2xl",children:""}),onClose:s,children:l.jsxs("div",{className:"p-6 flex flex-col items-center gap-8 min-h-[400px]",children:[l.jsxs("div",{className:"relative w-full h-48 bg-slate-900/50 rounded-2xl overflow-hidden border border-white/10 flex items-center justify-center",children:[l.jsx("img",{src:"/Simulation_StandAlone_Pro/map_peasant_farm.png",className:"absolute inset-0 w-full h-full object-cover opacity-30 grayscale",alt:"Coop Background"}),l.jsxs("div",{className:"relative z-10 flex gap-4",children:[l.jsx(De.div,{animate:{y:[0,-5,0]},transition:{repeat:1/0,duration:2,ease:"easeInOut"},className:"text-6xl",children:""}),r&&!u&&l.jsx(De.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-6xl",children:""}),u&&l.jsx(De.div,{initial:{scale:0},animate:{scale:[1,1.2,1]},transition:{repeat:1/0,duration:1},className:"text-6xl drop-shadow-[0_0_15px_rgba(251,191,36,0.8)]",children:""})]})]}),l.jsxs("div",{className:"text-center space-y-4 max-w-sm",children:[!r&&l.jsxs(l.Fragment,{children:[l.jsx("h3",{className:"text-xl font-bold text-white",children:"Sultne Hner"}),l.jsx("p",{className:"text-slate-400 text-sm",children:"Hnene kakler utlmodig. Gi dem korn for  starte eggproduksjonen."}),l.jsxs("div",{className:"flex items-center justify-center gap-4 bg-slate-800/50 p-4 rounded-xl border border-white/5",children:[l.jsx(dp,{resource:"grain",amount:d,size:"lg"}),l.jsx("button",{onClick:f,disabled:d<5,className:`
                                        px-6 py-3 rounded-xl font-bold uppercase tracking-wider text-sm transition-all
                                        ${d>=5?"bg-amber-500 hover:bg-amber-400 text-amber-950 shadow-amber-500/20 shadow-lg":"bg-slate-700 text-slate-500 cursor-not-allowed"}
                                    `,children:"Fr Hner (5 Korn)"})]})]}),r&&!u&&l.jsxs(l.Fragment,{children:[l.jsx("h3",{className:"text-xl font-bold text-white",children:"Hnene Spiser"}),l.jsx("p",{className:"text-slate-400 text-sm",children:"Det tar tid  lage gode egg..."}),l.jsx("div",{className:"w-full h-4 bg-slate-800 rounded-full overflow-hidden border border-white/10",children:l.jsx(De.div,{className:"h-full bg-amber-500",initial:{width:`${g*100}%`},animate:{width:`${g*100}%`},transition:{duration:1,ease:"linear"}})}),l.jsxs("p",{className:"font-mono text-amber-400 font-bold",children:[Math.ceil(o/6e4)," minutter igjen"]})]}),u&&l.jsxs(l.Fragment,{children:[l.jsx("h3",{className:"text-xl font-bold text-white",children:"Eggene er klare!"}),l.jsx("p",{className:"text-slate-400 text-sm",children:"Redet er fullt av ferske egg."}),l.jsx("button",{onClick:h,className:"px-8 py-4 bg-emerald-500 hover:bg-emerald-400 text-white rounded-xl font-black uppercase tracking-widest text-lg shadow-emerald-500/30 shadow-2xl animate-pulse",children:"Samle Egg"})]})]})]})})},GG=({buildingId:t,player:e,room:n,onAction:s})=>{var d,f,h,m;const i=Bt[t];if(!i)return null;const r=t==="farm_house",a=r?((d=e.buildings)==null?void 0:d[t])||{level:1,progress:{}}:((m=(h=(f=n.world)==null?void 0:f.settlement)==null?void 0:h.buildings)==null?void 0:m[t])||{level:1,progress:{},contributions:{}},c=(a.level||1)+1,u=i.levels[c];return l.jsxs("div",{className:"space-y-8 py-4 relative",children:[l.jsxs("div",{className:"bg-slate-900/80 rounded-[2rem] p-8 w-full border border-white/5 text-center relative overflow-hidden",children:[l.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-indigo-500/5 blur-3xl rounded-full -mr-16 -mt-16"}),l.jsxs("p",{className:"text-indigo-300 text-sm font-bold mb-4 uppercase tracking-widest flex items-center justify-center gap-2",children:[l.jsx("span",{className:"w-2 h-2 bg-indigo-500 rounded-full animate-pulse"}),"Bonus ved neste niv: ",(u==null?void 0:u.bonus)||"Maksimal effekt"]}),l.jsxs("p",{className:"text-slate-400 text-sm leading-relaxed italic opacity-80",children:['"',i.description,'"']})]}),u?l.jsxs("div",{className:"w-full space-y-8",children:[l.jsxs("div",{className:"text-left",children:[l.jsxs("div",{className:"text-[10px] font-black text-slate-500 uppercase tracking-[0.2em] mb-4",children:["Byggeprogresjon (Niv ",c,")"]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(u.requirements||{}).map(([g,v])=>{var A,w;const x=Math.floor(((A=a.progress)==null?void 0:A[g])||0),p=Math.min(100,x/v*100),b=Math.floor(((w=e.resources)==null?void 0:w[g])||0),y=v-x,E=b>0&&y>0,N=Math.min(b,y);return l.jsxs("div",{className:"p-5 bg-slate-900/70 rounded-2xl border border-white/5 space-y-3",children:[l.jsxs("div",{className:"flex justify-between items-end",children:[l.jsx("span",{className:"text-xs font-black uppercase text-slate-300 tracking-widest",children:g}),l.jsxs("span",{className:"text-xs font-bold text-slate-500",children:[x," / ",v]})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("div",{className:"h-2.5 bg-black/40 rounded-full overflow-hidden border border-white/5 shadow-inner",children:l.jsx("div",{className:"h-full bg-gradient-to-r from-indigo-600 to-indigo-400 transition-all duration-1000 shadow-[0_0_15px_rgba(79,70,229,0.4)]",style:{width:`${p}%`}})}),y>0?E?l.jsxs("button",{onClick:()=>s({type:"CONTRIBUTE_TO_UPGRADE",buildingId:t,resource:g,amount:N}),className:"w-full py-2 bg-indigo-600/80 hover:bg-indigo-600 text-white text-[10px] font-black rounded-xl transition-all active:scale-95 shadow-lg shadow-indigo-600/20 uppercase tracking-widest",children:["Bidra ",N," ",g]}):l.jsxs("div",{className:"w-full py-2 bg-rose-900/10 border border-rose-500/10 text-rose-500/60 text-[9px] font-black rounded-xl text-center uppercase tracking-widest",children:["Mangler ",g]}):l.jsx("div",{className:"text-[10px] text-emerald-500 font-bold uppercase tracking-widest text-center py-1",children:"Krav mtt "})]})]},g)})})]}),!r&&a.contributions&&Object.keys(a.contributions).length>0&&l.jsxs("div",{className:"w-full bg-indigo-500/5 rounded-3xl p-6 border border-indigo-500/10",children:[l.jsxs("div",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-indigo-400 mb-4 flex items-center gap-2",children:[l.jsx("span",{className:"w-1.5 h-1.5 bg-indigo-500 rounded-full"}),"Siste bidrag fra riket"]}),l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:Object.entries(a.contributions).slice(0,4).map(([g,v])=>l.jsxs("div",{className:"flex justify-between items-center bg-black/20 px-4 py-3 rounded-xl border border-white/5",children:[l.jsx("span",{className:"text-xs font-bold text-slate-200",children:v.name}),l.jsx("div",{className:"flex gap-2",children:Object.entries(v.resources||{}).map(([x,p])=>l.jsxs("span",{className:"text-[10px] font-black text-emerald-400",children:["+",p]},x))})]},g))})]}),Object.entries(u.requirements).every(([v,x])=>{var p;return(((p=a.progress)==null?void 0:p[v])||0)>=x})?l.jsx("button",{onClick:()=>{s({type:"CONTRIBUTE_TO_UPGRADE",buildingId:t,resource:"dummy",amount:0})},className:"w-full py-6 bg-emerald-600 hover:bg-emerald-500 text-white font-black uppercase tracking-widest rounded-[1.5rem] shadow-2xl transition-all active:scale-95 flex items-center justify-center gap-3 animate-bounce mt-4 shadow-emerald-600/20",children:"Fullfr Oppgradering "}):null]}):l.jsxs("div",{className:"py-12 px-10 bg-emerald-500/5 border border-emerald-500/10 rounded-[2.5rem] text-center w-full",children:[l.jsx("div",{className:"text-emerald-400 font-black uppercase tracking-widest text-lg mb-2",children:"Mesterverk fullfrt! "}),l.jsx("div",{className:"text-slate-400 text-sm font-medium",children:"Denne bygningen har ndd sitt maksimale potensial."})]})]})},VG=({npc:t,step:e,setStep:n,onClose:s})=>{var i,r;return l.jsx("div",{className:"absolute inset-0 z-50 bg-black/80 backdrop-blur-sm flex items-center justify-center p-6 animate-in fade-in duration-300",children:l.jsxs("div",{className:"bg-slate-900 border-2 border-amber-600/30 rounded-2xl max-w-lg w-full overflow-hidden shadow-2xl",children:[l.jsxs("div",{className:"bg-slate-950 p-6 border-b border-white/5 flex gap-4 items-center",children:[l.jsx("div",{className:"w-16 h-16 rounded-full bg-slate-800 border-2 border-amber-500/50 flex items-center justify-center text-3xl shadow-inner",children:""}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-xl font-black text-amber-500",children:t.name}),l.jsx("p",{className:"text-sm text-slate-400 italic font-medium",children:t.role})]}),l.jsx("button",{onClick:s,className:"ml-auto w-8 h-8 bg-white/5 hover:bg-white/10 rounded-full flex items-center justify-center text-white transition-colors",children:""})]}),l.jsxs("div",{className:"p-8 space-y-6",children:[l.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-widest mb-2 opacity-50",children:t.description}),l.jsxs("p",{className:"text-slate-300 text-lg leading-relaxed italic border-l-4 border-amber-500/20 pl-4 py-2",children:['"',((i=t.conversation[e])==null?void 0:i.text)||"...",'"']}),l.jsx("div",{className:"grid gap-3 pt-4",children:(r=t.conversation[e])==null?void 0:r.options.map((a,o)=>l.jsxs("button",{onClick:()=>{a.nextId==="EXIT"?s():n(a.nextId)},className:"w-full text-left bg-white/5 hover:bg-amber-500/10 hover:border-amber-500/50 border border-white/10 p-4 rounded-xl transition-all font-medium text-slate-200 active:scale-[0.98]",children:[l.jsx("span",{className:"text-amber-500 mr-2",children:""})," ",a.label]},o))})]})]})})},FG=({viewMode:t,viewingRegionId:e,player:n,onSelect:s,onEnterHub:i,onPOIAction:r,room:a})=>t==="kingdom"?null:l.jsx(l.Fragment,{children:lr.map(o=>{var w,T,k,R;if(!(t==="global"?!o.parentId:o.parentId===t))return null;const u=o.roles.includes(n.role)||o.id==="market"||o.isHub,d=["grain_fields","forest_clearing","mine_shaft","quarry_poi","forest_forage"].includes(o.id),f=t==="global",h=f&&e==="region_ost",m=f&&(e==="region_vest"||e==="capital"),g=t==="village",v=Object.values(a.players||{});let x=o.top,p=o.left;g&&o.village?(x=o.village.top,p=o.village.left):h&&o.ost?(x=o.ost.top,p=o.ost.left):m&&o.vest&&(x=o.vest.top,p=o.vest.left);const b=o.id==="castle",y=b&&v.some(C=>C.role==="BARON"&&C.regionId===e||e==="capital"&&C.role==="KING"),E=b?e==="capital"?"throne_room":e==="region_ost"?"manor_ost":"manor_vest":"",A=(b&&((R=(k=(T=(w=a.world)==null?void 0:w.settlement)==null?void 0:T.buildings)==null?void 0:k[E])==null?void 0:R.level)||0)>=1||y;return l.jsx(De.div,{style:{top:x,left:p},initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"absolute -translate-x-1/2 -translate-y-1/2 group z-20 pointer-events-auto",children:l.jsxs("button",{onClick:()=>{if(b&&!A){r(o.id,"OPEN_CONSTRUCTION");return}o.isHub?i(o.id):s(o)},className:`flex flex-col items-center transition-all ${u?"scale-100":"scale-75 opacity-40 grayscale pointer-events-none"}`,children:[l.jsx("div",{className:"w-16 h-16 rounded-3xl flex items-center justify-center text-4xl shadow-2xl border-2 transition-all duration-300 group-hover:scale-110 bg-slate-900/90 backdrop-blur-xl border-white/10 hover:bg-slate-800",children:o.icon}),l.jsx("span",{className:"bg-indigo-600 text-white text-[10px] font-black uppercase tracking-widest px-3 py-1 rounded-full mt-2 shadow-2xl opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap shadow-indigo-600/30",children:d?"KLIKK FOR  STARTE":b?A?"G INN":"BIDRA TIL BYGGING":o.label})]})},o.id)})}),zG=({viewMode:t,viewingRegionId:e,worldEvents:n,onSelect:s})=>t==="kingdom"||!n?null:l.jsx(l.Fragment,{children:Object.values(n).map(i=>{const r=lr.find(m=>m.id===i.locationId);if(!r||!(t==="global"?!r.parentId:r.parentId===t))return null;const o=t==="global",c=o&&e==="region_ost",u=o&&(e==="region_vest"||e==="capital"),d=t==="village";let f=r.top,h=r.left;return d&&r.village?(f=r.village.top,h=r.village.left):c&&r.ost?(f=r.ost.top,h=r.ost.left):u&&r.vest&&(f=r.vest.top,h=r.vest.left),l.jsx(De.div,{style:{top:f,left:h},initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},className:"absolute -translate-x-1/2 -translate-y-[150%] z-30 pointer-events-auto",children:l.jsx("button",{onClick:()=>s(i),className:`w-14 h-14 rounded-full flex items-center justify-center text-3xl shadow-[0_0_30px_rgba(255,255,255,0.4)] border-4 animate-bounce hover:scale-110 transition-transform ${i.type==="RAID"?"bg-rose-600 border-rose-900 text-white":"bg-amber-400 border-amber-700 text-slate-800"}`,children:i.type==="RAID"?"":""})},i.id)})}),$G=({players:t,setViewingRegionId:e,setViewMode:n})=>{const s=Object.values(t||{}),i=s.find(a=>{var o;return a.role==="BARON"&&(a.regionId==="region_vest"||((o=a.regionId)==null?void 0:o.includes("vest")))}),r=s.find(a=>{var o;return a.role==="BARON"&&(a.regionId==="region_ost"||((o=a.regionId)==null?void 0:o.includes("ost")))});return l.jsxs(l.Fragment,{children:[l.jsx(De.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"absolute top-[35%] left-[50%] -translate-x-1/2 -translate-y-1/2 z-30 group pointer-events-auto",children:l.jsxs("button",{onClick:()=>{e("capital"),n("global")},className:"flex flex-col items-center hover:scale-110 transition-transform",children:[l.jsx("div",{className:"text-6xl drop-shadow-[0_0_15px_rgba(255,215,0,0.8)] animate-pulse",children:""}),l.jsx("div",{className:"bg-black/80 text-amber-400 px-4 py-2 rounded-xl mt-2 font-black uppercase tracking-widest text-xs border border-amber-500/50 shadow-xl backdrop-blur-md",children:"Kongeriket"})]})}),l.jsx(De.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"absolute top-[65%] left-[15%] -translate-x-1/2 -translate-y-1/2 z-30 group pointer-events-auto",children:l.jsxs("button",{onClick:()=>{e("region_vest"),n("global")},className:"flex flex-col items-center hover:scale-110 transition-transform",children:[l.jsx("div",{className:"text-5xl drop-shadow-[0_0_10px_rgba(255,255,255,0.5)]",children:""}),l.jsx("div",{className:"bg-black/80 text-indigo-300 px-3 py-1 rounded-xl mt-2 font-bold text-[10px] uppercase tracking-wider border border-white/10 shadow-xl backdrop-blur-md whitespace-nowrap",children:(i==null?void 0:i.name)||"Baroni Vest"})]})}),l.jsx(De.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"absolute top-[65%] left-[85%] -translate-x-1/2 -translate-y-1/2 z-30 group pointer-events-auto",children:l.jsxs("button",{onClick:()=>{e("region_ost"),n("global")},className:"flex flex-col items-center hover:scale-110 transition-transform",children:[l.jsx("div",{className:"text-5xl drop-shadow-[0_0_10px_rgba(255,255,255,0.5)]",children:""}),l.jsx("div",{className:"bg-black/80 text-emerald-300 px-3 py-1 rounded-xl mt-2 font-bold text-[10px] uppercase tracking-wider border border-white/10 shadow-xl backdrop-blur-md whitespace-nowrap",children:(r==null?void 0:r.name)||"Baroni st"})]})})]})},KG=({player:t,room:e,onAction:n,onClose:s,viewingRegionId:i})=>{var N,A,w,T;const r=i==="capital"||t.role==="BARON"||t.role==="KING"?["throne_room","manor_ost","manor_vest"]:i==="region_ost"?["manor_ost"]:["manor_vest"],[a,o]=_.useState(r[0]),c=((A=(N=e.world)==null?void 0:N.settlement)==null?void 0:A.buildings)||{},u=r.filter(k=>c[k]),d=u.includes(a)?a:u[0]||a,f=c[d],h=Bt[d];if(!f||!h)return l.jsx(Td,{title:"Gjenoppbygging",onClose:s,children:l.jsxs("div",{className:"flex flex-col items-center justify-center h-96 text-center p-12",children:[l.jsx("div",{className:"w-16 h-16 bg-slate-900 rounded-full flex items-center justify-center mb-6 text-2xl opacity-50",children:""}),l.jsx("h3",{className:"text-xl font-black text-white italic mb-2",children:"Ingen aktive byggeprosjekter"}),l.jsx("p",{className:"text-slate-500 text-sm max-w-xs",children:"Det er ingen storsltte prosjekter i dette omrdet som krever din hjelp akkurat n. Prv  dra til hovedstaden eller et av baroniene."}),l.jsx("button",{onClick:s,className:"mt-8 px-8 py-3 bg-white/5 hover:bg-white/10 rounded-xl text-[10px] font-black uppercase tracking-widest text-slate-400",children:"Lukk vindu"})]})});const m=(f.level||0)+1,g=((T=(w=h.levels)==null?void 0:w[m])==null?void 0:T.requirements)||{},v=f.contributions||{};let x=0,p=0;Object.entries(g).forEach(([k,R])=>{var C;x+=R,p+=((C=f.progress)==null?void 0:C[k])||0});const b=x>0?p/x*100:0,y=(k,R)=>{n({type:"CONTRIBUTE",buildingId:d,resource:k,amount:R})},E=Object.entries(v).map(([k,R])=>{const C=q.CONTRIBUTION_VALUES;let B=0;return Object.entries(R.resources||{}).forEach(([z,$])=>{B+=$*(C[z]||C.default)}),{id:k,name:R.name,total:B}}).sort((k,R)=>R.total-k.total);return l.jsx(Td,{title:"Gjenoppbygging & Lederskap",onClose:s,children:l.jsxs("div",{className:"max-h-[70vh] overflow-y-auto custom-scrollbar p-1",children:[u.length>1&&l.jsx("div",{className:"flex gap-2 mb-6 bg-slate-900/50 p-1.5 rounded-2xl border border-white/5 w-fit",children:u.map(k=>{var R;return l.jsx("button",{onClick:()=>o(k),className:`px-4 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all ${d===k?"bg-indigo-600 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:((R=Bt[k])==null?void 0:R.name)||k},k)})}),l.jsxs("div",{className:"relative h-48 rounded-3xl overflow-hidden mb-8 group border border-white/5",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-950 via-slate-900/40 to-transparent z-10"}),l.jsx("div",{className:"absolute inset-0 bg-cover bg-center opacity-40 group-hover:scale-105 transition-transform duration-1000 bg-[url('https://images.unsplash.com/photo-1599619351208-3e6c839d6828?q=80&w=2672&auto=format&fit=crop')]"}),l.jsxs("div",{className:"absolute bottom-6 left-8 z-20",children:[l.jsx("h3",{className:"text-3xl font-black text-white italic tracking-tighter uppercase",children:h.name}),l.jsx("p",{className:"text-slate-300 font-medium text-xs max-w-md",children:h.description})]}),l.jsx("div",{className:"absolute top-6 right-8 z-20 bg-emerald-500/20 backdrop-blur-md px-4 py-2 rounded-full border border-emerald-500/30",children:l.jsxs("span",{className:"text-emerald-400 font-black text-xs tabular-nums",children:[b.toFixed(0),"% FULLFRT"]})})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[l.jsx("div",{className:"space-y-6",children:l.jsxs("section",{children:[l.jsx("h4",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mb-4",children:"Mangler for ferdigstillelse"}),l.jsx("div",{className:"space-y-4",children:Object.entries(g).map(([k,R])=>{var U,O,j,I;const C=((U=f.progress)==null?void 0:U[k])||0,B=R,z=Math.min(100,C/B*100),$=C>=B,K=((O=t.resources)==null?void 0:O[k])||0;return l.jsxs("div",{className:`p-4 rounded-2xl border transition-all ${$?"bg-emerald-500/5 border-emerald-500/20":"bg-slate-900/50 border-white/5"}`,children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"text-xl",children:((j=mn[k])==null?void 0:j.icon)||""}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-bold text-white tracking-tight italic",children:((I=mn[k])==null?void 0:I.label)||k}),l.jsxs("p",{className:"text-[10px] text-slate-500 font-medium",children:["Beholdning: ",l.jsx("span",{className:"text-slate-300",children:K})]})]})]}),l.jsx("div",{className:"text-right",children:l.jsxs("span",{className:`text-xs font-black ${$?"text-emerald-400":"text-slate-300"}`,children:[C," / ",B]})})]}),l.jsx("div",{className:"h-1.5 w-full bg-slate-950 rounded-full overflow-hidden mb-4",children:l.jsx("div",{style:{width:`${z}%`},className:`h-full transition-all duration-500 ${$?"bg-emerald-500":"bg-indigo-500"}`})}),!$&&K>0&&l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>y(k,Math.min(10,K)),className:"flex-1 py-2 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl text-[10px] font-black text-white transition-all uppercase",children:"Gi 10"}),l.jsx("button",{onClick:()=>y(k,Math.min(50,K)),className:"flex-1 py-2 bg-indigo-600 hover:bg-indigo-500 rounded-xl text-[10px] font-black text-white transition-all uppercase",children:"Gi 50"})]})]},k)})})]})}),l.jsxs("div",{className:"space-y-8",children:[l.jsxs("section",{className:"bg-slate-900/50 border border-white/5 rounded-[2rem] p-6",children:[l.jsx("h4",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mb-6 px-2",children:"Toppbidragsytere"}),l.jsx("div",{className:"space-y-2",children:E.length===0?l.jsx("div",{className:"text-center py-8 text-slate-500 text-xs italic",children:"Ingen bidrag enda. Bli den frste!"}):E.slice(0,5).map((k,R)=>l.jsxs("div",{className:`flex items-center justify-between p-3 rounded-xl ${R===0?"bg-amber-500/10 border border-amber-500/20":"hover:bg-white/5 transition-colors"}`,children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:`w-6 h-6 rounded-lg flex items-center justify-center text-[10px] font-black ${R===0?"bg-amber-500 text-slate-950":"bg-slate-800 text-slate-400"}`,children:R+1}),l.jsx("span",{className:`text-sm font-bold ${R===0?"text-white":"text-slate-300"}`,children:k.name})]}),l.jsxs("span",{className:"text-xs font-mono text-slate-500",children:[k.total.toLocaleString()," poeng"]})]},k.id))})]}),l.jsxs("section",{className:"bg-indigo-600/10 border border-indigo-500/20 rounded-[2rem] p-6 relative overflow-hidden",children:[l.jsx("div",{className:"absolute -top-4 -right-4 w-24 h-24 bg-indigo-500/10 blur-2xl rounded-full"}),l.jsx("h4",{className:"text-[10px] font-black text-indigo-400 uppercase tracking-widest mb-4",children:"Gevinst"}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("span",{className:"text-4xl",children:a==="throne_room"?"":""}),l.jsxs("div",{children:[l.jsx("p",{className:"text-white font-black italic tracking-tight underline decoration-indigo-500/50",children:a==="throne_room"?"TITTEL: KONGE":"TITTEL: BARON"}),l.jsx("p",{className:"text-slate-400 text-xs mt-1",children:"Spilleren med hyest poengsum ved ferdigstillelse overtar styringen."})]})]})]})]})]})]})})},hA=we.memo(({player:t,room:e,world:n,worldEvents:s,players:i,onAction:r,onOpenMarket:a})=>{var Ie;const o=(n==null?void 0:n.season)||"Spring",{viewMode:c,setViewMode:u,viewingRegionId:d,setViewingRegionId:f,selectedPOI:h,setSelectedPOI:m,selectedEvent:g,setSelectedEvent:v,upgradingBuildingId:x,setUpgradingBuildingId:p,dialogNPC:b,setDialogNPC:y,dialogStep:E,setDialogStep:N,isDiceGameOpen:A,setIsDiceGameOpen:w,isChickenCoopOpen:T,setIsChickenCoopOpen:k,isConstructionOpen:R,setIsConstructionOpen:C,direction:B,handlePOIAction:z}=xG(t,r,a),$=(n==null?void 0:n.weather)||"Clear",U=(()=>{var st,zt,On,Mt,Yn,pn,Hi;const V=Ss(((st=e.world)==null?void 0:st.gameTick)||0)==="NIGHT",me=o==="Winter";let ne="";switch(c){case"kingdom":ne=me?V?"map_kingdom_169_winter_night":"map_kingdom_169_winter":V?"map_kingdom_169_night":"map_kingdom_169";break;case"village":ne=me?V?"map_village_hub_1610_winter_night":"map_village_hub_1610_winter":V?"map_village_hub_1610_night":"map_village_hub_1610";break;case"castle":ne="map_castle_interior";break;case"fields":ne=me?V?"map_farm_fields_winter_night":"map_farm_fields_winter":V?"map_farm_fields_night":"map_farm_fields";break;case"peasant_farm":{const qn=((Mt=(On=(zt=n==null?void 0:n.settlement)==null?void 0:zt.buildings)==null?void 0:On.farm_house)==null?void 0:Mt.level)||1;ne=qn>1?`map_peasant_farm_lvl${qn}`:"map_peasant_farm";break}case"farm_house":{const qn=((Hi=(pn=(Yn=n==null?void 0:n.settlement)==null?void 0:Yn.buildings)==null?void 0:pn.farm_house)==null?void 0:Hi.level)||1;ne=qn>1?`map_stugo_interior_lvl${qn}`:"map_stugo_interior";break}case"mine":ne=me?V?"map_mountain_pass_winter_night":"map_mountain_pass_winter":V?"map_mountain_pass_night":"map_mountain_pass";break;case"forest":ne=me?V?"map_forest_winter_night":"map_forest_winter":V?"map_forest_night":"map_forest";break;case"monastery":ne=me?V?"map_monastery_winter_night":"map_monastery_winter":V?"map_monastery_night":"map_monastery";break;case"tavern":ne="map_tavern_interior";break;case"great_forge":ne="map_forge_interior";break;case"bakery":ne="map_bakery_interior";break;case"windmill":ne="map_windmill_interior";break;case"sawmill":ne="map_sawmill_interior";break;case"smeltery":ne="map_smeltery_interior";break;case"weavery":ne="map_weavery_interior";break;case"stables":ne="map_stables_interior";break;case"watchtower":ne="map_watchtower_interior";break;case"well":ne=me?V?"map_well_interior_winter_night":"map_well_interior_winter":V?"map_well_interior_night":"map_well_interior";break;case"apothecary":ne="map_apothecary_interior";break;case"global":d==="region_ost"?ne=me?V?"map_barony_ost_169_winter_night":"map_barony_ost_169_winter":V?"map_barony_ost_169_night":"map_barony_ost_169":d==="capital"?ne=me?V?"map_hovedstad_169_winter_night":"map_hovedstad_169_winter":V?"map_hovedstad_169_night":"map_hovedstad_169":ne=me?V?"map_barony_vest_v2_1610_winter_night":"map_barony_vest_v2_1610_winter":V?"map_barony_vest_v2_1610_night":"map_barony_vest_v2_1610";break;default:ne="map_barony_vest_v2_1610"}return{src:`/${ne}.webp`,placeholder:`/${ne}_tiny.webp`,original:`/${ne}.png`}})(),j=c==="kingdom"||c==="global"&&(d==="region_ost"||d==="capital")?"aspect-video":"aspect-[16/10]",I={initial:V=>({opacity:0,scale:V==="in"?.9:1.1,filter:"blur(10px)"}),animate:{opacity:1,scale:1,filter:"blur(0px)",transition:{duration:.6,ease:[.16,1,.3,1],staggerChildren:.05}},exit:V=>({opacity:0,scale:V==="in"?1.1:.9,filter:"blur(10px)",transition:{duration:.4,ease:[.7,0,.84,0]}})},H=`${c}-${d}`,X=_.useMemo(()=>lr.find(V=>V.id===c),[c]),oe=!!(X!=null&&X.isInterior);return l.jsxs("div",{className:"relative w-full h-full flex flex-col items-center justify-center p-4",children:[l.jsxs("div",{className:`relative w-full max-w-full max-h-full mx-auto ${j} rounded-[2rem] overflow-hidden shadow-[0_0_80px_rgba(0,0,0,0.5)] border-4 border-white/5 bg-slate-950 transition-all duration-1000`,children:[l.jsx(Ei,{mode:"popLayout",custom:B,children:l.jsxs(De.div,{custom:B,variants:I,initial:"initial",animate:"animate",exit:"exit",className:"absolute inset-0 w-full h-full",children:[l.jsxs("div",{className:"w-full h-full relative",children:[l.jsx(fA,{src:U.src,placeholderSrc:U.placeholder,alt:"Map View",className:"w-full h-full",disableMotion:!0}),l.jsx("div",{className:`absolute inset-0 pointer-events-none transition-opacity duration-1000 ${$==="Fog"?"opacity-100 backdrop-blur-sm bg-white/10":"opacity-0"}`})]}),l.jsx(BG,{weather:$,season:o,isInterior:oe}),l.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[c==="kingdom"&&l.jsx($G,{players:i||{},setViewingRegionId:f,setViewMode:u}),l.jsx(FG,{viewMode:c,viewingRegionId:d,player:t,room:e,onSelect:m,onEnterHub:u,onPOIAction:z}),l.jsx(zG,{viewMode:c,viewingRegionId:d,worldEvents:s,onSelect:v})]})]},H)}),l.jsx(UG,{player:t,room:e}),c!=="kingdom"&&l.jsxs("button",{onClick:()=>{if(c==="global")u("kingdom");else{const V=lr.find(me=>me.id===c);V!=null&&V.parentId?u(V.parentId):u("global")}},className:"absolute top-6 left-6 z-50 px-6 py-3 bg-slate-950/80 backdrop-blur-md border border-white/10 rounded-2xl text-[10px] font-black uppercase tracking-widest text-slate-400 hover:text-white hover:border-white/20 transition-all active:scale-95 flex items-center gap-2 group",children:[l.jsx("span",{className:"text-lg group-hover:-translate-x-1 transition-transform",children:""}),"Tilbake"]}),g&&l.jsx("div",{className:"absolute inset-x-6 bottom-6 z-40 animate-in slide-in-from-bottom-8 duration-500",children:l.jsxs("div",{className:"bg-slate-900/95 backdrop-blur-2xl rounded-[2.5rem] shadow-[0_30px_100px_rgba(0,0,0,0.8)] border border-white/10 p-8",children:[l.jsxs("div",{className:"flex justify-between items-start mb-6",children:[l.jsxs("div",{children:[l.jsx("span",{className:`text-[10px] font-black uppercase tracking-widest px-3 py-1 rounded-full ${g.type==="RAID"?"bg-rose-500/20 text-rose-400":"bg-amber-500/20 text-amber-500"}`,children:g.type==="RAID"?" Akutt Trussel":" Spesielt Oppdrag"}),l.jsx("h3",{className:"text-3xl font-black text-white mt-4 tracking-tighter",children:g.title})]}),l.jsx("button",{onClick:()=>v(null),className:"w-10 h-10 bg-white/5 hover:bg-white/10 text-white rounded-full flex items-center justify-center transition-colors",children:""})]}),l.jsxs("p",{className:"text-sm font-medium text-slate-400 mb-8 leading-relaxed italic opacity-80",children:['"',g.description,'"']}),l.jsx("button",{onClick:()=>{r({type:g.type==="RAID"?"DEFEND":"EXPLORE",eventId:g.id}),v(null)},className:`w-full py-5 rounded-2xl font-black uppercase tracking-widest text-sm shadow-2xl transition-all active:scale-95 ${g.type==="RAID"?"bg-rose-600 text-white shadow-rose-600/20":"bg-amber-500 text-slate-950 shadow-amber-500/20"}`,children:g.type==="RAID"?"TIL VPEN! ":"UTFORSK OMRDET! "})]})}),l.jsx(Ei,{children:h&&l.jsx(PG,{poi:h,player:t,room:e,onAction:V=>z(h.id,V),onClose:()=>m(null),viewingRegionId:d})})]}),l.jsxs(Ei,{children:[x&&l.jsx(Td,{title:"Bygg & Oppgrader",onClose:()=>p(null),children:l.jsx(GG,{buildingId:x,player:t,room:e,onAction:r})}),A&&l.jsx(yG,{playerGold:((Ie=t.resources)==null?void 0:Ie.gold)||0,onClose:()=>w(!1),onPlay:V=>r({type:"PLAY_DICE",...V})}),T&&l.jsx(HG,{player:t,activeProcesses:t.activeProcesses||[],onAction:r,onClose:()=>k(!1)}),b&&l.jsx(VG,{npc:b,step:E,setStep:N,onClose:()=>y(null)}),R&&l.jsx(KG,{player:t,room:e,onAction:r,onClose:()=>C(!1),viewingRegionId:d})]})]})},(t,e)=>{var i,r,a,o,c,u;if(((i=t.world)==null?void 0:i.season)!==((r=e.world)==null?void 0:r.season)||((a=t.world)==null?void 0:a.weather)!==((o=e.world)==null?void 0:o.weather))return!1;const n=Ss(((c=t.world)==null?void 0:c.gameTick)||0),s=Ss(((u=e.world)==null?void 0:u.gameTick)||0);return n!==s||t.player.activeProcesses!==e.player.activeProcesses?!1:t.player===e.player&&t.room===e.room&&t.world===e.world&&t.worldEvents===e.worldEvents});hA.displayName="WorldMap";const YG=({onClose:t})=>{const{currentTrackId:e,playlist:n,playNext:s,playPrevious:i,toggleIgnoreTrack:r,isIgnored:a,playMusic:o,stopMusic:c}=R0(),[u,d]=_.useState(!!e),f=n.find(m=>m.id===e)||n[0],h=()=>{u&&e?(c(),d(!1)):(e?o(e):s(),d(!0))};return l.jsxs("div",{className:"absolute inset-0 z-50 flex items-center justify-center p-4",children:[l.jsx(De.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:t,className:"absolute inset-0 bg-black/60 backdrop-blur-sm cursor-pointer"}),l.jsxs(De.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",bounce:.3},className:"relative w-full max-w-4xl h-[600px] bg-slate-950/80 backdrop-blur-2xl border border-white/10 rounded-[3rem] shadow-2xl overflow-hidden flex flex-col md:flex-row",children:[l.jsx("button",{onClick:t,className:"absolute top-6 right-6 z-20 p-2 rounded-full bg-white/5 hover:bg-white/10 text-white transition-colors",children:l.jsx(ji,{size:24})}),l.jsxs("div",{className:"flex-1 relative flex flex-col items-center justify-center p-12 bg-gradient-to-br from-indigo-900/40 to-slate-900/40 border-r border-white/5",children:[l.jsx("div",{className:`absolute inset-0 opacity-30 bg-gradient-to-tr ${(f==null?void 0:f.mood)==="Dark"?"from-rose-900/40":"from-indigo-600/20"} to-transparent transition-colors duration-1000`}),l.jsxs("div",{className:"relative z-10 mb-12 group",children:[l.jsxs("div",{className:`w-64 h-64 rounded-full bg-slate-900 border-4 border-white/10 shadow-[0_0_60px_rgba(0,0,0,0.6)] flex items-center justify-center relative overflow-hidden ${u&&e?"animate-[spin_8s_linear_infinite]":""}`,children:[l.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle,rgba(99,102,241,0.2)0%,transparent_70%)]"}),l.jsx("div",{className:"absolute inset-2 rounded-full border border-white/5 opacity-50"}),l.jsx("div",{className:"absolute inset-8 rounded-full border border-white/5 opacity-30"}),l.jsx(g3,{size:64,className:"text-white/20"})]}),l.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:l.jsx("button",{onClick:h,className:"w-20 h-20 bg-white/90 rounded-full flex items-center justify-center shadow-2xl hover:scale-105 active:scale-95 transition-all text-slate-900",children:u&&e?l.jsx(ap,{size:32,fill:"currentColor"}):l.jsx(yd,{size:32,fill:"currentColor",className:"ml-1"})})})]}),l.jsxs("div",{className:"text-center space-y-2 z-10",children:[l.jsx("p",{className:"text-xs font-black uppercase tracking-[0.3em] text-indigo-400",children:"N Spiller"}),l.jsx("h2",{className:"text-3xl font-black text-white tracking-tighter max-w-sm leading-tight",children:f?f.title:"Ingen Musikk"}),(f==null?void 0:f.mood)&&l.jsxs("span",{className:"inline-block px-3 py-1 bg-white/5 rounded-full text-[10px] font-bold text-slate-400 uppercase tracking-widest border border-white/5",children:[f.mood," Mood"]})]})]}),l.jsxs("div",{className:"w-full md:w-[400px] bg-black/20 flex flex-col",children:[l.jsxs("div",{className:"p-8 pb-4 border-b border-white/5 flex items-center justify-between",children:[l.jsxs("h3",{className:"text-sm font-black text-white uppercase tracking-widest flex items-center gap-2",children:[l.jsx(H3,{size:16,className:"text-indigo-400"})," Spilleliste"]}),l.jsxs("span",{className:"text-[10px] font-bold text-slate-500",children:[n.length," Spor"]})]}),l.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 space-y-2",children:n.map((m,g)=>{const v=e===m.id,x=a(m.id);return l.jsxs("div",{className:`group flex items-center justify-between p-4 rounded-xl border transition-all duration-300 ${v?"bg-indigo-600/10 border-indigo-500/50 shadow-lg shadow-indigo-900/20":x?"bg-transparent border-transparent opacity-40 grayscale hover:opacity-100 hover:bg-slate-800/50":"bg-transparent border-transparent hover:bg-white/5 hover:border-white/5"}`,children:[l.jsxs("button",{onClick:()=>{o(m.id),d(!0)},className:"flex items-center gap-4 flex-1 text-left min-w-0",children:[l.jsx("span",{className:`text-xs font-bold w-6 text-center ${v?"text-indigo-400":"text-slate-600"}`,children:v?l.jsx(pP,{size:14,className:"mx-auto animate-pulse"}):g+1}),l.jsx("div",{className:"min-w-0",children:l.jsx("p",{className:`text-sm font-bold truncate ${v?"text-white":"text-slate-400 group-hover:text-slate-200"}`,children:m.title})})]}),l.jsx("button",{onClick:p=>{p.stopPropagation(),r(m.id)},className:`p-2 rounded-lg opacity-0 group-hover:opacity-100 transition-all ${x?"opacity-100 text-rose-400 hover:bg-rose-500/10":"text-slate-500 hover:text-white hover:bg-white/10"}`,title:x?"Gjenoppta":"Ignorer",children:x?l.jsx(v3,{size:16}):l.jsx(y3,{size:16})})]},m.id)})}),l.jsxs("div",{className:"p-6 border-t border-white/5 bg-black/40 flex items-center justify-between",children:[l.jsx("button",{onClick:i,className:"p-4 rounded-full hover:bg-white/5 text-slate-400 hover:text-white transition-colors",children:l.jsx(tP,{size:20})}),l.jsx("div",{className:"h-10 w-[1px] bg-white/5"}),l.jsx("button",{onClick:h,className:"p-4 rounded-full hover:bg-white/5 text-white transition-colors scale-110 active:scale-95",children:u&&e?l.jsx(ap,{size:24,fill:"currentColor"}):l.jsx(yd,{size:24,fill:"currentColor",className:"ml-1"})}),l.jsx("div",{className:"h-10 w-[1px] bg-white/5"}),l.jsx("button",{onClick:s,className:"p-4 rounded-full hover:bg-white/5 text-slate-400 hover:text-white transition-colors",children:l.jsx(sP,{size:20})})]})]})]})]})},qG=({result:t,onClear:e})=>(_.useEffect(()=>{if(t){t.success&&t.utbytte&&t.utbytte.length>0&&t.utbytte.forEach((s,i)=>{s.amount>0&&setTimeout(()=>{Ge.spawnFlyingResource(s.resource,window.innerWidth/2,window.innerHeight/2,window.innerWidth-150,60)},i*200)});const n=setTimeout(()=>{e()},6e3);return()=>clearTimeout(n)}},[t,e]),l.jsx(Ei,{children:t&&l.jsxs(De.div,{initial:{opacity:0,y:-20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},className:"fixed top-[5%] left-1/2 transform -translate-x-1/2 bg-slate-900/95 border-2 border-amber-500/30 p-5 rounded-[2rem] shadow-[0_0_50px_rgba(0,0,0,0.5)] backdrop-blur-md min-w-[300px] text-center z-[300] overflow-hidden",children:[l.jsx("div",{className:"absolute bottom-0 left-0 h-1 bg-amber-500/20 w-full overflow-hidden",children:l.jsx(De.div,{initial:{width:"100%"},animate:{width:"0%"},transition:{duration:7,ease:"linear"},className:"h-full bg-amber-500"})}),l.jsx("button",{onClick:n=>{n.stopPropagation(),e()},className:"absolute top-4 right-4 text-slate-500 hover:text-white transition-colors p-1",children:l.jsx(ji,{className:"w-5 h-5"})}),l.jsxs("div",{className:"relative z-10",children:[l.jsx("div",{className:`text-lg font-black mb-3 tracking-tight ${t.success?"text-white":"text-rose-400"}`,children:t.message}),t.utbytte&&t.utbytte.length>0&&l.jsx("div",{className:"flex flex-wrap justify-center gap-2 mb-3",children:t.utbytte.map((n,s)=>{const i=mn[n.resource]||{label:n.resource,icon:""},r=n.name||i.label,a=n.icon||i.icon,o=n.amount>=0,c=n.jackpot;return l.jsxs(De.div,{initial:{scale:0,y:10},animate:{scale:1,y:0},transition:{delay:.2+s*.1,type:"spring"},className:`flex items-center gap-2 px-4 py-2 rounded-2xl text-sm font-black border shadow-lg ${c?"bg-gradient-to-r from-amber-200 to-yellow-400 border-yellow-300 text-yellow-900 shadow-amber-500/50 animate-pulse":o?"bg-emerald-500/10 border-emerald-500/30 text-emerald-400":"bg-rose-500/10 border-rose-500/30 text-rose-400"}`,children:[l.jsx("span",{className:"text-lg",children:a}),l.jsxs("span",{children:[o?"+":"",n.resource==="gold"?n.amount.toFixed(2):n.amount," ",c&&r]})]},`${n.resource}-${s}`)})}),t.xp&&t.xp.length>0&&l.jsx("div",{className:"flex flex-col gap-2 mb-2",children:t.xp.map((n,s)=>l.jsxs(De.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.4+s*.1},className:"text-xs font-black uppercase tracking-widest text-indigo-400 bg-indigo-500/5 py-1 rounded-lg",children:["+",n.amount," XP ",n.skill,n.levelUp&&l.jsxs(De.div,{initial:{scale:.5,opacity:0,rotate:-5},animate:{scale:[1,1.2,1],opacity:1,rotate:[0,5,-5,0],filter:["brightness(1)","brightness(2)","brightness(1)"]},transition:{duration:.6,times:[0,.5,1],repeat:1/0,repeatType:"reverse"},className:"mt-2 inline-flex items-center gap-2 bg-gradient-to-r from-amber-400 to-amber-600 text-black px-4 py-1.5 rounded-full text-[10px] font-black shadow-[0_0_20px_rgba(245,158,11,0.5)] border border-amber-300/50",children:[l.jsx("span",{children:""}),l.jsx("span",{className:"tracking-[0.2em]",children:"NIV OPPGGRADERT!"}),l.jsx("span",{children:""})]})]},`xp-${s}`))}),t.durability&&t.durability.length>0&&l.jsx("div",{className:"mt-4 pt-4 border-t border-white/5 flex flex-wrap justify-center gap-3",children:t.durability.map((n,s)=>l.jsxs("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider flex items-center gap-1",children:[" ",n.item,": ",l.jsxs("span",{className:n.amount>0?"text-rose-400":"text-emerald-400",children:[n.amount>0?"-":"+",Math.abs(n.amount),"%"]}),n.broken&&l.jsx("span",{className:"text-rose-500 font-black ml-1 animate-pulse",children:"(DELAGT!)"})]},`dura-${s}`))})]})]})})),WG=async(t,e,n,s)=>{if(e===n)return{success:!1,error:"Kan ikke gi gave til deg selv"};const i=D(L,`simulation_rooms/${t}/players/${e}`),r=D(L,`simulation_rooms/${t}/players/${n}`),a=await xe(i),o=await xe(r);if(!a.exists())return{success:!1,error:"Sender finnes ikke"};if(!o.exists())return{success:!1,error:"Mottaker finnes ikke"};const c=a.val(),u=o.val(),d=u.name;if(c.regionId!==u.regionId)return{success:!1,error:"Du kan kun sende gaver til spillere i din region."};let f=!1,h="";if(await Ae(i,v=>{if(v===null)return v;v.resources||(v.resources={});for(const[x,p]of Object.entries(s))if((v.resources[x]||0)<p)return;for(const[x,p]of Object.entries(s))v.resources[x]-=p,h+=`${p} ${x}, `;return f=!0,v}),!f)return{success:!1,error:"Ikke nok ressurser til  sende gaven."};let m=!1;if(await Ae(r,v=>{if(v===null)return v;v.resources||(v.resources={});for(const[x,p]of Object.entries(s))v.resources[x]=(v.resources[x]||0)+p;return m=!0,v}),!m)return console.error("CRITICAL: Gift transaction partial failure. Sender deducted but target failed.",e,n),{success:!1,error:"Transaksjonsfeil: Gaven gikk tapt i posten (Mottaker utilgjengelig i skrivende stund)."};const g=`Sendte gave (${h.slice(0,-2)}) til ${d}.`;return Et(t,`[GAVE] ${c.name} -> ${d}: ${h}`),{success:!0,data:{success:!0,timestamp:Date.now(),message:g}}},XG=async(t,e,n,s,i)=>{const r=D(L,`simulation_rooms/${t}/players/${e}`),a=D(L,`simulation_rooms/${t}/trades`),o=await xe(r),c=await xe(D(L,`simulation_rooms/${t}/players/${n}`));if(!o.exists()||!c.exists())return{success:!1,error:"Spiller finnes ikke"};const u=o.val(),d=c.val(),f=u.name,h=d.name;if(u.regionId!==d.regionId)return{success:!1,error:"Handel er kun tillatt med spillere i din region."};let m=!1;if(await Ae(r,x=>{var p;if(x===null)return x;for(const[b,y]of Object.entries(s))if((((p=x.resources)==null?void 0:p[b])||0)<y)return;for(const[b,y]of Object.entries(s))x.resources[b]-=y;return m=!0,x}),!m)return{success:!1,error:"Ikke nok ressurser til  opprette handelen."};const g=hS(a),v={id:g.key,senderId:e,senderName:f,receiverId:n,receiverName:h,offer:s,demand:i,status:"PENDING",createdAt:Date.now(),expiresAt:Date.now()+1e3*60*60*24};return await Ba(g,v),Et(t,`[HANDEL] ${f} tilbd handel til ${h}.`),{success:!0,message:"Handelstilbud sendt."}},QG=async(t,e,n,s)=>{const i=D(L,`simulation_rooms/${t}/trades/${n}`),r=await xe(i);if(!r.exists())return{success:!1,error:"Handelen finnes ikke lenger."};const a=r.val();if(a.status!=="PENDING")return{success:!1,error:"Handelen er ikke lenger aktiv."};if(a.receiverId!==e&&a.senderId!==e&&!(a.senderId===e&&s==="REJECT"))return{success:!1,error:"Du har ikke tilgang til denne handelen."};if(s==="REJECT"){const o=D(L,`simulation_rooms/${t}/players/${a.senderId}`);return await Ae(o,c=>{if(c===null)return c;c.resources||(c.resources={});for(const[u,d]of Object.entries(a.offer))c.resources[u]=(c.resources[u]||0)+d;return c}),await J(i,{status:a.senderId===e?"CANCELLED":"REJECTED"}),{success:!0,message:"Handel avbrutt/avsltt."}}if(s==="ACCEPT"){const o=D(L,`simulation_rooms/${t}/players/${e}`);let c=!1;if(await Ae(o,d=>{var f;if(d===null)return d;for(const[h,m]of Object.entries(a.demand))if((((f=d.resources)==null?void 0:f[h])||0)<m)return;for(const[h,m]of Object.entries(a.demand))d.resources[h]-=m;for(const[h,m]of Object.entries(a.offer))d.resources[h]=(d.resources[h]||0)+m;return c=!0,d}),!c)return{success:!1,error:"Du har ikke rd til denne handelen."};const u=D(L,`simulation_rooms/${t}/players/${a.senderId}`);return await Ae(u,d=>{if(d===null)return d;d.resources||(d.resources={});for(const[f,h]of Object.entries(a.demand))d.resources[f]=(d.resources[f]||0)+h;return d}),await J(i,{status:"ACCEPTED"}),Et(t,`[HANDEL] ${a.receiverName} godtok handelen fra ${a.senderName}.`),{success:!0,message:"Handel gjennomfrt!"}}},JG=({player:t,room:e,onAction:n,pin:s})=>{const[i,r]=_.useState([]),a=_.useRef({}),o=_.useRef(0),c=_.useMemo(()=>e.messages?Array.isArray(e.messages)?e.messages:Object.values(e.messages).sort((m,g)=>m.timestamp-g.timestamp):[],[e.messages]),u=m=>{r(v=>[...v,m]);const g=m.actions?1e4:5e3;setTimeout(()=>d(m.id),g)},d=m=>{r(g=>g.filter(v=>v.id!==m))},f=async(m,g)=>{const v=await QG(s,t.id,m,g);v&&v.success?(d(`trade-${m}`),u({id:`trade-res-${Date.now()}`,title:g==="ACCEPT"?"Handel Gjennomfrt":"Handel Avsltt",message:v.message||"Transaksjon fullfrt.",type:"TRADE"})):u({id:`trade-err-${Date.now()}`,title:"Feil ved handel",message:(v==null?void 0:v.error)||"Noe gikk galt.",type:"TRADE"})},h=(m,g,v)=>!v[m];return _.useEffect(()=>{const m=e.trades||{},g=a.current;Object.entries(m).forEach(([v,x])=>{if(h(v,x,g)&&x.receiverId===t.id&&x.status==="PENDING"){const p=Object.entries(x.offer).map(([y,E])=>`${E} ${y}`).join(", "),b=Object.entries(x.demand).map(([y,E])=>`${E} ${y}`).join(", ");u({id:`trade-${v}`,title:"Nytt Handelstilbud",message:`${x.senderName} tilbyr ${p} for ${b}.`,type:"TRADE",actions:[{label:"Aksepter",variant:"primary",icon:l.jsx(j0,{size:14}),onClick:()=>f(v,"ACCEPT")},{label:"Forhandle",variant:"neutral",icon:l.jsx(jl,{size:14}),onClick:()=>{d(`trade-${v}`),alert("Forhandling er ikke implementert enn. Avsl handelen for  sende nytt tilbud.")}},{label:"Avsl",variant:"danger",icon:l.jsx(ji,{size:14}),onClick:()=>f(v,"REJECT")}]})}}),a.current=m},[e.trades,t.id,s]),_.useEffect(()=>{var v;const m=c;if(m.length===0)return;const g=m[m.length-1];if(o.current===0&&m.length>0){o.current=m[m.length-1].timestamp;return}if(g.timestamp>o.current){const x=g.content;if(x.startsWith("[GAVE]")&&x.includes(`-> ${t.name}`)){const b=x.split("->")[0].replace("[GAVE]","").trim(),y=((v=x.split(":")[1])==null?void 0:v.trim())||"";u({id:`gift-${g.timestamp}`,title:`Gave fra ${b}`,message:`Du mottok: ${y}`,type:"GIFT"})}o.current=g.timestamp}},[c,t.name]),i.length===0?null:l.jsx("div",{className:"absolute top-24 right-8 z-[100] flex flex-col gap-4 pointer-events-none",children:i.map(m=>l.jsxs("div",{className:"pointer-events-auto bg-slate-900/95 backdrop-blur-xl border border-white/10 p-4 rounded-xl shadow-2xl flex flex-col gap-3 animate-in slide-in-from-right duration-300 w-96",children:[l.jsxs("div",{className:"flex items-start gap-4",children:[l.jsx("div",{className:`p-3 rounded-lg ${m.type==="GIFT"?"bg-indigo-500/20 text-indigo-400":"bg-emerald-500/20 text-emerald-400"}`,children:m.type==="GIFT"?l.jsx(wS,{size:24}):l.jsx(O0,{size:24})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h4",{className:"font-bold text-white text-sm",children:m.title}),l.jsx("p",{className:"text-slate-400 text-xs mt-1 leading-relaxed",children:m.message})]}),l.jsx("button",{onClick:()=>d(m.id),className:"text-slate-600 hover:text-white transition-colors",children:l.jsx(ji,{size:16})})]}),m.actions&&l.jsx("div",{className:"flex gap-2 pt-2 border-t border-white/5",children:m.actions.map((g,v)=>l.jsxs("button",{onClick:g.onClick,className:`
                                        flex-1 py-2 px-3 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition-all active:scale-95
                                        ${g.variant==="primary"?"bg-emerald-600 hover:bg-emerald-500 text-white shadow-lg shadow-emerald-500/20":""}
                                        ${g.variant==="danger"?"bg-rose-600/20 hover:bg-rose-600/30 text-rose-400 border border-rose-500/30":""}
                                        ${g.variant==="neutral"?"bg-slate-700 hover:bg-slate-600 text-slate-200":""}
                                    `,children:[g.icon,g.label]},v))})]},m.id))})},ZG=we.lazy(()=>Gt(()=>import("./SimulationMarket-vVXknkil.js"),__vite__mapDeps([0,1,2,3])).then(t=>({default:t.SimulationMarket}))),eV=we.lazy(()=>Gt(()=>import("./SimulationVault-Bb6Wkq9B.js"),__vite__mapDeps([4,5])).then(t=>({default:t.SimulationVault}))),tV=we.lazy(()=>Gt(()=>import("./SimulationSkills-CfYtRbkt.js"),__vite__mapDeps([6,1,7])).then(t=>({default:t.SimulationSkills}))),nV=we.lazy(()=>Gt(()=>import("./SimulationProduction-Bte1H2eV.js"),__vite__mapDeps([8,2,7])).then(t=>({default:t.SimulationProduction}))),sV=we.lazy(()=>Gt(()=>import("./SimulationActivity-Dnryb9R3.js"),[]).then(t=>({default:t.SimulationActivity}))),iV=we.lazy(()=>Gt(()=>import("./SimulationDiplomacy-D0WYIR-l.js"),[]).then(t=>({default:t.SimulationDiplomacy}))),rV=we.lazy(()=>Gt(()=>import("./SimulationHierarchy-DhKMGh5t.js"),__vite__mapDeps([9,10,2,1,3,5])).then(t=>({default:t.SimulationHierarchy}))),aV=we.lazy(()=>Gt(()=>import("./SimulationProfile-Chk-jeGv.js"),__vite__mapDeps([11,3])).then(t=>({default:t.SimulationProfile}))),oV=we.lazy(()=>Gt(()=>import("./SimulationSettings-Bmjiz-uf.js"),[]).then(t=>({default:t.SimulationSettings}))),lV=we.lazy(()=>Gt(()=>import("./PoliticalHub-CWsjA3-R.js"),__vite__mapDeps([10,2,1,3,5])).then(t=>({default:t.PoliticalHub}))),cV=we.lazy(()=>Gt(()=>import("./SimulationWarRoom-Bad7oIJF.js"),__vite__mapDeps([12,2])).then(t=>({default:t.SimulationWarRoom}))),uV=we.lazy(()=>Gt(()=>import("./SiegeEngine-BEwiUmMb.js"),__vite__mapDeps([13,2])).then(t=>({default:t.SiegeEngine}))),dV=({player:t,room:e,pin:n,onAction:s,actionResult:i,onClearActionResult:r})=>{var v,x;const{activeTab:a,setActiveTab:o,isMusicWindowOpen:c,setMusicWindowOpen:u,viewingRegionId:d}=gf(),[f,h]=we.useState(!1),m=async p=>{if(!f){h(!0);try{await J(D(L,`simulation_rooms/${n}/activeVote/votes`),{[t.id]:p})}catch(b){console.error("Voting failed",b)}finally{setTimeout(()=>h(!1),1500)}}},g=["MAP","PRODUCTION","MARKET","INVENTORY","SKILLS","DIPLOMACY","HIERARCHY","PROFILE","POLITICS"].includes(a);return l.jsxs("div",{className:"flex-1 relative flex flex-col overflow-hidden w-full h-full",children:[l.jsxs("div",{className:`flex-1 relative w-full h-full ${g?"p-4 md:p-6 overflow-hidden flex items-center justify-center":"p-4 md:p-8 overflow-y-auto overflow-x-hidden custom-scrollbar"}`,children:[g&&l.jsx("div",{className:"absolute inset-0 z-0",children:l.jsx(hA,{player:t,room:e,world:e.world,worldEvents:e.worldEvents,players:e.players,onAction:s,onOpenMarket:()=>o("MARKET")})}),l.jsxs(we.Suspense,{fallback:l.jsx("div",{className:"w-full h-full flex items-center justify-center pointer-events-none",children:l.jsx("div",{className:"w-8 h-8 border-2 border-white/20 border-t-white rounded-full animate-spin"})}),children:[(()=>{var y;const p=d||t.regionId||"",b=(y=e.regions[p])==null?void 0:y.activeSiege;return!b||!(a==="SIEGE"||g)?null:l.jsx("div",{className:`absolute inset-0 z-10 ${a!=="SIEGE"?"opacity-20 pointer-events-none blur-sm grayscale":""}`,children:l.jsx(uV,{player:t,siege:b,regionId:p,onAction:s,messages:Array.isArray(e.messages)?e.messages:Object.values(e.messages||{})})})})(),l.jsxs("div",{className:"absolute inset-0 z-20 pointer-events-none flex flex-col items-center justify-center",children:[a==="PRODUCTION"&&l.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-4xl md:h-auto md:max-h-[85vh] overflow-hidden",children:l.jsx(nV,{player:t,room:e,onAction:s,pin:n||""})}),a==="MARKET"&&l.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-5xl md:h-[90vh] overflow-hidden",children:l.jsx(ZG,{player:t,market:((v=e.markets)==null?void 0:v[t.regionId||"capital"])||e.market,regions:e.regions,allMarkets:e.markets,onAction:s,pin:n||""})}),a==="INVENTORY"&&l.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-4xl md:h-[80vh] overflow-hidden",children:l.jsx(eV,{player:t,onAction:s})}),a==="SKILLS"&&l.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-4xl md:h-[80vh] overflow-hidden",children:l.jsx(tV,{player:t})}),a==="DIPLOMACY"&&l.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-4xl md:h-[85vh] overflow-hidden",children:l.jsx(iV,{player:t,diplomacy:e.diplomacy,pin:n||""})}),a==="HIERARCHY"&&l.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-5xl md:h-[85vh] overflow-hidden",children:l.jsx(rV,{players:e.players,currentPlayer:t,regions:e.regions,onAction:s,pin:n||""})}),a==="PROFILE"&&l.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-2xl md:h-[85vh] overflow-hidden",children:l.jsx(aV,{player:t,regions:e.regions||{},allPlayers:e.players||{}})}),a==="POLITICS"&&l.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-6xl md:h-[90vh] overflow-hidden",children:l.jsx(lV,{player:t,room:e,onClose:()=>o("MAP")})}),a==="WAR_ROOM"&&l.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-4xl md:h-[85vh] overflow-hidden",children:l.jsx(cV,{player:t,regions:e.regions,onAction:s,onClose:()=>o("HIERARCHY")})})]}),a!=="MAP"&&!g&&l.jsx("div",{className:"max-w-4xl mx-auto w-full space-y-8 animate-in slide-in-from-bottom-4 duration-500 relative z-20",children:a==="SETTINGS"?l.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-slate-950/40 backdrop-blur-md p-8 animate-in fade-in duration-300",children:l.jsx(oV,{onClose:()=>o("MAP")})}):a==="ACTIVITY"?l.jsx(sV,{messages:e.messages}):null})]})]}),e.activeVote&&!((x=e.activeVote.votes)!=null&&x[t.id])&&l.jsx("div",{className:"absolute bottom-6 right-6 z-[50] w-96 animate-in slide-in-from-right duration-500",children:l.jsxs("div",{className:"bg-slate-900/95 backdrop-blur-xl rounded-2xl border border-indigo-500/50 p-6 shadow-2xl shadow-indigo-500/10",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-white font-bold text-lg leading-tight mb-1",children:"Tinget er satt"}),l.jsx("p",{className:"text-indigo-300 text-xs font-medium uppercase tracking-wider",children:"Avgi din stemme"})]}),l.jsx("div",{className:"bg-indigo-500/20 p-2 rounded-lg",children:l.jsx("span",{className:"text-2xl",children:""})})]}),l.jsxs("div",{className:"mb-6",children:[l.jsx("h4",{className:"text-white font-medium mb-2",children:e.activeVote.title}),l.jsx("p",{className:"text-slate-400 text-sm line-clamp-3 leading-relaxed",children:e.activeVote.description})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("button",{onClick:()=>m("YES"),disabled:f,className:`bg-emerald-600/80 hover:bg-emerald-500 text-white py-3 rounded-xl font-bold text-sm transition-all active:scale-95 flex items-center justify-center gap-2 ${f?"opacity-50 cursor-not-allowed":""}`,children:[l.jsx("span",{children:""})," VEDTA"]}),l.jsxs("button",{onClick:()=>m("NO"),disabled:f,className:`bg-rose-600/80 hover:bg-rose-500 text-white py-3 rounded-xl font-bold text-sm transition-all active:scale-95 flex items-center justify-center gap-2 ${f?"opacity-50 cursor-not-allowed":""}`,children:[l.jsx("span",{children:""})," AVSL"]})]})]})}),l.jsx(Ei,{}),l.jsx(Ei,{children:c&&l.jsx(YG,{onClose:()=>u(!1)})}),l.jsx(JG,{player:t,room:e,onAction:s,pin:n||""}),l.jsx(qG,{result:i,onClear:r})]})},fV=()=>{const[t,e]=_.useState([]);return _.useEffect(()=>Ge.subscribe(s=>{e(i=>[...i,s]),setTimeout(()=>{e(i=>i.filter(r=>r.id!==s.id))},s.duration+500)}),[]),l.jsx("div",{className:"fixed inset-0 pointer-events-none z-[200] overflow-hidden",children:l.jsx(Ei,{children:t.map(n=>{if(n.type==="FLOATING_TEXT")return l.jsx(De.div,{initial:{opacity:0,scale:.5,y:0,rotate:(Math.random()-.5)*20},animate:{opacity:1,scale:1.2,y:-120,x:(Math.random()-.5)*40,rotate:(Math.random()-.5)*40},exit:{opacity:0,scale:.8},transition:{duration:.8,ease:"easeOut"},className:`absolute font-black text-4xl drop-shadow-2xl ${n.color||"text-amber-500"}`,style:{left:`${n.x}%`,top:`${n.y}%`,transform:"translate(-50%, -50%)",zIndex:210},children:n.text},n.id);if(n.type==="FLYING_RESOURCE"){const s=mn[n.resource]||{icon:""};return l.jsx(De.div,{initial:{left:`${n.startPoint.x}px`,top:`${n.startPoint.y}px`,scale:.5,opacity:0},animate:{left:`${n.endPoint.x}px`,top:`${n.endPoint.y}px`,scale:[.5,1.5,1],opacity:1},exit:{opacity:0,scale:.5},transition:{duration:1,ease:"easeInOut"},className:"absolute text-4xl z-[220] drop-shadow-xl",children:s.icon},n.id)}return n.type==="PARTICLE"?l.jsx(we.Fragment,{children:[...Array(6)].map((s,i)=>l.jsx(De.div,{initial:{left:`${n.x}%`,top:`${n.y}%`,scale:1,opacity:1},animate:{left:`${n.x+(Math.random()-.5)*15}%`,top:`${n.y+(Math.random()-.5)*15}%`,scale:0,opacity:0},transition:{duration:.6,ease:"easeOut"},className:`absolute w-3 h-3 rounded-sm ${n.color||"bg-amber-400"} z-[205]`},`${n.id}-p-${i}`))},n.id):null})})})},hV=({level:t,title:e,onClose:n})=>l.jsxs("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-500",children:[l.jsx("div",{className:"bg-gradient-to-br from-amber-400 via-amber-500 to-amber-600 p-1 rounded-[2.5rem] shadow-[0_0_50px_rgba(245,158,11,0.5)] animate-in zoom-in duration-500",children:l.jsxs("div",{className:"bg-white rounded-[2.2rem] p-10 text-center relative overflow-hidden max-w-sm",children:[l.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-amber-200 via-yellow-400 to-amber-200"}),l.jsxs("div",{className:"relative z-10",children:[l.jsx("div",{className:"text-7xl mb-6 animate-bounce",children:""}),l.jsx("h2",{className:"text-sm font-black text-amber-600 uppercase tracking-[0.3em] mb-2",children:"Niv Oppndd!"}),l.jsxs("h3",{className:"text-6xl font-black text-slate-800 mb-4",children:["Niv ",t]}),l.jsx("div",{className:"h-0.5 w-16 bg-slate-200 mx-auto mb-6"}),l.jsx("p",{className:"text-slate-500 font-medium mb-1",children:"Ny Tittel:"}),l.jsx("p",{className:"text-3xl font-black text-indigo-600 mb-8",children:e}),l.jsx("button",{onClick:n,className:"w-full bg-slate-900 hover:bg-slate-800 text-white py-5 rounded-2xl font-black text-xl shadow-xl transition-all active:scale-95",children:"FORTSETT REISEN"})]}),l.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-20",children:[...Array(20)].map((s,i)=>l.jsx("div",{className:"absolute w-2 h-2 bg-amber-500 rounded-full animate-ping",style:{top:`${Math.random()*100}%`,left:`${Math.random()*100}%`,animationDelay:`${Math.random()*2}s`,animationDuration:`${2+Math.random()*2}s`}},i))})]})}),l.jsx("style",{dangerouslySetInnerHTML:{__html:`
                    @keyframes ping-slow {
                        0% { transform: scale(1); opacity: 0.8; }
                        100% { transform: scale(3); opacity: 0; }
                    }
                `}})]}),mV=({pin:t,account:e,onCreatePlayer:n,isCreating:s})=>{const i=Xa(),[r,a]=_.useState("WELCOME"),[o,c]=_.useState((e==null?void 0:e.displayName)||""),[u,d]=_.useState("PEASANT");return r==="WELCOME"?l.jsxs("div",{className:"bg-slate-900/40 backdrop-blur-3xl border border-white/5 p-12 md:p-16 rounded-[3.5rem] text-center space-y-10 shadow-2xl animate-in fade-in zoom-in duration-500",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsx("h1",{className:"text-6xl md:text-8xl font-black italic text-white tracking-tighter leading-none",children:"FEUDAL SIM"}),l.jsx("p",{className:"text-indigo-400 font-black uppercase tracking-[0.4em] text-xs",children:"En Levende Simulator"})]}),l.jsx("div",{className:"space-y-6",children:l.jsx("p",{className:"text-slate-400 text-lg md:text-xl font-medium max-w-md mx-auto leading-relaxed",children:"Dette er et spill om makt, ressurser og overlevelse i et feydalt samfunn."})}),l.jsxs("div",{className:"pt-4 space-y-4",children:[l.jsxs("button",{onClick:()=>a("CREATE"),className:"px-12 py-5 bg-indigo-600 hover:bg-indigo-500 text-white rounded-[2rem] font-black uppercase tracking-widest text-sm shadow-2xl shadow-indigo-600/40 transition-all hover:scale-105 active:scale-95 flex items-center justify-center gap-3 mx-auto w-64",children:["Skap din Karakter ",l.jsx(ga,{size:20})]}),l.jsx("button",{onClick:()=>i("/sim"),className:"text-slate-500 hover:text-white font-black uppercase tracking-widest text-xs transition-colors",children:"G til Lobby"})]})]}):r==="CREATE"?l.jsxs("div",{className:"bg-slate-900 border border-white/10 p-12 rounded-[3.5rem] shadow-2xl space-y-10 animate-in slide-in-from-bottom-8 duration-500",children:[l.jsxs("div",{className:"text-center space-y-2",children:[l.jsx("h2",{className:"text-4xl font-black italic text-white tracking-tighter uppercase",children:"Hvem er du?"}),l.jsxs("p",{className:"text-slate-500 font-bold uppercase tracking-widest text-xs",children:["Opprett din karakter i ",t]})]}),l.jsxs("div",{className:"space-y-8",children:[l.jsxs("div",{className:"space-y-3",children:[l.jsx("label",{className:"text-xs font-black text-indigo-400 uppercase tracking-[0.2em] ml-2",children:"Ditt Navn i Riket"}),l.jsxs("div",{className:"relative group",children:[l.jsx("div",{className:"absolute inset-y-0 left-6 flex items-center text-slate-500 group-focus-within:text-indigo-400",children:l.jsx(vf,{size:20})}),l.jsx("input",{type:"text",value:o,onChange:f=>c(f.target.value),placeholder:"f.eks. Eirik den Rde",className:"w-full bg-slate-950 border-2 border-white/5 rounded-3xl py-5 pl-16 pr-6 text-xl font-black text-white outline-none focus:border-indigo-500/50 transition-all"})]})]}),t==="TEST"&&l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:["PEASANT","SOLDIER","MERCHANT","BARON"].map(f=>l.jsx("button",{onClick:()=>d(f),className:`py-4 rounded-2xl font-black uppercase tracking-widest text-xs border-2 transition-all ${u===f?"bg-indigo-600/20 border-indigo-500 text-white":"bg-white/5 border-transparent text-slate-500"}`,children:f},f))}),l.jsxs("div",{className:"pt-4 flex gap-4",children:[l.jsx("button",{onClick:()=>a("WELCOME"),className:"flex-1 py-5 bg-white/5 text-slate-400 rounded-3xl font-black uppercase tracking-widest text-xs",children:"Tilbake"}),l.jsx("button",{onClick:()=>{n(o,u),a("SUCCESS")},disabled:!o.trim()||s,className:"flex-[2] py-5 bg-indigo-600 text-white rounded-3xl font-black uppercase tracking-widest text-sm",children:s?"Oppretter...":"Start Reisen"})]})]})]}):l.jsxs("div",{className:"bg-emerald-500/10 backdrop-blur-3xl border border-emerald-500/30 p-16 rounded-[4rem] text-center space-y-8 shadow-2xl animate-in zoom-in duration-500",children:[l.jsx(j0,{size:48,className:"text-white mx-auto bg-emerald-500 rounded-[2rem] p-4 shadow-2xl"}),l.jsx("h2",{className:"text-4xl font-black italic text-white uppercase",children:"Velkommen inn!"})]})},pV={KING:bf,BARON:D0,PEASANT:k3,SOLDIER:op,MERCHANT:_S},gV={KING:["Sikre rikets stabilitet","Samle inn skatter fra baronene","Beskytte 'The Orb of Power'"],BARON:["Administrer din region","Krev inn skatter fra bndene","Bygg opp forsvaret mot invasjoner"],PEASANT:["Dyrk jorden og hst korn","Betal skatt for  unng fengsel","Overlev vinteren"],SOLDIER:["Beskytt riket mot farer","Tren deg opp i kamp","Adlyde ordrer fra Kongen"],MERCHANT:["Kjp og selg varer p markedet","Tjen deg rik p handel","Unng  bli plyndret"]},bV={KING:"Du er den verste lederen. Din makt er absolutt, men ditt ansvar er tungt. Riket hviler p dine skuldre.",BARON:"Du styrer et av rikets store landomrder. Du er bindeleddet mellom Kongen og folket.",PEASANT:"Du er ryggraden i samfunnet. Uten ditt harde arbeid ville riket sultet. Livet er hardt, men rlig.",SOLDIER:"Du er sverdets mester. Din plikt er  beskytte de svake og opprettholde lov og orden.",MERCHANT:"Du forstr verdien av gull. Mens andre slss eller dyrker, bygger du formuer gjennom smart handel."},vV=({player:t,pin:e,onComplete:n})=>{var d,f;const[s,i]=_.useState(0),[r,a]=_.useState(!1),o=pV[t.role]||vf,c=gV[t.role]||["Overlev","Utforsk","Lr"];_.useEffect(()=>{if(s===0){const h=setTimeout(()=>i(1),3e3);return()=>clearTimeout(h)}},[s]);const u=async()=>{a(!0);try{const h={};h[`simulation_rooms/${e}/players/${t.id}/hasSeenIntro`]=!0,await J(D(L),h),setTimeout(n,500)}catch(h){console.error("Failed to save intro state",h),n()}};return s===0?l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-950 text-white animate-in fade-in duration-1000",children:l.jsxs("div",{className:"text-center space-y-8 animate-in zoom-in duration-1000 slide-in-from-bottom-10 fill-mode-forwards",children:[l.jsxs("div",{className:"relative inline-block",children:[l.jsx("div",{className:"absolute inset-0 bg-indigo-500/20 blur-[100px] rounded-full animate-pulse"}),l.jsx(o,{size:120,className:"relative z-10 text-white drop-shadow-[0_0_30px_rgba(255,255,255,0.5)]"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"text-slate-400 font-bold uppercase tracking-[0.5em] text-sm animate-in fade-in delay-500 duration-1000",children:"Skjebnen har valgt..."}),l.jsx("h1",{className:"text-6xl md:text-8xl font-black italic tracking-tighter uppercase animate-in slide-in-from-bottom-5 delay-700 duration-500",children:((d=Cl[t.role])==null?void 0:d.label)||t.role})]})]})}):l.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center bg-slate-950/90 backdrop-blur-3xl transition-opacity duration-500 ${r?"opacity-0":"opacity-100"}`,children:l.jsxs("div",{className:"max-w-4xl w-full mx-4 grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-16 items-center",children:[l.jsxs("div",{className:"text-center space-y-8 order-2 md:order-1 animate-in slide-in-from-left-10 duration-700",children:[l.jsxs("div",{className:"relative inline-block p-10 bg-gradient-to-br from-indigo-500/20 to-purple-500/20 rounded-[3rem] border border-white/10 shadow-2xl",children:[l.jsx(o,{size:180,className:"text-white drop-shadow-2xl"}),l.jsx("div",{className:"absolute -bottom-6 left-1/2 -translate-x-1/2 bg-slate-900 border border-white/20 px-6 py-2 rounded-full whitespace-nowrap",children:l.jsx("span",{className:"text-xs font-black uppercase tracking-widest text-indigo-300",children:"Din tildelte rolle"})})]}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-4xl font-black italic tracking-tighter uppercase mb-4",children:(f=Cl[t.role])==null?void 0:f.label}),l.jsx("p",{className:"text-slate-400 font-medium leading-relaxed max-w-sm mx-auto",children:bV[t.role]})]})]}),l.jsxs("div",{className:"space-y-8 order-1 md:order-2 animate-in slide-in-from-right-10 duration-700 delay-200",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx("h3",{className:"text-sm font-black uppercase tracking-[0.3em] text-indigo-400",children:"Dine Ml"}),l.jsx("h1",{className:"text-5xl font-black italic tracking-tighter text-white",children:"Oppdrag"})]}),l.jsx("div",{className:"space-y-4",children:c.map((h,m)=>l.jsxs("div",{className:"flex items-center gap-4 bg-white/5 border border-white/5 p-4 rounded-2xl hover:bg-white/10 transition-colors group",children:[l.jsx("div",{className:"w-10 h-10 rounded-full bg-emerald-500/20 flex items-center justify-center text-emerald-400 border border-emerald-500/20 group-hover:scale-110 transition-transform",children:l.jsx("span",{className:"font-black text-sm",children:m+1})}),l.jsx("span",{className:"font-bold text-slate-200",children:h})]},m))}),l.jsx("div",{className:"pt-8",children:l.jsxs("button",{onClick:u,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white py-6 rounded-[2rem] font-black uppercase text-lg tracking-widest shadow-2xl shadow-indigo-600/30 hover:scale-105 active:scale-95 transition-all flex items-center justify-center gap-4 group",children:["Start Din Reise ",l.jsx(ga,{className:"group-hover:translate-x-2 transition-transform"})]})})]})]})})},xV=(t,e)=>{const[n,s]=_.useState("global"),[i,r]=_.useState({}),[a,o]=_.useState({}),[c,u]=_.useState(!1);return _.useEffect(()=>{if(!e)return;const d={};if(d.global={id:"global",name:"Riket",type:"GLOBAL",unreadCount:0,description:"Offentlig torg"},e.role==="KING")d.region_vest={id:"region_vest",name:"Vest",type:"REGION",unreadCount:0,description:"Regional kanal for Vest"},d.region_ost={id:"region_ost",name:"st",type:"REGION",unreadCount:0,description:"Regional kanal for st"},d.capital={id:"capital",name:"Hovedstaden",type:"REGION",unreadCount:0,description:"Hovedstaden"};else if(e.regionId){const f=e.regionId==="capital"?"Hovedstaden":e.regionId==="region_vest"?"Vest":e.regionId==="region_ost"?"st":e.regionId;d[e.regionId]={id:e.regionId,name:f,type:"REGION",unreadCount:0,description:"Ditt hjemsted"}}(e.role==="BARON"||e.role==="KING")&&(d.diplomacy={id:"diplomacy",name:"Rdet",type:"DIPLOMACY",unreadCount:0,description:"Hemmelig kanal for ledere"}),r(f=>{const h={...d};return Object.keys(f).forEach(m=>{h[m]&&(h[m].unreadCount=f[m].unreadCount)}),h})},[e==null?void 0:e.regionId,e==null?void 0:e.role]),_.useEffect(()=>{if(!t||!n)return;u(!0);const d=D(L,`simulation_rooms/${t}/channels/${n}/messages`),f=SL(d,kL(50)),h=Ke(f,m=>{const g=m.val(),v=g?Object.values(g):[];v.sort((x,p)=>x.timestamp-p.timestamp),o(x=>({...x,[n]:v})),u(!1)});return()=>h()},[t,n]),{activeChannelId:n,setActiveChannelId:s,channels:i,messages:a[n]||[],isLoading:c}},Yc=(...t)=>t.filter(Boolean).join(" "),yV=({pin:t,player:e,onOpenProfile:n})=>{var p;const[s,i]=_.useState(!1),{activeChannelId:r,setActiveChannelId:a,channels:o,messages:c,isLoading:u}=xV(t,e),[d,f]=_.useState(""),[h,m]=_.useState(!1),g=_.useRef(null);_.useEffect(()=>{g.current&&g.current.scrollIntoView({behavior:"smooth"})},[c,s]),_.useEffect(()=>{const b=y=>{var E;["INPUT","TEXTAREA"].includes(((E=document.activeElement)==null?void 0:E.tagName)||"")||y.key.toLowerCase()==="c"&&i(N=>!N)};return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[]);const v=async()=>{if(!d.trim()||h)return;m(!0);const b=await PP(t,e.id,d,r);b.success?f(""):alert(b.error||"Feil ved sending."),m(!1)},x=b=>{switch(b){case"GLOBAL":return l.jsx(L0,{size:14});case"REGION":return l.jsx(ES,{size:14});case"DIPLOMACY":return l.jsx(bf,{size:14,className:"text-amber-400"});case"DM":return l.jsx(M0,{size:14});default:return l.jsx(jl,{size:14})}};return s?l.jsxs("div",{className:"fixed bottom-6 left-6 z-50 w-[380px] h-[500px] flex flex-col bg-slate-950/95 border border-slate-800/80 rounded-2xl shadow-2xl backdrop-blur-xl animate-in slide-in-from-bottom-10 fade-in duration-300",children:[l.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-slate-800/50 bg-slate-900/50 rounded-t-2xl drag-handle cursor-grab active:cursor-grabbing",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500 animate-pulse"}),l.jsx("span",{className:"text-xs font-bold uppercase tracking-widest text-slate-400",children:"Comms Array"})]}),l.jsx("button",{onClick:()=>i(!1),className:"text-slate-500 hover:text-white transition-colors",children:l.jsx(u3,{size:18})})]}),l.jsx("div",{className:"flex gap-1 p-2 bg-slate-900/30 overflow-x-auto scrollbar-hide",children:Object.values(o).map(b=>l.jsxs("button",{onClick:()=>a(b.id),className:Yc("flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-semibold whitespace-nowrap transition-all",r===b.id?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"bg-slate-800/50 text-slate-400 hover:bg-slate-800 hover:text-slate-200"),children:[x(b.type),b.name]},b.id))}),l.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar bg-gradient-to-b from-slate-950/50 to-transparent",children:[u?l.jsx("div",{className:"flex justify-center p-4",children:l.jsx("div",{className:"w-6 h-6 border-2 border-indigo-500 border-t-transparent rounded-full animate-spin"})}):c.length===0?l.jsx("div",{className:"text-center text-slate-600 text-xs italic mt-10",children:"Ingen meldinger i denne kanalen enn."}):c.map(b=>{const y=b.senderId===e.id;return l.jsxs("div",{className:Yc("flex flex-col gap-1 max-w-[85%]",y?"ml-auto items-end":"mr-auto items-start"),children:[l.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-slate-500 px-1",children:[l.jsx("span",{onClick:()=>n&&n(b.senderId||""),className:Yc("font-bold hover:underline cursor-pointer",y?"text-indigo-400":"text-amber-500"),children:b.senderName}),l.jsxs("span",{className:"opacity-50",children:[" ",new Date(b.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),l.jsxs("div",{className:Yc("px-3 py-2 rounded-2xl text-sm leading-relaxed shadow-sm break-words relative group",y?"bg-indigo-600 text-white rounded-tr-sm":"bg-slate-800 text-slate-200 rounded-tl-sm border border-slate-700/50"),children:[b.content,!y&&b.senderRole!=="PEASANT"&&l.jsx("div",{className:"absolute -top-2 -right-2 bg-slate-950 border border-slate-700 text-[8px] font-black uppercase px-1.5 py-0.5 rounded shadow-xl scale-0 group-hover:scale-100 transition-transform",children:b.senderRole})]})]},b.id)}),l.jsx("div",{ref:g})]}),l.jsx("div",{className:"p-3 bg-slate-900/80 border-t border-slate-800 backdrop-blur-md",children:l.jsxs("div",{className:"relative flex items-center gap-2",children:[l.jsx("input",{value:d,onChange:b=>f(b.target.value),onKeyDown:b=>b.key==="Enter"&&!b.shiftKey&&v(),placeholder:`Melding til #${((p=o[r])==null?void 0:p.name)||"kanal"}...`,className:"flex-1 bg-slate-950 border border-slate-700 rounded-xl px-4 py-2.5 text-sm text-white placeholder:text-slate-600 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500 transition-all shadow-inner",disabled:h}),l.jsx("button",{onClick:v,disabled:!d.trim()||h,className:"bg-indigo-600 hover:bg-indigo-500 text-white p-2.5 rounded-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-indigo-500/20 active:scale-95",children:h?l.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):l.jsx(NS,{size:16})}),e.role!=="KING"&&r==="global"&&l.jsx("div",{className:"absolute -top-6 right-2 text-[10px] text-amber-500 font-mono bg-amber-950/30 px-2 py-0.5 rounded border border-amber-900/50",children:"Kostnad: 2 Gull"})]})})]}):l.jsx("button",{onClick:()=>i(!0),className:"fixed bottom-6 left-6 z-50 bg-slate-900/90 border border-slate-700/50 text-white p-3 rounded-full shadow-2xl hover:bg-indigo-600 hover:scale-105 transition-all group backdrop-blur-md",children:l.jsxs("div",{className:"relative",children:[l.jsx(jl,{size:24,className:"group-hover:text-white text-slate-200"}),l.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full animate-pulse border-2 border-slate-900"})]})})},H_=["gold","grain","wood","iron_ore","stone","plank","iron_ingot","bread","swords","armor","cloth","wool"],_V=({isOpen:t,onClose:e,myPlayer:n,targetPlayer:s,pin:i})=>{const[r,a]=_.useState({gold:0}),[o,c]=_.useState({gold:0}),[u,d]=_.useState(!1),[f,h]=_.useState(null);if(!t)return null;we.useEffect(()=>{const p=b=>{b.key==="Escape"&&e()};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[e]);const m=async()=>{d(!0),h(null);try{const p=await XG(i,n.id,s.id,r,o);p.success?(h("Handelstilbud sendt!"),setTimeout(e,1500)):(h("Feil: "+p.error),d(!1))}catch(p){console.error(p),h("En ukjent feil oppstod."),d(!1)}},g=(p,b)=>{a(y=>({...y,[p]:Math.max(0,b)}))},v=(p,b)=>{c(y=>({...y,[p]:Math.max(0,b)}))},x=({label:p,values:b,onChange:y,max:E})=>l.jsxs("div",{className:"space-y-2",children:[l.jsx("h4",{className:"text-xs font-bold uppercase text-slate-400 tracking-wider mb-2",children:p}),l.jsxs("div",{className:"space-y-2 max-h-60 overflow-y-auto pr-2 custom-scrollbar",children:[H_.map(N=>{const A=b[N]||0,w=E?E(N):9999;return E&&w<=0&&A<=0?null:l.jsxs("div",{className:"flex items-center gap-2 bg-slate-900/50 p-2 rounded-lg border border-slate-700/50",children:[l.jsx("span",{className:"text-lg w-8 text-center",children:xd[N.toUpperCase()]||""}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:"text-xs text-slate-300 font-medium capitalize truncate",children:N.replace("_"," ")}),E&&l.jsxs("div",{className:"text-[10px] text-slate-500",children:["Du har: ",w]})]}),l.jsx("input",{type:"number",value:A||"",placeholder:"0",onChange:T=>y(N,parseInt(T.target.value)||0),className:"w-20 bg-slate-800 border border-slate-700 rounded px-2 py-1 text-right text-sm font-mono focus:outline-none focus:border-indigo-500"})]},N)}),!E&&l.jsx("div",{className:"text-xs text-slate-500 text-center italic mt-2",children:"Velg hva du krever"})]})]});return l.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:l.jsxs("div",{className:"w-full max-w-4xl bg-slate-900 border border-indigo-500/30 rounded-2xl shadow-2xl flex flex-col max-h-[90vh] overflow-hidden",children:[l.jsxs("div",{className:"p-6 bg-slate-900 border-b border-indigo-500/20 flex justify-between items-center relative overflow-hidden",children:[l.jsx("div",{className:"absolute inset-0 bg-indigo-600/5 opacity-0 group-hover:opacity-100 transition-opacity"}),l.jsxs("div",{children:[l.jsxs("h2",{className:"text-2xl font-black italic text-white flex items-center gap-3",children:[l.jsx(O0,{className:"text-indigo-400"}),"HANDELSKONTRAKT"]}),l.jsxs("p",{className:"text-slate-400 text-sm",children:["Opprett et tilbud til ",l.jsx("span",{className:"text-white font-bold",children:s.name})]})]}),l.jsx("button",{onClick:e,className:"relative z-10 p-2 hover:bg-slate-800 rounded-full transition-colors cursor-pointer",children:l.jsx(ji,{className:"text-slate-400"})})]}),l.jsxs("div",{className:"flex-1 overflow-hidden grid grid-cols-1 md:grid-cols-2 divide-y md:divide-y-0 md:divide-x divide-slate-800 bg-slate-950/50",children:[l.jsx("div",{className:"p-6 overflow-hidden flex flex-col",children:l.jsx(x,{label:"Ditt Tilbud (Assets)",values:r,onChange:g,max:p=>n.resources[p]||0})}),l.jsx("div",{className:"p-6 overflow-hidden flex flex-col",children:l.jsxs("div",{className:"space-y-2 max-h-[60vh] overflow-y-auto pr-2 custom-scrollbar",children:[l.jsx("h4",{className:"text-xs font-bold uppercase text-slate-400 tracking-wider mb-2",children:"Ditt Krav (Liabilities)"}),H_.map(p=>l.jsxs("div",{className:"flex items-center gap-2 bg-slate-900/50 p-2 rounded-lg border border-slate-700/50 hover:border-indigo-500/30 transition-colors",children:[l.jsx("span",{className:"text-lg w-8 text-center opacity-70",children:xd[p.toUpperCase()]||""}),l.jsx("span",{className:"flex-1 text-xs text-slate-300 font-medium capitalize truncate",children:p.replace("_"," ")}),l.jsx("input",{type:"number",value:o[p]||"",placeholder:"0",onChange:b=>v(p,parseInt(b.target.value)||0),className:"w-20 bg-slate-800 border border-slate-700 rounded px-2 py-1 text-right text-sm font-mono focus:outline-none focus:border-indigo-500"})]},p))]})})]}),l.jsxs("div",{className:"p-6 bg-slate-900 border-t border-indigo-500/20 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2 text-yellow-500/80 text-xs",children:[l.jsx(rp,{size:14}),l.jsx("span",{children:"Ressursene trekkes umiddelbart (Escrow)."})]}),l.jsxs("div",{className:"flex items-center gap-4",children:[f&&l.jsx("span",{className:`text-sm font-bold ${f.startsWith("Feil")?"text-red-400":"text-green-400"}`,children:f}),l.jsx("button",{onClick:m,disabled:u||f!==null,className:"px-6 py-3 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-xl flex items-center gap-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-indigo-500/20",children:u?"Signerer...":l.jsxs(l.Fragment,{children:[l.jsx(NS,{size:18}),"Send Kontrakt"]})})]})]})]})})},wV=["gold","grain","wood","iron_ore","bread"],EV=({isOpen:t,onClose:e,myPlayer:n,targetPlayer:s,pin:i})=>{const[r,a]=_.useState("INFO"),[o,c]=_.useState(!1);we.useEffect(()=>{const p=b=>{b.key==="Escape"&&e()};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[e]);const[u,d]=_.useState("gold"),[f,h]=_.useState(0),[m,g]=_.useState(null),v=p=>{switch(p){case"KING":return l.jsx(bf,{size:32,className:"text-yellow-400"});case"BARON":return l.jsx(D0,{size:32,className:"text-purple-400"});case"SOLDIER":return l.jsx(op,{size:32,className:"text-red-400"});case"MERCHANT":return l.jsx(_S,{size:32,className:"text-emerald-400"});default:return l.jsx(vf,{size:32,className:"text-slate-400"})}},x=async()=>{if(f<=0)return;g("Sender...");const p={};p[u]=f;const b=await WG(i,n.id,s.id,p);b.success?(g(`Sendte ${f} ${u}!`),setTimeout(()=>{g(null),a("INFO")},1500)):g("Feil: "+b.error)};return t?o?l.jsx(_V,{isOpen:!0,onClose:()=>c(!1),myPlayer:n,targetPlayer:s,pin:i}):l.jsx("div",{className:"fixed inset-0 z-[50] flex items-center justify-center p-4 bg-slate-950/60 backdrop-blur-sm animate-in fade-in duration-200",children:l.jsxs("div",{className:"w-full max-w-md bg-slate-900 border border-slate-700 rounded-3xl shadow-2xl overflow-hidden flex flex-col relative",children:[l.jsx("div",{className:`h-32 w-full relative bg-gradient-to-br ${s.role==="KING"?"from-yellow-900/40 to-slate-900":"from-indigo-900/40 to-slate-900"}`,children:l.jsx("div",{className:"absolute top-4 right-4",children:l.jsx("button",{onClick:e,className:"p-2 bg-black/20 hover:bg-black/40 rounded-full transition-colors backdrop-blur-sm text-white",children:l.jsx(ji,{size:20})})})}),l.jsxs("div",{className:"px-8 relative -mt-16 mb-4 flex flex-col items-center",children:[l.jsxs("div",{className:"w-32 h-32 rounded-full border-4 border-slate-900 bg-slate-800 flex items-center justify-center shadow-xl relative group overflow-hidden",children:[s.avatar?l.jsx("img",{src:s.avatar,alt:s.name,className:"w-full h-full object-cover"}):v(s.role),l.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"})]}),l.jsx("h2",{className:"text-2xl font-black text-white mt-4",children:s.name}),l.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-sm font-medium uppercase tracking-wider",children:[l.jsx("span",{className:"text-indigo-400",children:s.role}),l.jsx("span",{children:""}),l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx(ES,{size:12})," ",s.regionId||"Ukjent"]})]})]}),l.jsxs("div",{className:"flex-1 px-8 pb-8 space-y-6",children:[r==="INFO"&&l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{className:"bg-slate-950/50 p-4 rounded-2xl border border-slate-800 text-center",children:[l.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-widest font-bold mb-1",children:"Level"}),l.jsx("div",{className:"text-3xl font-black text-white",children:s.stats.level})]}),l.jsxs("div",{className:"bg-slate-950/50 p-4 rounded-2xl border border-slate-800 text-center",children:[l.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-widest font-bold mb-1",children:"Reputasjon"}),l.jsx("div",{className:"text-3xl font-black text-indigo-400",children:s.stats.reputation})]})]}),r==="GIFT"&&l.jsxs("div",{className:"bg-slate-950/50 p-6 rounded-2xl border border-slate-800 space-y-4 animate-in slide-in-from-bottom-4 duration-300",children:[l.jsx("h3",{className:"text-center text-slate-300 font-bold",children:"Send en gave"}),l.jsx("div",{className:"flex gap-2 justify-center",children:wV.map(p=>l.jsx("button",{onClick:()=>d(p),className:`p-2 rounded-lg border transition-all ${u===p?"bg-indigo-600 border-indigo-500":"bg-slate-900 border-slate-700 hover:border-slate-500"}`,children:l.jsx("span",{className:"text-xl",children:xd[p.toUpperCase()]||""})},p))}),l.jsxs("div",{className:"flex items-center gap-2 bg-slate-900 border border-slate-700 rounded-xl px-4 py-2",children:[l.jsx("input",{type:"number",className:"bg-transparent w-full text-center text-xl font-bold focus:outline-none",value:f,onChange:p=>h(parseInt(p.target.value)||0),placeholder:"0"}),l.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase",children:u})]}),l.jsx("button",{onClick:x,disabled:!!m,className:"w-full py-3 bg-emerald-600 hover:bg-emerald-500 text-white rounded-xl font-bold shadow-lg shadow-emerald-500/20 disabled:opacity-50",children:m||"Send Gave"})]}),l.jsx("div",{className:"flex gap-2",children:r==="INFO"?l.jsxs(l.Fragment,{children:[l.jsxs("button",{onClick:()=>a("GIFT"),className:"flex-1 py-3 bg-slate-800 hover:bg-slate-700 text-slate-200 rounded-xl font-bold flex items-center justify-center gap-2 transition-transform active:scale-95",children:[l.jsx(wS,{size:18}),l.jsx("span",{children:"Gave"})]}),l.jsxs("button",{onClick:()=>c(!0),className:"flex-1 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold flex items-center justify-center gap-2 transition-transform active:scale-95 shadow-lg shadow-indigo-500/20",children:[l.jsx(O0,{size:18}),l.jsx("span",{children:"Handel"})]})]}):l.jsx("button",{onClick:()=>a("INFO"),className:"w-full py-3 text-slate-400 hover:text-white font-bold",children:"Avbryt"})}),s.role==="SOLDIER"&&n.role==="SOLDIER"&&l.jsxs("button",{className:"w-full py-2 border border-red-500/30 text-red-400 hover:bg-red-500/10 rounded-xl font-bold uppercase tracking-widest text-xs flex items-center justify-center gap-2",children:[l.jsx(op,{size:14}),"Utfordre til Duell (Kommer snart)"]})]})]})}):null},NV=()=>{const{pin:t}=ZE(),[e]=f2(),n=e.get("impersonate"),s=Xa(),{user:i,account:r,loading:a}=pf(),{activeMinigame:o,setActiveMinigame:c,activeMinigameAction:u,setActiveMinigameAction:d,activeMinigameMethod:f,setActiveMinigameMethod:h}=gf(),{setHideHeader:m,setFullWidth:g}=iN();we.useEffect(()=>(m(!0),g(!0),()=>{m(!1),g(!1)}),[m,g]);const{player:v,world:x,players:p,roomStatus:b,markets:y,messages:E,diplomacy:N,activeVote:A,worldEvents:w,trades:T,regions:k,hasAttemptedPlayerLoad:R,isRetired:C}=P6(t,n),{handleAction:B,actionResult:z,handleClearActionResult:$}=jS(t,v,x,c,h,d,o),[K,U]=_.useState(!1),[O,j]=_.useState(null),[I,H]=_.useState(null),X=async(Ie,V)=>{if(!(!t||!i)){U(!0);try{const me=D(L,`simulation_rooms/${t}`),ne=n||i.uid;let st=Math.random()>.5?"region_ost":"region_vest";V==="BARON"?st=`region_${ne}`:V==="KING"&&(st="capital");const zt={id:ne,uid:i.uid,name:Ie,role:V,regionId:st,resources:Rt[V]||Rt.PEASANT,skills:jn[V]||jn.PEASANT,stats:{xp:0,level:1,reputation:50,contribution:0},status:{hp:100,morale:100,stamina:50,legitimacy:100,authority:50,loyalty:100,isJailed:!1,isFrozen:!1},equipment:ip[V]||ip.PEASANT,upgrades:[],lastActive:Date.now()},On={id:ne,uid:i.uid,name:Ie,role:V,regionId:st,stats:{level:1},status:{isJailed:!1,isFrozen:!1,legitimacy:100},online:!0,lastActive:Date.now()},Mt={};Mt[`players/${ne}`]=zt,Mt[`public_profiles/${ne}`]=On,await J(me,Mt)}catch(me){console.error("Failed to create player:",me),alert("Kunne ikke opprette karakter.")}finally{U(!1)}}},oe=_.useMemo(()=>({status:b,world:x,players:p||{},messages:E||[],markets:y||{},market:(y&&(v!=null&&v.regionId)?y[v.regionId]:Object.values(y||{})[0])||{},diplomacy:N||{},trades:T||{},activeVote:A,worldEvents:w||{},regions:k||{},settings:"feudal_europe",pin:t||""}),[b,x,p,E,y,N,A,w,T,k,t]);return a||!R?l.jsxs("div",{className:"min-h-screen bg-slate-950 flex flex-col items-center justify-center gap-8 p-12",children:[l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"w-24 h-24 border-4 border-indigo-500/20 rounded-full"}),l.jsx("div",{className:"absolute inset-0 w-24 h-24 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"})]}),l.jsx("h2",{className:"text-2xl font-black italic text-white animate-pulse",children:"Kaller p ndene..."})]}):C?l.jsx("div",{className:"fixed inset-0 z-[100] bg-slate-950/90 backdrop-blur-xl flex items-center justify-center p-6 text-center",children:l.jsxs("div",{className:"max-w-md bg-slate-900 border-2 border-indigo-500/30 rounded-[3rem] p-12 space-y-8 shadow-2xl",children:[l.jsx(dP,{size:48,className:"text-white mx-auto animate-bounce"}),l.jsx("h2",{className:"text-4xl font-black italic text-white",children:"ET LIV ER OVER"}),l.jsx("button",{onClick:()=>s("/sim"),className:"w-full py-4 bg-indigo-600 text-white rounded-2xl font-black uppercase",children:"Tilbake til Lobby"})]})}):v?x?l.jsxs("div",{className:"relative min-h-screen bg-slate-900 text-white overflow-hidden flex flex-col",children:[l.jsx("div",{className:"flex-1 flex flex-col relative",children:l.jsxs("div",{className:"fixed inset-0 top-0 bg-slate-950 text-slate-200 flex overflow-hidden",children:[l.jsx("div",{className:"fixed inset-0 pointer-events-none opacity-20",children:l.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-indigo-600/20 blur-[120px] rounded-full animate-pulse"})}),!v.hasSeenIntro&&l.jsx(vV,{player:v,pin:t||"",onComplete:()=>{v.hasSeenIntro=!0}}),o&&l.jsx(LG,{type:o,playerUpgrades:v.upgrades,equipment:Object.values(v.equipment||{}),skills:v.skills,selectedMethod:f||void 0,action:u,onComplete:Ie=>B({...u||{},performance:Ie,method:f}),onCancel:()=>{c(null),d(null),h(null)},currentSeason:(x==null?void 0:x.season)||"Spring",currentWeather:(x==null?void 0:x.weather)||"Clear",totalTicks:(x==null?void 0:x.totalTicks)||0}),l.jsx(fV,{}),l.jsxs("div",{className:"flex flex-col h-full w-full overflow-hidden",children:[l.jsx(gG,{room:oe,player:v,pin:t,onAction:B}),l.jsx("main",{className:"flex-1 relative overflow-hidden bg-slate-950/50",children:l.jsx(dV,{player:v,room:oe,pin:t,onAction:B,actionResult:z,onClearActionResult:$})})]})]})}),O&&l.jsx(hV,{level:O.level,title:O.title,onClose:()=>j(null)}),l.jsx(yV,{pin:t||"",player:v,onOpenProfile:Ie=>{const V=oe.players[Ie];V?H(V):console.warn("Spiller ikke funnet i rommet:",Ie)}}),I&&l.jsx(EV,{isOpen:!0,onClose:()=>H(null),myPlayer:v,targetPlayer:I,pin:t||""})]}):l.jsxs("div",{className:"min-h-screen bg-slate-950 flex flex-col items-center justify-center gap-4 text-white",children:[l.jsx("div",{className:"w-12 h-12 border-4 border-indigo-500 border-t-white rounded-full animate-spin"}),l.jsx("p",{className:"text-sm font-bold uppercase tracking-widest text-indigo-400",children:"Laster verden..."})]}):l.jsx("div",{className:"min-h-screen bg-slate-950 flex items-center justify-center p-6",children:l.jsx(mV,{pin:t||"",account:r,onCreatePlayer:X,isCreating:K})})},kV=()=>{const[t,e]=_.useState([]),[n,s]=_.useState(!0),[i,r]=_.useState(""),a=Xa();_.useEffect(()=>{const c=D(L,"simulation_server_metadata"),u=Ke(c,d=>{const f=d.val();if(f){const h=Object.values(f);e(h.filter(m=>m.isPublic&&(m.status==="LOBBY"||m.status==="PLAYING")).sort((m,g)=>g.lastUpdated-m.lastUpdated))}else e([]);s(!1)});return()=>u()},[]);const o=t.filter(c=>{var u;return c.pin.includes(i)||((u=c.name)==null?void 0:u.toLowerCase().includes(i.toLowerCase()))||c.hostName.toLowerCase().includes(i.toLowerCase())});return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"relative",children:[l.jsx(q3,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-white/40",size:16}),l.jsx("input",{type:"text",placeholder:"Sk i riker...",value:i,onChange:c=>r(c.target.value),className:"w-full bg-white/5 border border-white/10 focus:border-white/20 rounded-xl py-2.5 pl-10 pr-4 text-sm text-white placeholder:text-white/20 outline-none transition-all"})]}),n?l.jsxs("div",{className:"flex flex-col items-center justify-center p-12 gap-3 opacity-50",children:[l.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),l.jsx("span",{className:"text-[10px] uppercase tracking-widest text-white/50",children:"Laster verdener..."})]}):o.length===0?l.jsx("div",{className:"p-8 text-center border border-white/5 border-dashed rounded-xl",children:l.jsx("p",{className:"text-sm text-white/40 font-medium",children:"Ingen riker funnet."})}):l.jsx("div",{className:"space-y-2",children:o.map(c=>l.jsxs("button",{onClick:()=>a(`/sim/play/${c.pin}`),className:"group w-full flex items-center justify-between p-3 bg-white/5 hover:bg-white/10 border border-white/5 hover:border-white/20 rounded-xl transition-all text-left",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:`w-1.5 h-10 rounded-full ${c.status==="LOBBY"?"bg-emerald-500/50 shadow-[0_0_10px_rgba(16,185,129,0.5)]":"bg-amber-500/50"}`}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("h3",{className:"text-sm font-bold text-white group-hover:text-emerald-300 transition-colors",children:c.name||`Rike #${c.pin}`}),l.jsxs("div",{className:"flex items-center gap-3 text-[10px] font-medium text-white/40 uppercase tracking-widest",children:[l.jsx("span",{children:c.hostName}),l.jsx("span",{className:"w-1 h-1 bg-white/20 rounded-full"}),l.jsxs("span",{children:["PIN: ",c.pin]})]})]})]}),l.jsxs("div",{className:"flex items-center gap-6 pr-2",children:[l.jsxs("div",{className:"flex items-center gap-2 text-white/60",children:[l.jsx(L0,{size:14}),l.jsx("span",{className:"text-xs font-medium tabular-nums",children:c.playerCount})]}),l.jsxs("div",{className:"text-right hidden sm:block",children:[l.jsxs("div",{className:"text-[10px] text-white/30 uppercase tracking-wider",children:["r ",c.worldYear]}),l.jsx("div",{className:"text-[10px] text-white/50",children:c.season})]}),l.jsx("div",{className:"p-2 bg-white/5 rounded-lg text-white/40 group-hover:text-white group-hover:bg-emerald-500/20 transition-all",children:l.jsx(D0,{size:14})})]})]},c.pin))})]})},SV=({isOpen:t,onClose:e,initialMode:n="REGISTER"})=>{const{login:s,register:i,resetPassword:r,checkNameAvailability:a,error:o}=pf(),[c,u]=_.useState(n),[d,f]=_.useState(""),[h,m]=_.useState(""),[g,v]=_.useState(""),[x,p]=_.useState(!1),[b,y]=_.useState(null),[E,N]=_.useState(null),[A,w]=_.useState(null),[T,k]=_.useState(!1);if(_.useEffect(()=>{if(c!=="REGISTER"||g.length<3){w(null);return}const C=setTimeout(async()=>{k(!0);try{const B=await a(g);w(B)}catch(B){console.error(B)}finally{k(!1)}},500);return()=>clearTimeout(C)},[g,c,a]),!t)return null;const R=async C=>{C.preventDefault(),y(null),N(null),p(!0);try{if(c==="LOGIN")await s(d,h),e();else if(c==="REGISTER"){if(A===!1)throw new Error("Navnet er allerede tatt.");await i(d,h,g),e()}else c==="FORGOT"&&(await r(d),N("E-post for tilbakestilling er sendt!"))}catch(B){y(B.message||"Noe gikk galt. Vennligst prv igjen.")}finally{p(!1)}};return l.jsxs("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center p-4",children:[l.jsx("div",{className:"absolute inset-0 bg-slate-950/80 backdrop-blur-sm",onClick:e}),l.jsxs("div",{className:"relative w-full max-w-md bg-slate-900 border border-white/10 rounded-[2.5rem] shadow-2xl overflow-hidden animate-in fade-in zoom-in duration-300",children:[l.jsx("div",{className:"bg-indigo-600 h-2 w-full"}),l.jsxs("div",{className:"p-8 space-y-8",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-3xl font-black italic text-white tracking-tighter uppercase",children:c==="LOGIN"?"Velkommen tilbake":c==="REGISTER"?"Opprett Profil":"Glemt Passord"}),l.jsx("p",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mt-1",children:c==="LOGIN"?"Fortsett din reise i simulation":"Bli en del av historien"})]}),l.jsx("button",{onClick:e,className:"p-2 hover:bg-white/5 rounded-xl transition-colors",children:l.jsx(ji,{className:"text-slate-500",size:20})})]}),l.jsxs("form",{onSubmit:R,className:"space-y-4",children:[c==="REGISTER"&&l.jsxs("div",{className:"space-y-1.5",children:[l.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"Vises som (Unikt navn)"}),l.jsxs("div",{className:"relative group",children:[l.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:l.jsx(vf,{size:18,className:"text-slate-600 group-focus-within:text-indigo-400 transition-colors"})}),l.jsx("input",{type:"text",required:!0,placeholder:"Ditt kallenavn...",className:"w-full bg-slate-950/50 border border-white/5 focus:border-indigo-500/50 rounded-2xl py-3.5 pl-11 pr-4 text-white outline-none transition-all",value:g,onChange:C=>v(C.target.value)}),l.jsx("div",{className:"absolute inset-y-0 right-0 pr-4 flex items-center",children:T?l.jsx(by,{size:16,className:"text-slate-500 animate-spin"}):A===!0?l.jsx(vy,{size:16,className:"text-emerald-500"}):A===!1?l.jsx(rp,{size:16,className:"text-rose-500"}):null})]}),A===!1&&l.jsx("p",{className:"text-[10px] text-rose-400 font-bold px-1 italic",children:"Dette navnet er dessverre opptatt."})]}),l.jsxs("div",{className:"space-y-1.5",children:[l.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"E-post"}),l.jsxs("div",{className:"relative group",children:[l.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:l.jsx(j3,{size:18,className:"text-slate-600 group-focus-within:text-indigo-400 transition-colors"})}),l.jsx("input",{type:"email",required:!0,placeholder:"navn@epost.no",className:"w-full bg-slate-950/50 border border-white/5 focus:border-indigo-500/50 rounded-2xl py-3.5 pl-11 pr-4 text-white outline-none transition-all",value:d,onChange:C=>f(C.target.value)})]})]}),c!=="FORGOT"&&l.jsxs("div",{className:"space-y-1.5",children:[l.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"Passord"}),l.jsxs("div",{className:"relative group",children:[l.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:l.jsx(M0,{size:18,className:"text-slate-600 group-focus-within:text-indigo-400 transition-colors"})}),l.jsx("input",{type:"password",required:!0,placeholder:"Min. 8 tegn...",className:"w-full bg-slate-950/50 border border-white/5 focus:border-indigo-500/50 rounded-2xl py-3.5 pl-11 pr-4 text-white outline-none transition-all",value:h,onChange:C=>m(C.target.value)})]})]}),(b||o)&&l.jsxs("div",{className:"bg-rose-500/10 border border-rose-500/20 p-4 rounded-2xl flex items-center gap-3 text-rose-400",children:[l.jsx(rp,{size:18}),l.jsx("p",{className:"text-xs font-bold",children:b||o})]}),E&&l.jsxs("div",{className:"bg-emerald-500/10 border border-emerald-500/20 p-4 rounded-2xl flex items-center gap-3 text-emerald-400",children:[l.jsx(vy,{size:18}),l.jsx("p",{className:"text-xs font-bold",children:E})]}),l.jsxs("div",{className:"pt-4 space-y-4",children:[l.jsx("button",{type:"submit",disabled:x||c==="REGISTER"&&A===!1,className:"w-full bg-indigo-600 hover:bg-indigo-500 disabled:bg-slate-800 disabled:text-slate-500 text-white rounded-2xl py-4 font-black uppercase tracking-widest text-sm flex items-center justify-center gap-2 transition-all active:scale-95 shadow-lg shadow-indigo-600/20",children:x?l.jsx(by,{className:"animate-spin",size:20}):l.jsxs(l.Fragment,{children:[c==="LOGIN"?"Logg Inn":c==="REGISTER"?"Opprett Profil":"Send E-post",l.jsx(ga,{size:18})]})}),l.jsx("div",{className:"flex items-center justify-between px-2",children:c==="LOGIN"?l.jsxs(l.Fragment,{children:[l.jsx("button",{type:"button",onClick:()=>u("REGISTER"),className:"text-[10px] font-black text-indigo-400 uppercase tracking-widest hover:text-white transition-colors",children:"Ny her? Opprett profil"}),l.jsx("button",{type:"button",onClick:()=>u("FORGOT"),className:"text-[10px] font-medium text-slate-500 hover:text-white transition-colors",children:"Glemt passord?"})]}):l.jsx("button",{type:"button",onClick:()=>u("LOGIN"),className:"w-full text-center text-[10px] font-black text-indigo-400 uppercase tracking-widest hover:text-white transition-colors",children:"Har du allerede profil? Logg inn"})})]})]})]})]})]})},TV=()=>{const{user:t,isAnonymous:e,logout:n}=pf(),[s,i]=_.useState(!1),[r,a]=_.useState("LOGIN"),o=Xa(),{startPlaylist:c,resume:u}=R0(),[d,f]=_.useState(!1);_.useEffect(()=>{c()},[c]);const h=()=>{d||(u(),c(),f(!0))},m=g=>{h(),a(g),i(!0)};return l.jsxs("div",{onClick:h,className:"min-h-screen relative font-sans text-slate-200 overflow-x-hidden",children:[l.jsxs("div",{className:"absolute inset-0 z-0",children:[l.jsx("img",{src:"/Simulation_StandAlone_Pro/makthjulet_landingpage_bakgrunn.png",alt:"Background",className:"w-full h-full object-cover"}),l.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-950 via-slate-950/60 to-transparent"}),l.jsx("div",{className:"absolute inset-0 bg-black/40"})]}),l.jsxs("div",{className:"relative z-10 flex flex-col min-h-screen",children:[l.jsxs("header",{className:"w-full px-8 py-8 flex justify-between items-center",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(bf,{className:"text-white/90",size:24,strokeWidth:1.5}),l.jsx("span",{className:"text-sm font-black tracking-[0.2em] text-white/90 uppercase",children:"Simuleringshallen"})]}),l.jsx("div",{className:"flex items-center gap-6 text-xs font-bold tracking-widest uppercase",children:t&&!e?l.jsxs("div",{className:"flex items-center gap-6",children:[l.jsxs("span",{className:"text-white/70",children:["Velkommen, ",l.jsx("span",{className:"text-white",children:t.displayName})]}),l.jsx("button",{onClick:()=>n(),className:"hover:text-amber-400 transition-colors",children:"Logg ut"})]}):l.jsxs("div",{className:"flex items-center gap-6",children:[l.jsx("button",{onClick:()=>m("LOGIN"),className:"hover:text-white transition-colors text-white/70",children:"Logg Inn"}),l.jsx("button",{onClick:()=>m("REGISTER"),className:"px-5 py-2 bg-white/10 hover:bg-white/20 backdrop-blur-sm border border-white/20 rounded-full transition-all text-white",children:"Bli Med"})]})})]}),l.jsxs("main",{className:"flex-1 flex flex-col items-center justify-center w-full max-w-7xl mx-auto px-6 py-12",children:[l.jsxs("div",{className:"text-center mb-16 space-y-6 max-w-3xl",children:[l.jsx("h1",{className:"text-7xl md:text-9xl font-black text-white tracking-tighter leading-none drop-shadow-2xl",children:"MAKTHJULET"}),l.jsx("p",{className:"text-lg md:text-xl text-white/80 font-light tracking-wide max-w-xl mx-auto leading-relaxed",children:"Skjebnen er ikke skrevet. Den smis i ilden av ambisjoner."}),l.jsx("div",{className:"flex items-center justify-center gap-4 pt-4",children:l.jsxs("button",{onClick:()=>o("/sim/host"),className:"group flex items-center gap-2 px-6 py-3 bg-white/5 hover:bg-white/10 border border-white/10 rounded-full backdrop-blur-md transition-all",children:[l.jsx(aP,{size:14,className:"text-white/70"}),l.jsx("span",{className:"text-xs font-bold tracking-widest uppercase text-white/90 group-hover:text-white",children:"Start Nytt Rike"})]})})]}),l.jsxs("div",{className:"w-full max-w-4xl bg-black/40 backdrop-blur-xl border border-white/10 rounded-3xl p-8 shadow-2xl",children:[l.jsxs("div",{className:"mb-6 flex items-center justify-between border-b border-white/5 pb-4",children:[l.jsxs("h3",{className:"text-xs font-bold tracking-[0.2em] text-white/60 uppercase flex items-center gap-2",children:[l.jsx(yd,{size:12,className:"text-emerald-500"}),"Aktive Verdener"]}),l.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-white/40 uppercase tracking-widest",children:[l.jsx("span",{className:"w-2 h-2 rounded-full bg-emerald-500 animate-pulse"}),"Live Feed"]})]}),l.jsx("div",{className:"max-h-[400px] overflow-y-auto custom-scrollbar",children:l.jsx(kV,{})})]})]}),l.jsx("footer",{className:"w-full p-8 text-center text-[10px] uppercase tracking-[0.2em] text-white/30",children:" 2026 Eiriksbok  Maktens Pris"})]}),l.jsx(SV,{isOpen:s,onClose:()=>i(!1),initialMode:r})]})},AV=()=>l.jsx(d2,{children:l.jsx(h2,{children:l.jsx(FL,{children:l.jsx(zL,{children:l.jsx("div",{className:"min-h-screen bg-slate-950 text-white",children:l.jsxs(o2,{children:[l.jsx(To,{path:"/",element:l.jsx(TV,{})}),l.jsx(To,{path:"/sim/host",element:l.jsx(L6,{})}),l.jsx(To,{path:"/sim/play/:pin/*",element:l.jsx($L,{children:l.jsx(NV,{})})}),l.jsx(To,{path:"*",element:l.jsx(r2,{to:"/",replace:!0})})]})})})})})});class RV extends we.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,n){console.error("Uncaught error:",e,n)}render(){return this.state.hasError?l.jsxs("div",{style:{padding:"2rem",backgroundColor:"#1a1a1a",color:"#ff5555",height:"100vh",fontFamily:"monospace"},children:[l.jsx("h1",{children:"Noe gikk galt (Kritisk Feil)"}),l.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:this.state.error&&this.state.error.toString()+`

`+this.state.error.stack})]}):this.props.children}}pC.createRoot(document.getElementById("root")).render(l.jsx(we.StrictMode,{children:l.jsx(RV,{children:l.jsx(AV,{})})}));export{sp as $,dc as A,ZE as B,Rn as C,jV as D,MV as E,LV as F,q as G,k3 as H,DV as I,Te as J,HA as K,vd as L,jl as M,L0 as N,q3 as O,V3 as P,bf as Q,_r as R,Td as S,lP as T,vf as U,Bt as V,EV as W,Q3 as X,fs as Y,vP as Z,ga as _,mn as a,AS as a0,we as b,ae as c,J as d,WL as e,XL as f,_ as g,qL as h,M0 as i,l as j,xy as k,dp as l,De as m,_S as n,op as o,D0 as p,R0 as q,D as r,L as s,pP as t,gf as u,H3 as v,Ei as w,K3 as x,CV as y,OV as z};
