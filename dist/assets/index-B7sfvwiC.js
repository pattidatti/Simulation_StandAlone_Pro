const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SimulationMarket-BbLsA5PB.js","assets/Badge-CSMpc5Er.js","assets/SimulationVault-BgfuaGbL.js","assets/timer-UHr403wN.js","assets/SimulationSkills-BBKz7xkb.js","assets/GameCard-Cq--nig1.js","assets/SimulationProduction-C3iBXylB.js","assets/RecipeCard-09dVV3O6.js","assets/SimulationHierarchy-D39EAZM6.js","assets/PoliticalHub-CGtGSA2-.js","assets/SimulationProfile-CUL_aTnC.js","assets/ApothecaryWindow-CoKN6XyB.js"])))=>i.map(i=>d[i]);
var Ij=Object.defineProperty;var Oj=(t,e,s)=>e in t?Ij(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var et=(t,e,s)=>Oj(t,typeof e!="symbol"?e+"":e,s);function Mj(t,e){for(var s=0;s<e.length;s++){const n=e[s];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const a=Object.getOwnPropertyDescriptor(n,i);a&&Object.defineProperty(t,i,a.get?a:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function s(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=s(i);fetch(i.href,a)}})();function V_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var z_={exports:{}},of={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dj=Symbol.for("react.transitional.element"),Lj=Symbol.for("react.fragment");function K_(t,e,s){var n=null;if(s!==void 0&&(n=""+s),e.key!==void 0&&(n=""+e.key),"key"in e){s={};for(var i in e)i!=="key"&&(s[i]=e[i])}else s=e;return e=s.ref,{$$typeof:Dj,type:t,key:n,ref:e!==void 0?e:null,props:s}}of.Fragment=Lj;of.jsx=K_;of.jsxs=K_;z_.exports=of;var r=z_.exports,Y_={exports:{}},he={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wp=Symbol.for("react.transitional.element"),Pj=Symbol.for("react.portal"),Bj=Symbol.for("react.fragment"),Uj=Symbol.for("react.strict_mode"),Hj=Symbol.for("react.profiler"),$j=Symbol.for("react.consumer"),Gj=Symbol.for("react.context"),Fj=Symbol.for("react.forward_ref"),Vj=Symbol.for("react.suspense"),zj=Symbol.for("react.memo"),W_=Symbol.for("react.lazy"),Kj=Symbol.for("react.activity"),db=Symbol.iterator;function Yj(t){return t===null||typeof t!="object"?null:(t=db&&t[db]||t["@@iterator"],typeof t=="function"?t:null)}var q_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},X_=Object.assign,Q_={};function fl(t,e,s){this.props=t,this.context=e,this.refs=Q_,this.updater=s||q_}fl.prototype.isReactComponent={};fl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};fl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function J_(){}J_.prototype=fl.prototype;function kp(t,e,s){this.props=t,this.context=e,this.refs=Q_,this.updater=s||q_}var Np=kp.prototype=new J_;Np.constructor=kp;X_(Np,fl.prototype);Np.isPureReactComponent=!0;var fb=Array.isArray;function _m(){}var Je={H:null,A:null,T:null,S:null},Z_=Object.prototype.hasOwnProperty;function Sp(t,e,s){var n=s.ref;return{$$typeof:wp,type:t,key:e,ref:n!==void 0?n:null,props:s}}function Wj(t,e){return Sp(t.type,e,t.props)}function Ep(t){return typeof t=="object"&&t!==null&&t.$$typeof===wp}function qj(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(s){return e[s]})}var hb=/\/+/g;function nh(t,e){return typeof t=="object"&&t!==null&&t.key!=null?qj(""+t.key):e.toString(36)}function Xj(t){switch(t.status){case"fulfilled":return t.value;case"rejected":throw t.reason;default:switch(typeof t.status=="string"?t.then(_m,_m):(t.status="pending",t.then(function(e){t.status==="pending"&&(t.status="fulfilled",t.value=e)},function(e){t.status==="pending"&&(t.status="rejected",t.reason=e)})),t.status){case"fulfilled":return t.value;case"rejected":throw t.reason}}throw t}function ar(t,e,s,n,i){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var l=!1;if(t===null)l=!0;else switch(a){case"bigint":case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case wp:case Pj:l=!0;break;case W_:return l=t._init,ar(l(t._payload),e,s,n,i)}}if(l)return i=i(t),l=n===""?"."+nh(t,0):n,fb(i)?(s="",l!=null&&(s=l.replace(hb,"$&/")+"/"),ar(i,e,s,"",function(u){return u})):i!=null&&(Ep(i)&&(i=Wj(i,s+(i.key==null||t&&t.key===i.key?"":(""+i.key).replace(hb,"$&/")+"/")+l)),e.push(i)),1;l=0;var o=n===""?".":n+":";if(fb(t))for(var c=0;c<t.length;c++)n=t[c],a=o+nh(n,c),l+=ar(n,e,s,a,i);else if(c=Yj(t),typeof c=="function")for(t=c.call(t),c=0;!(n=t.next()).done;)n=n.value,a=o+nh(n,c++),l+=ar(n,e,s,a,i);else if(a==="object"){if(typeof t.then=="function")return ar(Xj(t),e,s,n,i);throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.")}return l}function Zc(t,e,s){if(t==null)return t;var n=[],i=0;return ar(t,n,"","",function(a){return e.call(s,a,i++)}),n}function Qj(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(s){(t._status===0||t._status===-1)&&(t._status=1,t._result=s)},function(s){(t._status===0||t._status===-1)&&(t._status=2,t._result=s)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var mb=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},Jj={map:Zc,forEach:function(t,e,s){Zc(t,function(){e.apply(this,arguments)},s)},count:function(t){var e=0;return Zc(t,function(){e++}),e},toArray:function(t){return Zc(t,function(e){return e})||[]},only:function(t){if(!Ep(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};he.Activity=Kj;he.Children=Jj;he.Component=fl;he.Fragment=Bj;he.Profiler=Hj;he.PureComponent=kp;he.StrictMode=Uj;he.Suspense=Vj;he.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Je;he.__COMPILER_RUNTIME={__proto__:null,c:function(t){return Je.H.useMemoCache(t)}};he.cache=function(t){return function(){return t.apply(null,arguments)}};he.cacheSignal=function(){return null};he.cloneElement=function(t,e,s){if(t==null)throw Error("The argument must be a React element, but you passed "+t+".");var n=X_({},t.props),i=t.key;if(e!=null)for(a in e.key!==void 0&&(i=""+e.key),e)!Z_.call(e,a)||a==="key"||a==="__self"||a==="__source"||a==="ref"&&e.ref===void 0||(n[a]=e[a]);var a=arguments.length-2;if(a===1)n.children=s;else if(1<a){for(var l=Array(a),o=0;o<a;o++)l[o]=arguments[o+2];n.children=l}return Sp(t.type,i,n)};he.createContext=function(t){return t={$$typeof:Gj,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null},t.Provider=t,t.Consumer={$$typeof:$j,_context:t},t};he.createElement=function(t,e,s){var n,i={},a=null;if(e!=null)for(n in e.key!==void 0&&(a=""+e.key),e)Z_.call(e,n)&&n!=="key"&&n!=="__self"&&n!=="__source"&&(i[n]=e[n]);var l=arguments.length-2;if(l===1)i.children=s;else if(1<l){for(var o=Array(l),c=0;c<l;c++)o[c]=arguments[c+2];i.children=o}if(t&&t.defaultProps)for(n in l=t.defaultProps,l)i[n]===void 0&&(i[n]=l[n]);return Sp(t,a,i)};he.createRef=function(){return{current:null}};he.forwardRef=function(t){return{$$typeof:Fj,render:t}};he.isValidElement=Ep;he.lazy=function(t){return{$$typeof:W_,_payload:{_status:-1,_result:t},_init:Qj}};he.memo=function(t,e){return{$$typeof:zj,type:t,compare:e===void 0?null:e}};he.startTransition=function(t){var e=Je.T,s={};Je.T=s;try{var n=t(),i=Je.S;i!==null&&i(s,n),typeof n=="object"&&n!==null&&typeof n.then=="function"&&n.then(_m,mb)}catch(a){mb(a)}finally{e!==null&&s.types!==null&&(e.types=s.types),Je.T=e}};he.unstable_useCacheRefresh=function(){return Je.H.useCacheRefresh()};he.use=function(t){return Je.H.use(t)};he.useActionState=function(t,e,s){return Je.H.useActionState(t,e,s)};he.useCallback=function(t,e){return Je.H.useCallback(t,e)};he.useContext=function(t){return Je.H.useContext(t)};he.useDebugValue=function(){};he.useDeferredValue=function(t,e){return Je.H.useDeferredValue(t,e)};he.useEffect=function(t,e){return Je.H.useEffect(t,e)};he.useEffectEvent=function(t){return Je.H.useEffectEvent(t)};he.useId=function(){return Je.H.useId()};he.useImperativeHandle=function(t,e,s){return Je.H.useImperativeHandle(t,e,s)};he.useInsertionEffect=function(t,e){return Je.H.useInsertionEffect(t,e)};he.useLayoutEffect=function(t,e){return Je.H.useLayoutEffect(t,e)};he.useMemo=function(t,e){return Je.H.useMemo(t,e)};he.useOptimistic=function(t,e){return Je.H.useOptimistic(t,e)};he.useReducer=function(t,e,s){return Je.H.useReducer(t,e,s)};he.useRef=function(t){return Je.H.useRef(t)};he.useState=function(t){return Je.H.useState(t)};he.useSyncExternalStore=function(t,e,s){return Je.H.useSyncExternalStore(t,e,s)};he.useTransition=function(){return Je.H.useTransition()};he.version="19.2.3";Y_.exports=he;var _=Y_.exports;const Ne=V_(_),Zj=Mj({__proto__:null,default:Ne},[_]);var ew={exports:{}},cf={},tw={exports:{}},sw={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(M,U){var C=M.length;M.push(U);e:for(;0<C;){var T=C-1>>>1,R=M[T];if(0<i(R,U))M[T]=U,M[C]=R,C=T;else break e}}function s(M){return M.length===0?null:M[0]}function n(M){if(M.length===0)return null;var U=M[0],C=M.pop();if(C!==U){M[0]=C;e:for(var T=0,R=M.length,D=R>>>1;T<D;){var I=2*(T+1)-1,F=M[I],P=I+1,B=M[P];if(0>i(F,C))P<R&&0>i(B,F)?(M[T]=B,M[P]=C,T=P):(M[T]=F,M[I]=C,T=I);else if(P<R&&0>i(B,C))M[T]=B,M[P]=C,T=P;else break e}}return U}function i(M,U){var C=M.sortIndex-U.sortIndex;return C!==0?C:M.id-U.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var l=Date,o=l.now();t.unstable_now=function(){return l.now()-o}}var c=[],u=[],d=1,f=null,h=3,m=!1,v=!1,x=!1,b=!1,g=typeof setTimeout=="function"?setTimeout:null,p=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;function k(M){for(var U=s(u);U!==null;){if(U.callback===null)n(u);else if(U.startTime<=M)n(u),U.sortIndex=U.expirationTime,e(c,U);else break;U=s(u)}}function N(M){if(x=!1,k(M),!v)if(s(c)!==null)v=!0,S||(S=!0,L());else{var U=s(u);U!==null&&H(N,U.startTime-M)}}var S=!1,w=-1,E=5,j=-1;function A(){return b?!0:!(t.unstable_now()-j<E)}function O(){if(b=!1,S){var M=t.unstable_now();j=M;var U=!0;try{e:{v=!1,x&&(x=!1,p(w),w=-1),m=!0;var C=h;try{t:{for(k(M),f=s(c);f!==null&&!(f.expirationTime>M&&A());){var T=f.callback;if(typeof T=="function"){f.callback=null,h=f.priorityLevel;var R=T(f.expirationTime<=M);if(M=t.unstable_now(),typeof R=="function"){f.callback=R,k(M),U=!0;break t}f===s(c)&&n(c),k(M)}else n(c);f=s(c)}if(f!==null)U=!0;else{var D=s(u);D!==null&&H(N,D.startTime-M),U=!1}}break e}finally{f=null,h=C,m=!1}U=void 0}}finally{U?L():S=!1}}}var L;if(typeof y=="function")L=function(){y(O)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,W=Y.port2;Y.port1.onmessage=O,L=function(){W.postMessage(null)}}else L=function(){g(O,0)};function H(M,U){w=g(function(){M(t.unstable_now())},U)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(M){M.callback=null},t.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<M?Math.floor(1e3/M):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_next=function(M){switch(h){case 1:case 2:case 3:var U=3;break;default:U=h}var C=h;h=U;try{return M()}finally{h=C}},t.unstable_requestPaint=function(){b=!0},t.unstable_runWithPriority=function(M,U){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var C=h;h=M;try{return U()}finally{h=C}},t.unstable_scheduleCallback=function(M,U,C){var T=t.unstable_now();switch(typeof C=="object"&&C!==null?(C=C.delay,C=typeof C=="number"&&0<C?T+C:T):C=T,M){case 1:var R=-1;break;case 2:R=250;break;case 5:R=1073741823;break;case 4:R=1e4;break;default:R=5e3}return R=C+R,M={id:d++,callback:U,priorityLevel:M,startTime:C,expirationTime:R,sortIndex:-1},C>T?(M.sortIndex=C,e(u,M),s(c)===null&&M===s(u)&&(x?(p(w),w=-1):x=!0,H(N,C-T))):(M.sortIndex=R,e(c,M),v||m||(v=!0,S||(S=!0,L()))),M},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(M){var U=h;return function(){var C=h;h=U;try{return M.apply(this,arguments)}finally{h=C}}}})(sw);tw.exports=sw;var eT=tw.exports,nw={exports:{}},Zt={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tT=_;function iw(t){var e="https://react.dev/errors/"+t;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var s=2;s<arguments.length;s++)e+="&args[]="+encodeURIComponent(arguments[s])}return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function si(){}var Wt={d:{f:si,r:function(){throw Error(iw(522))},D:si,C:si,L:si,m:si,X:si,S:si,M:si},p:0,findDOMNode:null},sT=Symbol.for("react.portal");function nT(t,e,s){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:sT,key:n==null?null:""+n,children:t,containerInfo:e,implementation:s}}var io=tT.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function uf(t,e){if(t==="font")return"";if(typeof e=="string")return e==="use-credentials"?e:""}Zt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Wt;Zt.createPortal=function(t,e){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)throw Error(iw(299));return nT(t,e,null,s)};Zt.flushSync=function(t){var e=io.T,s=Wt.p;try{if(io.T=null,Wt.p=2,t)return t()}finally{io.T=e,Wt.p=s,Wt.d.f()}};Zt.preconnect=function(t,e){typeof t=="string"&&(e?(e=e.crossOrigin,e=typeof e=="string"?e==="use-credentials"?e:"":void 0):e=null,Wt.d.C(t,e))};Zt.prefetchDNS=function(t){typeof t=="string"&&Wt.d.D(t)};Zt.preinit=function(t,e){if(typeof t=="string"&&e&&typeof e.as=="string"){var s=e.as,n=uf(s,e.crossOrigin),i=typeof e.integrity=="string"?e.integrity:void 0,a=typeof e.fetchPriority=="string"?e.fetchPriority:void 0;s==="style"?Wt.d.S(t,typeof e.precedence=="string"?e.precedence:void 0,{crossOrigin:n,integrity:i,fetchPriority:a}):s==="script"&&Wt.d.X(t,{crossOrigin:n,integrity:i,fetchPriority:a,nonce:typeof e.nonce=="string"?e.nonce:void 0})}};Zt.preinitModule=function(t,e){if(typeof t=="string")if(typeof e=="object"&&e!==null){if(e.as==null||e.as==="script"){var s=uf(e.as,e.crossOrigin);Wt.d.M(t,{crossOrigin:s,integrity:typeof e.integrity=="string"?e.integrity:void 0,nonce:typeof e.nonce=="string"?e.nonce:void 0})}}else e==null&&Wt.d.M(t)};Zt.preload=function(t,e){if(typeof t=="string"&&typeof e=="object"&&e!==null&&typeof e.as=="string"){var s=e.as,n=uf(s,e.crossOrigin);Wt.d.L(t,s,{crossOrigin:n,integrity:typeof e.integrity=="string"?e.integrity:void 0,nonce:typeof e.nonce=="string"?e.nonce:void 0,type:typeof e.type=="string"?e.type:void 0,fetchPriority:typeof e.fetchPriority=="string"?e.fetchPriority:void 0,referrerPolicy:typeof e.referrerPolicy=="string"?e.referrerPolicy:void 0,imageSrcSet:typeof e.imageSrcSet=="string"?e.imageSrcSet:void 0,imageSizes:typeof e.imageSizes=="string"?e.imageSizes:void 0,media:typeof e.media=="string"?e.media:void 0})}};Zt.preloadModule=function(t,e){if(typeof t=="string")if(e){var s=uf(e.as,e.crossOrigin);Wt.d.m(t,{as:typeof e.as=="string"&&e.as!=="script"?e.as:void 0,crossOrigin:s,integrity:typeof e.integrity=="string"?e.integrity:void 0})}else Wt.d.m(t)};Zt.requestFormReset=function(t){Wt.d.r(t)};Zt.unstable_batchedUpdates=function(t,e){return t(e)};Zt.useFormState=function(t,e,s){return io.H.useFormState(t,e,s)};Zt.useFormStatus=function(){return io.H.useHostTransitionStatus()};Zt.version="19.2.3";function aw(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(aw)}catch(t){console.error(t)}}aw(),nw.exports=Zt;var iT=nw.exports;/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var At=eT,rw=_,aT=iT;function K(t){var e="https://react.dev/errors/"+t;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var s=2;s<arguments.length;s++)e+="&args[]="+encodeURIComponent(arguments[s])}return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function lw(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function gc(t){var e=t,s=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(s=e.return),t=e.return;while(t)}return e.tag===3?s:null}function ow(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function cw(t){if(t.tag===31){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function pb(t){if(gc(t)!==t)throw Error(K(188))}function rT(t){var e=t.alternate;if(!e){if(e=gc(t),e===null)throw Error(K(188));return e!==t?null:t}for(var s=t,n=e;;){var i=s.return;if(i===null)break;var a=i.alternate;if(a===null){if(n=i.return,n!==null){s=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===s)return pb(i),t;if(a===n)return pb(i),e;a=a.sibling}throw Error(K(188))}if(s.return!==n.return)s=i,n=a;else{for(var l=!1,o=i.child;o;){if(o===s){l=!0,s=i,n=a;break}if(o===n){l=!0,n=i,s=a;break}o=o.sibling}if(!l){for(o=a.child;o;){if(o===s){l=!0,s=a,n=i;break}if(o===n){l=!0,n=a,s=i;break}o=o.sibling}if(!l)throw Error(K(189))}}if(s.alternate!==n)throw Error(K(190))}if(s.tag!==3)throw Error(K(188));return s.stateNode.current===s?t:e}function uw(t){var e=t.tag;if(e===5||e===26||e===27||e===6)return t;for(t=t.child;t!==null;){if(e=uw(t),e!==null)return e;t=t.sibling}return null}var Ze=Object.assign,lT=Symbol.for("react.element"),eu=Symbol.for("react.transitional.element"),ql=Symbol.for("react.portal"),or=Symbol.for("react.fragment"),dw=Symbol.for("react.strict_mode"),wm=Symbol.for("react.profiler"),fw=Symbol.for("react.consumer"),An=Symbol.for("react.context"),jp=Symbol.for("react.forward_ref"),km=Symbol.for("react.suspense"),Nm=Symbol.for("react.suspense_list"),Tp=Symbol.for("react.memo"),ri=Symbol.for("react.lazy"),Sm=Symbol.for("react.activity"),oT=Symbol.for("react.memo_cache_sentinel"),gb=Symbol.iterator;function Pl(t){return t===null||typeof t!="object"?null:(t=gb&&t[gb]||t["@@iterator"],typeof t=="function"?t:null)}var cT=Symbol.for("react.client.reference");function Em(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===cT?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case or:return"Fragment";case wm:return"Profiler";case dw:return"StrictMode";case km:return"Suspense";case Nm:return"SuspenseList";case Sm:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case ql:return"Portal";case An:return t.displayName||"Context";case fw:return(t._context.displayName||"Context")+".Consumer";case jp:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Tp:return e=t.displayName||null,e!==null?e:Em(t.type)||"Memo";case ri:e=t._payload,t=t._init;try{return Em(t(e))}catch{}}return null}var Xl=Array.isArray,ce=rw.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ce=aT.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ka={pending:!1,data:null,method:null,action:null},jm=[],cr=-1;function gn(t){return{current:t}}function Dt(t){0>cr||(t.current=jm[cr],jm[cr]=null,cr--)}function We(t,e){cr++,jm[cr]=t.current,t.current=e}var cn=gn(null),Co=gn(null),Si=gn(null),Xu=gn(null);function Qu(t,e){switch(We(Si,e),We(Co,t),We(cn,null),e.nodeType){case 9:case 11:t=(t=e.documentElement)&&(t=t.namespaceURI)?wv(t):0;break;default:if(t=e.tagName,e=e.namespaceURI)e=wv(e),t=IN(e,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}Dt(cn),We(cn,t)}function Gr(){Dt(cn),Dt(Co),Dt(Si)}function Tm(t){t.memoizedState!==null&&We(Xu,t);var e=cn.current,s=IN(e,t.type);e!==s&&(We(Co,t),We(cn,s))}function Ju(t){Co.current===t&&(Dt(cn),Dt(Co)),Xu.current===t&&(Dt(Xu),Go._currentValue=ka)}var ih,xb;function fa(t){if(ih===void 0)try{throw Error()}catch(s){var e=s.stack.trim().match(/\n( *(at )?)/);ih=e&&e[1]||"",xb=-1<s.stack.indexOf(`
    at`)?" (<anonymous>)":-1<s.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ih+t+xb}var ah=!1;function rh(t,e){if(!t||ah)return"";ah=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var n={DetermineComponentFrameRoot:function(){try{if(e){var f=function(){throw Error()};if(Object.defineProperty(f.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(f,[])}catch(m){var h=m}Reflect.construct(t,[],f)}else{try{f.call()}catch(m){h=m}t.call(f.prototype)}}else{try{throw Error()}catch(m){h=m}(f=t())&&typeof f.catch=="function"&&f.catch(function(){})}}catch(m){if(m&&h&&typeof m.stack=="string")return[m.stack,h.stack]}return[null,null]}};n.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var i=Object.getOwnPropertyDescriptor(n.DetermineComponentFrameRoot,"name");i&&i.configurable&&Object.defineProperty(n.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var a=n.DetermineComponentFrameRoot(),l=a[0],o=a[1];if(l&&o){var c=l.split(`
`),u=o.split(`
`);for(i=n=0;n<c.length&&!c[n].includes("DetermineComponentFrameRoot");)n++;for(;i<u.length&&!u[i].includes("DetermineComponentFrameRoot");)i++;if(n===c.length||i===u.length)for(n=c.length-1,i=u.length-1;1<=n&&0<=i&&c[n]!==u[i];)i--;for(;1<=n&&0<=i;n--,i--)if(c[n]!==u[i]){if(n!==1||i!==1)do if(n--,i--,0>i||c[n]!==u[i]){var d=`
`+c[n].replace(" at new "," at ");return t.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",t.displayName)),d}while(1<=n&&0<=i);break}}}finally{ah=!1,Error.prepareStackTrace=s}return(s=t?t.displayName||t.name:"")?fa(s):""}function uT(t,e){switch(t.tag){case 26:case 27:case 5:return fa(t.type);case 16:return fa("Lazy");case 13:return t.child!==e&&e!==null?fa("Suspense Fallback"):fa("Suspense");case 19:return fa("SuspenseList");case 0:case 15:return rh(t.type,!1);case 11:return rh(t.type.render,!1);case 1:return rh(t.type,!0);case 31:return fa("Activity");default:return""}}function bb(t){try{var e="",s=null;do e+=uT(t,s),s=t,t=t.return;while(t);return e}catch(n){return`
Error generating stack: `+n.message+`
`+n.stack}}var Am=Object.prototype.hasOwnProperty,Ap=At.unstable_scheduleCallback,lh=At.unstable_cancelCallback,dT=At.unstable_shouldYield,fT=At.unstable_requestPaint,bs=At.unstable_now,hT=At.unstable_getCurrentPriorityLevel,hw=At.unstable_ImmediatePriority,mw=At.unstable_UserBlockingPriority,Zu=At.unstable_NormalPriority,mT=At.unstable_LowPriority,pw=At.unstable_IdlePriority,pT=At.log,gT=At.unstable_setDisableYieldValue,xc=null,vs=null;function gi(t){if(typeof pT=="function"&&gT(t),vs&&typeof vs.setStrictMode=="function")try{vs.setStrictMode(xc,t)}catch{}}var ys=Math.clz32?Math.clz32:vT,xT=Math.log,bT=Math.LN2;function vT(t){return t>>>=0,t===0?32:31-(xT(t)/bT|0)|0}var tu=256,su=262144,nu=4194304;function ha(t){var e=t&42;if(e!==0)return e;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function df(t,e,s){var n=t.pendingLanes;if(n===0)return 0;var i=0,a=t.suspendedLanes,l=t.pingedLanes;t=t.warmLanes;var o=n&134217727;return o!==0?(n=o&~a,n!==0?i=ha(n):(l&=o,l!==0?i=ha(l):s||(s=o&~t,s!==0&&(i=ha(s))))):(o=n&~a,o!==0?i=ha(o):l!==0?i=ha(l):s||(s=n&~t,s!==0&&(i=ha(s)))),i===0?0:e!==0&&e!==i&&!(e&a)&&(a=i&-i,s=e&-e,a>=s||a===32&&(s&4194048)!==0)?e:i}function bc(t,e){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&e)===0}function yT(t,e){switch(t){case 1:case 2:case 4:case 8:case 64:return e+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function gw(){var t=nu;return nu<<=1,!(nu&62914560)&&(nu=4194304),t}function oh(t){for(var e=[],s=0;31>s;s++)e.push(t);return e}function vc(t,e){t.pendingLanes|=e,e!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function _T(t,e,s,n,i,a){var l=t.pendingLanes;t.pendingLanes=s,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=s,t.entangledLanes&=s,t.errorRecoveryDisabledLanes&=s,t.shellSuspendCounter=0;var o=t.entanglements,c=t.expirationTimes,u=t.hiddenUpdates;for(s=l&~s;0<s;){var d=31-ys(s),f=1<<d;o[d]=0,c[d]=-1;var h=u[d];if(h!==null)for(u[d]=null,d=0;d<h.length;d++){var m=h[d];m!==null&&(m.lane&=-536870913)}s&=~f}n!==0&&xw(t,n,0),a!==0&&i===0&&t.tag!==0&&(t.suspendedLanes|=a&~(l&~e))}function xw(t,e,s){t.pendingLanes|=e,t.suspendedLanes&=~e;var n=31-ys(e);t.entangledLanes|=e,t.entanglements[n]=t.entanglements[n]|1073741824|s&261930}function bw(t,e){var s=t.entangledLanes|=e;for(t=t.entanglements;s;){var n=31-ys(s),i=1<<n;i&e|t[n]&e&&(t[n]|=e),s&=~i}}function vw(t,e){var s=e&-e;return s=s&42?1:Rp(s),s&(t.suspendedLanes|e)?0:s}function Rp(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function Cp(t){return t&=-t,2<t?8<t?t&134217727?32:268435456:8:2}function yw(){var t=Ce.p;return t!==0?t:(t=window.event,t===void 0?32:FN(t.type))}function vb(t,e){var s=Ce.p;try{return Ce.p=t,e()}finally{Ce.p=s}}var ta=Math.random().toString(36).slice(2),Ht="__reactFiber$"+ta,us="__reactProps$"+ta,hl="__reactContainer$"+ta,Rm="__reactEvents$"+ta,wT="__reactListeners$"+ta,kT="__reactHandles$"+ta,yb="__reactResources$"+ta,yc="__reactMarker$"+ta;function Ip(t){delete t[Ht],delete t[us],delete t[Rm],delete t[wT],delete t[kT]}function ur(t){var e=t[Ht];if(e)return e;for(var s=t.parentNode;s;){if(e=s[hl]||s[Ht]){if(s=e.alternate,e.child!==null||s!==null&&s.child!==null)for(t=jv(t);t!==null;){if(s=t[Ht])return s;t=jv(t)}return e}t=s,s=t.parentNode}return null}function ml(t){if(t=t[Ht]||t[hl]){var e=t.tag;if(e===5||e===6||e===13||e===31||e===26||e===27||e===3)return t}return null}function Ql(t){var e=t.tag;if(e===5||e===26||e===27||e===6)return t.stateNode;throw Error(K(33))}function Tr(t){var e=t[yb];return e||(e=t[yb]={hoistableStyles:new Map,hoistableScripts:new Map}),e}function Ot(t){t[yc]=!0}var _w=new Set,ww={};function za(t,e){Fr(t,e),Fr(t+"Capture",e)}function Fr(t,e){for(ww[t]=e,t=0;t<e.length;t++)_w.add(e[t])}var NT=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),_b={},wb={};function ST(t){return Am.call(wb,t)?!0:Am.call(_b,t)?!1:NT.test(t)?wb[t]=!0:(_b[t]=!0,!1)}function Eu(t,e,s){if(ST(e))if(s===null)t.removeAttribute(e);else{switch(typeof s){case"undefined":case"function":case"symbol":t.removeAttribute(e);return;case"boolean":var n=e.toLowerCase().slice(0,5);if(n!=="data-"&&n!=="aria-"){t.removeAttribute(e);return}}t.setAttribute(e,""+s)}}function iu(t,e,s){if(s===null)t.removeAttribute(e);else{switch(typeof s){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(e);return}t.setAttribute(e,""+s)}}function _n(t,e,s,n){if(n===null)t.removeAttribute(s);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(s);return}t.setAttributeNS(e,s,""+n)}}function As(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function kw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function ET(t,e,s){var n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e);if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,a=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(l){s=""+l,a.call(this,l)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(l){s=""+l},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Cm(t){if(!t._valueTracker){var e=kw(t)?"checked":"value";t._valueTracker=ET(t,e,""+t[e])}}function Nw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var s=e.getValue(),n="";return t&&(n=kw(t)?t.checked?"true":"false":t.value),t=n,t!==s?(e.setValue(t),!0):!1}function ed(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var jT=/[\n"\\]/g;function Is(t){return t.replace(jT,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function Im(t,e,s,n,i,a,l,o){t.name="",l!=null&&typeof l!="function"&&typeof l!="symbol"&&typeof l!="boolean"?t.type=l:t.removeAttribute("type"),e!=null?l==="number"?(e===0&&t.value===""||t.value!=e)&&(t.value=""+As(e)):t.value!==""+As(e)&&(t.value=""+As(e)):l!=="submit"&&l!=="reset"||t.removeAttribute("value"),e!=null?Om(t,l,As(e)):s!=null?Om(t,l,As(s)):n!=null&&t.removeAttribute("value"),i==null&&a!=null&&(t.defaultChecked=!!a),i!=null&&(t.checked=i&&typeof i!="function"&&typeof i!="symbol"),o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"?t.name=""+As(o):t.removeAttribute("name")}function Sw(t,e,s,n,i,a,l,o){if(a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"&&(t.type=a),e!=null||s!=null){if(!(a!=="submit"&&a!=="reset"||e!=null)){Cm(t);return}s=s!=null?""+As(s):"",e=e!=null?""+As(e):s,o||e===t.value||(t.value=e),t.defaultValue=e}n=n??i,n=typeof n!="function"&&typeof n!="symbol"&&!!n,t.checked=o?t.checked:!!n,t.defaultChecked=!!n,l!=null&&typeof l!="function"&&typeof l!="symbol"&&typeof l!="boolean"&&(t.name=l),Cm(t)}function Om(t,e,s){e==="number"&&ed(t.ownerDocument)===t||t.defaultValue===""+s||(t.defaultValue=""+s)}function Ar(t,e,s,n){if(t=t.options,e){e={};for(var i=0;i<s.length;i++)e["$"+s[i]]=!0;for(s=0;s<t.length;s++)i=e.hasOwnProperty("$"+t[s].value),t[s].selected!==i&&(t[s].selected=i),i&&n&&(t[s].defaultSelected=!0)}else{for(s=""+As(s),e=null,i=0;i<t.length;i++){if(t[i].value===s){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Ew(t,e,s){if(e!=null&&(e=""+As(e),e!==t.value&&(t.value=e),s==null)){t.defaultValue!==e&&(t.defaultValue=e);return}t.defaultValue=s!=null?""+As(s):""}function jw(t,e,s,n){if(e==null){if(n!=null){if(s!=null)throw Error(K(92));if(Xl(n)){if(1<n.length)throw Error(K(93));n=n[0]}s=n}s==null&&(s=""),e=s}s=As(e),t.defaultValue=s,n=t.textContent,n===s&&n!==""&&n!==null&&(t.value=n),Cm(t)}function Vr(t,e){if(e){var s=t.firstChild;if(s&&s===t.lastChild&&s.nodeType===3){s.nodeValue=e;return}}t.textContent=e}var TT=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function kb(t,e,s){var n=e.indexOf("--")===0;s==null||typeof s=="boolean"||s===""?n?t.setProperty(e,""):e==="float"?t.cssFloat="":t[e]="":n?t.setProperty(e,s):typeof s!="number"||s===0||TT.has(e)?e==="float"?t.cssFloat=s:t[e]=(""+s).trim():t[e]=s+"px"}function Tw(t,e,s){if(e!=null&&typeof e!="object")throw Error(K(62));if(t=t.style,s!=null){for(var n in s)!s.hasOwnProperty(n)||e!=null&&e.hasOwnProperty(n)||(n.indexOf("--")===0?t.setProperty(n,""):n==="float"?t.cssFloat="":t[n]="");for(var i in e)n=e[i],e.hasOwnProperty(i)&&s[i]!==n&&kb(t,i,n)}else for(var a in e)e.hasOwnProperty(a)&&kb(t,a,e[a])}function Op(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var AT=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),RT=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ju(t){return RT.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function Rn(){}var Mm=null;function Mp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var dr=null,Rr=null;function Nb(t){var e=ml(t);if(e&&(t=e.stateNode)){var s=t[us]||null;e:switch(t=e.stateNode,e.type){case"input":if(Im(t,s.value,s.defaultValue,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name),e=s.name,s.type==="radio"&&e!=null){for(s=t;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll('input[name="'+Is(""+e)+'"][type="radio"]'),e=0;e<s.length;e++){var n=s[e];if(n!==t&&n.form===t.form){var i=n[us]||null;if(!i)throw Error(K(90));Im(n,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(e=0;e<s.length;e++)n=s[e],n.form===t.form&&Nw(n)}break e;case"textarea":Ew(t,s.value,s.defaultValue);break e;case"select":e=s.value,e!=null&&Ar(t,!!s.multiple,e,!1)}}}var ch=!1;function Aw(t,e,s){if(ch)return t(e,s);ch=!0;try{var n=t(e);return n}finally{if(ch=!1,(dr!==null||Rr!==null)&&(kf(),dr&&(e=dr,t=Rr,Rr=dr=null,Nb(e),t)))for(e=0;e<t.length;e++)Nb(t[e])}}function Io(t,e){var s=t.stateNode;if(s===null)return null;var n=s[us]||null;if(n===null)return null;s=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(s&&typeof s!="function")throw Error(K(231,e,typeof s));return s}var $n=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Dm=!1;if($n)try{var Bl={};Object.defineProperty(Bl,"passive",{get:function(){Dm=!0}}),window.addEventListener("test",Bl,Bl),window.removeEventListener("test",Bl,Bl)}catch{Dm=!1}var xi=null,Dp=null,Tu=null;function Rw(){if(Tu)return Tu;var t,e=Dp,s=e.length,n,i="value"in xi?xi.value:xi.textContent,a=i.length;for(t=0;t<s&&e[t]===i[t];t++);var l=s-t;for(n=1;n<=l&&e[s-n]===i[a-n];n++);return Tu=i.slice(t,1<n?1-n:void 0)}function Au(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function au(){return!0}function Sb(){return!1}function ds(t){function e(s,n,i,a,l){this._reactName=s,this._targetInst=i,this.type=n,this.nativeEvent=a,this.target=l,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(s=t[o],this[o]=s?s(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?au:Sb,this.isPropagationStopped=Sb,this}return Ze(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=au)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=au)},persist:function(){},isPersistent:au}),e}var Ka={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ff=ds(Ka),_c=Ze({},Ka,{view:0,detail:0}),CT=ds(_c),uh,dh,Ul,hf=Ze({},_c,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Lp,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ul&&(Ul&&t.type==="mousemove"?(uh=t.screenX-Ul.screenX,dh=t.screenY-Ul.screenY):dh=uh=0,Ul=t),uh)},movementY:function(t){return"movementY"in t?t.movementY:dh}}),Eb=ds(hf),IT=Ze({},hf,{dataTransfer:0}),OT=ds(IT),MT=Ze({},_c,{relatedTarget:0}),fh=ds(MT),DT=Ze({},Ka,{animationName:0,elapsedTime:0,pseudoElement:0}),LT=ds(DT),PT=Ze({},Ka,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),BT=ds(PT),UT=Ze({},Ka,{data:0}),jb=ds(UT),HT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$T={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},GT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function FT(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=GT[t])?!!e[t]:!1}function Lp(){return FT}var VT=Ze({},_c,{key:function(t){if(t.key){var e=HT[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Au(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?$T[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Lp,charCode:function(t){return t.type==="keypress"?Au(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Au(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),zT=ds(VT),KT=Ze({},hf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Tb=ds(KT),YT=Ze({},_c,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Lp}),WT=ds(YT),qT=Ze({},Ka,{propertyName:0,elapsedTime:0,pseudoElement:0}),XT=ds(qT),QT=Ze({},hf,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),JT=ds(QT),ZT=Ze({},Ka,{newState:0,oldState:0}),eA=ds(ZT),tA=[9,13,27,32],Pp=$n&&"CompositionEvent"in window,ao=null;$n&&"documentMode"in document&&(ao=document.documentMode);var sA=$n&&"TextEvent"in window&&!ao,Cw=$n&&(!Pp||ao&&8<ao&&11>=ao),Ab=" ",Rb=!1;function Iw(t,e){switch(t){case"keyup":return tA.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ow(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var fr=!1;function nA(t,e){switch(t){case"compositionend":return Ow(e);case"keypress":return e.which!==32?null:(Rb=!0,Ab);case"textInput":return t=e.data,t===Ab&&Rb?null:t;default:return null}}function iA(t,e){if(fr)return t==="compositionend"||!Pp&&Iw(t,e)?(t=Rw(),Tu=Dp=xi=null,fr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Cw&&e.locale!=="ko"?null:e.data;default:return null}}var aA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Cb(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!aA[t.type]:e==="textarea"}function Mw(t,e,s,n){dr?Rr?Rr.push(n):Rr=[n]:dr=n,e=bd(e,"onChange"),0<e.length&&(s=new ff("onChange","change",null,s,n),t.push({event:s,listeners:e}))}var ro=null,Oo=null;function rA(t){AN(t,0)}function mf(t){var e=Ql(t);if(Nw(e))return t}function Ib(t,e){if(t==="change")return e}var Dw=!1;if($n){var hh;if($n){var mh="oninput"in document;if(!mh){var Ob=document.createElement("div");Ob.setAttribute("oninput","return;"),mh=typeof Ob.oninput=="function"}hh=mh}else hh=!1;Dw=hh&&(!document.documentMode||9<document.documentMode)}function Mb(){ro&&(ro.detachEvent("onpropertychange",Lw),Oo=ro=null)}function Lw(t){if(t.propertyName==="value"&&mf(Oo)){var e=[];Mw(e,Oo,t,Mp(t)),Aw(rA,e)}}function lA(t,e,s){t==="focusin"?(Mb(),ro=e,Oo=s,ro.attachEvent("onpropertychange",Lw)):t==="focusout"&&Mb()}function oA(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return mf(Oo)}function cA(t,e){if(t==="click")return mf(e)}function uA(t,e){if(t==="input"||t==="change")return mf(e)}function dA(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ws=typeof Object.is=="function"?Object.is:dA;function Mo(t,e){if(ws(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var s=Object.keys(t),n=Object.keys(e);if(s.length!==n.length)return!1;for(n=0;n<s.length;n++){var i=s[n];if(!Am.call(e,i)||!ws(t[i],e[i]))return!1}return!0}function Db(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Lb(t,e){var s=Db(t);t=0;for(var n;s;){if(s.nodeType===3){if(n=t+s.textContent.length,t<=e&&n>=e)return{node:s,offset:e-t};t=n}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=Db(s)}}function Pw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Pw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Bw(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var e=ed(t.document);e instanceof t.HTMLIFrameElement;){try{var s=typeof e.contentWindow.location.href=="string"}catch{s=!1}if(s)t=e.contentWindow;else break;e=ed(t.document)}return e}function Bp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}var fA=$n&&"documentMode"in document&&11>=document.documentMode,hr=null,Lm=null,lo=null,Pm=!1;function Pb(t,e,s){var n=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;Pm||hr==null||hr!==ed(n)||(n=hr,"selectionStart"in n&&Bp(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),lo&&Mo(lo,n)||(lo=n,n=bd(Lm,"onSelect"),0<n.length&&(e=new ff("onSelect","select",null,e,s),t.push({event:e,listeners:n}),e.target=hr)))}function oa(t,e){var s={};return s[t.toLowerCase()]=e.toLowerCase(),s["Webkit"+t]="webkit"+e,s["Moz"+t]="moz"+e,s}var mr={animationend:oa("Animation","AnimationEnd"),animationiteration:oa("Animation","AnimationIteration"),animationstart:oa("Animation","AnimationStart"),transitionrun:oa("Transition","TransitionRun"),transitionstart:oa("Transition","TransitionStart"),transitioncancel:oa("Transition","TransitionCancel"),transitionend:oa("Transition","TransitionEnd")},ph={},Uw={};$n&&(Uw=document.createElement("div").style,"AnimationEvent"in window||(delete mr.animationend.animation,delete mr.animationiteration.animation,delete mr.animationstart.animation),"TransitionEvent"in window||delete mr.transitionend.transition);function Ya(t){if(ph[t])return ph[t];if(!mr[t])return t;var e=mr[t],s;for(s in e)if(e.hasOwnProperty(s)&&s in Uw)return ph[t]=e[s];return t}var Hw=Ya("animationend"),$w=Ya("animationiteration"),Gw=Ya("animationstart"),hA=Ya("transitionrun"),mA=Ya("transitionstart"),pA=Ya("transitioncancel"),Fw=Ya("transitionend"),Vw=new Map,Bm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Bm.push("scrollEnd");function nn(t,e){Vw.set(t,e),za(e,[t])}var td=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},Ts=[],pr=0,Up=0;function pf(){for(var t=pr,e=Up=pr=0;e<t;){var s=Ts[e];Ts[e++]=null;var n=Ts[e];Ts[e++]=null;var i=Ts[e];Ts[e++]=null;var a=Ts[e];if(Ts[e++]=null,n!==null&&i!==null){var l=n.pending;l===null?i.next=i:(i.next=l.next,l.next=i),n.pending=i}a!==0&&zw(s,i,a)}}function gf(t,e,s,n){Ts[pr++]=t,Ts[pr++]=e,Ts[pr++]=s,Ts[pr++]=n,Up|=n,t.lanes|=n,t=t.alternate,t!==null&&(t.lanes|=n)}function Hp(t,e,s,n){return gf(t,e,s,n),sd(t)}function Wa(t,e){return gf(t,null,null,e),sd(t)}function zw(t,e,s){t.lanes|=s;var n=t.alternate;n!==null&&(n.lanes|=s);for(var i=!1,a=t.return;a!==null;)a.childLanes|=s,n=a.alternate,n!==null&&(n.childLanes|=s),a.tag===22&&(t=a.stateNode,t===null||t._visibility&1||(i=!0)),t=a,a=a.return;return t.tag===3?(a=t.stateNode,i&&e!==null&&(i=31-ys(s),t=a.hiddenUpdates,n=t[i],n===null?t[i]=[e]:n.push(e),e.lane=s|536870912),a):null}function sd(t){if(50<xo)throw xo=0,a0=null,Error(K(185));for(var e=t.return;e!==null;)t=e,e=t.return;return t.tag===3?t.stateNode:null}var gr={};function gA(t,e,s,n){this.tag=t,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ps(t,e,s,n){return new gA(t,e,s,n)}function $p(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Ln(t,e){var s=t.alternate;return s===null?(s=ps(t.tag,e,t.key,t.mode),s.elementType=t.elementType,s.type=t.type,s.stateNode=t.stateNode,s.alternate=t,t.alternate=s):(s.pendingProps=e,s.type=t.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=t.flags&65011712,s.childLanes=t.childLanes,s.lanes=t.lanes,s.child=t.child,s.memoizedProps=t.memoizedProps,s.memoizedState=t.memoizedState,s.updateQueue=t.updateQueue,e=t.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},s.sibling=t.sibling,s.index=t.index,s.ref=t.ref,s.refCleanup=t.refCleanup,s}function Kw(t,e){t.flags&=65011714;var s=t.alternate;return s===null?(t.childLanes=0,t.lanes=e,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=s.childLanes,t.lanes=s.lanes,t.child=s.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=s.memoizedProps,t.memoizedState=s.memoizedState,t.updateQueue=s.updateQueue,t.type=s.type,e=s.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),t}function Ru(t,e,s,n,i,a){var l=0;if(n=t,typeof t=="function")$p(t)&&(l=1);else if(typeof t=="string")l=_R(t,s,cn.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case Sm:return t=ps(31,s,e,i),t.elementType=Sm,t.lanes=a,t;case or:return Na(s.children,i,a,e);case dw:l=8,i|=24;break;case wm:return t=ps(12,s,e,i|2),t.elementType=wm,t.lanes=a,t;case km:return t=ps(13,s,e,i),t.elementType=km,t.lanes=a,t;case Nm:return t=ps(19,s,e,i),t.elementType=Nm,t.lanes=a,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case An:l=10;break e;case fw:l=9;break e;case jp:l=11;break e;case Tp:l=14;break e;case ri:l=16,n=null;break e}l=29,s=Error(K(130,t===null?"null":typeof t,"")),n=null}return e=ps(l,s,e,i),e.elementType=t,e.type=n,e.lanes=a,e}function Na(t,e,s,n){return t=ps(7,t,n,e),t.lanes=s,t}function gh(t,e,s){return t=ps(6,t,null,e),t.lanes=s,t}function Yw(t){var e=ps(18,null,null,0);return e.stateNode=t,e}function xh(t,e,s){return e=ps(4,t.children!==null?t.children:[],t.key,e),e.lanes=s,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}var Bb=new WeakMap;function Os(t,e){if(typeof t=="object"&&t!==null){var s=Bb.get(t);return s!==void 0?s:(e={value:t,source:e,stack:bb(e)},Bb.set(t,e),e)}return{value:t,source:e,stack:bb(e)}}var xr=[],br=0,nd=null,Do=0,Rs=[],Cs=0,$i=null,rn=1,ln="";function jn(t,e){xr[br++]=Do,xr[br++]=nd,nd=t,Do=e}function Ww(t,e,s){Rs[Cs++]=rn,Rs[Cs++]=ln,Rs[Cs++]=$i,$i=t;var n=rn;t=ln;var i=32-ys(n)-1;n&=~(1<<i),s+=1;var a=32-ys(e)+i;if(30<a){var l=i-i%5;a=(n&(1<<l)-1).toString(32),n>>=l,i-=l,rn=1<<32-ys(e)+i|s<<i|n,ln=a+t}else rn=1<<a|s<<i|n,ln=t}function Gp(t){t.return!==null&&(jn(t,1),Ww(t,1,0))}function Fp(t){for(;t===nd;)nd=xr[--br],xr[br]=null,Do=xr[--br],xr[br]=null;for(;t===$i;)$i=Rs[--Cs],Rs[Cs]=null,ln=Rs[--Cs],Rs[Cs]=null,rn=Rs[--Cs],Rs[Cs]=null}function qw(t,e){Rs[Cs++]=rn,Rs[Cs++]=ln,Rs[Cs++]=$i,rn=e.id,ln=e.overflow,$i=t}var $t=null,Qe=null,Se=!1,Ei=null,Ms=!1,Um=Error(K(519));function Gi(t){var e=Error(K(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Lo(Os(e,t)),Um}function Ub(t){var e=t.stateNode,s=t.type,n=t.memoizedProps;switch(e[Ht]=t,e[us]=n,s){case"dialog":_e("cancel",e),_e("close",e);break;case"iframe":case"object":case"embed":_e("load",e);break;case"video":case"audio":for(s=0;s<Ho.length;s++)_e(Ho[s],e);break;case"source":_e("error",e);break;case"img":case"image":case"link":_e("error",e),_e("load",e);break;case"details":_e("toggle",e);break;case"input":_e("invalid",e),Sw(e,n.value,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name,!0);break;case"select":_e("invalid",e);break;case"textarea":_e("invalid",e),jw(e,n.value,n.defaultValue,n.children)}s=n.children,typeof s!="string"&&typeof s!="number"&&typeof s!="bigint"||e.textContent===""+s||n.suppressHydrationWarning===!0||CN(e.textContent,s)?(n.popover!=null&&(_e("beforetoggle",e),_e("toggle",e)),n.onScroll!=null&&_e("scroll",e),n.onScrollEnd!=null&&_e("scrollend",e),n.onClick!=null&&(e.onclick=Rn),e=!0):e=!1,e||Gi(t,!0)}function Hb(t){for($t=t.return;$t;)switch($t.tag){case 5:case 31:case 13:Ms=!1;return;case 27:case 3:Ms=!0;return;default:$t=$t.return}}function er(t){if(t!==$t)return!1;if(!Se)return Hb(t),Se=!0,!1;var e=t.tag,s;if((s=e!==3&&e!==27)&&((s=e===5)&&(s=t.type,s=!(s!=="form"&&s!=="button")||u0(t.type,t.memoizedProps)),s=!s),s&&Qe&&Gi(t),Hb(t),e===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(K(317));Qe=Ev(t)}else if(e===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(K(317));Qe=Ev(t)}else e===27?(e=Qe,sa(t.type)?(t=m0,m0=null,Qe=t):Qe=e):Qe=$t?Bs(t.stateNode.nextSibling):null;return!0}function Oa(){Qe=$t=null,Se=!1}function bh(){var t=Ei;return t!==null&&(as===null?as=t:as.push.apply(as,t),Ei=null),t}function Lo(t){Ei===null?Ei=[t]:Ei.push(t)}var Hm=gn(null),qa=null,Cn=null;function oi(t,e,s){We(Hm,e._currentValue),e._currentValue=s}function Pn(t){t._currentValue=Hm.current,Dt(Hm)}function $m(t,e,s){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===s)break;t=t.return}}function Gm(t,e,s,n){var i=t.child;for(i!==null&&(i.return=t);i!==null;){var a=i.dependencies;if(a!==null){var l=i.child;a=a.firstContext;e:for(;a!==null;){var o=a;a=i;for(var c=0;c<e.length;c++)if(o.context===e[c]){a.lanes|=s,o=a.alternate,o!==null&&(o.lanes|=s),$m(a.return,s,t),n||(l=null);break e}a=o.next}}else if(i.tag===18){if(l=i.return,l===null)throw Error(K(341));l.lanes|=s,a=l.alternate,a!==null&&(a.lanes|=s),$m(l,s,t),l=null}else l=i.child;if(l!==null)l.return=i;else for(l=i;l!==null;){if(l===t){l=null;break}if(i=l.sibling,i!==null){i.return=l.return,l=i;break}l=l.return}i=l}}function pl(t,e,s,n){t=null;for(var i=e,a=!1;i!==null;){if(!a){if(i.flags&524288)a=!0;else if(i.flags&262144)break}if(i.tag===10){var l=i.alternate;if(l===null)throw Error(K(387));if(l=l.memoizedProps,l!==null){var o=i.type;ws(i.pendingProps.value,l.value)||(t!==null?t.push(o):t=[o])}}else if(i===Xu.current){if(l=i.alternate,l===null)throw Error(K(387));l.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(t!==null?t.push(Go):t=[Go])}i=i.return}t!==null&&Gm(e,t,s,n),e.flags|=262144}function id(t){for(t=t.firstContext;t!==null;){if(!ws(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function Ma(t){qa=t,Cn=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function Ft(t){return Xw(qa,t)}function ru(t,e){return qa===null&&Ma(t),Xw(t,e)}function Xw(t,e){var s=e._currentValue;if(e={context:e,memoizedValue:s,next:null},Cn===null){if(t===null)throw Error(K(308));Cn=e,t.dependencies={lanes:0,firstContext:e},t.flags|=524288}else Cn=Cn.next=e;return s}var xA=typeof AbortController<"u"?AbortController:function(){var t=[],e=this.signal={aborted:!1,addEventListener:function(s,n){t.push(n)}};this.abort=function(){e.aborted=!0,t.forEach(function(s){return s()})}},bA=At.unstable_scheduleCallback,vA=At.unstable_NormalPriority,yt={$$typeof:An,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Vp(){return{controller:new xA,data:new Map,refCount:0}}function wc(t){t.refCount--,t.refCount===0&&bA(vA,function(){t.controller.abort()})}var oo=null,Fm=0,zr=0,Cr=null;function yA(t,e){if(oo===null){var s=oo=[];Fm=0,zr=pg(),Cr={status:"pending",value:void 0,then:function(n){s.push(n)}}}return Fm++,e.then($b,$b),e}function $b(){if(--Fm===0&&oo!==null){Cr!==null&&(Cr.status="fulfilled");var t=oo;oo=null,zr=0,Cr=null;for(var e=0;e<t.length;e++)(0,t[e])()}}function _A(t,e){var s=[],n={status:"pending",value:null,reason:null,then:function(i){s.push(i)}};return t.then(function(){n.status="fulfilled",n.value=e;for(var i=0;i<s.length;i++)(0,s[i])(e)},function(i){for(n.status="rejected",n.reason=i,i=0;i<s.length;i++)(0,s[i])(void 0)}),n}var Gb=ce.S;ce.S=function(t,e){uN=bs(),typeof e=="object"&&e!==null&&typeof e.then=="function"&&yA(t,e),Gb!==null&&Gb(t,e)};var Sa=gn(null);function zp(){var t=Sa.current;return t!==null?t:Ke.pooledCache}function Cu(t,e){e===null?We(Sa,Sa.current):We(Sa,e.pool)}function Qw(){var t=zp();return t===null?null:{parent:yt._currentValue,pool:t}}var gl=Error(K(460)),Kp=Error(K(474)),xf=Error(K(542)),ad={then:function(){}};function Fb(t){return t=t.status,t==="fulfilled"||t==="rejected"}function Jw(t,e,s){switch(s=t[s],s===void 0?t.push(e):s!==e&&(e.then(Rn,Rn),e=s),e.status){case"fulfilled":return e.value;case"rejected":throw t=e.reason,zb(t),t;default:if(typeof e.status=="string")e.then(Rn,Rn);else{if(t=Ke,t!==null&&100<t.shellSuspendCounter)throw Error(K(482));t=e,t.status="pending",t.then(function(n){if(e.status==="pending"){var i=e;i.status="fulfilled",i.value=n}},function(n){if(e.status==="pending"){var i=e;i.status="rejected",i.reason=n}})}switch(e.status){case"fulfilled":return e.value;case"rejected":throw t=e.reason,zb(t),t}throw Ea=e,gl}}function ma(t){try{var e=t._init;return e(t._payload)}catch(s){throw s!==null&&typeof s=="object"&&typeof s.then=="function"?(Ea=s,gl):s}}var Ea=null;function Vb(){if(Ea===null)throw Error(K(459));var t=Ea;return Ea=null,t}function zb(t){if(t===gl||t===xf)throw Error(K(483))}var Ir=null,Po=0;function lu(t){var e=Po;return Po+=1,Ir===null&&(Ir=[]),Jw(Ir,t,e)}function Hl(t,e){e=e.props.ref,t.ref=e!==void 0?e:null}function ou(t,e){throw e.$$typeof===lT?Error(K(525)):(t=Object.prototype.toString.call(e),Error(K(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)))}function Zw(t){function e(g,p){if(t){var y=g.deletions;y===null?(g.deletions=[p],g.flags|=16):y.push(p)}}function s(g,p){if(!t)return null;for(;p!==null;)e(g,p),p=p.sibling;return null}function n(g){for(var p=new Map;g!==null;)g.key!==null?p.set(g.key,g):p.set(g.index,g),g=g.sibling;return p}function i(g,p){return g=Ln(g,p),g.index=0,g.sibling=null,g}function a(g,p,y){return g.index=y,t?(y=g.alternate,y!==null?(y=y.index,y<p?(g.flags|=67108866,p):y):(g.flags|=67108866,p)):(g.flags|=1048576,p)}function l(g){return t&&g.alternate===null&&(g.flags|=67108866),g}function o(g,p,y,k){return p===null||p.tag!==6?(p=gh(y,g.mode,k),p.return=g,p):(p=i(p,y),p.return=g,p)}function c(g,p,y,k){var N=y.type;return N===or?d(g,p,y.props.children,k,y.key):p!==null&&(p.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===ri&&ma(N)===p.type)?(p=i(p,y.props),Hl(p,y),p.return=g,p):(p=Ru(y.type,y.key,y.props,null,g.mode,k),Hl(p,y),p.return=g,p)}function u(g,p,y,k){return p===null||p.tag!==4||p.stateNode.containerInfo!==y.containerInfo||p.stateNode.implementation!==y.implementation?(p=xh(y,g.mode,k),p.return=g,p):(p=i(p,y.children||[]),p.return=g,p)}function d(g,p,y,k,N){return p===null||p.tag!==7?(p=Na(y,g.mode,k,N),p.return=g,p):(p=i(p,y),p.return=g,p)}function f(g,p,y){if(typeof p=="string"&&p!==""||typeof p=="number"||typeof p=="bigint")return p=gh(""+p,g.mode,y),p.return=g,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case eu:return y=Ru(p.type,p.key,p.props,null,g.mode,y),Hl(y,p),y.return=g,y;case ql:return p=xh(p,g.mode,y),p.return=g,p;case ri:return p=ma(p),f(g,p,y)}if(Xl(p)||Pl(p))return p=Na(p,g.mode,y,null),p.return=g,p;if(typeof p.then=="function")return f(g,lu(p),y);if(p.$$typeof===An)return f(g,ru(g,p),y);ou(g,p)}return null}function h(g,p,y,k){var N=p!==null?p.key:null;if(typeof y=="string"&&y!==""||typeof y=="number"||typeof y=="bigint")return N!==null?null:o(g,p,""+y,k);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case eu:return y.key===N?c(g,p,y,k):null;case ql:return y.key===N?u(g,p,y,k):null;case ri:return y=ma(y),h(g,p,y,k)}if(Xl(y)||Pl(y))return N!==null?null:d(g,p,y,k,null);if(typeof y.then=="function")return h(g,p,lu(y),k);if(y.$$typeof===An)return h(g,p,ru(g,y),k);ou(g,y)}return null}function m(g,p,y,k,N){if(typeof k=="string"&&k!==""||typeof k=="number"||typeof k=="bigint")return g=g.get(y)||null,o(p,g,""+k,N);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case eu:return g=g.get(k.key===null?y:k.key)||null,c(p,g,k,N);case ql:return g=g.get(k.key===null?y:k.key)||null,u(p,g,k,N);case ri:return k=ma(k),m(g,p,y,k,N)}if(Xl(k)||Pl(k))return g=g.get(y)||null,d(p,g,k,N,null);if(typeof k.then=="function")return m(g,p,y,lu(k),N);if(k.$$typeof===An)return m(g,p,y,ru(p,k),N);ou(p,k)}return null}function v(g,p,y,k){for(var N=null,S=null,w=p,E=p=0,j=null;w!==null&&E<y.length;E++){w.index>E?(j=w,w=null):j=w.sibling;var A=h(g,w,y[E],k);if(A===null){w===null&&(w=j);break}t&&w&&A.alternate===null&&e(g,w),p=a(A,p,E),S===null?N=A:S.sibling=A,S=A,w=j}if(E===y.length)return s(g,w),Se&&jn(g,E),N;if(w===null){for(;E<y.length;E++)w=f(g,y[E],k),w!==null&&(p=a(w,p,E),S===null?N=w:S.sibling=w,S=w);return Se&&jn(g,E),N}for(w=n(w);E<y.length;E++)j=m(w,g,E,y[E],k),j!==null&&(t&&j.alternate!==null&&w.delete(j.key===null?E:j.key),p=a(j,p,E),S===null?N=j:S.sibling=j,S=j);return t&&w.forEach(function(O){return e(g,O)}),Se&&jn(g,E),N}function x(g,p,y,k){if(y==null)throw Error(K(151));for(var N=null,S=null,w=p,E=p=0,j=null,A=y.next();w!==null&&!A.done;E++,A=y.next()){w.index>E?(j=w,w=null):j=w.sibling;var O=h(g,w,A.value,k);if(O===null){w===null&&(w=j);break}t&&w&&O.alternate===null&&e(g,w),p=a(O,p,E),S===null?N=O:S.sibling=O,S=O,w=j}if(A.done)return s(g,w),Se&&jn(g,E),N;if(w===null){for(;!A.done;E++,A=y.next())A=f(g,A.value,k),A!==null&&(p=a(A,p,E),S===null?N=A:S.sibling=A,S=A);return Se&&jn(g,E),N}for(w=n(w);!A.done;E++,A=y.next())A=m(w,g,E,A.value,k),A!==null&&(t&&A.alternate!==null&&w.delete(A.key===null?E:A.key),p=a(A,p,E),S===null?N=A:S.sibling=A,S=A);return t&&w.forEach(function(L){return e(g,L)}),Se&&jn(g,E),N}function b(g,p,y,k){if(typeof y=="object"&&y!==null&&y.type===or&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case eu:e:{for(var N=y.key;p!==null;){if(p.key===N){if(N=y.type,N===or){if(p.tag===7){s(g,p.sibling),k=i(p,y.props.children),k.return=g,g=k;break e}}else if(p.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===ri&&ma(N)===p.type){s(g,p.sibling),k=i(p,y.props),Hl(k,y),k.return=g,g=k;break e}s(g,p);break}else e(g,p);p=p.sibling}y.type===or?(k=Na(y.props.children,g.mode,k,y.key),k.return=g,g=k):(k=Ru(y.type,y.key,y.props,null,g.mode,k),Hl(k,y),k.return=g,g=k)}return l(g);case ql:e:{for(N=y.key;p!==null;){if(p.key===N)if(p.tag===4&&p.stateNode.containerInfo===y.containerInfo&&p.stateNode.implementation===y.implementation){s(g,p.sibling),k=i(p,y.children||[]),k.return=g,g=k;break e}else{s(g,p);break}else e(g,p);p=p.sibling}k=xh(y,g.mode,k),k.return=g,g=k}return l(g);case ri:return y=ma(y),b(g,p,y,k)}if(Xl(y))return v(g,p,y,k);if(Pl(y)){if(N=Pl(y),typeof N!="function")throw Error(K(150));return y=N.call(y),x(g,p,y,k)}if(typeof y.then=="function")return b(g,p,lu(y),k);if(y.$$typeof===An)return b(g,p,ru(g,y),k);ou(g,y)}return typeof y=="string"&&y!==""||typeof y=="number"||typeof y=="bigint"?(y=""+y,p!==null&&p.tag===6?(s(g,p.sibling),k=i(p,y),k.return=g,g=k):(s(g,p),k=gh(y,g.mode,k),k.return=g,g=k),l(g)):s(g,p)}return function(g,p,y,k){try{Po=0;var N=b(g,p,y,k);return Ir=null,N}catch(w){if(w===gl||w===xf)throw w;var S=ps(29,w,null,g.mode);return S.lanes=k,S.return=g,S}finally{}}}var Da=Zw(!0),ek=Zw(!1),li=!1;function Yp(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Vm(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function ji(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function Ti(t,e,s){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Re&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,e=sd(t),zw(t,null,s),e}return gf(t,n,e,s),sd(t)}function co(t,e,s){if(e=e.updateQueue,e!==null&&(e=e.shared,(s&4194048)!==0)){var n=e.lanes;n&=t.pendingLanes,s|=n,e.lanes=s,bw(t,s)}}function vh(t,e){var s=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,s===n)){var i=null,a=null;if(s=s.firstBaseUpdate,s!==null){do{var l={lane:s.lane,tag:s.tag,payload:s.payload,callback:null,next:null};a===null?i=a=l:a=a.next=l,s=s.next}while(s!==null);a===null?i=a=e:a=a.next=e}else i=a=e;s={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,callbacks:n.callbacks},t.updateQueue=s;return}t=s.lastBaseUpdate,t===null?s.firstBaseUpdate=e:t.next=e,s.lastBaseUpdate=e}var zm=!1;function uo(){if(zm){var t=Cr;if(t!==null)throw t}}function fo(t,e,s,n){zm=!1;var i=t.updateQueue;li=!1;var a=i.firstBaseUpdate,l=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var c=o,u=c.next;c.next=null,l===null?a=u:l.next=u,l=c;var d=t.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==l&&(o===null?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=c))}if(a!==null){var f=i.baseState;l=0,d=u=c=null,o=a;do{var h=o.lane&-536870913,m=h!==o.lane;if(m?(ke&h)===h:(n&h)===h){h!==0&&h===zr&&(zm=!0),d!==null&&(d=d.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var v=t,x=o;h=e;var b=s;switch(x.tag){case 1:if(v=x.payload,typeof v=="function"){f=v.call(b,f,h);break e}f=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=x.payload,h=typeof v=="function"?v.call(b,f,h):v,h==null)break e;f=Ze({},f,h);break e;case 2:li=!0}}h=o.callback,h!==null&&(t.flags|=64,m&&(t.flags|=8192),m=i.callbacks,m===null?i.callbacks=[h]:m.push(h))}else m={lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(u=d=m,c=f):d=d.next=m,l|=h;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;m=o,o=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);d===null&&(c=f),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=d,a===null&&(i.shared.lanes=0),Vi|=l,t.lanes=l,t.memoizedState=f}}function tk(t,e){if(typeof t!="function")throw Error(K(191,t));t.call(e)}function sk(t,e){var s=t.callbacks;if(s!==null)for(t.callbacks=null,t=0;t<s.length;t++)tk(s[t],e)}var Kr=gn(null),rd=gn(0);function Kb(t,e){t=zn,We(rd,t),We(Kr,e),zn=t|e.baseLanes}function Km(){We(rd,zn),We(Kr,Kr.current)}function Wp(){zn=rd.current,Dt(Kr),Dt(rd)}var ks=gn(null),Ps=null;function ci(t){var e=t.alternate;We(mt,mt.current&1),We(ks,t),Ps===null&&(e===null||Kr.current!==null||e.memoizedState!==null)&&(Ps=t)}function Ym(t){We(mt,mt.current),We(ks,t),Ps===null&&(Ps=t)}function nk(t){t.tag===22?(We(mt,mt.current),We(ks,t),Ps===null&&(Ps=t)):ui()}function ui(){We(mt,mt.current),We(ks,ks.current)}function ms(t){Dt(ks),Ps===t&&(Ps=null),Dt(mt)}var mt=gn(0);function ld(t){for(var e=t;e!==null;){if(e.tag===13){var s=e.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||f0(s)||h0(s)))return e}else if(e.tag===19&&(e.memoizedProps.revealOrder==="forwards"||e.memoizedProps.revealOrder==="backwards"||e.memoizedProps.revealOrder==="unstable_legacy-backwards"||e.memoizedProps.revealOrder==="together")){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Gn=0,pe=null,Ge=null,bt=null,od=!1,Or=!1,La=!1,cd=0,Bo=0,Mr=null,wA=0;function ct(){throw Error(K(321))}function qp(t,e){if(e===null)return!1;for(var s=0;s<e.length&&s<t.length;s++)if(!ws(t[s],e[s]))return!1;return!0}function Xp(t,e,s,n,i,a){return Gn=a,pe=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ce.H=t===null||t.memoizedState===null?Mk:lg,La=!1,a=s(n,i),La=!1,Or&&(a=ak(e,s,n,i)),ik(t),a}function ik(t){ce.H=Uo;var e=Ge!==null&&Ge.next!==null;if(Gn=0,bt=Ge=pe=null,od=!1,Bo=0,Mr=null,e)throw Error(K(300));t===null||_t||(t=t.dependencies,t!==null&&id(t)&&(_t=!0))}function ak(t,e,s,n){pe=t;var i=0;do{if(Or&&(Mr=null),Bo=0,Or=!1,25<=i)throw Error(K(301));if(i+=1,bt=Ge=null,t.updateQueue!=null){var a=t.updateQueue;a.lastEffect=null,a.events=null,a.stores=null,a.memoCache!=null&&(a.memoCache.index=0)}ce.H=Dk,a=e(s,n)}while(Or);return a}function kA(){var t=ce.H,e=t.useState()[0];return e=typeof e.then=="function"?kc(e):e,t=t.useState()[0],(Ge!==null?Ge.memoizedState:null)!==t&&(pe.flags|=1024),e}function Qp(){var t=cd!==0;return cd=0,t}function Jp(t,e,s){e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s}function Zp(t){if(od){for(t=t.memoizedState;t!==null;){var e=t.queue;e!==null&&(e.pending=null),t=t.next}od=!1}Gn=0,bt=Ge=pe=null,Or=!1,Bo=cd=0,Mr=null}function Yt(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return bt===null?pe.memoizedState=bt=t:bt=bt.next=t,bt}function pt(){if(Ge===null){var t=pe.alternate;t=t!==null?t.memoizedState:null}else t=Ge.next;var e=bt===null?pe.memoizedState:bt.next;if(e!==null)bt=e,Ge=t;else{if(t===null)throw pe.alternate===null?Error(K(467)):Error(K(310));Ge=t,t={memoizedState:Ge.memoizedState,baseState:Ge.baseState,baseQueue:Ge.baseQueue,queue:Ge.queue,next:null},bt===null?pe.memoizedState=bt=t:bt=bt.next=t}return bt}function bf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function kc(t){var e=Bo;return Bo+=1,Mr===null&&(Mr=[]),t=Jw(Mr,t,e),e=pe,(bt===null?e.memoizedState:bt.next)===null&&(e=e.alternate,ce.H=e===null||e.memoizedState===null?Mk:lg),t}function vf(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return kc(t);if(t.$$typeof===An)return Ft(t)}throw Error(K(438,String(t)))}function eg(t){var e=null,s=pe.updateQueue;if(s!==null&&(e=s.memoCache),e==null){var n=pe.alternate;n!==null&&(n=n.updateQueue,n!==null&&(n=n.memoCache,n!=null&&(e={data:n.data.map(function(i){return i.slice()}),index:0})))}if(e==null&&(e={data:[],index:0}),s===null&&(s=bf(),pe.updateQueue=s),s.memoCache=e,s=e.data[e.index],s===void 0)for(s=e.data[e.index]=Array(t),n=0;n<t;n++)s[n]=oT;return e.index++,s}function Fn(t,e){return typeof e=="function"?e(t):e}function Iu(t){var e=pt();return tg(e,Ge,t)}function tg(t,e,s){var n=t.queue;if(n===null)throw Error(K(311));n.lastRenderedReducer=s;var i=t.baseQueue,a=n.pending;if(a!==null){if(i!==null){var l=i.next;i.next=a.next,a.next=l}e.baseQueue=i=a,n.pending=null}if(a=t.baseState,i===null)t.memoizedState=a;else{e=i.next;var o=l=null,c=null,u=e,d=!1;do{var f=u.lane&-536870913;if(f!==u.lane?(ke&f)===f:(Gn&f)===f){var h=u.revertLane;if(h===0)c!==null&&(c=c.next={lane:0,revertLane:0,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),f===zr&&(d=!0);else if((Gn&h)===h){u=u.next,h===zr&&(d=!0);continue}else f={lane:0,revertLane:u.revertLane,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},c===null?(o=c=f,l=a):c=c.next=f,pe.lanes|=h,Vi|=h;f=u.action,La&&s(a,f),a=u.hasEagerState?u.eagerState:s(a,f)}else h={lane:f,revertLane:u.revertLane,gesture:u.gesture,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},c===null?(o=c=h,l=a):c=c.next=h,pe.lanes|=f,Vi|=f;u=u.next}while(u!==null&&u!==e);if(c===null?l=a:c.next=o,!ws(a,t.memoizedState)&&(_t=!0,d&&(s=Cr,s!==null)))throw s;t.memoizedState=a,t.baseState=l,t.baseQueue=c,n.lastRenderedState=a}return i===null&&(n.lanes=0),[t.memoizedState,n.dispatch]}function yh(t){var e=pt(),s=e.queue;if(s===null)throw Error(K(311));s.lastRenderedReducer=t;var n=s.dispatch,i=s.pending,a=e.memoizedState;if(i!==null){s.pending=null;var l=i=i.next;do a=t(a,l.action),l=l.next;while(l!==i);ws(a,e.memoizedState)||(_t=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),s.lastRenderedState=a}return[a,n]}function rk(t,e,s){var n=pe,i=pt(),a=Se;if(a){if(s===void 0)throw Error(K(407));s=s()}else s=e();var l=!ws((Ge||i).memoizedState,s);if(l&&(i.memoizedState=s,_t=!0),i=i.queue,sg(ck.bind(null,n,i,t),[t]),i.getSnapshot!==e||l||bt!==null&&bt.memoizedState.tag&1){if(n.flags|=2048,Yr(9,{destroy:void 0},ok.bind(null,n,i,s,e),null),Ke===null)throw Error(K(349));a||Gn&127||lk(n,e,s)}return s}function lk(t,e,s){t.flags|=16384,t={getSnapshot:e,value:s},e=pe.updateQueue,e===null?(e=bf(),pe.updateQueue=e,e.stores=[t]):(s=e.stores,s===null?e.stores=[t]:s.push(t))}function ok(t,e,s,n){e.value=s,e.getSnapshot=n,uk(e)&&dk(t)}function ck(t,e,s){return s(function(){uk(e)&&dk(t)})}function uk(t){var e=t.getSnapshot;t=t.value;try{var s=e();return!ws(t,s)}catch{return!0}}function dk(t){var e=Wa(t,2);e!==null&&os(e,t,2)}function Wm(t){var e=Yt();if(typeof t=="function"){var s=t;if(t=s(),La){gi(!0);try{s()}finally{gi(!1)}}}return e.memoizedState=e.baseState=t,e.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fn,lastRenderedState:t},e}function fk(t,e,s,n){return t.baseState=s,tg(t,Ge,typeof n=="function"?n:Fn)}function NA(t,e,s,n,i){if(_f(t))throw Error(K(485));if(t=e.action,t!==null){var a={payload:i,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(l){a.listeners.push(l)}};ce.T!==null?s(!0):a.isTransition=!1,n(a),s=e.pending,s===null?(a.next=e.pending=a,hk(e,a)):(a.next=s.next,e.pending=s.next=a)}}function hk(t,e){var s=e.action,n=e.payload,i=t.state;if(e.isTransition){var a=ce.T,l={};ce.T=l;try{var o=s(i,n),c=ce.S;c!==null&&c(l,o),Yb(t,e,o)}catch(u){qm(t,e,u)}finally{a!==null&&l.types!==null&&(a.types=l.types),ce.T=a}}else try{a=s(i,n),Yb(t,e,a)}catch(u){qm(t,e,u)}}function Yb(t,e,s){s!==null&&typeof s=="object"&&typeof s.then=="function"?s.then(function(n){Wb(t,e,n)},function(n){return qm(t,e,n)}):Wb(t,e,s)}function Wb(t,e,s){e.status="fulfilled",e.value=s,mk(e),t.state=s,e=t.pending,e!==null&&(s=e.next,s===e?t.pending=null:(s=s.next,e.next=s,hk(t,s)))}function qm(t,e,s){var n=t.pending;if(t.pending=null,n!==null){n=n.next;do e.status="rejected",e.reason=s,mk(e),e=e.next;while(e!==n)}t.action=null}function mk(t){t=t.listeners;for(var e=0;e<t.length;e++)(0,t[e])()}function pk(t,e){return e}function qb(t,e){if(Se){var s=Ke.formState;if(s!==null){e:{var n=pe;if(Se){if(Qe){t:{for(var i=Qe,a=Ms;i.nodeType!==8;){if(!a){i=null;break t}if(i=Bs(i.nextSibling),i===null){i=null;break t}}a=i.data,i=a==="F!"||a==="F"?i:null}if(i){Qe=Bs(i.nextSibling),n=i.data==="F!";break e}}Gi(n)}n=!1}n&&(e=s[0])}}return s=Yt(),s.memoizedState=s.baseState=e,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:pk,lastRenderedState:e},s.queue=n,s=Ck.bind(null,pe,n),n.dispatch=s,n=Wm(!1),a=rg.bind(null,pe,!1,n.queue),n=Yt(),i={state:e,dispatch:null,action:t,pending:null},n.queue=i,s=NA.bind(null,pe,i,a,s),i.dispatch=s,n.memoizedState=t,[e,s,!1]}function Xb(t){var e=pt();return gk(e,Ge,t)}function gk(t,e,s){if(e=tg(t,e,pk)[0],t=Iu(Fn)[0],typeof e=="object"&&e!==null&&typeof e.then=="function")try{var n=kc(e)}catch(l){throw l===gl?xf:l}else n=e;e=pt();var i=e.queue,a=i.dispatch;return s!==e.memoizedState&&(pe.flags|=2048,Yr(9,{destroy:void 0},SA.bind(null,i,s),null)),[n,a,t]}function SA(t,e){t.action=e}function Qb(t){var e=pt(),s=Ge;if(s!==null)return gk(e,s,t);pt(),e=e.memoizedState,s=pt();var n=s.queue.dispatch;return s.memoizedState=t,[e,n,!1]}function Yr(t,e,s,n){return t={tag:t,create:s,deps:n,inst:e,next:null},e=pe.updateQueue,e===null&&(e=bf(),pe.updateQueue=e),s=e.lastEffect,s===null?e.lastEffect=t.next=t:(n=s.next,s.next=t,t.next=n,e.lastEffect=t),t}function xk(){return pt().memoizedState}function Ou(t,e,s,n){var i=Yt();pe.flags|=t,i.memoizedState=Yr(1|e,{destroy:void 0},s,n===void 0?null:n)}function yf(t,e,s,n){var i=pt();n=n===void 0?null:n;var a=i.memoizedState.inst;Ge!==null&&n!==null&&qp(n,Ge.memoizedState.deps)?i.memoizedState=Yr(e,a,s,n):(pe.flags|=t,i.memoizedState=Yr(1|e,a,s,n))}function Jb(t,e){Ou(8390656,8,t,e)}function sg(t,e){yf(2048,8,t,e)}function EA(t){pe.flags|=4;var e=pe.updateQueue;if(e===null)e=bf(),pe.updateQueue=e,e.events=[t];else{var s=e.events;s===null?e.events=[t]:s.push(t)}}function bk(t){var e=pt().memoizedState;return EA({ref:e,nextImpl:t}),function(){if(Re&2)throw Error(K(440));return e.impl.apply(void 0,arguments)}}function vk(t,e){return yf(4,2,t,e)}function yk(t,e){return yf(4,4,t,e)}function _k(t,e){if(typeof e=="function"){t=t();var s=e(t);return function(){typeof s=="function"?s():e(null)}}if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function wk(t,e,s){s=s!=null?s.concat([t]):null,yf(4,4,_k.bind(null,e,t),s)}function ng(){}function kk(t,e){var s=pt();e=e===void 0?null:e;var n=s.memoizedState;return e!==null&&qp(e,n[1])?n[0]:(s.memoizedState=[t,e],t)}function Nk(t,e){var s=pt();e=e===void 0?null:e;var n=s.memoizedState;if(e!==null&&qp(e,n[1]))return n[0];if(n=t(),La){gi(!0);try{t()}finally{gi(!1)}}return s.memoizedState=[n,e],n}function ig(t,e,s){return s===void 0||Gn&1073741824&&!(ke&261930)?t.memoizedState=e:(t.memoizedState=s,t=fN(),pe.lanes|=t,Vi|=t,s)}function Sk(t,e,s,n){return ws(s,e)?s:Kr.current!==null?(t=ig(t,s,n),ws(t,e)||(_t=!0),t):!(Gn&42)||Gn&1073741824&&!(ke&261930)?(_t=!0,t.memoizedState=s):(t=fN(),pe.lanes|=t,Vi|=t,e)}function Ek(t,e,s,n,i){var a=Ce.p;Ce.p=a!==0&&8>a?a:8;var l=ce.T,o={};ce.T=o,rg(t,!1,e,s);try{var c=i(),u=ce.S;if(u!==null&&u(o,c),c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=_A(c,n);ho(t,e,d,_s(t))}else ho(t,e,n,_s(t))}catch(f){ho(t,e,{then:function(){},status:"rejected",reason:f},_s())}finally{Ce.p=a,l!==null&&o.types!==null&&(l.types=o.types),ce.T=l}}function jA(){}function Xm(t,e,s,n){if(t.tag!==5)throw Error(K(476));var i=jk(t).queue;Ek(t,i,e,ka,s===null?jA:function(){return Tk(t),s(n)})}function jk(t){var e=t.memoizedState;if(e!==null)return e;e={memoizedState:ka,baseState:ka,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fn,lastRenderedState:ka},next:null};var s={};return e.next={memoizedState:s,baseState:s,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fn,lastRenderedState:s},next:null},t.memoizedState=e,t=t.alternate,t!==null&&(t.memoizedState=e),e}function Tk(t){var e=jk(t);e.next===null&&(e=t.alternate.memoizedState),ho(t,e.next.queue,{},_s())}function ag(){return Ft(Go)}function Ak(){return pt().memoizedState}function Rk(){return pt().memoizedState}function TA(t){for(var e=t.return;e!==null;){switch(e.tag){case 24:case 3:var s=_s();t=ji(s);var n=Ti(e,t,s);n!==null&&(os(n,e,s),co(n,e,s)),e={cache:Vp()},t.payload=e;return}e=e.return}}function AA(t,e,s){var n=_s();s={lane:n,revertLane:0,gesture:null,action:s,hasEagerState:!1,eagerState:null,next:null},_f(t)?Ik(e,s):(s=Hp(t,e,s,n),s!==null&&(os(s,t,n),Ok(s,e,n)))}function Ck(t,e,s){var n=_s();ho(t,e,s,n)}function ho(t,e,s,n){var i={lane:n,revertLane:0,gesture:null,action:s,hasEagerState:!1,eagerState:null,next:null};if(_f(t))Ik(e,i);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var l=e.lastRenderedState,o=a(l,s);if(i.hasEagerState=!0,i.eagerState=o,ws(o,l))return gf(t,e,i,0),Ke===null&&pf(),!1}catch{}finally{}if(s=Hp(t,e,i,n),s!==null)return os(s,t,n),Ok(s,e,n),!0}return!1}function rg(t,e,s,n){if(n={lane:2,revertLane:pg(),gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},_f(t)){if(e)throw Error(K(479))}else e=Hp(t,s,n,2),e!==null&&os(e,t,2)}function _f(t){var e=t.alternate;return t===pe||e!==null&&e===pe}function Ik(t,e){Or=od=!0;var s=t.pending;s===null?e.next=e:(e.next=s.next,s.next=e),t.pending=e}function Ok(t,e,s){if(s&4194048){var n=e.lanes;n&=t.pendingLanes,s|=n,e.lanes=s,bw(t,s)}}var Uo={readContext:Ft,use:vf,useCallback:ct,useContext:ct,useEffect:ct,useImperativeHandle:ct,useLayoutEffect:ct,useInsertionEffect:ct,useMemo:ct,useReducer:ct,useRef:ct,useState:ct,useDebugValue:ct,useDeferredValue:ct,useTransition:ct,useSyncExternalStore:ct,useId:ct,useHostTransitionStatus:ct,useFormState:ct,useActionState:ct,useOptimistic:ct,useMemoCache:ct,useCacheRefresh:ct};Uo.useEffectEvent=ct;var Mk={readContext:Ft,use:vf,useCallback:function(t,e){return Yt().memoizedState=[t,e===void 0?null:e],t},useContext:Ft,useEffect:Jb,useImperativeHandle:function(t,e,s){s=s!=null?s.concat([t]):null,Ou(4194308,4,_k.bind(null,e,t),s)},useLayoutEffect:function(t,e){return Ou(4194308,4,t,e)},useInsertionEffect:function(t,e){Ou(4,2,t,e)},useMemo:function(t,e){var s=Yt();e=e===void 0?null:e;var n=t();if(La){gi(!0);try{t()}finally{gi(!1)}}return s.memoizedState=[n,e],n},useReducer:function(t,e,s){var n=Yt();if(s!==void 0){var i=s(e);if(La){gi(!0);try{s(e)}finally{gi(!1)}}}else i=e;return n.memoizedState=n.baseState=i,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:i},n.queue=t,t=t.dispatch=AA.bind(null,pe,t),[n.memoizedState,t]},useRef:function(t){var e=Yt();return t={current:t},e.memoizedState=t},useState:function(t){t=Wm(t);var e=t.queue,s=Ck.bind(null,pe,e);return e.dispatch=s,[t.memoizedState,s]},useDebugValue:ng,useDeferredValue:function(t,e){var s=Yt();return ig(s,t,e)},useTransition:function(){var t=Wm(!1);return t=Ek.bind(null,pe,t.queue,!0,!1),Yt().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,e,s){var n=pe,i=Yt();if(Se){if(s===void 0)throw Error(K(407));s=s()}else{if(s=e(),Ke===null)throw Error(K(349));ke&127||lk(n,e,s)}i.memoizedState=s;var a={value:s,getSnapshot:e};return i.queue=a,Jb(ck.bind(null,n,a,t),[t]),n.flags|=2048,Yr(9,{destroy:void 0},ok.bind(null,n,a,s,e),null),s},useId:function(){var t=Yt(),e=Ke.identifierPrefix;if(Se){var s=ln,n=rn;s=(n&~(1<<32-ys(n)-1)).toString(32)+s,e="_"+e+"R_"+s,s=cd++,0<s&&(e+="H"+s.toString(32)),e+="_"}else s=wA++,e="_"+e+"r_"+s.toString(32)+"_";return t.memoizedState=e},useHostTransitionStatus:ag,useFormState:qb,useActionState:qb,useOptimistic:function(t){var e=Yt();e.memoizedState=e.baseState=t;var s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return e.queue=s,e=rg.bind(null,pe,!0,s),s.dispatch=e,[t,e]},useMemoCache:eg,useCacheRefresh:function(){return Yt().memoizedState=TA.bind(null,pe)},useEffectEvent:function(t){var e=Yt(),s={impl:t};return e.memoizedState=s,function(){if(Re&2)throw Error(K(440));return s.impl.apply(void 0,arguments)}}},lg={readContext:Ft,use:vf,useCallback:kk,useContext:Ft,useEffect:sg,useImperativeHandle:wk,useInsertionEffect:vk,useLayoutEffect:yk,useMemo:Nk,useReducer:Iu,useRef:xk,useState:function(){return Iu(Fn)},useDebugValue:ng,useDeferredValue:function(t,e){var s=pt();return Sk(s,Ge.memoizedState,t,e)},useTransition:function(){var t=Iu(Fn)[0],e=pt().memoizedState;return[typeof t=="boolean"?t:kc(t),e]},useSyncExternalStore:rk,useId:Ak,useHostTransitionStatus:ag,useFormState:Xb,useActionState:Xb,useOptimistic:function(t,e){var s=pt();return fk(s,Ge,t,e)},useMemoCache:eg,useCacheRefresh:Rk};lg.useEffectEvent=bk;var Dk={readContext:Ft,use:vf,useCallback:kk,useContext:Ft,useEffect:sg,useImperativeHandle:wk,useInsertionEffect:vk,useLayoutEffect:yk,useMemo:Nk,useReducer:yh,useRef:xk,useState:function(){return yh(Fn)},useDebugValue:ng,useDeferredValue:function(t,e){var s=pt();return Ge===null?ig(s,t,e):Sk(s,Ge.memoizedState,t,e)},useTransition:function(){var t=yh(Fn)[0],e=pt().memoizedState;return[typeof t=="boolean"?t:kc(t),e]},useSyncExternalStore:rk,useId:Ak,useHostTransitionStatus:ag,useFormState:Qb,useActionState:Qb,useOptimistic:function(t,e){var s=pt();return Ge!==null?fk(s,Ge,t,e):(s.baseState=t,[t,s.queue.dispatch])},useMemoCache:eg,useCacheRefresh:Rk};Dk.useEffectEvent=bk;function _h(t,e,s,n){e=t.memoizedState,s=s(n,e),s=s==null?e:Ze({},e,s),t.memoizedState=s,t.lanes===0&&(t.updateQueue.baseState=s)}var Qm={enqueueSetState:function(t,e,s){t=t._reactInternals;var n=_s(),i=ji(n);i.payload=e,s!=null&&(i.callback=s),e=Ti(t,i,n),e!==null&&(os(e,t,n),co(e,t,n))},enqueueReplaceState:function(t,e,s){t=t._reactInternals;var n=_s(),i=ji(n);i.tag=1,i.payload=e,s!=null&&(i.callback=s),e=Ti(t,i,n),e!==null&&(os(e,t,n),co(e,t,n))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var s=_s(),n=ji(s);n.tag=2,e!=null&&(n.callback=e),e=Ti(t,n,s),e!==null&&(os(e,t,s),co(e,t,s))}};function Zb(t,e,s,n,i,a,l){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,a,l):e.prototype&&e.prototype.isPureReactComponent?!Mo(s,n)||!Mo(i,a):!0}function ev(t,e,s,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(s,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(s,n),e.state!==t&&Qm.enqueueReplaceState(e,e.state,null)}function Pa(t,e){var s=e;if("ref"in e){s={};for(var n in e)n!=="ref"&&(s[n]=e[n])}if(t=t.defaultProps){s===e&&(s=Ze({},s));for(var i in t)s[i]===void 0&&(s[i]=t[i])}return s}function Lk(t){td(t)}function Pk(t){console.error(t)}function Bk(t){td(t)}function ud(t,e){try{var s=t.onUncaughtError;s(e.value,{componentStack:e.stack})}catch(n){setTimeout(function(){throw n})}}function tv(t,e,s){try{var n=t.onCaughtError;n(s.value,{componentStack:s.stack,errorBoundary:e.tag===1?e.stateNode:null})}catch(i){setTimeout(function(){throw i})}}function Jm(t,e,s){return s=ji(s),s.tag=3,s.payload={element:null},s.callback=function(){ud(t,e)},s}function Uk(t){return t=ji(t),t.tag=3,t}function Hk(t,e,s,n){var i=s.type.getDerivedStateFromError;if(typeof i=="function"){var a=n.value;t.payload=function(){return i(a)},t.callback=function(){tv(e,s,n)}}var l=s.stateNode;l!==null&&typeof l.componentDidCatch=="function"&&(t.callback=function(){tv(e,s,n),typeof i!="function"&&(Ai===null?Ai=new Set([this]):Ai.add(this));var o=n.stack;this.componentDidCatch(n.value,{componentStack:o!==null?o:""})})}function RA(t,e,s,n,i){if(s.flags|=32768,n!==null&&typeof n=="object"&&typeof n.then=="function"){if(e=s.alternate,e!==null&&pl(e,s,i,!0),s=ks.current,s!==null){switch(s.tag){case 31:case 13:return Ps===null?pd():s.alternate===null&&ft===0&&(ft=3),s.flags&=-257,s.flags|=65536,s.lanes=i,n===ad?s.flags|=16384:(e=s.updateQueue,e===null?s.updateQueue=new Set([n]):e.add(n),Ih(t,n,i)),!1;case 22:return s.flags|=65536,n===ad?s.flags|=16384:(e=s.updateQueue,e===null?(e={transitions:null,markerInstances:null,retryQueue:new Set([n])},s.updateQueue=e):(s=e.retryQueue,s===null?e.retryQueue=new Set([n]):s.add(n)),Ih(t,n,i)),!1}throw Error(K(435,s.tag))}return Ih(t,n,i),pd(),!1}if(Se)return e=ks.current,e!==null?(!(e.flags&65536)&&(e.flags|=256),e.flags|=65536,e.lanes=i,n!==Um&&(t=Error(K(422),{cause:n}),Lo(Os(t,s)))):(n!==Um&&(e=Error(K(423),{cause:n}),Lo(Os(e,s))),t=t.current.alternate,t.flags|=65536,i&=-i,t.lanes|=i,n=Os(n,s),i=Jm(t.stateNode,n,i),vh(t,i),ft!==4&&(ft=2)),!1;var a=Error(K(520),{cause:n});if(a=Os(a,s),go===null?go=[a]:go.push(a),ft!==4&&(ft=2),e===null)return!0;n=Os(n,s),s=e;do{switch(s.tag){case 3:return s.flags|=65536,t=i&-i,s.lanes|=t,t=Jm(s.stateNode,n,t),vh(s,t),!1;case 1:if(e=s.type,a=s.stateNode,(s.flags&128)===0&&(typeof e.getDerivedStateFromError=="function"||a!==null&&typeof a.componentDidCatch=="function"&&(Ai===null||!Ai.has(a))))return s.flags|=65536,i&=-i,s.lanes|=i,i=Uk(i),Hk(i,t,s,n),vh(s,i),!1}s=s.return}while(s!==null);return!1}var og=Error(K(461)),_t=!1;function Ut(t,e,s,n){e.child=t===null?ek(e,null,s,n):Da(e,t.child,s,n)}function sv(t,e,s,n,i){s=s.render;var a=e.ref;if("ref"in n){var l={};for(var o in n)o!=="ref"&&(l[o]=n[o])}else l=n;return Ma(e),n=Xp(t,e,s,l,a,i),o=Qp(),t!==null&&!_t?(Jp(t,e,i),Vn(t,e,i)):(Se&&o&&Gp(e),e.flags|=1,Ut(t,e,n,i),e.child)}function nv(t,e,s,n,i){if(t===null){var a=s.type;return typeof a=="function"&&!$p(a)&&a.defaultProps===void 0&&s.compare===null?(e.tag=15,e.type=a,$k(t,e,a,n,i)):(t=Ru(s.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!cg(t,i)){var l=a.memoizedProps;if(s=s.compare,s=s!==null?s:Mo,s(l,n)&&t.ref===e.ref)return Vn(t,e,i)}return e.flags|=1,t=Ln(a,n),t.ref=e.ref,t.return=e,e.child=t}function $k(t,e,s,n,i){if(t!==null){var a=t.memoizedProps;if(Mo(a,n)&&t.ref===e.ref)if(_t=!1,e.pendingProps=n=a,cg(t,i))t.flags&131072&&(_t=!0);else return e.lanes=t.lanes,Vn(t,e,i)}return Zm(t,e,s,n,i)}function Gk(t,e,s,n){var i=n.children,a=t!==null?t.memoizedState:null;if(t===null&&e.stateNode===null&&(e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),n.mode==="hidden"){if(e.flags&128){if(a=a!==null?a.baseLanes|s:s,t!==null){for(n=e.child=t.child,i=0;n!==null;)i=i|n.lanes|n.childLanes,n=n.sibling;n=i&~a}else n=0,e.child=null;return iv(t,e,a,s,n)}if(s&536870912)e.memoizedState={baseLanes:0,cachePool:null},t!==null&&Cu(e,a!==null?a.cachePool:null),a!==null?Kb(e,a):Km(),nk(e);else return n=e.lanes=536870912,iv(t,e,a!==null?a.baseLanes|s:s,s,n)}else a!==null?(Cu(e,a.cachePool),Kb(e,a),ui(),e.memoizedState=null):(t!==null&&Cu(e,null),Km(),ui());return Ut(t,e,i,s),e.child}function Jl(t,e){return t!==null&&t.tag===22||e.stateNode!==null||(e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),e.sibling}function iv(t,e,s,n,i){var a=zp();return a=a===null?null:{parent:yt._currentValue,pool:a},e.memoizedState={baseLanes:s,cachePool:a},t!==null&&Cu(e,null),Km(),nk(e),t!==null&&pl(t,e,n,!0),e.childLanes=i,null}function Mu(t,e){return e=dd({mode:e.mode,children:e.children},t.mode),e.ref=t.ref,t.child=e,e.return=t,e}function av(t,e,s){return Da(e,t.child,null,s),t=Mu(e,e.pendingProps),t.flags|=2,ms(e),e.memoizedState=null,t}function CA(t,e,s){var n=e.pendingProps,i=(e.flags&128)!==0;if(e.flags&=-129,t===null){if(Se){if(n.mode==="hidden")return t=Mu(e,n),e.lanes=536870912,Jl(null,t);if(Ym(e),(t=Qe)?(t=MN(t,Ms),t=t!==null&&t.data==="&"?t:null,t!==null&&(e.memoizedState={dehydrated:t,treeContext:$i!==null?{id:rn,overflow:ln}:null,retryLane:536870912,hydrationErrors:null},s=Yw(t),s.return=e,e.child=s,$t=e,Qe=null)):t=null,t===null)throw Gi(e);return e.lanes=536870912,null}return Mu(e,n)}var a=t.memoizedState;if(a!==null){var l=a.dehydrated;if(Ym(e),i)if(e.flags&256)e.flags&=-257,e=av(t,e,s);else if(e.memoizedState!==null)e.child=t.child,e.flags|=128,e=null;else throw Error(K(558));else if(_t||pl(t,e,s,!1),i=(s&t.childLanes)!==0,_t||i){if(n=Ke,n!==null&&(l=vw(n,s),l!==0&&l!==a.retryLane))throw a.retryLane=l,Wa(t,l),os(n,t,l),og;pd(),e=av(t,e,s)}else t=a.treeContext,Qe=Bs(l.nextSibling),$t=e,Se=!0,Ei=null,Ms=!1,t!==null&&qw(e,t),e=Mu(e,n),e.flags|=4096;return e}return t=Ln(t.child,{mode:n.mode,children:n.children}),t.ref=e.ref,e.child=t,t.return=e,t}function Du(t,e){var s=e.ref;if(s===null)t!==null&&t.ref!==null&&(e.flags|=4194816);else{if(typeof s!="function"&&typeof s!="object")throw Error(K(284));(t===null||t.ref!==s)&&(e.flags|=4194816)}}function Zm(t,e,s,n,i){return Ma(e),s=Xp(t,e,s,n,void 0,i),n=Qp(),t!==null&&!_t?(Jp(t,e,i),Vn(t,e,i)):(Se&&n&&Gp(e),e.flags|=1,Ut(t,e,s,i),e.child)}function rv(t,e,s,n,i,a){return Ma(e),e.updateQueue=null,s=ak(e,n,s,i),ik(t),n=Qp(),t!==null&&!_t?(Jp(t,e,a),Vn(t,e,a)):(Se&&n&&Gp(e),e.flags|=1,Ut(t,e,s,a),e.child)}function lv(t,e,s,n,i){if(Ma(e),e.stateNode===null){var a=gr,l=s.contextType;typeof l=="object"&&l!==null&&(a=Ft(l)),a=new s(n,a),e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=Qm,e.stateNode=a,a._reactInternals=e,a=e.stateNode,a.props=n,a.state=e.memoizedState,a.refs={},Yp(e),l=s.contextType,a.context=typeof l=="object"&&l!==null?Ft(l):gr,a.state=e.memoizedState,l=s.getDerivedStateFromProps,typeof l=="function"&&(_h(e,s,l,n),a.state=e.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(l=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),l!==a.state&&Qm.enqueueReplaceState(a,a.state,null),fo(e,n,a,i),uo(),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!0}else if(t===null){a=e.stateNode;var o=e.memoizedProps,c=Pa(s,o);a.props=c;var u=a.context,d=s.contextType;l=gr,typeof d=="object"&&d!==null&&(l=Ft(d));var f=s.getDerivedStateFromProps;d=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function",o=e.pendingProps!==o,d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o||u!==l)&&ev(e,a,n,l),li=!1;var h=e.memoizedState;a.state=h,fo(e,n,a,i),uo(),u=e.memoizedState,o||h!==u||li?(typeof f=="function"&&(_h(e,s,f,n),u=e.memoizedState),(c=li||Zb(e,s,c,n,h,u,l))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=u),a.props=n,a.state=u,a.context=l,n=c):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,Vm(t,e),l=e.memoizedProps,d=Pa(s,l),a.props=d,f=e.pendingProps,h=a.context,u=s.contextType,c=gr,typeof u=="object"&&u!==null&&(c=Ft(u)),o=s.getDerivedStateFromProps,(u=typeof o=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==f||h!==c)&&ev(e,a,n,c),li=!1,h=e.memoizedState,a.state=h,fo(e,n,a,i),uo();var m=e.memoizedState;l!==f||h!==m||li||t!==null&&t.dependencies!==null&&id(t.dependencies)?(typeof o=="function"&&(_h(e,s,o,n),m=e.memoizedState),(d=li||Zb(e,s,d,n,h,m,c)||t!==null&&t.dependencies!==null&&id(t.dependencies))?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,m,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,m,c)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=m),a.props=n,a.state=m,a.context=c,n=d):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),n=!1)}return a=n,Du(t,e),n=(e.flags&128)!==0,a||n?(a=e.stateNode,s=n&&typeof s.getDerivedStateFromError!="function"?null:a.render(),e.flags|=1,t!==null&&n?(e.child=Da(e,t.child,null,i),e.child=Da(e,null,s,i)):Ut(t,e,s,i),e.memoizedState=a.state,t=e.child):t=Vn(t,e,i),t}function ov(t,e,s,n){return Oa(),e.flags|=256,Ut(t,e,s,n),e.child}var wh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function kh(t){return{baseLanes:t,cachePool:Qw()}}function Nh(t,e,s){return t=t!==null?t.childLanes&~s:0,e&&(t|=xs),t}function Fk(t,e,s){var n=e.pendingProps,i=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=t!==null&&t.memoizedState===null?!1:(mt.current&2)!==0),l&&(i=!0,e.flags&=-129),l=(e.flags&32)!==0,e.flags&=-33,t===null){if(Se){if(i?ci(e):ui(),(t=Qe)?(t=MN(t,Ms),t=t!==null&&t.data!=="&"?t:null,t!==null&&(e.memoizedState={dehydrated:t,treeContext:$i!==null?{id:rn,overflow:ln}:null,retryLane:536870912,hydrationErrors:null},s=Yw(t),s.return=e,e.child=s,$t=e,Qe=null)):t=null,t===null)throw Gi(e);return h0(t)?e.lanes=32:e.lanes=536870912,null}var o=n.children;return n=n.fallback,i?(ui(),i=e.mode,o=dd({mode:"hidden",children:o},i),n=Na(n,i,s,null),o.return=e,n.return=e,o.sibling=n,e.child=o,n=e.child,n.memoizedState=kh(s),n.childLanes=Nh(t,l,s),e.memoizedState=wh,Jl(null,n)):(ci(e),e0(e,o))}var c=t.memoizedState;if(c!==null&&(o=c.dehydrated,o!==null)){if(a)e.flags&256?(ci(e),e.flags&=-257,e=Sh(t,e,s)):e.memoizedState!==null?(ui(),e.child=t.child,e.flags|=128,e=null):(ui(),o=n.fallback,i=e.mode,n=dd({mode:"visible",children:n.children},i),o=Na(o,i,s,null),o.flags|=2,n.return=e,o.return=e,n.sibling=o,e.child=n,Da(e,t.child,null,s),n=e.child,n.memoizedState=kh(s),n.childLanes=Nh(t,l,s),e.memoizedState=wh,e=Jl(null,n));else if(ci(e),h0(o)){if(l=o.nextSibling&&o.nextSibling.dataset,l)var u=l.dgst;l=u,n=Error(K(419)),n.stack="",n.digest=l,Lo({value:n,source:null,stack:null}),e=Sh(t,e,s)}else if(_t||pl(t,e,s,!1),l=(s&t.childLanes)!==0,_t||l){if(l=Ke,l!==null&&(n=vw(l,s),n!==0&&n!==c.retryLane))throw c.retryLane=n,Wa(t,n),os(l,t,n),og;f0(o)||pd(),e=Sh(t,e,s)}else f0(o)?(e.flags|=192,e.child=t.child,e=null):(t=c.treeContext,Qe=Bs(o.nextSibling),$t=e,Se=!0,Ei=null,Ms=!1,t!==null&&qw(e,t),e=e0(e,n.children),e.flags|=4096);return e}return i?(ui(),o=n.fallback,i=e.mode,c=t.child,u=c.sibling,n=Ln(c,{mode:"hidden",children:n.children}),n.subtreeFlags=c.subtreeFlags&65011712,u!==null?o=Ln(u,o):(o=Na(o,i,s,null),o.flags|=2),o.return=e,n.return=e,n.sibling=o,e.child=n,Jl(null,n),n=e.child,o=t.child.memoizedState,o===null?o=kh(s):(i=o.cachePool,i!==null?(c=yt._currentValue,i=i.parent!==c?{parent:c,pool:c}:i):i=Qw(),o={baseLanes:o.baseLanes|s,cachePool:i}),n.memoizedState=o,n.childLanes=Nh(t,l,s),e.memoizedState=wh,Jl(t.child,n)):(ci(e),s=t.child,t=s.sibling,s=Ln(s,{mode:"visible",children:n.children}),s.return=e,s.sibling=null,t!==null&&(l=e.deletions,l===null?(e.deletions=[t],e.flags|=16):l.push(t)),e.child=s,e.memoizedState=null,s)}function e0(t,e){return e=dd({mode:"visible",children:e},t.mode),e.return=t,t.child=e}function dd(t,e){return t=ps(22,t,null,e),t.lanes=0,t}function Sh(t,e,s){return Da(e,t.child,null,s),t=e0(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function cv(t,e,s){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),$m(t.return,e,s)}function Eh(t,e,s,n,i,a){var l=t.memoizedState;l===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:s,tailMode:i,treeForkCount:a}:(l.isBackwards=e,l.rendering=null,l.renderingStartTime=0,l.last=n,l.tail=s,l.tailMode=i,l.treeForkCount=a)}function Vk(t,e,s){var n=e.pendingProps,i=n.revealOrder,a=n.tail;n=n.children;var l=mt.current,o=(l&2)!==0;if(o?(l=l&1|2,e.flags|=128):l&=1,We(mt,l),Ut(t,e,n,s),n=Se?Do:0,!o&&t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&cv(t,s,e);else if(t.tag===19)cv(t,s,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(i){case"forwards":for(s=e.child,i=null;s!==null;)t=s.alternate,t!==null&&ld(t)===null&&(i=s),s=s.sibling;s=i,s===null?(i=e.child,e.child=null):(i=s.sibling,s.sibling=null),Eh(e,!1,i,s,a,n);break;case"backwards":case"unstable_legacy-backwards":for(s=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&ld(t)===null){e.child=i;break}t=i.sibling,i.sibling=s,s=i,i=t}Eh(e,!0,s,null,a,n);break;case"together":Eh(e,!1,null,null,void 0,n);break;default:e.memoizedState=null}return e.child}function Vn(t,e,s){if(t!==null&&(e.dependencies=t.dependencies),Vi|=e.lanes,!(s&e.childLanes))if(t!==null){if(pl(t,e,s,!1),(s&e.childLanes)===0)return null}else return null;if(t!==null&&e.child!==t.child)throw Error(K(153));if(e.child!==null){for(t=e.child,s=Ln(t,t.pendingProps),e.child=s,s.return=e;t.sibling!==null;)t=t.sibling,s=s.sibling=Ln(t,t.pendingProps),s.return=e;s.sibling=null}return e.child}function cg(t,e){return t.lanes&e?!0:(t=t.dependencies,!!(t!==null&&id(t)))}function IA(t,e,s){switch(e.tag){case 3:Qu(e,e.stateNode.containerInfo),oi(e,yt,t.memoizedState.cache),Oa();break;case 27:case 5:Tm(e);break;case 4:Qu(e,e.stateNode.containerInfo);break;case 10:oi(e,e.type,e.memoizedProps.value);break;case 31:if(e.memoizedState!==null)return e.flags|=128,Ym(e),null;break;case 13:var n=e.memoizedState;if(n!==null)return n.dehydrated!==null?(ci(e),e.flags|=128,null):s&e.child.childLanes?Fk(t,e,s):(ci(e),t=Vn(t,e,s),t!==null?t.sibling:null);ci(e);break;case 19:var i=(t.flags&128)!==0;if(n=(s&e.childLanes)!==0,n||(pl(t,e,s,!1),n=(s&e.childLanes)!==0),i){if(n)return Vk(t,e,s);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),We(mt,mt.current),n)break;return null;case 22:return e.lanes=0,Gk(t,e,s,e.pendingProps);case 24:oi(e,yt,t.memoizedState.cache)}return Vn(t,e,s)}function zk(t,e,s){if(t!==null)if(t.memoizedProps!==e.pendingProps)_t=!0;else{if(!cg(t,s)&&!(e.flags&128))return _t=!1,IA(t,e,s);_t=!!(t.flags&131072)}else _t=!1,Se&&e.flags&1048576&&Ww(e,Do,e.index);switch(e.lanes=0,e.tag){case 16:e:{var n=e.pendingProps;if(t=ma(e.elementType),e.type=t,typeof t=="function")$p(t)?(n=Pa(t,n),e.tag=1,e=lv(null,e,t,n,s)):(e.tag=0,e=Zm(null,e,t,n,s));else{if(t!=null){var i=t.$$typeof;if(i===jp){e.tag=11,e=sv(null,e,t,n,s);break e}else if(i===Tp){e.tag=14,e=nv(null,e,t,n,s);break e}}throw e=Em(t)||t,Error(K(306,e,""))}}return e;case 0:return Zm(t,e,e.type,e.pendingProps,s);case 1:return n=e.type,i=Pa(n,e.pendingProps),lv(t,e,n,i,s);case 3:e:{if(Qu(e,e.stateNode.containerInfo),t===null)throw Error(K(387));n=e.pendingProps;var a=e.memoizedState;i=a.element,Vm(t,e),fo(e,n,null,s);var l=e.memoizedState;if(n=l.cache,oi(e,yt,n),n!==a.cache&&Gm(e,[yt],s,!0),uo(),n=l.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:l.cache},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){e=ov(t,e,n,s);break e}else if(n!==i){i=Os(Error(K(424)),e),Lo(i),e=ov(t,e,n,s);break e}else{switch(t=e.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(Qe=Bs(t.firstChild),$t=e,Se=!0,Ei=null,Ms=!0,s=ek(e,null,n,s),e.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling}else{if(Oa(),n===i){e=Vn(t,e,s);break e}Ut(t,e,n,s)}e=e.child}return e;case 26:return Du(t,e),t===null?(s=Av(e.type,null,e.pendingProps,null))?e.memoizedState=s:Se||(s=e.type,t=e.pendingProps,n=vd(Si.current).createElement(s),n[Ht]=e,n[us]=t,Vt(n,s,t),Ot(n),e.stateNode=n):e.memoizedState=Av(e.type,t.memoizedProps,e.pendingProps,t.memoizedState),null;case 27:return Tm(e),t===null&&Se&&(n=e.stateNode=DN(e.type,e.pendingProps,Si.current),$t=e,Ms=!0,i=Qe,sa(e.type)?(m0=i,Qe=Bs(n.firstChild)):Qe=i),Ut(t,e,e.pendingProps.children,s),Du(t,e),t===null&&(e.flags|=4194304),e.child;case 5:return t===null&&Se&&((i=n=Qe)&&(n=oR(n,e.type,e.pendingProps,Ms),n!==null?(e.stateNode=n,$t=e,Qe=Bs(n.firstChild),Ms=!1,i=!0):i=!1),i||Gi(e)),Tm(e),i=e.type,a=e.pendingProps,l=t!==null?t.memoizedProps:null,n=a.children,u0(i,a)?n=null:l!==null&&u0(i,l)&&(e.flags|=32),e.memoizedState!==null&&(i=Xp(t,e,kA,null,null,s),Go._currentValue=i),Du(t,e),Ut(t,e,n,s),e.child;case 6:return t===null&&Se&&((t=s=Qe)&&(s=cR(s,e.pendingProps,Ms),s!==null?(e.stateNode=s,$t=e,Qe=null,t=!0):t=!1),t||Gi(e)),null;case 13:return Fk(t,e,s);case 4:return Qu(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Da(e,null,n,s):Ut(t,e,n,s),e.child;case 11:return sv(t,e,e.type,e.pendingProps,s);case 7:return Ut(t,e,e.pendingProps,s),e.child;case 8:return Ut(t,e,e.pendingProps.children,s),e.child;case 12:return Ut(t,e,e.pendingProps.children,s),e.child;case 10:return n=e.pendingProps,oi(e,e.type,n.value),Ut(t,e,n.children,s),e.child;case 9:return i=e.type._context,n=e.pendingProps.children,Ma(e),i=Ft(i),n=n(i),e.flags|=1,Ut(t,e,n,s),e.child;case 14:return nv(t,e,e.type,e.pendingProps,s);case 15:return $k(t,e,e.type,e.pendingProps,s);case 19:return Vk(t,e,s);case 31:return CA(t,e,s);case 22:return Gk(t,e,s,e.pendingProps);case 24:return Ma(e),n=Ft(yt),t===null?(i=zp(),i===null&&(i=Ke,a=Vp(),i.pooledCache=a,a.refCount++,a!==null&&(i.pooledCacheLanes|=s),i=a),e.memoizedState={parent:n,cache:i},Yp(e),oi(e,yt,i)):(t.lanes&s&&(Vm(t,e),fo(e,null,null,s),uo()),i=t.memoizedState,a=e.memoizedState,i.parent!==n?(i={parent:n,cache:n},e.memoizedState=i,e.lanes===0&&(e.memoizedState=e.updateQueue.baseState=i),oi(e,yt,n)):(n=a.cache,oi(e,yt,n),n!==i.cache&&Gm(e,[yt],s,!0))),Ut(t,e,e.pendingProps.children,s),e.child;case 29:throw e.pendingProps}throw Error(K(156,e.tag))}function wn(t){t.flags|=4}function jh(t,e,s,n,i){if((e=(t.mode&32)!==0)&&(e=!1),e){if(t.flags|=16777216,(i&335544128)===i)if(t.stateNode.complete)t.flags|=8192;else if(pN())t.flags|=8192;else throw Ea=ad,Kp}else t.flags&=-16777217}function uv(t,e){if(e.type!=="stylesheet"||e.state.loading&4)t.flags&=-16777217;else if(t.flags|=16777216,!BN(e))if(pN())t.flags|=8192;else throw Ea=ad,Kp}function cu(t,e){e!==null&&(t.flags|=4),t.flags&16384&&(e=t.tag!==22?gw():536870912,t.lanes|=e,Wr|=e)}function $l(t,e){if(!Se)switch(t.tailMode){case"hidden":e=t.tail;for(var s=null;e!==null;)e.alternate!==null&&(s=e),e=e.sibling;s===null?t.tail=null:s.sibling=null;break;case"collapsed":s=t.tail;for(var n=null;s!==null;)s.alternate!==null&&(n=s),s=s.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Xe(t){var e=t.alternate!==null&&t.alternate.child===t.child,s=0,n=0;if(e)for(var i=t.child;i!==null;)s|=i.lanes|i.childLanes,n|=i.subtreeFlags&65011712,n|=i.flags&65011712,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)s|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=s,e}function OA(t,e,s){var n=e.pendingProps;switch(Fp(e),e.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xe(e),null;case 1:return Xe(e),null;case 3:return s=e.stateNode,n=null,t!==null&&(n=t.memoizedState.cache),e.memoizedState.cache!==n&&(e.flags|=2048),Pn(yt),Gr(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(er(e)?wn(e):t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,bh())),Xe(e),null;case 26:var i=e.type,a=e.memoizedState;return t===null?(wn(e),a!==null?(Xe(e),uv(e,a)):(Xe(e),jh(e,i,null,n,s))):a?a!==t.memoizedState?(wn(e),Xe(e),uv(e,a)):(Xe(e),e.flags&=-16777217):(t=t.memoizedProps,t!==n&&wn(e),Xe(e),jh(e,i,t,n,s)),null;case 27:if(Ju(e),s=Si.current,i=e.type,t!==null&&e.stateNode!=null)t.memoizedProps!==n&&wn(e);else{if(!n){if(e.stateNode===null)throw Error(K(166));return Xe(e),null}t=cn.current,er(e)?Ub(e):(t=DN(i,n,s),e.stateNode=t,wn(e))}return Xe(e),null;case 5:if(Ju(e),i=e.type,t!==null&&e.stateNode!=null)t.memoizedProps!==n&&wn(e);else{if(!n){if(e.stateNode===null)throw Error(K(166));return Xe(e),null}if(a=cn.current,er(e))Ub(e);else{var l=vd(Si.current);switch(a){case 1:a=l.createElementNS("http://www.w3.org/2000/svg",i);break;case 2:a=l.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;default:switch(i){case"svg":a=l.createElementNS("http://www.w3.org/2000/svg",i);break;case"math":a=l.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;case"script":a=l.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild);break;case"select":a=typeof n.is=="string"?l.createElement("select",{is:n.is}):l.createElement("select"),n.multiple?a.multiple=!0:n.size&&(a.size=n.size);break;default:a=typeof n.is=="string"?l.createElement(i,{is:n.is}):l.createElement(i)}}a[Ht]=e,a[us]=n;e:for(l=e.child;l!==null;){if(l.tag===5||l.tag===6)a.appendChild(l.stateNode);else if(l.tag!==4&&l.tag!==27&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===e)break e;for(;l.sibling===null;){if(l.return===null||l.return===e)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}e.stateNode=a;e:switch(Vt(a,i,n),i){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}n&&wn(e)}}return Xe(e),jh(e,e.type,t===null?null:t.memoizedProps,e.pendingProps,s),null;case 6:if(t&&e.stateNode!=null)t.memoizedProps!==n&&wn(e);else{if(typeof n!="string"&&e.stateNode===null)throw Error(K(166));if(t=Si.current,er(e)){if(t=e.stateNode,s=e.memoizedProps,n=null,i=$t,i!==null)switch(i.tag){case 27:case 5:n=i.memoizedProps}t[Ht]=e,t=!!(t.nodeValue===s||n!==null&&n.suppressHydrationWarning===!0||CN(t.nodeValue,s)),t||Gi(e,!0)}else t=vd(t).createTextNode(n),t[Ht]=e,e.stateNode=t}return Xe(e),null;case 31:if(s=e.memoizedState,t===null||t.memoizedState!==null){if(n=er(e),s!==null){if(t===null){if(!n)throw Error(K(318));if(t=e.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(K(557));t[Ht]=e}else Oa(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Xe(e),t=!1}else s=bh(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=s),t=!0;if(!t)return e.flags&256?(ms(e),e):(ms(e),null);if(e.flags&128)throw Error(K(558))}return Xe(e),null;case 13:if(n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(i=er(e),n!==null&&n.dehydrated!==null){if(t===null){if(!i)throw Error(K(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(K(317));i[Ht]=e}else Oa(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Xe(e),i=!1}else i=bh(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=i),i=!0;if(!i)return e.flags&256?(ms(e),e):(ms(e),null)}return ms(e),e.flags&128?(e.lanes=s,e):(s=n!==null,t=t!==null&&t.memoizedState!==null,s&&(n=e.child,i=null,n.alternate!==null&&n.alternate.memoizedState!==null&&n.alternate.memoizedState.cachePool!==null&&(i=n.alternate.memoizedState.cachePool.pool),a=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(a=n.memoizedState.cachePool.pool),a!==i&&(n.flags|=2048)),s!==t&&s&&(e.child.flags|=8192),cu(e,e.updateQueue),Xe(e),null);case 4:return Gr(),t===null&&gg(e.stateNode.containerInfo),Xe(e),null;case 10:return Pn(e.type),Xe(e),null;case 19:if(Dt(mt),n=e.memoizedState,n===null)return Xe(e),null;if(i=(e.flags&128)!==0,a=n.rendering,a===null)if(i)$l(n,!1);else{if(ft!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=ld(t),a!==null){for(e.flags|=128,$l(n,!1),t=a.updateQueue,e.updateQueue=t,cu(e,t),e.subtreeFlags=0,t=s,s=e.child;s!==null;)Kw(s,t),s=s.sibling;return We(mt,mt.current&1|2),Se&&jn(e,n.treeForkCount),e.child}t=t.sibling}n.tail!==null&&bs()>hd&&(e.flags|=128,i=!0,$l(n,!1),e.lanes=4194304)}else{if(!i)if(t=ld(a),t!==null){if(e.flags|=128,i=!0,t=t.updateQueue,e.updateQueue=t,cu(e,t),$l(n,!0),n.tail===null&&n.tailMode==="hidden"&&!a.alternate&&!Se)return Xe(e),null}else 2*bs()-n.renderingStartTime>hd&&s!==536870912&&(e.flags|=128,i=!0,$l(n,!1),e.lanes=4194304);n.isBackwards?(a.sibling=e.child,e.child=a):(t=n.last,t!==null?t.sibling=a:e.child=a,n.last=a)}return n.tail!==null?(t=n.tail,n.rendering=t,n.tail=t.sibling,n.renderingStartTime=bs(),t.sibling=null,s=mt.current,We(mt,i?s&1|2:s&1),Se&&jn(e,n.treeForkCount),t):(Xe(e),null);case 22:case 23:return ms(e),Wp(),n=e.memoizedState!==null,t!==null?t.memoizedState!==null!==n&&(e.flags|=8192):n&&(e.flags|=8192),n?s&536870912&&!(e.flags&128)&&(Xe(e),e.subtreeFlags&6&&(e.flags|=8192)):Xe(e),s=e.updateQueue,s!==null&&cu(e,s.retryQueue),s=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(s=t.memoizedState.cachePool.pool),n=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),n!==s&&(e.flags|=2048),t!==null&&Dt(Sa),null;case 24:return s=null,t!==null&&(s=t.memoizedState.cache),e.memoizedState.cache!==s&&(e.flags|=2048),Pn(yt),Xe(e),null;case 25:return null;case 30:return null}throw Error(K(156,e.tag))}function MA(t,e){switch(Fp(e),e.tag){case 1:return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Pn(yt),Gr(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 26:case 27:case 5:return Ju(e),null;case 31:if(e.memoizedState!==null){if(ms(e),e.alternate===null)throw Error(K(340));Oa()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 13:if(ms(e),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(K(340));Oa()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Dt(mt),null;case 4:return Gr(),null;case 10:return Pn(e.type),null;case 22:case 23:return ms(e),Wp(),t!==null&&Dt(Sa),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 24:return Pn(yt),null;case 25:return null;default:return null}}function Kk(t,e){switch(Fp(e),e.tag){case 3:Pn(yt),Gr();break;case 26:case 27:case 5:Ju(e);break;case 4:Gr();break;case 31:e.memoizedState!==null&&ms(e);break;case 13:ms(e);break;case 19:Dt(mt);break;case 10:Pn(e.type);break;case 22:case 23:ms(e),Wp(),t!==null&&Dt(Sa);break;case 24:Pn(yt)}}function Nc(t,e){try{var s=e.updateQueue,n=s!==null?s.lastEffect:null;if(n!==null){var i=n.next;s=i;do{if((s.tag&t)===t){n=void 0;var a=s.create,l=s.inst;n=a(),l.destroy=n}s=s.next}while(s!==i)}}catch(o){Le(e,e.return,o)}}function Fi(t,e,s){try{var n=e.updateQueue,i=n!==null?n.lastEffect:null;if(i!==null){var a=i.next;n=a;do{if((n.tag&t)===t){var l=n.inst,o=l.destroy;if(o!==void 0){l.destroy=void 0,i=e;var c=s,u=o;try{u()}catch(d){Le(i,c,d)}}}n=n.next}while(n!==a)}}catch(d){Le(e,e.return,d)}}function Yk(t){var e=t.updateQueue;if(e!==null){var s=t.stateNode;try{sk(e,s)}catch(n){Le(t,t.return,n)}}}function Wk(t,e,s){s.props=Pa(t.type,t.memoizedProps),s.state=t.memoizedState;try{s.componentWillUnmount()}catch(n){Le(t,e,n)}}function mo(t,e){try{var s=t.ref;if(s!==null){switch(t.tag){case 26:case 27:case 5:var n=t.stateNode;break;case 30:n=t.stateNode;break;default:n=t.stateNode}typeof s=="function"?t.refCleanup=s(n):s.current=n}}catch(i){Le(t,e,i)}}function on(t,e){var s=t.ref,n=t.refCleanup;if(s!==null)if(typeof n=="function")try{n()}catch(i){Le(t,e,i)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof s=="function")try{s(null)}catch(i){Le(t,e,i)}else s.current=null}function qk(t){var e=t.type,s=t.memoizedProps,n=t.stateNode;try{e:switch(e){case"button":case"input":case"select":case"textarea":s.autoFocus&&n.focus();break e;case"img":s.src?n.src=s.src:s.srcSet&&(n.srcset=s.srcSet)}}catch(i){Le(t,t.return,i)}}function Th(t,e,s){try{var n=t.stateNode;sR(n,t.type,s,e),n[us]=e}catch(i){Le(t,t.return,i)}}function Xk(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&sa(t.type)||t.tag===4}function Ah(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Xk(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&sa(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function t0(t,e,s){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s).insertBefore(t,e):(e=s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,e.appendChild(t),s=s._reactRootContainer,s!=null||e.onclick!==null||(e.onclick=Rn));else if(n!==4&&(n===27&&sa(t.type)&&(s=t.stateNode,e=null),t=t.child,t!==null))for(t0(t,e,s),t=t.sibling;t!==null;)t0(t,e,s),t=t.sibling}function fd(t,e,s){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?s.insertBefore(t,e):s.appendChild(t);else if(n!==4&&(n===27&&sa(t.type)&&(s=t.stateNode),t=t.child,t!==null))for(fd(t,e,s),t=t.sibling;t!==null;)fd(t,e,s),t=t.sibling}function Qk(t){var e=t.stateNode,s=t.memoizedProps;try{for(var n=t.type,i=e.attributes;i.length;)e.removeAttributeNode(i[0]);Vt(e,n,s),e[Ht]=t,e[us]=s}catch(a){Le(t,t.return,a)}}var Tn=!1,vt=!1,Rh=!1,dv=typeof WeakSet=="function"?WeakSet:Set,Ct=null;function DA(t,e){if(t=t.containerInfo,o0=kd,t=Bw(t),Bp(t)){if("selectionStart"in t)var s={start:t.selectionStart,end:t.selectionEnd};else e:{s=(s=t.ownerDocument)&&s.defaultView||window;var n=s.getSelection&&s.getSelection();if(n&&n.rangeCount!==0){s=n.anchorNode;var i=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{s.nodeType,a.nodeType}catch{s=null;break e}var l=0,o=-1,c=-1,u=0,d=0,f=t,h=null;t:for(;;){for(var m;f!==s||i!==0&&f.nodeType!==3||(o=l+i),f!==a||n!==0&&f.nodeType!==3||(c=l+n),f.nodeType===3&&(l+=f.nodeValue.length),(m=f.firstChild)!==null;)h=f,f=m;for(;;){if(f===t)break t;if(h===s&&++u===i&&(o=l),h===a&&++d===n&&(c=l),(m=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=m}s=o===-1||c===-1?null:{start:o,end:c}}else s=null}s=s||{start:0,end:0}}else s=null;for(c0={focusedElem:t,selectionRange:s},kd=!1,Ct=e;Ct!==null;)if(e=Ct,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ct=t;else for(;Ct!==null;){switch(e=Ct,a=e.alternate,t=e.flags,e.tag){case 0:if(t&4&&(t=e.updateQueue,t=t!==null?t.events:null,t!==null))for(s=0;s<t.length;s++)i=t[s],i.ref.impl=i.nextImpl;break;case 11:case 15:break;case 1:if(t&1024&&a!==null){t=void 0,s=e,i=a.memoizedProps,a=a.memoizedState,n=s.stateNode;try{var v=Pa(s.type,i);t=n.getSnapshotBeforeUpdate(v,a),n.__reactInternalSnapshotBeforeUpdate=t}catch(x){Le(s,s.return,x)}}break;case 3:if(t&1024){if(t=e.stateNode.containerInfo,s=t.nodeType,s===9)d0(t);else if(s===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":d0(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(t&1024)throw Error(K(163))}if(t=e.sibling,t!==null){t.return=e.return,Ct=t;break}Ct=e.return}}function Jk(t,e,s){var n=s.flags;switch(s.tag){case 0:case 11:case 15:Nn(t,s),n&4&&Nc(5,s);break;case 1:if(Nn(t,s),n&4)if(t=s.stateNode,e===null)try{t.componentDidMount()}catch(l){Le(s,s.return,l)}else{var i=Pa(s.type,e.memoizedProps);e=e.memoizedState;try{t.componentDidUpdate(i,e,t.__reactInternalSnapshotBeforeUpdate)}catch(l){Le(s,s.return,l)}}n&64&&Yk(s),n&512&&mo(s,s.return);break;case 3:if(Nn(t,s),n&64&&(t=s.updateQueue,t!==null)){if(e=null,s.child!==null)switch(s.child.tag){case 27:case 5:e=s.child.stateNode;break;case 1:e=s.child.stateNode}try{sk(t,e)}catch(l){Le(s,s.return,l)}}break;case 27:e===null&&n&4&&Qk(s);case 26:case 5:Nn(t,s),e===null&&n&4&&qk(s),n&512&&mo(s,s.return);break;case 12:Nn(t,s);break;case 31:Nn(t,s),n&4&&tN(t,s);break;case 13:Nn(t,s),n&4&&sN(t,s),n&64&&(t=s.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(s=VA.bind(null,s),uR(t,s))));break;case 22:if(n=s.memoizedState!==null||Tn,!n){e=e!==null&&e.memoizedState!==null||vt,i=Tn;var a=vt;Tn=n,(vt=e)&&!a?En(t,s,(s.subtreeFlags&8772)!==0):Nn(t,s),Tn=i,vt=a}break;case 30:break;default:Nn(t,s)}}function Zk(t){var e=t.alternate;e!==null&&(t.alternate=null,Zk(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&Ip(e)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var tt=null,is=!1;function kn(t,e,s){for(s=s.child;s!==null;)eN(t,e,s),s=s.sibling}function eN(t,e,s){if(vs&&typeof vs.onCommitFiberUnmount=="function")try{vs.onCommitFiberUnmount(xc,s)}catch{}switch(s.tag){case 26:vt||on(s,e),kn(t,e,s),s.memoizedState?s.memoizedState.count--:s.stateNode&&(s=s.stateNode,s.parentNode.removeChild(s));break;case 27:vt||on(s,e);var n=tt,i=is;sa(s.type)&&(tt=s.stateNode,is=!1),kn(t,e,s),bo(s.stateNode),tt=n,is=i;break;case 5:vt||on(s,e);case 6:if(n=tt,i=is,tt=null,kn(t,e,s),tt=n,is=i,tt!==null)if(is)try{(tt.nodeType===9?tt.body:tt.nodeName==="HTML"?tt.ownerDocument.body:tt).removeChild(s.stateNode)}catch(a){Le(s,e,a)}else try{tt.removeChild(s.stateNode)}catch(a){Le(s,e,a)}break;case 18:tt!==null&&(is?(t=tt,Nv(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,s.stateNode),Jr(t)):Nv(tt,s.stateNode));break;case 4:n=tt,i=is,tt=s.stateNode.containerInfo,is=!0,kn(t,e,s),tt=n,is=i;break;case 0:case 11:case 14:case 15:Fi(2,s,e),vt||Fi(4,s,e),kn(t,e,s);break;case 1:vt||(on(s,e),n=s.stateNode,typeof n.componentWillUnmount=="function"&&Wk(s,e,n)),kn(t,e,s);break;case 21:kn(t,e,s);break;case 22:vt=(n=vt)||s.memoizedState!==null,kn(t,e,s),vt=n;break;default:kn(t,e,s)}}function tN(t,e){if(e.memoizedState===null&&(t=e.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{Jr(t)}catch(s){Le(e,e.return,s)}}}function sN(t,e){if(e.memoizedState===null&&(t=e.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{Jr(t)}catch(s){Le(e,e.return,s)}}function LA(t){switch(t.tag){case 31:case 13:case 19:var e=t.stateNode;return e===null&&(e=t.stateNode=new dv),e;case 22:return t=t.stateNode,e=t._retryCache,e===null&&(e=t._retryCache=new dv),e;default:throw Error(K(435,t.tag))}}function uu(t,e){var s=LA(t);e.forEach(function(n){if(!s.has(n)){s.add(n);var i=zA.bind(null,t,n);n.then(i,i)}})}function ss(t,e){var s=e.deletions;if(s!==null)for(var n=0;n<s.length;n++){var i=s[n],a=t,l=e,o=l;e:for(;o!==null;){switch(o.tag){case 27:if(sa(o.type)){tt=o.stateNode,is=!1;break e}break;case 5:tt=o.stateNode,is=!1;break e;case 3:case 4:tt=o.stateNode.containerInfo,is=!0;break e}o=o.return}if(tt===null)throw Error(K(160));eN(a,l,i),tt=null,is=!1,a=i.alternate,a!==null&&(a.return=null),i.return=null}if(e.subtreeFlags&13886)for(e=e.child;e!==null;)nN(e,t),e=e.sibling}var Ws=null;function nN(t,e){var s=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:ss(e,t),ns(t),n&4&&(Fi(3,t,t.return),Nc(3,t),Fi(5,t,t.return));break;case 1:ss(e,t),ns(t),n&512&&(vt||s===null||on(s,s.return)),n&64&&Tn&&(t=t.updateQueue,t!==null&&(n=t.callbacks,n!==null&&(s=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=s===null?n:s.concat(n))));break;case 26:var i=Ws;if(ss(e,t),ns(t),n&512&&(vt||s===null||on(s,s.return)),n&4){var a=s!==null?s.memoizedState:null;if(n=t.memoizedState,s===null)if(n===null)if(t.stateNode===null){e:{n=t.type,s=t.memoizedProps,i=i.ownerDocument||i;t:switch(n){case"title":a=i.getElementsByTagName("title")[0],(!a||a[yc]||a[Ht]||a.namespaceURI==="http://www.w3.org/2000/svg"||a.hasAttribute("itemprop"))&&(a=i.createElement(n),i.head.insertBefore(a,i.querySelector("head > title"))),Vt(a,n,s),a[Ht]=t,Ot(a),n=a;break e;case"link":var l=Cv("link","href",i).get(n+(s.href||""));if(l){for(var o=0;o<l.length;o++)if(a=l[o],a.getAttribute("href")===(s.href==null||s.href===""?null:s.href)&&a.getAttribute("rel")===(s.rel==null?null:s.rel)&&a.getAttribute("title")===(s.title==null?null:s.title)&&a.getAttribute("crossorigin")===(s.crossOrigin==null?null:s.crossOrigin)){l.splice(o,1);break t}}a=i.createElement(n),Vt(a,n,s),i.head.appendChild(a);break;case"meta":if(l=Cv("meta","content",i).get(n+(s.content||""))){for(o=0;o<l.length;o++)if(a=l[o],a.getAttribute("content")===(s.content==null?null:""+s.content)&&a.getAttribute("name")===(s.name==null?null:s.name)&&a.getAttribute("property")===(s.property==null?null:s.property)&&a.getAttribute("http-equiv")===(s.httpEquiv==null?null:s.httpEquiv)&&a.getAttribute("charset")===(s.charSet==null?null:s.charSet)){l.splice(o,1);break t}}a=i.createElement(n),Vt(a,n,s),i.head.appendChild(a);break;default:throw Error(K(468,n))}a[Ht]=t,Ot(a),n=a}t.stateNode=n}else Iv(i,t.type,t.stateNode);else t.stateNode=Rv(i,n,t.memoizedProps);else a!==n?(a===null?s.stateNode!==null&&(s=s.stateNode,s.parentNode.removeChild(s)):a.count--,n===null?Iv(i,t.type,t.stateNode):Rv(i,n,t.memoizedProps)):n===null&&t.stateNode!==null&&Th(t,t.memoizedProps,s.memoizedProps)}break;case 27:ss(e,t),ns(t),n&512&&(vt||s===null||on(s,s.return)),s!==null&&n&4&&Th(t,t.memoizedProps,s.memoizedProps);break;case 5:if(ss(e,t),ns(t),n&512&&(vt||s===null||on(s,s.return)),t.flags&32){i=t.stateNode;try{Vr(i,"")}catch(v){Le(t,t.return,v)}}n&4&&t.stateNode!=null&&(i=t.memoizedProps,Th(t,i,s!==null?s.memoizedProps:i)),n&1024&&(Rh=!0);break;case 6:if(ss(e,t),ns(t),n&4){if(t.stateNode===null)throw Error(K(162));n=t.memoizedProps,s=t.stateNode;try{s.nodeValue=n}catch(v){Le(t,t.return,v)}}break;case 3:if(Bu=null,i=Ws,Ws=yd(e.containerInfo),ss(e,t),Ws=i,ns(t),n&4&&s!==null&&s.memoizedState.isDehydrated)try{Jr(e.containerInfo)}catch(v){Le(t,t.return,v)}Rh&&(Rh=!1,iN(t));break;case 4:n=Ws,Ws=yd(t.stateNode.containerInfo),ss(e,t),ns(t),Ws=n;break;case 12:ss(e,t),ns(t);break;case 31:ss(e,t),ns(t),n&4&&(n=t.updateQueue,n!==null&&(t.updateQueue=null,uu(t,n)));break;case 13:ss(e,t),ns(t),t.child.flags&8192&&t.memoizedState!==null!=(s!==null&&s.memoizedState!==null)&&(wf=bs()),n&4&&(n=t.updateQueue,n!==null&&(t.updateQueue=null,uu(t,n)));break;case 22:i=t.memoizedState!==null;var c=s!==null&&s.memoizedState!==null,u=Tn,d=vt;if(Tn=u||i,vt=d||c,ss(e,t),vt=d,Tn=u,ns(t),n&8192)e:for(e=t.stateNode,e._visibility=i?e._visibility&-2:e._visibility|1,i&&(s===null||c||Tn||vt||pa(t)),s=null,e=t;;){if(e.tag===5||e.tag===26){if(s===null){c=s=e;try{if(a=c.stateNode,i)l=a.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none";else{o=c.stateNode;var f=c.memoizedProps.style,h=f!=null&&f.hasOwnProperty("display")?f.display:null;o.style.display=h==null||typeof h=="boolean"?"":(""+h).trim()}}catch(v){Le(c,c.return,v)}}}else if(e.tag===6){if(s===null){c=e;try{c.stateNode.nodeValue=i?"":c.memoizedProps}catch(v){Le(c,c.return,v)}}}else if(e.tag===18){if(s===null){c=e;try{var m=c.stateNode;i?Sv(m,!0):Sv(c.stateNode,!1)}catch(v){Le(c,c.return,v)}}}else if((e.tag!==22&&e.tag!==23||e.memoizedState===null||e===t)&&e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;s===e&&(s=null),e=e.return}s===e&&(s=null),e.sibling.return=e.return,e=e.sibling}n&4&&(n=t.updateQueue,n!==null&&(s=n.retryQueue,s!==null&&(n.retryQueue=null,uu(t,s))));break;case 19:ss(e,t),ns(t),n&4&&(n=t.updateQueue,n!==null&&(t.updateQueue=null,uu(t,n)));break;case 30:break;case 21:break;default:ss(e,t),ns(t)}}function ns(t){var e=t.flags;if(e&2){try{for(var s,n=t.return;n!==null;){if(Xk(n)){s=n;break}n=n.return}if(s==null)throw Error(K(160));switch(s.tag){case 27:var i=s.stateNode,a=Ah(t);fd(t,a,i);break;case 5:var l=s.stateNode;s.flags&32&&(Vr(l,""),s.flags&=-33);var o=Ah(t);fd(t,o,l);break;case 3:case 4:var c=s.stateNode.containerInfo,u=Ah(t);t0(t,u,c);break;default:throw Error(K(161))}}catch(d){Le(t,t.return,d)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function iN(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var e=t;iN(e),e.tag===5&&e.flags&1024&&e.stateNode.reset(),t=t.sibling}}function Nn(t,e){if(e.subtreeFlags&8772)for(e=e.child;e!==null;)Jk(t,e.alternate,e),e=e.sibling}function pa(t){for(t=t.child;t!==null;){var e=t;switch(e.tag){case 0:case 11:case 14:case 15:Fi(4,e,e.return),pa(e);break;case 1:on(e,e.return);var s=e.stateNode;typeof s.componentWillUnmount=="function"&&Wk(e,e.return,s),pa(e);break;case 27:bo(e.stateNode);case 26:case 5:on(e,e.return),pa(e);break;case 22:e.memoizedState===null&&pa(e);break;case 30:pa(e);break;default:pa(e)}t=t.sibling}}function En(t,e,s){for(s=s&&(e.subtreeFlags&8772)!==0,e=e.child;e!==null;){var n=e.alternate,i=t,a=e,l=a.flags;switch(a.tag){case 0:case 11:case 15:En(i,a,s),Nc(4,a);break;case 1:if(En(i,a,s),n=a,i=n.stateNode,typeof i.componentDidMount=="function")try{i.componentDidMount()}catch(u){Le(n,n.return,u)}if(n=a,i=n.updateQueue,i!==null){var o=n.stateNode;try{var c=i.shared.hiddenCallbacks;if(c!==null)for(i.shared.hiddenCallbacks=null,i=0;i<c.length;i++)tk(c[i],o)}catch(u){Le(n,n.return,u)}}s&&l&64&&Yk(a),mo(a,a.return);break;case 27:Qk(a);case 26:case 5:En(i,a,s),s&&n===null&&l&4&&qk(a),mo(a,a.return);break;case 12:En(i,a,s);break;case 31:En(i,a,s),s&&l&4&&tN(i,a);break;case 13:En(i,a,s),s&&l&4&&sN(i,a);break;case 22:a.memoizedState===null&&En(i,a,s),mo(a,a.return);break;case 30:break;default:En(i,a,s)}e=e.sibling}}function ug(t,e){var s=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(s=t.memoizedState.cachePool.pool),t=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(t=e.memoizedState.cachePool.pool),t!==s&&(t!=null&&t.refCount++,s!=null&&wc(s))}function dg(t,e){t=null,e.alternate!==null&&(t=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==t&&(e.refCount++,t!=null&&wc(t))}function Vs(t,e,s,n){if(e.subtreeFlags&10256)for(e=e.child;e!==null;)aN(t,e,s,n),e=e.sibling}function aN(t,e,s,n){var i=e.flags;switch(e.tag){case 0:case 11:case 15:Vs(t,e,s,n),i&2048&&Nc(9,e);break;case 1:Vs(t,e,s,n);break;case 3:Vs(t,e,s,n),i&2048&&(t=null,e.alternate!==null&&(t=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==t&&(e.refCount++,t!=null&&wc(t)));break;case 12:if(i&2048){Vs(t,e,s,n),t=e.stateNode;try{var a=e.memoizedProps,l=a.id,o=a.onPostCommit;typeof o=="function"&&o(l,e.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(c){Le(e,e.return,c)}}else Vs(t,e,s,n);break;case 31:Vs(t,e,s,n);break;case 13:Vs(t,e,s,n);break;case 23:break;case 22:a=e.stateNode,l=e.alternate,e.memoizedState!==null?a._visibility&2?Vs(t,e,s,n):po(t,e):a._visibility&2?Vs(t,e,s,n):(a._visibility|=2,rr(t,e,s,n,(e.subtreeFlags&10256)!==0||!1)),i&2048&&ug(l,e);break;case 24:Vs(t,e,s,n),i&2048&&dg(e.alternate,e);break;default:Vs(t,e,s,n)}}function rr(t,e,s,n,i){for(i=i&&((e.subtreeFlags&10256)!==0||!1),e=e.child;e!==null;){var a=t,l=e,o=s,c=n,u=l.flags;switch(l.tag){case 0:case 11:case 15:rr(a,l,o,c,i),Nc(8,l);break;case 23:break;case 22:var d=l.stateNode;l.memoizedState!==null?d._visibility&2?rr(a,l,o,c,i):po(a,l):(d._visibility|=2,rr(a,l,o,c,i)),i&&u&2048&&ug(l.alternate,l);break;case 24:rr(a,l,o,c,i),i&&u&2048&&dg(l.alternate,l);break;default:rr(a,l,o,c,i)}e=e.sibling}}function po(t,e){if(e.subtreeFlags&10256)for(e=e.child;e!==null;){var s=t,n=e,i=n.flags;switch(n.tag){case 22:po(s,n),i&2048&&ug(n.alternate,n);break;case 24:po(s,n),i&2048&&dg(n.alternate,n);break;default:po(s,n)}e=e.sibling}}var Zl=8192;function tr(t,e,s){if(t.subtreeFlags&Zl)for(t=t.child;t!==null;)rN(t,e,s),t=t.sibling}function rN(t,e,s){switch(t.tag){case 26:tr(t,e,s),t.flags&Zl&&t.memoizedState!==null&&wR(s,Ws,t.memoizedState,t.memoizedProps);break;case 5:tr(t,e,s);break;case 3:case 4:var n=Ws;Ws=yd(t.stateNode.containerInfo),tr(t,e,s),Ws=n;break;case 22:t.memoizedState===null&&(n=t.alternate,n!==null&&n.memoizedState!==null?(n=Zl,Zl=16777216,tr(t,e,s),Zl=n):tr(t,e,s));break;default:tr(t,e,s)}}function lN(t){var e=t.alternate;if(e!==null&&(t=e.child,t!==null)){e.child=null;do e=t.sibling,t.sibling=null,t=e;while(t!==null)}}function Gl(t){var e=t.deletions;if(t.flags&16){if(e!==null)for(var s=0;s<e.length;s++){var n=e[s];Ct=n,cN(n,t)}lN(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)oN(t),t=t.sibling}function oN(t){switch(t.tag){case 0:case 11:case 15:Gl(t),t.flags&2048&&Fi(9,t,t.return);break;case 3:Gl(t);break;case 12:Gl(t);break;case 22:var e=t.stateNode;t.memoizedState!==null&&e._visibility&2&&(t.return===null||t.return.tag!==13)?(e._visibility&=-3,Lu(t)):Gl(t);break;default:Gl(t)}}function Lu(t){var e=t.deletions;if(t.flags&16){if(e!==null)for(var s=0;s<e.length;s++){var n=e[s];Ct=n,cN(n,t)}lN(t)}for(t=t.child;t!==null;){switch(e=t,e.tag){case 0:case 11:case 15:Fi(8,e,e.return),Lu(e);break;case 22:s=e.stateNode,s._visibility&2&&(s._visibility&=-3,Lu(e));break;default:Lu(e)}t=t.sibling}}function cN(t,e){for(;Ct!==null;){var s=Ct;switch(s.tag){case 0:case 11:case 15:Fi(8,s,e);break;case 23:case 22:if(s.memoizedState!==null&&s.memoizedState.cachePool!==null){var n=s.memoizedState.cachePool.pool;n!=null&&n.refCount++}break;case 24:wc(s.memoizedState.cache)}if(n=s.child,n!==null)n.return=s,Ct=n;else e:for(s=t;Ct!==null;){n=Ct;var i=n.sibling,a=n.return;if(Zk(n),n===s){Ct=null;break e}if(i!==null){i.return=a,Ct=i;break e}Ct=a}}}var PA={getCacheForType:function(t){var e=Ft(yt),s=e.data.get(t);return s===void 0&&(s=t(),e.data.set(t,s)),s},cacheSignal:function(){return Ft(yt).controller.signal}},BA=typeof WeakMap=="function"?WeakMap:Map,Re=0,Ke=null,we=null,ke=0,De=0,hs=null,bi=!1,xl=!1,fg=!1,zn=0,ft=0,Vi=0,ja=0,hg=0,xs=0,Wr=0,go=null,as=null,s0=!1,wf=0,uN=0,hd=1/0,md=null,Ai=null,jt=0,Ri=null,qr=null,Bn=0,n0=0,i0=null,dN=null,xo=0,a0=null;function _s(){return Re&2&&ke!==0?ke&-ke:ce.T!==null?pg():yw()}function fN(){if(xs===0)if(!(ke&536870912)||Se){var t=su;su<<=1,!(su&3932160)&&(su=262144),xs=t}else xs=536870912;return t=ks.current,t!==null&&(t.flags|=32),xs}function os(t,e,s){(t===Ke&&(De===2||De===9)||t.cancelPendingCommit!==null)&&(Xr(t,0),vi(t,ke,xs,!1)),vc(t,s),(!(Re&2)||t!==Ke)&&(t===Ke&&(!(Re&2)&&(ja|=s),ft===4&&vi(t,ke,xs,!1)),xn(t))}function hN(t,e,s){if(Re&6)throw Error(K(327));var n=!s&&(e&127)===0&&(e&t.expiredLanes)===0||bc(t,e),i=n?$A(t,e):Ch(t,e,!0),a=n;do{if(i===0){xl&&!n&&vi(t,e,0,!1);break}else{if(s=t.current.alternate,a&&!UA(s)){i=Ch(t,e,!1),a=!1;continue}if(i===2){if(a=e,t.errorRecoveryDisabledLanes&a)var l=0;else l=t.pendingLanes&-536870913,l=l!==0?l:l&536870912?536870912:0;if(l!==0){e=l;e:{var o=t;i=go;var c=o.current.memoizedState.isDehydrated;if(c&&(Xr(o,l).flags|=256),l=Ch(o,l,!1),l!==2){if(fg&&!c){o.errorRecoveryDisabledLanes|=a,ja|=a,i=4;break e}a=as,as=i,a!==null&&(as===null?as=a:as.push.apply(as,a))}i=l}if(a=!1,i!==2)continue}}if(i===1){Xr(t,0),vi(t,e,0,!0);break}e:{switch(n=t,a=i,a){case 0:case 1:throw Error(K(345));case 4:if((e&4194048)!==e)break;case 6:vi(n,e,xs,!bi);break e;case 2:as=null;break;case 3:case 5:break;default:throw Error(K(329))}if((e&62914560)===e&&(i=wf+300-bs(),10<i)){if(vi(n,e,xs,!bi),df(n,0,!0)!==0)break e;Bn=e,n.timeoutHandle=ON(fv.bind(null,n,s,as,md,s0,e,xs,ja,Wr,bi,a,"Throttled",-0,0),i);break e}fv(n,s,as,md,s0,e,xs,ja,Wr,bi,a,null,-0,0)}}break}while(!0);xn(t)}function fv(t,e,s,n,i,a,l,o,c,u,d,f,h,m){if(t.timeoutHandle=-1,f=e.subtreeFlags,f&8192||(f&16785408)===16785408){f={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Rn},rN(e,a,f);var v=(a&62914560)===a?wf-bs():(a&4194048)===a?uN-bs():0;if(v=kR(f,v),v!==null){Bn=a,t.cancelPendingCommit=v(mv.bind(null,t,e,a,s,n,i,l,o,c,d,f,null,h,m)),vi(t,a,l,!u);return}}mv(t,e,a,s,n,i,l,o,c)}function UA(t){for(var e=t;;){var s=e.tag;if((s===0||s===11||s===15)&&e.flags&16384&&(s=e.updateQueue,s!==null&&(s=s.stores,s!==null)))for(var n=0;n<s.length;n++){var i=s[n],a=i.getSnapshot;i=i.value;try{if(!ws(a(),i))return!1}catch{return!1}}if(s=e.child,e.subtreeFlags&16384&&s!==null)s.return=e,e=s;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function vi(t,e,s,n){e&=~hg,e&=~ja,t.suspendedLanes|=e,t.pingedLanes&=~e,n&&(t.warmLanes|=e),n=t.expirationTimes;for(var i=e;0<i;){var a=31-ys(i),l=1<<a;n[a]=-1,i&=~l}s!==0&&xw(t,s,e)}function kf(){return Re&6?!0:(Sc(0),!1)}function mg(){if(we!==null){if(De===0)var t=we.return;else t=we,Cn=qa=null,Zp(t),Ir=null,Po=0,t=we;for(;t!==null;)Kk(t.alternate,t),t=t.return;we=null}}function Xr(t,e){var s=t.timeoutHandle;s!==-1&&(t.timeoutHandle=-1,aR(s)),s=t.cancelPendingCommit,s!==null&&(t.cancelPendingCommit=null,s()),Bn=0,mg(),Ke=t,we=s=Ln(t.current,null),ke=e,De=0,hs=null,bi=!1,xl=bc(t,e),fg=!1,Wr=xs=hg=ja=Vi=ft=0,as=go=null,s0=!1,e&8&&(e|=e&32);var n=t.entangledLanes;if(n!==0)for(t=t.entanglements,n&=e;0<n;){var i=31-ys(n),a=1<<i;e|=t[i],n&=~a}return zn=e,pf(),s}function mN(t,e){pe=null,ce.H=Uo,e===gl||e===xf?(e=Vb(),De=3):e===Kp?(e=Vb(),De=4):De=e===og?8:e!==null&&typeof e=="object"&&typeof e.then=="function"?6:1,hs=e,we===null&&(ft=1,ud(t,Os(e,t.current)))}function pN(){var t=ks.current;return t===null?!0:(ke&4194048)===ke?Ps===null:(ke&62914560)===ke||ke&536870912?t===Ps:!1}function gN(){var t=ce.H;return ce.H=Uo,t===null?Uo:t}function xN(){var t=ce.A;return ce.A=PA,t}function pd(){ft=4,bi||(ke&4194048)!==ke&&ks.current!==null||(xl=!0),!(Vi&134217727)&&!(ja&134217727)||Ke===null||vi(Ke,ke,xs,!1)}function Ch(t,e,s){var n=Re;Re|=2;var i=gN(),a=xN();(Ke!==t||ke!==e)&&(md=null,Xr(t,e)),e=!1;var l=ft;e:do try{if(De!==0&&we!==null){var o=we,c=hs;switch(De){case 8:mg(),l=6;break e;case 3:case 2:case 9:case 6:ks.current===null&&(e=!0);var u=De;if(De=0,hs=null,vr(t,o,c,u),s&&xl){l=0;break e}break;default:u=De,De=0,hs=null,vr(t,o,c,u)}}HA(),l=ft;break}catch(d){mN(t,d)}while(!0);return e&&t.shellSuspendCounter++,Cn=qa=null,Re=n,ce.H=i,ce.A=a,we===null&&(Ke=null,ke=0,pf()),l}function HA(){for(;we!==null;)bN(we)}function $A(t,e){var s=Re;Re|=2;var n=gN(),i=xN();Ke!==t||ke!==e?(md=null,hd=bs()+500,Xr(t,e)):xl=bc(t,e);e:do try{if(De!==0&&we!==null){e=we;var a=hs;t:switch(De){case 1:De=0,hs=null,vr(t,e,a,1);break;case 2:case 9:if(Fb(a)){De=0,hs=null,hv(e);break}e=function(){De!==2&&De!==9||Ke!==t||(De=7),xn(t)},a.then(e,e);break e;case 3:De=7;break e;case 4:De=5;break e;case 7:Fb(a)?(De=0,hs=null,hv(e)):(De=0,hs=null,vr(t,e,a,7));break;case 5:var l=null;switch(we.tag){case 26:l=we.memoizedState;case 5:case 27:var o=we;if(l?BN(l):o.stateNode.complete){De=0,hs=null;var c=o.sibling;if(c!==null)we=c;else{var u=o.return;u!==null?(we=u,Nf(u)):we=null}break t}}De=0,hs=null,vr(t,e,a,5);break;case 6:De=0,hs=null,vr(t,e,a,6);break;case 8:mg(),ft=6;break e;default:throw Error(K(462))}}GA();break}catch(d){mN(t,d)}while(!0);return Cn=qa=null,ce.H=n,ce.A=i,Re=s,we!==null?0:(Ke=null,ke=0,pf(),ft)}function GA(){for(;we!==null&&!dT();)bN(we)}function bN(t){var e=zk(t.alternate,t,zn);t.memoizedProps=t.pendingProps,e===null?Nf(t):we=e}function hv(t){var e=t,s=e.alternate;switch(e.tag){case 15:case 0:e=rv(s,e,e.pendingProps,e.type,void 0,ke);break;case 11:e=rv(s,e,e.pendingProps,e.type.render,e.ref,ke);break;case 5:Zp(e);default:Kk(s,e),e=we=Kw(e,zn),e=zk(s,e,zn)}t.memoizedProps=t.pendingProps,e===null?Nf(t):we=e}function vr(t,e,s,n){Cn=qa=null,Zp(e),Ir=null,Po=0;var i=e.return;try{if(RA(t,i,e,s,ke)){ft=1,ud(t,Os(s,t.current)),we=null;return}}catch(a){if(i!==null)throw we=i,a;ft=1,ud(t,Os(s,t.current)),we=null;return}e.flags&32768?(Se||n===1?t=!0:xl||ke&536870912?t=!1:(bi=t=!0,(n===2||n===9||n===3||n===6)&&(n=ks.current,n!==null&&n.tag===13&&(n.flags|=16384))),vN(e,t)):Nf(e)}function Nf(t){var e=t;do{if(e.flags&32768){vN(e,bi);return}t=e.return;var s=OA(e.alternate,e,zn);if(s!==null){we=s;return}if(e=e.sibling,e!==null){we=e;return}we=e=t}while(e!==null);ft===0&&(ft=5)}function vN(t,e){do{var s=MA(t.alternate,t);if(s!==null){s.flags&=32767,we=s;return}if(s=t.return,s!==null&&(s.flags|=32768,s.subtreeFlags=0,s.deletions=null),!e&&(t=t.sibling,t!==null)){we=t;return}we=t=s}while(t!==null);ft=6,we=null}function mv(t,e,s,n,i,a,l,o,c){t.cancelPendingCommit=null;do Sf();while(jt!==0);if(Re&6)throw Error(K(327));if(e!==null){if(e===t.current)throw Error(K(177));if(a=e.lanes|e.childLanes,a|=Up,_T(t,s,a,l,o,c),t===Ke&&(we=Ke=null,ke=0),qr=e,Ri=t,Bn=s,n0=a,i0=i,dN=n,e.subtreeFlags&10256||e.flags&10256?(t.callbackNode=null,t.callbackPriority=0,KA(Zu,function(){return NN(),null})):(t.callbackNode=null,t.callbackPriority=0),n=(e.flags&13878)!==0,e.subtreeFlags&13878||n){n=ce.T,ce.T=null,i=Ce.p,Ce.p=2,l=Re,Re|=4;try{DA(t,e,s)}finally{Re=l,Ce.p=i,ce.T=n}}jt=1,yN(),_N(),wN()}}function yN(){if(jt===1){jt=0;var t=Ri,e=qr,s=(e.flags&13878)!==0;if(e.subtreeFlags&13878||s){s=ce.T,ce.T=null;var n=Ce.p;Ce.p=2;var i=Re;Re|=4;try{nN(e,t);var a=c0,l=Bw(t.containerInfo),o=a.focusedElem,c=a.selectionRange;if(l!==o&&o&&o.ownerDocument&&Pw(o.ownerDocument.documentElement,o)){if(c!==null&&Bp(o)){var u=c.start,d=c.end;if(d===void 0&&(d=u),"selectionStart"in o)o.selectionStart=u,o.selectionEnd=Math.min(d,o.value.length);else{var f=o.ownerDocument||document,h=f&&f.defaultView||window;if(h.getSelection){var m=h.getSelection(),v=o.textContent.length,x=Math.min(c.start,v),b=c.end===void 0?x:Math.min(c.end,v);!m.extend&&x>b&&(l=b,b=x,x=l);var g=Lb(o,x),p=Lb(o,b);if(g&&p&&(m.rangeCount!==1||m.anchorNode!==g.node||m.anchorOffset!==g.offset||m.focusNode!==p.node||m.focusOffset!==p.offset)){var y=f.createRange();y.setStart(g.node,g.offset),m.removeAllRanges(),x>b?(m.addRange(y),m.extend(p.node,p.offset)):(y.setEnd(p.node,p.offset),m.addRange(y))}}}}for(f=[],m=o;m=m.parentNode;)m.nodeType===1&&f.push({element:m,left:m.scrollLeft,top:m.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<f.length;o++){var k=f[o];k.element.scrollLeft=k.left,k.element.scrollTop=k.top}}kd=!!o0,c0=o0=null}finally{Re=i,Ce.p=n,ce.T=s}}t.current=e,jt=2}}function _N(){if(jt===2){jt=0;var t=Ri,e=qr,s=(e.flags&8772)!==0;if(e.subtreeFlags&8772||s){s=ce.T,ce.T=null;var n=Ce.p;Ce.p=2;var i=Re;Re|=4;try{Jk(t,e.alternate,e)}finally{Re=i,Ce.p=n,ce.T=s}}jt=3}}function wN(){if(jt===4||jt===3){jt=0,fT();var t=Ri,e=qr,s=Bn,n=dN;e.subtreeFlags&10256||e.flags&10256?jt=5:(jt=0,qr=Ri=null,kN(t,t.pendingLanes));var i=t.pendingLanes;if(i===0&&(Ai=null),Cp(s),e=e.stateNode,vs&&typeof vs.onCommitFiberRoot=="function")try{vs.onCommitFiberRoot(xc,e,void 0,(e.current.flags&128)===128)}catch{}if(n!==null){e=ce.T,i=Ce.p,Ce.p=2,ce.T=null;try{for(var a=t.onRecoverableError,l=0;l<n.length;l++){var o=n[l];a(o.value,{componentStack:o.stack})}}finally{ce.T=e,Ce.p=i}}Bn&3&&Sf(),xn(t),i=t.pendingLanes,s&261930&&i&42?t===a0?xo++:(xo=0,a0=t):xo=0,Sc(0)}}function kN(t,e){(t.pooledCacheLanes&=e)===0&&(e=t.pooledCache,e!=null&&(t.pooledCache=null,wc(e)))}function Sf(){return yN(),_N(),wN(),NN()}function NN(){if(jt!==5)return!1;var t=Ri,e=n0;n0=0;var s=Cp(Bn),n=ce.T,i=Ce.p;try{Ce.p=32>s?32:s,ce.T=null,s=i0,i0=null;var a=Ri,l=Bn;if(jt=0,qr=Ri=null,Bn=0,Re&6)throw Error(K(331));var o=Re;if(Re|=4,oN(a.current),aN(a,a.current,l,s),Re=o,Sc(0,!1),vs&&typeof vs.onPostCommitFiberRoot=="function")try{vs.onPostCommitFiberRoot(xc,a)}catch{}return!0}finally{Ce.p=i,ce.T=n,kN(t,e)}}function pv(t,e,s){e=Os(s,e),e=Jm(t.stateNode,e,2),t=Ti(t,e,2),t!==null&&(vc(t,2),xn(t))}function Le(t,e,s){if(t.tag===3)pv(t,t,s);else for(;e!==null;){if(e.tag===3){pv(e,t,s);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ai===null||!Ai.has(n))){t=Os(s,t),s=Uk(2),n=Ti(e,s,2),n!==null&&(Hk(s,n,e,t),vc(n,2),xn(n));break}}e=e.return}}function Ih(t,e,s){var n=t.pingCache;if(n===null){n=t.pingCache=new BA;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(s)||(fg=!0,i.add(s),t=FA.bind(null,t,e,s),e.then(t,t))}function FA(t,e,s){var n=t.pingCache;n!==null&&n.delete(e),t.pingedLanes|=t.suspendedLanes&s,t.warmLanes&=~s,Ke===t&&(ke&s)===s&&(ft===4||ft===3&&(ke&62914560)===ke&&300>bs()-wf?!(Re&2)&&Xr(t,0):hg|=s,Wr===ke&&(Wr=0)),xn(t)}function SN(t,e){e===0&&(e=gw()),t=Wa(t,e),t!==null&&(vc(t,e),xn(t))}function VA(t){var e=t.memoizedState,s=0;e!==null&&(s=e.retryLane),SN(t,s)}function zA(t,e){var s=0;switch(t.tag){case 31:case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(s=i.retryLane);break;case 19:n=t.stateNode;break;case 22:n=t.stateNode._retryCache;break;default:throw Error(K(314))}n!==null&&n.delete(e),SN(t,s)}function KA(t,e){return Ap(t,e)}var gd=null,lr=null,r0=!1,xd=!1,Oh=!1,yi=0;function xn(t){t!==lr&&t.next===null&&(lr===null?gd=lr=t:lr=lr.next=t),xd=!0,r0||(r0=!0,WA())}function Sc(t,e){if(!Oh&&xd){Oh=!0;do for(var s=!1,n=gd;n!==null;){if(t!==0){var i=n.pendingLanes;if(i===0)var a=0;else{var l=n.suspendedLanes,o=n.pingedLanes;a=(1<<31-ys(42|t)+1)-1,a&=i&~(l&~o),a=a&201326741?a&201326741|1:a?a|2:0}a!==0&&(s=!0,gv(n,a))}else a=ke,a=df(n,n===Ke?a:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),!(a&3)||bc(n,a)||(s=!0,gv(n,a));n=n.next}while(s);Oh=!1}}function YA(){EN()}function EN(){xd=r0=!1;var t=0;yi!==0&&iR()&&(t=yi);for(var e=bs(),s=null,n=gd;n!==null;){var i=n.next,a=jN(n,e);a===0?(n.next=null,s===null?gd=i:s.next=i,i===null&&(lr=s)):(s=n,(t!==0||a&3)&&(xd=!0)),n=i}jt!==0&&jt!==5||Sc(t),yi!==0&&(yi=0)}function jN(t,e){for(var s=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,a=t.pendingLanes&-62914561;0<a;){var l=31-ys(a),o=1<<l,c=i[l];c===-1?(!(o&s)||o&n)&&(i[l]=yT(o,e)):c<=e&&(t.expiredLanes|=o),a&=~o}if(e=Ke,s=ke,s=df(t,t===e?s:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),n=t.callbackNode,s===0||t===e&&(De===2||De===9)||t.cancelPendingCommit!==null)return n!==null&&n!==null&&lh(n),t.callbackNode=null,t.callbackPriority=0;if(!(s&3)||bc(t,s)){if(e=s&-s,e===t.callbackPriority)return e;switch(n!==null&&lh(n),Cp(s)){case 2:case 8:s=mw;break;case 32:s=Zu;break;case 268435456:s=pw;break;default:s=Zu}return n=TN.bind(null,t),s=Ap(s,n),t.callbackPriority=e,t.callbackNode=s,e}return n!==null&&n!==null&&lh(n),t.callbackPriority=2,t.callbackNode=null,2}function TN(t,e){if(jt!==0&&jt!==5)return t.callbackNode=null,t.callbackPriority=0,null;var s=t.callbackNode;if(Sf()&&t.callbackNode!==s)return null;var n=ke;return n=df(t,t===Ke?n:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),n===0?null:(hN(t,n,e),jN(t,bs()),t.callbackNode!=null&&t.callbackNode===s?TN.bind(null,t):null)}function gv(t,e){if(Sf())return null;hN(t,e,!0)}function WA(){rR(function(){Re&6?Ap(hw,YA):EN()})}function pg(){if(yi===0){var t=zr;t===0&&(t=tu,tu<<=1,!(tu&261888)&&(tu=256)),yi=t}return yi}function xv(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:ju(""+t)}function bv(t,e){var s=e.ownerDocument.createElement("input");return s.name=e.name,s.value=e.value,t.id&&s.setAttribute("form",t.id),e.parentNode.insertBefore(s,e),t=new FormData(t),s.parentNode.removeChild(s),t}function qA(t,e,s,n,i){if(e==="submit"&&s&&s.stateNode===i){var a=xv((i[us]||null).action),l=n.submitter;l&&(e=(e=l[us]||null)?xv(e.formAction):l.getAttribute("formAction"),e!==null&&(a=e,l=null));var o=new ff("action","action",null,n,i);t.push({event:o,listeners:[{instance:null,listener:function(){if(n.defaultPrevented){if(yi!==0){var c=l?bv(i,l):new FormData(i);Xm(s,{pending:!0,data:c,method:i.method,action:a},null,c)}}else typeof a=="function"&&(o.preventDefault(),c=l?bv(i,l):new FormData(i),Xm(s,{pending:!0,data:c,method:i.method,action:a},a,c))},currentTarget:i}]})}}for(var Mh=0;Mh<Bm.length;Mh++){var Dh=Bm[Mh],XA=Dh.toLowerCase(),QA=Dh[0].toUpperCase()+Dh.slice(1);nn(XA,"on"+QA)}nn(Hw,"onAnimationEnd");nn($w,"onAnimationIteration");nn(Gw,"onAnimationStart");nn("dblclick","onDoubleClick");nn("focusin","onFocus");nn("focusout","onBlur");nn(hA,"onTransitionRun");nn(mA,"onTransitionStart");nn(pA,"onTransitionCancel");nn(Fw,"onTransitionEnd");Fr("onMouseEnter",["mouseout","mouseover"]);Fr("onMouseLeave",["mouseout","mouseover"]);Fr("onPointerEnter",["pointerout","pointerover"]);Fr("onPointerLeave",["pointerout","pointerover"]);za("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));za("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));za("onBeforeInput",["compositionend","keypress","textInput","paste"]);za("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));za("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));za("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ho="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),JA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ho));function AN(t,e){e=(e&4)!==0;for(var s=0;s<t.length;s++){var n=t[s],i=n.event;n=n.listeners;e:{var a=void 0;if(e)for(var l=n.length-1;0<=l;l--){var o=n[l],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==a&&i.isPropagationStopped())break e;a=o,i.currentTarget=u;try{a(i)}catch(d){td(d)}i.currentTarget=null,a=c}else for(l=0;l<n.length;l++){if(o=n[l],c=o.instance,u=o.currentTarget,o=o.listener,c!==a&&i.isPropagationStopped())break e;a=o,i.currentTarget=u;try{a(i)}catch(d){td(d)}i.currentTarget=null,a=c}}}}function _e(t,e){var s=e[Rm];s===void 0&&(s=e[Rm]=new Set);var n=t+"__bubble";s.has(n)||(RN(e,t,2,!1),s.add(n))}function Lh(t,e,s){var n=0;e&&(n|=4),RN(s,t,n,e)}var du="_reactListening"+Math.random().toString(36).slice(2);function gg(t){if(!t[du]){t[du]=!0,_w.forEach(function(s){s!=="selectionchange"&&(JA.has(s)||Lh(s,!1,t),Lh(s,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[du]||(e[du]=!0,Lh("selectionchange",!1,e))}}function RN(t,e,s,n){switch(FN(e)){case 2:var i=ER;break;case 8:i=jR;break;default:i=yg}s=i.bind(null,e,s,t),i=void 0,!Dm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,s,{capture:!0,passive:i}):t.addEventListener(e,s,!0):i!==void 0?t.addEventListener(e,s,{passive:i}):t.addEventListener(e,s,!1)}function Ph(t,e,s,n,i){var a=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var l=n.tag;if(l===3||l===4){var o=n.stateNode.containerInfo;if(o===i)break;if(l===4)for(l=n.return;l!==null;){var c=l.tag;if((c===3||c===4)&&l.stateNode.containerInfo===i)return;l=l.return}for(;o!==null;){if(l=ur(o),l===null)return;if(c=l.tag,c===5||c===6||c===26||c===27){n=a=l;continue e}o=o.parentNode}}n=n.return}Aw(function(){var u=a,d=Mp(s),f=[];e:{var h=Vw.get(t);if(h!==void 0){var m=ff,v=t;switch(t){case"keypress":if(Au(s)===0)break e;case"keydown":case"keyup":m=zT;break;case"focusin":v="focus",m=fh;break;case"focusout":v="blur",m=fh;break;case"beforeblur":case"afterblur":m=fh;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Eb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=OT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=WT;break;case Hw:case $w:case Gw:m=LT;break;case Fw:m=XT;break;case"scroll":case"scrollend":m=CT;break;case"wheel":m=JT;break;case"copy":case"cut":case"paste":m=BT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Tb;break;case"toggle":case"beforetoggle":m=eA}var x=(e&4)!==0,b=!x&&(t==="scroll"||t==="scrollend"),g=x?h!==null?h+"Capture":null:h;x=[];for(var p=u,y;p!==null;){var k=p;if(y=k.stateNode,k=k.tag,k!==5&&k!==26&&k!==27||y===null||g===null||(k=Io(p,g),k!=null&&x.push($o(p,k,y))),b)break;p=p.return}0<x.length&&(h=new m(h,v,null,s,d),f.push({event:h,listeners:x}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",h&&s!==Mm&&(v=s.relatedTarget||s.fromElement)&&(ur(v)||v[hl]))break e;if((m||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,m?(v=s.relatedTarget||s.toElement,m=u,v=v?ur(v):null,v!==null&&(b=gc(v),x=v.tag,v!==b||x!==5&&x!==27&&x!==6)&&(v=null)):(m=null,v=u),m!==v)){if(x=Eb,k="onMouseLeave",g="onMouseEnter",p="mouse",(t==="pointerout"||t==="pointerover")&&(x=Tb,k="onPointerLeave",g="onPointerEnter",p="pointer"),b=m==null?h:Ql(m),y=v==null?h:Ql(v),h=new x(k,p+"leave",m,s,d),h.target=b,h.relatedTarget=y,k=null,ur(d)===u&&(x=new x(g,p+"enter",v,s,d),x.target=y,x.relatedTarget=b,k=x),b=k,m&&v)t:{for(x=ZA,g=m,p=v,y=0,k=g;k;k=x(k))y++;k=0;for(var N=p;N;N=x(N))k++;for(;0<y-k;)g=x(g),y--;for(;0<k-y;)p=x(p),k--;for(;y--;){if(g===p||p!==null&&g===p.alternate){x=g;break t}g=x(g),p=x(p)}x=null}else x=null;m!==null&&vv(f,h,m,x,!1),v!==null&&b!==null&&vv(f,b,v,x,!0)}}e:{if(h=u?Ql(u):window,m=h.nodeName&&h.nodeName.toLowerCase(),m==="select"||m==="input"&&h.type==="file")var S=Ib;else if(Cb(h))if(Dw)S=uA;else{S=oA;var w=lA}else m=h.nodeName,!m||m.toLowerCase()!=="input"||h.type!=="checkbox"&&h.type!=="radio"?u&&Op(u.elementType)&&(S=Ib):S=cA;if(S&&(S=S(t,u))){Mw(f,S,s,d);break e}w&&w(t,h,u),t==="focusout"&&u&&h.type==="number"&&u.memoizedProps.value!=null&&Om(h,"number",h.value)}switch(w=u?Ql(u):window,t){case"focusin":(Cb(w)||w.contentEditable==="true")&&(hr=w,Lm=u,lo=null);break;case"focusout":lo=Lm=hr=null;break;case"mousedown":Pm=!0;break;case"contextmenu":case"mouseup":case"dragend":Pm=!1,Pb(f,s,d);break;case"selectionchange":if(fA)break;case"keydown":case"keyup":Pb(f,s,d)}var E;if(Pp)e:{switch(t){case"compositionstart":var j="onCompositionStart";break e;case"compositionend":j="onCompositionEnd";break e;case"compositionupdate":j="onCompositionUpdate";break e}j=void 0}else fr?Iw(t,s)&&(j="onCompositionEnd"):t==="keydown"&&s.keyCode===229&&(j="onCompositionStart");j&&(Cw&&s.locale!=="ko"&&(fr||j!=="onCompositionStart"?j==="onCompositionEnd"&&fr&&(E=Rw()):(xi=d,Dp="value"in xi?xi.value:xi.textContent,fr=!0)),w=bd(u,j),0<w.length&&(j=new jb(j,t,null,s,d),f.push({event:j,listeners:w}),E?j.data=E:(E=Ow(s),E!==null&&(j.data=E)))),(E=sA?nA(t,s):iA(t,s))&&(j=bd(u,"onBeforeInput"),0<j.length&&(w=new jb("onBeforeInput","beforeinput",null,s,d),f.push({event:w,listeners:j}),w.data=E)),qA(f,t,u,s,d)}AN(f,e)})}function $o(t,e,s){return{instance:t,listener:e,currentTarget:s}}function bd(t,e){for(var s=e+"Capture",n=[];t!==null;){var i=t,a=i.stateNode;if(i=i.tag,i!==5&&i!==26&&i!==27||a===null||(i=Io(t,s),i!=null&&n.unshift($o(t,i,a)),i=Io(t,e),i!=null&&n.push($o(t,i,a))),t.tag===3)return n;t=t.return}return[]}function ZA(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function vv(t,e,s,n,i){for(var a=e._reactName,l=[];s!==null&&s!==n;){var o=s,c=o.alternate,u=o.stateNode;if(o=o.tag,c!==null&&c===n)break;o!==5&&o!==26&&o!==27||u===null||(c=u,i?(u=Io(s,a),u!=null&&l.unshift($o(s,u,c))):i||(u=Io(s,a),u!=null&&l.push($o(s,u,c)))),s=s.return}l.length!==0&&t.push({event:e,listeners:l})}var eR=/\r\n?/g,tR=/\u0000|\uFFFD/g;function yv(t){return(typeof t=="string"?t:""+t).replace(eR,`
`).replace(tR,"")}function CN(t,e){return e=yv(e),yv(t)===e}function Ue(t,e,s,n,i,a){switch(s){case"children":typeof n=="string"?e==="body"||e==="textarea"&&n===""||Vr(t,n):(typeof n=="number"||typeof n=="bigint")&&e!=="body"&&Vr(t,""+n);break;case"className":iu(t,"class",n);break;case"tabIndex":iu(t,"tabindex",n);break;case"dir":case"role":case"viewBox":case"width":case"height":iu(t,s,n);break;case"style":Tw(t,n,a);break;case"data":if(e!=="object"){iu(t,"data",n);break}case"src":case"href":if(n===""&&(e!=="a"||s!=="href")){t.removeAttribute(s);break}if(n==null||typeof n=="function"||typeof n=="symbol"||typeof n=="boolean"){t.removeAttribute(s);break}n=ju(""+n),t.setAttribute(s,n);break;case"action":case"formAction":if(typeof n=="function"){t.setAttribute(s,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof a=="function"&&(s==="formAction"?(e!=="input"&&Ue(t,e,"name",i.name,i,null),Ue(t,e,"formEncType",i.formEncType,i,null),Ue(t,e,"formMethod",i.formMethod,i,null),Ue(t,e,"formTarget",i.formTarget,i,null)):(Ue(t,e,"encType",i.encType,i,null),Ue(t,e,"method",i.method,i,null),Ue(t,e,"target",i.target,i,null)));if(n==null||typeof n=="symbol"||typeof n=="boolean"){t.removeAttribute(s);break}n=ju(""+n),t.setAttribute(s,n);break;case"onClick":n!=null&&(t.onclick=Rn);break;case"onScroll":n!=null&&_e("scroll",t);break;case"onScrollEnd":n!=null&&_e("scrollend",t);break;case"dangerouslySetInnerHTML":if(n!=null){if(typeof n!="object"||!("__html"in n))throw Error(K(61));if(s=n.__html,s!=null){if(i.children!=null)throw Error(K(60));t.innerHTML=s}}break;case"multiple":t.multiple=n&&typeof n!="function"&&typeof n!="symbol";break;case"muted":t.muted=n&&typeof n!="function"&&typeof n!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(n==null||typeof n=="function"||typeof n=="boolean"||typeof n=="symbol"){t.removeAttribute("xlink:href");break}s=ju(""+n),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",s);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":n!=null&&typeof n!="function"&&typeof n!="symbol"?t.setAttribute(s,""+n):t.removeAttribute(s);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":n&&typeof n!="function"&&typeof n!="symbol"?t.setAttribute(s,""):t.removeAttribute(s);break;case"capture":case"download":n===!0?t.setAttribute(s,""):n!==!1&&n!=null&&typeof n!="function"&&typeof n!="symbol"?t.setAttribute(s,n):t.removeAttribute(s);break;case"cols":case"rows":case"size":case"span":n!=null&&typeof n!="function"&&typeof n!="symbol"&&!isNaN(n)&&1<=n?t.setAttribute(s,n):t.removeAttribute(s);break;case"rowSpan":case"start":n==null||typeof n=="function"||typeof n=="symbol"||isNaN(n)?t.removeAttribute(s):t.setAttribute(s,n);break;case"popover":_e("beforetoggle",t),_e("toggle",t),Eu(t,"popover",n);break;case"xlinkActuate":_n(t,"http://www.w3.org/1999/xlink","xlink:actuate",n);break;case"xlinkArcrole":_n(t,"http://www.w3.org/1999/xlink","xlink:arcrole",n);break;case"xlinkRole":_n(t,"http://www.w3.org/1999/xlink","xlink:role",n);break;case"xlinkShow":_n(t,"http://www.w3.org/1999/xlink","xlink:show",n);break;case"xlinkTitle":_n(t,"http://www.w3.org/1999/xlink","xlink:title",n);break;case"xlinkType":_n(t,"http://www.w3.org/1999/xlink","xlink:type",n);break;case"xmlBase":_n(t,"http://www.w3.org/XML/1998/namespace","xml:base",n);break;case"xmlLang":_n(t,"http://www.w3.org/XML/1998/namespace","xml:lang",n);break;case"xmlSpace":_n(t,"http://www.w3.org/XML/1998/namespace","xml:space",n);break;case"is":Eu(t,"is",n);break;case"innerText":case"textContent":break;default:(!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(s=AT.get(s)||s,Eu(t,s,n))}}function l0(t,e,s,n,i,a){switch(s){case"style":Tw(t,n,a);break;case"dangerouslySetInnerHTML":if(n!=null){if(typeof n!="object"||!("__html"in n))throw Error(K(61));if(s=n.__html,s!=null){if(i.children!=null)throw Error(K(60));t.innerHTML=s}}break;case"children":typeof n=="string"?Vr(t,n):(typeof n=="number"||typeof n=="bigint")&&Vr(t,""+n);break;case"onScroll":n!=null&&_e("scroll",t);break;case"onScrollEnd":n!=null&&_e("scrollend",t);break;case"onClick":n!=null&&(t.onclick=Rn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ww.hasOwnProperty(s))e:{if(s[0]==="o"&&s[1]==="n"&&(i=s.endsWith("Capture"),e=s.slice(2,i?s.length-7:void 0),a=t[us]||null,a=a!=null?a[s]:null,typeof a=="function"&&t.removeEventListener(e,a,i),typeof n=="function")){typeof a!="function"&&a!==null&&(s in t?t[s]=null:t.hasAttribute(s)&&t.removeAttribute(s)),t.addEventListener(e,n,i);break e}s in t?t[s]=n:n===!0?t.setAttribute(s,""):Eu(t,s,n)}}}function Vt(t,e,s){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":_e("error",t),_e("load",t);var n=!1,i=!1,a;for(a in s)if(s.hasOwnProperty(a)){var l=s[a];if(l!=null)switch(a){case"src":n=!0;break;case"srcSet":i=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(K(137,e));default:Ue(t,e,a,l,s,null)}}i&&Ue(t,e,"srcSet",s.srcSet,s,null),n&&Ue(t,e,"src",s.src,s,null);return;case"input":_e("invalid",t);var o=a=l=i=null,c=null,u=null;for(n in s)if(s.hasOwnProperty(n)){var d=s[n];if(d!=null)switch(n){case"name":i=d;break;case"type":l=d;break;case"checked":c=d;break;case"defaultChecked":u=d;break;case"value":a=d;break;case"defaultValue":o=d;break;case"children":case"dangerouslySetInnerHTML":if(d!=null)throw Error(K(137,e));break;default:Ue(t,e,n,d,s,null)}}Sw(t,a,o,c,u,l,i,!1);return;case"select":_e("invalid",t),n=l=a=null;for(i in s)if(s.hasOwnProperty(i)&&(o=s[i],o!=null))switch(i){case"value":a=o;break;case"defaultValue":l=o;break;case"multiple":n=o;default:Ue(t,e,i,o,s,null)}e=a,s=l,t.multiple=!!n,e!=null?Ar(t,!!n,e,!1):s!=null&&Ar(t,!!n,s,!0);return;case"textarea":_e("invalid",t),a=i=n=null;for(l in s)if(s.hasOwnProperty(l)&&(o=s[l],o!=null))switch(l){case"value":n=o;break;case"defaultValue":i=o;break;case"children":a=o;break;case"dangerouslySetInnerHTML":if(o!=null)throw Error(K(91));break;default:Ue(t,e,l,o,s,null)}jw(t,n,i,a);return;case"option":for(c in s)if(s.hasOwnProperty(c)&&(n=s[c],n!=null))switch(c){case"selected":t.selected=n&&typeof n!="function"&&typeof n!="symbol";break;default:Ue(t,e,c,n,s,null)}return;case"dialog":_e("beforetoggle",t),_e("toggle",t),_e("cancel",t),_e("close",t);break;case"iframe":case"object":_e("load",t);break;case"video":case"audio":for(n=0;n<Ho.length;n++)_e(Ho[n],t);break;case"image":_e("error",t),_e("load",t);break;case"details":_e("toggle",t);break;case"embed":case"source":case"link":_e("error",t),_e("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in s)if(s.hasOwnProperty(u)&&(n=s[u],n!=null))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(K(137,e));default:Ue(t,e,u,n,s,null)}return;default:if(Op(e)){for(d in s)s.hasOwnProperty(d)&&(n=s[d],n!==void 0&&l0(t,e,d,n,s,void 0));return}}for(o in s)s.hasOwnProperty(o)&&(n=s[o],n!=null&&Ue(t,e,o,n,s,null))}function sR(t,e,s,n){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,a=null,l=null,o=null,c=null,u=null,d=null;for(m in s){var f=s[m];if(s.hasOwnProperty(m)&&f!=null)switch(m){case"checked":break;case"value":break;case"defaultValue":c=f;default:n.hasOwnProperty(m)||Ue(t,e,m,null,n,f)}}for(var h in n){var m=n[h];if(f=s[h],n.hasOwnProperty(h)&&(m!=null||f!=null))switch(h){case"type":a=m;break;case"name":i=m;break;case"checked":u=m;break;case"defaultChecked":d=m;break;case"value":l=m;break;case"defaultValue":o=m;break;case"children":case"dangerouslySetInnerHTML":if(m!=null)throw Error(K(137,e));break;default:m!==f&&Ue(t,e,h,m,n,f)}}Im(t,l,o,c,u,d,a,i);return;case"select":m=l=o=h=null;for(a in s)if(c=s[a],s.hasOwnProperty(a)&&c!=null)switch(a){case"value":break;case"multiple":m=c;default:n.hasOwnProperty(a)||Ue(t,e,a,null,n,c)}for(i in n)if(a=n[i],c=s[i],n.hasOwnProperty(i)&&(a!=null||c!=null))switch(i){case"value":h=a;break;case"defaultValue":o=a;break;case"multiple":l=a;default:a!==c&&Ue(t,e,i,a,n,c)}e=o,s=l,n=m,h!=null?Ar(t,!!s,h,!1):!!n!=!!s&&(e!=null?Ar(t,!!s,e,!0):Ar(t,!!s,s?[]:"",!1));return;case"textarea":m=h=null;for(o in s)if(i=s[o],s.hasOwnProperty(o)&&i!=null&&!n.hasOwnProperty(o))switch(o){case"value":break;case"children":break;default:Ue(t,e,o,null,n,i)}for(l in n)if(i=n[l],a=s[l],n.hasOwnProperty(l)&&(i!=null||a!=null))switch(l){case"value":h=i;break;case"defaultValue":m=i;break;case"children":break;case"dangerouslySetInnerHTML":if(i!=null)throw Error(K(91));break;default:i!==a&&Ue(t,e,l,i,n,a)}Ew(t,h,m);return;case"option":for(var v in s)if(h=s[v],s.hasOwnProperty(v)&&h!=null&&!n.hasOwnProperty(v))switch(v){case"selected":t.selected=!1;break;default:Ue(t,e,v,null,n,h)}for(c in n)if(h=n[c],m=s[c],n.hasOwnProperty(c)&&h!==m&&(h!=null||m!=null))switch(c){case"selected":t.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:Ue(t,e,c,h,n,m)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var x in s)h=s[x],s.hasOwnProperty(x)&&h!=null&&!n.hasOwnProperty(x)&&Ue(t,e,x,null,n,h);for(u in n)if(h=n[u],m=s[u],n.hasOwnProperty(u)&&h!==m&&(h!=null||m!=null))switch(u){case"children":case"dangerouslySetInnerHTML":if(h!=null)throw Error(K(137,e));break;default:Ue(t,e,u,h,n,m)}return;default:if(Op(e)){for(var b in s)h=s[b],s.hasOwnProperty(b)&&h!==void 0&&!n.hasOwnProperty(b)&&l0(t,e,b,void 0,n,h);for(d in n)h=n[d],m=s[d],!n.hasOwnProperty(d)||h===m||h===void 0&&m===void 0||l0(t,e,d,h,n,m);return}}for(var g in s)h=s[g],s.hasOwnProperty(g)&&h!=null&&!n.hasOwnProperty(g)&&Ue(t,e,g,null,n,h);for(f in n)h=n[f],m=s[f],!n.hasOwnProperty(f)||h===m||h==null&&m==null||Ue(t,e,f,h,n,m)}function _v(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function nR(){if(typeof performance.getEntriesByType=="function"){for(var t=0,e=0,s=performance.getEntriesByType("resource"),n=0;n<s.length;n++){var i=s[n],a=i.transferSize,l=i.initiatorType,o=i.duration;if(a&&o&&_v(l)){for(l=0,o=i.responseEnd,n+=1;n<s.length;n++){var c=s[n],u=c.startTime;if(u>o)break;var d=c.transferSize,f=c.initiatorType;d&&_v(f)&&(c=c.responseEnd,l+=d*(c<o?1:(o-u)/(c-u)))}if(--n,e+=8*(a+l)/(i.duration/1e3),t++,10<t)break}}if(0<t)return e/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var o0=null,c0=null;function vd(t){return t.nodeType===9?t:t.ownerDocument}function wv(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function IN(t,e){if(t===0)switch(e){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&e==="foreignObject"?0:t}function u0(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.children=="bigint"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Bh=null;function iR(){var t=window.event;return t&&t.type==="popstate"?t===Bh?!1:(Bh=t,!0):(Bh=null,!1)}var ON=typeof setTimeout=="function"?setTimeout:void 0,aR=typeof clearTimeout=="function"?clearTimeout:void 0,kv=typeof Promise=="function"?Promise:void 0,rR=typeof queueMicrotask=="function"?queueMicrotask:typeof kv<"u"?function(t){return kv.resolve(null).then(t).catch(lR)}:ON;function lR(t){setTimeout(function(){throw t})}function sa(t){return t==="head"}function Nv(t,e){var s=e,n=0;do{var i=s.nextSibling;if(t.removeChild(s),i&&i.nodeType===8)if(s=i.data,s==="/$"||s==="/&"){if(n===0){t.removeChild(i),Jr(e);return}n--}else if(s==="$"||s==="$?"||s==="$~"||s==="$!"||s==="&")n++;else if(s==="html")bo(t.ownerDocument.documentElement);else if(s==="head"){s=t.ownerDocument.head,bo(s);for(var a=s.firstChild;a;){var l=a.nextSibling,o=a.nodeName;a[yc]||o==="SCRIPT"||o==="STYLE"||o==="LINK"&&a.rel.toLowerCase()==="stylesheet"||s.removeChild(a),a=l}}else s==="body"&&bo(t.ownerDocument.body);s=i}while(s);Jr(e)}function Sv(t,e){var s=t;t=0;do{var n=s.nextSibling;if(s.nodeType===1?e?(s._stashedDisplay=s.style.display,s.style.display="none"):(s.style.display=s._stashedDisplay||"",s.getAttribute("style")===""&&s.removeAttribute("style")):s.nodeType===3&&(e?(s._stashedText=s.nodeValue,s.nodeValue=""):s.nodeValue=s._stashedText||""),n&&n.nodeType===8)if(s=n.data,s==="/$"){if(t===0)break;t--}else s!=="$"&&s!=="$?"&&s!=="$~"&&s!=="$!"||t++;s=n}while(s)}function d0(t){var e=t.firstChild;for(e&&e.nodeType===10&&(e=e.nextSibling);e;){var s=e;switch(e=e.nextSibling,s.nodeName){case"HTML":case"HEAD":case"BODY":d0(s),Ip(s);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(s.rel.toLowerCase()==="stylesheet")continue}t.removeChild(s)}}function oR(t,e,s,n){for(;t.nodeType===1;){var i=s;if(t.nodeName.toLowerCase()!==e.toLowerCase()){if(!n&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(n){if(!t[yc])switch(e){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(a=t.getAttribute("rel"),a==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(a!==i.rel||t.getAttribute("href")!==(i.href==null||i.href===""?null:i.href)||t.getAttribute("crossorigin")!==(i.crossOrigin==null?null:i.crossOrigin)||t.getAttribute("title")!==(i.title==null?null:i.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(a=t.getAttribute("src"),(a!==(i.src==null?null:i.src)||t.getAttribute("type")!==(i.type==null?null:i.type)||t.getAttribute("crossorigin")!==(i.crossOrigin==null?null:i.crossOrigin))&&a&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(e==="input"&&t.type==="hidden"){var a=i.name==null?null:""+i.name;if(i.type==="hidden"&&t.getAttribute("name")===a)return t}else return t;if(t=Bs(t.nextSibling),t===null)break}return null}function cR(t,e,s){if(e==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!s||(t=Bs(t.nextSibling),t===null))return null;return t}function MN(t,e){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!e||(t=Bs(t.nextSibling),t===null))return null;return t}function f0(t){return t.data==="$?"||t.data==="$~"}function h0(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function uR(t,e){var s=t.ownerDocument;if(t.data==="$~")t._reactRetry=e;else if(t.data!=="$?"||s.readyState!=="loading")e();else{var n=function(){e(),s.removeEventListener("DOMContentLoaded",n)};s.addEventListener("DOMContentLoaded",n),t._reactRetry=n}}function Bs(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?"||e==="$~"||e==="&"||e==="F!"||e==="F")break;if(e==="/$"||e==="/&")return null}}return t}var m0=null;function Ev(t){t=t.nextSibling;for(var e=0;t;){if(t.nodeType===8){var s=t.data;if(s==="/$"||s==="/&"){if(e===0)return Bs(t.nextSibling);e--}else s!=="$"&&s!=="$!"&&s!=="$?"&&s!=="$~"&&s!=="&"||e++}t=t.nextSibling}return null}function jv(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var s=t.data;if(s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"){if(e===0)return t;e--}else s!=="/$"&&s!=="/&"||e++}t=t.previousSibling}return null}function DN(t,e,s){switch(e=vd(s),t){case"html":if(t=e.documentElement,!t)throw Error(K(452));return t;case"head":if(t=e.head,!t)throw Error(K(453));return t;case"body":if(t=e.body,!t)throw Error(K(454));return t;default:throw Error(K(451))}}function bo(t){for(var e=t.attributes;e.length;)t.removeAttributeNode(e[0]);Ip(t)}var Gs=new Map,Tv=new Set;function yd(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var Jn=Ce.d;Ce.d={f:dR,r:fR,D:hR,C:mR,L:pR,m:gR,X:bR,S:xR,M:vR};function dR(){var t=Jn.f(),e=kf();return t||e}function fR(t){var e=ml(t);e!==null&&e.tag===5&&e.type==="form"?Tk(e):Jn.r(t)}var bl=typeof document>"u"?null:document;function LN(t,e,s){var n=bl;if(n&&typeof e=="string"&&e){var i=Is(e);i='link[rel="'+t+'"][href="'+i+'"]',typeof s=="string"&&(i+='[crossorigin="'+s+'"]'),Tv.has(i)||(Tv.add(i),t={rel:t,crossOrigin:s,href:e},n.querySelector(i)===null&&(e=n.createElement("link"),Vt(e,"link",t),Ot(e),n.head.appendChild(e)))}}function hR(t){Jn.D(t),LN("dns-prefetch",t,null)}function mR(t,e){Jn.C(t,e),LN("preconnect",t,e)}function pR(t,e,s){Jn.L(t,e,s);var n=bl;if(n&&t&&e){var i='link[rel="preload"][as="'+Is(e)+'"]';e==="image"&&s&&s.imageSrcSet?(i+='[imagesrcset="'+Is(s.imageSrcSet)+'"]',typeof s.imageSizes=="string"&&(i+='[imagesizes="'+Is(s.imageSizes)+'"]')):i+='[href="'+Is(t)+'"]';var a=i;switch(e){case"style":a=Qr(t);break;case"script":a=vl(t)}Gs.has(a)||(t=Ze({rel:"preload",href:e==="image"&&s&&s.imageSrcSet?void 0:t,as:e},s),Gs.set(a,t),n.querySelector(i)!==null||e==="style"&&n.querySelector(Ec(a))||e==="script"&&n.querySelector(jc(a))||(e=n.createElement("link"),Vt(e,"link",t),Ot(e),n.head.appendChild(e)))}}function gR(t,e){Jn.m(t,e);var s=bl;if(s&&t){var n=e&&typeof e.as=="string"?e.as:"script",i='link[rel="modulepreload"][as="'+Is(n)+'"][href="'+Is(t)+'"]',a=i;switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":a=vl(t)}if(!Gs.has(a)&&(t=Ze({rel:"modulepreload",href:t},e),Gs.set(a,t),s.querySelector(i)===null)){switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(s.querySelector(jc(a)))return}n=s.createElement("link"),Vt(n,"link",t),Ot(n),s.head.appendChild(n)}}}function xR(t,e,s){Jn.S(t,e,s);var n=bl;if(n&&t){var i=Tr(n).hoistableStyles,a=Qr(t);e=e||"default";var l=i.get(a);if(!l){var o={loading:0,preload:null};if(l=n.querySelector(Ec(a)))o.loading=5;else{t=Ze({rel:"stylesheet",href:t,"data-precedence":e},s),(s=Gs.get(a))&&xg(t,s);var c=l=n.createElement("link");Ot(c),Vt(c,"link",t),c._p=new Promise(function(u,d){c.onload=u,c.onerror=d}),c.addEventListener("load",function(){o.loading|=1}),c.addEventListener("error",function(){o.loading|=2}),o.loading|=4,Pu(l,e,n)}l={type:"stylesheet",instance:l,count:1,state:o},i.set(a,l)}}}function bR(t,e){Jn.X(t,e);var s=bl;if(s&&t){var n=Tr(s).hoistableScripts,i=vl(t),a=n.get(i);a||(a=s.querySelector(jc(i)),a||(t=Ze({src:t,async:!0},e),(e=Gs.get(i))&&bg(t,e),a=s.createElement("script"),Ot(a),Vt(a,"link",t),s.head.appendChild(a)),a={type:"script",instance:a,count:1,state:null},n.set(i,a))}}function vR(t,e){Jn.M(t,e);var s=bl;if(s&&t){var n=Tr(s).hoistableScripts,i=vl(t),a=n.get(i);a||(a=s.querySelector(jc(i)),a||(t=Ze({src:t,async:!0,type:"module"},e),(e=Gs.get(i))&&bg(t,e),a=s.createElement("script"),Ot(a),Vt(a,"link",t),s.head.appendChild(a)),a={type:"script",instance:a,count:1,state:null},n.set(i,a))}}function Av(t,e,s,n){var i=(i=Si.current)?yd(i):null;if(!i)throw Error(K(446));switch(t){case"meta":case"title":return null;case"style":return typeof s.precedence=="string"&&typeof s.href=="string"?(e=Qr(s.href),s=Tr(i).hoistableStyles,n=s.get(e),n||(n={type:"style",instance:null,count:0,state:null},s.set(e,n)),n):{type:"void",instance:null,count:0,state:null};case"link":if(s.rel==="stylesheet"&&typeof s.href=="string"&&typeof s.precedence=="string"){t=Qr(s.href);var a=Tr(i).hoistableStyles,l=a.get(t);if(l||(i=i.ownerDocument||i,l={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},a.set(t,l),(a=i.querySelector(Ec(t)))&&!a._p&&(l.instance=a,l.state.loading=5),Gs.has(t)||(s={rel:"preload",as:"style",href:s.href,crossOrigin:s.crossOrigin,integrity:s.integrity,media:s.media,hrefLang:s.hrefLang,referrerPolicy:s.referrerPolicy},Gs.set(t,s),a||yR(i,t,s,l.state))),e&&n===null)throw Error(K(528,""));return l}if(e&&n!==null)throw Error(K(529,""));return null;case"script":return e=s.async,s=s.src,typeof s=="string"&&e&&typeof e!="function"&&typeof e!="symbol"?(e=vl(s),s=Tr(i).hoistableScripts,n=s.get(e),n||(n={type:"script",instance:null,count:0,state:null},s.set(e,n)),n):{type:"void",instance:null,count:0,state:null};default:throw Error(K(444,t))}}function Qr(t){return'href="'+Is(t)+'"'}function Ec(t){return'link[rel="stylesheet"]['+t+"]"}function PN(t){return Ze({},t,{"data-precedence":t.precedence,precedence:null})}function yR(t,e,s,n){t.querySelector('link[rel="preload"][as="style"]['+e+"]")?n.loading=1:(e=t.createElement("link"),n.preload=e,e.addEventListener("load",function(){return n.loading|=1}),e.addEventListener("error",function(){return n.loading|=2}),Vt(e,"link",s),Ot(e),t.head.appendChild(e))}function vl(t){return'[src="'+Is(t)+'"]'}function jc(t){return"script[async]"+t}function Rv(t,e,s){if(e.count++,e.instance===null)switch(e.type){case"style":var n=t.querySelector('style[data-href~="'+Is(s.href)+'"]');if(n)return e.instance=n,Ot(n),n;var i=Ze({},s,{"data-href":s.href,"data-precedence":s.precedence,href:null,precedence:null});return n=(t.ownerDocument||t).createElement("style"),Ot(n),Vt(n,"style",i),Pu(n,s.precedence,t),e.instance=n;case"stylesheet":i=Qr(s.href);var a=t.querySelector(Ec(i));if(a)return e.state.loading|=4,e.instance=a,Ot(a),a;n=PN(s),(i=Gs.get(i))&&xg(n,i),a=(t.ownerDocument||t).createElement("link"),Ot(a);var l=a;return l._p=new Promise(function(o,c){l.onload=o,l.onerror=c}),Vt(a,"link",n),e.state.loading|=4,Pu(a,s.precedence,t),e.instance=a;case"script":return a=vl(s.src),(i=t.querySelector(jc(a)))?(e.instance=i,Ot(i),i):(n=s,(i=Gs.get(a))&&(n=Ze({},s),bg(n,i)),t=t.ownerDocument||t,i=t.createElement("script"),Ot(i),Vt(i,"link",n),t.head.appendChild(i),e.instance=i);case"void":return null;default:throw Error(K(443,e.type))}else e.type==="stylesheet"&&!(e.state.loading&4)&&(n=e.instance,e.state.loading|=4,Pu(n,s.precedence,t));return e.instance}function Pu(t,e,s){for(var n=s.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),i=n.length?n[n.length-1]:null,a=i,l=0;l<n.length;l++){var o=n[l];if(o.dataset.precedence===e)a=o;else if(a!==i)break}a?a.parentNode.insertBefore(t,a.nextSibling):(e=s.nodeType===9?s.head:s,e.insertBefore(t,e.firstChild))}function xg(t,e){t.crossOrigin==null&&(t.crossOrigin=e.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=e.referrerPolicy),t.title==null&&(t.title=e.title)}function bg(t,e){t.crossOrigin==null&&(t.crossOrigin=e.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=e.referrerPolicy),t.integrity==null&&(t.integrity=e.integrity)}var Bu=null;function Cv(t,e,s){if(Bu===null){var n=new Map,i=Bu=new Map;i.set(s,n)}else i=Bu,n=i.get(s),n||(n=new Map,i.set(s,n));if(n.has(t))return n;for(n.set(t,null),s=s.getElementsByTagName(t),i=0;i<s.length;i++){var a=s[i];if(!(a[yc]||a[Ht]||t==="link"&&a.getAttribute("rel")==="stylesheet")&&a.namespaceURI!=="http://www.w3.org/2000/svg"){var l=a.getAttribute(e)||"";l=t+l;var o=n.get(l);o?o.push(a):n.set(l,[a])}}return n}function Iv(t,e,s){t=t.ownerDocument||t,t.head.insertBefore(s,e==="title"?t.querySelector("head > title"):null)}function _R(t,e,s){if(s===1||e.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof e.precedence!="string"||typeof e.href!="string"||e.href==="")break;return!0;case"link":if(typeof e.rel!="string"||typeof e.href!="string"||e.href===""||e.onLoad||e.onError)break;switch(e.rel){case"stylesheet":return t=e.disabled,typeof e.precedence=="string"&&t==null;default:return!0}case"script":if(e.async&&typeof e.async!="function"&&typeof e.async!="symbol"&&!e.onLoad&&!e.onError&&e.src&&typeof e.src=="string")return!0}return!1}function BN(t){return!(t.type==="stylesheet"&&!(t.state.loading&3))}function wR(t,e,s,n){if(s.type==="stylesheet"&&(typeof n.media!="string"||matchMedia(n.media).matches!==!1)&&!(s.state.loading&4)){if(s.instance===null){var i=Qr(n.href),a=e.querySelector(Ec(i));if(a){e=a._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(t.count++,t=_d.bind(t),e.then(t,t)),s.state.loading|=4,s.instance=a,Ot(a);return}a=e.ownerDocument||e,n=PN(n),(i=Gs.get(i))&&xg(n,i),a=a.createElement("link"),Ot(a);var l=a;l._p=new Promise(function(o,c){l.onload=o,l.onerror=c}),Vt(a,"link",n),s.instance=a}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(s,e),(e=s.state.preload)&&!(s.state.loading&3)&&(t.count++,s=_d.bind(t),e.addEventListener("load",s),e.addEventListener("error",s))}}var Uh=0;function kR(t,e){return t.stylesheets&&t.count===0&&Uu(t,t.stylesheets),0<t.count||0<t.imgCount?function(s){var n=setTimeout(function(){if(t.stylesheets&&Uu(t,t.stylesheets),t.unsuspend){var a=t.unsuspend;t.unsuspend=null,a()}},6e4+e);0<t.imgBytes&&Uh===0&&(Uh=62500*nR());var i=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&Uu(t,t.stylesheets),t.unsuspend)){var a=t.unsuspend;t.unsuspend=null,a()}},(t.imgBytes>Uh?50:800)+e);return t.unsuspend=s,function(){t.unsuspend=null,clearTimeout(n),clearTimeout(i)}}:null}function _d(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Uu(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var wd=null;function Uu(t,e){t.stylesheets=null,t.unsuspend!==null&&(t.count++,wd=new Map,e.forEach(NR,t),wd=null,_d.call(t))}function NR(t,e){if(!(e.state.loading&4)){var s=wd.get(t);if(s)var n=s.get(null);else{s=new Map,wd.set(t,s);for(var i=t.querySelectorAll("link[data-precedence],style[data-precedence]"),a=0;a<i.length;a++){var l=i[a];(l.nodeName==="LINK"||l.getAttribute("media")!=="not all")&&(s.set(l.dataset.precedence,l),n=l)}n&&s.set(null,n)}i=e.instance,l=i.getAttribute("data-precedence"),a=s.get(l)||n,a===n&&s.set(null,i),s.set(l,i),this.count++,n=_d.bind(this),i.addEventListener("load",n),i.addEventListener("error",n),a?a.parentNode.insertBefore(i,a.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(i,t.firstChild)),e.state.loading|=4}}var Go={$$typeof:An,Provider:null,Consumer:null,_currentValue:ka,_currentValue2:ka,_threadCount:0};function SR(t,e,s,n,i,a,l,o,c){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=oh(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=oh(0),this.hiddenUpdates=oh(null),this.identifierPrefix=n,this.onUncaughtError=i,this.onCaughtError=a,this.onRecoverableError=l,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=c,this.incompleteTransitions=new Map}function UN(t,e,s,n,i,a,l,o,c,u,d,f){return t=new SR(t,e,s,l,c,u,d,f,o),e=1,a===!0&&(e|=24),a=ps(3,null,null,e),t.current=a,a.stateNode=t,e=Vp(),e.refCount++,t.pooledCache=e,e.refCount++,a.memoizedState={element:n,isDehydrated:s,cache:e},Yp(a),t}function HN(t){return t?(t=gr,t):gr}function $N(t,e,s,n,i,a){i=HN(i),n.context===null?n.context=i:n.pendingContext=i,n=ji(e),n.payload={element:s},a=a===void 0?null:a,a!==null&&(n.callback=a),s=Ti(t,n,e),s!==null&&(os(s,t,e),co(s,t,e))}function Ov(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var s=t.retryLane;t.retryLane=s!==0&&s<e?s:e}}function vg(t,e){Ov(t,e),(t=t.alternate)&&Ov(t,e)}function GN(t){if(t.tag===13||t.tag===31){var e=Wa(t,67108864);e!==null&&os(e,t,67108864),vg(t,67108864)}}function Mv(t){if(t.tag===13||t.tag===31){var e=_s();e=Rp(e);var s=Wa(t,e);s!==null&&os(s,t,e),vg(t,e)}}var kd=!0;function ER(t,e,s,n){var i=ce.T;ce.T=null;var a=Ce.p;try{Ce.p=2,yg(t,e,s,n)}finally{Ce.p=a,ce.T=i}}function jR(t,e,s,n){var i=ce.T;ce.T=null;var a=Ce.p;try{Ce.p=8,yg(t,e,s,n)}finally{Ce.p=a,ce.T=i}}function yg(t,e,s,n){if(kd){var i=p0(n);if(i===null)Ph(t,e,n,Nd,s),Dv(t,n);else if(AR(i,t,e,s,n))n.stopPropagation();else if(Dv(t,n),e&4&&-1<TR.indexOf(t)){for(;i!==null;){var a=ml(i);if(a!==null)switch(a.tag){case 3:if(a=a.stateNode,a.current.memoizedState.isDehydrated){var l=ha(a.pendingLanes);if(l!==0){var o=a;for(o.pendingLanes|=2,o.entangledLanes|=2;l;){var c=1<<31-ys(l);o.entanglements[1]|=c,l&=~c}xn(a),!(Re&6)&&(hd=bs()+500,Sc(0))}}break;case 31:case 13:o=Wa(a,2),o!==null&&os(o,a,2),kf(),vg(a,2)}if(a=p0(n),a===null&&Ph(t,e,n,Nd,s),a===i)break;i=a}i!==null&&n.stopPropagation()}else Ph(t,e,n,null,s)}}function p0(t){return t=Mp(t),_g(t)}var Nd=null;function _g(t){if(Nd=null,t=ur(t),t!==null){var e=gc(t);if(e===null)t=null;else{var s=e.tag;if(s===13){if(t=ow(e),t!==null)return t;t=null}else if(s===31){if(t=cw(e),t!==null)return t;t=null}else if(s===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null)}}return Nd=t,null}function FN(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(hT()){case hw:return 2;case mw:return 8;case Zu:case mT:return 32;case pw:return 268435456;default:return 32}default:return 32}}var g0=!1,Ci=null,Ii=null,Oi=null,Fo=new Map,Vo=new Map,di=[],TR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Dv(t,e){switch(t){case"focusin":case"focusout":Ci=null;break;case"dragenter":case"dragleave":Ii=null;break;case"mouseover":case"mouseout":Oi=null;break;case"pointerover":case"pointerout":Fo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Vo.delete(e.pointerId)}}function Fl(t,e,s,n,i,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:s,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},e!==null&&(e=ml(e),e!==null&&GN(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function AR(t,e,s,n,i){switch(e){case"focusin":return Ci=Fl(Ci,t,e,s,n,i),!0;case"dragenter":return Ii=Fl(Ii,t,e,s,n,i),!0;case"mouseover":return Oi=Fl(Oi,t,e,s,n,i),!0;case"pointerover":var a=i.pointerId;return Fo.set(a,Fl(Fo.get(a)||null,t,e,s,n,i)),!0;case"gotpointercapture":return a=i.pointerId,Vo.set(a,Fl(Vo.get(a)||null,t,e,s,n,i)),!0}return!1}function VN(t){var e=ur(t.target);if(e!==null){var s=gc(e);if(s!==null){if(e=s.tag,e===13){if(e=ow(s),e!==null){t.blockedOn=e,vb(t.priority,function(){Mv(s)});return}}else if(e===31){if(e=cw(s),e!==null){t.blockedOn=e,vb(t.priority,function(){Mv(s)});return}}else if(e===3&&s.stateNode.current.memoizedState.isDehydrated){t.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Hu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var s=p0(t.nativeEvent);if(s===null){s=t.nativeEvent;var n=new s.constructor(s.type,s);Mm=n,s.target.dispatchEvent(n),Mm=null}else return e=ml(s),e!==null&&GN(e),t.blockedOn=s,!1;e.shift()}return!0}function Lv(t,e,s){Hu(t)&&s.delete(e)}function RR(){g0=!1,Ci!==null&&Hu(Ci)&&(Ci=null),Ii!==null&&Hu(Ii)&&(Ii=null),Oi!==null&&Hu(Oi)&&(Oi=null),Fo.forEach(Lv),Vo.forEach(Lv)}function fu(t,e){t.blockedOn===e&&(t.blockedOn=null,g0||(g0=!0,At.unstable_scheduleCallback(At.unstable_NormalPriority,RR)))}var hu=null;function Pv(t){hu!==t&&(hu=t,At.unstable_scheduleCallback(At.unstable_NormalPriority,function(){hu===t&&(hu=null);for(var e=0;e<t.length;e+=3){var s=t[e],n=t[e+1],i=t[e+2];if(typeof n!="function"){if(_g(n||s)===null)continue;break}var a=ml(s);a!==null&&(t.splice(e,3),e-=3,Xm(a,{pending:!0,data:i,method:s.method,action:n},n,i))}}))}function Jr(t){function e(c){return fu(c,t)}Ci!==null&&fu(Ci,t),Ii!==null&&fu(Ii,t),Oi!==null&&fu(Oi,t),Fo.forEach(e),Vo.forEach(e);for(var s=0;s<di.length;s++){var n=di[s];n.blockedOn===t&&(n.blockedOn=null)}for(;0<di.length&&(s=di[0],s.blockedOn===null);)VN(s),s.blockedOn===null&&di.shift();if(s=(t.ownerDocument||t).$$reactFormReplay,s!=null)for(n=0;n<s.length;n+=3){var i=s[n],a=s[n+1],l=i[us]||null;if(typeof a=="function")l||Pv(s);else if(l){var o=null;if(a&&a.hasAttribute("formAction")){if(i=a,l=a[us]||null)o=l.formAction;else if(_g(i)!==null)continue}else o=l.action;typeof o=="function"?s[n+1]=o:(s.splice(n,3),n-=3),Pv(s)}}}function zN(){function t(a){a.canIntercept&&a.info==="react-transition"&&a.intercept({handler:function(){return new Promise(function(l){return i=l})},focusReset:"manual",scroll:"manual"})}function e(){i!==null&&(i(),i=null),n||setTimeout(s,20)}function s(){if(!n&&!navigation.transition){var a=navigation.currentEntry;a&&a.url!=null&&navigation.navigate(a.url,{state:a.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var n=!1,i=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",e),navigation.addEventListener("navigateerror",e),setTimeout(s,100),function(){n=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",e),navigation.removeEventListener("navigateerror",e),i!==null&&(i(),i=null)}}}function wg(t){this._internalRoot=t}Ef.prototype.render=wg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(K(409));var s=e.current,n=_s();$N(s,n,t,e,null,null)};Ef.prototype.unmount=wg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;$N(t.current,2,null,t,null,null),kf(),e[hl]=null}};function Ef(t){this._internalRoot=t}Ef.prototype.unstable_scheduleHydration=function(t){if(t){var e=yw();t={blockedOn:null,target:t,priority:e};for(var s=0;s<di.length&&e!==0&&e<di[s].priority;s++);di.splice(s,0,t),s===0&&VN(t)}};var Bv=rw.version;if(Bv!=="19.2.3")throw Error(K(527,Bv,"19.2.3"));Ce.findDOMNode=function(t){var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(K(188)):(t=Object.keys(t).join(","),Error(K(268,t)));return t=rT(e),t=t!==null?uw(t):null,t=t===null?null:t.stateNode,t};var CR={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:ce,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var mu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mu.isDisabled&&mu.supportsFiber)try{xc=mu.inject(CR),vs=mu}catch{}}cf.createRoot=function(t,e){if(!lw(t))throw Error(K(299));var s=!1,n="",i=Lk,a=Pk,l=Bk;return e!=null&&(e.unstable_strictMode===!0&&(s=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onUncaughtError!==void 0&&(i=e.onUncaughtError),e.onCaughtError!==void 0&&(a=e.onCaughtError),e.onRecoverableError!==void 0&&(l=e.onRecoverableError)),e=UN(t,1,!1,null,null,s,n,null,i,a,l,zN),t[hl]=e.current,gg(t),new wg(e)};cf.hydrateRoot=function(t,e,s){if(!lw(t))throw Error(K(299));var n=!1,i="",a=Lk,l=Pk,o=Bk,c=null;return s!=null&&(s.unstable_strictMode===!0&&(n=!0),s.identifierPrefix!==void 0&&(i=s.identifierPrefix),s.onUncaughtError!==void 0&&(a=s.onUncaughtError),s.onCaughtError!==void 0&&(l=s.onCaughtError),s.onRecoverableError!==void 0&&(o=s.onRecoverableError),s.formState!==void 0&&(c=s.formState)),e=UN(t,1,!0,e,s??null,n,i,c,a,l,o,zN),e.context=HN(null),s=e.current,n=_s(),n=Rp(n),i=ji(n),i.callback=null,Ti(s,i,n),s=n,e.current.lanes=s,vc(e,s),xn(e),t[hl]=e.current,gg(t),new Ef(e)};cf.version="19.2.3";function KN(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(KN)}catch(t){console.error(t)}}KN(),ew.exports=cf;var IR=ew.exports;const OR=V_(IR);/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function zo(){return zo=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},zo.apply(this,arguments)}var _i;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(_i||(_i={}));const Uv="popstate";function MR(t){t===void 0&&(t={});function e(n,i){let{pathname:a,search:l,hash:o}=n.location;return x0("",{pathname:a,search:l,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function s(n,i){return typeof i=="string"?i:YN(i)}return LR(e,s,null,t)}function wt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function kg(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function DR(){return Math.random().toString(36).substr(2,8)}function Hv(t,e){return{usr:t.state,key:t.key,idx:e}}function x0(t,e,s,n){return s===void 0&&(s=null),zo({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?yl(e):e,{state:s,key:e&&e.key||n||DR()})}function YN(t){let{pathname:e="/",search:s="",hash:n=""}=t;return s&&s!=="?"&&(e+=s.charAt(0)==="?"?s:"?"+s),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function yl(t){let e={};if(t){let s=t.indexOf("#");s>=0&&(e.hash=t.substr(s),t=t.substr(0,s));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function LR(t,e,s,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:a=!1}=n,l=i.history,o=_i.Pop,c=null,u=d();u==null&&(u=0,l.replaceState(zo({},l.state,{idx:u}),""));function d(){return(l.state||{idx:null}).idx}function f(){o=_i.Pop;let b=d(),g=b==null?null:b-u;u=b,c&&c({action:o,location:x.location,delta:g})}function h(b,g){o=_i.Push;let p=x0(x.location,b,g);u=d()+1;let y=Hv(p,u),k=x.createHref(p);try{l.pushState(y,"",k)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;i.location.assign(k)}a&&c&&c({action:o,location:x.location,delta:1})}function m(b,g){o=_i.Replace;let p=x0(x.location,b,g);u=d();let y=Hv(p,u),k=x.createHref(p);l.replaceState(y,"",k),a&&c&&c({action:o,location:x.location,delta:0})}function v(b){let g=i.location.origin!=="null"?i.location.origin:i.location.href,p=typeof b=="string"?b:YN(b);return p=p.replace(/ $/,"%20"),wt(g,"No window.location.(origin|href) available to create URL for href: "+p),new URL(p,g)}let x={get action(){return o},get location(){return t(i,l)},listen(b){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(Uv,f),c=b,()=>{i.removeEventListener(Uv,f),c=null}},createHref(b){return e(i,b)},createURL:v,encodeLocation(b){let g=v(b);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:h,replace:m,go(b){return l.go(b)}};return x}var $v;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})($v||($v={}));function PR(t,e,s){return s===void 0&&(s="/"),BR(t,e,s)}function BR(t,e,s,n){let i=typeof e=="string"?yl(e):e,a=XN(i.pathname||"/",s);if(a==null)return null;let l=WN(t);UR(l);let o=null;for(let c=0;o==null&&c<l.length;++c){let u=QR(a);o=WR(l[c],u)}return o}function WN(t,e,s,n){e===void 0&&(e=[]),s===void 0&&(s=[]),n===void 0&&(n="");let i=(a,l,o)=>{let c={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:l,route:a};c.relativePath.startsWith("/")&&(wt(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=Ta([n,c.relativePath]),d=s.concat(c);a.children&&a.children.length>0&&(wt(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),WN(a.children,e,d,u)),!(a.path==null&&!a.index)&&e.push({path:u,score:KR(u,a.index),routesMeta:d})};return t.forEach((a,l)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))i(a,l);else for(let c of qN(a.path))i(a,l,c)}),e}function qN(t){let e=t.split("/");if(e.length===0)return[];let[s,...n]=e,i=s.endsWith("?"),a=s.replace(/\?$/,"");if(n.length===0)return i?[a,""]:[a];let l=qN(n.join("/")),o=[];return o.push(...l.map(c=>c===""?a:[a,c].join("/"))),i&&o.push(...l),o.map(c=>t.startsWith("/")&&c===""?"/":c)}function UR(t){t.sort((e,s)=>e.score!==s.score?s.score-e.score:YR(e.routesMeta.map(n=>n.childrenIndex),s.routesMeta.map(n=>n.childrenIndex)))}const HR=/^:[\w-]+$/,$R=3,GR=2,FR=1,VR=10,zR=-2,Gv=t=>t==="*";function KR(t,e){let s=t.split("/"),n=s.length;return s.some(Gv)&&(n+=zR),e&&(n+=GR),s.filter(i=>!Gv(i)).reduce((i,a)=>i+(HR.test(a)?$R:a===""?FR:VR),n)}function YR(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function WR(t,e,s){let{routesMeta:n}=t,i={},a="/",l=[];for(let o=0;o<n.length;++o){let c=n[o],u=o===n.length-1,d=a==="/"?e:e.slice(a.length)||"/",f=qR({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),h=c.route;if(!f)return null;Object.assign(i,f.params),l.push({params:i,pathname:Ta([a,f.pathname]),pathnameBase:sC(Ta([a,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(a=Ta([a,f.pathnameBase]))}return l}function qR(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[s,n]=XR(t.path,t.caseSensitive,t.end),i=e.match(s);if(!i)return null;let a=i[0],l=a.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:n.reduce((u,d,f)=>{let{paramName:h,isOptional:m}=d;if(h==="*"){let x=o[f]||"";l=a.slice(0,a.length-x.length).replace(/(.)\/+$/,"$1")}const v=o[f];return m&&!v?u[h]=void 0:u[h]=(v||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:l,pattern:t}}function XR(t,e,s){e===void 0&&(e=!1),s===void 0&&(s=!0),kg(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,o,c)=>(n.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function QR(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return kg(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function XN(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let s=e.endsWith("/")?e.length-1:e.length,n=t.charAt(s);return n&&n!=="/"?null:t.slice(s)||"/"}const JR=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ZR=t=>JR.test(t);function eC(t,e){e===void 0&&(e="/");let{pathname:s,search:n="",hash:i=""}=typeof t=="string"?yl(t):t,a;if(s)if(ZR(s))a=s;else{if(s.includes("//")){let l=s;s=s.replace(/\/\/+/g,"/"),kg(!1,"Pathnames cannot have embedded double slashes - normalizing "+(l+" -> "+s))}s.startsWith("/")?a=Fv(s.substring(1),"/"):a=Fv(s,e)}else a=e;return{pathname:a,search:nC(n),hash:iC(i)}}function Fv(t,e){let s=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?s.length>1&&s.pop():i!=="."&&s.push(i)}),s.length>1?s.join("/"):"/"}function Hh(t,e,s,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+s+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function tC(t){return t.filter((e,s)=>s===0||e.route.path&&e.route.path.length>0)}function QN(t,e){let s=tC(t);return e?s.map((n,i)=>i===s.length-1?n.pathname:n.pathnameBase):s.map(n=>n.pathnameBase)}function JN(t,e,s,n){n===void 0&&(n=!1);let i;typeof t=="string"?i=yl(t):(i=zo({},t),wt(!i.pathname||!i.pathname.includes("?"),Hh("?","pathname","search",i)),wt(!i.pathname||!i.pathname.includes("#"),Hh("#","pathname","hash",i)),wt(!i.search||!i.search.includes("#"),Hh("#","search","hash",i)));let a=t===""||i.pathname==="",l=a?"/":i.pathname,o;if(l==null)o=s;else{let f=e.length-1;if(!n&&l.startsWith("..")){let h=l.split("/");for(;h[0]==="..";)h.shift(),f-=1;i.pathname=h.join("/")}o=f>=0?e[f]:"/"}let c=eC(i,o),u=l&&l!=="/"&&l.endsWith("/"),d=(a||l===".")&&s.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const Ta=t=>t.join("/").replace(/\/\/+/g,"/"),sC=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),nC=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,iC=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function aC(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const ZN=["post","put","patch","delete"];new Set(ZN);const rC=["get",...ZN];new Set(rC);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ko(){return Ko=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},Ko.apply(this,arguments)}const Ng=_.createContext(null),lC=_.createContext(null),Tc=_.createContext(null),jf=_.createContext(null),na=_.createContext({outlet:null,matches:[],isDataRoute:!1}),eS=_.createContext(null);function Ac(){return _.useContext(jf)!=null}function Tf(){return Ac()||wt(!1),_.useContext(jf).location}function tS(t){_.useContext(Tc).static||_.useLayoutEffect(t)}function _l(){let{isDataRoute:t}=_.useContext(na);return t?yC():oC()}function oC(){Ac()||wt(!1);let t=_.useContext(Ng),{basename:e,future:s,navigator:n}=_.useContext(Tc),{matches:i}=_.useContext(na),{pathname:a}=Tf(),l=JSON.stringify(QN(i,s.v7_relativeSplatPath)),o=_.useRef(!1);return tS(()=>{o.current=!0}),_.useCallback(function(u,d){if(d===void 0&&(d={}),!o.current)return;if(typeof u=="number"){n.go(u);return}let f=JN(u,JSON.parse(l),a,d.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:Ta([e,f.pathname])),(d.replace?n.replace:n.push)(f,d.state,d)},[e,n,l,a,t])}function sS(){let{matches:t}=_.useContext(na),e=t[t.length-1];return e?e.params:{}}function cC(t,e){return uC(t,e)}function uC(t,e,s,n){Ac()||wt(!1);let{navigator:i}=_.useContext(Tc),{matches:a}=_.useContext(na),l=a[a.length-1],o=l?l.params:{};l&&l.pathname;let c=l?l.pathnameBase:"/";l&&l.route;let u=Tf(),d;if(e){var f;let b=typeof e=="string"?yl(e):e;c==="/"||(f=b.pathname)!=null&&f.startsWith(c)||wt(!1),d=b}else d=u;let h=d.pathname||"/",m=h;if(c!=="/"){let b=c.replace(/^\//,"").split("/");m="/"+h.replace(/^\//,"").split("/").slice(b.length).join("/")}let v=PR(t,{pathname:m}),x=pC(v&&v.map(b=>Object.assign({},b,{params:Object.assign({},o,b.params),pathname:Ta([c,i.encodeLocation?i.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?c:Ta([c,i.encodeLocation?i.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),a,s,n);return e&&x?_.createElement(jf.Provider,{value:{location:Ko({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:_i.Pop}},x):x}function dC(){let t=vC(),e=aC(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),s=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return _.createElement(_.Fragment,null,_.createElement("h2",null,"Unexpected Application Error!"),_.createElement("h3",{style:{fontStyle:"italic"}},e),s?_.createElement("pre",{style:i},s):null,null)}const fC=_.createElement(dC,null);class hC extends _.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,s){return s.location!==e.location||s.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:s.error,location:s.location,revalidation:e.revalidation||s.revalidation}}componentDidCatch(e,s){console.error("React Router caught the following error during render",e,s)}render(){return this.state.error!==void 0?_.createElement(na.Provider,{value:this.props.routeContext},_.createElement(eS.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function mC(t){let{routeContext:e,match:s,children:n}=t,i=_.useContext(Ng);return i&&i.static&&i.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=s.route.id),_.createElement(na.Provider,{value:e},n)}function pC(t,e,s,n){var i;if(e===void 0&&(e=[]),s===void 0&&(s=null),n===void 0&&(n=null),t==null){var a;if(!s)return null;if(s.errors)t=s.matches;else if((a=n)!=null&&a.v7_partialHydration&&e.length===0&&!s.initialized&&s.matches.length>0)t=s.matches;else return null}let l=t,o=(i=s)==null?void 0:i.errors;if(o!=null){let d=l.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);d>=0||wt(!1),l=l.slice(0,Math.min(l.length,d+1))}let c=!1,u=-1;if(s&&n&&n.v7_partialHydration)for(let d=0;d<l.length;d++){let f=l[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=d),f.route.id){let{loaderData:h,errors:m}=s,v=f.route.loader&&h[f.route.id]===void 0&&(!m||m[f.route.id]===void 0);if(f.route.lazy||v){c=!0,u>=0?l=l.slice(0,u+1):l=[l[0]];break}}}return l.reduceRight((d,f,h)=>{let m,v=!1,x=null,b=null;s&&(m=o&&f.route.id?o[f.route.id]:void 0,x=f.route.errorElement||fC,c&&(u<0&&h===0?(_C("route-fallback"),v=!0,b=null):u===h&&(v=!0,b=f.route.hydrateFallbackElement||null)));let g=e.concat(l.slice(0,h+1)),p=()=>{let y;return m?y=x:v?y=b:f.route.Component?y=_.createElement(f.route.Component,null):f.route.element?y=f.route.element:y=d,_.createElement(mC,{match:f,routeContext:{outlet:d,matches:g,isDataRoute:s!=null},children:y})};return s&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?_.createElement(hC,{location:s.location,revalidation:s.revalidation,component:x,error:m,children:p(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):p()},null)}var nS=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(nS||{}),iS=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(iS||{});function gC(t){let e=_.useContext(Ng);return e||wt(!1),e}function xC(t){let e=_.useContext(lC);return e||wt(!1),e}function bC(t){let e=_.useContext(na);return e||wt(!1),e}function aS(t){let e=bC(),s=e.matches[e.matches.length-1];return s.route.id||wt(!1),s.route.id}function vC(){var t;let e=_.useContext(eS),s=xC(),n=aS();return e!==void 0?e:(t=s.errors)==null?void 0:t[n]}function yC(){let{router:t}=gC(nS.UseNavigateStable),e=aS(iS.UseNavigateStable),s=_.useRef(!1);return tS(()=>{s.current=!0}),_.useCallback(function(i,a){a===void 0&&(a={}),s.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Ko({fromRouteId:e},a)))},[t,e])}const Vv={};function _C(t,e,s){Vv[t]||(Vv[t]=!0)}function wC(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function kC(t){let{to:e,replace:s,state:n,relative:i}=t;Ac()||wt(!1);let{future:a,static:l}=_.useContext(Tc),{matches:o}=_.useContext(na),{pathname:c}=Tf(),u=_l(),d=JN(e,QN(o,a.v7_relativeSplatPath),c,i==="path"),f=JSON.stringify(d);return _.useEffect(()=>u(JSON.parse(f),{replace:s,state:n,relative:i}),[u,f,i,s,n]),null}function eo(t){wt(!1)}function NC(t){let{basename:e="/",children:s=null,location:n,navigationType:i=_i.Pop,navigator:a,static:l=!1,future:o}=t;Ac()&&wt(!1);let c=e.replace(/^\/*/,"/"),u=_.useMemo(()=>({basename:c,navigator:a,static:l,future:Ko({v7_relativeSplatPath:!1},o)}),[c,o,a,l]);typeof n=="string"&&(n=yl(n));let{pathname:d="/",search:f="",hash:h="",state:m=null,key:v="default"}=n,x=_.useMemo(()=>{let b=XN(d,c);return b==null?null:{location:{pathname:b,search:f,hash:h,state:m,key:v},navigationType:i}},[c,d,f,h,m,v,i]);return x==null?null:_.createElement(Tc.Provider,{value:u},_.createElement(jf.Provider,{children:s,value:x}))}function SC(t){let{children:e,location:s}=t;return cC(b0(e),s)}new Promise(()=>{});function b0(t,e){e===void 0&&(e=[]);let s=[];return _.Children.forEach(t,(n,i)=>{if(!_.isValidElement(n))return;let a=[...e,i];if(n.type===_.Fragment){s.push.apply(s,b0(n.props.children,a));return}n.type!==eo&&wt(!1),!n.props.index||!n.props.children||wt(!1);let l={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=b0(n.props.children,a)),s.push(l)}),s}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function v0(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,s)=>{let n=t[s];return e.concat(Array.isArray(n)?n.map(i=>[s,i]):[[s,n]])},[]))}function EC(t,e){let s=v0(t);return e&&e.forEach((n,i)=>{s.has(i)||e.getAll(i).forEach(a=>{s.append(i,a)})}),s}const jC="6";try{window.__reactRouterVersion=jC}catch{}const TC="startTransition",zv=Zj[TC];function AC(t){let{basename:e,children:s,future:n,window:i}=t,a=_.useRef();a.current==null&&(a.current=MR({window:i,v5Compat:!0}));let l=a.current,[o,c]=_.useState({action:l.action,location:l.location}),{v7_startTransition:u}=n||{},d=_.useCallback(f=>{u&&zv?zv(()=>c(f)):c(f)},[c,u]);return _.useLayoutEffect(()=>l.listen(d),[l,d]),_.useEffect(()=>wC(n),[n]),_.createElement(NC,{basename:e,children:s,location:o.location,navigationType:o.action,navigator:l,future:n})}var Kv;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Kv||(Kv={}));var Yv;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Yv||(Yv={}));function RC(t){let e=_.useRef(v0(t)),s=_.useRef(!1),n=Tf(),i=_.useMemo(()=>EC(n.search,s.current?null:e.current),[n.search]),a=_l(),l=_.useCallback((o,c)=>{const u=v0(typeof o=="function"?o(i):o);s.current=!0,a("?"+u,c)},[a,i]);return[i,l]}const rS=_.createContext({setFullWidth:()=>{},setHideHeader:()=>{}}),lS=()=>_.useContext(rS),CC=({children:t})=>{const[,e]=_.useState(!1),[,s]=_.useState(!1);return r.jsx(rS.Provider,{value:{setFullWidth:e,setHideHeader:s},children:t})},IC=()=>{};var Wv={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oS={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X=function(t,e){if(!t)throw wl(e)},wl=function(t){return new Error("Firebase Database ("+oS.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cS=function(t){const e=[];let s=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[s++]=i:i<2048?(e[s++]=i>>6|192,e[s++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[s++]=i>>18|240,e[s++]=i>>12&63|128,e[s++]=i>>6&63|128,e[s++]=i&63|128):(e[s++]=i>>12|224,e[s++]=i>>6&63|128,e[s++]=i&63|128)}return e},OC=function(t){const e=[];let s=0,n=0;for(;s<t.length;){const i=t[s++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const a=t[s++];e[n++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=t[s++],l=t[s++],o=t[s++],c=((i&7)<<18|(a&63)<<12|(l&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const a=t[s++],l=t[s++];e[n++]=String.fromCharCode((i&15)<<12|(a&63)<<6|l&63)}}return e.join("")},Sg={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const s=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const a=t[i],l=i+1<t.length,o=l?t[i+1]:0,c=i+2<t.length,u=c?t[i+2]:0,d=a>>2,f=(a&3)<<4|o>>4;let h=(o&15)<<2|u>>6,m=u&63;c||(m=64,l||(h=64)),n.push(s[d],s[f],s[h],s[m])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(cS(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):OC(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const s=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const a=s[t.charAt(i++)],o=i<t.length?s[t.charAt(i)]:0;++i;const u=i<t.length?s[t.charAt(i)]:64;++i;const f=i<t.length?s[t.charAt(i)]:64;if(++i,a==null||o==null||u==null||f==null)throw new MC;const h=a<<2|o>>4;if(n.push(h),u!==64){const m=o<<4&240|u>>2;if(n.push(m),f!==64){const v=u<<6&192|f;n.push(v)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class MC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const uS=function(t){const e=cS(t);return Sg.encodeByteArray(e,!0)},Sd=function(t){return uS(t).replace(/\./g,"")},Ed=function(t){try{return Sg.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DC(t){return dS(void 0,t)}function dS(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const s=e;return new Date(s.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const s in e)!e.hasOwnProperty(s)||!LC(s)||(t[s]=dS(t[s],e[s]));return t}function LC(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BC=()=>PC().__FIREBASE_DEFAULTS__,UC=()=>{if(typeof process>"u"||typeof Wv>"u")return;const t=Wv.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},HC=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Ed(t[1]);return e&&JSON.parse(e)},Eg=()=>{try{return IC()||BC()||UC()||HC()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},fS=t=>{var e,s;return(s=(e=Eg())===null||e===void 0?void 0:e.emulatorHosts)===null||s===void 0?void 0:s[t]},$C=t=>{const e=fS(t);if(!e)return;const s=e.lastIndexOf(":");if(s<=0||s+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(s+1),10);return e[0]==="["?[e.substring(1,s-1),n]:[e.substring(0,s),n]},hS=()=>{var t;return(t=Eg())===null||t===void 0?void 0:t.config},mS=t=>{var e;return(e=Eg())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,s)=>{this.resolve=e,this.reject=s})}wrapCallback(e){return(s,n)=>{s?this.reject(s):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(s):e(s,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kl(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function pS(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GC(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const s={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Sd(JSON.stringify(s)),Sd(JSON.stringify(l)),""].join(".")}const vo={};function FC(){const t={prod:[],emulator:[]};for(const e of Object.keys(vo))vo[e]?t.emulator.push(e):t.prod.push(e);return t}function VC(t){let e=document.getElementById(t),s=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),s=!0),{created:s,element:e}}let qv=!1;function gS(t,e){if(typeof window>"u"||typeof document>"u"||!kl(window.location.host)||vo[t]===e||vo[t]||qv)return;vo[t]=e;function s(h){return`__firebase__banner__${h}`}const n="__firebase__banner",a=FC().prod.length>0;function l(){const h=document.getElementById(n);h&&h.remove()}function o(h){h.style.display="flex",h.style.background="#7faaf0",h.style.position="fixed",h.style.bottom="5px",h.style.left="5px",h.style.padding=".5em",h.style.borderRadius="5px",h.style.alignItems="center"}function c(h,m){h.setAttribute("width","24"),h.setAttribute("id",m),h.setAttribute("height","24"),h.setAttribute("viewBox","0 0 24 24"),h.setAttribute("fill","none"),h.style.marginLeft="-6px"}function u(){const h=document.createElement("span");return h.style.cursor="pointer",h.style.marginLeft="16px",h.style.fontSize="24px",h.innerHTML=" &times;",h.onclick=()=>{qv=!0,l()},h}function d(h,m){h.setAttribute("id",m),h.innerText="Learn more",h.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",h.setAttribute("target","__blank"),h.style.paddingLeft="5px",h.style.textDecoration="underline"}function f(){const h=VC(n),m=s("text"),v=document.getElementById(m)||document.createElement("span"),x=s("learnmore"),b=document.getElementById(x)||document.createElement("a"),g=s("preprendIcon"),p=document.getElementById(g)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(h.created){const y=h.element;o(y),d(b,x);const k=u();c(p,g),y.append(p,v,b,k),document.body.appendChild(y)}a?(v.innerText="Preview backend disconnected.",p.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(p.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,v.innerText="Preview backend running in this workspace."),v.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function jg(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Jt())}function zC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function KC(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function xS(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function YC(){const t=Jt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function WC(){return oS.NODE_ADMIN===!0}function qC(){try{return typeof indexedDB=="object"}catch{return!1}}function XC(){return new Promise((t,e)=>{try{let s=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),s||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{s=!1},i.onerror=()=>{var a;e(((a=i.error)===null||a===void 0?void 0:a.message)||"")}}catch(s){e(s)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QC="FirebaseError";class ia extends Error{constructor(e,s,n){super(s),this.code=e,this.customData=n,this.name=QC,Object.setPrototypeOf(this,ia.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Rc.prototype.create)}}class Rc{constructor(e,s,n){this.service=e,this.serviceName=s,this.errors=n}create(e,...s){const n=s[0]||{},i=`${this.service}/${e}`,a=this.errors[e],l=a?JC(a,n):"Error",o=`${this.serviceName}: ${l} (${i}).`;return new ia(i,o,n)}}function JC(t,e){return t.replace(ZC,(s,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const ZC=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yo(t){return JSON.parse(t)}function Tt(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bS=function(t){let e={},s={},n={},i="";try{const a=t.split(".");e=Yo(Ed(a[0])||""),s=Yo(Ed(a[1])||""),i=a[2],n=s.d||{},delete s.d}catch{}return{header:e,claims:s,data:n,signature:i}},eI=function(t){const e=bS(t),s=e.claims;return!!s&&typeof s=="object"&&s.hasOwnProperty("iat")},tI=function(t){const e=bS(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function an(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Ba(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function jd(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Td(t,e,s){const n={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=e.call(s,t[i],i,t));return n}function Ua(t,e){if(t===e)return!0;const s=Object.keys(t),n=Object.keys(e);for(const i of s){if(!n.includes(i))return!1;const a=t[i],l=e[i];if(Xv(a)&&Xv(l)){if(!Ua(a,l))return!1}else if(a!==l)return!1}for(const i of n)if(!s.includes(i))return!1;return!0}function Xv(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nl(t){const e=[];for(const[s,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(s)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(s)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function to(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,a]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(a)}}),e}function so(t){const e=t.indexOf("?");if(!e)return"";const s=t.indexOf("#",e);return t.substring(e,s>0?s:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sI{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,s){s||(s=0);const n=this.W_;if(typeof e=="string")for(let f=0;f<16;f++)n[f]=e.charCodeAt(s)<<24|e.charCodeAt(s+1)<<16|e.charCodeAt(s+2)<<8|e.charCodeAt(s+3),s+=4;else for(let f=0;f<16;f++)n[f]=e[s]<<24|e[s+1]<<16|e[s+2]<<8|e[s+3],s+=4;for(let f=16;f<80;f++){const h=n[f-3]^n[f-8]^n[f-14]^n[f-16];n[f]=(h<<1|h>>>31)&4294967295}let i=this.chain_[0],a=this.chain_[1],l=this.chain_[2],o=this.chain_[3],c=this.chain_[4],u,d;for(let f=0;f<80;f++){f<40?f<20?(u=o^a&(l^o),d=1518500249):(u=a^l^o,d=1859775393):f<60?(u=a&l|o&(a|l),d=2400959708):(u=a^l^o,d=3395469782);const h=(i<<5|i>>>27)+u+c+d+n[f]&4294967295;c=o,o=l,l=(a<<30|a>>>2)&4294967295,a=i,i=h}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+a&4294967295,this.chain_[2]=this.chain_[2]+l&4294967295,this.chain_[3]=this.chain_[3]+o&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,s){if(e==null)return;s===void 0&&(s=e.length);const n=s-this.blockSize;let i=0;const a=this.buf_;let l=this.inbuf_;for(;i<s;){if(l===0)for(;i<=n;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<s;)if(a[l]=e.charCodeAt(i),++l,++i,l===this.blockSize){this.compress_(a),l=0;break}}else for(;i<s;)if(a[l]=e[i],++l,++i,l===this.blockSize){this.compress_(a),l=0;break}}this.inbuf_=l,this.total_+=s}digest(){const e=[];let s=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=s&255,s/=256;this.compress_(this.buf_);let n=0;for(let i=0;i<5;i++)for(let a=24;a>=0;a-=8)e[n]=this.chain_[i]>>a&255,++n;return e}}function nI(t,e){const s=new iI(t,e);return s.subscribe.bind(s)}class iI{constructor(e,s){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=s,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(s=>{s.next(e)})}error(e){this.forEachObserver(s=>{s.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,s,n){let i;if(e===void 0&&s===void 0&&n===void 0)throw new Error("Missing Observer.");aI(e,["next","error","complete"])?i=e:i={next:e,error:s,complete:n},i.next===void 0&&(i.next=$h),i.error===void 0&&(i.error=$h),i.complete===void 0&&(i.complete=$h);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let s=0;s<this.observers.length;s++)this.sendOne(s,e)}sendOne(e,s){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{s(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function aI(t,e){if(typeof t!="object"||t===null)return!1;for(const s of e)if(s in t&&typeof t[s]=="function")return!0;return!1}function $h(){}function Zr(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rI=function(t){const e=[];let s=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);if(i>=55296&&i<=56319){const a=i-55296;n++,X(n<t.length,"Surrogate pair missing trail surrogate.");const l=t.charCodeAt(n)-56320;i=65536+(a<<10)+l}i<128?e[s++]=i:i<2048?(e[s++]=i>>6|192,e[s++]=i&63|128):i<65536?(e[s++]=i>>12|224,e[s++]=i>>6&63|128,e[s++]=i&63|128):(e[s++]=i>>18|240,e[s++]=i>>12&63|128,e[s++]=i>>6&63|128,e[s++]=i&63|128)}return e},Af=function(t){let e=0;for(let s=0;s<t.length;s++){const n=t.charCodeAt(s);n<128?e++:n<2048?e+=2:n>=55296&&n<=56319?(e+=4,s++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nt(t){return t&&t._delegate?t._delegate:t}class Ha{constructor(e,s,n){this.name=e,this.instanceFactory=s,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ga="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lI{constructor(e,s){this.name=e,this.container=s,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const s=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(s)){const n=new qs;if(this.instancesDeferred.set(s,n),this.isInitialized(s)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:s});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(s).promise}getImmediate(e){var s;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(s=e==null?void 0:e.optional)!==null&&s!==void 0?s:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(i)return null;throw a}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(cI(e))try{this.getOrInitializeService({instanceIdentifier:ga})}catch{}for(const[s,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(s);try{const a=this.getOrInitializeService({instanceIdentifier:i});n.resolve(a)}catch{}}}}clearInstance(e=ga){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(s=>"INTERNAL"in s).map(s=>s.INTERNAL.delete()),...e.filter(s=>"_delete"in s).map(s=>s._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ga){return this.instances.has(e)}getOptions(e=ga){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:s={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:s});for(const[a,l]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(a);n===o&&l.resolve(i)}return i}onInit(e,s){var n;const i=this.normalizeInstanceIdentifier(s),a=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;a.add(e),this.onInitCallbacks.set(i,a);const l=this.instances.get(i);return l&&e(l,i),()=>{a.delete(e)}}invokeOnInitCallbacks(e,s){const n=this.onInitCallbacks.get(s);if(n)for(const i of n)try{i(e,s)}catch{}}getOrInitializeService({instanceIdentifier:e,options:s={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:oI(e),options:s}),this.instances.set(e,n),this.instancesOptions.set(e,s),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=ga){return this.component?this.component.multipleInstances?e:ga:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function oI(t){return t===ga?void 0:t}function cI(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const s=this.getProvider(e.name);if(s.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);s.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const s=new lI(e,this);return this.providers.set(e,s),s}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var He;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(He||(He={}));const dI={debug:He.DEBUG,verbose:He.VERBOSE,info:He.INFO,warn:He.WARN,error:He.ERROR,silent:He.SILENT},fI=He.INFO,hI={[He.DEBUG]:"log",[He.VERBOSE]:"log",[He.INFO]:"info",[He.WARN]:"warn",[He.ERROR]:"error"},mI=(t,e,...s)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=hI[e];if(i)console[i](`[${n}]  ${t.name}:`,...s);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Tg{constructor(e){this.name=e,this._logLevel=fI,this._logHandler=mI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in He))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?dI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,He.DEBUG,...e),this._logHandler(this,He.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,He.VERBOSE,...e),this._logHandler(this,He.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,He.INFO,...e),this._logHandler(this,He.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,He.WARN,...e),this._logHandler(this,He.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,He.ERROR,...e),this._logHandler(this,He.ERROR,...e)}}const pI=(t,e)=>e.some(s=>t instanceof s);let Qv,Jv;function gI(){return Qv||(Qv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function xI(){return Jv||(Jv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const vS=new WeakMap,y0=new WeakMap,yS=new WeakMap,Gh=new WeakMap,Ag=new WeakMap;function bI(t){const e=new Promise((s,n)=>{const i=()=>{t.removeEventListener("success",a),t.removeEventListener("error",l)},a=()=>{s(Mi(t.result)),i()},l=()=>{n(t.error),i()};t.addEventListener("success",a),t.addEventListener("error",l)});return e.then(s=>{s instanceof IDBCursor&&vS.set(s,t)}).catch(()=>{}),Ag.set(e,t),e}function vI(t){if(y0.has(t))return;const e=new Promise((s,n)=>{const i=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",l),t.removeEventListener("abort",l)},a=()=>{s(),i()},l=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",a),t.addEventListener("error",l),t.addEventListener("abort",l)});y0.set(t,e)}let _0={get(t,e,s){if(t instanceof IDBTransaction){if(e==="done")return y0.get(t);if(e==="objectStoreNames")return t.objectStoreNames||yS.get(t);if(e==="store")return s.objectStoreNames[1]?void 0:s.objectStore(s.objectStoreNames[0])}return Mi(t[e])},set(t,e,s){return t[e]=s,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function yI(t){_0=t(_0)}function _I(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...s){const n=t.call(Fh(this),e,...s);return yS.set(n,e.sort?e.sort():[e]),Mi(n)}:xI().includes(t)?function(...e){return t.apply(Fh(this),e),Mi(vS.get(this))}:function(...e){return Mi(t.apply(Fh(this),e))}}function wI(t){return typeof t=="function"?_I(t):(t instanceof IDBTransaction&&vI(t),pI(t,gI())?new Proxy(t,_0):t)}function Mi(t){if(t instanceof IDBRequest)return bI(t);if(Gh.has(t))return Gh.get(t);const e=wI(t);return e!==t&&(Gh.set(t,e),Ag.set(e,t)),e}const Fh=t=>Ag.get(t);function kI(t,e,{blocked:s,upgrade:n,blocking:i,terminated:a}={}){const l=indexedDB.open(t,e),o=Mi(l);return n&&l.addEventListener("upgradeneeded",c=>{n(Mi(l.result),c.oldVersion,c.newVersion,Mi(l.transaction),c)}),s&&l.addEventListener("blocked",c=>s(c.oldVersion,c.newVersion,c)),o.then(c=>{a&&c.addEventListener("close",()=>a()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),o}const NI=["get","getKey","getAll","getAllKeys","count"],SI=["put","add","delete","clear"],Vh=new Map;function Zv(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Vh.get(e))return Vh.get(e);const s=e.replace(/FromIndex$/,""),n=e!==s,i=SI.includes(s);if(!(s in(n?IDBIndex:IDBObjectStore).prototype)||!(i||NI.includes(s)))return;const a=async function(l,...o){const c=this.transaction(l,i?"readwrite":"readonly");let u=c.store;return n&&(u=u.index(o.shift())),(await Promise.all([u[s](...o),i&&c.done]))[0]};return Vh.set(e,a),a}yI(t=>({...t,get:(e,s,n)=>Zv(e,s)||t.get(e,s,n),has:(e,s)=>!!Zv(e,s)||t.has(e,s)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(s=>{if(jI(s)){const n=s.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(s=>s).join(" ")}}function jI(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const w0="@firebase/app",ey="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kn=new Tg("@firebase/app"),TI="@firebase/app-compat",AI="@firebase/analytics-compat",RI="@firebase/analytics",CI="@firebase/app-check-compat",II="@firebase/app-check",OI="@firebase/auth",MI="@firebase/auth-compat",DI="@firebase/database",LI="@firebase/data-connect",PI="@firebase/database-compat",BI="@firebase/functions",UI="@firebase/functions-compat",HI="@firebase/installations",$I="@firebase/installations-compat",GI="@firebase/messaging",FI="@firebase/messaging-compat",VI="@firebase/performance",zI="@firebase/performance-compat",KI="@firebase/remote-config",YI="@firebase/remote-config-compat",WI="@firebase/storage",qI="@firebase/storage-compat",XI="@firebase/firestore",QI="@firebase/ai",JI="@firebase/firestore-compat",ZI="firebase",eO="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k0="[DEFAULT]",tO={[w0]:"fire-core",[TI]:"fire-core-compat",[RI]:"fire-analytics",[AI]:"fire-analytics-compat",[II]:"fire-app-check",[CI]:"fire-app-check-compat",[OI]:"fire-auth",[MI]:"fire-auth-compat",[DI]:"fire-rtdb",[LI]:"fire-data-connect",[PI]:"fire-rtdb-compat",[BI]:"fire-fn",[UI]:"fire-fn-compat",[HI]:"fire-iid",[$I]:"fire-iid-compat",[GI]:"fire-fcm",[FI]:"fire-fcm-compat",[VI]:"fire-perf",[zI]:"fire-perf-compat",[KI]:"fire-rc",[YI]:"fire-rc-compat",[WI]:"fire-gcs",[qI]:"fire-gcs-compat",[XI]:"fire-fst",[JI]:"fire-fst-compat",[QI]:"fire-vertex","fire-js":"fire-js",[ZI]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ad=new Map,sO=new Map,N0=new Map;function ty(t,e){try{t.container.addComponent(e)}catch(s){Kn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,s)}}function el(t){const e=t.name;if(N0.has(e))return Kn.debug(`There were multiple attempts to register component ${e}.`),!1;N0.set(e,t);for(const s of Ad.values())ty(s,t);for(const s of sO.values())ty(s,t);return!0}function Rg(t,e){const s=t.container.getProvider("heartbeat").getImmediate({optional:!0});return s&&s.triggerHeartbeat(),t.container.getProvider(e)}function gs(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nO={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Di=new Rc("app","Firebase",nO);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iO{constructor(e,s,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},s),this._name=s.name,this._automaticDataCollectionEnabled=s.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ha("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Di.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sl=eO;function _S(t,e={}){let s=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:k0,automaticDataCollectionEnabled:!0},e),i=n.name;if(typeof i!="string"||!i)throw Di.create("bad-app-name",{appName:String(i)});if(s||(s=hS()),!s)throw Di.create("no-options");const a=Ad.get(i);if(a){if(Ua(s,a.options)&&Ua(n,a.config))return a;throw Di.create("duplicate-app",{appName:i})}const l=new uI(i);for(const c of N0.values())l.addComponent(c);const o=new iO(s,n,l);return Ad.set(i,o),o}function wS(t=k0){const e=Ad.get(t);if(!e&&t===k0&&hS())return _S();if(!e)throw Di.create("no-app",{appName:t});return e}function Li(t,e,s){var n;let i=(n=tO[t])!==null&&n!==void 0?n:t;s&&(i+=`-${s}`);const a=i.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const o=[`Unable to register library "${i}" with version "${e}":`];a&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&l&&o.push("and"),l&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Kn.warn(o.join(" "));return}el(new Ha(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aO="firebase-heartbeat-database",rO=1,Wo="firebase-heartbeat-store";let zh=null;function kS(){return zh||(zh=kI(aO,rO,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Wo)}catch(s){console.warn(s)}}}}).catch(t=>{throw Di.create("idb-open",{originalErrorMessage:t.message})})),zh}async function lO(t){try{const s=(await kS()).transaction(Wo),n=await s.objectStore(Wo).get(NS(t));return await s.done,n}catch(e){if(e instanceof ia)Kn.warn(e.message);else{const s=Di.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Kn.warn(s.message)}}}async function sy(t,e){try{const n=(await kS()).transaction(Wo,"readwrite");await n.objectStore(Wo).put(e,NS(t)),await n.done}catch(s){if(s instanceof ia)Kn.warn(s.message);else{const n=Di.create("idb-set",{originalErrorMessage:s==null?void 0:s.message});Kn.warn(n.message)}}}function NS(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oO=1024,cO=30;class uO{constructor(e){this.container=e,this._heartbeatsCache=null;const s=this.container.getProvider("app").getImmediate();this._storage=new fO(s),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,s;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=ny();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((s=this._heartbeatsCache)===null||s===void 0?void 0:s.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(l=>l.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:i}),this._heartbeatsCache.heartbeats.length>cO){const l=hO(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Kn.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const s=ny(),{heartbeatsToSend:n,unsentEntries:i}=dO(this._heartbeatsCache.heartbeats),a=Sd(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=s,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(s){return Kn.warn(s),""}}}function ny(){return new Date().toISOString().substring(0,10)}function dO(t,e=oO){const s=[];let n=t.slice();for(const i of t){const a=s.find(l=>l.agent===i.agent);if(a){if(a.dates.push(i.date),iy(s)>e){a.dates.pop();break}}else if(s.push({agent:i.agent,dates:[i.date]}),iy(s)>e){s.pop();break}n=n.slice(1)}return{heartbeatsToSend:s,unsentEntries:n}}class fO{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return qC()?XC().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const s=await lO(this.app);return s!=null&&s.heartbeats?s:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var s;if(await this._canUseIndexedDBPromise){const i=await this.read();return sy(this.app,{lastSentHeartbeatDate:(s=e.lastSentHeartbeatDate)!==null&&s!==void 0?s:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var s;if(await this._canUseIndexedDBPromise){const i=await this.read();return sy(this.app,{lastSentHeartbeatDate:(s=e.lastSentHeartbeatDate)!==null&&s!==void 0?s:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function iy(t){return Sd(JSON.stringify({version:2,heartbeats:t})).length}function hO(t){if(t.length===0)return-1;let e=0,s=t[0].date;for(let n=1;n<t.length;n++)t[n].date<s&&(s=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mO(t){el(new Ha("platform-logger",e=>new EI(e),"PRIVATE")),el(new Ha("heartbeat",e=>new uO(e),"PRIVATE")),Li(w0,ey,t),Li(w0,ey,"esm2017"),Li("fire-js","")}mO("");function Cg(t,e){var s={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(s[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(s[n[i]]=t[n[i]]);return s}function SS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const pO=SS,ES=new Rc("auth","Firebase",SS());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rd=new Tg("@firebase/auth");function gO(t,...e){Rd.logLevel<=He.WARN&&Rd.warn(`Auth (${Sl}): ${t}`,...e)}function $u(t,...e){Rd.logLevel<=He.ERROR&&Rd.error(`Auth (${Sl}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sn(t,...e){throw Ig(t,...e)}function un(t,...e){return Ig(t,...e)}function jS(t,e,s){const n=Object.assign(Object.assign({},pO()),{[e]:s});return new Rc("auth","Firebase",n).create(e,{appName:t.name})}function dn(t){return jS(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ig(t,...e){if(typeof t!="string"){const s=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(s,...n)}return ES.create(t,...e)}function re(t,e,...s){if(!t)throw Ig(e,...s)}function In(t){const e="INTERNAL ASSERTION FAILED: "+t;throw $u(e),new Error(e)}function Yn(t,e){t||In(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S0(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function xO(){return ay()==="http:"||ay()==="https:"}function ay(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bO(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(xO()||KC()||"connection"in navigator)?navigator.onLine:!0}function vO(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cc{constructor(e,s){this.shortDelay=e,this.longDelay=s,Yn(s>e,"Short delay should be less than long delay!"),this.isMobile=jg()||xS()}get(){return bO()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Og(t,e){Yn(t.emulator,"Emulator should always be set here");const{url:s}=t.emulator;return e?`${s}${e.startsWith("/")?e.slice(1):e}`:s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TS{static initialize(e,s,n){this.fetchImpl=e,s&&(this.headersImpl=s),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;In("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;In("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;In("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yO={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _O=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],wO=new Cc(3e4,6e4);function Zn(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function ei(t,e,s,n,i={}){return AS(t,i,async()=>{let a={},l={};n&&(e==="GET"?l=n:a={body:JSON.stringify(n)});const o=Nl(Object.assign({key:t.config.apiKey},l)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:c},a);return zC()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&kl(t.emulatorConfig.host)&&(u.credentials="include"),TS.fetch()(await RS(t,t.config.apiHost,s,o),u)})}async function AS(t,e,s){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},yO),e);try{const i=new NO(t),a=await Promise.race([s(),i.promise]);i.clearNetworkTimeout();const l=await a.json();if("needConfirmation"in l)throw pu(t,"account-exists-with-different-credential",l);if(a.ok&&!("errorMessage"in l))return l;{const o=a.ok?l.errorMessage:l.error.message,[c,u]=o.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw pu(t,"credential-already-in-use",l);if(c==="EMAIL_EXISTS")throw pu(t,"email-already-in-use",l);if(c==="USER_DISABLED")throw pu(t,"user-disabled",l);const d=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw jS(t,d,u);sn(t,d)}}catch(i){if(i instanceof ia)throw i;sn(t,"network-request-failed",{message:String(i)})}}async function Ic(t,e,s,n,i={}){const a=await ei(t,e,s,n,i);return"mfaPendingCredential"in a&&sn(t,"multi-factor-auth-required",{_serverResponse:a}),a}async function RS(t,e,s,n){const i=`${e}${s}?${n}`,a=t,l=a.config.emulator?Og(t.config,i):`${t.config.apiScheme}://${i}`;return _O.includes(s)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(l).toString():l}function kO(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class NO{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((s,n)=>{this.timer=setTimeout(()=>n(un(this.auth,"network-request-failed")),wO.get())})}}function pu(t,e,s){const n={appName:t.name};s.email&&(n.email=s.email),s.phoneNumber&&(n.phoneNumber=s.phoneNumber);const i=un(t,e,n);return i.customData._tokenResponse=s,i}function ry(t){return t!==void 0&&t.enterprise!==void 0}class SO{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const s of this.recaptchaEnforcementState)if(s.provider&&s.provider===e)return kO(s.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function EO(t,e){return ei(t,"GET","/v2/recaptchaConfig",Zn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jO(t,e){return ei(t,"POST","/v1/accounts:delete",e)}async function Cd(t,e){return ei(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yo(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function TO(t,e=!1){const s=Nt(t),n=await s.getIdToken(e),i=Mg(n);re(i&&i.exp&&i.auth_time&&i.iat,s.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,l=a==null?void 0:a.sign_in_provider;return{claims:i,token:n,authTime:yo(Kh(i.auth_time)),issuedAtTime:yo(Kh(i.iat)),expirationTime:yo(Kh(i.exp)),signInProvider:l||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function Kh(t){return Number(t)*1e3}function Mg(t){const[e,s,n]=t.split(".");if(e===void 0||s===void 0||n===void 0)return $u("JWT malformed, contained fewer than 3 sections"),null;try{const i=Ed(s);return i?JSON.parse(i):($u("Failed to decode base64 JWT payload"),null)}catch(i){return $u("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function ly(t){const e=Mg(t);return re(e,"internal-error"),re(typeof e.exp<"u","internal-error"),re(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qo(t,e,s=!1){if(s)return e;try{return await e}catch(n){throw n instanceof ia&&AO(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function AO({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RO{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var s;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((s=this.user.stsTokenManager.expirationTime)!==null&&s!==void 0?s:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const s=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},s)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E0{constructor(e,s){this.createdAt=e,this.lastLoginAt=s,this._initializeTime()}_initializeTime(){this.lastSignInTime=yo(this.lastLoginAt),this.creationTime=yo(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xo(t){var e;const s=t.auth,n=await t.getIdToken(),i=await qo(t,Cd(s,{idToken:n}));re(i==null?void 0:i.users.length,s,"internal-error");const a=i.users[0];t._notifyReloadListener(a);const l=!((e=a.providerUserInfo)===null||e===void 0)&&e.length?CS(a.providerUserInfo):[],o=IO(t.providerData,l),c=t.isAnonymous,u=!(t.email&&a.passwordHash)&&!(o!=null&&o.length),d=c?u:!1,f={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:o,metadata:new E0(a.createdAt,a.lastLoginAt),isAnonymous:d};Object.assign(t,f)}async function CO(t){const e=Nt(t);await Xo(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function IO(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function CS(t){return t.map(e=>{var{providerId:s}=e,n=Cg(e,["providerId"]);return{providerId:s,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OO(t,e){const s=await AS(t,{},async()=>{const n=Nl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=t.config,l=await RS(t,i,"/v1/token",`key=${a}`),o=await t._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:o,body:n};return t.emulatorConfig&&kl(t.emulatorConfig.host)&&(c.credentials="include"),TS.fetch()(l,c)});return{accessToken:s.access_token,expiresIn:s.expires_in,refreshToken:s.refresh_token}}async function MO(t,e){return ei(t,"POST","/v2/accounts:revokeToken",Zn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){re(e.idToken,"internal-error"),re(typeof e.idToken<"u","internal-error"),re(typeof e.refreshToken<"u","internal-error");const s="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ly(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,s)}updateFromIdToken(e){re(e.length!==0,"internal-error");const s=ly(e);this.updateTokensAndExpiration(e,null,s)}async getToken(e,s=!1){return!s&&this.accessToken&&!this.isExpired?this.accessToken:(re(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,s){const{accessToken:n,refreshToken:i,expiresIn:a}=await OO(e,s);this.updateTokensAndExpiration(n,i,Number(a))}updateTokensAndExpiration(e,s,n){this.refreshToken=s||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,s){const{refreshToken:n,accessToken:i,expirationTime:a}=s,l=new Dr;return n&&(re(typeof n=="string","internal-error",{appName:e}),l.refreshToken=n),i&&(re(typeof i=="string","internal-error",{appName:e}),l.accessToken=i),a&&(re(typeof a=="number","internal-error",{appName:e}),l.expirationTime=a),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Dr,this.toJSON())}_performRefresh(){return In("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ni(t,e){re(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Qs{constructor(e){var{uid:s,auth:n,stsTokenManager:i}=e,a=Cg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new RO(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=s,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new E0(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const s=await qo(this,this.stsTokenManager.getToken(this.auth,e));return re(s,this.auth,"internal-error"),this.accessToken!==s&&(this.accessToken=s,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),s}getIdTokenResult(e){return TO(this,e)}reload(){return CO(this)}_assign(e){this!==e&&(re(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(s=>Object.assign({},s)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const s=new Qs(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return s.metadata._copy(this.metadata),s}_onReload(e){re(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,s=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),s&&await Xo(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(gs(this.auth.app))return Promise.reject(dn(this.auth));const e=await this.getIdToken();return await qo(this,jO(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,s){var n,i,a,l,o,c,u,d;const f=(n=s.displayName)!==null&&n!==void 0?n:void 0,h=(i=s.email)!==null&&i!==void 0?i:void 0,m=(a=s.phoneNumber)!==null&&a!==void 0?a:void 0,v=(l=s.photoURL)!==null&&l!==void 0?l:void 0,x=(o=s.tenantId)!==null&&o!==void 0?o:void 0,b=(c=s._redirectEventId)!==null&&c!==void 0?c:void 0,g=(u=s.createdAt)!==null&&u!==void 0?u:void 0,p=(d=s.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:y,emailVerified:k,isAnonymous:N,providerData:S,stsTokenManager:w}=s;re(y&&w,e,"internal-error");const E=Dr.fromJSON(this.name,w);re(typeof y=="string",e,"internal-error"),ni(f,e.name),ni(h,e.name),re(typeof k=="boolean",e,"internal-error"),re(typeof N=="boolean",e,"internal-error"),ni(m,e.name),ni(v,e.name),ni(x,e.name),ni(b,e.name),ni(g,e.name),ni(p,e.name);const j=new Qs({uid:y,auth:e,email:h,emailVerified:k,displayName:f,isAnonymous:N,photoURL:v,phoneNumber:m,tenantId:x,stsTokenManager:E,createdAt:g,lastLoginAt:p});return S&&Array.isArray(S)&&(j.providerData=S.map(A=>Object.assign({},A))),b&&(j._redirectEventId=b),j}static async _fromIdTokenResponse(e,s,n=!1){const i=new Dr;i.updateFromServerResponse(s);const a=new Qs({uid:s.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await Xo(a),a}static async _fromGetAccountInfoResponse(e,s,n){const i=s.users[0];re(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?CS(i.providerUserInfo):[],l=!(i.email&&i.passwordHash)&&!(a!=null&&a.length),o=new Dr;o.updateFromIdToken(n);const c=new Qs({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:l}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new E0(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(a!=null&&a.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oy=new Map;function On(t){Yn(t instanceof Function,"Expected a class definition");let e=oy.get(t);return e?(Yn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,oy.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IS{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,s){this.storage[e]=s}async _get(e){const s=this.storage[e];return s===void 0?null:s}async _remove(e){delete this.storage[e]}_addListener(e,s){}_removeListener(e,s){}}IS.type="NONE";const cy=IS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gu(t,e,s){return`firebase:${t}:${e}:${s}`}class Lr{constructor(e,s,n){this.persistence=e,this.auth=s,this.userKey=n;const{config:i,name:a}=this.auth;this.fullUserKey=Gu(this.userKey,i.apiKey,a),this.fullPersistenceKey=Gu("persistence",i.apiKey,a),this.boundEventHandler=s._onStorageEvent.bind(s),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const s=await Cd(this.auth,{idToken:e}).catch(()=>{});return s?Qs._fromGetAccountInfoResponse(this.auth,s,e):null}return Qs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const s=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,s)return this.setCurrentUser(s)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,s,n="authUser"){if(!s.length)return new Lr(On(cy),e,n);const i=(await Promise.all(s.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let a=i[0]||On(cy);const l=Gu(n,e.config.apiKey,e.name);let o=null;for(const u of s)try{const d=await u._get(l);if(d){let f;if(typeof d=="string"){const h=await Cd(e,{idToken:d}).catch(()=>{});if(!h)break;f=await Qs._fromGetAccountInfoResponse(e,h,d)}else f=Qs._fromJSON(e,d);u!==a&&(o=f),a=u;break}}catch{}const c=i.filter(u=>u._shouldAllowMigration);return!a._shouldAllowMigration||!c.length?new Lr(a,e,n):(a=c[0],o&&await a._set(l,o.toJSON()),await Promise.all(s.map(async u=>{if(u!==a)try{await u._remove(l)}catch{}})),new Lr(a,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uy(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(LS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(OS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(BS(e))return"Blackberry";if(US(e))return"Webos";if(MS(e))return"Safari";if((e.includes("chrome/")||DS(e))&&!e.includes("edge/"))return"Chrome";if(PS(e))return"Android";{const s=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(s);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function OS(t=Jt()){return/firefox\//i.test(t)}function MS(t=Jt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function DS(t=Jt()){return/crios\//i.test(t)}function LS(t=Jt()){return/iemobile/i.test(t)}function PS(t=Jt()){return/android/i.test(t)}function BS(t=Jt()){return/blackberry/i.test(t)}function US(t=Jt()){return/webos/i.test(t)}function Dg(t=Jt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function DO(t=Jt()){var e;return Dg(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function LO(){return YC()&&document.documentMode===10}function HS(t=Jt()){return Dg(t)||PS(t)||US(t)||BS(t)||/windows phone/i.test(t)||LS(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $S(t,e=[]){let s;switch(t){case"Browser":s=uy(Jt());break;case"Worker":s=`${uy(Jt())}-${t}`;break;default:s=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${s}/JsCore/${Sl}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PO{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,s){const n=a=>new Promise((l,o)=>{try{const c=e(a);l(c)}catch(c){o(c)}});n.onAbort=s,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const s=[];try{for(const n of this.queue)await n(e),n.onAbort&&s.push(n.onAbort)}catch(n){s.reverse();for(const i of s)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BO(t,e={}){return ei(t,"GET","/v2/passwordPolicy",Zn(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UO=6;class HO{constructor(e){var s,n,i,a;const l=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(s=l.minPasswordLength)!==null&&s!==void 0?s:UO,l.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=l.maxPasswordLength),l.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=l.containsLowercaseCharacter),l.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=l.containsUppercaseCharacter),l.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=l.containsNumericCharacter),l.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=l.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(a=e.forceUpgradeOnSignin)!==null&&a!==void 0?a:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var s,n,i,a,l,o;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(s=c.meetsMinPasswordLength)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(n=c.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(a=c.containsUppercaseLetter)!==null&&a!==void 0?a:!0),c.isValid&&(c.isValid=(l=c.containsNumericCharacter)!==null&&l!==void 0?l:!0),c.isValid&&(c.isValid=(o=c.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),c}validatePasswordLengthOptions(e,s){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(s.meetsMinPasswordLength=e.length>=n),i&&(s.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,s){this.updatePasswordCharacterOptionsStatuses(s,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(s,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,s,n,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=s)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $O{constructor(e,s,n,i){this.app=e,this.heartbeatServiceProvider=s,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new dy(this),this.idTokenSubscription=new dy(this),this.beforeStateQueue=new PO(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ES,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,s){return s&&(this._popupRedirectResolver=On(s)),this._initializationPromise=this.queue(async()=>{var n,i,a;if(!this._deleted&&(this.persistenceManager=await Lr.create(this,e),(n=this._resolvePersistenceManagerAvailable)===null||n===void 0||n.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(s),this.lastNotifiedUid=((a=this.currentUser)===null||a===void 0?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const s=await Cd(this,{idToken:e}),n=await Qs._fromGetAccountInfoResponse(this,s,e);await this.directlySetCurrentUser(n)}catch(s){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",s),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(gs(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId,o=i==null?void 0:i._redirectEventId,c=await this.tryRedirectSignIn(e);(!l||l===o)&&(c!=null&&c.user)&&(i=c.user,a=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(i)}catch(l){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return re(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let s=null;try{s=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return s}async reloadAndSetCurrentUserOrClear(e){try{await Xo(e)}catch(s){if((s==null?void 0:s.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=vO()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(gs(this.app))return Promise.reject(dn(this));const s=e?Nt(e):null;return s&&re(s.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(s&&s._clone(this))}async _updateCurrentUser(e,s=!1){if(!this._deleted)return e&&re(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),s||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return gs(this.app)?Promise.reject(dn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return gs(this.app)?Promise.reject(dn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(On(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const s=this._getPasswordPolicyInternal();return s.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):s.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await BO(this),s=new HO(e);this.tenantId===null?this._projectPasswordPolicy=s:this._tenantPasswordPolicies[this.tenantId]=s}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Rc("auth","Firebase",e())}onAuthStateChanged(e,s,n){return this.registerStateListener(this.authStateSubscription,e,s,n)}beforeAuthStateChanged(e,s){return this.beforeStateQueue.pushCallback(e,s)}onIdTokenChanged(e,s,n){return this.registerStateListener(this.idTokenSubscription,e,s,n)}authStateReady(){return new Promise((e,s)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},s)}})}async revokeAccessToken(e){if(this.currentUser){const s=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:s};this.tenantId!=null&&(n.tenantId=this.tenantId),await MO(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,s){const n=await this.getOrInitRedirectPersistenceManager(s);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const s=e&&On(e)||this._popupRedirectResolver;re(s,this,"argument-error"),this.redirectPersistenceManager=await Lr.create(this,[On(s._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var s,n;return this._isInitialized&&await this.queue(async()=>{}),((s=this._currentUser)===null||s===void 0?void 0:s._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,s;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(s=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&s!==void 0?s:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,s,n,i){if(this._deleted)return()=>{};const a=typeof s=="function"?s:s.next.bind(s);let l=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(re(o,this,"internal-error"),o.then(()=>{l||a(this.currentUser)}),typeof s=="function"){const c=e.addObserver(s,n,i);return()=>{l=!0,c()}}else{const c=e.addObserver(s);return()=>{l=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return re(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=$S(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const s={"X-Client-Version":this.clientVersion};this.app.options.appId&&(s["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(s["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(s["X-Firebase-AppCheck"]=i),s}async _getAppCheckToken(){var e;if(gs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const s=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return s!=null&&s.error&&gO(`Error while retrieving App Check token: ${s.error}`),s==null?void 0:s.token}}function ti(t){return Nt(t)}class dy{constructor(e){this.auth=e,this.observer=null,this.addObserver=nI(s=>this.observer=s)}get next(){return re(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function GO(t){Rf=t}function GS(t){return Rf.loadJS(t)}function FO(){return Rf.recaptchaEnterpriseScript}function VO(){return Rf.gapiScript}function zO(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class KO{constructor(){this.enterprise=new YO}ready(e){e()}execute(e,s){return Promise.resolve("token")}render(e,s){return""}}class YO{ready(e){e()}execute(e,s){return Promise.resolve("token")}render(e,s){return""}}const WO="recaptcha-enterprise",FS="NO_RECAPTCHA";class qO{constructor(e){this.type=WO,this.auth=ti(e)}async verify(e="verify",s=!1){async function n(a){if(!s){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(l,o)=>{EO(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const u=new SO(c);return a.tenantId==null?a._agentRecaptchaConfig=u:a._tenantRecaptchaConfigs[a.tenantId]=u,l(u.siteKey)}}).catch(c=>{o(c)})})}function i(a,l,o){const c=window.grecaptcha;ry(c)?c.enterprise.ready(()=>{c.enterprise.execute(a,{action:e}).then(u=>{l(u)}).catch(()=>{l(FS)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new KO().execute("siteKey",{action:"verify"}):new Promise((a,l)=>{n(this.auth).then(o=>{if(!s&&ry(window.grecaptcha))i(o,a,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let c=FO();c.length!==0&&(c+=o),GS(c).then(()=>{i(o,a,l)}).catch(u=>{l(u)})}}).catch(o=>{l(o)})})}}async function fy(t,e,s,n=!1,i=!1){const a=new qO(t);let l;if(i)l=FS;else try{l=await a.verify(s)}catch{l=await a.verify(s,!0)}const o=Object.assign({},e);if(s==="mfaSmsEnrollment"||s==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in o){const c=o.phoneEnrollmentInfo.phoneNumber,u=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:u,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const c=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return n?Object.assign(o,{captchaResp:l}):Object.assign(o,{captchaResponse:l}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Id(t,e,s,n,i){var a;if(!((a=t._getRecaptchaConfig())===null||a===void 0)&&a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await fy(t,e,s,s==="getOobCode");return n(t,l)}else return n(t,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${s} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await fy(t,e,s,s==="getOobCode");return n(t,o)}else return Promise.reject(l)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XO(t,e){const s=Rg(t,"auth");if(s.isInitialized()){const i=s.getImmediate(),a=s.getOptions();if(Ua(a,e??{}))return i;sn(i,"already-initialized")}return s.initialize({options:e})}function QO(t,e){const s=(e==null?void 0:e.persistence)||[],n=(Array.isArray(s)?s:[s]).map(On);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function JO(t,e,s){const n=ti(t);re(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,a=VS(e),{host:l,port:o}=ZO(e),c=o===null?"":`:${o}`,u={url:`${a}//${l}${c}/`},d=Object.freeze({host:l,port:o,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){re(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),re(Ua(u,n.config.emulator)&&Ua(d,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=u,n.emulatorConfig=d,n.settings.appVerificationDisabledForTesting=!0,kl(l)?(pS(`${a}//${l}${c}`),gS("Auth",!0)):eM()}function VS(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function ZO(t){const e=VS(t),s=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!s)return{host:"",port:null};const n=s[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const a=i[1];return{host:a,port:hy(n.substr(a.length+1))}}else{const[a,l]=n.split(":");return{host:a,port:hy(l)}}}function hy(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function eM(){function t(){const e=document.createElement("p"),s=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",s.position="fixed",s.width="100%",s.backgroundColor="#ffffff",s.border=".1em solid #000000",s.color="#b50000",s.bottom="0px",s.left="0px",s.margin="0px",s.zIndex="10000",s.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lg{constructor(e,s){this.providerId=e,this.signInMethod=s}toJSON(){return In("not implemented")}_getIdTokenResponse(e){return In("not implemented")}_linkToIdToken(e,s){return In("not implemented")}_getReauthenticationResolver(e){return In("not implemented")}}async function tM(t,e){return ei(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sM(t,e){return Ic(t,"POST","/v1/accounts:signInWithPassword",Zn(t,e))}async function nM(t,e){return ei(t,"POST","/v1/accounts:sendOobCode",Zn(t,e))}async function iM(t,e){return nM(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aM(t,e){return Ic(t,"POST","/v1/accounts:signInWithEmailLink",Zn(t,e))}async function rM(t,e){return Ic(t,"POST","/v1/accounts:signInWithEmailLink",Zn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo extends Lg{constructor(e,s,n,i=null){super("password",n),this._email=e,this._password=s,this._tenantId=i}static _fromEmailAndPassword(e,s){return new Qo(e,s,"password")}static _fromEmailAndCode(e,s,n=null){return new Qo(e,s,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const s=typeof e=="string"?JSON.parse(e):e;if(s!=null&&s.email&&(s!=null&&s.password)){if(s.signInMethod==="password")return this._fromEmailAndPassword(s.email,s.password);if(s.signInMethod==="emailLink")return this._fromEmailAndCode(s.email,s.password,s.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const s={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Id(e,s,"signInWithPassword",sM);case"emailLink":return aM(e,{email:this._email,oobCode:this._password});default:sn(e,"internal-error")}}async _linkToIdToken(e,s){switch(this.signInMethod){case"password":const n={idToken:s,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Id(e,n,"signUpPassword",tM);case"emailLink":return rM(e,{idToken:s,email:this._email,oobCode:this._password});default:sn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pr(t,e){return Ic(t,"POST","/v1/accounts:signInWithIdp",Zn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lM="http://localhost";class $a extends Lg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const s=new $a(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(s.idToken=e.idToken),e.accessToken&&(s.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(s.nonce=e.nonce),e.pendingToken&&(s.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(s.accessToken=e.oauthToken,s.secret=e.oauthTokenSecret):sn("argument-error"),s}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const s=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=s,a=Cg(s,["providerId","signInMethod"]);if(!n||!i)return null;const l=new $a(n,i);return l.idToken=a.idToken||void 0,l.accessToken=a.accessToken||void 0,l.secret=a.secret,l.nonce=a.nonce,l.pendingToken=a.pendingToken||null,l}_getIdTokenResponse(e){const s=this.buildRequest();return Pr(e,s)}_linkToIdToken(e,s){const n=this.buildRequest();return n.idToken=s,Pr(e,n)}_getReauthenticationResolver(e){const s=this.buildRequest();return s.autoCreate=!1,Pr(e,s)}buildRequest(){const e={requestUri:lM,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const s={};this.idToken&&(s.id_token=this.idToken),this.accessToken&&(s.access_token=this.accessToken),this.secret&&(s.oauth_token_secret=this.secret),s.providerId=this.providerId,this.nonce&&!this.pendingToken&&(s.nonce=this.nonce),e.postBody=Nl(s)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oM(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function cM(t){const e=to(so(t)).link,s=e?to(so(e)).deep_link_id:null,n=to(so(t)).deep_link_id;return(n?to(so(n)).link:null)||n||s||e||t}class Pg{constructor(e){var s,n,i,a,l,o;const c=to(so(e)),u=(s=c.apiKey)!==null&&s!==void 0?s:null,d=(n=c.oobCode)!==null&&n!==void 0?n:null,f=oM((i=c.mode)!==null&&i!==void 0?i:null);re(u&&d&&f,"argument-error"),this.apiKey=u,this.operation=f,this.code=d,this.continueUrl=(a=c.continueUrl)!==null&&a!==void 0?a:null,this.languageCode=(l=c.lang)!==null&&l!==void 0?l:null,this.tenantId=(o=c.tenantId)!==null&&o!==void 0?o:null}static parseLink(e){const s=cM(e);try{return new Pg(s)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xa{constructor(){this.providerId=Xa.PROVIDER_ID}static credential(e,s){return Qo._fromEmailAndPassword(e,s)}static credentialWithLink(e,s){const n=Pg.parseLink(s);return re(n,"argument-error"),Qo._fromEmailAndCode(e,n.code,n.tenantId)}}Xa.PROVIDER_ID="password";Xa.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Xa.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zS{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oc extends zS{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi extends Oc{constructor(){super("facebook.com")}static credential(e){return $a._fromParams({providerId:fi.PROVIDER_ID,signInMethod:fi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return fi.credentialFromTaggedObject(e)}static credentialFromError(e){return fi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return fi.credential(e.oauthAccessToken)}catch{return null}}}fi.FACEBOOK_SIGN_IN_METHOD="facebook.com";fi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi extends Oc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,s){return $a._fromParams({providerId:hi.PROVIDER_ID,signInMethod:hi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:s})}static credentialFromResult(e){return hi.credentialFromTaggedObject(e)}static credentialFromError(e){return hi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:s,oauthAccessToken:n}=e;if(!s&&!n)return null;try{return hi.credential(s,n)}catch{return null}}}hi.GOOGLE_SIGN_IN_METHOD="google.com";hi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi extends Oc{constructor(){super("github.com")}static credential(e){return $a._fromParams({providerId:mi.PROVIDER_ID,signInMethod:mi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return mi.credentialFromTaggedObject(e)}static credentialFromError(e){return mi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return mi.credential(e.oauthAccessToken)}catch{return null}}}mi.GITHUB_SIGN_IN_METHOD="github.com";mi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi extends Oc{constructor(){super("twitter.com")}static credential(e,s){return $a._fromParams({providerId:pi.PROVIDER_ID,signInMethod:pi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:s})}static credentialFromResult(e){return pi.credentialFromTaggedObject(e)}static credentialFromError(e){return pi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:s,oauthTokenSecret:n}=e;if(!s||!n)return null;try{return pi.credential(s,n)}catch{return null}}}pi.TWITTER_SIGN_IN_METHOD="twitter.com";pi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KS(t,e){return Ic(t,"POST","/v1/accounts:signUp",Zn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,s,n,i=!1){const a=await Qs._fromIdTokenResponse(e,n,i),l=my(n);return new Wn({user:a,providerId:l,_tokenResponse:n,operationType:s})}static async _forOperation(e,s,n){await e._updateTokensIfNecessary(n,!0);const i=my(n);return new Wn({user:e,providerId:i,_tokenResponse:n,operationType:s})}}function my(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uM(t){var e;if(gs(t.app))return Promise.reject(dn(t));const s=ti(t);if(await s._initializationPromise,!((e=s.currentUser)===null||e===void 0)&&e.isAnonymous)return new Wn({user:s.currentUser,providerId:null,operationType:"signIn"});const n=await KS(s,{returnSecureToken:!0}),i=await Wn._fromIdTokenResponse(s,"signIn",n,!0);return await s._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od extends ia{constructor(e,s,n,i){var a;super(s.code,s.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Od.prototype),this.customData={appName:e.name,tenantId:(a=e.tenantId)!==null&&a!==void 0?a:void 0,_serverResponse:s.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,s,n,i){return new Od(e,s,n,i)}}function YS(t,e,s,n){return(e==="reauthenticate"?s._getReauthenticationResolver(t):s._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?Od._fromErrorAndOperation(t,a,e,n):a})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dM(t){return new Set(t.map(({providerId:e})=>e).filter(e=>!!e))}async function WS(t,e,s=!1){const n=await qo(t,e._linkToIdToken(t.auth,await t.getIdToken()),s);return Wn._forOperation(t,"link",n)}async function fM(t,e,s){await Xo(e);const n=dM(e.providerData);re(n.has(s)===t,e.auth,"provider-already-linked")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hM(t,e,s=!1){const{auth:n}=t;if(gs(n.app))return Promise.reject(dn(n));const i="reauthenticate";try{const a=await qo(t,YS(n,i,e,t),s);re(a.idToken,n,"internal-error");const l=Mg(a.idToken);re(l,n,"internal-error");const{sub:o}=l;return re(t.uid===o,n,"user-mismatch"),Wn._forOperation(t,i,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&sn(n,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qS(t,e,s=!1){if(gs(t.app))return Promise.reject(dn(t));const n="signIn",i=await YS(t,n,e),a=await Wn._fromIdTokenResponse(t,n,i);return s||await t._updateCurrentUser(a.user),a}async function mM(t,e){return qS(ti(t),e)}async function pM(t,e){const s=Nt(t);return await fM(!1,s,e.providerId),WS(s,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XS(t){const e=ti(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function gM(t,e,s){const n=ti(t);await Id(n,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",iM)}async function xM(t,e,s){if(gs(t.app))return Promise.reject(dn(t));const n=ti(t),l=await Id(n,{returnSecureToken:!0,email:e,password:s,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",KS).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&XS(t),c}),o=await Wn._fromIdTokenResponse(n,"signIn",l);return await n._updateCurrentUser(o.user),o}function bM(t,e,s){return gs(t.app)?Promise.reject(dn(t)):mM(Nt(t),Xa.credential(e,s)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&XS(t),n})}function vM(t,e,s,n){return Nt(t).onIdTokenChanged(e,s,n)}function yM(t,e,s){return Nt(t).beforeAuthStateChanged(e,s)}function _M(t,e,s,n){return Nt(t).onAuthStateChanged(e,s,n)}function wM(t){return Nt(t).signOut()}const Md="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QS{constructor(e,s){this.storageRetriever=e,this.type=s}_isAvailable(){try{return this.storage?(this.storage.setItem(Md,"1"),this.storage.removeItem(Md),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,s){return this.storage.setItem(e,JSON.stringify(s)),Promise.resolve()}_get(e){const s=this.storage.getItem(e);return Promise.resolve(s?JSON.parse(s):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kM=1e3,NM=10;class JS extends QS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,s)=>this.onStorageEvent(e,s),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=HS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const s of Object.keys(this.listeners)){const n=this.storage.getItem(s),i=this.localCache[s];n!==i&&e(s,i,n)}}onStorageEvent(e,s=!1){if(!e.key){this.forAllChangedKeys((l,o,c)=>{this.notifyListeners(l,c)});return}const n=e.key;s?this.detachListener():this.stopPolling();const i=()=>{const l=this.storage.getItem(n);!s&&this.localCache[n]===l||this.notifyListeners(n,l)},a=this.storage.getItem(n);LO()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,NM):i()}notifyListeners(e,s){this.localCache[e]=s;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(s&&JSON.parse(s))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,s,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:s,newValue:n}),!0)})},kM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,s){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(s)}_removeListener(e,s){this.listeners[e]&&(this.listeners[e].delete(s),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,s){await super._set(e,s),this.localCache[e]=JSON.stringify(s)}async _get(e){const s=await super._get(e);return this.localCache[e]=JSON.stringify(s),s}async _remove(e){await super._remove(e),delete this.localCache[e]}}JS.type="LOCAL";const SM=JS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZS extends QS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,s){}_removeListener(e,s){}}ZS.type="SESSION";const eE=ZS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EM(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(s){return{fulfilled:!1,reason:s}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const s=this.receivers.find(i=>i.isListeningto(e));if(s)return s;const n=new Cf(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const s=e,{eventId:n,eventType:i,data:a}=s.data,l=this.handlersMap[i];if(!(l!=null&&l.size))return;s.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(l).map(async u=>u(s.origin,a)),c=await EM(o);s.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:c})}_subscribe(e,s){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(s)}_unsubscribe(e,s){this.handlersMap[e]&&s&&this.handlersMap[e].delete(s),(!s||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Cf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bg(t="",e=10){let s="";for(let n=0;n<e;n++)s+=Math.floor(Math.random()*10);return t+s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jM{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,s,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,l;return new Promise((o,c)=>{const u=Bg("",20);i.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},n);l={messageChannel:i,onMessage(f){const h=f;if(h.data.eventId===u)switch(h.data.status){case"ack":clearTimeout(d),a=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),o(h.data.response);break;default:clearTimeout(d),clearTimeout(a),c(new Error("invalid_response"));break}}},this.handlers.add(l),i.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:u,data:s},[i.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fn(){return window}function TM(t){fn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tE(){return typeof fn().WorkerGlobalScope<"u"&&typeof fn().importScripts=="function"}async function AM(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function RM(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function CM(){return tE()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sE="firebaseLocalStorageDb",IM=1,Dd="firebaseLocalStorage",nE="fbase_key";class Mc{constructor(e){this.request=e}toPromise(){return new Promise((e,s)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{s(this.request.error)})})}}function If(t,e){return t.transaction([Dd],e?"readwrite":"readonly").objectStore(Dd)}function OM(){const t=indexedDB.deleteDatabase(sE);return new Mc(t).toPromise()}function j0(){const t=indexedDB.open(sE,IM);return new Promise((e,s)=>{t.addEventListener("error",()=>{s(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Dd,{keyPath:nE})}catch(i){s(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Dd)?e(n):(n.close(),await OM(),e(await j0()))})})}async function py(t,e,s){const n=If(t,!0).put({[nE]:e,value:s});return new Mc(n).toPromise()}async function MM(t,e){const s=If(t,!1).get(e),n=await new Mc(s).toPromise();return n===void 0?null:n.value}function gy(t,e){const s=If(t,!0).delete(e);return new Mc(s).toPromise()}const DM=800,LM=3;class iE{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await j0(),this.db)}async _withRetries(e){let s=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(s++>LM)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return tE()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Cf._getInstance(CM()),this.receiver._subscribe("keyChanged",async(e,s)=>({keyProcessed:(await this._poll()).includes(s.key)})),this.receiver._subscribe("ping",async(e,s)=>["keyChanged"])}async initializeSender(){var e,s;if(this.activeServiceWorker=await AM(),!this.activeServiceWorker)return;this.sender=new jM(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((s=n[0])===null||s===void 0)&&s.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||RM()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await j0();return await py(e,Md,"1"),await gy(e,Md),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,s){return this._withPendingWrite(async()=>(await this._withRetries(n=>py(n,e,s)),this.localCache[e]=s,this.notifyServiceWorker(e)))}async _get(e){const s=await this._withRetries(n=>MM(n,e));return this.localCache[e]=s,s}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(s=>gy(s,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=If(i,!1).getAll();return new Mc(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const s=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),s.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),s.push(i));return s}notifyListeners(e,s){this.localCache[e]=s;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(s)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),DM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,s){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(s)}_removeListener(e,s){this.listeners[e]&&(this.listeners[e].delete(s),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}iE.type="LOCAL";const PM=iE;new Cc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BM(t,e){return e?On(e):(re(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ug extends Lg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Pr(e,this._buildIdpRequest())}_linkToIdToken(e,s){return Pr(e,this._buildIdpRequest(s))}_getReauthenticationResolver(e){return Pr(e,this._buildIdpRequest())}_buildIdpRequest(e){const s={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(s.idToken=e),s}}function UM(t){return qS(t.auth,new Ug(t),t.bypassAuthState)}function HM(t){const{auth:e,user:s}=t;return re(s,e,"internal-error"),hM(s,new Ug(t),t.bypassAuthState)}async function $M(t){const{auth:e,user:s}=t;return re(s,e,"internal-error"),WS(s,new Ug(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aE{constructor(e,s,n,i,a=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(s)?s:[s]}execute(){return new Promise(async(e,s)=>{this.pendingPromise={resolve:e,reject:s};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:s,sessionId:n,postBody:i,tenantId:a,error:l,type:o}=e;if(l){this.reject(l);return}const c={auth:this.auth,requestUri:s,sessionId:n,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return UM;case"linkViaPopup":case"linkViaRedirect":return $M;case"reauthViaPopup":case"reauthViaRedirect":return HM;default:sn(this.auth,"internal-error")}}resolve(e){Yn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Yn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GM=new Cc(2e3,1e4);class yr extends aE{constructor(e,s,n,i,a){super(e,s,i,a),this.provider=n,this.authWindow=null,this.pollId=null,yr.currentPopupAction&&yr.currentPopupAction.cancel(),yr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return re(e,this.auth,"internal-error"),e}async onExecution(){Yn(this.filter.length===1,"Popup operations only handle one event");const e=Bg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(s=>{this.reject(s)}),this.resolver._isIframeWebStorageSupported(this.auth,s=>{s||this.reject(un(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(un(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,yr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var s,n;if(!((n=(s=this.authWindow)===null||s===void 0?void 0:s.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(un(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,GM.get())};e()}}yr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FM="pendingRedirect",Fu=new Map;class VM extends aE{constructor(e,s,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],s,void 0,n),this.eventId=null}async execute(){let e=Fu.get(this.auth._key());if(!e){try{const n=await zM(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(s){e=()=>Promise.reject(s)}Fu.set(this.auth._key(),e)}return this.bypassAuthState||Fu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const s=await this.auth._redirectUserForId(e.eventId);if(s)return this.user=s,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function zM(t,e){const s=WM(e),n=YM(t);if(!await n._isAvailable())return!1;const i=await n._get(s)==="true";return await n._remove(s),i}function KM(t,e){Fu.set(t._key(),e)}function YM(t){return On(t._redirectPersistence)}function WM(t){return Gu(FM,t.config.apiKey,t.name)}async function qM(t,e,s=!1){if(gs(t.app))return Promise.reject(dn(t));const n=ti(t),i=BM(n,e),l=await new VM(n,i,s).execute();return l&&!s&&(delete l.user._redirectEventId,await n._persistUserIfCurrent(l.user),await n._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XM=10*60*1e3;class QM{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let s=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(s=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!JM(e)||(this.hasHandledPotentialRedirect=!0,s||(this.queuedRedirectEvent=e,s=!0)),s}sendToConsumer(e,s){var n;if(e.error&&!rE(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";s.onError(un(this.auth,i))}else s.onAuthEvent(e)}isEventForConsumer(e,s){const n=s.eventId===null||!!e.eventId&&e.eventId===s.eventId;return s.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=XM&&this.cachedEventUids.clear(),this.cachedEventUids.has(xy(e))}saveEventToCache(e){this.cachedEventUids.add(xy(e)),this.lastProcessedEventTime=Date.now()}}function xy(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function rE({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function JM(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return rE(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZM(t,e={}){return ei(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,t4=/^https?/;async function s4(t){if(t.config.emulator)return;const{authorizedDomains:e}=await ZM(t);for(const s of e)try{if(n4(s))return}catch{}sn(t,"unauthorized-domain")}function n4(t){const e=S0(),{protocol:s,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const l=new URL(t);return l.hostname===""&&n===""?s==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):s==="chrome-extension:"&&l.hostname===n}if(!t4.test(s))return!1;if(e4.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i4=new Cc(3e4,6e4);function by(){const t=fn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let s=0;s<t.CP.length;s++)t.CP[s]=null}}function a4(t){return new Promise((e,s)=>{var n,i,a;function l(){by(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{by(),s(un(t,"network-request-failed"))},timeout:i4.get()})}if(!((i=(n=fn().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((a=fn().gapi)===null||a===void 0)&&a.load)l();else{const o=zO("iframefcb");return fn()[o]=()=>{gapi.load?l():s(un(t,"network-request-failed"))},GS(`${VO()}?onload=${o}`).catch(c=>s(c))}}).catch(e=>{throw Vu=null,e})}let Vu=null;function r4(t){return Vu=Vu||a4(t),Vu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l4=new Cc(5e3,15e3),o4="__/auth/iframe",c4="emulator/auth/iframe",u4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},d4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function f4(t){const e=t.config;re(e.authDomain,t,"auth-domain-config-required");const s=e.emulator?Og(e,c4):`https://${t.config.authDomain}/${o4}`,n={apiKey:e.apiKey,appName:t.name,v:Sl},i=d4.get(t.config.apiHost);i&&(n.eid=i);const a=t._getFrameworks();return a.length&&(n.fw=a.join(",")),`${s}?${Nl(n).slice(1)}`}async function h4(t){const e=await r4(t),s=fn().gapi;return re(s,t,"internal-error"),e.open({where:document.body,url:f4(t),messageHandlersFilter:s.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:u4,dontclear:!0},n=>new Promise(async(i,a)=>{await n.restyle({setHideOnLeave:!1});const l=un(t,"network-request-failed"),o=fn().setTimeout(()=>{a(l)},l4.get());function c(){fn().clearTimeout(o),i(n)}n.ping(c).then(c,()=>{a(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},p4=500,g4=600,x4="_blank",b4="http://localhost";class vy{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function v4(t,e,s,n=p4,i=g4){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),l=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const c=Object.assign(Object.assign({},m4),{width:n.toString(),height:i.toString(),top:a,left:l}),u=Jt().toLowerCase();s&&(o=DS(u)?x4:s),OS(u)&&(e=e||b4,c.scrollbars="yes");const d=Object.entries(c).reduce((h,[m,v])=>`${h}${m}=${v},`,"");if(DO(u)&&o!=="_self")return y4(e||"",o),new vy(null);const f=window.open(e||"",o,d);re(f,t,"popup-blocked");try{f.focus()}catch{}return new vy(f)}function y4(t,e){const s=document.createElement("a");s.href=t,s.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),s.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _4="__/auth/handler",w4="emulator/auth/handler",k4=encodeURIComponent("fac");async function yy(t,e,s,n,i,a){re(t.config.authDomain,t,"auth-domain-config-required"),re(t.config.apiKey,t,"invalid-api-key");const l={apiKey:t.config.apiKey,appName:t.name,authType:s,redirectUrl:n,v:Sl,eventId:i};if(e instanceof zS){e.setDefaultLanguage(t.languageCode),l.providerId=e.providerId||"",jd(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries({}))l[d]=f}if(e instanceof Oc){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(l.scopes=d.join(","))}t.tenantId&&(l.tid=t.tenantId);const o=l;for(const d of Object.keys(o))o[d]===void 0&&delete o[d];const c=await t._getAppCheckToken(),u=c?`#${k4}=${encodeURIComponent(c)}`:"";return`${N4(t)}?${Nl(o).slice(1)}${u}`}function N4({config:t}){return t.emulator?Og(t,w4):`https://${t.authDomain}/${_4}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yh="webStorageSupport";class S4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=eE,this._completeRedirectFn=qM,this._overrideRedirectResult=KM}async _openPopup(e,s,n,i){var a;Yn((a=this.eventManagers[e._key()])===null||a===void 0?void 0:a.manager,"_initialize() not called before _openPopup()");const l=await yy(e,s,n,S0(),i);return v4(e,l,Bg())}async _openRedirect(e,s,n,i){await this._originValidation(e);const a=await yy(e,s,n,S0(),i);return TM(a),new Promise(()=>{})}_initialize(e){const s=e._key();if(this.eventManagers[s]){const{manager:i,promise:a}=this.eventManagers[s];return i?Promise.resolve(i):(Yn(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(e);return this.eventManagers[s]={promise:n},n.catch(()=>{delete this.eventManagers[s]}),n}async initAndGetManager(e){const s=await h4(e),n=new QM(e);return s.register("authEvent",i=>(re(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=s,n}_isIframeWebStorageSupported(e,s){this.iframes[e._key()].send(Yh,{type:Yh},i=>{var a;const l=(a=i==null?void 0:i[0])===null||a===void 0?void 0:a[Yh];l!==void 0&&s(!!l),sn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const s=e._key();return this.originValidationPromises[s]||(this.originValidationPromises[s]=s4(e)),this.originValidationPromises[s]}get _shouldInitProactively(){return HS()||MS()||Dg()}}const E4=S4;var _y="@firebase/auth",wy="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const s=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,s),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const s=this.internalListeners.get(e);s&&(this.internalListeners.delete(e),s(),this.updateProactiveRefresh())}assertAuthConfigured(){re(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T4(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function A4(t){el(new Ha("auth",(e,{options:s})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:l,authDomain:o}=n.options;re(l&&!l.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:l,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:$S(t)},u=new $O(n,i,a,c);return QO(u,s),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,s,n)=>{e.getProvider("auth-internal").initialize()})),el(new Ha("auth-internal",e=>{const s=ti(e.getProvider("auth").getImmediate());return(n=>new j4(n))(s)},"PRIVATE").setInstantiationMode("EXPLICIT")),Li(_y,wy,T4(t)),Li(_y,wy,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R4=5*60,C4=mS("authIdTokenMaxAge")||R4;let ky=null;const I4=t=>async e=>{const s=e&&await e.getIdTokenResult(),n=s&&(new Date().getTime()-Date.parse(s.issuedAtTime))/1e3;if(n&&n>C4)return;const i=s==null?void 0:s.token;ky!==i&&(ky=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function O4(t=wS()){const e=Rg(t,"auth");if(e.isInitialized())return e.getImmediate();const s=XO(t,{popupRedirectResolver:E4,persistence:[PM,SM,eE]}),n=mS("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const l=I4(a.toString());yM(s,l,()=>l(s.currentUser)),vM(s,o=>l(o))}}const i=fS("auth");return i&&JO(s,`http://${i}`),s}function M4(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}GO({loadJS(t){return new Promise((e,s)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const a=un("internal-error");a.customData=i,s(a)},n.type="text/javascript",n.charset="UTF-8",M4().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});A4("Browser");var Ny={};const Sy="@firebase/database",Ey="1.0.20";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lE="";function D4(t){lE=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L4{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,s){s==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Tt(s))}get(e){const s=this.domStorage_.getItem(this.prefixedName_(e));return s==null?null:Yo(s)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P4{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,s){s==null?delete this.cache_[e]:this.cache_[e]=s}get(e){return an(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oE=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new L4(e)}}catch{}return new P4},ya=oE("localStorage"),B4=oE("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Br=new Tg("@firebase/database"),cE=function(){let t=1;return function(){return t++}}(),uE=function(t){const e=rI(t),s=new sI;s.update(e);const n=s.digest();return Sg.encodeByteArray(n)},Dc=function(...t){let e="";for(let s=0;s<t.length;s++){const n=t[s];Array.isArray(n)||n&&typeof n=="object"&&typeof n.length=="number"?e+=Dc.apply(null,n):typeof n=="object"?e+=Tt(n):e+=n,e+=" "}return e};let _o=null,jy=!0;const U4=function(t,e){X(!0,"Can't turn on custom loggers persistently."),Br.logLevel=He.VERBOSE,_o=Br.log.bind(Br)},Mt=function(...t){if(jy===!0&&(jy=!1,_o===null&&B4.get("logging_enabled")===!0&&U4()),_o){const e=Dc.apply(null,t);_o(e)}},Lc=function(t){return function(...e){Mt(t,...e)}},T0=function(...t){const e="FIREBASE INTERNAL ERROR: "+Dc(...t);Br.error(e)},qn=function(...t){const e=`FIREBASE FATAL ERROR: ${Dc(...t)}`;throw Br.error(e),new Error(e)},Qt=function(...t){const e="FIREBASE WARNING: "+Dc(...t);Br.warn(e)},H4=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Qt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Of=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},$4=function(t){if(document.readyState==="complete")t();else{let e=!1;const s=function(){if(!document.body){setTimeout(s,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",s,!1),window.addEventListener("load",s,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&s()}),window.attachEvent("onload",s))}},tl="[MIN_NAME]",Ga="[MAX_NAME]",Qa=function(t,e){if(t===e)return 0;if(t===tl||e===Ga)return-1;if(e===tl||t===Ga)return 1;{const s=Ty(t),n=Ty(e);return s!==null?n!==null?s-n===0?t.length-e.length:s-n:-1:n!==null?1:t<e?-1:1}},G4=function(t,e){return t===e?0:t<e?-1:1},Vl=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Tt(e))},Hg=function(t){if(typeof t!="object"||t===null)return Tt(t);const e=[];for(const n in t)e.push(n);e.sort();let s="{";for(let n=0;n<e.length;n++)n!==0&&(s+=","),s+=Tt(e[n]),s+=":",s+=Hg(t[e[n]]);return s+="}",s},dE=function(t,e){const s=t.length;if(s<=e)return[t];const n=[];for(let i=0;i<s;i+=e)i+e>s?n.push(t.substring(i,s)):n.push(t.substring(i,i+e));return n};function Lt(t,e){for(const s in t)t.hasOwnProperty(s)&&e(s,t[s])}const fE=function(t){X(!Of(t),"Invalid JSON number");const e=11,s=52,n=(1<<e-1)-1;let i,a,l,o,c;t===0?(a=0,l=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-n)?(o=Math.min(Math.floor(Math.log(t)/Math.LN2),n),a=o+n,l=Math.round(t*Math.pow(2,s-o)-Math.pow(2,s))):(a=0,l=Math.round(t/Math.pow(2,1-n-s))));const u=[];for(c=s;c;c-=1)u.push(l%2?1:0),l=Math.floor(l/2);for(c=e;c;c-=1)u.push(a%2?1:0),a=Math.floor(a/2);u.push(i?1:0),u.reverse();const d=u.join("");let f="";for(c=0;c<64;c+=8){let h=parseInt(d.substr(c,8),2).toString(16);h.length===1&&(h="0"+h),f=f+h}return f.toLowerCase()},F4=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},V4=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function z4(t,e){let s="Unknown Error";t==="too_big"?s="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?s="Client doesn't have permission to access the desired data.":t==="unavailable"&&(s="The service is unavailable");const n=new Error(t+" at "+e._path.toString()+": "+s);return n.code=t.toUpperCase(),n}const K4=new RegExp("^-?(0*)\\d{1,10}$"),Y4=-2147483648,W4=2147483647,Ty=function(t){if(K4.test(t)){const e=Number(t);if(e>=Y4&&e<=W4)return e}return null},El=function(t){try{t()}catch(e){setTimeout(()=>{const s=e.stack||"";throw Qt("Exception was thrown by user callback.",s),e},Math.floor(0))}},q4=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},wo=function(t,e){const s=setTimeout(t,e);return typeof s=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(s):typeof s=="object"&&s.unref&&s.unref(),s};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X4{constructor(e,s){this.appCheckProvider=s,this.appName=e.name,gs(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=s==null?void 0:s.getImmediate({optional:!0}),this.appCheck||s==null||s.get().then(n=>this.appCheck=n)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((s,n)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(s,n):s(null)},0)})}addTokenChangeListener(e){var s;(s=this.appCheckProvider)===null||s===void 0||s.get().then(n=>n.addTokenListener(e))}notifyForInvalidToken(){Qt(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q4{constructor(e,s,n){this.appName_=e,this.firebaseOptions_=s,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(s=>s&&s.code==="auth/token-not-initialized"?(Mt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(s)):new Promise((s,n)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(s,n):s(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(s=>s.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(s=>s.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Qt(e)}}class zu{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}zu.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $g="5",hE="v",mE="s",pE="r",gE="f",xE=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,bE="ls",vE="p",A0="ac",yE="websocket",_E="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wE{constructor(e,s,n,i,a=!1,l="",o=!1,c=!1,u=null){this.secure=s,this.namespace=n,this.webSocketOnly=i,this.nodeAdmin=a,this.persistenceKey=l,this.includeNamespaceInQueryParams=o,this.isUsingEmulator=c,this.emulatorOptions=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=ya.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&ya.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",s=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${s}`}}function J4(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function kE(t,e,s){X(typeof e=="string","typeof type must == string"),X(typeof s=="object","typeof params must == object");let n;if(e===yE)n=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===_E)n=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);J4(t)&&(s.ns=t.namespace);const i=[];return Lt(s,(a,l)=>{i.push(a+"="+l)}),n+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z4{constructor(){this.counters_={}}incrementCounter(e,s=1){an(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=s}get(){return DC(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wh={},qh={};function Gg(t){const e=t.toString();return Wh[e]||(Wh[e]=new Z4),Wh[e]}function e3(t,e){const s=t.toString();return qh[s]||(qh[s]=e()),qh[s]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t3{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,s){this.closeAfterResponse=e,this.onClose=s,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,s){for(this.pendingResponses[e]=s;this.pendingResponses[this.currentResponseNum];){const n=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<n.length;++i)n[i]&&El(()=>{this.onMessage_(n[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ay="start",s3="close",n3="pLPCommand",i3="pRTLPCB",NE="id",SE="pw",EE="ser",a3="cb",r3="seg",l3="ts",o3="d",c3="dframe",jE=1870,TE=30,u3=jE-TE,d3=25e3,f3=3e4;class _r{constructor(e,s,n,i,a,l,o){this.connId=e,this.repoInfo=s,this.applicationId=n,this.appCheckToken=i,this.authToken=a,this.transportSessionId=l,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Lc(e),this.stats_=Gg(s),this.urlFn=c=>(this.appCheckToken&&(c[A0]=this.appCheckToken),kE(s,_E,c))}open(e,s){this.curSegmentNum=0,this.onDisconnect_=s,this.myPacketOrderer=new t3(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(f3)),$4(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Fg((...a)=>{const[l,o,c,u,d]=a;if(this.incrementIncomingBytes_(a),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,l===Ay)this.id=o,this.password=c;else if(l===s3)o?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(o,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+l)},(...a)=>{const[l,o]=a;this.incrementIncomingBytes_(a),this.myPacketOrderer.handleResponse(l,o)},()=>{this.onClosed_()},this.urlFn);const n={};n[Ay]="t",n[EE]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(n[a3]=this.scriptTagHolder.uniqueCallbackIdentifier),n[hE]=$g,this.transportSessionId&&(n[mE]=this.transportSessionId),this.lastSessionId&&(n[bE]=this.lastSessionId),this.applicationId&&(n[vE]=this.applicationId),this.appCheckToken&&(n[A0]=this.appCheckToken),typeof location<"u"&&location.hostname&&xE.test(location.hostname)&&(n[pE]=gE);const i=this.urlFn(n);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){_r.forceAllow_=!0}static forceDisallow(){_r.forceDisallow_=!0}static isAvailable(){return _r.forceAllow_?!0:!_r.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!F4()&&!V4()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const s=Tt(e);this.bytesSent+=s.length,this.stats_.incrementCounter("bytes_sent",s.length);const n=uS(s),i=dE(n,u3);for(let a=0;a<i.length;a++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[a]),this.curSegmentNum++}addDisconnectPingFrame(e,s){this.myDisconnFrame=document.createElement("iframe");const n={};n[c3]="t",n[NE]=e,n[SE]=s,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const s=Tt(e).length;this.bytesReceived+=s,this.stats_.incrementCounter("bytes_received",s)}}class Fg{constructor(e,s,n,i){this.onDisconnect=n,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=cE(),window[n3+this.uniqueCallbackIdentifier]=e,window[i3+this.uniqueCallbackIdentifier]=s,this.myIFrame=Fg.createIFrame_();let a="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(a='<script>document.domain="'+document.domain+'";<\/script>');const l="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(l),this.myIFrame.doc.close()}catch(o){Mt("frame writing exception"),o.stack&&Mt(o.stack),Mt(o)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Mt("No IE domain setting required")}catch{const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,s){for(this.myID=e,this.myPW=s,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[NE]=this.myID,e[SE]=this.myPW,e[EE]=this.currentSerial;let s=this.urlFn(e),n="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+TE+n.length<=jE;){const l=this.pendingSegs.shift();n=n+"&"+r3+i+"="+l.seg+"&"+l3+i+"="+l.ts+"&"+o3+i+"="+l.d,i++}return s=s+n,this.addLongPollTag_(s,this.currentSerial),!0}else return!1}enqueueSegment(e,s,n){this.pendingSegs.push({seg:e,ts:s,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,s){this.outstandingRequests.add(s);const n=()=>{this.outstandingRequests.delete(s),this.newRequest_()},i=setTimeout(n,Math.floor(d3)),a=()=>{clearTimeout(i),n()};this.addTag(e,a)}addTag(e,s){setTimeout(()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const i=n.readyState;(!i||i==="loaded"||i==="complete")&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),s())},n.onerror=()=>{Mt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h3=16384,m3=45e3;let Ld=null;typeof MozWebSocket<"u"?Ld=MozWebSocket:typeof WebSocket<"u"&&(Ld=WebSocket);class Xs{constructor(e,s,n,i,a,l,o){this.connId=e,this.applicationId=n,this.appCheckToken=i,this.authToken=a,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Lc(this.connId),this.stats_=Gg(s),this.connURL=Xs.connectionURL_(s,l,o,i,n),this.nodeAdmin=s.nodeAdmin}static connectionURL_(e,s,n,i,a){const l={};return l[hE]=$g,typeof location<"u"&&location.hostname&&xE.test(location.hostname)&&(l[pE]=gE),s&&(l[mE]=s),n&&(l[bE]=n),i&&(l[A0]=i),a&&(l[vE]=a),kE(e,yE,l)}open(e,s){this.onDisconnect=s,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,ya.set("previous_websocket_failure",!0);try{let n;WC(),this.mySock=new Ld(this.connURL,[],n)}catch(n){this.log_("Error instantiating WebSocket.");const i=n.message||n.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=n=>{this.handleIncomingFrame(n)},this.mySock.onerror=n=>{this.log_("WebSocket error.  Closing connection.");const i=n.message||n.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){Xs.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const s=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(s);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&Ld!==null&&!Xs.forceDisallow_}static previouslyFailed(){return ya.isInMemoryStorage||ya.get("previous_websocket_failure")===!0}markConnectionHealthy(){ya.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const s=this.frames.join("");this.frames=null;const n=Yo(s);this.onMessage(n)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(X(this.frames===null,"We already have a frame buffer"),e.length<=6){const s=Number(e);if(!isNaN(s))return this.handleNewFrameCount_(s),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const s=e.data;if(this.bytesReceived+=s.length,this.stats_.incrementCounter("bytes_received",s.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(s);else{const n=this.extractFrameCount_(s);n!==null&&this.appendFrame_(n)}}send(e){this.resetKeepAlive();const s=Tt(e);this.bytesSent+=s.length,this.stats_.incrementCounter("bytes_sent",s.length);const n=dE(s,h3);n.length>1&&this.sendString_(String(n.length));for(let i=0;i<n.length;i++)this.sendString_(n[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(m3))}sendString_(e){try{this.mySock.send(e)}catch(s){this.log_("Exception thrown from WebSocket.send():",s.message||s.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Xs.responsesRequiredToBeHealthy=2;Xs.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{static get ALL_TRANSPORTS(){return[_r,Xs]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const s=Xs&&Xs.isAvailable();let n=s&&!Xs.previouslyFailed();if(e.webSocketOnly&&(s||Qt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[Xs];else{const i=this.transports_=[];for(const a of Jo.ALL_TRANSPORTS)a&&a.isAvailable()&&i.push(a);Jo.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Jo.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p3=6e4,g3=5e3,x3=10*1024,b3=100*1024,Xh="t",Ry="d",v3="s",Cy="r",y3="e",Iy="o",Oy="a",My="n",Dy="p",_3="h";class w3{constructor(e,s,n,i,a,l,o,c,u,d){this.id=e,this.repoInfo_=s,this.applicationId_=n,this.appCheckToken_=i,this.authToken_=a,this.onMessage_=l,this.onReady_=o,this.onDisconnect_=c,this.onKill_=u,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Lc("c:"+this.id+":"),this.transportManager_=new Jo(s),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const s=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(s,n)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=wo(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>b3?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>x3?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return s=>{e===this.conn_?this.onConnectionLost_(s):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return s=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(s):e===this.secondaryConn_?this.onSecondaryMessageReceived_(s):this.log_("message on old connection"))}}sendRequest(e){const s={t:"d",d:e};this.sendData_(s)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Xh in e){const s=e[Xh];s===Oy?this.upgradeIfSecondaryHealthy_():s===Cy?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):s===Iy&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const s=Vl("t",e),n=Vl("d",e);if(s==="c")this.onSecondaryControl_(n);else if(s==="d")this.pendingDataMessages.push(n);else throw new Error("Unknown protocol layer: "+s)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Dy,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Oy,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:My,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const s=Vl("t",e),n=Vl("d",e);s==="c"?this.onControl_(n):s==="d"&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const s=Vl(Xh,e);if(Ry in e){const n=e[Ry];if(s===_3){const i=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(s===My){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else s===v3?this.onConnectionShutdown_(n):s===Cy?this.onReset_(n):s===y3?T0("Server Error: "+n):s===Iy?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):T0("Unknown control packet command: "+s)}}onHandshake_(e){const s=e.ts,n=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,s),$g!==n&&Qt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const s=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(s,n),wo(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(p3))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,s){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(s,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):wo(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(g3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Dy,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(ya.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AE{put(e,s,n,i){}merge(e,s,n,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,s,n){}onDisconnectMerge(e,s,n){}onDisconnectCancel(e,s){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RE{constructor(e){this.allowedEvents_=e,this.listeners_={},X(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...s){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let i=0;i<n.length;i++)n[i].callback.apply(n[i].context,s)}}on(e,s,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:s,context:n});const i=this.getInitialEvent(e);i&&s.apply(n,i)}off(e,s,n){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let a=0;a<i.length;a++)if(i[a].callback===s&&(!n||n===i[a].context)){i.splice(a,1);return}}validateEventType_(e){X(this.allowedEvents_.find(s=>s===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pd extends RE{static getInstance(){return new Pd}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!jg()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return X(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ly=32,Py=768;class Be{constructor(e,s){if(s===void 0){this.pieces_=e.split("/");let n=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[n]=this.pieces_[i],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=s}toString(){let e="";for(let s=this.pieceNum_;s<this.pieces_.length;s++)this.pieces_[s]!==""&&(e+="/"+this.pieces_[s]);return e||"/"}}function Ae(){return new Be("")}function xe(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function zi(t){return t.pieces_.length-t.pieceNum_}function ze(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Be(t.pieces_,e)}function Vg(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function k3(t){let e="";for(let s=t.pieceNum_;s<t.pieces_.length;s++)t.pieces_[s]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[s])));return e||"/"}function Zo(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function CE(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let s=t.pieceNum_;s<t.pieces_.length-1;s++)e.push(t.pieces_[s]);return new Be(e,0)}function lt(t,e){const s=[];for(let n=t.pieceNum_;n<t.pieces_.length;n++)s.push(t.pieces_[n]);if(e instanceof Be)for(let n=e.pieceNum_;n<e.pieces_.length;n++)s.push(e.pieces_[n]);else{const n=e.split("/");for(let i=0;i<n.length;i++)n[i].length>0&&s.push(n[i])}return new Be(s,0)}function be(t){return t.pieceNum_>=t.pieces_.length}function qt(t,e){const s=xe(t),n=xe(e);if(s===null)return e;if(s===n)return qt(ze(t),ze(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function N3(t,e){const s=Zo(t,0),n=Zo(e,0);for(let i=0;i<s.length&&i<n.length;i++){const a=Qa(s[i],n[i]);if(a!==0)return a}return s.length===n.length?0:s.length<n.length?-1:1}function zg(t,e){if(zi(t)!==zi(e))return!1;for(let s=t.pieceNum_,n=e.pieceNum_;s<=t.pieces_.length;s++,n++)if(t.pieces_[s]!==e.pieces_[n])return!1;return!0}function Ds(t,e){let s=t.pieceNum_,n=e.pieceNum_;if(zi(t)>zi(e))return!1;for(;s<t.pieces_.length;){if(t.pieces_[s]!==e.pieces_[n])return!1;++s,++n}return!0}class S3{constructor(e,s){this.errorPrefix_=s,this.parts_=Zo(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let n=0;n<this.parts_.length;n++)this.byteLength_+=Af(this.parts_[n]);IE(this)}}function E3(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Af(e),IE(t)}function j3(t){const e=t.parts_.pop();t.byteLength_-=Af(e),t.parts_.length>0&&(t.byteLength_-=1)}function IE(t){if(t.byteLength_>Py)throw new Error(t.errorPrefix_+"has a key path longer than "+Py+" bytes ("+t.byteLength_+").");if(t.parts_.length>Ly)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Ly+") or object contains a cycle "+xa(t))}function xa(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kg extends RE{static getInstance(){return new Kg}constructor(){super(["visible"]);let e,s;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(s="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(s="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(s="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(s="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,s&&document.addEventListener(s,()=>{const n=!document[e];n!==this.visible_&&(this.visible_=n,this.trigger("visible",n))},!1)}getInitialEvent(e){return X(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zl=1e3,T3=60*5*1e3,By=30*1e3,A3=1.3,R3=3e4,C3="server_kill",Uy=3;class Un extends AE{constructor(e,s,n,i,a,l,o,c){if(super(),this.repoInfo_=e,this.applicationId_=s,this.onDataUpdate_=n,this.onConnectStatus_=i,this.onServerInfoUpdate_=a,this.authTokenProvider_=l,this.appCheckTokenProvider_=o,this.authOverride_=c,this.id=Un.nextPersistentConnectionId_++,this.log_=Lc("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=zl,this.maxReconnectDelay_=T3,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Kg.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Pd.getInstance().on("online",this.onOnline_,this)}sendRequest(e,s,n){const i=++this.requestNumber_,a={r:i,a:e,b:s};this.log_(Tt(a)),X(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(a),n&&(this.requestCBHash_[i]=n)}get(e){this.initConnection_();const s=new qs,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:l=>{const o=l.d;l.s==="ok"?s.resolve(o):s.reject(o)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const a=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(a),s.promise}listen(e,s,n,i){this.initConnection_();const a=e._queryIdentifier,l=e._path.toString();this.log_("Listen called for "+l+" "+a),this.listens.has(l)||this.listens.set(l,new Map),X(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),X(!this.listens.get(l).has(a),"listen() called twice for same path/queryId.");const o={onComplete:i,hashFn:s,query:e,tag:n};this.listens.get(l).set(a,o),this.connected_&&this.sendListen_(o)}sendGet_(e){const s=this.outstandingGets_[e];this.sendRequest("g",s.request,n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),s.onComplete&&s.onComplete(n)})}sendListen_(e){const s=e.query,n=s._path.toString(),i=s._queryIdentifier;this.log_("Listen on "+n+" for "+i);const a={p:n},l="q";e.tag&&(a.q=s._queryObject,a.t=e.tag),a.h=e.hashFn(),this.sendRequest(l,a,o=>{const c=o.d,u=o.s;Un.warnOnListenWarnings_(c,s),(this.listens.get(n)&&this.listens.get(n).get(i))===e&&(this.log_("listen response",o),u!=="ok"&&this.removeListen_(n,i),e.onComplete&&e.onComplete(u,c))})}static warnOnListenWarnings_(e,s){if(e&&typeof e=="object"&&an(e,"w")){const n=Ba(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const i='".indexOn": "'+s._queryParams.getIndex().toString()+'"',a=s._path.toString();Qt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${a} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||tI(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=By)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,s=eI(e)?"auth":"gauth",n={cred:e};this.authOverride_===null?n.noauth=!0:typeof this.authOverride_=="object"&&(n.authvar=this.authOverride_),this.sendRequest(s,n,i=>{const a=i.s,l=i.d||"error";this.authToken_===e&&(a==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(a,l))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const s=e.s,n=e.d||"error";s==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(s,n)})}unlisten(e,s){const n=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+i),X(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,i)&&this.connected_&&this.sendUnlisten_(n,i,e._queryObject,s)}sendUnlisten_(e,s,n,i){this.log_("Unlisten on "+e+" for "+s);const a={p:e},l="n";i&&(a.q=n,a.t=i),this.sendRequest(l,a)}onDisconnectPut(e,s,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,s,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:s,onComplete:n})}onDisconnectMerge(e,s,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,s,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:s,onComplete:n})}onDisconnectCancel(e,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:s})}sendOnDisconnect_(e,s,n,i){const a={p:s,d:n};this.log_("onDisconnect "+e,a),this.sendRequest(e,a,l=>{i&&setTimeout(()=>{i(l.s,l.d)},Math.floor(0))})}put(e,s,n,i){this.putInternal("p",e,s,n,i)}merge(e,s,n,i){this.putInternal("m",e,s,n,i)}putInternal(e,s,n,i,a){this.initConnection_();const l={p:s,d:n};a!==void 0&&(l.h=a),this.outstandingPuts_.push({action:e,request:l,onComplete:i}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+s)}sendPut_(e){const s=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(s,n,a=>{this.log_(s+" response",a),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(a.s,a.d)})}reportStats(e){if(this.connected_){const s={c:e};this.log_("reportStats",s),this.sendRequest("s",s,n=>{if(n.s!=="ok"){const a=n.d;this.log_("reportStats","Error sending stats: "+a)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Tt(e));const s=e.r,n=this.requestCBHash_[s];n&&(delete this.requestCBHash_[s],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,s){this.log_("handleServerMessage",e,s),e==="d"?this.onDataUpdate_(s.p,s.d,!1,s.t):e==="m"?this.onDataUpdate_(s.p,s.d,!0,s.t):e==="c"?this.onListenRevoked_(s.p,s.q):e==="ac"?this.onAuthRevoked_(s.s,s.d):e==="apc"?this.onAppCheckRevoked_(s.s,s.d):e==="sd"?this.onSecurityDebugPacket_(s):T0("Unrecognized action received from server: "+Tt(e)+`
Are you using the latest client?`)}onReady_(e,s){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=s,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){X(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=zl,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=zl,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>R3&&(this.reconnectDelay_=zl),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let s=Math.max(0,this.reconnectDelay_-e);s=Math.random()*s,this.log_("Trying to reconnect in "+s+"ms"),this.scheduleConnect_(s),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*A3)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),s=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+Un.nextConnectionId_++,a=this.lastSessionId;let l=!1,o=null;const c=function(){o?o.close():(l=!0,n())},u=function(f){X(o,"sendRequest call when we're not connected not allowed."),o.sendRequest(f)};this.realtime_={close:c,sendRequest:u};const d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[f,h]=await Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);l?Mt("getToken() completed but was canceled"):(Mt("getToken() completed. Creating connection."),this.authToken_=f&&f.accessToken,this.appCheckToken_=h&&h.token,o=new w3(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,s,n,m=>{Qt(m+" ("+this.repoInfo_.toString()+")"),this.interrupt(C3)},a))}catch(f){this.log_("Failed to get token: "+f),l||(this.repoInfo_.nodeAdmin&&Qt(f),c())}}}interrupt(e){Mt("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Mt("Resuming connection for reason: "+e),delete this.interruptReasons_[e],jd(this.interruptReasons_)&&(this.reconnectDelay_=zl,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const s=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:s})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const s=this.outstandingPuts_[e];s&&"h"in s.request&&s.queued&&(s.onComplete&&s.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,s){let n;s?n=s.map(a=>Hg(a)).join("$"):n="default";const i=this.removeListen_(e,n);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,s){const n=new Be(e).toString();let i;if(this.listens.has(n)){const a=this.listens.get(n);i=a.get(s),a.delete(s),a.size===0&&this.listens.delete(n)}else i=void 0;return i}onAuthRevoked_(e,s){Mt("Auth token revoked: "+e+"/"+s),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Uy&&(this.reconnectDelay_=By,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,s){Mt("App check token revoked: "+e+"/"+s),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Uy&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const s of e.values())this.sendListen_(s);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let s="js";e["sdk."+s+"."+lE.replace(/\./g,"-")]=1,jg()?e["framework.cordova"]=1:xS()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Pd.getInstance().currentlyOnline();return jd(this.interruptReasons_)&&e}}Un.nextPersistentConnectionId_=0;Un.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{constructor(e,s){this.name=e,this.node=s}static Wrap(e,s){return new ve(e,s)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mf{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,s){const n=new ve(tl,e),i=new ve(tl,s);return this.compare(n,i)!==0}minPost(){return ve.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gu;class OE extends Mf{static get __EMPTY_NODE(){return gu}static set __EMPTY_NODE(e){gu=e}compare(e,s){return Qa(e.name,s.name)}isDefinedOn(e){throw wl("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,s){return!1}minPost(){return ve.MIN}maxPost(){return new ve(Ga,gu)}makePost(e,s){return X(typeof e=="string","KeyIndex indexValue must always be a string."),new ve(e,gu)}toString(){return".key"}}const Ur=new OE;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xu{constructor(e,s,n,i,a=null){this.isReverse_=i,this.resultGenerator_=a,this.nodeStack_=[];let l=1;for(;!e.isEmpty();)if(e=e,l=s?n(e.key,s):1,i&&(l*=-1),l<0)this.isReverse_?e=e.left:e=e.right;else if(l===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),s;if(this.resultGenerator_?s=this.resultGenerator_(e.key,e.value):s={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return s}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class It{constructor(e,s,n,i,a){this.key=e,this.value=s,this.color=n??It.RED,this.left=i??rs.EMPTY_NODE,this.right=a??rs.EMPTY_NODE}copy(e,s,n,i,a){return new It(e??this.key,s??this.value,n??this.color,i??this.left,a??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,s,n){let i=this;const a=n(e,i.key);return a<0?i=i.copy(null,null,null,i.left.insert(e,s,n),null):a===0?i=i.copy(null,s,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,s,n)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return rs.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,s){let n,i;if(n=this,s(e,n.key)<0)!n.left.isEmpty()&&!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,s),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),!n.right.isEmpty()&&!n.right.isRed_()&&!n.right.left.isRed_()&&(n=n.moveRedRight_()),s(e,n.key)===0){if(n.right.isEmpty())return rs.EMPTY_NODE;i=n.right.min_(),n=n.copy(i.key,i.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,s))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,It.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,It.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),s=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,s)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}It.RED=!0;It.BLACK=!1;class I3{copy(e,s,n,i,a){return this}insert(e,s,n){return new It(e,s,null)}remove(e,s){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class rs{constructor(e,s=rs.EMPTY_NODE){this.comparator_=e,this.root_=s}insert(e,s){return new rs(this.comparator_,this.root_.insert(e,s,this.comparator_).copy(null,null,It.BLACK,null,null))}remove(e){return new rs(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,It.BLACK,null,null))}get(e){let s,n=this.root_;for(;!n.isEmpty();){if(s=this.comparator_(e,n.key),s===0)return n.value;s<0?n=n.left:s>0&&(n=n.right)}return null}getPredecessorKey(e){let s,n=this.root_,i=null;for(;!n.isEmpty();)if(s=this.comparator_(e,n.key),s===0){if(n.left.isEmpty())return i?i.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}else s<0?n=n.left:s>0&&(i=n,n=n.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new xu(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,s){return new xu(this.root_,e,this.comparator_,!1,s)}getReverseIteratorFrom(e,s){return new xu(this.root_,e,this.comparator_,!0,s)}getReverseIterator(e){return new xu(this.root_,null,this.comparator_,!0,e)}}rs.EMPTY_NODE=new I3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O3(t,e){return Qa(t.name,e.name)}function Yg(t,e){return Qa(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let R0;function M3(t){R0=t}const ME=function(t){return typeof t=="number"?"number:"+fE(t):"string:"+t},DE=function(t){if(t.isLeafNode()){const e=t.val();X(typeof e=="string"||typeof e=="number"||typeof e=="object"&&an(e,".sv"),"Priority must be a string or number.")}else X(t===R0||t.isEmpty(),"priority of unexpected type.");X(t===R0||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hy;class Rt{static set __childrenNodeConstructor(e){Hy=e}static get __childrenNodeConstructor(){return Hy}constructor(e,s=Rt.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=s,this.lazyHash_=null,X(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),DE(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Rt(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:Rt.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return be(e)?this:xe(e)===".priority"?this.priorityNode_:Rt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,s){return null}updateImmediateChild(e,s){return e===".priority"?this.updatePriority(s):s.isEmpty()&&e!==".priority"?this:Rt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,s).updatePriority(this.priorityNode_)}updateChild(e,s){const n=xe(e);return n===null?s:s.isEmpty()&&n!==".priority"?this:(X(n!==".priority"||zi(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(n,Rt.__childrenNodeConstructor.EMPTY_NODE.updateChild(ze(e),s)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,s){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+ME(this.priorityNode_.val())+":");const s=typeof this.value_;e+=s+":",s==="number"?e+=fE(this.value_):e+=this.value_,this.lazyHash_=uE(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Rt.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Rt.__childrenNodeConstructor?-1:(X(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const s=typeof e.value_,n=typeof this.value_,i=Rt.VALUE_TYPE_ORDER.indexOf(s),a=Rt.VALUE_TYPE_ORDER.indexOf(n);return X(i>=0,"Unknown leaf type: "+s),X(a>=0,"Unknown leaf type: "+n),i===a?n==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:a-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const s=e;return this.value_===s.value_&&this.priorityNode_.equals(s.priorityNode_)}else return!1}}Rt.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let LE,PE;function D3(t){LE=t}function L3(t){PE=t}class P3 extends Mf{compare(e,s){const n=e.node.getPriority(),i=s.node.getPriority(),a=n.compareTo(i);return a===0?Qa(e.name,s.name):a}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,s){return!e.getPriority().equals(s.getPriority())}minPost(){return ve.MIN}maxPost(){return new ve(Ga,new Rt("[PRIORITY-POST]",PE))}makePost(e,s){const n=LE(e);return new ve(s,new Rt("[PRIORITY-POST]",n))}toString(){return".priority"}}const nt=new P3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B3=Math.log(2);class U3{constructor(e){const s=a=>parseInt(Math.log(a)/B3,10),n=a=>parseInt(Array(a+1).join("1"),2);this.count=s(e+1),this.current_=this.count-1;const i=n(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Bd=function(t,e,s,n){t.sort(e);const i=function(c,u){const d=u-c;let f,h;if(d===0)return null;if(d===1)return f=t[c],h=s?s(f):f,new It(h,f.node,It.BLACK,null,null);{const m=parseInt(d/2,10)+c,v=i(c,m),x=i(m+1,u);return f=t[m],h=s?s(f):f,new It(h,f.node,It.BLACK,v,x)}},a=function(c){let u=null,d=null,f=t.length;const h=function(v,x){const b=f-v,g=f;f-=v;const p=i(b+1,g),y=t[b],k=s?s(y):y;m(new It(k,y.node,x,null,p))},m=function(v){u?(u.left=v,u=v):(d=v,u=v)};for(let v=0;v<c.count;++v){const x=c.nextBitIsOne(),b=Math.pow(2,c.count-(v+1));x?h(b,It.BLACK):(h(b,It.BLACK),h(b,It.RED))}return d},l=new U3(t.length),o=a(l);return new rs(n||e,o)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qh;const sr={};class Mn{static get Default(){return X(sr&&nt,"ChildrenNode.ts has not been loaded"),Qh=Qh||new Mn({".priority":sr},{".priority":nt}),Qh}constructor(e,s){this.indexes_=e,this.indexSet_=s}get(e){const s=Ba(this.indexes_,e);if(!s)throw new Error("No index defined for "+e);return s instanceof rs?s:null}hasIndex(e){return an(this.indexSet_,e.toString())}addIndex(e,s){X(e!==Ur,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let i=!1;const a=s.getIterator(ve.Wrap);let l=a.getNext();for(;l;)i=i||e.isDefinedOn(l.node),n.push(l),l=a.getNext();let o;i?o=Bd(n,e.getCompare()):o=sr;const c=e.toString(),u=Object.assign({},this.indexSet_);u[c]=e;const d=Object.assign({},this.indexes_);return d[c]=o,new Mn(d,u)}addToIndexes(e,s){const n=Td(this.indexes_,(i,a)=>{const l=Ba(this.indexSet_,a);if(X(l,"Missing index implementation for "+a),i===sr)if(l.isDefinedOn(e.node)){const o=[],c=s.getIterator(ve.Wrap);let u=c.getNext();for(;u;)u.name!==e.name&&o.push(u),u=c.getNext();return o.push(e),Bd(o,l.getCompare())}else return sr;else{const o=s.get(e.name);let c=i;return o&&(c=c.remove(new ve(e.name,o))),c.insert(e,e.node)}});return new Mn(n,this.indexSet_)}removeFromIndexes(e,s){const n=Td(this.indexes_,i=>{if(i===sr)return i;{const a=s.get(e.name);return a?i.remove(new ve(e.name,a)):i}});return new Mn(n,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Kl;class le{static get EMPTY_NODE(){return Kl||(Kl=new le(new rs(Yg),null,Mn.Default))}constructor(e,s,n){this.children_=e,this.priorityNode_=s,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&DE(this.priorityNode_),this.children_.isEmpty()&&X(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Kl}updatePriority(e){return this.children_.isEmpty()?this:new le(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const s=this.children_.get(e);return s===null?Kl:s}}getChild(e){const s=xe(e);return s===null?this:this.getImmediateChild(s).getChild(ze(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,s){if(X(s,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(s);{const n=new ve(e,s);let i,a;s.isEmpty()?(i=this.children_.remove(e),a=this.indexMap_.removeFromIndexes(n,this.children_)):(i=this.children_.insert(e,s),a=this.indexMap_.addToIndexes(n,this.children_));const l=i.isEmpty()?Kl:this.priorityNode_;return new le(i,l,a)}}updateChild(e,s){const n=xe(e);if(n===null)return s;{X(xe(e)!==".priority"||zi(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(n).updateChild(ze(e),s);return this.updateImmediateChild(n,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const s={};let n=0,i=0,a=!0;if(this.forEachChild(nt,(l,o)=>{s[l]=o.val(e),n++,a&&le.INTEGER_REGEXP_.test(l)?i=Math.max(i,Number(l)):a=!1}),!e&&a&&i<2*n){const l=[];for(const o in s)l[o]=s[o];return l}else return e&&!this.getPriority().isEmpty()&&(s[".priority"]=this.getPriority().val()),s}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+ME(this.getPriority().val())+":"),this.forEachChild(nt,(s,n)=>{const i=n.hash();i!==""&&(e+=":"+s+":"+i)}),this.lazyHash_=e===""?"":uE(e)}return this.lazyHash_}getPredecessorChildName(e,s,n){const i=this.resolveIndex_(n);if(i){const a=i.getPredecessorKey(new ve(e,s));return a?a.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const s=this.resolveIndex_(e);if(s){const n=s.minKey();return n&&n.name}else return this.children_.minKey()}getFirstChild(e){const s=this.getFirstChildName(e);return s?new ve(s,this.children_.get(s)):null}getLastChildName(e){const s=this.resolveIndex_(e);if(s){const n=s.maxKey();return n&&n.name}else return this.children_.maxKey()}getLastChild(e){const s=this.getLastChildName(e);return s?new ve(s,this.children_.get(s)):null}forEachChild(e,s){const n=this.resolveIndex_(e);return n?n.inorderTraversal(i=>s(i.name,i.node)):this.children_.inorderTraversal(s)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,s){const n=this.resolveIndex_(s);if(n)return n.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,ve.Wrap);let a=i.peek();for(;a!=null&&s.compare(a,e)<0;)i.getNext(),a=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,s){const n=this.resolveIndex_(s);if(n)return n.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,ve.Wrap);let a=i.peek();for(;a!=null&&s.compare(a,e)>0;)i.getNext(),a=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Pc?-1:0}withIndex(e){if(e===Ur||this.indexMap_.hasIndex(e))return this;{const s=this.indexMap_.addIndex(e,this.children_);return new le(this.children_,this.priorityNode_,s)}}isIndexed(e){return e===Ur||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const s=e;if(this.getPriority().equals(s.getPriority()))if(this.children_.count()===s.children_.count()){const n=this.getIterator(nt),i=s.getIterator(nt);let a=n.getNext(),l=i.getNext();for(;a&&l;){if(a.name!==l.name||!a.node.equals(l.node))return!1;a=n.getNext(),l=i.getNext()}return a===null&&l===null}else return!1;else return!1}}resolveIndex_(e){return e===Ur?null:this.indexMap_.get(e.toString())}}le.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class H3 extends le{constructor(){super(new rs(Yg),le.EMPTY_NODE,Mn.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return le.EMPTY_NODE}isEmpty(){return!1}}const Pc=new H3;Object.defineProperties(ve,{MIN:{value:new ve(tl,le.EMPTY_NODE)},MAX:{value:new ve(Ga,Pc)}});OE.__EMPTY_NODE=le.EMPTY_NODE;Rt.__childrenNodeConstructor=le;M3(Pc);L3(Pc);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $3=!0;function rt(t,e=null){if(t===null)return le.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),X(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const s=t;return new Rt(s,rt(e))}if(!(t instanceof Array)&&$3){const s=[];let n=!1;if(Lt(t,(l,o)=>{if(l.substring(0,1)!=="."){const c=rt(o);c.isEmpty()||(n=n||!c.getPriority().isEmpty(),s.push(new ve(l,c)))}}),s.length===0)return le.EMPTY_NODE;const a=Bd(s,O3,l=>l.name,Yg);if(n){const l=Bd(s,nt.getCompare());return new le(a,rt(e),new Mn({".priority":l},{".priority":nt}))}else return new le(a,rt(e),Mn.Default)}else{let s=le.EMPTY_NODE;return Lt(t,(n,i)=>{if(an(t,n)&&n.substring(0,1)!=="."){const a=rt(i);(a.isLeafNode()||!a.isEmpty())&&(s=s.updateImmediateChild(n,a))}}),s.updatePriority(rt(e))}}D3(rt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G3 extends Mf{constructor(e){super(),this.indexPath_=e,X(!be(e)&&xe(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,s){const n=this.extractChild(e.node),i=this.extractChild(s.node),a=n.compareTo(i);return a===0?Qa(e.name,s.name):a}makePost(e,s){const n=rt(e),i=le.EMPTY_NODE.updateChild(this.indexPath_,n);return new ve(s,i)}maxPost(){const e=le.EMPTY_NODE.updateChild(this.indexPath_,Pc);return new ve(Ga,e)}toString(){return Zo(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F3 extends Mf{compare(e,s){const n=e.node.compareTo(s.node);return n===0?Qa(e.name,s.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,s){return!e.equals(s)}minPost(){return ve.MIN}maxPost(){return ve.MAX}makePost(e,s){const n=rt(e);return new ve(s,n)}toString(){return".value"}}const V3=new F3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BE(t){return{type:"value",snapshotNode:t}}function sl(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function ec(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function tc(t,e,s){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:s}}function z3(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wg{constructor(e){this.index_=e}updateChild(e,s,n,i,a,l){X(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const o=e.getImmediateChild(s);return o.getChild(i).equals(n.getChild(i))&&o.isEmpty()===n.isEmpty()||(l!=null&&(n.isEmpty()?e.hasChild(s)?l.trackChildChange(ec(s,o)):X(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?l.trackChildChange(sl(s,n)):l.trackChildChange(tc(s,n,o))),e.isLeafNode()&&n.isEmpty())?e:e.updateImmediateChild(s,n).withIndex(this.index_)}updateFullNode(e,s,n){return n!=null&&(e.isLeafNode()||e.forEachChild(nt,(i,a)=>{s.hasChild(i)||n.trackChildChange(ec(i,a))}),s.isLeafNode()||s.forEachChild(nt,(i,a)=>{if(e.hasChild(i)){const l=e.getImmediateChild(i);l.equals(a)||n.trackChildChange(tc(i,a,l))}else n.trackChildChange(sl(i,a))})),s.withIndex(this.index_)}updatePriority(e,s){return e.isEmpty()?le.EMPTY_NODE:e.updatePriority(s)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(e){this.indexedFilter_=new Wg(e.getIndex()),this.index_=e.getIndex(),this.startPost_=sc.getStartPost_(e),this.endPost_=sc.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const s=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,n=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return s&&n}updateChild(e,s,n,i,a,l){return this.matches(new ve(s,n))||(n=le.EMPTY_NODE),this.indexedFilter_.updateChild(e,s,n,i,a,l)}updateFullNode(e,s,n){s.isLeafNode()&&(s=le.EMPTY_NODE);let i=s.withIndex(this.index_);i=i.updatePriority(le.EMPTY_NODE);const a=this;return s.forEachChild(nt,(l,o)=>{a.matches(new ve(l,o))||(i=i.updateImmediateChild(l,le.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,n)}updatePriority(e,s){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const s=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),s)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const s=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),s)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K3{constructor(e){this.withinDirectionalStart=s=>this.reverse_?this.withinEndPost(s):this.withinStartPost(s),this.withinDirectionalEnd=s=>this.reverse_?this.withinStartPost(s):this.withinEndPost(s),this.withinStartPost=s=>{const n=this.index_.compare(this.rangedFilter_.getStartPost(),s);return this.startIsInclusive_?n<=0:n<0},this.withinEndPost=s=>{const n=this.index_.compare(s,this.rangedFilter_.getEndPost());return this.endIsInclusive_?n<=0:n<0},this.rangedFilter_=new sc(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,s,n,i,a,l){return this.rangedFilter_.matches(new ve(s,n))||(n=le.EMPTY_NODE),e.getImmediateChild(s).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,s,n,i,a,l):this.fullLimitUpdateChild_(e,s,n,a,l)}updateFullNode(e,s,n){let i;if(s.isLeafNode()||s.isEmpty())i=le.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<s.numChildren()&&s.isIndexed(this.index_)){i=le.EMPTY_NODE.withIndex(this.index_);let a;this.reverse_?a=s.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):a=s.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let l=0;for(;a.hasNext()&&l<this.limit_;){const o=a.getNext();if(this.withinDirectionalStart(o))if(this.withinDirectionalEnd(o))i=i.updateImmediateChild(o.name,o.node),l++;else break;else continue}}else{i=s.withIndex(this.index_),i=i.updatePriority(le.EMPTY_NODE);let a;this.reverse_?a=i.getReverseIterator(this.index_):a=i.getIterator(this.index_);let l=0;for(;a.hasNext();){const o=a.getNext();l<this.limit_&&this.withinDirectionalStart(o)&&this.withinDirectionalEnd(o)?l++:i=i.updateImmediateChild(o.name,le.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,n)}updatePriority(e,s){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,s,n,i,a){let l;if(this.reverse_){const f=this.index_.getCompare();l=(h,m)=>f(m,h)}else l=this.index_.getCompare();const o=e;X(o.numChildren()===this.limit_,"");const c=new ve(s,n),u=this.reverse_?o.getFirstChild(this.index_):o.getLastChild(this.index_),d=this.rangedFilter_.matches(c);if(o.hasChild(s)){const f=o.getImmediateChild(s);let h=i.getChildAfterChild(this.index_,u,this.reverse_);for(;h!=null&&(h.name===s||o.hasChild(h.name));)h=i.getChildAfterChild(this.index_,h,this.reverse_);const m=h==null?1:l(h,c);if(d&&!n.isEmpty()&&m>=0)return a!=null&&a.trackChildChange(tc(s,n,f)),o.updateImmediateChild(s,n);{a!=null&&a.trackChildChange(ec(s,f));const x=o.updateImmediateChild(s,le.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(a!=null&&a.trackChildChange(sl(h.name,h.node)),x.updateImmediateChild(h.name,h.node)):x}}else return n.isEmpty()?e:d&&l(u,c)>=0?(a!=null&&(a.trackChildChange(ec(u.name,u.node)),a.trackChildChange(sl(s,n))),o.updateImmediateChild(s,n).updateImmediateChild(u.name,le.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qg{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=nt}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return X(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return X(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:tl}hasEnd(){return this.endSet_}getIndexEndValue(){return X(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return X(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Ga}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return X(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===nt}copy(){const e=new qg;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Y3(t){return t.loadsAllData()?new Wg(t.getIndex()):t.hasLimit()?new K3(t):new sc(t)}function W3(t,e){const s=t.copy();return s.limitSet_=!0,s.limit_=e,s.viewFrom_="r",s}function $y(t){const e={};if(t.isDefault())return e;let s;if(t.index_===nt?s="$priority":t.index_===V3?s="$value":t.index_===Ur?s="$key":(X(t.index_ instanceof G3,"Unrecognized index type!"),s=t.index_.toString()),e.orderBy=Tt(s),t.startSet_){const n=t.startAfterSet_?"startAfter":"startAt";e[n]=Tt(t.indexStartValue_),t.startNameSet_&&(e[n]+=","+Tt(t.indexStartName_))}if(t.endSet_){const n=t.endBeforeSet_?"endBefore":"endAt";e[n]=Tt(t.indexEndValue_),t.endNameSet_&&(e[n]+=","+Tt(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function Gy(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let s=t.viewFrom_;s===""&&(t.isViewFromLeft()?s="l":s="r"),e.vf=s}return t.index_!==nt&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ud extends AE{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,s){return s!==void 0?"tag$"+s:(X(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,s,n,i){super(),this.repoInfo_=e,this.onDataUpdate_=s,this.authTokenProvider_=n,this.appCheckTokenProvider_=i,this.log_=Lc("p:rest:"),this.listens_={}}listen(e,s,n,i){const a=e._path.toString();this.log_("Listen called for "+a+" "+e._queryIdentifier);const l=Ud.getListenId_(e,n),o={};this.listens_[l]=o;const c=$y(e._queryParams);this.restRequest_(a+".json",c,(u,d)=>{let f=d;if(u===404&&(f=null,u=null),u===null&&this.onDataUpdate_(a,f,!1,n),Ba(this.listens_,l)===o){let h;u?u===401?h="permission_denied":h="rest_error:"+u:h="ok",i(h,null)}})}unlisten(e,s){const n=Ud.getListenId_(e,s);delete this.listens_[n]}get(e){const s=$y(e._queryParams),n=e._path.toString(),i=new qs;return this.restRequest_(n+".json",s,(a,l)=>{let o=l;a===404&&(o=null,a=null),a===null?(this.onDataUpdate_(n,o,!1,null),i.resolve(o)):i.reject(new Error(o))}),i.promise}refreshAuthToken(e){}restRequest_(e,s={},n){return s.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,a])=>{i&&i.accessToken&&(s.auth=i.accessToken),a&&a.token&&(s.ac=a.token);const l=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Nl(s);this.log_("Sending REST request for "+l);const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(n&&o.readyState===4){this.log_("REST Response for "+l+" received. status:",o.status,"response:",o.responseText);let c=null;if(o.status>=200&&o.status<300){try{c=Yo(o.responseText)}catch{Qt("Failed to parse JSON response for "+l+": "+o.responseText)}n(null,c)}else o.status!==401&&o.status!==404&&Qt("Got unsuccessful REST response for "+l+" Status: "+o.status),n(o.status);n=null}},o.open("GET",l,!0),o.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q3{constructor(){this.rootNode_=le.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,s){this.rootNode_=this.rootNode_.updateChild(e,s)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hd(){return{value:null,children:new Map}}function jl(t,e,s){if(be(e))t.value=s,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,s);else{const n=xe(e);t.children.has(n)||t.children.set(n,Hd());const i=t.children.get(n);e=ze(e),jl(i,e,s)}}function C0(t,e){if(be(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{const s=t.value;return t.value=null,s.forEachChild(nt,(n,i)=>{jl(t,new Be(n),i)}),C0(t,e)}}else if(t.children.size>0){const s=xe(e);return e=ze(e),t.children.has(s)&&C0(t.children.get(s),e)&&t.children.delete(s),t.children.size===0}else return!0}function I0(t,e,s){t.value!==null?s(e,t.value):X3(t,(n,i)=>{const a=new Be(e.toString()+"/"+n);I0(i,a,s)})}function X3(t,e){t.children.forEach((s,n)=>{e(n,s)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q3{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),s=Object.assign({},e);return this.last_&&Lt(this.last_,(n,i)=>{s[n]=s[n]-i}),this.last_=e,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fy=10*1e3,J3=30*1e3,Z3=5*60*1e3;class eD{constructor(e,s){this.server_=s,this.statsToReport_={},this.statsListener_=new Q3(e);const n=Fy+(J3-Fy)*Math.random();wo(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),s={};let n=!1;Lt(e,(i,a)=>{a>0&&an(this.statsToReport_,i)&&(s[i]=a,n=!0)}),n&&this.server_.reportStats(s),wo(this.reportStats_.bind(this),Math.floor(Math.random()*2*Z3))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Js;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Js||(Js={}));function Xg(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Qg(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Jg(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $d{constructor(e,s,n){this.path=e,this.affectedTree=s,this.revert=n,this.type=Js.ACK_USER_WRITE,this.source=Xg()}operationForChild(e){if(be(this.path)){if(this.affectedTree.value!=null)return X(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const s=this.affectedTree.subtree(new Be(e));return new $d(Ae(),s,this.revert)}}else return X(xe(this.path)===e,"operationForChild called for unrelated child."),new $d(ze(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nc{constructor(e,s){this.source=e,this.path=s,this.type=Js.LISTEN_COMPLETE}operationForChild(e){return be(this.path)?new nc(this.source,Ae()):new nc(this.source,ze(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fa{constructor(e,s,n){this.source=e,this.path=s,this.snap=n,this.type=Js.OVERWRITE}operationForChild(e){return be(this.path)?new Fa(this.source,Ae(),this.snap.getImmediateChild(e)):new Fa(this.source,ze(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(e,s,n){this.source=e,this.path=s,this.children=n,this.type=Js.MERGE}operationForChild(e){if(be(this.path)){const s=this.children.subtree(new Be(e));return s.isEmpty()?null:s.value?new Fa(this.source,Ae(),s.value):new nl(this.source,Ae(),s)}else return X(xe(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new nl(this.source,ze(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(e,s,n){this.node_=e,this.fullyInitialized_=s,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(be(e))return this.isFullyInitialized()&&!this.filtered_;const s=xe(e);return this.isCompleteForChild(s)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tD{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function sD(t,e,s,n){const i=[],a=[];return e.forEach(l=>{l.type==="child_changed"&&t.index_.indexedValueChanged(l.oldSnap,l.snapshotNode)&&a.push(z3(l.childName,l.snapshotNode))}),Yl(t,i,"child_removed",e,n,s),Yl(t,i,"child_added",e,n,s),Yl(t,i,"child_moved",a,n,s),Yl(t,i,"child_changed",e,n,s),Yl(t,i,"value",e,n,s),i}function Yl(t,e,s,n,i,a){const l=n.filter(o=>o.type===s);l.sort((o,c)=>iD(t,o,c)),l.forEach(o=>{const c=nD(t,o,a);i.forEach(u=>{u.respondsTo(o.type)&&e.push(u.createEvent(c,t.query_))})})}function nD(t,e,s){return e.type==="value"||e.type==="child_removed"||(e.prevName=s.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function iD(t,e,s){if(e.childName==null||s.childName==null)throw wl("Should only compare child_ events.");const n=new ve(e.childName,e.snapshotNode),i=new ve(s.childName,s.snapshotNode);return t.index_.compare(n,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Df(t,e){return{eventCache:t,serverCache:e}}function ko(t,e,s,n){return Df(new Ki(e,s,n),t.serverCache)}function UE(t,e,s,n){return Df(t.eventCache,new Ki(e,s,n))}function Gd(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Va(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jh;const aD=()=>(Jh||(Jh=new rs(G4)),Jh);class Ye{static fromObject(e){let s=new Ye(null);return Lt(e,(n,i)=>{s=s.set(new Be(n),i)}),s}constructor(e,s=aD()){this.value=e,this.children=s}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,s){if(this.value!=null&&s(this.value))return{path:Ae(),value:this.value};if(be(e))return null;{const n=xe(e),i=this.children.get(n);if(i!==null){const a=i.findRootMostMatchingPathAndValue(ze(e),s);return a!=null?{path:lt(new Be(n),a.path),value:a.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(be(e))return this;{const s=xe(e),n=this.children.get(s);return n!==null?n.subtree(ze(e)):new Ye(null)}}set(e,s){if(be(e))return new Ye(s,this.children);{const n=xe(e),a=(this.children.get(n)||new Ye(null)).set(ze(e),s),l=this.children.insert(n,a);return new Ye(this.value,l)}}remove(e){if(be(e))return this.children.isEmpty()?new Ye(null):new Ye(null,this.children);{const s=xe(e),n=this.children.get(s);if(n){const i=n.remove(ze(e));let a;return i.isEmpty()?a=this.children.remove(s):a=this.children.insert(s,i),this.value===null&&a.isEmpty()?new Ye(null):new Ye(this.value,a)}else return this}}get(e){if(be(e))return this.value;{const s=xe(e),n=this.children.get(s);return n?n.get(ze(e)):null}}setTree(e,s){if(be(e))return s;{const n=xe(e),a=(this.children.get(n)||new Ye(null)).setTree(ze(e),s);let l;return a.isEmpty()?l=this.children.remove(n):l=this.children.insert(n,a),new Ye(this.value,l)}}fold(e){return this.fold_(Ae(),e)}fold_(e,s){const n={};return this.children.inorderTraversal((i,a)=>{n[i]=a.fold_(lt(e,i),s)}),s(e,this.value,n)}findOnPath(e,s){return this.findOnPath_(e,Ae(),s)}findOnPath_(e,s,n){const i=this.value?n(s,this.value):!1;if(i)return i;if(be(e))return null;{const a=xe(e),l=this.children.get(a);return l?l.findOnPath_(ze(e),lt(s,a),n):null}}foreachOnPath(e,s){return this.foreachOnPath_(e,Ae(),s)}foreachOnPath_(e,s,n){if(be(e))return this;{this.value&&n(s,this.value);const i=xe(e),a=this.children.get(i);return a?a.foreachOnPath_(ze(e),lt(s,i),n):new Ye(null)}}foreach(e){this.foreach_(Ae(),e)}foreach_(e,s){this.children.inorderTraversal((n,i)=>{i.foreach_(lt(e,n),s)}),this.value&&s(e,this.value)}foreachChild(e){this.children.inorderTraversal((s,n)=>{n.value&&e(s,n.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zs{constructor(e){this.writeTree_=e}static empty(){return new Zs(new Ye(null))}}function No(t,e,s){if(be(e))return new Zs(new Ye(s));{const n=t.writeTree_.findRootMostValueAndPath(e);if(n!=null){const i=n.path;let a=n.value;const l=qt(i,e);return a=a.updateChild(l,s),new Zs(t.writeTree_.set(i,a))}else{const i=new Ye(s),a=t.writeTree_.setTree(e,i);return new Zs(a)}}}function O0(t,e,s){let n=t;return Lt(s,(i,a)=>{n=No(n,lt(e,i),a)}),n}function Vy(t,e){if(be(e))return Zs.empty();{const s=t.writeTree_.setTree(e,new Ye(null));return new Zs(s)}}function M0(t,e){return Ja(t,e)!=null}function Ja(t,e){const s=t.writeTree_.findRootMostValueAndPath(e);return s!=null?t.writeTree_.get(s.path).getChild(qt(s.path,e)):null}function zy(t){const e=[],s=t.writeTree_.value;return s!=null?s.isLeafNode()||s.forEachChild(nt,(n,i)=>{e.push(new ve(n,i))}):t.writeTree_.children.inorderTraversal((n,i)=>{i.value!=null&&e.push(new ve(n,i.value))}),e}function Pi(t,e){if(be(e))return t;{const s=Ja(t,e);return s!=null?new Zs(new Ye(s)):new Zs(t.writeTree_.subtree(e))}}function D0(t){return t.writeTree_.isEmpty()}function il(t,e){return HE(Ae(),t.writeTree_,e)}function HE(t,e,s){if(e.value!=null)return s.updateChild(t,e.value);{let n=null;return e.children.inorderTraversal((i,a)=>{i===".priority"?(X(a.value!==null,"Priority writes must always be leaf nodes"),n=a.value):s=HE(lt(t,i),a,s)}),!s.getChild(t).isEmpty()&&n!==null&&(s=s.updateChild(lt(t,".priority"),n)),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lf(t,e){return VE(e,t)}function rD(t,e,s,n,i){X(n>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:s,writeId:n,visible:i}),i&&(t.visibleWrites=No(t.visibleWrites,e,s)),t.lastWriteId=n}function lD(t,e,s,n){X(n>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:s,writeId:n,visible:!0}),t.visibleWrites=O0(t.visibleWrites,e,s),t.lastWriteId=n}function oD(t,e){for(let s=0;s<t.allWrites.length;s++){const n=t.allWrites[s];if(n.writeId===e)return n}return null}function cD(t,e){const s=t.allWrites.findIndex(o=>o.writeId===e);X(s>=0,"removeWrite called with nonexistent writeId.");const n=t.allWrites[s];t.allWrites.splice(s,1);let i=n.visible,a=!1,l=t.allWrites.length-1;for(;i&&l>=0;){const o=t.allWrites[l];o.visible&&(l>=s&&uD(o,n.path)?i=!1:Ds(n.path,o.path)&&(a=!0)),l--}if(i){if(a)return dD(t),!0;if(n.snap)t.visibleWrites=Vy(t.visibleWrites,n.path);else{const o=n.children;Lt(o,c=>{t.visibleWrites=Vy(t.visibleWrites,lt(n.path,c))})}return!0}else return!1}function uD(t,e){if(t.snap)return Ds(t.path,e);for(const s in t.children)if(t.children.hasOwnProperty(s)&&Ds(lt(t.path,s),e))return!0;return!1}function dD(t){t.visibleWrites=$E(t.allWrites,fD,Ae()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function fD(t){return t.visible}function $E(t,e,s){let n=Zs.empty();for(let i=0;i<t.length;++i){const a=t[i];if(e(a)){const l=a.path;let o;if(a.snap)Ds(s,l)?(o=qt(s,l),n=No(n,o,a.snap)):Ds(l,s)&&(o=qt(l,s),n=No(n,Ae(),a.snap.getChild(o)));else if(a.children){if(Ds(s,l))o=qt(s,l),n=O0(n,o,a.children);else if(Ds(l,s))if(o=qt(l,s),be(o))n=O0(n,Ae(),a.children);else{const c=Ba(a.children,xe(o));if(c){const u=c.getChild(ze(o));n=No(n,Ae(),u)}}}else throw wl("WriteRecord should have .snap or .children")}}return n}function GE(t,e,s,n,i){if(!n&&!i){const a=Ja(t.visibleWrites,e);if(a!=null)return a;{const l=Pi(t.visibleWrites,e);if(D0(l))return s;if(s==null&&!M0(l,Ae()))return null;{const o=s||le.EMPTY_NODE;return il(l,o)}}}else{const a=Pi(t.visibleWrites,e);if(!i&&D0(a))return s;if(!i&&s==null&&!M0(a,Ae()))return null;{const l=function(u){return(u.visible||i)&&(!n||!~n.indexOf(u.writeId))&&(Ds(u.path,e)||Ds(e,u.path))},o=$E(t.allWrites,l,e),c=s||le.EMPTY_NODE;return il(o,c)}}}function hD(t,e,s){let n=le.EMPTY_NODE;const i=Ja(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(nt,(a,l)=>{n=n.updateImmediateChild(a,l)}),n;if(s){const a=Pi(t.visibleWrites,e);return s.forEachChild(nt,(l,o)=>{const c=il(Pi(a,new Be(l)),o);n=n.updateImmediateChild(l,c)}),zy(a).forEach(l=>{n=n.updateImmediateChild(l.name,l.node)}),n}else{const a=Pi(t.visibleWrites,e);return zy(a).forEach(l=>{n=n.updateImmediateChild(l.name,l.node)}),n}}function mD(t,e,s,n,i){X(n||i,"Either existingEventSnap or existingServerSnap must exist");const a=lt(e,s);if(M0(t.visibleWrites,a))return null;{const l=Pi(t.visibleWrites,a);return D0(l)?i.getChild(s):il(l,i.getChild(s))}}function pD(t,e,s,n){const i=lt(e,s),a=Ja(t.visibleWrites,i);if(a!=null)return a;if(n.isCompleteForChild(s)){const l=Pi(t.visibleWrites,i);return il(l,n.getNode().getImmediateChild(s))}else return null}function gD(t,e){return Ja(t.visibleWrites,e)}function xD(t,e,s,n,i,a,l){let o;const c=Pi(t.visibleWrites,e),u=Ja(c,Ae());if(u!=null)o=u;else if(s!=null)o=il(c,s);else return[];if(o=o.withIndex(l),!o.isEmpty()&&!o.isLeafNode()){const d=[],f=l.getCompare(),h=a?o.getReverseIteratorFrom(n,l):o.getIteratorFrom(n,l);let m=h.getNext();for(;m&&d.length<i;)f(m,n)!==0&&d.push(m),m=h.getNext();return d}else return[]}function bD(){return{visibleWrites:Zs.empty(),allWrites:[],lastWriteId:-1}}function Fd(t,e,s,n){return GE(t.writeTree,t.treePath,e,s,n)}function Zg(t,e){return hD(t.writeTree,t.treePath,e)}function Ky(t,e,s,n){return mD(t.writeTree,t.treePath,e,s,n)}function Vd(t,e){return gD(t.writeTree,lt(t.treePath,e))}function vD(t,e,s,n,i,a){return xD(t.writeTree,t.treePath,e,s,n,i,a)}function ex(t,e,s){return pD(t.writeTree,t.treePath,e,s)}function FE(t,e){return VE(lt(t.treePath,e),t.writeTree)}function VE(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yD{constructor(){this.changeMap=new Map}trackChildChange(e){const s=e.type,n=e.childName;X(s==="child_added"||s==="child_changed"||s==="child_removed","Only child changes supported for tracking"),X(n!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(n);if(i){const a=i.type;if(s==="child_added"&&a==="child_removed")this.changeMap.set(n,tc(n,e.snapshotNode,i.snapshotNode));else if(s==="child_removed"&&a==="child_added")this.changeMap.delete(n);else if(s==="child_removed"&&a==="child_changed")this.changeMap.set(n,ec(n,i.oldSnap));else if(s==="child_changed"&&a==="child_added")this.changeMap.set(n,sl(n,e.snapshotNode));else if(s==="child_changed"&&a==="child_changed")this.changeMap.set(n,tc(n,e.snapshotNode,i.oldSnap));else throw wl("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _D{getCompleteChild(e){return null}getChildAfterChild(e,s,n){return null}}const zE=new _D;class tx{constructor(e,s,n=null){this.writes_=e,this.viewCache_=s,this.optCompleteServerCache_=n}getCompleteChild(e){const s=this.viewCache_.eventCache;if(s.isCompleteForChild(e))return s.getNode().getImmediateChild(e);{const n=this.optCompleteServerCache_!=null?new Ki(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return ex(this.writes_,e,n)}}getChildAfterChild(e,s,n){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Va(this.viewCache_),a=vD(this.writes_,i,s,1,n,e);return a.length===0?null:a[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wD(t){return{filter:t}}function kD(t,e){X(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),X(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function ND(t,e,s,n,i){const a=new yD;let l,o;if(s.type===Js.OVERWRITE){const u=s;u.source.fromUser?l=L0(t,e,u.path,u.snap,n,i,a):(X(u.source.fromServer,"Unknown source."),o=u.source.tagged||e.serverCache.isFiltered()&&!be(u.path),l=zd(t,e,u.path,u.snap,n,i,o,a))}else if(s.type===Js.MERGE){const u=s;u.source.fromUser?l=ED(t,e,u.path,u.children,n,i,a):(X(u.source.fromServer,"Unknown source."),o=u.source.tagged||e.serverCache.isFiltered(),l=P0(t,e,u.path,u.children,n,i,o,a))}else if(s.type===Js.ACK_USER_WRITE){const u=s;u.revert?l=AD(t,e,u.path,n,i,a):l=jD(t,e,u.path,u.affectedTree,n,i,a)}else if(s.type===Js.LISTEN_COMPLETE)l=TD(t,e,s.path,n,a);else throw wl("Unknown operation type: "+s.type);const c=a.getChanges();return SD(e,l,c),{viewCache:l,changes:c}}function SD(t,e,s){const n=e.eventCache;if(n.isFullyInitialized()){const i=n.getNode().isLeafNode()||n.getNode().isEmpty(),a=Gd(t);(s.length>0||!t.eventCache.isFullyInitialized()||i&&!n.getNode().equals(a)||!n.getNode().getPriority().equals(a.getPriority()))&&s.push(BE(Gd(e)))}}function KE(t,e,s,n,i,a){const l=e.eventCache;if(Vd(n,s)!=null)return e;{let o,c;if(be(s))if(X(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const u=Va(e),d=u instanceof le?u:le.EMPTY_NODE,f=Zg(n,d);o=t.filter.updateFullNode(e.eventCache.getNode(),f,a)}else{const u=Fd(n,Va(e));o=t.filter.updateFullNode(e.eventCache.getNode(),u,a)}else{const u=xe(s);if(u===".priority"){X(zi(s)===1,"Can't have a priority with additional path components");const d=l.getNode();c=e.serverCache.getNode();const f=Ky(n,s,d,c);f!=null?o=t.filter.updatePriority(d,f):o=l.getNode()}else{const d=ze(s);let f;if(l.isCompleteForChild(u)){c=e.serverCache.getNode();const h=Ky(n,s,l.getNode(),c);h!=null?f=l.getNode().getImmediateChild(u).updateChild(d,h):f=l.getNode().getImmediateChild(u)}else f=ex(n,u,e.serverCache);f!=null?o=t.filter.updateChild(l.getNode(),u,f,d,i,a):o=l.getNode()}}return ko(e,o,l.isFullyInitialized()||be(s),t.filter.filtersNodes())}}function zd(t,e,s,n,i,a,l,o){const c=e.serverCache;let u;const d=l?t.filter:t.filter.getIndexedFilter();if(be(s))u=d.updateFullNode(c.getNode(),n,null);else if(d.filtersNodes()&&!c.isFiltered()){const m=c.getNode().updateChild(s,n);u=d.updateFullNode(c.getNode(),m,null)}else{const m=xe(s);if(!c.isCompleteForPath(s)&&zi(s)>1)return e;const v=ze(s),b=c.getNode().getImmediateChild(m).updateChild(v,n);m===".priority"?u=d.updatePriority(c.getNode(),b):u=d.updateChild(c.getNode(),m,b,v,zE,null)}const f=UE(e,u,c.isFullyInitialized()||be(s),d.filtersNodes()),h=new tx(i,f,a);return KE(t,f,s,i,h,o)}function L0(t,e,s,n,i,a,l){const o=e.eventCache;let c,u;const d=new tx(i,e,a);if(be(s))u=t.filter.updateFullNode(e.eventCache.getNode(),n,l),c=ko(e,u,!0,t.filter.filtersNodes());else{const f=xe(s);if(f===".priority")u=t.filter.updatePriority(e.eventCache.getNode(),n),c=ko(e,u,o.isFullyInitialized(),o.isFiltered());else{const h=ze(s),m=o.getNode().getImmediateChild(f);let v;if(be(h))v=n;else{const x=d.getCompleteChild(f);x!=null?Vg(h)===".priority"&&x.getChild(CE(h)).isEmpty()?v=x:v=x.updateChild(h,n):v=le.EMPTY_NODE}if(m.equals(v))c=e;else{const x=t.filter.updateChild(o.getNode(),f,v,h,d,l);c=ko(e,x,o.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function Yy(t,e){return t.eventCache.isCompleteForChild(e)}function ED(t,e,s,n,i,a,l){let o=e;return n.foreach((c,u)=>{const d=lt(s,c);Yy(e,xe(d))&&(o=L0(t,o,d,u,i,a,l))}),n.foreach((c,u)=>{const d=lt(s,c);Yy(e,xe(d))||(o=L0(t,o,d,u,i,a,l))}),o}function Wy(t,e,s){return s.foreach((n,i)=>{e=e.updateChild(n,i)}),e}function P0(t,e,s,n,i,a,l,o){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,u;be(s)?u=n:u=new Ye(null).setTree(s,n);const d=e.serverCache.getNode();return u.children.inorderTraversal((f,h)=>{if(d.hasChild(f)){const m=e.serverCache.getNode().getImmediateChild(f),v=Wy(t,m,h);c=zd(t,c,new Be(f),v,i,a,l,o)}}),u.children.inorderTraversal((f,h)=>{const m=!e.serverCache.isCompleteForChild(f)&&h.value===null;if(!d.hasChild(f)&&!m){const v=e.serverCache.getNode().getImmediateChild(f),x=Wy(t,v,h);c=zd(t,c,new Be(f),x,i,a,l,o)}}),c}function jD(t,e,s,n,i,a,l){if(Vd(i,s)!=null)return e;const o=e.serverCache.isFiltered(),c=e.serverCache;if(n.value!=null){if(be(s)&&c.isFullyInitialized()||c.isCompleteForPath(s))return zd(t,e,s,c.getNode().getChild(s),i,a,o,l);if(be(s)){let u=new Ye(null);return c.getNode().forEachChild(Ur,(d,f)=>{u=u.set(new Be(d),f)}),P0(t,e,s,u,i,a,o,l)}else return e}else{let u=new Ye(null);return n.foreach((d,f)=>{const h=lt(s,d);c.isCompleteForPath(h)&&(u=u.set(d,c.getNode().getChild(h)))}),P0(t,e,s,u,i,a,o,l)}}function TD(t,e,s,n,i){const a=e.serverCache,l=UE(e,a.getNode(),a.isFullyInitialized()||be(s),a.isFiltered());return KE(t,l,s,n,zE,i)}function AD(t,e,s,n,i,a){let l;if(Vd(n,s)!=null)return e;{const o=new tx(n,e,i),c=e.eventCache.getNode();let u;if(be(s)||xe(s)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=Fd(n,Va(e));else{const f=e.serverCache.getNode();X(f instanceof le,"serverChildren would be complete if leaf node"),d=Zg(n,f)}d=d,u=t.filter.updateFullNode(c,d,a)}else{const d=xe(s);let f=ex(n,d,e.serverCache);f==null&&e.serverCache.isCompleteForChild(d)&&(f=c.getImmediateChild(d)),f!=null?u=t.filter.updateChild(c,d,f,ze(s),o,a):e.eventCache.getNode().hasChild(d)?u=t.filter.updateChild(c,d,le.EMPTY_NODE,ze(s),o,a):u=c,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(l=Fd(n,Va(e)),l.isLeafNode()&&(u=t.filter.updateFullNode(u,l,a)))}return l=e.serverCache.isFullyInitialized()||Vd(n,Ae())!=null,ko(e,u,l,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(e,s){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,i=new Wg(n.getIndex()),a=Y3(n);this.processor_=wD(a);const l=s.serverCache,o=s.eventCache,c=i.updateFullNode(le.EMPTY_NODE,l.getNode(),null),u=a.updateFullNode(le.EMPTY_NODE,o.getNode(),null),d=new Ki(c,l.isFullyInitialized(),i.filtersNodes()),f=new Ki(u,o.isFullyInitialized(),a.filtersNodes());this.viewCache_=Df(f,d),this.eventGenerator_=new tD(this.query_)}get query(){return this.query_}}function CD(t){return t.viewCache_.serverCache.getNode()}function ID(t){return Gd(t.viewCache_)}function OD(t,e){const s=Va(t.viewCache_);return s&&(t.query._queryParams.loadsAllData()||!be(e)&&!s.getImmediateChild(xe(e)).isEmpty())?s.getChild(e):null}function qy(t){return t.eventRegistrations_.length===0}function MD(t,e){t.eventRegistrations_.push(e)}function Xy(t,e,s){const n=[];if(s){X(e==null,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach(a=>{const l=a.createCancelEvent(s,i);l&&n.push(l)})}if(e){let i=[];for(let a=0;a<t.eventRegistrations_.length;++a){const l=t.eventRegistrations_[a];if(!l.matches(e))i.push(l);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(a+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return n}function Qy(t,e,s,n){e.type===Js.MERGE&&e.source.queryId!==null&&(X(Va(t.viewCache_),"We should always have a full cache before handling merges"),X(Gd(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,a=ND(t.processor_,i,e,s,n);return kD(t.processor_,a.viewCache),X(a.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=a.viewCache,YE(t,a.changes,a.viewCache.eventCache.getNode(),null)}function DD(t,e){const s=t.viewCache_.eventCache,n=[];return s.getNode().isLeafNode()||s.getNode().forEachChild(nt,(a,l)=>{n.push(sl(a,l))}),s.isFullyInitialized()&&n.push(BE(s.getNode())),YE(t,n,s.getNode(),e)}function YE(t,e,s,n){const i=n?[n]:t.eventRegistrations_;return sD(t.eventGenerator_,e,s,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Kd;class WE{constructor(){this.views=new Map}}function LD(t){X(!Kd,"__referenceConstructor has already been defined"),Kd=t}function PD(){return X(Kd,"Reference.ts has not been loaded"),Kd}function BD(t){return t.views.size===0}function sx(t,e,s,n){const i=e.source.queryId;if(i!==null){const a=t.views.get(i);return X(a!=null,"SyncTree gave us an op for an invalid query."),Qy(a,e,s,n)}else{let a=[];for(const l of t.views.values())a=a.concat(Qy(l,e,s,n));return a}}function qE(t,e,s,n,i){const a=e._queryIdentifier,l=t.views.get(a);if(!l){let o=Fd(s,i?n:null),c=!1;o?c=!0:n instanceof le?(o=Zg(s,n),c=!1):(o=le.EMPTY_NODE,c=!1);const u=Df(new Ki(o,c,!1),new Ki(n,i,!1));return new RD(e,u)}return l}function UD(t,e,s,n,i,a){const l=qE(t,e,n,i,a);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,l),MD(l,s),DD(l,s)}function HD(t,e,s,n){const i=e._queryIdentifier,a=[];let l=[];const o=Yi(t);if(i==="default")for(const[c,u]of t.views.entries())l=l.concat(Xy(u,s,n)),qy(u)&&(t.views.delete(c),u.query._queryParams.loadsAllData()||a.push(u.query));else{const c=t.views.get(i);c&&(l=l.concat(Xy(c,s,n)),qy(c)&&(t.views.delete(i),c.query._queryParams.loadsAllData()||a.push(c.query)))}return o&&!Yi(t)&&a.push(new(PD())(e._repo,e._path)),{removed:a,events:l}}function XE(t){const e=[];for(const s of t.views.values())s.query._queryParams.loadsAllData()||e.push(s);return e}function Bi(t,e){let s=null;for(const n of t.views.values())s=s||OD(n,e);return s}function QE(t,e){if(e._queryParams.loadsAllData())return Pf(t);{const n=e._queryIdentifier;return t.views.get(n)}}function JE(t,e){return QE(t,e)!=null}function Yi(t){return Pf(t)!=null}function Pf(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yd;function $D(t){X(!Yd,"__referenceConstructor has already been defined"),Yd=t}function GD(){return X(Yd,"Reference.ts has not been loaded"),Yd}let FD=1;class Jy{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Ye(null),this.pendingWriteTree_=bD(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function nx(t,e,s,n,i){return rD(t.pendingWriteTree_,e,s,n,i),i?Tl(t,new Fa(Xg(),e,s)):[]}function VD(t,e,s,n){lD(t.pendingWriteTree_,e,s,n);const i=Ye.fromObject(s);return Tl(t,new nl(Xg(),e,i))}function wi(t,e,s=!1){const n=oD(t.pendingWriteTree_,e);if(cD(t.pendingWriteTree_,e)){let a=new Ye(null);return n.snap!=null?a=a.set(Ae(),!0):Lt(n.children,l=>{a=a.set(new Be(l),!0)}),Tl(t,new $d(n.path,a,s))}else return[]}function Bc(t,e,s){return Tl(t,new Fa(Qg(),e,s))}function zD(t,e,s){const n=Ye.fromObject(s);return Tl(t,new nl(Qg(),e,n))}function KD(t,e){return Tl(t,new nc(Qg(),e))}function YD(t,e,s){const n=ix(t,s);if(n){const i=ax(n),a=i.path,l=i.queryId,o=qt(a,e),c=new nc(Jg(l),o);return rx(t,a,c)}else return[]}function Wd(t,e,s,n,i=!1){const a=e._path,l=t.syncPointTree_.get(a);let o=[];if(l&&(e._queryIdentifier==="default"||JE(l,e))){const c=HD(l,e,s,n);BD(l)&&(t.syncPointTree_=t.syncPointTree_.remove(a));const u=c.removed;if(o=c.events,!i){const d=u.findIndex(h=>h._queryParams.loadsAllData())!==-1,f=t.syncPointTree_.findOnPath(a,(h,m)=>Yi(m));if(d&&!f){const h=t.syncPointTree_.subtree(a);if(!h.isEmpty()){const m=XD(h);for(let v=0;v<m.length;++v){const x=m[v],b=x.query,g=s2(t,x);t.listenProvider_.startListening(So(b),ic(t,b),g.hashFn,g.onComplete)}}}!f&&u.length>0&&!n&&(d?t.listenProvider_.stopListening(So(e),null):u.forEach(h=>{const m=t.queryToTagMap.get(Uf(h));t.listenProvider_.stopListening(So(h),m)}))}QD(t,u)}return o}function ZE(t,e,s,n){const i=ix(t,n);if(i!=null){const a=ax(i),l=a.path,o=a.queryId,c=qt(l,e),u=new Fa(Jg(o),c,s);return rx(t,l,u)}else return[]}function WD(t,e,s,n){const i=ix(t,n);if(i){const a=ax(i),l=a.path,o=a.queryId,c=qt(l,e),u=Ye.fromObject(s),d=new nl(Jg(o),c,u);return rx(t,l,d)}else return[]}function B0(t,e,s,n=!1){const i=e._path;let a=null,l=!1;t.syncPointTree_.foreachOnPath(i,(h,m)=>{const v=qt(h,i);a=a||Bi(m,v),l=l||Yi(m)});let o=t.syncPointTree_.get(i);o?(l=l||Yi(o),a=a||Bi(o,Ae())):(o=new WE,t.syncPointTree_=t.syncPointTree_.set(i,o));let c;a!=null?c=!0:(c=!1,a=le.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((m,v)=>{const x=Bi(v,Ae());x&&(a=a.updateImmediateChild(m,x))}));const u=JE(o,e);if(!u&&!e._queryParams.loadsAllData()){const h=Uf(e);X(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");const m=JD();t.queryToTagMap.set(h,m),t.tagToQueryMap.set(m,h)}const d=Lf(t.pendingWriteTree_,i);let f=UD(o,e,s,d,a,c);if(!u&&!l&&!n){const h=QE(o,e);f=f.concat(ZD(t,e,h))}return f}function Bf(t,e,s){const i=t.pendingWriteTree_,a=t.syncPointTree_.findOnPath(e,(l,o)=>{const c=qt(l,e),u=Bi(o,c);if(u)return u});return GE(i,e,a,s,!0)}function qD(t,e){const s=e._path;let n=null;t.syncPointTree_.foreachOnPath(s,(u,d)=>{const f=qt(u,s);n=n||Bi(d,f)});let i=t.syncPointTree_.get(s);i?n=n||Bi(i,Ae()):(i=new WE,t.syncPointTree_=t.syncPointTree_.set(s,i));const a=n!=null,l=a?new Ki(n,!0,!1):null,o=Lf(t.pendingWriteTree_,e._path),c=qE(i,e,o,a?l.getNode():le.EMPTY_NODE,a);return ID(c)}function Tl(t,e){return e2(e,t.syncPointTree_,null,Lf(t.pendingWriteTree_,Ae()))}function e2(t,e,s,n){if(be(t.path))return t2(t,e,s,n);{const i=e.get(Ae());s==null&&i!=null&&(s=Bi(i,Ae()));let a=[];const l=xe(t.path),o=t.operationForChild(l),c=e.children.get(l);if(c&&o){const u=s?s.getImmediateChild(l):null,d=FE(n,l);a=a.concat(e2(o,c,u,d))}return i&&(a=a.concat(sx(i,t,n,s))),a}}function t2(t,e,s,n){const i=e.get(Ae());s==null&&i!=null&&(s=Bi(i,Ae()));let a=[];return e.children.inorderTraversal((l,o)=>{const c=s?s.getImmediateChild(l):null,u=FE(n,l),d=t.operationForChild(l);d&&(a=a.concat(t2(d,o,c,u)))}),i&&(a=a.concat(sx(i,t,n,s))),a}function s2(t,e){const s=e.query,n=ic(t,s);return{hashFn:()=>(CD(e)||le.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return n?YD(t,s._path,n):KD(t,s._path);{const a=z4(i,s);return Wd(t,s,null,a)}}}}function ic(t,e){const s=Uf(e);return t.queryToTagMap.get(s)}function Uf(t){return t._path.toString()+"$"+t._queryIdentifier}function ix(t,e){return t.tagToQueryMap.get(e)}function ax(t){const e=t.indexOf("$");return X(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Be(t.substr(0,e))}}function rx(t,e,s){const n=t.syncPointTree_.get(e);X(n,"Missing sync point for query tag that we're tracking");const i=Lf(t.pendingWriteTree_,e);return sx(n,s,i,null)}function XD(t){return t.fold((e,s,n)=>{if(s&&Yi(s))return[Pf(s)];{let i=[];return s&&(i=XE(s)),Lt(n,(a,l)=>{i=i.concat(l)}),i}})}function So(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(GD())(t._repo,t._path):t}function QD(t,e){for(let s=0;s<e.length;++s){const n=e[s];if(!n._queryParams.loadsAllData()){const i=Uf(n),a=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(a)}}}function JD(){return FD++}function ZD(t,e,s){const n=e._path,i=ic(t,e),a=s2(t,s),l=t.listenProvider_.startListening(So(e),i,a.hashFn,a.onComplete),o=t.syncPointTree_.subtree(n);if(i)X(!Yi(o.value),"If we're adding a query, it shouldn't be shadowed");else{const c=o.fold((u,d,f)=>{if(!be(u)&&d&&Yi(d))return[Pf(d).query];{let h=[];return d&&(h=h.concat(XE(d).map(m=>m.query))),Lt(f,(m,v)=>{h=h.concat(v)}),h}});for(let u=0;u<c.length;++u){const d=c[u];t.listenProvider_.stopListening(So(d),ic(t,d))}}return l}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lx{constructor(e){this.node_=e}getImmediateChild(e){const s=this.node_.getImmediateChild(e);return new lx(s)}node(){return this.node_}}class ox{constructor(e,s){this.syncTree_=e,this.path_=s}getImmediateChild(e){const s=lt(this.path_,e);return new ox(this.syncTree_,s)}node(){return Bf(this.syncTree_,this.path_)}}const eL=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},Zy=function(t,e,s){if(!t||typeof t!="object")return t;if(X(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return tL(t[".sv"],e,s);if(typeof t[".sv"]=="object")return sL(t[".sv"],e);X(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},tL=function(t,e,s){switch(t){case"timestamp":return s.timestamp;default:X(!1,"Unexpected server value: "+t)}},sL=function(t,e,s){t.hasOwnProperty("increment")||X(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const n=t.increment;typeof n!="number"&&X(!1,"Unexpected increment value: "+n);const i=e.node();if(X(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return n;const l=i.getValue();return typeof l!="number"?n:l+n},n2=function(t,e,s,n){return ux(e,new ox(s,t),n)},cx=function(t,e,s){return ux(t,new lx(e),s)};function ux(t,e,s){const n=t.getPriority().val(),i=Zy(n,e.getImmediateChild(".priority"),s);let a;if(t.isLeafNode()){const l=t,o=Zy(l.getValue(),e,s);return o!==l.getValue()||i!==l.getPriority().val()?new Rt(o,rt(i)):t}else{const l=t;return a=l,i!==l.getPriority().val()&&(a=a.updatePriority(new Rt(i))),l.forEachChild(nt,(o,c)=>{const u=ux(c,e.getImmediateChild(o),s);u!==c&&(a=a.updateImmediateChild(o,u))}),a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dx{constructor(e="",s=null,n={children:{},childCount:0}){this.name=e,this.parent=s,this.node=n}}function Hf(t,e){let s=e instanceof Be?e:new Be(e),n=t,i=xe(s);for(;i!==null;){const a=Ba(n.node.children,i)||{children:{},childCount:0};n=new dx(i,n,a),s=ze(s),i=xe(s)}return n}function Za(t){return t.node.value}function fx(t,e){t.node.value=e,U0(t)}function i2(t){return t.node.childCount>0}function nL(t){return Za(t)===void 0&&!i2(t)}function $f(t,e){Lt(t.node.children,(s,n)=>{e(new dx(s,t,n))})}function a2(t,e,s,n){s&&e(t),$f(t,i=>{a2(i,e,!0)})}function iL(t,e,s){let n=t.parent;for(;n!==null;){if(e(n))return!0;n=n.parent}return!1}function Uc(t){return new Be(t.parent===null?t.name:Uc(t.parent)+"/"+t.name)}function U0(t){t.parent!==null&&aL(t.parent,t.name,t)}function aL(t,e,s){const n=nL(s),i=an(t.node.children,e);n&&i?(delete t.node.children[e],t.node.childCount--,U0(t)):!n&&!i&&(t.node.children[e]=s.node,t.node.childCount++,U0(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rL=/[\[\].#$\/\u0000-\u001F\u007F]/,lL=/[\[\].#$\u0000-\u001F\u007F]/,Zh=10*1024*1024,hx=function(t){return typeof t=="string"&&t.length!==0&&!rL.test(t)},r2=function(t){return typeof t=="string"&&t.length!==0&&!lL.test(t)},oL=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),r2(t)},mx=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Of(t)||t&&typeof t=="object"&&an(t,".sv")},qd=function(t,e,s,n){n&&e===void 0||Hc(Zr(t,"value"),e,s)},Hc=function(t,e,s){const n=s instanceof Be?new S3(s,t):s;if(e===void 0)throw new Error(t+"contains undefined "+xa(n));if(typeof e=="function")throw new Error(t+"contains a function "+xa(n)+" with contents = "+e.toString());if(Of(e))throw new Error(t+"contains "+e.toString()+" "+xa(n));if(typeof e=="string"&&e.length>Zh/3&&Af(e)>Zh)throw new Error(t+"contains a string greater than "+Zh+" utf8 bytes "+xa(n)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,a=!1;if(Lt(e,(l,o)=>{if(l===".value")i=!0;else if(l!==".priority"&&l!==".sv"&&(a=!0,!hx(l)))throw new Error(t+" contains an invalid key ("+l+") "+xa(n)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);E3(n,l),Hc(t,o,n),j3(n)}),i&&a)throw new Error(t+' contains ".value" child '+xa(n)+" in addition to actual children.")}},cL=function(t,e){let s,n;for(s=0;s<e.length;s++){n=e[s];const a=Zo(n);for(let l=0;l<a.length;l++)if(!(a[l]===".priority"&&l===a.length-1)){if(!hx(a[l]))throw new Error(t+"contains an invalid key ("+a[l]+") in path "+n.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(N3);let i=null;for(s=0;s<e.length;s++){if(n=e[s],i!==null&&Ds(i,n))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+n.toString());i=n}},l2=function(t,e,s,n){const i=Zr(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const a=[];Lt(e,(l,o)=>{const c=new Be(l);if(Hc(i,o,lt(s,c)),Vg(c)===".priority"&&!mx(o))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(c)}),cL(i,a)},uL=function(t,e,s){if(Of(e))throw new Error(Zr(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!mx(e))throw new Error(Zr(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},o2=function(t,e,s,n){if(!r2(s))throw new Error(Zr(t,e)+'was an invalid path = "'+s+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},dL=function(t,e,s,n){s&&(s=s.replace(/^\/*\.info(\/|$)/,"/")),o2(t,e,s)},ki=function(t,e){if(xe(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},fL=function(t,e){const s=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!hx(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||s.length!==0&&!oL(s))throw new Error(Zr(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hL{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Gf(t,e){let s=null;for(let n=0;n<e.length;n++){const i=e[n],a=i.getPath();s!==null&&!zg(a,s.path)&&(t.eventLists_.push(s),s=null),s===null&&(s={events:[],path:a}),s.events.push(i)}s&&t.eventLists_.push(s)}function c2(t,e,s){Gf(t,s),u2(t,n=>zg(n,e))}function Ns(t,e,s){Gf(t,s),u2(t,n=>Ds(n,e)||Ds(e,n))}function u2(t,e){t.recursionDepth_++;let s=!0;for(let n=0;n<t.eventLists_.length;n++){const i=t.eventLists_[n];if(i){const a=i.path;e(a)?(mL(t.eventLists_[n]),t.eventLists_[n]=null):s=!1}}s&&(t.eventLists_=[]),t.recursionDepth_--}function mL(t){for(let e=0;e<t.events.length;e++){const s=t.events[e];if(s!==null){t.events[e]=null;const n=s.getEventRunner();_o&&Mt("event: "+s.toString()),El(n)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pL="repo_interrupt",gL=25;class xL{constructor(e,s,n,i){this.repoInfo_=e,this.forceRestClient_=s,this.authTokenProvider_=n,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new hL,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Hd(),this.transactionQueueTree_=new dx,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function bL(t,e,s){if(t.stats_=Gg(t.repoInfo_),t.forceRestClient_||q4())t.server_=new Ud(t.repoInfo_,(n,i,a,l)=>{e1(t,n,i,a,l)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>t1(t,!0),0);else{if(typeof s<"u"&&s!==null){if(typeof s!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Tt(s)}catch(n){throw new Error("Invalid authOverride provided: "+n)}}t.persistentConnection_=new Un(t.repoInfo_,e,(n,i,a,l)=>{e1(t,n,i,a,l)},n=>{t1(t,n)},n=>{vL(t,n)},t.authTokenProvider_,t.appCheckProvider_,s),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(n=>{t.server_.refreshAuthToken(n)}),t.appCheckProvider_.addTokenChangeListener(n=>{t.server_.refreshAppCheckToken(n.token)}),t.statsReporter_=e3(t.repoInfo_,()=>new eD(t.stats_,t.server_)),t.infoData_=new q3,t.infoSyncTree_=new Jy({startListening:(n,i,a,l)=>{let o=[];const c=t.infoData_.getNode(n._path);return c.isEmpty()||(o=Bc(t.infoSyncTree_,n._path,c),setTimeout(()=>{l("ok")},0)),o},stopListening:()=>{}}),px(t,"connected",!1),t.serverSyncTree_=new Jy({startListening:(n,i,a,l)=>(t.server_.listen(n,a,i,(o,c)=>{const u=l(o,c);Ns(t.eventQueue_,n._path,u)}),[]),stopListening:(n,i)=>{t.server_.unlisten(n,i)}})}function d2(t){const s=t.infoData_.getNode(new Be(".info/serverTimeOffset")).val()||0;return new Date().getTime()+s}function $c(t){return eL({timestamp:d2(t)})}function e1(t,e,s,n,i){t.dataUpdateCount++;const a=new Be(e);s=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,s):s;let l=[];if(i)if(n){const c=Td(s,u=>rt(u));l=WD(t.serverSyncTree_,a,c,i)}else{const c=rt(s);l=ZE(t.serverSyncTree_,a,c,i)}else if(n){const c=Td(s,u=>rt(u));l=zD(t.serverSyncTree_,a,c)}else{const c=rt(s);l=Bc(t.serverSyncTree_,a,c)}let o=a;l.length>0&&(o=al(t,a)),Ns(t.eventQueue_,o,l)}function t1(t,e){px(t,"connected",e),e===!1&&kL(t)}function vL(t,e){Lt(e,(s,n)=>{px(t,s,n)})}function px(t,e,s){const n=new Be("/.info/"+e),i=rt(s);t.infoData_.updateSnapshot(n,i);const a=Bc(t.infoSyncTree_,n,i);Ns(t.eventQueue_,n,a)}function Ff(t){return t.nextWriteId_++}function yL(t,e,s){const n=qD(t.serverSyncTree_,e);return n!=null?Promise.resolve(n):t.server_.get(e).then(i=>{const a=rt(i).withIndex(e._queryParams.getIndex());B0(t.serverSyncTree_,e,s,!0);let l;if(e._queryParams.loadsAllData())l=Bc(t.serverSyncTree_,e._path,a);else{const o=ic(t.serverSyncTree_,e);l=ZE(t.serverSyncTree_,e._path,a,o)}return Ns(t.eventQueue_,e._path,l),Wd(t.serverSyncTree_,e,s,null,!0),a},i=>(Al(t,"get for query "+Tt(e)+" failed: "+i),Promise.reject(new Error(i))))}function _L(t,e,s,n,i){Al(t,"set",{path:e.toString(),value:s,priority:n});const a=$c(t),l=rt(s,n),o=Bf(t.serverSyncTree_,e),c=cx(l,o,a),u=Ff(t),d=nx(t.serverSyncTree_,e,c,u,!0);Gf(t.eventQueue_,d),t.server_.put(e.toString(),l.val(!0),(h,m)=>{const v=h==="ok";v||Qt("set at "+e+" failed: "+h);const x=wi(t.serverSyncTree_,u,!v);Ns(t.eventQueue_,e,x),Wi(t,i,h,m)});const f=xx(t,e);al(t,f),Ns(t.eventQueue_,f,[])}function wL(t,e,s,n){Al(t,"update",{path:e.toString(),value:s});let i=!0;const a=$c(t),l={};if(Lt(s,(o,c)=>{i=!1,l[o]=n2(lt(e,o),rt(c),t.serverSyncTree_,a)}),i)Mt("update() called with empty data.  Don't do anything."),Wi(t,n,"ok",void 0);else{const o=Ff(t),c=VD(t.serverSyncTree_,e,l,o);Gf(t.eventQueue_,c),t.server_.merge(e.toString(),s,(u,d)=>{const f=u==="ok";f||Qt("update at "+e+" failed: "+u);const h=wi(t.serverSyncTree_,o,!f),m=h.length>0?al(t,e):e;Ns(t.eventQueue_,m,h),Wi(t,n,u,d)}),Lt(s,u=>{const d=xx(t,lt(e,u));al(t,d)}),Ns(t.eventQueue_,e,[])}}function kL(t){Al(t,"onDisconnectEvents");const e=$c(t),s=Hd();I0(t.onDisconnect_,Ae(),(i,a)=>{const l=n2(i,a,t.serverSyncTree_,e);jl(s,i,l)});let n=[];I0(s,Ae(),(i,a)=>{n=n.concat(Bc(t.serverSyncTree_,i,a));const l=xx(t,i);al(t,l)}),t.onDisconnect_=Hd(),Ns(t.eventQueue_,Ae(),n)}function NL(t,e,s){t.server_.onDisconnectCancel(e.toString(),(n,i)=>{n==="ok"&&C0(t.onDisconnect_,e),Wi(t,s,n,i)})}function s1(t,e,s,n){const i=rt(s);t.server_.onDisconnectPut(e.toString(),i.val(!0),(a,l)=>{a==="ok"&&jl(t.onDisconnect_,e,i),Wi(t,n,a,l)})}function SL(t,e,s,n,i){const a=rt(s,n);t.server_.onDisconnectPut(e.toString(),a.val(!0),(l,o)=>{l==="ok"&&jl(t.onDisconnect_,e,a),Wi(t,i,l,o)})}function EL(t,e,s,n){if(jd(s)){Mt("onDisconnect().update() called with empty data.  Don't do anything."),Wi(t,n,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),s,(i,a)=>{i==="ok"&&Lt(s,(l,o)=>{const c=rt(o);jl(t.onDisconnect_,lt(e,l),c)}),Wi(t,n,i,a)})}function jL(t,e,s){let n;xe(e._path)===".info"?n=B0(t.infoSyncTree_,e,s):n=B0(t.serverSyncTree_,e,s),c2(t.eventQueue_,e._path,n)}function n1(t,e,s){let n;xe(e._path)===".info"?n=Wd(t.infoSyncTree_,e,s):n=Wd(t.serverSyncTree_,e,s),c2(t.eventQueue_,e._path,n)}function TL(t){t.persistentConnection_&&t.persistentConnection_.interrupt(pL)}function Al(t,...e){let s="";t.persistentConnection_&&(s=t.persistentConnection_.id+":"),Mt(s,...e)}function Wi(t,e,s,n){e&&El(()=>{if(s==="ok")e(null);else{const i=(s||"error").toUpperCase();let a=i;n&&(a+=": "+n);const l=new Error(a);l.code=i,e(l)}})}function AL(t,e,s,n,i,a){Al(t,"transaction on "+e);const l={path:e,update:s,onComplete:n,status:null,order:cE(),applyLocally:a,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},o=gx(t,e,void 0);l.currentInputSnapshot=o;const c=l.update(o.val());if(c===void 0)l.unwatcher(),l.currentOutputSnapshotRaw=null,l.currentOutputSnapshotResolved=null,l.onComplete&&l.onComplete(null,!1,l.currentInputSnapshot);else{Hc("transaction failed: Data returned ",c,l.path),l.status=0;const u=Hf(t.transactionQueueTree_,e),d=Za(u)||[];d.push(l),fx(u,d);let f;typeof c=="object"&&c!==null&&an(c,".priority")?(f=Ba(c,".priority"),X(mx(f),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):f=(Bf(t.serverSyncTree_,e)||le.EMPTY_NODE).getPriority().val();const h=$c(t),m=rt(c,f),v=cx(m,o,h);l.currentOutputSnapshotRaw=m,l.currentOutputSnapshotResolved=v,l.currentWriteId=Ff(t);const x=nx(t.serverSyncTree_,e,v,l.currentWriteId,l.applyLocally);Ns(t.eventQueue_,e,x),Vf(t,t.transactionQueueTree_)}}function gx(t,e,s){return Bf(t.serverSyncTree_,e,s)||le.EMPTY_NODE}function Vf(t,e=t.transactionQueueTree_){if(e||zf(t,e),Za(e)){const s=h2(t,e);X(s.length>0,"Sending zero length transaction queue"),s.every(i=>i.status===0)&&RL(t,Uc(e),s)}else i2(e)&&$f(e,s=>{Vf(t,s)})}function RL(t,e,s){const n=s.map(u=>u.currentWriteId),i=gx(t,e,n);let a=i;const l=i.hash();for(let u=0;u<s.length;u++){const d=s[u];X(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;const f=qt(e,d.path);a=a.updateChild(f,d.currentOutputSnapshotRaw)}const o=a.val(!0),c=e;t.server_.put(c.toString(),o,u=>{Al(t,"transaction put response",{path:c.toString(),status:u});let d=[];if(u==="ok"){const f=[];for(let h=0;h<s.length;h++)s[h].status=2,d=d.concat(wi(t.serverSyncTree_,s[h].currentWriteId)),s[h].onComplete&&f.push(()=>s[h].onComplete(null,!0,s[h].currentOutputSnapshotResolved)),s[h].unwatcher();zf(t,Hf(t.transactionQueueTree_,e)),Vf(t,t.transactionQueueTree_),Ns(t.eventQueue_,e,d);for(let h=0;h<f.length;h++)El(f[h])}else{if(u==="datastale")for(let f=0;f<s.length;f++)s[f].status===3?s[f].status=4:s[f].status=0;else{Qt("transaction at "+c.toString()+" failed: "+u);for(let f=0;f<s.length;f++)s[f].status=4,s[f].abortReason=u}al(t,e)}},l)}function al(t,e){const s=f2(t,e),n=Uc(s),i=h2(t,s);return CL(t,i,n),n}function CL(t,e,s){if(e.length===0)return;const n=[];let i=[];const l=e.filter(o=>o.status===0).map(o=>o.currentWriteId);for(let o=0;o<e.length;o++){const c=e[o],u=qt(s,c.path);let d=!1,f;if(X(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)d=!0,f=c.abortReason,i=i.concat(wi(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=gL)d=!0,f="maxretry",i=i.concat(wi(t.serverSyncTree_,c.currentWriteId,!0));else{const h=gx(t,c.path,l);c.currentInputSnapshot=h;const m=e[o].update(h.val());if(m!==void 0){Hc("transaction failed: Data returned ",m,c.path);let v=rt(m);typeof m=="object"&&m!=null&&an(m,".priority")||(v=v.updatePriority(h.getPriority()));const b=c.currentWriteId,g=$c(t),p=cx(v,h,g);c.currentOutputSnapshotRaw=v,c.currentOutputSnapshotResolved=p,c.currentWriteId=Ff(t),l.splice(l.indexOf(b),1),i=i.concat(nx(t.serverSyncTree_,c.path,p,c.currentWriteId,c.applyLocally)),i=i.concat(wi(t.serverSyncTree_,b,!0))}else d=!0,f="nodata",i=i.concat(wi(t.serverSyncTree_,c.currentWriteId,!0))}Ns(t.eventQueue_,s,i),i=[],d&&(e[o].status=2,function(h){setTimeout(h,Math.floor(0))}(e[o].unwatcher),e[o].onComplete&&(f==="nodata"?n.push(()=>e[o].onComplete(null,!1,e[o].currentInputSnapshot)):n.push(()=>e[o].onComplete(new Error(f),!1,null))))}zf(t,t.transactionQueueTree_);for(let o=0;o<n.length;o++)El(n[o]);Vf(t,t.transactionQueueTree_)}function f2(t,e){let s,n=t.transactionQueueTree_;for(s=xe(e);s!==null&&Za(n)===void 0;)n=Hf(n,s),e=ze(e),s=xe(e);return n}function h2(t,e){const s=[];return m2(t,e,s),s.sort((n,i)=>n.order-i.order),s}function m2(t,e,s){const n=Za(e);if(n)for(let i=0;i<n.length;i++)s.push(n[i]);$f(e,i=>{m2(t,i,s)})}function zf(t,e){const s=Za(e);if(s){let n=0;for(let i=0;i<s.length;i++)s[i].status!==2&&(s[n]=s[i],n++);s.length=n,fx(e,s.length>0?s:void 0)}$f(e,n=>{zf(t,n)})}function xx(t,e){const s=Uc(f2(t,e)),n=Hf(t.transactionQueueTree_,e);return iL(n,i=>{em(t,i)}),em(t,n),a2(n,i=>{em(t,i)}),s}function em(t,e){const s=Za(e);if(s){const n=[];let i=[],a=-1;for(let l=0;l<s.length;l++)s[l].status===3||(s[l].status===1?(X(a===l-1,"All SENT items should be at beginning of queue."),a=l,s[l].status=3,s[l].abortReason="set"):(X(s[l].status===0,"Unexpected transaction status in abort"),s[l].unwatcher(),i=i.concat(wi(t.serverSyncTree_,s[l].currentWriteId,!0)),s[l].onComplete&&n.push(s[l].onComplete.bind(null,new Error("set"),!1,null))));a===-1?fx(e,void 0):s.length=a+1,Ns(t.eventQueue_,Uc(e),i);for(let l=0;l<n.length;l++)El(n[l])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IL(t){let e="";const s=t.split("/");for(let n=0;n<s.length;n++)if(s[n].length>0){let i=s[n];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function OL(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const s of t.split("&")){if(s.length===0)continue;const n=s.split("=");n.length===2?e[decodeURIComponent(n[0])]=decodeURIComponent(n[1]):Qt(`Invalid query segment '${s}' in query '${t}'`)}return e}const i1=function(t,e){const s=ML(t),n=s.namespace;s.domain==="firebase.com"&&qn(s.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!n||n==="undefined")&&s.domain!=="localhost"&&qn("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),s.secure||H4();const i=s.scheme==="ws"||s.scheme==="wss";return{repoInfo:new wE(s.host,s.secure,n,i,e,"",n!==s.subdomain),path:new Be(s.pathString)}},ML=function(t){let e="",s="",n="",i="",a="",l=!0,o="https",c=443;if(typeof t=="string"){let u=t.indexOf("//");u>=0&&(o=t.substring(0,u-1),t=t.substring(u+2));let d=t.indexOf("/");d===-1&&(d=t.length);let f=t.indexOf("?");f===-1&&(f=t.length),e=t.substring(0,Math.min(d,f)),d<f&&(i=IL(t.substring(d,f)));const h=OL(t.substring(Math.min(t.length,f)));u=e.indexOf(":"),u>=0?(l=o==="https"||o==="wss",c=parseInt(e.substring(u+1),10)):u=e.length;const m=e.slice(0,u);if(m.toLowerCase()==="localhost")s="localhost";else if(m.split(".").length<=2)s=m;else{const v=e.indexOf(".");n=e.substring(0,v).toLowerCase(),s=e.substring(v+1),a=n}"ns"in h&&(a=h.ns)}return{host:e,port:c,domain:s,subdomain:n,secure:l,scheme:o,pathString:i,namespace:a}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a1="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",DL=function(){let t=0;const e=[];return function(s){const n=s===t;t=s;let i;const a=new Array(8);for(i=7;i>=0;i--)a[i]=a1.charAt(s%64),s=Math.floor(s/64);X(s===0,"Cannot push at time == 0");let l=a.join("");if(n){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)l+=a1.charAt(e[i]);return X(l.length===20,"nextPushId: Length should be 20."),l}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LL{constructor(e,s,n,i){this.eventType=e,this.eventRegistration=s,this.snapshot=n,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Tt(this.snapshot.exportVal())}}class PL{constructor(e,s,n){this.eventRegistration=e,this.error=s,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p2{constructor(e,s){this.snapshotCallback=e,this.cancelCallback=s}onValue(e,s){this.snapshotCallback.call(null,e,s)}onCancel(e){return X(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BL{constructor(e,s){this._repo=e,this._path=s}cancel(){const e=new qs;return NL(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){ki("OnDisconnect.remove",this._path);const e=new qs;return s1(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){ki("OnDisconnect.set",this._path),qd("OnDisconnect.set",e,this._path,!1);const s=new qs;return s1(this._repo,this._path,e,s.wrapCallback(()=>{})),s.promise}setWithPriority(e,s){ki("OnDisconnect.setWithPriority",this._path),qd("OnDisconnect.setWithPriority",e,this._path,!1),uL("OnDisconnect.setWithPriority",s);const n=new qs;return SL(this._repo,this._path,e,s,n.wrapCallback(()=>{})),n.promise}update(e){ki("OnDisconnect.update",this._path),l2("OnDisconnect.update",e,this._path);const s=new qs;return EL(this._repo,this._path,e,s.wrapCallback(()=>{})),s.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kf{constructor(e,s,n,i){this._repo=e,this._path=s,this._queryParams=n,this._orderByCalled=i}get key(){return be(this._path)?null:Vg(this._path)}get ref(){return new bn(this._repo,this._path)}get _queryIdentifier(){const e=Gy(this._queryParams),s=Hg(e);return s==="{}"?"default":s}get _queryObject(){return Gy(this._queryParams)}isEqual(e){if(e=Nt(e),!(e instanceof Kf))return!1;const s=this._repo===e._repo,n=zg(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return s&&n&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+k3(this._path)}}class bn extends Kf{constructor(e,s){super(e,s,new qg,!1)}get parent(){const e=CE(this._path);return e===null?null:new bn(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class rl{constructor(e,s,n){this._node=e,this.ref=s,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const s=new Be(e),n=ac(this.ref,e);return new rl(this._node.getChild(s),n,nt)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(n,i)=>e(new rl(i,ac(this.ref,n),nt)))}hasChild(e){const s=new Be(e);return!this._node.getChild(s).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function $(t,e){return t=Nt(t),t._checkNotDeleted("ref"),e!==void 0?ac(t._root,e):t._root}function ac(t,e){return t=Nt(t),xe(t._path)===null?dL("child","path",e):o2("child","path",e),new bn(t._repo,lt(t._path,e))}function r1(t){return t=Nt(t),new BL(t._repo,t._path)}function bx(t,e){t=Nt(t),ki("push",t._path),qd("push",e,t._path,!0);const s=d2(t._repo),n=DL(s),i=ac(t,n),a=ac(t,n);let l;return e!=null?l=qi(a,e).then(()=>a):l=Promise.resolve(a),i.then=l.then.bind(l),i.catch=l.then.bind(l,void 0),i}function l1(t){return ki("remove",t._path),qi(t,null)}function qi(t,e){t=Nt(t),ki("set",t._path),qd("set",e,t._path,!1);const s=new qs;return _L(t._repo,t._path,e,null,s.wrapCallback(()=>{})),s.promise}function ne(t,e){l2("update",e,t._path);const s=new qs;return wL(t._repo,t._path,e,s.wrapCallback(()=>{})),s.promise}function de(t){t=Nt(t);const e=new p2(()=>{}),s=new Yf(e);return yL(t._repo,t,s).then(n=>new rl(n,new bn(t._repo,t._path),t._queryParams.getIndex()))}class Yf{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,s){const n=s._queryParams.getIndex();return new LL("value",this,new rl(e.snapshotNode,new bn(s._repo,s._path),n))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,s){return this.callbackContext.hasCancelCallback?new PL(this,e,s):null}matches(e){return e instanceof Yf?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function UL(t,e,s,n,i){let a;if(typeof n=="object"&&(a=void 0,i=n),typeof n=="function"&&(a=n),i&&i.onlyOnce){const c=s,u=(d,f)=>{n1(t._repo,t,o),c(d,f)};u.userCallback=s.userCallback,u.context=s.context,s=u}const l=new p2(s,a||void 0),o=new Yf(l);return jL(t._repo,t,o),()=>n1(t._repo,t,o)}function $e(t,e,s,n){return UL(t,"value",e,s,n)}class HL{}class $L extends HL{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Kf(e._repo,e._path,W3(e._queryParams,this._limit),e._orderByCalled)}}function GL(t){if(Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new $L(t)}function FL(t,...e){let s=Nt(t);for(const n of e)s=n._apply(s);return s}LD(bn);$D(bn);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VL="FIREBASE_DATABASE_EMULATOR_HOST",H0={};let zL=!1;function KL(t,e,s,n){const i=e.lastIndexOf(":"),a=e.substring(0,i),l=kl(a);t.repoInfo_=new wE(e,l,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0,s),n&&(t.authTokenProvider_=n)}function YL(t,e,s,n,i){let a=n||t.options.databaseURL;a===void 0&&(t.options.projectId||qn("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Mt("Using default host for project ",t.options.projectId),a=`${t.options.projectId}-default-rtdb.firebaseio.com`);let l=i1(a,i),o=l.repoInfo,c;typeof process<"u"&&Ny&&(c=Ny[VL]),c?(a=`http://${c}?ns=${o.namespace}`,l=i1(a,i),o=l.repoInfo):l.repoInfo.secure;const u=new Q4(t.name,t.options,e);fL("Invalid Firebase Database URL",l),be(l.path)||qn("Database URL must point to the root of a Firebase Database (not including a child path).");const d=qL(o,t,u,new X4(t,s));return new XL(d,t)}function WL(t,e){const s=H0[e];(!s||s[t.key]!==t)&&qn(`Database ${e}(${t.repoInfo_}) has already been deleted.`),TL(t),delete s[t.key]}function qL(t,e,s,n){let i=H0[e.name];i||(i={},H0[e.name]=i);let a=i[t.toURLString()];return a&&qn("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),a=new xL(t,zL,s,n),i[t.toURLString()]=a,a}class XL{constructor(e,s){this._repoInternal=e,this.app=s,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(bL(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new bn(this._repo,Ae())),this._rootInternal}_delete(){return this._rootInternal!==null&&(WL(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&qn("Cannot call "+e+" on a deleted database.")}}function QL(t=wS(),e){const s=Rg(t,"database").getImmediate({identifier:e});if(!s._instanceStarted){const n=$C("database");n&&JL(s,...n)}return s}function JL(t,e,s,n={}){t=Nt(t),t._checkNotDeleted("useEmulator");const i=`${e}:${s}`,a=t._repoInternal;if(t._instanceStarted){if(i===t._repoInternal.repoInfo_.host&&Ua(n,a.repoInfo_.emulatorOptions))return;qn("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let l;if(a.repoInfo_.nodeAdmin)n.mockUserToken&&qn('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),l=new zu(zu.OWNER);else if(n.mockUserToken){const o=typeof n.mockUserToken=="string"?n.mockUserToken:GC(n.mockUserToken,t.app.options.projectId);l=new zu(o)}kl(e)&&(pS(e),gS("Database",!0)),KL(a,i,n,l)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZL(t){D4(Sl),el(new Ha("database",(e,{instanceIdentifier:s})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),a=e.getProvider("app-check-internal");return YL(n,i,a,s)},"PUBLIC").setMultipleInstances(!0)),Li(Sy,Ey,t),Li(Sy,Ey,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e6={".sv":"timestamp"};function t6(){return e6}function g2(t){return{".sv":{increment:t}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s6{constructor(e,s){this.committed=e,this.snapshot=s}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function je(t,e,s){var n;if(t=Nt(t),ki("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";const i=(n=void 0)!==null&&n!==void 0?n:!0,a=new qs,l=(c,u,d)=>{let f=null;c?a.reject(c):(f=new rl(d,new bn(t._repo,t._path),nt),a.resolve(new s6(u,f)))},o=$e(t,()=>{});return AL(t._repo,t._path,e,l,o,i),a.promise}Un.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Un.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};ZL();var n6="firebase",i6="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Li(n6,i6,"app");const a6={apiKey:"AIzaSyBU11CvtAaUkADomFxcMuN6fH9ipx-VtAs",authDomain:"eiriksbok-simuleringfeudal.firebaseapp.com",databaseURL:"https://eiriksbok-simuleringfeudal-default-rtdb.europe-west1.firebasedatabase.app",projectId:"eiriksbok-simuleringfeudal",storageBucket:"eiriksbok-simuleringfeudal.firebasestorage.app",messagingSenderId:"772081963542",appId:"1:772081963542:web:05edb87535f629fd36db37",measurementId:"G-NDR8LNVQNX"},x2=_S(a6,"simulationApp"),G=QL(x2),nr=O4(x2),b2=_.createContext(void 0),r6=({children:t})=>{const[e,s]=_.useState(null),[n,i]=_.useState(null),[a,l]=_.useState(!0),[o,c]=_.useState(null),[u,d]=_.useState(!0);_.useEffect(()=>{const b=_M(nr,async g=>{if(g){s(g),d(g.isAnonymous);const p=$(G,`simulation_accounts/${g.uid}`),y=$e(p,async k=>{if(k.exists())i(k.val()),l(!1);else{const N={uid:g.uid,displayName:g.displayName||`Eventyrer_${g.uid.slice(0,4)}`,globalXp:0,globalLevel:1,totalGoldEarned:0,unlockedAchievements:[],characterHistory:[],lastActive:Date.now()};await qi(p,N),i(N),l(!1)}});return()=>y()}else{d(!0);try{await uM(nr)}catch(p){console.error("Auth failed:",p),l(!1)}}});return()=>b()},[]);const f=async(b,g)=>{c(null);try{await bM(nr,b,g)}catch(p){throw c(p.message),p}},h=async b=>{const g=b.trim().toLowerCase();if(!g||g.length<3)return!1;const p=$(G,`simulation_reserved_names/${g}`);return!(await de(p)).exists()},m=async(b,g,p)=>{c(null);const y=p.trim(),k=y.toLowerCase();try{if(!await h(y))throw new Error("Navnet er allerede tatt.");if(e&&e.isAnonymous){const S=Xa.credential(b,g);await pM(e,S);const w={};w[`simulation_accounts/${e.uid}/displayName`]=y,w[`simulation_reserved_names/${k}`]=e.uid,await ne($(G),w)}else{const S=await xM(nr,b,g),w={};w[`simulation_reserved_names/${k}`]=S.user.uid;const E={uid:S.user.uid,displayName:y,globalXp:0,globalLevel:1,totalGoldEarned:0,unlockedAchievements:[],characterHistory:[],lastActive:Date.now()};w[`simulation_accounts/${S.user.uid}`]=E,await ne($(G),w)}}catch(N){throw c(N.message),N}},v=async()=>{await wM(nr)},x=async b=>{try{await gM(nr,b)}catch(g){throw c(g.message),g}};return r.jsx(b2.Provider,{value:{user:e,account:n,loading:a,isAnonymous:u,error:o,login:f,register:m,logout:v,resetPassword:x,checkNameAvailability:h},children:t})},Wf=()=>{const t=_.useContext(b2);if(!t)throw new Error("useSimulationAuth must be used within a SimulationAuthProvider");return t},v2=[{id:"Ashes of the Keep.mp3",title:"Festningens Aske",mood:"Dark"},{id:"Banner at the Old Stone Keep.mp3",title:"Gamle Steiner",mood:"Epic"},{id:"Banner at the Old Stone Keep (1).mp3",title:"Steinhallens Hymne",mood:"Epic"},{id:"Burning Banners Over Stone.mp3",title:"Brennende Bannere",mood:"Dark"},{id:"Candlelit Keep.mp3",title:"Lys i Hallen",mood:"Calm"},{id:"Candlelit Keep (1).mp3",title:"Nattens Vakt",mood:"Calm"},{id:"Crown of Quiet Rooms.mp3",title:"Stillhetens Krone",mood:"Mysterious"},{id:"Crown of Quiet Rooms (1).mp3",title:"Kongens Tvil",mood:"Mysterious"}],va=class va{constructor(){et(this,"sfxVolume",.5);et(this,"musicVolume",.3);et(this,"currentMusic",null);et(this,"currentMusicKey",null);et(this,"playlist",[]);et(this,"playlistIndex",0);et(this,"isPlaylistActive",!1);et(this,"ignoredTracks",new Set);et(this,"audioContext",null);et(this,"filterNode",null);et(this,"isMuffledState",!1);et(this,"activeFades",new Map);const e=localStorage.getItem("sim_sfx_volume"),s=localStorage.getItem("sim_music_volume"),n=localStorage.getItem("sim_music_muffled"),i=localStorage.getItem("sim_music_ignored");if(e&&(this.sfxVolume=parseFloat(e)),s&&(this.musicVolume=parseFloat(s)),n&&(this.isMuffledState=n==="true"),i)try{this.ignoredTracks=new Set(JSON.parse(i))}catch(a){console.error("Failed to parse ignored tracks",a)}this.playlist=v2.map(a=>a.id),this.shufflePlaylist()}shufflePlaylist(){this.playlist=this.playlist.sort(()=>Math.random()-.5)}initAudioContext(){if(!this.audioContext)try{this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.filterNode=this.audioContext.createBiquadFilter(),this.filterNode.type="lowpass",this.filterNode.frequency.setValueAtTime(this.isMuffledState?12e3:2e4,this.audioContext.currentTime),this.filterNode.connect(this.audioContext.destination)}catch(e){console.error("Failed to initialize AudioContext",e)}this.audioContext&&this.audioContext.state==="suspended"&&this.audioContext.resume()}static getInstance(){return va.instance||(va.instance=new va),va.instance}setSfxVolume(e){this.sfxVolume=Math.max(0,Math.min(1,e)),localStorage.setItem("sim_sfx_volume",this.sfxVolume.toString())}setMusicVolume(e){this.musicVolume=Math.max(0,Math.min(1,e)),localStorage.setItem("sim_music_volume",this.musicVolume.toString()),this.currentMusic&&(this.currentMusic.volume=this.musicVolume)}setMuffled(e){this.isMuffledState=e,localStorage.setItem("sim_music_muffled",e.toString()),this.filterNode&&this.audioContext&&this.filterNode.frequency.setTargetAtTime(e?15e3:2e4,this.audioContext.currentTime,.1)}toggleIgnoreTrack(e){this.ignoredTracks.has(e)?this.ignoredTracks.delete(e):this.ignoredTracks.add(e),localStorage.setItem("sim_music_ignored",JSON.stringify(Array.from(this.ignoredTracks))),this.ignoredTracks.has(e)&&this.currentMusicKey===e&&this.isPlaylistActive&&this.playNextInPlaylist()}isIgnored(e){return this.ignoredTracks.has(e)}getSfxVolume(){return this.sfxVolume}getMusicVolume(){return this.musicVolume}isMuffled(){return this.isMuffledState}getCurrentTrackId(){return this.currentMusicKey}playSfx(e){if(this.sfxVolume===0)return;const i=`/Simulation_StandAlone_Pro//sounds/sfx/${e.includes(".")?e:`${e}.mp3`}`.replace("//","/"),a=new Audio(i);a.volume=this.sfxVolume,a.play().catch(()=>{})}startPlaylist(){this.isPlaylistActive&&this.currentMusic||(this.isPlaylistActive=!0,this.currentMusic||this.playNextInPlaylist())}playNextInPlaylist(){if(!this.isPlaylistActive)return;let e=0,s=!1;for(;e<this.playlist.length;){this.playlistIndex=(this.playlistIndex+1)%this.playlist.length;const n=this.playlist[this.playlistIndex];if(!this.ignoredTracks.has(n)){this.playMusic(n,2e3,!1),s=!0;break}e++}s||(console.warn("All tracks are ignored! Playing fallback."),this.playMusic(this.playlist[0],2e3,!1))}playPreviousInPlaylist(){if(!this.isPlaylistActive)return;let e=0,s=!1;for(;e<this.playlist.length;){this.playlistIndex=(this.playlistIndex-1+this.playlist.length)%this.playlist.length;const n=this.playlist[this.playlistIndex];if(!this.ignoredTracks.has(n)){this.playMusic(n,2e3,!1),s=!0;break}e++}s||this.playMusic(this.playlist[0],2e3,!1)}async resume(){this.audioContext||this.initAudioContext(),this.audioContext&&this.audioContext.state==="suspended"&&await this.audioContext.resume()}playMusic(e,s=1e3,n=!0){if(n&&(this.isPlaylistActive=!1),this.currentMusicKey===e&&this.currentMusic&&!this.currentMusic.paused){this.fadeIn(this.currentMusic,this.musicVolume,500);return}const l=`/Simulation_StandAlone_Pro//sounds/music/${e.includes(".")?e:`${e}.mp3`}`.replace("//","/"),o=new Audio(l);if(o.loop=!this.isPlaylistActive,o.volume=0,this.initAudioContext(),this.audioContext&&this.filterNode)try{this.audioContext.createMediaElementSource(o).connect(this.filterNode)}catch(c){console.warn("Could not route through Web Audio API",c)}this.isPlaylistActive&&(o.onended=()=>{this.playNextInPlaylist()}),this.currentMusic&&this.fadeOut(this.currentMusic,s),this.currentMusic=o,this.currentMusicKey=e,o.play().then(()=>{this.fadeIn(o,this.musicVolume,s),this.audioContext&&this.audioContext.state==="suspended"&&this.audioContext.resume()}).catch(c=>{console.warn(`Failed to play music: ${e}`,c),this.currentMusic===o&&(this.currentMusic=null,this.currentMusicKey=null),this.isPlaylistActive&&setTimeout(()=>this.playNextInPlaylist(),2e3)})}stopMusic(e=1e3){this.isPlaylistActive=!1,this.currentMusic&&(this.fadeOut(this.currentMusic,e),this.currentMusic=null,this.currentMusicKey=null)}fadeOut(e,s){this.activeFades.has(e)&&clearInterval(this.activeFades.get(e));const n=e.volume,i=20,a=s/i,l=n/i;let o=0;const c=setInterval(()=>{o++;const u=Math.max(0,n-l*o);e.volume=u,u<=0&&(e.pause(),e.src="",clearInterval(c),this.activeFades.delete(e))},a);this.activeFades.set(e,c)}fadeIn(e,s,n){this.activeFades.has(e)&&(clearInterval(this.activeFades.get(e)),this.activeFades.delete(e));const i=20,a=n/i,l=s/i;let o=0;const c=setInterval(()=>{o++;const u=Math.min(s,l*o);e.volume=u,(u>=s||e.paused)&&clearInterval(c)},a)}};et(va,"instance");let $0=va;const ut=$0.getInstance(),l6=Object.freeze(Object.defineProperty({__proto__:null,audioManager:ut},Symbol.toStringTag,{value:"Module"})),y2=_.createContext(void 0),o6=({children:t})=>{const[e,s]=_.useState(ut.getSfxVolume()),[n,i]=_.useState(ut.getMusicVolume()),[a,l]=_.useState(ut.isMuffled()),[o,c]=_.useState(ut.getCurrentTrackId()),[u,d]=_.useState(0);_.useEffect(()=>{const w=setInterval(()=>{const E=ut.getCurrentTrackId();E!==o&&c(E)},1e3);return()=>clearInterval(w)},[o]);const f=_.useCallback(w=>{ut.setSfxVolume(w),s(w)},[]),h=_.useCallback(w=>{ut.setMusicVolume(w),i(w)},[]),m=_.useCallback(w=>{ut.setMuffled(w),l(w)},[]),v=_.useCallback(w=>{ut.playSfx(w)},[]),x=_.useCallback(w=>{ut.playMusic(w),c(w)},[]),b=_.useCallback(()=>{ut.stopMusic(),c(null)},[]),g=_.useCallback(()=>{ut.startPlaylist(),c(ut.getCurrentTrackId())},[]),p=_.useCallback(()=>{ut.playNextInPlaylist(),c(ut.getCurrentTrackId())},[]),y=_.useCallback(()=>{ut.playPreviousInPlaylist(),c(ut.getCurrentTrackId())},[]),k=_.useCallback(w=>{ut.toggleIgnoreTrack(w),d(E=>E+1)},[]),N=_.useCallback(w=>ut.isIgnored(w),[u]),S=_.useCallback(()=>{ut.resume()},[]);return r.jsx(y2.Provider,{value:{playSfx:v,playMusic:x,startPlaylist:g,stopMusic:b,playNext:p,playPrevious:y,toggleIgnoreTrack:k,isIgnored:N,currentTrackId:o,playlist:v2,sfxVolume:e,setSfxVolume:f,musicVolume:n,setMusicVolume:h,isMuffled:a,setMuffled:m,resume:S},children:t})},vx=()=>{const t=_.useContext(y2);if(!t)throw new Error("useAudio must be used within a SimulationAudioProvider");return t},_2=_.createContext(void 0),c6=({children:t})=>{const{pin:e,tab:s}=sS(),n=O=>{if(!O)return"MAP";const L=O.toUpperCase();return L==="ACTIVITY"||L==="LOG"?"ACTIVITY":L},i=O=>O.toLowerCase(),[a,l]=_.useState(()=>n(s)),[o,c]=_.useState("global"),[u,d]=_.useState(null),[f,h]=_.useState(!1),[m,v]=_.useState(!1),[x,b]=_.useState(null),[g,p]=_.useState(null),[y,k]=_.useState(null),[N,S]=_.useState(null),[w,E]=_.useState(null),j=O=>{l(O);const L=i(O),Y=`/Simulation_StandAlone_Pro/play/${e}/${L}`;window.history.replaceState({...window.history.state,idx:window.history.length},"",Y)},A=O=>{h(O),O?j("MARKET"):a==="MARKET"&&j("MAP")};return r.jsx(_2.Provider,{value:{activeTab:a,setActiveTab:j,viewMode:o,setViewMode:c,viewingRegionId:u,setViewingRegionId:d,isMarketOpen:f,setMarketOpen:A,isMusicWindowOpen:m,setMusicWindowOpen:v,activeMinigame:x,setActiveMinigame:b,activeMinigameMethod:g,setActiveMinigameMethod:p,activeMinigameAction:y,setActiveMinigameAction:k,actionLoading:N,setActionLoading:S,productionContext:w,setProductionContext:E},children:t})},ll=()=>{const t=_.useContext(_2);if(!t)throw new Error("useSimulation must be used within a SimulationProvider");return t},u6="modulepreload",d6=function(t){return"/Simulation_StandAlone_Pro/"+t},o1={},zt=function(e,s,n){let i=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),o=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));i=Promise.allSettled(s.map(c=>{if(c=d6(c),c in o1)return;o1[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":u6,u||(f.as="script"),f.crossOrigin="",f.href=c,o&&f.setAttribute("nonce",o),document.head.appendChild(f),u)return new Promise((h,m)=>{f.addEventListener("load",h),f.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(l){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l}return i.then(l=>{for(const o of l||[])o.status==="rejected"&&a(o.reason);return e().catch(a)})},te={MARKET:{SELL_RATIO:.8,PRICE_IMPACT_BUY:.005,PRICE_IMPACT_SELL:.005,MIN_PRICE_MULTIPLIER:.2,MAX_PRICE_MULTIPLIER:5,VISCOSITY:100},CONTRIBUTION_VALUES:{gold:1,wood:.5,stone:1,iron_ore:1,iron_ingot:5,plank:2,grain:.1,flour:.5,bread:1,meat:1,honey:1,cloth:1,wool:.5,flax:.2,linen_canvas:3,tar:2,fish_raw:.5,silk:5,spice:10,default:.1},CAREERS:{SOLDIER:{COST:200,LEVEL_REQ:3},MERCHANT:{COST:500,LEVEL_REQ:3}},TAX:{PEASANT_RATE_DEFAULT:.15,PEASANT_RATE_CUT:.07,ROYAL_RATE:.2,LOYALTY_PENALTY_PEASANT:10,LOYALTY_PENALTY_BARON:5},GATHERING:{NO_TOOL_PENALTY:.75},YIELD:{WORK_GRAIN:10,CHOP_WOOD:6,MINE_ORE:5,QUARRY_STONE:8,FORAGE_BREAD:1,PLOW_BONUS:4,SUMMER_WOOD_BONUS:2},DURABILITY:{MAX:100,LOSS_WORK:5,LOSS_COMBAT_WEAPON:10,LOSS_COMBAT_ARMOR:15,REPAIR_AMOUNT:30},MINIGAME:{BASE_MULTIPLIER:.5,PERFORMANCE_WEIGHT:1,CRAFTING_WEIGHT:1.5,THRESHOLD_GREAT:.8},RELIGION:{PRAY_MIN:1,PRAY_MAX:5,XP_PRAY:2},COMBAT:{RAID_LOOT_FACTOR:.4,DEFEND_GOLD_BASE:20,XP_WIN:20,XP_LOSS:0},LUCKY_DROP:{CHANCE:.05,MULTIPLIER:2},PASSIVE_INCOME:{COW:2,ACCOUNTING_BOOKS:5,CARAVAN:10},SKILLS:{GATHERING_BONUS:.1,REFINING_BONUS:.1,CRAFTING_XP:25,REFINING_XP:10},COUP:{BASE_BRIBE_COST:500,HONEYMOON_DURATION:6e5,VACANCY_DURATION:3e5,RESTORE_ORDER_COST:600,LEGITIMACY_SHIELD_MULT:2,KING_VOTE_WEIGHT:15,PEASANT_VOTE_WEIGHT:1},CARAVAN:{LEVELS:[{level:1,name:"Hndkjre",capacity:5,speed:1,cost:0,durability:100},{level:2,name:"Enkel vogn",capacity:15,speed:1.2,cost:300,durability:150},{level:3,name:"Overbygd kjerre",capacity:40,speed:1.5,cost:800,durability:200},{level:4,name:"Jernkledd konvoi",capacity:100,speed:1.8,cost:2e3,durability:300},{level:5,name:"Storkjpmannens vogn",capacity:250,speed:2.2,cost:5e3,durability:500}],UPGRADES:{SILK_CHESTS:{id:"silk_chests",name:"Silkeforede kister",cost:150,benefit:"Beskytter luksusvarer"},HEAVY_AXLES:{id:"heavy_axles",name:"Forsterkede akslinger",cost:250,benefit:"+10% fart med full last"},GUARD_POST:{id:"guard_post",name:"Vaktpost",cost:400,benefit:"Reduserer bandittfare"}}}},Gc={WORK:{xp:5},CHOP:{xp:5},FORAGE:{xp:2}},Xd=[0,100,300,700,1500,3e3,6e3],Us={Spring:{label:"Vr",yieldMod:1,staminaMod:1,color:"#4ade80"},Summer:{label:"Sommer",yieldMod:1.2,staminaMod:1,color:"#fbbf24"},Autumn:{label:"Hst",yieldMod:1.5,staminaMod:1,color:"#f97316"},Winter:{label:"Vinter",yieldMod:.2,staminaMod:1.5,color:"#38bdf8"}},Dn={Clear:{label:"Klart Vr",desc:"Ideelle forhold for alt arbeid.",mod:1,icon:"",speedMod:1,staminaMod:1},Rain:{label:"Regn",desc:"Glatte forhold. Minispill gr litt fortere.",mod:.9,icon:"",speedMod:1.2,staminaMod:1},Storm:{label:"Storm",desc:"Farlig vr. Hy stamina-kostnad og lavt utbytte!",mod:.5,icon:"",speedMod:1.5,staminaMod:2},Fog:{label:"Tke",desc:"Drlig sikt. Vanskeligere  treffe blinker.",mod:.8,icon:"",speedMod:.8,staminaMod:1}},Rl={WORK:{bread:1,stamina:10},CHOP:{bread:1,stamina:15},FORAGE:{stamina:40},MINE:{bread:1,stamina:25},RAID:{bread:3,stamina:40},TAX:{stamina:20},TAX_PEASANTS:{stamina:25},TAX_ROYAL:{stamina:30},MILL:{grain:10},SMELT:{iron_ore:5,wood:2},SAWMILL:{wood:5},BAKERY:{flour:5},REFINE:{},CRAFT:{},QUARRY:{bread:1,stamina:20},REPAIR:{stamina:15},HUNT:{stamina:30},GATHER_WOOL:{stamina:15},GATHER_HONEY:{stamina:20},PRAY:{stamina:15},FEAST:{bread:30,gold:100,stamina:10},CONTRIBUTE:{stamina:10},CONSTRUCT:{stamina:20},SLEEP:{stamina:0},EAT:{bread:1,stamina:0},PLANT:{grain:5,stamina:25},HARVEST:{stamina:15},BAKE:{},WEAVE:{},MIX:{},DEFEND:{stamina:30},EXPLORE:{stamina:25},PATROL:{stamina:10},MAINTAIN_CROP:{stamina:5},MOUNT_HORSE:{stamina:5},BUY_HORSE_COSMETIC:{stamina:0},SELECT_HORSE_COSMETIC:{stamina:0},LOAD_CARAVAN:{stamina:5},UNLOAD_CARAVAN:{stamina:5},UPGRADE_CARAVAN:{stamina:0},TRAVEL_START:{stamina:20,bread:1}},G0={great_forge:{material:"iron_ingot",goldCost:20,staminaCost:15,slots:["MAIN_HAND","OFF_HAND","HEAD","BODY","FEET","AXE","PICKAXE","SCYTHE","HAMMER","BOW","TRAP","CHISEL"]},weavery:{material:"cloth",goldCost:10,staminaCost:10,slots:["BODY","FEET","HEAD"]},sawmill:{material:"plank",goldCost:5,staminaCost:10,slots:["OFF_HAND","MAIN_HAND"]}},ol={GOLD:"",GRAIN:"",WOOD:"",IRON_ORE:"",STONE:"",PLANK:"",IRON_INGOT:"",BREAD:"",SWORDS:"",ARMOR:"",CLOTH:"",WOOL:"",MEAT:"",HONEY:"",GLASS:"",FLOUR:"",EGG:"",OMELETTE:"",MANPOWER:"",FAVOR:"",FLAX:"",LINEN_CANVAS:"",TAR:"",FISH_RAW:"",SILK:"",SPICE:""},Ie={gold:{label:"Gull",icon:""},grain:{label:"Korn",icon:"",isCommodity:!0},flour:{label:"Mel",icon:"",isCommodity:!0},bread:{label:"Brd",icon:""},wood:{label:"Ved",icon:"",isCommodity:!0},plank:{label:"Planker",icon:"",isCommodity:!0},iron_ore:{label:"Jernmalm",icon:"",isCommodity:!0},iron_ingot:{label:"Jernbarre",icon:"",isCommodity:!0},stone:{label:"Stein",icon:"",isCommodity:!0},siege_sword:{label:"Beleiringsvpen",icon:""},siege_armor:{label:"Beleiringsrustning",icon:""},favor:{label:"Gunst",icon:""},honey:{label:"Honning",icon:"",isCommodity:!0},meat:{label:"Kjtt",icon:"",isCommodity:!0},wool:{label:"Ull",icon:"",isCommodity:!0},cloth:{label:"Stoff",icon:"",isCommodity:!0},glass:{label:"Glass",icon:"",isCommodity:!0},egg:{label:"Egg",icon:"",isCommodity:!0},omelette:{label:"Omelett",icon:""},minor_stamina_potion:{label:"Liten Stamina-brygg",icon:""},herbal_balm:{label:"Urtebalsam",icon:""},focus_brew:{label:"Fokus-brygg",icon:""},strength_tincture:{label:"Styrke-tinktur",icon:""},masters_draught:{label:"Mester-drikk",icon:""},elixir_of_life:{label:"Livseliksir",icon:""},flax:{label:"Lin",icon:"",isCommodity:!0},linen_canvas:{label:"Seilduk",icon:"",isCommodity:!0},tar:{label:"Tjre",icon:"",isCommodity:!0},fish_raw:{label:"R fisk",icon:"",isCommodity:!0},fish_cooked:{label:"Stekt fisk",icon:""},silk:{label:"Silke",icon:"",isCommodity:!0},spice:{label:"Krydder",icon:"",isCommodity:!0},cannonball:{label:"Kanonkuler",icon:"",isCommodity:!0}},Gt={KING:{gold:1e3,grain:500,flour:200,bread:50,wood:200,plank:50,iron_ore:0,iron_ingot:20,stone:100,siege_sword:50,siege_armor:20,favor:0,wool:50,cloth:20,honey:0,meat:0,glass:0,manpower:0,egg:0,omelette:0,flax:0,linen_canvas:0,tar:0,fish_raw:0,fish_cooked:0,silk:0,spice:0,cannonball:20,minor_stamina_potion:0,herbal_balm:0,focus_brew:0,strength_tincture:0,masters_draught:0,elixir_of_life:0},BARON:{gold:300,grain:100,flour:50,bread:20,wood:50,plank:20,iron_ore:0,iron_ingot:10,stone:20,siege_sword:10,siege_armor:10,favor:0,wool:20,cloth:5,honey:0,meat:0,glass:0,manpower:0,egg:0,omelette:0,flax:0,linen_canvas:0,tar:0,fish_raw:0,fish_cooked:0,silk:0,spice:0,cannonball:10,minor_stamina_potion:0,herbal_balm:0,focus_brew:0,strength_tincture:0,masters_draught:0,elixir_of_life:0},PEASANT:{gold:20,grain:30,flour:5,bread:10,wood:0,plank:0,iron_ore:0,iron_ingot:0,stone:0,siege_sword:0,siege_armor:0,favor:0,wool:10,cloth:0,honey:0,meat:0,glass:0,manpower:0,egg:0,omelette:0,flax:0,linen_canvas:0,tar:0,fish_raw:0,fish_cooked:0,silk:0,spice:0,cannonball:0,minor_stamina_potion:0,herbal_balm:0,focus_brew:0,strength_tincture:0,masters_draught:0,elixir_of_life:0},SOLDIER:{gold:50,grain:10,flour:10,bread:10,wood:0,plank:0,iron_ore:0,iron_ingot:0,stone:0,siege_sword:5,siege_armor:2,favor:0,wool:0,cloth:0,honey:0,meat:0,glass:0,manpower:0,egg:0,omelette:0,flax:0,linen_canvas:0,tar:0,fish_raw:0,fish_cooked:0,silk:0,spice:0,cannonball:10,minor_stamina_potion:0,herbal_balm:0,focus_brew:0,strength_tincture:0,masters_draught:0,elixir_of_life:0},MERCHANT:{gold:500,grain:50,flour:50,bread:20,wood:50,plank:20,iron_ore:0,iron_ingot:5,stone:50,siege_sword:5,siege_armor:2,favor:0,wool:20,cloth:10,honey:0,meat:0,glass:0,manpower:0,egg:0,omelette:0,flax:0,linen_canvas:0,tar:0,fish_raw:0,fish_cooked:0,silk:0,spice:0,cannonball:5,minor_stamina_potion:0,herbal_balm:0,focus_brew:0,strength_tincture:0,masters_draught:0,elixir_of_life:0}},yx={PEASANT:[{id:"iron_plow",name:"Jernplog",description:"ker kornhst med +5.",cost:{gold:50,wood:10},benefit:"YIELD_GRAIN"},{id:"fence",name:"Solid Gjerde",description:"Beskytter mot smtyveri.",cost:{wood:50},benefit:"DEFENSE_REGION"},{id:"cow",name:"Melkeku",description:"Gir passivt 2 gull per minutt (simulert via actions).",cost:{gold:80},benefit:"PASSIVE_GOLD"},{id:"roof",name:"Tett Tak",description:"Bedre hvile. Mer utholdenhet.",cost:{wood:20,gold:10},benefit:"STAMINA_REGEN"}],BARON:[{id:"stone_keep",name:"Steintrn",description:"Gjr raiding av deg mye vanskeligere.",cost:{gold:200,wood:100},benefit:"FORTRESS"},{id:"armory",name:"Vpenkammer",description:"Dobbelt s effektiv rekruttering.",cost:{gold:150},benefit:"DRAFT_BONUS"},{id:"stables",name:"Staller",description:"Raskere raids.",cost:{gold:100,wood:50},benefit:"RAID_SPEED"}],KING:[{id:"cathedral",name:"Katedral",description:"ker din legitimitet og skattevilje.",cost:{gold:500,stone:200},benefit:"ROYAL_AUTHORITY"},{id:"royal_guard",name:"Kongelig Garde",description:"Uovervinnelig defensiv styrke.",cost:{gold:400,iron:100},benefit:"ELITE_DEFENSE"}],SOLDIER:[{id:"knight_armor",name:"Ridderrustning",description:"Du tar mindre skade og ser tffere ut.",cost:{gold:100,swords:5},benefit:"ARMOR"},{id:"warhorse",name:"Stridshest",description:"Gjr deg til en Ridder. 2x XP fra kamp.",cost:{gold:200,grain:100},benefit:"KNIGHT"}],MERCHANT:[{id:"trade_license",name:"Handelsbrev",description:"Bedre salgspriser p markedet.",cost:{gold:150},benefit:"MARKET_BONUS"},{id:"accounting_books",name:"Regnskapsbker",description:"Gir passivt 5 gull per minutt.",cost:{gold:200,wood:20},benefit:"PASSIVE_GOLD_HIGH"},{id:"caravan",name:"Karavane",description:"Tjen penger p handel med utlandet.",cost:{gold:300,wood:50},benefit:"CARAVAN"}]},Fs={PEASANT:{FARMING:{level:1,xp:0,maxXp:100},WOODCUTTING:{level:1,xp:0,maxXp:100},MINING:{level:0,xp:0,maxXp:100},CRAFTING:{level:0,xp:0,maxXp:100},STEWARDSHIP:{level:0,xp:0,maxXp:100},COMBAT:{level:0,xp:0,maxXp:100},TRADING:{level:0,xp:0,maxXp:100},THEOLOGY:{level:0,xp:0,maxXp:100}},BARON:{FARMING:{level:3,xp:0,maxXp:300},WOODCUTTING:{level:3,xp:0,maxXp:300},MINING:{level:1,xp:0,maxXp:100},CRAFTING:{level:1,xp:0,maxXp:100},STEWARDSHIP:{level:5,xp:0,maxXp:1e3},COMBAT:{level:3,xp:0,maxXp:300},TRADING:{level:3,xp:0,maxXp:300},THEOLOGY:{level:1,xp:0,maxXp:100}},KING:{FARMING:{level:1,xp:0,maxXp:100},WOODCUTTING:{level:1,xp:0,maxXp:100},MINING:{level:1,xp:0,maxXp:100},CRAFTING:{level:1,xp:0,maxXp:100},STEWARDSHIP:{level:10,xp:0,maxXp:5e3},COMBAT:{level:5,xp:0,maxXp:1500},TRADING:{level:5,xp:0,maxXp:1500},THEOLOGY:{level:5,xp:0,maxXp:1500}},SOLDIER:{FARMING:{level:1,xp:0,maxXp:100},WOODCUTTING:{level:1,xp:0,maxXp:100},MINING:{level:0,xp:0,maxXp:100},CRAFTING:{level:1,xp:0,maxXp:100},STEWARDSHIP:{level:0,xp:0,maxXp:100},COMBAT:{level:5,xp:0,maxXp:1500},TRADING:{level:0,xp:0,maxXp:100},THEOLOGY:{level:0,xp:0,maxXp:100}},MERCHANT:{FARMING:{level:1,xp:0,maxXp:100},WOODCUTTING:{level:1,xp:0,maxXp:100},MINING:{level:0,xp:0,maxXp:100},CRAFTING:{level:2,xp:0,maxXp:200},STEWARDSHIP:{level:1,xp:0,maxXp:100},COMBAT:{level:0,xp:0,maxXp:100},TRADING:{level:5,xp:0,maxXp:1500},THEOLOGY:{level:0,xp:0,maxXp:100}}},f6={FARMING:{label:"Jordbruk",description:"Dyrking av mark, hsting av avlinger og husdyrhold.",color:"#10b981",bonuses:{2:"10% raskere hsting.",5:"Avlinger gir 20% mer utbytte.",10:"Mesterbonde: Lser opp avanserte avlinger."}},WOODCUTTING:{label:"Vedhogging",description:"Kunsten  felle trr og bearbeide tmmer.",color:"#8b5cf6",bonuses:{3:"15% raskere tmmerhogst.",7:"Sjanse for  finne sjelden kvae.",12:"Skovens vokter: kt utbytte fra alle trr."}},MINING:{label:"Gruvedrift",description:"Uthenting av malm og edle metaller fra fjellet.",color:"#f59e0b",bonuses:{4:"Bedre verktyeffektivitet i gruver.",8:"Lser opp utvinning av edelstener.",15:"Fjellkonge: Maksimalt utbytte fra dype rer."}},CRAFTING:{label:"Hndverk",description:"Smiing, snekring og tilvirking av avansert utstyr.",color:"#3b82f6",bonuses:{2:"Mindre materialsvinn ved refining.",5:"Bedre sjanse for hyere kvalitet.",10:"Stormester: Kan smie legendarisk utstyr."}},STEWARDSHIP:{label:"Godsforvaltning",description:"Administrasjon av land, folk og ressurser.",color:"#ec4899",bonuses:{5:"Redusert skattetrykk fra overordnede.",10:"kt passiv inntekt fra oppgraderinger.",20:"Rikets forvalter: Maksimal konomisk innsikt."}},COMBAT:{label:"Kamp",description:"Ferdighet i sverd, bue og forsvar av riket.",color:"#ef4444",bonuses:{3:"kt angrepskraft (+10%).",6:"Bedre forsvarsevne i beleiringer.",12:"Krigsherre: Fryktinngytende p slagmarken."}},TRADING:{label:"Handel",description:"Kjp, salg og markedsspekulering.",color:"#facc15",bonuses:{2:"Lavere gebyrer p markedet.",5:"Bedre priser ved handel med NPCs.",10:"Handelsfyrste: Kontroll over handelsruter."}},THEOLOGY:{label:"Teologi",description:"Tro, bnn og forstelse av det guddommelige.",color:"#6366f1",bonuses:{5:"Bnner gir mer stamina.",10:"Guddommelig beskyttelse mot ulykker.",15:"Helgen: Utstrler en aura av ro og verdighet."}}},F0={PEASANT:{},BARON:{MAIN_HAND:{id:"iron_sword",name:"Jernsverd",icon:"",type:"MAIN_HAND",durability:100,maxDurability:100,level:5,stats:{attack:10}},BODY:{id:"fine_clothes",name:"Fie Klr",icon:"",type:"BODY",durability:50,maxDurability:50,level:5,stats:{defense:2,speedBonus:1.1}}},KING:{MAIN_HAND:{id:"royal_scepter",name:"Kongens Septer",icon:"",type:"MAIN_HAND",durability:200,maxDurability:200,level:10,stats:{luckBonus:.2}},HEAD:{id:"crown",name:"Krone",icon:"",type:"HEAD",durability:100,maxDurability:100,level:10,stats:{luckBonus:.1}}},SOLDIER:{MAIN_HAND:{id:"iron_sword",name:"Jernsverd",icon:"",type:"MAIN_HAND",durability:100,maxDurability:100,level:3,stats:{attack:8}},OFF_HAND:{id:"wooden_shield",name:"Treskjold",icon:"",type:"OFF_HAND",durability:50,maxDurability:50,level:2,stats:{defense:5}},BODY:{id:"leather_armor",name:"Lrrustning",icon:"",type:"BODY",durability:80,maxDurability:80,level:2,stats:{defense:5}}},MERCHANT:{MAIN_HAND:{id:"walking_stick",name:"Vandrestav",icon:"",type:"MAIN_HAND",durability:50,maxDurability:50,level:2,stats:{speedBonus:1.05}},TRINKET:{id:"abacus",name:"Kuleramme",icon:"",type:"TRINKET",durability:100,maxDurability:100,level:3,stats:{yieldBonus:2}}}},Oe={tools:{id:"tools",name:"Verkty",icon:"",type:"MAIN_HAND",durability:100,maxDurability:100,level:1,description:"Grunnleggende verkty."},weapon:{id:"weapon",name:"Enkelt Sverd",icon:"",type:"MAIN_HAND",durability:100,maxDurability:100,level:1,description:"Et enkelt sverd."},armor:{id:"armor",name:"Enkel Rustning",icon:"",type:"BODY",durability:100,maxDurability:100,level:1,description:"Beskyttende rustning."},stone_axe:{id:"stone_axe",name:"Steinks",icon:"",type:"AXE",durability:30,maxDurability:30,level:1,description:"Primitiv ks hugget fra mrke fjell. Sagnet sier at de frste fedrene brukte slike til  bane vei gjennom de tette skogene fr sivilisasjonens inntog. +1 Utbytte.",stats:{yieldBonus:1},relevantActions:["CHOP"],nextTierId:"iron_axe"},stone_pickaxe:{id:"stone_pickaxe",name:"Steinhakke",icon:"",type:"PICKAXE",durability:30,maxDurability:30,level:1,description:"En enkel hakke i flint og tre. Brukt i generasjoner av de som sker fjellets hemmeligheter. +1 Utbytte.",stats:{yieldBonus:1},relevantActions:["MINE"],nextTierId:"iron_pickaxe"},rusty_axe:{id:"rusty_axe",name:"Rusten ks",icon:"",type:"AXE",durability:50,maxDurability:50,level:1,description:"Et glemt relikvie fra en svunnen tid, n bare en skygge av sin fordums prakt. Slv og uplitelig.",stats:{yieldBonus:0},relevantActions:["CHOP"],nextTierId:"stone_axe"},iron_axe:{id:"iron_axe",name:"Jernks",icon:"",type:"AXE",durability:100,maxDurability:100,level:3,description:"Smid i landsbyens esse under fullmnen. Jernet synger nr det treffer treverket. +3 Utbytte.",stats:{yieldBonus:3},relevantActions:["CHOP"],nextTierId:"steel_axe"},iron_pickaxe:{id:"iron_pickaxe",name:"Jernhakke",icon:"",type:"PICKAXE",durability:100,maxDurability:100,level:3,description:"Tung og balansert. Laget for  trenge dypt inn i rikets rike rer. +3 Utbytte.",stats:{yieldBonus:3},relevantActions:["MINE"],nextTierId:"steel_pickaxe"},stone_chisel:{id:"stone_chisel",name:"Steinmeisel",icon:"",type:"CHISEL",durability:30,maxDurability:30,level:1,description:"En enkel meisel av herdet stein. Perfekt for  forme steinblokker. +1 Utbytte.",stats:{yieldBonus:1},relevantActions:["QUARRY"],nextTierId:"iron_chisel"},iron_chisel:{id:"iron_chisel",name:"Jernmeisel",icon:"",type:"CHISEL",durability:80,maxDurability:80,level:3,description:"Smid i landsbyens esse. Gjr steinhugging til en lek. +3 Utbytte.",stats:{yieldBonus:3},relevantActions:["QUARRY"],nextTierId:"steel_chisel"},royal_scepter:{id:"royal_scepter",name:"Kongens Septer",icon:"",type:"MAIN_HAND",durability:200,maxDurability:200,level:10,description:"Et symbol p guddommelig rett og folkets vilje. Det glitrer med en makt som kan bye selve skjebnen. +20% Flaks.",stats:{luckBonus:.2}},steel_axe:{id:"steel_axe",name:"Stlks",icon:"",type:"AXE",durability:200,maxDurability:200,level:8,description:"Mesterlig stl. +8 Utbytte, 20% raskere arbeid.",stats:{yieldBonus:8,speedBonus:1.2},relevantActions:["CHOP"]},steel_hja:{id:"steel_hja",name:"Stlhj",icon:"",type:"SCYTHE",durability:120,maxDurability:120,level:4,description:"Sylskarp hj. +5 Utbytte, 10% raskere hsting.",stats:{yieldBonus:5,speedBonus:1.1},relevantActions:["WORK","HST"]},stone_sickle:{id:"stone_sickle",name:"Steinsigd",icon:"",type:"SCYTHE",durability:40,maxDurability:40,level:1,description:"Enkel sigd for jordbruk. +1 Utbytte ved kornhsting.",stats:{yieldBonus:1},relevantActions:["WORK"]},blacksmith_hammer:{id:"blacksmith_hammer",name:"Smedhammer",icon:"",type:"HAMMER",durability:200,maxDurability:200,level:5,description:"Mesterverkty. 20% raskere smiing.",stats:{speedBonus:1.2},relevantActions:["CRAFT","REFINE","SMELT"]},shears:{id:"shears",name:"Saks",icon:"",type:"MAIN_HAND",durability:50,maxDurability:50,level:1,description:"Brukt til  klippe sauer. Helt ndvendig for ull-produksjon.",stats:{yieldBonus:2},relevantActions:["GATHER_WOOL"]},iron_sword:{id:"iron_sword",name:"Jernsverd",icon:"",type:"MAIN_HAND",durability:100,maxDurability:100,level:5,description:"Standard sverd. +10 Angrepskraft.",stats:{attack:10},relevantActions:["DEFEND","PATROL","EXPLORE","HUNT"],nextTierId:"steel_sword"},steel_sword:{id:"steel_sword",name:"Stlsverd",icon:"",type:"MAIN_HAND",durability:250,maxDurability:250,level:10,description:"Ddelig stl. +25 Angrep, 10% raskere hugg.",stats:{attack:25,speedBonus:1.1},relevantActions:["DEFEND","PATROL","EXPLORE","HUNT"]},tunic:{id:"tunic",name:"Slitt Tunika",icon:"",type:"BODY",durability:20,maxDurability:20,level:1,description:"Gammel og hullete. Minimal beskyttelse.",stats:{defense:1},relevantActions:["DEFEND","PATROL"],nextTierId:"leather_armor"},leather_armor:{id:"leather_armor",name:"Lrrustning",icon:"",type:"BODY",durability:80,maxDurability:80,level:3,description:"Herdet skinn. +5 Forsvar.",stats:{defense:5},relevantActions:["DEFEND","PATROL"],nextTierId:"iron_armor"},whetstone:{id:"whetstone",name:"Bryne",icon:"",type:"OFF_HAND",durability:100,maxDurability:100,level:1,description:"Bruk bryne for  holde verkty skarpe. Gir +1 i utbytte p de fleste sanke-oppgaver.",stats:{yieldBonus:1},relevantActions:["CHOP","MINE","QUARRY","WORK","GATHER_WOOL"]},hunting_bow:{id:"hunting_bow",name:"Jaktbue",icon:"",type:"BOW",durability:80,maxDurability:80,level:1,description:"En stdig bue av barlind. +2 Utbytte.",stats:{yieldBonus:2},relevantActions:["HUNT"],nextTierId:"longbow"},longbow:{id:"longbow",name:"Langbue",icon:"",type:"BOW",durability:150,maxDurability:150,level:5,description:"En mektig langbue som krever styrke  spenne. +5 Utbytte, 10% raskere.",stats:{yieldBonus:5,speedBonus:1.1},relevantActions:["HUNT"]},hunting_trap:{id:"hunting_trap",name:"Jaktfelle",icon:"",type:"TRAP",durability:30,maxDurability:30,level:1,description:"En enkel snarefangst-felle. +1 Utbytte ved smviltjakt.",stats:{yieldBonus:1},relevantActions:["HUNT","FORAGE"]},omelette:{id:"omelette",name:"Omelett",icon:"",type:"CONSUMABLE",durability:1,maxDurability:1,level:1,description:'En nringsrik frokost. Gir buff: "Lett til beins" (20% mindre stamina kostnad i 15 min).',stats:{},relevantActions:["CONSUME"]},bread:{id:"bread",name:"Brd",icon:"",type:"CONSUMABLE",durability:1,maxDurability:1,level:1,description:"Ferskt brd fra bakeriet. Gjenoppretter +20 Stamina.",stats:{},relevantActions:["CONSUME"]},minor_stamina_potion:{id:"minor_stamina_potion",name:"Liten Stamina-brygg",icon:"",type:"CONSUMABLE",durability:1,maxDurability:1,level:1,description:"Gjenoppretter 30 Stamina umiddelbart.",stats:{},relevantActions:["CONSUME"]},herbal_balm:{id:"herbal_balm",name:"Urtebalsam",icon:"",type:"CONSUMABLE",durability:1,maxDurability:1,level:1,description:"ker sankehastighet med 15% i 10 minutter.",stats:{},relevantActions:["CONSUME"]},focus_brew:{id:"focus_brew",name:"Fokus-brygg",icon:"",type:"CONSUMABLE",durability:1,maxDurability:1,level:2,description:"Reduserer stamina-kostnad med 20% i 15 minutter.",stats:{},relevantActions:["CONSUME"]},strength_tincture:{id:"strength_tincture",name:"Styrke-tinktur",icon:"",type:"CONSUMABLE",durability:1,maxDurability:1,level:2,description:"ker angrepskraft med 10 i 10 minutter.",stats:{},relevantActions:["CONSUME"]},masters_draught:{id:"masters_draught",name:"Mester-drikk",icon:"",type:"CONSUMABLE",durability:1,maxDurability:1,level:3,description:"Mesterens hemmelighet. Gir +50% utbytte i 20 minutter.",stats:{},relevantActions:["CONSUME"]},elixir_of_life:{id:"elixir_of_life",name:"Livseliksir",icon:"",type:"CONSUMABLE",durability:1,maxDurability:1,level:3,description:"En legendarisk eliksir. Gjenoppretter 100 Stamina og 50 HP.",stats:{},relevantActions:["CONSUME"]}},_x={grain:{label:"Kornker",seed:"grain",yieldResource:"grain",duration:3*60*1e3,minYield:12,maxYield:20,xp:20},flax:{label:"Lin-ker",seed:"flax",yieldResource:"flax",duration:5*60*1e3,minYield:8,maxYield:15,xp:35}},cs={farm_house:{id:"farm_house",name:"Grdshuset",icon:"",locationId:"peasant_farm",description:"Ditt personlige hjem. Oppgraderinger gir bedre hvile og mer matlagingsplass.",levels:{1:{requirements:{},unlocks:["SLEEP","EAT"],bonus:"Base hvile"},2:{requirements:{wood:65,gold:130},unlocks:["FARM_UPGRADE"],bonus:"+20% Stamina fra peisen"},3:{requirements:{plank:26,stone:65,gold:390},unlocks:["FARM_UPGRADE_MASTER"],bonus:"+30% Stamina fra senga"},4:{requirements:{plank:65,stone:130,gold:780},unlocks:["FARM_UPGRADE_ELITE"],bonus:"+50% Stamina fra hvile"},5:{requirements:{plank:130,stone:260,gold:1300,iron_ingot:26},unlocks:["FARM_UPGRADE_GODLY"],bonus:"Restaurerer all Stamina ved hvile"}}},sawmill:{id:"sawmill",name:"Sagbruk",icon:"",locationId:"village",description:"Gjr det mulig  foredle Ved til Tmmer.",levels:{1:{requirements:{},unlocks:["REFINE_PLANK_BASIC","hunting_bow"],bonus:"Base produksjon"},2:{requirements:{wood:130,stone:65,gold:130},unlocks:["REFINE_PLANK_FAST"],bonus:"+10% Woodcutting XP"},3:{requirements:{plank:65,stone:195,gold:390},unlocks:["REFINE_PLANK_MASTER","longbow"],bonus:"Lser opp Tier 3 verkty og Langbue"}}},windmill:{id:"windmill",name:"Vindmlle",icon:"",locationId:"village",description:"Gjr det mulig  foredle Korn til Mel mer effektivt.",levels:{1:{requirements:{},unlocks:["REFINE_FLOUR_BASIC"],bonus:"Base produksjon"},2:{requirements:{plank:39,stone:65,gold:195},unlocks:["REFINE_FLOUR_FAST"],bonus:"+10% Farming XP"},3:{requirements:{plank:130,stone:260,gold:650},unlocks:["REFINE_FLOUR_AUTO"],bonus:"Sjanse for dobbel avling"}}},smeltery:{id:"smeltery",name:"Smeltehytte",icon:"",locationId:"village",description:"Gjr det mulig  smelte Jernmalm til Jernbarrer.",levels:{1:{requirements:{},unlocks:["REFINE_IRON_BASIC"],bonus:"Base produksjon"},2:{requirements:{stone:195,wood:130,gold:260},unlocks:["REFINE_IRON_FAST"],bonus:"+10% Mining XP"},3:{requirements:{stone:390,plank:65,gold:780},unlocks:["REFINE_STEEL","glass"],bonus:"Lser opp Stl og Glass"}}},great_forge:{id:"great_forge",name:"Storsmie",icon:"",locationId:"village",description:"Gjr det mulig  lage avanserte verkty og vpen.",levels:{1:{requirements:{},unlocks:["stone_axe","stone_pickaxe","stone_sickle","whetstone","hunting_trap"],bonus:"Base produksjon"},2:{requirements:{iron_ingot:26,plank:39,gold:390},unlocks:["iron_axe","iron_pickaxe","iron_sword","leather_armor","shears","siege_swords","siege_armor"],bonus:"+10% Crafting XP"},3:{requirements:{iron_ingot:130,plank:130,gold:1300},unlocks:["steel_axe","steel_sword","blacksmith_hammer","repair_advanced"],bonus:"Lser opp Mester-utstyr"}}},bakery:{id:"bakery",name:"Bakeri",icon:"",locationId:"village",description:"Gjr det mulig  bake Brd fra Mel.",levels:{1:{requirements:{},unlocks:["CRAFT_BREAD","CRAFT_omelette"],bonus:"Base produksjon"},2:{requirements:{stone:65,plank:26,gold:130},unlocks:["CRAFT_PIE"],bonus:"Bedre stamina fra mat"},3:{requirements:{stone:195,plank:65,gold:520},unlocks:["CRAFT_FEAST"],bonus:"Lser opp Gildemltid"}}},tavern:{id:"tavern",name:"Vertshuset",icon:"",locationId:"village",description:"Et sted for hvile og rykter. ker stamina-regenerering.",levels:{1:{requirements:{},unlocks:["ENTER_TAVERN","REST_BASIC","BUY_MEAL","OPEN_DICE_GAME","OPEN_RESOURCE_GAME","CHAT_LOCAL"],bonus:"Standard hvile"},2:{requirements:{wood:130,stone:65,gold:325},unlocks:["REST_COMFY"],bonus:"Dobbel stamina-regen"},3:{requirements:{plank:65,stone:195,gold:975},unlocks:["REST_ROYAL"],bonus:"Gjenoppretter all stamina raskt"}}},weavery:{id:"weavery",name:"Veveri",icon:"",locationId:"village",description:"Foredler Ull til Stoff for videre salg eller klr.",levels:{1:{requirements:{},unlocks:["REFINE_CLOTH_BASIC"],bonus:"Base produksjon"},2:{requirements:{plank:52,stone:39,gold:195},unlocks:["REFINE_CLOTH_FAST"],bonus:"+10% Trading XP"},3:{requirements:{plank:130,stone:130,gold:520},unlocks:["REFINE_CLOTH_MASTER"],bonus:"Lser opp Silke-produksjon"}}},well:{id:"well",name:"Bybrnn",icon:"",locationId:"village",description:"Gir tilgang til ferskvann for baking og hygiene.",levels:{1:{requirements:{},unlocks:["GATHER_WATER"],bonus:"Basiskilde"},2:{requirements:{stone:65,gold:65},unlocks:["GATHER_WATER_FAST"],bonus:"Bedre vanntilgang"},3:{requirements:{stone:195,gold:260},unlocks:["GATHER_WATER_MASTER"],bonus:"Hellig kilde: +5 Stamina ved drikking"}}},apothecary:{id:"apothecary",name:"Apoteker",icon:"",locationId:"village",description:"Fremstiller medisin og salver.",levels:{1:{requirements:{},unlocks:["REFINE_minor_stamina_potion","REFINE_herbal_balm"],bonus:"Basis urter"},2:{requirements:{wood:130,stone:65,gold:325},unlocks:["REFINE_focus_brew","REFINE_strength_tincture"],bonus:"Gift og Tinkturer"},3:{requirements:{plank:130,glass:65,gold:1300},unlocks:["REFINE_masters_draught","REFINE_elixir_of_life"],bonus:"Mesterverk & Eliksirer"}}},watchtower:{id:"watchtower",name:"Vaktrn",icon:"",locationId:"village",description:"Bedre oversikt og forsvar av landsbyen.",levels:{1:{requirements:{},unlocks:["PATROL"],bonus:"+5 Forsvar"},2:{requirements:{stone:130,plank:65,gold:260},unlocks:["SCOUT"],bonus:"+15 Forsvar"},3:{requirements:{stone:390,plank:130,gold:1040},unlocks:["VOLLEY"],bonus:"Bueskytter-sttte i kamp"}}},stables:{id:"stables",name:"Stall",icon:"",locationId:"village",description:"Muliggjr raskere reise og kavaleri.",levels:{1:{requirements:{},unlocks:["MOUNT_HORSE"],bonus:"Transport"},2:{requirements:{plank:65,wood:65,gold:195},unlocks:["BREED_WARHORSE"],bonus:"Stridshester"},3:{requirements:{plank:195,iron_ingot:26,gold:520},unlocks:["KNIGHT_TRAINING"],bonus:"Riddere"}}},manor_ost:{id:"manor_ost",name:"Slott st",icon:"",locationId:"castle",description:"Setet til den stlige herre. Krever enorme ressurser  bygge.",levels:{1:{requirements:{stone:500,plank:300,iron_ingot:50,gold:1e3},unlocks:["BARON_STATUS"],bonus:"Krav p regionen"}}},manor_vest:{id:"manor_vest",name:"Slott Vest",icon:"",locationId:"castle",description:"Setet til den vestlige herre. Krever enorme ressurser  bygge.",levels:{1:{requirements:{stone:500,plank:300,iron_ingot:50,gold:1e3},unlocks:["BARON_STATUS"],bonus:"Krav p regionen"}}},throne_room:{id:"throne_room",name:"Slottet",icon:"",locationId:"castle",description:"Kongens stol. Den frste Baronen som fullfrer denne blir Konge.",levels:{1:{requirements:{stone:2e3,plank:1e3,iron_ingot:200,gold:5e3},unlocks:["KING_STATUS"],bonus:"Krav p riket"}}},wharf:{id:"wharf",name:"Havnekaia",icon:"",locationId:"dock_hub",description:"Sentrum for maritim handel. Oppgraderinger lser opp flere maritime ressurser og bedre bter.",levels:{1:{requirements:{},unlocks:["OPEN_SHIPYARD","START_SAILING"],bonus:"Grunnleggende sjfart"},2:{requirements:{plank:100,tar:50,gold:5e3},unlocks:["OPEN_WHARF_UPGRADE_MASTER"],bonus:"+20% Fiske-utbytte"},3:{requirements:{plank:250,linen_canvas:100,iron_ingot:100,gold:15e3},unlocks:["OPEN_OCEAN_SAILING"],bonus:"Lser opp Havseilas"}}}},Xi={plank:{label:"Planker",icon:"",input:{wood:5},outputResource:"plank",outputAmount:1,buildingId:"sawmill",stamina:10,xp:5,skill:"WOODCUTTING"},flour:{label:"Fint Mel",icon:"",input:{grain:20},outputResource:"flour",outputAmount:10,buildingId:"windmill",stamina:15,xp:8,skill:"FARMING",duration:12e4},iron_ingot:{label:"Jernbarre",icon:"",input:{iron_ore:5,wood:2},outputResource:"iron_ingot",outputAmount:1,buildingId:"smeltery",stamina:20,xp:12,skill:"CRAFTING"},bread:{label:"Bondebrd",icon:"",input:{flour:2},outputResource:"bread",outputAmount:5,buildingId:"bakery",stamina:5,xp:3,skill:"CRAFTING"},pie:{label:"Kjttpai",icon:"",input:{flour:4,meat:2},outputResource:"bread",outputAmount:15,buildingId:"bakery",stamina:15,xp:10,skill:"CRAFTING"},mead:{label:"Mjd",icon:"",input:{honey:5},outputResource:"stamina",outputAmount:20,buildingId:"tavern",stamina:5,xp:5,skill:"CRAFTING"},cloth:{label:"Lin-stoff",icon:"",input:{wool:5},outputResource:"cloth",outputAmount:1,buildingId:"weavery",stamina:15,xp:10,skill:"CRAFTING"},glass:{label:"Glass",icon:"",input:{stone:10,wood:5},outputResource:"glass",outputAmount:1,buildingId:"smeltery",requiredLevel:3,stamina:25,xp:15,skill:"CRAFTING"},minor_stamina_potion:{label:"Liten Stamina-brygg",icon:"",input:{honey:2,glass:1},outputResource:"minor_stamina_potion",outputAmount:1,buildingId:"apothecary",requiredLevel:1,stamina:20,xp:15,skill:"CRAFTING",duration:3e4},herbal_balm:{label:"Urtebalsam",icon:"",input:{wood:5,honey:3},outputResource:"herbal_balm",outputAmount:1,buildingId:"apothecary",requiredLevel:1,stamina:20,xp:15,skill:"CRAFTING",duration:45e3},focus_brew:{label:"Fokus-brygg",icon:"",input:{honey:5,glass:1,grain:10},outputResource:"focus_brew",outputAmount:1,buildingId:"apothecary",requiredLevel:2,stamina:30,xp:30,skill:"CRAFTING",duration:6e4},strength_tincture:{label:"Styrke-tinktur",icon:"",input:{iron_ore:5,honey:5,glass:1},outputResource:"strength_tincture",outputAmount:1,buildingId:"apothecary",requiredLevel:2,stamina:40,xp:40,skill:"CRAFTING",duration:9e4},masters_draught:{label:"Mester-drikk",icon:"",input:{gold:100,honey:10,glass:2},outputResource:"masters_draught",outputAmount:1,buildingId:"apothecary",requiredLevel:3,stamina:60,xp:100,skill:"CRAFTING",duration:18e4},elixir_of_life:{label:"Livseliksir",icon:"",input:{gold:250,honey:20,glass:5},outputResource:"elixir_of_life",outputAmount:1,buildingId:"apothecary",requiredLevel:3,stamina:100,xp:250,skill:"CRAFTING",duration:3e5},linen_canvas:{label:"Seilduk",icon:"",input:{flax:5},outputResource:"linen_canvas",outputAmount:1,buildingId:"weavery",stamina:15,xp:20,skill:"CRAFTING"},tar:{label:"Tjre",icon:"",input:{wood:5},outputResource:"tar",outputAmount:1,buildingId:"smeltery",stamina:20,xp:10,skill:"CRAFTING"},fish_cooked:{label:"Stekt Fisk",icon:"",input:{fish_raw:1},outputResource:"fish_cooked",outputAmount:1,buildingId:"bakery",stamina:10,xp:5,skill:"CRAFTING"}},Hs={stone_axe:{label:"Steinks",icon:"",input:{stone:13,wood:7,gold:7},outputItemId:"stone_axe",buildingId:"great_forge",level:1,stamina:15,xp:10,description:"Et enkelt redskap for tmmerhogst.",skill:"CRAFTING"},stone_pickaxe:{label:"Steinhakke",icon:"",input:{stone:13,wood:7,gold:7},outputItemId:"stone_pickaxe",buildingId:"great_forge",level:1,stamina:15,xp:10,description:"En primitiv hakke for gruvearbeid.",skill:"CRAFTING"},stone_sickle:{label:"Steinsigd",icon:"",input:{stone:7,wood:7,gold:13},outputItemId:"stone_sickle",buildingId:"great_forge",level:1,stamina:10,xp:5,description:"Enkel sigd for kornhsting.",skill:"CRAFTING"},whetstone:{label:"Bryne",icon:"",input:{stone:20,gold:26},outputItemId:"whetstone",buildingId:"great_forge",level:1,stamina:10,xp:5,description:"Brukt for  slipe verkty og ke utbyttet.",skill:"CRAFTING"},stone_chisel:{label:"Steinmeisel",icon:"",input:{stone:13,gold:13},outputItemId:"stone_chisel",buildingId:"great_forge",level:1,stamina:10,xp:8,description:"Ndvendig for  hugge stein i steinhuggeriet.",skill:"CRAFTING"},iron_chisel:{label:"Jernmeisel",icon:"",input:{iron_ingot:7,gold:104},outputItemId:"iron_chisel",buildingId:"great_forge",level:2,stamina:20,xp:15,description:"Effektiv mesiel for steinhugging.",skill:"CRAFTING"},iron_axe:{label:"Jernks",icon:"",input:{iron_ingot:7,plank:3,gold:65},outputItemId:"iron_axe",buildingId:"great_forge",level:2,stamina:25,xp:20,description:"Et solid verkty av jern.",skill:"CRAFTING"},iron_pickaxe:{label:"Jernhakke",icon:"",input:{iron_ingot:7,plank:3,gold:65},outputItemId:"iron_pickaxe",buildingId:"great_forge",level:2,stamina:25,xp:20,description:"Effektiv hakke for dypere graving.",skill:"CRAFTING"},iron_sword:{label:"Jernsverd",icon:"",input:{iron_ingot:13,plank:3,gold:130},outputItemId:"iron_sword",buildingId:"great_forge",level:2,stamina:40,xp:35,description:"Et skarpt sverd for krigere.",skill:"CRAFTING"},leather_armor:{label:"Lrrustning",icon:"",input:{cloth:13,gold:195},outputItemId:"leather_armor",buildingId:"great_forge",level:2,stamina:30,xp:25,description:"God beskyttelse for en reisende.",skill:"CRAFTING"},shears:{label:"Saks",icon:"",input:{iron_ingot:7,gold:130},outputItemId:"shears",buildingId:"great_forge",level:2,stamina:20,xp:15,description:"Ndvendig for  klippe sauer og f ull.",skill:"CRAFTING"},siege_swords:{label:"Beleiringsvpen (x10)",icon:"",input:{iron_ingot:7,plank:7,gold:65},outputItemId:"siege_sword",outputAmount:10,buildingId:"great_forge",level:2,stamina:40,xp:30,description:"En kasse med vpen til garnisonen.",skill:"CRAFTING"},siege_armor:{label:"Beleiringsrustning (x10)",icon:"",input:{iron_ingot:7,cloth:7,gold:65},outputItemId:"siege_armor",outputAmount:10,buildingId:"great_forge",level:2,stamina:40,xp:30,description:"En kasse med rustninger til garnisonen.",skill:"CRAFTING"},steel_axe:{label:"Stlks",icon:"",input:{iron_ingot:26,plank:13,gold:325},outputItemId:"steel_axe",buildingId:"great_forge",level:3,stamina:50,xp:50,description:"Mesterlig utformet ks av herdet stl.",skill:"CRAFTING"},steel_sword:{label:"Stlsverd",icon:"",input:{iron_ingot:39,plank:7,gold:650},outputItemId:"steel_sword",buildingId:"great_forge",level:3,stamina:80,xp:100,description:"Det ultimate vpenet for en herre.",skill:"CRAFTING"},blacksmith_hammer:{label:"Smedhammer",icon:"",input:{iron_ingot:20,plank:7,gold:260},outputItemId:"blacksmith_hammer",buildingId:"great_forge",level:3,stamina:40,xp:50,description:"Mesterverkty for en ekte smed.",skill:"CRAFTING"},omelette:{label:"Omelett",icon:"",input:{egg:3},outputItemId:"omelette",buildingId:"bakery",level:1,stamina:10,xp:8,description:"En mettende frokost. Gir energi-buff.",skill:"CRAFTING"},hunting_trap:{label:"Jaktfelle",icon:"",input:{wood:13,iron_ingot:3,gold:39},outputItemId:"hunting_trap",buildingId:"great_forge",level:1,stamina:20,xp:15,description:"En enkel snare for smvilt.",skill:"CRAFTING"},hunting_bow:{label:"Jaktbue",icon:"",input:{plank:7,cloth:7,gold:65},outputItemId:"hunting_bow",buildingId:"sawmill",level:1,stamina:25,xp:20,description:"En stdig bue for jakt.",skill:"CRAFTING"},longbow:{label:"Langbue",icon:"",input:{plank:20,cloth:13,iron_ingot:1,gold:325},outputItemId:"longbow",buildingId:"sawmill",level:3,stamina:40,xp:45,description:"En kraftig bue med lang rekkevidde.",skill:"CRAFTING"},cannonball:{label:"Kanonkuler (x5)",icon:"",input:{stone:5,iron_ingot:1,gold:10},outputItemId:"cannonball",outputAmount:5,buildingId:"great_forge",level:2,stamina:30,xp:25,description:"Tunge kuler for skipsartilleri.",skill:"CRAFTING"}},rc={KING:{label:"Konge",description:"Styrer riket, krever skatt og dmmer i store saker."},BARON:{label:"Baron",description:"Styrer en region, krever inn skatt fra bnder, og beskytter mot krig."},PEASANT:{label:"Bonde",description:"Produserer mat og ressurser. Betaler skatt."},SOLDIER:{label:"Soldat",description:"Beskytter riket og deltar i raids."},MERCHANT:{label:"Kjpmann",description:"Tjener penger p handel og markedsspekulasjon."}},h6={PEASANT:["Trell","Leilending","Selveier","Storbondi","Odalbonde"],BARON:["Landmann","Vpner","Ridder","Baron","Grev"],KING:["Prins","Hertug","Konungr"],SOLDIER:["Rekrutt","Vakt","Kjempe","Hvding"],MERCHANT:["Gutt","Svenn","Mester","Hanseat"]},m6={PEASANT:[["Basis rettigheter som bonde."],["+10% resurseffektivitet ved innhsting."],["Redusert skattetreff (-5%) fra din lensherre."],["Lser opp bruk av spesialverkty og ploger."],["Fullstendig selveie: Maksimal frihet og prestisje."]],BARON:[["Rett til  kreve inn skatt i din region."],["+20% forsvarsstyrke for dine vakter."],["Lser opp bygging av avanserte steinborger."],["Hyere status i Tinget: Dine stemmer teller mer."],["Maksimal autoritet og kontroll over landegrenser."]],KING:[["Gunst fra understtene og rett til tronen."],["Nasjonal autoritet: Kan passere lover uten Tinget."],["Gudegitt makt: Maksimal legitimitet og kontroll."]],SOLDIER:[["Grunnleggende kamptrening og utstyr."],["+15% skade i raids og forsvar."],["Lser opp bruk av tunge rustninger og hester."],["Elite-kriger: Fryktet over hele riket."]],MERCHANT:[["Rett til  drive handel p markedsplassen."],["Bedre priser ved kjp og salg (+10%)."],["Lser opp utlandshandel og karavaner."],["Finansfyrste: Kontrollerer markedstrender."]]},st={grain:{price:.5,stock:800,basePrice:.5,baseStock:800,demand:1},flour:{price:1.75,stock:300,basePrice:1.75,baseStock:300,demand:1},bread:{price:1.2,stock:300,basePrice:1.2,baseStock:300,demand:1},wood:{price:1.25,stock:800,basePrice:1.25,baseStock:800,demand:1},plank:{price:11.25,stock:300,basePrice:11.25,baseStock:300,demand:1},iron_ore:{price:2.5,stock:800,basePrice:2.5,baseStock:800,demand:1},iron_ingot:{price:25,stock:300,basePrice:25,baseStock:300,demand:1},stone:{price:1.25,stock:800,basePrice:1.25,baseStock:800,demand:1},wool:{price:.5,stock:800,basePrice:.5,baseStock:800,demand:1},cloth:{price:10,stock:300,basePrice:10,baseStock:300,demand:1},honey:{price:1,stock:300,basePrice:1,baseStock:300,demand:1},meat:{price:1.5,stock:300,basePrice:1.5,baseStock:300,demand:1},siege_sword:{price:40,stock:100,basePrice:40,baseStock:100,demand:1},siege_armor:{price:40,stock:100,basePrice:40,baseStock:100,demand:1},flax:{price:10,stock:0,basePrice:1,baseStock:800,demand:1},linen_canvas:{price:125,stock:0,basePrice:12.5,baseStock:300,demand:1},tar:{price:162.5,stock:0,basePrice:16.25,baseStock:300,demand:1},fish_raw:{price:20,stock:0,basePrice:2,baseStock:800,demand:1},silk:{price:500,stock:0,basePrice:50,baseStock:50,demand:1},spice:{price:750,stock:0,basePrice:75,baseStock:50,demand:1}},p6=[{type:"RAID",title:"Vikinger p horisonten!",description:"Et vikingskip er sett nr kysten. Forsvar jordene fr de stjeler kornet!",locationId:"fields"},{type:"RAID",title:"Bandittleir funnet",description:"Banditter har sltt seg ned i skogen. De stjeler ved hver time!",locationId:"forest"},{type:"QUEST",title:"Den Hellige Gral?",description:"Rykter sier en eremitt ved klosteret har funnet noe verdifullt.",locationId:"village"},{type:"QUEST",title:"Markedsdag i nabolaget",description:"En sjelden mulighet for god handel p grensen.",locationId:"marketplace"}],g6=[{id:"tax_cut",label:"Skattekutt",description:"Alle skatter halveres i 10 minutter. Lojaliteten stiger."},{id:"peace",label:"Fredsavtale",description:"Ingen raids tillatt de neste 10 minuttene."},{id:"salt_tax",label:"Saltskatt",description:"ker kornprisene, men reduserer lojalitet."},{id:"conscription",label:"Verneplikt",description:"Soldater koster mindre  verve, men bnder jobber 20% tregere."}],V0={skins:[{id:"brown",label:"Rust",color:"#8B4513",price:0},{id:"white",label:"Pearl",color:"#E2E8F0",price:1e3},{id:"black",label:"Void",color:"#1A202C",price:2500},{id:"golden",label:"Gold",color:"#F6E05E",price:5e3},{id:"chestnut",label:"Red",color:"#7C2D12",price:750},{id:"grey",label:"Mist",color:"#94A3B8",price:1200}]},qf={standard:{id:"standard",name:"Snekke",description:"En enkel, men plitelig bt for kystfiske og korte turer.",baseSpeed:5,baseHp:100,cargoSlots:2,maxCannons:0,cost:{plank:50,tar:20}},sloop:{id:"sloop",name:"Slupp",description:"En rask seilbt som balanserer fart og lastekapasitet. Perfekt for handel.",baseSpeed:10,baseHp:250,cargoSlots:4,maxCannons:2,cost:{plank:200,iron_ingot:50,linen_canvas:40,tar:50}},cog:{id:"cog",name:"Kogg",description:"Et tungt handelsskip med bredt skrog. Tler mye juling.",baseSpeed:6,baseHp:600,cargoSlots:8,maxCannons:4,cost:{plank:500,iron_ingot:100,linen_canvas:80,tar:100}},galleon:{id:"galleon",name:"Gallion",description:"Havets ubestridte hersker. En flytende festning.",baseSpeed:8,baseHp:1500,cargoSlots:12,maxCannons:12,cost:{plank:1e3,iron_ingot:300,linen_canvas:150,gold:5e3,silk:50}}},wx={sails:{id:"sails",name:"Seilduk",description:"Forbedret seilduk fanger vinden bedre og ker farten.",levels:[{level:1,cost:{linen_canvas:10},effect:"+10% Fart"},{level:2,cost:{linen_canvas:25,silk:5},effect:"+20% Fart"},{level:3,cost:{linen_canvas:50,silk:20},effect:"+35% Fart"}]},hull:{id:"hull",name:"Skrogforsterkning",description:"Ekstra lag med eik og jernbeslag gir bten mer helse.",levels:[{level:1,cost:{plank:20,tar:5},effect:"+50 HP"},{level:2,cost:{plank:50,iron_ingot:10},effect:"+150 HP"},{level:3,cost:{plank:100,iron_ingot:30},effect:"+350 HP"}]},cannons:{id:"cannons",name:"Kanonbatteri",description:"Bedre kanoner ker skaden og rekkevidden.",levels:[{level:1,cost:{iron_ingot:20,plank:10},effect:"+20 Skade"},{level:2,cost:{iron_ingot:50,plank:25},effect:"+50 Skade"},{level:3,cost:{iron_ingot:100,gold:500},effect:"+100 Skade"}]},nets:{id:"nets",name:"Fiskenot",description:"Strre og sterkere garn ker fangsten per kast.",levels:[{level:1,cost:{linen_canvas:15},effect:"+20% Fangst"},{level:2,cost:{linen_canvas:40},effect:"+50% Fangst"},{level:3,cost:{linen_canvas:80,silk:5},effect:"+100% Fangst"}]}},Eo={colors:[{id:"classic_brown",name:"Valntt",hex:"#4b2c20",cost:{}},{id:"royal_red",name:"Kongelig Rd",hex:"#7f1d1d",cost:{gold:100}},{id:"deep_blue",name:"Havdyp Bl",hex:"#1e3a8a",cost:{gold:250}},{id:"midnight_black",name:"Svartedauden",hex:"#0f172a",cost:{gold:500}},{id:"gold_leaf",name:"Bladgull",hex:"#fbbf24",cost:{gold:2e3}}],flags:[{id:"none",name:"Ingen",cost:{}},{id:"pirate",name:"Sjrver",cost:{gold:150}},{id:"merchant",name:"Handelslaug",cost:{gold:300}},{id:"royal",name:"Kongens Vakt",cost:{gold:1e3}}]},c1=Object.freeze(Object.defineProperty({__proto__:null,ACTION_COSTS:Rl,ACTION_ICONS:ol,BOAT_MODELS:qf,BOAT_UPGRADES:wx,COSMETIC_UNLOCKS:Eo,CRAFTING_RECIPES:Hs,CROP_DATA:_x,GAME_BALANCE:te,HORSE_COSMETICS:V0,INITIAL_EQUIPMENT:F0,INITIAL_MARKET:st,INITIAL_RESOURCES:Gt,INITIAL_SKILLS:Fs,ITEM_TEMPLATES:Oe,LAW_TEMPLATES:g6,LEVEL_XP:Xd,RANK_BENEFITS:m6,REFINERY_RECIPES:Xi,REPAIR_CONFIG:G0,RESOURCE_DETAILS:Ie,REWARDS:Gc,ROLE_DEFINITIONS:rc,ROLE_TITLES:h6,SEASONS:Us,SKILL_DETAILS:f6,UPGRADES_LIST:yx,VILLAGE_BUILDINGS:cs,WEATHER:Dn,WORLD_EVENT_TEMPLATES:p6},Symbol.toStringTag,{value:"Module"})),x6=t=>{const e=Object.keys(t),s=[...e].sort(()=>Math.random()-.5),n={...t};if(e.length===0)return n;const a=s.shift();a&&(n[a]={...n[a],role:"KING",resources:JSON.parse(JSON.stringify(Gt.KING)),regionId:"capital",status:{hp:100,stamina:100,morale:100,legitimacy:100,authority:100,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:1,xp:0,reputation:50,contribution:0},equipment:{MAIN_HAND:{id:"tools",name:"Kongens Verkty",icon:"",type:"MAIN_HAND",level:1,durability:100,maxDurability:100},OFF_HAND:{id:"weapon",name:"Kongens Sverd",icon:"",type:"OFF_HAND",level:1,durability:100,maxDurability:100},BODY:{id:"armor",name:"Kongens Rustning",icon:"",type:"BODY",level:1,durability:100,maxDurability:100}}});const o=Math.min(2,s.length);for(let m=0;m<o;m++){const v=s.shift();if(v){const x=m===0?"region_ost":"region_vest";n[v]={...n[v],role:"BARON",resources:JSON.parse(JSON.stringify(Gt.BARON)),regionId:x,status:{hp:100,stamina:100,morale:100,legitimacy:80,authority:50,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:1,xp:0,reputation:40,contribution:0},equipment:{MAIN_HAND:{id:"tools",name:"Baronens Verkty",icon:"",type:"MAIN_HAND",level:1,durability:100,maxDurability:100},OFF_HAND:{id:"weapon",name:"Baronens Sverd",icon:"",type:"OFF_HAND",level:1,durability:100,maxDurability:100},BODY:{id:"armor",name:"Baronens Rustning",icon:"",type:"BODY",level:1,durability:100,maxDurability:100}}}}}let c=0;const u=()=>{const m=c%2===0?"region_ost":"region_vest";return c++,m},d=s.length;let f=0,h=0;d>=4?(f=Math.max(1,Math.floor(d/6)),h=Math.max(1,Math.floor(d/5))):d>0&&d<4&&(f=0,h=0);for(let m=0;m<f;m++){const v=s.shift();v&&(n[v]={...n[v],role:"MERCHANT",resources:JSON.parse(JSON.stringify(Gt.MERCHANT)),regionId:u(),status:{hp:100,stamina:100,morale:100,legitimacy:100,authority:30,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:1,xp:0,reputation:30,contribution:0},equipment:{MAIN_HAND:{id:"tools",name:"Hndverkty",icon:"",type:"MAIN_HAND",level:1,durability:100,maxDurability:100},OFF_HAND:{id:"weapon",name:"Kort sverd",icon:"",type:"OFF_HAND",level:1,durability:100,maxDurability:100},BODY:{id:"armor",name:"Kjpmannskappe",icon:"",type:"BODY",level:1,durability:100,maxDurability:100}}})}for(let m=0;m<h;m++){const v=s.shift();v&&(n[v]={...n[v],role:"SOLDIER",resources:JSON.parse(JSON.stringify(Gt.SOLDIER)),regionId:u(),status:{hp:100,stamina:100,morale:100,legitimacy:100,authority:50,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:1,xp:0,reputation:20,contribution:0},equipment:{MAIN_HAND:{id:"tools",name:"Feltverkty",icon:"",type:"MAIN_HAND",level:1,durability:100,maxDurability:100},OFF_HAND:{id:"weapon",name:"Soldatens Sverd",icon:"",type:"OFF_HAND",level:1,durability:100,maxDurability:100},BODY:{id:"armor",name:"Brynjekofte",icon:"",type:"BODY",level:1,durability:100,maxDurability:100}}})}for(;s.length>0;){const m=s.shift();m&&(n[m]={...n[m],role:"PEASANT",resources:JSON.parse(JSON.stringify(Gt.PEASANT)),regionId:u(),status:{hp:100,stamina:100,morale:80,legitimacy:100,authority:10,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:1,xp:0,reputation:10,contribution:0},equipment:{}})}return n},b6=(t,e)=>{const s={...t},n=[];return Object.values(s).forEach(i=>{if(i.role==="PEASANT"){const l=Math.ceil((i.resources.grain||0)*.15),o=Math.ceil((i.resources.gold||0)*(15/100));if(l>0||o>0){const c=Object.values(s).find(u=>u.role==="BARON"&&(u.regionId===i.regionId||i.regionId==="test_region"&&u.regionId==="test_region"));c&&(i.resources.grain=Math.max(0,i.resources.grain-l),i.resources.gold=Math.max(0,i.resources.gold-o),s[c.id].resources.grain+=l,s[c.id].resources.gold+=o,n.push(`${i.name} betalte ${l} korn og ${o} gull i skatt til ${c.name}`))}}}),Object.values(s).forEach(i=>{if(i.role==="BARON"){const a=Math.ceil((i.resources.grain||0)*(e/100)),l=Math.ceil((i.resources.gold||0)*(e/100));if(a>0||l>0){const o=Object.values(s).find(c=>c.role==="KING");o&&(i.resources.grain=Math.max(0,i.resources.grain-a),i.resources.gold=Math.max(0,i.resources.gold-l),s[o.id].resources.grain+=a,s[o.id].resources.gold+=l,n.push(`${i.name} betalte ${a} korn og ${l} gull i skatt til Kongen`))}}}),Object.values(s).forEach(i=>{if(i.role==="MERCHANT"||i.role==="SOLDIER"){const a=i.role==="MERCHANT"?e/50:e/100,l=Math.ceil((i.resources.gold||0)*a);if(l>0){const o=Object.values(s).find(c=>c.role==="KING");o&&(i.resources.gold=Math.max(0,i.resources.gold-l),s[o.id].resources.gold+=l,n.push(`${i.name} (${i.role}) betalte ${l} gull i skatt til Kongen`))}}}),{updatedPlayers:s,results:n}},v6=(t,e)=>{if(!t||Object.keys(t).length===0)return null;const s=te.CONTRIBUTION_VALUES,n=Object.entries(t).map(([l,o])=>{let c=0;return Object.entries(o.resources||{}).forEach(([u,d])=>{c+=d*(s[u]||.1)}),{pid:l,score:c,name:o.name}});n.sort((l,o)=>o.score-l.score);const i=n[0];if(!i)return null;const a=e==="throne_room"?"KING":"BARON";return{winningPlayerId:i.pid,role:a}},y6=(t,e)=>({pin:t,name:e,status:"PLAYING",settings:"feudal_europe",hostName:"Host",isPublic:!0,market:JSON.parse(JSON.stringify(st)),world:{year:1100,season:"Spring",weather:"Clear",gameTick:0,lastTickAt:Date.now(),taxRateDetails:{kingTax:20},settlement:{buildings:Object.entries(cs).reduce((s,[n])=>({...s,[n]:{id:n,level:0,progress:{},target:200,contributions:{}}}),{})}},markets:{capital:{...st},region_vest:{...st},region_ost:{...st}},players:{},public_profiles:{},messages:[],regions:{region_vest:{id:"region_vest",name:"Baroniet Vest",taxRate:10,defenseLevel:50,rulerName:"Ingen"},region_ost:{id:"region_ost",name:"Baroniet st",taxRate:10,defenseLevel:50,rulerName:"Ingen"}},diplomacy:{},worldEvents:{}}),Qd=async(t,e)=>{var i,a;if(!t||!e)return;const s=$(G,`simulation_server_metadata/${t}`);if(e.isPublic===!1){await qi(s,null);return}const n={pin:t,lastUpdated:Date.now()};e.name&&(n.name=e.name),e.status&&(n.status=e.status),e.players&&(n.playerCount=Object.keys(e.players).length),e.playerCount!==void 0&&(n.playerCount=e.playerCount),(i=e.world)!=null&&i.year&&(n.worldYear=e.world.year),(a=e.world)!=null&&a.season&&(n.season=e.world.season),e.hostName&&(n.hostName=e.hostName),e.isPublic!==void 0&&(n.isPublic=e.isPublic),await ne(s,n)},z0=30,_6=21,w6=120,w2=480,k6=["Spring","Summer","Autumn","Winter"],N6=t=>t%z0,Qi=t=>N6(t)<_6?"DAY":"NIGHT",S6=(t,e=0)=>{let s=t;if(e>0){const o=(Date.now()-e)/6e4;s+=Math.min(1,Math.max(0,o))}const i=s%z0/z0*24,a=(6+Math.floor(i))%24,l=Math.floor(i%1*60);return`${a.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`},E6=t=>{const e=Math.floor(t%w2/w6);return k6[e]||"Spring"},j6=(t,e=1)=>e+Math.floor(t/w2),Ui=t=>!t||!t.id?null:Oe[t.id]?t.id:Object.keys(Oe).sort((n,i)=>i.length-n.length).find(n=>t.id.startsWith(n+"_"))||null,k2=(t,e)=>{if(!e)return;const n=(Array.isArray(e)?e:Object.values(e)).filter(i=>{if(!i)return!1;const a=Ui(i),l=a?Oe[a]:null,o=i.relevantActions||(l==null?void 0:l.relevantActions);return o==null?void 0:o.includes(t)}).filter(i=>!!i);if(n.length!==0)return n.sort((i,a)=>{var h,m;const l=Ui(i),o=Ui(a),c=i.stats||(l?(h=Oe[l])==null?void 0:h.stats:{}),u=a.stats||(o?(m=Oe[o])==null?void 0:m.stats:{}),d=(c==null?void 0:c.yieldBonus)||0;return((u==null?void 0:u.yieldBonus)||0)-d})[0]},at=async(t,e)=>{const s=$(G,`simulation_rooms/${t}/messages`),n={id:`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,content:e,timestamp:Date.now(),type:"SYSTEM"};try{const i=$(G,`simulation_archives/${t}/full_log`);bx(i,n)}catch(i){console.error("Critical: Archive log failed:",i)}await je(s,i=>{let a=[];return Array.isArray(i)?a=i:i&&typeof i=="object"&&(a=Object.values(i)),a.push(n),a.length>50&&(a=a.sort((l,o)=>l.timestamp-o.timestamp).slice(a.length-50)),a})},vn=(t,e,s,n={})=>{var v,x;let i=0,a=!1;t.equipment&&Object.keys(t.equipment).forEach(g=>{var N,S;const p=t.equipment[g];if(!p)return;let y=p.relevantActions;if(!y&&p.id){const w=Ui(p);w&&(y=(N=Oe[w])==null?void 0:N.relevantActions)}if(!n.actionType||(y==null?void 0:y.includes(n.actionType))){const w=p.stats||(Ui(p)?(S=Oe[Ui(p)])==null?void 0:S.stats:void 0);w!=null&&w.yieldBonus&&(i+=w.yieldBonus),(g==="AXE"||g==="PICKAXE"||g==="SCYTHE"||g==="MAIN_HAND"||g==="OFF_HAND"||g==="BOW"||g==="TRAP"||g==="CHISEL")&&(a=!0)}});let l=e+i;const o=((v=t.skills)==null?void 0:v[s])||{level:0},c=n.isRefining?te.SKILLS.REFINING_BONUS:te.SKILLS.GATHERING_BONUS,u=1+o.level*c;l*=u;const d=n.actionType==="FORAGE"||n.actionType==="GATHER_HONEY";if(!n.isRefining&&!a&&!d){if(n.requiresTool)return 0;const b=(x=te.GATHERING)==null?void 0:x.NO_TOOL_PENALTY;l*=1-b}let f=1;n.regionId&&(n.actionType==="MINE"&&(n.regionId==="region_vest"?f=1.2:n.regionId==="region_ost"&&(f=.8)),n.actionType==="CHOP"&&(n.regionId==="region_vest"?f=.8:n.regionId==="region_ost"&&(f=1.2)));let h=1;if(t.activeBuffs&&t.activeBuffs.length>0){const b=Date.now(),g=t.activeBuffs.find(p=>p.type==="YIELD_BONUS"&&p.expiresAt>b);g&&(h+=g.value)}const m=(n.season||1)*(n.weather||1)*(n.law||1)*(n.upgrades||1)*f*h;if(l=Math.floor(l*m),n.performance!==void 0){const b=te.MINIGAME.BASE_MULTIPLIER+n.performance*te.MINIGAME.PERFORMANCE_WEIGHT;l=Math.ceil(l*b)}return Math.max(0,l)},Ys=(t,e,s,n,i=0)=>{const a=Us[e],l=Dn[s],o=(a==null?void 0:a.staminaMod)||1,c=(l==null?void 0:l.staminaMod)||1,d=Qi(i)==="NIGHT"?1.2:1;let h=t*o*c*d;if(n&&n.length>0){const m=Date.now(),v=n.find(x=>x.type==="STAMINA_SAVE"&&x.expiresAt>m);v&&(h*=1-v.value)}return Math.ceil(h)},en=(t,e,s,n=1)=>{if(!t||!e||!s)return;const i=s.replace(/\./g,"_"),a=$(G,`simulation_rooms/${t}/stats/${e}`);ne(a,{[i]:g2(n)}).catch(l=>console.error("Failed to log systemic stat:",l))},T6=async(t,e,s)=>{const{resource:n,type:i,amount:a}=s,l=Math.max(1,Math.floor(a||1)),o=$(G,`simulation_rooms/${t}/players/${e}`),c=await de(o);if(!c.exists())return{success:!1,error:"Player not found"};const u=c.val(),d=u.regionId||"capital";if((i==="BUY"||i==="MARKET_BUY")&&s.target==="CARAVAN"){const x=u.caravan||{level:1,inventory:{}},b=te.CARAVAN.LEVELS.find(p=>p.level===x.level)||te.CARAVAN.LEVELS[0],g=Object.values(x.inventory||{}).reduce((p,y)=>p+(y||0),0);if(g+l>b.capacity)return{success:!1,error:`Ikke nok plass i karavanen! (${g}/${b.capacity})`}}const f=$(G,`simulation_rooms/${t}/markets/${d}/${n}`);let h={success:!1,amount:0};if(await je(f,x=>{if(!x){const b=st[n];if(!b)return;x=JSON.parse(JSON.stringify(b))}if(i==="BUY"||i==="MARKET_BUY"){if(x.stock<l)return;h.price=x.price,h.cost=x.price*l,h.amount=l,x.stock-=l;const b=te.MARKET.PRICE_IMPACT_BUY;x.price=x.price*Math.pow(1+b,l),h.success=!0}else if(i==="SELL"||i==="MARKET_SELL"){h.price=x.price;const b=x.price*te.MARKET.SELL_RATIO;h.revenue=b*l,h.amount=l,x.stock+=l;const g=te.MARKET.PRICE_IMPACT_SELL;x.price=x.price*Math.pow(1-g,l),h.success=!0}return x}),!h.success)return{success:!1,error:"Handel feilet (Vare mangler, utsolgt eller for lite p lager)"};let m=!1,v="";return await je(o,x=>{var p,y;if(!x)return;x.resources||(x.resources={});const b=s.target||"BACKPACK",g=s.source||"BACKPACK";if(i==="BUY"||i==="MARKET_BUY"){const k=h.cost||0;if((x.resources.gold||0)<k)return;x.resources.gold=(x.resources.gold||0)-k,b==="CARAVAN"?(x.caravan||(x.caravan={level:1,inventory:{},durability:100,upgrades:[]}),x.caravan.inventory||(x.caravan.inventory={}),x.caravan.inventory[n]=(x.caravan.inventory[n]||0)+l):x.resources[n]=(x.resources[n]||0)+l;const N=Ie[n];v=`Kjpte ${l} ${N?N.label:n} for ${k.toFixed(1)}g`,m=!0}else if(i==="SELL"||i==="MARKET_SELL"){const k=h.revenue||0;if(g==="CARAVAN"){if((((y=(p=x==null?void 0:x.caravan)==null?void 0:p.inventory)==null?void 0:y[n])||0)<l)return;x.caravan.inventory[n]-=l}else{if((x.resources[n]||0)<l)return;x.resources[n]-=l}x.resources.gold=(x.resources.gold||0)+k;const N=Ie[n];v=`Solgte ${l} ${N?N.label:n} for ${k.toFixed(1)}g`,m=!0}return x}),m?(at(t,`[${new Date().toLocaleTimeString()}] ${u.name}: ${v}`),{success:!0,data:{success:!0,timestamp:Date.now(),message:v,utbytte:i==="BUY"||i==="MARKET_BUY"?[{resource:n,amount:l}]:[{resource:"gold",amount:h.revenue}],xp:[],durability:[]}}):{success:!1,error:"Transaksjon avbrutt (Mangler ressurser eller gull)"}},A6=async(t,e,s)=>{var g;const{buildingId:n,resource:i,amount:a}=s,l=$(G,`simulation_rooms/${t}/world/settlement/buildings/${n}`),o=$(G,`simulation_rooms/${t}/players/${e}`),c=await de(o);if(!c.exists())return{success:!1,error:"Player missing"};const u=c.val();if((((g=u.resources)==null?void 0:g[i])||0)<a)return{success:!1,error:"Not enough resources"};let d=!1,f=0,h="",m=!1,v=0,x="Ukjent feil i transaksjon";if(await je(l,p=>{var C,T,R,D;p||(p={id:n,level:0,progress:{},contributions:{}});const y=cs[n];if(!y){x=`Systemfeil: BuildingDef mangler for ID: ${n}`;return}h=(y==null?void 0:y.name)||n;const k=Number(p.level??0),N=p.progress&&Object.keys(p.progress).length>0,S=p.contributions&&Object.keys(p.contributions).length>0,w=!((C=y.levels)!=null&&C[k+1]);let E=!1;w&&(N||S)&&(console.log(`[Auto-Repair] Building ${n} is stuck at Level ${k}. Resetting to 0 to enable completion.`),p.level=0,E=!0);const j=Number(p.level??0),A=j+1,O=(T=y==null?void 0:y.levels)==null?void 0:T[A];if(!O)return x=`Bygget er ferdig (Level ${j}). Ingen flere oppgraderinger tilgjengelig.`,E?p:void 0;const L=((R=O.requirements)==null?void 0:R[i])||0,Y=((D=p.progress)==null?void 0:D[i])||0,W=L-Y;let H=!0;if(Object.entries(O.requirements).forEach(([I,F])=>{(p.progress[I]||0)<F&&(H=!1)}),W<=0&&!H)return x=`Fullt lager for ${i}. (Krav: ${L}, Har: ${Y}, Niv: ${j}->${A})`,E?p:void 0;f=Math.min(a,W),p.progress||(p.progress={}),p.progress[i]=Y+f,p.contributions||(p.contributions={}),p.contributions[e]||(p.contributions[e]={name:u.name,resources:{}});const M=p.contributions[e].resources;M[i]=(M[i]||0)+f;let U=!0;if(Object.entries(O.requirements).forEach(([I,F])=>{(p.progress[I]||0)<F&&(U=!1)}),U){p.level=A,p.progress={};const I=O.unlocks||[];if(I.includes("BARON_STATUS")||I.includes("KING_STATUS")){const F=v6(p.contributions,n);F&&(p.pendingWinnerId=F.winningPlayerId,p.pendingRole=F.role)}p.contributions={},m=!0,v=A}return d=!0,en(t,"contributions",i,f),p}),!d)return{success:!1,error:`${x}`};if(m){const y=(await de(l)).val();if(y.pendingWinnerId){const k=y.pendingWinnerId,N=y.pendingRole,S=$(G,`simulation_rooms/${t}/players/${k}`),E=(await de(S)).val(),j=$(G,`simulation_rooms/${t}`),A={};if(A[`players/${k}/role`]=N,A[`public_profiles/${k}/role`]=N,N==="BARON"){const L=n==="manor_ost"?"region_ost":"region_vest";A[`players/${k}/regionId`]=L,A[`public_profiles/${k}/regionId`]=L,A[`regions/${L}/rulerId`]=k,A[`regions/${L}/rulerName`]=E.name}else if(N==="KING"){A[`players/${k}/regionId`]="capital",A[`public_profiles/${k}/regionId`]="capital",A["regions/capital/rulerId"]=k,A["regions/capital/rulerName"]=E.name;const L=await de($(G,`simulation_rooms/${t}/regions`));if(L.exists()){const W=L.val();Object.entries(W).forEach(([H,M])=>{M.rulerId===k&&H!=="capital"&&(A[`regions/${H}/rulerId`]=null,A[`regions/${H}/rulerName`]="VAKANT")})}const Y=await de($(G,`simulation_rooms/${t}/players`));if(Y.exists()){const W=Y.val();Object.entries(W).forEach(([H,M])=>{M.role==="KING"&&H!==k&&(A[`players/${H}/role`]="PEASANT",A[`public_profiles/${H}/role`]="PEASANT",M.status&&(A[`players/${H}/status/legitimacy`]=0))})}}await ne(j,A);const O=` ${E.name} har fullfrt ${h} og er n utnevnt til ${N==="BARON"?"Baron":"Konge"}!`;at(t,O),await ne(l,{pendingWinnerId:null,pendingRole:null})}}let b=`Bidro med ${f} ${i} til ${h}`;return m&&(b+=`  ${h} ndde niv ${v}!`),await je(o,p=>{var y;if(p)return((y=p.resources)==null?void 0:y[i])>=f&&(p.resources[i]-=f),p}),at(t,`[${new Date().toLocaleTimeString()}] ${u.name}: ${b}`),{success:!0,data:{success:!0,timestamp:Date.now(),message:b,utbytte:[{resource:i,amount:-f}],xp:[],durability:[]}}},R6=async(t,e,s)=>{const n=$(G,`simulation_rooms/${t}/players/${e}`),i=await de(n);if(!i.exists())return{success:!1,error:"Spiller finnes ikke"};const a=i.val(),l=s.type||"TAX",o=a.role==="KING"||l==="TAX_ROYAL",c=s.taxRate!==void 0?s.taxRate:10,u=c/100,d=$(G,`simulation_rooms/${t}/players`),f=await de(d);if(!f.exists())return{success:!1,error:"Ingen spillere i rommet"};const h=f.val();let m=0,v=0,x=0;const b=(a.regionId||"").trim().toLowerCase(),g=Object.entries(h).map(async([L,Y])=>{if(L===e)return;const W=(Y.regionId||"").trim().toLowerCase();if(!(o?Y.role==="BARON":Y.role==="PEASANT"&&(W===b||W.includes(b)||b.includes(W))))return;const M=$(G,`simulation_rooms/${t}/players/${L}`);let U={goldFloat:0,grainFloat:0};await je(M,C=>{var F,P,B;if(!C)return;C.resources||(C.resources={gold:0,grain:0});const T=Number(C.resources.gold??C.gold??C.wealth??((F=C.stats)==null?void 0:F.gold)??((B=(P=C.inventory)==null?void 0:P.find(J=>J.id==="gold"))==null?void 0:B.amount)??0),R=Number(C.resources.grain??0),D=T*u,I=R*u;if(D>0){const J=Math.floor(D);C.resources.gold!==void 0?C.resources.gold-=J:C.gold!==void 0&&(C.gold-=J),U.goldFloat=D}if(I>0){const J=Math.floor(I);C.resources.grain-=J,U.grainFloat=I}return C}),(U.goldFloat>0||U.grainFloat>0)&&(x++,m+=U.goldFloat,v+=U.grainFloat)});await Promise.all(g);const p=Math.floor(m),y=Math.floor(v);await je(n,L=>{if(!L)return;L.resources||(L.resources={gold:0,grain:0}),L.resources.gold=(L.resources.gold||0)+p,L.resources.grain=(L.resources.grain||0)+y;const Y=Math.max(0,5+Math.floor((c-10)/2));return L.status.legitimacy=Math.max(0,(L.status.legitimacy||100)-Y),L});const k=Date.now(),N=$(G,`simulation_rooms/${t}/world`),w=(await de(N)).val()||{year:1,season:"Spring"},E=w.year||1,j=w.season||"Spring",A={year:E,season:j,amountGold:p,amountGrain:y,rate:c,timestamp:k};if(o){const L={};L.lastRoyalTaxCollection={year:E,season:j},w.taxRateDetails?L["taxRateDetails/kingTax"]=c:L.taxRateDetails={kingTax:c},await ne(N,L);const Y=$(G,`simulation_rooms/${t}/world/royalTaxHistory`),W=await de(Y),H=W.exists()?W.val():[];H.push(A),H.length>10&&H.shift(),await qi(Y,H)}else{const L=$(G,`simulation_rooms/${t}/regions/${a.regionId}`),Y={};Y.taxRate=c,Y.lastTaxCollection={year:E,season:j},await ne(L,Y);const W=$(G,`simulation_rooms/${t}/regions/${a.regionId}/taxHistory`),H=await de(W),M=H.exists()?H.val():[];M.push(A),M.length>10&&M.shift(),await qi(W,M)}const O=o?`Kongelig Skatt (${c}%): ${p}g og ${y} korn fra ${x} baroner.`:`Skatteinnkreving (${c}%): ${p}g og ${y} korn fra ${x} bnder.`;return at(t,`[${new Date().toLocaleTimeString()}] ${a.name}: ${O}`),{success:!0,data:{success:!0,timestamp:k,message:O,utbytte:[{resource:"gold",amount:p},{resource:"grain",amount:y}],xp:[],durability:[]}}},PV=async(t,e,s)=>{const n=$(G,`simulation_rooms/${t}/players/${e}`),i=await de(n);if(!i.exists())return{success:!1,error:"Fant ikke spilleren."};const a=i.val();if(a.role!=="PEASANT")return{success:!1,error:"Du har alt en karriere."};if(s!=="SOLDIER"&&s!=="MERCHANT")return{success:!1,error:"Ugyldig karrierevalg."};const l=te.CAREERS[s];if(a.stats.level<l.LEVEL_REQ)return{success:!1,error:`Du m vre level ${l.LEVEL_REQ} for  bli ${s==="SOLDIER"?"Soldat":"Kjpmann"}.`};if((a.resources.gold||0)<l.COST)return{success:!1,error:`Du mangler ${l.COST-(a.resources.gold||0)} gull.`};let o=!1;return await je(n,c=>{if(c&&!(c.resources.gold<l.COST))return c.resources.gold-=l.COST,c.role=s,o=!0,c}),o?(at(t,`[KARRIERE] ${a.name} er n en ${s}!`),{success:!0,message:`Gratulerer! Du er n en ${s==="SOLDIER"?"Soldat":"Kjpmann"}.`}):{success:!1,error:"Transaksjon feilet."}},C6=async(t,e)=>{en(t,"coups","start",1);const s=$(G,`simulation_rooms/${t}/regions/${e}`),i=(await de(s)).val(),a=i.rulerId,l=i.rulerName;if(a){const c=$(G,`simulation_rooms/${t}/players/${a}`);await je(c,u=>{if(u)return u.role="PEASANT",u.status&&(u.status.legitimacy=0),u}),await ne($(G,`simulation_rooms/${t}/public_profiles/${a}`),{role:"PEASANT"})}const o=await N2(t,e,i);at(t,` REVOLUSJON i ${i.name}! ${l} er styrtet. ${o} skyggelfter ble automatisk talt opp!`)},I6=async(t,e)=>{if(!e||e==="capital")return;const s=$(G,`simulation_rooms/${t}/regions/${e}`),i=(await de(s)).val();if(!i)return;await N2(t,e,i)>-1?at(t,` SUKSESSJON: Baroniet ${i.name} er ledig etter eierens kroning. Et nytt valg er i gang!`):at(t,` SUKSESSJON: Baroniet ${i.name} er ledig og kan n kreves.`)};async function N2(t,e,s){var h,m;const n={},i=((h=s.coup)==null?void 0:h.contributions)||{},a=((m=s.coup)==null?void 0:m.preVotes)||{};if(Object.entries(i).sort((v,x)=>x[1].amount-v[1].amount).slice(0,3).forEach(([v,x])=>{n[v]={id:v,name:x.name,votes:0,weightedVotes:0,contribution:x.amount}}),Object.keys(n).length===0)return await ne($(G,`simulation_rooms/${t}/regions/${e}`),{rulerId:null,rulerName:"VAKANT",activeElection:null,"coup/bribeProgress":0,"coup/preVotes":null}),-1;const l=Date.now(),o={startedAt:l,expiresAt:l+te.COUP.VACANCY_DURATION,candidates:n,votes:{}};let c=0;const u=$(G,`simulation_rooms/${t}/players`),f=(await de(u)).val()||{};return Object.entries(a).forEach(([v,x])=>{if(n[x]){const b=f[v];if(b){let g=te.COUP.PEASANT_VOTE_WEIGHT;b.role==="KING"&&(g=te.COUP.KING_VOTE_WEIGHT),o.votes[v]={candidateId:x,weight:g},n[x].votes+=1,n[x].weightedVotes+=g,c++}}}),await ne($(G,`simulation_rooms/${t}/regions/${e}`),{rulerId:null,rulerName:"VAKANT",activeElection:o,"coup/bribeProgress":0,"coup/preVotes":null}),c}const BV=async(t,e,s)=>{var y,k;const{regionId:n,amount:i}=s,a=$(G,`simulation_rooms/${t}/regions/${n}`),l=$(G,`simulation_rooms/${t}/players/${e}`),o=await de(l);if(!o.exists())return{success:!1,error:"Fant ikke spilleren."};const c=o.val();if((((y=c.resources)==null?void 0:y.gold)||0)<i)return{success:!1,error:"Du har ikke nok gull."};const d=(await de(a)).val();if(!d)return{success:!1,error:"Region finnes ikke."};const f=((k=d.coup)==null?void 0:k.lastRulerChange)||0,h=Date.now();if(h-f<te.COUP.HONEYMOON_DURATION&&c.role!=="KING")return{success:!1,error:`Regionen er for stabil. Prv igjen om ${Math.ceil((te.COUP.HONEYMOON_DURATION-(h-f))/6e4)} minutter.`};if(d.activeElection)return{success:!1,error:"Et valg pgr allerede."};let m=0,v=!1;if(await je(a,N=>{N||(N={id:n,name:n==="capital"?"Kongeriket":n==="region_vest"?"Baroniet Vest":"Baroniet st",rulerName:"Ingen",coup:{lastRulerChange:0,bribeProgress:0,contributions:{}}}),N.coup||(N.coup={lastRulerChange:0,bribeProgress:0,contributions:{}}),N.garrison||(N.garrison={swords:0,armor:0,morale:100}),N.fortification||(N.fortification={hp:1e3,maxHp:1e3,level:1});const S=N.coup.bribeProgress||0,w=i/te.COUP.BASE_BRIBE_COST*10;return e===d.rulerId?N.coup.bribeProgress=Math.max(0,S-w):(N.coup.bribeProgress=Math.min(100,S+w),N.coup.challengerId=e,N.coup.challengerName=c.name),N.coup.contributions||(N.coup.contributions={}),N.coup.contributions[e]||(N.coup.contributions[e]={name:c.name,amount:0}),N.coup.contributions[e].amount+=i,m=N.coup.bribeProgress,v=!0,N}),!v)return{success:!1,error:"Transaksjon feilet (Region oppdatert)."};await je(l,N=>{if(N)return N.resources.gold=(N.resources.gold||0)-i,N});const x=$(G,`simulation_rooms/${t}/players`),b=await de(x);let g={};b.exists()&&(g=b.val());let p=d.rulerId;if(!p&&Object.keys(g).length>0){if(n==="capital"){const N=Object.values(g).find(S=>S.role==="KING");N&&(p=N.id)}else{const N=Object.values(g).find(S=>S.role==="BARON"&&S.regionId===n);N&&(p=N.id)}p&&await ne(a,{rulerId:p})}if(p){const N=$(G,`simulation_rooms/${t}/players/${p}`),S=Math.floor(i/100);if(await je(N,w=>{if(w)return w.status&&(w.status.legitimacy=Math.max(0,(w.status.legitimacy||0)-S)),w}),Object.keys(g).length>0){const w=Object.keys(g).filter(E=>g[E].regionId===n&&E!==e&&(g[E].role==="PEASANT"||g[E].role==="SOLDIER"));if(w.length>0){const E=Math.floor(i/w.length);E>0&&await Promise.all(w.map(j=>{const A=$(G,`simulation_rooms/${t}/players/${j}/resources`);return ne(A,{gold:g2(E)})})),at(t,`[FOLKEGAVE] ${c.name} donerte ${i}g. ${w.length} innbyggere fikk ${E}g hver! (Opprr: ${m.toFixed(0)}%)`)}else at(t,`[FOLKEGAVE] ${c.name} donerte ${i}g til saken, men fant ingen trengende i ${d.name}. (Opprr: ${m.toFixed(0)}%)`)}else at(t,`[FOLKEGAVE] ${c.name} donerte ${i}g. (Opprr: ${m.toFixed(0)}%)`);return m>=100&&await C6(t,n),{success:!0,message:`Besteikkelse gjennomfrt! Opprr: ${m.toFixed(1)}%`}}return{success:!0,message:"Besteikkelse registrert."}},UV=async(t,e,s,n)=>{const i=$(G,`simulation_rooms/${t}/regions/${s}`);let a=!1;return await je(i,l=>{if(l)return l.coup||(l.coup={bribeProgress:0,contributions:{},preVotes:{}}),l.coup.preVotes||(l.coup.preVotes={}),l.coup.preVotes[e]=n,a=!0,l}),a?{success:!0,message:"Skyggelfte avgitt!"}:{success:!1,error:"Kunne ikke avgi lfte."}},HV=async(t,e,s)=>{const n=$(G,`simulation_rooms/${t}/regions/${s}`),i=$(G,`simulation_rooms/${t}/players/${e}`),a=te.COUP.RESTORE_ORDER_COST,l=await de(i);if(!l.exists())return{success:!1,error:"Spiller mangler"};const o=l.val();if(o.resources.gold<a)return{success:!1,error:`Trenger ${a}g for  gjenopprette ro.`};let c=!1;return await je(n,u=>{if(!(!u||u.rulerId!==e)&&u.coup)return u.coup.bribeProgress=Math.max(0,(u.coup.bribeProgress||0)-25),c=!0,u}),c?(await je(i,u=>{if(u)return u.resources.gold-=a,u.status.legitimacy=Math.min(100,(u.status.legitimacy||0)+10),u}),at(t,` ${o.name} har gjenopprettet ro i ${s} ved  dele ut midler til vaktene.`),{success:!0,message:"Ro gjenopprettet (-25% opprr)"}):{success:!1,error:"Kunne ikke gjenopprette ro."}},$V=async(t,e,s)=>{const{regionId:n,candidateId:i}=s,a=$(G,`simulation_rooms/${t}/regions/${n}`),l=$(G,`simulation_rooms/${t}/players/${e}`),o=await de(l);if(!o.exists())return{success:!1};const c=o.val();let u=te.COUP.PEASANT_VOTE_WEIGHT;c.role==="KING"&&(u=te.COUP.KING_VOTE_WEIGHT);let d=!1;return await je(a,f=>{if(!f||!f.activeElection||Date.now()>f.activeElection.expiresAt)return;f.activeElection.votes||(f.activeElection.votes={});const h=f.activeElection.votes[e];if(h){const v=f.activeElection.candidates[h.candidateId];v&&(v.votes=Math.max(0,(v.votes||0)-1),v.weightedVotes=Math.max(0,(v.weightedVotes||0)-h.weight))}f.activeElection.votes[e]={candidateId:i,weight:u};const m=f.activeElection.candidates[i];return m&&(m.votes=(m.votes||0)+1,m.weightedVotes=(m.weightedVotes||0)+u),d=!0,f}),{success:d}},O6=async(t,e,s)=>{const{newRate:n}=s,i=$(G,`simulation_rooms/${t}/players/${e}`),a=await de(i);if(!a.exists())return{success:!1,error:"Spiller mangler"};const l=a.val(),o=l.regionId||"capital",c=$(G,`simulation_rooms/${t}/regions/${o}`),u=Math.max(0,Math.min(20,n));await ne(c,{taxRate:u});const d=`Skatteniv i ${o} satt til ${u}%.`;return at(t,`[${new Date().toLocaleTimeString()}] ${l.name}: ${d}`),{success:!0,data:{message:d}}},GV=async(t,e)=>{const s=$(G,`simulation_rooms/${t}/regions/${e}`),i=(await de(s)).val(),a=(i==null?void 0:i.name)||e;let l=null;if(await je(s,o=>{if(!o||!o.activeElection||Date.now()<o.activeElection.expiresAt)return;const c=Object.values(o.activeElection.candidates);if(c.length===0)return o.rulerId=null,o.rulerName="Ingen Hersker",o.activeElection=null,o;const u=c.sort((d,f)=>f.weightedVotes-d.weightedVotes)[0];return l={winnerId:u.id,winnerName:u.name},o.rulerId=u.id,o.rulerName=u.name,o.activeElection=null,o.coup||(o.coup={lastRulerChange:Date.now(),bribeProgress:0,contributions:{}}),o.coup.lastRulerChange=Date.now(),o.coup.bribeProgress=0,o.coup.contributions={},o}),l){en(t,"coups","success",1);const o=l.winnerId,c=$(G,`simulation_rooms/${t}/players/${o}`),d=(await de(c)).val(),f=$(G,`simulation_rooms/${t}`),h=e==="capital",m=h?"KING":"BARON",v=h?"Konge":"Baron",x={};return x[`players/${o}/role`]=m,x[`players/${o}/regionId`]=e,x[`public_profiles/${o}/role`]=m,x[`public_profiles/${o}/regionId`]=e,await ne(f,x),at(t,` KRONING: ${d.name} har vunnet valget og er n ${v} av ${a}!`),{success:!0}}return{success:!1}},M6=async(t,e,s)=>{const n=$(G,`simulation_rooms/${t}/players/${e}`);let i=!1;return await je(n,a=>{if(a)return a.resources||(a.resources={}),a.resources.gold=(a.resources.gold||0)+s,i=!0,a}),i&&at(t,` ADMIN: Gitt ${s}g til en spiller.`),{success:i}},D6=async(t,e,s,n)=>{const i=$(G,`simulation_rooms/${t}/players/${e}`),a=Oe[s];if(!a)return{success:!1,error:"Invalid Item ID"};let l=!1;return await je(i,o=>{if(o){o.inventory||(o.inventory=[]);for(let c=0;c<n;c++){const u=JSON.parse(JSON.stringify(a));u.instanceId=`${s}_${Date.now()}_${Math.random().toString(36).substr(2,5)}`,o.inventory.push(u)}return l=!0,o}}),l&&at(t,` ADMIN: Gitt ${n}x ${a.name} til en spiller.`),{success:l}},L6=async(t,e,s,n)=>{const i=$(G,`simulation_rooms/${t}/players/${e}`);let a=!1;return await je(i,l=>{if(l)return l.resources||(l.resources={}),l.resources[s]=(l.resources[s]||0)+n,l.resources[s]<0&&(l.resources[s]=0),a=!0,l}),a&&at(t,` ADMIN: Gitt ${n}x ${s} til en spiller.`),{success:a}},P6=async(t,e,s,n)=>{var d;const i=$(G,`simulation_rooms/${t}/players/${e}`),a=$(G,`simulation_rooms/${t}/channels/${n}/messages`),l=await de(i);if(!l.exists())return{success:!1,error:"Spiller mangler"};const o=l.val();let c=0;if(o.role!=="KING"&&(n==="global"?c=2:n!==o.regionId&&n!=="diplomacy"&&n.includes(e)&&n.length>20&&(c=5)),(((d=o.resources)==null?void 0:d.gold)||0)<c)return{success:!1,error:`Trenger ${c}g for  sende denne meldingen.`};let u=!1;if(c>0?await je(i,f=>{if(f&&!((f.resources.gold||0)<c))return f.resources.gold-=c,u=!0,f}):u=!0,!u)return{success:!1,error:"Har ikke rd."};try{const f=bx(a);return await ne(f,{id:f.key,senderId:e,senderName:o.name,senderRole:o.role,content:s.trim(),timestamp:t6(),isPremiere:c>0}),{success:!0}}catch(f){return console.error("Chat Send Error:",f),{success:!1,error:`Kunne ikke sende melding: ${f.message||"Ukjent feil"}`}}},B6=async(t,e,s)=>{const{targetRegionId:n}=s,i=$(G,`simulation_rooms/${t}/players/${e}`),a=await de(i);if(!a.exists())return{success:!1,error:"Spiller finnes ikke"};const l=a.val();if(l.regionId===n)return{success:!1,error:"Du er allerede i denne regionen."};const o=Rl.TRAVEL_START;return(l.status.stamina||0)<(o==null?void 0:o.stamina)?{success:!1,error:"For sliten for reise."}:(l.resources.bread||0)<(o==null?void 0:o.bread)?{success:!1,error:"Trenger mer niste (brd) for reisen."}:(await je(i,c=>{if(c)return c.status.stamina-=o==null?void 0:o.stamina,c.resources.bread-=o==null?void 0:o.bread,c}),at(t,`[VEIEN] ${l.name} har lagt ut p reise mot ${n}...`),{success:!0,data:{success:!0,message:"Reisen har begynt!",utbytte:[],xp:[],durability:[]}})},U6=async(t,e,s)=>{const{targetRegionId:n,finalDurability:i}=s,a=$(G,`simulation_rooms/${t}/players/${e}`),l=await de(a);if(!l.exists())return{success:!1,error:"Spiller finnes ikke"};const o=l.val();let c=0;await je(a,d=>{if(d)return d.regionId=n,typeof i=="number"&&(d.caravan||(d.caravan={level:1,inventory:{},durability:100,upgrades:[]}),d.caravan.durability=Math.max(0,i),c=d.caravan.durability),d}),await ne($(G,`simulation_rooms/${t}/public_profiles/${e}`),{regionId:n});const u=n==="capital"?"Hovedstaden":n==="region_vest"?"Vestfjella":"stlandet";return at(t,`[VEIEN] ${o.name} har ankommet ${u}. (Slitasje: ${Math.round(c)})`),{success:!0,data:{success:!0,message:`Ankommet ${u}!`,utbytte:[],xp:[{skill:"TRADING",amount:25}],durability:[]}}},Ji=t=>{if(!t.basePrice||!t.baseStock)return t.price;const e=Math.max(1,t.stock),s=t.baseStock/e;let n=Math.pow(s,1.25);return n=Math.min(10,Math.max(.2,n)),t.basePrice*n},u1=(t,e,s)=>{let n=0;const i={...t},a=s?-1:1;for(let l=0;l<e;l++){const o=Ji(i);if(n+=s?o:o*te.MARKET.SELL_RATIO,i.stock+=a,i.stock<0)break}return n},H6=t=>{var h;const{actor:e,room:s,action:n,localResult:i}=t,{resource:a}=n,l=e.regionId||"capital";let o=((h=s.markets)==null?void 0:h[l])||s.market;const c=["iron","swords","armor"];let u=!1;if(c.forEach(m=>{o[m]&&(delete o[m],u=!0)}),Object.keys(st).forEach(m=>{o[m]||(o[m]=JSON.parse(JSON.stringify(st[m])),u=!0)}),u&&s.markets&&(s.markets[l]=o),!o)return i.success=!1,i.message="Markedet er ikke tilgjengelig.",!1;if(!o[a])return i.success=!1,i.message="Markedet tilbyr ikke denne varen her.",!1;const d=o[a];if(!d)return i.success=!1,i.message="Varen finnes ikke p dette markedet.",!1;const f=Ji(d);return d.stock<=0?(i.success=!1,i.message="Varen er utsolgt.",!1):(e.resources.gold||0)<f?(i.success=!1,i.message=`Du har ikke nok gull. Trenger ${f.toFixed(2)}g`,!1):(e.resources.gold=(e.resources.gold||0)-f,e.resources[a]=(e.resources[a]||0)+1,d.stock-=1,d.price=Ji(d),i.message=`Kjpte 1 ${a} for ${f.toFixed(2)}g`,i.utbytte.push({resource:a,amount:1}),!0)},$6=t=>{var h;const{actor:e,room:s,action:n,localResult:i}=t,{resource:a}=n,l=e.regionId||"capital";let o=((h=s.markets)==null?void 0:h[l])||s.market;if(!o){s.markets||(s.markets={});const m=JSON.parse(JSON.stringify(st)),x={region_vest:{discount:["iron_ore","stone","swords"],premium:["grain","bread","cloth"]},region_ost:{discount:["grain","bread","wool","meat"],premium:["iron_ore","tools","wood"]},capital:{discount:["luxury_goods","glass"],premium:["raw_materials","wood","stone"]}}[l]||{discount:[],premium:[]};Object.keys(m).forEach(b=>{x.discount.includes(b)&&(m[b].price*=.6,m[b].stock*=1.5),x.premium.includes(b)&&(m[b].price*=1.4,m[b].stock*=.7),m[b].price*=.9+Math.random()*.2}),o=m,s.markets[l]=o}if(!o)return i.success=!1,i.message="Markedet er ikke tilgjengelig.",!1;if(!o[a]||!o[a])return i.success=!1,i.message="Markedet tar ikke imot denne varen her.",!1;const c=e.resources[a]||0;if(typeof c!="number"||c<1)return i.success=!1,i.message=`Du har ingen ${a}  selge.`,!1;const u=o[a];if(!u)return i.success=!1,i.message="Markedet tar ikke imot denne varen.",!1;const f=Ji(u)*te.MARKET.SELL_RATIO;return e.resources[a]-=1,e.resources.gold=(e.resources.gold||0)+f,u.stock+=1,u.price=Ji(u),i.message=`Solgte 1 ${a} for ${f.toFixed(2)}g`,!0},G6=t=>{var v,x;const{actor:e,room:s,action:n,localResult:i,trackXp:a}=t,{resource:l,targetRegionId:o,action:c}=n,u=e.regionId||"capital",d=((v=s.markets)==null?void 0:v[u])||s.market,f=(x=s.markets)==null?void 0:x[o];if(!d||!f||!d[l]||!f[l])return i.success=!1,i.message="Ugyldig handelsrute eller vare.",!1;const h=d[l],m=f[l];if(!h||!m)return i.success=!1,i.message="Varen handles ikke p disse markedene.",!1;if(c==="IMPORT"){const g=u1(m,5,!0);if((e.resources.gold||0)<g)return i.success=!1,i.message=`Ikke nok gull. Trenger ${g.toFixed(2)}g for 5stk.`,!1;for(let p=0;p<5;p++)m.stock-=1,m.price=Ji(m);e.resources.gold-=g,e.resources[l]=(e.resources[l]||0)+5,i.message=`Bulk-Import: 5 ${l} fra ${o} for ${g.toFixed(2)}g`}else{if((e.resources[l]||0)<5)return i.success=!1,i.message=`Mangler 5 ${l} for eksport.`,!1;const g=u1(m,5,!1);for(let p=0;p<5;p++)m.stock+=1,m.price=Ji(m);e.resources[l]-=5,e.resources.gold+=g,i.message=`Bulk-Eksport: 5 ${l} til ${o} for ${g.toFixed(2)}g`}return a("TRADING",25),!0},F6=t=>{t&&Object.keys(t).forEach(e=>{const s=t[e];if(!(!s||!s.baseStock)&&s.stock>s.baseStock*.1){const n=s.stock*.003;s.stock=Math.max(0,s.stock-n),s.price=Ji(s)}})},S2=(t,e,s,n)=>{_.useEffect(()=>{if(!t||e==="LOBBY")return;const i=setInterval(async()=>{const a=Date.now(),l=(s==null?void 0:s.lastTickAt)||0;if(!(a-l<1e3))if(a-l>=6e4){const o=$(G,`simulation_rooms/${t}/world`);try{let c=null;await je(o,u=>{if(!u)return;const d=u.lastTickAt||0;if(Date.now()-d>=6e4){const f=(u.gameTick||0)+1;if(u.gameTick=f,u.lastTickAt=Date.now(),u.season=E6(f),u.year=j6(f,1100),f%10===0){const h=$(G,`simulation_rooms/${t}/markets`);de(h).then(m=>{if(m.exists()){const v=m.val();Object.keys(v).forEach(x=>{F6(v[x])}),ne(h,v)}})}return c={...u},u}else return}),c&&Qd(t,{world:c,pin:t,playerCount:n})}catch{}}else s!=null&&s.lastTickAt||ne($(G,`simulation_rooms/${t}/world`),{lastTickAt:Date.now()})},5e3);return()=>clearInterval(i)},[t,e,s==null?void 0:s.lastTickAt,s==null?void 0:s.gameTick,n]),_.useEffect(()=>{if(!t||n===void 0)return;const i=setTimeout(()=>{Qd(t,{playerCount:n})},2e3);return()=>clearTimeout(i)},[t,n])},V6=t=>{const[e,s]=_.useState(null);_.useEffect(()=>{if(!t){s(null);return}const i=`simulation_rooms/${t}`,a=$e($(G,`${i}/status`),m=>{s(v=>{const x=m.val()||"LOBBY";return v?{...v,status:x}:{pin:t,status:x,markets:{},market:st,players:{},messages:[],regions:{},worldEvents:{}}})}),l=$e($(G,`${i}/world`),m=>{s(v=>{const x=m.val();return v?{...v,world:x}:{pin:t,world:x,markets:{},market:st,players:{},messages:[],regions:{},worldEvents:{}}})}),o=$e($(G,`${i}/markets`),m=>{s(v=>{const x=m.val()||{};return v?{...v,markets:x}:{pin:t,markets:x,market:st,players:{},messages:[],regions:{},worldEvents:{}}})}),c=$e($(G,`${i}/messages`),m=>{s(v=>{const x=m.val()||[];return v?{...v,messages:x}:{pin:t,messages:x,markets:{},market:st,players:{},regions:{},worldEvents:{}}})}),u=$e($(G,`${i}/players`),m=>{s(v=>{const x=m.val()||{};return v?{...v,players:x}:{pin:t,players:x,markets:{},market:st,messages:[],regions:{},worldEvents:{}}})}),d=$e($(G,`${i}/worldEvents`),m=>{s(v=>{const x=m.val()||{};return v?{...v,worldEvents:x}:{pin:t,worldEvents:x,markets:{},market:st,players:{},messages:[],regions:{}}})}),f=$e($(G,`${i}/activeVote`),m=>{s(v=>{const x=m.val();return v?{...v,activeVote:x}:{pin:t,activeVote:x,markets:{},market:st,players:{},messages:[],regions:{},worldEvents:{}}})}),h=$e($(G,`${i}/regions`),m=>{s(v=>{const x=m.val()||{};return v?{...v,regions:x}:{pin:t,regions:x,markets:{},market:st,players:{},messages:[],worldEvents:{}}})});return de($(G,i)).then(m=>{if(m.exists()){const v=m.val();s(x=>({...x,pin:v.pin,status:v.status,settings:v.settings,hostName:v.hostName,isPublic:v.isPublic??!0,world:v.world,markets:v.markets||{},market:v.market||st,players:(x==null?void 0:x.players)||v.players||{},messages:(x==null?void 0:x.messages)||v.messages||[],regions:v.regions||{},diplomacy:v.diplomacy||{},worldEvents:v.worldEvents||{}}))}}),()=>{a(),l(),o(),c(),u(),d(),f(),h()}},[t]);const n=_.useMemo(()=>{if(!(e!=null&&e.players))return 0;const i=Date.now();return Object.values(e.players).filter(a=>a.online&&i-(a.lastActive||0)<6e4).length},[e==null?void 0:e.players]);return{roomData:e,setRoomData:s,onlineCount:n}},kx=_.createContext({});function Nx(t){const e=_.useRef(null);return e.current===null&&(e.current=t()),e.current}const Sx=typeof window<"u",E2=Sx?_.useLayoutEffect:_.useEffect,Xf=_.createContext(null);function Ex(t,e){t.indexOf(e)===-1&&t.push(e)}function jx(t,e){const s=t.indexOf(e);s>-1&&t.splice(s,1)}const Xn=(t,e,s)=>s>e?e:s<t?t:s;let Tx=()=>{};const Qn={},j2=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function T2(t){return typeof t=="object"&&t!==null}const A2=t=>/^0[^.\s]+$/u.test(t);function Ax(t){let e;return()=>(e===void 0&&(e=t()),e)}const $s=t=>t,z6=(t,e)=>s=>e(t(s)),Fc=(...t)=>t.reduce(z6),lc=(t,e,s)=>{const n=e-t;return n===0?1:(s-t)/n};class Rx{constructor(){this.subscriptions=[]}add(e){return Ex(this.subscriptions,e),()=>jx(this.subscriptions,e)}notify(e,s,n){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,s,n);else for(let a=0;a<i;a++){const l=this.subscriptions[a];l&&l(e,s,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const hn=t=>t*1e3,Ls=t=>t/1e3;function R2(t,e){return e?t*(1e3/e):0}const C2=(t,e,s)=>(((1-3*s+3*e)*t+(3*s-6*e))*t+3*e)*t,K6=1e-7,Y6=12;function W6(t,e,s,n,i){let a,l,o=0;do l=e+(s-e)/2,a=C2(l,n,i)-t,a>0?s=l:e=l;while(Math.abs(a)>K6&&++o<Y6);return l}function Vc(t,e,s,n){if(t===e&&s===n)return $s;const i=a=>W6(a,0,1,t,s);return a=>a===0||a===1?a:C2(i(a),e,n)}const I2=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,O2=t=>e=>1-t(1-e),M2=Vc(.33,1.53,.69,.99),Cx=O2(M2),D2=I2(Cx),L2=t=>(t*=2)<1?.5*Cx(t):.5*(2-Math.pow(2,-10*(t-1))),Ix=t=>1-Math.sin(Math.acos(t)),P2=O2(Ix),B2=I2(Ix),q6=Vc(.42,0,1,1),X6=Vc(0,0,.58,1),U2=Vc(.42,0,.58,1),Q6=t=>Array.isArray(t)&&typeof t[0]!="number",H2=t=>Array.isArray(t)&&typeof t[0]=="number",J6={linear:$s,easeIn:q6,easeInOut:U2,easeOut:X6,circIn:Ix,circInOut:B2,circOut:P2,backIn:Cx,backInOut:D2,backOut:M2,anticipate:L2},Z6=t=>typeof t=="string",d1=t=>{if(H2(t)){Tx(t.length===4);const[e,s,n,i]=t;return Vc(e,s,n,i)}else if(Z6(t))return J6[t];return t},bu=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function eP(t,e){let s=new Set,n=new Set,i=!1,a=!1;const l=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function c(d){l.has(d)&&(u.schedule(d),t()),d(o)}const u={schedule:(d,f=!1,h=!1)=>{const v=h&&i?s:n;return f&&l.add(d),v.has(d)||v.add(d),d},cancel:d=>{n.delete(d),l.delete(d)},process:d=>{if(o=d,i){a=!0;return}i=!0,[s,n]=[n,s],s.forEach(c),s.clear(),i=!1,a&&(a=!1,u.process(d))}};return u}const tP=40;function $2(t,e){let s=!1,n=!0;const i={delta:0,timestamp:0,isProcessing:!1},a=()=>s=!0,l=bu.reduce((y,k)=>(y[k]=eP(a),y),{}),{setup:o,read:c,resolveKeyframes:u,preUpdate:d,update:f,preRender:h,render:m,postRender:v}=l,x=()=>{const y=Qn.useManualTiming?i.timestamp:performance.now();s=!1,Qn.useManualTiming||(i.delta=n?1e3/60:Math.max(Math.min(y-i.timestamp,tP),1)),i.timestamp=y,i.isProcessing=!0,o.process(i),c.process(i),u.process(i),d.process(i),f.process(i),h.process(i),m.process(i),v.process(i),i.isProcessing=!1,s&&e&&(n=!1,t(x))},b=()=>{s=!0,n=!0,i.isProcessing||t(x)};return{schedule:bu.reduce((y,k)=>{const N=l[k];return y[k]=(S,w=!1,E=!1)=>(s||b(),N.schedule(S,w,E)),y},{}),cancel:y=>{for(let k=0;k<bu.length;k++)l[bu[k]].cancel(y)},state:i,steps:l}}const{schedule:it,cancel:Zi,state:Bt,steps:tm}=$2(typeof requestAnimationFrame<"u"?requestAnimationFrame:$s,!0);let Ku;function sP(){Ku=void 0}const ls={now:()=>(Ku===void 0&&ls.set(Bt.isProcessing||Qn.useManualTiming?Bt.timestamp:performance.now()),Ku),set:t=>{Ku=t,queueMicrotask(sP)}},G2=t=>e=>typeof e=="string"&&e.startsWith(t),F2=G2("--"),nP=G2("var(--"),Ox=t=>nP(t)?iP.test(t.split("/*")[0].trim()):!1,iP=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Cl={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},oc={...Cl,transform:t=>Xn(0,1,t)},vu={...Cl,default:1},jo=t=>Math.round(t*1e5)/1e5,Mx=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function aP(t){return t==null}const rP=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Dx=(t,e)=>s=>!!(typeof s=="string"&&rP.test(s)&&s.startsWith(t)||e&&!aP(s)&&Object.prototype.hasOwnProperty.call(s,e)),V2=(t,e,s)=>n=>{if(typeof n!="string")return n;const[i,a,l,o]=n.match(Mx);return{[t]:parseFloat(i),[e]:parseFloat(a),[s]:parseFloat(l),alpha:o!==void 0?parseFloat(o):1}},lP=t=>Xn(0,255,t),sm={...Cl,transform:t=>Math.round(lP(t))},_a={test:Dx("rgb","red"),parse:V2("red","green","blue"),transform:({red:t,green:e,blue:s,alpha:n=1})=>"rgba("+sm.transform(t)+", "+sm.transform(e)+", "+sm.transform(s)+", "+jo(oc.transform(n))+")"};function oP(t){let e="",s="",n="",i="";return t.length>5?(e=t.substring(1,3),s=t.substring(3,5),n=t.substring(5,7),i=t.substring(7,9)):(e=t.substring(1,2),s=t.substring(2,3),n=t.substring(3,4),i=t.substring(4,5),e+=e,s+=s,n+=n,i+=i),{red:parseInt(e,16),green:parseInt(s,16),blue:parseInt(n,16),alpha:i?parseInt(i,16)/255:1}}const K0={test:Dx("#"),parse:oP,transform:_a.transform},zc=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),ai=zc("deg"),mn=zc("%"),oe=zc("px"),cP=zc("vh"),uP=zc("vw"),f1={...mn,parse:t=>mn.parse(t)/100,transform:t=>mn.transform(t*100)},wr={test:Dx("hsl","hue"),parse:V2("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:s,alpha:n=1})=>"hsla("+Math.round(t)+", "+mn.transform(jo(e))+", "+mn.transform(jo(s))+", "+jo(oc.transform(n))+")"},xt={test:t=>_a.test(t)||K0.test(t)||wr.test(t),parse:t=>_a.test(t)?_a.parse(t):wr.test(t)?wr.parse(t):K0.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?_a.transform(t):wr.transform(t),getAnimatableNone:t=>{const e=xt.parse(t);return e.alpha=0,xt.transform(e)}},dP=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function fP(t){var e,s;return isNaN(t)&&typeof t=="string"&&(((e=t.match(Mx))==null?void 0:e.length)||0)+(((s=t.match(dP))==null?void 0:s.length)||0)>0}const z2="number",K2="color",hP="var",mP="var(",h1="${}",pP=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function cc(t){const e=t.toString(),s=[],n={color:[],number:[],var:[]},i=[];let a=0;const o=e.replace(pP,c=>(xt.test(c)?(n.color.push(a),i.push(K2),s.push(xt.parse(c))):c.startsWith(mP)?(n.var.push(a),i.push(hP),s.push(c)):(n.number.push(a),i.push(z2),s.push(parseFloat(c))),++a,h1)).split(h1);return{values:s,split:o,indexes:n,types:i}}function Y2(t){return cc(t).values}function W2(t){const{split:e,types:s}=cc(t),n=e.length;return i=>{let a="";for(let l=0;l<n;l++)if(a+=e[l],i[l]!==void 0){const o=s[l];o===z2?a+=jo(i[l]):o===K2?a+=xt.transform(i[l]):a+=i[l]}return a}}const gP=t=>typeof t=="number"?0:xt.test(t)?xt.getAnimatableNone(t):t;function xP(t){const e=Y2(t);return W2(t)(e.map(gP))}const ea={test:fP,parse:Y2,createTransformer:W2,getAnimatableNone:xP};function nm(t,e,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?t+(e-t)*6*s:s<1/2?e:s<2/3?t+(e-t)*(2/3-s)*6:t}function bP({hue:t,saturation:e,lightness:s,alpha:n}){t/=360,e/=100,s/=100;let i=0,a=0,l=0;if(!e)i=a=l=s;else{const o=s<.5?s*(1+e):s+e-s*e,c=2*s-o;i=nm(c,o,t+1/3),a=nm(c,o,t),l=nm(c,o,t-1/3)}return{red:Math.round(i*255),green:Math.round(a*255),blue:Math.round(l*255),alpha:n}}function Jd(t,e){return s=>s>0?e:t}const ot=(t,e,s)=>t+(e-t)*s,im=(t,e,s)=>{const n=t*t,i=s*(e*e-n)+n;return i<0?0:Math.sqrt(i)},vP=[K0,_a,wr],yP=t=>vP.find(e=>e.test(t));function m1(t){const e=yP(t);if(!e)return!1;let s=e.parse(t);return e===wr&&(s=bP(s)),s}const p1=(t,e)=>{const s=m1(t),n=m1(e);if(!s||!n)return Jd(t,e);const i={...s};return a=>(i.red=im(s.red,n.red,a),i.green=im(s.green,n.green,a),i.blue=im(s.blue,n.blue,a),i.alpha=ot(s.alpha,n.alpha,a),_a.transform(i))},Y0=new Set(["none","hidden"]);function _P(t,e){return Y0.has(t)?s=>s<=0?t:e:s=>s>=1?e:t}function wP(t,e){return s=>ot(t,e,s)}function Lx(t){return typeof t=="number"?wP:typeof t=="string"?Ox(t)?Jd:xt.test(t)?p1:SP:Array.isArray(t)?q2:typeof t=="object"?xt.test(t)?p1:kP:Jd}function q2(t,e){const s=[...t],n=s.length,i=t.map((a,l)=>Lx(a)(a,e[l]));return a=>{for(let l=0;l<n;l++)s[l]=i[l](a);return s}}function kP(t,e){const s={...t,...e},n={};for(const i in s)t[i]!==void 0&&e[i]!==void 0&&(n[i]=Lx(t[i])(t[i],e[i]));return i=>{for(const a in n)s[a]=n[a](i);return s}}function NP(t,e){const s=[],n={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const a=e.types[i],l=t.indexes[a][n[a]],o=t.values[l]??0;s[i]=o,n[a]++}return s}const SP=(t,e)=>{const s=ea.createTransformer(e),n=cc(t),i=cc(e);return n.indexes.var.length===i.indexes.var.length&&n.indexes.color.length===i.indexes.color.length&&n.indexes.number.length>=i.indexes.number.length?Y0.has(t)&&!i.values.length||Y0.has(e)&&!n.values.length?_P(t,e):Fc(q2(NP(n,i),i.values),s):Jd(t,e)};function X2(t,e,s){return typeof t=="number"&&typeof e=="number"&&typeof s=="number"?ot(t,e,s):Lx(t)(t,e)}const EP=t=>{const e=({timestamp:s})=>t(s);return{start:(s=!0)=>it.update(e,s),stop:()=>Zi(e),now:()=>Bt.isProcessing?Bt.timestamp:ls.now()}},Q2=(t,e,s=10)=>{let n="";const i=Math.max(Math.round(e/s),2);for(let a=0;a<i;a++)n+=Math.round(t(a/(i-1))*1e4)/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},Zd=2e4;function Px(t){let e=0;const s=50;let n=t.next(e);for(;!n.done&&e<Zd;)e+=s,n=t.next(e);return e>=Zd?1/0:e}function jP(t,e=100,s){const n=s({...t,keyframes:[0,e]}),i=Math.min(Px(n),Zd);return{type:"keyframes",ease:a=>n.next(i*a).value/e,duration:Ls(i)}}const TP=5;function J2(t,e,s){const n=Math.max(e-TP,0);return R2(s-t(n),e-n)}const dt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},am=.001;function AP({duration:t=dt.duration,bounce:e=dt.bounce,velocity:s=dt.velocity,mass:n=dt.mass}){let i,a,l=1-e;l=Xn(dt.minDamping,dt.maxDamping,l),t=Xn(dt.minDuration,dt.maxDuration,Ls(t)),l<1?(i=u=>{const d=u*l,f=d*t,h=d-s,m=W0(u,l),v=Math.exp(-f);return am-h/m*v},a=u=>{const f=u*l*t,h=f*s+s,m=Math.pow(l,2)*Math.pow(u,2)*t,v=Math.exp(-f),x=W0(Math.pow(u,2),l);return(-i(u)+am>0?-1:1)*((h-m)*v)/x}):(i=u=>{const d=Math.exp(-u*t),f=(u-s)*t+1;return-am+d*f},a=u=>{const d=Math.exp(-u*t),f=(s-u)*(t*t);return d*f});const o=5/t,c=CP(i,a,o);if(t=hn(t),isNaN(c))return{stiffness:dt.stiffness,damping:dt.damping,duration:t};{const u=Math.pow(c,2)*n;return{stiffness:u,damping:l*2*Math.sqrt(n*u),duration:t}}}const RP=12;function CP(t,e,s){let n=s;for(let i=1;i<RP;i++)n=n-t(n)/e(n);return n}function W0(t,e){return t*Math.sqrt(1-e*e)}const IP=["duration","bounce"],OP=["stiffness","damping","mass"];function g1(t,e){return e.some(s=>t[s]!==void 0)}function MP(t){let e={velocity:dt.velocity,stiffness:dt.stiffness,damping:dt.damping,mass:dt.mass,isResolvedFromDuration:!1,...t};if(!g1(t,OP)&&g1(t,IP))if(t.visualDuration){const s=t.visualDuration,n=2*Math.PI/(s*1.2),i=n*n,a=2*Xn(.05,1,1-(t.bounce||0))*Math.sqrt(i);e={...e,mass:dt.mass,stiffness:i,damping:a}}else{const s=AP(t);e={...e,...s,mass:dt.mass},e.isResolvedFromDuration=!0}return e}function ef(t=dt.visualDuration,e=dt.bounce){const s=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:n,restDelta:i}=s;const a=s.keyframes[0],l=s.keyframes[s.keyframes.length-1],o={done:!1,value:a},{stiffness:c,damping:u,mass:d,duration:f,velocity:h,isResolvedFromDuration:m}=MP({...s,velocity:-Ls(s.velocity||0)}),v=h||0,x=u/(2*Math.sqrt(c*d)),b=l-a,g=Ls(Math.sqrt(c/d)),p=Math.abs(b)<5;n||(n=p?dt.restSpeed.granular:dt.restSpeed.default),i||(i=p?dt.restDelta.granular:dt.restDelta.default);let y;if(x<1){const N=W0(g,x);y=S=>{const w=Math.exp(-x*g*S);return l-w*((v+x*g*b)/N*Math.sin(N*S)+b*Math.cos(N*S))}}else if(x===1)y=N=>l-Math.exp(-g*N)*(b+(v+g*b)*N);else{const N=g*Math.sqrt(x*x-1);y=S=>{const w=Math.exp(-x*g*S),E=Math.min(N*S,300);return l-w*((v+x*g*b)*Math.sinh(E)+N*b*Math.cosh(E))/N}}const k={calculatedDuration:m&&f||null,next:N=>{const S=y(N);if(m)o.done=N>=f;else{let w=N===0?v:0;x<1&&(w=N===0?hn(v):J2(y,N,S));const E=Math.abs(w)<=n,j=Math.abs(l-S)<=i;o.done=E&&j}return o.value=o.done?l:S,o},toString:()=>{const N=Math.min(Px(k),Zd),S=Q2(w=>k.next(N*w).value,N,30);return N+"ms "+S},toTransition:()=>{}};return k}ef.applyToOptions=t=>{const e=jP(t,100,ef);return t.ease=e.ease,t.duration=hn(e.duration),t.type="keyframes",t};function q0({keyframes:t,velocity:e=0,power:s=.8,timeConstant:n=325,bounceDamping:i=10,bounceStiffness:a=500,modifyTarget:l,min:o,max:c,restDelta:u=.5,restSpeed:d}){const f=t[0],h={done:!1,value:f},m=E=>o!==void 0&&E<o||c!==void 0&&E>c,v=E=>o===void 0?c:c===void 0||Math.abs(o-E)<Math.abs(c-E)?o:c;let x=s*e;const b=f+x,g=l===void 0?b:l(b);g!==b&&(x=g-f);const p=E=>-x*Math.exp(-E/n),y=E=>g+p(E),k=E=>{const j=p(E),A=y(E);h.done=Math.abs(j)<=u,h.value=h.done?g:A};let N,S;const w=E=>{m(h.value)&&(N=E,S=ef({keyframes:[h.value,v(h.value)],velocity:J2(y,E,h.value),damping:i,stiffness:a,restDelta:u,restSpeed:d}))};return w(0),{calculatedDuration:null,next:E=>{let j=!1;return!S&&N===void 0&&(j=!0,k(E),w(E)),N!==void 0&&E>=N?S.next(E-N):(!j&&k(E),h)}}}function DP(t,e,s){const n=[],i=s||Qn.mix||X2,a=t.length-1;for(let l=0;l<a;l++){let o=i(t[l],t[l+1]);if(e){const c=Array.isArray(e)?e[l]||$s:e;o=Fc(c,o)}n.push(o)}return n}function LP(t,e,{clamp:s=!0,ease:n,mixer:i}={}){const a=t.length;if(Tx(a===e.length),a===1)return()=>e[0];if(a===2&&e[0]===e[1])return()=>e[1];const l=t[0]===t[1];t[0]>t[a-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=DP(e,n,i),c=o.length,u=d=>{if(l&&d<t[0])return e[0];let f=0;if(c>1)for(;f<t.length-2&&!(d<t[f+1]);f++);const h=lc(t[f],t[f+1],d);return o[f](h)};return s?d=>u(Xn(t[0],t[a-1],d)):u}function PP(t,e){const s=t[t.length-1];for(let n=1;n<=e;n++){const i=lc(0,e,n);t.push(ot(s,1,i))}}function BP(t){const e=[0];return PP(e,t.length-1),e}function UP(t,e){return t.map(s=>s*e)}function HP(t,e){return t.map(()=>e||U2).splice(0,t.length-1)}function To({duration:t=300,keyframes:e,times:s,ease:n="easeInOut"}){const i=Q6(n)?n.map(d1):d1(n),a={done:!1,value:e[0]},l=UP(s&&s.length===e.length?s:BP(e),t),o=LP(l,e,{ease:Array.isArray(i)?i:HP(e,i)});return{calculatedDuration:t,next:c=>(a.value=o(c),a.done=c>=t,a)}}const $P=t=>t!==null;function Bx(t,{repeat:e,repeatType:s="loop"},n,i=1){const a=t.filter($P),o=i<0||e&&s!=="loop"&&e%2===1?0:a.length-1;return!o||n===void 0?a[o]:n}const GP={decay:q0,inertia:q0,tween:To,keyframes:To,spring:ef};function Z2(t){typeof t.type=="string"&&(t.type=GP[t.type])}class Ux{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,s){return this.finished.then(e,s)}}const FP=t=>t/100;class Hx extends Ux{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var n,i;const{motionValue:s}=this.options;s&&s.updatedAt!==ls.now()&&this.tick(ls.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(i=(n=this.options).onStop)==null||i.call(n))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;Z2(e);const{type:s=To,repeat:n=0,repeatDelay:i=0,repeatType:a,velocity:l=0}=e;let{keyframes:o}=e;const c=s||To;c!==To&&typeof o[0]!="number"&&(this.mixKeyframes=Fc(FP,X2(o[0],o[1])),o=[0,100]);const u=c({...e,keyframes:o});a==="mirror"&&(this.mirroredGenerator=c({...e,keyframes:[...o].reverse(),velocity:-l})),u.calculatedDuration===null&&(u.calculatedDuration=Px(u));const{calculatedDuration:d}=u;this.calculatedDuration=d,this.resolvedDuration=d+i,this.totalDuration=this.resolvedDuration*(n+1)-i,this.generator=u}updateTime(e){const s=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=s}tick(e,s=!1){const{generator:n,totalDuration:i,mixKeyframes:a,mirroredGenerator:l,resolvedDuration:o,calculatedDuration:c}=this;if(this.startTime===null)return n.next(0);const{delay:u=0,keyframes:d,repeat:f,repeatType:h,repeatDelay:m,type:v,onUpdate:x,finalKeyframe:b}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-i/this.speed,this.startTime)),s?this.currentTime=e:this.updateTime(e);const g=this.currentTime-u*(this.playbackSpeed>=0?1:-1),p=this.playbackSpeed>=0?g<0:g>i;this.currentTime=Math.max(g,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let y=this.currentTime,k=n;if(f){const E=Math.min(this.currentTime,i)/o;let j=Math.floor(E),A=E%1;!A&&E>=1&&(A=1),A===1&&j--,j=Math.min(j,f+1),!!(j%2)&&(h==="reverse"?(A=1-A,m&&(A-=m/o)):h==="mirror"&&(k=l)),y=Xn(0,1,A)*o}const N=p?{done:!1,value:d[0]}:k.next(y);a&&(N.value=a(N.value));let{done:S}=N;!p&&c!==null&&(S=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const w=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&S);return w&&v!==q0&&(N.value=Bx(d,this.options,b,this.speed)),x&&x(N.value),w&&this.finish(),N}then(e,s){return this.finished.then(e,s)}get duration(){return Ls(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Ls(e)}get time(){return Ls(this.currentTime)}set time(e){var s;e=hn(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(s=this.driver)==null||s.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(ls.now());const s=this.playbackSpeed!==e;this.playbackSpeed=e,s&&(this.time=Ls(this.currentTime))}play(){var i,a;if(this.isStopped)return;const{driver:e=EP,startTime:s}=this.options;this.driver||(this.driver=e(l=>this.tick(l))),(a=(i=this.options).onPlay)==null||a.call(i);const n=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=n):this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime||(this.startTime=s??n),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(ls.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,s;this.notifyFinished(),this.teardown(),this.state="finished",(s=(e=this.options).onComplete)==null||s.call(e)}cancel(){var e,s;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(s=(e=this.options).onCancel)==null||s.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var s;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(s=this.driver)==null||s.stop(),e.observe(this)}}function VP(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const wa=t=>t*180/Math.PI,X0=t=>{const e=wa(Math.atan2(t[1],t[0]));return Q0(e)},zP={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:X0,rotateZ:X0,skewX:t=>wa(Math.atan(t[1])),skewY:t=>wa(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},Q0=t=>(t=t%360,t<0&&(t+=360),t),x1=X0,b1=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),v1=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),KP={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:b1,scaleY:v1,scale:t=>(b1(t)+v1(t))/2,rotateX:t=>Q0(wa(Math.atan2(t[6],t[5]))),rotateY:t=>Q0(wa(Math.atan2(-t[2],t[0]))),rotateZ:x1,rotate:x1,skewX:t=>wa(Math.atan(t[4])),skewY:t=>wa(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function J0(t){return t.includes("scale")?1:0}function Z0(t,e){if(!t||t==="none")return J0(e);const s=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,i;if(s)n=KP,i=s;else{const o=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=zP,i=o}if(!i)return J0(e);const a=n[e],l=i[1].split(",").map(WP);return typeof a=="function"?a(l):l[a]}const YP=(t,e)=>{const{transform:s="none"}=getComputedStyle(t);return Z0(s,e)};function WP(t){return parseFloat(t.trim())}const Il=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Ol=new Set(Il),y1=t=>t===Cl||t===oe,qP=new Set(["x","y","z"]),XP=Il.filter(t=>!qP.has(t));function QP(t){const e=[];return XP.forEach(s=>{const n=t.getValue(s);n!==void 0&&(e.push([s,n.get()]),n.set(s.startsWith("scale")?1:0))}),e}const Aa={width:({x:t},{paddingLeft:e="0",paddingRight:s="0"})=>t.max-t.min-parseFloat(e)-parseFloat(s),height:({y:t},{paddingTop:e="0",paddingBottom:s="0"})=>t.max-t.min-parseFloat(e)-parseFloat(s),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>Z0(e,"x"),y:(t,{transform:e})=>Z0(e,"y")};Aa.translateX=Aa.x;Aa.translateY=Aa.y;const Ra=new Set;let ep=!1,tp=!1,sp=!1;function e5(){if(tp){const t=Array.from(Ra).filter(n=>n.needsMeasurement),e=new Set(t.map(n=>n.element)),s=new Map;e.forEach(n=>{const i=QP(n);i.length&&(s.set(n,i),n.render())}),t.forEach(n=>n.measureInitialState()),e.forEach(n=>{n.render();const i=s.get(n);i&&i.forEach(([a,l])=>{var o;(o=n.getValue(a))==null||o.set(l)})}),t.forEach(n=>n.measureEndState()),t.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}tp=!1,ep=!1,Ra.forEach(t=>t.complete(sp)),Ra.clear()}function t5(){Ra.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(tp=!0)})}function JP(){sp=!0,t5(),e5(),sp=!1}class $x{constructor(e,s,n,i,a,l=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=s,this.name=n,this.motionValue=i,this.element=a,this.isAsync=l}scheduleResolve(){this.state="scheduled",this.isAsync?(Ra.add(this),ep||(ep=!0,it.read(t5),it.resolveKeyframes(e5))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:s,element:n,motionValue:i}=this;if(e[0]===null){const a=i==null?void 0:i.get(),l=e[e.length-1];if(a!==void 0)e[0]=a;else if(n&&s){const o=n.readValue(s,l);o!=null&&(e[0]=o)}e[0]===void 0&&(e[0]=l),i&&a===void 0&&i.set(e[0])}VP(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),Ra.delete(this)}cancel(){this.state==="scheduled"&&(Ra.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const ZP=t=>t.startsWith("--");function e8(t,e,s){ZP(e)?t.style.setProperty(e,s):t.style[e]=s}const t8=Ax(()=>window.ScrollTimeline!==void 0),s8={};function n8(t,e){const s=Ax(t);return()=>s8[e]??s()}const s5=n8(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),no=([t,e,s,n])=>`cubic-bezier(${t}, ${e}, ${s}, ${n})`,_1={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:no([0,.65,.55,1]),circOut:no([.55,0,1,.45]),backIn:no([.31,.01,.66,-.59]),backOut:no([.33,1.53,.69,.99])};function n5(t,e){if(t)return typeof t=="function"?s5()?Q2(t,e):"ease-out":H2(t)?no(t):Array.isArray(t)?t.map(s=>n5(s,e)||_1.easeOut):_1[t]}function i8(t,e,s,{delay:n=0,duration:i=300,repeat:a=0,repeatType:l="loop",ease:o="easeOut",times:c}={},u=void 0){const d={[e]:s};c&&(d.offset=c);const f=n5(o,i);Array.isArray(f)&&(d.easing=f);const h={delay:n,duration:i,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:a+1,direction:l==="reverse"?"alternate":"normal"};return u&&(h.pseudoElement=u),t.animate(d,h)}function i5(t){return typeof t=="function"&&"applyToOptions"in t}function a8({type:t,...e}){return i5(t)&&s5()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class r8 extends Ux{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:s,name:n,keyframes:i,pseudoElement:a,allowFlatten:l=!1,finalKeyframe:o,onComplete:c}=e;this.isPseudoElement=!!a,this.allowFlatten=l,this.options=e,Tx(typeof e.type!="string");const u=a8(e);this.animation=i8(s,n,i,u,a),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const d=Bx(i,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(d):e8(s,n,d),this.animation.cancel()}c==null||c(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,s;(s=(e=this.animation).finish)==null||s.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,s;this.isPseudoElement||(s=(e=this.animation).commitStyles)==null||s.call(e)}get duration(){var s,n;const e=((n=(s=this.animation.effect)==null?void 0:s.getComputedTiming)==null?void 0:n.call(s).duration)||0;return Ls(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Ls(e)}get time(){return Ls(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=hn(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:s}){var n;return this.allowFlatten&&((n=this.animation.effect)==null||n.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&t8()?(this.animation.timeline=e,$s):s(this)}}const a5={anticipate:L2,backInOut:D2,circInOut:B2};function l8(t){return t in a5}function o8(t){typeof t.ease=="string"&&l8(t.ease)&&(t.ease=a5[t.ease])}const w1=10;class c8 extends r8{constructor(e){o8(e),Z2(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:s,onUpdate:n,onComplete:i,element:a,...l}=this.options;if(!s)return;if(e!==void 0){s.set(e);return}const o=new Hx({...l,autoplay:!1}),c=hn(this.finishedTime??this.time);s.setWithVelocity(o.sample(c-w1).value,o.sample(c).value,w1),o.stop()}}const k1=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(ea.test(t)||t==="0")&&!t.startsWith("url("));function u8(t){const e=t[0];if(t.length===1)return!0;for(let s=0;s<t.length;s++)if(t[s]!==e)return!0}function d8(t,e,s,n){const i=t[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const a=t[t.length-1],l=k1(i,e),o=k1(a,e);return!l||!o?!1:u8(t)||(s==="spring"||i5(s))&&n}function np(t){t.duration=0,t.type="keyframes"}const f8=new Set(["opacity","clipPath","filter","transform"]),h8=Ax(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function m8(t){var d;const{motionValue:e,name:s,repeatDelay:n,repeatType:i,damping:a,type:l}=t;if(!(((d=e==null?void 0:e.owner)==null?void 0:d.current)instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:u}=e.owner.getProps();return h8()&&s&&f8.has(s)&&(s!=="transform"||!u)&&!c&&!n&&i!=="mirror"&&a!==0&&l!=="inertia"}const p8=40;class g8 extends Ux{constructor({autoplay:e=!0,delay:s=0,type:n="keyframes",repeat:i=0,repeatDelay:a=0,repeatType:l="loop",keyframes:o,name:c,motionValue:u,element:d,...f}){var v;super(),this.stop=()=>{var x,b;this._animation&&(this._animation.stop(),(x=this.stopTimeline)==null||x.call(this)),(b=this.keyframeResolver)==null||b.cancel()},this.createdAt=ls.now();const h={autoplay:e,delay:s,type:n,repeat:i,repeatDelay:a,repeatType:l,name:c,motionValue:u,element:d,...f},m=(d==null?void 0:d.KeyframeResolver)||$x;this.keyframeResolver=new m(o,(x,b,g)=>this.onKeyframesResolved(x,b,h,!g),c,u,d),(v=this.keyframeResolver)==null||v.scheduleResolve()}onKeyframesResolved(e,s,n,i){this.keyframeResolver=void 0;const{name:a,type:l,velocity:o,delay:c,isHandoff:u,onUpdate:d}=n;this.resolvedAt=ls.now(),d8(e,a,l,o)||((Qn.instantAnimations||!c)&&(d==null||d(Bx(e,n,s))),e[0]=e[e.length-1],np(n),n.repeat=0);const h={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>p8?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:s,...n,keyframes:e},m=!u&&m8(h)?new c8({...h,element:h.motionValue.owner.current}):new Hx(h);m.finished.then(()=>this.notifyFinished()).catch($s),this.pendingTimeline&&(this.stopTimeline=m.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=m}get finished(){return this._animation?this.animation.finished:this._finished}then(e,s){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),JP()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}const x8=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function b8(t){const e=x8.exec(t);if(!e)return[,];const[,s,n,i]=e;return[`--${s??n}`,i]}function r5(t,e,s=1){const[n,i]=b8(t);if(!n)return;const a=window.getComputedStyle(e).getPropertyValue(n);if(a){const l=a.trim();return j2(l)?parseFloat(l):l}return Ox(i)?r5(i,e,s+1):i}function Gx(t,e){return(t==null?void 0:t[e])??(t==null?void 0:t.default)??t}const l5=new Set(["width","height","top","left","right","bottom",...Il]),v8={test:t=>t==="auto",parse:t=>t},o5=t=>e=>e.test(t),c5=[Cl,oe,mn,ai,uP,cP,v8],N1=t=>c5.find(o5(t));function y8(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||A2(t):!0}const _8=new Set(["brightness","contrast","saturate","opacity"]);function w8(t){const[e,s]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[n]=s.match(Mx)||[];if(!n)return t;const i=s.replace(n,"");let a=_8.has(e)?1:0;return n!==s&&(a*=100),e+"("+a+i+")"}const k8=/\b([a-z-]*)\(.*?\)/gu,ip={...ea,getAnimatableNone:t=>{const e=t.match(k8);return e?e.map(w8).join(" "):t}},S1={...Cl,transform:Math.round},N8={rotate:ai,rotateX:ai,rotateY:ai,rotateZ:ai,scale:vu,scaleX:vu,scaleY:vu,scaleZ:vu,skew:ai,skewX:ai,skewY:ai,distance:oe,translateX:oe,translateY:oe,translateZ:oe,x:oe,y:oe,z:oe,perspective:oe,transformPerspective:oe,opacity:oc,originX:f1,originY:f1,originZ:oe},Fx={borderWidth:oe,borderTopWidth:oe,borderRightWidth:oe,borderBottomWidth:oe,borderLeftWidth:oe,borderRadius:oe,radius:oe,borderTopLeftRadius:oe,borderTopRightRadius:oe,borderBottomRightRadius:oe,borderBottomLeftRadius:oe,width:oe,maxWidth:oe,height:oe,maxHeight:oe,top:oe,right:oe,bottom:oe,left:oe,padding:oe,paddingTop:oe,paddingRight:oe,paddingBottom:oe,paddingLeft:oe,margin:oe,marginTop:oe,marginRight:oe,marginBottom:oe,marginLeft:oe,backgroundPositionX:oe,backgroundPositionY:oe,...N8,zIndex:S1,fillOpacity:oc,strokeOpacity:oc,numOctaves:S1},S8={...Fx,color:xt,backgroundColor:xt,outlineColor:xt,fill:xt,stroke:xt,borderColor:xt,borderTopColor:xt,borderRightColor:xt,borderBottomColor:xt,borderLeftColor:xt,filter:ip,WebkitFilter:ip},u5=t=>S8[t];function d5(t,e){let s=u5(t);return s!==ip&&(s=ea),s.getAnimatableNone?s.getAnimatableNone(e):void 0}const E8=new Set(["auto","none","0"]);function j8(t,e,s){let n=0,i;for(;n<t.length&&!i;){const a=t[n];typeof a=="string"&&!E8.has(a)&&cc(a).values.length&&(i=t[n]),n++}if(i&&s)for(const a of e)t[a]=d5(s,i)}class T8 extends $x{constructor(e,s,n,i,a){super(e,s,n,i,a,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:s,name:n}=this;if(!s||!s.current)return;super.readKeyframes();for(let c=0;c<e.length;c++){let u=e[c];if(typeof u=="string"&&(u=u.trim(),Ox(u))){const d=r5(u,s.current);d!==void 0&&(e[c]=d),c===e.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!l5.has(n)||e.length!==2)return;const[i,a]=e,l=N1(i),o=N1(a);if(l!==o)if(y1(l)&&y1(o))for(let c=0;c<e.length;c++){const u=e[c];typeof u=="string"&&(e[c]=parseFloat(u))}else Aa[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:s}=this,n=[];for(let i=0;i<e.length;i++)(e[i]===null||y8(e[i]))&&n.push(i);n.length&&j8(e,n,s)}measureInitialState(){const{element:e,unresolvedKeyframes:s,name:n}=this;if(!e||!e.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Aa[n](e.measureViewportBox(),window.getComputedStyle(e.current)),s[0]=this.measuredOrigin;const i=s[s.length-1];i!==void 0&&e.getValue(n,i).jump(i,!1)}measureEndState(){var o;const{element:e,name:s,unresolvedKeyframes:n}=this;if(!e||!e.current)return;const i=e.getValue(s);i&&i.jump(this.measuredOrigin,!1);const a=n.length-1,l=n[a];n[a]=Aa[s](e.measureViewportBox(),window.getComputedStyle(e.current)),l!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=l),(o=this.removedTransforms)!=null&&o.length&&this.removedTransforms.forEach(([c,u])=>{e.getValue(c).set(u)}),this.resolveNoneKeyframes()}}function A8(t,e,s){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let n=document;const i=(s==null?void 0:s[t])??n.querySelectorAll(t);return i?Array.from(i):[]}return Array.from(t)}const f5=(t,e)=>e&&typeof t=="number"?e.transform(t):t;function h5(t){return T2(t)&&"offsetHeight"in t}const E1=30,R8=t=>!isNaN(parseFloat(t));class C8{constructor(e,s={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=n=>{var a;const i=ls.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&((a=this.events.change)==null||a.notify(this.current),this.dependents))for(const l of this.dependents)l.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=s.owner}setCurrent(e){this.current=e,this.updatedAt=ls.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=R8(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,s){this.events[e]||(this.events[e]=new Rx);const n=this.events[e].add(s);return e==="change"?()=>{n(),it.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,s){this.passiveEffect=e,this.stopPassiveEffect=s}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,s,n){this.set(s),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,s=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,s&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=ls.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>E1)return 0;const s=Math.min(this.updatedAt-this.prevUpdatedAt,E1);return R2(parseFloat(this.current)-parseFloat(this.prevFrameValue),s)}start(e){return this.stop(),new Promise(s=>{this.hasAnimated=!0,this.animation=e(s),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,s;(e=this.dependents)==null||e.clear(),(s=this.events.destroy)==null||s.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function cl(t,e){return new C8(t,e)}const{schedule:Vx}=$2(queueMicrotask,!1),Ks={x:!1,y:!1};function m5(){return Ks.x||Ks.y}function I8(t){return t==="x"||t==="y"?Ks[t]?null:(Ks[t]=!0,()=>{Ks[t]=!1}):Ks.x||Ks.y?null:(Ks.x=Ks.y=!0,()=>{Ks.x=Ks.y=!1})}function p5(t,e){const s=A8(t),n=new AbortController,i={passive:!0,...e,signal:n.signal};return[s,i,()=>n.abort()]}function j1(t){return!(t.pointerType==="touch"||m5())}function O8(t,e,s={}){const[n,i,a]=p5(t,s),l=o=>{if(!j1(o))return;const{target:c}=o,u=e(c,o);if(typeof u!="function"||!c)return;const d=f=>{j1(f)&&(u(f),c.removeEventListener("pointerleave",d))};c.addEventListener("pointerleave",d,i)};return n.forEach(o=>{o.addEventListener("pointerenter",l,i)}),a}const g5=(t,e)=>e?t===e?!0:g5(t,e.parentElement):!1,zx=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,M8=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function D8(t){return M8.has(t.tagName)||t.tabIndex!==-1}const Yu=new WeakSet;function T1(t){return e=>{e.key==="Enter"&&t(e)}}function rm(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const L8=(t,e)=>{const s=t.currentTarget;if(!s)return;const n=T1(()=>{if(Yu.has(s))return;rm(s,"down");const i=T1(()=>{rm(s,"up")}),a=()=>rm(s,"cancel");s.addEventListener("keyup",i,e),s.addEventListener("blur",a,e)});s.addEventListener("keydown",n,e),s.addEventListener("blur",()=>s.removeEventListener("keydown",n),e)};function A1(t){return zx(t)&&!m5()}function P8(t,e,s={}){const[n,i,a]=p5(t,s),l=o=>{const c=o.currentTarget;if(!A1(o))return;Yu.add(c);const u=e(c,o),d=(m,v)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",h),Yu.has(c)&&Yu.delete(c),A1(m)&&typeof u=="function"&&u(m,{success:v})},f=m=>{d(m,c===window||c===document||s.useGlobalTarget||g5(c,m.target))},h=m=>{d(m,!1)};window.addEventListener("pointerup",f,i),window.addEventListener("pointercancel",h,i)};return n.forEach(o=>{(s.useGlobalTarget?window:o).addEventListener("pointerdown",l,i),h5(o)&&(o.addEventListener("focus",u=>L8(u,i)),!D8(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),a}function x5(t){return T2(t)&&"ownerSVGElement"in t}function B8(t){return x5(t)&&t.tagName==="svg"}const Kt=t=>!!(t&&t.getVelocity),U8=[...c5,xt,ea],H8=t=>U8.find(o5(t)),Kx=_.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function R1(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function $8(...t){return e=>{let s=!1;const n=t.map(i=>{const a=R1(i,e);return!s&&typeof a=="function"&&(s=!0),a});if(s)return()=>{for(let i=0;i<n.length;i++){const a=n[i];typeof a=="function"?a():R1(t[i],null)}}}}function G8(...t){return _.useCallback($8(...t),t)}class F8 extends _.Component{getSnapshotBeforeUpdate(e){const s=this.props.childRef.current;if(s&&e.isPresent&&!this.props.isPresent){const n=s.offsetParent,i=h5(n)&&n.offsetWidth||0,a=this.props.sizeRef.current;a.height=s.offsetHeight||0,a.width=s.offsetWidth||0,a.top=s.offsetTop,a.left=s.offsetLeft,a.right=i-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function V8({children:t,isPresent:e,anchorX:s,root:n}){const i=_.useId(),a=_.useRef(null),l=_.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=_.useContext(Kx),c=G8(a,t==null?void 0:t.ref);return _.useInsertionEffect(()=>{const{width:u,height:d,top:f,left:h,right:m}=l.current;if(e||!a.current||!u||!d)return;const v=s==="left"?`left: ${h}`:`right: ${m}`;a.current.dataset.motionPopId=i;const x=document.createElement("style");o&&(x.nonce=o);const b=n??document.head;return b.appendChild(x),x.sheet&&x.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${u}px !important;
            height: ${d}px !important;
            ${v}px !important;
            top: ${f}px !important;
          }
        `),()=>{b.contains(x)&&b.removeChild(x)}},[e]),r.jsx(F8,{isPresent:e,childRef:a,sizeRef:l,children:_.cloneElement(t,{ref:c})})}const z8=({children:t,initial:e,isPresent:s,onExitComplete:n,custom:i,presenceAffectsLayout:a,mode:l,anchorX:o,root:c})=>{const u=Nx(K8),d=_.useId();let f=!0,h=_.useMemo(()=>(f=!1,{id:d,initial:e,isPresent:s,custom:i,onExitComplete:m=>{u.set(m,!0);for(const v of u.values())if(!v)return;n&&n()},register:m=>(u.set(m,!1),()=>u.delete(m))}),[s,u,n]);return a&&f&&(h={...h}),_.useMemo(()=>{u.forEach((m,v)=>u.set(v,!1))},[s]),_.useEffect(()=>{!s&&!u.size&&n&&n()},[s]),l==="popLayout"&&(t=r.jsx(V8,{isPresent:s,anchorX:o,root:c,children:t})),r.jsx(Xf.Provider,{value:h,children:t})};function K8(){return new Map}function b5(t=!0){const e=_.useContext(Xf);if(e===null)return[!0,null];const{isPresent:s,onExitComplete:n,register:i}=e,a=_.useId();_.useEffect(()=>{if(t)return i(a)},[t]);const l=_.useCallback(()=>t&&n&&n(a),[a,n,t]);return!s&&n?[!1,l]:[!0]}const yu=t=>t.key||"";function C1(t){const e=[];return _.Children.forEach(t,s=>{_.isValidElement(s)&&e.push(s)}),e}const kt=({children:t,custom:e,initial:s=!0,onExitComplete:n,presenceAffectsLayout:i=!0,mode:a="sync",propagate:l=!1,anchorX:o="left",root:c})=>{const[u,d]=b5(l),f=_.useMemo(()=>C1(t),[t]),h=l&&!u?[]:f.map(yu),m=_.useRef(!0),v=_.useRef(f),x=Nx(()=>new Map),[b,g]=_.useState(f),[p,y]=_.useState(f);E2(()=>{m.current=!1,v.current=f;for(let S=0;S<p.length;S++){const w=yu(p[S]);h.includes(w)?x.delete(w):x.get(w)!==!0&&x.set(w,!1)}},[p,h.length,h.join("-")]);const k=[];if(f!==b){let S=[...f];for(let w=0;w<p.length;w++){const E=p[w],j=yu(E);h.includes(j)||(S.splice(w,0,E),k.push(E))}return a==="wait"&&k.length&&(S=k),y(C1(S)),g(f),null}const{forceRender:N}=_.useContext(kx);return r.jsx(r.Fragment,{children:p.map(S=>{const w=yu(S),E=l&&!u?!1:f===p||h.includes(w),j=()=>{if(x.has(w))x.set(w,!0);else return;let A=!0;x.forEach(O=>{O||(A=!1)}),A&&(N==null||N(),y(v.current),l&&(d==null||d()),n&&n())};return r.jsx(z8,{isPresent:E,initial:!m.current||s?void 0:!1,custom:e,presenceAffectsLayout:i,mode:a,root:c,onExitComplete:E?void 0:j,anchorX:o,children:S},w)})})},v5=_.createContext({strict:!1}),I1={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},ul={};for(const t in I1)ul[t]={isEnabled:e=>I1[t].some(s=>!!e[s])};function Y8(t){for(const e in t)ul[e]={...ul[e],...t[e]}}const W8=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function tf(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||W8.has(t)}let y5=t=>!tf(t);function q8(t){typeof t=="function"&&(y5=e=>e.startsWith("on")?!tf(e):t(e))}try{q8(require("@emotion/is-prop-valid").default)}catch{}function X8(t,e,s){const n={};for(const i in t)i==="values"&&typeof t.values=="object"||(y5(i)||s===!0&&tf(i)||!e&&!tf(i)||t.draggable&&i.startsWith("onDrag"))&&(n[i]=t[i]);return n}const Qf=_.createContext({});function Jf(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function uc(t){return typeof t=="string"||Array.isArray(t)}const Yx=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Wx=["initial",...Yx];function Zf(t){return Jf(t.animate)||Wx.some(e=>uc(t[e]))}function _5(t){return!!(Zf(t)||t.variants)}function Q8(t,e){if(Zf(t)){const{initial:s,animate:n}=t;return{initial:s===!1||uc(s)?s:void 0,animate:uc(n)?n:void 0}}return t.inherit!==!1?e:{}}function J8(t){const{initial:e,animate:s}=Q8(t,_.useContext(Qf));return _.useMemo(()=>({initial:e,animate:s}),[O1(e),O1(s)])}function O1(t){return Array.isArray(t)?t.join(" "):t}function M1(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Wl={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(oe.test(t))t=parseFloat(t);else return t;const s=M1(t,e.target.x),n=M1(t,e.target.y);return`${s}% ${n}%`}},Z8={correct:(t,{treeScale:e,projectionDelta:s})=>{const n=t,i=ea.parse(t);if(i.length>5)return n;const a=ea.createTransformer(t),l=typeof i[0]!="number"?1:0,o=s.x.scale*e.x,c=s.y.scale*e.y;i[0+l]/=o,i[1+l]/=c;const u=ot(o,c,.5);return typeof i[2+l]=="number"&&(i[2+l]/=u),typeof i[3+l]=="number"&&(i[3+l]/=u),a(i)}},ap={borderRadius:{...Wl,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Wl,borderTopRightRadius:Wl,borderBottomLeftRadius:Wl,borderBottomRightRadius:Wl,boxShadow:Z8};function w5(t,{layout:e,layoutId:s}){return Ol.has(t)||t.startsWith("origin")||(e||s!==void 0)&&(!!ap[t]||t==="opacity")}const eB={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},tB=Il.length;function sB(t,e,s){let n="",i=!0;for(let a=0;a<tB;a++){const l=Il[a],o=t[l];if(o===void 0)continue;let c=!0;if(typeof o=="number"?c=o===(l.startsWith("scale")?1:0):c=parseFloat(o)===0,!c||s){const u=f5(o,Fx[l]);if(!c){i=!1;const d=eB[l]||l;n+=`${d}(${u}) `}s&&(e[l]=u)}}return n=n.trim(),s?n=s(e,i?"":n):i&&(n="none"),n}function qx(t,e,s){const{style:n,vars:i,transformOrigin:a}=t;let l=!1,o=!1;for(const c in e){const u=e[c];if(Ol.has(c)){l=!0;continue}else if(F2(c)){i[c]=u;continue}else{const d=f5(u,Fx[c]);c.startsWith("origin")?(o=!0,a[c]=d):n[c]=d}}if(e.transform||(l||s?n.transform=sB(e,t.transform,s):n.transform&&(n.transform="none")),o){const{originX:c="50%",originY:u="50%",originZ:d=0}=a;n.transformOrigin=`${c} ${u} ${d}`}}const Xx=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function k5(t,e,s){for(const n in e)!Kt(e[n])&&!w5(n,s)&&(t[n]=e[n])}function nB({transformTemplate:t},e){return _.useMemo(()=>{const s=Xx();return qx(s,e,t),Object.assign({},s.vars,s.style)},[e])}function iB(t,e){const s=t.style||{},n={};return k5(n,s,t),Object.assign(n,nB(t,e)),n}function aB(t,e){const s={},n=iB(t,e);return t.drag&&t.dragListener!==!1&&(s.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(s.tabIndex=0),s.style=n,s}const rB={offset:"stroke-dashoffset",array:"stroke-dasharray"},lB={offset:"strokeDashoffset",array:"strokeDasharray"};function oB(t,e,s=1,n=0,i=!0){t.pathLength=1;const a=i?rB:lB;t[a.offset]=oe.transform(-n);const l=oe.transform(e),o=oe.transform(s);t[a.array]=`${l} ${o}`}function N5(t,{attrX:e,attrY:s,attrScale:n,pathLength:i,pathSpacing:a=1,pathOffset:l=0,...o},c,u,d){if(qx(t,o,u),c){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:f,style:h}=t;f.transform&&(h.transform=f.transform,delete f.transform),(h.transform||f.transformOrigin)&&(h.transformOrigin=f.transformOrigin??"50% 50%",delete f.transformOrigin),h.transform&&(h.transformBox=(d==null?void 0:d.transformBox)??"fill-box",delete f.transformBox),e!==void 0&&(f.x=e),s!==void 0&&(f.y=s),n!==void 0&&(f.scale=n),i!==void 0&&oB(f,i,a,l,!1)}const S5=()=>({...Xx(),attrs:{}}),E5=t=>typeof t=="string"&&t.toLowerCase()==="svg";function cB(t,e,s,n){const i=_.useMemo(()=>{const a=S5();return N5(a,e,E5(n),t.transformTemplate,t.style),{...a.attrs,style:{...a.style}}},[e]);if(t.style){const a={};k5(a,t.style,t),i.style={...a,...i.style}}return i}const uB=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Qx(t){return typeof t!="string"||t.includes("-")?!1:!!(uB.indexOf(t)>-1||/[A-Z]/u.test(t))}function dB(t,e,s,{latestValues:n},i,a=!1){const o=(Qx(t)?cB:aB)(e,n,i,t),c=X8(e,typeof t=="string",a),u=t!==_.Fragment?{...c,...o,ref:s}:{},{children:d}=e,f=_.useMemo(()=>Kt(d)?d.get():d,[d]);return _.createElement(t,{...u,children:f})}function D1(t){const e=[{},{}];return t==null||t.values.forEach((s,n)=>{e[0][n]=s.get(),e[1][n]=s.getVelocity()}),e}function Jx(t,e,s,n){if(typeof e=="function"){const[i,a]=D1(n);e=e(s!==void 0?s:t.custom,i,a)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[i,a]=D1(n);e=e(s!==void 0?s:t.custom,i,a)}return e}function Wu(t){return Kt(t)?t.get():t}function fB({scrapeMotionValuesFromProps:t,createRenderState:e},s,n,i){return{latestValues:hB(s,n,i,t),renderState:e()}}function hB(t,e,s,n){const i={},a=n(t,{});for(const h in a)i[h]=Wu(a[h]);let{initial:l,animate:o}=t;const c=Zf(t),u=_5(t);e&&u&&!c&&t.inherit!==!1&&(l===void 0&&(l=e.initial),o===void 0&&(o=e.animate));let d=s?s.initial===!1:!1;d=d||l===!1;const f=d?o:l;if(f&&typeof f!="boolean"&&!Jf(f)){const h=Array.isArray(f)?f:[f];for(let m=0;m<h.length;m++){const v=Jx(t,h[m]);if(v){const{transitionEnd:x,transition:b,...g}=v;for(const p in g){let y=g[p];if(Array.isArray(y)){const k=d?y.length-1:0;y=y[k]}y!==null&&(i[p]=y)}for(const p in x)i[p]=x[p]}}}return i}const j5=t=>(e,s)=>{const n=_.useContext(Qf),i=_.useContext(Xf),a=()=>fB(t,e,n,i);return s?a():Nx(a)};function Zx(t,e,s){var a;const{style:n}=t,i={};for(const l in n)(Kt(n[l])||e.style&&Kt(e.style[l])||w5(l,t)||((a=s==null?void 0:s.getValue(l))==null?void 0:a.liveStyle)!==void 0)&&(i[l]=n[l]);return i}const mB=j5({scrapeMotionValuesFromProps:Zx,createRenderState:Xx});function T5(t,e,s){const n=Zx(t,e,s);for(const i in t)if(Kt(t[i])||Kt(e[i])){const a=Il.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;n[a]=t[i]}return n}const pB=j5({scrapeMotionValuesFromProps:T5,createRenderState:S5}),gB=Symbol.for("motionComponentSymbol");function kr(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function xB(t,e,s){return _.useCallback(n=>{n&&t.onMount&&t.onMount(n),e&&(n?e.mount(n):e.unmount()),s&&(typeof s=="function"?s(n):kr(s)&&(s.current=n))},[e])}const eb=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),bB="framerAppearId",A5="data-"+eb(bB),R5=_.createContext({});function vB(t,e,s,n,i){var x,b;const{visualElement:a}=_.useContext(Qf),l=_.useContext(v5),o=_.useContext(Xf),c=_.useContext(Kx).reducedMotion,u=_.useRef(null);n=n||l.renderer,!u.current&&n&&(u.current=n(t,{visualState:e,parent:a,props:s,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:c}));const d=u.current,f=_.useContext(R5);d&&!d.projection&&i&&(d.type==="html"||d.type==="svg")&&yB(u.current,s,i,f);const h=_.useRef(!1);_.useInsertionEffect(()=>{d&&h.current&&d.update(s,o)});const m=s[A5],v=_.useRef(!!m&&!((x=window.MotionHandoffIsComplete)!=null&&x.call(window,m))&&((b=window.MotionHasOptimisedAnimation)==null?void 0:b.call(window,m)));return E2(()=>{d&&(h.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),d.scheduleRenderMicrotask(),v.current&&d.animationState&&d.animationState.animateChanges())}),_.useEffect(()=>{d&&(!v.current&&d.animationState&&d.animationState.animateChanges(),v.current&&(queueMicrotask(()=>{var g;(g=window.MotionHandoffMarkAsComplete)==null||g.call(window,m)}),v.current=!1),d.enteringChildren=void 0)}),d}function yB(t,e,s,n){const{layoutId:i,layout:a,drag:l,dragConstraints:o,layoutScroll:c,layoutRoot:u,layoutCrossfade:d}=e;t.projection=new s(t.latestValues,e["data-framer-portal-id"]?void 0:C5(t.parent)),t.projection.setOptions({layoutId:i,layout:a,alwaysMeasureLayout:!!l||o&&kr(o),visualElement:t,animationType:typeof a=="string"?a:"both",initialPromotionConfig:n,crossfade:d,layoutScroll:c,layoutRoot:u})}function C5(t){if(t)return t.options.allowProjection!==!1?t.projection:C5(t.parent)}function lm(t,{forwardMotionProps:e=!1}={},s,n){s&&Y8(s);const i=Qx(t)?pB:mB;function a(o,c){let u;const d={..._.useContext(Kx),...o,layoutId:_B(o)},{isStatic:f}=d,h=J8(o),m=i(o,f);if(!f&&Sx){wB();const v=kB(d);u=v.MeasureLayout,h.visualElement=vB(t,m,d,n,v.ProjectionNode)}return r.jsxs(Qf.Provider,{value:h,children:[u&&h.visualElement?r.jsx(u,{visualElement:h.visualElement,...d}):null,dB(t,o,xB(m,h.visualElement,c),m,f,e)]})}a.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const l=_.forwardRef(a);return l[gB]=t,l}function _B({layoutId:t}){const e=_.useContext(kx).id;return e&&t!==void 0?e+"-"+t:t}function wB(t,e){_.useContext(v5).strict}function kB(t){const{drag:e,layout:s}=ul;if(!e&&!s)return{};const n={...e,...s};return{MeasureLayout:e!=null&&e.isEnabled(t)||s!=null&&s.isEnabled(t)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}function NB(t,e){if(typeof Proxy>"u")return lm;const s=new Map,n=(a,l)=>lm(a,l,t,e),i=(a,l)=>n(a,l);return new Proxy(i,{get:(a,l)=>l==="create"?n:(s.has(l)||s.set(l,lm(l,void 0,t,e)),s.get(l))})}function I5({top:t,left:e,right:s,bottom:n}){return{x:{min:e,max:s},y:{min:t,max:n}}}function SB({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function EB(t,e){if(!e)return t;const s=e({x:t.left,y:t.top}),n=e({x:t.right,y:t.bottom});return{top:s.y,left:s.x,bottom:n.y,right:n.x}}function om(t){return t===void 0||t===1}function rp({scale:t,scaleX:e,scaleY:s}){return!om(t)||!om(e)||!om(s)}function ba(t){return rp(t)||O5(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function O5(t){return L1(t.x)||L1(t.y)}function L1(t){return t&&t!=="0%"}function sf(t,e,s){const n=t-s,i=e*n;return s+i}function P1(t,e,s,n,i){return i!==void 0&&(t=sf(t,i,n)),sf(t,s,n)+e}function lp(t,e=0,s=1,n,i){t.min=P1(t.min,e,s,n,i),t.max=P1(t.max,e,s,n,i)}function M5(t,{x:e,y:s}){lp(t.x,e.translate,e.scale,e.originPoint),lp(t.y,s.translate,s.scale,s.originPoint)}const B1=.999999999999,U1=1.0000000000001;function jB(t,e,s,n=!1){const i=s.length;if(!i)return;e.x=e.y=1;let a,l;for(let o=0;o<i;o++){a=s[o],l=a.projectionDelta;const{visualElement:c}=a.options;c&&c.props.style&&c.props.style.display==="contents"||(n&&a.options.layoutScroll&&a.scroll&&a!==a.root&&Sr(t,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),l&&(e.x*=l.x.scale,e.y*=l.y.scale,M5(t,l)),n&&ba(a.latestValues)&&Sr(t,a.latestValues))}e.x<U1&&e.x>B1&&(e.x=1),e.y<U1&&e.y>B1&&(e.y=1)}function Nr(t,e){t.min=t.min+e,t.max=t.max+e}function H1(t,e,s,n,i=.5){const a=ot(t.min,t.max,i);lp(t,e,s,a,n)}function Sr(t,e){H1(t.x,e.x,e.scaleX,e.scale,e.originX),H1(t.y,e.y,e.scaleY,e.scale,e.originY)}function D5(t,e){return I5(EB(t.getBoundingClientRect(),e))}function TB(t,e,s){const n=D5(t,s),{scroll:i}=e;return i&&(Nr(n.x,i.offset.x),Nr(n.y,i.offset.y)),n}const $1=()=>({translate:0,scale:1,origin:0,originPoint:0}),Er=()=>({x:$1(),y:$1()}),G1=()=>({min:0,max:0}),Et=()=>({x:G1(),y:G1()}),op={current:null},L5={current:!1};function AB(){if(L5.current=!0,!!Sx)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>op.current=t.matches;t.addEventListener("change",e),e()}else op.current=!1}const RB=new WeakMap;function CB(t,e,s){for(const n in e){const i=e[n],a=s[n];if(Kt(i))t.addValue(n,i);else if(Kt(a))t.addValue(n,cl(i,{owner:t}));else if(a!==i)if(t.hasValue(n)){const l=t.getValue(n);l.liveStyle===!0?l.jump(i):l.hasAnimated||l.set(i)}else{const l=t.getStaticValue(n);t.addValue(n,cl(l!==void 0?l:i,{owner:t}))}}for(const n in s)e[n]===void 0&&t.removeValue(n);return e}const F1=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class IB{scrapeMotionValuesFromProps(e,s,n){return{}}constructor({parent:e,props:s,presenceContext:n,reducedMotionConfig:i,blockInitialAnimation:a,visualState:l},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=$x,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=ls.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,it.render(this.render,!1,!0))};const{latestValues:c,renderState:u}=l;this.latestValues=c,this.baseTarget={...c},this.initialValues=s.initial?{...c}:{},this.renderState=u,this.parent=e,this.props=s,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=o,this.blockInitialAnimation=!!a,this.isControllingVariants=Zf(s),this.isVariantNode=_5(s),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:d,...f}=this.scrapeMotionValuesFromProps(s,{},this);for(const h in f){const m=f[h];c[h]!==void 0&&Kt(m)&&m.set(c[h])}}mount(e){var s;this.current=e,RB.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,i)=>this.bindToMotionValue(i,n)),L5.current||AB(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:op.current,(s=this.parent)==null||s.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),Zi(this.notifyUpdate),Zi(this.render),this.valueSubscriptions.forEach(s=>s()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(e=this.parent)==null||e.removeChild(this);for(const s in this.events)this.events[s].clear();for(const s in this.features){const n=this.features[s];n&&(n.unmount(),n.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,s){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=Ol.has(e);n&&this.onBindTransform&&this.onBindTransform();const i=s.on("change",l=>{this.latestValues[e]=l,this.props.onUpdate&&it.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,s)),this.valueSubscriptions.set(e,()=>{i(),a&&a(),s.owner&&s.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in ul){const s=ul[e];if(!s)continue;const{isEnabled:n,Feature:i}=s;if(!this.features[e]&&i&&n(this.props)&&(this.features[e]=new i(this)),this.features[e]){const a=this.features[e];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Et()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,s){this.latestValues[e]=s}update(e,s){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=s;for(let n=0;n<F1.length;n++){const i=F1[n];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const a="on"+i,l=e[a];l&&(this.propEventSubscriptions[i]=this.on(i,l))}this.prevMotionValues=CB(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const s=this.getClosestVariantNode();if(s)return s.variantChildren&&s.variantChildren.add(e),()=>s.variantChildren.delete(e)}addValue(e,s){const n=this.values.get(e);s!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,s),this.values.set(e,s),this.latestValues[e]=s.get())}removeValue(e){this.values.delete(e);const s=this.valueSubscriptions.get(e);s&&(s(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,s){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&s!==void 0&&(n=cl(s===null?void 0:s,{owner:this}),this.addValue(e,n)),n}readValue(e,s){let n=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return n!=null&&(typeof n=="string"&&(j2(n)||A2(n))?n=parseFloat(n):!H8(n)&&ea.test(s)&&(n=d5(e,s)),this.setBaseTarget(e,Kt(n)?n.get():n)),Kt(n)?n.get():n}setBaseTarget(e,s){this.baseTarget[e]=s}getBaseTarget(e){var a;const{initial:s}=this.props;let n;if(typeof s=="string"||typeof s=="object"){const l=Jx(this.props,s,(a=this.presenceContext)==null?void 0:a.custom);l&&(n=l[e])}if(s&&n!==void 0)return n;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!Kt(i)?i:this.initialValues[e]!==void 0&&n===void 0?void 0:this.baseTarget[e]}on(e,s){return this.events[e]||(this.events[e]=new Rx),this.events[e].add(s)}notify(e,...s){this.events[e]&&this.events[e].notify(...s)}scheduleRenderMicrotask(){Vx.render(this.render)}}class P5 extends IB{constructor(){super(...arguments),this.KeyframeResolver=T8}sortInstanceNodePosition(e,s){return e.compareDocumentPosition(s)&2?1:-1}getBaseTargetFromProps(e,s){return e.style?e.style[s]:void 0}removeValueFromRenderState(e,{vars:s,style:n}){delete s[e],delete n[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Kt(e)&&(this.childSubscription=e.on("change",s=>{this.current&&(this.current.textContent=`${s}`)}))}}function B5(t,{style:e,vars:s},n,i){const a=t.style;let l;for(l in e)a[l]=e[l];i==null||i.applyProjectionStyles(a,n);for(l in s)a.setProperty(l,s[l])}function OB(t){return window.getComputedStyle(t)}class MB extends P5{constructor(){super(...arguments),this.type="html",this.renderInstance=B5}readValueFromInstance(e,s){var n;if(Ol.has(s))return(n=this.projection)!=null&&n.isProjecting?J0(s):YP(e,s);{const i=OB(e),a=(F2(s)?i.getPropertyValue(s):i[s])||0;return typeof a=="string"?a.trim():a}}measureInstanceViewportBox(e,{transformPagePoint:s}){return D5(e,s)}build(e,s,n){qx(e,s,n.transformTemplate)}scrapeMotionValuesFromProps(e,s,n){return Zx(e,s,n)}}const U5=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function DB(t,e,s,n){B5(t,e,void 0,n);for(const i in e.attrs)t.setAttribute(U5.has(i)?i:eb(i),e.attrs[i])}class LB extends P5{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Et}getBaseTargetFromProps(e,s){return e[s]}readValueFromInstance(e,s){if(Ol.has(s)){const n=u5(s);return n&&n.default||0}return s=U5.has(s)?s:eb(s),e.getAttribute(s)}scrapeMotionValuesFromProps(e,s,n){return T5(e,s,n)}build(e,s,n){N5(e,s,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(e,s,n,i){DB(e,s,n,i)}mount(e){this.isSVGTag=E5(e.tagName),super.mount(e)}}const PB=(t,e)=>Qx(t)?new LB(e):new MB(e,{allowProjection:t!==_.Fragment});function Hr(t,e,s){const n=t.getProps();return Jx(n,e,s!==void 0?s:n.custom,t)}const cp=t=>Array.isArray(t);function BB(t,e,s){t.hasValue(e)?t.getValue(e).set(s):t.addValue(e,cl(s))}function UB(t){return cp(t)?t[t.length-1]||0:t}function HB(t,e){const s=Hr(t,e);let{transitionEnd:n={},transition:i={},...a}=s||{};a={...a,...n};for(const l in a){const o=UB(a[l]);BB(t,l,o)}}function $B(t){return!!(Kt(t)&&t.add)}function up(t,e){const s=t.getValue("willChange");if($B(s))return s.add(e);if(!s&&Qn.WillChange){const n=new Qn.WillChange("auto");t.addValue("willChange",n),n.add(e)}}function H5(t){return t.props[A5]}const GB=t=>t!==null;function FB(t,{repeat:e,repeatType:s="loop"},n){const i=t.filter(GB),a=e&&s!=="loop"&&e%2===1?0:i.length-1;return i[a]}const VB={type:"spring",stiffness:500,damping:25,restSpeed:10},zB=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),KB={type:"keyframes",duration:.8},YB={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},WB=(t,{keyframes:e})=>e.length>2?KB:Ol.has(t)?t.startsWith("scale")?zB(e[1]):VB:YB;function qB({when:t,delay:e,delayChildren:s,staggerChildren:n,staggerDirection:i,repeat:a,repeatType:l,repeatDelay:o,from:c,elapsed:u,...d}){return!!Object.keys(d).length}const tb=(t,e,s,n={},i,a)=>l=>{const o=Gx(n,t)||{},c=o.delay||n.delay||0;let{elapsed:u=0}=n;u=u-hn(c);const d={keyframes:Array.isArray(s)?s:[null,s],ease:"easeOut",velocity:e.getVelocity(),...o,delay:-u,onUpdate:h=>{e.set(h),o.onUpdate&&o.onUpdate(h)},onComplete:()=>{l(),o.onComplete&&o.onComplete()},name:t,motionValue:e,element:a?void 0:i};qB(o)||Object.assign(d,WB(t,d)),d.duration&&(d.duration=hn(d.duration)),d.repeatDelay&&(d.repeatDelay=hn(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let f=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(np(d),d.delay===0&&(f=!0)),(Qn.instantAnimations||Qn.skipAnimations)&&(f=!0,np(d),d.delay=0),d.allowFlatten=!o.type&&!o.ease,f&&!a&&e.get()!==void 0){const h=FB(d.keyframes,o);if(h!==void 0){it.update(()=>{d.onUpdate(h),d.onComplete()});return}}return o.isSync?new Hx(d):new g8(d)};function XB({protectedKeys:t,needsAnimating:e},s){const n=t.hasOwnProperty(s)&&e[s]!==!0;return e[s]=!1,n}function $5(t,e,{delay:s=0,transitionOverride:n,type:i}={}){let{transition:a=t.getDefaultTransition(),transitionEnd:l,...o}=e;n&&(a=n);const c=[],u=i&&t.animationState&&t.animationState.getState()[i];for(const d in o){const f=t.getValue(d,t.latestValues[d]??null),h=o[d];if(h===void 0||u&&XB(u,d))continue;const m={delay:s,...Gx(a||{},d)},v=f.get();if(v!==void 0&&!f.isAnimating&&!Array.isArray(h)&&h===v&&!m.velocity)continue;let x=!1;if(window.MotionHandoffAnimation){const g=H5(t);if(g){const p=window.MotionHandoffAnimation(g,d,it);p!==null&&(m.startTime=p,x=!0)}}up(t,d),f.start(tb(d,f,h,t.shouldReduceMotion&&l5.has(d)?{type:!1}:m,t,x));const b=f.animation;b&&c.push(b)}return l&&Promise.all(c).then(()=>{it.update(()=>{l&&HB(t,l)})}),c}function G5(t,e,s,n=0,i=1){const a=Array.from(t).sort((u,d)=>u.sortNodePosition(d)).indexOf(e),l=t.size,o=(l-1)*n;return typeof s=="function"?s(a,l):i===1?a*n:o-a*n}function dp(t,e,s={}){var c;const n=Hr(t,e,s.type==="exit"?(c=t.presenceContext)==null?void 0:c.custom:void 0);let{transition:i=t.getDefaultTransition()||{}}=n||{};s.transitionOverride&&(i=s.transitionOverride);const a=n?()=>Promise.all($5(t,n,s)):()=>Promise.resolve(),l=t.variantChildren&&t.variantChildren.size?(u=0)=>{const{delayChildren:d=0,staggerChildren:f,staggerDirection:h}=i;return QB(t,e,u,d,f,h,s)}:()=>Promise.resolve(),{when:o}=i;if(o){const[u,d]=o==="beforeChildren"?[a,l]:[l,a];return u().then(()=>d())}else return Promise.all([a(),l(s.delay)])}function QB(t,e,s=0,n=0,i=0,a=1,l){const o=[];for(const c of t.variantChildren)c.notify("AnimationStart",e),o.push(dp(c,e,{...l,delay:s+(typeof n=="function"?0:n)+G5(t.variantChildren,c,n,i,a)}).then(()=>c.notify("AnimationComplete",e)));return Promise.all(o)}function JB(t,e,s={}){t.notify("AnimationStart",e);let n;if(Array.isArray(e)){const i=e.map(a=>dp(t,a,s));n=Promise.all(i)}else if(typeof e=="string")n=dp(t,e,s);else{const i=typeof e=="function"?Hr(t,e,s.custom):e;n=Promise.all($5(t,i,s))}return n.then(()=>{t.notify("AnimationComplete",e)})}function F5(t,e){if(!Array.isArray(e))return!1;const s=e.length;if(s!==t.length)return!1;for(let n=0;n<s;n++)if(e[n]!==t[n])return!1;return!0}const ZB=Wx.length;function V5(t){if(!t)return;if(!t.isControllingVariants){const s=t.parent?V5(t.parent)||{}:{};return t.props.initial!==void 0&&(s.initial=t.props.initial),s}const e={};for(let s=0;s<ZB;s++){const n=Wx[s],i=t.props[n];(uc(i)||i===!1)&&(e[n]=i)}return e}const e9=[...Yx].reverse(),t9=Yx.length;function s9(t){return e=>Promise.all(e.map(({animation:s,options:n})=>JB(t,s,n)))}function n9(t){let e=s9(t),s=V1(),n=!0;const i=c=>(u,d)=>{var h;const f=Hr(t,d,c==="exit"?(h=t.presenceContext)==null?void 0:h.custom:void 0);if(f){const{transition:m,transitionEnd:v,...x}=f;u={...u,...x,...v}}return u};function a(c){e=c(t)}function l(c){const{props:u}=t,d=V5(t.parent)||{},f=[],h=new Set;let m={},v=1/0;for(let b=0;b<t9;b++){const g=e9[b],p=s[g],y=u[g]!==void 0?u[g]:d[g],k=uc(y),N=g===c?p.isActive:null;N===!1&&(v=b);let S=y===d[g]&&y!==u[g]&&k;if(S&&n&&t.manuallyAnimateOnMount&&(S=!1),p.protectedKeys={...m},!p.isActive&&N===null||!y&&!p.prevProp||Jf(y)||typeof y=="boolean")continue;const w=i9(p.prevProp,y);let E=w||g===c&&p.isActive&&!S&&k||b>v&&k,j=!1;const A=Array.isArray(y)?y:[y];let O=A.reduce(i(g),{});N===!1&&(O={});const{prevResolvedValues:L={}}=p,Y={...L,...O},W=U=>{E=!0,h.has(U)&&(j=!0,h.delete(U)),p.needsAnimating[U]=!0;const C=t.getValue(U);C&&(C.liveStyle=!1)};for(const U in Y){const C=O[U],T=L[U];if(m.hasOwnProperty(U))continue;let R=!1;cp(C)&&cp(T)?R=!F5(C,T):R=C!==T,R?C!=null?W(U):h.add(U):C!==void 0&&h.has(U)?W(U):p.protectedKeys[U]=!0}p.prevProp=y,p.prevResolvedValues=O,p.isActive&&(m={...m,...O}),n&&t.blockInitialAnimation&&(E=!1);const H=S&&w;E&&(!H||j)&&f.push(...A.map(U=>{const C={type:g};if(typeof U=="string"&&n&&!H&&t.manuallyAnimateOnMount&&t.parent){const{parent:T}=t,R=Hr(T,U);if(T.enteringChildren&&R){const{delayChildren:D}=R.transition||{};C.delay=G5(T.enteringChildren,t,D)}}return{animation:U,options:C}}))}if(h.size){const b={};if(typeof u.initial!="boolean"){const g=Hr(t,Array.isArray(u.initial)?u.initial[0]:u.initial);g&&g.transition&&(b.transition=g.transition)}h.forEach(g=>{const p=t.getBaseTarget(g),y=t.getValue(g);y&&(y.liveStyle=!0),b[g]=p??null}),f.push({animation:b})}let x=!!f.length;return n&&(u.initial===!1||u.initial===u.animate)&&!t.manuallyAnimateOnMount&&(x=!1),n=!1,x?e(f):Promise.resolve()}function o(c,u){var f;if(s[c].isActive===u)return Promise.resolve();(f=t.variantChildren)==null||f.forEach(h=>{var m;return(m=h.animationState)==null?void 0:m.setActive(c,u)}),s[c].isActive=u;const d=l(c);for(const h in s)s[h].protectedKeys={};return d}return{animateChanges:l,setActive:o,setAnimateFunction:a,getState:()=>s,reset:()=>{s=V1()}}}function i9(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!F5(e,t):!1}function ca(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function V1(){return{animate:ca(!0),whileInView:ca(),whileHover:ca(),whileTap:ca(),whileDrag:ca(),whileFocus:ca(),exit:ca()}}class aa{constructor(e){this.isMounted=!1,this.node=e}update(){}}class a9 extends aa{constructor(e){super(e),e.animationState||(e.animationState=n9(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Jf(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:s}=this.node.prevProps||{};e!==s&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let r9=0;class l9 extends aa{constructor(){super(...arguments),this.id=r9++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:s}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const i=this.node.animationState.setActive("exit",!e);s&&!e&&i.then(()=>{s(this.id)})}mount(){const{register:e,onExitComplete:s}=this.node.presenceContext||{};s&&s(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const o9={animation:{Feature:a9},exit:{Feature:l9}};function dc(t,e,s,n={passive:!0}){return t.addEventListener(e,s,n),()=>t.removeEventListener(e,s)}function Kc(t){return{point:{x:t.pageX,y:t.pageY}}}const c9=t=>e=>zx(e)&&t(e,Kc(e));function Ao(t,e,s,n){return dc(t,e,c9(s),n)}const z5=1e-4,u9=1-z5,d9=1+z5,K5=.01,f9=0-K5,h9=0+K5;function Xt(t){return t.max-t.min}function m9(t,e,s){return Math.abs(t-e)<=s}function z1(t,e,s,n=.5){t.origin=n,t.originPoint=ot(e.min,e.max,t.origin),t.scale=Xt(s)/Xt(e),t.translate=ot(s.min,s.max,t.origin)-t.originPoint,(t.scale>=u9&&t.scale<=d9||isNaN(t.scale))&&(t.scale=1),(t.translate>=f9&&t.translate<=h9||isNaN(t.translate))&&(t.translate=0)}function Ro(t,e,s,n){z1(t.x,e.x,s.x,n?n.originX:void 0),z1(t.y,e.y,s.y,n?n.originY:void 0)}function K1(t,e,s){t.min=s.min+e.min,t.max=t.min+Xt(e)}function p9(t,e,s){K1(t.x,e.x,s.x),K1(t.y,e.y,s.y)}function Y1(t,e,s){t.min=e.min-s.min,t.max=t.min+Xt(e)}function nf(t,e,s){Y1(t.x,e.x,s.x),Y1(t.y,e.y,s.y)}function js(t){return[t("x"),t("y")]}const Y5=({current:t})=>t?t.ownerDocument.defaultView:null,W1=(t,e)=>Math.abs(t-e);function g9(t,e){const s=W1(t.x,e.x),n=W1(t.y,e.y);return Math.sqrt(s**2+n**2)}class W5{constructor(e,s,{transformPagePoint:n,contextWindow:i=window,dragSnapToOrigin:a=!1,distanceThreshold:l=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=um(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,v=g9(h.offset,{x:0,y:0})>=this.distanceThreshold;if(!m&&!v)return;const{point:x}=h,{timestamp:b}=Bt;this.history.push({...x,timestamp:b});const{onStart:g,onMove:p}=this.handlers;m||(g&&g(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),p&&p(this.lastMoveEvent,h)},this.handlePointerMove=(h,m)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=cm(m,this.transformPagePoint),it.update(this.updatePoint,!0)},this.handlePointerUp=(h,m)=>{this.end();const{onEnd:v,onSessionEnd:x,resumeAnimation:b}=this.handlers;if(this.dragSnapToOrigin&&b&&b(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const g=um(h.type==="pointercancel"?this.lastMoveEventInfo:cm(m,this.transformPagePoint),this.history);this.startEvent&&v&&v(h,g),x&&x(h,g)},!zx(e))return;this.dragSnapToOrigin=a,this.handlers=s,this.transformPagePoint=n,this.distanceThreshold=l,this.contextWindow=i||window;const o=Kc(e),c=cm(o,this.transformPagePoint),{point:u}=c,{timestamp:d}=Bt;this.history=[{...u,timestamp:d}];const{onSessionStart:f}=s;f&&f(e,um(c,this.history)),this.removeListeners=Fc(Ao(this.contextWindow,"pointermove",this.handlePointerMove),Ao(this.contextWindow,"pointerup",this.handlePointerUp),Ao(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Zi(this.updatePoint)}}function cm(t,e){return e?{point:e(t.point)}:t}function q1(t,e){return{x:t.x-e.x,y:t.y-e.y}}function um({point:t},e){return{point:t,delta:q1(t,q5(e)),offset:q1(t,x9(e)),velocity:b9(e,.1)}}function x9(t){return t[0]}function q5(t){return t[t.length-1]}function b9(t,e){if(t.length<2)return{x:0,y:0};let s=t.length-1,n=null;const i=q5(t);for(;s>=0&&(n=t[s],!(i.timestamp-n.timestamp>hn(e)));)s--;if(!n)return{x:0,y:0};const a=Ls(i.timestamp-n.timestamp);if(a===0)return{x:0,y:0};const l={x:(i.x-n.x)/a,y:(i.y-n.y)/a};return l.x===1/0&&(l.x=0),l.y===1/0&&(l.y=0),l}function v9(t,{min:e,max:s},n){return e!==void 0&&t<e?t=n?ot(e,t,n.min):Math.max(t,e):s!==void 0&&t>s&&(t=n?ot(s,t,n.max):Math.min(t,s)),t}function X1(t,e,s){return{min:e!==void 0?t.min+e:void 0,max:s!==void 0?t.max+s-(t.max-t.min):void 0}}function y9(t,{top:e,left:s,bottom:n,right:i}){return{x:X1(t.x,s,i),y:X1(t.y,e,n)}}function Q1(t,e){let s=e.min-t.min,n=e.max-t.max;return e.max-e.min<t.max-t.min&&([s,n]=[n,s]),{min:s,max:n}}function _9(t,e){return{x:Q1(t.x,e.x),y:Q1(t.y,e.y)}}function w9(t,e){let s=.5;const n=Xt(t),i=Xt(e);return i>n?s=lc(e.min,e.max-n,t.min):n>i&&(s=lc(t.min,t.max-i,e.min)),Xn(0,1,s)}function k9(t,e){const s={};return e.min!==void 0&&(s.min=e.min-t.min),e.max!==void 0&&(s.max=e.max-t.min),s}const fp=.35;function N9(t=fp){return t===!1?t=0:t===!0&&(t=fp),{x:J1(t,"left","right"),y:J1(t,"top","bottom")}}function J1(t,e,s){return{min:Z1(t,e),max:Z1(t,s)}}function Z1(t,e){return typeof t=="number"?t:t[e]||0}const S9=new WeakMap;class E9{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Et(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:s=!1,distanceThreshold:n}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const a=f=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),s&&this.snapToCursor(Kc(f).point)},l=(f,h)=>{const{drag:m,dragPropagation:v,onDragStart:x}=this.getProps();if(m&&!v&&(this.openDragLock&&this.openDragLock(),this.openDragLock=I8(m),!this.openDragLock))return;this.latestPointerEvent=f,this.latestPanInfo=h,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),js(g=>{let p=this.getAxisMotionValue(g).get()||0;if(mn.test(p)){const{projection:y}=this.visualElement;if(y&&y.layout){const k=y.layout.layoutBox[g];k&&(p=Xt(k)*(parseFloat(p)/100))}}this.originPoint[g]=p}),x&&it.postRender(()=>x(f,h)),up(this.visualElement,"transform");const{animationState:b}=this.visualElement;b&&b.setActive("whileDrag",!0)},o=(f,h)=>{this.latestPointerEvent=f,this.latestPanInfo=h;const{dragPropagation:m,dragDirectionLock:v,onDirectionLock:x,onDrag:b}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:g}=h;if(v&&this.currentDirection===null){this.currentDirection=j9(g),this.currentDirection!==null&&x&&x(this.currentDirection);return}this.updateAxis("x",h.point,g),this.updateAxis("y",h.point,g),this.visualElement.render(),b&&b(f,h)},c=(f,h)=>{this.latestPointerEvent=f,this.latestPanInfo=h,this.stop(f,h),this.latestPointerEvent=null,this.latestPanInfo=null},u=()=>js(f=>{var h;return this.getAnimationState(f)==="paused"&&((h=this.getAxisMotionValue(f).animation)==null?void 0:h.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new W5(e,{onSessionStart:a,onStart:l,onMove:o,onSessionEnd:c,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,distanceThreshold:n,contextWindow:Y5(this.visualElement)})}stop(e,s){const n=e||this.latestPointerEvent,i=s||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!i||!n)return;const{velocity:l}=i;this.startAnimation(l);const{onDragEnd:o}=this.getProps();o&&it.postRender(()=>o(n,i))}cancel(){this.isDragging=!1;const{projection:e,animationState:s}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),s&&s.setActive("whileDrag",!1)}updateAxis(e,s,n){const{drag:i}=this.getProps();if(!n||!_u(e,i,this.currentDirection))return;const a=this.getAxisMotionValue(e);let l=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(l=v9(l,this.constraints[e],this.elastic[e])),a.set(l)}resolveConstraints(){var a;const{dragConstraints:e,dragElastic:s}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(a=this.visualElement.projection)==null?void 0:a.layout,i=this.constraints;e&&kr(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&n?this.constraints=y9(n.layoutBox,e):this.constraints=!1,this.elastic=N9(s),i!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&js(l=>{this.constraints!==!1&&this.getAxisMotionValue(l)&&(this.constraints[l]=k9(n.layoutBox[l],this.constraints[l]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:s}=this.getProps();if(!e||!kr(e))return!1;const n=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const a=TB(n,i.root,this.visualElement.getTransformPagePoint());let l=_9(i.layout.layoutBox,a);if(s){const o=s(SB(l));this.hasMutatedConstraints=!!o,o&&(l=I5(o))}return l}startAnimation(e){const{drag:s,dragMomentum:n,dragElastic:i,dragTransition:a,dragSnapToOrigin:l,onDragTransitionEnd:o}=this.getProps(),c=this.constraints||{},u=js(d=>{if(!_u(d,s,this.currentDirection))return;let f=c&&c[d]||{};l&&(f={min:0,max:0});const h=i?200:1e6,m=i?40:1e7,v={type:"inertia",velocity:n?e[d]:0,bounceStiffness:h,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...a,...f};return this.startAxisValueAnimation(d,v)});return Promise.all(u).then(o)}startAxisValueAnimation(e,s){const n=this.getAxisMotionValue(e);return up(this.visualElement,e),n.start(tb(e,n,0,s,this.visualElement,!1))}stopAnimation(){js(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){js(e=>{var s;return(s=this.getAxisMotionValue(e).animation)==null?void 0:s.pause()})}getAnimationState(e){var s;return(s=this.getAxisMotionValue(e).animation)==null?void 0:s.state}getAxisMotionValue(e){const s=`_drag${e.toUpperCase()}`,n=this.visualElement.getProps(),i=n[s];return i||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){js(s=>{const{drag:n}=this.getProps();if(!_u(s,n,this.currentDirection))return;const{projection:i}=this.visualElement,a=this.getAxisMotionValue(s);if(i&&i.layout){const{min:l,max:o}=i.layout.layoutBox[s];a.set(e[s]-ot(l,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:s}=this.getProps(),{projection:n}=this.visualElement;if(!kr(s)||!n||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};js(l=>{const o=this.getAxisMotionValue(l);if(o&&this.constraints!==!1){const c=o.get();i[l]=w9({min:c,max:c},this.constraints[l])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),js(l=>{if(!_u(l,e,null))return;const o=this.getAxisMotionValue(l),{min:c,max:u}=this.constraints[l];o.set(ot(c,u,i[l]))})}addListeners(){if(!this.visualElement.current)return;S9.set(this.visualElement,this);const e=this.visualElement.current,s=Ao(e,"pointerdown",c=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(c)}),n=()=>{const{dragConstraints:c}=this.getProps();kr(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,a=i.addEventListener("measure",n);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),it.read(n);const l=dc(window,"resize",()=>this.scalePositionWithinConstraints()),o=i.addEventListener("didUpdate",({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&(js(d=>{const f=this.getAxisMotionValue(d);f&&(this.originPoint[d]+=c[d].translate,f.set(f.get()+c[d].translate))}),this.visualElement.render())});return()=>{l(),s(),a(),o&&o()}}getProps(){const e=this.visualElement.getProps(),{drag:s=!1,dragDirectionLock:n=!1,dragPropagation:i=!1,dragConstraints:a=!1,dragElastic:l=fp,dragMomentum:o=!0}=e;return{...e,drag:s,dragDirectionLock:n,dragPropagation:i,dragConstraints:a,dragElastic:l,dragMomentum:o}}}function _u(t,e,s){return(e===!0||e===t)&&(s===null||s===t)}function j9(t,e=10){let s=null;return Math.abs(t.y)>e?s="y":Math.abs(t.x)>e&&(s="x"),s}class T9 extends aa{constructor(e){super(e),this.removeGroupControls=$s,this.removeListeners=$s,this.controls=new E9(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||$s}unmount(){this.removeGroupControls(),this.removeListeners()}}const e_=t=>(e,s)=>{t&&it.postRender(()=>t(e,s))};class A9 extends aa{constructor(){super(...arguments),this.removePointerDownListener=$s}onPointerDown(e){this.session=new W5(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Y5(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:s,onPan:n,onPanEnd:i}=this.node.getProps();return{onSessionStart:e_(e),onStart:e_(s),onMove:n,onEnd:(a,l)=>{delete this.session,i&&it.postRender(()=>i(a,l))}}}mount(){this.removePointerDownListener=Ao(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const qu={hasAnimatedSinceResize:!0,hasEverUpdated:!1};let dm=!1;class R9 extends _.Component{componentDidMount(){const{visualElement:e,layoutGroup:s,switchLayoutGroup:n,layoutId:i}=this.props,{projection:a}=e;a&&(s.group&&s.group.add(a),n&&n.register&&i&&n.register(a),dm&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),qu.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:s,visualElement:n,drag:i,isPresent:a}=this.props,{projection:l}=n;return l&&(l.isPresent=a,dm=!0,i||e.layoutDependency!==s||s===void 0||e.isPresent!==a?l.willUpdate():this.safeToRemove(),e.isPresent!==a&&(a?l.promote():l.relegate()||it.postRender(()=>{const o=l.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),Vx.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:s,switchLayoutGroup:n}=this.props,{projection:i}=e;dm=!0,i&&(i.scheduleCheckAfterUnmount(),s&&s.group&&s.group.remove(i),n&&n.deregister&&n.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function X5(t){const[e,s]=b5(),n=_.useContext(kx);return r.jsx(R9,{...t,layoutGroup:n,switchLayoutGroup:_.useContext(R5),isPresent:e,safeToRemove:s})}function C9(t,e,s){const n=Kt(t)?t:cl(t);return n.start(tb("",n,e,s)),n.animation}const I9=(t,e)=>t.depth-e.depth;class O9{constructor(){this.children=[],this.isDirty=!1}add(e){Ex(this.children,e),this.isDirty=!0}remove(e){jx(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(I9),this.isDirty=!1,this.children.forEach(e)}}function M9(t,e){const s=ls.now(),n=({timestamp:i})=>{const a=i-s;a>=e&&(Zi(n),t(a-e))};return it.setup(n,!0),()=>Zi(n)}const Q5=["TopLeft","TopRight","BottomLeft","BottomRight"],D9=Q5.length,t_=t=>typeof t=="string"?parseFloat(t):t,s_=t=>typeof t=="number"||oe.test(t);function L9(t,e,s,n,i,a){i?(t.opacity=ot(0,s.opacity??1,P9(n)),t.opacityExit=ot(e.opacity??1,0,B9(n))):a&&(t.opacity=ot(e.opacity??1,s.opacity??1,n));for(let l=0;l<D9;l++){const o=`border${Q5[l]}Radius`;let c=n_(e,o),u=n_(s,o);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||s_(c)===s_(u)?(t[o]=Math.max(ot(t_(c),t_(u),n),0),(mn.test(u)||mn.test(c))&&(t[o]+="%")):t[o]=u}(e.rotate||s.rotate)&&(t.rotate=ot(e.rotate||0,s.rotate||0,n))}function n_(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const P9=J5(0,.5,P2),B9=J5(.5,.95,$s);function J5(t,e,s){return n=>n<t?0:n>e?1:s(lc(t,e,n))}function i_(t,e){t.min=e.min,t.max=e.max}function zs(t,e){i_(t.x,e.x),i_(t.y,e.y)}function a_(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function r_(t,e,s,n,i){return t-=e,t=sf(t,1/s,n),i!==void 0&&(t=sf(t,1/i,n)),t}function U9(t,e=0,s=1,n=.5,i,a=t,l=t){if(mn.test(e)&&(e=parseFloat(e),e=ot(l.min,l.max,e/100)-l.min),typeof e!="number")return;let o=ot(a.min,a.max,n);t===a&&(o-=e),t.min=r_(t.min,e,s,o,i),t.max=r_(t.max,e,s,o,i)}function l_(t,e,[s,n,i],a,l){U9(t,e[s],e[n],e[i],e.scale,a,l)}const H9=["x","scaleX","originX"],$9=["y","scaleY","originY"];function o_(t,e,s,n){l_(t.x,e,H9,s?s.x:void 0,n?n.x:void 0),l_(t.y,e,$9,s?s.y:void 0,n?n.y:void 0)}function c_(t){return t.translate===0&&t.scale===1}function Z5(t){return c_(t.x)&&c_(t.y)}function u_(t,e){return t.min===e.min&&t.max===e.max}function G9(t,e){return u_(t.x,e.x)&&u_(t.y,e.y)}function d_(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function ej(t,e){return d_(t.x,e.x)&&d_(t.y,e.y)}function f_(t){return Xt(t.x)/Xt(t.y)}function h_(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class F9{constructor(){this.members=[]}add(e){Ex(this.members,e),e.scheduleRender()}remove(e){if(jx(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const s=this.members[this.members.length-1];s&&this.promote(s)}}relegate(e){const s=this.members.findIndex(i=>e===i);if(s===0)return!1;let n;for(let i=s;i>=0;i--){const a=this.members[i];if(a.isPresent!==!1){n=a;break}}return n?(this.promote(n),!0):!1}promote(e,s){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,s&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:s,resumingFrom:n}=e;s.onExitComplete&&s.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function V9(t,e,s){let n="";const i=t.x.translate/e.x,a=t.y.translate/e.y,l=(s==null?void 0:s.z)||0;if((i||a||l)&&(n=`translate3d(${i}px, ${a}px, ${l}px) `),(e.x!==1||e.y!==1)&&(n+=`scale(${1/e.x}, ${1/e.y}) `),s){const{transformPerspective:u,rotate:d,rotateX:f,rotateY:h,skewX:m,skewY:v}=s;u&&(n=`perspective(${u}px) ${n}`),d&&(n+=`rotate(${d}deg) `),f&&(n+=`rotateX(${f}deg) `),h&&(n+=`rotateY(${h}deg) `),m&&(n+=`skewX(${m}deg) `),v&&(n+=`skewY(${v}deg) `)}const o=t.x.scale*e.x,c=t.y.scale*e.y;return(o!==1||c!==1)&&(n+=`scale(${o}, ${c})`),n||"none"}const fm=["","X","Y","Z"],z9=1e3;let K9=0;function hm(t,e,s,n){const{latestValues:i}=e;i[t]&&(s[t]=i[t],e.setStaticValue(t,0),n&&(n[t]=0))}function tj(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const s=H5(e);if(window.MotionHasOptimisedAnimation(s,"transform")){const{layout:i,layoutId:a}=t.options;window.MotionCancelOptimisedAnimation(s,"transform",it,!(i||a))}const{parent:n}=t;n&&!n.hasCheckedOptimisedAppear&&tj(n)}function sj({attachResizeListener:t,defaultParent:e,measureScroll:s,checkIsScrollRoot:n,resetTransform:i}){return class{constructor(l={},o=e==null?void 0:e()){this.id=K9++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(q9),this.nodes.forEach(Z9),this.nodes.forEach(eU),this.nodes.forEach(X9)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=l,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new O9)}addEventListener(l,o){return this.eventHandlers.has(l)||this.eventHandlers.set(l,new Rx),this.eventHandlers.get(l).add(o)}notifyListeners(l,...o){const c=this.eventHandlers.get(l);c&&c.notify(...o)}hasListeners(l){return this.eventHandlers.has(l)}mount(l){if(this.instance)return;this.isSVG=x5(l)&&!B8(l),this.instance=l;const{layoutId:o,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(l),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||o)&&(this.isLayoutDirty=!0),t){let d,f=0;const h=()=>this.root.updateBlockedByResize=!1;it.read(()=>{f=window.innerWidth}),t(l,()=>{const m=window.innerWidth;m!==f&&(f=m,this.root.updateBlockedByResize=!0,d&&d(),d=M9(h,250),qu.hasAnimatedSinceResize&&(qu.hasAnimatedSinceResize=!1,this.nodes.forEach(g_)))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&u&&(o||c)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:f,hasRelativeLayoutChanged:h,layout:m})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const v=this.options.transition||u.getDefaultTransition()||aU,{onLayoutAnimationStart:x,onLayoutAnimationComplete:b}=u.getProps(),g=!this.targetLayout||!ej(this.targetLayout,m),p=!f&&h;if(this.options.layoutRoot||this.resumeFrom||p||f&&(g||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const y={...Gx(v,"layout"),onPlay:x,onComplete:b};(u.shouldReduceMotion||this.options.layoutRoot)&&(y.delay=0,y.type=!1),this.startAnimation(y),this.setAnimationOrigin(d,p)}else f||g_(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=m})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const l=this.getStack();l&&l.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Zi(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(tU),this.animationId++)}getTransformTemplate(){const{visualElement:l}=this.options;return l&&l.getProps().transformTemplate}willUpdate(l=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&tj(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const f=this.path[d];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:o,layout:c}=this.options;if(o===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),l&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(m_);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(p_);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(J9),this.nodes.forEach(Y9),this.nodes.forEach(W9)):this.nodes.forEach(p_),this.clearAllSnapshots();const o=ls.now();Bt.delta=Xn(0,1e3/60,o-Bt.timestamp),Bt.timestamp=o,Bt.isProcessing=!0,tm.update.process(Bt),tm.preRender.process(Bt),tm.render.process(Bt),Bt.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Vx.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Q9),this.sharedNodes.forEach(sU)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,it.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){it.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Xt(this.snapshot.measuredBox.x)&&!Xt(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const l=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=Et(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,l?l.layoutBox:void 0)}updateScroll(l="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===l&&(o=!1),o&&this.instance){const c=n(this.instance);this.scroll={animationId:this.root.animationId,phase:l,isRoot:c,offset:s(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!i)return;const l=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!Z5(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;l&&this.instance&&(o||ba(this.latestValues)||d)&&(i(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(l=!0){const o=this.measurePageBox();let c=this.removeElementScroll(o);return l&&(c=this.removeTransform(c)),rU(c),{animationId:this.root.animationId,measuredBox:o,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var u;const{visualElement:l}=this.options;if(!l)return Et();const o=l.measureViewportBox();if(!(((u=this.scroll)==null?void 0:u.wasRoot)||this.path.some(lU))){const{scroll:d}=this.root;d&&(Nr(o.x,d.offset.x),Nr(o.y,d.offset.y))}return o}removeElementScroll(l){var c;const o=Et();if(zs(o,l),(c=this.scroll)!=null&&c.wasRoot)return o;for(let u=0;u<this.path.length;u++){const d=this.path[u],{scroll:f,options:h}=d;d!==this.root&&f&&h.layoutScroll&&(f.wasRoot&&zs(o,l),Nr(o.x,f.offset.x),Nr(o.y,f.offset.y))}return o}applyTransform(l,o=!1){const c=Et();zs(c,l);for(let u=0;u<this.path.length;u++){const d=this.path[u];!o&&d.options.layoutScroll&&d.scroll&&d!==d.root&&Sr(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),ba(d.latestValues)&&Sr(c,d.latestValues)}return ba(this.latestValues)&&Sr(c,this.latestValues),c}removeTransform(l){const o=Et();zs(o,l);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!ba(u.latestValues))continue;rp(u.latestValues)&&u.updateSnapshot();const d=Et(),f=u.measurePageBox();zs(d,f),o_(o,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return ba(this.latestValues)&&o_(o,this.latestValues),o}setTargetDelta(l){this.targetDelta=l,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(l){this.options={...this.options,...l,crossfade:l.crossfade!==void 0?l.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Bt.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(l=!1){var m;const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==o;if(!(l||c&&this.isSharedProjectionDirty||this.isProjectionDirty||(m=this.parent)!=null&&m.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:f}=this.options;if(!this.layout||!(d||f))return;this.resolvedRelativeTargetAt=Bt.timestamp;const h=this.getClosestProjectingParent();h&&this.linkedParentVersion!==h.layoutVersion&&!h.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(h&&h.layout?this.createRelativeTarget(h,this.layout.layoutBox,h.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Et(),this.targetWithTransforms=Et()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),p9(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):zs(this.target,this.layout.layoutBox),M5(this.target,this.targetDelta)):zs(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,h&&!!h.resumingFrom==!!this.resumingFrom&&!h.options.layoutScroll&&h.target&&this.animationProgress!==1?this.createRelativeTarget(h,this.target,h.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||rp(this.parent.latestValues)||O5(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(l,o,c){this.relativeParent=l,this.linkedParentVersion=l.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Et(),this.relativeTargetOrigin=Et(),nf(this.relativeTargetOrigin,o,c),zs(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){var v;const l=this.getLead(),o=!!this.resumingFrom||this!==l;let c=!0;if((this.isProjectionDirty||(v=this.parent)!=null&&v.isProjectionDirty)&&(c=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===Bt.timestamp&&(c=!1),c)return;const{layout:u,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||d))return;zs(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,h=this.treeScale.y;jB(this.layoutCorrected,this.treeScale,this.path,o),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox,l.targetWithTransforms=Et());const{target:m}=l;if(!m){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(a_(this.prevProjectionDelta.x,this.projectionDelta.x),a_(this.prevProjectionDelta.y,this.projectionDelta.y)),Ro(this.projectionDelta,this.layoutCorrected,m,this.latestValues),(this.treeScale.x!==f||this.treeScale.y!==h||!h_(this.projectionDelta.x,this.prevProjectionDelta.x)||!h_(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",m))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(l=!0){var o;if((o=this.options.visualElement)==null||o.scheduleRender(),l){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Er(),this.projectionDelta=Er(),this.projectionDeltaWithTransform=Er()}setAnimationOrigin(l,o=!1){const c=this.snapshot,u=c?c.latestValues:{},d={...this.latestValues},f=Er();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const h=Et(),m=c?c.source:void 0,v=this.layout?this.layout.source:void 0,x=m!==v,b=this.getStack(),g=!b||b.members.length<=1,p=!!(x&&!g&&this.options.crossfade===!0&&!this.path.some(iU));this.animationProgress=0;let y;this.mixTargetDelta=k=>{const N=k/1e3;x_(f.x,l.x,N),x_(f.y,l.y,N),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(nf(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),nU(this.relativeTarget,this.relativeTargetOrigin,h,N),y&&G9(this.relativeTarget,y)&&(this.isProjectionDirty=!1),y||(y=Et()),zs(y,this.relativeTarget)),x&&(this.animationValues=d,L9(d,u,this.latestValues,N,p,g)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=N},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(l){var o,c,u;this.notifyListeners("animationStart"),(o=this.currentAnimation)==null||o.stop(),(u=(c=this.resumingFrom)==null?void 0:c.currentAnimation)==null||u.stop(),this.pendingAnimation&&(Zi(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=it.update(()=>{qu.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=cl(0)),this.currentAnimation=C9(this.motionValue,[0,1e3],{...l,velocity:0,isSync:!0,onUpdate:d=>{this.mixTargetDelta(d),l.onUpdate&&l.onUpdate(d)},onStop:()=>{},onComplete:()=>{l.onComplete&&l.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const l=this.getStack();l&&l.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(z9),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const l=this.getLead();let{targetWithTransforms:o,target:c,layout:u,latestValues:d}=l;if(!(!o||!c||!u)){if(this!==l&&this.layout&&u&&nj(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||Et();const f=Xt(this.layout.layoutBox.x);c.x.min=l.target.x.min,c.x.max=c.x.min+f;const h=Xt(this.layout.layoutBox.y);c.y.min=l.target.y.min,c.y.max=c.y.min+h}zs(o,c),Sr(o,d),Ro(this.projectionDeltaWithTransform,this.layoutCorrected,o,d)}}registerSharedNode(l,o){this.sharedNodes.has(l)||this.sharedNodes.set(l,new F9),this.sharedNodes.get(l).add(o);const u=o.options.initialPromotionConfig;o.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(o):void 0})}isLead(){const l=this.getStack();return l?l.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())==null?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())==null?void 0:o.prevLead:void 0}getStack(){const{layoutId:l}=this.options;if(l)return this.root.sharedNodes.get(l)}promote({needsReset:l,transition:o,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),l&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const l=this.getStack();return l?l.relegate(this):!1}resetSkewAndRotation(){const{visualElement:l}=this.options;if(!l)return;let o=!1;const{latestValues:c}=l;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(o=!0),!o)return;const u={};c.z&&hm("z",l,u,this.animationValues);for(let d=0;d<fm.length;d++)hm(`rotate${fm[d]}`,l,u,this.animationValues),hm(`skew${fm[d]}`,l,u,this.animationValues);l.render();for(const d in u)l.setStaticValue(d,u[d]),this.animationValues&&(this.animationValues[d]=u[d]);l.scheduleRender()}applyProjectionStyles(l,o){if(!this.instance||this.isSVG)return;if(!this.isVisible){l.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,l.visibility="",l.opacity="",l.pointerEvents=Wu(o==null?void 0:o.pointerEvents)||"",l.transform=c?c(this.latestValues,""):"none";return}const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){this.options.layoutId&&(l.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,l.pointerEvents=Wu(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!ba(this.latestValues)&&(l.transform=c?c({},""):"none",this.hasProjected=!1);return}l.visibility="";const d=u.animationValues||u.latestValues;this.applyTransformsToTarget();let f=V9(this.projectionDeltaWithTransform,this.treeScale,d);c&&(f=c(d,f)),l.transform=f;const{x:h,y:m}=this.projectionDelta;l.transformOrigin=`${h.origin*100}% ${m.origin*100}% 0`,u.animationValues?l.opacity=u===this?d.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:l.opacity=u===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const v in ap){if(d[v]===void 0)continue;const{correct:x,applyTo:b,isCSSVariable:g}=ap[v],p=f==="none"?d[v]:x(d[v],u);if(b){const y=b.length;for(let k=0;k<y;k++)l[b[k]]=p}else g?this.options.visualElement.renderState.vars[v]=p:l[v]=p}this.options.layoutId&&(l.pointerEvents=u===this?Wu(o==null?void 0:o.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(l=>{var o;return(o=l.currentAnimation)==null?void 0:o.stop()}),this.root.nodes.forEach(m_),this.root.sharedNodes.clear()}}}function Y9(t){t.updateLayout()}function W9(t){var s;const e=((s=t.resumeFrom)==null?void 0:s.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:i}=t.layout,{animationType:a}=t.options,l=e.source!==t.layout.source;a==="size"?js(f=>{const h=l?e.measuredBox[f]:e.layoutBox[f],m=Xt(h);h.min=n[f].min,h.max=h.min+m}):nj(a,e.layoutBox,n)&&js(f=>{const h=l?e.measuredBox[f]:e.layoutBox[f],m=Xt(n[f]);h.max=h.min+m,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[f].max=t.relativeTarget[f].min+m)});const o=Er();Ro(o,n,e.layoutBox);const c=Er();l?Ro(c,t.applyTransform(i,!0),e.measuredBox):Ro(c,n,e.layoutBox);const u=!Z5(o);let d=!1;if(!t.resumeFrom){const f=t.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:h,layout:m}=f;if(h&&m){const v=Et();nf(v,e.layoutBox,h.layoutBox);const x=Et();nf(x,n,m.layoutBox),ej(v,x)||(d=!0),f.options.layoutRoot&&(t.relativeTarget=x,t.relativeTargetOrigin=v,t.relativeParent=f)}}}t.notifyListeners("didUpdate",{layout:n,snapshot:e,delta:c,layoutDelta:o,hasLayoutChanged:u,hasRelativeLayoutChanged:d})}else if(t.isLead()){const{onExitComplete:n}=t.options;n&&n()}t.options.transition=void 0}function q9(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function X9(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function Q9(t){t.clearSnapshot()}function m_(t){t.clearMeasurements()}function p_(t){t.isLayoutDirty=!1}function J9(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function g_(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function Z9(t){t.resolveTargetDelta()}function eU(t){t.calcProjection()}function tU(t){t.resetSkewAndRotation()}function sU(t){t.removeLeadSnapshot()}function x_(t,e,s){t.translate=ot(e.translate,0,s),t.scale=ot(e.scale,1,s),t.origin=e.origin,t.originPoint=e.originPoint}function b_(t,e,s,n){t.min=ot(e.min,s.min,n),t.max=ot(e.max,s.max,n)}function nU(t,e,s,n){b_(t.x,e.x,s.x,n),b_(t.y,e.y,s.y,n)}function iU(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const aU={duration:.45,ease:[.4,0,.1,1]},v_=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),y_=v_("applewebkit/")&&!v_("chrome/")?Math.round:$s;function __(t){t.min=y_(t.min),t.max=y_(t.max)}function rU(t){__(t.x),__(t.y)}function nj(t,e,s){return t==="position"||t==="preserve-aspect"&&!m9(f_(e),f_(s),.2)}function lU(t){var e;return t!==t.root&&((e=t.scroll)==null?void 0:e.wasRoot)}const oU=sj({attachResizeListener:(t,e)=>dc(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),mm={current:void 0},ij=sj({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!mm.current){const t=new oU({});t.mount(window),t.setOptions({layoutScroll:!0}),mm.current=t}return mm.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),cU={pan:{Feature:A9},drag:{Feature:T9,ProjectionNode:ij,MeasureLayout:X5}};function w_(t,e,s){const{props:n}=t;t.animationState&&n.whileHover&&t.animationState.setActive("whileHover",s==="Start");const i="onHover"+s,a=n[i];a&&it.postRender(()=>a(e,Kc(e)))}class uU extends aa{mount(){const{current:e}=this.node;e&&(this.unmount=O8(e,(s,n)=>(w_(this.node,n,"Start"),i=>w_(this.node,i,"End"))))}unmount(){}}class dU extends aa{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Fc(dc(this.node.current,"focus",()=>this.onFocus()),dc(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function k_(t,e,s){const{props:n}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&n.whileTap&&t.animationState.setActive("whileTap",s==="Start");const i="onTap"+(s==="End"?"":s),a=n[i];a&&it.postRender(()=>a(e,Kc(e)))}class fU extends aa{mount(){const{current:e}=this.node;e&&(this.unmount=P8(e,(s,n)=>(k_(this.node,n,"Start"),(i,{success:a})=>k_(this.node,i,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const hp=new WeakMap,pm=new WeakMap,hU=t=>{const e=hp.get(t.target);e&&e(t)},mU=t=>{t.forEach(hU)};function pU({root:t,...e}){const s=t||document;pm.has(s)||pm.set(s,{});const n=pm.get(s),i=JSON.stringify(e);return n[i]||(n[i]=new IntersectionObserver(mU,{root:t,...e})),n[i]}function gU(t,e,s){const n=pU(e);return hp.set(t,s),n.observe(t),()=>{hp.delete(t),n.unobserve(t)}}const xU={some:0,all:1};class bU extends aa{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:s,margin:n,amount:i="some",once:a}=e,l={root:s?s.current:void 0,rootMargin:n,threshold:typeof i=="number"?i:xU[i]},o=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,a&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:f}=this.node.getProps(),h=u?d:f;h&&h(c)};return gU(this.node.current,l,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:s}=this.node;["amount","margin","root"].some(vU(e,s))&&this.startObserver()}unmount(){}}function vU({viewport:t={}},{viewport:e={}}={}){return s=>t[s]!==e[s]}const yU={inView:{Feature:bU},tap:{Feature:fU},focus:{Feature:dU},hover:{Feature:uU}},_U={layout:{ProjectionNode:ij,MeasureLayout:X5}},wU={...o9,...yU,...cU,..._U},q=NB(wU,PB);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kU=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),NU=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,s,n)=>n?n.toUpperCase():s.toLowerCase()),N_=t=>{const e=NU(t);return e.charAt(0).toUpperCase()+e.slice(1)},aj=(...t)=>t.filter((e,s,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===s).join(" ").trim(),SU=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var EU={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jU=_.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:s=2,absoluteStrokeWidth:n,className:i="",children:a,iconNode:l,...o},c)=>_.createElement("svg",{ref:c,...EU,width:e,height:e,stroke:t,strokeWidth:n?Number(s)*24/Number(e):s,className:aj("lucide",i),...!a&&!SU(o)&&{"aria-hidden":"true"},...o},[...l.map(([u,d])=>_.createElement(u,d)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=(t,e)=>{const s=_.forwardRef(({className:n,...i},a)=>_.createElement(jU,{ref:a,iconNode:e,className:aj(`lucide-${kU(N_(t))}`,`lucide-${t}`,n),...i}));return s.displayName=N_(t),s};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TU=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],S_=ee("activity",TU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AU=[["path",{d:"M12 6v16",key:"nqf5sj"}],["path",{d:"m19 13 2-1a9 9 0 0 1-18 0l2 1",key:"y7qv08"}],["path",{d:"M9 11h6",key:"1fldmi"}],["circle",{cx:"12",cy:"4",r:"2",key:"muu5ef"}]],eh=ee("anchor",AU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RU=[["path",{d:"M11 9a1 1 0 0 0 1-1V5.061a1 1 0 0 1 1.811-.75l6.836 6.836a1.207 1.207 0 0 1 0 1.707l-6.836 6.835a1 1 0 0 1-1.811-.75V16a1 1 0 0 0-1-1H5a1 1 0 0 1-1-1v-4a1 1 0 0 1 1-1z",key:"1232du"}]],CU=ee("arrow-big-right",RU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IU=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Ca=ee("arrow-right",IU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OU=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],MU=ee("arrow-up",OU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DU=[["path",{d:"M2 4v16",key:"vw9hq8"}],["path",{d:"M2 8h18a2 2 0 0 1 2 2v10",key:"1dgv2r"}],["path",{d:"M2 17h20",key:"18nfp3"}],["path",{d:"M6 8v9",key:"1yriud"}]],E_=ee("bed",DU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LU=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],rj=ee("box",LU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PU=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],BU=ee("brain",PU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UU=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],HU=ee("calendar",UU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $U=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Yc=ee("check",$U);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GU=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],FU=ee("chevron-down",GU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VU=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],lj=ee("chevron-right",VU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zU=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],mp=ee("circle-alert",zU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KU=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]],YU=ee("circle-arrow-up",KU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WU=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],qU=ee("circle-check",WU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XU=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],QU=ee("circle",XU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JU=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],pp=ee("clock",JU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZU=[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]],eH=ee("coffee",ZU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tH=[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]],sb=ee("coins",tH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sH=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],Wc=ee("crown",sH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nH=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],iH=ee("disc",nH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aH=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],rH=ee("eye-off",aH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lH=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],oH=ee("eye",lH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cH=[["path",{d:"M6.5 12c.94-3.46 4.94-6 8.5-6 3.56 0 6.06 2.54 7 6-.94 3.47-3.44 6-7 6s-7.56-2.53-8.5-6Z",key:"15baut"}],["path",{d:"M18 12v.5",key:"18hhni"}],["path",{d:"M16 17.93a9.77 9.77 0 0 1 0-11.86",key:"16dt7o"}],["path",{d:"M7 10.67C7 8 5.58 5.97 2.73 5.5c-1 1.5-1 5 .23 6.5-1.24 1.5-1.24 5-.23 6.5C5.58 18.03 7 16 7 13.33",key:"l9di03"}],["path",{d:"M10.46 7.26C10.2 5.88 9.17 4.24 8 3h5.8a2 2 0 0 1 1.98 1.67l.23 1.4",key:"1kjonw"}],["path",{d:"m16.01 17.93-.23 1.4A2 2 0 0 1 13.8 21H9.5a5.96 5.96 0 0 0 1.49-3.98",key:"1zlm23"}]],uH=ee("fish",cH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dH=[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]],oj=ee("gift",dH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fH=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],hH=ee("globe",fH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mH=[["path",{d:"m15 12-9.373 9.373a1 1 0 0 1-3.001-3L12 9",key:"1hayfq"}],["path",{d:"m18 15 4-4",key:"16gjal"}],["path",{d:"m21.5 11.5-1.914-1.914A2 2 0 0 1 19 8.172v-.344a2 2 0 0 0-.586-1.414l-1.657-1.657A6 6 0 0 0 12.516 3H9l1.243 1.243A6 6 0 0 1 12 8.485V10l2 2h1.172a2 2 0 0 1 1.414.586L18.5 14.5",key:"15ts47"}]],dl=ee("hammer",mH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pH=[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]],nb=ee("handshake",pH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gH=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],xH=ee("heart",gH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bH=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],cj=ee("history",bH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vH=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],uj=ee("info",vH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yH=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],_H=ee("layout-grid",yH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wH=[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]],kH=ee("leaf",wH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NH=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],j_=ee("loader-circle",NH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SH=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Ml=ee("lock",SH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EH=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],jH=ee("mail",EH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TH=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],dj=ee("map-pin",TH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AH=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],fj=ee("map",AH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RH=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],CH=ee("menu",RH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IH=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],fc=ee("message-square",IH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OH=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],MH=ee("music",OH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DH=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],hj=ee("navigation",DH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LH=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],mj=ee("package",LH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PH=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],BH=ee("palette",PH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UH=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],gp=ee("pause",UH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HH=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],xp=ee("play",HH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $H=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],pj=ee("scale",$H);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GH=[["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]],FH=ee("scroll",GH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VH=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],zH=ee("search",VH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KH=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],gj=ee("send",KH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YH=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],WH=ee("settings",YH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qH=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],xj=ee("shield-alert",qH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XH=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],bp=ee("shield-check",XH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QH=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],ib=ee("shield",QH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JH=[["path",{d:"M17.971 4.285A2 2 0 0 1 21 6v12a2 2 0 0 1-3.029 1.715l-9.997-5.998a2 2 0 0 1-.003-3.432z",key:"15892j"}],["path",{d:"M3 20V4",key:"1ptbpl"}]],ZH=ee("skip-back",JH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e$=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],t$=ee("skip-forward",e$);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s$=[["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M15 22a1 1 0 0 0 1-1v-1a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20v1a1 1 0 0 0 1 1z",key:"1o5pge"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}]],n$=ee("skull",s$);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i$=[["path",{d:"m10 20-1.25-2.5L6 18",key:"18frcb"}],["path",{d:"M10 4 8.75 6.5 6 6",key:"7mghy3"}],["path",{d:"m14 20 1.25-2.5L18 18",key:"1chtki"}],["path",{d:"m14 4 1.25 2.5L18 6",key:"1b4wsy"}],["path",{d:"m17 21-3-6h-4",key:"15hhxa"}],["path",{d:"m17 3-3 6 1.5 3",key:"11697g"}],["path",{d:"M2 12h6.5L10 9",key:"kv9z4n"}],["path",{d:"m20 10-1.5 2 1.5 2",key:"1swlpi"}],["path",{d:"M22 12h-6.5L14 15",key:"1mxi28"}],["path",{d:"m4 10 1.5 2L4 14",key:"k9enpj"}],["path",{d:"m7 21 3-6-1.5-3",key:"j8hb9u"}],["path",{d:"m7 3 3 6h4",key:"1otusx"}]],a$=ee("snowflake",i$);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r$=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Hi=ee("sparkles",r$);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l$=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],o$=ee("sun",l$);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c$=[["path",{d:"m11 19-6-6",key:"s7kpr"}],["path",{d:"m5 21-2-2",key:"1kw20b"}],["path",{d:"m8 16-4 4",key:"1oqv8h"}],["path",{d:"M9.5 17.5 21 6V3h-3L6.5 14.5",key:"pkxemp"}]],af=ee("sword",c$);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u$=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],rf=ee("trending-up",u$);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d$=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],hc=ee("triangle-alert",d$);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f$=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],mc=ee("trophy",f$);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h$=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],m$=ee("truck",h$);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p$=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Ia=ee("user",p$);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g$=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ab=ee("users",g$);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x$=[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]],b$=ee("utensils",x$);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v$=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],y$=ee("volume-2",v$);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _$=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],w$=ee("wand-sparkles",_$);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k$=[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]],bj=ee("wind",k$);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N$=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],pn=ee("x",N$);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S$=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],vp=ee("zap",S$),E$=({onAuth:t,adminPassword:e})=>{const[s,n]=_.useState(""),[i,a]=_.useState(!1),l=o=>{o&&o.preventDefault(),s===e?(t(),sessionStorage.setItem("admin_session","active"),a(!1)):(a(!0),n(""),navigator.vibrate&&navigator.vibrate(50))};return r.jsxs("div",{className:"fixed inset-0 bg-slate-950 flex items-center justify-center z-[100] overflow-hidden",children:[r.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[r.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full h-full bg-[radial-gradient(circle_at_center,rgba(99,102,241,0.08)_0%,transparent_70%)]"}),r.jsx(q.div,{animate:{scale:[1,1.1,1],opacity:[.3,.5,.3]},transition:{duration:8,repeat:1/0,ease:"easeInOut"},className:"absolute top-[-20%] left-[-10%] w-[60%] h-[60%] bg-indigo-600/10 blur-[150px] rounded-full"})]}),r.jsxs(q.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},className:"w-full max-w-md p-8 relative",children:[r.jsxs("div",{className:"text-center mb-10",children:[r.jsx(q.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",damping:12,stiffness:200,delay:.2},className:"w-20 h-20 bg-indigo-500/10 rounded-3xl flex items-center justify-center mx-auto mb-6 border border-indigo-500/20 backdrop-blur-xl",children:r.jsx(Ml,{className:"w-10 h-10 text-indigo-400"})}),r.jsx("h2",{className:"text-3xl font-black text-white tracking-tight mb-2",children:"Begrenset tilgang"}),r.jsx("p",{className:"text-slate-400 font-medium",children:"Vennligst oppgi passord for  fortsette"})]}),r.jsxs("form",{onSubmit:l,className:"space-y-4",children:[r.jsxs("div",{className:"relative group",children:[r.jsx(q.div,{animate:i?{x:[-10,10,-10,10,0]}:{},transition:{duration:.4},children:r.jsx("input",{autoFocus:!0,type:"password",value:s,onChange:o=>{n(o.target.value),i&&a(!1)},placeholder:"Passord...",className:`w-full bg-slate-900/50 border-2 ${i?"border-red-500/50 focus:border-red-500":"border-slate-800 focus:border-indigo-500"} rounded-2xl px-6 py-4 text-white text-lg font-medium outline-none transition-all duration-300 backdrop-blur-md placeholder:text-slate-600`})}),r.jsx(kt,{children:i&&r.jsx(q.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"text-red-400 text-sm font-bold mt-2 ml-2",children:"Ugyldig passord. Prv igjen."})})]}),r.jsx("button",{type:"submit",className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-4 rounded-2xl transition-all duration-300 shadow-lg shadow-indigo-600/20 active:scale-[0.98]",children:"Ls opp panel"})]}),r.jsx("div",{className:"mt-12 text-center",children:r.jsx("button",{onClick:()=>window.location.href="/",className:"text-slate-500 hover:text-slate-300 text-sm font-bold transition-colors",children:"Tilbake til forsiden"})})]})]})},j$=({allRooms:t,isLoading:e,onCreateRoom:s,onDeleteRoom:n,onManageRoom:i,onCleanupMetadata:a})=>r.jsxs("div",{className:"fixed inset-0 top-0 bg-slate-950 text-slate-200 p-12 overflow-y-auto custom-scrollbar font-sans z-20",children:[r.jsxs("div",{className:"fixed inset-0 pointer-events-none opacity-20",children:[r.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-indigo-600/20 blur-[120px] rounded-full"}),r.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-amber-600/10 blur-[120px] rounded-full"})]}),r.jsxs("div",{className:"max-w-5xl mx-auto relative z-10",children:[r.jsxs("div",{className:"flex justify-between items-center mb-12",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-5xl font-black text-white px-2 tracking-tighter",children:"Simuleringshallen"}),r.jsx("p",{className:"text-slate-500 font-bold uppercase tracking-widest text-[10px] mt-2 px-2",children:"Sentralt kontrollpanel for administratoren"})]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsx("button",{onClick:a,disabled:e,className:"bg-slate-800 hover:bg-rose-500/20 text-slate-400 hover:text-rose-400 border border-slate-700 hover:border-rose-500/50 px-6 py-5 rounded-2xl font-black text-xs uppercase tracking-widest transition-all",children:" Vask Serverlisten"}),r.jsx("button",{onClick:s,disabled:e,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-10 py-5 rounded-2xl font-black text-lg shadow-2xl shadow-indigo-600/30 transition-all hover:scale-105 active:scale-95",children:"+ Opprett Nytt Rike"})]})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(l=>{var o,c;return r.jsxs("div",{className:"bg-slate-900/50 backdrop-blur-xl border border-white/5 p-8 rounded-[2.5rem] group hover:border-indigo-500/50 transition-all shadow-xl flex flex-col justify-between",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between items-start mb-2",children:[r.jsx("h2",{className:"text-2xl font-black text-white group-hover:text-indigo-400 transition-colors truncate pr-4",title:l.name||`Rike #${l.pin}`,children:l.name||`Rike #${l.pin}`}),r.jsx("span",{className:`px-2 py-0.5 rounded-full text-[8px] font-black uppercase tracking-widest ${l.status==="PLAYING"?"bg-emerald-500/20 text-emerald-400":"bg-amber-500/20 text-amber-400"} shrink-0`,children:typeof l.status=="string"?l.status:"KORRUPT"})]}),r.jsxs("div",{className:"text-[10px] font-mono text-slate-600 mb-6 uppercase tracking-widest",children:["PIN: ",r.jsx("span",{className:"text-slate-400 font-bold",children:l.pin})]}),r.jsxs("div",{className:"space-y-4 mb-8",children:[r.jsxs("div",{className:"flex items-center justify-between text-sm font-bold text-slate-500",children:[r.jsx("span",{children:"Innbyggere:"}),r.jsxs("span",{className:"text-white",children:[Object.keys(l.players||{}).length," sjeler"]})]}),r.jsxs("div",{className:"flex items-center justify-between text-sm font-bold text-slate-500",children:[r.jsx("span",{children:"rstid:"}),r.jsx("span",{className:"text-indigo-300",children:st[(o=l.world)==null?void 0:o.season]||((c=l.world)==null?void 0:c.season)||"Ukjent"})]})]})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:()=>i(l.pin),className:"flex-1 bg-white/5 hover:bg-white/10 text-white py-4 rounded-2xl font-black uppercase tracking-widest text-xs transition-all border border-white/5",children:"Administrer "}),r.jsx("button",{onClick:()=>n(l.pin),className:"bg-rose-500/10 hover:bg-rose-500/20 text-rose-500 w-16 rounded-2xl flex items-center justify-center border border-rose-500/20 transition-all hover:scale-105 active:scale-95",title:"Slett rom",children:""})]})]},l.pin)})})]})]}),T$=Ne.memo(({pin:t,roomData:e,isLoading:s,onBack:n,onStartGame:i,onTogglePublic:a,onRepairData:l,onResetGame:o,onNextSeason:c,onChangeWeather:u,onTaxationBase:d,onRegenStamina:f,onResetUnrest:h,onKickAll:m,onSpawnEvent:v,onStartTing:x,onSpawnCharacter:b,initializeSettlement:g,onExportLog:p})=>{var S,w,E,j,A;const[y,k]=_.useState({name:"",role:"PEASANT",level:1}),N=()=>{if(!y.name){alert("Vennligst oppgi et navn.");return}b(y),k({name:"",role:"PEASANT",level:1})};return r.jsxs("aside",{className:"w-80 border-r border-white/10 bg-slate-900/50 backdrop-blur-xl flex flex-col z-20 shadow-2xl overflow-y-auto no-scrollbar",children:[r.jsxs("div",{className:"p-8 border-b border-white/5 bg-black/20",children:[r.jsx("button",{onClick:n,className:"text-indigo-400 font-black text-[10px] uppercase tracking-widest mb-4 hover:text-white transition-colors flex items-center gap-2",children:" Tilbake til oversikt"}),r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("h1",{className:"text-4xl font-mono font-black text-white",children:t}),r.jsx("span",{className:"text-[10px] font-black uppercase text-indigo-500 tracking-widest bg-indigo-500/10 px-3 py-1 rounded-full",children:"Admin"})]}),r.jsxs("p",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-6",children:[typeof e.status=="string"?e.status:"FEIL: DATA KORRUPT"," MODUS"]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[r.jsx("button",{onClick:i,disabled:e.status==="PLAYING"||s,className:`w-full py-4 rounded-xl font-black uppercase tracking-widest text-sm transition-all shadow-lg ${e.status==="PLAYING"?"bg-emerald-600/20 text-emerald-400 cursor-default":"bg-emerald-600 hover:bg-emerald-500 text-white shadow-emerald-600/20"}`,children:e.status==="PLAYING"?" SPILL AKTIVT":" START SPILL"}),r.jsxs("button",{onClick:a,disabled:s,className:`w-full py-3 rounded-xl font-black uppercase tracking-widest text-[10px] transition-all border flex items-center justify-center gap-2 ${e.isPublic?"bg-indigo-600/10 text-indigo-400 border-indigo-500/20 hover:bg-indigo-600 hover:text-white":"bg-slate-800 text-slate-500 border-white/5 hover:border-indigo-500/20"}`,children:[e.isPublic?r.jsx(hH,{size:14}):r.jsx(Ml,{size:14}),e.isPublic?"OFFENTLIG SERVER":"PRIVAT (KUN PIN)"]}),r.jsx("button",{onClick:l,disabled:s,className:"w-full py-3 rounded-xl font-black uppercase tracking-widest text-[10px] bg-amber-600/10 text-amber-500 hover:bg-amber-600 hover:text-white transition-all border border-amber-500/20",children:" REPARER DATA"}),r.jsx("button",{onClick:o,disabled:s,className:"w-full py-3 rounded-xl font-black uppercase tracking-widest text-[10px] bg-rose-600/10 text-rose-500 hover:bg-rose-600 hover:text-white transition-all border border-rose-500/20",children:" NULLSTILL ALT"})]})]}),r.jsxs("div",{className:"p-8 space-y-8 flex-1 overflow-y-auto custom-scrollbar",children:[r.jsxs("section",{children:[r.jsx("h3",{className:"text-[10px] font-black uppercase text-slate-500 tracking-[0.2em] mb-4",children:"Verdensstyring"}),r.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[r.jsxs("div",{className:"bg-white/5 p-4 rounded-2xl border border-white/5 group",children:[r.jsxs("div",{className:"flex justify-between items-center mb-3",children:[r.jsxs("span",{className:"text-xs font-bold text-slate-400 italic",children:["rstid: ",((w=Us[(S=e.world)==null?void 0:S.season])==null?void 0:w.label)||"Ukjent"]}),r.jsx("span",{className:"text-2xl group-hover:rotate-12 transition-transform",children:{Spring:"",Summer:"",Autumn:"",Winter:""}[((E=e.world)==null?void 0:E.season)||"Spring"]})]}),r.jsx("button",{onClick:c,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white py-2 rounded-lg font-black uppercase text-[10px] transition-all",children:"Neste rstid"})]}),r.jsxs("div",{className:"bg-white/5 p-4 rounded-2xl border border-white/5 group",children:[r.jsxs("div",{className:"flex justify-between items-center mb-3",children:[r.jsxs("span",{className:"text-xs font-bold text-slate-400 italic",children:["Vr: ",((j=e.world)==null?void 0:j.weather)||"Klart"]}),r.jsx("span",{className:"text-2xl group-hover:scale-110 transition-transform",children:""})]}),r.jsx("button",{onClick:u,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white py-2 rounded-lg font-black uppercase text-[10px] transition-all",children:"Endre Vr"})]})]})]}),r.jsxs("section",{children:[r.jsx("h3",{className:"text-[10px] font-black uppercase text-slate-500 tracking-[0.2em] mb-4",children:"Massehandlinger"}),r.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[r.jsx("button",{onClick:d,className:"w-full bg-amber-600/10 hover:bg-amber-600 text-amber-500 hover:text-white border border-amber-600/20 py-4 rounded-2xl font-black uppercase text-[10px] transition-all flex items-center justify-center gap-2",children:" Skattlegg Riket"}),r.jsx("button",{onClick:f,className:"w-full bg-blue-600/10 hover:bg-blue-600 text-blue-500 hover:text-white border border-blue-600/20 py-4 rounded-2xl font-black uppercase text-[10px] transition-all flex items-center justify-center gap-2 text-center",children:" Gjenopprett Stamina"}),r.jsx("button",{onClick:h,className:"w-full bg-indigo-600/10 hover:bg-indigo-600 text-indigo-500 hover:text-white border border-indigo-600/20 py-4 rounded-2xl font-black uppercase text-[10px] transition-all flex items-center justify-center gap-2 text-center",children:" Nullstill Politisk Uro"}),r.jsx("button",{onClick:m,className:"w-full bg-rose-600/10 hover:bg-rose-600 text-rose-500 hover:text-white border border-rose-600/20 py-4 rounded-2xl font-black uppercase text-[10px] transition-all flex items-center justify-center gap-2 text-center mt-2",children:" Kast ut alle"})]})]}),r.jsxs("section",{children:[r.jsx("h3",{className:"text-[10px] font-black uppercase text-slate-500 tracking-[0.2em] mb-4",children:"Dataanalyse"}),r.jsx("div",{className:"grid grid-cols-1 gap-3",children:r.jsx("button",{onClick:p,disabled:s,className:"w-full bg-indigo-500 hover:bg-indigo-400 text-white py-4 rounded-2xl font-black uppercase text-[10px] shadow-lg shadow-indigo-600/20 transition-all active:scale-95 flex items-center justify-center gap-2",children:" EKSPORTER FULL LOGG"})})]}),r.jsxs("section",{children:[r.jsx("h3",{className:"text-[10px] font-black uppercase text-slate-500 tracking-[0.2em] mb-4 text-center",children:"Intervensjoner"}),r.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsx("button",{onClick:v,className:"bg-rose-600/80 hover:bg-rose-600 text-white py-4 rounded-2xl font-black uppercase text-[10px] shadow-lg shadow-rose-600/20 transition-all active:scale-95",children:" Event"}),r.jsx("button",{onClick:x,disabled:!!e.activeVote,className:"bg-amber-600/80 hover:bg-amber-600 text-white py-4 rounded-2xl font-black uppercase text-[10px] shadow-lg shadow-amber-600/20 disabled:opacity-20 text-center transition-all active:scale-95",children:" Tinget"})]}),r.jsxs("section",{className:"bg-white/5 border border-white/5 rounded-[2.5rem] p-6 space-y-4 shadow-inner",children:[r.jsx("h3",{className:"text-[10px] font-black uppercase text-indigo-400 tracking-[0.2em] mb-2 px-2",children:"Legg til Karakter"}),r.jsxs("div",{className:"space-y-3",children:[r.jsx("input",{type:"text",placeholder:"Navn...",value:y.name,onChange:O=>k({...y,name:O.target.value}),className:"w-full bg-black/40 border border-white/5 rounded-xl px-4 py-3 text-xs font-bold text-white placeholder:text-slate-600 focus:border-indigo-500/50 focus:ring-0 transition-all"}),r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsx("select",{value:y.role,onChange:O=>k({...y,role:O.target.value}),className:"bg-black/40 border border-white/5 rounded-xl px-3 py-2 text-[10px] font-black uppercase text-slate-400 focus:ring-0",children:Object.keys(rc).map(O=>r.jsx("option",{value:O,children:O},O))}),r.jsxs("div",{className:"flex items-center gap-2 bg-black/40 border border-white/5 rounded-xl px-3 py-2",children:[r.jsx("span",{className:"text-[8px] font-black text-slate-600",children:"LVL"}),r.jsx("input",{type:"number",value:y.level,onChange:O=>k({...y,level:parseInt(O.target.value)}),className:"w-full bg-transparent border-none p-0 text-xs font-black text-white focus:ring-0 font-mono"})]})]}),r.jsx("button",{onClick:N,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-xl font-black uppercase text-[10px] shadow-lg shadow-indigo-600/20 transition-all active:scale-95",children:" SKAP KARAKTER"})]})]})]})]}),r.jsxs("section",{children:[r.jsx("h3",{className:"text-[10px] font-black uppercase text-slate-500 tracking-[0.2em] mb-4",children:"Landsby-fokus"}),(A=e.world)!=null&&A.settlement?r.jsx("div",{className:"text-xs text-slate-500 italic",children:"Landsbyen er initialisert."}):r.jsx("button",{onClick:g,className:"w-full bg-amber-500 text-black py-4 rounded-2xl font-black uppercase text-[10px] animate-pulse",children:"Initialiser Landsby"})]})]})]})}),A$=Ne.memo(({players:t,onKick:e,onLevelChange:s,onRoleChange:n,onRegionChange:i,onControl:a,onGiveGold:l,onGiveResource:o,onGiveItem:c})=>{const[u,d]=_.useState({}),[f,h]=_.useState({}),[m,v]=_.useState({});return r.jsxs("section",{children:[r.jsx("h2",{className:"text-3xl font-black text-white px-2 mb-8 tracking-tighter",children:"Innbyggere i Riket"}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[Object.values(t||{}).map(x=>{var b,g,p,y,k,N,S;return r.jsxs("div",{className:"relative bg-slate-900/80 border border-white/5 p-6 rounded-[2rem] hover:border-indigo-500/30 transition-all group",children:[r.jsx("button",{onClick:w=>{w.stopPropagation(),e(x.id,x.name)},className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-rose-500/10 text-rose-500 opacity-0 group-hover:opacity-100 transition-all hover:bg-rose-500 hover:text-white flex items-center justify-center font-bold text-xs",title:"Kast ut spiller",children:""}),r.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[r.jsx("div",{className:"w-12 h-12 bg-indigo-600/20 rounded-xl flex items-center justify-center text-2xl shrink-0 group-hover:scale-110 transition-transform overflow-hidden",children:x.avatar?r.jsx("img",{src:x.avatar,alt:x.role,className:"w-full h-full object-cover"}):{KING:"",BARON:"",PEASANT:"",SOLDIER:"",MERCHANT:""}[x.role]||""}),r.jsxs("div",{className:"min-w-0 flex-1",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsx("h3",{className:"text-lg font-black text-white truncate leading-tight",children:x.name}),r.jsxs("div",{className:"flex items-center gap-1 bg-white/5 px-2 py-0.5 rounded-lg border border-white/5",children:[r.jsx("span",{className:"text-[8px] font-black text-slate-500 uppercase",children:"LVL"}),r.jsx("input",{type:"number",value:((b=x.stats)==null?void 0:b.level)||1,onChange:w=>s(x.id,parseInt(w.target.value)),className:"w-8 bg-transparent border-none p-0 text-[10px] font-black text-indigo-400 focus:ring-0 text-center font-mono"})]})]}),r.jsxs("div",{className:"flex flex-col gap-1 mt-1",children:[r.jsx("select",{value:x.role,onChange:w=>n(x.id,w.target.value),className:"bg-indigo-500/10 text-indigo-400 text-[10px] font-black uppercase tracking-widest border-none p-0 focus:ring-0 cursor-pointer hover:text-white transition-colors w-full text-left",children:Object.entries(rc).map(([w,E])=>r.jsx("option",{value:w,className:"bg-slate-900",children:E.label},w))}),r.jsxs("select",{value:x.regionId||"region_ost",onChange:w=>i(x.id,w.target.value),className:"bg-white/5 text-slate-500 text-[9px] font-bold uppercase tracking-wider border-none p-0 focus:ring-0 cursor-pointer hover:text-slate-300 transition-colors w-full text-left",children:[r.jsx("option",{value:"capital",className:"bg-slate-900",children:"Hovedstaden"}),r.jsx("option",{value:"region_ost",className:"bg-slate-900",children:"Baroniet st"}),r.jsx("option",{value:"region_vest",className:"bg-slate-900",children:"Baroniet Vest"})]})]})]})]}),x.id.startsWith("bot_")&&((g=x.status)==null?void 0:g.thought)&&r.jsxs("div",{className:"mb-4 p-3 bg-indigo-500/10 rounded-xl border border-indigo-500/20",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("span",{className:"text-[8px] font-black text-indigo-400 uppercase tracking-widest",children:"Mental Tilstand"}),r.jsx("div",{className:"flex-1 h-[1px] bg-indigo-500/20"})]}),r.jsxs("p",{className:"text-[10px] text-white/90 font-bold leading-relaxed mb-2",children:['"',x.status.thought,'"']}),r.jsxs("div",{className:"flex justify-between items-center text-[8px] font-black uppercase tracking-tighter text-indigo-400/60",children:[r.jsxs("span",{children:["Handling: ",x.status.lastAction]}),r.jsxs("span",{children:["Tid: ",x.status.lastTick?new Date(x.status.lastTick).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"N"]})]})]}),r.jsxs("div",{className:"space-y-3 mb-6",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between text-[8px] font-black uppercase text-slate-500 mb-1",children:[r.jsx("span",{children:"Stamina"}),r.jsxs("span",{className:"text-white",children:[x.status.stamina,"%"]})]}),r.jsx("div",{className:"h-1 bg-slate-800 rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full bg-emerald-500",style:{width:`${x.status.stamina}%`}})})]}),r.jsxs("div",{className:"flex justify-between items-center text-xs font-bold",children:[r.jsx("span",{className:"text-slate-500",children:"Gull:"}),r.jsxs("span",{className:"text-amber-500 font-black",children:[x.resources.gold,""]})]})]}),r.jsxs("div",{className:"flex flex-wrap gap-1 mb-6",children:[(p=x.upgrades)==null?void 0:p.map(w=>r.jsx("span",{className:"text-[7px] font-black bg-indigo-500/10 text-indigo-400 px-1.5 py-0.5 rounded border border-indigo-500/20 uppercase tracking-tighter",children:w},w)),(!x.upgrades||x.upgrades.length===0)&&r.jsx("span",{className:"text-[7px] font-bold text-slate-700 uppercase italic",children:"Ingen oppgraderinger"})]}),r.jsxs("button",{onClick:()=>a(x.id),className:"w-full py-4 rounded-2xl bg-indigo-600/10 hover:bg-indigo-600 text-indigo-400 hover:text-white font-black uppercase text-[10px] tracking-widest transition-all border border-indigo-500/20 flex items-center justify-center gap-2 group/btn",children:[r.jsx("span",{className:"group-hover/btn:scale-125 transition-transform",children:""}),"Styr spiller"]}),r.jsxs("div",{className:"mt-4 pt-4 border-t border-white/5 flex flex-col gap-2",children:[r.jsxs("div",{className:"flex gap-2",children:[r.jsx("input",{type:"number",placeholder:"Gull...",value:u[x.id]||"",onChange:w=>d({...u,[x.id]:parseInt(w.target.value)||0}),className:"flex-1 bg-black/40 border border-white/5 rounded-xl px-3 py-2 text-[10px] font-black text-white focus:border-indigo-500/50 transition-all font-mono"}),r.jsx("button",{onClick:()=>{const w=u[x.id]||0;w>0&&(l(x.id,w),d({...u,[x.id]:0}))},className:"bg-emerald-600/20 hover:bg-emerald-600 text-emerald-400 hover:text-white border border-emerald-500/30 px-3 py-2 rounded-xl text-[8px] font-black uppercase transition-all",children:"GI GULL"})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("select",{value:((y=m[x.id])==null?void 0:y.resourceId)||"",onChange:w=>{var E;return v({...m,[x.id]:{resourceId:w.target.value,amount:((E=m[x.id])==null?void 0:E.amount)||10}})},className:"flex-[2] bg-black/40 border border-white/5 rounded-xl px-2 py-2 text-[10px] font-bold text-amber-300 focus:border-amber-500/50 transition-all cursor-pointer",children:[r.jsx("option",{value:"",children:"Velg ressurs..."}),r.jsx("optgroup",{label:"BASISVARER",className:"bg-slate-900 text-slate-500",children:["gold","grain","wood","stone","iron_ore","honey","meat","wool","egg"].map(w=>{var E,j;return r.jsxs("option",{value:w,className:"text-white",children:[(E=Ie[w])==null?void 0:E.icon," ",(j=Ie[w])==null?void 0:j.label]},w)})}),r.jsx("optgroup",{label:"FOREDLET",className:"bg-slate-900 text-slate-500",children:["flour","bread","plank","iron_ingot","cloth","glass","omelette"].map(w=>{var E,j;return r.jsxs("option",{value:w,className:"text-white",children:[(E=Ie[w])==null?void 0:E.icon," ",(j=Ie[w])==null?void 0:j.label]},w)})}),r.jsx("optgroup",{label:"MARITIMT",className:"bg-slate-900 text-slate-500",children:["flax","linen_canvas","tar","fish_raw","fish_cooked","silk","spice","cannonball"].map(w=>{var E,j;return r.jsxs("option",{value:w,className:"text-white",children:[(E=Ie[w])==null?void 0:E.icon," ",(j=Ie[w])==null?void 0:j.label]},w)})}),r.jsx("optgroup",{label:"KRIG",className:"bg-slate-900 text-slate-500",children:["siege_sword","siege_armor"].map(w=>{var E,j;return r.jsxs("option",{value:w,className:"text-white",children:[(E=Ie[w])==null?void 0:E.icon," ",(j=Ie[w])==null?void 0:j.label]},w)})}),r.jsx("optgroup",{label:"APOTEKER",className:"bg-slate-900 text-slate-500",children:["minor_stamina_potion","herbal_balm","focus_brew","strength_tincture","masters_draught","elixir_of_life"].map(w=>{var E,j;return r.jsxs("option",{value:w,className:"text-white",children:[(E=Ie[w])==null?void 0:E.icon," ",(j=Ie[w])==null?void 0:j.label]},w)})}),r.jsx("optgroup",{label:"ANNET",className:"bg-slate-900 text-slate-500",children:r.jsx("option",{value:"favor",className:"text-white",children:" Gunst"})})]}),r.jsx("input",{type:"number",placeholder:"#",value:((k=m[x.id])==null?void 0:k.amount)||10,onChange:w=>{var E;return v({...m,[x.id]:{resourceId:((E=m[x.id])==null?void 0:E.resourceId)||"",amount:parseInt(w.target.value)||1}})},className:"w-12 bg-black/40 border border-white/5 rounded-xl px-2 py-2 text-[10px] font-black text-white focus:border-amber-500/50 transition-all font-mono text-center"}),r.jsx("button",{onClick:()=>{const w=m[x.id];w&&w.resourceId&&w.amount>0&&(o(x.id,w.resourceId,w.amount),v({...m,[x.id]:{resourceId:"",amount:10}}))},className:"bg-amber-600/20 hover:bg-amber-600 text-amber-400 hover:text-white border border-amber-500/30 px-3 py-2 rounded-xl text-[8px] font-black uppercase transition-all",children:"GI"})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("select",{value:((N=f[x.id])==null?void 0:N.itemId)||"",onChange:w=>{var E;return h({...f,[x.id]:{itemId:w.target.value,amount:((E=f[x.id])==null?void 0:E.amount)||1}})},className:"flex-[2] bg-black/40 border border-white/5 rounded-xl px-2 py-2 text-[10px] font-bold text-slate-300 focus:border-indigo-500/50 transition-all cursor-pointer",children:[r.jsx("option",{value:"",children:"Velg..."}),Object.values(Oe).map(w=>r.jsxs("option",{value:w.id,children:[w.icon," ",w.name]},w.id))]}),r.jsx("input",{type:"number",placeholder:"#",value:((S=f[x.id])==null?void 0:S.amount)||1,onChange:w=>{var E;return h({...f,[x.id]:{itemId:((E=f[x.id])==null?void 0:E.itemId)||"",amount:parseInt(w.target.value)||1}})},className:"w-12 bg-black/40 border border-white/5 rounded-xl px-2 py-2 text-[10px] font-black text-white focus:border-indigo-500/50 transition-all font-mono text-center"}),r.jsx("button",{onClick:()=>{const w=f[x.id];w&&w.itemId&&w.amount>0&&(c(x.id,w.itemId,w.amount),h({...f,[x.id]:{itemId:"",amount:1}}))},className:"bg-indigo-600/20 hover:bg-indigo-600 text-indigo-400 hover:text-white border border-indigo-500/30 px-3 py-2 rounded-xl text-[8px] font-black uppercase transition-all",children:"GI"})]})]})]},x.id)}),Object.keys(t||{}).length===0&&r.jsxs("div",{className:"col-span-full py-20 text-center border-2 border-dashed border-white/5 rounded-[3rem]",children:[r.jsx("span",{className:"text-6xl block mb-4 opacity-20",children:""}),r.jsx("p",{className:"text-slate-500 font-bold uppercase tracking-widest text-xs",children:"Venter p at understter skal ankomme..."})]})]})]})}),R$=Ne.memo(({roomData:t})=>{const e=s=>s?Array.isArray(s)?s:Object.values(s).sort((n,i)=>n.timestamp-i.timestamp):[];return r.jsxs("aside",{className:"w-80 border-l border-white/10 bg-slate-900/50 backdrop-blur-xl flex flex-col z-20 shadow-2xl overflow-hidden",children:[r.jsxs("div",{className:"p-8 border-b border-white/5 bg-black/20 shrink-0",children:[r.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-amber-500 mb-6 flex items-center justify-between",children:["Rikets Formue",r.jsx("div",{className:"w-2 h-2 bg-amber-500 rounded-full animate-pulse shadow-[0_0_10px_rgba(245,158,11,0.5)]"})]}),r.jsxs("div",{className:"space-y-4",children:[Object.values(t.players||{}).sort((s,n)=>(n.resources.gold||0)-(s.resources.gold||0)).slice(0,5).map((s,n)=>r.jsxs("div",{className:"flex justify-between items-center group",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("span",{className:"text-xs font-black text-slate-600 font-mono",children:["#",n+1]}),r.jsx("span",{className:"text-sm font-bold text-white group-hover:translate-x-1 transition-transform",children:s.name})]}),r.jsxs("span",{className:"text-sm font-black text-amber-400",children:[s.resources.gold,""]})]},s.id)),Object.keys(t.players||{}).length===0&&r.jsx("p",{className:"text-[10px] text-slate-600 font-bold italic text-center py-4",children:"Ingen data tilgjengelig..."})]})]}),r.jsxs("div",{className:"p-8 border-b border-white/5 shrink-0",children:[r.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-indigo-400 mb-6",children:"Markedsanalyse"}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[Object.entries(t.market||{}).slice(0,4).map(([s,n])=>{const i=Ie[s]||{label:s};return r.jsxs("div",{className:"bg-white/5 p-3 rounded-xl border border-white/5",children:[r.jsx("div",{className:"text-[8px] font-black uppercase text-slate-500 mb-1",children:i.label}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"text-xs font-black text-white",children:n.stock}),r.jsxs("span",{className:"text-[10px] font-mono text-emerald-400",children:[n.price.toFixed(1),"g"]})]})]},s)}),Object.entries(t.market||{}).slice(0,4).length===0&&r.jsx("div",{className:"col-span-2 text-[10px] text-slate-600 font-bold italic text-center py-4",children:"Ingen markedsdata..."})]})]}),r.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[r.jsx("div",{className:"p-8 pb-4 shrink-0",children:r.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-rose-500 flex items-center gap-2",children:[r.jsx("span",{className:"w-2 h-2 bg-rose-600 rounded-full animate-pulse shadow-[0_0_10px_rgba(225,29,72,0.5)]"}),"Global Logg"]})}),r.jsxs("div",{className:"flex-1 overflow-y-auto px-6 space-y-3 pb-8 custom-scrollbar",children:[r.jsx(kt,{initial:!1,children:e(t.messages).slice().reverse().map((s,n)=>{const i=typeof s=="object"&&s.id||n;return r.jsx(q.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,scale:.95},className:"bg-indigo-950/20 border-l-2 border-indigo-500/50 p-4 rounded-r-2xl",children:r.jsx("p",{className:"text-[10px] font-medium leading-relaxed text-slate-400 antialiased italic font-serif opacity-80",children:typeof s=="object"?s.text||JSON.stringify(s):s})},i)})}),e(t.messages).length===0&&r.jsxs("div",{className:"h-full flex flex-col items-center justify-center opacity-20 py-20",children:[r.jsx("span",{className:"text-4xl mb-4",children:""}),r.jsx("p",{className:"text-[8px] font-black uppercase tracking-[0.2em]",children:"Arkivet er tomt"})]})]})]})]})});class C${constructor(e){et(this,"genome");this.genome=e}decide(e,s){var c;const n=[],i=e.status.stamina,a=(1-i/100)*this.genome.weights.hungerThreshold*5;e.resources.bread>0&&i<80&&n.push({action:{type:"EAT"},score:a,reason:"Sulten"}),i<50&&n.push({action:{type:"SLEEP"},score:(1-i/100)*this.genome.weights.restFocus*3,reason:"Trtt"}),n.push({action:{type:"CHOP"},score:this.genome.weights.gatherWood*this.getNeedMultiplier(e,"wood"),reason:"Trengte ved"}),n.push({action:{type:"QUARRY"},score:this.genome.weights.gatherStone*this.getNeedMultiplier(e,"stone"),reason:"Trengte stein"}),n.push({action:{type:"MINE"},score:this.genome.weights.gatherIron*this.getNeedMultiplier(e,"iron_ore"),reason:"Trengte jernmalm"}),n.push({action:{type:"WORK"},score:this.genome.weights.gatherGrain*this.getNeedMultiplier(e,"grain"),reason:"Trengte korn"});const l=((c=s.markets)==null?void 0:c[e.regionId])||s.market;l&&Object.entries(e.resources).forEach(([u,d])=>{if(u==="gold")return;const f=l[u];if(f&&d>10){const h=f.price;n.push({action:{type:"SELL",itemId:u,amount:Math.floor(d/2)},score:this.genome.weights.marketAggression*(h/20)*(d/50),reason:`Selger ${u} for gull`})}}),e.resources.gold>200&&n.push({action:{type:"CONTRIBUTE_TO_UPGRADE",buildingId:"great_hall"},score:this.genome.weights.promotionFocus*(e.resources.gold/1e3),reason:"Vil bli mektigere"});const o=n.filter(u=>{const d=typeof u.action=="string"?u.action:u.action.type,f=Rl[d];if(!f)return!0;if(i<(f.stamina||0))return!1;for(const[h,m]of Object.entries(f))if(h!=="stamina"&&(e.resources[h]||0)<m)return!1;return!0});return o.length===0?{action:"IDLE",score:0,reason:"Ingenting  gjre"}:(o.sort((u,d)=>d.score-u.score),o[0])}getNeedMultiplier(e,s){const n=e.resources[s]||0;return n<5?2:n<20?1.2:n>100?.5:1}}const I$=(t=0)=>({id:`genome_${Date.now()}_${Math.floor(Math.random()*1e3)}`,generation:t,weights:{gatherWood:Math.random()*2,gatherStone:Math.random()*2,gatherIron:Math.random()*2,gatherGrain:Math.random()*2,marketAggression:Math.random()*2,savingsFocus:Math.random()*2,upgradeFocus:Math.random()*2,hungerThreshold:.2+Math.random()*.6,restFocus:Math.random()*2,promotionFocus:Math.random()*2,contributionFocus:Math.random()*2}}),O$=(t,e=.1)=>{const s={...t.weights};return Object.keys(s).forEach(n=>{if(Math.random()<.2){const i=(Math.random()*2-1)*e;s[n]=Math.max(0,Math.min(2,s[n]+i))}}),{...t,id:`genome_${Date.now()}_${Math.floor(Math.random()*1e3)}`,weights:s,generation:t.generation+1,parents:[t.id],fitness:void 0}},T_="eiriksbok_ai_top_genomes";class yp{static calculateFitness(e,s){const n=(e.resources.gold||0)+Object.values(e.resources).reduce((o,c)=>o+(typeof c=="number"?c:0),0)*.5,a={PEASANT:1,SOLDIER:5,MERCHANT:10,BARON:50,KING:200}[e.role]||1,l=Math.max(1,(Date.now()-s)/6e4);return(n+a*100)/l}static saveTopGenomes(e){const s=[...e].filter(n=>n.fitness!==void 0).sort((n,i)=>(i.fitness||0)-(n.fitness||0)).slice(0,3);localStorage.setItem(T_,JSON.stringify(s))}static getTopGenomes(){const e=localStorage.getItem(T_);if(!e)return[];try{return JSON.parse(e)}catch{return[]}}static getNextGenerationGenome(){const e=this.getTopGenomes();if(e.length===0)return I$(0);const s=e[Math.floor(Math.random()*e.length)];return O$(s)}}const vj={CHOP:["AXE","OFF_HAND"],MINE:["PICKAXE","OFF_HAND"],QUARRY:["CHISEL","OFF_HAND"],WORK:["SCYTHE","OFF_HAND"],RAID:["MAIN_HAND","OFF_HAND","BODY","HEAD","FEET"],DEFEND:["MAIN_HAND","OFF_HAND","BODY","HEAD","FEET"],PATROL:["MAIN_HAND","OFF_HAND","BODY"],EXPLORE:["MAIN_HAND","OFF_HAND","BODY","HEAD","FEET"],CRAFT:["MAIN_HAND","AXE","PICKAXE","SCYTHE","HAMMER"],HUNT:["MAIN_HAND","BOW","TRAP"],FORAGE:["MAIN_HAND","TRAP"],GATHER_WOOL:["MAIN_HAND","OFF_HAND"],SAWMILL:["MAIN_HAND","OFF_HAND"],PLANT:["MAIN_HAND","OFF_HAND"],HARVEST:["SCYTHE","OFF_HAND","MAIN_HAND"]},_p=(t,e)=>{const s=vj[e];return!s||!t.equipment?[]:s.map(n=>{var i;return(i=t.equipment)==null?void 0:i[n]}).filter(n=>{var i,a;if(!n)return!1;if((i=n.relevantActions)!=null&&i.includes(e))return!0;if(!n.relevantActions){const l=n.id.split("_").slice(0,2).join("_"),o=Oe[n.id]||Oe[l]||Object.values(Oe).find(c=>n.id.startsWith(c.id));return(a=o==null?void 0:o.relevantActions)!=null&&a.includes(e)?!0:!o||!o.relevantActions}return!1})},Dl=(t,e)=>{const s=vj[e];return!s||!t.equipment?[]:s.filter(n=>{var a,l,o;const i=(a=t.equipment)==null?void 0:a[n];if(!i)return!1;if((l=i.relevantActions)!=null&&l.includes(e))return!0;if(!i.relevantActions){const c=i.id.split("_").slice(0,2).join("_"),u=Oe[i.id]||Oe[c]||Object.values(Oe).find(d=>i.id.startsWith(d.id));return(o=u==null?void 0:u.relevantActions)!=null&&o.includes(e)?!0:!u||!u.relevantActions}return!1})},yj=(t,e,s="Spring",n="Clear",i=0)=>{var d;let a=typeof e=="string"?e:e.type,l=typeof e=="object"?{...e}:{};a.startsWith("REFINE_")&&!Xi[a]?(l.recipeId=a.replace("REFINE_","").toLowerCase(),a="REFINE"):a.startsWith("CRAFT_")&&!Hs[a]?(l.subType=a.replace("CRAFT_","").toLowerCase(),a="CRAFT"):Hs[a]&&(l.subType=a,a="CRAFT");const o=_p(t,a);for(const f of o)if(f.durability<=0)return{success:!1,reason:`delagt: ${f.name}`};if(a==="GATHER_WOOL"&&o.length===0)return{success:!1,reason:"Du mangler Saks"};let c={};const u=Rl[a];if(u&&(c={...u}),a==="REFINE"||a==="CRAFT"){let f;a==="REFINE"&&(f=Xi[l.recipeId]),a==="CRAFT"&&(f=Hs[l.subType]),f&&(f.stamina!==void 0&&(c.stamina=f.stamina),f.input&&Object.entries(f.input).forEach(([h,m])=>{c[h]=(c[h]||0)+m}))}if(Object.keys(c).length>0){const f=Us[s],h=Dn[n],m=(f==null?void 0:f.staminaMod)||1,v=(h==null?void 0:h.staminaMod)||1,x=Qi(i)==="NIGHT",b=x?1.2:1,g=c.stamina||0;if(a==="SLEEP"&&!x)return{success:!1,reason:"Du kan bare sove nr det er natt"};if(a==="PLANT"&&s==="Winter")return{success:!1,reason:"Bakken er frossen - du kan ikke s om vinteren"};if(l.locationId==="farm_well"||l.locationId==="well_water"||a==="GATHER_WATER"){const N=l.locationId||(a==="GATHER_WATER"?"well_water":null);if(N){const S=(d=t.activeProcesses)==null?void 0:d.find(w=>w.type==="WELL"&&w.locationId===N);if(S&&S.readyAt>Date.now())return{success:!1,reason:"Brnnen fyller seg med vann..."}}}const y=Math.ceil(g*m*v*b);if((t.status.stamina||0)<y)return{success:!1,reason:`Du mangler ${Math.ceil(y-(t.status.stamina||0))} energi`};const k={bread:"brd",gold:"gull",wood:"tre",flour:"mel",grain:"korn",iron_ingot:"jernbarrer",plank:"planker",stone:"stein",meat:"kjtt",honey:"honning",wool:"ull",iron_ore:"jernmalm",cloth:"stoff",stamina:"energi"};for(const[N,S]of Object.entries(c)){if(N==="stamina")continue;const w=t.resources[N]||0;if(w<S){const E=k[N]||N;return{success:!1,reason:`Du mangler ${S-w} ${E}`}}}}return{success:!0}},_j=(t,e="Spring",s="Clear",n=0)=>{let i=typeof t=="string"?t:t.type,a=typeof t=="object"?{...t}:{};i.startsWith("REFINE_")&&!Xi[i]?(a.recipeId=i.replace("REFINE_","").toLowerCase(),i="REFINE"):i.startsWith("CRAFT_")&&!Hs[i]?(a.subType=i.replace("CRAFT_","").toLowerCase(),i="CRAFT"):Hs[i]&&(a.subType=i,i="CRAFT");let l={};const o=Rl[i];if(o&&(l={...o}),i==="REFINE"||i==="CRAFT"){let d;i==="REFINE"&&(d=Xi[a.recipeId]),i==="CRAFT"&&(d=Hs[a.subType]),d&&(d.stamina!==void 0&&(l.stamina=d.stamina),d.input&&Object.entries(d.input).forEach(([f,h])=>{l[f]=(l[f]||0)+h}))}if(Object.keys(l).length===0)return null;const c=[];if(l.stamina){const d=Us[e],f=Dn[s],m=Qi(n)==="NIGHT"?1.2:1,v=((d==null?void 0:d.staminaMod)||1)*((f==null?void 0:f.staminaMod)||1)*m,x=Math.ceil(l.stamina*v);let b="-";l.stamina<0&&(b="+"),c.push(`${b}${Math.abs(x)}`)}const u={bread:"",gold:"",wood:"",flour:"",grain:"",iron_ingot:"",plank:"",stone:"",meat:"",honey:"",wool:"",iron_ore:"",cloth:""};for(const[d,f]of Object.entries(l)){if(d==="stamina")continue;const h=f,m=u[d]||d;c.push(`-${h}${m}`)}return c.join(" ")},M$=(t,e,s)=>{t.activeProcesses||(t.activeProcesses=[]),t.activeProcesses.push({id:`cd_${Date.now()}_${Math.random().toString(36).substr(2,5)}`,type:"COOLDOWN",locationId:e,itemId:"cooldown",notified:!1,startedAt:Date.now(),readyAt:Date.now()+s,duration:s})},D$=t=>{const{actor:e,action:s,localResult:n}=t,i=s.processId;if(!e.activeProcesses)return n.success=!1,n.message="Ingen aktive prosesser.",!1;const a=e.activeProcesses.find(o=>o.id===i);if(!a)return n.success=!1,n.message="Fant ikke avlingen (kanskje den allerede er ferdig?).",!1;if(a.type!=="CROP")return n.success=!1,n.message="Kan bare vedlikeholde avlinger.",!1;if(a.maintainCount===void 0&&(a.maintainCount=0),a.yieldBonus===void 0&&(a.yieldBonus=0),a.maintainCount>=3)return n.success=!1,n.message="Denne keren er allerede perfekt vedlikeholdt.",!1;a.maintainCount+=1,a.yieldBonus+=.05;const l=s.subType==="WEED"?"Lukte ugress":"Skremte vekk krka";return n.message=`${l}! (+5% Utbytte).`,!0},L$=t=>{var f;const{actor:e,action:s,localResult:n,timestamp:i}=t,a=s.cropId||"grain",l=_x[a];if(!l)return n.success=!1,n.message=`Ukjent grde: ${a}`,!1;if((((f=t.room.world)==null?void 0:f.season)||"Spring")==="Winter")return n.success=!1,n.message="Du kan ikke s om vinteren - bakken er frossen.",!1;e.activeProcesses||(e.activeProcesses=[]);const c=s.locationId||"grain_fields",u=e.activeProcesses.find(h=>h.type==="CROP"&&h.locationId===c);if(u){const h=Date.now();if(u.readyAt<=h){const m=e.activeProcesses.indexOf(u);m>-1&&e.activeProcesses.splice(m,1)}else return n.success=!1,n.message="Det vokser allerede noe her.",!1}const d={id:Math.random().toString(36).substr(2,9),type:"CROP",itemId:a,locationId:c,startedAt:Date.now(),duration:l.duration,readyAt:Date.now()+l.duration,notified:!1};return e.activeProcesses.push(d),n.message=`Sdde ${l.label}. Klar om ${Math.ceil(l.duration/6e4)} min.`,!0},P$=t=>{var y,k,N;const{actor:e,action:s,localResult:n,trackXp:i,damageTool:a,room:l}=t,o=Date.now(),c=s.locationId||"grain_fields",u=(y=e.activeProcesses)==null?void 0:y.findIndex(S=>S.locationId===c&&S.readyAt<=o);if(u===void 0||u===-1)return n.success=!1,n.message="Ingenting er klart til innhsting her.",!1;const d=e.activeProcesses[u];let f="",h=0,m="",v=0,x="FARMING";const b=_x[d.itemId],g=Xi[d.itemId];if(b){m=b.label,f=b.yieldResource;const S=s.performance||.5,w=b.minYield+(b.maxYield-b.minYield)*S,E=((k=l.world)==null?void 0:k.season)||"Spring",j=Us[E],A=1+(d.yieldBonus||0);h=Math.ceil(w*((j==null?void 0:j.yieldMod)||1)*A),v=Math.ceil(b.xp*(1+S))}else if(g){m=g.label,f=g.outputResource;const S=((N=g.output)==null?void 0:N.amount)||g.outputAmount||1,w=s.performance||.5;h=vn(e,S,"CRAFTING",{performance:w,isRefining:!0}),v=g.xp||10,x=g.skill||"CRAFTING"}else return n.success=!1,n.message="Ugyldig prosess-data.",!1;return e.activeProcesses.filter(S=>S.locationId===c&&S.readyAt<=o).forEach(S=>{const w=e.activeProcesses.indexOf(S);w>-1&&e.activeProcesses.splice(w,1)}),Dl(e,"WORK").forEach(S=>{a(S,te.DURABILITY.LOSS_WORK)}),e.resources[f]||(e.resources[f]=0),e.resources[f]+=h,n.utbytte.push({resource:f,amount:h}),n.message=`Hstet ${h} ${m}`,i(x,v),!0},B$=t=>{var b,g,p,y,k,N,S;const{actor:e,room:s,action:n,localResult:i,trackXp:a,damageTool:l}=t,o=((b=s.world)==null?void 0:b.activeLaws)||[];Dl(e,"WORK").forEach(w=>{l(w,te.DURABILITY.LOSS_WORK)});let c=1;o.includes("conscription")&&(c=.8);const u=te.YIELD.WORK_GRAIN+((g=e.upgrades)!=null&&g.includes("iron_plow")?5:0),d=((p=s.world)==null?void 0:p.season)||"Spring",f=((y=s.world)==null?void 0:y.weather)||"Clear",h=Us[d],m=Dn[f],v=n.performance||.5,x=vn(e,u,"FARMING",{season:(h==null?void 0:h.yieldMod)||1,weather:(m==null?void 0:m.yieldMod)||1,law:c,performance:v,actionType:"WORK",regionId:e.regionId});if(e.resources.grain=(e.resources.grain||0)+x,i.utbytte.push({resource:"grain",amount:x}),i.message=`Hstet ${x} korn`,a("FARMING",Math.ceil(Gc.WORK.xp*(1+v))),Math.random()<te.LUCKY_DROP.CHANCE+(((S=(N=(k=e.equipment)==null?void 0:k.HEAD)==null?void 0:N.stats)==null?void 0:S.luckBonus)||0)){const w=Math.ceil(x*.5),E=x+w;e.resources.grain+=w,i.utbytte.push({resource:"grain",amount:w,bonus:!0}),i.message=`Innhstet ${E} korn! (inkl. ${w} flaks)`}return!0},U$=t=>{var f,h,m,v;const{actor:e,room:s,action:n,localResult:i,trackXp:a,damageTool:l}=t,o=((f=s.world)==null?void 0:f.season)||"Spring";Dl(e,"CHOP").forEach(x=>{l(x,te.DURABILITY.LOSS_WORK)});let c=te.YIELD.CHOP_WOOD;o==="Summer"&&(c+=te.YIELD.SUMMER_WOOD_BONUS);const u=n.performance||.5,d=vn(e,c,"WOODCUTTING",{performance:u,actionType:"CHOP",regionId:e.regionId});if(e.resources.wood=(e.resources.wood||0)+d,i.utbytte.push({resource:"wood",amount:d}),i.message=`Felte ${d} ved`,a("WOODCUTTING",Math.ceil(Gc.CHOP.xp*(1+u))),Math.random()<te.LUCKY_DROP.CHANCE+(((v=(m=(h=e.equipment)==null?void 0:h.HEAD)==null?void 0:m.stats)==null?void 0:v.luckBonus)||0)){const x=Math.ceil(d*.5),b=d+x;e.resources.wood+=x,i.utbytte.push({resource:"wood",amount:x,bonus:!0}),i.message=`Felte ${b} ved! (inkl. ${x} flaks)`}return!0},A_=t=>{const{actor:e,action:s,localResult:n,trackXp:i,damageTool:a}=t,l=typeof s=="string"?s:s.type;Dl(e,l).forEach(h=>{a(h,te.DURABILITY.LOSS_WORK)});const o="MINING",c=l==="MINE"?te.YIELD.MINE_ORE:te.YIELD.QUARRY_STONE,u=l==="MINE"?"iron_ore":"stone",d=s.performance||.5,f=vn(e,c,o,{performance:d,actionType:l,regionId:e.regionId});return e.resources[u]=(e.resources[u]||0)+f,n.utbytte.push({resource:u,amount:f}),n.message=l==="MINE"?`Utvant ${f} jernmalm`:`Hogde ${f} stein`,i(o,Math.ceil(Gc.WORK.xp*(1+d))),!0},H$=t=>{const{actor:e,action:s,localResult:n,trackXp:i,damageTool:a}=t;Dl(e,"FORAGE").forEach(u=>{a(u,1)});const l=te.YIELD.FORAGE_BREAD,o=s.performance||.5,c=vn(e,l,"FARMING",{performance:o,actionType:"FORAGE"});return e.resources||(e.resources={}),e.resources.bread=(e.resources.bread||0)+c,n.utbytte.push({resource:"bread",amount:c}),n.message=`Sanket ${c} ndproviant (brd/br)`,i("FARMING",Math.ceil(Gc.FORAGE.xp*(1+o))),!0},$$=t=>{const{actor:e,action:s,localResult:n,trackXp:i,damageTool:a}=t;Dl(e,"HUNT").forEach(u=>{a(u,2)});const l=8,o=s.performance||.5,c=vn(e,l,"COMBAT",{performance:o,actionType:"HUNT"});return e.resources.meat=(e.resources.meat||0)+c,n.utbytte.push({resource:"meat",amount:c}),n.message=`Felte bytte og fikk ${c} kjtt`,i("COMBAT",Math.ceil(15*(1+o))),!0},G$=t=>{const{actor:e,action:s,localResult:n,trackXp:i}=t,a=6,l=s.performance||.5,o=vn(e,a,"FARMING",{performance:l,actionType:"GATHER_WOOL",requiresTool:!0});return o===0?(n.message="Du trenger en Saks for  klippe sauene!",!1):(e.resources.wool=(e.resources.wool||0)+o,n.utbytte.push({resource:"wool",amount:o}),n.message=`Klippet sauer og fikk ${o} ull`,i("FARMING",Math.ceil(10*(1+l))),!0)},F$=t=>{const{actor:e,action:s,localResult:n,trackXp:i}=t,a=s.locationId||"beehives";e.activeProcesses||(e.activeProcesses=[]);const l=e.activeProcesses.find(d=>d.type==="HIVE"&&d.locationId===a);if(l){if(l.readyAt>Date.now())return n.success=!1,n.message="Biene trenger hvile fr de kan lage mer honning.",!1;e.activeProcesses=e.activeProcesses.filter(d=>d.id!==l.id)}const o=4,c=s.performance||.5,u=vn(e,o,"FARMING",{performance:c,actionType:"GATHER_HONEY"});return e.resources.honey=(e.resources.honey||0)+u,n.utbytte.push({resource:"honey",amount:u}),n.message=`Hentet ${u} honning fra bikubene`,i("FARMING",Math.ceil(12*(1+c))),e.activeProcesses.push({id:"hive_"+Date.now(),type:"HIVE",itemId:"honey",locationId:a,startedAt:Date.now(),duration:3e5,readyAt:Date.now()+3e5,notified:!1}),!0},V$=t=>{const{actor:e,localResult:s}=t,n=5;if((e.resources.grain||0)<n)return s.success=!1,s.message=`Mangler korn. Trenger ${n} korn for  mate hnene.`,!1;if(e.activeProcesses||(e.activeProcesses=[]),e.activeProcesses.find(o=>o.type==="COOP"&&o.locationId==="chicken_coop"&&o.readyAt>Date.now()))return s.success=!1,s.message="Hnene har allerede mat.",!1;e.resources.grain-=n,s.utbytte.push({resource:"grain",amount:-n});const a=24e4,l={id:Math.random().toString(36).substr(2,9),type:"COOP",itemId:"egg",locationId:"chicken_coop",startedAt:Date.now(),duration:a,readyAt:Date.now()+a,notified:!1};return e.activeProcesses.push(l),s.message="Matet hnene. Egg klare om 4 minutter.",!0},z$=t=>{var o;const{actor:e,localResult:s,trackXp:n}=t,i=Date.now(),a=(o=e.activeProcesses)==null?void 0:o.findIndex(c=>c.type==="COOP"&&c.locationId==="chicken_coop"&&c.readyAt<=i);if(a===void 0||a===-1)return s.success=!1,s.message="Ingen egg  hente enn.",!1;e.activeProcesses.splice(a,1);const l=Math.floor(Math.random()*3)+3;return e.resources.egg||(e.resources.egg=0),e.resources.egg+=l,s.utbytte.push({resource:"egg",amount:l}),s.message=`Samlet ${l} egg.`,n("FARMING",15),!0},K$=t=>{var c,u,d,f,h,m,v,x,b;const{actor:e,room:s,action:n,localResult:i,trackXp:a}=t,l=n.subType,o=Hs[l];if(o){if((((f=(d=(u=(c=s.world)==null?void 0:c.settlement)==null?void 0:u.buildings)==null?void 0:d[o.buildingId])==null?void 0:f.level)||1)<o.level)return i.success=!1,i.message=`Mangler bygningsniv ${o.level} for  lage dette.`,!1;let p=!0;if(Object.entries(o.input).forEach(([y,k])=>{e.resources[y]<k&&(p=!1)}),p){Object.entries(o.input).forEach(([N,S])=>{e.resources[N]-=S});const y=o.outputItemId;if(Ie[y]||y==="omelette"){const N=o.outputAmount||1;e.resources[y]=(e.resources[y]||0)+N,i.utbytte.push({resource:y,amount:N});const S=(h=Ie[y])==null?void 0:h.label,w=(m=Oe[y])==null?void 0:m.name;i.message=`Laget ${N}x ${S||w||y}!`,a("CRAFTING",25*o.level),en(s.pin,"crafted",y,N)}else{const N=Oe[y];if(N){const S={...N,id:`${N.id}_${Date.now()}_${Math.floor(Math.random()*1e3)}`};e.inventory||(e.inventory=[]),e.inventory.push(S),i.utbytte.push({resource:y,amount:1}),i.message=`Smidde ${S.name}!`,a("CRAFTING",25*o.level),en(s.pin,"crafted",y,1)}}if(o.stamina){const N=((v=s.world)==null?void 0:v.season)||"Spring",S=((x=s.world)==null?void 0:x.weather)||"Clear",w=Ys(o.stamina,N,S,e.activeBuffs,((b=s.world)==null?void 0:b.gameTick)||0);(e.status.stamina||0)<w?(i.success=!1,i.message=`For lite stamina! Krever ${w}`):e.status.stamina-=w}}else return i.success=!1,i.message="Mangler ressurser for  smi.",!1}return!0},ir=t=>{var c,u,d,f,h,m,v,x,b;const{actor:e,room:s,action:n,localResult:i,trackXp:a}=t,l=n.recipeId,o=Xi[l];if(o){const g=((f=(d=(u=(c=s.world)==null?void 0:c.settlement)==null?void 0:u.buildings)==null?void 0:d[o.buildingId])==null?void 0:f.level)||1;if(o.requiredLevel&&g<o.requiredLevel)return i.success=!1,i.message=`Utvidelse kreves: ${o.buildingId} m vre Niv ${o.requiredLevel}.`,!1;let p=!0;Object.entries(o.input).forEach(([w,E])=>{e.resources[w]<E&&(p=!1)});const y=((h=s.world)==null?void 0:h.season)||"Spring",k=((m=s.world)==null?void 0:m.weather)||"Clear",N=o.stamina||0,S=Ys(N,y,k,e.activeBuffs,((v=s.world)==null?void 0:v.gameTick)||0);if((e.status.stamina||0)<S)return p=!1,i.message=`For lite stamina! Krever ${S}`,i.success=!1,!1;if(p){let w=n.performance||0;const j=Math.max(0,g-(o.requiredLevel||1))*.25,A=w*.5,O=1-Math.min(.9,j+A),L=o.duration?Math.max(o.duration*.1,o.duration*O):0;if(o.duration){e.activeProcesses||(e.activeProcesses=[]);const T=n.locationId||o.buildingId;if(e.activeProcesses.find(I=>I.locationId===T))return i.success=!1,i.message="Det pgr allerede en prosess her.",!1;Object.entries(o.input).forEach(([I,F])=>{e.resources[I]-=F}),e.status.stamina-=S;const D={id:Math.random().toString(36).substr(2,9),type:l==="flour"?"MILL":"CRAFT",itemId:l,locationId:T,startedAt:Date.now(),duration:L,readyAt:Date.now()+L,notified:!1};return e.activeProcesses.push(D),i.message=`Startet ${o.label.toLowerCase()}. Ferdig om ${Math.ceil(L/6e4)} minutter (-${S}).`,!0}Object.entries(o.input).forEach(([T,R])=>{e.resources[T]-=R}),e.status.stamina-=S,w=n.performance!==void 0?n.performance:.5;const Y=((x=o.output)==null?void 0:x.amount)||o.outputAmount||1,H=1+Math.max(0,g-(o.requiredLevel||1))*.2,M=vn(e,Y,"CRAFTING",{performance:w,isRefining:!0,upgrades:H}),U=e.resources[o.outputResource]||0;e.resources[o.outputResource]=U+M;const C=((b=Ie[o.outputResource])==null?void 0:b.label)||o.outputResource;i.utbytte.push({resource:o.outputResource,amount:M}),i.message=`Produserte ${M} ${C}`,a("CRAFTING",te.SKILLS.REFINING_XP),en(s.pin,"crafted",o.outputResource,M)}else return i.success=!1,i.message="Mangler ressurser til raffinering.",!1}return!0},Y$=t=>{var x,b;const{actor:e,action:s,localResult:n}=t,{targetSlot:i,itemUid:a,buildingId:l}=s;if(!l||!G0[l])return n.success=!1,n.message="Ugyldig reparasjonsstasjon.",!1;const o=G0[l];let c,u="gjenstanden";if(i?c=e.equipment[i]:a&&(c=(x=e.inventory)==null?void 0:x.find(g=>g.id===a)),!c)return n.success=!1,n.message="Fant ikke gjenstanden som skulle repareres.",!1;if(u=c.name,!o.slots.includes(c.type))return n.success=!1,n.message=`Denne stasjonen kan ikke reparere ${u}.`,!1;if(c.durability>=c.maxDurability)return n.success=!1,n.message=`${u} er allerede i perfekt stand.`,!1;const d=o.goldCost,f=1,h=o.material,m=(e.resources.gold||0)>=d,v=(e.resources[h]||0)>=f;if(m&&v){e.resources.gold-=d,e.resources[h]-=f;const g=te.DURABILITY.REPAIR_AMOUNT,p=c.durability;c.durability=Math.min(c.maxDurability,c.durability+g);const y=c.durability-p;n.durability.push({slot:i||c.type,item:c.name,amount:y}),n.message=`Reparerte ${c.name} (+${y} holdbarhet).`}else{n.success=!1;const g=((b=Ie[h])==null?void 0:b.label)||h;return n.message=`Mangler ${m?"":`${d} gull`}${!m&&!v?" og ":""}${v?"":`${f} ${g}`}.`,!1}return!0},W$=t=>{const{actor:e,action:s,localResult:n}=t,{itemId:i,slot:a}=s;e.inventory&&!Array.isArray(e.inventory)&&(e.inventory=Object.values(e.inventory)),e.inventory||(e.inventory=[]);const l=e.inventory.findIndex(o=>o.id===i);if(l!==-1){const o=e.inventory[l],c=e.equipment[a];e.inventory.splice(l,1),e.equipment[a]=o,c&&e.inventory.push(c),n.message=`Utstyrte ${o.name}`}return!0},q$=t=>{const{actor:e,action:s,localResult:n}=t,{slot:i}=s,a=e.equipment[i];return a&&(e.equipment[i]=null,e.inventory&&!Array.isArray(e.inventory)&&(e.inventory=Object.values(e.inventory)),e.inventory||(e.inventory=[]),e.inventory.push(a),n.message=`Tok av ${a.name}`),!0},X$=t=>{const{actor:e,action:s,localResult:n}=t,{itemId:i}=s;e.inventory&&!Array.isArray(e.inventory)&&(e.inventory=Object.values(e.inventory)),e.inventory||(e.inventory=[]);const a=e.inventory.findIndex(l=>l.id===i);if(a!==-1){const l=e.inventory[a];return e.inventory.splice(a,1),n.message=`Slettet ${l.name}`,!0}return n.message="Fant ikke gjenstanden som skulle slettes.",!1},Q$=t=>{const{actor:e,room:s,action:n,localResult:i}=t;if(e.role!=="BARON")return i.success=!1,i.message="Kun Baroner kan kreve inn lokal skatt.",!1;const a=e.regionId,l=s.regions[a];if(!l)return!1;const o=s.world.season,c=s.world.year;if(l.taxHistory||(l.taxHistory=[]),l.lastTaxCollection&&l.lastTaxCollection.year===c&&l.lastTaxCollection.season===o)return i.success=!1,i.message=`Du har allerede krevd inn skatt for ${o} ${c}.`,!1;const u=n.taxRate!==void 0?n.taxRate:l.taxRate||10,d=u/100;let f=0,h=0,m=0,v=0,x=0;const b=(e.regionId||"").trim().toLowerCase();Object.values(s.players).forEach(y=>{var S,w,E;if(!y||y.id===e.id)return;const k=(y.regionId||"").trim().toLowerCase();if(y.role==="PEASANT"&&(k===b||k.includes(b)||b.includes(k))){y.resources||(y.resources={gold:0,grain:0});const j=Number(y.resources.gold??y.gold??y.wealth??((S=y.stats)==null?void 0:S.gold)??((E=(w=y.inventory)==null?void 0:w.find(Y=>Y.id==="gold"))==null?void 0:E.amount)??0),A=Number(y.resources.grain??0),O=j*d,L=A*d;if(O>0){const Y=Math.floor(O);y.resources.gold!==void 0?y.resources.gold-=Y:y.gold!==void 0&&(y.gold-=Y),v+=O}if(L>0){const Y=Math.floor(L);y.resources.grain-=Y,x+=L}(O>0||L>0)&&m++}}),f=Math.floor(v),h=Math.floor(x),e.resources||(e.resources={gold:0,grain:0}),e.resources.gold=(e.resources.gold||0)+f,e.resources.grain=(e.resources.grain||0)+h,l.taxRate=u,l.lastTaxCollection={year:c,season:o};const g={year:c,season:o,amountGold:f,amountGrain:h,rate:u,timestamp:Date.now()};l.taxHistory.push(g),l.taxHistory.length>10&&l.taxHistory.shift();const p=Math.max(0,5+Math.floor((u-10)/2));return e.status.legitimacy=Math.max(0,(e.status.legitimacy||100)-p),f>0||h>0?(i.utbytte.push({resource:"gold",amount:f}),i.utbytte.push({resource:"grain",amount:h}),i.message=`Skatteinnkreving (${u}%): ${f}g og ${h} korn fra ${m} bnder. (-${p} Legitimet)`):i.message=`Ingen skatt  hente (sats: ${u}%). (-${p} Legitimet)`,!0},J$=t=>{const{actor:e,localResult:s}=t;if(e.role!=="BARON"&&e.role!=="KING")return s.success=!1,!1;const n=5,i=10;if((e.resources.gold||0)>=n&&(e.resources.grain||0)>=i)e.resources.gold-=n,e.resources.grain-=i,e.resources.manpower=(e.resources.manpower||0)+10,s.utbytte.push({resource:"manpower",amount:10}),s.message="Mobiliserte tropper (+10 Manpower).";else return s.success=!1,s.message="Mangler ressurser for  mobilisere.",!1;return!0},Z$=t=>{const{actor:e,room:s,localResult:n}=t;if(e.role!=="KING")return!1;n.message="UTSTEDTE KONGELIG DEKRET: Ekstraskatt!";let i=0;return Object.values(s.players).forEach(a=>{a.role==="BARON"&&a.resources.gold>=20&&(a.resources.gold-=20,i+=20)}),e.resources.gold=(e.resources.gold||0)+i,n.utbytte.push({resource:"gold",amount:i}),!0},gm=t=>{const{actor:e,room:s,action:n,localResult:i}=t,{buildingId:a,resource:l,amount:o}=n,c=cs[a];if(!c)return i.success=!1,i.message=`Fant ikke bygning med ID: ${a}`,!1;const u=a==="farm_house";let d;if(u)e.buildings||(e.buildings={}),e.buildings[a]||(e.buildings[a]={level:1,progress:{}}),d=e.buildings[a];else{if(s.world||(s.world={season:"Spring",weather:"Clear",year:1066,gameTick:0,lastTickAt:Date.now(),taxRateDetails:{kingTax:.1},settlement:{buildings:{}}}),s.world.settlement||(s.world.settlement={buildings:{}}),s.world.settlement.buildings||(s.world.settlement.buildings={}),!s.world.settlement.buildings[a]){const S=["manor_ost","manor_vest","throne_room"].includes(a)?0:1;s.world.settlement.buildings[a]={id:a,level:S,progress:{},contributions:{}}}d=s.world.settlement.buildings[a]}if(d.progress||(d.progress={}),e.resources||(e.resources=JSON.parse(JSON.stringify(Gt.PEASANT))),!d.level&&d.level!==0){const N=["manor_ost","manor_vest","throne_room"].includes(a);d.level=N?0:1}const f=d.level+1,h=c.levels[f];if(!h)return i.success=!1,i.message="Maksimalt niv ndd.",!1;const v=(h.requirements||{})[l]||0,x=d.progress[l]||0,b=v-x;let g=!0;if(Object.entries(h.requirements).forEach(([N,S])=>{(d.progress[N]||0)<S&&(g=!1)}),b<=0&&!g)return i.success=!1,i.message="Ressurskravet er allerede oppfylt.",!1;const p=e.resources[l]||0,y=Math.min(o,b,p);if(y<=0)return i.success=!1,i.message=`Kan ikke bidra 0 (Har: ${p}, Trenger: ${b}, Bud: ${o})`,!1;if(e.resources[l]=p-y,d.progress[l]=x+y,!u){d.contributions||(d.contributions={}),d.contributions[e.id]||(d.contributions[e.id]={name:e.name,resources:{}});const N=d.contributions[e.id].resources;N[l]=(N[l]||0)+y}i.message=`Bidro med ${y} ${l} til ${c.name}.`,i.utbytte.push({resource:l,amount:-y});let k=!0;if(Object.entries(h.requirements).forEach(([N,S])=>{(d.progress[N]||0)<S&&(k=!1)}),k){if(d.level=f,d.progress={},u||(d.contributions={}),["watchtower","manor_ost","manor_vest"].includes(c.id)){let N="capital";if(c.id==="manor_ost"&&(N="region_ost"),c.id==="manor_vest"&&(N="region_vest"),s.regions&&s.regions[N]){const S=s.regions[N].fortification||{hp:1e3,maxHp:1e3,level:1};S.maxHp+=500,S.hp+=500,S.level=Math.max(S.level,f),s.regions[N].fortification=S,i.message+="  Murene forsterket! (+500 HP)"}}i.message+=`  NYTT NIV: ${c.name} ndde Niv ${f}!`}return!0},eG=t=>{var c;const{actor:e,room:s,action:n,localResult:i}=t,a=typeof n=="string"?n:n.type,l=n.buildingId||a.replace("UPGRADE_BUILDING_",""),o=cs[l];if(o){s.world.settlement||(s.world.settlement={buildings:{}});const d=(((c=s.world.settlement.buildings[l])==null?void 0:c.level)||1)+1,f=o.levels[d];if(f){let h=!0;if(Object.entries(f.requirements||{}).forEach(([m,v])=>{(e.resources[m]||0)<v&&(h=!1)}),h){if(Object.entries(f.requirements||{}).forEach(([m,v])=>{e.resources[m]-=v}),s.world.settlement.buildings[l]||(s.world.settlement.buildings[l]={id:l,level:1,progress:{},contributions:{}}),s.world.settlement.buildings[l].level=d,["watchtower","manor_ost","manor_vest"].includes(l)){let m="capital";if(l==="manor_ost"&&(m="region_ost"),l==="manor_vest"&&(m="region_vest"),s.regions&&s.regions[m]){const v=s.regions[m].fortification||{hp:1e3,maxHp:1e3,level:1};v.maxHp+=500,v.hp+=500,v.level=Math.max(v.level,d),s.regions[m].fortification=v}}i.message=`Oppgraderte ${o.name} til Niv ${d}!`}else return i.success=!1,i.message="Mangler ressurser for oppgradering.",!1}}return!0},tG=t=>{var o;const{actor:e,action:s,localResult:n}=t,i=s.upgradeId,a=e.role,l=yx[a];if(l){const c=l.find(u=>u.id===i);if(c&&!((o=e.upgrades)!=null&&o.includes(i))){let u=!0;if(Object.entries(c.cost).forEach(([d,f])=>{e.resources[d]<f&&(u=!1)}),u)Object.entries(c.cost).forEach(([d,f])=>{e.resources[d]-=f}),e.upgrades||(e.upgrades=[]),e.upgrades.push(i),n.message=`Oppgradering fullfrt: ${c.name}`;else return n.success=!1,n.message="Har ikke rd til oppgradering.",!1}}return!0},sG=t=>{var c,u;const{actor:e,action:s,localResult:n}=t,i=s.targetRole;if(!i)return n.success=!1,n.message="Ingen rolle spesifisert.",!1;if(e.role===i)return n.success=!1,n.message=`Du er allerede ${i}.`,!1;if(["SOLDIER","MERCHANT","BARON","KING"].includes(i)&&i!=="BARON"&&i!=="KING"){const d=(c=e.roleStats)==null?void 0:c.PEASANT,f=(d==null?void 0:d.level)||(e.role==="PEASANT"?e.stats.level:1),h=te.CAREERS[i];if(h&&f<h.LEVEL_REQ)return n.success=!1,n.message=`Du m vre Bonde Niv ${h.LEVEL_REQ} for  bli ${i}. (N: ${f})`,!1}const l=((u=te.CAREERS[i])==null?void 0:u.COST)||0;if((e.resources.gold||0)<l)return n.success=!1,n.message=`Det koster ${l}g  bli ${i}. (Har: ${e.resources.gold}g)`,!1;e.roleStats||(e.roleStats={}),e.roleStats[e.role]={level:e.stats.level,xp:e.stats.xp,skills:JSON.parse(JSON.stringify(e.skills))},l>0&&(e.resources.gold-=l,n.utbytte.push({resource:"gold",amount:-l}));const o=e.roleStats[i];return o?(e.stats.level=o.level,e.stats.xp=o.xp,e.skills=o.skills):(e.stats.level=1,e.stats.xp=0,e.skills=JSON.parse(JSON.stringify(Fs[i]||Fs.PEASANT))),e.role=i,n.message=`Gratulerer! Du er n ${i}.`,!0},nG=t=>{const{actor:e,action:s,localResult:n}=t,{stage:i,resources:a}=s;if(e.boat||(e.boat={stage:0,model:"standard",componentLevels:{sails:0,hull:0,cannons:0,nets:0},hullType:"standard",stamina:100,durability:100,upgrades:[],hp:100,maxHp:100,cannons:0,cannonballs:50,isDamaged:!1}),i===-1){if(!e.boat.isDamaged)return n.success=!1,n.message="Bten trenger ikke reparasjon.",!1;let o=!0;return Object.entries(a).forEach(([c,u])=>{(e.resources[c]||0)<u&&(o=!1)}),o?(Object.entries(a).forEach(([c,u])=>{e.resources[c]-=u,n.utbytte.push({resource:c,amount:-u})}),e.boat.isDamaged=!1,e.boat.hp=25,n.message="Ndreparasjon fullfrt. Skroget er tett!",!0):(n.success=!1,n.message="Du har ikke nok materialer til  reparere skroget.",!1)}if(i===-2){if(e.boat.hp>=e.boat.maxHp)return n.success=!1,n.message="Bten er allerede i topp stand.",!1;let o=!0;return Object.entries(a).forEach(([c,u])=>{(e.resources[c]||0)<u&&(o=!1)}),o?(Object.entries(a).forEach(([c,u])=>{e.resources[c]-=u,n.utbytte.push({resource:c,amount:-u})}),e.boat.hp=e.boat.maxHp,n.message="Vedlikehold utfrt. Skroget er som nytt!",!0):(n.success=!1,n.message="Mangler materialer til vedlikehold.",!1)}if(e.boat.stage>=i)return n.success=!1,n.message="Du har allerede fullfrt dette trinnet.",!1;if(i!==e.boat.stage+1)return n.success=!1,n.message="Du m fullfre forrige trinn frst.",!1;let l=!0;return Object.entries(a).forEach(([o,c])=>{(e.resources[o]||0)<c&&(l=!1)}),l?(Object.entries(a).forEach(([o,c])=>{e.resources[o]-=c,n.utbytte.push({resource:o,amount:-c})}),e.boat.stage=i,n.message=`Btbygging: Fullfrte steg ${i}!`,e.stats.xp+=100,e.skills.CRAFTING&&(e.skills.CRAFTING.xp+=50),!0):(n.success=!1,n.message="Mangler ressurser for  bygge bten.",!1)},iG=t=>{const{actor:e,action:s,localResult:n}=t,{componentId:i}=s;if(!e.boat)return n.success=!1,n.message="Du har ingen bt  oppgradere.",!1;e.boat.componentLevels||(e.boat.componentLevels={sails:0,hull:0,cannons:0,nets:0});const a=e.boat.componentLevels[i]||0,l=wx[i];if(!l)return n.success=!1,n.message="Ukjent oppgradering.",!1;const o=a,c=l.levels[o];if(!c)return n.success=!1,n.message="Maksimalt niv ndd for denne komponenten.",!1;let u=!0;return Object.entries(c.cost).forEach(([d,f])=>{(e.resources[d]||0)<f&&(u=!1)}),u?(Object.entries(c.cost).forEach(([d,f])=>{e.resources[d]-=f,n.utbytte.push({resource:d,amount:-f})}),e.boat.componentLevels[i]=a+1,i==="hull"&&(e.boat.maxHp+=50),i==="cannons"&&(e.boat.cannons+=1),n.message=`Oppgraderte ${l.name} til Niv ${c.level}!`,!0):(n.success=!1,n.message="Mangler ressurser for oppgradering.",!1)},aG=t=>{const{actor:e,action:s,localResult:n}=t,{modelId:i}=s;if(!e.boat)return n.success=!1,n.message="Du m bygge en bt frst.",!1;const a=qf[i];if(!a)return n.success=!1,n.message="Ukjent btmodell.",!1;if(e.boat.model===i)return n.success=!1,n.message="Du har allerede denne modellen.",!1;let l=!0;return Object.entries(a.cost).forEach(([o,c])=>{(e.resources[o]||0)<c&&(l=!1)}),l?e.boat.stage<4?(n.success=!1,n.message="Du m fullfre grunnkonstruksjonen (Steg 4) fr du kan bytte modell.",!1):(Object.entries(a.cost).forEach(([o,c])=>{e.resources[o]-=c,n.utbytte.push({resource:o,amount:-c})}),e.boat.model=i,e.boat.maxHp=a.baseHp,e.boat.hp=a.baseHp,n.message=`Kjpte ny bt: ${a.name}!`,!0):(n.success=!1,n.message=`Har ikke rd til ${a.name}.`,!1)},rG=t=>{var f;const{actor:e,action:s,localResult:n}=t,{cosmeticType:i,id:a}=s;if(!e.boat)return!1;if(e.boat.customization||(e.boat.customization={color:"#4b2c20",flagId:"none",figurehead:"none",unlocked:[]}),(Array.isArray(e.boat.customization.unlocked)?e.boat.customization.unlocked:e.boat.customization.unlocked=[]).includes(a)){const h={...e.boat.customization};return i==="color"&&(h.color=((f=Eo.colors.find(m=>m.id===a))==null?void 0:f.hex)||"#4b2c20"),i==="flag"&&(h.flagId=a),e.boat={...e.boat,customization:h},n.message="Endret utseende.",!0}let o=null;if(i==="color"&&(o=Eo.colors.find(h=>h.id===a)),i==="flag"&&(o=Eo.flags.find(h=>h.id===a)),!o)return n.success=!1,n.message="Ukjent gjenstand.",!1;const c=o.cost||{};let u=!0;if(Object.entries(c).forEach(([h,m])=>{(e.resources[h]||0)<m&&(u=!1)}),!u)return n.success=!1,n.message="For dyrt.",!1;Object.entries(c).forEach(([h,m])=>{e.resources[h]-=m,n.utbytte.push({resource:h,amount:-m})}),e.boat.customization.unlocked.push(a);const d={...e.boat.customization};return i==="color"&&(d.color=o.hex),i==="flag"&&(d.flagId=a),e.boat={...e.boat,customization:d},n.message=`Kjpte ${o.name}!`,!0},lG=.15,R_=15,oG=t=>{var d,f,h;const{actor:e,room:s,localResult:n,action:i}=t,a=((d=i.payload)==null?void 0:d.targetRegionId)||e.regionId,l=a==="capital"&&e.role==="BARON";if(!a||!l&&(a==="capital"||a==="unassigned"))return n.success=!1,n.message=a==="capital"&&e.role!=="BARON"?"Bare baroner kan g til beleiring av hovedstaden.":"Du m angi en gyldig region for  starte beleiring.",!1;if(!s.regions)return console.error("CRITICAL: room.regions is undefined in handleStartSiege",s),n.success=!1,n.message="Systemfeil: Kunne ikke hente regiondata.",!1;const o=s.regions[a];if(!o)return n.success=!1,n.message="Regionen eksisterer ikke.",!1;if(o.activeSiege)return n.success=!1,n.message="Beleiring pgr allerede!",!1;if(o.rulerName===e.name)return n.success=!1,n.message="Du kan ikke beleire ditt eget slott!",!1;const c=((f=e.resources)==null?void 0:f.siege_sword)||0;if(c<500)return n.success=!1,n.message=`Du trenger minst 500 beleiringssverd i forsyninger for  starte en beleiring! (Eier: ${c})`,!1;const u=((h=o.fortification)==null?void 0:h.hp)||1e3;return o.activeSiege={phase:"BREACH",startedAt:Date.now(),lastTick:Date.now(),attackers:{[e.id]:{lane:1,hp:100,name:e.name}},defenders:{},gateHp:u,maxGateHp:u},n.message=`Beleiringen av ${o.name} har startet!`,!0},cG=t=>{var m,v,x;const{actor:e,room:s,localResult:n,action:i}=t,a=((m=i.payload)==null?void 0:m.targetRegionId)||e.regionId;if(!a||!((v=s.regions[a])!=null&&v.activeSiege))return n.success=!1,n.message="Ingen aktiv beleiring her.",!1;const l=s.regions[a].activeSiege,o=l.attackers||{},c=l.defenders||{};if(o[e.id]||c[e.id])return n.message="Du deltar allerede.",!1;const u=e.regionId===a,d=["BARON","KING"].includes(e.role);if(!u&&!d)return n.success=!1,n.message="Bare innbyggere eller adelen kan delta i krigfring i dette omrdet.",!1;const f=((x=i.payload)==null?void 0:x.side)==="DEFENDER",h={damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0};return f?(l.defenders||(l.defenders={}),l.defenders[e.id]={lane:1,hp:100,name:e.name,stats:h},n.message="Du forsvarer murene!"):(l.attackers||(l.attackers={}),l.attackers[e.id]={lane:1,hp:100,name:e.name,stats:h},n.message="Du har sluttet deg til beleiringen!"),!0},uG=t=>{var d,f,h,m,v,x,b,g,p,y,k,N,S,w,E,j,A,O,L,Y,W,H,M,U;const{actor:e,room:s,action:n,localResult:i}=t,a=((d=n.payload)==null?void 0:d.targetRegionId)||e.regionId;if(!a||!((f=s.regions[a])!=null&&f.activeSiege))return i.success=!1,i.message="Ingen aktiv beleiring funnet i dette omrdet.",!1;const l=s.regions[a].activeSiege,o=l.attackers||{},c=l.defenders||{},u=o[e.id]||c[e.id];if(!u)return i.message="Du m vre deltaker i beleiringen (angriper eller forsvarer) for  delta i kapplpet.",!1;if(l.phase==="BREACH"){if(n.subType==="ATTACK_GATE"){const T=(((h=e.resources)==null?void 0:h.siege_sword)||0)>0,R=T?25:2;return T&&(e.resources.siege_sword-=1),l.gateHp=Math.max(0,(l.gateHp||1e3)-R),u.stats=u.stats||{damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0},u.stats.damageDealt+=R,i.message=T?` Du hugger ls p porten! (-${R} HP). Du har ${e.resources.siege_sword} beleiringssverd igjen.`:` Du slr p porten med nevene... det gjr nesten ingen skade. (-${R} HP)`,T&&i.utbytte.push({resource:"siege_sword",amount:-1}),l.gateHp<=0&&(l.phase="COURTYARD",l.gateHp=0,i.message="PORTEN ER KNUST! Storm borggrden!"),!0}if(n.subType==="SHIELD_WALL")return!0}if(l.phase==="COURTYARD"){const C=l;if(!C.bossHp){const I=(((v=(m=s.regions[a])==null?void 0:m.garrison)==null?void 0:v.armor)||0)*20,F=1e4;C.bossHp=F+I,C.maxBossHp=F+I,C.bossTargetLane=1,C.nextBossAttack=Date.now()+5e3}if(n.subType==="MOVE_LANE"){const D=(x=n.payload)==null?void 0:x.lane;D>=0&&D<=2&&(u.lane=D,i.message=`Forflyttet til bane ${D===0?"Venstre":D===1?"Midten":"Hyre"}.`)}if(n.subType==="ATTACK_BOSS"){const D=((b=e.resources)==null?void 0:b.siege_sword)||0,I=((p=(g=s.regions[a])==null?void 0:g.garrison)==null?void 0:p.swords)||0,F=!!c[e.id];let P=2,B=!1;return D>0?(P=25,e.resources.siege_sword-=1,i.utbytte.push({resource:"siege_sword",amount:-1})):F&&I>0&&(P=25,s.regions[a].garrison&&(s.regions[a].garrison.swords-=1,B=!0)),C.bossHp-=P,u.stats=u.stats||{damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0},u.stats.damageDealt+=P,i.message=B?` Du bruker et sverd fra salens garnison og angriper bossen! (-${P} HP)`:P>2?` Du angriper bossen med ditt eget sverd! (-${P} HP). Du har ${e.resources.siege_sword} igjen.`:` Du slr p bossen med nevene... (-${P} HP)`,!0}const T=((k=(y=s.regions[a])==null?void 0:y.fortification)==null?void 0:k.level)||1,R=lG+T*.05;if(Date.now()>C.nextBossAttack){const D=C.bossTargetLane,I=u.lane===D,F=Math.random()<R;if(I||F){const P=((S=(N=s.regions[a])==null?void 0:N.garrison)==null?void 0:S.swords)||0,B=Math.floor(P/10),J=R_+B,se=(I?20:0)+(F?J:0),ie=!!c[e.id],Ee=((w=e.resources)==null?void 0:w.siege_armor)||0,ye=((j=(E=s.regions[a])==null?void 0:E.garrison)==null?void 0:j.armor)||0;let ae=0,Z=!1;Ee>0?(ae=Math.min(Ee,se),e.resources.siege_armor-=ae,i.utbytte.push({resource:"siege_armor",amount:-ae})):ie&&ye>0&&(ae=Math.min(ye,se),s.regions[a].garrison&&(s.regions[a].garrison.armor-=ae,Z=!0));const Me=se-ae;u.hp-=Me,u.stats=u.stats||{damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0},u.stats.damageTaken+=se,I&&(i.message+=Z?"  Slottets garnison-rustning beskyttet deg fra bossens slag!":ae>=20?"  Rustningen din tok sttet fra bossen!":"  AU! Bossen traff deg!"),F&&(i.message+=Z?"  Portens pilarer og garnison-rustning stoppet pilene!":ae>=R_?"  Rustningen din stoppet pilene!":`  Piler fra murene traff deg! (-${Me} HP)`),Me>0&&ae>0&&(i.message+=` (Rustningen absorberte ${ae} skade)`)}C.bossTargetLane=Math.floor(Math.random()*3),C.nextBossAttack=Date.now()+5e3}if(C.bossHp<=0){l.phase="THRONE_ROOM";const D=s.regions[a].rulerId,I=s.players[D||""],F=I&&Date.now()-(I.lastActive||0)<6e4,P={};F&&D&&I&&(P[D]={id:D,name:I.name,armor:100,progress:20,joinedAt:Date.now()}),l.throne={mode:F?"PVP":"PVE",occupation:0,plundered:!1,bossHp:F?(((A=I==null?void 0:I.status)==null?void 0:A.hp)||100)*5:5e3,maxBossHp:F?(((O=I==null?void 0:I.status)==null?void 0:O.hp)||100)*5:5e3,defendingPlayerId:D,occupiers:P},i.message="GARNISONSSJEFEN ER BESEIRET! Drene til Tronsalen sls opp!"}return!0}if(l.phase==="THRONE_ROOM"||l.phase==="THRONE"){let C=l.throne;(!C||!C.occupiers)&&(C=C||{},C.occupiers=C.occupiers||{},C.lastTick=Date.now(),l.throne=C);const T=Date.now();if(T-(C.lastTick||0)>1e3){const R=Math.floor((T-(C.lastTick||0))/1e3);C.lastTick=T;const D=Object.values(C.occupiers||{}),I=((Y=(L=s.regions[a])==null?void 0:L.garrison)==null?void 0:Y.armor)||0,F=Math.min(.8,I/100*.1);D.forEach(P=>{var ae;const J=P.id===s.regions[a].rulerId?1*(1-F):1;P.armor=Math.max(0,P.armor-J*R);const se=o[P.id]||c[P.id],ye=1*(1+(((ae=se==null?void 0:se.stats)==null?void 0:ae.damageDealt)||0)/200)*R;if(P.progress=Math.min(100,P.progress+ye),se&&(se.stats=se.stats||{damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0},se.stats.ticksOnThrone+=R),P.armor<=0)delete C.occupiers[P.id],i.message=`${P.name} falt fra tronen! (0 Beleiringsrustning)`;else if(P.progress>=100){delete s.regions[a].activeSiege;const Z=s.regions[a];P.id===Z.rulerId?i.message=` ${P.name} har knust opprret og gjenopprettet kontroll over ${Z.name}!`:(i.message=` ${P.name} har vunnet kappelpet og TATT TRONEN med makt!`,i.siegeWinnerId=P.id,i.targetRegionId=a)}})}if(n.subType==="CLAIM_THRONE"){C.occupiers||(C.occupiers={});const R=10,D=e.resources.siege_armor||0;return D<R?(i.message=`Mangler Beleiringsrustning! Du har ${D}, men trenger ${R}.`,!1):(e.resources.siege_armor=0,C.occupiers[e.id]={id:e.id,name:e.name,armor:D,progress:0,joinedAt:Date.now()},i.message=`${e.name} kastet seg inn i kampen om tronen med ${D} rustning!`,!0)}if(n.subType==="DONATE_ARMOR"){const R=(W=n.payload)==null?void 0:W.targetId,D=C.occupiers[R];if(!D)return i.message="Ugyldig ml.",!1;const I=e.resources.siege_armor||0;return I<1?(i.message="Du har ingen beleiringsrustning  gi!",!1):(e.resources.siege_armor=I-1,D.armor+=1,u.stats=u.stats||{damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0},u.stats.armorDonated+=1,i.message=`Donerte rustning til ${D.name}`,!0)}if(n.subType==="SUNDER_ARMOR"){const R=(H=n.payload)==null?void 0:H.targetId,D=C.occupiers[R];if(!D)return i.success=!1,i.message="Ingen p tronen  angripe!",!1;D.armor=Math.max(0,D.armor-1),u.stats=u.stats||{damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0},u.stats.damageDealt+=1;const I=R===s.regions[a].rulerId,F=((U=(M=s.regions[a])==null?void 0:M.garrison)==null?void 0:U.armor)||0;return I&&F>0?i.message=` Du angriper ${D.name}! Angrepet er mindre effektivt pga. slottets garnison-skjold.`:i.message=` Angrep ${D.name} p tronen!`,!0}return n.subType==="TICK",!0}return!1},dG=t=>{const{actor:e,room:s,action:n,localResult:i}=t,{resource:a,amount:l}=n,o=e.regionId==="capital"||!e.regionId?"capital":e.regionId;if(a!=="siege_sword"&&a!=="siege_armor")return i.success=!1,i.message="Ugyldig ressurs for garnisonen.",!1;if((e.resources[a]||0)<l)return i.success=!1,i.message=`Du har ikke nok ${a}.`,!1;s.regions[o].garrison||(s.regions[o].garrison={swords:0,armor:0,morale:100});const u=a==="siege_sword"?"swords":"armor";return e.resources[a]-=l,s.regions[o].garrison||(s.regions[o].garrison={swords:0,armor:0,morale:100}),s.regions[o].garrison[u]=(s.regions[o].garrison[u]||0)+l,i.utbytte.push({resource:a,amount:-l}),i.message=`Forsterket garnisonen med ${l} ${a==="siege_sword"?"vpen":"rustninger"}.`,!0},fG=t=>{const{actor:e,room:s,action:n,localResult:i}=t,{amount:a}=n,l=e.regionId==="capital"||!e.regionId?"capital":e.regionId;if(!s.regions)return!1;const o=s.regions[l];o.fortification||(o.fortification={hp:1e3,maxHp:1e3,level:1});const c=o.fortification;if(c.hp>=c.maxHp)return i.success=!1,i.message="Murene er allerede i perfekt stand.",!1;const u=10*a,d=10*a;if((e.resources.stone||0)<u||(e.resources.wood||0)<d)return i.success=!1,i.message="Mangler stein eller ved til reparasjon.",!1;e.resources.stone=(e.resources.stone||0)-u,e.resources.wood=(e.resources.wood||0)-d;const f=50*a;return c.hp=Math.min(c.maxHp,c.hp+f),i.utbytte.push({resource:"stone",amount:-u}),i.utbytte.push({resource:"wood",amount:-d}),i.message=`Reparerte murene (+${f} HP).`,o.activeSiege&&o.activeSiege.gateHp!==void 0&&(o.activeSiege.gateHp+=f),!0},hG=t=>{const{actor:e,room:s,localResult:n}=t,i=e.regionId==="capital"||!e.regionId?"capital":e.regionId;if(!s.regions)return!1;const a=s.regions[i];a.fortification||(a.fortification={hp:1e3,maxHp:1e3,level:1});const l=a.fortification,o=l.level||1,c=o+1,u=5e3*o,d=100*o,f=100*o;return(e.resources.gold||0)<u||(e.resources.stone||0)<d||(e.resources.wood||0)<f?(n.success=!1,n.message=`Mangler ressurser til oppgradering. Krever ${u}G, ${d} stein og ${f} ved.`,!1):(e.resources.gold-=u,e.resources.stone-=d,e.resources.wood-=f,l.level=c,l.maxHp+=500,l.hp=l.maxHp,n.utbytte.push({resource:"gold",amount:-u}),n.utbytte.push({resource:"stone",amount:-d}),n.utbytte.push({resource:"wood",amount:-f}),n.message=` Oppgradert festningsverk til niv ${c}! Murens styrke er n ${l.maxHp} HP.`,!0)},mG=t=>{var o,c,u,d,f,h;const{actor:e,room:s,localResult:n,trackXp:i,damageTool:a}=t;if(e.role!=="BARON")return n.success=!1,!1;const l=Object.values(s.players).find(m=>m.role==="BARON"&&m.id!==e.id);if(l){if((((o=s.world)==null?void 0:o.activeLaws)||[]).includes("peace"))return n.success=!1,n.message="Fredsavtale blokkerer raid!",!1;const v=e.resources.manpower||0;let x=l.resources.manpower||0,b=Math.random()*.5+.75;if((c=l.upgrades)!=null&&c.includes("stone_keep")&&(x+=30),(u=l.upgrades)!=null&&u.includes("fence")&&(x+=10),(d=e.upgrades)!=null&&d.includes("stables")&&(b+=.1),e.activeBuffs&&e.activeBuffs.length>0){const g=Date.now(),p=e.activeBuffs.find(y=>y.type==="STRENGTH_BONUS"&&y.expiresAt>g);p&&(b+=p.value/100)}if((f=e.equipment)!=null&&f.MAIN_HAND&&a("MAIN_HAND",te.DURABILITY.LOSS_COMBAT_WEAPON),(h=e.equipment)!=null&&h.BODY&&a("BODY",te.DURABILITY.LOSS_COMBAT_ARMOR),v*b>x){const g=Math.floor((l.resources.gold||0)*te.COMBAT.RAID_LOOT_FACTOR),p=Math.floor((l.resources.grain||0)*te.COMBAT.RAID_LOOT_FACTOR);l.resources.gold=Math.max(0,(l.resources.gold||0)-g),l.resources.grain=Math.max(0,(l.resources.grain||0)-p),e.resources.gold=(e.resources.gold||0)+g,e.resources.grain=(e.resources.grain||0)+p,e.resources.manpower=Math.max(0,e.resources.manpower-5),l.resources.manpower=Math.max(0,l.resources.manpower-8),n.utbytte.push({resource:"gold",amount:g}),n.utbytte.push({resource:"grain",amount:p}),n.message=`Plyndret ${l.name} for ${g}g og ${p} korn!`,i("COMBAT",50)}else return e.resources.manpower=Math.max(0,e.resources.manpower-10),n.success=!1,n.message=`Angrepet p ${l.name} ble sltt tilbake.`,i("COMBAT",10),!1}else return n.success=!1,n.message="Fant ingen annen baron  raide.",!1;return!0},pG=t=>{const{actor:e,action:s,localResult:n,trackXp:i}=t,a=s.performance||.5,l=Math.ceil(15*a);return e.resources.gold=(e.resources.gold||0)+l,i("COMBAT",10),n.utbytte.push({resource:"gold",amount:l}),n.message="Utfrte patrulje.",!0},gG=t=>{const{actor:e,localResult:s}=t;if(!e.boat)return s.success=!1,s.message="Du trenger en bt for  laste ammunisjon!",!1;const n=e.resources.cannonball||0;return n<=0?(s.success=!1,s.message="Du har ingen kanonkuler i ryggsekken!",!1):(e.boat.cannonballs=(e.boat.cannonballs||0)+n,e.resources.cannonball=0,s.message=`Lastet ${n} kanonkuler ombord. Btlager: ${e.boat.cannonballs} stk.`,!0)},xG=t=>{const{actor:e,action:s,localResult:n}=t,{resource:i,amount:a}=s;e.caravan||(e.caravan={level:1,inventory:{},durability:100,upgrades:[]});const l=te.CARAVAN.LEVELS.find(u=>u.level===e.caravan.level);return l?(e.resources[i]||0)<a?(n.success=!1,n.message=`Du har ikke nok ${i}.`,!1):(Object.values(e.caravan.inventory).reduce((u,d)=>(u||0)+(d||0),0)||0)+a>l.capacity?(n.success=!1,n.message="Karavanen er full!",!1):(e.resources[i]-=a,e.caravan.inventory[i]=(e.caravan.inventory[i]||0)+a,n.message=`Lastet ${a} ${i} p karavanen.`,n.utbytte.push({resource:i,amount:-a}),!0):!1},bG=t=>{const{actor:e,action:s,localResult:n}=t,{resource:i,amount:a}=s;return!e.caravan||!e.caravan.inventory[i]||e.caravan.inventory[i]<a?(n.success=!1,n.message="Mangelfull last i karavanen.",!1):(e.caravan.inventory[i]-=a,e.resources[i]=(e.resources[i]||0)+a,n.message=`Losset ${a} ${i} fra karavanen.`,n.utbytte.push({resource:i,amount:a}),!0)},vG=t=>{const{actor:e,action:s,localResult:n,trackXp:i}=t,{upgradeType:a,upgradeId:l}=s;if(e.caravan||(e.caravan={level:1,inventory:{},durability:100,upgrades:[]}),a==="LEVEL"){const o=(e.caravan.level||1)+1,c=te.CARAVAN.LEVELS.find(u=>u.level===o);return c?(e.resources.gold||0)<c.cost?(n.success=!1,n.message=`Du mangler ${c.cost-(e.resources.gold||0)} gull for oppgraderingen.`,!1):(e.resources.gold-=c.cost,e.caravan.level=o,e.caravan.durability=c.durability,n.message=`Karavanen oppgradert til: ${c.name}!`,i("TRADING",100),!0):(n.success=!1,n.message="Karavanen er allerede p maks niv.",!1)}if(a==="MODULE"&&l){const o=te.CARAVAN.UPGRADES[l.toUpperCase()];return o?e.caravan.upgrades.includes(o.id)?(n.success=!1,n.message="Du har allerede denne oppgraderingen.",!1):(e.resources.gold||0)<o.cost?(n.success=!1,n.message="Ikke nok gull.",!1):(e.resources.gold-=o.cost,e.caravan.upgrades.push(o.id),n.message=`Kjpte modulen: ${o.name}!`,i("TRADING",50),!0):!1}return!1},yG=t=>{const{actor:e,localResult:s}=t;if(!e.caravan)return!1;const n=te.CARAVAN.LEVELS.find(u=>u.level===e.caravan.level),i=n?n.durability:100,a=e.caravan.durability||0;if(a>=i)return s.success=!1,s.message="Karavanen er allerede i topp stand.",!1;const c=(i-a)*2;return(e.resources.gold||0)<c?(s.success=!1,s.message=`Du mangler ${c-(e.resources.gold||0)} gull. Reparasjon koster ${c}g.`,!1):(e.resources.gold-=c,e.caravan.durability=i,s.message=`Karavanen reparert for ${c}g.`,!0)},C_=t=>{var l;const{actor:e,action:s,localResult:n}=t,{finalDurability:i,targetRegionId:a}=s;return console.log("[CaravanHandler] Travel Result:",{finalDurability:i,targetRegionId:a,currentDurability:(l=e.caravan)==null?void 0:l.durability}),e.caravan?(e.caravan.durability=Math.max(0,i),e.caravan.durability<=0?(n.success=!1,n.message="Karavanen brt sammen under reisen! Du m reparere den fr du kan reise igjen.",!0):(e.regionId=a,n.message=`Ankom destinasjonen! Durability: ${Math.round(i)}%`,!0)):!1},rb={chassis_oak:{id:"chassis_oak",category:"CHASSIS",name:"Rustikk Eik",cost:0},chassis_iron:{id:"chassis_iron",category:"CHASSIS",name:"Forsterket Jern",cost:1500,reqLevel:3},chassis_gold:{id:"chassis_gold",category:"CHASSIS",name:"Gyllen Kongevogn",cost:5e3,reqLevel:5},wheels_wood:{id:"wheels_wood",category:"WHEELS",name:"Trehjul",cost:0},wheels_iron:{id:"wheels_iron",category:"WHEELS",name:"Jernbesltte",cost:150},wheels_spiked:{id:"wheels_spiked",category:"WHEELS",name:"Pigghjul",cost:500},cover_canvas:{id:"cover_canvas",category:"COVER",name:"Slitt Lerret",cost:0},cover_leather:{id:"cover_leather",category:"COVER",name:"Lr",cost:200},cover_silk:{id:"cover_silk",category:"COVER",name:"Silke med Gullkant",cost:1e3},cover_stars:{id:"cover_stars",category:"COVER",name:"Stjernehimmel",cost:2500},lantern_oil:{id:"lantern_oil",category:"LANTERNS",name:"Oljelampe",cost:0},lantern_crystal:{id:"lantern_crystal",category:"LANTERNS",name:"Bl Krystall",cost:800},lantern_fireflies:{id:"lantern_fireflies",category:"LANTERNS",name:"Ildfluer i bur",cost:300},flag_none:{id:"flag_none",category:"FLAG",name:"Ingen",cost:0},flag_region:{id:"flag_region",category:"FLAG",name:"Regionens Flagg",cost:100},flag_pirate:{id:"flag_pirate",category:"FLAG",name:"Piratflagg",cost:500},skin_ox:{id:"skin_ox",category:"SKIN",name:"Standard Okse",cost:0},skin_horse_linked:{id:"skin_horse_linked",category:"SKIN",name:"Min Hest",cost:0},skin_horse_white:{id:"skin_horse_white",category:"SKIN",name:"Hvit Hest",cost:1e3},skin_horse_mech:{id:"skin_horse_mech",category:"SKIN",name:"Mekanisk Hest",cost:5e3},companion_none:{id:"companion_none",category:"COMPANION",name:"Ingen",cost:0},companion_dog:{id:"companion_dog",category:"COMPANION",name:"Vakthund",cost:400},companion_cat:{id:"companion_cat",category:"COMPANION",name:"Katt p taket",cost:200},trail_dust:{id:"trail_dust",category:"TRAIL",name:"Stvsky",cost:0},trail_gold:{id:"trail_gold",category:"TRAIL",name:"Gullglitter",cost:2e3},trail_dark:{id:"trail_dark",category:"TRAIL",name:"Mrk Tke",cost:1500},decor_none:{id:"decor_none",category:"DECOR",name:"Ingen",cost:0},decor_shields:{id:"decor_shields",category:"DECOR",name:"Skjoldrekke",cost:600},decor_flowers:{id:"decor_flowers",category:"DECOR",name:"Blomsterkasser",cost:100}},_G=t=>{const{actor:e,action:s,localResult:n}=t,{cosmeticId:i}=s;if(!e.caravan)return!1;e.caravan.customization||(e.caravan.customization={chassis:"chassis_oak",wheels:"wheels_wood",cover:"cover_canvas",lanterns:"lantern_oil",flag:"flag_none",skin:"skin_ox",companion:"companion_none",trail:"trail_dust",decor:"decor_none",unlocked:["chassis_oak","wheels_wood","cover_canvas","lantern_oil","flag_none","skin_ox","skin_horse_linked","companion_none","trail_dust","decor_none"]});const a=rb[i];return a?e.caravan.customization.unlocked.includes(i)?(n.success=!1,n.message="Du eier allerede denne.",!1):(e.resources.gold||0)<a.cost?(n.success=!1,n.message=`Du mangler ${a.cost-(e.resources.gold||0)} gull.`,!1):a.reqLevel&&(e.caravan.level||1)<a.reqLevel?(n.success=!1,n.message=`Krever Karavan Niv ${a.reqLevel}.`,!1):(e.resources.gold-=a.cost,e.caravan.customization.unlocked.push(i),n.message=`Kjpte ${a.name}!`,!0):(n.success=!1,n.message="Ugyldig vare.",!1)},wG=t=>{const{actor:e,action:s,localResult:n}=t,{cosmeticId:i}=s,a=rb[i];if(!a||!e.caravan)return!1;if(e.caravan.customization||(e.caravan.customization={chassis:"chassis_oak",wheels:"wheels_wood",cover:"cover_canvas",lanterns:"lantern_oil",flag:"flag_none",skin:"skin_ox",companion:"companion_none",trail:"trail_dust",decor:"decor_none",unlocked:["chassis_oak","wheels_wood","cover_canvas","lantern_oil","flag_none","skin_ox","skin_horse_linked","companion_none","trail_dust","decor_none"]}),!e.caravan.customization.unlocked.includes(i))return n.success=!1,n.message="Du eier ikke denne gjenstanden.",!1;if(i==="skin_horse_linked"&&!(e.horseCustomization&&e.horseCustomization.skinId))return n.success=!1,n.message="Du trenger en hest i stallen for  bruke denne.",!1;switch(a.category){case"CHASSIS":e.caravan.customization.chassis=i;break;case"WHEELS":e.caravan.customization.wheels=i;break;case"COVER":e.caravan.customization.cover=i;break;case"LANTERNS":e.caravan.customization.lanterns=i;break;case"FLAG":e.caravan.customization.flag=i;break;case"SKIN":e.caravan.customization.skin=i;break;case"COMPANION":e.caravan.customization.companion=i;break;case"TRAIL":e.caravan.customization.trail=i;break;case"DECOR":e.caravan.customization.decor=i;break}return typeof e.caravan.inventory>"u"&&(e.caravan.inventory={}),typeof e.caravan.upgrades>"u"&&(e.caravan.upgrades=[]),n.message=`Utstyrte ${a.name}.`,!0},kG=t=>{var d,f,h;const{actor:e,room:s,localResult:n}=t;if(!(Qi(((d=s.world)==null?void 0:d.gameTick)||0)==="NIGHT"))return n.success=!1,n.message=" Du kan bare sove nr det er natt.",!1;const l=100-(e.status.stamina||0);e.status.stamina=100,e.status.hp=Math.min(100,(e.status.hp||100)+20),e.activeBuffs||(e.activeBuffs=[]),e.activeBuffs=e.activeBuffs.filter(m=>m.type!=="STAMINA_SAVE"||m.label!=="Godt utvilt");const o=((h=(f=e.buildings)==null?void 0:f.farm_house)==null?void 0:h.level)||1;let c=.5,u=3e5;return o>=3&&(c=.6),o>=4&&(c=.7,u=6e5),e.activeBuffs.push({id:"well_rested_"+Date.now(),type:"STAMINA_SAVE",value:c,label:"Godt utvilt",description:`${Math.round(c*100)}% mindre stamina-forbruk etter en god natts svn (Grd Niv ${o}).`,expiresAt:Date.now()+u}),n.message="Du sov tungt gjennom natten. Vknet opp uthvilt og full av energi!",n.utbytte.push({resource:"stamina",amount:l}),!0},ua=t=>{var d;const{actor:e,action:s,localResult:n}=t,i=typeof s=="string"?s:s.type,a=s.locationId;let l=30,o=0,c="Hvilte.";if(i==="EAT"&&(l=40,c="Satt ved varmen og spiste."),i==="FEAST"&&(l=100,o=20,c="Holdt gjestebud!"),i==="GATHER_WATER"||a==="farm_well"||a==="well_water"){e.activeProcesses||(e.activeProcesses=[]);const f=a||(i==="GATHER_WATER"?"well_water":null);if(f){const h=e.activeProcesses.find(m=>m.type==="WELL"&&m.locationId===f);if(h){if(h.readyAt>Date.now())return n.success=!1,n.message="Brnnen er tom. Den fyller seg med vann...",!1;e.activeProcesses=e.activeProcesses.filter(m=>m.id!==h.id)}l=5,c="Drakk friskt vann fra brnnen.",e.activeProcesses.push({id:"well_"+Date.now(),type:"WELL",itemId:"water",locationId:f,startedAt:Date.now(),duration:3e5,readyAt:Date.now()+3e5,notified:!1})}}if(a==="village_square"&&(l=10,c="Hvilte p torget.",M$(e,"REST_SQUARE",6*60*1e3)),(a==="village"||a==="tavern_bar")&&["REST_BASIC","REST_COMFY","REST_ROYAL"].includes(i)){t.room.metadata||(t.room.metadata={});const f=t.room.metadata,h=Date.now(),m=f.lastTavernRest||h,v=(h-m)/3e5;let x=f.tavernDemand||1;v>0&&(x=Math.max(1,x-v*.05));let b=150,g=30,p=0,y=null,k="Hvilte i salen";i==="REST_BASIC"?(b=150,g=30,k="Hvilte i salen"):i==="REST_COMFY"?(b=500,g=80,p=10,k="Hvilte i komfortabelt rom",y={id:"rest_comfy_"+h,type:"STAMINA_SAVE",value:.2,label:"Utvilt",description:"20% redusert stamina-forbruk i 10 min.",expiresAt:h+6e5}):i==="REST_ROYAL"&&(b=1500,g=100,p=50,k="Hvilte i Kongesuite",y={id:"rest_royal_"+h,type:"STAMINA_SAVE",value:.5,label:"Luksusliv",description:"50% redusert stamina, +1 HP/sek regenerering i 20 min.",expiresAt:h+12e5,passiveEffect:"HP_REGEN"});const N=Math.ceil(b*x);return(e.resources.gold||0)<N?(n.success=!1,n.message=`Vertshuset krever ${N}g (Ettersprsel: ${Math.round(x*100)}%). Du har ikke rd.`,!1):(e.resources.gold-=N,n.utbytte.push({resource:"gold",amount:-N}),l=g,o=p,c=`${k} (-${N}g). Fler deg bedre!`,y&&(e.activeBuffs||(e.activeBuffs=[]),e.activeBuffs=e.activeBuffs.filter(S=>S.type!=="STAMINA_SAVE"),e.activeBuffs.push(y),c+=` (Buff: ${y.label})`),f.tavernDemand=x+.1,f.lastTavernRest=h,!0)}return(d=e.upgrades)!=null&&d.includes("roof")&&(l+=20),a==="royal_chambers"&&(l=100,o=100,c="Hvilte ut i de kongelige kamrene. Fler deg som en konge igjen!",e.activeBuffs||(e.activeBuffs=[]),e.activeBuffs=e.activeBuffs.filter(f=>f.label!=="Kongelig Velvre"),e.activeBuffs.push({id:"royal_wellness_"+Date.now(),type:"STAMINA_SAVE",value:.6,label:"Kongelig Velvre",description:"Fyrstelig velvre reduserer stamina-forbruk med 60%.",expiresAt:Date.now()+6e5})),e.status.stamina=Math.min(100,(e.status.stamina||0)+l),o>0&&(e.status.hp=Math.min(100,(e.status.hp||100)+o)),n.utbytte.push({resource:"stamina",amount:l}),n.message=c,!0},NG=t=>{const{actor:e,localResult:s,trackXp:n}=t,i=Math.floor(Math.random()*5)+1;return e.resources.favor=(e.resources.favor||0)+i,s.utbytte.push({resource:"favor",amount:i}),n("THEOLOGY",10),s.message=`Ba til gudene. (+${i} velvilje)`,!0},SG=t=>{const{localResult:e}=t,s=["Baronen ser nervs ut i dag.","Hrte du ulvene i natt?","Prisen p korn gr opp.","Kongens soldater er p vei."];return e.message=`Sladder: "${s[Math.floor(Math.random()*s.length)]}"`,!0},I_=t=>{const{actor:e,action:s,localResult:n}=t,{amount:i,isWin:a,playerRoll:l,houseRoll:o}=s;return a?(e.resources.gold=(e.resources.gold||0)+i,n.utbytte.push({resource:"gold",amount:i}),n.message=`Vant ${i}g p terninger! (${l} mot ${o})`):(e.resources.gold=Math.max(0,(e.resources.gold||0)-i),n.message=`Tapte ${i}g p terninger. (${l} mot ${o})`),!0},EG=t=>{const{actor:e,action:s,localResult:n}=t,{resource:i,amount:a,multiplier:l,isWin:o}=s,c=i,u=e.resources[c]||0;if(u<a)return n.success=!1,n.message=`Du har ikke nok ${i}!`,!1;if(e.resources[c]=Math.max(0,u-a),o){const d=a*l;e.resources[c]+=d;const f=d-a;n.utbytte.push({resource:c,amount:f}),n.message=`Soga-hjulet vider seg til din fordel! Vant ${d} ${i}.`,l>=2.5&&(e.status.morale=Math.min(100,(e.status.morale||50)+5))}else n.message=`Skjebnen var hard. Du mistet ${a} ${i} til soga-hjulet.`,n.utbytte.push({resource:c,amount:-a});return!0},jG=t=>{var c;const{actor:e,room:s,localResult:n}=t,i=e.regionId||"capital",a=((c=s.markets)==null?void 0:c[i])||s.market;let l=5;a&&a.bread&&(l=a.bread.price);const o=Math.ceil(l*1.2);if((e.resources.gold||0)>=o){e.resources.gold-=o;const u=10;e.status.stamina=Math.min(100,(e.status.stamina||0)+u),n.utbytte.push({resource:"stamina",amount:u}),n.utbytte.push({resource:"gold",amount:-o}),n.message=`Kjpte et mltid i baren for ${o}g. (+10 Stamina)`}else return n.success=!1,n.message=`Har ikke rd til mat (koster ${o}g).`,!1;return!0},TG=t=>{const{actor:e,room:s,localResult:n}=t;return n.message=`${e.name} har valgt  trekke seg tilbake fra dette livet.`,delete s.players[e.id],!0},AG=t=>{const{actor:e,action:s,localResult:n,room:i}=t,a=s.itemId,o=!!s.isResource,c=Array.isArray(e.inventory)?e.inventory:Object.values(e.inventory||{});if(o){if(!e.resources[a]||e.resources[a]<1)return n.success=!1,n.message="Du har ikke mer igjen.",!1;e.resources[a]--,n.utbytte.push({resource:a,amount:-1})}else{const d=c.findIndex(f=>f.id===a);if(d===-1)return n.success=!1,n.message="Fant ikke gjenstanden.",!1;e.inventory=c.filter((f,h)=>h!==d)}e.activeBuffs||(e.activeBuffs=[]);const u=Date.now();switch(a){case"bread":e.status.stamina=Math.min(100,(e.status.stamina||0)+20),n.message="Spiste Brd. (+20 Stamina)",n.utbytte.push({resource:"stamina",amount:20});break;case"omelette":e.activeBuffs=e.activeBuffs.filter(d=>d.type!=="STAMINA_SAVE"),e.activeBuffs.push({id:"buff_omelette_"+u,type:"STAMINA_SAVE",value:.2,label:"Lett til beins",description:"Reduserer stamina-kostnad med 20%.",expiresAt:u+9e5,sourceItem:"omelette"}),n.message="Spiste Omelett. (20% stamina-spare buff)";break;case"minor_stamina_potion":e.status.stamina=Math.min(100,(e.status.stamina||0)+30),n.message="Drakk Liten Stamina-brygg. (+30 Stamina)",n.utbytte.push({resource:"stamina",amount:30});break;case"herbal_balm":e.activeBuffs=e.activeBuffs.filter(d=>d.type!=="SPEED_BONUS"),e.activeBuffs.push({id:"buff_balm_"+u,type:"SPEED_BONUS",value:.15,label:"Lett p foten",description:"ker sankehastighet med 15%.",expiresAt:u+6e5,sourceItem:"herbal_balm"}),n.message="Brukte Urtebalsam. (+15% Arbeidshastighet)";break;case"focus_brew":e.activeBuffs=e.activeBuffs.filter(d=>d.type!=="STAMINA_SAVE"),e.activeBuffs.push({id:"buff_focus_"+u,type:"STAMINA_SAVE",value:.2,label:"Skjerpet Fokus",description:"Reduserer stamina-kostnad med 20% i 15 min.",expiresAt:u+9e5,sourceItem:"focus_brew"}),n.message="Drakk Fokus-brygg. (Bedre fokus!)";break;case"strength_tincture":e.activeBuffs=e.activeBuffs.filter(d=>d.type!=="STRENGTH_BONUS"),e.activeBuffs.push({id:"buff_strength_"+u,type:"STRENGTH_BONUS",value:10,label:"Kjempestyrke",description:"ker angrepskraft med 10.",expiresAt:u+6e5,sourceItem:"strength_tincture"}),n.message="Drakk Styrke-tinktur. (+10 Angrep)";break;case"masters_draught":e.activeBuffs=e.activeBuffs.filter(d=>d.type!=="YIELD_BONUS"),e.activeBuffs.push({id:"buff_master_"+u,type:"YIELD_BONUS",value:.5,label:"Mesterhnd",description:"ker utbytte fra alle sankeoppgaver med 50%.",expiresAt:u+12e5,sourceItem:"masters_draught"}),n.message="Drakk Mester-drikk. (Fler deg som en mester!)";break;case"elixir_of_life":e.status.stamina=100,e.status.hp=Math.min(100,(e.status.hp||100)+50),n.message="Drakk Livseliksir. Full Stamina og +50 HP!",n.utbytte.push({resource:"stamina",amount:100});break;default:return n.success=!1,n.message=`Kan ikke bruke ${a}.`,!1}return en(i.pin,"consumed",a,1),!0},RG=t=>{const{actor:e,action:s,localResult:n,trackXp:i}=t,a=s.performance||.5,l=s.method||"ride_easy",o=s.level||1;let c=1,u="lav";l==="ride_medium"?(c=1.6,u="middels"):l==="ride_hard"&&(c=2.5,u="hy");const d=1+(o-1)*.5,f=Math.ceil(10*c*d);if(a===.5&&!s.isComplete){if((e.resources.grain||0)<f)return n.message=`Du har ikke nok korn! Trenger ${f} korn.`,!1;e.resources.grain=(e.resources.grain||0)-f}const h=c*(1+(o-1)*.2);e.status.stamina=Math.min(100,(e.status.stamina||0)+5);const m=Math.ceil(20*(1+a)*h);if(i("STEWARDSHIP",m),a>=.8){e.minigameProgress||(e.minigameProgress={});const v=e.minigameProgress[l]||1;o===v&&v<5?(e.minigameProgress[l]=v+1,n.message=`Glimrende ridning! Du har lst opp niv ${v+1} for ${l==="ride_easy"?"Engelskogen":l==="ride_medium"?"Fjellpasset":"Ulvestien"}! (Brukt ${f} korn)`):n.message=`Du red en tur i ${u} vanskelighetsgrad (Lvl ${o}). Fler deg forfrisket! (Brukt ${f} korn)`}else n.message=`Du red en tur i ${u} vanskelighetsgrad (Lvl ${o}). (Ytelse: ${Math.round(a*100)}%, Brukt ${f} korn)`;return!0},CG=t=>{const{actor:e,action:s,localResult:n}=t,{cosmeticId:i,cosmeticType:a,price:l}=s;return e.horseCustomization||(e.horseCustomization={skinId:"brown",maneColor:"#1e1b4b",unlockedSkins:["brown"],unlockedManeColors:["#1e1b4b"],unlockedHats:[]}),(e.resources.gold||0)<l?(n.message=`Du har ikke nok gull! Trenger ${l}g.`,!1):(e.resources.gold=(e.resources.gold||0)-l,a==="skin"?(e.horseCustomization.unlockedSkins||(e.horseCustomization.unlockedSkins=["brown"]),e.horseCustomization.unlockedSkins.includes(i)||e.horseCustomization.unlockedSkins.push(i)):a==="mane"?(e.horseCustomization.unlockedManeColors||(e.horseCustomization.unlockedManeColors=["#1e1b4b"]),e.horseCustomization.unlockedManeColors.includes(i)||e.horseCustomization.unlockedManeColors.push(i)):a==="hat"&&(e.horseCustomization.unlockedHats||(e.horseCustomization.unlockedHats=[]),e.horseCustomization.unlockedHats.includes(i)||e.horseCustomization.unlockedHats.push(i)),n.message=`Du kjpte en ny ting til hesten din for ${l}g!`,!0)},IG=t=>{const{actor:e,action:s}=t,{cosmeticId:n,cosmeticType:i}=s;return e.horseCustomization||(e.horseCustomization={skinId:"brown",maneColor:"#1e1b4b",unlockedSkins:["brown"],unlockedManeColors:["#1e1b4b"],unlockedHats:[]}),i==="skin"?e.horseCustomization.skinId=n:i==="mane"?e.horseCustomization.maneColor=n:i==="hat"&&(e.horseCustomization.hatId=n),!0},wj={WORK:B$,CHOP:U$,MINE:A_,QUARRY:A_,FORAGE:H$,HUNT:$$,GATHER_WOOL:G$,GATHER_HONEY:F$,PLANT:L$,HARVEST:P$,MAINTAIN_CROP:D$,CRAFT:K$,REFINE:ir,BAKE:ir,MILL:ir,SMELT:ir,WEAVE:ir,MIX:ir,REPAIR:Y$,EQUIP_ITEM:W$,UNEQUIP_ITEM:q$,DISCARD_ITEM:X$,TAX:Q$,DRAFT:J$,DECREE:Z$,CONSTRUCT:gm,CONTRIBUTE_TO_UPGRADE:gm,CONTRIBUTE_TO_PRIVATE_UPGRADE:gm,UPGRADE_BUILDING:eG,UPGRADE:tG,JOIN_ROLE:sG,CONTRIBUTE_TO_BOAT:nG,UPGRADE_BOAT_COMPONENT:iG,BUY_BOAT_MODEL:aG,BUY_BOAT_COSMETIC:rG,START_SIEGE:oG,JOIN_SIEGE:cG,SIEGE_ACTION:uG,REINFORCE_GARRISON:dG,REPAIR_WALLS:fG,UPGRADE_FORTIFICATION:hG,RAID:mG,PATROL:pG,REFILL_AMMO:gG,SLEEP:kG,REST:ua,REST_BASIC:ua,REST_COMFY:ua,REST_ROYAL:ua,EAT:ua,FEAST:ua,PRAY:NG,CHAT_LOCAL:SG,GAMBLE_RESULT:I_,PLAY_DICE:I_,PLAY_RESOURCE_GAME:EG,BUY_MEAL:jG,RETIRE:TG,CONSUME:AG,FEED_CHICKENS:V$,COLLECT_EGGS:z$,GATHER_WATER:ua,TRADE_ROUTE:G6,MOUNT_HORSE:RG,BUY_HORSE_COSMETIC:CG,SELECT_HORSE_COSMETIC:IG,BUY:H6,SELL:$6,LOAD_CARAVAN:xG,UNLOAD_CARAVAN:bG,UPGRADE_CARAVAN:vG,REPAIR_CARAVAN:yG,TRAVEL_COMPLETE:C_,TRAVEL_FAILED:C_,BUY_CARAVAN_COSMETIC:_G,EQUIP_CARAVAN_COSMETIC:wG},xm=[{level:0,label:"Gammelt Trestativ",slots:2,cost:{wood:50}},{level:1,label:"Forsterket Jernstativ",slots:4,cost:{wood:100,ore:50}},{level:2,label:"Forgylt Kongestativ",slots:6,cost:{wood:200,ore:100,gold:500}}],OG=async(t,e,s)=>{const n=$(G,`simulation_rooms/${t}/players/${e}`),{type:i,slotId:a,itemId:l,instanceId:o,trophyId:c,price:u}=s;let d=!1,f="";return await je(n,h=>{if(!h)return;h.weaponRack||(h.weaponRack={level:0,slots:[],unlockedTrophies:[]});const m=h.weaponRack;m.slots||(m.slots=[]),m.unlockedTrophies||(m.unlockedTrophies=[]);const x=(xm.find(b=>b.level===m.level)||xm[0]).slots;if(i==="RACK_UPGRADE"){const b=xm.find(y=>y.level===m.level+1);if(!b)return;const g=b.cost;if(!Object.entries(g).every(([y,k])=>(h.resources[y]||0)>=k))return;Object.entries(g).forEach(([y,k])=>{const N=y;h.resources[N]=(h.resources[N]||0)-k}),m.level+=1,f=`Oppgraderte vpenstativet til ${b.label}!`,d=!0}if(i==="RACK_MOUNT_ITEM"){if(m.slots.length>=x)return;const b=(h.inventory||[]).findIndex(p=>p.id===l||p.id===o);if(b===-1)return;const g=h.inventory[b];h.inventory.splice(b,1),m.slots.push({id:`slot_${Date.now()}`,type:"ITEM",itemId:g.id,instanceId:g.id}),f=`Hengte opp ${g.name}`,d=!0}if(i==="RACK_MOUNT_TROPHY"){if(m.slots.length>=x||!m.unlockedTrophies.includes(c)||m.slots.some(b=>b.itemId===c))return;m.slots.push({id:`slot_${Date.now()}`,type:"TROPHY",itemId:c}),f="Plasserte trof p utstilling.",d=!0}if(i==="RACK_UNMOUNT"){const b=m.slots.findIndex(p=>p.id===a);if(b===-1)return;const g=m.slots[b];if(g.type==="ITEM"){const p=Oe[g.itemId];if(p){const y=JSON.parse(JSON.stringify(p));h.inventory||(h.inventory=[]),h.inventory.push(y)}}m.slots.splice(b,1),f="Tok ned gjenstand.",d=!0}if(i==="RACK_BUY_TROPHY"){if(h.resources.gold<u||m.unlockedTrophies.includes(c))return;h.resources.gold-=u,m.unlockedTrophies.push(c),f="Kjpte nytt trof!",d=!0}if(i==="RACK_POLISH"){const b=Date.now(),g=m.lastPolishedAt||0;if(b-g<6e4*60){f="Du m vente fr du kan pusse utstyret igjen.";return}m.lastPolishedAt=b,h.status.morale||(h.status.morale=50),h.status.morale=Math.min(100,h.status.morale+10),f="Pusset samlingen. Moralen ker!",d=!0}return h}),d&&f&&at(t,f),{success:d}},MG=(t,e,s,n)=>{var u,d;t.roleStats||(t.roleStats={});const i=t.role;t.roleStats[i]||(t.roleStats[i]={level:((u=t.stats)==null?void 0:u.level)||1,xp:((d=t.stats)==null?void 0:d.xp)||0,skills:JSON.parse(JSON.stringify(t.skills||Fs[i]||Fs.PEASANT))});const a=t.roleStats[i],l=a.skills[e];l&&(l.xp+=s||0,l.xp>=l.maxXp&&(l.level+=1,l.xp-=l.maxXp,l.maxXp=Math.floor(l.maxXp*1.5),n.push(` ${t.name} ble bedre i ${e}! (Niv ${l.level})`))),a.xp=(a.xp||0)+(s||0);const c=(f=>{const h=Xd.findIndex(m=>f<m);return h===-1?Xd.length:h})(a.xp);c>a.level&&(a.level=c,n.push(` ${t.name} har steget i rang som ${i} til Niv ${c}!`)),t.stats.xp=a.xp,t.stats.level=a.level,t.skills=a.skills};async function DG(t,e,s){var i,a,l;if(!t||!s)return;const n=$(G,`simulation_accounts/${t}`);try{const o=await de(n);if(!o.exists())return;const c=o.val(),u=c.characterHistory||[],d={name:s.name,role:s.role,level:((i=s.stats)==null?void 0:i.level)||1,xp:((a=s.stats)==null?void 0:a.xp)||0,roomPin:e,timestamp:Date.now()},f=[...u,d],h=((l=s.stats)==null?void 0:l.xp)||0,m=(c.globalXp||0)+h,v=Math.floor(Math.sqrt(m/100))+1;await ne(n,{characterHistory:f,globalXp:m,globalLevel:v,lastActive:Date.now()}),console.log(`Character life recorded for ${s.name} (${t})`)}catch(o){console.error("Failed to record character life:",o)}}async function LG(t,e,s){const n=typeof s=="string"?s:s.type,i=$(G,`simulation_rooms/${t}/players/${e}`),a=$(G,`simulation_rooms/${t}/regions`),l=$(G,`simulation_rooms/${t}/world`);try{const[o,c,u]=await Promise.all([de(i),de(a),de(l)]);if(!o.exists())return{success:!1,error:"Spiller finnes ikke"};const d=o.val();d.resources||(d.resources=Gt[d.role]||Gt.PEASANT);const f=c.val()||{},h=u.val()||{},m={success:!0,timestamp:Date.now(),message:"",utbytte:[],xp:[],durability:[]},v={world:h,regions:f,players:{[e]:d},markets:{},messages:[]},x={actor:d,room:v,pin:t,action:s,timestamp:new Date().toLocaleTimeString(),localResult:m,trackXp:(N,S)=>{},damageTool:()=>!0},b=wj[n];if(!b)return{success:!1,error:"Ukjent handling"};if(!b(x)||!m.success)return{success:!1,data:m};const p={};p[`players/${e}`]=d;const y=m.siegeWinnerId,k=m.targetRegionId;if(y&&k){const N=f[k],S=N.rulerId,w=k==="capital";if(S&&S!==y){const j=await de($(G,`simulation_rooms/${t}/players/${S}`));if(j.exists()){const A=j.val();A.role="PEASANT",A.status&&(A.status.legitimacy=0),p[`players/${S}`]=A,p[`public_profiles/${S}/role`]="PEASANT",en(t,"roleChanges","PEASANT (Demoted)",1)}}const E=await de($(G,`simulation_rooms/${t}/players/${y}`));if(E.exists()){const j=E.val(),A=j.regionId,O=w?"KING":"BARON";j.role=O,j.regionId=k,j.status&&(j.status.legitimacy=100),p[`players/${y}`]=j,p[`public_profiles/${y}/role`]=O,p[`public_profiles/${y}/regionId`]=k,N.rulerId=y,N.rulerName=j.name,w&&A&&A!=="capital"&&A!=="unassigned"&&I6(t,A)}}return p.regions=f,await ne($(G,`simulation_rooms/${t}`),p),{success:!0,data:m}}catch(o){return console.error("Siege Transaction Failed",o),{success:!1,error:o.message||"Beleiring feilet"}}}const PG=["MARKET_BUY","MARKET_SELL","RAID","TAX","TAX_PEASANTS","TAX_ROYAL","TRADE","TRADE_ROUTE","CONTRIBUTE_TO_UPGRADE","BUY","SELL","CONTRIBUTE","CONSTRUCT","UPGRADE_BUILDING","START_SIEGE","JOIN_SIEGE","SIEGE_ACTION","REINFORCE_GARRISON","REPAIR_WALLS","SET_TAX","UPGRADE_FORTIFICATION","TRAVEL_START","TRAVEL_COMPLETE"],kj=async(t,e,s)=>{const n=typeof s=="string"?s:s.type;return PG.includes(n)?await UG(t,e,s):n&&n.startsWith("RACK_")?await OG(t,e,s):BG(t,e,s)};async function BG(t,e,s){const n=$(G,`simulation_rooms/${t}/players/${e}`),i=$(G,`simulation_rooms/${t}/world`);let a=null;try{const l=await de(i),o=l.exists()?l.val():{season:"Spring",weather:"Clear",activeLaws:[]};if(await je(n,c=>{var k,N,S;if(!c)return c;c.resources||(c.resources=JSON.parse(JSON.stringify(Gt[c.role]||Gt.PEASANT))),c.skills||(c.skills=JSON.parse(JSON.stringify(Fs[c.role]||Fs.PEASANT))),c.status||(c.status={stamina:100,hp:100,authority:0,gold:c.resources.gold||0,level:1,xp:0}),c.equipment||(c.equipment={HEAD:null,BODY:null,MAIN_HAND:null,OFF_HAND:null,FEET:null,TRINKET:null,AXE:null,PICKAXE:null,SCYTHE:null,HAMMER:null}),c.stats||(c.stats={level:1,xp:0}),c.activeBuffs||(c.activeBuffs=[]);const u={success:!0,timestamp:Date.now(),message:"",utbytte:[],xp:[],durability:[]},d=(w,E)=>{var M,U,C,T,R,D;let j=E;const A=((M=o.settlement)==null?void 0:M.buildings)||{},L={WOODCUTTING:"sawmill",FARMING:"windmill",MINING:"smeltery",CRAFTING:"great_forge",TRADING:"weavery"}[w];L&&(((U=A[L])==null?void 0:U.level)||1)>=2&&(j=Math.ceil(j*1.1));const Y=((T=(C=c.skills)==null?void 0:C[w])==null?void 0:T.level)||0,W=[];MG(c,w,j,W),W.length>0&&(u.message+=" "+W.join(" "));const H=((D=(R=c.skills)==null?void 0:R[w])==null?void 0:D.level)||0;u.xp.push({skill:w,amount:j,levelUp:H>Y})},f=c.stats.level||1,h=(w,E)=>{var A;const j=(A=c.equipment)==null?void 0:A[w];return j&&(j.durability=Math.max(0,j.durability-E),u.durability.push({slot:w,item:j.name||"Gjenstand",amount:E,broken:j.durability<=0}),j.durability<=0)?(u.message=` ${j.name} ble delagt!`,u.success=!1,!1):!0},m=Date.now(),v=m-(c.lastActive||m),x=Math.min(60,isNaN(v)?0:v/6e4);if(x>.1){let w=0;(k=c.upgrades)!=null&&k.includes("cow")&&(w+=x*te.PASSIVE_INCOME.COW),(N=c.upgrades)!=null&&N.includes("accounting_books")&&(w+=x*te.PASSIVE_INCOME.ACCOUNTING_BOOKS),(S=c.upgrades)!=null&&S.includes("caravan")&&(w+=x*te.PASSIVE_INCOME.CARAVAN),w>0&&(c.resources.gold=(c.resources.gold||0)+Math.floor(w));const E=x*2;c.status.stamina=Math.min(100,(c.status.stamina||0)+E)}const b=c.role,g=typeof s=="string"?s:s.type,p=Rl[g];if(p){const w=Ys(p.stamina||0,o.season,o.weather,c.activeBuffs,o.gameTick||0);for(const[E,j]of Object.entries(p)){if(E==="stamina")continue;const A=E;if((c.resources[A]||0)<j)return u.success=!1,u.message=` Mangler ${j} ${E}!`,a=u,c}if((c.status.stamina||0)<w)return u.success=!1,u.message=` For sliten! (${w} kreves)`,a=u,c;for(const[E,j]of Object.entries(p)){if(E==="stamina")continue;const A=E;c.resources[A]=(c.resources[A]||0)-j,en(t,"consumed",E,j)}c.status.stamina-=w}const y=wj[g];if(y){const w={actor:c,room:{world:o,players:{[e]:c},messages:[]},pin:t,action:s,timestamp:new Date().toLocaleTimeString(),localResult:u,trackXp:d,damageTool:h};if(y(w)===!1)return a=u,c}else u.success=!1,u.message=`Ukjent handling: ${g}`;return u.message||(u.message="Handling utfrt."),u.success&&Math.random()<.005&&(c.resources.gold=(c.resources.gold||0)+150,u.utbytte.push({id:"ancient_relic",name:"Gammel Relikvie",type:"ITEM",icon:"",amount:1,jackpot:!0}),u.message+="  ET JORDFUNN! Du fant en eldgammel relikvie!"),c.lastActive=Date.now(),a=u,g==="RETIRE"&&u.success&&(a.characterSnapshot=JSON.parse(JSON.stringify(c))),c.stats.level>f&&(a.newLevel=c.stats.level),c.role!==b&&en(t,"roleChanges",c.role,1),c}),a&&a.success){if(a.message&&await at(t,`[${new Date().toLocaleTimeString()}] ${a.message}`),a.utbytte&&a.utbytte.length>0&&a.utbytte.forEach(c=>{const u=c.type==="ITEM"?"crafted":"produced";en(t,u,c.id||c.resource,c.amount||1)}),a.characterSnapshot){const c=a.characterSnapshot.uid||e;await DG(c,t,a.characterSnapshot)}if(a.newLevel)try{await ne($(G,`simulation_rooms/${t}/public_profiles/${e}`),{"stats/level":a.newLevel,lastActive:Date.now()})}catch(c){console.error("Failed to sync level",c)}}return{success:!!(a!=null&&a.success),data:a||void 0}}catch(l){return console.error("Action error:",l),{success:!1,error:l.message||"Handling feilet"}}}async function UG(t,e,s){const n=typeof s=="string"?s:s.type;try{return n==="BUY"||n==="SELL"||n==="TRADE_ROUTE"||n==="MARKET_BUY"||n==="MARKET_SELL"?await T6(t,e,s):n==="CONTRIBUTE"||n==="CONTRIBUTE_TO_UPGRADE"||n==="CONSTRUCT"||n==="UPGRADE_BUILDING"?await A6(t,e,s):n==="TAX"||n==="TAX_PEASANTS"||n==="TAX_ROYAL"?await R6(t,e,s):n==="START_SIEGE"||n==="JOIN_SIEGE"||n==="SIEGE_ACTION"||n==="UPGRADE_FORTIFICATION"||n==="REINFORCE_GARRISON"||n==="REPAIR_WALLS"?await LG(t,e,s):n==="SET_TAX"?await O6(t,e,s):n==="TRAVEL_START"?await B6(t,e,s):n==="TRAVEL_COMPLETE"?await U6(t,e,s):{success:!1,error:"Global handling not available."}}catch(i){return console.error("Global Action ERROR:",i),{success:!1,error:i.message||"Global handling feilet"}}}class HG{constructor(e,s){et(this,"player");et(this,"genome");et(this,"brain");et(this,"startTime");et(this,"history",[]);et(this,"status","RUNNING");et(this,"lastActionAt",0);et(this,"stuckThreshold",6e4);this.player=e,this.genome=s,this.brain=new C$(s),this.startTime=Date.now()}async tick(e,s){if(this.status!=="RUNNING")return;const n=this.brain.decide(this.player,e);if(this.history.push(n),this.history.length>20&&this.history.shift(),n.action==="IDLE"){Date.now()-this.lastActionAt>this.stuckThreshold&&(this.status="STUCK",this.dumpLog("Bottleneck detected: Stuck for > 60s"));return}this.lastActionAt=Date.now(),(await kj(s,this.player.id,n.action)).success,this.player.role==="KING"&&(this.status="SUCCESS")}getFitness(){return yp.calculateFitness(this.player,this.startTime)}dumpLog(e){const s={reason:e,genome:this.genome,history:this.history,playerState:this.player,timestamp:Date.now()};console.error("AI Training Lab - Game Balance Issue:",s),window.lastAILog=s}}const $G=({roomData:t,pin:e})=>{var N;const[s,n]=_.useState([]),[i,a]=_.useState(0),[l,o]=_.useState(!1),[c,u]=_.useState([]),[d,f]=_.useState({}),[h,m]=_.useState({}),[v,x]=_.useState(null),b=_.useRef(t);_.useEffect(()=>{b.current=t},[t]);const g=_.useRef(null),p=async()=>{const S={};for(let w=1;w<=5;w++){const E=`bot_${Date.now()}_${w}`,j={id:E,name:`BOT Alpha ${w}`,role:"PEASANT",regionId:Math.random()>.5?"region_ost":"region_vest",resources:{...Gt.PEASANT},status:{hp:100,stamina:100,morale:100,legitimacy:100,authority:50,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:1,xp:0,reputation:10,contribution:0},skills:{...Fs.PEASANT},lastActive:Date.now(),online:!0};S[`simulation_rooms/${e}/players/${E}`]=j,S[`simulation_rooms/${e}/public_profiles/${E}`]={id:E,stats:{level:1},status:j.status,online:!0,lastActive:Date.now()}}try{await ne($(G),S)}catch(w){console.error("Failed to spawn bots",w)}},y=()=>{t.players&&o(!0)},k=()=>{o(!1),g.current&&cancelIdleCallback(g.current)};return _.useEffect(()=>{if(l){const S=async()=>{const w=b.current,E=Object.values(w.players||{}).filter(j=>j.name.includes("BOT"));await Promise.all(E.map(async j=>{let A=s.find(O=>O.player.id===j.id);if(A)A.player=j;else{const O=yp.getNextGenerationGenome();A=new HG(j,O),n(L=>[...L,A]),a(O.generation)}if(await A.tick(w,e),A.history.length>0){const O=A.history[A.history.length-1];let L=O.action.type||"IDLE";L==="SELL"&&O.action.itemId?L=`SELL (${O.action.itemId})`:L==="BUY"&&O.action.itemId&&(L=`BUY (${O.action.itemId})`),f(Y=>({...Y,[L]:(Y[L]||0)+1})),m(Y=>({...Y,[A.player.id]:{name:A.player.name,action:L,reason:O.reason,score:O.score.toFixed(2),fitness:A.getFitness().toFixed(1),resources:{...A.player.resources},stamina:A.player.status.stamina}}))}if((A.status==="STUCK"||A.status==="DEAD")&&x(window.lastAILog),A.status==="SUCCESS"||A.status==="DEAD"||A.status==="STUCK"){const O=A.getFitness();A.genome.fitness=O,yp.saveTopGenomes([A.genome]),u(L=>[...L.slice(-19),O])}})),g.current=window.setTimeout(()=>S(),1e3)};S()}return()=>{g.current&&clearTimeout(g.current)}},[l,e]),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center bg-slate-900/50 p-6 rounded-2xl border border-white/10",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[r.jsx(BU,{className:"text-indigo-400"})," AI Training Lab"]}),r.jsx("p",{className:"text-slate-400 text-sm",children:"Genetisk Algoritme-optimalisering av spillbalanse"})]}),r.jsx("div",{className:"flex gap-3",children:l?r.jsxs("button",{onClick:k,className:"bg-red-600 hover:bg-red-500 px-4 py-2 rounded-lg flex items-center gap-2 font-bold transition-all",children:[r.jsx(gp,{size:18})," Stopp Trening"]}):r.jsxs("button",{onClick:y,className:"bg-indigo-600 hover:bg-indigo-500 px-4 py-2 rounded-lg flex items-center gap-2 font-bold transition-all",children:[r.jsx(xp,{size:18})," Start Trening"]})})]}),l&&Object.values(t.players||{}).filter(S=>S.name.includes("BOT")||S.id.startsWith("bot_")).length===0&&r.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/20 p-6 rounded-2xl flex items-center justify-between animate-in slide-in-from-top-2",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"bg-amber-500/20 p-3 rounded-full text-amber-500",children:r.jsx(ab,{size:24})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-amber-500 font-black uppercase text-sm",children:"Ingen bot-subjekter funnet"}),r.jsx("p",{className:"text-amber-200/60 text-xs",children:"AI-en trenger kropper  kontrollere (navn med 'BOT' eller ID 'bot_')."})]})]}),r.jsx("button",{onClick:p,className:"bg-amber-500 hover:bg-amber-400 text-black px-6 py-3 rounded-xl font-black uppercase text-xs tracking-widest transition-all shadow-lg hover:scale-105",children:" Spawn Alpha Squad (5 stk)"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"bg-slate-900/50 p-6 rounded-2xl border border-white/10",children:[r.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-xs uppercase font-black mb-2",children:[r.jsx(S_,{size:14})," Generasjon"]}),r.jsx("div",{className:"text-4xl font-black",children:i})]}),r.jsxs("div",{className:"bg-slate-900/50 p-6 rounded-2xl border border-white/10 flex flex-col justify-between",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-xs uppercase font-black mb-2",children:[r.jsx(rf,{size:14})," Fitness Trend"]}),r.jsx("div",{className:"text-4xl font-black mb-4",children:c.length>0?(c.reduce((S,w)=>S+w,0)/c.length).toFixed(1):"0.0"})]}),r.jsxs("div",{className:"h-12 flex items-end gap-1 px-1",children:[c.map((S,w)=>{const E=Math.max(...c,1),j=S/E*100;return r.jsx("div",{className:"flex-1 bg-indigo-500/50 rounded-t-sm transition-all duration-500 hover:bg-indigo-400",style:{height:`${j}%`},title:`Fitness: ${S.toFixed(1)}`},w)}),c.length===0&&r.jsx("div",{className:"w-full h-[1px] bg-white/10"})]})]}),r.jsxs("div",{className:"bg-slate-900/50 p-6 rounded-2xl border border-white/10 text-amber-500",children:[r.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-xs uppercase font-black mb-2",children:[r.jsx(hc,{size:14})," Bottlenecks"]}),r.jsx("div",{className:"text-4xl font-black text-amber-500",children:s.filter(S=>S.status==="STUCK").length})]})]}),r.jsxs("div",{className:"bg-slate-900/50 p-6 rounded-2xl border border-white/10",children:[r.jsx("h3",{className:"text-sm font-bold uppercase tracking-widest text-slate-400 mb-4",children:"Decision Heatmap"}),r.jsxs("div",{className:"flex flex-wrap gap-4",children:[Object.entries(d).sort((S,w)=>w[1]-S[1]).map(([S,w])=>r.jsxs("div",{className:"bg-white/5 p-3 rounded-lg border border-white/5 flex flex-col items-center min-w-[80px]",children:[r.jsx("span",{className:"text-xs text-slate-500 uppercase",children:S}),r.jsx("span",{className:"text-lg font-bold",children:w})]},S)),Object.keys(d).length===0&&r.jsx("p",{className:"text-slate-600 italic",children:"Ingen data enn..."})]})]}),r.jsxs("div",{className:"bg-slate-900/50 p-6 rounded-2xl border border-white/10",children:[r.jsxs("h3",{className:"text-sm font-bold uppercase tracking-widest text-slate-400 mb-4 flex items-center gap-2",children:[r.jsx(S_,{size:16,className:"text-indigo-400"})," Live Neural Feed"]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full text-left border-collapse",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"text-xs uppercase text-slate-500 border-b border-white/10",children:[r.jsx("th",{className:"p-3",children:"Subject"}),r.jsx("th",{className:"p-3",children:"Last Decision"}),r.jsx("th",{className:"p-3",children:"Reasoning"}),r.jsx("th",{className:"p-3",children:"Score"}),r.jsx("th",{className:"p-3",children:"Fitness"}),r.jsx("th",{className:"p-3",children:"Gold"}),r.jsx("th",{className:"p-3",children:"Stamina"})]})}),r.jsxs("tbody",{className:"text-sm",children:[Object.entries(h).map(([S,w])=>r.jsxs("tr",{className:"border-b border-white/5 hover:bg-white/5 transition-colors font-mono",children:[r.jsx("td",{className:"p-3 font-bold text-indigo-300",children:w.name}),r.jsx("td",{className:"p-3",children:r.jsx("span",{className:"bg-indigo-500/20 text-indigo-300 px-2 py-1 rounded text-xs font-bold border border-indigo-500/30",children:w.action})}),r.jsxs("td",{className:"p-3 text-slate-400 italic text-xs",children:['"',w.reason,'"']}),r.jsx("td",{className:"p-3 text-slate-300",children:w.score}),r.jsx("td",{className:"p-3 font-bold text-white",children:w.fitness}),r.jsx("td",{className:"p-3 text-amber-400",children:w.resources.gold}),r.jsx("td",{className:"p-3",children:r.jsx("div",{className:"w-16 h-1 bg-slate-700 rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full bg-emerald-500",style:{width:`${w.stamina}%`}})})})]},S)),Object.keys(h).length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,className:"p-8 text-center text-slate-600 italic",children:"Venter p telemetri..."})})]})]})})]}),v&&r.jsxs("div",{className:"bg-red-950/30 border border-red-500/30 p-6 rounded-2xl",children:[r.jsxs("h3",{className:"text-red-400 font-bold flex items-center gap-2 mb-4",children:[r.jsx(hc,{size:18})," Game Balance Issue Detected"]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[r.jsxs("div",{className:"bg-black/40 p-4 rounded-lg",children:[r.jsx("p",{className:"text-slate-400 text-xs uppercase mb-2",children:"Grunn"}),r.jsx("p",{className:"font-mono",children:v.reason})]}),r.jsxs("div",{className:"bg-black/40 p-4 rounded-lg",children:[r.jsx("p",{className:"text-slate-400 text-xs uppercase mb-2",children:"Siste Handling"}),r.jsx("p",{className:"font-mono",children:((N=v.history[v.history.length-1])==null?void 0:N.action.type)||"None"})]})]}),r.jsx("pre",{className:"mt-4 p-4 bg-black/40 rounded-lg overflow-x-auto text-[10px] text-slate-300 custom-scrollbar",children:JSON.stringify(v,null,2)})]})]})},GG=Ne.memo(({pin:t,roomData:e,view:s,setView:n,isLoading:i,onBack:a,worldActions:l,playerActions:o,SimulationEconomyBlueprint:c})=>{var u,d,f,h;return r.jsxs("div",{className:"fixed inset-0 top-0 bg-slate-950 text-slate-200 flex overflow-hidden font-sans selection:bg-indigo-500/30 z-20",children:[r.jsxs("div",{className:"fixed inset-0 pointer-events-none opacity-20",children:[r.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-indigo-600/20 blur-[120px] rounded-full animate-pulse"}),r.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-amber-600/10 blur-[120px] rounded-full"})]}),r.jsx(T$,{pin:t,roomData:e,isLoading:i,onBack:a,...l,...o}),r.jsxs("main",{className:"flex-1 relative flex flex-col bg-slate-900/10 overflow-hidden no-scrollbar",children:[r.jsxs("header",{className:"h-16 border-b border-white/5 bg-slate-950/30 backdrop-blur-md flex items-center justify-between px-8 shrink-0 z-10",children:[r.jsxs("div",{className:"flex items-center gap-8",children:[r.jsxs("nav",{className:"flex items-center bg-white/5 p-1 rounded-xl border border-white/10",children:[r.jsx("button",{onClick:()=>n("MANAGE"),className:`px-4 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${s==="MANAGE"?"bg-indigo-600 text-white shadow-lg":"text-slate-500 hover:text-white"}`,children:"Overvking"}),r.jsx("button",{onClick:()=>n("ECONOMY"),className:`px-4 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${s==="ECONOMY"?"bg-indigo-600 text-white shadow-lg":"text-slate-500 hover:text-white"}`,children:"Blueprint"}),r.jsx("button",{onClick:()=>n("AI_LAB"),className:`px-4 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${s==="AI_LAB"?"bg-indigo-600 text-white shadow-lg":"text-slate-500 hover:text-white"}`,children:"AI Training Lab"})]}),r.jsx("div",{className:"h-4 w-[1px] bg-white/10 mx-2"}),r.jsxs("div",{className:"flex items-center gap-8",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Innbyggere:"}),r.jsx("span",{className:"text-sm font-bold text-white",children:Object.keys(e.players||{}).length})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"r i Riket:"}),r.jsx("span",{className:"text-sm font-bold text-white",children:((u=e.world)==null?void 0:u.year)||1100})]})]})]}),i&&r.jsx("div",{className:"text-[10px] font-black uppercase tracking-widest text-indigo-400 animate-pulse",children:"Prosesserer Endringer..."})]}),r.jsx("div",{className:"flex-1 p-8 overflow-y-auto custom-scrollbar no-scrollbar",children:s==="ECONOMY"?c?r.jsx(c,{}):r.jsx("div",{className:"p-20 text-center animate-pulse text-slate-500 font-black uppercase tracking-widest",children:"Laster Blueprint..."}):s==="AI_LAB"?r.jsx($G,{roomData:e,pin:t}):r.jsxs("div",{className:"space-y-12 pb-20",children:[r.jsx(A$,{players:e.players,onKick:o.kickPlayer,onLevelChange:o.handlePlayerLevelChange,onRoleChange:o.handleRoleChange,onRegionChange:o.handleRegionChange,onControl:o.controlPlayer,onGiveGold:o.onGiveGold,onGiveResource:o.onGiveResource,onGiveItem:o.onGiveItem}),((d=e.world)==null?void 0:d.settlement)&&r.jsxs("section",{className:"bg-indigo-900/10 border border-indigo-500/10 p-10 rounded-[3rem] relative overflow-hidden group",children:[r.jsxs("div",{className:"relative z-10",children:[r.jsxs("h2",{className:"text-3xl font-black text-white mb-8 tracking-tighter flex items-center justify-between",children:["Landsbyutvikling",r.jsx("span",{className:"text-xs font-black uppercase tracking-widest text-indigo-400 bg-indigo-500/10 px-4 py-2 rounded-full",children:"Status Rapport"})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:Object.values(((h=(f=e.world)==null?void 0:f.settlement)==null?void 0:h.buildings)||{}).map(m=>{const v=cs[m.id],x=m.progress/(m.target||200)*100;return r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between items-end",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-black text-white uppercase",children:v==null?void 0:v.name}),r.jsxs("p",{className:"text-[10px] text-slate-500 font-bold tracking-tight",children:["Niv ",m.level]})]}),r.jsxs("span",{className:"text-xs font-mono text-indigo-500",children:[Object.values(m.progress||{}).reduce((b,g)=>b+g,0)," / ",m.target||200]})]}),r.jsxs("div",{className:"h-4 bg-black/40 rounded-full overflow-hidden border border-white/5 relative group/progress",children:[r.jsx("div",{className:"h-full bg-gradient-to-r from-indigo-600 via-indigo-400 to-fuchsia-500 transition-all duration-1000 shadow-[0_0_15px_rgba(99,102,241,0.4)] relative",style:{width:`${x}%`},children:r.jsx("div",{className:"absolute inset-0 bg-white/20 animate-pulse"})}),r.jsxs("div",{className:"absolute inset-0 opacity-0 group-hover/progress:opacity-100 transition-opacity flex justify-between items-center px-1 pointer-events-none",children:[r.jsx("button",{onClick:b=>{b.stopPropagation(),l.handleBuildingLevelChange(m.id,-1)},className:"w-5 h-5 bg-white/10 hover:bg-rose-500 text-white rounded-full flex items-center justify-center text-[10px] font-black pointer-events-auto transition-all",children:"-"}),r.jsx("button",{onClick:b=>{b.stopPropagation(),l.handleBuildingLevelChange(m.id,1)},className:"w-5 h-5 bg-white/10 hover:bg-emerald-500 text-white rounded-full flex items-center justify-center text-[10px] font-black pointer-events-auto transition-all",children:"+"})]})]})]},m.id)})})]}),r.jsx("div",{className:"absolute top-[-20%] right-[-10%] text-[15rem] text-indigo-500 opacity-[0.03] pointer-events-none group-hover:rotate-6 transition-transform duration-[3000ms]",children:""})]})]})})]}),r.jsx(R$,{roomData:e}),r.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .custom-scrollbar::-webkit-scrollbar {
                    width: 4px;
                }
                .custom-scrollbar::-webkit-scrollbar-track {
                    background: transparent;
                }
                .custom-scrollbar::-webkit-scrollbar-thumb {
                    background: rgba(255, 255, 255, 0.1);
                    border-radius: 10px;
                }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover {
                    background: rgba(255, 255, 255, 0.2);
                }
                .no-scrollbar::-webkit-scrollbar {
                    display: none;
                }
            `}})]})}),FG="Enevelde",VG=()=>{var C;const[t,e]=_.useState(""),[s,n]=_.useState([]),[i,a]=_.useState(!1),[l,o]=_.useState("LIST"),[c,u]=_.useState(()=>sessionStorage.getItem("admin_session")==="active"),{setFullWidth:d,setHideHeader:f}=lS(),{roomData:h,setRoomData:m,onlineCount:v}=V6(t),x=T=>T?Array.isArray(T)?T:Object.values(T).sort((R,D)=>R.timestamp-D.timestamp):[];_.useEffect(()=>(d(!0),f(!0),()=>{d(!1),f(!1)}),[d,f]),_.useEffect(()=>(t&&(l==="MANAGE"||l==="ECONOMY"||l==="AI_LAB")?document.title=`Host: ${t} | Eiriksbok`:document.title="Simuleringshallen | Eiriksbok",()=>{document.title="Eiriksbok"}),[t,l]),S2(t,(h==null?void 0:h.status)||"LOBBY",h==null?void 0:h.world,v),_.useEffect(()=>{if(!t||!(h!=null&&h.world)||h.status!=="PLAYING")return;const R=setInterval(async()=>{const D=h.world.sea_resources||{};if(Object.keys(D).length<15){const P=Math.floor(Math.random()*2)+1,B={};for(let se=0;se<P;se++){const ie=`fish_${Date.now()}_${Math.random().toString(36).substr(2,5)}`,Ee=Math.floor(Math.random()*4e3),ye=Math.floor(Math.random()*4e3),ae=["COD","HERRING","SALMON","TUNA"],Z=ae[Math.floor(Math.random()*ae.length)];B[`simulation_rooms/${t}/world/sea_resources/${ie}`]={id:ie,x:Ee,y:ye,type:Z,amount:Math.floor(Math.random()*5)+1,expiresAt:Date.now()+1e3*60*10}}const J=Date.now();Object.values(D).forEach(se=>{se.expiresAt<J&&(B[`simulation_rooms/${t}/world/sea_resources/${se.id}`]=null)}),Object.keys(B).length>0&&await ne($(G),B)}},1e4);return()=>clearInterval(R)},[t,h==null?void 0:h.status,(C=h==null?void 0:h.world)==null?void 0:C.sea_resources]),_.useEffect(()=>{const T=$(G,"simulation_rooms"),R=$e(T,D=>{const I=D.val();if(I){const F=Object.entries(I).map(([P,B])=>({...B,pin:B.pin||P}));n(F.reverse())}else n([])});return()=>R()},[]);const b=async()=>{const T=prompt("Hva skal riket hete? (La st tomt for automatisk navn)");if(T===null)return;a(!0);const R=Math.floor(1e3+Math.random()*9e3).toString(),D=T.trim()||`Rike #${R}`,I=y6(R,D);try{await qi($(G,`simulation_rooms/${R}`),I),await Qd(R,I),e(R),o("MANAGE")}catch(F){console.error(F),alert("Kunne ikke opprette rom.")}finally{a(!1)}},g=async T=>{if(window.confirm(`ER DU SIKKER? Dette vil slette rommet ${T} permanent!`)){a(!0);try{await l1($(G,`simulation_rooms/${T}`)),await l1($(G,`simulation_server_metadata/${T}`))}catch(R){console.error(R),alert("Kunne ikke slette rommet.")}finally{a(!1)}}},p=async()=>{a(!0);try{const[T,R]=await Promise.all([de($(G,"simulation_server_metadata")),de($(G,"simulation_rooms"))]),D=T.val()||{},I=R.val()||{};let F=0;const P={};Object.keys(D).forEach(B=>{I[B]||(P[`simulation_server_metadata/${B}`]=null,F++)}),F>0?(await ne($(G),P),alert(`Ryddet opp ${F} dde serverkoblinger!`)):alert("Alt ser ryddig ut!")}catch(T){console.error(T)}finally{a(!1)}},y=async()=>{if(!(!h||!h.players)){a(!0);try{const T=x6(h.players),R={region_vest:{id:"region_vest",name:"Baroniet Vest",taxRate:10,defenseLevel:50,rulerName:"Ingen"},region_ost:{id:"region_ost",name:"Baroniet st",taxRate:10,defenseLevel:50,rulerName:"Ingen"}},D={...h.markets};D.capital||(D.capital=JSON.parse(JSON.stringify(st))),["region_vest","region_ost"].forEach(P=>{D[P]||(D[P]=JSON.parse(JSON.stringify(st)))}),Object.values(T).forEach(P=>{if(P.role==="BARON"){R[P.regionId]={...R[P.regionId],rulerName:P.name};const B=JSON.parse(JSON.stringify(st));Object.keys(B).forEach(J=>{B[J].price=Math.floor(B[J].price*(.8+Math.random()*.4)),B[J].stock=Math.floor(B[J].stock*(.8+Math.random()*.4))}),D[P.regionId]=B}});const I={};Object.values(T).forEach(P=>{I[P.id]={id:P.id,name:P.name,role:P.role,regionId:P.regionId,stats:{level:P.stats.level||1},status:{isJailed:!1,isFrozen:!1,legitimacy:100},online:!0,lastActive:P.lastActive}});const F={};F[`simulation_rooms/${t}/players`]=T,F[`simulation_rooms/${t}/public_profiles`]=I,F[`simulation_rooms/${t}/regions`]=R,F[`simulation_rooms/${t}/markets`]=D,F[`simulation_rooms/${t}/status`]="PLAYING",await ne($(G),F),await Qd(t,{...h,status:"PLAYING"})}catch(T){console.error(T),alert("Klarte ikke starte.")}finally{a(!1)}}},k=async()=>{var T,R;if(h!=null&&h.players){a(!0);try{const D=((R=(T=h.world)==null?void 0:T.taxRateDetails)==null?void 0:R.kingTax)||20,{updatedPlayers:I,results:F}=b6(h.players,D);await ne($(G,`simulation_rooms/${t}/players`),I),alert(`Suksess! ${F.length} bnder og baroner ble skattlagt.`)}catch(D){console.error(D)}finally{a(!1)}}},N=async()=>{var F,P;if(!h)return;const T=["Spring","Summer","Autumn","Winter"],D=(T.indexOf(((F=h.world)==null?void 0:F.season)||"Spring")+1)%T.length,I=T[D];a(!0);try{const B=((P=Us[I])==null?void 0:P.label)||I,J={id:`msg_${Date.now()}`,content:` rstiden har skiftet til ${B}!`,timestamp:Date.now(),type:"SEASON_CHANGE"},se=[...x(h.messages),J].slice(-50);await ne($(G),{[`simulation_rooms/${t}/world/season`]:I,[`simulation_rooms/${t}/messages`]:se})}catch(B){console.error(B)}finally{a(!1)}},S=async()=>{if(!h)return;const T=["Clear","Rain","Storm","Fog"],R=T.indexOf(h.world.weather||"Clear"),D=T[(R+1)%T.length];try{const I={Clear:"Klart",Rain:"Regn",Storm:"Storm",Fog:"Tke"},F={id:`msg_${Date.now()}`,content:` Vret har skiftet til ${I[D]||D}!`,timestamp:Date.now(),type:"WEATHER_CHANGE"},P=[...x(h.messages),F].slice(-50);await ne($(G),{[`simulation_rooms/${t}/world/weather`]:D,[`simulation_rooms/${t}/messages`]:P})}catch(I){console.error(I)}},w=async()=>{if(!h)return;const{LAW_TEMPLATES:T}=await zt(async()=>{const{LAW_TEMPLATES:I}=await Promise.resolve().then(()=>c1);return{LAW_TEMPLATES:I}},void 0),R=T[Math.floor(Math.random()*T.length)],D={lawId:R.id,title:R.label,votes:{},expiresAt:Date.now()+6e4};try{const I={id:`msg_${Date.now()}`,content:` TINGET ER SATT! Det skal stemmes over loven: "${R.label}"!`,timestamp:Date.now(),type:"VOTE_START"},F=[...x(h.messages),I].slice(-50);await ne($(G,`simulation_rooms/${t}`),{activeVote:D,messages:F}),setTimeout(()=>E(R.id),6e4)}catch(I){console.error(I)}},E=async T=>{var ie;const R=await de($(G,`simulation_rooms/${t}/activeVote`));if(!R.exists())return;const D=R.val(),I=Object.values(D.votes||{}),F=I.filter(Ee=>Ee==="YES").length,P=I.filter(Ee=>Ee==="NO").length;let B=((ie=h==null?void 0:h.world)==null?void 0:ie.activeLaws)||[],J=F>P?` LOVEN ER VEDTATT! "${D.title}" er n gjeldende.`:` LOVEN BLE FORKASTET. "${D.title}" ble nedstemt.`;F>P&&(B=[...B,T]);const se={id:`msg_${Date.now()}`,content:J,timestamp:Date.now(),type:"VOTE_RESULT"};try{await ne($(G,`simulation_rooms/${t}/world`),{activeLaws:B}),await ne($(G,`simulation_rooms/${t}`),{activeVote:null,messages:[...x(h==null?void 0:h.messages),se].slice(-50)})}catch(Ee){console.error(Ee)}},j=async()=>{if(!h)return;const{WORLD_EVENT_TEMPLATES:T}=await zt(async()=>{const{WORLD_EVENT_TEMPLATES:I}=await Promise.resolve().then(()=>c1);return{WORLD_EVENT_TEMPLATES:I}},void 0),R=T[Math.floor(Math.random()*T.length)],D=`event_${Date.now()}`;try{const I={id:`msg_${Date.now()}`,content:` HENDELSE: ${R.title}! Sjekk kartet!`,timestamp:Date.now(),type:"EVENT_SPAWN"},F=[...x(h.messages),I].slice(-50);await ne($(G,`simulation_rooms/${t}/worldEvents`),{[D]:{...R,id:D,expiresAt:Date.now()+3e5}}),await ne($(G,`simulation_rooms/${t}`),{messages:F})}catch(I){console.error(I)}},A=async T=>{a(!0);try{const R=`char_${Math.random().toString(36).substr(2,9)}`,D={id:R,name:T.name,role:T.role,regionId:T.role==="KING"?"capital":Math.random()>.5?"region_ost":"region_vest",resources:Gt[T.role]||Gt.PEASANT,status:{hp:100,stamina:100,morale:100,legitimacy:100,authority:50,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:T.level,xp:0,reputation:10,contribution:0},skills:Fs[T.role]||Fs.PEASANT,lastActive:Date.now(),online:!0},I={};I[`simulation_rooms/${t}/players/${R}`]=D,I[`simulation_rooms/${t}/public_profiles/${R}`]={id:R,name:D.name,role:D.role,regionId:D.regionId,stats:{level:D.stats.level},status:{isJailed:!1,isFrozen:!1,legitimacy:100},online:!0,lastActive:D.lastActive},await ne($(G),I)}catch(R){console.error(R)}finally{a(!1)}},O=async()=>{if(window.confirm("Er du sikker? Dette vil regenerere 'public_profiles'.")){a(!0);try{const T=await de($(G,`simulation_rooms/${t}`));if(!T.exists())return;const R=T.val(),D=R.players||{},I={};Object.entries(D).forEach(([F,P])=>{var B,J,se,ie;I[`simulation_rooms/${t}/public_profiles/${F}`]={id:F,uid:P.uid||null,name:P.name,role:P.role,regionId:P.regionId,stats:{level:((B=P.stats)==null?void 0:B.level)||1},status:{isJailed:((J=P.status)==null?void 0:J.isJailed)||!1,isFrozen:((se=P.status)==null?void 0:se.isFrozen)||!1,legitimacy:((ie=P.status)==null?void 0:ie.legitimacy)||100},online:!0,lastActive:P.lastActive||Date.now()}}),R.status||(I[`simulation_rooms/${t}/status`]="LOBBY"),await ne($(G),I),alert("Data reparert!")}catch(T){console.error(T)}finally{a(!1)}}},L=async()=>{if(window.confirm("Er du sikker? Alt slettes.")){a(!0);try{const T={};T[`simulation_rooms/${t}/status`]="LOBBY",T[`simulation_rooms/${t}/worldEvents`]={},T[`simulation_rooms/${t}/messages`]=[],T[`simulation_rooms/${t}/market`]=st,T[`simulation_rooms/${t}/markets`]={capital:st},T[`simulation_rooms/${t}/regions`]={},T[`simulation_rooms/${t}/world/monumentProgress`]=0,T[`simulation_rooms/${t}/world/activeLaws`]=[],T[`simulation_rooms/${t}/world/settlement/buildings`]=Object.entries(cs).reduce((R,[D])=>({...R,[D]:{id:D,level:0,progress:{},target:200,contributions:{}}}),{}),Object.keys((h==null?void 0:h.players)||{}).forEach(R=>{T[`simulation_rooms/${t}/players/${R}/role`]="PEASANT",T[`simulation_rooms/${t}/players/${R}/regionId`]="capital",T[`simulation_rooms/${t}/players/${R}/resources`]=Gt.PEASANT,T[`simulation_rooms/${t}/players/${R}/status`]={stamina:100,legitimacy:100,authority:50},T[`simulation_rooms/${t}/public_profiles/${R}/role`]="PEASANT",T[`simulation_rooms/${t}/public_profiles/${R}/regionId`]="capital",T[`simulation_rooms/${t}/public_profiles/${R}/stats/level`]=1}),await ne($(G),T),m(R=>R?{...R,status:"LOBBY",messages:[]}:null),alert("Spillet er nullstilt!")}catch(T){console.error(T)}finally{a(!1)}}},[Y,W]=_.useState(null);if(_.useEffect(()=>{zt(()=>import("./SimulationEconomyBlueprint-DXBQABye.js"),[]).then(T=>W(()=>T.SimulationEconomyBlueprint))},[]),!c)return r.jsx(E$,{onAuth:()=>u(!0),adminPassword:FG});if(l==="LIST")return r.jsx(j$,{allRooms:s,isLoading:i,onCreateRoom:b,onDeleteRoom:g,onManageRoom:T=>{e(T),o("MANAGE")},onCleanupMetadata:p});const H=async()=>{if(!t)return;a(!0);let T=[];try{const R=await de($(G,`simulation_archives/${t}/full_log`));R.exists()&&(T=Object.values(R.val()))}catch(R){console.warn("Archive fetch failed (likely permissions), falling back to live data.",R)}if(T.length===0&&(h!=null&&h.messages)&&(T=Array.isArray(h.messages)?h.messages:Object.values(h.messages),T.length>0&&console.log("Exported live data fallback.")),T.length===0){alert("Ingen data  eksportere (verken i arkiv eller live-feed)."),a(!1);return}try{const R=new Blob([JSON.stringify(T,null,2)],{type:"application/json"}),D=URL.createObjectURL(R),I=document.createElement("a");I.href=D,I.download=`simulation_log_${t}_${new Date().toISOString()}.json`,I.click(),URL.revokeObjectURL(D)}catch(R){console.error("Blob creation failed:",R),alert("Kunne ikke generere fil.")}a(!1)};if(!h)return null;const M={onStartGame:y,onTogglePublic:()=>ne($(G,`simulation_rooms/${t}`),{isPublic:!h.isPublic}),onRepairData:O,onResetGame:L,onNextSeason:N,onChangeWeather:S,onSpawnEvent:j,onStartTing:w,onExportLog:H,initializeSettlement:async()=>{a(!0),await ne($(G,`simulation_rooms/${t}/world/settlement`),{buildings:Object.entries(cs).reduce((T,[R])=>({...T,[R]:{id:R,level:0,progress:{},target:200,contributions:{}}}),{})}),a(!1)},handleBuildingLevelChange:async(T,R)=>{var I,F,P;const D=(P=(F=(I=h.world)==null?void 0:I.settlement)==null?void 0:F.buildings)==null?void 0:P[T];D&&await ne($(G,`simulation_rooms/${t}/world/settlement/buildings/${T}`),{level:Math.max(0,D.level+R),progress:{}})},onTaxationBase:k},U={onRegenStamina:async()=>{a(!0);const T={};Object.keys(h.players||{}).forEach(R=>{T[`simulation_rooms/${t}/players/${R}/status/stamina`]=100}),await ne($(G),T),a(!1)},onResetUnrest:async()=>{a(!0);const T={};Object.keys(h.regions||{}).forEach(R=>{T[`simulation_rooms/${t}/regions/${R}/coup/bribeProgress`]=0,T[`simulation_rooms/${t}/regions/${R}/coup/contributions`]={}}),await ne($(G),T),a(!1)},onKickAll:async()=>{window.confirm("Kast ut alle?")&&await ne($(G),{[`simulation_rooms/${t}/players`]:{}})},onSpawnCharacter:A,kickPlayer:async(T,R)=>{window.confirm(`Kast ut ${R}?`)&&await ne($(G),{[`simulation_rooms/${t}/players/${T}`]:null,[`simulation_rooms/${t}/public_profiles/${T}`]:null})},handlePlayerLevelChange:async(T,R)=>{await ne($(G),{[`simulation_rooms/${t}/players/${T}/stats/level`]:R,[`simulation_rooms/${t}/public_profiles/${T}/stats/level`]:R})},handleRoleChange:async(T,R)=>{await ne($(G),{[`simulation_rooms/${t}/players/${T}/role`]:R,[`simulation_rooms/${t}/public_profiles/${T}/role`]:R})},handleRegionChange:async(T,R)=>{await ne($(G),{[`simulation_rooms/${t}/players/${T}/regionId`]:R,[`simulation_rooms/${t}/public_profiles/${T}/regionId`]:R})},controlPlayer:T=>window.open(`${window.location.origin}/Simulation_StandAlone_Pro/play/${t}?impersonate=${T}`,"_blank"),onGiveGold:(T,R)=>M6(t,T,R),onGiveResource:(T,R,D)=>L6(t,T,R,D),onGiveItem:(T,R,D)=>D6(t,T,R,D)};return r.jsx(GG,{pin:t,roomData:h,view:l,setView:o,isLoading:i,onBack:()=>o("LIST"),worldActions:M,playerActions:U,SimulationEconomyBlueprint:Y})};function zG(t,e){const{user:s,authLoading:n}=Wf(),[i,a]=_.useState(null),[l,o]=_.useState(null),[c,u]=_.useState({}),[d,f]=_.useState("LOBBY"),[h,m]=_.useState({}),[v,x]=_.useState({}),[b,g]=_.useState([]),[p,y]=_.useState(null),[k,N]=_.useState({}),[S,w]=_.useState({}),[E,j]=_.useState(!1),[A,O]=_.useState(!1),[L,Y]=_.useState(!1),W=_.useRef(null),H=_.useRef(null);_.useEffect(()=>{if(n)return;const U=localStorage.getItem("sim_player_id");let C=e;if(C||(s!=null&&s.uid?C=s.uid:C=U),!C||!t)return;const T=`simulation_rooms/${t}`,R=$(G,`${T}/players/${C}`),D=$e(R,fe=>{if(j(!0),fe.exists()){W.current&&(clearTimeout(W.current),W.current=null);const V=fe.val();if(t==="TEST"&&V.regionId==="unassigned"&&V.role!=="KING"){const z=Math.random()>.5?"region_east":"region_west";ne(R,{regionId:z})}const ue={...V,id:C};a(ue),H.current=ue,O(!0)}else A?W.current||(W.current=setTimeout(()=>{Y(!0),a(null),O(!1),H.current=null},5e3)):a(null)}),I=$(G,`${T}/world`),F=$e(I,fe=>{const V=fe.val();V&&o(V)}),P=$(G,`${T}/status`),B=$e(P,fe=>{const V=fe.val();V&&f(V||"LOBBY")}),J=$(G,`${T}/markets`),se=$e(J,fe=>{const V=fe.val();V&&m(V)}),ie=$(G,`${T}/messages`),Ee=$e(ie,fe=>{const V=fe.val();V&&g(V)}),ye=$(G,`${T}/activeVote`),ae=$e(ye,fe=>{y(fe.val())}),Z=$(G,`${T}/diplomacy`),Me=$e(Z,fe=>{N(fe.val()||{})}),qe=$(G,`${T}/trades`),ge=$e(qe,fe=>{w(fe.val()||{})}),me=$(G,`${T}/players`),ht=$e(me,fe=>{const V=fe.val()||{};u(V)}),Fe=$(G,`${T}/regions`),Q=$e(Fe,fe=>{x(fe.val()||{})});return()=>{D(),F(),B(),se(),Ee(),ae(),Me(),ht(),ge(),Q()}},[t,e,s==null?void 0:s.uid,n,A]),_.useEffect(()=>{if(!i||!t)return;const U=$(G,`simulation_rooms/${t}/players/${i.id}`),C=$(G,`simulation_rooms/${t}/public_profiles/${i.id}`);r1(U).update({online:!1}),r1(C).update({online:!1});const T=setInterval(()=>{const R=Date.now();ne(U,{lastActive:R,online:!0}),ne(C,{lastActive:R,online:!0})},3e4);return ne(U,{lastActive:Date.now(),online:!0}),ne(C,{lastActive:Date.now(),online:!0}),()=>clearInterval(T)},[t,i==null?void 0:i.id]),_.useEffect(()=>{if(!t||!t.startsWith("v"))return;const U=localStorage.getItem("nexus_active_vessel");if(U)try{const C=JSON.parse(U);if(C.id===t){console.log("Nexus Vessel Detected. Injecting Mock Data...",C);const T={id:C.id,uid:(s==null?void 0:s.uid)||"nexus_user",name:C.name,role:C.role.toUpperCase(),regionId:"nexus_region",resources:{gold:C.gold,grain:100,flour:0,bread:5,wood:50,plank:0,iron_ore:0,iron_ingot:0,stone:0,swords:0,armor:0,favor:0,wool:0,cloth:0,honey:0,meat:0,glass:0,manpower:10,egg:0,omelette:0},stats:{xp:0,level:1,reputation:50,contribution:0},status:{hp:C.health,morale:100,stamina:100,legitimacy:100,authority:100,loyalty:100,isJailed:!1,isFrozen:!1},equipment:{},skills:{FARMING:{level:1,xp:0,maxXp:100},WOODCUTTING:{level:1,xp:0,maxXp:100},MINING:{level:1,xp:0,maxXp:100},CRAFTING:{level:1,xp:0,maxXp:100},STEWARDSHIP:{level:1,xp:0,maxXp:100},COMBAT:{level:1,xp:0,maxXp:100},TRADING:{level:1,xp:0,maxXp:100},THEOLOGY:{level:1,xp:0,maxXp:100}},upgrades:[],lastActive:Date.now()};a(T),O(!0),j(!0),f("PLAYING"),o({year:1250,season:"Spring",weather:"Clear",gameTick:100,lastTickAt:Date.now(),taxRateDetails:{kingTax:10},settlement:{buildings:{}}})}}catch(C){console.error("Failed to parse Nexus vessel data",C)}},[t,s==null?void 0:s.uid]);const M=Object.values(c||{}).filter(U=>U.online&&Date.now()-(U.lastActive||0)<6e4).length;return S2(t,d,l,M),{player:i,world:l,players:c,roomStatus:d,markets:h,regions:v,messages:b,activeVote:p,diplomacy:k,trades:S,hasAttemptedPlayerLoad:E,hasActiveSession:A,isRetired:L,setIsRetired:Y,setPlayer:a,lastValidPlayer:H.current}}function Nj(t,e,s,n,i,a,l){const[o,c]=_.useState(null),[u,d]=_.useState(null);_.useEffect(()=>{if(o){const m=setTimeout(()=>{console.warn("[useSimulationActions] Self-Healing: Resetting stuck loading state:",o),c(null)},5e3);return()=>clearTimeout(m)}},[o]);const f=_.useCallback(()=>{d(null)},[]),h=_.useCallback(async m=>{var y;if(!t||!e||o)return;const v=typeof m=="string"?m:m.type,x=typeof m=="object"?m.method:null;if(["WORK","CHOP","CRAFT","DEFEND","EXPLORE","MINE","QUARRY","PATROL","FORAGE","REFINE","SMELT","BAKE","WEAVE","MIX","PLANT","HARVEST","GATHER_WOOL","HUNT","SAWMILL","MOUNT_HORSE","TRAVEL_START"].includes(v)&&!l&&!m.performance){const k=(s==null?void 0:s.season)||"Spring",N=(s==null?void 0:s.weather)||"Clear",S=(s==null?void 0:s.gameTick)||0,w=yj(e,m,k,N,S);if(!w.success){alert(`Du har ikke rd til dette: ${w.reason}`),d({success:!1,timestamp:Date.now(),message:`Kan ikke utfre: ${w.reason}`,utbytte:[],xp:[],durability:[]});return}let E=v;if(v==="REFINE"){const O=m.recipeId;(O==="iron_ingot"||O==="glass"||O==="smelt")&&(E="SMELT"),(O==="bread"||O==="pie"||O==="mead"||O==="bake")&&(E="BAKE"),(O==="cloth"||O==="weave")&&(E="WEAVE"),O==="plank"&&(E="SAWMILL"),["minor_stamina_potion","herbal_balm","focus_brew","strength_tincture","masters_draught","elixir_of_life"].includes(O)&&(E="MIX")}v==="CRAFT"&&m.subType==="omelette"&&(E="BAKE");const A=(e.activeProcesses||[]).find(O=>{var L;return(O.locationId===m.locationId||m.locationId&&((L=O.locationId)==null?void 0:L.startsWith(m.locationId)))&&O.readyAt<=Date.now()});if(!(v==="REFINE"&&m.recipeId==="flour"||v==="HARVEST"&&((A==null?void 0:A.type)==="MILL"||(A==null?void 0:A.type)==="CRAFT"))){n(E),x&&i(x),a(m),d(null);return}}const g=v==="EQUIP_ITEM"||v==="UNEQUIP_ITEM"||v==="CONSUME";m.performance&&!g&&(n(null),a(null),i(null)),g||c(v);const p=new Promise((k,N)=>{setTimeout(()=>N(new Error("Handlingen tok for lang tid (Timeout)")),3e4)});try{const k=await Promise.race([kj(t,e.id,m),p]);(!g||v==="CONSUME")&&(k.data?d(k.data):k.success||d({success:!1,timestamp:Date.now(),message:`Handlingen feilet: ${((y=k.error)==null?void 0:y.message)||k.error||"Ukjent feil"}`,utbytte:[],xp:[],durability:[]}))}catch(k){console.error("Action Timeout/Error:",k),g||d({success:!1,timestamp:Date.now(),message:` ${k.message||"Ukjent feil"}`,utbytte:[],xp:[],durability:[]})}finally{g||c(null),n(null),a(null),i(null)}},[t,e,o,s,l,n,i,a]);return{actionLoading:o,actionResult:u,setActionResult:d,handleAction:h,handleClearActionResult:f,setActionLoading:c}}const Hn=({resource:t,amount:e,size:s="md",showLabel:n=!1,className:i=""})=>{const a=Ie[t]||{label:t,icon:""},l={sm:"text-xl",md:"text-3xl",lg:"text-7xl"};return r.jsxs("div",{className:`flex items-center gap-2 ${i}`,title:a.label,children:[r.jsx("span",{className:`${l[s]}`,children:a.icon}),r.jsxs("div",{className:"flex flex-col leading-none",children:[n&&r.jsx("span",{className:"text-[10px] uppercase font-bold tracking-wider opacity-70 mb-0.5",children:a.label}),e!==void 0&&r.jsx("span",{className:`font-mono font-bold ${s==="lg"?"text-xl":"text-sm"}`,children:e.toLocaleString()})]})]})},O_=(t,e=800)=>{const[s,n]=_.useState(t),i=_.useRef(t);return _.useEffect(()=>{if(i.current===t)return;const a=i.current,l=t;let o=null;const c=u=>{o||(o=u);const d=Math.min((u-o)/e,1);n(a+(l-a)*d),d<1?requestAnimationFrame(c):i.current=t};requestAnimationFrame(c)},[t,e]),s},KG=({room:t,player:e,onAction:s})=>{var j,A,O,L,Y,W,H,M,U,C,T;const{activeTab:n,setActiveTab:i,activeMinigame:a}=ll(),{playSfx:l}=vx(),[o,c]=_.useState(!1),[u,d]=_.useState({tick:((j=t.world)==null?void 0:j.gameTick)||0,time:Date.now()});_.useEffect(()=>{var R,D;((R=t.world)==null?void 0:R.gameTick)!==u.tick&&d({tick:((D=t.world)==null?void 0:D.gameTick)||0,time:Date.now()})},[(A=t.world)==null?void 0:A.gameTick,u.tick]);const f=(O=t.regions)==null?void 0:O[e.regionId||"capital"],h=(((L=f==null?void 0:f.coup)==null?void 0:L.bribeProgress)||0)>0||!!(f!=null&&f.activeElection);_.useEffect(()=>{const R=D=>{if(D.target instanceof HTMLInputElement||D.target instanceof HTMLTextAreaElement||a)return;const I=D.key.toLowerCase(),F={m:"MAP",l:"ACTIVITY",p:"PROFILE",i:"INVENTORY",f:"SKILLS",d:"DIPLOMACY",h:"HIERARCHY"};if(F[I]){if(I==="d"&&e.role==="PEASANT")return;i(F[I]),l("ui_click.ogg")}};return window.addEventListener("keydown",R),()=>window.removeEventListener("keydown",R)},[i,e.role,l,a]);const[,m]=_.useState(0);_.useEffect(()=>{const R=setInterval(()=>m(D=>D+1),1e3);return()=>clearInterval(R)},[]);const v=e.status.stamina||0,x=e.status.hp||0,b=e.stats.xp||0,g=e.stats.level||1,p=Xd[g]||1e3,y=Math.min(100,b/p*100),k=O_(v),N=O_(x),S=[{id:"MAP",label:"Kart",icon:fj,short:"M"},{id:"ACTIVITY",label:"Live",icon:fc,short:"L"},{id:"INVENTORY",label:"Eiendeler",icon:mj,short:"I"},{id:"SKILLS",label:"Ferdigheter",icon:FH,short:"F"},...e.role!=="PEASANT"?[{id:"DIPLOMACY",label:"Diplomati",icon:fc,short:"D"}]:[],{id:"HIERARCHY",label:"Samfunn",icon:_H,short:"H"}],w=((Y=t.world)==null?void 0:Y.year)||1100,E=((H=Us[(W=t.world)==null?void 0:W.season])==null?void 0:H.label)||((M=t.world)==null?void 0:M.season);return r.jsxs("header",{className:"flex-none h-14 md:h-16 border-b border-white/5 bg-slate-950/80 backdrop-blur-xl flex items-center justify-between px-4 md:px-6 z-50 relative shrink-0 transition-all",children:[r.jsxs("div",{className:"flex items-center gap-4 md:gap-6",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsxs("div",{className:"flex items-baseline gap-2",children:[r.jsx("span",{className:"text-2xl md:text-3xl font-black text-white tracking-tighter leading-none tabular-nums shadow-indigo-500/50 drop-shadow-lg",children:S6(u.tick,u.time)}),r.jsxs("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest hidden sm:inline",children:["R ",w]})]}),r.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold uppercase tracking-widest text-slate-400 mt-0.5",children:[r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx("span",{className:((U=t.world)==null?void 0:U.season)==="Winter"?"text-blue-300 drop-shadow-[0_0_8px_rgba(147,197,253,0.5)]":"text-amber-400 drop-shadow-[0_0_8px_rgba(251,191,36,0.5)]",children:E}),r.jsx("span",{className:"text-slate-600",children:""}),r.jsx("span",{className:"",title:Qi(((C=t.world)==null?void 0:C.gameTick)||0)==="DAY"?"Dag":"Natt",children:Qi(((T=t.world)==null?void 0:T.gameTick)||0)==="DAY"?" Dag":" Natt"})]}),h&&r.jsx("button",{onClick:()=>{i("POLITICS"),l("ui_click.ogg")},className:"flex items-center gap-2 bg-rose-600/20 border border-rose-500/50 px-2 py-0.5 rounded-full animate-pulse group hover:bg-rose-500 hover:text-white transition-all ml-2",title:"Uro i regionen! Klikk for  se politisk status.",children:r.jsx("span",{className:"text-[9px] font-black italic tracking-tighter",children:" URO"})})]})]}),r.jsx("nav",{className:"hidden md:flex items-center gap-1 bg-white/5 p-1 rounded-xl border border-white/5",children:S.map(R=>{const D=n===R.id,I=R.icon;return r.jsxs("button",{onClick:()=>{i(R.id),l("ui_click.ogg")},className:`
                                    relative px-3 py-1.5 md:py-2 rounded-lg flex items-center gap-2 transition-all group overflow-hidden
                                    ${D?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-400 hover:text-white hover:bg-white/5"}
                                `,title:R.label,children:[r.jsx(I,{size:16,className:D?"animate-pulse":""}),r.jsx("span",{className:"hidden xl:block text-xs font-bold uppercase tracking-wider ",children:R.label}),R.short&&r.jsx("span",{className:`text-[9px] absolute top-0.5 right-1 font-mono font-bold transition-opacity hidden xl:block ${D?"text-indigo-300":"text-slate-700 group-hover:text-slate-500"}`,children:R.short})]},R.id)})})]}),r.jsxs("div",{className:"flex items-center gap-3 md:gap-5",children:[e.activeBuffs&&e.activeBuffs.length>0&&r.jsx("div",{className:"flex items-center gap-1 mr-1",children:e.activeBuffs.map(R=>r.jsx(YG,{buff:R},R.id))}),r.jsxs("div",{className:"hidden md:flex items-center bg-slate-900/50 rounded-full border border-white/5 overflow-hidden transition-all duration-300",children:[r.jsxs("button",{onClick:()=>{i("INVENTORY"),l("ui_click.ogg")},className:"flex items-center gap-2 hover:bg-white/5 px-3 py-1.5 transition-colors cursor-pointer group active:scale-95",title:"pne Eiendeler (I)",children:[r.jsx(Hn,{resource:"gold",amount:e.resources.gold,size:"sm"}),r.jsx("span",{className:"hidden xl:inline text-[10px] font-black uppercase tracking-widest text-slate-500 group-hover:text-slate-300 transition-colors ml-1",children:"Gull"})]}),r.jsx("div",{className:"w-px h-3 bg-white/10"}),r.jsxs("button",{onClick:()=>{e.resources.bread?(s==null||s({type:"CONSUME",itemId:"bread",isResource:!0}),l("eat.ogg")):(i("INVENTORY"),l("ui_click.ogg"))},disabled:!e.resources.bread,className:`flex items-center gap-2 px-3 py-1.5 transition-all cursor-pointer group border-l border-white/0 active:scale-95 ${e.resources.bread?"hover:bg-emerald-500/10 hover:border-emerald-500/20":"opacity-40 cursor-not-allowed"}`,title:e.resources.bread?"Spis Brd (+20 Stamina)":"Tomt for brd",children:[r.jsx(Hn,{resource:"bread",amount:e.resources.bread||0,size:"sm"}),r.jsx("div",{className:"hidden xl:flex flex-col items-start -space-y-1",children:r.jsx("span",{className:`text-[10px] font-black uppercase tracking-widest transition-colors ${e.resources.bread?"text-slate-500 group-hover:text-emerald-400":"text-slate-600"}`,children:e.resources.bread?"Spis":"Tom"})})]})]}),r.jsxs("div",{className:"flex flex-col gap-1 w-20 md:w-24",children:[r.jsxs("div",{className:"h-1 bg-slate-800 rounded-full overflow-hidden relative group",children:[r.jsx(q.div,{className:"absolute inset-y-0 left-0 bg-rose-500 rounded-full",initial:{width:0},animate:{width:`${N}%`}}),r.jsxs("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 flex items-center justify-center text-[8px] font-black text-white bg-black/50 transition-opacity",children:["HP ",Math.round(N),"%"]})]}),r.jsxs("div",{className:"h-1 bg-slate-800 rounded-full overflow-hidden relative group",children:[r.jsx(q.div,{className:"absolute inset-y-0 left-0 bg-amber-400 shadow-[0_0_10px_rgba(251,191,36,0.5)]",initial:{width:0},animate:{width:`${k}%`}}),r.jsxs("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 flex items-center justify-center text-[8px] font-black text-black bg-white/50 transition-opacity",children:["STA ",Math.round(k),"%"]})]}),r.jsx("div",{className:"h-0.5 bg-slate-800/50 rounded-full overflow-hidden relative group mt-0.5",children:r.jsx(q.div,{className:"absolute inset-y-0 left-0 bg-indigo-500",initial:{width:0},animate:{width:`${y}%`}})})]}),r.jsxs("button",{onClick:()=>{i("PROFILE"),l("ui_click.ogg")},className:"group flex items-center gap-3 bg-white/0 hover:bg-white/5 pl-2 pr-1 py-1 rounded-2xl border border-transparent hover:border-white/10 transition-all active:scale-95",title:"Min Karakter (P)",children:[r.jsx("div",{className:"hidden 2xl:flex flex-col items-end",children:r.jsx("span",{className:"text-sm font-black italic tracking-tighter text-white leading-none",children:e.name})}),r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"w-8 h-8 md:w-9 md:h-9 rounded-lg bg-gradient-to-br from-indigo-500 to-purple-600 p-0.5 shadow-lg overflow-hidden group-hover:shadow-indigo-500/20",children:e.avatar?r.jsx("img",{src:e.avatar,alt:"Profile",className:"w-full h-full object-cover rounded-[6px]"}):r.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-900 rounded-[6px] text-base",children:e.role==="KING"?"":""})}),r.jsx("div",{className:"absolute -bottom-1 -right-1 w-4 h-4 bg-slate-900 rounded-full flex items-center justify-center border border-white/10 text-[8px] font-black text-white z-10",children:g})]})]}),r.jsx(M_,{icon:WH,onClick:()=>i("SETTINGS"),title:"Innstillinger"}),e.role==="MERCHANT"&&r.jsx(M_,{icon:m$,onClick:()=>s==null?void 0:s({type:"OPEN_CARAVAN"}),title:"Karavane",className:"text-amber-400 border border-amber-400/20 bg-amber-100/5 hover:bg-amber-400/20"}),r.jsx("button",{className:"md:hidden text-white p-2",onClick:()=>c(!o),children:o?r.jsx(pn,{}):r.jsx(CH,{})})]}),r.jsx(kt,{children:o&&r.jsxs(q.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"absolute top-16 left-0 right-0 bg-slate-900 border-b border-white/10 p-4 shadow-2xl md:hidden flex flex-col gap-2 z-40",children:[S.map(R=>r.jsxs("button",{onClick:()=>{i(R.id),c(!1)},className:`w-full p-4 rounded-xl text-left font-black uppercase flex items-center gap-4 ${n===R.id?"bg-indigo-600 text-white":"bg-white/5 text-slate-400"}`,children:[r.jsx(R.icon,{size:20}),R.label]},R.id)),r.jsx("div",{className:"h-px bg-white/5 my-2"}),r.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 font-bold uppercase tracking-widest px-2",children:[r.jsxs("span",{children:["r ",w]}),r.jsx("span",{children:E})]})]})})]})},M_=({icon:t,onClick:e,title:s,className:n})=>r.jsx("button",{onClick:e,title:s,className:`hidden md:flex p-2 text-slate-400 hover:text-white hover:bg-white/5 rounded-lg transition-all ${n}`,children:r.jsx(t,{size:20})}),YG=({buff:t})=>{const[e,s]=_.useState(Math.max(0,Math.ceil((t.expiresAt-Date.now())/6e4)));return _.useEffect(()=>{const n=setInterval(()=>{const i=Math.max(0,Math.ceil((t.expiresAt-Date.now())/6e4));s(i)},1e4);return()=>clearInterval(n)},[t.expiresAt]),Date.now()>t.expiresAt?null:r.jsxs("div",{className:"group relative flex items-center justify-center w-8 h-8 rounded-full bg-emerald-500/10 border border-emerald-500/30 text-emerald-400 cursor-help",children:[r.jsx("span",{className:"text-lg",children:""}),r.jsxs("span",{className:"absolute -bottom-1 -right-1 text-[8px] font-black bg-slate-900 px-1 rounded-full border border-white/10",children:[e,"m"]}),r.jsxs("div",{className:"absolute top-full mt-2 left-1/2 -translate-x-1/2 bg-slate-900 p-2 rounded-lg border border-white/10 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none w-32 text-center z-50",children:[r.jsx("p",{className:"text-[10px] font-bold text-white mb-0.5",children:t.label}),r.jsxs("p",{className:"text-[9px] text-emerald-400",children:[t.value*100,"% mindre stamina"]})]})]})},lb=Ne.memo(({src:t,placeholderSrc:e,alt:s,className:n,imgClassName:i="object-cover w-full h-full",priority:a=!1,disableMotion:l=!1})=>{const[o,c]=_.useState(!1),[u,d]=_.useState(e||t);return _.useEffect(()=>{c(!1),e&&d(e);const f=new Image;f.src=t,f.onload=()=>{d(t),c(!0)}},[t,e]),r.jsx("div",{className:`relative overflow-hidden ${n}`,children:r.jsx(q.img,{src:u,alt:s,loading:a?"eager":"lazy",className:`${i} transition-all duration-700 ease-in-out`,initial:{filter:"blur(20px)",scale:l?1:1.1},animate:{filter:o?"blur(0px)":"blur(20px)",scale:l||o?1:1.1},style:{willChange:"filter, transform"}},t)})});lb.displayName="ProgressiveImage";const Ni=[{id:"fields",label:"krene",icon:"",top:"22%",left:"42%",vest:{top:"35%",left:"70%"},ost:{top:"35%",left:"45%"},roles:["PEASANT","BARON","KING"],actions:[],isHub:!0},{id:"forest",label:"Skogen",icon:"",top:"25%",left:"80%",vest:{top:"15%",left:"60%"},ost:{top:"27%",left:"14%"},roles:["PEASANT","BARON","KING"],actions:[],isHub:!0},{id:"castle",label:"Slottet",icon:"",top:"66%",left:"86%",vest:{top:"40%",left:"30%"},ost:{top:"40%",left:"68%"},roles:["PEASANT","BARON","KING","SOLDIER"],actions:[{id:"OPEN_CONSTRUCTION",label:"Bidra til bygging",cost:"Ressurser"},{id:"OPEN_TAXATION",label:"Skattekammeret",cost:"Baron Only",roleReq:"BARON"}],isHub:!0},{id:"peasant_farm",label:"Husmannsplassen",icon:"",top:"30%",left:"60%",vest:{top:"85%",left:"72%"},ost:{top:"75%",left:"30%"},roles:["PEASANT","BARON"],actions:[],isHub:!0},{id:"market",label:"Markedet",icon:"",top:"70%",left:"25%",vest:{top:"70%",left:"37%"},ost:{top:"70%",left:"63%"},roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],actions:[{id:"MARKET_VIEW",label:"pne Handel",cost:"Gratis"},{id:"JOIN_ROLE",label:"Bli Kjpmann",cost:"500g + Niv 3",targetRole:"MERCHANT"}]},{id:"village",label:"Landsbyen",icon:"",top:"42%",left:"42%",vest:{top:"50%",left:"52%"},ost:{top:"55%",left:"44%"},roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],actions:[],isHub:!0},{id:"mine",label:"Gruve-distriktet",icon:"",top:"12%",left:"25%",vest:{top:"13%",left:"39%"},ost:{top:"20%",left:"60%"},roles:["PEASANT","BARON","KING"],actions:[],isHub:!0},{id:"monastery",label:"Klosteret",icon:"",top:"16%",left:"55%",vest:{top:"50%",left:"78%"},ost:{top:"50%",left:"27%"},roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],actions:[],isHub:!0},{id:"border",label:"Grensen",icon:"",top:"85%",left:"80%",vest:{top:"15%",left:"10%"},ost:{top:"15%",left:"10%"},roles:["BARON"],actions:[{id:"RAID",label:"Plyndre Nabo",cost:"-40"}]},{id:"dock",label:"Kaien",icon:"",top:"90%",left:"50%",vest:{top:"90%",left:"40%"},ost:{top:"90%",left:"60%"},roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],actions:[],isHub:!0},{id:"flax_field",label:"Lin-keren",icon:"",roles:["PEASANT"],parentId:"fields",top:"70%",left:"40%",actions:[{id:"PLANT",label:"S Lin",cost:"-10 lin -30",cropId:"flax"}]},{id:"throne_room",label:"Tronsalen",icon:"",top:"40%",left:"50%",roles:["KING"],parentId:"castle",actions:[{id:"DECREE",label:"Utsted Dekret",cost:"King Only"}]},{id:"treasury",label:"Skattekammeret",icon:"",top:"55%",left:"65%",roles:["BARON","KING"],parentId:"castle",actions:[{id:"OPEN_TAXATION",label:"pne Skattekammeret",cost:"Administrasjon"}]},{id:"barracks",label:"Kasernen",icon:"",top:"60%",left:"30%",roles:["PEASANT","BARON","KING","SOLDIER"],parentId:"castle",actions:[{id:"DRAFT",label:"Verve Soldater",cost:"-5g -10"},{id:"JOIN_ROLE",label:"Bli Soldat",cost:"200g + Niv 3",targetRole:"SOLDIER"}]},{id:"royal_chambers",label:"Kongens Kammer",icon:"",top:"30%",left:"70%",roles:["BARON","KING"],parentId:"castle",actions:[{id:"REST",label:"Hvile i Kammeret",cost:"Full rest + Velvre"}]},{id:"castle_construction",label:"Byggeplass",icon:"",top:"75%",left:"80%",roles:["PEASANT","BARON","KING","SOLDIER"],parentId:"castle",actions:[{id:"OPEN_CONSTRUCTION",label:"Bidra til bygging",cost:"Ressurser"}]},{id:"war_room",label:"Krigsrommet",icon:"",top:"25%",left:"35%",roles:["BARON","KING","SOLDIER"],parentId:"castle",actions:[{id:"OPEN_WAR_ROOM",label:"pne Krigsrommet",cost:"Gratis"}]},{id:"village_square",label:"Landsbytorg",icon:"",top:"50%",left:"50%",village:{top:"48%",left:"50%"},roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],parentId:"village",actions:[{id:"REST",label:"Hvile p torget",cost:"+10"}]},{id:"tavern",label:"Vertshuset",icon:"",top:"35%",left:"75%",village:{top:"75%",left:"80%"},roles:["PEASANT","BARON","KING","SOLDIER"],parentId:"village",actions:[{id:"ENTER_TAVERN",label:"G inn",cost:"Gratis"},{id:"REST_BASIC",label:"Hvile i Salen",cost:"Gratis"},{id:"REST_COMFY",label:"Bestille Kammer",cost:"-5g"},{id:"REST_ROYAL",label:"Kongelig Suite",cost:"-20g"}],isHub:!0,isInterior:!0},{id:"bakery",label:"Bakeri",icon:"",top:"80%",left:"30%",village:{top:"38%",left:"35%"},roles:["PEASANT","BARON","KING"],parentId:"village",actions:[],isHub:!0,isInterior:!0},{id:"great_forge",label:"Storsmie",icon:"",top:"35%",left:"15%",village:{top:"48%",left:"23%"},roles:["PEASANT","BARON","KING"],parentId:"village",actions:[],isHub:!0,isInterior:!0},{id:"windmill",label:"Vindmlle",icon:"",top:"20%",left:"37%",village:{top:"25%",left:"17%"},roles:["PEASANT","BARON","KING"],parentId:"village",actions:[{id:"REFINE_flour",label:"Male Mel",cost:"-15 -10korn"}],isHub:!0,isInterior:!0},{id:"smeltery",label:"Smeltehytte",icon:"",top:"60%",left:"95%",village:{top:"75%",left:"12%"},roles:["PEASANT","BARON","KING"],parentId:"village",actions:[{id:"REFINE_IRON_BASIC",label:"Smelte Jern",cost:"-20 -5malm"},{id:"REFINE_IRON_FAST",label:"Industri-smelting",cost:"-30 -10malm"},{id:"REFINE_STEEL",label:"Smelte Stl",cost:"-50 -20malm"}],isHub:!0,isInterior:!0},{id:"sawmill",label:"Sagbruk",icon:"",top:"55%",left:"15%",village:{top:"70%",left:"45%"},roles:["PEASANT","BARON","KING"],parentId:"village",actions:[{id:"REFINE_PLANK_BASIC",label:"Sag Planker",cost:"-10 -5ved"},{id:"REFINE_PLANK_FAST",label:"Hurtig-saging",cost:"-15 -5ved"}],isHub:!0,isInterior:!0},{id:"weavery",label:"Veveri",icon:"",top:"50%",left:"85%",village:{top:"45%",left:"65%"},roles:["PEASANT","BARON","MERCHANT"],parentId:"village",actions:[],isHub:!0,isInterior:!0},{id:"watchtower",label:"Vaktrn",icon:"",top:"15%",left:"68%",village:{top:"25%",left:"82%"},roles:["BARON","SOLDIER","KING"],parentId:"village",actions:[],isHub:!0,isInterior:!0},{id:"stables",label:"Stall",icon:"",top:"80%",left:"80%",village:{top:"45%",left:"90%"},roles:["PEASANT","BARON","SOLDIER","KING","MERCHANT"],parentId:"village",actions:[],isHub:!0,isInterior:!0},{id:"well",label:"Bybrnn",icon:"",top:"69%",left:"60%",village:{top:"48%",left:"50%"},roles:["PEASANT","BARON","KING"],parentId:"village",actions:[],isHub:!0},{id:"apothecary",label:"Apoteker",icon:"",top:"20%",left:"82%",village:{top:"60%",left:"92%"},roles:["PEASANT","BARON","KING","MERCHANT"],parentId:"village",actions:[],isHub:!0,isInterior:!0},{id:"forge_anvil",label:"Ambolt",icon:"",top:"50%",left:"40%",roles:["PEASANT","BARON","KING"],parentId:"great_forge",actions:[{id:"OPEN_CRAFTING",label:"pne Smia",cost:"Gratis"}]},{id:"forge_upgrades",label:"Tegneark",icon:"",top:"40%",left:"75%",roles:["PEASANT","BARON","KING"],parentId:"great_forge",actions:[{id:"BUILDING_UPGRADE_great_forge",label:"Oppgrader Smia",cost:"Varierer"}]},{id:"bakery_oven",label:"Bakerovn",icon:"",top:"50%",left:"50%",roles:["PEASANT","BARON","KING"],parentId:"bakery",actions:[{id:"REFINE",label:"pne Bakeriet",cost:"Gratis"}]},{id:"bakery_upgrades",label:"Tegneark",icon:"",top:"30%",left:"80%",roles:["PEASANT","BARON","KING"],parentId:"bakery",actions:[{id:"BUILDING_UPGRADE_bakery",label:"Oppgrader Bakeriet",cost:"Varierer"}]},{id:"windmill_stones",label:"Kvernsteiner",icon:"",top:"50%",left:"40%",roles:["PEASANT","BARON","KING"],parentId:"windmill",actions:[{id:"REFINE",label:"pne Mlla",cost:"Gratis"}]},{id:"windmill_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON","KING"],parentId:"windmill",actions:[{id:"BUILDING_UPGRADE_windmill",label:"Oppgrader Mlla",cost:"Varierer"}]},{id:"sawmill_blade",label:"Saga",icon:"",top:"50%",left:"40%",roles:["PEASANT","BARON","KING"],parentId:"sawmill",actions:[{id:"REFINE",label:"pne Sagbruket",cost:"Gratis"}]},{id:"sawmill_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON","KING"],parentId:"sawmill",actions:[{id:"BUILDING_UPGRADE_sawmill",label:"Oppgrader Sagbruket",cost:"Varierer"}]},{id:"smeltery_furnace",label:"Smelteovn",icon:"",top:"50%",left:"30%",roles:["PEASANT","BARON","KING"],parentId:"smeltery",actions:[{id:"REFINE",label:"pne Smeltehytta",cost:"Gratis"}]},{id:"smeltery_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON","KING"],parentId:"smeltery",actions:[{id:"BUILDING_UPGRADE_smeltery",label:"Oppgrader Smeltehytta",cost:"Varierer"}]},{id:"weavery_loom",label:"Vevstol",icon:"",top:"50%",left:"40%",roles:["PEASANT","BARON","MERCHANT"],parentId:"weavery",actions:[{id:"REFINE",label:"pne Veveriet",cost:"Gratis"}]},{id:"weavery_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON"],parentId:"weavery",actions:[{id:"BUILDING_UPGRADE_weavery",label:"Oppgrader Veveriet",cost:"Varierer"}]},{id:"stables_stall",label:"Stallplass",icon:"",top:"50%",left:"40%",roles:["PEASANT","BARON","SOLDIER","KING","MERCHANT"],parentId:"stables",actions:[{id:"MOUNT_HORSE",label:"Ri ut",cost:"-5"}]},{id:"stables_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON","KING","MERCHANT"],parentId:"stables",actions:[{id:"BUILDING_UPGRADE_stables",label:"Oppgrader Stallen",cost:"Varierer"}]},{id:"watchtower_top",label:"Vaktpost",icon:"",top:"30%",left:"50%",roles:["PEASANT","BARON","SOLDIER"],parentId:"watchtower",actions:[{id:"OPEN_GARRISON",label:"pne Garnisonen",cost:"Gratis"},{id:"PATROL",label:"Patruljer",cost:"-30"}]},{id:"watchtower_upgrades",label:"Tegneark",icon:"",top:"50%",left:"80%",roles:["BARON"],parentId:"watchtower",actions:[{id:"BUILDING_UPGRADE_watchtower",label:"Oppgrader Trnet",cost:"Varierer"}]},{id:"apothecary_bench",label:"Arbeidsbenk",icon:"",top:"50%",left:"40%",roles:["PEASANT","BARON","KING"],parentId:"apothecary",actions:[{id:"OPEN_CRAFTING",label:"pne Apoteket",cost:"Gratis"}]},{id:"apothecary_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON","KING"],parentId:"apothecary",actions:[{id:"BUILDING_UPGRADE_apothecary",label:"Oppgrader Apoteket",cost:"Varierer"}]},{id:"well_water",label:"Brnnkum",icon:"",top:"50%",left:"50%",roles:["PEASANT","BARON","KING"],parentId:"well",actions:[{id:"GATHER_WATER",label:"Hent Vann",cost:"-10"}]},{id:"well_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON","KING"],parentId:"well",actions:[{id:"BUILDING_UPGRADE_well",label:"Oppgrader Brnnen",cost:"Varierer"}]},{id:"tavern_bar",label:"Baren",icon:"",top:"30%",left:"30%",roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],parentId:"tavern",actions:[{id:"OPEN_TAVERN_MENU",label:"Se Menykart",cost:"Gratis"}]},{id:"tavern_gambling",label:"Spillebordet",icon:"",top:"50%",left:"50%",roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],parentId:"tavern",actions:[{id:"OPEN_DICE_GAME",label:"Spill Terninger",cost:"Min. 0.5g"}]},{id:"tavern_resource_wheel",label:"Soga-hjulet",icon:"",top:"65%",left:"75%",roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],parentId:"tavern",actions:[{id:"OPEN_RESOURCE_GAME",label:"Sats Ressurser",cost:"Varer"}]},{id:"tavern_gossip",label:"Lokalbefolkningen",icon:"",top:"40%",left:"70%",roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],parentId:"tavern",actions:[{id:"CHAT_LOCAL",label:"Snakk med folk",cost:"Gratis"}]},{id:"tavern_upgrades",label:"Tegneark",icon:"",top:"25%",left:"85%",roles:["PEASANT","BARON","KING"],parentId:"tavern",actions:[{id:"BUILDING_UPGRADE_tavern",label:"Oppgrader Vertshuset",cost:"Varierer"}]},{id:"grain_fields",label:"Kornker",icon:"",top:"50%",left:"20%",roles:["PEASANT","BARON","KING"],parentId:"fields",actions:[{id:"PLANT",label:"S Korn",cost:"-5 korn -25"}]},{id:"sheep_pasture",label:"Sauebeite",icon:"",top:"35%",left:"65%",roles:["PEASANT","BARON","KING"],parentId:"fields",actions:[{id:"GATHER_WOOL",label:"Klipp Sauer",cost:"-15"}]},{id:"beehives",label:"Bikuber",icon:"",top:"75%",left:"70%",roles:["PEASANT","BARON","KING"],parentId:"fields",actions:[{id:"GATHER_HONEY",label:"Samle Honning",cost:"-20"}]},{id:"mine_shaft",label:"Jern-gruva",icon:"",top:"50%",left:"12%",roles:["PEASANT","BARON","KING"],parentId:"mine",actions:[{id:"MINE",label:"Bryte Malm",cost:"-25 -1"}]},{id:"quarry_poi",label:"Steinhuggeriet",icon:"",top:"40%",left:"85%",roles:["PEASANT","BARON","KING"],parentId:"mine",actions:[{id:"QUARRY",label:"Hugge Stein",cost:"-20 -1"}]},{id:"forest_clearing",label:"Hogstfeltet",icon:"",top:"60%",left:"30%",roles:["PEASANT","BARON","KING"],parentId:"forest",actions:[{id:"CHOP",label:"Hugge Ved",cost:"-15 -1"}]},{id:"hunting_grounds",label:"Jaktmarker",icon:"",top:"30%",left:"75%",roles:["PEASANT","BARON","KING"],parentId:"forest",actions:[{id:"HUNT",label:"Dra p Jakt",cost:"-30"}]},{id:"forest_forage",label:"Brplukking",icon:"",top:"60%",left:"90%",roles:["PEASANT","BARON","KING"],parentId:"forest",actions:[{id:"FORAGE",label:"Sanke Mat (Nd)",cost:"-40"}]},{id:"monastery_chapel",label:"Klosterkirken",icon:"",top:"50%",left:"50%",roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],parentId:"monastery",actions:[{id:"PRAY",label:"Be en Bnn",cost:"-15"}]},{id:"farm_house",label:"Inne i Stugo",icon:"",top:"52%",left:"58%",roles:["PEASANT"],parentId:"peasant_farm",actions:[],isHub:!0,isInterior:!0},{id:"stugo_bed",label:"Senga",icon:"",top:"65%",left:"42%",roles:["PEASANT"],parentId:"farm_house",actions:[{id:"SLEEP",label:"Sove tungt",cost:"Full "}]},{id:"stugo_fireplace",label:"Peisen",icon:"",top:"55%",left:"80%",roles:["PEASANT"],parentId:"farm_house",actions:[{id:"EAT",label:"Sitte ved varmen",cost:"-1 +40"}]},{id:"farm_well",label:"Brnnen",icon:"",top:"60%",left:"27%",roles:["PEASANT"],parentId:"peasant_farm",actions:[{id:"REST",label:"Drikke vann",cost:"+5"}]},{id:"farm_upgrade_spot",label:"Tegneark",icon:"",top:"40%",left:"15%",roles:["PEASANT"],parentId:"farm_house",actions:[{id:"BUILDING_UPGRADE_farm_house",label:"Bygg ut grden",cost:"Varierer"}]},{id:"chicken_coop",label:"Hnsehus",icon:"",top:"40%",left:"75%",roles:["PEASANT"],parentId:"peasant_farm",actions:[{id:"OPEN_CHICKEN_COOP",label:"G inn til hnene",cost:"Gratis"}]},{id:"dock_view",label:"Horisonten",icon:"",top:"30%",left:"50%",roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],parentId:"dock",actions:[{id:"START_SAILING",label:"Sette seil",cost:"Bt kreves"}]},{id:"shipyard",label:"Skipsverftet",icon:"",top:"60%",left:"25%",roles:["PEASANT","BARON","KING","MERCHANT"],parentId:"dock",actions:[{id:"OPEN_SHIPYARD",label:"pne Verftet",cost:"Bygg bt"}],isHub:!0,isInterior:!0},{id:"dock_administration",label:"Havnefuten",icon:"",top:"40%",left:"75%",roles:["BARON","KING","MERCHANT"],parentId:"dock",actions:[{id:"OPEN_WHARF_UPGRADE",label:"Oppgrader Kaien",cost:"Globalt prosjekt"}]}],D_=[{id:"pilegrim",name:"Sigurd Pilegrim",role:"Vandrer mot Nidaros",description:"Han sitter masserer sine sre ftter. En bredbremmet hatt med et kamskjell ligger p bordet, og vandringsstaven er slitt glatt av tusenvis av grep.",conversation:{start:{text:"Fred vre med deg, reisende. Kjenner du veien nordover? Mine ftter verker som om jeg har gtt p gldende kull, men sjelen... sjelen trekkes mot Hellig Olavs by.",options:[{label:"Hvorfor denne lange reisen?",nextId:"why"},{label:"Er det farlig langs veien?",nextId:"danger"},{label:"Fortell om kamskjellet.",nextId:"shell"},{label:"Lykke til videre. (G)",nextId:"EXIT"}]},why:{text:"For bot og bedring! Vi brer alle synder, min venn. Men i Nidaros, ved kongens skrin, er himmelen nrmere jorden. Det sies at en pilegrimsferd kan korte ned tiden i skjrsilden med mange r.",options:[{label:"Tror du virkelig p det?",nextId:"believe"},{label:"Hva hper du  finne?",nextId:"hope"}]},believe:{text:"Jeg *m* tro. Jeg har sett halte kaste krykkene og blinde f synet tilbake ved katedralen. Olavs kraft er sterk, selv om han har vrt dd i hundrevis av r. Han er Norges evige konge.",options:[{label:"Fortell om Olav.",nextId:"olav"}]},hope:{text:"Tilgivelse. Og kanskje litt sjelefred. Livet er hardt, vinteren er lang.  vite at man har gjort denne ofringen... det gir styrke.",options:[{label:"Forstelig.",nextId:"start"}]},danger:{text:" ja! Dovrefjell er ndelst. Snstormer kan komme midt p sommeren. Og i dalene lurer landeveisrvere som ser p oss pilegrimer som vandrende pengesekker. Men vi reiser ofte i flokk for beskyttelse.",options:[{label:"Har du blitt ranet?",nextId:"robbed"},{label:"Hvor sover dere?",nextId:"sjelehus"}]},robbed:{text:"Nesten. En gang, nr Gudbrandsdalen, s vi skygger i skogen. Vi sang salmer s hyt vi kunne, og drev dem bort med troens styrke! ...og kanskje fordi vi var frti stykker.",options:[{label:"God taktikk.",nextId:"danger"}]},sjelehus:{text:"Det finnes sjelehus  herberger bygget for Guds skyld  langs ruten. Der fr vi tak over hodet og enkel mat. Ofte deler vi rom med dyrene for varmen.",options:[{label:"Hres... koselig ut.",nextId:"danger"}]},shell:{text:"Ah, Ib-skjellet! Symbolet p St. Jakob. Dette viser at jeg har vandret helt til Santiago de Compostela i Spania. Jeg har sett verden, min venn. Fra nordlyset her til de solbrente slettene i sr.",options:[{label:"Du er en bereist mann.",nextId:"start"}]},olav:{text:"Han falt p Stiklestad i 1030. De sier at da de gravde ham opp et r senere, var kroppen like frisk, og hret og neglene hadde vokst! Det var beviset. Han kristnet oss med sverd, men reddet oss med sin hellighet.",options:[{label:"En mektig legende.",nextId:"start"}]}}},{id:"hansa",name:"Gerhard fra Lbeck",role:"Hansa-kjpmann",description:"Kledd i kostbar ull og pels. Han studerer en lang regnskapsrull med rynket panne og nipper til en vin som ser langt bedre ut enn husets vanlige.",conversation:{start:{text:"*Mumler p tysk* ...zwei schock, drei stck... Ah! En lokal? Si meg, har fiskerne i nord ftt opp farten? Mine skip venter i Bergen. Tid er penger, som vi sier i Lbeck.",options:[{label:"Hvem er du?",nextId:"intro"},{label:"Hvorfor er trrfisken s viktig?",nextId:"stockfish"},{label:"Hva er Hansaen egentlig?",nextId:"hansa_deep"},{label:"Jeg lar deg arbeide. (G)",nextId:"EXIT"}]},intro:{text:"Gerhard, handelsmann av Det Tyske Hanseforbund. Vi srger for at dere fr korn og mel, og at dere fr solgt den... vel, illeluktende fisken deres. En god byttehandel, *nicht wahr*?",options:[{label:"Vi klarer oss vel selv?",nextId:"monitor"},{label:"Takk for kornet.",nextId:"grain"}]},grain:{text:"Ja, det burde dere. Uten vrt baltiske korn ville mange nordmenn sultet nr avlingene svikter. Vi binder Nord-Europa sammen med vre kogger.",options:[{label:"Kogger?",nextId:"cog"}]},monitor:{text:"Haha! Tror du det? Uten oss ville fisken deres rtnet p stranden. Vi har nettverket. Vi har markedene i sr  katolikkene trenger fisk til fasten, og vi leverer.",options:[{label:"Dere tar stor fortjeneste.",nextId:"monopoly"}]},monopoly:{text:"Risiko koster! Stormer, pirater, kriger. Vi tar risikoen, vi tar profitten. Og vi har Kongens velsignelse... og privilegier. Vi dmmer vre egne p Bryggen.",options:[{label:"Egne lover?",nextId:"laws"}]},laws:{text:"Ja. En hanseat dmmes etter hansas lov, ikke norsk lov. Det... skaper litt friksjon med byborgerne, innrmmer jeg. Men handelen m flyte!",options:[{label:"Hres urettferdig ut.",nextId:"start"}]},stockfish:{text:'Det er "Det hvite gullet"! Trket i den kalde norske vinden blir den hard som tre og holder i revis. Perfekt mat for soldater og munker i hele Europa. Vi bytter det mot korn, klr, vin og krydder.',options:[{label:"En viktig ressurs.",nextId:"start"}]},hansa_deep:{text:"Et brorskap av handelsbyer. Lbeck, Hamburg, Rostock, Visby... og vrt kontor i Bergen. Vi beskytter hverandre mot konger som vil skattlegge oss for hardt, og mot sjrvere. Sammen er vi sterkere enn noe kongerike.",options:[{label:"Morsomt at du nevner pirater...",nextId:"pirates"},{label:"Imponerende.",nextId:"start"}]},pirates:{text:"Vitaliebrdrene... en plage! De herjer i stersjen. Men Hansaen har sine egne skip. Vi kan bite fra oss. Ikke tro at en kjpmann ikke kan svinge et sverd.",options:[{label:"Notert.",nextId:"EXIT"}]},cog:{text:"Vre skip. Brede, hye, med plass til enorme mengder last. De er ikke raske som vikingenes langskip, men de bygget vr rikdom. Ett skip kan f hele Bergen med korn.",options:[{label:"Teknologi er makt.",nextId:"start"}]}}},{id:"leilending",name:"Tormod",role:"Sliten Leilending",description:"Hendene hans er grove som bark, og ryggen er byd av r med plying. Han drikker tynt l og ser tankefullt ned i kruset.",conversation:{start:{text:"Enda en hst, enda en landskyld  betale. Livet til en leilending er  s for andre og hste smuler selv. Skl for det.",options:[{label:"Hva er landskyld?",nextId:"rent"},{label:"Hvorfor eier du ikke jorda?",nextId:"own"},{label:"Hvordan var det fr?",nextId:"plague"},{label:"Gr det s drlig? (G)",nextId:"EXIT"}]},rent:{text:"Leieavgiften. Jeg driver grden, men Kirken eier grunnen. Hvert r m jeg gi dem en fjerdedel av kornet, tre skippund smr og to kyr. Det som er igjen... det skal f familien min gjennom vinteren.",options:[{label:"Hva hvis avlingen svikter?",nextId:"fail"},{label:"Hvem bestemmer prisen?",nextId:"laws"}]},fail:{text:"Da sulter vi. Eller vi m lne skorn av jordeieren, og da havner vi dypere i gjeld. Det er en sirkel det er vanskelig  bryte.",options:[{label:"Trist skjebne.",nextId:"start"}]},own:{text:"F bnder eier sin egen jord n. Adelen og Kirken har kjpt opp nesten alt. Men jeg har i det minste *bygslebrev*. S lenge jeg betaler og driver jorda, kan de ikke kaste meg ut. Det er norsk lov.",options:[{label:"En viss trygghet.",nextId:"laws"}]},laws:{text:"Ja, Landsloven til Magnus Lagabte. Den gir oss rettigheter. Jordeieren kan ikke bare ta grden fordi han vil. Og jeg kan kreve at snnen min fr overta bygselen. Vi er ikke slaver, vi er frie menn... bare fattige.",options:[{label:"Viktig forskjell.",nextId:"start"}]},plague:{text:"*Han senker stemmen* Bestefar fortalte om Den Store Dden. Da to av tre dde. Etterp... etterp var det gode tider for de som overlevde. Masse ledig jord! Lav landskyld! N? N er vi mange igjen, og jordeierne strammer grepet.",options:[{label:"degrder?",nextId:"deserted"},{label:"Tidene skifter.",nextId:"start"}]},deserted:{text:"Ja, du kan fortsatt se ruinene i skogen. Grder der folk bodde fr, som n er grodd igjen. Noen sier det spker der, at de dde gr igjen og passer p arveslvet sitt.",options:[{label:"Grss.",nextId:"start"}]}}},{id:"steinhugger",name:"Master William",role:"Engelsk Steinhugger",description:"Han tegner geometriske figurer i slt l p bordet. Fingrene er hvite av steinstv.",conversation:{start:{text:"Ser du? Hvis du lfter buen *her*, og krysser hvelvet *slik*... da kan du bygge hyere enn fjellene! Ah, unnskyld. Jeg drmmer om stein.",options:[{label:"Bygger du katedralen?",nextId:"nidaros"},{label:"Du er ikke herfra?",nextId:"english"},{label:"Stein er bare stein. (G)",nextId:"EXIT"}]},nidaros:{text:"Kristkirken i Nidaros, ja! Verdens nordligste gotiske katedral. Vi hugger Kleberstein. Den er myk som smr nr den brytes, men blir hard som jern i luften. Et mirakulst materiale.",options:[{label:"Fortell om stilen.",nextId:"gothic"},{label:"Hvor lenge holder dere p?",nextId:"time"}]},gothic:{text:"Gotikk! Det er lysets arkitektur. I gamle dager bygget de tykke vegger og sm vinduer (romansk stil). N? Vi bruker strebepilarer p utsiden til  bre taket, s vi kan fylle veggene med glassmalerier. Guds lys strmmer inn!",options:[{label:"Hres vakkert ut.",nextId:"symbolism"}]},symbolism:{text:"Det er mer enn vakkert. Kirken er et bilde p himmelen. Hver syle, hver bue peker oppover. Nr bonden kommer inn fra gjrma, skal han fle at han trer inn i Guds rike.",options:[{label:"Mektig.",nextId:"start"}]},english:{text:"Nei, jeg kom fra Lincoln. Erkebiskopen hentet hndverkere fra England. Vi tar med oss kunnskapen om de nye stilene. Det er et internasjonalt laug, steinhuggerne. Vi reiser dit Gud og gullet kaller oss.",options:[{label:"Et reisende liv.",nextId:"start"}]},time:{text:'Haha! "Hvor lenge?" Min oldefar begynte. Jeg fortsetter. Mine barnebarn vil kanskje se spiret reise seg. En katedral bygges ikke for oss, men for evigheten.',options:[{label:"En tlmodighetsprve.",nextId:"EXIT"}]}}},{id:"vaering",name:"Halvdan",role:"Veteran fra Vringgarden",description:"Han brer en kappe av falmet, men kostbar silke. Et stygt arr deler venstre yenbryn i to. Han drikker ikke l, men vin fra en liten flaske.",conversation:{start:{text:"Dette stedet... det er kaldt, mrkt og lukter av vt hund. I Miklagard skinte solen p gulltakene hver dag, og keiserens hager duftet av sjasmin.",options:[{label:"Hvor er Miklagard?",nextId:"miklagard"},{label:"Var du en kriger?",nextId:"guard"},{label:"Hjemme best. (G)",nextId:"EXIT"}]},miklagard:{text:'"Den Store Byen". Konstantinopel! Verdens sentrum. Der mtes st og vest. Gatene er brolagt med marmor, og de har badehus med varmt vann i veggene! Kan du tenke deg? Varmt vann uten  koke det over bl!',options:[{label:"Utrolig.",nextId:"hagia"},{label:"Savner du det?",nextId:"miss"}]},hagia:{text:"Og Hagia Sofia... Guds Helligdoms Kirke. Kuppelen er s stor at den ser ut som om den henger i en gullkjede fra himmelen. Jeg har sett menn grte bare av  g inn der.",options:[{label:"M vre et syn.",nextId:"start"}]},guard:{text:'Vringgarden. Keiserens livvakt. Vi nordboere er hye, sterke og... vel, vi sviker ikke for penger. Grekerne er slueste folk, men de stoler bare p vre kser. "Pelekysphoroi" kaller de oss. ksebrere.',options:[{label:"Mtte dere slss?",nextId:"fight"},{label:"Ble du rik?",nextId:"rich"}]},fight:{text:"Mot sarasenere, mot bulgarere, mot opprrske generaler. Jeg har sett gresk ild  flytende flammer som brenner p vann! Det er djevelens verk, men effektivt.",options:[{label:"Gresk ild?",nextId:"start"}]},rich:{text:'Keiseren er sjeners. Nr han dr, har vi rett til  g gjennom skattkammeret og ta det vi kan bre. "Polutasvarf", kaller vi det. Palass-plyndring. Det er slik jeg fikk denne kappen... og denne ringen.',options:[{label:"En god pensjon.",nextId:"start"}]},miss:{text:"Hver vinter. Men her er min slekt, min jord. Og her snakker folk et sprk man kan forst. Men jeg vil alltid drmme om det Gyldne Horn.",options:[{label:"Skl for minnene.",nextId:"EXIT"}]}}},{id:"munk",name:"Broder Johannes",role:"Lrd Skrivermunk",description:"Fingrene hans er flekkete av blekk. Han myser, som om han er vant til  lese i drlig lys, og snakker lavmelt.",conversation:{start:{text:"Hysj. Hrer du stillheten? Nei, selvsagt ikke. Her er det sty. I skriptoriet hrer man bare fjrpennens skraping mot pergamentet. Guds ord som festes til huden.",options:[{label:"Hva skriver du?",nextId:"write"},{label:"Er du ikke ensom?",nextId:"lonely"},{label:"Jeg lar deg vre i fred. (G)",nextId:"EXIT"}]},write:{text:'Akkurat n? En kopi av "Kongespeilet"  *Konungs skuggsj*. En lrebok for prinser. Den forteller om hflighet, handel, stjernene og Guds orden. En klok konge m vre lrd, ikke bare sterk.',options:[{label:"Er bker dyre?",nextId:"expensive"},{label:"Hvem leser disse?",nextId:"readers"}]},expensive:{text:"Ufattelig. Et stort bibelverk krever skinnet fra 300 kalver! Tenk p flokken... og arbeidet.  forberede skinnet, blande blekket, male initialene med bladgull. En bok kan koste mer enn en grd.",options:[{label:"En skatt alts.",nextId:"start"}]},readers:{text:"De geistlige, kongen, og noen f adelige. Men kunnskapen risler nedover. Det vi bevarer i bibliotekene, er verdens hukommelse. Uten oss ville historien forsvinne i mrket.",options:[{label:"Et viktig ansvar.",nextId:"start"}]},lonely:{text:"Aldri. Jeg er omgitt av apostler, helgener og kirkefedrene. Augustin, Thomas Aquinas... de taler til meg gjennom sidene. Og brdrene i klosteret er min familie. Vi ber sammen, arbeider sammen.",options:[{label:"Ora et labora?",nextId:"rule"},{label:"Hres fredelig ut.",nextId:"start"}]},rule:{text:"Be og arbeid. Ja. Det er St. Benedikts regel. Lediggang er fienden av sjelen. S vi dyrker urter, brygger l (som dette, Guds gave!), og kopierer bker.",options:[{label:"Skl for let.",nextId:"EXIT"}]}}},{id:"pestlege",name:"Doktor Pestus",role:"Pestlege",description:"Han sitter litt for seg selv. En merkelig maske med nebb henger rundt halsen hans, og han lukter sterkt av eddik og trkede blomster.",conversation:{start:{text:"Ikke kom for nr! Balansen i vskene dine ser... urolig ut. Er du sangvinsk? Eller melankolsk? Luften her er tykk av miasma.",options:[{label:"Miasma?",nextId:"miasma"},{label:"Hva er masken til?",nextId:"mask"},{label:"Jeg er frisk! (G)",nextId:"EXIT"}]},miasma:{text:"Drlig luft! Sykdom kommer av rtten luft som stiger opp fra jorden eller fra syke kropper. Den forstyrrer balansen i kroppen  blod, slim, gul og svart galle. Pesten... den er den verste ubalansen.",options:[{label:"Svartedauden?",nextId:"plague"},{label:"Hvordan kurerer man det?",nextId:"cure"}]},plague:{text:"Den store dden. Den kom med et skip til Bergen i 1349. Jeg s hele landsbyer tmmes. Prester dde mens de ga den siste olje. Det var som om Gud hadde forlatt oss. De som overlevde... vi er merket.",options:[{label:"Forferdelig.",nextId:"social"}]},social:{text:"Men se rundt deg! De frre vi er, jo mer verdt er hver mann. Bndene krever bedre lnn n. Tjenestepikene gr med silke. Verden er snudd p hodet etter pesten.",options:[{label:"En ny tid.",nextId:"start"}]},mask:{text:"Nebbet fylles med urter. Nellik, roser, mynte. Sterk lukt motvirker den drlige luften. Det er som et filter mot dden selv. Og kappen er innsatt med voks s pestloppene glir av.",options:[{label:"Smart oppfinnelse.",nextId:"cure"}]},cure:{text:'relating for  fjerne ondt blod. Kopping. Og Theriak  en blanding av over 60 ingredienser, inkludert ormekjtt og opium. Det beste rdet? "Cito, longe, tarde." Dra fort, dra langt, kom sent tilbake.',options:[{label:"Skal huske det.",nextId:"EXIT"}]}}},{id:"birkebeiner",name:"Gunnar",role:"Birkebeiner-opprrer",description:"En hardfr mann med slitte klr, men sverdet ved beltet er velstelt. Han ser mistenksomt mot dren hver gang den pnes.",conversation:{start:{text:"Hvem holder du med? Kongen eller Kirken? Baglerne eller Birkebeinerne? Svar fort, fr let blir varmt.",options:[{label:"Birkebeinerne!",nextId:"birkebeiner"},{label:"Jeg blander meg ikke.",nextId:"neutral"},{label:"Baglerne?",nextId:"bagler"},{label:"Ingen. (G)",nextId:"EXIT"}]},birkebeiner:{text:"Godt svar! Vi er kong Sverres menn. Mange av oss startet med ingenting, med never rundt leggene i snen. Men vi kjemper for norges rettmessige konge mot biskopenes tyranni!",options:[{label:"Hvorfor hater dere biskopene?",nextId:"church"},{label:"Fortell om Kong Sverre.",nextId:"sverre"}]},bagler:{text:"*Han spytter p gulvet* Kirkens lpegutter. De vil at paven i Roma skal styre Norge, ikke kongen. Pass deg, ellers tror jeg du er en spion.",options:[{label:"Jeg mente det ikke snn.",nextId:"start"}]},neutral:{text:"Ingen kan vre nytrale i borgerkrig. Nr bror dreper bror, m man velge side. Men kanskje det er klokest  holde kjeft, ja.",options:[{label:"Nettopp.",nextId:"start"}]},church:{text:'Erkebiskopen vil ha makt. Han nekter  krone Sverre! Han lyste ham i bann! Men Sverre talte Roma midt imot. "En tale mot biskopene", kalte han det. Han sa at kirken er rtten, og at kongen er innsatt av Gud, ikke av Paven.',options:[{label:"Sterke ord.",nextId:"start"}]},sverre:{text:"En prest fra Fryene som ble konge! Han er liten av vekst, men en kjempe i klkt. Han lrte oss  slss p en ny mte. Ikke bare storme frem, men bruke terrenget, sl til og forsvinne. Gerilja, kaller de det visst i sr.",options:[{label:"En taktiker.",nextId:"EXIT"}]}}},{id:"kone",name:"Ragnhild",role:"Klok Kone",description:"En eldre kvinne med grtt hr flettet med fargerike bnd. Hun har en kurv full av trkede planter og rtter p bordet.",conversation:{start:{text:"Har du en plage, ungen min? En verkebyll? Kjrlighetssorg? Eller kanskje kua di har sluttet  melke? Naturen har en bot for alt, hvis man vet hvor man skal lete.",options:[{label:"Er du en heks?",nextId:"witch"},{label:"Har du noe mot sr?",nextId:"herbs"},{label:"Jeg tror p bnner. (G)",nextId:"EXIT"}]},witch:{text:"Hysj! Ikke bruk det ordet. Prestene brenner folk for mindre. Jeg er en hjelper. Jeg bruker bare Guds skaperverk. Er det trolldom  vite at groblad stanser bldning? Nei, det er kunnskap.",options:[{label:"Unnskyld.",nextId:"signs"},{label:"Hva med magi?",nextId:"magic"}]},herbs:{text:"Groblad for sr. Ryllik for feber. Og johannesurt for de tunge tankene som kommer om vinteren. Og honning... honning er bra for alt. Det holder betennelsen borte.",options:[{label:"Nyttig  vite.",nextId:"start"}]},signs:{text:"Man m lese tegnene. Hvis rogna brer mye br, blir vinteren sntung. Hvis krka skriker mot nord, kommer det gjester. Det er ikke magi, det er  lytte til verden.",options:[{label:"Klokt.",nextId:"start"}]},magic:{text:"*Hun lener seg frem* Det finnes krefter... de underjordiske. Nissen p lven, Huldra i skogen. Man m vise dem respekt. Ofre litt grt, litt l. Kirken liker det ikke, men bonden vet at det er best  holde seg inne med dem.",options:[{label:"Best  vre forsiktig.",nextId:"EXIT"}]}}},{id:"skald",name:"Einar Skald",role:"Hoff-poet",description:"Han sitter med lukkede yne og trommer rytmisk p bordet. Plutselig slr han ut med hnden og deklamerer en strofe.",conversation:{start:{text:'"Sverdets sang, blodets brang, ravnens fang..." Nei, nei. Det mangler bokstavrim. En god drpa skal vre som et vevd teppe, hver ord skal lse det neste.',options:[{label:"Hva er en drpa?",nextId:"drapa"},{label:"Fortell en saga!",nextId:"saga"},{label:"Du virker intens. (G)",nextId:"EXIT"}]},drapa:{text:'Det ypperste av kvad! Et hyllingsdikt til en fyrste eller konge. Det m ha "stef"  et omkved som gjentas. Hvis jeg gjr en feil i versefoten foran Jarlen, kan jeg miste hodet. Eller verre, miste min re.',options:[{label:"Hres vanskelig ut.",nextId:"oral"},{label:"Hva er versefot?",nextId:"poetry"}]},saga:{text:'Ah, historiene. Ikke bare dikt, men sannheten om vre forfedre. Som historien om Egil Skallagrimsson... kriger og poet. Han reddet sitt eget liv ved  dikte "Hodelsningen" til Eirik Blodks. Ord er makt, min venn.',options:[{label:"Fortell om Egil.",nextId:"egil"}]},egil:{text:"Han var stygg som juling, men sterk som en bjrn. Og han kunne drepe med et sverd i n hnd og dikte med den andre. En gang spydde han over en hirdmann som prvde  fornrme ham! En ekte helt.",options:[{label:"Fargerik type.",nextId:"start"}]},oral:{text:"Vi brer historien i hodet. Bker kan brenne, men et godt kvede lever p folkemunne i tusen r. Det er min oppgave.  srge for at kongens bedrifter aldri glemmes. Jeg er levende historie.",options:[{label:"Imponerende hukommelse.",nextId:"start"}]},poetry:{text:'Det er regler! Fornyrdislag, Ljogahtt... du m bruke "Kenninger". Du sier ikke "sverd", du sier "sr-isl". Du sier ikke "blod", du sier "sverd-vann". Det gjr sprket rikt og gtefullt.',options:[{label:"Vakkert sprk.",nextId:"EXIT"}]}}}];function WG(t,e,s){const{setActiveTab:n,setProductionContext:i,viewMode:a,setViewMode:l,viewingRegionId:o,setViewingRegionId:c,setActiveMinigame:u,activeTab:d}=ll(),f=o||t.regionId||"capital",[h,m]=_.useState(null),[v,x]=_.useState(null),[b,g]=_.useState(null),[p,y]=_.useState(null),[k,N]=_.useState("start"),[S,w]=_.useState(!1),[E,j]=_.useState(!1),[A,O]=_.useState(!1),[L,Y]=_.useState(!1),[W,H]=_.useState(!1),[M,U]=_.useState(!1),[C,T]=_.useState(!1),[R,D]=_.useState(!1),[I,F]=_.useState(!1),P=_.useCallback(ye=>{if(ye==="kingdom")return 0;if(ye==="global")return 1;const ae=Ni.find(Z=>Z.id===ye);return ae!=null&&ae.parentId?3:2},[]),[B,J]=_.useState(a),[se,ie]=_.useState("in");if(a!==B){const ye=P(B),ae=P(a);ae>ye?ie("in"):ae<ye&&ie("out"),J(a)}_.useEffect(()=>{const ye=ae=>{if(ae.key==="Escape"){if(d!=="MAP")return;if(b){g(null);return}if(S){w(!1);return}if(E){j(!1);return}if(L){Y(!1);return}if(W){H(!1);return}if(M){U(!1);return}if(C){T(!1);return}if(I){F(!1);return}if(p){y(null);return}if(v){x(null);return}if(h){m(null);return}if(a!=="kingdom"){const Z=Ni.find(qe=>qe.id===a),Me=Z!=null&&Z.parentId?Ni.find(qe=>qe.id===Z.parentId):null;l(a==="global"?"kingdom":Me?Me.id:"global")}}};return window.addEventListener("keydown",ye),()=>window.removeEventListener("keydown",ye)},[a,b,S,E,L,p,v,h,l,d]);const Ee=_.useCallback((ye,ae)=>{var ht,Fe;const Z=typeof ae=="string"?ae:ae.type||ae.id,Me=Q=>Q==="windmill_stones"?{buildingId:"windmill",type:"REFINE"}:Q==="sawmill_blade"?{buildingId:"sawmill",type:"REFINE"}:Q==="smeltery_furnace"?{buildingId:"smeltery",type:"REFINE"}:Q==="bakery_oven"?{buildingId:"bakery",type:"REFINE"}:Q==="weavery_loom"?{buildingId:"weavery",type:"REFINE"}:Q==="forge_anvil"?{buildingId:"great_forge",type:"CRAFT"}:Q==="apothecary_bench"?{buildingId:"apothecary",type:"CRAFT"}:null;if(Z==="OPEN_CHICKEN_COOP"){j(!0),m(null);return}if(Z==="OPEN_GARRISON"){i({buildingId:"watchtower",type:"CRAFT",initialView:"PRODUCE"}),n("PRODUCTION"),m(null);return}if(Z==="OPEN_CONSTRUCTION"){O(!0),m(null);return}if(Z==="OPEN_WAR_ROOM"){n("WAR_ROOM"),m(null);return}if(Z==="OPEN_TAXATION"){Y(!0),m(null);return}if(Z==="OPEN_SHIPYARD"){T(!0),m(null);return}if(Z==="START_SAILING"){u("SAILING"),m(null);return}if(Z==="OPEN_WHARF_UPGRADE"){D(!0),m(null);return}const qe=Me(ye);if(qe&&(Z==="OPEN_CRAFTING"||Z==="CRAFT"||Z==="REFINE"||Z.startsWith("REFINE_")||Z.startsWith("CRAFT_")||Hs[Z]||Z==="REPAIR")){i({...qe,initialView:Z==="REPAIR"?"REPAIR":"PRODUCE"}),n("PRODUCTION"),m(null);return}const ge=f===t.regionId,me=t.role==="KING";if(!ge&&!me&&Z!=="MARKET_VIEW"){alert("Du har ingen myndighet i dette baroniet.");return}if(Z==="MARKET_VIEW")s();else if(Z.startsWith("REFINE_")){const Q=Z.replace("REFINE_","").split("_")[0].toLowerCase();e({type:"REFINE",recipeId:{plank:"plank",flour:"flour",iron:"iron_ingot",steel:"iron_ingot",cloth:"cloth"}[Q]||Q})}else if(Z.startsWith("CRAFT_")){const Q=Z.replace("CRAFT_","").toLowerCase();e(Q==="bread"||Q==="pie"||Q==="mead"?{type:"REFINE",recipeId:Q}:{type:"CRAFT",subType:Q})}else if(Z in Hs)e({type:"CRAFT",subType:Z});else if(Z.startsWith("BUILDING_UPGRADE_")){const Q=Z.replace("BUILDING_UPGRADE_","");g(Q)}else if(Z==="OPEN_RESOURCE_GAME")H(!0);else if(Z==="HARVEST"||Z==="PLANT"){const Q=Ni.find(ue=>ue.id===ye),fe=((ht=Q==null?void 0:Q.label)==null?void 0:ht.toLowerCase().includes("lin"))||ye==="flax_field",V=(Fe=Q==null?void 0:Q.actions)==null?void 0:Fe.find(ue=>ue.id===Z);fe&&Z==="HARVEST"?F(!0):!fe&&Z==="HARVEST"?U(!0):e({type:Z,...V,locationId:ye})}else if(Z==="CHAT_LOCAL"){const Q=D_[Math.floor(Math.random()*D_.length)];y(Q),N("start")}else e(Z==="BUY_MEAL"?{type:"BUY_MEAL"}:Z);m(null)},[f,t,e,s,n,i,m]);return{viewMode:a,setViewMode:l,viewingRegionId:f,setViewingRegionId:c,selectedPOI:h,setSelectedPOI:m,selectedEvent:v,setSelectedEvent:x,upgradingBuildingId:b,setUpgradingBuildingId:g,dialogNPC:p,setDialogNPC:y,dialogStep:k,setDialogStep:N,isDiceGameOpen:S,setIsDiceGameOpen:w,isChickenCoopOpen:E,setIsChickenCoopOpen:j,isConstructionOpen:A,setIsConstructionOpen:O,isTaxationOpen:L,setIsTaxationOpen:Y,isGambleGameOpen:W,setIsGambleGameOpen:H,isGrainGameOpen:M,setIsGrainGameOpen:U,isShipyardOpen:C,setIsShipyardOpen:T,isWharfUpgradeOpen:R,setIsWharfUpgradeOpen:D,isFlaxGameOpen:I,setIsFlaxGameOpen:F,direction:se,handlePOIAction:Ee}}const qG=({playerGold:t,onClose:e,onPlay:s})=>{const[n,i]=_.useState(1),[a,l]=_.useState(!1),[o,c]=_.useState([1,1]),[u,d]=_.useState([1,1]),[f,h]=_.useState("Plasser din innsats..."),[m,v]=_.useState(t);Ne.useEffect(()=>{v(t)},[t]);const x=()=>Math.floor(Math.random()*6)+1,b=()=>{if(a)return;if(n>t){h("Du har ikke nok gull!");return}if(n<.5){h("Minstesats er 0.5g");return}l(!0),h("Terningene ruller...");let y=0;const k=10,N=setInterval(()=>{c([x(),x()]),d([x(),x()]),y++,y>=k&&(clearInterval(N),g())},100)},g=()=>{const y=x(),k=x(),N=x(),S=x(),w=y+k,E=N+S;c([y,k]),d([N,S]);const j=w>E;j?(h(`DU VANT! ${w} mot ${E}`),v(A=>A+n)):(h(`HUSET VANT. ${E} mot ${w}`),v(A=>Math.max(0,A-n))),s({amount:n,isWin:j,playerRoll:w,houseRoll:E}),l(!1)},p=(y,k)=>r.jsx("div",{className:`w-16 h-16 rounded-xl shadow-[inset_0_0_10px_rgba(0,0,0,0.5)] flex bg-gradient-to-br ${k==="player"?"from-white to-slate-200 text-black":"from-red-600 to-red-800 text-white"} relative transition-transform duration-100 ${a?"animate-bounce":""}`,children:r.jsx("div",{className:"grid grid-cols-3 grid-rows-3 w-full h-full p-2 gap-1",children:[...Array(9)].map((N,S)=>{let w=!1;return y===1&&S===4&&(w=!0),y===2&&(S===0||S===8)&&(w=!0),y===3&&(S===0||S===4||S===8)&&(w=!0),y===4&&(S===0||S===2||S===6||S===8)&&(w=!0),y===5&&(S===0||S===2||S===4||S===6||S===8)&&(w=!0),y===6&&(S===0||S===2||S===3||S===5||S===6||S===8)&&(w=!0),r.jsx("div",{className:"flex items-center justify-center",children:w&&r.jsx("div",{className:`w-3 h-3 rounded-full ${k==="player"?"bg-black":"bg-white"} shadow-sm`})},S)})})});return r.jsxs("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/90 backdrop-blur-sm animate-in fade-in duration-500",children:[r.jsxs("div",{className:"absolute inset-0 z-0 opacity-50",children:[r.jsx("img",{src:"/Simulation_StandAlone_Pro/poi/tavern_dice_bg.png",alt:"Tavern Table",className:"w-full h-full object-cover"}),r.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-transparent to-black"})]}),r.jsxs("div",{className:"relative z-10 bg-[#1a472a]/90 border-[4px] border-[#5d4037] rounded-[2rem] shadow-[0_50px_100px_rgba(0,0,0,0.8)] w-full max-w-2xl overflow-hidden backdrop-blur-md",children:[r.jsx("div",{className:"absolute inset-0 border-2 border-[#8d6e63] rounded-[1.2rem] pointer-events-none opacity-50"}),r.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-[#d7ccc8] hover:text-white transition-colors bg-black/20 hover:bg-black/40 rounded-full w-8 h-8 flex items-center justify-center font-bold z-50",children:""}),r.jsxs("div",{className:"p-8 flex flex-col items-center gap-8 relative",children:[r.jsxs("div",{className:"text-center space-y-1",children:[r.jsx("h2",{className:"text-3xl font-black text-[#ffecb3] uppercase tracking-widest drop-shadow-md",style:{fontFamily:"serif"},children:"Spillebordet"}),r.jsx("div",{className:"text-[#a5d6a7] font-bold tracking-wider text-sm",children:"Huset vinner ved uavgjort"}),r.jsx("div",{className:"text-xs text-white/50 uppercase tracking-widest font-black",children:"Lykke til!"})]}),r.jsxs("div",{className:"flex justify-between w-full px-8 gap-8",children:[r.jsxs("div",{className:"flex flex-col items-center gap-4",children:[r.jsxs("span",{className:"text-[#90caf9] font-black uppercase tracking-widest text-xs",children:["Deg (",o[0]+o[1],")"]}),r.jsxs("div",{className:"flex gap-3",children:[p(o[0],"player"),p(o[1],"player")]})]}),r.jsx("div",{className:"flex items-center justify-center",children:r.jsx("span",{className:"text-2xl font-black text-white/20",children:"VS"})}),r.jsxs("div",{className:"flex flex-col items-center gap-4",children:[r.jsxs("span",{className:"text-[#ef9a9a] font-black uppercase tracking-widest text-xs",children:["Huset (",u[0]+u[1],")"]}),r.jsxs("div",{className:"flex gap-3",children:[p(u[0],"house"),p(u[1],"house")]})]})]}),r.jsx("div",{className:`h-12 flex items-center justify-center w-full bg-black/30 rounded-xl border border-white/5 transition-all ${f.includes("VANT")?"bg-green-900/40 border-green-500/30":f.includes("tapte")?"bg-red-900/40 border-red-500/30":""}`,children:r.jsx("span",{className:"font-bold text-lg text-[#fff8e1] tracking-wide",children:f})}),r.jsxs("div",{className:"w-full bg-black/20 p-6 rounded-2xl border border-white/5 flex flex-col gap-4",children:[r.jsxs("div",{className:"flex justify-between items-center text-[#d7ccc8] font-bold text-sm uppercase tracking-widest",children:[r.jsx("span",{children:"Innsats"}),r.jsxs("span",{children:["Din Saldo: ",r.jsxs("span",{className:"text-[#ffd54f]",children:[m.toFixed(1),"g"]})]})]}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("input",{type:"range",min:.5,max:Math.min(t,100),step:.5,value:n,onChange:y=>i(parseFloat(y.target.value)),className:"w-full h-3 bg-black/50 rounded-lg appearance-none cursor-pointer accent-[#ffb74d]",disabled:a}),r.jsxs("div",{className:"bg-black/40 px-4 py-2 rounded-xl text-[#ffd54f] font-black min-w-[5rem] text-center border border-white/10",children:[n,"g"]})]}),r.jsx("div",{className:"grid grid-cols-4 gap-2",children:[1,5,10,50].map(y=>r.jsxs("button",{onClick:()=>i(y),disabled:y>t||a,className:`py-1 rounded-lg text-xs font-bold uppercase tracking-widest transition-colors ${n===y?"bg-[#ffb74d] text-black":"bg-white/5 text-[#d7ccc8] hover:bg-white/10"}`,children:[y,"g"]},y))}),r.jsx("button",{onClick:b,disabled:a||t<n,className:`w-full py-4 rounded-xl font-black uppercase tracking-widest text-lg shadow-lg transform transition-all active:scale-[0.98] ${a?"bg-gray-600 cursor-not-allowed opacity-50":"bg-gradient-to-r from-[#ffca28] to-[#ff6f00] text-black hover:brightness-110 shadow-orange-900/40"}`,children:a?"Ruller...":"KAST TERNINGENE!"})]})]})]})]})},wu=[{id:"gold",label:"GULL",icon:"",color:"from-yellow-400 to-amber-600",accent:"amber"},{id:"grain",label:"KORN",icon:"",color:"from-amber-400 to-amber-600",accent:"amber"},{id:"wood",label:"TREVIRKE",icon:"",color:"from-orange-500 to-amber-800",accent:"orange"},{id:"stone",label:"STEIN",icon:"",color:"from-slate-500 to-slate-700",accent:"slate"},{id:"iron",label:"JERN",icon:"",color:"from-blue-500 to-indigo-900",accent:"indigo"}],Sn=[{value:0,weight:50,label:"Tap",color:"#0f172a",multiplierText:"0x",angle:180},{value:1.5,weight:30,label:"Gevinst",color:"#10b981",multiplierText:"1.5x",angle:90},{value:2.5,weight:15,label:"Stor Gevinst",color:"#3b82f6",multiplierText:"2.5x",angle:60},{value:5,weight:5,label:"JACKPOT!",color:"#f59e0b",multiplierText:"5x",angle:30}],XG=({player:t,onClose:e,onPlay:s})=>{const[n,i]=_.useState("gold"),[a,l]=_.useState(100),[o,c]=_.useState(!1),[u,d]=_.useState(0),[f,h]=_.useState(null),[m,v]=_.useState([]),x=_.useRef(!1),b=t.resources||{},g=b[n]||0;_.useEffect(()=>{a>g&&l(Math.max(1,Math.floor(g)))},[n,g]);const p=()=>{if(x.current||o||a<=0||a>g)return;x.current=!0,c(!0),h(null);const N=Sn.reduce((I,F)=>I+F.weight,0),S=Math.random()*N;let w=0,E=0;for(let I=0;I<Sn.length;I++)if(E+=Sn[I].weight,S<E){w=I;break}const j=Sn[w],A=8+Math.floor(Math.random()*4);let O=0;for(let I=0;I<w;I++)O+=Sn[I].angle;const L=Sn[w],Y=O+L.angle/2,W=L.angle/2*.6,H=(Math.random()-.5)*W,U=(360-(Y+H+360)%360)%360,C=u,T=C%360,R=(U-T+360)%360,D=C+A*360+R;d(D),setTimeout(()=>{const I=j.value>0,F={multiplier:j.value,isWin:I,label:j.label};h(F),c(!1),x.current=!1;const P={resource:n,amount:a,multiplier:j.value,isWin:I,timestamp:Date.now()};v(B=>[P,...B].slice(0,4)),s({resource:n,amount:a,multiplier:j.value,isWin:I})},3100)},y=wu.find(N=>N.id===n)||wu[0],k=_.useMemo(()=>{let N=0;return Sn.map(S=>{const w=N;return N+=S.angle,`${S.color} ${w}deg ${N}deg`}).join(", ")},[]);return r.jsxs("div",{className:"absolute inset-0 z-[100] flex items-center justify-center p-4",children:[r.jsx(q.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:o?void 0:e,className:"absolute inset-0 bg-slate-950/85 backdrop-blur-xl cursor-pointer"}),r.jsxs(q.div,{initial:{scale:.95,opacity:0,y:30},animate:{scale:1,opacity:1,y:0},exit:{scale:.95,opacity:0,y:30},className:"relative w-full max-w-5xl bg-slate-900 border border-white/5 rounded-[2.5rem] shadow-2xl overflow-hidden flex flex-col lg:flex-row h-[650px]",children:[r.jsx("button",{onClick:e,disabled:o,className:"absolute top-6 right-6 z-50 p-2 bg-white/5 hover:bg-white/10 rounded-full text-white/30 hover:text-white transition-all",children:r.jsx(pn,{size:24})}),r.jsxs("div",{className:"flex-1 p-6 flex flex-col gap-4 z-10 overflow-hidden",children:[r.jsx("div",{className:"flex items-center gap-2",children:r.jsxs("div",{className:"px-3 py-0.5 rounded-full bg-amber-500/10 border border-amber-500/20 text-amber-500 text-[9px] font-black uppercase tracking-[0.2em] flex items-center gap-2",children:[r.jsx(Hi,{size:10}),r.jsx("span",{children:"Soga-hjulet"})]})}),r.jsx("h2",{className:"text-3xl font-black text-white italic tracking-tighter leading-none",children:"Sats Dine Ressurser"}),r.jsx("div",{className:"grid grid-cols-5 gap-2",children:wu.map(N=>{const S=n===N.id,w=b[N.id]||0;return r.jsxs("button",{onClick:()=>!o&&i(N.id),className:`relative p-3 rounded-2xl border-2 transition-all duration-300 flex flex-col items-center gap-1.5
                                        ${S?`bg-white/5 border-${N.accent}-500 shadow-lg scale-105`:"bg-black/20 border-white/5 hover:border-white/10 opacity-70"}`,children:[r.jsx("div",{className:"text-2xl",children:N.icon}),r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsx("div",{className:"text-[10px] font-black uppercase tracking-widest text-slate-400",children:N.label}),r.jsx("div",{className:`text-lg font-black font-mono ${S?"text-white":"text-slate-300"}`,children:w%1!==0?w.toFixed(1):w.toLocaleString()})]})]},N.id)})}),r.jsxs("div",{className:"bg-black/40 border border-white/5 rounded-[2rem] p-6 space-y-4",children:[r.jsxs("div",{className:"flex justify-between items-end",children:[r.jsxs("div",{className:"space-y-0.5",children:[r.jsx("span",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-slate-500",children:"Innsats Belp"}),r.jsxs("div",{className:"flex items-baseline gap-2",children:[r.jsx("span",{className:"text-5xl font-black text-white font-mono",children:a.toLocaleString()}),r.jsx("span",{className:"text-sm font-black text-indigo-400 uppercase tracking-widest",children:y.label})]})]}),r.jsx("div",{className:"flex gap-2",children:[25,50,100].map(N=>r.jsx("button",{onClick:()=>l(Math.max(1,Math.floor(g*(N/100)))),className:"px-3 py-1.5 rounded-xl bg-white/5 hover:bg-white/10 text-[10px] font-black uppercase tracking-widest text-slate-300 border border-white/5",children:N===100?"MAX":`${N}%`},N))})]}),r.jsxs("div",{className:"relative h-8 flex items-center",children:[r.jsx("input",{type:"range",min:1,max:Math.max(1,Math.floor(g)),step:1,value:a,onChange:N=>l(parseInt(N.target.value)),disabled:o,className:"w-full h-1.5 bg-white/5 rounded-full appearance-none cursor-pointer accent-amber-500 z-10"}),r.jsx("div",{className:"absolute left-0 h-1.5 bg-gradient-to-r from-amber-600 to-amber-400 rounded-full pointer-events-none",style:{width:`${a/Math.max(1,Math.floor(g))*100}%`}})]}),r.jsx("button",{onClick:p,disabled:o||g<a||a<=0,className:`w-full relative h-14 rounded-xl font-black uppercase tracking-[0.3em] text-base shadow-2xl transition-all duration-300 ${o?"bg-slate-800":"bg-amber-500 hover:brightness-110 active:scale-95 text-slate-950"}`,children:o?"Spinner...":"SPINN HJULET!"})]}),r.jsxs("div",{className:"mt-auto border-t border-white/5 pt-3",children:[r.jsxs("div",{className:"flex items-center gap-2 text-[9px] font-black uppercase tracking-[0.3em] text-slate-600 mb-2",children:[r.jsx(cj,{size:10}),r.jsx("span",{children:"Siste Resultater"})]}),r.jsx("div",{className:"grid grid-cols-4 gap-2",children:m.map((N,S)=>{const w=wu.find(E=>E.id===N.resource);return r.jsxs("div",{className:"flex flex-col p-2 rounded-xl bg-black/40 border border-white/5 items-center",children:[r.jsxs("div",{className:"flex items-center gap-1.5 mb-0.5",children:[r.jsx("span",{className:"text-xs",children:w==null?void 0:w.icon}),r.jsx("span",{className:"text-[10px] font-mono font-bold text-slate-400",children:N.amount.toLocaleString()})]}),r.jsx("div",{className:`text-xs font-black font-mono ${N.isWin?"text-emerald-500":"text-rose-900/40"}`,children:N.isWin?`x${N.multiplier}`:"TAP"})]},S)})})]})]}),r.jsxs("div",{className:"w-full lg:w-[480px] bg-black/50 border-l border-white/5 flex flex-col items-center justify-center p-12 relative",children:[r.jsxs("div",{className:"relative w-80 h-80 mb-10",children:[r.jsx("div",{className:`absolute -inset-12 rounded-full blur-[100px] opacity-20 transition-colors duration-1000 bg-${y.accent}-500`}),r.jsxs(q.div,{animate:{rotate:u},transition:{duration:3,ease:[.32,.72,0,1]},className:"w-full h-full rounded-full border-[18px] border-slate-900 shadow-2xl relative overflow-hidden bg-slate-950",children:[r.jsx("div",{className:"absolute inset-0 transition-opacity duration-300",style:{background:`conic-gradient(${k})`,opacity:o?.4:.8}}),Sn.map((N,S)=>{let w=0;for(let j=0;j<S;j++)w+=Sn[j].angle;const E=w+N.angle/2;return r.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",style:{transform:`rotate(${E}deg)`},children:r.jsx("div",{className:"absolute top-[16%] text-white font-black text-2xl drop-shadow-[0_2px_4px_rgba(0,0,0,1)] font-mono",children:N.multiplierText})},S)}),r.jsx("div",{className:"absolute inset-[80px] rounded-full border-2 border-white/5 bg-slate-950/80 backdrop-blur-md shadow-inner"})]}),r.jsx("div",{className:"absolute -top-12 left-1/2 -translate-x-1/2 z-50",children:r.jsx(q.div,{animate:o?{y:[0,-5,0]}:{},transition:{duration:.1,repeat:1/0},className:"w-10 h-16 bg-amber-500 rounded-b-full shadow-[0_15px_30px_rgba(245,158,11,0.6)] border-4 border-slate-950 flex flex-col items-center justify-end pb-2",children:r.jsx("div",{className:"w-1.5 h-6 bg-slate-950/30 rounded-full"})})}),r.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-40 pointer-events-none",children:r.jsx(kt,{mode:"wait",children:o?r.jsx(q.div,{initial:{scale:.8},animate:{scale:1.1},exit:{scale:1.2,opacity:0},className:"text-7xl drop-shadow-2xl",children:y.icon},"spinning_icon"):r.jsxs(q.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},className:"flex flex-col items-center gap-1 drop-shadow-2xl",children:[r.jsx("span",{className:"text-6xl",children:y.icon}),f&&r.jsxs(q.span,{initial:{y:10,opacity:0},animate:{y:0,opacity:1},className:`text-3xl font-black font-mono ${f.isWin?"text-emerald-400":"text-slate-500"}`,children:[f.multiplier,"x"]})]},"result_icon")})})]}),r.jsx("div",{className:"h-24 text-center flex flex-col items-center justify-center",children:r.jsx(kt,{mode:"wait",children:f&&!o&&r.jsxs(q.div,{initial:{opacity:0,y:10,scale:.9},animate:{opacity:1,y:0,scale:1},className:"space-y-1",children:[r.jsxs("div",{className:`text-xs font-black uppercase tracking-[0.3em] flex items-center justify-center gap-2 ${f.isWin?"text-emerald-400":"text-slate-500"}`,children:[f.isWin&&r.jsx(Hi,{size:12,className:"animate-pulse"}),f.label,f.isWin&&r.jsx(Hi,{size:12,className:"animate-pulse"})]}),r.jsx("h4",{className:`text-3xl font-black italic tracking-tighter drop-shadow-lg transition-all ${f.multiplier>=2.5?"text-yellow-400 scale-110":"text-white"}`,children:f.isWin?`+${(a*f.multiplier).toLocaleString()} ${y.label}`:"Fortellingen er over"}),f.multiplier>=5&&r.jsx(q.div,{initial:{opacity:0},animate:{opacity:1},className:"text-[10px] font-black text-amber-500 uppercase tracking-[0.5em] mt-2 animate-bounce",children:"LEGENDARISK GEVINST!"})]})})})]})]})]})};class QG{constructor(){et(this,"listeners",[])}subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(s=>s!==e)}}emit(e){this.listeners.forEach(s=>s(e))}spawnFloatingText(e,s,n,i){const a=(Math.random()-.5)*4,l=(Math.random()-.5)*4;this.emit({id:Math.random().toString(36).substr(2,9),type:"FLOATING_TEXT",text:e,x:s+a,y:n+l,color:i,duration:1500})}spawnFlyingResource(e,s,n,i,a){this.emit({id:Math.random().toString(36).substr(2,9),type:"FLYING_RESOURCE",resource:e,startPoint:{x:s,y:n},endPoint:{x:i,y:a},duration:1e3})}spawnParticles(e,s,n){this.emit({id:Math.random().toString(36).substr(2,9),type:"PARTICLE",x:e,y:s,color:n,duration:800})}}const Pe=new QG,JG=({onComplete:t})=>{const[e,s]=_.useState([]),[n,i]=_.useState(!1),a=10,l=o=>{if(n)return;const c=o.currentTarget.getBoundingClientRect(),u=(o.clientX-c.left)/c.width*100,d=(o.clientY-c.top)/c.height*100,f={x:u,y:d,id:Date.now()};Pe.spawnParticles(u,d,"bg-emerald-400"),s(h=>{const m=[...h,f];return m.length>=a&&(i(!0),setTimeout(()=>t(1),1500)),m})};return r.jsxs("div",{onClick:l,className:"w-full h-[600px] relative overflow-hidden cursor-crosshair group active:scale-[0.99] transition-transform select-none",style:{backgroundImage:'url("/images/minigames/agriculture_bg.png")',backgroundSize:"cover",backgroundPosition:"center"},children:[r.jsx("div",{className:"absolute inset-0 bg-black/40 z-0 pointer-events-none"}),r.jsx("div",{className:"absolute top-10 left-1/2 -translate-x-1/2 pointer-events-none z-20 text-center",children:n?r.jsx("div",{className:"animate-in zoom-in duration-300",children:r.jsx("h2",{className:"text-5xl font-black text-emerald-400 drop-shadow-[0_4px_0_rgba(0,0,0,0.5)] uppercase tracking-tighter animate-bounce",children:"Mestrerlig Sdd! "})}):r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"text-3xl font-black text-white drop-shadow-md mb-2",children:"S dine fr"}),r.jsxs("div",{className:"bg-black/40 px-4 py-1 rounded-full text-emerald-400 font-bold uppercase tracking-widest text-sm inline-block",children:[e.length," / ",a]})]})}),e.map(o=>r.jsx("div",{className:"absolute w-4 h-4 bg-emerald-400 rounded-full shadow-[0_0_10px_rgba(52,211,153,0.8)] animate-in zoom-in duration-300",style:{left:`${o.x}%`,top:`${o.y}%`,transform:"translate(-50%, -50%)"},children:r.jsx("div",{className:"absolute -top-4 left-1/2 -translate-x-1/2 w-0.5 h-3 bg-white/50"})},o.id)),r.jsx("div",{className:"absolute inset-0 pointer-events-none z-10 hidden group-hover:block",children:r.jsx("div",{className:"absolute w-8 h-8 border-2 border-white/50 rounded-full -translate-x-1/2 -translate-y-1/2"})})]})},jr=({onComplete:t,equipment:e=[],isMining:s,isQuarrying:n,isForaging:i,speedMultiplier:a=1,possibleYield:l=10,resourceName:o="Ressurs"})=>{const[c,u]=_.useState(0),[d,f]=_.useState([]),[h,m]=_.useState(!1),[v,x]=_.useState(!1),[b,g]=_.useState(!1),p=_.useRef(1),[y,k]=_.useState(50),N=_.useRef(1);_.useEffect(()=>{const E=j=>{j.code==="Space"&&(j.preventDefault(),S())};return window.addEventListener("keydown",E),()=>window.removeEventListener("keydown",E)},[d,h,c,y,e,a,b]),_.useEffect(()=>{if(d.length>=5||h||b)return;const E=setInterval(()=>{u(j=>{let A=2/a,O=j+A*p.current;return O>100?(p.current=-1,100):O<0?(p.current=1,0):O}),k(j=>{let O=j+.3*N.current;return Math.random()<.02&&(N.current*=-1),O>80?(N.current=-1,80):O<20?(N.current=1,20):O})},16);return()=>clearInterval(E)},[d.length,h,a,b]);const S=()=>{var M,U,C;if(d.length>=5||h||b)return;const E=Math.abs(c-y);let j=E<5?1:E<15?.7:E<25?.4:.1;const A=s?"MINE":n?"QUARRY":i?"FORAGE":"WORK",O=k2(A,e||[]);console.log(`[HarvestingGame] Init. Action: ${A}. Equipment Count: ${e==null?void 0:e.length}. Best Tool:`,O);const L=((M=O==null?void 0:O.stats)==null?void 0:M.yieldBonus)||(O&&Ui(O)?(C=(U=Oe[Ui(O)])==null?void 0:U.stats)==null?void 0:C.yieldBonus:0)||0,Y=Math.ceil(l/5*(.5+j)),W=Math.ceil(L/5*(.5+j));E<15?(x(!0),g(!0),Pe.spawnParticles(50,40,E<5?"bg-amber-400":"bg-white"),E<5?Pe.spawnFloatingText(`PERFEKT! + ${Y} ${W>0?`(+${W})`:""} `,50,40,"text-amber-400 font-black text-2xl"):Pe.spawnFloatingText(`Bra! +${Y}`,50,40,"text-white font-bold"),setTimeout(()=>{x(!1),g(!1)},100)):Pe.spawnFloatingText("Svakt...",50,40,"text-slate-500 font-bold");const H=[...d,j];f(H),H.length===5&&(m(!0),setTimeout(()=>t(H.reduce((T,R)=>T+R,0)/5),800))},w=s||n?'url("/images/minigames/mining_bg.png")':i?'url("/images/minigames/foraging_bg.png")':'url("/images/minigames/agriculture_bg.png")';return r.jsxs("div",{className:`p-8 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden ${v?"animate-shake":""} `,style:{backgroundImage:w,backgroundSize:"cover",backgroundPosition:"center"},children:[r.jsx("div",{className:`absolute inset-0 bg-black/70 z-0 transition-all duration-75 ${b?"bg-indigo-900/50 mix-blend-hard-light":""}`}),r.jsxs("div",{className:`relative z-10 w-full flex flex-col items-center transition-all duration-75 ${b?"scale-105 brightness-150 contrast-125":""}`,children:[r.jsx("h2",{className:"text-4xl font-black text-white mb-8 drop-shadow-lg tracking-tighter uppercase",children:s?"Gruvedrift":n?"Steinhugger":i?"Sanking":o!=null&&o.toLowerCase().includes("lin")?"Linhsting":"Kornhsting"}),h?r.jsx("div",{className:"py-12 animate-bounce text-5xl font-black text-amber-500 uppercase tracking-tighter drop-shadow-[0_0_20px_rgba(245,158,11,0.5)]",children:"FERDIG! "}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"mb-4 text-xs font-black text-amber-500 uppercase tracking-widest",children:o}),r.jsxs("div",{className:"w-full h-8 bg-white/5 rounded-full mb-12 relative border border-white/10 overflow-hidden shadow-inner",children:[r.jsx("div",{className:"absolute inset-y-0 bg-amber-500/30 border-x border-amber-500/50 transition-all duration-75 linear",style:{left:`${y-8}%`,right:`${100-(y+8)}%`}}),r.jsx("div",{className:"absolute inset-y-0 w-0.5 bg-amber-400/80 z-0",style:{left:`${y}%`}}),r.jsx("div",{className:"absolute inset-y-0 w-1 bg-white shadow-[0_0_20px_white] z-10",style:{left:`${c}% `}})]}),r.jsx("button",{onClick:S,className:`w-full bg-amber-500 hover:bg-amber-400 text-slate-950 py-7 rounded-[2rem] font-black text-2xl shadow-2xl transition-all uppercase tracking-widest border-b-4 border-amber-700 ${b?"scale-95 brightness-125":"active:scale-95"}`,children:"KLIKK N! "})]})]})]})},ZG=({onComplete:t,speedMultiplier:e=1})=>{const[s,n]=_.useState(50),[i,a]=_.useState(50),[l,o]=_.useState(0),[c,u]=_.useState(!1),[d,f]=_.useState(!1),[h,m]=_.useState(!1),v=_.useRef(1);_.useEffect(()=>{if(c||h)return;const b=setInterval(()=>{n(g=>{let p=g+.8*v.current*e;return p>90?(v.current=-1,90):p<10?(v.current=1,10):p})},16);return()=>clearInterval(b)},[c,e,h]),_.useEffect(()=>{const b=g=>{g.code==="Space"&&(g.preventDefault(),x({clientX:window.innerWidth/2,clientY:window.innerHeight/2}))};return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[c,i,s,h]);const x=b=>{if(c||h)return;const g=Math.abs(i-s),p=b.clientX,y=b.clientY;g<12?(f(!0),m(!0),o(k=>{const N=k+1;return N>=5&&(u(!0),Pe.spawnFloatingText("MESTERVERK! ",p,y-60,"text-amber-400 text-3xl font-black"),setTimeout(()=>t(1),1200)),N}),Pe.spawnParticles(p,y,"bg-amber-400"),Pe.spawnFloatingText("KLANG!",p,y-40,"text-amber-500 font-black"),setTimeout(()=>{f(!1),m(!1)},100)):g<25?(Pe.spawnFloatingText("Treff",p,y-40,"text-white font-bold"),Pe.spawnParticles(p,y,"bg-white")):Pe.spawnFloatingText("BOM!",p,y-40,"text-slate-500 font-bold")};return r.jsxs("div",{onMouseMove:b=>{const g=b.currentTarget.getBoundingClientRect();a((b.clientX-g.left)/g.width*100)},onClick:x,className:`p-12 min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden cursor-crosshair ${d?"animate-shake":""}`,style:{backgroundImage:'url("/images/minigames/smithing_bg.png")',backgroundSize:"cover",backgroundColor:"#0f172a"},children:[r.jsx("div",{className:`absolute inset-0 bg-black/70 z-0 transition-all duration-75 ${h?"bg-amber-900/40 mix-blend-hard-light":""}`}),r.jsxs("div",{className:`relative z-10 text-center mb-12 transition-all duration-75 ${h?"scale-105 brightness-150 contrast-125":""}`,children:[r.jsx("h2",{className:"text-4xl font-black text-white uppercase tracking-tighter drop-shadow-xl",children:"Smedarbeid"}),r.jsxs("div",{className:"text-amber-500 font-black uppercase tracking-widest text-xs mt-2 bg-black/40 px-4 py-1 rounded-full border border-amber-500/20",children:["Slag: ",l," / 5"]})]}),r.jsxs("div",{className:`relative z-10 w-full max-w-2xl space-y-4 transition-all duration-75 ${h?"scale-105":""}`,children:[r.jsxs("div",{className:"w-full h-24 bg-slate-900/50 rounded-2xl border-2 border-white/10 shadow-2xl flex items-center px-4 overflow-hidden",children:[r.jsx("div",{className:"absolute inset-0 bg-amber-500/5 transition-all duration-1000",style:{opacity:l/5}}),r.jsxs("div",{className:"relative w-full h-4 bg-white/5 rounded-full overflow-hidden",children:[r.jsx("div",{className:"absolute inset-y-0 w-24 bg-amber-500/40 blur-sm mix-blend-screen transition-all duration-75",style:{left:`${s}%`,transform:"translateX(-50%)"}}),r.jsx("div",{className:"absolute inset-y-0 w-12 bg-white/40 blur-[2px]",style:{left:`${s}%`,transform:"translateX(-50%)"}}),r.jsx("div",{className:"absolute inset-y-0 w-1 bg-white shadow-[0_0_15px_white] z-20",style:{left:`${i}%`,transform:"translateX(-50%)"}})]})]}),r.jsxs("div",{className:"flex items-center gap-4 px-2",children:[r.jsx("div",{className:"flex-1 h-2 bg-black/40 rounded-full overflow-hidden border border-white/5",children:r.jsx("div",{className:"h-full bg-gradient-to-r from-amber-600 to-amber-400 transition-all duration-500",style:{width:`${l/5*100}%`}})}),r.jsxs("span",{className:"text-[10px] font-black text-amber-500 uppercase tracking-widest",children:[Math.round(l/5*100),"%"]})]})]}),c&&r.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm animate-in fade-in zoom-in duration-300",children:r.jsx("div",{className:"text-6xl font-black text-amber-500 animate-bounce drop-shadow-[0_0_30px_rgba(245,158,11,0.5)]",children:"FERDIG! "})}),r.jsx("div",{className:`mt-12 text-slate-400 text-sm font-bold uppercase tracking-widest animate-pulse relative z-10 transition-opacity ${h?"opacity-0":"opacity-100"}`,children:"Klikk nr markren er over den gldende sonen"})]})},eF=({onComplete:t,speedMultiplier:e=1,icon:s=""})=>{const[n,i]=_.useState(0),[a,l]=_.useState(!1),[o,c]=_.useState(null),[u,d]=_.useState(0),[f,h]=_.useState(80),m=_.useRef(-1);_.useEffect(()=>{if(a||o)return;const x=setInterval(()=>{i(g=>{const p=g+1*e;return p>=100?(c("BRENT! "),setTimeout(()=>{c(null),i(0)},1e3),0):p})},50),b=setInterval(()=>{h(g=>{let y=g+.8*m.current;return y>90?(m.current=-1,90):y<40?(m.current=1,40):y})},50);return()=>{clearInterval(x),clearInterval(b)}},[a,o,e]),_.useEffect(()=>{const x=b=>{b.code==="Space"&&(b.preventDefault(),v())};return window.addEventListener("keydown",x),()=>window.removeEventListener("keydown",x)},[a,o,n,f]);const v=()=>{if(a||o)return;const x=f-10,b=f+10;n>x&&n<b?(c("PERFEKT GYLLEN! "),d(g=>{const p=g+1;return p>=3&&(l(!0),setTimeout(()=>t(1),1e3)),p})):n<x?c("R... "):c("LITT BRENT... "),setTimeout(()=>{c(null),i(0)},1e3)};return r.jsxs("div",{className:"p-12 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden",style:{backgroundImage:'url("/images/minigames/bakery_bg.png")',backgroundSize:"cover",backgroundColor:"#451a03"},children:[r.jsx("div",{className:"absolute inset-0 bg-black/70 z-0"}),r.jsx("h2",{className:"relative z-10 text-4xl font-black text-white mb-8 tracking-tighter uppercase italic",children:"Bakeri: Steking "}),r.jsxs("div",{className:"relative z-10 w-64 h-64 bg-slate-900 border-8 border-amber-900 rounded-3xl flex items-center justify-center overflow-hidden mb-12 shadow-2xl",children:[r.jsx("div",{className:"absolute inset-0 bg-orange-500/10 animate-pulse"}),r.jsx("div",{className:"text-8xl transition-all duration-300 transform",style:{filter:`grayscale(${100-n}%) sepia(${n}%)`,transform:`scale(${.8+n/500})`},children:s}),o&&r.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center text-white font-black text-2xl p-4 animate-in zoom-in",children:o})]}),r.jsxs("div",{className:`relative z-10 w-full max-w-sm h-8 bg-white/10 rounded-full mb-12 border ${n>f-10&&n<f+10?"border-emerald-500 shadow-[0_0_15px_rgba(16,185,129,0.5)]":"border-white/10"} overflow-hidden transition-all shadow-2xl`,children:[r.jsx("div",{className:"absolute inset-y-0 bg-emerald-500/30 border-x border-emerald-500/50 transition-all duration-75 ease-linear",style:{left:`${f-10}%`,right:`${100-(f+10)}%`},children:n>f-10&&n<f+10&&r.jsx("div",{className:"absolute inset-0 bg-emerald-400/20 animate-pulse"})}),r.jsx("div",{className:"h-full bg-orange-500 transition-all duration-75 relative z-10 opacity-80",style:{width:`${n}% `}}),r.jsx("div",{className:"absolute top-0 bottom-0 w-1 bg-white/50 z-20",style:{left:`${f}%`}})]}),r.jsx("div",{className:"relative z-10 flex gap-4 mb-8",children:[...Array(3)].map((x,b)=>r.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center text-2xl border-2 transition-all ${u>b?"bg-amber-500 border-amber-300 scale-110 shadow-lg":"bg-white/5 border-white/10 opacity-30"} `,children:s},b))}),r.jsx("button",{onClick:v,className:"relative z-10 w-full max-w-sm bg-amber-600 hover:bg-amber-500 text-white py-6 rounded-2xl font-black text-2xl shadow-xl active:scale-95 transition-all uppercase tracking-widest border-b-8 border-amber-800",children:"TA UT N! "})]})},tF=(t,e)=>{if(e)return e.find(s=>{var a;if(!s)return!1;const n=Object.keys(Oe).find(l=>s.id===l||s.id.startsWith(l+"_")),i=n?Oe[n]:null;return(a=i==null?void 0:i.relevantActions)==null?void 0:a.includes(t)})},sF=({onComplete:t,equipment:e=[]})=>{const[s,n]=_.useState(0),[i,a]=_.useState(!1),[l,o]=_.useState(!1),[c,u]=_.useState(0),[d,f]=_.useState({x:50,y:50}),[h,m]=_.useState(!1),v=()=>f({x:20+Math.random()*60,y:20+Math.random()*60}),x=g=>{if(l)return;o(!0),a(!0);const p=s+1;n(p);const y=p>5,k=p>2?`${p}x COMBO!`:y?"FLAWLESS!":"TREFF!",N=y?"text-amber-400 font-display":"text-white";Pe.spawnFloatingText(k,g.clientX,g.clientY-40,N),Pe.spawnParticles(g.clientX,g.clientY,y?"bg-amber-400":"bg-white"),setTimeout(()=>{o(!1),a(!1),u(S=>(S+1>=10&&(m(!0),Pe.spawnFloatingText("FULLFRT! ",g.clientX,g.clientY-100,"text-emerald-400 text-2xl"),setTimeout(()=>t(1),1200)),S+1)),v()},80)},b=tF("CHOP",e);return r.jsxs("div",{className:`p-8 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden ${i?"animate-shake":""} `,style:{backgroundImage:'url("/images/minigames/forestry_bg.png")',backgroundSize:"cover"},children:[r.jsx("div",{className:"absolute inset-0 bg-black/60 z-0"}),r.jsx("div",{className:"relative z-10 w-full mb-8",children:r.jsxs("div",{className:"flex flex-col items-center gap-2",children:[r.jsx("h2",{className:"text-4xl font-black text-white drop-shadow-lg tracking-tighter uppercase",children:"Tmmerhogging"}),r.jsxs("div",{className:"flex gap-4",children:[r.jsxs("div",{className:"text-amber-400 font-black uppercase tracking-widest text-xs px-4 py-1 bg-black/40 rounded-full inline-block border border-amber-500/20",children:["Framdrift: ",c,"/10"]}),s>0&&r.jsxs("div",{className:"text-rose-500 font-black uppercase tracking-widest text-xs px-4 py-1 bg-rose-500/10 rounded-full inline-block border border-rose-500/30 animate-bounce",children:["COMBO: x",s]}),b&&r.jsxs("div",{className:"text-indigo-400 font-black uppercase tracking-widest text-xs px-4 py-1 bg-indigo-500/10 rounded-full inline-block border border-indigo-500/30",children:[b.icon," ",b.name]})]})]})}),r.jsxs("div",{className:`relative z-10 w-full h-96 bg-white/5 rounded-[3rem] border border-white/10 shadow-inner overflow-hidden ${l?"opacity-90 grayscale-[0.5]":""}`,children:[r.jsx("div",{className:"absolute bottom-0 left-0 h-2 bg-indigo-500/50 transition-all duration-300 z-0",style:{width:`${c/10*100}%`}}),h?r.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-4",children:[r.jsx("div",{className:"animate-bounce text-5xl font-black text-amber-500 uppercase tracking-tighter drop-shadow-2xl",children:"VEDHOGST FERDIG! "}),r.jsxs("div",{className:"text-xl font-black text-white uppercase tracking-widest bg-indigo-600 px-8 py-2 rounded-full shadow-lg",children:["Maks Combo: ",s]})]}):r.jsx("button",{onClick:x,onKeyDown:g=>{g.key===" "&&g.preventDefault()},className:`absolute w-20 h-20 bg-rose-500 rounded-full border-4 border-white shadow-[0_0_30px_rose] transition-all active:scale-90 ${l?"scale-110 brightness-150":"animate-pulse cursor-pointer"}`,style:{left:`${d.x}%`,top:`${d.y}%`,transform:"translate(-50%, -50%)"},children:""})]})]})},nF=(t,e)=>{if(e)return e.find(s=>{var a;if(!s)return!1;const n=Object.keys(Oe).find(l=>s.id===l||s.id.startsWith(l+"_")),i=n?Oe[n]:null;return(a=i==null?void 0:i.relevantActions)==null?void 0:a.includes(t)})},L_=({onComplete:t,equipment:e=[],speedMultiplier:s=1,possibleYield:n=10,resourceName:i="Korn"})=>{const[a,l]=_.useState(0),[o,c]=_.useState(0),[u,d]=_.useState(!1),[f,h]=_.useState(!1),[m,v]=_.useState(!1),x=()=>{u||m||l(b=>{var p;const g=b+2*s;if(g>=100){const y=nF("WORK",e),k=((p=y==null?void 0:y.stats)==null?void 0:p.yieldBonus)||0,N=Math.ceil(n/5*1.25),S=Math.ceil(k/5*1.25);return h(!0),v(!0),Pe.spawnFloatingText(`+ ${N} ${i} ${S>0?`(+${S})`:""} `,50,40,"text-amber-400 font-black text-xl"),Pe.spawnParticles(50,50,"bg-emerald-400"),setTimeout(()=>{h(!1),v(!1)},100),c(w=>(w+1>=5&&(d(!0),setTimeout(()=>t(1),800)),w+1)),0}return g})};return r.jsxs("div",{onMouseMove:x,className:`p-8 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden ${f?"animate-shake":""} `,style:{backgroundImage:'url("/images/minigames/agriculture_bg.png")',backgroundSize:"cover"},children:[r.jsx("div",{className:`absolute inset-0 bg-black/50 z-0 transition-all duration-75 ${m?"bg-emerald-900/40 mix-blend-hard-light":""}`}),r.jsxs("div",{className:`relative z-10 w-full flex flex-col items-center transition-all duration-75 ${m?"scale-105 brightness-150 contrast-125":""}`,children:[r.jsx("h2",{className:"text-3xl font-black text-white mb-4",children:"Scythe Sweep"}),r.jsx("div",{className:"w-full h-4 bg-white/10 rounded-full mb-8 border border-white/20 overflow-hidden",children:r.jsx("div",{className:"h-full bg-amber-400 transition-all duration-75",style:{width:`${a}% `}})}),r.jsx("div",{className:"grid grid-cols-5 gap-2",children:[...Array(5)].map((b,g)=>r.jsx("div",{className:`w-8 h-8 rounded-lg border-2 ${o>g?"bg-amber-500 border-amber-300":"border-white/20"} `},g))}),r.jsx("div",{className:"mt-8 text-slate-400 text-sm font-bold uppercase tracking-widest animate-pulse",children:"Beveg musen raskt frem og tilbake!"})]})]})},P_=({onComplete:t,speedMultiplier:e=1,variant:s="water"})=>{const[n,i]=_.useState(0),[a,l]=_.useState(0),[o,c]=_.useState(!1),[u,d]=_.useState(50),[f,h]=_.useState(1),[m,v]=_.useState(!1);_.useEffect(()=>{if(o)return;const b=setInterval(()=>{i(g=>{let p=3/e,y=g+p*f;return y>100?(h(-1),100):y<0?(h(1),0):y})},16);return()=>clearInterval(b)},[f,o,e]);const x=()=>{if(Math.abs(n-u)<10)v(!0),setTimeout(()=>v(!1),200),l(g=>{const p=s==="land"?"FANGST! ":"NAPP! ";return Pe.spawnFloatingText(p,50,40,"text-emerald-400 font-black text-3xl"),Pe.spawnParticles(50,50,"bg-emerald-400"),g+1>=3&&(c(!0),setTimeout(()=>t(1),1e3)),g+1}),d(20+Math.random()*60);else{v(!0),setTimeout(()=>v(!1),200);const g=s==="land"?"BOM... ":"INGENTING... ";Pe.spawnFloatingText(g,50,40,"text-rose-400 font-bold text-xl")}};return r.jsxs("div",{className:`p-12 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden transition-transform ${m?"animate-shake":""}`,style:{backgroundImage:s==="land"?'url("/images/textures/bark.png")':'url("/images/minigames/foraging_bg.png")',backgroundColor:s==="land"?"#2f3e28":"#0c4a6e",backgroundSize:"cover"},children:[r.jsx("div",{className:"absolute inset-0 bg-black/70 z-0"}),r.jsx("h2",{className:"relative z-10 text-4xl font-black text-white mb-12 tracking-tighter uppercase italic drop-shadow-lg",children:s==="land"?"Fellefangst ":"Snarefiske "}),r.jsxs("div",{className:"relative z-10 w-full max-w-sm h-12 bg-white/5 rounded-full border border-white/10 mb-12 shadow-inner overflow-hidden",children:[r.jsx("div",{className:"absolute inset-y-0 w-20 bg-amber-500/40 border-x-2 border-amber-500/50 rounded-lg blur-[1px]",style:{left:`${u}%`,transform:"translateX(-50%)"}}),r.jsx("div",{className:"absolute inset-y-0 w-1 bg-white shadow-[0_0_15px_white] z-20",style:{left:`${n}%`}})]}),r.jsx("div",{className:"relative z-10 flex gap-4 mb-12",children:[...Array(3)].map((b,g)=>r.jsx("div",{className:`w-16 h-16 rounded-2xl flex items-center justify-center text-3xl border-2 transition-all duration-300 ${a>g?"bg-emerald-500 border-emerald-300 scale-110 shadow-[0_0_20px_rgba(16,185,129,0.5)]":"bg-white/5 border-white/10 opacity-30 shadow-inner"} `,children:a>g?s==="land"?"":"":""},g))}),r.jsx("button",{onClick:x,className:"relative z-10 w-full max-w-md bg-sky-600 hover:bg-sky-500 text-white py-8 rounded-[2rem] font-black text-3xl shadow-2xl active:scale-95 transition-all uppercase tracking-widest border-b-8 border-sky-800 active:border-b-0 active:translate-y-2 group",children:r.jsx("span",{className:"drop-shadow-md group-hover:scale-105 inline-block transition-transform",children:s==="land"?"SJEKK FELLA! ":"HAL INN! "})})]})},iF=({onComplete:t,speedMultiplier:e=1})=>{const[s,n]=_.useState("right"),[i,a]=_.useState(0),[l,o]=_.useState(!1),[c,u]=_.useState(null),d=f=>{l||f!==s&&(n(f),a(h=>{const m=h+5*e;return m>=100?(o(!0),setTimeout(()=>t(1),1e3),100):m}),u(f==="left"?"":""),setTimeout(()=>u(null),200))};return _.useEffect(()=>{const f=h=>{(h.key==="ArrowLeft"||h.key==="a"||h.key==="A")&&d("left"),(h.key==="ArrowRight"||h.key==="d"||h.key==="D")&&d("right")};return window.addEventListener("keydown",f),()=>window.removeEventListener("keydown",f)},[s,l]),r.jsxs("div",{className:"p-12 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden",style:{backgroundImage:'url("/images/minigames/weavery_bg.png")',backgroundSize:"cover",backgroundColor:"#1e1b4b"},children:[r.jsx("div",{className:"absolute inset-0 bg-black/70 z-0"}),r.jsx("h2",{className:"relative z-10 text-4xl font-black text-white mb-8 tracking-tighter uppercase italic",children:"Veveri: Vevstol "}),r.jsxs("div",{className:`relative z-10 w-full max-w-lg aspect-video bg-slate-900/50 border-4 rounded-3xl p-8 mb-12 flex flex-col justify-between overflow-hidden transition-all ${c?"brightness-125":""} ${s==="left"?"border-indigo-500/50 shadow-[inset_20px_0_40px_rgba(99,102,241,0.1)]":"border-emerald-500/50 shadow-[inset_-20px_0_40px_rgba(16,185,129,0.1)]"} `,children:[r.jsxs("div",{className:"flex justify-between items-center mb-8 relative h-32",children:[r.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 text-6xl transition-all duration-300 ease-out z-20",style:{left:s==="left"?"0%":"calc(100% - 4rem)",transform:`translateY(-50%) rotate(${s==="left"?"0deg":"180deg"})`},children:""}),r.jsx("div",{className:`text-6xl transition-all duration-500 ${s==="left"?"scale-110 opacity-100 rotate-12":"scale-75 opacity-20"} `,children:""}),r.jsx("div",{className:"absolute inset-x-0 h-1 bg-white/20 top-1/2 -translate-y-1/2 pointer-events-none"}),r.jsx("div",{className:`text-6xl transition-all duration-500 ${s==="right"?"scale-110 opacity-100 -rotate-12":"scale-75 opacity-20"} `,children:""})]}),r.jsx("div",{className:"text-sm font-black text-indigo-300 uppercase tracking-[0.3em] h-8 animate-pulse",children:c||"Veksle mellom Venstre / Hyre"})]}),r.jsxs("div",{className:"relative z-10 flex gap-12 mb-8",children:[r.jsx("button",{onClick:()=>d("left"),className:`w-28 h-28 rounded-[2rem] flex items-center justify-center text-4xl border-4 transition-all active:scale-90 ${s==="right"?"bg-indigo-600 border-indigo-400 scale-110 shadow-[0_0_30px_rgba(99,102,241,0.5)]":"bg-white/5 border-white/10 opacity-30 shadow-inner"} `,children:""}),r.jsx("button",{onClick:()=>d("right"),className:`w-28 h-28 rounded-[2rem] flex items-center justify-center text-4xl border-4 transition-all active:scale-90 ${s==="left"?"bg-emerald-600 border-emerald-400 scale-110 shadow-[0_0_30px_rgba(16,185,129,0.5)]":"bg-white/5 border-white/10 opacity-30 shadow-inner"} `,children:""})]}),r.jsx("div",{className:"relative z-10 w-full max-w-sm h-4 bg-white/10 rounded-full border border-white/10 overflow-hidden",children:r.jsx("div",{className:"h-full bg-indigo-500 transition-all duration-300",style:{width:`${i}% `}})})]})},aF=({onComplete:t,speedMultiplier:e=1})=>{var v;const[s,n]=_.useState([]),[i,a]=_.useState([]),[l,o]=_.useState(0),[c,u]=_.useState(!1),[d,f]=_.useState(null),h=[{id:"red",icon:"",label:"Rdurt"},{id:"blue",icon:"",label:"Blbr"},{id:"green",icon:"",label:"Grnnmose"},{id:"yellow",icon:"",label:"Gulrot"}];_.useEffect(()=>{const x=[];for(let b=0;b<5;b++)x.push(h[Math.floor(Math.random()*h.length)].id);n(x)},[]);const m=x=>{if(!(c||d))if(x===s[l]){const b=l+1;a(g=>[...g,x]),o(b),f("RIKTIG! "),setTimeout(()=>f(null),500),b>=s.length&&(u(!0),setTimeout(()=>t(1),1e3))}else f("FEIL... "),o(0),a([]),setTimeout(()=>f(null),1e3)};return r.jsxs("div",{className:"p-12 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden",style:{backgroundImage:'url("/images/minigames/apothecary_bg.png")',backgroundSize:"cover",backgroundColor:"#2e1065"},children:[r.jsx("div",{className:"absolute inset-0 bg-black/70 z-0"}),r.jsx("h2",{className:"relative z-10 text-4xl font-black text-white mb-8 tracking-tighter uppercase italic",children:"Apoteker: Brygging "}),r.jsx("div",{className:"relative z-10 mb-12 flex gap-4 h-24 items-center",children:s.map((x,b)=>{var g;return r.jsx("div",{className:`w-16 h-16 rounded-2xl flex items-center justify-center text-3xl transition-all border-2 border-white/10 ${l>b?"opacity-10 scale-90":"bg-black/40 scale-100"} `,children:(g=h.find(p=>p.id===x))==null?void 0:g.icon},b)})}),d&&r.jsx("div",{className:`relative z-10 text-3xl font-black mb-8 animate-in zoom-in ${d.includes("FEIL")?"text-rose-500":"text-emerald-400"} `,children:d}),r.jsxs("div",{className:"relative z-10 w-48 h-64 bg-white/5 border-4 border-white/20 rounded-b-[4rem] rounded-t-3xl overflow-hidden mb-12 shadow-inner",children:[r.jsx("div",{className:"absolute bottom-0 inset-x-0 transition-all duration-1000 ease-out",style:{height:`${l/s.length*100}%`,backgroundColor:l>0?(v=h.find(x=>x.id===s[l-1]))==null?void 0:v.id:"transparent",opacity:.6},children:r.jsx("div",{className:"absolute top-0 inset-x-0 h-4 bg-white/20 animate-pulse pointer-events-none"})}),r.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-6xl opacity-20 transition-transform duration-500 scale-125",children:""})]}),r.jsx("div",{className:"relative z-10 grid grid-cols-2 gap-4",children:h.map(x=>r.jsxs("button",{onClick:()=>m(x.id),className:`w-32 h-32 bg-slate-900/80 border-2 rounded-3xl flex flex-col items-center justify-center transition-all active:scale-90 shadow-xl group ${d==="RIKTIG! "&&s[l-1]===x.id?"border-emerald-500 scale-105 shadow-emerald-500/20":"border-white/20 hover:border-white/40"} `,children:[r.jsx("span",{className:"text-4xl mb-2 group-hover:scale-110 transition-transform",children:x.icon}),r.jsx("span",{className:"font-bold text-white uppercase text-sm",children:x.label})]},x.id))})]})},rF=({onComplete:t,speedMultiplier:e=1})=>{const[s,n]=_.useState(0),[i,a]=_.useState(0),[l,o]=_.useState(!0),[c,u]=_.useState(0),[d,f]=_.useState(!1),[h,m]=_.useState(1);_.useEffect(()=>{if(d)return;const x=setInterval(()=>{u(b=>{let g=b+h*3*e;return g>=100?(m(-1),100):g<=0?(m(1),0):g})},16);return()=>clearInterval(x)},[h,d,e]);const v=_.useCallback(x=>{if(d)return;const b=Math.abs(c-50),g=b<15,p=b>35;let y=0,k="",N="";g?(y=1,k="PERFEKT!",N="text-amber-400"):p?(y=.1,k="BOM!",N="text-rose-400"):(y=.5,k="BRA!",N="text-emerald-400");const S="clientX"in x?x.clientX:x.touches[0].clientX,w="clientY"in x?x.clientY:x.touches[0].clientY;Pe.spawnFloatingText(k,S,w-40,N),y>.1&&Pe.spawnParticles(S,w,y===1?"bg-amber-400":"bg-emerald-400"),a(j=>j+1),o(!l);const E=y*10;n(j=>{const A=j+E;return A>=100?(f(!0),Pe.spawnFloatingText("PLANKER FERDIG! ",S,w-100,"text-emerald-400 text-2xl font-black"),setTimeout(()=>t(1),1e3),100):A})},[c,d,l,t]);return r.jsxs("div",{className:"p-12 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden",children:[r.jsxs("div",{className:"absolute inset-0 bg-slate-950 z-0",children:[r.jsx("div",{className:"absolute inset-0 opacity-20 bg-[url('/images/textures/wood_pattern.png')] bg-repeat"}),r.jsx("div",{className:"absolute inset-x-0 bottom-0 h-32 bg-gradient-to-t from-indigo-500/10 to-transparent"})]}),r.jsxs("div",{className:"relative z-10 w-full mb-12",children:[r.jsx("h2",{className:"text-5xl font-black text-white uppercase tracking-tighter mb-2 italic drop-shadow-[0_0_20px_rgba(255,255,255,0.2)]",children:"Saging"}),r.jsx("p",{className:"text-slate-400 font-bold uppercase tracking-[0.3em] text-xs",children:"Pull og Push i takt for perfekte planker"})]}),r.jsxs("div",{className:"relative z-10 w-full max-w-2xl h-64 bg-slate-900/50 rounded-[3rem] border border-white/5 shadow-2xl overflow-hidden flex items-center justify-center group cursor-pointer",onClick:v,children:[r.jsx("div",{className:"absolute inset-y-0 left-0 bg-indigo-500/20 transition-all duration-500 z-0",style:{width:`${s}%`}}),r.jsxs("div",{className:"relative w-4/5 h-16 bg-[#3d2b1f] rounded-lg border-2 border-[#2a1d15] shadow-2xl flex items-center",children:[r.jsx("div",{className:"absolute inset-0 opacity-30 bg-[url('/images/textures/bark.png')] bg-cover mix-blend-overlay"}),r.jsx("div",{className:`absolute top-1/2 left-1/2 -translate-y-1/2 -translate-x-1/2 transition-transform duration-300 ${l?"-rotate-12 translate-x-4":"rotate-12 -translate-x-4"}`,children:r.jsx("div",{className:"text-6xl filter drop-shadow-[0_0_15px_rgba(255,255,255,0.3)]",children:""})}),r.jsxs("div",{className:"absolute bottom-0 left-1/2 -translate-x-1/2 flex gap-1 opacity-40",children:[r.jsx("div",{className:"w-1 h-1 bg-amber-200 rounded-full animate-ping"}),r.jsx("div",{className:"w-1 h-1 bg-amber-400 rounded-full animate-ping delay-75"}),r.jsx("div",{className:"w-1 h-1 bg-amber-100 rounded-full animate-ping delay-150"})]})]})]}),r.jsxs("div",{className:"relative z-10 mt-12 w-full max-w-md h-12 bg-black/40 rounded-full border border-white/10 p-1 flex items-center shadow-inner",children:[r.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 w-1/4 h-3/4 bg-amber-500/20 blur-sm rounded-full"}),r.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 w-[2px] h-full bg-amber-500/50"}),r.jsx("div",{className:"absolute w-8 h-8 bg-white rounded-full shadow-[0_0_20px_white] flex items-center justify-center transition-all duration-16 ease-linear",style:{left:`${c}%`,transform:"translateX(-50%)"},children:r.jsx("div",{className:"w-4 h-4 bg-indigo-500 rounded-full animate-pulse"})})]}),r.jsxs("div",{className:"relative z-10 mt-8",children:[r.jsxs("div",{className:"text-3xl font-black text-indigo-400 italic",children:[s.toFixed(0),"%"]}),r.jsxs("div",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mt-2",children:["Stroke: ",i]})]}),r.jsx("div",{className:"absolute inset-0 z-20 cursor-pointer",onClick:v})]})},lF=({onComplete:t,speedMultiplier:e=1})=>{const s=_.useRef(20),n=_.useRef(0),i=_.useRef(0),a=_.useRef({min:60,max:85}),l=.05*e,o=3.5,[c,u]=_.useState("playing"),[d,f]=_.useState(0),h=_.useRef(),m=_.useRef(),v=_.useCallback(b=>{if(c==="playing"){if(m.current!==void 0){n.current-=l,s.current+=n.current,s.current<0?(s.current=0,n.current=0):s.current>100&&(s.current=100,n.current=-n.current*.5);const g=s.current>=a.current.min&&s.current<=a.current.max;if(g?i.current+=.15*e:i.current=Math.max(0,i.current-.05),i.current>=100){u("won"),t(1);return}g?Math.random()>.8?f(1):f(0):s.current>90?f(3):f(0)}m.current=b,h.current=requestAnimationFrame(v)}},[c,t,e,l]);_.useEffect(()=>(h.current=requestAnimationFrame(v),()=>{h.current&&cancelAnimationFrame(h.current)}),[v]);const x=_.useCallback(()=>{c==="playing"&&(n.current+=o,n.current=Math.min(n.current,8))},[c,o]);return{heatRef:s,progressRef:i,targetRange:a.current,gameState:c,shakeIntensity:d,pump:x}},oF=({heatRef:t,targetRange:e})=>{const s=_.useRef(null),n=_.useRef(null);return _.useEffect(()=>{let i;const a=()=>{const l=t.current;s.current&&(s.current.style.height=`${l}%`,l>90?s.current.style.filter=`hue-rotate(${Math.sin(Date.now()/50)*10}deg) brightness(1.2)`:s.current.style.filter="none"),n.current&&(n.current.style.opacity=`${l/100}`),i=requestAnimationFrame(a)};return i=requestAnimationFrame(a),()=>cancelAnimationFrame(i)},[t]),r.jsxs("div",{className:"relative w-24 h-96 bg-slate-900 rounded-full border-4 border-slate-700 shadow-2xl overflow-hidden backdrop-blur-sm",children:[r.jsx("div",{className:"absolute inset-0 opacity-20 flex flex-col justify-between py-4 px-2",children:[...Array(10)].map((i,a)=>r.jsx("div",{className:"w-full h-px bg-white"},a))}),r.jsx("div",{className:"absolute w-full bg-green-500/20 border-y-2 border-green-500/50 z-10",style:{bottom:`${e.min}%`,height:`${e.max-e.min}%`},children:r.jsx("div",{className:"w-full h-full animate-pulse bg-green-400/10"})}),r.jsx("div",{className:"absolute bottom-0 w-full px-2 pb-2 transition-transform duration-75 ease-out z-20 h-full flex items-end pointer-events-none",children:r.jsx("div",{ref:s,className:"w-full rounded-b-full rounded-t-sm bg-gradient-to-t from-red-900 via-orange-600 to-yellow-300 shadow-[0_0_20px_rgba(255,165,0,0.6)]",style:{height:"0%",transition:"height 0.1s cubic-bezier(0.2, 0.8, 0.2, 1)"}})}),r.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/10 to-transparent pointer-events-none z-30 rounded-full"}),r.jsx("div",{ref:n,className:"absolute inset-0 z-0 bg-orange-500/30 blur-xl pointer-events-none transition-opacity duration-300"})]})},cF=({onPump:t})=>{const[e,s]=_.useState(!1),n=()=>{s(!0),t()},i=()=>{s(!1)};return r.jsxs("button",{onPointerDown:n,onPointerUp:i,onPointerLeave:i,className:`
                relative group
                w-48 h-32 
                flex items-center justify-center
                transition-all duration-75 ease-out
                ${e?"scale-95":"scale-100 hover:scale-[1.02]"}
            `,children:[r.jsxs("div",{className:"absolute inset-0 bg-[#5d4037] rounded-xl shadow-[0_10px_0_#3e2723] active:shadow-none active:translate-y-[10px] transition-all duration-75 overflow-hidden border-2 border-[#8d6e63]",children:[r.jsx("div",{className:"absolute inset-0 opacity-20 bg-[radial-gradient(circle,_transparent_20%,_#000_120%)]"}),r.jsxs("div",{className:"w-full h-full flex flex-col justify-between py-2 px-4 opacity-50",children:[r.jsx("div",{className:"h-0.5 bg-black/40 shadow-sm"}),r.jsx("div",{className:"h-0.5 bg-black/40 shadow-sm"}),r.jsx("div",{className:"h-0.5 bg-black/40 shadow-sm"}),r.jsx("div",{className:"h-0.5 bg-black/40 shadow-sm"})]})]}),r.jsx("div",{className:"relative z-10 text-orange-100 font-black uppercase text-2xl tracking-widest drop-shadow-md select-none pointer-events-none",children:"PUMP"})]})},uF=({onComplete:t,speedMultiplier:e=1})=>{const{heatRef:s,progressRef:n,targetRange:i,shakeIntensity:a,gameState:l,pump:o}=lF({onComplete:t,speedMultiplier:e}),c=_.useRef(null),u=_.useRef(null);_.useEffect(()=>{let f;const h=()=>{if(c.current)if(a>0){const m=(Math.random()-.5)*a*4,v=(Math.random()-.5)*a*4;c.current.style.transform=`translate(${m}px, ${v}px)`}else c.current.style.transform="none";if(u.current){const m=n.current;u.current.style.background=`conic-gradient(#f97316 ${m}%, transparent 0)`;const v=u.current.querySelector('[data-role="progress-text"]');v&&(v.innerText=`${Math.floor(m)}%`)}f=requestAnimationFrame(h)};return f=requestAnimationFrame(h),()=>cancelAnimationFrame(f)},[a,n]);const d=()=>{if(o(),c.current){const f=c.current.getBoundingClientRect();Pe.spawnParticles(f.left+f.width/2,f.bottom-100,"bg-orange-200")}};return r.jsxs("div",{ref:c,className:"p-8 min-h-[600px] w-full relative flex flex-col items-center justify-center overflow-hidden select-none",style:{backgroundImage:'url("/images/minigames/smeltery_bg.png")',backgroundSize:"cover",backgroundColor:"#1a0f0a"},children:[r.jsx("div",{className:"absolute inset-0 bg-black/70 z-0 backdrop-blur-[2px]"}),r.jsxs("div",{className:"relative z-10 text-center mb-8",children:[r.jsx("h2",{className:"text-5xl font-black text-transparent bg-clip-text bg-gradient-to-br from-orange-400 to-red-600 uppercase tracking-tighter drop-shadow-2xl filter contrast-125",children:"Smelting"}),r.jsx("div",{className:"text-orange-200/80 font-bold uppercase tracking-[0.2em] text-xs mt-2",children:"Hold varmen i sonen"})]}),r.jsxs("div",{className:"relative z-10 flex gap-12 items-end",children:[r.jsxs("div",{className:"flex flex-col items-center gap-2",children:[r.jsx(oF,{heatRef:s,targetRange:i}),r.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest",children:"Heat"})]}),r.jsxs("div",{className:"flex flex-col items-center gap-4 mb-4",children:[r.jsxs("div",{className:"relative w-32 h-32 rounded-full bg-slate-900 border-4 border-slate-700 shadow-xl flex items-center justify-center",children:[r.jsx("div",{ref:u,className:"absolute inset-0 rounded-full opacity-80",style:{background:"conic-gradient(#f97316 0%, transparent 0)"}}),r.jsx("div",{className:"absolute inset-2 bg-slate-900 rounded-full flex items-center justify-center",children:r.jsx("span",{"data-role":"progress-text",className:"text-3xl font-black text-white",children:"0%"})})]}),r.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest",children:"Fremgang"})]})]}),r.jsx("div",{className:"relative z-10 mt-12",children:r.jsx(cF,{onPump:d})}),l==="won"&&r.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-md animate-in fade-in duration-300",children:r.jsxs("div",{className:"flex flex-col items-center gap-4 animate-in zoom-in-50 duration-500",children:[r.jsx("div",{className:"text-7xl",children:""}),r.jsx("div",{className:"text-6xl font-black text-white tracking-tighter drop-shadow-[0_0_30px_rgba(249,115,22,0.8)]",children:"PERFEKT!"})]})})]})},B_={ride_easy:{speed:.012,spawnRate:80,targetDistance:8,label:"Engelskogen",colors:{sky:"#1e293b",path:"#451a03"},xpMult:1},ride_medium:{speed:.018,spawnRate:60,targetDistance:12,label:"Fjellpasset",colors:{sky:"#0f172a",path:"#262626"},xpMult:1.5},ride_hard:{speed:.025,spawnRate:45,targetDistance:15,label:"Ulvestien",colors:{sky:"#020617",path:"#171717"},xpMult:2.2}},dF={tree:"",house:"",cow:"",rock:"",bush:""},fF=({onComplete:t,speedMultiplier:e=1,levelId:s="ride_easy",level:n=1,horse:i})=>{const a=B_[s]||B_.ride_easy,l=1+(n-1)*.15,o=1-(n-1)*.1,c=1+(n-1)*.2,u=_.useRef(null),[d,f]=_.useState(!1),[h,m]=_.useState(0),[v,x]=_.useState(0),b=_.useRef({lane:1,targetLane:1,cameraTilt:0,isJumping:!1,jumpTime:0,obstacles:[],sideObjects:[],lastSpawn:0,lastSideSpawn:0,distance:0,speed:a.speed*e*l,gameOver:!1,bobAmt:0,ticks:0});return _.useEffect(()=>{const g=p=>{b.current.gameOver||(p.key==="a"||p.key==="ArrowLeft"?b.current.targetLane=Math.max(0,b.current.targetLane-1):p.key==="d"||p.key==="ArrowRight"?b.current.targetLane=Math.min(2,b.current.targetLane+1):p.code==="Space"&&!b.current.isJumping&&(b.current.isJumping=!0,b.current.jumpTime=0,ut.playSfx("jump")))};return window.addEventListener("keydown",g),()=>window.removeEventListener("keydown",g)},[]),_.useEffect(()=>{const g=u.current;if(!g)return;const p=g.getContext("2d");if(!p)return;let y;const k=()=>{if(b.current.gameOver)return;if(b.current.ticks++,b.current.distance+=b.current.speed,b.current.lane!==b.current.targetLane){const j=b.current.targetLane-b.current.lane;b.current.lane+=j*.2,Math.abs(b.current.targetLane-b.current.lane)<.01&&(b.current.lane=b.current.targetLane),b.current.cameraTilt=j*.15}else b.current.cameraTilt*=.9;if(b.current.isJumping&&(b.current.jumpTime+=.05,b.current.jumpTime>=Math.PI&&(b.current.isJumping=!1,b.current.jumpTime=0)),b.current.bobAmt=Math.sin(b.current.ticks*.2)*5,b.current.ticks-b.current.lastSpawn>a.spawnRate*o/e&&(Math.random()>.4&&b.current.obstacles.push({id:Date.now(),lane:Math.floor(Math.random()*3),z:0,type:Math.random()>.5?"log":"rock"}),b.current.lastSpawn=b.current.ticks),b.current.ticks-b.current.lastSideSpawn>15/e){const j=["tree","tree","bush","rock","house","cow"];b.current.sideObjects.push({id:Date.now(),side:Math.random()>.5?"left":"right",z:0,type:j[Math.floor(Math.random()*j.length)],offset:.2+Math.random()*.5}),b.current.lastSideSpawn=b.current.ticks}b.current.obstacles.forEach(j=>{if(j.z+=b.current.speed,j.z>.88&&j.z<.96){const A=Math.round(b.current.lane);if(j.lane===A){const O=j.type==="log",L=b.current.isJumping&&Math.sin(b.current.jumpTime)>.6;O&&L||N()}}}),b.current.sideObjects.forEach(j=>{j.z+=b.current.speed}),b.current.obstacles=b.current.obstacles.filter(j=>j.z<1.05),b.current.sideObjects=b.current.sideObjects.filter(j=>j.z<1.05);const E=b.current.distance;m(Math.floor(E*100)),E>=a.targetDistance*c&&S(1)},N=()=>{x(15),b.current.speed*=.6,Pe.spawnFloatingText("OUCH!",50,40,"text-rose-500 font-black text-3xl"),b.current.obstacles=b.current.obstacles.filter(E=>E.z<.85),setTimeout(()=>x(0),300)},S=E=>{b.current.gameOver||(b.current.gameOver=!0,f(!0),setTimeout(()=>t(E),2e3))},w=()=>{var R,D;if(!p)return;p.clearRect(0,0,g.width,g.height);const E=b.current.cameraTilt;p.save(),p.translate(g.width/2,g.height/2),p.rotate(E),p.translate(-g.width/2,-g.height/2);const j=p.createLinearGradient(0,0,0,g.height);j.addColorStop(0,a.colors.sky),j.addColorStop(.5,"#334155"),j.addColorStop(.5,"#064e3b"),j.addColorStop(1,"#065f46"),p.fillStyle=j,p.fillRect(-g.width*.5,0,g.width*2,g.height),p.beginPath(),p.moveTo(g.width*.45,g.height*.5),p.lineTo(g.width*.55,g.height*.5),p.lineTo(g.width*1.3,g.height),p.lineTo(g.width*-.3,g.height),p.closePath(),p.fillStyle=a.colors.path,p.fill(),p.strokeStyle="rgba(255,255,255,0.15)",p.setLineDash([20,10]),p.lineWidth=4,[.33,.66].forEach(I=>{p.beginPath(),p.moveTo(g.width*(.45+I*.1),g.height*.5),p.lineTo(g.width*(-.3+I*1.6),g.height),p.stroke()}),p.setLineDash([]),b.current.sideObjects.forEach(I=>{const F=I.z*I.z,P=g.height*.5,B=P+(g.height-P)*F,J=g.width*.1+g.width*1.6*F,se=J*I.offset+J*.1,ie=g.width*.5+(I.side==="left"?-se:se),Ee=20+200*F;p.save(),p.translate(ie,B),p.font=`${Ee}px serif`,p.textAlign="center",p.textBaseline="bottom",p.globalAlpha=I.z>.95?Math.max(0,1-(I.z-.95)*10):1,p.fillText(dF[I.type]||"",0,0),p.restore()}),b.current.obstacles.forEach(I=>{const F=I.z*I.z,P=g.height*.5,B=P+(g.height-P)*F,J=g.width*.1+g.width*1.6*F,se=g.width*.5+(I.lane-1)*(J/3),ie=30+150*F,Ee=I.z>.95?Math.max(0,1-(I.z-.95)*10):1;p.save(),p.globalAlpha=Ee,p.translate(se,B),I.type==="log"?(p.fillStyle="#78350f",p.fillRect(-ie/2,-ie/6,ie,ie/3),p.strokeStyle="#451a03",p.lineWidth=2,p.strokeRect(-ie/2,-ie/6,ie,ie/3)):(p.fillStyle="#475569",p.beginPath(),p.arc(0,0,ie/2,0,Math.PI*2),p.fill(),p.strokeStyle="#1e293b",p.stroke()),p.restore()}),p.restore();const A=b.current.lane,O=g.width*.5+(A-1)*(g.width*.45);p.save(),p.fillStyle="rgba(0,0,0,0.3)",p.beginPath(),p.ellipse(O,g.height-40,60,20,0,0,Math.PI*2),p.fill(),p.restore(),p.save(),p.strokeStyle="rgba(255,255,255,0.1)",p.lineWidth=2;for(let I=0;I<10;I++){const F=(b.current.ticks*20+I*200)%g.width,P=I*77%g.height;p.beginPath(),p.moveTo(F,P),p.lineTo(F+50,P),p.stroke()}p.restore();const L=b.current.bobAmt,Y=b.current.isJumping?-Math.sin(b.current.jumpTime)*120:0,W=i!=null&&i.skinId&&{brown:"#8B4513",white:"#E2E8F0",black:"#1A202C",golden:"#F6E05E",chestnut:"#7C2D12",grey:"#94A3B8"}[i.skinId]||"#8B4513";p.save(),p.translate(O+(v>0?(Math.random()-.5)*v:0),g.height-110+L+Y),p.rotate(E*.5),p.fillStyle=W,p.beginPath(),p.ellipse(0,150,80,200,0,0,Math.PI*2),p.fill(),p.beginPath(),p.ellipse(0,0,40,70,0,0,Math.PI*2),p.fill(),p.fillStyle=(i==null?void 0:i.skinId)==="black"||(i==null?void 0:i.skinId)==="chestnut"?"#020617":"#451a03",p.beginPath(),p.ellipse(0,40,30,40,0,0,Math.PI*2),p.fill(),p.fillStyle=W,p.beginPath(),p.moveTo(-30,-50),p.lineTo(-40,-90),p.lineTo(-10,-60),p.fill(),p.beginPath(),p.moveTo(30,-50),p.lineTo(40,-90),p.lineTo(10,-60),p.fill();const H=(i==null?void 0:i.maneColor)||"#1e1b4b";if(H==="rainbow"){const I=p.createLinearGradient(-10,-60,20,100);I.addColorStop(0,"#f43f5e"),I.addColorStop(.3,"#fbbf24"),I.addColorStop(.6,"#10b981"),I.addColorStop(1,"#6366f1"),p.fillStyle=I}else p.fillStyle=H;if(p.fillRect(-10,-60,20,100),i!=null&&i.hatId&&(i==null?void 0:i.hatId)!=="none"){const I={straw_hat:"",cowboy_hat:"",crown:"",viking:"",tophat:""}[i.hatId];I&&(p.font="60px serif",p.textAlign="center",p.fillText(I,0,-60))}p.restore();const M=b.current.distance/(a.targetDistance*c),U=g.width*.6,C=(g.width-U)/2,T=20;p.fillStyle="rgba(0,0,0,0.5)",(R=p.roundRect)==null||R.call(p,C,T,U,10,5),p.fill(),p.fillStyle="#fbbf24",(D=p.roundRect)==null||D.call(p,C,T,U*Math.min(1,M),10,5),p.fill(),p.fillStyle="white",p.font="bold 12px Inter",p.textAlign="center",p.fillText(a.label.toUpperCase()+` - NIV ${n}`,g.width/2,T+25),k(),y=requestAnimationFrame(w)};return w(),()=>cancelAnimationFrame(y)},[e]),r.jsxs("div",{className:"relative w-full h-[600px] bg-slate-950 overflow-hidden flex flex-col items-center justify-center",children:[r.jsx("canvas",{ref:u,width:800,height:600,className:"w-full h-full object-cover"}),r.jsxs("div",{className:"absolute inset-0 pointer-events-none flex flex-col items-center justify-between p-12",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("h2",{className:"text-4xl font-black text-white italic tracking-tighter uppercase drop-shadow-[0_0_10px_rgba(0,0,0,0.5)]",children:"Galopp!"}),r.jsx("p",{className:"text-amber-400 font-bold uppercase tracking-widest text-sm",children:"Bruk A/D for  bytte bane, SPACE for  hoppe"})]}),d&&r.jsxs("div",{className:"bg-slate-950/80 backdrop-blur-xl p-12 rounded-[3rem] border-2 border-amber-500 animate-in zoom-in duration-300",children:[r.jsx("div",{className:"text-6xl mb-4",children:""}),r.jsx("h3",{className:"text-5xl font-black text-white italic mb-2",children:"RITT FULLFRT!"}),r.jsxs("p",{className:"text-xl text-slate-400 font-bold uppercase",children:["Du red ",h," meter"]})]})]}),r.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-20",children:r.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[radial-gradient(circle_at_center,transparent_0%,rgba(255,255,255,0.1)_100%)]"})})]})},U_=({onComplete:t,speedMultiplier:e=1})=>{const[s,n]=_.useState(0),[i,a]=_.useState(5),[l,o]=_.useState(!1),[c,u]=_.useState(50),[d,f]=_.useState(50),h=_.useRef(0),m=_.useRef(0),[v,x]=_.useState({x:50,y:50});_.useEffect(()=>{if(l)return;const g=()=>{h.current+=.02*e;const p=Math.sin(h.current)*4+Math.cos(h.current*2.3)*2,y=Math.cos(h.current*.8)*3+Math.sin(h.current*1.5)*1.5;u(50+p),f(50+y),m.current=requestAnimationFrame(g)};return m.current=requestAnimationFrame(g),()=>cancelAnimationFrame(m.current)},[l,e]);const b=()=>{if(l||i<=0)return;const g=c-v.x,p=d-v.y,y=Math.sqrt(g*g+p*p);let k=0,N="BOM!",S="text-rose-500";y<3?(k=50,N="BULLSEYE! ",S="text-amber-400",Pe.spawnParticles(50,50,"bg-amber-400")):y<8?(k=20,N="TREFF!",S="text-emerald-400",Pe.spawnParticles(50,50,"bg-white")):y<15&&(k=5,N="KANTEN...",S="text-slate-400"),Pe.spawnFloatingText(N,50,40,S),n(w=>w+k),a(w=>{const E=w-1;if(E<=0){o(!0);let j=.5;s+k>=100?j=1.2:s+k>=50?j=1:j=.8,setTimeout(()=>t(j),2e3)}else x({x:45+Math.random()*10,y:45+Math.random()*10});return E})};return r.jsxs("div",{onClick:b,className:"relative w-full h-[600px] overflow-hidden bg-slate-900 cursor-crosshair select-none group",style:{backgroundImage:'url("/images/minigames/forestry_bg.png")',backgroundSize:"cover",backgroundPosition:"center 30%"},children:[r.jsx("div",{className:"absolute inset-0 bg-radial-gradient from-transparent to-black/60 pointer-events-none"}),r.jsx("div",{className:"absolute w-32 h-32 rounded-full bg-white border-4 border-slate-800 shadow-2xl flex items-center justify-center transition-all duration-500",style:{left:`${v.x}%`,top:`${v.y}%`,transform:"translate(-50%, -50%) scale(0.8)"},children:r.jsx("div",{className:"w-24 h-24 rounded-full bg-rose-600 border-4 border-white flex items-center justify-center",children:r.jsx("div",{className:"w-16 h-16 rounded-full bg-white border-4 border-rose-600 flex items-center justify-center",children:r.jsx("div",{className:"w-8 h-8 rounded-full bg-rose-600 shadow-inner"})})})}),r.jsx("div",{className:"absolute pointer-events-none transition-transform duration-75 ease-out z-20",style:{left:`${c}%`,top:`${d}%`,transform:"translate(-50%, -50%)"},children:r.jsxs("div",{className:"relative w-16 h-16 opacity-80",children:[r.jsx("div",{className:"absolute top-1/2 left-0 w-full h-0.5 bg-white shadow-sm"}),r.jsx("div",{className:"absolute left-1/2 top-0 h-full w-0.5 bg-white shadow-sm"}),r.jsx("div",{className:"absolute inset-0 border-2 border-white/50 rounded-full"}),r.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-1 h-1 bg-red-500 rounded-full shadow-[0_0_10px_red]"})]})}),r.jsx("div",{className:"absolute bottom-0 right-10 w-96 h-96 pointer-events-none z-10 translate-y-10 rotate-[-10deg]",children:r.jsxs("div",{className:"w-full h-full relative",children:[r.jsx("div",{className:"absolute bottom-0 right-20 w-8 h-80 bg-stone-800 rounded-full origin-bottom rotate-12"}),r.jsx("div",{className:"absolute bottom-20 right-24 w-0.5 h-[400px] bg-white/20 rotate-12 origin-bottom border-l border-dashed border-white/30"})]})}),r.jsxs("div",{className:"absolute top-8 left-8 text-white font-black text-2xl drop-shadow-md",children:["SCORE: ",r.jsx("span",{className:"text-amber-400",children:s})]}),r.jsx("div",{className:"absolute top-8 right-8 flex gap-2",children:[...Array(5)].map((g,p)=>r.jsx("div",{className:`text-3xl transition-opacity ${p<i?"opacity-100":"opacity-20 grayscale"}`,children:""},p))}),!l&&r.jsx("div",{className:"absolute bottom-10 left-1/2 -translate-x-1/2 text-white/70 text-sm font-bold uppercase tracking-widest animate-pulse",children:"Klikk for  skyte"}),l&&r.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/80 backdrop-blur-sm z-50 animate-in fade-in run-in",children:r.jsx("h1",{className:"text-6xl font-black text-white italic uppercase tracking-tighter drop-shadow-[0_0_30px_rgba(255,255,255,0.5)]",children:s>=100?"Mesterbueskytter!":"Ferdig!"})}),r.jsx("div",{className:"absolute inset-0 bg-stone-800 -z-10"})]})},Sj=({level:t,upgrades:e=[],className:s,isMoving:n,customization:i,horseCustomization:a})=>{const l="#1e293b",o="#fbbf24",c="#94a3b8",u="#0f172a",d="#fcd34d",f=_.useMemo(()=>({chassis:(i==null?void 0:i.chassis)||"chassis_oak",wheels:(i==null?void 0:i.wheels)||(t===1?"wheels_wood":"wheels_iron"),cover:(i==null?void 0:i.cover)||"cover_canvas",lanterns:(i==null?void 0:i.lanterns)||"lantern_oil",flag:(i==null?void 0:i.flag)||"flag_none",skin:(i==null?void 0:i.skin)||"skin_ox",decor:(i==null?void 0:i.decor)||"decor_none",companion:(i==null?void 0:i.companion)||"companion_none"}),[i,t]);return r.jsxs("svg",{viewBox:"0 0 260 140",className:`${s} ${n?"animate-bounce":""}`,style:{animationDuration:"0.8s"},children:[r.jsxs("defs",{children:[r.jsxs("linearGradient",{id:"rainbowGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[r.jsx("stop",{offset:"0%",stopColor:"#ff0000"}),r.jsx("stop",{offset:"20%",stopColor:"#ffff00"}),r.jsx("stop",{offset:"40%",stopColor:"#00ff00"}),r.jsx("stop",{offset:"60%",stopColor:"#00ffff"}),r.jsx("stop",{offset:"80%",stopColor:"#0000ff"}),r.jsx("stop",{offset:"100%",stopColor:"#ff00ff"})]}),r.jsxs("filter",{id:"glow",children:[r.jsx("feGaussianBlur",{stdDeviation:"2.5",result:"coloredBlur"}),r.jsxs("feMerge",{children:[r.jsx("feMergeNode",{in:"coloredBlur"}),r.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),r.jsx("ellipse",{cx:"130",cy:"110",rx:"100",ry:"10",fill:"rgba(0,0,0,0.15)"}),(()=>{const h=t>1,m=f.wheels==="wheels_iron"?"#475569":f.wheels==="wheels_spiked"?"#334155":"#78350f",v=f.wheels==="wheels_spiked"?"#94a3b8":"#000";return h?r.jsxs("g",{children:[r.jsxs("g",{transform:"translate(60, 95)",children:[r.jsx("circle",{r:"15",fill:m,stroke:v,strokeWidth:"2"}),r.jsx("circle",{r:"4",fill:u}),f.wheels==="wheels_spiked"&&r.jsxs(r.Fragment,{children:[r.jsx("path",{d:"M 0 -17 L 3 -14 L -3 -14 Z",fill:"#94a3b8"}),r.jsx("path",{d:"M 0 17 L 3 14 L -3 14 Z",fill:"#94a3b8",transform:"rotate(180)"}),r.jsx("path",{d:"M 17 0 L 14 3 L 14 -3 Z",fill:"#94a3b8",transform:"rotate(90)"}),r.jsx("path",{d:"M -17 0 L -14 3 L -14 -3 Z",fill:"#94a3b8",transform:"rotate(-90)"})]})]}),r.jsxs("g",{transform:"translate(140, 95)",children:[r.jsx("circle",{r:"15",fill:m,stroke:v,strokeWidth:"2"}),r.jsx("circle",{r:"4",fill:u}),f.wheels==="wheels_spiked"&&r.jsxs(r.Fragment,{children:[r.jsx("path",{d:"M 0 -17 L 3 -14 L -3 -14 Z",fill:"#94a3b8"}),r.jsx("path",{d:"M 0 17 L 3 14 L -3 14 Z",fill:"#94a3b8",transform:"rotate(180)"}),r.jsx("path",{d:"M 17 0 L 14 3 L 14 -3 Z",fill:"#94a3b8",transform:"rotate(90)"}),r.jsx("path",{d:"M -17 0 L -14 3 L -14 -3 Z",fill:"#94a3b8",transform:"rotate(-90)"})]})]})]}):r.jsxs("g",{transform:"translate(100, 100)",children:[r.jsx("circle",{r:"10",fill:m,stroke:v,strokeWidth:"1.5"}),f.wheels==="wheels_spiked"&&r.jsx("path",{d:"M 0 -12 L 2 -10 L -2 -10 Z",fill:"#94a3b8"})]})})(),(()=>{const h=f.chassis==="chassis_gold"?d:f.chassis==="chassis_iron"?"#334155":l,m=f.chassis==="chassis_gold"?"#b45309":void 0;return t===1?r.jsxs("g",{children:[r.jsx("path",{d:"M 50 85 L 150 85 L 155 70 L 45 70 Z",fill:h,stroke:m}),r.jsx("rect",{x:"55",y:"60",width:"30",height:"15",fill:c,opacity:"0.5"}),r.jsx("line",{x1:"150",y1:"80",x2:"175",y2:"80",stroke:h,strokeWidth:"4"})]}):r.jsxs("g",{children:[r.jsx("rect",{x:"40",y:"55",width:"120",height:"35",rx:"2",fill:h,stroke:m,strokeWidth:m?2:0}),(t>=4||f.chassis!=="chassis_oak")&&r.jsxs("g",{children:[r.jsx("rect",{x:"40",y:"55",width:"120",height:"4",fill:f.chassis==="chassis_gold"?"#fff":"#64748b",opacity:"0.5"}),r.jsx("rect",{x:"40",y:"86",width:"120",height:"4",fill:f.chassis==="chassis_gold"?"#fff":"#64748b",opacity:"0.5"})]}),r.jsx("line",{x1:"160",y1:"90",x2:"180",y2:"85",stroke:"#334155",strokeWidth:"3"})]})})(),f.decor==="decor_shields"&&t>1&&r.jsxs("g",{transform:"translate(45, 65)",children:[r.jsx("circle",{cx:"10",cy:"10",r:"8",fill:"#ef4444",stroke:"#fff"}),r.jsx("circle",{cx:"30",cy:"10",r:"8",fill:"#3b82f6",stroke:"#fff"}),r.jsx("circle",{cx:"50",cy:"10",r:"8",fill:"#22c55e",stroke:"#fff"})]}),f.decor==="decor_flowers"&&t>1&&r.jsxs("g",{transform:"translate(45, 82)",children:[r.jsx("rect",{width:"110",height:"6",fill:"#78350f",rx:"2"}),r.jsx("circle",{cx:"20",cy:"-2",r:"3",fill:"#ec4899"}),r.jsx("circle",{cx:"40",cy:"-2",r:"3",fill:"#eab308"}),r.jsx("circle",{cx:"60",cy:"-2",r:"3",fill:"#a855f7"}),r.jsx("circle",{cx:"80",cy:"-2",r:"3",fill:"#ef4444"})]}),t>=3&&r.jsx("path",{d:"M 40 55 C 40 55 100 10 160 55 Z",fill:f.cover==="cover_stars"?"#1e1b4b":f.cover==="cover_silk"?"#f8fafc":f.cover==="cover_leather"?"#78350f":t>=5?"#1e1b4b":"#334155",stroke:u,strokeWidth:"1"}),f.cover==="cover_stars"&&t>=3&&r.jsxs("g",{clipPath:"url(#coverClip)",children:[r.jsx("circle",{cx:"80",cy:"40",r:"1",fill:"#fff"}),r.jsx("circle",{cx:"100",cy:"30",r:"1.5",fill:"#fff"}),r.jsx("circle",{cx:"120",cy:"45",r:"1",fill:"#fff"})]}),r.jsxs("g",{filter:"url(#glow)",children:[r.jsx("circle",{cx:t===1?140:160,cy:"45",r:f.lanterns==="lantern_fireflies"?4:3,fill:f.lanterns==="lantern_crystal"?"#3b82f6":f.lanterns==="lantern_fireflies"?"#84cc16":o}),f.lanterns==="lantern_fireflies"&&r.jsx(q.circle,{cx:t===1?142:162,cy:"43",r:"1",fill:"#fff",animate:{opacity:[0,1,0]}}),r.jsx("rect",{x:t===1?138:158,y:"38",width:"4",height:"8",rx:"1",fill:l})]}),f.flag!=="flag_none"&&t>=2&&r.jsxs("g",{transform:"translate(160, 55)",children:[r.jsx("line",{x1:"0",y1:"0",x2:"0",y2:"-20",stroke:"#000",strokeWidth:"1"}),f.flag==="flag_pirate"?r.jsx("path",{d:"M 0 -20 L 15 -15 L 0 -10 Z",fill:"#000"}):r.jsx("path",{d:"M 0 -20 L 15 -15 L 0 -10 Z",fill:"#ef4444"})]}),f.companion==="companion_dog"&&r.jsxs("g",{transform:"translate(60, 55)",children:[r.jsx("path",{d:"M 0 0 Q 5 -10 10 0 Z",fill:"#d97706"}),r.jsx("circle",{cx:"5",cy:"-5",r:"3",fill:"#d97706"})]}),f.companion==="companion_cat"&&r.jsxs("g",{transform:`translate(100, ${t>=3?"15":"55"})`,children:[r.jsx("path",{d:"M 0 0 Q 3 -8 6 0 Z",fill:"#000"}),r.jsx("circle",{cx:"3",cy:"-4",r:"2.5",fill:"#000"}),r.jsx("path",{d:"M 3 -4 L 1 -7 M 3 -4 L 5 -7",stroke:"#000",strokeWidth:"0.5"})]}),t>=1&&r.jsx("g",{transform:"translate(160, 35) scale(0.4)",children:(()=>{let h="#8B4513",m="#1e1b4b",v="none";if(f.skin==="skin_horse_linked"&&a){const b=V0.skins.find(g=>g.id===a.skinId);b&&(h=b.color),m=a.maneColor||m,v=a.hatId||v}else if(f.skin.startsWith("skin_horse_")){const b=f.skin.replace("skin_horse_",""),g=V0.skins.find(p=>p.id===b);g?h=g.color:f.skin==="skin_horse_mech"&&(h="#94a3b8")}else return r.jsxs("g",{transform:"translate(0, 60) scale(1.5)",children:[r.jsx("path",{d:"M 0 0 Q 20 -20 40 0 L 40 40 L 0 40 Z",fill:"#78350f"}),r.jsx("path",{d:"M 40 0 Q 60 -10 65 15",stroke:"#78350f",strokeWidth:"8",fill:"none",strokeLinecap:"round"}),r.jsx("circle",{cx:"55",cy:"5",r:"10",fill:"#78350f"}),r.jsx("path",{d:"M 50 0 L 45 -10 M 60 0 L 65 -10",stroke:"#fff",strokeWidth:"2"})]});const x=m==="rainbow";return r.jsxs("g",{children:[r.jsx("path",{d:"M70,160 L70,190 L85,190 L85,150 Z",fill:h,filter:"brightness(0.7)"}),r.jsx("path",{d:"M140,160 L140,190 L155,190 L155,150 Z",fill:h,filter:"brightness(0.7)"}),r.jsx("path",{d:"M50,100 Q40,60 90,60 L140,60 Q180,60 170,110 Q160,160 120,150 L80,150 Q50,150 50,100 Z",fill:h}),r.jsx("path",{d:"M60,150 L60,195 L75,195 L75,150 Z",fill:h}),r.jsx("path",{d:"M130,150 L130,195 L145,195 L145,150 Z",fill:h}),r.jsx("path",{d:"M130,65 Q130,30 160,20 L165,25 Q185,25 185,50 L175,70 Q160,85 145,65 Z",fill:h}),r.jsx("path",{d:"M185,50 L195,55 L190,65 L175,70 Z",fill:h,filter:"brightness(0.9)"}),r.jsx("path",{d:"M160,20 Q120,20 120,80 L130,90 Q140,30 165,25 Z",fill:x?"url(#rainbowGradient)":m,className:x?"animate-pulse":""}),r.jsx("path",{d:"M50,80 Q20,80 20,140",fill:"none",stroke:x?"url(#rainbowGradient)":m,strokeWidth:"8",strokeLinecap:"round"}),r.jsx("circle",{cx:"170",cy:"40",r:"2",fill:"white"}),r.jsx("circle",{cx:"170.5",cy:"39.5",r:"0.5",fill:"black"}),v==="straw_hat"&&r.jsx("text",{x:"160",y:"25",fontSize:"40",transform:"rotate(10, 160, 25)",children:""}),v==="cowboy_hat"&&r.jsx("text",{x:"155",y:"25",fontSize:"40",transform:"rotate(-5, 155, 25)",children:""}),v==="crown"&&r.jsx("text",{x:"155",y:"20",fontSize:"40",transform:"rotate(-10, 155, 20)",children:""}),v==="viking"&&r.jsx("text",{x:"155",y:"20",fontSize:"40",transform:"rotate(0, 155, 20)",children:""}),v==="tophat"&&r.jsx("text",{x:"152",y:"15",fontSize:"45",transform:"rotate(-10, 155, 20)",children:""})]})})()}),e.includes("heavy_axles")&&r.jsx("g",{stroke:o,strokeWidth:"1",opacity:"0.6",children:r.jsx("line",{x1:"60",y1:"95",x2:"140",y2:"95"})})]})},hF=({onComplete:t,targetRegionId:e,caravanLevel:s,upgrades:n=[],initialDurability:i=100,maxDurability:a=100,customization:l,horseCustomization:o})=>{var k,N;const c=_.useRef(null),[u,d]=_.useState(0),[f,h]=_.useState(!1),[m,v]=_.useState(i),[x,b]=_.useState(!1),g=_.useRef({distance:0,speed:0,isJumping:!1,jumpHeight:0,obstacles:[],lastObstacleTime:0,shake:0,penaltyTimer:0,durability:i,isBroken:!1,hasFinished:!1}),p=_.useRef([{speed:.15,height:280,color:"#0f172a",amplitude:60,freq:.002},{speed:.4,height:200,color:"#1e293b",amplitude:40,freq:.005},{speed:.9,height:120,color:"#334155",amplitude:30,freq:.012}]);_.useEffect(()=>{const S=w=>{w.code==="Space"&&!g.current.isJumping&&!f&&!g.current.isBroken&&(g.current.isJumping=!0,g.current.jumpHeight=12)};return window.addEventListener("keydown",S),()=>window.removeEventListener("keydown",S)},[f]),_.useEffect(()=>{const S=c.current;if(!S)return;const w=S.getContext("2d");if(!w)return;let E,j=0;const A=1e4,O=n.includes("heavy_axles"),L=n.includes("guard_post"),Y=n.includes("silk_chests"),W=1+s*.1+(O?.15:0),H=M=>{j||(j=M);const U=M-j;j=M;const C=g.current;if(!f&&!C.isBroken){let I=W;C.penaltyTimer>0&&(I*=Y?.6:.3,C.penaltyTimer-=U),C.speed=I,C.distance+=U*C.speed;const F=Math.min(1,C.distance/A);if(d(F),F>=1&&!C.hasFinished&&(C.hasFinished=!0,h(!0),setTimeout(()=>t(!0,{durability:C.durability}),3e3)),C.isJumping&&(C.jumpHeight-=.45,C.jumpHeight<0&&C.jumpHeight>-10||C.jumpHeight<=-10&&(C.isJumping=!1,C.jumpHeight=0)),C.shake>0&&(C.shake*=.9),M-C.lastObstacleTime>2e3+Math.random()*3e3){const P=Math.random();let B="ROCK";P>.8&&!L?B="BANDIT":P>.5&&(B="MUD"),(B!=="BANDIT"||!L)&&(C.obstacles.push({x:S.width+100,typ:B}),C.lastObstacleTime=M)}for(let P=C.obstacles.length-1;P>=0;P--){const B=C.obstacles[P];B.x-=U*C.speed*.8;const J=S.width*.15;if(B.x<J+200-50&&B.x>J+50){let ie=!1;B.typ==="BANDIT"?(ie=!0,C.penaltyTimer=1e3,C.shake=20,C.durability=Math.max(0,C.durability-25)):(B.typ==="ROCK"||B.typ==="MUD")&&!C.isJumping&&(ie=!0,C.penaltyTimer=800,C.shake=10,C.durability=Math.max(0,C.durability-10)),ie&&(C.obstacles.splice(P,1),v(C.durability),b(!0),setTimeout(()=>b(!1),200),C.durability<=0&&(C.isBroken=!0,setTimeout(()=>t(!1,{durability:0}),3e3)))}B.x<-200&&C.obstacles.splice(P,1)}}const T=(Math.random()-.5)*C.shake,R=(Math.random()-.5)*C.shake;w.clearRect(0,0,S.width,S.height),w.save(),w.translate(T,R);const D=w.createLinearGradient(0,0,0,S.height);D.addColorStop(0,"#020617"),D.addColorStop(1,"#1e293b"),w.fillStyle=D,w.fillRect(0,0,S.width,S.height),w.fillStyle="rgba(255,255,255,0.2)";for(let I=0;I<50;I++){const F=I*137%S.width,P=I*79%(S.height*.6);w.fillRect(F,P,1,1)}if(p.current.forEach(I=>{w.fillStyle=I.color,w.beginPath(),w.moveTo(0,S.height);for(let F=0;F<=S.width+10;F+=10){const P=F+C.distance*I.speed,B=S.height-I.height+Math.sin(P*I.freq)*I.amplitude+Math.cos(P*I.freq*.5)*(I.amplitude*.5);w.lineTo(F,B)}w.lineTo(S.width,S.height),w.fill()}),w.fillStyle="#020617",w.fillRect(0,S.height-60,S.width,60),C.obstacles.forEach(I=>{const F=S.height-60;I.typ==="ROCK"?(w.fillStyle="#64748b",w.beginPath(),w.arc(I.x,F-15,20,0,Math.PI*2),w.fill()):I.typ==="BANDIT"?(w.fillStyle="#e11d48",w.fillRect(I.x,F-60,30,60),w.fillStyle="#fff",w.fillRect(I.x+5,F-50,5,5),w.fillRect(I.x+15,F-50,5,5)):I.typ==="MUD"&&(w.fillStyle="#78350f",w.beginPath(),w.ellipse(I.x,F-5,40,10,0,0,Math.PI*2),w.fill())}),!f&&!C.isBroken){w.strokeStyle=`rgba(255,255,255,${C.speed>W*.5?.05:.01})`,w.lineWidth=1;for(let I=0;I<10;I++){const F=(C.distance*2+I*150)%S.width,P=S.height-30+I*5%20;w.beginPath(),w.moveTo(F,P),w.lineTo(F+40,P),w.stroke()}}w.restore(),E=requestAnimationFrame(H)};return E=requestAnimationFrame(H),()=>cancelAnimationFrame(E)},[f,t,s,n]);const y=e==="capital"?"Hovedstaden":e==="region_vest"?"Vestfjella":"stlandet";return r.jsxs("div",{className:"fixed inset-0 z-[200] bg-slate-950 flex flex-col items-center justify-center overflow-hidden",children:[r.jsxs("div",{className:"relative w-full max-w-5xl h-[500px] border border-slate-800 rounded-[3rem] overflow-hidden shadow-[0_0_100px_rgba(0,0,0,0.8)]",children:[r.jsx("canvas",{ref:c,width:1200,height:500,className:"w-full h-full object-cover"}),x&&r.jsx("div",{className:"absolute inset-0 bg-rose-500/30 animate-pulse pointer-events-none"}),r.jsxs("div",{className:"absolute left-[15%] bottom-[70px] w-48 transition-transform duration-100 ease-out",style:{transform:`translateY(${-Math.max(0,(((k=g.current)==null?void 0:k.jumpHeight)||0)*12)}px) rotate(${(N=g.current)!=null&&N.isJumping?-5:0}deg)`},children:[r.jsx(Sj,{level:s,upgrades:n,customization:l,horseCustomization:o,isMoving:!f&&!g.current.isBroken,className:"w-full drop-shadow-[0_15px_25px_rgba(0,0,0,0.8)]"}),!f&&!g.current.isBroken&&r.jsx("div",{className:"absolute top-1/2 right-0 w-8 h-8 bg-amber-400/20 blur-xl animate-pulse rounded-full"}),g.current.isBroken&&r.jsx("div",{className:"absolute top-0 right-1/2 w-12 h-24 bg-gray-500/50 blur-xl animate-pulse -translate-y-full"})]}),r.jsx("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 text-slate-500 font-bold uppercase text-xs tracking-widest animate-pulse opacity-50",children:"Trykk [MELLOMROM] for  hoppe"}),r.jsxs("div",{className:"absolute top-12 left-1/2 -translate-x-1/2 w-full max-w-md px-12 z-10",children:[r.jsxs("div",{className:"flex justify-between items-end mb-2",children:[r.jsxs("div",{className:"text-left",children:[r.jsx("h2",{className:"text-white font-black uppercase italic tracking-tighter text-3xl",children:"Mitt-Europa"}),r.jsxs("p",{className:"text-slate-500 font-bold uppercase text-[9px] tracking-widest leading-none",children:["Vegen mot ",y]})]}),r.jsx("div",{className:"text-right flex flex-col items-end",children:r.jsxs("span",{className:"text-amber-400 font-black italic text-xl",children:[Math.floor(u*100),"%"]})})]}),r.jsx("div",{className:"h-1 w-full bg-slate-800/50 rounded-full overflow-hidden backdrop-blur-md mb-4",children:r.jsx(q.div,{initial:{width:0},animate:{width:`${u*100}%`},className:"h-full bg-gradient-to-r from-amber-600 to-amber-400"})}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-[10px] font-bold uppercase text-slate-400 w-12 text-right",children:"Helse"}),r.jsx("div",{className:"flex-1 h-3 bg-slate-900 border border-slate-700 rounded-sm overflow-hidden relative",children:r.jsx(q.div,{className:`h-full ${m<a*.3?"bg-rose-500":"bg-emerald-500"}`,animate:{width:`${m/a*100}%`}})}),r.jsxs("span",{className:`text-[10px] font-bold ${m<a*.3?"text-rose-500":"text-emerald-500"}`,children:[Math.round(m)," / ",a]})]})]}),r.jsx("div",{className:"absolute inset-0 pointer-events-none shadow-[inset_0_0_100px_rgba(0,0,0,0.8)]"})]}),f&&r.jsx(q.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute inset-0 flex items-center justify-center bg-slate-950/90 backdrop-blur-2xl",children:r.jsxs("div",{className:"text-center space-y-6",children:[r.jsx(q.div,{initial:{scale:.5,rotate:-20},animate:{scale:1,rotate:0},className:"text-8xl",children:""}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("h3",{className:"text-6xl font-black text-white italic uppercase tracking-tighter",children:"Ankomst"}),r.jsx("p",{className:"text-amber-400 font-black uppercase tracking-[0.5em] text-sm",children:y})]}),r.jsx("div",{className:"h-px w-24 bg-slate-800 mx-auto"}),r.jsx("p",{className:"text-slate-500 font-bold uppercase text-xs tracking-widest",children:"Handelsruten er etablert"})]})}),g.current.isBroken&&r.jsx(q.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute inset-0 flex items-center justify-center bg-rose-950/90 backdrop-blur-2xl",children:r.jsxs("div",{className:"text-center space-y-6",children:[r.jsx(q.div,{initial:{scale:.5,rotate:20},animate:{scale:1,rotate:0},className:"text-8xl",children:""}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("h3",{className:"text-6xl font-black text-rose-500 italic uppercase tracking-tighter",children:"HAVARI"}),r.jsx("p",{className:"text-rose-200 font-black uppercase tracking-[0.5em] text-sm",children:"Vognen er delagt"})]}),r.jsx("div",{className:"h-px w-24 bg-rose-800 mx-auto"}),r.jsx("p",{className:"text-rose-300 font-bold uppercase text-xs tracking-widest",children:"Reisen avbrutt  Reparer vognen"})]})})]})},$r={WORK:[{id:"sickle",label:"Sigd",icon:"",desc:"Presisjons-hsting for hy kvalitet."},{id:"sweep",label:"Lj",icon:"",desc:"Rask innhsting av store omrder."}],CHOP:[{id:"axe",label:"ks",icon:"",desc:"Fell trr med r makt."}],FORAGE:[{id:"gather",label:"Sanking",icon:"",desc:"Let etter mat og urter i skogen."},{id:"traps",label:"Snarefangst",icon:"",desc:"Sett feller for smvilt."}],MINE:[{id:"pickaxe",label:"Hakke",icon:"",desc:"Hugg ut malm fra fjellet."}],QUARRY:[{id:"chisel",label:"Meisel",icon:"",desc:"Hugg ut steinblokker."}],CRAFT:[{id:"hammer",label:"Smiing",icon:"",desc:"Form metallet p ambolten."}],BAKE:[{id:"oven",label:"Steking",icon:"",desc:"Stek brd i ovnen."}],WEAVE:[{id:"loom",label:"Veving",icon:"",desc:"Vev trd til stoffer."}],MIX:[{id:"brew",label:"Brygging",icon:"",desc:"Bland urter til medisiner."}],SMELT:[{id:"furnace",label:"Smelting",icon:"",desc:"Smelt malm til barrer."}],PLANT:[{id:"manual",label:"Hndsing",icon:"",desc:"S fr for hnd."}],HUNT:[{id:"bow",label:"Bueskyting",icon:"",desc:"Presisjonsjakt fra avstand."},{id:"trap",label:"Fellefangst",icon:"",desc:"Sett ut snarer for smvilt."}],SAWMILL:[{id:"saw",label:"Saging",icon:"",desc:"Sag opp tmmer til planker."}],GATHER_WOOL:[{id:"shears",label:"Saks",icon:"",desc:"Klipp ullen av sauene."}]},mF=({item:t})=>{const e=t.durability/t.maxDurability*100;return r.jsx("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 z-[110] animate-in slide-in-from-bottom-4 fade-in duration-500",children:r.jsxs("div",{className:"bg-slate-900/90 border border-white/10 rounded-full px-6 py-3 flex items-center gap-4 backdrop-blur-md shadow-2xl",children:[r.jsx("div",{className:"text-3xl drop-shadow-[0_0_10px_rgba(255,255,255,0.2)]",children:t.icon}),r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("div",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:t.name}),r.jsxs("div",{className:"flex items-center gap-2 text-xs font-bold text-slate-300",children:[r.jsx("div",{className:`w-2 h-2 rounded-full ${e>20?"bg-emerald-500":"bg-rose-500"} animate-pulse`}),r.jsx("span",{children:"Slitasje"}),r.jsxs("span",{children:[Math.round(e),"%"]})]})]})]})})},pF=({type:t,onComplete:e,onCancel:s,equipment:n,skills:i,playerUpgrades:a,currentSeason:l="Spring",currentWeather:o="Clear",totalTicks:c=0,selectedMethod:u,action:d,player:f})=>{var N,S,w;const[h,m]=Ne.useState(u||null);Ne.useEffect(()=>{const E=$r[t];E&&E.length===1&&!h&&m(E[0].id)},[t,h]);const v=Ne.useMemo(()=>k2(t,n||[]),[t,n]),x=Ne.useMemo(()=>{var A,O;const E=Us[l],j=Dn[o];return{speedMultiplier:((j==null?void 0:j.speedMod)||1)*(((A=v==null?void 0:v.stats)==null?void 0:A.speedBonus)||1),staminaCostMod:((E==null?void 0:E.staminaMod)||1)*((j==null?void 0:j.staminaMod)||1),yieldMod:(((O=v==null?void 0:v.stats)==null?void 0:O.yieldBonus)||0)+((E==null?void 0:E.yieldMod)||1)}},[l,o,v]),b=Ne.useMemo(()=>{var Y,W;const E={skills:i||{},equipment:{}};n&&n.forEach(H=>{const M=H.slot||H.type;H&&M&&(E.equipment[M]=H)});let j=10,A="FARMING",O=t;switch(t){case"MINE":j=te.YIELD.MINE_ORE,A="MINING";break;case"QUARRY":j=te.YIELD.QUARRY_STONE,A="MINING";break;case"CHOP":j=te.YIELD.CHOP_WOOD,l==="Summer"&&(j+=te.YIELD.SUMMER_WOOD_BONUS),A="WOODCUTTING";break;case"WORK":case"HARVEST":j=te.YIELD.WORK_GRAIN,a!=null&&a.includes("iron_plow")&&(j+=te.YIELD.PLOW_BONUS),A="FARMING";break;case"FORAGE":j=te.YIELD.FORAGE_BREAD,A="FARMING";break}const L={season:((Y=Us[l])==null?void 0:Y.yieldMod)||1,weather:((W=Dn[o])==null?void 0:W.yieldMod)||1,actionType:O,upgrades:1};try{const H=vn(E,j,A,L);return console.log(`[MinigameOverlay] Yield Calc. Type: ${t}, Base: ${j}. Result: ${H}. Equipment:`,E.equipment),isNaN(H)?1.5:H}catch(H){return console.error("Yield Calc Error:",H),1.5}},[t,i,n,a,l,o]),g=Ne.useMemo(()=>{let E=10;switch(t){case"MINE":E=te.YIELD.MINE_ORE;break;case"QUARRY":E=te.YIELD.QUARRY_STONE;break;case"CHOP":E=te.YIELD.CHOP_WOOD;break;case"WORK":case"HARVEST":E=te.YIELD.WORK_GRAIN;break;case"FORAGE":E=te.YIELD.FORAGE_BREAD;break}return b<=2||b<E*.4},[b,t]),p=E=>{m(E)},[y,k]=Ne.useState(!1);return g&&!y&&(t==="MINE"||t==="QUARRY"||t==="CHOP"||t==="WORK"||t==="HARVEST"||t==="FORAGE")&&h?r.jsx("div",{className:"fixed inset-0 z-[150] flex items-center justify-center bg-black/80 backdrop-blur-md animate-in fade-in zoom-in duration-300",children:r.jsxs("div",{className:"bg-slate-900 border-2 border-rose-500 rounded-3xl p-8 max-w-md w-full text-center shadow-[0_0_50px_rgba(244,63,94,0.3)]",children:[r.jsx("div",{className:"text-6xl mb-6",children:""}),r.jsx("h2",{className:"text-3xl font-black text-white uppercase tracking-tighter mb-4",children:"Manglende Verkty!"}),r.jsxs("p",{className:"text-slate-300 font-medium mb-8 leading-relaxed",children:["Du forsker  utfre ",r.jsx("span",{className:"text-rose-400 font-bold",children:t})," uten riktig verkty. Effektiviteten din er redusert med 80%."]}),r.jsxs("div",{className:"flex flex-col gap-3",children:[r.jsx("button",{onClick:()=>k(!0),className:"w-full py-4 bg-rose-600 hover:bg-rose-500 text-white rounded-xl font-black uppercase tracking-widest shadow-lg active:scale-95 transition-all",children:"Fortsett likevel"}),r.jsx("button",{onClick:s,className:"w-full py-4 bg-white/5 hover:bg-white/10 text-slate-400 hover:text-white rounded-xl font-bold uppercase tracking-widest transition-all",children:"Avbryt"})]})]})}):!h&&$r[t]?r.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-slate-950/80 backdrop-blur-md animate-in fade-in duration-300",children:r.jsxs("div",{className:"max-w-4xl w-full p-8",children:[r.jsx("h2",{className:"text-4xl font-black text-white text-center mb-12 uppercase tracking-tighter drop-shadow-lg",children:"Velg Metode"}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:$r[t].map(E=>r.jsxs("button",{onClick:()=>p(E.id),className:"group relative bg-slate-900 border-2 border-slate-700 hover:border-indigo-500 rounded-3xl p-8 transition-all hover:-translate-y-2 hover:shadow-[0_0_50px_rgba(79,70,229,0.3)] text-left overflow-hidden",children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-500/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),r.jsxs("div",{className:"relative z-10 flex flex-col items-center text-center gap-6",children:[r.jsx("div",{className:"text-6xl group-hover:scale-110 transition-transform duration-300",children:E.icon}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-2xl font-black text-white mb-2 uppercase tracking-wide group-hover:text-indigo-400 transition-colors",children:E.label}),r.jsx("p",{className:"text-slate-400 font-medium leading-relaxed",children:E.desc})]}),r.jsx("div",{className:"mt-4 pt-4 border-t border-white/5 w-full",children:(()=>{const j=_j(t,l,o,c);return j?r.jsx("div",{className:"flex items-center justify-center gap-2 text-sm font-bold text-slate-500",children:r.jsx("span",{children:j})}):null})()})]})]},E.id))}),r.jsx("button",{onClick:s,className:"mt-12 mx-auto block text-slate-500 font-bold hover:text-white transition-colors uppercase tracking-widest text-sm",children:"Avbryt"})]})}):r.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-slate-950/90 backdrop-blur-xl animate-in fade-in duration-300",children:[r.jsx("div",{className:"absolute top-8 right-8 z-[110]",children:r.jsx("button",{onClick:s,className:"bg-black/40 hover:bg-rose-500/20 text-white/50 hover:text-rose-400 w-12 h-12 rounded-full flex items-center justify-center transition-all",children:""})}),r.jsx("div",{className:"absolute top-8 left-8 z-[110] flex gap-4",children:r.jsxs("div",{className:"bg-black/40 backdrop-blur-md px-4 py-2 rounded-2xl border border-white/5 flex items-center gap-3",children:[r.jsx("span",{className:"text-2xl",title:((N=Us[l])==null?void 0:N.label)||l,children:l==="Winter"?"":l==="Summer"?"":l==="Autumn"?"":""}),r.jsx("span",{className:"text-2xl",title:((S=Dn[o])==null?void 0:S.label)||o,children:(w=Dn[o])==null?void 0:w.icon}),r.jsx("div",{className:"h-4 w-[1px] bg-white/10 mx-2"}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] uppercase font-bold text-slate-500 tracking-wider",children:"Forhold"}),r.jsxs("span",{className:`text-xs font-bold ${x.speedMultiplier<1?"text-rose-400":"text-emerald-400"}`,children:[Math.round(x.speedMultiplier*100),"% Hastighet"]})]})]})}),r.jsxs("div",{className:"w-full max-w-5xl bg-slate-900 rounded-[3rem] shadow-2xl relative overflow-hidden border border-white/5",children:[(()=>{var E,j,A,O,L,Y;switch(t){case"PLANT":return r.jsx(JG,{onComplete:e});case"HARVEST":case"WORK":return h==="sweep"||h==="scythe"?r.jsx(L_,{onComplete:e,equipment:n,speedMultiplier:x.speedMultiplier}):r.jsx(jr,{onComplete:e,equipment:n,speedMultiplier:x.speedMultiplier,possibleYield:b});case"CHOP":return r.jsx(sF,{onComplete:e,equipment:n,speedMultiplier:x.speedMultiplier,possibleYield:b});case"SAWMILL":return r.jsx(rF,{onComplete:e,speedMultiplier:x.speedMultiplier});case"FORAGE":return h==="traps"?r.jsx(P_,{onComplete:e,speedMultiplier:x.speedMultiplier,variant:"land"}):r.jsx(jr,{isForaging:!0,onComplete:e,equipment:n,speedMultiplier:x.speedMultiplier,resourceName:"Mat/Urter",possibleYield:b});case"MINE":return r.jsx(jr,{isMining:!0,onComplete:e,equipment:n,speedMultiplier:x.speedMultiplier,resourceName:"Malm",possibleYield:b});case"QUARRY":return r.jsx(jr,{isQuarrying:!0,onComplete:e,equipment:n,speedMultiplier:x.speedMultiplier,resourceName:"Stein",possibleYield:b});case"CRAFT":case"REPAIR":return r.jsx(ZG,{onComplete:e,speedMultiplier:x.speedMultiplier});case"SMELT":return r.jsx(uF,{onComplete:e,speedMultiplier:x.speedMultiplier});case"BAKE":const W=d!=null&&d.subType?((E=Oe[d.subType])==null?void 0:E.icon)||"":((j=Ie[d==null?void 0:d.recipeId])==null?void 0:j.icon)||"";return r.jsx(eF,{onComplete:e,speedMultiplier:x.speedMultiplier,icon:W});case"WEAVE":return r.jsx(iF,{onComplete:e,speedMultiplier:x.speedMultiplier});case"MIX":return r.jsx(aF,{onComplete:e,speedMultiplier:x.speedMultiplier});case"GATHER_WOOL":return r.jsx(L_,{onComplete:e,equipment:n,speedMultiplier:x.speedMultiplier});case"MOUNT_HORSE":return r.jsx(fF,{onComplete:e,speedMultiplier:x.speedMultiplier,levelId:h||"ride_easy",level:(d==null?void 0:d.level)||1,horse:f==null?void 0:f.horseCustomization});case"HUNT":return h==="bow"?r.jsx(U_,{onComplete:e,speedMultiplier:x.speedMultiplier}):h==="trap"?r.jsx(P_,{onComplete:e,speedMultiplier:x.speedMultiplier,variant:"land"}):r.jsx(U_,{onComplete:e,speedMultiplier:x.speedMultiplier});case"TRAVEL_START":const H=((A=f==null?void 0:f.caravan)==null?void 0:A.level)||1,U=(te.CARAVAN.LEVELS.find(C=>C.level===H)||te.CARAVAN.LEVELS[0]).durability;return r.jsx(hF,{onComplete:(C,T)=>e(C?1:0,T),targetRegionId:(d==null?void 0:d.targetRegionId)||"capital",caravanLevel:H,upgrades:((O=f==null?void 0:f.caravan)==null?void 0:O.upgrades)||[],initialDurability:((L=f==null?void 0:f.caravan)==null?void 0:L.durability)||U,maxDurability:U,customization:(Y=f==null?void 0:f.caravan)==null?void 0:Y.customization,horseCustomization:f==null?void 0:f.horseCustomization});default:return r.jsxs("div",{className:"p-12 text-center",children:[r.jsxs("h2",{className:"text-2xl font-bold text-white mb-4",children:["Ukjent Minispill: ",t]}),r.jsx("button",{onClick:()=>e(.5),className:"px-6 py-3 bg-indigo-600 rounded-xl font-bold text-white",children:"Fullfr (Skip)"})]})}})(),v&&r.jsx(mF,{item:v})]})]})},gF=({isOpen:t,onClose:e,onConfirm:s,roleId:n,cost:i})=>{const[a,l]=_.useState(!1);if(_.useEffect(()=>{l(!!t)},[t]),!t)return null;const o=n==="MERCHANT",c=o?{modalBg:"bg-[#050810]",borderColor:"border-amber-500/20",glowColor:"bg-amber-500",shadowColor:"shadow-[0_0_200px_rgba(245,158,11,0.15)]",iconBg:"bg-gradient-to-br from-amber-400/20 to-amber-900/40",iconBorder:"border-amber-500/30",iconColor:"text-amber-400",titleColor:"text-amber-100",accentText:"text-amber-400",mutedText:"text-amber-100/50",cardBg:"bg-white/5 hover:bg-white/10",cardBorder:"border-white/5 hover:border-amber-500/30",buttonPrimary:"bg-amber-400 hover:bg-amber-300 text-black border-amber-300 shadow-[0_0_30px_rgba(245,158,11,0.4)] hover:shadow-[0_0_50px_rgba(245,158,11,0.6)]",buttonSecondary:"bg-transparent text-amber-100/40 hover:text-amber-100 hover:bg-white/5 border-transparent hover:border-white/10",icon:pj}:{modalBg:"bg-[#0F0505]",borderColor:"border-red-500/20",glowColor:"bg-red-600",shadowColor:"shadow-[0_0_150px_rgba(220,38,38,0.2)]",iconBg:"bg-red-900/20",iconBorder:"border-red-500/30",iconColor:"text-red-500",titleColor:"text-red-100",accentText:"text-red-500",mutedText:"text-red-200/50",cardBg:"bg-red-950/20",cardBorder:"border-red-500/10",buttonPrimary:"bg-red-600/10 hover:bg-red-600 text-red-500 hover:text-white border-red-600/30",buttonSecondary:"bg-transparent text-slate-500 hover:text-slate-300 border-transparent",icon:hc},u=c.icon;return r.jsxs("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 perspective-[1000px]",children:[r.jsx("div",{className:`absolute inset-0 bg-black/80 backdrop-blur-2xl transition-opacity duration-700 ${t?"opacity-100":"opacity-0"}`,onClick:e,children:r.jsx("div",{className:`absolute inset-0 opacity-20 bg-radial-gradient from-${o?"amber":"red"}-900/20 to-transparent`})}),r.jsxs("div",{className:`relative z-10 w-full ${o?"max-w-3xl":"max-w-lg"} 
                ${c.modalBg} border ${c.borderColor} rounded-[3rem] ${c.shadowColor} 
                overflow-hidden flex flex-col transition-all duration-700 ease-out transform
                ${a?"scale-100 translate-y-0 opacity-100 rotate-x-0":"scale-90 translate-y-10 opacity-0 rotate-x-12"}
                `,children:[r.jsx("div",{className:"absolute -top-1/2 -left-1/2 w-[200%] h-[200%] bg-gradient-to-b from-white/5 to-transparent rotate-45 pointer-events-none opacity-20"}),r.jsx("div",{className:`absolute -top-64 left-1/2 -translate-x-1/2 w-[800px] h-[600px] ${c.glowColor} opacity-10 blur-[150px] rounded-full pointer-events-none`}),r.jsxs("div",{className:"absolute inset-0 overflow-hidden opacity-30 pointer-events-none",children:[r.jsx("div",{className:"absolute top-20 left-20 w-1 h-1 bg-white rounded-full animate-pulse"}),r.jsx("div",{className:"absolute top-40 right-40 w-1.5 h-1.5 bg-white rounded-full animate-pulse delay-700"}),r.jsx("div",{className:"absolute bottom-20 left-1/3 w-1 h-1 bg-white rounded-full animate-pulse delay-300"})]}),r.jsxs("div",{className:`p-12 relative flex flex-col items-center text-center ${o?"gap-10":"gap-6"}`,children:[r.jsx("button",{onClick:e,className:"absolute top-8 right-8 group p-2 rounded-full transition-all hover:bg-white/5",children:r.jsx(pn,{size:24,className:`${c.mutedText} group-hover:text-white transition-colors`})}),r.jsxs("div",{className:"relative group",children:[o&&r.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-48 h-48 border border-amber-500/20 rounded-full animate-[spin_10s_linear_infinite]"}),r.jsx("div",{className:`absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-32 h-32 ${c.glowColor} blur-[60px] opacity-40 group-hover:opacity-60 transition-opacity duration-1000`}),r.jsxs("div",{className:`relative w-28 h-28 mx-auto rounded-[2.5rem] ${c.iconBg} ${c.iconBorder} border flex items-center justify-center shadow-2xl backdrop-blur-sm z-10 transition-transform duration-500 group-hover:scale-105 group-hover:-translate-y-1`,children:[r.jsx(u,{size:64,className:`${c.iconColor} drop-shadow-[0_0_20px_rgba(251,191,36,0.5)]`}),r.jsx("div",{className:"absolute inset-0 rounded-[2.5rem] bg-gradient-to-tr from-white/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"})]})]}),r.jsxs("div",{className:"space-y-4 max-w-lg mx-auto z-10",children:[r.jsxs("div",{className:"flex items-center justify-center gap-3 opacity-80",children:[r.jsx("div",{className:`h-px w-12 ${c.glowColor} opacity-50`}),r.jsx("h4",{className:`text-xs font-bold uppercase tracking-[0.4em] ${c.accentText}`,children:"Ny Karrierevei"}),r.jsx("div",{className:`h-px w-12 ${c.glowColor} opacity-50`})]}),r.jsx("h2",{className:`text-6xl font-black uppercase tracking-tighter italic drop-shadow-2xl ${c.titleColor}`,children:o?"Kjpmann":"Soldat"})]}),o?r.jsxs("div",{className:"w-full max-w-2xl space-y-8 animate-in fade-in slide-in-from-bottom-8 duration-1000 delay-150",children:[r.jsx("p",{className:"text-xl text-slate-300 font-light leading-relaxed max-w-lg mx-auto italic",children:'"Som kjpmann beveger du ikke bare varer, du beveger verden. Gull er blodet som strmmer gjennom rikets rer."'}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsx("div",{className:`relative overflow-hidden p-5 rounded-3xl border ${c.cardBorder} ${c.cardBg} transition-all duration-300 group/card text-left flex flex-col h-full`,children:r.jsxs("div",{className:"relative z-10 space-y-4",children:[r.jsx("div",{className:"w-10 h-10 rounded-xl bg-amber-500/10 flex items-center justify-center text-amber-400 group-hover/card:scale-110 transition-transform",children:r.jsx(eh,{size:20})}),r.jsxs("div",{children:[r.jsx("h5",{className:"font-black text-white text-sm uppercase tracking-wider",children:"Fltestyring"}),r.jsx("div",{className:"h-0.5 w-6 bg-amber-500/50 my-2"}),r.jsx("p",{className:"text-xs text-slate-400 leading-relaxed",children:"Bygg og oppgrader din egen karavaneflte. Velg mellom raske kjerrer eller tunge vogner med enorm lastekapasitet."})]})]})}),r.jsx("div",{className:`relative overflow-hidden p-5 rounded-3xl border ${c.cardBorder} ${c.cardBg} transition-all duration-300 group/card text-left flex flex-col h-full`,children:r.jsxs("div",{className:"relative z-10 space-y-4",children:[r.jsx("div",{className:"w-10 h-10 rounded-xl bg-amber-500/10 flex items-center justify-center text-amber-400 group-hover/card:scale-110 transition-transform",children:r.jsx(fj,{size:20})}),r.jsxs("div",{children:[r.jsx("h5",{className:"font-black text-white text-sm uppercase tracking-wider",children:"Global Handel"}),r.jsx("div",{className:"h-0.5 w-6 bg-amber-500/50 my-2"}),r.jsx("p",{className:"text-xs text-slate-400 leading-relaxed",children:"Kryss landegrenser og utnytt dype prisforskjeller mellom regionene. Kjp billig i st, selg dyrt i vest."})]})]})}),r.jsx("div",{className:`relative overflow-hidden p-5 rounded-3xl border ${c.cardBorder} ${c.cardBg} transition-all duration-300 group/card text-left flex flex-col h-full`,children:r.jsxs("div",{className:"relative z-10 space-y-4",children:[r.jsx("div",{className:"w-10 h-10 rounded-xl bg-amber-500/10 flex items-center justify-center text-amber-400 group-hover/card:scale-110 transition-transform",children:r.jsx(rf,{size:20})}),r.jsxs("div",{children:[r.jsx("h5",{className:"font-black text-white text-sm uppercase tracking-wider",children:"Markedsmakt"}),r.jsx("div",{className:"h-0.5 w-6 bg-amber-500/50 my-2"}),r.jsx("p",{className:"text-xs text-slate-400 leading-relaxed",children:"Invester i landsbyens konomi, ls opp passiv inntekt gjennom luksusvarer og dominer de lokale markedene."})]})]})})]}),r.jsx("div",{className:"bg-amber-500/5 border border-amber-500/10 p-4 rounded-2xl",children:r.jsxs("p",{className:"text-xs text-amber-200/70 font-medium",children:[r.jsx(Hi,{size:12,className:"inline mr-2 mb-0.5"}),"Som Kjpmann lser du opp en helt ny dimensjon av spillet fokusert p logistikk, risiko og massiv profitt."]})})]}):r.jsxs("div",{className:"bg-red-950/20 border border-red-500/20 p-8 rounded-[2rem] max-w-md mx-auto",children:[r.jsx(xj,{size:48,className:"text-red-500 mx-auto mb-4"}),r.jsx("p",{className:"text-red-200 font-medium",children:"Denne rollen er under utvikling. Forvent ubalanse og manglende funksjoner."})]}),r.jsxs("div",{className:"flex flex-col items-center gap-6 w-full pt-4 animate-in fade-in slide-in-from-bottom-4 duration-1000 delay-300",children:[r.jsxs("div",{className:`flex items-center gap-2 text-[10px] font-black uppercase tracking-[0.2em] opacity-60 ${c.accentText}`,children:[r.jsx(hc,{size:12}),r.jsx("span",{children:"Dette valget er permanent"})]}),r.jsxs("div",{className:"flex items-center gap-4 w-full justify-center",children:[r.jsx("button",{onClick:e,className:`px-8 py-4 rounded-2xl font-bold tracking-widest uppercase text-xs transition-all ${c.buttonSecondary}`,children:"Avbryt"}),r.jsxs("button",{onClick:s,className:`group relative px-10 py-5 rounded-2xl font-black tracking-widest uppercase text-sm border-2 transition-all hover:scale-[1.02] active:scale-[0.98] flex items-center gap-4 ${c.buttonPrimary}`,children:[r.jsx("div",{className:"absolute inset-0 bg-white/20 blur-xl opacity-0 group-hover:opacity-50 transition-opacity"}),r.jsx("span",{className:"relative z-10",children:o?"Signer Kontrakt":"Jeg forstr"}),i&&o&&r.jsx("div",{className:"relative z-10 flex items-center gap-2 bg-black/20 backdrop-blur-md px-3 py-1.5 rounded-lg border border-black/10",children:r.jsx("span",{className:"text-xs font-mono font-bold text-amber-900",children:i})}),o&&r.jsx(Hi,{size:16,className:"relative z-10 animate-pulse text-amber-900"})]})]})]})]})]})]})},xF=({poi:t,player:e,room:s,viewingRegionId:n,onAction:i,onClose:a})=>{var j,A,O,L,Y,W;const l=_.useRef(null),o=n==="region_ost"&&t.ost?t.ost.top:t.top,c=n==="region_ost"&&t.ost?t.ost.left:t.left,[u,d]=_.useState({x:"3rem",y:"-50%"}),[f,h]=_.useState(!1),[m,v]=_.useState({isOpen:!1,action:null}),x=((j=s.world)==null?void 0:j.season)||"Spring",b=((A=s.world)==null?void 0:A.weather)||"Clear",g=_.useMemo(()=>{var I,F,P;const H=t.id in cs?t.id:t.parentId,M=cs[H],C=((P=(F=(((I=s.world)==null?void 0:I.settlement)||{}).buildings)==null?void 0:F[H])==null?void 0:P.level)||1;let T=[];if(M)for(let B=1;B<=C;B++)M.levels[B]&&(T=[...T,...M.levels[B].unlocks]);const R=t.actions.filter(B=>{if(B.id==="TAX_PEASANTS"&&e.role!=="BARON"||B.id==="TAX_ROYAL"&&e.role!=="KING"||B.id==="DECREE"&&e.role!=="KING"||B.id==="RAID"&&e.role!=="BARON"||B.id==="FEAST"&&e.role!=="KING"&&e.role!=="BARON"||B.id==="JOIN_ROLE"&&e.role===B.targetRole)return!1;const J=["OPEN_CRAFTING","CRAFT","REFINE","MARKET_VIEW","OPEN_GARRISON","OPEN_TAVERN_MENU","OPEN_WEAPON_RACK","OPEN_DICE_GAME","OPEN_RESOURCE_GAME"];return!(M&&!B.id.startsWith("BUILDING_UPGRADE_")&&!J.includes(B.id)&&!T.includes(B.id))});return["windmill_stones","sawmill_blade","smeltery_furnace","bakery_oven","weavery_loom","forge_anvil"].includes(t.id)?R.filter(B=>B.id==="OPEN_CRAFTING"||B.id==="REFINE"||B.id==="CRAFT"||B.id.startsWith("REFINE_")||B.id.startsWith("CRAFT_")||B.id in Hs).slice(0,1):R},[t,e.role,(O=s.world)==null?void 0:O.settlement]);_.useLayoutEffect(()=>{if(!l.current)return;const H=l.current.getBoundingClientRect(),M=l.current.offsetParent;if(!M){h(!0);return}const U=M.getBoundingClientRect(),C=parseFloat(c),T=parseFloat(o),R=C<50?"3rem":"calc(-100% - 3rem)",D=T/100*U.height-H.height/2,I=D+H.height;let F="-50%";D<20?F=`calc(-50% + ${20-D}px)`:I>U.height-20&&(F=`calc(-50% - ${I-(U.height-20)}px)`),d({x:R,y:F}),h(!0)},[o,c,g.length]);const p=H=>{var D,I,F;const M=[],U=_p(e,H);if(U.forEach(P=>{var B,J,se;(B=P.stats)!=null&&B.speedBonus&&P.stats.speedBonus!==1&&M.push({source:P.name,type:"Fart",value:`+${Math.round((P.stats.speedBonus-1)*100)}%`,icon:P.icon,isBonus:!0}),(J=P.stats)!=null&&J.yieldBonus&&M.push({source:P.name,type:"Utbytte",value:`+${P.stats.yieldBonus}`,icon:P.icon,isBonus:!0}),(se=P.stats)!=null&&se.luckBonus&&M.push({source:P.name,type:"Flaks",value:`+${Math.round(P.stats.luckBonus*100)}%`,icon:P.icon,isBonus:!0})}),e.upgrades){const P=yx[e.role]||[];e.upgrades.forEach(B=>{const J=P.find(se=>se.id===B);J&&(J.benefit==="YIELD_GRAIN"&&(H==="WORK"||H==="MILL")&&M.push({source:J.name,type:"Utbytte",value:"+5",icon:"",isBonus:!0}),J.benefit==="RAID_SPEED"&&H==="RAID"&&M.push({source:J.name,type:"Fart",value:"Raskere",icon:"",isBonus:!0}))})}const C=t.id==="tavern"||t.id==="bakery"||t.id==="great_forge"||t.id==="weavery"||t.id==="sawmill"||t.id==="windmill"||t.id==="smeltery"?t.id:t.parentId,R=((F=(I=(((D=s.world)==null?void 0:D.settlement)||{}).buildings)==null?void 0:I[C])==null?void 0:F.level)||1;if(R>=2&&M.push({source:"Bygningsbonus (Lvl 2)",type:"Utbytte",value:"+10% XP",icon:"",isBonus:!0}),R>=3&&M.push({source:"Bygningsbonus (Lvl 3)",type:"Utbytte",value:"Master Tier",icon:"",isBonus:!0}),$r[H]){const P=$r[H][0];P.id==="manual"||P.id==="gather"||U.some(se=>{var ie;return((ie=se.type)==null?void 0:ie.toLowerCase().includes(P.id.toLowerCase()))||se.id.toLowerCase().includes(P.id.toLowerCase())})||M.push({source:"System",type:"ADVARSEL",value:`Du mangler ${P.label}, utbytte redusert med 80%`,icon:"",isBonus:!1})}return M},y=_.useMemo(()=>{var H;return(H=e.activeProcesses)==null?void 0:H.find(M=>!(M.locationId!==t.id||M.type==="COOP"||M.type==="WELL"&&M.readyAt<=Date.now()))},[e.activeProcesses,t.id]),k=()=>{if(!y)return 0;const H=Date.now();return Math.max(0,y.readyAt-H)},[N,S]=_.useState(k());_.useEffect(()=>{if(!y)return;const H=setInterval(()=>{const M=k();S(M),M<=0&&clearInterval(H)},1e3);return()=>clearInterval(H)},[y]);const w=H=>{const M=Math.floor(H/6e4),U=Math.floor(H%6e4/1e3);return`${M}m ${U}s`},E=r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"absolute inset-0 z-[90]",onClick:a}),r.jsx("div",{ref:l,style:{top:o,left:c,transform:`translate(${u.x}, ${u.y})`,visibility:f?"visible":"hidden",opacity:f?1:0},className:`absolute z-[100] ${f?"animate-in fade-in zoom-in":""} duration-200 pointer-events-auto`,children:r.jsxs("div",{className:"bg-slate-900/90 backdrop-blur-3xl border border-white/10 rounded-[2.5rem] p-6 shadow-[0_40px_100px_rgba(0,0,0,0.8)] min-w-[320px] w-max max-w-[400px] relative transition-all duration-500 overflow-hidden group/tooltip",children:[r.jsx("div",{className:"absolute -top-24 -left-24 w-48 h-48 bg-indigo-500/10 blur-[80px] pointer-events-none group-hover/tooltip:bg-indigo-500/20 transition-all duration-1000"}),r.jsxs("div",{className:"flex items-center justify-between mb-6 relative z-10",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("div",{className:"w-14 h-14 rounded-2xl bg-white/5 border border-white/10 flex items-center justify-center text-3xl shadow-inner relative overflow-hidden group/icon",children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-0 group-hover/icon:opacity-100 transition-opacity"}),t.icon]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("h3",{className:"font-display font-black text-white text-xl uppercase tracking-tighter leading-none",children:t.label}),r.jsx("span",{className:"text-xs font-black text-indigo-400 uppercase tracking-[.2em] mt-1 opacity-90",children:"Landemerke"})]})]}),r.jsx("div",{className:"flex items-center gap-3",children:r.jsx("button",{onClick:a,className:"text-white/60 hover:text-white transition-all bg-white/10 hover:bg-white/20 rounded-full w-10 h-10 flex items-center justify-center border border-white/10 hover:border-white/30 active:scale-90",children:""})})]}),r.jsxs("div",{className:"space-y-3",children:[y?r.jsx("div",{className:"w-full relative py-4",children:N<=0?r.jsxs("div",{className:"relative group/harvest",children:[r.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-emerald-500 to-teal-500 rounded-3xl blur opacity-25 group-hover/harvest:opacity-50 transition duration-1000 group-hover:duration-200"}),r.jsxs("button",{onClick:()=>i({type:"HARVEST",locationId:t.id}),disabled:e.status.stamina<Ys(15,x,b),className:`w-full relative px-6 py-8 border rounded-3xl flex items-center justify-between overflow-hidden active:scale-[0.98] transition-all
                                                ${e.status.stamina<Ys(15,x,b)?"bg-red-900/20 border-red-500/30 cursor-not-allowed grayscale opacity-80":"bg-slate-900 border-emerald-500/50 hover:bg-emerald-950/30"}`,children:[r.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-emerald-500/10 blur-3xl -mr-16 -mt-16"}),r.jsxs("div",{className:"flex flex-col items-start z-10",children:[r.jsx("span",{className:`text-2xl font-black uppercase tracking-tighter italic ${e.status.stamina<Ys(15,x,b)?"text-slate-500":"text-white"}`,children:(L=t.label)!=null&&L.toLowerCase().includes("lin")?"Linhsting":t.id==="grain_fields"?"Kornhsting":"Innhsting"}),r.jsx("span",{className:`text-xs font-black uppercase tracking-[0.2em] mt-1 ${e.status.stamina<Ys(15,x,b)?"text-red-400":"text-emerald-400"}`,children:e.status.stamina<Ys(15,x,b)?`Mangler energi (${Math.ceil(e.status.stamina)}/${Ys(15,x,b).toFixed(0)})`:"Klar til  hentes!"})]}),r.jsx("div",{className:`w-14 h-14 rounded-2xl flex items-center justify-center text-3xl shadow-[0_0_20px_rgba(16,185,129,0.3)] ${e.status.stamina<Ys(15,x,b)?"bg-slate-800 text-slate-600":"bg-emerald-500/20 animate-bounce"}`,children:e.status.stamina<Ys(15,x,b)?r.jsx(vp,{size:24,className:"text-red-500"}):""})]})]}):r.jsxs("div",{className:"p-8 bg-white/5 border border-white/10 rounded-[2rem] flex flex-col items-center gap-6 relative overflow-hidden group/timer",children:[r.jsx("div",{className:"absolute -bottom-12 -right-12 w-24 h-24 bg-indigo-500/5 blur-2xl rounded-full"}),r.jsxs("div",{className:"relative w-24 h-24",children:[r.jsxs("svg",{className:"w-full h-full -rotate-90",viewBox:"0 0 36 36",children:[r.jsx("circle",{cx:"18",cy:"18",r:"16",fill:"none",className:"stroke-white/5",strokeWidth:"2"}),r.jsx("circle",{cx:"18",cy:"18",r:"16",fill:"none",className:"stroke-emerald-500 transition-all duration-1000 ease-linear",strokeWidth:"2",strokeDasharray:"100",strokeDashoffset:100-(1-N/y.duration)*100,strokeLinecap:"round"})]}),r.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:r.jsx("span",{className:"text-3xl animate-pulse",children:y.type==="MILL"?"":y.type==="WELL"?"":""})})]}),r.jsxs("div",{className:"flex flex-col items-center gap-1",children:[r.jsx("span",{className:"text-sm font-black text-slate-400 uppercase tracking-widest leading-none",children:y.type==="WELL"?"Brnnen fyller seg med vann":"Venter p produksjon"}),r.jsx("span",{className:"text-2xl font-mono font-black text-white",children:w(N)})]}),r.jsx("div",{className:"w-full h-1 bg-white/5 rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full bg-emerald-500 transition-all duration-1000 ease-linear",style:{width:`${(1-N/y.duration)*100}%`}})})]})}):r.jsx("div",{className:"space-y-6",children:g.map(H=>{var P,B,J,se;const M=((P=s.world)==null?void 0:P.season)||"Spring",U=((B=s.world)==null?void 0:B.weather)||"Clear",C=p(H.id);let T=!0,R="";const D=["CRAFT","REFINE","OPEN_CRAFTING","BAKE","SMELT","MILL","WEAVE","MIX","OPEN_CHICKEN_COOP","OPEN_DICE_GAME","MARKET_VIEW","OPEN_GARRISON","OPEN_WEAPON_RACK"];if(n!==e.regionId&&e.role!=="KING"&&H.id!=="MARKET_VIEW")T=!1,R="Dette er ikke ditt baroni";else if(!D.includes(H.id)){const ie=yj(e,H.id,M,U,((J=s.world)==null?void 0:J.gameTick)||0);ie.success||(T=!1,R=ie.reason||"Krav ikke mtt")}const I=_j(H.id,M,U,((se=s.world)==null?void 0:se.gameTick)||0),F=$r[H.id];return r.jsxs("div",{className:"w-full animate-in fade-in slide-in-from-bottom-2 duration-500",children:[r.jsxs("div",{className:"flex items-center justify-between px-1 mb-3",children:[r.jsx("h4",{className:"text-xs font-black text-slate-300 uppercase tracking-[0.3em]",children:H.label}),I&&r.jsx("span",{className:"text-xs font-black text-indigo-400 uppercase tracking-widest",children:I})]}),F?r.jsx("div",{className:"grid grid-cols-1 gap-4",children:F.map(ie=>{const Ee=_p(e,H.id),ye=Ee.find(Z=>{var Me;return((Me=Z.type)==null?void 0:Me.toLowerCase().includes(ie.id.toLowerCase()))||Z.id.toLowerCase().includes(ie.id.toLowerCase())})||Ee[0],ae=ye?ye.durability/ye.maxDurability*100:null;return r.jsxs("button",{onClick:()=>i({type:H.id,method:ie.id,locationId:t.id}),disabled:!T,className:`group relative flex items-center gap-6 w-full p-5 rounded-[2rem] border transition-all duration-300 ${T?"bg-white/5 border-white/10 hover:border-indigo-500/50 hover:bg-indigo-500/5 active:scale-[0.98]":"bg-black/20 border-white/5 cursor-not-allowed"}`,children:[r.jsx("div",{className:`w-16 h-16 rounded-2xl bg-white/5 flex-shrink-0 flex items-center justify-center text-4xl group-hover:scale-110 transition-transform duration-500 ${!T&&"opacity-40"}`,children:ie.icon}),r.jsxs("div",{className:"flex-1 flex flex-col justify-center min-w-0 items-start",children:[r.jsx("span",{className:"font-display font-black text-white text-xl uppercase tracking-tighter group-hover:text-indigo-400 transition-colors truncate",children:ie.label}),T?r.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[r.jsx("span",{className:"text-[10px] text-slate-400 font-black uppercase tracking-widest truncate opacity-60",children:ie.desc}),C.length>0&&r.jsx("div",{className:"flex gap-1.5",children:C.filter(Z=>!Z.isBonus||Z.value.includes("+")).slice(0,1).map((Z,Me)=>r.jsx("span",{className:"text-[10px] text-emerald-400 font-black px-2 py-0.5 bg-emerald-400/10 rounded-full",children:Z.value},Me))})]}):r.jsx("span",{className:"text-xs font-black text-rose-500 uppercase tracking-widest mt-0.5",children:R})]}),r.jsxs("div",{className:"flex flex-col items-end gap-3 ml-2",children:[ae!==null&&T&&r.jsx("div",{className:"w-10 h-1.5 bg-white/10 rounded-full overflow-hidden shadow-inner",children:r.jsx("div",{className:`h-full transition-all duration-1000 ${ae>50?"bg-indigo-500 shadow-[0_0_8px_rgba(99,102,241,0.5)]":ae>20?"bg-amber-500":"bg-rose-500"}`,style:{width:`${ae}%`}})}),r.jsx(Ca,{size:22,className:`transition-all ${T?"text-white/20 group-hover:text-indigo-400 group-hover:translate-x-1":"text-white/5"}`})]})]},ie.id)})}):r.jsx("button",{onClick:()=>{H.id==="JOIN_ROLE"?v({isOpen:!0,action:{...H,type:H.id,locationId:t.id}}):i({...H,type:H.id,locationId:t.id})},disabled:!T,className:`w-full group relative overflow-hidden p-5 rounded-3xl border transition-all duration-300 ${T?"bg-white/5 border-white/10 hover:border-indigo-500/50 hover:bg-indigo-500/5 active:scale-[0.98]":"bg-black/20 border-white/5 opacity-50 cursor-not-allowed"}`,children:r.jsxs("div",{className:"flex items-center justify-between relative z-10",children:[r.jsxs("div",{className:"flex flex-col items-start",children:[r.jsx("span",{className:"text-xl font-black text-white group-hover:text-indigo-400 transition-colors uppercase tracking-tight",children:H.label}),!T&&r.jsx("span",{className:"text-sm font-black text-rose-500 uppercase tracking-widest mt-1",children:R})]}),r.jsx(Ca,{size:20,className:"text-white/20 group-hover:text-indigo-400 group-hover:translate-x-1 transition-all"})]})})]},H.id)})}),(()=>{var R,D,I,F,P;const H=g.map(B=>B.id),M=Object.values(e.equipment||{}),T=Object.values(Oe).filter(B=>{var J;return(J=B.relevantActions)==null?void 0:J.some(se=>H.includes(se))}).map(B=>{if(M.find(se=>se.id===B.id||se.id.startsWith(B.id+"_"))){const se=B.nextTierId;return se?Oe[se]:null}else return B.level===1?B:null}).filter(Boolean).filter((B,J,se)=>se.findIndex(ie=>(ie==null?void 0:ie.id)===(B==null?void 0:B.id))===J).sort((B,J)=>{if(!B||!J)return 0;const se=B.type==="MAIN_HAND"||B.type==="AXE"||B.type==="PICKAXE"||B.type==="SCYTHE"||B.type==="BOW"||B.type==="CHISEL"?1:0;return(J.type==="MAIN_HAND"||J.type==="AXE"||J.type==="PICKAXE"||J.type==="SCYTHE"||J.type==="BOW"||J.type==="CHISEL"?1:0)-se});if(T.length>0){const B=T[0];if(!B)return null;const J=Object.values(Hs).find(qe=>qe.outputItemId===B.id),se=((R=s.world)==null?void 0:R.settlement)||{buildings:{}},ie=(J==null?void 0:J.buildingId)||"great_forge",Ee=((I=(D=se.buildings)==null?void 0:D[ie])==null?void 0:I.level)||1,ye=(J==null?void 0:J.level)||1,ae=Ee<ye,Z=((F=cs[ie])==null?void 0:F.name)||"Smien",Me=M.find(qe=>{var ht;if(!qe)return!1;const ge=Object.keys(Oe).find(Fe=>qe.id===Fe||qe.id.startsWith(Fe+"_")),me=ge?Oe[ge]:null;return(ht=me==null?void 0:me.relevantActions)==null?void 0:ht.some(Fe=>H.includes(Fe))});return r.jsx("div",{className:"mt-8 pt-8 border-t border-white/5 relative z-10",children:r.jsxs("div",{className:"flex flex-col gap-4",children:[r.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[r.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-amber-500 to-transparent flex-1"}),r.jsx("span",{className:`text-xs font-black uppercase tracking-[0.2em] ${ae?"text-slate-400":"text-amber-500 animate-pulse"}`,children:ae?`Krever niv ${ye}`:"Utvikling venter"}),r.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-amber-500 to-transparent flex-1"})]}),r.jsxs("div",{className:"flex items-center justify-between gap-6 px-4",children:[r.jsxs("div",{className:"flex flex-col items-center gap-2 group/evolve",children:[r.jsx("div",{className:"w-16 h-16 rounded-[1.5rem] bg-white/5 border border-white/10 flex items-center justify-center text-3xl opacity-40 transition-all group-hover/evolve:opacity-60",children:(Me==null?void 0:Me.icon)||""}),r.jsx("span",{className:"text-[9px] font-black text-slate-500 uppercase tracking-widest",children:"N"})]}),r.jsxs("div",{className:"flex flex-col items-center flex-1 gap-2 pt-2",children:[r.jsxs("div",{className:"relative w-full flex justify-center",children:[r.jsx("div",{className:"absolute top-1/2 left-0 w-full h-px bg-gradient-to-r from-indigo-500/0 via-indigo-500/30 to-indigo-500/0"}),r.jsx(Ca,{className:"text-indigo-500/50 w-6 h-6 animate-pulse relative z-10"})]}),((P=B.stats)==null?void 0:P.yieldBonus)&&r.jsxs("span",{className:"text-[10px] font-black text-emerald-400 bg-emerald-400/10 px-2 py-0.5 rounded-full border border-emerald-400/20",children:["+",B.stats.yieldBonus," Utbytte"]})]}),r.jsxs("div",{className:"flex flex-col items-center gap-2 group/next",children:[r.jsx("div",{className:`w-20 h-20 rounded-[2rem] flex items-center justify-center text-4xl border-2 shadow-2xl transition-all duration-500 ${ae?"bg-slate-900/50 border-white/5 grayscale":"bg-indigo-600/20 border-indigo-500/50 shadow-indigo-500/20 hover:scale-110 active:scale-95"}`,children:B.icon}),r.jsx("span",{className:`text-xs font-black uppercase tracking-tight ${ae?"text-slate-500":"text-amber-500"}`,children:B.name})]})]}),r.jsx("p",{className:"text-xs text-slate-400 text-center font-medium italic px-6 mt-2",children:ae?`Forbedre ${Z} til niv ${ye} for  lse opp.`:`Besk ${Z} i landsbyen for  smi din ${B.name}.`})]})})}return null})()]})]})})]});return r.jsxs(r.Fragment,{children:[E,r.jsx(gF,{isOpen:m.isOpen,onClose:()=>v({isOpen:!1,action:null}),onConfirm:()=>{m.action&&i(m.action),v({isOpen:!1,action:null})},roleId:((Y=m.action)==null?void 0:Y.targetRole)||"",cost:(W=m.action)==null?void 0:W.cost})]})},bF=({weather:t,season:e,hideClouds:s,isInterior:n})=>{const i=_.useMemo(()=>Array.from({length:12}).map((d,f)=>({id:f,top:`${Math.random()*100}%`,delay:Math.random()*60,duration:40+Math.random()*60,scale:.5+Math.random()*1.5,opacity:.1+Math.random()*.3})),[]),a=_.useMemo(()=>Array.from({length:10}).map((d,f)=>({id:f,left:`${Math.random()*100}%`,delay:Math.random()*20,duration:10+Math.random()*20,size:5+Math.random()*10,rotation:Math.random()*360,drift:50+Math.random()*150})),[]),l=_.useMemo(()=>Array.from({length:5}).map((d,f)=>({id:f,left:`${10+Math.random()*80}%`,top:`${-10+Math.random()*40}%`,rotation:f*45+Math.random()*20,delay:f*2})),[]),o=()=>e==="Autumn"?"":e==="Spring"?"":e==="Winter"?"":"",u=100*(t==="Storm"?2.5:t==="Rain"?1.5:1);return r.jsxs("div",{className:"absolute inset-0 pointer-events-none overflow-hidden z-[5]",children:[t==="Clear"&&!n&&r.jsx("div",{className:"absolute inset-0 opacity-40",children:l.map(d=>r.jsx("div",{className:"absolute w-[400px] h-[800px] animate-sunbeam",style:{left:d.left,top:d.top,background:"radial-gradient(ellipse at top, rgba(253, 224, 71, 0.15) 0%, transparent 70%)",transform:`rotate(${d.rotation}deg)`,animationDelay:`${d.delay}s`}},d.id))}),!s&&!n&&r.jsx("div",{className:"absolute inset-0",children:i.map(d=>r.jsx("div",{className:"absolute text-white animate-cloud-drift select-none",style:{top:d.top,fontSize:`${d.scale*4}rem`,opacity:t==="Storm"?d.opacity*2:d.opacity,filter:"blur(8px)",animationDuration:`${t==="Storm"?d.duration/2:d.duration}s`,animationDelay:`-${d.delay}s`,color:t==="Storm"?"#475569":"white"},children:""},d.id))}),t==="Fog"&&!n&&r.jsx("div",{className:"absolute inset-0 bg-slate-400/10 backdrop-blur-[2px] animate-mist"}),!n&&r.jsx("div",{className:"absolute inset-0",children:a.map(d=>r.jsx("div",{className:"absolute animate-particle opacity-0",style:{left:d.left,fontSize:`${d.size}px`,animationDuration:`${d.duration}s`,animationDelay:`${d.delay}s`,filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.1))","--wind-drift":`${u+d.drift}px`,"--wind-rotation":`${720+d.rotation}deg`},children:o()},d.id))}),(t==="Clear"||n)&&r.jsx("div",{className:"absolute inset-0",children:Array.from({length:15}).map((d,f)=>r.jsx("div",{className:"absolute w-1 h-1 bg-white/40 rounded-full animate-dust-float",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDuration:`${6+Math.random()*8}s`,animationDelay:`${Math.random()*10}s`,filter:"blur(1px)"}},`dust-${f}`))}),(t==="Rain"||t==="Storm")&&!n&&r.jsx("div",{className:"absolute inset-0 bg-indigo-900/10 mix-blend-overlay"})]})},vF=({player:t,room:e})=>{const[s,n]=_.useState(Date.now()),{handleAction:i}=Nj(e==null?void 0:e.pin,t,(e==null?void 0:e.world)||null,()=>{},()=>{},()=>{},null),[a,l]=_.useState({});_.useEffect(()=>{const m=setInterval(()=>{var x;const v=Date.now();if(n(v),Math.random()<.05){const b=((x=t.activeProcesses)==null?void 0:x.filter(g=>g.type==="CROP"&&g.readyAt>v))||[];if(b.length>0){const g=b[Math.floor(Math.random()*b.length)];if(!a[g.id]){const p=Math.random()>.5?"CROW":"WEED";l(y=>({...y,[g.id]:{type:p,expiresAt:v+1e4}}))}}}l(b=>{const g={...b};let p=!1;return Object.entries(g).forEach(([y,k])=>{k.expiresAt<v&&(delete g[y],p=!0)}),p?g:b})},1e3);return()=>clearInterval(m)},[t.activeProcesses,a]);const o=_.useCallback((m,v)=>{l(x=>{const b={...x};return delete b[m],b}),i({type:"MAINTAIN_CROP",processId:m,subType:v})},[i]),c=t.activeProcesses||[],u=s,d=c.filter(m=>!(!(m.type==="CROP"||m.type==="COOP"||m.type==="MILL"||m.type==="WELL"||m.type==="CRAFT")||m.type==="WELL"&&m.readyAt>0&&u>m.readyAt+1e4)),f=(t.activeBuffs||[]).filter(m=>m.expiresAt>u);if(d.length===0&&f.length===0)return null;d.sort((m,v)=>m.readyAt-v.readyAt);const h=m=>{const v=Math.floor(m/6e4),x=Math.floor(m%6e4/1e3);return`${v}m ${x}s`};return r.jsxs("div",{className:"absolute top-6 right-6 z-[60] flex flex-col gap-2 pointer-events-none items-end",children:[f.map(m=>{const v=Math.max(0,m.expiresAt-u);return r.jsxs("div",{className:"group bg-indigo-900/90 backdrop-blur-md border border-indigo-500/30 rounded-xl p-3 shadow-xl pointer-events-auto flex items-center gap-4 transition-all hover:bg-indigo-900/100 hover:scale-105 animate-in slide-in-from-right-4 duration-300 relative",children:[r.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center border bg-indigo-500/20 border-indigo-500 text-indigo-300",children:r.jsx("span",{className:"text-xl",children:""})}),r.jsxs("div",{className:"flex flex-col min-w-[120px]",children:[r.jsx("span",{className:"text-xs font-bold text-indigo-300 uppercase tracking-wider",children:m.label}),r.jsx("div",{className:"flex items-center gap-2",children:r.jsx("span",{className:"text-sm font-black text-white",children:h(v)})})]}),m.description&&r.jsx("div",{className:"absolute right-full top-1/2 -translate-y-1/2 mr-3 w-48 bg-slate-900/95 border border-indigo-500/30 p-3 rounded-xl shadow-2xl opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none translate-x-2 group-hover:translate-x-0",children:r.jsx("p",{className:"text-[10px] text-indigo-100 leading-tight",children:m.description})})]},m.id)}),d.map(m=>{const v=Math.max(0,m.readyAt-u),x=v<=0;let b="Avling Gror",g=r.jsx(pp,{size:20}),p="Innhsting Klar!";const y=Ie[m.itemId];if(m.type==="COOP")b="Hner Spiser",g=r.jsx("span",{className:"text-xl",children:""}),p="Egg klare!";else if(m.type==="MILL")b="Kverner korn",g=r.jsx("span",{className:"text-xl",children:""}),p="Mel klart!";else if(m.type==="WELL")b="Brnnen fyller seg",g=r.jsx("span",{className:"text-xl",children:""}),p="Brnnen er klar!";else if(m.type==="CRAFT"){const S=Xi[m.itemId],w=Oe[m.itemId];S?(g=r.jsx("span",{className:"text-xl",children:S.icon||""}),b=S.label?`Lager ${S.label}...`:"Hndverk pgr...",p=S.label?`${S.label} klar!`:"Hndverk ferdig!"):w?(g=r.jsx("span",{className:"text-xl",children:w.icon||""}),b=`Lager ${w.name}...`,p=`${w.name} ferdig!`):(g=r.jsx("span",{className:"text-xl",children:""}),b="Hndverk pgr...",p="Hndverk ferdig!")}else y?(g=r.jsx("span",{className:"text-xl",children:y.icon}),b=`${y.label} gror`,p=`${y.label} klar!`):g=x?r.jsx(Yc,{size:20}):r.jsx(pp,{size:20});const k=a[m.id],N=!!k&&!x;return r.jsxs("div",{className:`relative bg-slate-900/90 backdrop-blur-md border rounded-xl p-3 shadow-xl pointer-events-auto flex items-center gap-4 transition-all hover:bg-slate-900/95 animate-in slide-in-from-right-4 duration-300 ${m.type==="WELL"&&x?"animate-pulse":""} ${N?"border-rose-500/50 hover:border-rose-400 cursor-pointer group":"border-white/10"}`,onClick:N?()=>o(m.id,k.type):void 0,children:[N&&r.jsx("div",{className:"absolute -top-3 -right-3 z-50 animate-bounce",children:r.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center shadow-lg border-2 border-white ${k.type==="CROW"?"bg-slate-800":"bg-emerald-700"}`,children:r.jsx("span",{className:"text-lg",children:k.type==="CROW"?"":""})})}),m.yieldBonus&&m.yieldBonus>0&&r.jsxs("div",{className:"absolute -bottom-2 -right-2 px-2 py-0.5 bg-emerald-600 text-white text-[10px] font-black rounded-full shadow-lg border border-emerald-400 z-10",children:["+",Math.round(m.yieldBonus*100),"%"]}),r.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center border ${x?"bg-emerald-500/20 border-emerald-500 text-emerald-400 animate-pulse":"bg-slate-800 border-white/10 text-slate-400"}`,children:g}),r.jsxs("div",{className:"flex flex-col min-w-[120px]",children:[r.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:x?p:N?k.type==="CROW"?"Fjern Krke!":"Luk ugress!":b}),r.jsx("div",{className:"flex items-center gap-2",children:r.jsx("span",{className:`text-sm font-black ${x?"text-emerald-400":N?"text-rose-400":"text-white"}`,children:x?"Hent n":h(v)})})]})]},m.id)})]})},tn=({title:t,subtitle:e,icon:s,headerRight:n,children:i,onClose:a,className:l,maxWidth:o,hideHeader:c=!1,noPadding:u=!1})=>(_.useEffect(()=>{const d=f=>{f.key==="Escape"&&a()};return window.addEventListener("keydown",d),()=>window.removeEventListener("keydown",d)},[a]),r.jsxs("div",{className:"absolute inset-0 z-40 flex items-center justify-center p-4 md:p-8",children:[r.jsx(q.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:a,className:"absolute inset-0 bg-black/20 backdrop-blur-[1px] cursor-pointer"}),r.jsxs(q.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{type:"spring",stiffness:260,damping:25,mass:1},className:`relative w-full ${o||"max-w-5xl"} max-h-full bg-slate-950/90 backdrop-blur-md border border-white/10 rounded-3xl shadow-2xl overflow-hidden flex flex-col pointer-events-auto will-change-transform`,children:[!c&&r.jsxs("div",{className:"flex-none flex justify-between items-center px-6 py-4 border-b border-white/10 bg-gradient-to-r from-white/5 to-transparent min-h-[72px]",children:[r.jsxs("div",{className:"flex items-center gap-5 overflow-hidden",children:[s&&r.jsx("div",{className:"w-12 h-12 bg-white/5 rounded-2xl flex items-center justify-center text-3xl shadow-inner border border-white/5 shrink-0",children:s}),r.jsxs("div",{className:"flex flex-col min-w-0",children:[t&&r.jsx("h2",{className:"text-xl font-display font-black text-white tracking-tighter uppercase truncate",children:t}),e&&r.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest truncate opacity-80",children:e})]}),n&&r.jsx("div",{className:"hidden sm:flex items-center pl-4 border-l border-white/10 ml-2",children:n})]}),r.jsx("button",{onClick:a,className:"w-8 h-8 bg-white/5 hover:bg-rose-500/20 text-slate-400 hover:text-rose-500 rounded-full flex items-center justify-center transition-all group",title:"Lukk vindu",children:r.jsx("span",{className:"text-lg group-hover:rotate-90 transition-transform",children:""})})]}),r.jsx("div",{className:`flex-1 overflow-y-auto custom-scrollbar ${u?"":"p-6"} ${l||""}`,children:i})]})]})),yF=({children:t,variant:e="primary",size:s="md",icon:n,className:i="",...a})=>{const l="relative inline-flex items-center justify-center font-bold tracking-wide transition-all duration-200 uppercase rounded shadow-lg active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed",o={primary:"bg-blue-600 hover:bg-blue-500 text-white border-b-4 border-blue-800 hover:border-blue-700",secondary:"bg-game-stone hover:bg-gray-500 text-white border-b-4 border-gray-700",danger:"bg-game-danger hover:bg-red-500 text-white border-b-4 border-red-700",wood:"bg-game-wood hover:bg-amber-800 text-game-paper border-2 border-game-wood_light shadow-inner",ghost:"bg-transparent hover:bg-white/10 text-white shadow-none"},c={sm:"px-3 py-1 text-xs",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"};return r.jsxs("button",{className:`${l} ${o[e]} ${c[s]} ${i}`,...a,children:[n&&r.jsx("span",{className:"mr-2",children:n}),t]})},_F=({player:t,room:e,onAction:s,onClose:n})=>{var S,w,E,j;const i=t.role==="KING",a=(t.regionId||"").trim().toLowerCase(),l=t.regionId||"Riket";if(!e||!e.world)return null;const{world:o,regions:c}=e,u=i?null:c==null?void 0:c[t.regionId||""],d=i?o.lastRoyalTaxCollection:u==null?void 0:u.lastTaxCollection,f=d&&d.year===o.year&&d.season===o.season,h=i?o.royalTaxHistory||[]:(u==null?void 0:u.taxHistory)||[],[m,v]=_.useState(i?((w=(S=e.world)==null?void 0:S.taxRateDetails)==null?void 0:w.kingTax)||20:((j=(E=e.regions)==null?void 0:E[t.regionId||""])==null?void 0:j.taxRate)||10),[x,b]=_.useState("ADJUST"),[g,p]=_.useState(!1),{estimates:y,citizenList:k}=Ne.useMemo(()=>{let A=0,O=0,L=[];const Y=m/100;return Object.values(e.players||{}).forEach(H=>{var C,T,R,D,I;if(!H||H.id===t.id)return;const M=(H.regionId||"").trim().toLowerCase();if(i?H.role==="BARON":H.role==="PEASANT"&&(M===a||M.includes(a))){const F=Number(((C=H.resources)==null?void 0:C.gold)??H.gold??H.wealth??((T=H.stats)==null?void 0:T.gold)??((D=(R=H.inventory)==null?void 0:R.find(B=>B.id==="gold"))==null?void 0:D.amount)??0),P=Number(((I=H.resources)==null?void 0:I.grain)??0);A+=F*Y,O+=P*Y,L.push({id:H.id,name:H.name,gold:F,grain:P,role:H.role,hasResources:!!H.resources,raw:H})}}),{estimates:{gold:Math.floor(A),grain:Math.floor(O),count:L.length,penalty:Math.max(0,Math.floor((m-10)/1.5))},citizenList:L.sort((H,M)=>M.gold-H.gold)}},[m,e.players,i,a,t.id]),N=()=>{s({type:i?"TAX_ROYAL":"TAX",taxRate:m}),n()};return r.jsx(tn,{title:i?"STATSKASSEN":`SKATT: ${l.toUpperCase()}`,icon:r.jsx(pj,{size:18,className:"text-game-gold"}),onClose:n,children:r.jsxs("div",{className:`p-4 sm:p-6 lg:p-10 flex flex-col gap-8 w-full ${i?"max-w-6xl":"max-w-3xl"} mx-auto transition-all ${f?"grayscale-[0.5] opacity-90":""}`,children:[r.jsxs("nav",{className:"flex bg-slate-900/80 backdrop-blur-md border border-white/5 rounded-2xl p-1.5 max-w-sm mx-auto w-full shadow-2xl relative z-20",children:[r.jsxs("button",{onClick:()=>b("ADJUST"),className:`flex-1 flex items-center justify-center gap-2 py-3 text-[10px] font-black uppercase tracking-widest transition-all rounded-xl ${x==="ADJUST"?"bg-white text-black shadow-xl scale-[1.02]":"text-slate-500 hover:text-white hover:bg-white/5"}`,children:[r.jsx(rf,{size:14})," Justering"]}),r.jsxs("button",{onClick:()=>b("HISTORY"),className:`flex-1 flex items-center justify-center gap-2 py-3 text-[10px] font-black uppercase tracking-widest transition-all rounded-xl ${x==="HISTORY"?"bg-white text-black shadow-xl scale-[1.02]":"text-slate-500 hover:text-white hover:bg-white/5"}`,children:[r.jsx(cj,{size:14})," Historikk"]})]}),x==="ADJUST"?r.jsxs("div",{className:`grid grid-cols-1 ${i?"lg:grid-cols-12":"gap-6"} items-start animate-in fade-in zoom-in-95 duration-700`,children:[r.jsxs("div",{className:i?"lg:col-span-4 space-y-6":"space-y-6",children:[r.jsxs("div",{className:"bg-gradient-to-br from-slate-900 via-slate-950 to-black border border-white/10 rounded-[3rem] p-8 lg:p-10 shadow-[0_30px_60px_-15px_rgba(0,0,0,0.7)] relative overflow-hidden group",children:[r.jsx("div",{className:"absolute -top-12 -right-12 w-48 h-48 bg-game-gold/5 blur-[80px] rounded-full group-hover:bg-game-gold/10 transition-colors"}),r.jsxs("div",{className:"flex justify-between items-start mb-10 relative z-10",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-12 h-12 rounded-2xl bg-game-gold/10 flex items-center justify-center text-game-gold border border-game-gold/20",children:r.jsx(bp,{size:24})}),r.jsxs("div",{children:[r.jsx("span",{className:"text-[10px] font-black text-game-gold/60 uppercase tracking-[0.3em] block mb-1",children:"Innkrevingsniv"}),r.jsxs("div",{className:"flex items-baseline gap-3",children:[r.jsxs("h2",{className:"text-7xl font-black text-white italic tracking-tighter leading-none",children:[m,"%"]}),r.jsx("div",{className:`px-2.5 py-1 rounded-full border text-[9px] font-black uppercase tracking-widest shadow-lg ${y.penalty>15?"bg-red-500/10 border-red-500/20 text-red-500":"bg-emerald-500/10 border-emerald-500/20 text-emerald-500"}`,children:y.penalty===0?"Optimalt":`-${y.penalty} Lojalitet`})]})]})]}),i&&r.jsx("button",{onClick:()=>p(!g),className:"p-2.5 hover:bg-white/5 rounded-full transition-all group/info",children:r.jsx(uj,{size:18,className:g?"text-game-gold":"text-slate-700 group-hover/info:text-slate-400"})})]}),r.jsxs("div",{className:"relative h-20 flex items-center mb-6 relative z-10 px-2",children:[r.jsx("div",{className:"absolute h-2 w-full bg-slate-800/50 rounded-full"}),r.jsx("div",{className:"absolute h-2 bg-gradient-to-r from-game-gold via-orange-500 to-red-600 rounded-full shadow-[0_0_30px_rgba(251,191,36,0.5)]",style:{width:`${m/50*100}%`}}),r.jsx("input",{type:"range",min:"0",max:"50",step:"1",value:m,onChange:A=>v(parseInt(A.target.value)),disabled:f,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-30"}),r.jsx("div",{className:"absolute w-12 h-12 bg-white border-[6px] border-game-gold rounded-full shadow-[0_10px_30px_rgba(0,0,0,0.6)] transition-all pointer-events-none flex items-center justify-center scale-110",style:{left:`calc(${m/50*100}% - 24px)`},children:r.jsx("div",{className:"w-2.5 h-2.5 bg-game-gold rounded-full"})})]}),r.jsxs("div",{className:"flex justify-between text-[11px] font-black uppercase tracking-[0.25em] px-2",children:[r.jsx("span",{className:"text-slate-600",children:"Sknsel"}),r.jsx("span",{className:"text-slate-400",children:"Rettferd"}),r.jsx("span",{className:"text-red-900/80 shadow-red-500/10",children:"Tyranni"})]})]}),r.jsxs("div",{className:`grid ${i?"grid-cols-1":"grid-cols-1 sm:grid-cols-3"} gap-4`,children:[r.jsxs("div",{className:"bg-slate-900/60 backdrop-blur-sm border border-white/5 p-5 rounded-3xl flex items-center gap-4 transition-all hover:bg-slate-900 hover:border-white/10 group min-h-[90px]",children:[r.jsx("div",{className:"p-3 bg-game-gold/10 text-game-gold rounded-2xl group-hover:scale-110 transition-transform shadow-inner",children:r.jsx(sb,{size:22})}),r.jsxs("div",{className:"min-w-0",children:[r.jsx("p",{className:"text-[9px] text-slate-500 font-black uppercase tracking-widest truncate",children:"Gull"}),r.jsxs("p",{className:"text-2xl font-black text-white italic tracking-tighter truncate leading-none mt-1",children:[y.gold,"g"]})]})]}),r.jsxs("div",{className:"bg-slate-900/60 backdrop-blur-sm border border-white/5 p-5 rounded-3xl flex items-center gap-4 transition-all hover:bg-slate-900 hover:border-white/10 group min-h-[90px]",children:[r.jsx("div",{className:"p-3 bg-orange-500/10 text-orange-400 rounded-2xl group-hover:scale-110 transition-transform shadow-inner",children:r.jsx(rf,{size:22})}),r.jsxs("div",{className:"min-w-0",children:[r.jsx("p",{className:"text-[9px] text-slate-500 font-black uppercase tracking-widest truncate",children:"Korn"}),r.jsx("p",{className:"text-2xl font-black text-white italic tracking-tighter truncate leading-none mt-1",children:y.grain})]})]}),r.jsxs("div",{className:"bg-slate-900/60 backdrop-blur-sm border border-white/5 p-5 rounded-3xl flex items-center gap-4 transition-all hover:bg-slate-800 hover:border-white/10 group min-h-[90px]",children:[r.jsx("div",{className:"p-3 bg-indigo-500/10 text-indigo-400 rounded-2xl group-hover:scale-110 transition-transform shadow-inner",children:r.jsx(Ia,{size:22})}),r.jsxs("div",{className:"min-w-0",children:[r.jsx("p",{className:"text-[9px] text-slate-500 font-black uppercase tracking-widest truncate",children:i?"Baroner":"Borgere"}),r.jsx("p",{className:"text-2xl font-black text-white italic tracking-tighter leading-none mt-1",children:y.count})]})]})]}),r.jsx(yF,{variant:f?"ghost":"primary",onClick:N,disabled:f||m===0||y.count===0,className:"w-full py-8 text-2xl font-black italic uppercase rounded-[2.5rem] shadow-[0_20px_40px_-10px_rgba(37,99,235,0.4)] hover:shadow-[0_25px_50px_-10px_rgba(37,99,235,0.6)] active:scale-95 transition-all h-24",children:f?"Du har skattlagt, vent til neste rstid":"EKSEKVER SKATT"})]}),i&&r.jsx("div",{className:"lg:col-span-8 h-full",children:r.jsxs("div",{className:"bg-slate-900/40 backdrop-blur-xl border border-white/5 rounded-[3.5rem] overflow-hidden flex flex-col shadow-inner h-full min-h-[600px]",children:[r.jsxs("div",{className:"px-10 py-6 border-b border-white/5 flex justify-between items-center bg-black/40",children:[r.jsx("h4",{className:"text-[12px] font-black text-slate-400 uppercase tracking-[0.3em]",children:"Vasaller & Rikdom"}),r.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-game-gold/10 rounded-full border border-game-gold/20",children:[r.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-game-gold animate-pulse"}),r.jsx("span",{className:"text-[10px] font-black uppercase text-game-gold tracking-widest",children:k.length})]})]}),r.jsx("div",{className:"p-8 overflow-y-auto custom-scrollbar flex-1",children:k.length===0?r.jsxs("div",{className:"h-full flex flex-col items-center justify-center opacity-10 italic text-center py-20",children:[r.jsx(Ia,{size:64,className:"mb-6"}),r.jsx("p",{className:"text-xl font-black uppercase tracking-[0.4em]",children:"Ingen vasaller funnet"})]}):r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:k.map(A=>r.jsxs("div",{className:"group flex items-center justify-between p-6 bg-slate-900 border border-white/[0.03] rounded-[2rem] hover:bg-white/[0.07] hover:border-white/10 transition-all cursor-default",children:[r.jsxs("div",{className:"flex items-center gap-5 min-w-0",children:[r.jsx("div",{className:"w-14 h-14 rounded-2xl bg-slate-800 flex items-center justify-center text-slate-500 border border-white/5 group-hover:bg-game-gold/10 group-hover:text-game-gold transition-all duration-300",children:r.jsx(Ia,{size:22})}),r.jsxs("div",{className:"flex flex-col min-w-0",children:[r.jsx("span",{className:"text-base font-black text-white truncate leading-tight group-hover:tracking-wide transition-all",children:A.name}),r.jsx("span",{className:"text-[10px] font-black uppercase text-slate-600 tracking-widest mt-1.5",children:A.role})]})]}),r.jsxs("div",{className:"text-right ml-4 flex-shrink-0",children:[r.jsxs("p",{className:"text-2xl font-black italic tracking-tighter text-white group-hover:text-game-gold transition-colors",children:[Math.floor(A.gold),"g"]}),r.jsx("div",{className:"w-24 h-1.5 bg-white/[0.03] rounded-full mt-2.5 overflow-hidden border border-white/[0.02]",children:r.jsx("div",{className:"h-full bg-game-gold/30 shadow-[0_0_15px_rgba(251,191,36,0.3)] transition-all duration-700",style:{width:`${Math.min(100,A.gold/500*100)}%`}})})]})]},A.id))})})]})})]}):r.jsx("div",{className:"bg-slate-900/50 backdrop-blur-xl border border-white/5 rounded-[3rem] overflow-hidden animate-in fade-in slide-in-from-right-8 duration-700 max-w-4xl mx-auto w-full shadow-[0_40px_80px_-20px_rgba(0,0,0,0.8)]",children:r.jsxs("table",{className:"w-full text-base text-left",children:[r.jsx("thead",{className:"bg-black/40 text-[11px] text-game-gold font-black uppercase tracking-[0.25em] border-b border-white/5",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-10 py-8",children:"Tidsepoke"}),r.jsx("th",{className:"px-10 py-8 text-right",children:"Sats"}),r.jsx("th",{className:"px-10 py-8 text-right",children:"Gull"}),r.jsx("th",{className:"px-10 py-8 text-right",children:"Korn"})]})}),r.jsx("tbody",{className:"divide-y divide-white/5 font-bold",children:h.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:4,className:"py-40 text-center opacity-10 font-black uppercase tracking-widest text-3xl",children:"Portalens historie er tom"})}):[...h].reverse().map((A,O)=>r.jsxs("tr",{className:"hover:bg-white/5 transition-all group",children:[r.jsxs("td",{className:"px-10 py-7 text-slate-400 group-hover:text-white transition-colors",children:["r ",A.year,", ",r.jsx("span",{className:"font-black italic text-indigo-400 uppercase tracking-widest ml-3",children:A.season.toUpperCase()})]}),r.jsxs("td",{className:"px-10 py-7 text-right font-black italic text-slate-500 group-hover:text-game-gold transition-colors",children:[A.rate,"%"]}),r.jsxs("td",{className:"px-10 py-7 text-right font-black italic text-game-gold text-2xl whitespace-nowrap",children:[A.amountGold,"g"]}),r.jsx("td",{className:"px-10 py-7 text-right font-black italic text-orange-400 text-2xl whitespace-nowrap",children:A.amountGrain||0})]},O))})]})}),g&&i&&r.jsxs("div",{className:"p-8 bg-black/60 backdrop-blur-2xl border border-red-500/20 rounded-[2.5rem] mt-6 animate-in slide-in-from-top-6 max-w-lg mx-auto w-full shadow-2xl",children:[r.jsxs("div",{className:"flex items-center gap-4 mb-5 border-b border-red-500/10 pb-4",children:[r.jsx("div",{className:"p-2 bg-red-500/10 rounded-lg text-red-500",children:r.jsx(hc,{size:20})}),r.jsx("p",{className:"text-[12px] font-black text-red-400 uppercase tracking-[0.3em]",children:"Systemisk Diagnose"})]}),r.jsxs("div",{className:"text-[11px] font-mono text-slate-500 space-y-2",children:[r.jsxs("div",{className:"flex justify-between border-b border-white/[0.02] pb-1",children:[r.jsx("span",{children:"Region ID:"})," ",r.jsx("span",{className:"text-white font-bold",children:a})]}),r.jsxs("div",{className:"flex justify-between border-b border-white/[0.02] pb-1",children:[r.jsx("span",{children:"Active Entities:"})," ",r.jsx("span",{className:"text-white font-bold",children:Object.keys(e.players).length})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Match Success:"})," ",r.jsx("span",{className:"text-emerald-500 font-bold",children:k.length>0?"YES":"NO"})]})]})]})]})})},wF=({player:t,activeProcesses:e,onAction:s,onClose:n})=>{var g,p;const i=e.filter(y=>y.type==="COOP"&&y.locationId==="chicken_coop"),a=i.length>0,l=i[0],[o,c]=_.useState(0);_.useEffect(()=>{if(!l){c(0);return}const y=()=>{const N=Math.max(0,l.readyAt-Date.now());c(N)};y();const k=setInterval(y,1e3);return()=>clearInterval(k)},[l]);const u=a&&o<=0,d=t.resources.grain||0,f=()=>{s({type:"FEED_CHICKENS",locationId:"chicken_coop"})},h=()=>{s({type:"COLLECT_EGGS",locationId:"chicken_coop"})},m=l?l.readyAt-l.startedAt:1,v=l?1-o/m:0,x=((p=(g=t.buildings)==null?void 0:g.farm_house)==null?void 0:p.level)||1,b=x>1?`map_peasant_farm_lvl${x}`:"map_peasant_farm";return r.jsx(tn,{title:"Hnsehuset",icon:r.jsx("span",{className:"text-2xl",children:""}),onClose:n,children:r.jsxs("div",{className:"p-6 flex flex-col items-center gap-8 min-h-[400px]",children:[r.jsxs("div",{className:"relative w-full h-48 bg-slate-900/50 rounded-2xl overflow-hidden border border-white/10 flex items-center justify-center",children:[r.jsx("img",{src:`/Simulation_StandAlone_Pro/${b}.png`,className:"absolute inset-0 w-full h-full object-cover opacity-30 grayscale",alt:"Coop Background"}),r.jsxs("div",{className:"relative z-10 flex gap-4",children:[r.jsx(q.div,{animate:{y:[0,-5,0]},transition:{repeat:1/0,duration:2,ease:"easeInOut"},className:"text-6xl",children:""}),a&&!u&&r.jsx(q.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-6xl",children:""}),u&&r.jsx(q.div,{initial:{scale:0},animate:{scale:[1,1.2,1]},transition:{repeat:1/0,duration:1},className:"text-6xl drop-shadow-[0_0_15px_rgba(251,191,36,0.8)]",children:""})]})]}),r.jsxs("div",{className:"text-center space-y-4 max-w-sm",children:[!a&&r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"text-xl font-bold text-white",children:"Sultne Hner"}),r.jsx("p",{className:"text-slate-400 text-sm",children:"Hnene kakler utlmodig. Gi dem korn for  starte eggproduksjonen."}),r.jsxs("div",{className:"flex items-center justify-center gap-4 bg-slate-800/50 p-4 rounded-xl border border-white/5",children:[r.jsx(Hn,{resource:"grain",amount:d,size:"lg"}),r.jsx("button",{onClick:f,disabled:d<5,className:`
                                        px-6 py-3 rounded-xl font-bold uppercase tracking-wider text-sm transition-all
                                        ${d>=5?"bg-amber-500 hover:bg-amber-400 text-amber-950 shadow-amber-500/20 shadow-lg":"bg-slate-700 text-slate-500 cursor-not-allowed"}
                                    `,children:"Fr Hner (5 Korn)"})]})]}),a&&!u&&r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"text-xl font-bold text-white",children:"Hnene Spiser"}),r.jsx("p",{className:"text-slate-400 text-sm",children:"Det tar tid  lage gode egg..."}),r.jsx("div",{className:"w-full h-4 bg-slate-800 rounded-full overflow-hidden border border-white/10",children:r.jsx(q.div,{className:"h-full bg-amber-500",initial:{width:`${v*100}%`},animate:{width:`${v*100}%`},transition:{duration:1,ease:"linear"}})}),r.jsxs("p",{className:"font-mono text-amber-400 font-bold",children:[Math.ceil(o/6e4)," minutter igjen"]})]}),u&&r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"text-xl font-bold text-white",children:"Eggene er klare!"}),r.jsx("p",{className:"text-slate-400 text-sm",children:"Redet er fullt av ferske egg."}),r.jsx("button",{onClick:h,className:"px-8 py-4 bg-emerald-500 hover:bg-emerald-400 text-white rounded-xl font-black uppercase tracking-widest text-lg shadow-emerald-500/30 shadow-2xl animate-pulse",children:"Samle Egg"})]})]})]})})},kF=({buildingId:t,player:e,room:s,onAction:n})=>{var b,g,p,y;const i=cs[t];if(!i)return null;const a=t==="farm_house",o=["manor_ost","manor_vest","throne_room"].includes(t)?0:1,c=a?((b=e.buildings)==null?void 0:b[t])||{level:1,progress:{}}:((y=(p=(g=s.world)==null?void 0:g.settlement)==null?void 0:p.buildings)==null?void 0:y[t])||{level:o,progress:{}},u=c.level??0,d=Object.keys(i.levels).map(Number).sort((k,N)=>k-N),f=d[d.length-1],h=u>=f,m=u+1,v=i.levels[m],x=i.levels[u];return h?r.jsxs("div",{className:"relative w-full overflow-hidden rounded-[2.5rem] bg-gradient-to-br from-amber-600/20 to-slate-900 border border-amber-500/30 shadow-2xl p-8 text-center group",children:[r.jsx("div",{className:"absolute inset-0 bg-[url('/patterns/topographic.svg')] opacity-10"}),r.jsx("div",{className:"absolute top-0 right-0 p-12 opacity-10 group-hover:opacity-20 transition-opacity",children:r.jsx(mc,{size:120,className:"text-amber-400"})}),r.jsxs("div",{className:"relative z-10 flex flex-col items-center gap-6",children:[r.jsx("div",{className:"w-20 h-20 rounded-full bg-gradient-to-br from-amber-400 to-orange-600 flex items-center justify-center shadow-[0_0_40px_rgba(251,191,36,0.4)] animate-pulse",children:r.jsx(mc,{size:40,className:"text-white drop-shadow-md"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-3xl font-black text-amber-100 uppercase tracking-tighter mb-2",children:"Mesterverk Fullfrt"}),r.jsxs("p",{className:"text-amber-200/60 font-medium max-w-md mx-auto",children:[i.name," har ndd sitt ypperste potensial (Niv ",f,")."]})]}),r.jsx("div",{className:"grid grid-cols-1 gap-3 w-full max-w-md mt-4",children:r.jsxs("div",{className:"bg-amber-950/40 border border-amber-500/20 rounded-xl p-4 flex items-center gap-4",children:[r.jsx("span",{className:"text-2xl",children:""}),r.jsxs("div",{className:"text-left",children:[r.jsx("div",{className:"text-[10px] font-black uppercase text-amber-500 tracking-widest",children:"Aktiv Bonus"}),r.jsx("div",{className:"font-bold text-amber-100",children:(x==null?void 0:x.bonus)||"Maksimal effekt"})]})]})})]})]}):r.jsxs("div",{className:"space-y-8 w-full",children:[r.jsxs("div",{className:"grid grid-cols-[1fr_auto_1fr] gap-4 items-center",children:[r.jsxs("div",{className:"bg-slate-900/50 rounded-2xl p-4 border border-white/5 flex flex-col items-center gap-2 opacity-60",children:[r.jsx("div",{className:"text-[10px] font-black uppercase text-slate-500 tracking-widest",children:"Nvrende"}),r.jsxs("div",{className:"text-3xl font-black text-slate-300",children:["Niv ",u]}),r.jsx("div",{className:"text-xs text-center text-slate-500 font-medium px-2",children:(x==null?void 0:x.bonus)||"Ingen effekt"})]}),r.jsx("div",{className:"flex flex-col items-center justify-center text-indigo-500",children:r.jsx(CU,{size:32,className:"animate-pulse"})}),r.jsxs("div",{className:"bg-indigo-600/10 rounded-2xl p-5 border border-indigo-500/30 flex flex-col items-center gap-2 relative overflow-hidden shadow-[0_0_30px_rgba(99,102,241,0.1)]",children:[r.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-indigo-500"}),r.jsx("div",{className:"text-[10px] font-black uppercase text-indigo-400 tracking-widest",children:"Neste Oppgradering"}),r.jsxs("div",{className:"text-4xl font-black text-white",children:["Niv ",m]}),r.jsx("div",{className:"text-xs text-center text-indigo-200 font-bold px-2 bg-indigo-500/20 py-1 rounded-full mt-1",children:(v==null?void 0:v.bonus)||"???"})]})]}),r.jsx("div",{className:"bg-slate-950/30 rounded-xl p-4 text-center border border-white/5",children:r.jsxs("p",{className:"text-slate-400 text-sm italic",children:['"',i.description,'"']})}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between px-2",children:[r.jsx("span",{className:"text-[10px] font-black text-slate-500 uppercase tracking-[0.2em]",children:"Ressurskrav"}),r.jsx("span",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:a?"Privat Bygg":"Felles Dugnad"})]}),r.jsx("div",{className:"grid grid-cols-1 gap-3",children:Object.entries(v.requirements||{}).map(([k,N])=>{var Y,W;const S=Math.floor(((Y=c.progress)==null?void 0:Y[k])||0),w=Math.min(100,S/N*100),E=Math.floor(((W=e.resources)==null?void 0:W[k])||0),j=N-S,A=E>0&&j>0,O=Math.min(E,j),L=S>=N;return r.jsxs("div",{className:"relative group overflow-hidden bg-slate-900 border border-white/10 rounded-2xl transition-all hover:border-white/20",children:[r.jsx("div",{className:"absolute inset-0 bg-slate-950",children:r.jsx("div",{className:`h-full transition-all duration-1000 ease-out opacity-20 ${L?"bg-emerald-500":"bg-indigo-500"}`,style:{width:`${w}%`}})}),r.jsxs("div",{className:"relative z-10 p-4 flex items-center justify-between gap-4",children:[r.jsxs("div",{className:"flex items-center gap-4 min-w-[120px]",children:[r.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center text-xl shadow-inner ${L?"bg-emerald-500/20 text-emerald-400":"bg-slate-800 text-slate-400"}`,children:L?r.jsx(Yc,{size:20}):k==="gold"?"":k==="wood"?"":k==="stone"?"":k==="plank"?"":""}),r.jsxs("div",{children:[r.jsx("div",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:k}),r.jsxs("div",{className:`font-bold ${L?"text-emerald-400":"text-white"}`,children:[S," / ",r.jsx("span",{className:"text-slate-500",children:N})]})]})]}),!L&&r.jsx("div",{className:"flex items-center gap-3",children:A?r.jsxs("div",{className:"flex flex-col items-end gap-1",children:[r.jsxs("span",{className:"text-[9px] text-slate-400 font-bold uppercase tracking-wide",children:["Du har: ",E]}),r.jsxs("button",{onClick:()=>n({type:a?"CONTRIBUTE_TO_PRIVATE_UPGRADE":"CONTRIBUTE_TO_UPGRADE",buildingId:t,resource:k,amount:O}),className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-white text-xs font-black uppercase tracking-widest rounded-lg transition-all active:scale-95 shadow-lg shadow-indigo-900/20 flex items-center gap-2",children:[r.jsx(dl,{size:12}),"Gi ",O]})]}):r.jsxs("div",{className:"px-4 py-2 bg-rose-500/10 border border-rose-500/20 rounded-lg text-rose-500 text-[10px] font-black uppercase tracking-widest flex items-center gap-2",children:[r.jsx(Ml,{size:12}),"Mangler ",k," (",j,")"]})}),L&&r.jsx("div",{className:"px-4 py-2 bg-emerald-500/10 border border-emerald-500/20 rounded-lg text-emerald-400 text-[10px] font-black uppercase tracking-widest",children:"Fullfrt"})]})]},k)})})]}),Object.entries(v.requirements).every(([N,S])=>{var w;return(((w=c.progress)==null?void 0:w[N])||0)>=S})?r.jsxs("button",{onClick:()=>{n({type:a?"CONTRIBUTE_TO_PRIVATE_UPGRADE":"CONTRIBUTE_TO_UPGRADE",buildingId:t,resource:"dummy",amount:0})},className:"w-full py-5 bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-500 hover:to-teal-500 text-white font-black uppercase tracking-widest rounded-2xl shadow-[0_0_30px_rgba(16,185,129,0.4)] transition-all active:scale-95 flex items-center justify-center gap-3 animate-bounce",children:[r.jsx(dl,{size:24}),"Fullfr Oppgradering til Niv ",m,"!"]}):null]})},NF=({npc:t,step:e,setStep:s,onClose:n})=>{var i,a;return r.jsx("div",{className:"absolute inset-0 z-50 bg-black/80 backdrop-blur-sm flex items-center justify-center p-6 animate-in fade-in duration-300",children:r.jsxs("div",{className:"bg-slate-900 border-2 border-amber-600/30 rounded-2xl max-w-lg w-full overflow-hidden shadow-2xl",children:[r.jsxs("div",{className:"bg-slate-950 p-6 border-b border-white/5 flex gap-4 items-center",children:[r.jsx("div",{className:"w-16 h-16 rounded-full bg-slate-800 border-2 border-amber-500/50 flex items-center justify-center text-3xl shadow-inner",children:""}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-black text-amber-500",children:t.name}),r.jsx("p",{className:"text-sm text-slate-400 italic font-medium",children:t.role})]}),r.jsx("button",{onClick:n,className:"ml-auto w-8 h-8 bg-white/5 hover:bg-white/10 rounded-full flex items-center justify-center text-white transition-colors",children:""})]}),r.jsxs("div",{className:"p-8 space-y-6",children:[r.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-widest mb-2 opacity-50",children:t.description}),r.jsxs("p",{className:"text-slate-300 text-lg leading-relaxed italic border-l-4 border-amber-500/20 pl-4 py-2",children:['"',((i=t.conversation[e])==null?void 0:i.text)||"...",'"']}),r.jsx("div",{className:"grid gap-3 pt-4",children:(a=t.conversation[e])==null?void 0:a.options.map((l,o)=>r.jsxs("button",{onClick:()=>{l.nextId==="EXIT"?n():s(l.nextId)},className:"w-full text-left bg-white/5 hover:bg-amber-500/10 hover:border-amber-500/50 border border-white/10 p-4 rounded-xl transition-all font-medium text-slate-200 active:scale-[0.98]",children:[r.jsx("span",{className:"text-amber-500 mr-2",children:""})," ",l.label]},o))})]})]})})},SF=({viewMode:t,viewingRegionId:e,player:s,onSelect:n,onEnterHub:i,onPOIAction:a,room:l})=>{const[o,c]=Ne.useState(Date.now());if(Ne.useEffect(()=>{const d=setInterval(()=>c(Date.now()),1e3);return()=>clearInterval(d)},[]),t==="kingdom")return null;const u=s.activeProcesses||[];return r.jsx(r.Fragment,{children:Ni.map(d=>{var Y,W,H,M;const f=u.find(U=>U.locationId===d.id&&U.readyAt>o),h=f?Math.ceil((f.readyAt-o)/1e3):0,m=h>0;if(!(t==="global"?!d.parentId:d.parentId===t))return null;const x=s.role==="KING"&&d.id!=="peasant_farm"||d.roles.includes(s.role)||d.id==="market"||d.isHub,b=["grain_fields","flax_field","forest_clearing","mine_shaft","quarry_poi","forest_forage"].includes(d.id),g=t==="global",p=g&&e==="region_ost",y=g&&(e==="region_vest"||e==="capital"),k=t==="village",N=Object.values(l.players||{});let S=d.top,w=d.left;k&&d.village?(S=d.village.top,w=d.village.left):p&&d.ost?(S=d.ost.top,w=d.ost.left):y&&d.vest&&(S=d.vest.top,w=d.vest.left);const E=d.id==="castle",j=E&&N.some(U=>U.role==="BARON"&&U.regionId===e||e==="capital"&&U.role==="KING"),A=E?e==="capital"?"throne_room":e==="region_ost"?"manor_ost":"manor_vest":"",L=(E&&((M=(H=(W=(Y=l.world)==null?void 0:Y.settlement)==null?void 0:W.buildings)==null?void 0:H[A])==null?void 0:M.level)||0)>=1||j;return r.jsx(q.div,{style:{top:S,left:w},initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"absolute -translate-x-1/2 -translate-y-1/2 group z-20 pointer-events-auto",children:r.jsxs("button",{onClick:()=>{if(E&&!L){a(d.id,"OPEN_CONSTRUCTION");return}d.isHub?i(d.id):n(d)},className:`flex flex-col items-center transition-all ${x?"scale-100":"scale-75 opacity-40 grayscale pointer-events-none"}`,children:[r.jsxs("div",{className:"w-16 h-16 rounded-3xl flex items-center justify-center text-4xl shadow-2xl border-2 transition-all duration-300 group-hover:scale-110 bg-slate-900/90 backdrop-blur-xl border-white/10 hover:bg-slate-800 overflow-hidden relative",children:[d.icon,m&&r.jsxs("div",{className:"absolute inset-0 bg-slate-900/60 backdrop-blur-[2px] rounded-3xl flex flex-col items-center justify-center z-10 transition-all group-hover:scale-110",children:[r.jsx(pp,{className:"w-5 h-5 text-indigo-400 mb-0.5 animate-pulse"}),r.jsxs("span",{className:"text-white font-black text-xs",children:[h,"s"]})]})]}),r.jsx("span",{className:"bg-indigo-600 text-white text-[10px] font-black uppercase tracking-widest px-3 py-1 rounded-full mt-2 shadow-2xl opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap shadow-indigo-600/30",children:m?`KLAR OM ${h}S`:b?"KLIKK FOR  STARTE":E?L?"G INN":"BIDRA TIL BYGGING":d.label})]})},d.id)})})},EF=({viewMode:t,viewingRegionId:e,worldEvents:s,onSelect:n})=>t==="kingdom"||!s?null:r.jsx(r.Fragment,{children:Object.values(s).map(i=>{const a=Ni.find(m=>m.id===i.locationId);if(!a||!(t==="global"?!a.parentId:a.parentId===t))return null;const o=t==="global",c=o&&e==="region_ost",u=o&&(e==="region_vest"||e==="capital"),d=t==="village";let f=a.top,h=a.left;return d&&a.village?(f=a.village.top,h=a.village.left):c&&a.ost?(f=a.ost.top,h=a.ost.left):u&&a.vest&&(f=a.vest.top,h=a.vest.left),r.jsx(q.div,{style:{top:f,left:h},initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},className:"absolute -translate-x-1/2 -translate-y-[150%] z-30 pointer-events-auto",children:r.jsx("button",{onClick:()=>n(i),className:`w-14 h-14 rounded-full flex items-center justify-center text-3xl shadow-[0_0_30px_rgba(255,255,255,0.4)] border-4 animate-bounce hover:scale-110 transition-transform ${i.type==="RAID"?"bg-rose-600 border-rose-900 text-white":"bg-amber-400 border-amber-700 text-slate-800"}`,children:i.type==="RAID"?"":""})},i.id)})}),jF=({players:t,setViewingRegionId:e,setViewMode:s,currentUserId:n})=>{const i=t[n],a=i==null?void 0:i.role,l=d=>{if(i){if(i.regionId===d){e(d),s("global");return}if(a==="MERCHANT"||a==="KING"){e(d),s("global");return}alert("Du kan ikke se inn i andre regioner. Du m reise dit med Karavanen!")}},o=Object.values(t||{}),c=o.find(d=>{var f;return d.role==="BARON"&&(d.regionId==="region_vest"||((f=d.regionId)==null?void 0:f.includes("vest")))}),u=o.find(d=>{var f;return d.role==="BARON"&&(d.regionId==="region_ost"||((f=d.regionId)==null?void 0:f.includes("ost")))});return r.jsxs(r.Fragment,{children:[r.jsx(q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"absolute top-[35%] left-[50%] -translate-x-1/2 -translate-y-1/2 z-30 group pointer-events-auto",children:r.jsxs("button",{onClick:()=>l("capital"),className:"flex flex-col items-center hover:scale-110 transition-transform",children:[r.jsx("div",{className:"text-6xl drop-shadow-[0_0_15px_rgba(255,215,0,0.8)] animate-pulse",children:""}),r.jsx("div",{className:"bg-black/80 text-amber-400 px-4 py-2 rounded-xl mt-2 font-black uppercase tracking-widest text-xs border border-amber-500/50 shadow-xl backdrop-blur-md",children:"Kongeriket"})]})}),r.jsx(q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"absolute top-[65%] left-[15%] -translate-x-1/2 -translate-y-1/2 z-30 group pointer-events-auto",children:r.jsxs("button",{onClick:()=>l("region_vest"),className:"flex flex-col items-center hover:scale-110 transition-transform",children:[r.jsx("div",{className:"text-5xl drop-shadow-[0_0_10px_rgba(255,255,255,0.5)]",children:""}),r.jsx("div",{className:"bg-black/80 text-indigo-300 px-3 py-1 rounded-xl mt-2 font-bold text-[10px] uppercase tracking-wider border border-white/10 shadow-xl backdrop-blur-md whitespace-nowrap",children:(c==null?void 0:c.name)||"Baroni Vest"})]})}),r.jsx(q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"absolute top-[65%] left-[85%] -translate-x-1/2 -translate-y-1/2 z-30 group pointer-events-auto",children:r.jsxs("button",{onClick:()=>l("region_ost"),className:"flex flex-col items-center hover:scale-110 transition-transform",children:[r.jsx("div",{className:"text-5xl drop-shadow-[0_0_10px_rgba(255,255,255,0.5)]",children:""}),r.jsx("div",{className:"bg-black/80 text-emerald-300 px-3 py-1 rounded-xl mt-2 font-bold text-[10px] uppercase tracking-wider border border-white/10 shadow-xl backdrop-blur-md whitespace-nowrap",children:(u==null?void 0:u.name)||"Baroni st"})]})})]})},H_=({player:t,room:e,onAction:s,onClose:n,viewingRegionId:i,initialProjectId:a})=>{var w,E,j,A;const l=i==="dock_hub"?["wharf"]:i==="region_ost"?["manor_ost"]:i==="region_vest"?["manor_vest"]:i==="capital"||t.role==="BARON"||t.role==="KING"?["throne_room","manor_ost","manor_vest","wharf"]:["throne_room"],o=a&&(l.includes(a)||["throne_room","wharf"].includes(a))?a:l[0],[c,u]=_.useState(o),d=((E=(w=e.world)==null?void 0:w.settlement)==null?void 0:E.buildings)||{},f=l.filter(O=>d[O]),h=f.includes(c)?c:f[0]||c,m=d[h],v=cs[h];if(!m||!v)return r.jsx(tn,{title:"Gjenoppbygging",onClose:n,children:r.jsxs("div",{className:"flex flex-col items-center justify-center h-96 text-center p-12",children:[r.jsx("div",{className:"w-16 h-16 bg-slate-900 rounded-full flex items-center justify-center mb-6 text-2xl opacity-50",children:""}),r.jsx("h3",{className:"text-xl font-black text-white italic mb-2",children:"Ingen aktive byggeprosjekter"}),r.jsx("p",{className:"text-slate-500 text-sm max-w-xs",children:"Det er ingen storsltte prosjekter i dette omrdet som krever din hjelp akkurat n. Prv  dra til hovedstaden eller et av baroniene."}),r.jsx("button",{onClick:n,className:"mt-8 px-8 py-3 bg-white/5 hover:bg-white/10 rounded-xl text-[11px] font-black uppercase tracking-widest text-slate-400",children:"Lukk vindu"})]})});const x=(m.level||0)+1,b=((A=(j=v.levels)==null?void 0:j[x])==null?void 0:A.requirements)||{},g=m.contributions||{};let p=0,y=0;Object.entries(b).forEach(([O,L])=>{var Y;p+=L,y+=((Y=m.progress)==null?void 0:Y[O])||0});const k=p>0?y/p*100:0,N=(O,L)=>{s({type:"CONTRIBUTE",buildingId:h,resource:O,amount:L})},S=Object.entries(g).map(([O,L])=>{const Y=te.CONTRIBUTION_VALUES;let W=0;return Object.entries(L.resources||{}).forEach(([H,M])=>{W+=M*(Y[H]||Y.default)}),{id:O,name:L.name,total:W}}).sort((O,L)=>L.total-O.total);return r.jsx(tn,{title:"Gjenoppbygging & Lederskap",onClose:n,children:r.jsxs("div",{className:"max-h-[70vh] overflow-y-auto custom-scrollbar p-1",children:[f.length>1&&r.jsx("div",{className:"flex gap-2 mb-6 bg-slate-900/50 p-1.5 rounded-2xl border border-white/5 w-fit",children:f.map(O=>{var L;return r.jsx("button",{onClick:()=>u(O),className:`px-4 py-2 rounded-xl text-[11px] font-black uppercase tracking-widest transition-all ${h===O?"bg-indigo-600 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:((L=cs[O])==null?void 0:L.name)||O},O)})}),r.jsxs("div",{className:"relative h-48 rounded-3xl overflow-hidden mb-8 group border border-white/5",children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-950 via-slate-900/40 to-transparent z-10"}),r.jsx("img",{src:`/Simulation_StandAlone_Pro/antigravity/brain/07597a3b-439f-498d-aa43-1b02768f5015/${h==="throne_room"?"maritime_shipyard_blueprint_bg_1768089214778.png":"maritime_wharf_upgrade_epic_1768089228676.png"}`,alt:v.name,className:"w-full h-48 object-cover rounded-2xl mb-6 shadow-2xl border border-white/10"}),r.jsxs("div",{className:"absolute bottom-6 left-8 z-20",children:[r.jsx("h3",{className:"text-3xl font-black text-white italic tracking-tighter uppercase",children:v.name}),r.jsx("p",{className:"text-slate-300 font-medium text-xs max-w-md",children:v.description})]}),r.jsxs("div",{className:"absolute top-6 right-8 z-20 flex flex-col items-end gap-2",children:[r.jsx("div",{className:"bg-emerald-500/20 backdrop-blur-md px-4 py-2 rounded-full border border-emerald-500/30",children:r.jsxs("span",{className:"text-emerald-400 font-black text-xs tabular-nums",children:[k.toFixed(0),"% FULLFRT"]})}),r.jsx("div",{className:"bg-white/5 backdrop-blur-md px-3 py-1 rounded-full border border-white/10 opacity-40",children:r.jsxs("span",{className:"text-white/60 font-bold text-[11px] uppercase tracking-tighter",children:["DB Niv: ",m.level||0," / Max: ",Object.keys(v.levels||{}).length]})})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[r.jsx("div",{className:"space-y-6",children:r.jsxs("section",{children:[r.jsx("h4",{className:"text-[11px] font-black text-slate-500 uppercase tracking-widest mb-4",children:"Mangler for ferdigstillelse"}),r.jsx("div",{className:"space-y-4",children:Object.entries(b).map(([O,L])=>{var C,T,R,D,I;const Y=((C=m.progress)==null?void 0:C[O])||0,W=L,H=Math.min(100,Y/W*100),M=Y>=W,U=((T=t.resources)==null?void 0:T[O])||0;return r.jsxs("div",{className:`p-4 rounded-2xl border transition-all ${M?"bg-emerald-500/5 border-emerald-500/20":"bg-slate-900/50 border-white/5"}`,children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:"text-xl",children:((R=Ie[O])==null?void 0:R.icon)||""}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-bold text-white tracking-tight italic",children:((D=Ie[O])==null?void 0:D.label)||O}),r.jsxs("p",{className:"text-[11px] text-slate-500 font-medium",children:["Beholdning: ",r.jsx("span",{className:"text-slate-300",children:typeof U=="number"?U.toLocaleString():U})]})]})]}),r.jsx("div",{className:"text-right",children:r.jsxs("span",{className:`text-xs font-black ${M?"text-emerald-400":"text-slate-300"}`,children:[Y," / ",W]})})]}),r.jsx("div",{className:"h-1.5 w-full bg-slate-950 rounded-full overflow-hidden mb-4",children:r.jsx("div",{style:{width:`${H}%`},className:`h-full transition-all duration-500 ${M?"bg-emerald-500":"bg-indigo-500"}`})}),(U>0||M)&&r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>N(O,Math.min(10,U||1)),className:`flex-1 py-2 rounded-xl text-[11px] font-black text-white transition-all uppercase border
                                                            ${M?"bg-white/5 border-white/10 opacity-50":"bg-white/5 hover:bg-white/10 border-white/10"}
                                                        `,children:M?"Lager Fullt":"Gi 10"}),r.jsx("button",{onClick:()=>N(O,Math.min(50,U||1)),className:`flex-1 py-2 rounded-xl text-[11px] font-black text-white transition-all uppercase
                                                            ${M?"bg-indigo-600/20 text-indigo-300/50 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-500"}
                                                        `,children:M?"Fullfrt":"Gi 50"})]}),U<=0&&!M&&r.jsx("div",{className:"py-2 text-center bg-black/20 rounded-xl border border-white/5",children:r.jsxs("span",{className:"text-[11px] font-black text-slate-600 uppercase tracking-widest",children:["Du mangler ",((I=Ie[O])==null?void 0:I.label)||O]})})]},O)})})]})}),r.jsxs("div",{className:"space-y-8",children:[r.jsxs("section",{className:"bg-slate-900/50 border border-white/5 rounded-[2rem] p-6",children:[r.jsx("h4",{className:"text-[11px] font-black text-slate-500 uppercase tracking-widest mb-6 px-2",children:"Toppbidragsytere"}),r.jsx("div",{className:"space-y-2",children:S.length===0?r.jsx("div",{className:"text-center py-8 text-slate-500 text-xs italic",children:"Ingen bidrag enda. Bli den frste!"}):S.slice(0,5).map((O,L)=>r.jsxs("div",{className:`flex items-center justify-between p-3 rounded-xl ${L===0?"bg-amber-500/10 border border-amber-500/20":"hover:bg-white/5 transition-colors"}`,children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`w-6 h-6 rounded-lg flex items-center justify-center text-[11px] font-black ${L===0?"bg-amber-500 text-slate-950":"bg-slate-800 text-slate-400"}`,children:L+1}),r.jsx("span",{className:`text-sm font-bold ${L===0?"text-white":"text-slate-300"}`,children:O.name})]}),r.jsxs("span",{className:"text-xs font-mono text-slate-500",children:[O.total.toLocaleString()," poeng"]})]},O.id))})]}),r.jsxs("section",{className:"bg-indigo-600/10 border border-indigo-500/20 rounded-[2rem] p-6 relative overflow-hidden",children:[r.jsx("div",{className:"absolute -top-4 -right-4 w-24 h-24 bg-indigo-500/10 blur-2xl rounded-full"}),r.jsx("h4",{className:"text-[11px] font-black text-indigo-400 uppercase tracking-widest mb-4",children:"Gevinst"}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("span",{className:"text-4xl",children:c==="throne_room"?"":""}),r.jsxs("div",{children:[r.jsx("p",{className:"text-white font-black italic tracking-tight underline decoration-indigo-500/50",children:c==="throne_room"?"TITTEL: KONGE":"TITTEL: BARON"}),r.jsx("p",{className:"text-slate-400 text-xs mt-1",children:"Spilleren med hyest poengsum ved ferdigstillelse overtar styringen."})]})]})]})]})]})]})})},bm=[{level:0,label:"Gammelt Trestativ",slots:2,cost:{wood:50},visual:"wood"},{level:1,label:"Forsterket Jernstativ",slots:4,cost:{wood:100,ore:50},visual:"iron"},{level:2,label:"Forgylt Kongestativ",slots:6,cost:{wood:200,ore:100,gold:500},visual:"gold"}],TF=[{id:"trophy_rusty_sword",label:"Rustent Sverd",desc:"Funnet i myra.",price:50,icon:r.jsx(af,{size:24,className:"text-amber-800"})},{id:"trophy_broken_shield",label:"Knust Skjold",desc:"Fra et glemt slag.",price:100,icon:r.jsx(ib,{size:24,className:"text-slate-600"})},{id:"trophy_golden_chalice",label:"Gullbeger",desc:"Kanskje litt uekte gull?",price:500,icon:r.jsx(mc,{size:24,className:"text-yellow-400"})},{id:"trophy_dragon_skull",label:"Dragehodeskalle",desc:"En fryktinngytende replika.",price:2500,icon:r.jsx("div",{className:"text-2xl",children:""})}],Ej=({level:t,slots:e})=>{const s="#5D4037",n="#3E2723",i="#B7950B",a=()=>t===1?"#263238":t===2?i:n,l={filter:t===2?"drop-shadow(0 0 15px rgba(255, 215, 0, 0.3))":"drop-shadow(0 10px 15px rgba(0,0,0,0.5))"};return r.jsxs("svg",{viewBox:"0 0 400 300",className:"w-full h-full transition-all duration-500",style:l,children:[r.jsxs("defs",{children:[r.jsxs("linearGradient",{id:"woodGradient",x1:"0",y1:"0",x2:"1",y2:"0",children:[r.jsx("stop",{offset:"0%",stopColor:n}),r.jsx("stop",{offset:"50%",stopColor:s}),r.jsx("stop",{offset:"100%",stopColor:n})]}),r.jsxs("linearGradient",{id:"goldGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[r.jsx("stop",{offset:"0%",stopColor:"#FFF9C4"}),r.jsx("stop",{offset:"50%",stopColor:"#FFD700"}),r.jsx("stop",{offset:"100%",stopColor:"#B7950B"})]})]}),r.jsx("ellipse",{cx:"200",cy:"270",rx:"140",ry:"20",fill:"black",opacity:"0.4"}),r.jsx("rect",{x:"60",y:"40",width:"20",height:"240",rx:"4",fill:t===2?"url(#goldGradient)":"url(#woodGradient)",stroke:a(),strokeWidth:"2"}),r.jsx("rect",{x:"320",y:"40",width:"20",height:"240",rx:"4",fill:t===2?"url(#goldGradient)":"url(#woodGradient)",stroke:a(),strokeWidth:"2"}),r.jsx("rect",{x:"50",y:"80",width:"300",height:"15",rx:"4",fill:t===2?"url(#goldGradient)":"url(#woodGradient)",stroke:a(),strokeWidth:"2"}),r.jsx("rect",{x:"50",y:"150",width:"300",height:"15",rx:"4",fill:t===2?"url(#goldGradient)":"url(#woodGradient)",stroke:a(),strokeWidth:"2"}),r.jsx("rect",{x:"50",y:"220",width:"300",height:"15",rx:"4",fill:t===2?"url(#goldGradient)":"url(#woodGradient)",stroke:a(),strokeWidth:"2"}),t>=1&&r.jsxs(r.Fragment,{children:[r.jsx("circle",{cx:"70",cy:"87.5",r:"4",fill:t===2?"black":"#CFD8DC"}),r.jsx("circle",{cx:"330",cy:"87.5",r:"4",fill:t===2?"black":"#CFD8DC"}),r.jsx("circle",{cx:"70",cy:"157.5",r:"4",fill:t===2?"black":"#CFD8DC"}),r.jsx("circle",{cx:"330",cy:"157.5",r:"4",fill:t===2?"black":"#CFD8DC"})]}),e.map((o,c)=>{if(!o||!o.itemId)return null;const u=2,d=Math.floor(c/u),h=c%u===0?140:260,m=90+d*70;return r.jsxs("g",{transform:`translate(${h}, ${m})`,children:[r.jsx("ellipse",{cx:"0",cy:"40",rx:"15",ry:"5",fill:"black",opacity:"0.3"}),o.type==="ITEM"?r.jsxs("g",{transform:"scale(1.2) rotate(15)",children:[r.jsx("path",{d:"M0,-30 L0,30",stroke:"#90A4AE",strokeWidth:"4"}),r.jsx("rect",{x:"-6",y:"-10",width:"12",height:"4",fill:"#546E7A"}),r.jsx("circle",{cx:"0",cy:"32",r:"3",fill:"#FFD700"})]}):r.jsxs("g",{transform:"scale(1.5)",children:[o.itemId==="trophy_rusty_sword"&&r.jsx("text",{x:"-10",y:"10",fontSize:"24",children:""}),o.itemId==="trophy_broken_shield"&&r.jsx("text",{x:"-10",y:"10",fontSize:"24",children:""}),o.itemId==="trophy_golden_chalice"&&r.jsx("text",{x:"-10",y:"10",fontSize:"24",children:""}),o.itemId==="trophy_dragon_skull"&&r.jsx("text",{x:"-12",y:"12",fontSize:"28",children:""})]})]},c)})]})},AF=({player:t,onAction:e,onClose:s})=>{const[n,i]=_.useState("status"),a=t.weaponRack||{},l={level:a.level||0,slots:a.slots||[],unlockedTrophies:a.unlockedTrophies||[],lastPolishedAt:a.lastPolishedAt||0},o=bm.find(p=>p.level===l.level)||bm[0],c=bm.find(p=>p.level===l.level+1),u=o.slots,d=(t.inventory||[]).filter(p=>["MAIN_HAND","OFF_HAND","BODY","HEAD","FEET","AXE","BOW","HAMMER"].includes(p.type));d.sort((p,y)=>(y.value||0)-(p.value||0));const f=p=>{e({type:"RACK_MOUNT_ITEM",itemId:p.id,instanceId:p.id})},h=p=>{e({type:"RACK_MOUNT_TROPHY",trophyId:p})},m=p=>{e({type:"RACK_UNMOUNT",slotId:p})},v=()=>{e({type:"RACK_UPGRADE"})},x=(p,y)=>{e({type:"RACK_BUY_TROPHY",trophyId:p,price:y})},b=()=>{e({type:"RACK_POLISH"})},g=l.slots.length>=u;return r.jsx(tn,{title:"VPENKAMMERET",subtitle:"The Royal Armory",icon:r.jsx(dl,{className:"text-amber-500",size:24}),onClose:s,maxWidth:"max-w-7xl",children:r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6 h-[700px] text-slate-200 select-none overflow-hidden",children:[r.jsxs("div",{className:"lg:col-span-3 flex flex-col bg-slate-900/50 rounded-3xl border border-white/5 overflow-hidden",children:[r.jsxs("div",{className:"p-4 border-b border-white/5 bg-white/5 flex items-center justify-between",children:[r.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-slate-400",children:"Ditt Utstyr"}),r.jsxs("span",{className:"text-[10px] bg-slate-800 px-2 py-1 rounded text-slate-400",children:[d.length," gjenstander"]})]}),r.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-3 space-y-2",children:[d.length===0&&r.jsx("div",{className:"text-center py-10 text-slate-600 text-xs italic",children:"Tomt i sekken..."}),d.map((p,y)=>r.jsxs("button",{disabled:g,onClick:()=>f(p),className:"w-full flex items-center gap-3 p-3 bg-slate-900 rounded-xl border border-white/5 hover:border-indigo-500/50 hover:bg-indigo-500/10 transition-all text-left disabled:opacity-50 group",children:[r.jsx("div",{className:"w-10 h-10 flex items-center justify-center bg-slate-950 rounded-lg border border-white/5 text-lg shadow-inner group-hover:scale-105 transition-transform",children:""}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"font-bold text-base text-indigo-100 truncate group-hover:text-indigo-400 transition-colors",children:p.name}),r.jsx("div",{className:"flex items-center gap-2 text-[10px] text-slate-500",children:r.jsxs("span",{children:["Slitasje: ",p.durability||100,"%"]})})]}),r.jsx("div",{className:"opacity-0 group-hover:opacity-100 text-indigo-400 transition-opacity",children:r.jsx(lj,{size:14})})]},`inv-${y}`))]})]}),r.jsx("div",{className:"lg:col-span-6 flex flex-col relative group",children:r.jsxs("div",{className:"flex-1 bg-gradient-to-b from-slate-900 to-slate-950 rounded-3xl border border-white/10 shadow-2xl relative overflow-hidden flex items-center justify-center",children:[r.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-amber-900/10 via-slate-950/50 to-slate-950 pointer-events-none"}),r.jsx("div",{className:"relative z-10 w-full h-full p-8",children:r.jsx(Ej,{level:l.level,slots:l.slots})}),r.jsx("div",{className:"absolute bottom-8 right-8 z-20",children:(()=>{const p=Date.now(),y=l.lastPolishedAt||0,k=6e4*60,N=p-y,S=N>=k,w=k-N,E=Math.ceil(w/6e4);return r.jsxs("button",{onClick:b,disabled:!S,className:`flex items-center gap-2 px-4 py-3 rounded-full border transition-all backdrop-blur-sm shadow-xl 
                                            ${S?"bg-amber-500/10 hover:bg-amber-500/20 text-amber-500 hover:text-amber-400 border-amber-500/30 hover:border-amber-500/50 hover:shadow-amber-500/10 cursor-pointer":"bg-slate-900/50 text-slate-500 border-slate-700 cursor-not-allowed grayscale"}`,children:[r.jsx(w$,{size:18,className:S?"animate-pulse":""}),r.jsxs("div",{className:"flex flex-col items-start leading-none",children:[r.jsx("span",{className:"text-xs font-bold uppercase tracking-widest",children:S?"Puss Utstyr":"Ny-pusset"}),!S&&r.jsxs("span",{className:"text-[10px] lowercase text-slate-400",children:[E,"m ventetid"]})]})]})})()})]})}),r.jsxs("div",{className:"lg:col-span-3 flex flex-col gap-4",children:[r.jsxs("div",{className:"bg-slate-900/80 rounded-2xl p-2 flex border border-white/10",children:[r.jsx("button",{onClick:()=>i("status"),className:`flex-1 py-2 rounded-xl text-xs font-bold uppercase tracking-widest transition-all ${n==="status"?"bg-slate-800 text-white shadow":"text-slate-500 hover:text-slate-300"}`,children:"Oversikt"}),r.jsx("button",{onClick:()=>i("shop"),className:`flex-1 py-2 rounded-xl text-xs font-bold uppercase tracking-widest transition-all ${n==="shop"?"bg-amber-900/30 text-amber-500 shadow":"text-slate-500 hover:text-slate-300"}`,children:"Trofer"})]}),r.jsxs("div",{className:"flex-1 bg-slate-900/50 rounded-3xl border border-white/5 p-4 overflow-y-auto custom-scrollbar",children:[n==="status"&&r.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4 duration-300",children:[r.jsxs("div",{children:[r.jsxs("h4",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500 mb-3 flex justify-between",children:[r.jsx("span",{children:"P Veggen"}),r.jsxs("span",{children:[l.slots.length," / ",u]})]}),r.jsxs("div",{className:"space-y-2",children:[l.slots.length===0&&r.jsx("div",{className:"text-xs text-slate-600 italic",children:"Tomt stativ..."}),l.slots.map(p=>r.jsxs("div",{className:"flex items-center gap-3 p-2 bg-slate-800/50 rounded-lg border border-white/5",children:[r.jsx("div",{className:"text-lg",children:p.type==="TROPHY"?"":""}),r.jsx("div",{className:"flex-1 min-w-0",children:r.jsx("div",{className:"text-sm font-bold text-slate-300 truncate",children:p.itemId})}),r.jsx("button",{onClick:()=>m(p.id),className:"text-rose-500 hover:text-rose-400 p-1 hover:bg-rose-500/10 rounded",children:r.jsx("span",{className:"text-xs",children:""})})]},p.id))]})]}),r.jsxs("div",{className:"mt-auto pt-6 border-t border-white/5",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[r.jsx(YU,{className:"text-amber-500",size:16}),r.jsx("h4",{className:"text-xs font-black uppercase tracking-widest text-amber-500",children:"Neste Niv"})]}),c?r.jsxs("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 p-4 rounded-xl border border-white/5",children:[r.jsx("div",{className:"text-sm font-bold text-white mb-2",children:c.label}),r.jsxs("div",{className:"text-[10px] text-slate-400 mb-4",children:["ker kapasiteten til ",r.jsxs("span",{className:"text-amber-400 font-bold",children:[c.slots," plasser"]}),"."]}),r.jsx("div",{className:"grid grid-cols-2 gap-2 mb-4",children:Object.entries(c.cost).map(([p,y])=>r.jsxs("div",{className:`text-xs px-2 py-1 rounded bg-slate-950 flex justify-between ${t.resources[p]>=y?"text-slate-300":"text-rose-400"}`,children:[r.jsx("span",{className:"capitalize",children:p}),r.jsx("span",{className:"font-mono",children:y})]},p))}),r.jsx("button",{onClick:v,disabled:!1,className:"w-full py-2 bg-amber-600 hover:bg-amber-500 text-white rounded-lg font-bold text-xs shadow-lg shadow-amber-900/20 transition-all uppercase tracking-wider",children:"Oppgrader"})]}):r.jsx("div",{className:"text-center py-4 text-emerald-500 text-xs font-bold bg-emerald-500/10 rounded-xl border border-emerald-500/20",children:"Maksimalt niv ndd!"})]})]}),n==="shop"&&r.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-right-4 duration-300",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2 p-3 bg-amber-900/10 border border-amber-500/20 rounded-xl text-amber-200 text-xs",children:[r.jsx(Hi,{size:14,className:"text-amber-400"}),r.jsx("span",{children:"Kjp unike trofer for re og bermmelse!"})]}),TF.map(p=>{const y=l.unlockedTrophies.includes(p.id),k=(t.resources.gold||0)>=p.price;return r.jsx("div",{className:"relative p-3 bg-slate-800/40 rounded-xl border border-white/5 hover:bg-slate-800/80 transition-all group",children:r.jsxs("div",{className:"flex gap-3",children:[r.jsx("div",{className:"w-12 h-12 rounded-lg bg-black/40 flex items-center justify-center text-2xl shadow-inner group-hover:scale-110 transition-transform duration-300",children:p.icon}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h4",{className:"font-bold text-sm text-slate-200",children:p.label}),r.jsx("p",{className:"text-xs text-slate-500 mt-1",children:p.desc}),r.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[r.jsxs("span",{className:"font-mono text-amber-500 font-bold text-xs",children:[p.price,"g"]}),y?l.slots.some(N=>N.itemId===p.id)?r.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider bg-slate-800 px-2 py-0.5 rounded",children:"P veggen"}):r.jsx("button",{onClick:()=>h(p.id),disabled:g,className:"px-3 py-1 rounded text-[10px] font-bold uppercase tracking-wider transition-colors bg-emerald-600/20 text-emerald-400 hover:bg-emerald-600 hover:text-white disabled:opacity-50 disabled:cursor-not-allowed",children:"Heng Opp"}):r.jsx("button",{onClick:()=>x(p.id,p.price),disabled:!k,className:`px-3 py-1 rounded text-[10px] font-bold uppercase tracking-wider transition-colors ${k?"bg-amber-600/20 text-amber-400 hover:bg-amber-600 hover:text-white":"bg-slate-800 text-slate-600 cursor-not-allowed"}`,children:"Kjp"})]})]})]})},p.id)})]})]})]})]})})},vm={standard:"M-150,-40 Q-120,-40 0,-50 Q120,-40 150,0 Q120,40 0,50 Q-120,40 -150,40 L-150,-40 Z",sloop:"M-140,-35 Q-100,-35 0,-45 Q100,-35 160,0 Q100,35 0,45 Q-100,35 -140,35 L-140,-35 Z",cog:"M-160,-50 Q-120,-50 0,-60 Q120,-50 140,0 Q120,50 0,60 Q-120,50 -160,50 L-160,-50 Z",galleon:"M-180,-55 Q-130,-55 0,-65 Q130,-55 170,0 Q130,55 0,65 Q-130,55 -180,55 L-180,-55 Z"},$_={standard:"M-40,-70 Q10,-70 20,0 Q10,70 -40,70",sloop:"M-60,-80 Q20,-60 60,0 Q20,60 -60,80 L-50,0 Z",cog:"M-50,-90 Q0,-90 50,0 Q0,90 -50,90",galleon:"M-60,-100 Q10,-100 60,-30 Q10,-30 -60,-30 M-50,30 Q10,30 50,90 Q10,90 -50,90"},lf=Ne.memo(({stage:t,model:e="standard",componentLevels:s={sails:0,hull:0,cannons:0,nets:0},view:n="top",variant:i="standard",customization:a={},scale:l=1,rotation:o=0,className:c=""})=>{const u=i==="drafting",d={standard:{hullFill:a.color||"#453020",hullStroke:"#2a1b12",deckFill:"#1a0f0a",deckOpacity:.4,sailFill:a.sailPattern==="striped"?"url(#stripedPattern)":"#f0e6d2",sailStroke:(s.sails||0)>=3?"#b45309":"#a8a29e",metal:"#3f3f46",wood:"#453020",gold:"#d97706"},drafting:{hullFill:"#f5f5f4",hullStroke:"#1c1917",deckFill:"#e7e5e4",deckOpacity:1,sailFill:"#fafaf9",sailStroke:"#1c1917",metal:"#44403c",wood:"#57534e",gold:"#1c1917"}},f=u?d.drafting:d.standard,h=u?"2.5":"4",m=u?"url(#inkRoughness)":"none",v=u?"300 5":"none",x=t<4,b=vm[e]||vm.standard,g=$_[e]||$_.standard,p=s.cannons||0;return n==="side"?r.jsxs(q.svg,{viewBox:"0 0 400 300",className:`w-full h-full ${c}`,initial:!1,animate:{scale:l},style:{filter:u?"none":"drop-shadow(0 4px 6px rgba(0,0,0,0.3))"},transition:{type:"spring",stiffness:300,damping:30},children:[u&&r.jsx("defs",{children:r.jsxs("filter",{id:"inkRoughness",children:[r.jsx("feTurbulence",{type:"fractalNoise",baseFrequency:"0.04",numOctaves:"3",result:"noise"}),r.jsx("feDisplacementMap",{in:"SourceGraphic",in2:"noise",scale:"2"})]})}),r.jsxs("g",{transform:"translate(200, 180)",filter:m,children:[t>=1&&r.jsx("g",{id:"hull-side",children:r.jsx("path",{d:e==="galleon"?"M-190,-40 Q-100,50 0,60 Q100,50 180,-40 L160,-50 L-160,-50 Z":"M-160,-20 Q-150,40 0,50 Q150,40 160,-30 L140,-40 L-140,-40 Z",fill:f.hullFill,stroke:f.hullStroke,strokeWidth:h,strokeLinecap:"round",strokeDasharray:v})}),t>=2&&r.jsxs("g",{id:"mast-side",children:[r.jsx("rect",{x:"-4",y:"-180",width:"8",height:"150",rx:"2",fill:u?"none":f.wood,stroke:f.wood,strokeWidth:u?2:0}),r.jsx(q.path,{d:"M0,-145 Q60,-90 0,-20",fill:f.sailFill,stroke:f.sailStroke,strokeWidth:"2",strokeDasharray:u?"4 2":"none",animate:{d:["M0,-145 Q60,-90 0,-20","M0,-145 Q80,-90 0,-20","M0,-145 Q60,-90 0,-20"]},transition:{repeat:1/0,duration:6,ease:"easeInOut"}})]})]})]}):r.jsxs(q.svg,{viewBox:"0 0 400 300",className:`w-full h-full ${c}`,style:{rotate:o},initial:!1,animate:{scale:l},transition:{type:"spring",stiffness:300,damping:30},children:[u&&r.jsx("defs",{children:r.jsxs("filter",{id:"inkRoughness",children:[r.jsx("feTurbulence",{type:"fractalNoise",baseFrequency:"0.04",numOctaves:"3",result:"noise"}),r.jsx("feDisplacementMap",{in:"SourceGraphic",in2:"noise",scale:"2"})]})}),r.jsxs("g",{transform:"translate(200, 150) scale(1)",filter:m,children:[t>=1&&r.jsxs("g",{id:"hull",children:[r.jsx("path",{d:x?vm.standard:b,fill:f.hullFill,stroke:f.hullStroke,strokeWidth:h,strokeLinecap:"round"}),r.jsx("path",{d:"M-130,-30 L110,-30 L130,0 L110,30 L-130,30 Z",fill:f.deckFill,fillOpacity:f.deckOpacity})]}),!x&&p>0&&r.jsxs("g",{id:"cannons",children:[r.jsx("rect",{x:"-80",y:"-45",width:"20",height:"8",fill:f.metal,stroke:u?f.hullStroke:"none",strokeWidth:"1"}),r.jsx("rect",{x:"-40",y:"-48",width:"20",height:"8",fill:f.metal,stroke:u?f.hullStroke:"none",strokeWidth:"1"}),r.jsx("rect",{x:"0",y:"-50",width:"20",height:"8",fill:f.metal,stroke:u?f.hullStroke:"none",strokeWidth:"1"}),r.jsx("rect",{x:"-80",y:"37",width:"20",height:"8",fill:f.metal,stroke:u?f.hullStroke:"none",strokeWidth:"1"}),r.jsx("rect",{x:"-40",y:"40",width:"20",height:"8",fill:f.metal,stroke:u?f.hullStroke:"none",strokeWidth:"1"}),r.jsx("rect",{x:"0",y:"42",width:"20",height:"8",fill:f.metal,stroke:u?f.hullStroke:"none",strokeWidth:"1"}),e==="galleon"&&r.jsxs(r.Fragment,{children:[r.jsx("rect",{x:"-120",y:"-42",width:"20",height:"8",fill:f.metal,stroke:u?f.hullStroke:"none",strokeWidth:"1"}),r.jsx("rect",{x:"-120",y:"34",width:"20",height:"8",fill:f.metal,stroke:u?f.hullStroke:"none",strokeWidth:"1"})]})]}),t>=2&&r.jsxs("g",{id:"mast-rigging",children:[r.jsx("circle",{cx:"0",cy:"0",r:"6",fill:f.wood}),r.jsx("rect",{x:"-4",y:"-80",width:"8",height:"160",rx:"2",fill:f.wood,transform:"rotate(90)"}),r.jsx("path",{d:g,fill:f.sailFill,stroke:f.sailStroke,strokeWidth:"2",opacity:u?1:.9,strokeDasharray:u?"4 2":"none"}),r.jsx(q.path,{d:"M-4,-80 L-40,-70 L-40,-90 Z",fill:u?f.gold:a.color||"#ef4444",animate:{scaleX:[1,1.2,1],rotate:[0,5,0]},transition:{repeat:1/0,duration:1.5}})]})]})]})},(t,e)=>{var s,n,i,a,l,o;return t.stage===e.stage&&t.model===e.model&&t.view===e.view&&t.variant===e.variant&&t.scale===e.scale&&t.rotation===e.rotation&&((s=t.customization)==null?void 0:s.color)===((n=e.customization)==null?void 0:n.color)&&((i=t.componentLevels)==null?void 0:i.sails)===((a=e.componentLevels)==null?void 0:a.sails)&&((l=t.componentLevels)==null?void 0:l.cannons)===((o=e.componentLevels)==null?void 0:o.cannons)}),RF=({children:t,color:e="amber"})=>r.jsx("div",{className:`px-4 py-1.5 rounded-full bg-${e}-500/20 border border-${e}-400/30 text-${e}-400 text-[11px] font-black uppercase tracking-widest shadow-[0_0_20px_rgba(0,0,0,0.3)]`,children:t}),ym=({children:t,onClick:e,disabled:s,variant:n="primary"})=>r.jsx("button",{onClick:e,disabled:s,className:`px-8 py-4 rounded-2xl font-black uppercase italic tracking-tighter transition-all active:scale-95 flex items-center gap-3
            ${s?"opacity-30 cursor-not-allowed grayscale":"hover:scale-105"}
            ${n==="primary"?"bg-amber-500 text-slate-950 shadow-[0_10px_30px_rgba(245,158,11,0.2)]":""}
            ${n==="ghost"?"bg-white/5 text-white border border-white/10 hover:bg-white/10":""}
            ${n==="danger"?"bg-red-500/20 text-red-400 border border-red-500/30 hover:bg-red-500/30":""}
        `,children:t}),CF=({player:t,world:e,onAction:s})=>{var h,m;const{season:n,time:i}=e,a=((h=t.boat)==null?void 0:h.isDamaged)||!1,l=((m=t.boat)==null?void 0:m.cannonballs)||0,o=t.resources.cannonball||0,c=t.boat&&t.boat.stage>=2&&!a,u=n.toLowerCase(),d=i.toLowerCase(),f=`/Simulation_StandAlone_Pro/assets/maritime/dock_${u}_${d}.png`;return r.jsxs("div",{className:"relative w-full h-full overflow-hidden bg-slate-950 flex flex-col items-center justify-center font-sans tracking-tight",children:[r.jsxs("div",{className:"absolute inset-0 z-0",children:[r.jsx(lb,{src:f,alt:`${n} ${i} Dock View`,className:"w-full h-full object-cover brightness-[0.7] contrast-[1.1]",disableMotion:!0}),r.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-950/90 via-transparent to-slate-950/40 pointer-events-none"})]}),r.jsx(kt,{children:t.boat&&t.boat.stage>0&&r.jsx(q.div,{initial:{x:-100,opacity:0},animate:{x:0,opacity:1,y:[0,-10,0]},transition:{y:{repeat:1/0,duration:6,ease:"easeInOut"},default:{type:"spring",damping:20}},className:"absolute bottom-[5%] left-[5%] w-[800px] h-[500px] z-10 pointer-events-none drop-shadow-[0_40px_80px_rgba(0,0,0,0.8)]",children:r.jsx(lf,{stage:t.boat.stage,view:"side",customization:t.boat.customization,scale:.85,className:"drop-shadow-[0_10px_20px_rgba(0,0,0,0.7)]"})})}),r.jsxs("div",{className:"relative z-20 w-full h-full flex flex-col justify-between p-12",children:[r.jsxs("div",{className:"flex justify-between items-start pt-16",children:[r.jsx(q.div,{initial:{x:-50,opacity:0},animate:{x:0,opacity:1},className:"bg-slate-950/40 backdrop-blur-2xl border border-white/5 p-6 rounded-[2rem] shadow-2xl",children:r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx(RF,{color:"amber",children:"Maritim Hub"}),r.jsx("div",{className:"h-px w-12 bg-white/10"}),r.jsxs("span",{className:"text-white/40 text-[10px] uppercase font-black tracking-widest",children:["Region ",t.regionId==="region_vest"?"Vest":"st"]})]}),r.jsx("h1",{className:"text-8xl font-black text-white italic tracking-tighter leading-none mb-2 drop-shadow-2xl",children:"KAIA"}),r.jsx("p",{className:"text-slate-400 text-base max-w-[280px] leading-relaxed font-medium",children:t.boat?"Bten din ligger klar ved bryggen. Vinden er gunstig.":"Verftet venter. Legg ned den frste kjlen for  erobre havet."})]})}),t.boat&&r.jsxs(q.div,{initial:{x:50,opacity:0},animate:{x:0,opacity:1},className:"w-72 bg-slate-950/40 backdrop-blur-3xl border border-white/10 p-6 rounded-[2rem] shadow-2xl flex flex-col gap-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-white font-black italic uppercase tracking-tighter",children:"Arsenalet"}),r.jsx(mj,{className:"text-amber-500",size:20})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-white/5 p-4 rounded-2xl border border-white/5",children:[r.jsx("span",{className:"text-white/40 text-[9px] uppercase font-bold block mb-1",children:"I Lasterom"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(rj,{size:14,className:"text-amber-400"}),r.jsx("span",{className:"text-xl font-black text-white italic",children:l})]})]}),r.jsxs("div",{className:"bg-white/5 p-4 rounded-2xl border border-white/5",children:[r.jsx("span",{className:"text-white/40 text-[9px] uppercase font-bold block mb-1",children:"Ryggsekk"}),r.jsx("div",{className:"flex items-center gap-2",children:r.jsx("span",{className:"text-xl font-black text-white italic",children:o})})]})]}),r.jsx("button",{onClick:()=>s("REFILL_AMMO"),disabled:o<=0,className:`w-full py-4 rounded-2xl font-black uppercase italic text-xs tracking-widest transition-all
                                    ${o>0?"bg-white text-slate-950 hover:scale-[1.02] active:scale-95 shadow-xl":"bg-white/5 text-white/20 cursor-not-allowed"}
                                `,children:"Last ombord"})]})]}),r.jsx(q.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},className:"flex justify-center gap-6",children:r.jsxs("div",{className:"flex items-center gap-6 bg-slate-950/20 backdrop-blur-md p-4 rounded-[2.5rem] border border-white/5 shadow-2xl",children:[r.jsxs(ym,{variant:"ghost",onClick:()=>s("OPEN_SHIPYARD"),children:[r.jsx(dl,{size:18})," Verftet"]}),r.jsxs(ym,{disabled:!c,onClick:()=>s("START_SAILING"),variant:c?"primary":"ghost",children:[r.jsx(hj,{size:20}),a?"SKADET SKROG!":"Sette Seil"]}),a&&r.jsxs(ym,{variant:"danger",onClick:()=>s("REPAIR_BOAT"),children:[r.jsx(xj,{size:18})," Reparer"]})]})})]}),r.jsx("div",{className:"absolute top-[45%] w-full h-px bg-white/5 shadow-[0_0_50px_rgba(255,255,255,0.1)] pointer-events-none"})]})},jj=_.memo(({stage:t,model:e,componentLevels:s,customization:n})=>r.jsxs("div",{className:"absolute inset-0 flex items-center justify-center p-12 overflow-hidden",children:[r.jsx("div",{className:"absolute inset-0 opacity-10 pointer-events-none mix-blend-multiply",style:{backgroundColor:"#1c1917",backgroundImage:"radial-gradient(circle at center, #292524 0%, #1c1917 100%)"}}),r.jsx(q.div,{initial:{opacity:0,scale:.95,filter:"blur(2px)"},animate:{opacity:1,scale:1,filter:"blur(0px)"},transition:{duration:.8,ease:"easeInOut"},className:"w-full h-full relative z-10",children:r.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:r.jsx(lf,{stage:t,model:e,componentLevels:s,customization:n,view:"side",variant:"standard",className:"opacity-100 drop-shadow-2xl"})})},e),r.jsx("div",{className:"absolute top-8 left-8 flex flex-col gap-1 pointer-events-none opacity-60",children:r.jsx("span",{className:"font-serif italic text-[#1e293b] text-sm",children:"Fig. 1: Lateral View"})}),r.jsxs("div",{className:"absolute bottom-8 right-8 text-right pointer-events-none opacity-60",children:[r.jsxs("div",{className:"font-serif font-bold text-[#1e293b] text-xs uppercase tracking-widest",children:["Model: ",(e==null?void 0:e.toUpperCase())||"UNKNOWN"]}),r.jsxs("div",{className:"font-mono text-[#57534e] text-[10px] mt-1",children:["REF: ",e?e.toUpperCase().split("").reduce((i,a)=>i+a.charCodeAt(0),0).toString(16).padEnd(4,"0").toUpperCase():"0000"]})]})]}),(t,e)=>t.stage===e.stage&&t.model===e.model&&t.componentLevels===e.componentLevels&&JSON.stringify(t.customization)===JSON.stringify(e.customization));jj.displayName="ShipyardVisualizer";const ku={parchment:"#d6cbb8",inkPrimary:"#0c0a09"},pc=({onClick:t,children:e,disabled:s,variant:n="primary",className:i=""})=>{const a=n==="primary";return r.jsxs(q.button,{whileHover:s?{}:{scale:1.02,y:-1},whileTap:s?{}:{scale:.98,y:1},onClick:t,disabled:s,className:`
                relative px-6 py-2 font-bold uppercase tracking-widest text-xs transition-all
                ${s?"opacity-40 cursor-not-allowed grayscale":"cursor-pointer"}
                ${i}
            `,style:{backgroundColor:a?ku.inkPrimary:"transparent",color:a?ku.parchment:ku.inkPrimary,border:a?"none":`2px solid ${ku.inkPrimary}`,borderRadius:"2px"},children:[!a&&r.jsx("svg",{className:"absolute inset-0 w-full h-full pointer-events-none overflow-visible",style:{opacity:.6},children:r.jsx("path",{d:"M0,0 L100%,0 L100%,100% L0,100% Z",fill:"none",stroke:"currentColor",strokeWidth:"1",strokeDasharray:"4 2"})}),e]})},Tj=({onClick:t,label:e,color:s="#b91c1c"})=>r.jsxs(q.button,{whileHover:{scale:1.1},whileTap:{scale:.95},onClick:t,className:"flex flex-col items-center gap-2 group",children:[r.jsxs("div",{className:"w-16 h-16 rounded-full flex items-center justify-center shadow-lg relative",style:{background:`radial-gradient(circle at 30% 30%, ${s}, #7f1d1d)`,boxShadow:"0 4px 6px rgba(0,0,0,0.3), inset 0 2px 4px rgba(255,255,255,0.2)"},children:[r.jsx("div",{className:"absolute inset-0 border-4 border-dashed border-black/10 rounded-full opacity-50",style:{transform:"rotate(15deg)"}}),r.jsx("span",{className:"font-serif font-black text-white/90 text-xl drop-shadow-md",children:""})]}),e&&r.jsx("span",{className:"font-serif font-bold text-[10px] uppercase tracking-widest text-slate-600 transition-colors group-hover:text-amber-800",children:e})]}),IF=({title:t,level:e,maxLevel:s,description:n,effect:i,cost:a,playerResources:l,onAction:o,actionLabel:c="MONTERE"})=>{const u=e>=s;let d=!0;return u||Object.entries(a).forEach(([f,h])=>{(l[f]||0)<h&&(d=!1)}),r.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-[#a8a29e]/20 hover:bg-[#a8a29e]/5 transition-colors group relative",children:[r.jsxs("div",{className:"flex-1 pr-8",children:[r.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[r.jsx("h4",{className:"font-serif font-bold text-lg text-[#292524]",children:t}),r.jsxs("span",{className:`text-xs font-black px-2 py-0.5 rounded border uppercase tracking-widest ${e>0?"bg-amber-900/10 text-amber-800 border-amber-900/10":"bg-stone-300/50 text-stone-600 border-stone-300"}`,children:["NIV ",e," ",r.jsxs("span",{className:"text-stone-500/80",children:["/ ",s]})]})]}),r.jsx("p",{className:"text-[#44403c] italic font-serif leading-snug mb-2 text-sm max-w-md",children:n}),i&&r.jsxs("div",{className:"text-emerald-700 font-bold text-[10px] uppercase tracking-wider flex items-center gap-2",children:[r.jsx(vp,{size:12}),i]})]}),r.jsx("div",{className:"flex flex-col items-end gap-3 min-w-[240px]",children:u?r.jsx("div",{className:"flex flex-col items-center justify-center py-2 px-6 border border-[#b45309]/30 rounded bg-[#b45309]/10 w-full",children:r.jsxs("span",{className:"text-[#aa5212] font-black uppercase tracking-[0.2em] text-[10px] flex items-center gap-2",children:[r.jsx(vp,{size:10,strokeWidth:3})," Mesterverk"]})}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"flex items-center justify-end gap-3 w-full",children:Object.entries(a).map(([f,h])=>{const m=(l[f]||0)>=h;return r.jsx("div",{className:"flex items-center gap-1.5 opacity-100",children:r.jsx(Hn,{resource:f,amount:h,size:"sm",showLabel:!0,className:m?"text-[#292524]":"text-rose-700 font-bold"})},f)})}),r.jsx(pc,{onClick:o,disabled:!d,className:`w-full py-1.5 text-xs ${d?"":"opacity-50 cursor-not-allowed"}`,children:c})]})})]})},OF=({isOpen:t,onConfirm:e,onCancel:s,title:n,cost:i})=>t?r.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-8",children:r.jsxs(q.div,{initial:{opacity:0,scale:.9,rotate:-2},animate:{opacity:1,scale:1,rotate:0},exit:{opacity:0,scale:.9},className:"bg-[#f2e8d5] p-8 w-full max-w-md shadow-2xl relative rotate-1 border border-[#b45309]/30",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='200' height='200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.1'/%3E%3C/svg%3E")`},children:[r.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2 w-32 h-8 bg-white/40 rotate-1 shadow-sm backdrop-blur-sm"}),r.jsxs("div",{className:"border-b-2 border-dashed border-[#292524]/20 pb-6 mb-6 text-center",children:[r.jsx("h3",{className:"font-serif font-black text-2xl uppercase tracking-widest text-[#2a1b12] mb-1",children:"Faktura"}),r.jsx("p",{className:"font-serif italic text-stone-600 text-sm",children:"Kongelig Skipsverft"})]}),r.jsxs("div",{className:"space-y-6 mb-8",children:[r.jsxs("div",{className:"flex justify-between items-baseline border-b border-stone-300 pb-2",children:[r.jsx("span",{className:"font-bold text-stone-500 text-sm uppercase tracking-wide",children:"Vare"}),r.jsx("span",{className:"font-serif font-bold text-lg text-[#292524]",children:n})]}),r.jsxs("div",{className:"bg-[#e7ded0] p-4 rounded-sm border border-[#d6cbb8]",children:[r.jsx("div",{className:"text-xs font-black uppercase tracking-widest text-[#b45309] mb-3 text-center",children:"Kostnader"}),r.jsx("div",{className:"flex flex-wrap justify-center gap-4 text-[#292524]",children:Object.entries(i).map(([a,l])=>r.jsx("div",{className:"flex items-center gap-2",children:r.jsx(Hn,{resource:a,amount:l,size:"sm",showLabel:!0,className:"text-[#292524]"})},a))})]})]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsx("button",{onClick:s,className:"flex-1 py-3 border-2 border-[#292524]/20 font-bold uppercase tracking-widest text-xs text-[#57534e] hover:bg-[#292524]/5 transition-colors",children:"Avsl"}),r.jsx(pc,{onClick:e,className:"flex-1 py-3",variant:"primary",children:"Signer"})]})]})}):null,MF=[{id:"construct",label:"Construction",icon:dl},{id:"upgrade",label:"The Ledger",icon:MU},{id:"models",label:"Models",icon:eh},{id:"cosmetics",label:"Aesthetics",icon:BH}],DF=({player:t,onClose:e,onAction:s})=>{var d,f,h,m,v,x,b,g,p,y,k,N,S,w,E,j,A,O,L,Y,W,H,M;const[n,i]=_.useState("construct"),a={stage:((d=t.boat)==null?void 0:d.stage)??0,hullType:((f=t.boat)==null?void 0:f.hullType)??"oak_standard",model:((h=t.boat)==null?void 0:h.model)??"standard",hp:(m=t.boat)==null?void 0:m.hp,maxHp:((v=t.boat)==null?void 0:v.maxHp)||((b=qf[(x=t.boat)==null?void 0:x.model])==null?void 0:b.baseHp)||100,componentLevels:{sails:((p=(g=t.boat)==null?void 0:g.componentLevels)==null?void 0:p.sails)??0,hull:((k=(y=t.boat)==null?void 0:y.componentLevels)==null?void 0:k.hull)??0,cannons:((S=(N=t.boat)==null?void 0:N.componentLevels)==null?void 0:S.cannons)??0,nets:((E=(w=t.boat)==null?void 0:w.componentLevels)==null?void 0:E.nets)??0},customization:{color:((A=(j=t.boat)==null?void 0:j.customization)==null?void 0:A.color)??"#4b2c20",flagId:((L=(O=t.boat)==null?void 0:O.customization)==null?void 0:L.flagId)??"none",figurehead:((W=(Y=t.boat)==null?void 0:Y.customization)==null?void 0:W.figurehead)??"none",unlocked:Array.isArray((M=(H=t.boat)==null?void 0:H.customization)==null?void 0:M.unlocked)?t.boat.customization.unlocked:[]}},[l,o]=_.useState(null),c=(U,C,T)=>{["BUY_BOAT_MODEL","BUY_BOAT_COSMETIC"].includes(U.type)&&T&&Object.keys(T).length>0?o({action:U,label:C||"Ukjent Vare",cost:T}):s(U)},u=()=>{l&&(s(l.action),o(null))};return r.jsx(tn,{title:"",onClose:e,maxWidth:"max-w-7xl",hideHeader:!0,noPadding:!0,children:r.jsxs("div",{className:"flex flex-col h-[700px] w-full overflow-hidden rounded-b-xl shadow-2xl bg-[#0f0a05] relative",children:[r.jsx(kt,{children:l&&r.jsx(OF,{isOpen:!0,title:l.label,cost:l.cost,onConfirm:u,onCancel:()=>o(null)})}),r.jsxs("div",{className:"h-24 bg-[#2a1b12] flex items-center justify-between px-10 border-b border-[#453020] relative z-20 shadow-xl",children:[r.jsxs("div",{className:"flex items-center gap-6",children:[r.jsx(eh,{className:"text-amber-500 drop-shadow-md",size:40}),r.jsxs("div",{children:[r.jsxs("h2",{className:"text-2xl font-serif font-black text-[#e7ded0] uppercase tracking-[0.2em] leading-none",children:["Kongelig ",r.jsx("span",{className:"text-amber-500",children:"Skipsverft"})]}),r.jsx("div",{className:"h-1 w-16 bg-amber-600 mt-2 rounded-full opacity-60"})]})]}),r.jsx("div",{className:"flex gap-2 h-full pt-6 pr-12 relative z-30",children:MF.map(U=>{const T=!(U.id==="construct")&&a.stage<4,R=n===U.id;return r.jsxs("button",{type:"button",onClick:()=>i(U.id),disabled:T,className:`
                                        flex items-center gap-3 px-8 h-full rounded-t-lg transition-all group relative overflow-hidden
                                        ${R?"bg-[#d6cbb8] text-[#2a1b12] shadow-[0_-5px_20px_rgba(0,0,0,0.3)] scale-y-110 translate-y-1":"bg-transparent text-[#a8a29e] hover:bg-[#453020] hover:text-[#e7ded0]"}
                                        ${T?"opacity-30 cursor-not-allowed grayscale":""}
                                    `,children:[r.jsx(U.icon,{size:18,className:R?"text-[#b45309]":"text-[#57534e] group-hover:text-[#e7ded0]"}),r.jsx("span",{className:"font-serif font-bold uppercase tracking-widest text-sm",children:{Construction:"Konstruksjon","The Ledger":"Loggbok",Models:"Modeller",Aesthetics:"Estetikk"}[U.label]})]},U.id)})}),r.jsx("button",{onClick:e,className:"absolute top-6 right-6 w-10 h-10 bg-black/20 hover:bg-rose-900/40 text-[#a8a29e] hover:text-rose-400 rounded-full flex items-center justify-center transition-all group border border-white/5 z-50 backdrop-blur-sm",title:"Lukk Vinduet",children:r.jsx("span",{className:"text-xl group-hover:rotate-90 transition-transform",children:""})})]}),r.jsxs("div",{className:"flex-1 grid grid-cols-[40%_60%] min-h-0 overflow-hidden bg-[#0c0a09]",children:[r.jsxs("div",{className:"relative border-r border-[#292524] bg-[#1c1917]",children:[r.jsx("div",{className:"absolute inset-0 opacity-30 pointer-events-none",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='100' height='20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0 10 Q25 20 50 10 T100 10' fill='none' stroke='%2338bdf8' opacity='0.05'/%3E%3C/svg%3E")`}}),r.jsx("div",{className:"h-full flex items-center justify-center p-8 relative z-10",children:r.jsx(jj,{stage:a.stage,model:a.model,componentLevels:a.componentLevels,customization:a.customization})}),r.jsx("div",{className:"absolute bottom-6 left-0 right-0 text-center z-20",children:r.jsxs("span",{className:"font-serif italic text-[#57534e] text-sm opacity-50",children:["Fig. ",a.model.toUpperCase()]})})]}),r.jsxs("div",{className:"relative bg-[#d6cbb8] flex flex-col h-full overflow-hidden shadow-[inset_10px_0_30px_rgba(0,0,0,0.3)]",children:[r.jsx("div",{className:"absolute inset-0 opacity-[0.08] pointer-events-none mix-blend-multiply",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='200' height='200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E")`}}),r.jsx("div",{className:"flex-1 overflow-hidden p-8 relative z-10",children:r.jsxs("div",{className:"h-full relative overflow-hidden",children:[n==="construct"&&r.jsx(LF,{boat:a,player:t,onAction:c}),n==="upgrade"&&r.jsx(PF,{boat:a,player:t,onAction:c}),n==="models"&&r.jsx(BF,{boat:a,player:t,onAction:c}),n==="cosmetics"&&r.jsx(HF,{boat:a,onAction:c})]})})]})]})]})})},LF=({boat:t,player:e,onAction:s})=>{if(console.log("[Shipyard] Rendering ConstructionView",{boat:t,stage:t==null?void 0:t.stage,player:e}),!e||!t)return console.error("[Shipyard] ConstructionView missing props",{player:e,boat:t}),r.jsx("div",{className:"p-8 text-red-500 font-bold",children:"Error: Missing Data"});const n=t.stage??0,i=["Kjlstrekking","Mast & Rigg","Dekk & Detaljer","Sjsetting"][n]||"Ukjent Fase",a=n<4?{stage:n+1,name:i,reqs:[{plank:20},{plank:40,linen_canvas:10},{plank:30,iron_ingot:10},{plank:50,tar:20}][n]||{}}:null,l=n>=4,o=t.hp??t.maxHp??100,c=t.maxHp??100,u=o/c*100,d=o<c,f=c-o,h=Math.ceil(f/10),m=d?{plank:h,tar:h}:{};return r.jsxs("div",{className:"p-8 flex flex-col gap-6 h-full overflow-y-auto scrollbar-thin scrollbar-thumb-stone-400 scrollbar-track-transparent",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-4xl font-serif font-black uppercase text-amber-900 tracking-[0.2em] mb-2 drop-shadow-sm",children:l?"VEDLIKEHOLD":`FASE ${n+1}`}),r.jsx("p",{className:"text-stone-700 font-serif italic text-lg tracking-wide",children:l?"Verft & Reparasjon":a==null?void 0:a.name})]}),l&&r.jsxs("div",{className:"bg-[#292524] rounded-sm p-6 border border-white/5 relative overflow-hidden group shadow-lg",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsxs("span",{className:"text-sm font-bold text-stone-400 uppercase tracking-widest font-serif flex items-center gap-2",children:[r.jsx(xH,{size:14,className:d?"text-rose-500":"text-emerald-500"}),"Skrog Integritet"]}),r.jsxs("span",{className:`font-mono text-lg font-bold ${d?"text-rose-500":"text-emerald-500"}`,children:[o," / ",c," HP"]})]}),r.jsxs("div",{className:"h-4 bg-black/40 rounded-full overflow-hidden mb-8 border border-white/5 relative",children:[r.jsx("div",{className:"absolute inset-0 flex justify-between px-1 opacity-20",children:[...Array(9)].map((v,x)=>r.jsx("div",{className:"w-[1px] h-full bg-white"},x))}),r.jsx("div",{className:`h-full transition-all duration-1000 ease-out relative ${d?"bg-rose-600":"bg-emerald-600"}`,style:{width:`${u}%`},children:r.jsx("div",{className:"absolute inset-0 bg-white/10"})})]}),d?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center gap-4 mb-6 p-4 bg-black/20 rounded border border-white/5",children:[r.jsx("span",{className:"text-stone-400 text-sm font-serif italic",children:"Reparasjonskostnad:"}),r.jsxs("div",{className:"flex gap-4",children:[r.jsx("div",{className:"flex items-center gap-2",children:r.jsx(Hn,{resource:"plank",size:"sm",amount:m.plank,className:e.resources.plank>=h?"text-[#e7ded0]":"text-rose-500 font-bold"})}),r.jsx("div",{className:"flex items-center gap-2",children:r.jsx(Hn,{resource:"tar",size:"sm",amount:m.tar,className:e.resources.tar>=h?"text-[#e7ded0]":"text-rose-500 font-bold"})})]})]}),r.jsx(pc,{onClick:()=>s({type:"REPAIR_BOAT"},"Reparer Skrog",m),disabled:(e.resources.plank||0)<h||(e.resources.tar||0)<h,className:"w-full py-4 text-sm",children:"Utfr Reparasjon"})]}):r.jsxs("div",{className:"flex flex-col items-center justify-center py-6 gap-4 opacity-80",children:[r.jsx(Tj,{label:"GODKJENT",color:"#10b981"}),r.jsx("span",{className:"text-emerald-500/50 text-xs font-black tracking-[0.3em] uppercase",children:"Ingen feil funnet"})]})]}),!l&&a&&r.jsxs("div",{className:"bg-[#292524] rounded-sm p-6 border border-white/5 relative overflow-hidden group shadow-lg",children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-amber-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),r.jsxs("div",{className:"flex justify-between items-center mb-8 border-b border-white/5 pb-4",children:[r.jsx("span",{className:"text-sm font-bold text-stone-400 uppercase tracking-widest font-serif",children:"Ndvendige Materialer"}),r.jsxs("span",{className:"font-serif font-bold text-[#b45309] text-lg",children:["Steg ",a.stage,"/4"]})]}),r.jsx("div",{className:"grid grid-cols-2 gap-6 mb-8",children:Object.entries(a.reqs).map(([v,x])=>{const b=e.resources[v]||0,g=b>=x;return r.jsxs("div",{className:`flex justify-between items-center pb-2 border-b ${g?"border-green-800/20":"border-red-800/20"}`,children:[r.jsx(Hn,{resource:v,size:"sm",showLabel:!0}),r.jsxs("span",{className:`font-mono text-lg font-bold ${g?"text-green-500":"text-red-500"}`,children:[b," / ",x]})]},v)})}),r.jsx(pc,{onClick:()=>s({type:"CONTRIBUTE_TO_BOAT",stage:a.stage,resources:a.reqs}),className:"w-full py-5 text-base",children:"Start Bygging"})]})]})},PF=({boat:t,player:e,onAction:s})=>r.jsx("div",{className:"flex flex-col pb-10 overflow-y-auto max-h-[600px] scrollbar-thin scrollbar-thumb-[#b45309]/20 px-4",children:Object.entries(wx).map(([n,i])=>{const a=t.componentLevels[n]||0,l=i.levels.length,o=i.levels[a];return r.jsx(IF,{title:i.name,level:a,maxLevel:l,description:i.description,effect:o==null?void 0:o.effect,cost:(o==null?void 0:o.cost)||{},playerResources:e.resources,onAction:()=>s({type:"UPGRADE_BOAT_COMPONENT",componentId:n})},n)})}),BF=({boat:t,player:e,onAction:s})=>r.jsx("div",{className:"flex flex-col gap-6 p-6 overflow-y-auto h-full scrollbar-thin scrollbar-thumb-stone-400 scrollbar-track-transparent",children:Object.values(qf).map(n=>{const i=t.model===n.id;return r.jsxs("div",{className:`relative p-8 rounded border transition-all ${i?"bg-[#e7ded0] border-[#b45309]":"bg-[#e0d5c1] border-[#c0b39c]"}`,children:[i&&r.jsx("div",{className:"absolute top-4 right-4 text-[#b45309] opacity-20",children:r.jsx(eh,{size:80})}),r.jsxs("div",{className:"flex justify-between items-start relative z-10",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("h4",{className:`text-2xl font-black uppercase tracking-[0.1em] mb-2 font-serif ${i?"text-amber-700":"text-stone-800"}`,children:n.name}),r.jsxs("div",{className:"flex gap-6 text-xs font-mono text-stone-600 mb-6 uppercase tracking-widest",children:[r.jsxs("span",{className:"flex items-center gap-1 font-bold",children:[r.jsx(rj,{size:14})," ",n.baseHp," HP"]}),r.jsxs("span",{className:"flex items-center gap-1 font-bold",children:[r.jsx(bj,{size:14})," ",n.baseSpeed," KNOP"]})]}),r.jsxs("p",{className:"text-base text-stone-700 max-w-lg italic border-l-4 border-[#292524]/10 pl-4 py-1 mb-4",children:['"',n.description,'"']})]}),i?r.jsx("div",{className:"flex flex-col items-center justify-center h-full pl-8",children:r.jsx(Tj,{label:"Aktiv",color:"#b45309"})}):r.jsxs("div",{className:"text-right flex flex-col items-end gap-3 pl-8 min-w-[200px]",children:[r.jsx(pc,{onClick:()=>s({type:"BUY_BOAT_MODEL",modelId:n.id},`Kjp Skjte: ${n.name}`,n.cost),className:"mb-2 w-full py-3 text-sm",children:"Kjp Skjte"}),r.jsx("div",{className:"flex flex-wrap justify-end gap-2 mt-2",children:Object.entries(n.cost).map(([a,l])=>{const c=(e.resources[a]||0)>=l;return r.jsx("div",{className:`bg-stone-800/10 rounded px-2 py-1 ${c?"":"bg-rose-900/10 border border-rose-900/30"}`,children:r.jsx(Hn,{resource:a,amount:l,size:"sm",className:c?"text-[#292524]":"text-rose-700 font-bold"})},a)})})]})]})]},n.id)})}),UF=t=>r.jsx(DF,{...t}),HF=({boat:t,onAction:e})=>r.jsx("div",{className:"p-6 space-y-8 overflow-y-auto max-h-[600px]",children:r.jsxs("div",{children:[r.jsx("h4",{className:"text-xs font-black text-stone-700 uppercase tracking-[0.2em] mb-6 border-b border-stone-400/30 pb-2 font-serif",children:"Skrogmaling"}),r.jsx("div",{className:"flex gap-4 flex-wrap",children:Eo.colors.map(s=>{var a,l;const n=t.customization.unlocked.includes(s.id)||((a=s.cost)==null?void 0:a.gold)===void 0,i=t.customization.color===s.hex;return r.jsxs("button",{onClick:()=>e({type:"BUY_BOAT_COSMETIC",cosmeticType:"color",id:s.id},`Maling: ${s.name}`,n?{}:s.cost),className:`relative w-16 h-16 rounded shadow-sm transition-all ${i?"ring-4 ring-amber-600 ring-offset-2 ring-offset-[#d6cbb8] scale-105":"hover:scale-105 ring-1 ring-stone-900/10"}`,style:{backgroundColor:s.hex},title:s.name,children:[!n&&r.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center rounded",children:r.jsxs("span",{className:"text-[10px] text-white font-bold bg-black/50 px-1.5 py-0.5 rounded backdrop-blur-sm",children:[(l=s.cost)==null?void 0:l.gold,"g"]})}),i&&r.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:r.jsx(Yc,{size:28,className:"text-white drop-shadow-md",strokeWidth:3})})]},s.id)})})]})}),Aj=({player:t,room:e,world:s,worldEvents:n,players:i,onAction:a,onOpenMarket:l})=>{var ge,me,ht,Fe;const o=(s==null?void 0:s.season)||"Spring",{viewMode:c,setViewMode:u,viewingRegionId:d,setViewingRegionId:f,selectedPOI:h,setSelectedPOI:m,selectedEvent:v,setSelectedEvent:x,upgradingBuildingId:b,setUpgradingBuildingId:g,dialogNPC:p,setDialogNPC:y,dialogStep:k,setDialogStep:N,isDiceGameOpen:S,setIsDiceGameOpen:w,isChickenCoopOpen:E,setIsChickenCoopOpen:j,isConstructionOpen:A,setIsConstructionOpen:O,isTaxationOpen:L,setIsTaxationOpen:Y,isGambleGameOpen:W,setIsGambleGameOpen:H,isGrainGameOpen:M,setIsGrainGameOpen:U,isShipyardOpen:C,setIsShipyardOpen:T,isWharfUpgradeOpen:R,setIsWharfUpgradeOpen:D,isFlaxGameOpen:I,setIsFlaxGameOpen:F,direction:P,handlePOIAction:B}=WG(t,a,l),J=(s==null?void 0:s.weather)||"Clear",ie=(()=>{var z,gt,fs,es,Es;const Q=Qi(((z=e.world)==null?void 0:z.gameTick)||0)==="NIGHT",fe=o==="Winter";let V="";switch(c){case"kingdom":V=fe?Q?"map_kingdom_169_winter_night":"map_kingdom_169_winter":Q?"map_kingdom_169_night":"map_kingdom_169";break;case"village":V=fe?Q?"map_village_hub_1610_winter_night":"map_village_hub_1610_winter":Q?"map_village_hub_1610_night":"map_village_hub_1610";break;case"castle":V="map_castle_interior";break;case"fields":V=fe?Q?"map_farm_fields_winter_night":"map_farm_fields_winter":Q?"map_farm_fields_night":"map_farm_fields";break;case"peasant_farm":{const St=((fs=(gt=t.buildings)==null?void 0:gt.farm_house)==null?void 0:fs.level)||1;V=St>1?`map_peasant_farm_lvl${St}`:"map_peasant_farm";break}case"farm_house":{const St=((Es=(es=t.buildings)==null?void 0:es.farm_house)==null?void 0:Es.level)||1;V=St>1?`map_stugo_interior_lvl${St}`:"map_stugo_interior";break}case"mine":V=fe?Q?"map_mountain_pass_winter_night":"map_mountain_pass_winter":Q?"map_mountain_pass_night":"map_mountain_pass";break;case"forest":V=fe?Q?"map_forest_winter_night":"map_forest_winter":Q?"map_forest_night":"map_forest";break;case"monastery":V=fe?Q?"map_monastery_winter_night":"map_monastery_winter":Q?"map_monastery_night":"map_monastery";break;case"tavern":V="map_tavern_interior";break;case"great_forge":V="map_forge_interior";break;case"bakery":V="map_bakery_interior";break;case"windmill":V="map_windmill_interior";break;case"sawmill":V="map_sawmill_interior";break;case"smeltery":V="map_smeltery_interior";break;case"weavery":V="map_weavery_interior";break;case"stables":V="map_stables_interior";break;case"watchtower":V="map_watchtower_interior";break;case"well":V=fe?Q?"map_well_interior_winter_night":"map_well_interior_winter":Q?"map_well_interior_night":"map_well_interior";break;case"apothecary":V="map_apothecary_interior";break;case"global":d==="region_ost"?V=fe?Q?"map_barony_ost_169_winter_night":"map_barony_ost_169_winter":Q?"map_barony_ost_169_night":"map_barony_ost_169":d==="capital"?V=fe?Q?"map_hovedstad_169_winter_night":"map_hovedstad_169_winter":Q?"map_hovedstad_169_night":"map_hovedstad_169":V=fe?Q?"map_barony_vest_v2_1610_winter_night":"map_barony_vest_v2_1610_winter":Q?"map_barony_vest_v2_1610_night":"map_barony_vest_v2_1610";break;case"dock":V=`map_dock_${o.toLowerCase()}_${Q?"night":"day"}`;break;default:V="map_barony_vest_v2_1610"}const ue="/Simulation_StandAlone_Pro/";return{src:`${ue}${V}.webp`,placeholder:`${ue}${V}_tiny.webp`,original:`${ue}${V}.png`}})(),ye=c==="kingdom"||c==="global"&&(d==="region_ost"||d==="capital")?"aspect-video":"aspect-[16/10]",ae={initial:Q=>({opacity:0,scale:Q==="in"?.9:1.1,filter:"blur(10px)"}),animate:{opacity:1,scale:1,filter:"blur(0px)",transition:{duration:.6,ease:[.16,1,.3,1],staggerChildren:.05}},exit:Q=>({opacity:0,scale:Q==="in"?1.1:.9,filter:"blur(10px)",transition:{duration:.4,ease:[.7,0,.84,0]}})},Z=`${c}-${d}`,Me=_.useMemo(()=>Ni.find(Q=>Q.id===c),[c]),qe=!!(Me!=null&&Me.isInterior);return r.jsxs("div",{className:"relative w-full h-full flex flex-col items-center justify-center p-0",children:[r.jsxs("div",{className:`relative w-full max-w-full max-h-full mx-auto ${ye} rounded-[2rem] overflow-hidden shadow-[0_0_80px_rgba(0,0,0,0.5)] border-4 border-white/5 bg-slate-950 transition-all duration-1000`,children:[r.jsx(kt,{mode:"popLayout",custom:P,children:r.jsxs(q.div,{custom:P,variants:ae,initial:"initial",animate:"animate",exit:"exit",className:"absolute inset-0 w-full h-full",children:[r.jsxs("div",{className:"w-full h-full relative",children:[r.jsx(lb,{src:ie.src,placeholderSrc:ie.placeholder,alt:"Map View",className:`w-full h-full ${d!==t.regionId?"grayscale-[0.8] sepia-[0.2] brightness-125 contrast-125":""}`,disableMotion:!0}),r.jsx("div",{className:`absolute inset-0 pointer-events-none transition-opacity duration-1000 ${J==="Fog"?"opacity-100 backdrop-blur-sm bg-white/10":"opacity-0"}`}),d!==t.regionId&&r.jsx("div",{className:"absolute inset-0 pointer-events-none border-[20px] border-indigo-500/10 shadow-[inset_0_0_100px_rgba(79,70,229,0.3)] z-50 flex items-start justify-center pt-8",children:r.jsxs("div",{className:"bg-indigo-600/20 backdrop-blur-md border border-indigo-400/30 px-6 py-2 rounded-full flex items-center gap-3",children:[r.jsx("div",{className:"w-2 h-2 bg-indigo-400 rounded-full animate-pulse"}),r.jsx("span",{className:"text-[10px] font-black text-indigo-200 uppercase tracking-[0.2em]",children:"Remote View"})]})})]}),c==="dock"&&r.jsx("div",{className:"absolute inset-0 z-30",children:r.jsx(CF,{player:t,world:{season:o,weather:J,time:Qi(((ge=e.world)==null?void 0:ge.gameTick)||0)==="NIGHT"?"Night":"Day"},onAction:Q=>B("dock",Q)})}),c==="farm_house"&&r.jsxs("div",{className:"absolute bottom-[70%] left-[10%] w-[18%] h-auto z-20 cursor-pointer hover:scale-105 hover:brightness-110 transition-all drop-shadow-2xl opacity-90 hover:opacity-100",onClick:()=>a("OPEN_WEAPON_RACK"),title:"pne Vpenstativet",children:[r.jsx("div",{className:"absolute -inset-4 bg-black/40 blur-xl rounded-full"}),r.jsx("div",{className:"relative",children:r.jsx(Ej,{level:((me=t.weaponRack)==null?void 0:me.level)||0,slots:((ht=t.weaponRack)==null?void 0:ht.slots)||[]})})]}),r.jsx(bF,{weather:J,season:o,isInterior:qe}),r.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[c==="kingdom"&&r.jsx(jF,{players:i||{},setViewingRegionId:f,setViewMode:u,currentUserId:t.id}),r.jsx(SF,{viewMode:c,viewingRegionId:d,player:t,room:e,onSelect:m,onEnterHub:u,onPOIAction:Q=>B(c,Q)}),r.jsx(EF,{viewMode:c,viewingRegionId:d,worldEvents:n,onSelect:x})]})]},Z)}),r.jsx(vF,{player:t,room:e}),c!=="kingdom"&&r.jsxs("button",{onClick:()=>{if(c==="global")u("kingdom");else{const Q=Ni.find(fe=>fe.id===c);Q!=null&&Q.parentId?u(Q.parentId):u("global")}},className:"absolute top-6 left-6 z-50 px-6 py-3 bg-slate-950/80 backdrop-blur-md border border-white/10 rounded-2xl text-[10px] font-black uppercase tracking-widest text-slate-400 hover:text-white hover:border-white/20 transition-all active:scale-95 flex items-center gap-2 group",children:[r.jsx("span",{className:"text-lg group-hover:-translate-x-1 transition-transform",children:""}),"Tilbake"]}),v&&r.jsx("div",{className:"absolute inset-x-6 bottom-6 z-40 animate-in slide-in-from-bottom-8 duration-500",children:r.jsxs("div",{className:"bg-slate-900/95 backdrop-blur-2xl rounded-[2.5rem] shadow-[0_30px_100px_rgba(0,0,0,0.8)] border border-white/10 p-8",children:[r.jsxs("div",{className:"flex justify-between items-start mb-6",children:[r.jsxs("div",{children:[r.jsx("span",{className:`text-[10px] font-black uppercase tracking-widest px-3 py-1 rounded-full ${v.type==="RAID"?"bg-rose-500/20 text-rose-400":"bg-amber-500/20 text-amber-500"}`,children:v.type==="RAID"?" Akutt Trussel":" Spesielt Oppdrag"}),r.jsx("h3",{className:"text-3xl font-black text-white mt-4 tracking-tighter",children:v.title})]}),r.jsx("button",{onClick:()=>x(null),className:"w-10 h-10 bg-white/5 hover:bg-white/10 text-white rounded-full flex items-center justify-center transition-colors",children:""})]}),r.jsxs("p",{className:"text-sm font-medium text-slate-400 mb-8 leading-relaxed italic opacity-80",children:['"',v.description,'"']}),r.jsx("button",{onClick:()=>{a({type:v.type==="RAID"?"DEFEND":"EXPLORE",eventId:v.id}),x(null)},className:`w-full py-5 rounded-2xl font-black uppercase tracking-widest text-sm shadow-2xl transition-all active:scale-95 ${v.type==="RAID"?"bg-rose-600 text-white shadow-rose-600/20":"bg-amber-500 text-slate-950 shadow-amber-500/20"}`,children:v.type==="RAID"?"TIL VPEN! ":"UTFORSK OMRDET! "})]})}),r.jsx(kt,{children:h&&r.jsx(xF,{poi:h,player:t,room:e,onAction:Q=>B(h.id,Q),onClose:()=>m(null),viewingRegionId:d})})]}),r.jsxs(kt,{children:[b&&r.jsx(tn,{title:"Bygg & Oppgrader",onClose:()=>g(null),children:r.jsx(kF,{buildingId:b,player:t,room:e,onAction:a})}),S&&r.jsx(qG,{playerGold:((Fe=t.resources)==null?void 0:Fe.gold)||0,onClose:()=>w(!1),onPlay:Q=>a({type:"PLAY_DICE",...Q})}),W&&r.jsx(XG,{player:t,onClose:()=>H(!1),onPlay:Q=>a({type:"PLAY_RESOURCE_GAME",...Q})}),M&&r.jsx(tn,{title:"Kornhsting",onClose:()=>U(!1),maxWidth:"max-w-xl",children:r.jsx(jr,{resourceName:"Korn",possibleYield:12,equipment:Object.values(t.equipment||{}),onComplete:Q=>{a({type:"HARVEST",locationId:"grain_fields",cropId:"grain",performance:Q}),U(!1)}})}),E&&r.jsx(wF,{player:t,activeProcesses:t.activeProcesses||[],onAction:a,onClose:()=>j(!1)}),p&&r.jsx(NF,{npc:p,step:k,setStep:N,onClose:()=>y(null)}),A&&r.jsx(H_,{player:t,room:e,onAction:a,onClose:()=>O(!1),viewingRegionId:d}),L&&r.jsx(_F,{player:t,room:e,onAction:a,onClose:()=>Y(!1)}),C&&r.jsx(UF,{player:t,room:e,onClose:()=>T(!1),onAction:a}),R&&r.jsx(H_,{player:t,room:e,onAction:a,onClose:()=>D(!1),viewingRegionId:"dock_hub",initialProjectId:"wharf"}),I&&r.jsx(tn,{title:"Linhsting",onClose:()=>F(!1),maxWidth:"max-w-xl",children:r.jsx(jr,{resourceName:"Lin",possibleYield:12,equipment:Object.values(t.equipment||{}),onComplete:Q=>{a({type:"HARVEST",locationId:"flax_field",cropId:"flax",performance:Q}),F(!1)}})})]})]})};Aj.displayName="GameMap";function Ss(t){return Ne.lazy(async()=>{try{return await t()}catch(e){if(/failed to fetch dynamically imported module/i.test(e.message)||/loading chunk/i.test(e.message)||/dynamic import/i.test(e.message)||e.name==="TypeError"&&/fetch/i.test(e.message)){const n="last_chunk_reload",i=Date.now(),a=parseInt(localStorage.getItem(n)||"0",10);if(i-a>1e4)return localStorage.setItem(n,i.toString()),console.warn("Chunk load error detected. Reloading application to fetch latest version..."),window.location.reload(),new Promise(()=>{})}throw e}})}const $F=({onClose:t})=>{const{currentTrackId:e,playlist:s,playNext:n,playPrevious:i,toggleIgnoreTrack:a,isIgnored:l,playMusic:o,stopMusic:c}=vx(),[u,d]=_.useState(!!e),f=s.find(m=>m.id===e)||s[0],h=()=>{u&&e?(c(),d(!1)):(e?o(e):n(),d(!0))};return r.jsxs("div",{className:"absolute inset-0 z-50 flex items-center justify-center p-4",children:[r.jsx(q.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:t,className:"absolute inset-0 bg-black/60 backdrop-blur-sm cursor-pointer"}),r.jsxs(q.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",bounce:.3},className:"relative w-full max-w-4xl h-[600px] bg-slate-950/80 backdrop-blur-2xl border border-white/10 rounded-[3rem] shadow-2xl overflow-hidden flex flex-col md:flex-row",children:[r.jsx("button",{onClick:t,className:"absolute top-6 right-6 z-20 p-2 rounded-full bg-white/5 hover:bg-white/10 text-white transition-colors",children:r.jsx(pn,{size:24})}),r.jsxs("div",{className:"flex-1 relative flex flex-col items-center justify-center p-12 bg-gradient-to-br from-indigo-900/40 to-slate-900/40 border-r border-white/5",children:[r.jsx("div",{className:`absolute inset-0 opacity-30 bg-gradient-to-tr ${(f==null?void 0:f.mood)==="Dark"?"from-rose-900/40":"from-indigo-600/20"} to-transparent transition-colors duration-1000`}),r.jsxs("div",{className:"relative z-10 mb-12 group",children:[r.jsxs("div",{className:`w-64 h-64 rounded-full bg-slate-900 border-4 border-white/10 shadow-[0_0_60px_rgba(0,0,0,0.6)] flex items-center justify-center relative overflow-hidden ${u&&e?"animate-[spin_8s_linear_infinite]":""}`,children:[r.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle,rgba(99,102,241,0.2)0%,transparent_70%)]"}),r.jsx("div",{className:"absolute inset-2 rounded-full border border-white/5 opacity-50"}),r.jsx("div",{className:"absolute inset-8 rounded-full border border-white/5 opacity-30"}),r.jsx(iH,{size:64,className:"text-white/20"})]}),r.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:r.jsx("button",{onClick:h,className:"w-20 h-20 bg-white/90 rounded-full flex items-center justify-center shadow-2xl hover:scale-105 active:scale-95 transition-all text-slate-900",children:u&&e?r.jsx(gp,{size:32,fill:"currentColor"}):r.jsx(xp,{size:32,fill:"currentColor",className:"ml-1"})})})]}),r.jsxs("div",{className:"text-center space-y-2 z-10",children:[r.jsx("p",{className:"text-xs font-black uppercase tracking-[0.3em] text-indigo-400",children:"N Spiller"}),r.jsx("h2",{className:"text-3xl font-black text-white tracking-tighter max-w-sm leading-tight",children:f?f.title:"Ingen Musikk"}),(f==null?void 0:f.mood)&&r.jsxs("span",{className:"inline-block px-3 py-1 bg-white/5 rounded-full text-[10px] font-bold text-slate-400 uppercase tracking-widest border border-white/5",children:[f.mood," Mood"]})]})]}),r.jsxs("div",{className:"w-full md:w-[400px] bg-black/20 flex flex-col",children:[r.jsxs("div",{className:"p-8 pb-4 border-b border-white/5 flex items-center justify-between",children:[r.jsxs("h3",{className:"text-sm font-black text-white uppercase tracking-widest flex items-center gap-2",children:[r.jsx(MH,{size:16,className:"text-indigo-400"})," Spilleliste"]}),r.jsxs("span",{className:"text-[10px] font-bold text-slate-500",children:[s.length," Spor"]})]}),r.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 space-y-2",children:s.map((m,v)=>{const x=e===m.id,b=l(m.id);return r.jsxs("div",{className:`group flex items-center justify-between p-4 rounded-xl border transition-all duration-300 ${x?"bg-indigo-600/10 border-indigo-500/50 shadow-lg shadow-indigo-900/20":b?"bg-transparent border-transparent opacity-40 grayscale hover:opacity-100 hover:bg-slate-800/50":"bg-transparent border-transparent hover:bg-white/5 hover:border-white/5"}`,children:[r.jsxs("button",{onClick:()=>{o(m.id),d(!0)},className:"flex items-center gap-4 flex-1 text-left min-w-0",children:[r.jsx("span",{className:`text-xs font-bold w-6 text-center ${x?"text-indigo-400":"text-slate-600"}`,children:x?r.jsx(y$,{size:14,className:"mx-auto animate-pulse"}):v+1}),r.jsx("div",{className:"min-w-0",children:r.jsx("p",{className:`text-sm font-bold truncate ${x?"text-white":"text-slate-400 group-hover:text-slate-200"}`,children:m.title})})]}),r.jsx("button",{onClick:g=>{g.stopPropagation(),a(m.id)},className:`p-2 rounded-lg opacity-0 group-hover:opacity-100 transition-all ${b?"opacity-100 text-rose-400 hover:bg-rose-500/10":"text-slate-500 hover:text-white hover:bg-white/10"}`,title:b?"Gjenoppta":"Ignorer",children:b?r.jsx(rH,{size:16}):r.jsx(oH,{size:16})})]},m.id)})}),r.jsxs("div",{className:"p-6 border-t border-white/5 bg-black/40 flex items-center justify-between",children:[r.jsx("button",{onClick:i,className:"p-4 rounded-full hover:bg-white/5 text-slate-400 hover:text-white transition-colors",children:r.jsx(ZH,{size:20})}),r.jsx("div",{className:"h-10 w-[1px] bg-white/5"}),r.jsx("button",{onClick:h,className:"p-4 rounded-full hover:bg-white/5 text-white transition-colors scale-110 active:scale-95",children:u&&e?r.jsx(gp,{size:24,fill:"currentColor"}):r.jsx(xp,{size:24,fill:"currentColor",className:"ml-1"})}),r.jsx("div",{className:"h-10 w-[1px] bg-white/5"}),r.jsx("button",{onClick:n,className:"p-4 rounded-full hover:bg-white/5 text-slate-400 hover:text-white transition-colors",children:r.jsx(t$,{size:20})})]})]})]})]})},GF=({result:t,onClear:e})=>(_.useEffect(()=>{if(t){t.success&&t.utbytte&&t.utbytte.length>0&&t.utbytte.forEach((n,i)=>{n.amount>0&&setTimeout(()=>{Pe.spawnFlyingResource(n.resource,window.innerWidth/2,window.innerHeight/2,window.innerWidth-150,60)},i*200)});const s=setTimeout(()=>{e()},6e3);return()=>clearTimeout(s)}},[t,e]),r.jsx(kt,{children:t&&r.jsxs(q.div,{initial:{opacity:0,y:-20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},className:"fixed top-[5%] left-1/2 transform -translate-x-1/2 bg-slate-900/95 border-2 border-amber-500/30 p-5 rounded-[2rem] shadow-[0_0_50px_rgba(0,0,0,0.5)] backdrop-blur-md min-w-[300px] text-center z-[300] overflow-hidden",children:[r.jsx("div",{className:"absolute bottom-0 left-0 h-1 bg-amber-500/20 w-full overflow-hidden",children:r.jsx(q.div,{initial:{width:"100%"},animate:{width:"0%"},transition:{duration:7,ease:"linear"},className:"h-full bg-amber-500"})}),r.jsx("button",{onClick:s=>{s.stopPropagation(),e()},className:"absolute top-4 right-4 text-slate-500 hover:text-white transition-colors p-1",children:r.jsx(pn,{className:"w-5 h-5"})}),r.jsxs("div",{className:"relative z-10",children:[r.jsx("div",{className:`text-lg font-black mb-3 tracking-tight ${t.success?"text-white":"text-rose-400"}`,children:t.message}),t.utbytte&&t.utbytte.length>0&&r.jsx("div",{className:"flex flex-wrap justify-center gap-2 mb-3",children:t.utbytte.map((s,n)=>{const i=Ie[s.resource]||{label:s.resource,icon:""},a=s.name||i.label,l=s.icon||i.icon,o=s.amount>=0,c=s.jackpot;return r.jsxs(q.div,{initial:{scale:0,y:10},animate:{scale:1,y:0},transition:{delay:.2+n*.1,type:"spring"},className:`flex items-center gap-2 px-4 py-2 rounded-2xl text-sm font-black border shadow-lg ${c?"bg-gradient-to-r from-amber-200 to-yellow-400 border-yellow-300 text-yellow-900 shadow-amber-500/50 animate-pulse":o?"bg-emerald-500/10 border-emerald-500/30 text-emerald-400":"bg-rose-500/10 border-rose-500/30 text-rose-400"}`,children:[r.jsx("span",{className:"text-lg",children:l}),r.jsxs("span",{children:[o?"+":"",s.resource==="gold"?s.amount.toFixed(2):s.amount," ",c&&a]})]},`${s.resource}-${n}`)})}),t.xp&&t.xp.length>0&&r.jsx("div",{className:"flex flex-col gap-2 mb-2",children:t.xp.map((s,n)=>r.jsxs(q.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.4+n*.1},className:"text-xs font-black uppercase tracking-widest text-indigo-400 bg-indigo-500/5 py-1 rounded-lg",children:["+",s.amount," XP ",s.skill,s.levelUp&&r.jsxs(q.div,{initial:{scale:.5,opacity:0,rotate:-5},animate:{scale:[1,1.2,1],opacity:1,rotate:[0,5,-5,0],filter:["brightness(1)","brightness(2)","brightness(1)"]},transition:{duration:.6,times:[0,.5,1],repeat:1/0,repeatType:"reverse"},className:"mt-2 inline-flex items-center gap-2 bg-gradient-to-r from-amber-400 to-amber-600 text-black px-4 py-1.5 rounded-full text-[10px] font-black shadow-[0_0_20px_rgba(245,158,11,0.5)] border border-amber-300/50",children:[r.jsx("span",{children:""}),r.jsx("span",{className:"tracking-[0.2em]",children:"NIV OPPGGRADERT!"}),r.jsx("span",{children:""})]})]},`xp-${n}`))}),t.durability&&t.durability.length>0&&r.jsx("div",{className:"mt-4 pt-4 border-t border-white/5 flex flex-wrap justify-center gap-3",children:t.durability.map((s,n)=>r.jsxs("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider flex items-center gap-1",children:[" ",s.item,": ",r.jsxs("span",{className:s.amount>0?"text-rose-400":"text-emerald-400",children:[s.amount>0?"-":"+",Math.abs(s.amount),"%"]}),s.broken&&r.jsx("span",{className:"text-rose-500 font-black ml-1 animate-pulse",children:"(DELAGT!)"})]},`dura-${n}`))})]})]})})),FF=async(t,e,s,n)=>{if(e===s)return{success:!1,error:"Kan ikke gi gave til deg selv"};const i=$(G,`simulation_rooms/${t}/players/${e}`),a=$(G,`simulation_rooms/${t}/players/${s}`),l=await de(i),o=await de(a);if(!l.exists())return{success:!1,error:"Sender finnes ikke"};if(!o.exists())return{success:!1,error:"Mottaker finnes ikke"};const c=l.val(),u=o.val(),d=u.name;if(c.regionId!==u.regionId)return{success:!1,error:"Du kan kun sende gaver til spillere i din region."};let f=!1,h="";if(await je(i,x=>{if(x===null)return x;x.resources||(x.resources={});for(const[b,g]of Object.entries(n))if((x.resources[b]||0)<g)return;for(const[b,g]of Object.entries(n))x.resources[b]-=g,h+=`${g} ${b}, `;return f=!0,x}),!f)return{success:!1,error:"Ikke nok ressurser til  sende gaven."};let m=!1;if(await je(a,x=>{if(x===null)return x;x.resources||(x.resources={});for(const[b,g]of Object.entries(n))x.resources[b]=(x.resources[b]||0)+g;return m=!0,x}),!m)return console.error("CRITICAL: Gift transaction partial failure. Sender deducted but target failed.",e,s),{success:!1,error:"Transaksjonsfeil: Gaven gikk tapt i posten (Mottaker utilgjengelig i skrivende stund)."};const v=`Sendte gave (${h.slice(0,-2)}) til ${d}.`;return at(t,`[GAVE] ${c.name} -> ${d}: ${h}`),{success:!0,data:{success:!0,timestamp:Date.now(),message:v}}},VF=async(t,e,s,n,i)=>{const a=$(G,`simulation_rooms/${t}/players/${e}`),l=$(G,`simulation_rooms/${t}/trades`),o=await de(a),c=await de($(G,`simulation_rooms/${t}/players/${s}`));if(!o.exists()||!c.exists())return{success:!1,error:"Spiller finnes ikke"};const u=o.val(),d=c.val(),f=u.name,h=d.name;if(u.regionId!==d.regionId)return{success:!1,error:"Handel er kun tillatt med spillere i din region."};let m=!1;if(await je(a,b=>{var g;if(b===null)return b;for(const[p,y]of Object.entries(n))if((((g=b.resources)==null?void 0:g[p])||0)<y)return;for(const[p,y]of Object.entries(n))b.resources[p]-=y;return m=!0,b}),!m)return{success:!1,error:"Ikke nok ressurser til  opprette handelen."};const v=bx(l),x={id:v.key,senderId:e,senderName:f,receiverId:s,receiverName:h,offer:n,demand:i,status:"PENDING",createdAt:Date.now(),expiresAt:Date.now()+1e3*60*60*24};return await qi(v,x),at(t,`[HANDEL] ${f} tilbd handel til ${h}.`),{success:!0,message:"Handelstilbud sendt."}},zF=async(t,e,s,n)=>{const i=$(G,`simulation_rooms/${t}/trades/${s}`),a=await de(i);if(!a.exists())return{success:!1,error:"Handelen finnes ikke lenger."};const l=a.val();if(l.status!=="PENDING")return{success:!1,error:"Handelen er ikke lenger aktiv."};if(l.receiverId!==e&&l.senderId!==e&&!(l.senderId===e&&n==="REJECT"))return{success:!1,error:"Du har ikke tilgang til denne handelen."};if(n==="REJECT"){const o=$(G,`simulation_rooms/${t}/players/${l.senderId}`);return await je(o,c=>{if(c===null)return c;c.resources||(c.resources={});for(const[u,d]of Object.entries(l.offer))c.resources[u]=(c.resources[u]||0)+d;return c}),await ne(i,{status:l.senderId===e?"CANCELLED":"REJECTED"}),{success:!0,message:"Handel avbrutt/avsltt."}}if(n==="ACCEPT"){const o=$(G,`simulation_rooms/${t}/players/${e}`);let c=!1;if(await je(o,d=>{var f;if(d===null)return d;for(const[h,m]of Object.entries(l.demand))if((((f=d.resources)==null?void 0:f[h])||0)<m)return;for(const[h,m]of Object.entries(l.demand))d.resources[h]-=m;for(const[h,m]of Object.entries(l.offer))d.resources[h]=(d.resources[h]||0)+m;return c=!0,d}),!c)return{success:!1,error:"Du har ikke rd til denne handelen."};const u=$(G,`simulation_rooms/${t}/players/${l.senderId}`);return await je(u,d=>{if(d===null)return d;d.resources||(d.resources={});for(const[f,h]of Object.entries(l.demand))d.resources[f]=(d.resources[f]||0)+h;return d}),await ne(i,{status:"ACCEPTED"}),at(t,`[HANDEL] ${l.receiverName} godtok handelen fra ${l.senderName}.`),{success:!0,message:"Handel gjennomfrt!"}}},KF=({player:t,room:e,onAction:s,pin:n})=>{const[i,a]=_.useState([]),l=_.useRef({}),o=_.useRef(0),c=_.useMemo(()=>e.messages?Array.isArray(e.messages)?e.messages:Object.values(e.messages).sort((m,v)=>m.timestamp-v.timestamp):[],[e.messages]),u=m=>{a(x=>[...x,m]);const v=m.actions?1e4:5e3;setTimeout(()=>d(m.id),v)},d=m=>{a(v=>v.filter(x=>x.id!==m))},f=async(m,v)=>{const x=await zF(n,t.id,m,v);x&&x.success?(d(`trade-${m}`),u({id:`trade-res-${Date.now()}`,title:v==="ACCEPT"?"Handel Gjennomfrt":"Handel Avsltt",message:x.message||"Transaksjon fullfrt.",type:"TRADE"})):u({id:`trade-err-${Date.now()}`,title:"Feil ved handel",message:(x==null?void 0:x.error)||"Noe gikk galt.",type:"TRADE"})},h=(m,v,x)=>!x[m];return _.useEffect(()=>{const m=e.trades||{},v=l.current;Object.entries(m).forEach(([x,b])=>{if(h(x,b,v)&&b.receiverId===t.id&&b.status==="PENDING"){const g=Object.entries(b.offer).map(([y,k])=>`${k} ${y}`).join(", "),p=Object.entries(b.demand).map(([y,k])=>`${k} ${y}`).join(", ");u({id:`trade-${x}`,title:"Nytt Handelstilbud",message:`${b.senderName} tilbyr ${g} for ${p}.`,type:"TRADE",actions:[{label:"Aksepter",variant:"primary",icon:r.jsx(Yc,{size:14}),onClick:()=>f(x,"ACCEPT")},{label:"Forhandle",variant:"neutral",icon:r.jsx(fc,{size:14}),onClick:()=>{d(`trade-${x}`),alert("Forhandling er ikke implementert enn. Avsl handelen for  sende nytt tilbud.")}},{label:"Avsl",variant:"danger",icon:r.jsx(pn,{size:14}),onClick:()=>f(x,"REJECT")}]})}}),l.current=m},[e.trades,t.id,n]),_.useEffect(()=>{var x;const m=c;if(m.length===0)return;const v=m[m.length-1];if(o.current===0&&m.length>0){o.current=m[m.length-1].timestamp;return}if(v.timestamp>o.current){const b=v.content;if(b.startsWith("[GAVE]")&&b.includes(`-> ${t.name}`)){const p=b.split("->")[0].replace("[GAVE]","").trim(),y=((x=b.split(":")[1])==null?void 0:x.trim())||"";u({id:`gift-${v.timestamp}`,title:`Gave fra ${p}`,message:`Du mottok: ${y}`,type:"GIFT"})}o.current=v.timestamp}},[c,t.name]),i.length===0?null:r.jsx("div",{className:"absolute top-24 right-8 z-[100] flex flex-col gap-4 pointer-events-none",children:i.map(m=>r.jsxs("div",{className:"pointer-events-auto bg-slate-900/95 backdrop-blur-xl border border-white/10 p-4 rounded-xl shadow-2xl flex flex-col gap-3 animate-in slide-in-from-right duration-300 w-96",children:[r.jsxs("div",{className:"flex items-start gap-4",children:[r.jsx("div",{className:`p-3 rounded-lg ${m.type==="GIFT"?"bg-indigo-500/20 text-indigo-400":"bg-emerald-500/20 text-emerald-400"}`,children:m.type==="GIFT"?r.jsx(oj,{size:24}):r.jsx(nb,{size:24})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h4",{className:"font-bold text-white text-sm",children:m.title}),r.jsx("p",{className:"text-slate-400 text-xs mt-1 leading-relaxed",children:m.message})]}),r.jsx("button",{onClick:()=>d(m.id),className:"text-slate-600 hover:text-white transition-colors",children:r.jsx(pn,{size:16})})]}),m.actions&&r.jsx("div",{className:"flex gap-2 pt-2 border-t border-white/5",children:m.actions.map((v,x)=>r.jsxs("button",{onClick:v.onClick,className:`
                                        flex-1 py-2 px-3 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition-all active:scale-95
                                        ${v.variant==="primary"?"bg-emerald-600 hover:bg-emerald-500 text-white shadow-lg shadow-emerald-500/20":""}
                                        ${v.variant==="danger"?"bg-rose-600/20 hover:bg-rose-600/30 text-rose-400 border border-rose-500/30":""}
                                        ${v.variant==="neutral"?"bg-slate-700 hover:bg-slate-600 text-slate-200":""}
                                    `,children:[v.icon,v.label]},x))})]},m.id))})},YF=Ss(()=>zt(()=>import("./SimulationMarket-BbLsA5PB.js"),__vite__mapDeps([0,1])).then(t=>({default:t.SimulationMarket}))),WF=Ss(()=>zt(()=>import("./SimulationVault-BgfuaGbL.js"),__vite__mapDeps([2,3])).then(t=>({default:t.SimulationVault}))),qF=Ss(()=>zt(()=>import("./SimulationSkills-BBKz7xkb.js"),__vite__mapDeps([4,5])).then(t=>({default:t.SimulationSkills}))),XF=Ss(()=>zt(()=>import("./SimulationProduction-C3iBXylB.js"),__vite__mapDeps([6,7])).then(t=>({default:t.SimulationProduction}))),QF=Ss(()=>zt(()=>import("./SimulationActivity-CVgS1gQF.js"),[]).then(t=>({default:t.SimulationActivity}))),JF=Ss(()=>zt(()=>import("./SimulationDiplomacy-CEnmYGQz.js"),[]).then(t=>({default:t.SimulationDiplomacy}))),ZF=Ss(()=>zt(()=>import("./SimulationHierarchy-D39EAZM6.js"),__vite__mapDeps([8,9,5,1,3])).then(t=>({default:t.SimulationHierarchy}))),eV=Ss(()=>zt(()=>import("./SimulationProfile-CUL_aTnC.js"),__vite__mapDeps([10,1])).then(t=>({default:t.SimulationProfile}))),tV=Ss(()=>zt(()=>import("./SimulationSettings-BEinxs6h.js"),[]).then(t=>({default:t.SimulationSettings}))),sV=Ss(()=>zt(()=>import("./PoliticalHub-CGtGSA2-.js"),__vite__mapDeps([9,5,1,3])).then(t=>({default:t.PoliticalHub}))),nV=Ss(()=>zt(()=>import("./SimulationWarRoom-BBfn4_j-.js"),[]).then(t=>({default:t.SimulationWarRoom}))),iV=Ss(()=>zt(()=>import("./SiegeEngine-DccicNEK.js"),[]).then(t=>({default:t.SiegeEngine}))),aV=Ss(()=>zt(()=>import("./ApothecaryWindow-CoKN6XyB.js"),__vite__mapDeps([11,7,3])).then(t=>({default:t.ApothecaryWindow}))),rV=({player:t,room:e,pin:s,onAction:n,actionResult:i,onClearActionResult:a})=>{var x,b,g;const{activeTab:l,setActiveTab:o,isMusicWindowOpen:c,setMusicWindowOpen:u,viewingRegionId:d}=ll(),[f,h]=Ne.useState(!1),m=async p=>{if(!f){h(!0);try{await ne($(G,`simulation_rooms/${s}/activeVote/votes`),{[t.id]:p})}catch(y){console.error("Voting failed",y)}finally{setTimeout(()=>h(!1),1500)}}},v=["MAP","PRODUCTION","MARKET","INVENTORY","SKILLS","DIPLOMACY","HIERARCHY","PROFILE","POLITICS"].includes(l);return r.jsxs("div",{className:"flex-1 relative flex flex-col overflow-hidden w-full h-full",children:[r.jsxs("div",{className:`flex-1 relative w-full h-full ${v?"p-2 md:p-3 overflow-hidden flex items-center justify-center":"p-4 md:p-8 overflow-y-auto overflow-x-hidden custom-scrollbar"}`,children:[v&&r.jsx("div",{className:"absolute inset-0 z-0",children:r.jsx(Aj,{player:t,room:e,world:e.world,worldEvents:e.worldEvents,players:e.players,onAction:n,onOpenMarket:()=>o("MARKET")})}),r.jsxs(Ne.Suspense,{fallback:r.jsx("div",{className:"w-full h-full flex items-center justify-center pointer-events-none",children:r.jsx("div",{className:"w-8 h-8 border-2 border-white/20 border-t-white rounded-full animate-spin"})}),children:[(()=>{var k;const p=d||t.regionId||"",y=(k=e.regions[p])==null?void 0:k.activeSiege;return!y||!(l==="SIEGE"||v)?null:r.jsx("div",{className:`absolute inset-0 z-10 ${l!=="SIEGE"?"opacity-20 pointer-events-none blur-sm grayscale":""}`,children:r.jsx(iV,{player:t,siege:y,regionId:p,onAction:n,messages:Array.isArray(e.messages)?e.messages:Object.values(e.messages||{}),regions:e.regions})})})(),r.jsxs("div",{className:"absolute inset-0 z-20 pointer-events-none flex flex-col items-center justify-center",children:[l==="PRODUCTION"&&r.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-6xl md:h-auto md:max-h-[90vh] overflow-hidden",children:((x=ll().productionContext)==null?void 0:x.buildingId)==="apothecary"?r.jsx(aV,{player:t,room:e,onAction:n,pin:s||""}):r.jsx(XF,{player:t,room:e,onAction:n,pin:s||""})}),l==="MARKET"&&r.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-5xl md:h-[90vh] overflow-hidden",children:r.jsx(YF,{player:t,market:((b=e.markets)==null?void 0:b[d||t.regionId||"capital"])||e.market,regions:e.regions,allMarkets:e.markets,onAction:n,pin:s||""})}),l==="INVENTORY"&&r.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-4xl md:h-[80vh] overflow-hidden",children:r.jsx(WF,{player:t,onAction:n})}),l==="SKILLS"&&r.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-4xl md:h-[80vh] overflow-hidden",children:r.jsx(qF,{player:t})}),l==="DIPLOMACY"&&r.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-4xl md:h-[85vh] overflow-hidden",children:r.jsx(JF,{player:t,diplomacy:e.diplomacy,pin:s||""})}),l==="HIERARCHY"&&r.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-5xl md:h-[85vh] overflow-hidden",children:r.jsx(ZF,{players:e.players,currentPlayer:t,regions:e.regions,onAction:n,pin:s||""})}),l==="PROFILE"&&r.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-2xl md:h-[85vh] overflow-hidden",children:r.jsx(eV,{player:t,regions:e.regions||{},allPlayers:e.players||{}})}),l==="POLITICS"&&r.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-6xl md:h-[90vh] overflow-hidden",children:r.jsx(sV,{player:t,room:e,onClose:()=>o("MAP")})}),l==="WAR_ROOM"&&r.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-4xl md:h-[85vh] overflow-hidden",children:r.jsx(nV,{player:t,regions:e.regions,onAction:n,onClose:()=>o("HIERARCHY")})})]}),l!=="MAP"&&!v&&r.jsx("div",{className:"max-w-4xl mx-auto w-full space-y-8 animate-in slide-in-from-bottom-4 duration-500 relative z-20",children:l==="SETTINGS"?r.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-slate-950/40 backdrop-blur-md p-8 animate-in fade-in duration-300",children:r.jsx(tV,{onClose:()=>o("MAP")})}):l==="ACTIVITY"?r.jsx(QF,{messages:e.messages}):null})]})]}),e.activeVote&&!((g=e.activeVote.votes)!=null&&g[t.id])&&r.jsx("div",{className:"absolute bottom-6 right-6 z-[50] w-96 animate-in slide-in-from-right duration-500",children:r.jsxs("div",{className:"bg-slate-900/95 backdrop-blur-xl rounded-2xl border border-indigo-500/50 p-6 shadow-2xl shadow-indigo-500/10",children:[r.jsxs("div",{className:"flex items-start justify-between mb-4",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-white font-bold text-lg leading-tight mb-1",children:"Tinget er satt"}),r.jsx("p",{className:"text-indigo-300 text-xs font-medium uppercase tracking-wider",children:"Avgi din stemme"})]}),r.jsx("div",{className:"bg-indigo-500/20 p-2 rounded-lg",children:r.jsx("span",{className:"text-2xl",children:""})})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h4",{className:"text-white font-medium mb-2",children:e.activeVote.title}),r.jsx("p",{className:"text-slate-400 text-sm line-clamp-3 leading-relaxed",children:e.activeVote.description})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("button",{onClick:()=>m("YES"),disabled:f,className:`bg-emerald-600/80 hover:bg-emerald-500 text-white py-3 rounded-xl font-bold text-sm transition-all active:scale-95 flex items-center justify-center gap-2 ${f?"opacity-50 cursor-not-allowed":""}`,children:[r.jsx("span",{children:""})," VEDTA"]}),r.jsxs("button",{onClick:()=>m("NO"),disabled:f,className:`bg-rose-600/80 hover:bg-rose-500 text-white py-3 rounded-xl font-bold text-sm transition-all active:scale-95 flex items-center justify-center gap-2 ${f?"opacity-50 cursor-not-allowed":""}`,children:[r.jsx("span",{children:""})," AVSL"]})]})]})}),r.jsx(kt,{}),r.jsx(kt,{children:c&&r.jsx($F,{onClose:()=>u(!1)})}),r.jsx(KF,{player:t,room:e,onAction:n,pin:s||""}),r.jsx(GF,{result:i,onClear:a})]})},lV=()=>{const[t,e]=_.useState([]);return _.useEffect(()=>Pe.subscribe(n=>{e(i=>[...i,n]),setTimeout(()=>{e(i=>i.filter(a=>a.id!==n.id))},n.duration+500)}),[]),r.jsx("div",{className:"fixed inset-0 pointer-events-none z-[200] overflow-hidden",children:r.jsx(kt,{children:t.map(s=>{if(s.type==="FLOATING_TEXT")return r.jsx(q.div,{initial:{opacity:0,scale:.5,y:0,rotate:(Math.random()-.5)*20},animate:{opacity:1,scale:1.2,y:-120,x:(Math.random()-.5)*40,rotate:(Math.random()-.5)*40},exit:{opacity:0,scale:.8},transition:{duration:.8,ease:"easeOut"},className:`absolute font-black text-4xl drop-shadow-2xl ${s.color||"text-amber-500"}`,style:{left:`${s.x}%`,top:`${s.y}%`,transform:"translate(-50%, -50%)",zIndex:210},children:s.text},s.id);if(s.type==="FLYING_RESOURCE"){const n=Ie[s.resource]||{icon:""};return r.jsx(q.div,{initial:{left:`${s.startPoint.x}px`,top:`${s.startPoint.y}px`,scale:.5,opacity:0},animate:{left:`${s.endPoint.x}px`,top:`${s.endPoint.y}px`,scale:[.5,1.5,1],opacity:1},exit:{opacity:0,scale:.5},transition:{duration:1,ease:"easeInOut"},className:"absolute text-4xl z-[220] drop-shadow-xl",children:n.icon},s.id)}return s.type==="PARTICLE"?r.jsx(Ne.Fragment,{children:[...Array(6)].map((n,i)=>r.jsx(q.div,{initial:{left:`${s.x}%`,top:`${s.y}%`,scale:1,opacity:1},animate:{left:`${s.x+(Math.random()-.5)*15}%`,top:`${s.y+(Math.random()-.5)*15}%`,scale:0,opacity:0},transition:{duration:.6,ease:"easeOut"},className:`absolute w-3 h-3 rounded-sm ${s.color||"bg-amber-400"} z-[205]`},`${s.id}-p-${i}`))},s.id):null})})})},oV=({level:t,title:e,onClose:s})=>r.jsxs("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-500",children:[r.jsx("div",{className:"bg-gradient-to-br from-amber-400 via-amber-500 to-amber-600 p-1 rounded-[2.5rem] shadow-[0_0_50px_rgba(245,158,11,0.5)] animate-in zoom-in duration-500",children:r.jsxs("div",{className:"bg-white rounded-[2.2rem] p-10 text-center relative overflow-hidden max-w-sm",children:[r.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-amber-200 via-yellow-400 to-amber-200"}),r.jsxs("div",{className:"relative z-10",children:[r.jsx("div",{className:"text-7xl mb-6 animate-bounce",children:""}),r.jsx("h2",{className:"text-sm font-black text-amber-600 uppercase tracking-[0.3em] mb-2",children:"Niv Oppndd!"}),r.jsxs("h3",{className:"text-6xl font-black text-slate-800 mb-4",children:["Niv ",t]}),r.jsx("div",{className:"h-0.5 w-16 bg-slate-200 mx-auto mb-6"}),r.jsx("p",{className:"text-slate-500 font-medium mb-1",children:"Ny Tittel:"}),r.jsx("p",{className:"text-3xl font-black text-indigo-600 mb-8",children:e}),r.jsx("button",{onClick:s,className:"w-full bg-slate-900 hover:bg-slate-800 text-white py-5 rounded-2xl font-black text-xl shadow-xl transition-all active:scale-95",children:"FORTSETT REISEN"})]}),r.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-20",children:[...Array(20)].map((n,i)=>r.jsx("div",{className:"absolute w-2 h-2 bg-amber-500 rounded-full animate-ping",style:{top:`${Math.random()*100}%`,left:`${Math.random()*100}%`,animationDelay:`${Math.random()*2}s`,animationDuration:`${2+Math.random()*2}s`}},i))})]})}),r.jsx("style",{dangerouslySetInnerHTML:{__html:`
                    @keyframes ping-slow {
                        0% { transform: scale(1); opacity: 0.8; }
                        100% { transform: scale(3); opacity: 0; }
                    }
                `}})]}),cV=({pin:t,account:e,onCreatePlayer:s,isCreating:n})=>{const i=_l(),[a,l]=_.useState("WELCOME"),[o,c]=_.useState((e==null?void 0:e.displayName)||""),[u,d]=_.useState("PEASANT");return a==="WELCOME"?r.jsxs("div",{className:"bg-slate-900/40 backdrop-blur-3xl border border-white/5 p-12 md:p-16 rounded-[3.5rem] text-center space-y-10 shadow-2xl animate-in fade-in zoom-in duration-500",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsx("h1",{className:"text-6xl md:text-8xl font-black italic text-white tracking-tighter leading-none",children:"FEUDAL SIM"}),r.jsx("p",{className:"text-indigo-400 font-black uppercase tracking-[0.4em] text-xs",children:"En Levende Simulator"})]}),r.jsx("div",{className:"space-y-6",children:r.jsx("p",{className:"text-slate-400 text-lg md:text-xl font-medium max-w-md mx-auto leading-relaxed",children:"Dette er et spill om makt, ressurser og overlevelse i et feydalt samfunn."})}),r.jsxs("div",{className:"pt-4 space-y-4",children:[r.jsxs("button",{onClick:()=>l("CREATE"),className:"px-12 py-5 bg-indigo-600 hover:bg-indigo-500 text-white rounded-[2rem] font-black uppercase tracking-widest text-sm shadow-2xl shadow-indigo-600/40 transition-all hover:scale-105 active:scale-95 flex items-center justify-center gap-3 mx-auto w-64",children:["Skap din Karakter ",r.jsx(Ca,{size:20})]}),r.jsx("button",{onClick:()=>i("/sim"),className:"text-slate-500 hover:text-white font-black uppercase tracking-widest text-xs transition-colors",children:"G til Lobby"})]})]}):a==="CREATE"?r.jsxs("div",{className:"bg-slate-900 border border-white/10 p-12 rounded-[3.5rem] shadow-2xl space-y-10 animate-in slide-in-from-bottom-8 duration-500",children:[r.jsxs("div",{className:"text-center space-y-2",children:[r.jsx("h2",{className:"text-4xl font-black italic text-white tracking-tighter uppercase",children:"Hvem er du?"}),r.jsxs("p",{className:"text-slate-500 font-bold uppercase tracking-widest text-xs",children:["Opprett din karakter i ",t]})]}),r.jsxs("div",{className:"space-y-8",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsx("label",{className:"text-xs font-black text-indigo-400 uppercase tracking-[0.2em] ml-2",children:"Ditt Navn i Riket"}),r.jsxs("div",{className:"relative group",children:[r.jsx("div",{className:"absolute inset-y-0 left-6 flex items-center text-slate-500 group-focus-within:text-indigo-400",children:r.jsx(Ia,{size:20})}),r.jsx("input",{type:"text",value:o,onChange:f=>c(f.target.value),placeholder:"f.eks. Eirik den Rde",className:"w-full bg-slate-950 border-2 border-white/5 rounded-3xl py-5 pl-16 pr-6 text-xl font-black text-white outline-none focus:border-indigo-500/50 transition-all"})]})]}),t==="TEST"&&r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:["PEASANT","SOLDIER","MERCHANT","BARON"].map(f=>r.jsx("button",{onClick:()=>d(f),className:`py-4 rounded-2xl font-black uppercase tracking-widest text-xs border-2 transition-all ${u===f?"bg-indigo-600/20 border-indigo-500 text-white":"bg-white/5 border-transparent text-slate-500"}`,children:f},f))}),r.jsxs("div",{className:"pt-4 flex gap-4",children:[r.jsx("button",{onClick:()=>l("WELCOME"),className:"flex-1 py-5 bg-white/5 text-slate-400 rounded-3xl font-black uppercase tracking-widest text-xs",children:"Tilbake"}),r.jsx("button",{onClick:()=>{s(o,u),l("SUCCESS")},disabled:!o.trim()||n,className:"flex-[2] py-5 bg-indigo-600 text-white rounded-3xl font-black uppercase tracking-widest text-sm",children:n?"Oppretter...":"Start Reisen"})]})]})]}):r.jsxs("div",{className:"bg-emerald-500/10 backdrop-blur-3xl border border-emerald-500/30 p-16 rounded-[4rem] text-center space-y-8 shadow-2xl animate-in zoom-in duration-500",children:[r.jsx(Yc,{size:48,className:"text-white mx-auto bg-emerald-500 rounded-[2rem] p-4 shadow-2xl"}),r.jsx("h2",{className:"text-4xl font-black italic text-white uppercase",children:"Velkommen inn!"})]})},uV=[{id:"ride_easy",label:"Engelskogen",icon:"",desc:"En rolig tur i vakkert terreng.",difficultly:"Lett",color:"from-emerald-600 to-emerald-800"},{id:"ride_medium",label:"Fjellpasset",icon:"",desc:"Hyere fart og flere klipper.",difficultly:"Medium",color:"from-amber-600 to-amber-800"},{id:"ride_hard",label:"Ulvestien",icon:"",desc:"Livsfarlig galopp gjennom tett mrke.",difficultly:"Hard",color:"from-rose-600 to-rose-800"}],da={skins:[{id:"brown",label:"Rust",color:"#8B4513",price:0},{id:"white",label:"Pearl",color:"#E2E8F0",price:1e3},{id:"black",label:"Void",color:"#1A202C",price:2500},{id:"golden",label:"Gold",color:"#F6E05E",price:5e3},{id:"chestnut",label:"Red",color:"#7C2D12",price:750},{id:"grey",label:"Mist",color:"#94A3B8",price:1200}],manes:[{id:"#1e1b4b",label:"Shadow",price:0},{id:"#f1f5f9",label:"Snow",price:400},{id:"#ea580c",label:"Flame",price:800},{id:"rainbow",label:"Mythic",price:1500},{id:"#FCD34D",label:"Blonde",price:600}],hats:[{id:"none",label:"Ingen",icon:"",price:0},{id:"straw_hat",label:"Strhatt",icon:"",price:500},{id:"cowboy_hat",label:"Sheriff",icon:"",price:1e3},{id:"crown",label:"Konge",icon:"",price:1500},{id:"viking",label:"Viking",icon:"",price:2e3},{id:"tophat",label:"Grev",icon:"",price:3e3}]},dV=(t,e)=>{let s=1;t==="ride_medium"&&(s=1.6),t==="ride_hard"&&(s=2.5);const n=1+(e-1)*.5;return Math.ceil(10*s*n)},fV=({skinColor:t,maneColor:e,hatId:s})=>{const n=e==="rainbow";return r.jsxs("svg",{viewBox:"0 0 200 200",className:"w-full h-full drop-shadow-2xl",children:[r.jsxs("defs",{children:[r.jsxs("linearGradient",{id:"rainbowGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[r.jsx("stop",{offset:"0%",stopColor:"#ff0000"}),r.jsx("stop",{offset:"20%",stopColor:"#ffff00"}),r.jsx("stop",{offset:"40%",stopColor:"#00ff00"}),r.jsx("stop",{offset:"60%",stopColor:"#00ffff"}),r.jsx("stop",{offset:"80%",stopColor:"#0000ff"}),r.jsx("stop",{offset:"100%",stopColor:"#ff00ff"})]}),r.jsxs("filter",{id:"glow",children:[r.jsx("feGaussianBlur",{stdDeviation:"2.5",result:"coloredBlur"}),r.jsxs("feMerge",{children:[r.jsx("feMergeNode",{in:"coloredBlur"}),r.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),r.jsx("path",{d:"M70,160 L70,190 L85,190 L85,150 Z",fill:t,filter:"brightness(0.7)"}),r.jsx("path",{d:"M140,160 L140,190 L155,190 L155,150 Z",fill:t,filter:"brightness(0.7)"}),r.jsx("path",{d:"M50,100 Q40,60 90,60 L140,60 Q180,60 170,110 Q160,160 120,150 L80,150 Q50,150 50,100 Z",fill:t}),r.jsx("path",{d:"M60,150 L60,195 L75,195 L75,150 Z",fill:t}),r.jsx("path",{d:"M130,150 L130,195 L145,195 L145,150 Z",fill:t}),r.jsx("path",{d:"M130,65 Q130,30 160,20 L165,25 Q185,25 185,50 L175,70 Q160,85 145,65 Z",fill:t}),r.jsx("path",{d:"M185,50 L195,55 L190,65 L175,70 Z",fill:t,filter:"brightness(0.9)"}),r.jsx("path",{d:"M160,20 Q120,20 120,80 L130,90 Q140,30 165,25 Z",fill:n?"url(#rainbowGradient)":e,className:n?"animate-pulse":""}),r.jsx("path",{d:"M50,80 Q20,80 20,140",fill:"none",stroke:n?"url(#rainbowGradient)":e,strokeWidth:"8",strokeLinecap:"round"}),r.jsx("circle",{cx:"170",cy:"40",r:"2",fill:"white"}),r.jsx("circle",{cx:"170.5",cy:"39.5",r:"0.5",fill:"black"}),s==="straw_hat"&&r.jsx("text",{x:"160",y:"25",fontSize:"40",transform:"rotate(10, 160, 25)",children:""}),s==="cowboy_hat"&&r.jsx("text",{x:"155",y:"25",fontSize:"40",transform:"rotate(-5, 155, 25)",children:""}),s==="crown"&&r.jsx("text",{x:"155",y:"20",fontSize:"40",transform:"rotate(-10, 155, 20)",children:""}),s==="viking"&&r.jsx("text",{x:"155",y:"20",fontSize:"40",transform:"rotate(0, 155, 20)",children:""}),s==="tophat"&&r.jsx("text",{x:"152",y:"15",fontSize:"45",transform:"rotate(-10, 155, 20)",children:""})]})},hV=({player:t,onAction:e,onClose:s})=>{var p;const[n,i]=Ne.useState("ride"),[a,l]=Ne.useState("skin"),[o,c]=Ne.useState(null),u=t.minigameProgress||{},d=t.horseCustomization||{},f={skinId:d.skinId||"brown",maneColor:d.maneColor||"#1e1b4b",hatId:d.hatId||"none",unlockedSkins:d.unlockedSkins||["brown"],unlockedManeColors:d.unlockedManeColors||["#1e1b4b"],unlockedHats:d.unlockedHats||[]},h=da.skins.find(y=>y.id===f.skinId)||da.skins[0],m=da.manes.find(y=>y.id===f.maneColor)||da.manes[0],v=(y,k)=>{e({type:"MOUNT_HORSE",method:y,level:k}),s()},x=(y,k,N)=>{c({id:y,type:k,price:N})},b=()=>{o&&(e({type:"BUY_HORSE_COSMETIC",cosmeticId:o.id,cosmeticType:o.type,price:o.price}),c(null))},g=(y,k)=>{e({type:"SELECT_HORSE_COSMETIC",cosmeticId:y,cosmeticType:k})};return r.jsxs(tn,{title:"KONGELIG STALL",subtitle:"Equestrian Center",icon:r.jsx(mc,{className:"text-amber-500",size:24}),onClose:s,children:[o&&r.jsx("div",{className:"absolute inset-0 z-50 bg-black/80 backdrop-blur-sm flex items-center justify-center p-8 animate-in fade-in duration-200",children:r.jsxs("div",{className:"bg-slate-900 border border-amber-500/30 rounded-3xl p-8 max-w-sm w-full text-center shadow-2xl space-y-6",children:[r.jsx("div",{className:"w-16 h-16 bg-amber-500/10 rounded-full flex items-center justify-center mx-auto text-amber-500 border border-amber-500/20",children:r.jsx(Hi,{size:32})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-black text-white uppercase mb-2",children:"Bekreft Kjp"}),r.jsxs("p",{className:"text-slate-400 text-sm",children:["Er du sikker p at du vil kjpe dette for ",r.jsxs("span",{className:"text-amber-400 font-bold",children:[o.price,"g"]}),"?"]})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:()=>c(null),className:"flex-1 py-3 rounded-xl bg-slate-800 text-slate-400 font-bold text-xs uppercase hover:bg-slate-700 transition-colors",children:"Avbryt"}),r.jsx("button",{onClick:b,className:"flex-1 py-3 rounded-xl bg-amber-600 text-white font-bold text-xs uppercase hover:bg-amber-500 shadow-lg shadow-amber-900/20 transition-all",children:"Kjp"})]})]})}),r.jsxs("div",{className:"flex flex-col h-[650px] select-none text-slate-200",children:[r.jsxs("div",{className:"flex items-center gap-4 p-6 pb-2",children:[r.jsxs("div",{className:"flex bg-slate-900/50 p-1 rounded-2xl border border-white/5",children:[r.jsxs("button",{onClick:()=>i("ride"),className:`px-8 py-2.5 rounded-xl font-bold text-xs uppercase tracking-widest transition-all flex items-center gap-2 ${n==="ride"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-400 hover:text-white hover:bg-white/5"}`,children:[r.jsx(hj,{size:14})," Turer"]}),r.jsxs("button",{onClick:()=>i("horse"),className:`px-8 py-2.5 rounded-xl font-bold text-xs uppercase tracking-widest transition-all flex items-center gap-2 ${n==="horse"?"bg-amber-600 text-white shadow-lg shadow-amber-500/20":"text-slate-400 hover:text-white hover:bg-white/5"}`,children:[r.jsx(Hi,{size:14})," Min Hest"]})]}),r.jsx("div",{className:"flex-1"}),r.jsxs("div",{className:"flex items-center gap-3 px-5 py-2 bg-slate-950/50 rounded-2xl border border-amber-500/20 shadow-inner",children:[r.jsx("span",{className:"text-[10px] font-black text-amber-500 uppercase tracking-widest",children:"Saldo"}),r.jsxs("span",{className:"text-base font-black text-amber-400 font-mono tracking-tight",children:[(((p=t.resources)==null?void 0:p.gold)||0).toLocaleString(),r.jsx("span",{className:"text-xs ml-1 text-amber-600",children:"G"})]})]})]}),r.jsx("div",{className:"flex-1 p-6 overflow-hidden",children:n==="ride"?r.jsx("div",{className:"h-full flex flex-col animate-in fade-in slide-in-from-bottom-4 duration-500",children:r.jsx("div",{className:"grid grid-cols-1 gap-4 overflow-y-auto pr-2 custom-scrollbar pb-4",children:uV.map(y=>{const k=u[y.id]||1;return r.jsxs("div",{className:"group relative bg-gradient-to-r from-slate-900 via-slate-900 to-slate-800/50 border border-white/5 rounded-[2rem] p-1 overflow-hidden hover:border-white/10 transition-all",children:[r.jsx("div",{className:`absolute left-0 top-0 bottom-0 w-1 bg-gradient-to-b ${y.color}`}),r.jsxs("div",{className:"flex flex-col md:flex-row items-stretch gap-6 pl-6 p-5",children:[r.jsxs("div",{className:"flex items-center gap-5 min-w-[200px]",children:[r.jsx("div",{className:"w-16 h-16 rounded-2xl bg-slate-950 flex items-center justify-center text-4xl shadow-inner border border-white/5 group-hover:scale-105 transition-transform duration-500",children:y.icon}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-lg font-black uppercase tracking-tight text-white group-hover:text-indigo-400 transition-colors",children:y.label}),r.jsx("div",{className:"flex items-center gap-2 mt-1",children:r.jsx("span",{className:"px-2 py-0.5 bg-white/5 rounded text-[10px] font-bold text-slate-400 uppercase tracking-wider",children:y.difficultly})})]})]}),r.jsx("div",{className:"flex-1 flex flex-wrap items-center gap-3",children:[1,2,3,4,5].map(N=>{var A;const S=N<=k,w=N<k,E=dV(y.id,N),j=(((A=t.resources)==null?void 0:A.grain)||0)>=E;return r.jsx("button",{disabled:!S||!w&&!j,onClick:()=>v(y.id,N),className:`
                                                                    relative h-12 flex-1 min-w-[60px] max-w-[80px] rounded-xl flex flex-col items-center justify-center gap-0.5 border transition-all duration-300
                                                                    ${w?"bg-emerald-500/10 border-emerald-500/30 text-emerald-400":S?j?"bg-indigo-600 border-indigo-500 text-white shadow-lg shadow-indigo-500/20 hover:-translate-y-1":"bg-slate-800 border-slate-700 text-slate-500 saturate-0":"bg-transparent border-slate-800/50 text-slate-800"}
                                                                `,children:w?r.jsx(qU,{size:20}):S?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"text-sm font-black leading-none",children:N}),r.jsxs("span",{className:"text-[9px] font-medium opacity-80 leading-none",children:[E," "]})]}):r.jsx(Ml,{size:16})},N)})}),r.jsx("button",{onClick:()=>v(y.id,k),className:"w-14 rounded-xl bg-white/5 hover:bg-white/10 border border-white/5 flex items-center justify-center text-slate-400 hover:text-white transition-all",children:r.jsx(lj,{size:24})})]})]},y.id)})})}):r.jsxs("div",{className:"h-full grid grid-cols-12 gap-8 animate-in fade-in zoom-in-95 duration-500",children:[r.jsx("div",{className:"col-span-5 flex flex-col",children:r.jsxs("div",{className:"flex-1 relative bg-gradient-to-b from-slate-800/50 to-slate-900/90 rounded-[3rem] border border-white/10 shadow-2xl flex items-center justify-center overflow-hidden",children:[r.jsx("div",{className:"absolute inset-x-0 bottom-0 h-1/2 bg-gradient-to-t from-black/60 to-transparent"}),r.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[300px] h-[300px] bg-indigo-500/10 blur-[100px] rounded-full"}),r.jsx("div",{className:"relative z-10 w-full h-full p-8 transition-all hover:scale-105 duration-700 ease-out",children:r.jsx(fV,{skinColor:h.color,maneColor:m.id,hatId:f.hatId})}),r.jsx("div",{className:"absolute bottom-6 inset-x-8 text-center",children:r.jsx("div",{className:"inline-block px-6 py-2 bg-black/40 backdrop-blur-md rounded-full border border-white/5",children:r.jsxs("span",{className:"text-xs font-black uppercase tracking-[0.3em] text-white/80",children:[h.label," Stalon"]})})})]})}),r.jsxs("div",{className:"col-span-7 flex flex-col gap-6",children:[r.jsx("div",{className:"flex p-1 bg-slate-950/50 rounded-xl border border-white/5 w-fit",children:["skin","mane","hat"].map(y=>r.jsx("button",{onClick:()=>l(y),className:`px-5 py-2 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${a===y?"bg-amber-600 text-white shadow-lg shadow-amber-900/20":"text-slate-500 hover:text-slate-300 hover:bg-white/5"}`,children:y==="skin"?"Pels":y==="mane"?"Manke":"Hodeplagg"},y))}),r.jsx("div",{className:"flex-1 overflow-y-auto pr-2 custom-scrollbar",children:r.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[a==="skin"&&da.skins.map(y=>{const k=f.unlockedSkins.includes(y.id),N=f.skinId===y.id;return r.jsxs("button",{onClick:()=>k?g(y.id,"skin"):x(y.id,"skin",y.price),className:`
                                                        aspect-square rounded-2xl border flex flex-col items-center justify-center gap-2 transition-all group
                                                        ${N?"bg-indigo-600 border-indigo-400 ring-2 ring-indigo-500/30":k?"bg-slate-800 border-white/5 hover:bg-slate-700 hover:border-white/20":"bg-slate-900/50 border-white/5 opacity-70 hover:opacity-100 hover:border-amber-500/50"}
                                                    `,children:[r.jsx("div",{className:"w-8 h-8 rounded-full border border-white/10 shadow-lg",style:{backgroundColor:y.color}}),r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsx("span",{className:`text-[10px] font-black uppercase tracking-widest ${N?"text-white":"text-slate-400"}`,children:y.label}),!k&&r.jsxs("span",{className:"text-[10px] font-bold text-amber-500",children:[y.price,"g"]})]})]},y.id)}),a==="mane"&&da.manes.map(y=>{const k=f.unlockedManeColors.includes(y.id),N=f.maneColor===y.id;return r.jsxs("button",{onClick:()=>k?g(y.id,"mane"):x(y.id,"mane",y.price),className:`
                                                        aspect-square rounded-2xl border flex flex-col items-center justify-center gap-3 transition-all
                                                        ${N?"bg-indigo-600 border-indigo-400":"bg-slate-800 border-white/5 hover:bg-slate-700"}
                                                    `,children:[r.jsx("div",{className:"w-12 h-4 rounded-full border border-white/10 shadow-sm",style:{background:y.id==="rainbow"?"linear-gradient(90deg, #f43f5e, #fbbf24, #10b981, #6366f1)":y.id}}),k?r.jsx("span",{className:`text-[10px] font-black uppercase tracking-widest ${N?"text-white":"text-slate-400"}`,children:y.label}):r.jsxs("span",{className:"text-xs font-bold text-amber-500",children:[y.price,"g"]})]},y.id)}),a==="hat"&&da.hats.map(y=>{const k=f.unlockedHats.includes(y.id)||y.id==="none",N=f.hatId===y.id||!1;return r.jsxs("button",{onClick:()=>k?g(y.id,"hat"):x(y.id,"hat",y.price),className:`
                                                        aspect-square rounded-2xl border flex flex-col items-center justify-center gap-2 transition-all
                                                        ${N?"bg-indigo-600 border-indigo-400":"bg-slate-800 border-white/5 hover:bg-slate-700"}
                                                    `,children:[r.jsx("span",{className:"text-4xl drop-shadow-lg",children:y.icon}),!k&&r.jsxs("span",{className:"text-xs font-bold text-amber-500",children:[y.price,"g"]})]},y.id)})]})})]})]})})]})]})},mV=({player:t,room:e,onAction:s,onClose:n})=>{var v,x;const i=e.metadata||{},a=Date.now(),l=i.lastTavernRest||a,o=(a-l)/3e5;let c=i.tavernDemand||1;o>0&&(c=Math.max(1,c-o*.05));const u=b=>Math.ceil(b*c),d=t.regionId||"capital",f=((v=e.markets)==null?void 0:v[d])||e.market,h=((x=f==null?void 0:f.bread)==null?void 0:x.price)||5,m=Math.ceil(h*1.2);return r.jsx(tn,{title:"Vertshuset: Den Glade Gris",subtitle:"Mat & Losji",icon:r.jsx(b$,{className:"text-amber-400"}),onClose:n,maxWidth:"max-w-4xl",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("div",{className:"p-2 bg-amber-500/20 rounded-lg text-amber-400",children:r.jsx(eH,{size:20})}),r.jsx("h3",{className:"text-lg font-bold text-white uppercase tracking-wider",children:"Mat & Drikke"})]}),r.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-2xl p-5 hover:bg-white/10 transition-colors group",children:[r.jsxs("div",{className:"flex justify-between items-start mb-3",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-bold text-lg text-amber-100",children:"Dagens Husmannskost"}),r.jsx("p",{className:"text-xs text-amber-400/60 uppercase tracking-widest font-bold mt-1",children:"Markedspris + Servering"})]}),r.jsxs("div",{className:"text-right",children:[r.jsxs("div",{className:"text-xl font-black text-amber-400",children:[m,"g"]}),r.jsxs("div",{className:"text-[10px] text-slate-400",children:["oppr. ",h.toFixed(1),"g"]})]})]}),r.jsx("p",{className:"text-slate-300 text-sm mb-4 leading-relaxed",children:"En varm tallerken med brd, litt kjttrester og dagens suppe. Ikke noe fancy, men det metter."}),r.jsx("div",{className:"flex items-center gap-4 text-xs font-medium text-slate-400 mb-5",children:r.jsxs("div",{className:"flex items-center gap-1.5 bg-slate-950/50 px-2.5 py-1 rounded-md border border-white/5",children:[r.jsx("span",{className:"text-emerald-400",children:""}),r.jsx("span",{children:"+10 Stamina"})]})}),r.jsx("button",{onClick:()=>{s({type:"BUY_MEAL",locationId:"tavern_bar"})},className:"w-full py-3 bg-amber-600 hover:bg-amber-500 text-white font-bold rounded-xl flex items-center justify-center gap-2 transition-all active:scale-95 shadow-lg shadow-amber-900/20",children:r.jsx("span",{children:"Kjp Mltid"})})]}),r.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-xl p-4 flex gap-3 text-sm text-blue-200",children:[r.jsx(uj,{className:"shrink-0 mt-0.5",size:16}),r.jsx("p",{children:"Prisene justeres automatisk basert p rvarepriser i markedet."})]})]}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("div",{className:"p-2 bg-indigo-500/20 rounded-lg text-indigo-400",children:r.jsx(E_,{size:20})}),r.jsx("h3",{className:"text-lg font-bold text-white uppercase tracking-wider",children:"Overnatting"}),c>1.1&&r.jsxs("span",{className:"ml-auto text-[10px] font-black bg-rose-500 text-white px-2 py-0.5 rounded-full animate-pulse",children:["HY ETTERSPRSEL (x",c.toFixed(2),")"]})]}),r.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-2xl p-4 hover:border-indigo-500/30 transition-colors",children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsx("h4",{className:"font-bold text-slate-200",children:"Sovesal (Hengekye)"}),r.jsxs("span",{className:"font-bold text-amber-400",children:[u(150),"g"]})]}),r.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400 mb-3",children:[r.jsx("span",{className:"text-emerald-400 font-bold",children:"+30 Stamina"}),r.jsx("span",{children:""}),r.jsx("span",{children:"Ingen buffs"})]}),r.jsx("button",{onClick:()=>s({type:"REST_BASIC",locationId:"tavern_bar"}),className:"w-full py-2 bg-slate-700 hover:bg-slate-600 text-white text-sm font-bold rounded-lg transition-colors",children:"Lei Kye"})]}),r.jsxs("div",{className:"bg-gradient-to-br from-indigo-900/20 to-slate-900/40 border border-indigo-500/30 rounded-2xl p-4 hover:border-indigo-400/50 transition-colors relative overflow-hidden group",children:[r.jsx("div",{className:"absolute top-0 right-0 p-2 opacity-5 scale-150 group-hover:scale-110 transition-transform",children:r.jsx(E_,{size:64})}),r.jsxs("div",{className:"relative",children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsx("h4",{className:"font-bold text-indigo-200",children:"Komfortabelt Rom"}),r.jsxs("span",{className:"font-bold text-amber-400",children:[u(500),"g"]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-slate-400 mb-3",children:[r.jsx("span",{className:"text-emerald-400 font-bold",children:"+80 Stamina"}),r.jsx("span",{className:"text-rose-400 font-bold",children:"+10 HP"}),r.jsx("span",{className:"bg-indigo-500/20 text-indigo-300 px-1.5 py-0.5 rounded border border-indigo-500/30",children:"Buff: Utvilt"})]}),r.jsx("button",{onClick:()=>s({type:"REST_COMFY",locationId:"tavern_bar"}),className:"w-full py-2 bg-indigo-600 hover:bg-indigo-500 text-white text-sm font-bold rounded-lg transition-colors shadow-lg shadow-indigo-900/20",children:"Lei Rom"})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-amber-900/20 to-slate-900/40 border border-amber-500/30 rounded-2xl p-4 hover:border-amber-400/50 transition-colors relative overflow-hidden group",children:[r.jsx("div",{className:"absolute top-0 right-0 p-2 opacity-5 scale-150 group-hover:scale-110 transition-transform",children:r.jsx(Wc,{size:64})}),r.jsxs("div",{className:"relative",children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsx("h4",{className:"font-bold text-amber-200",children:"Kongesuite"}),r.jsxs("span",{className:"font-bold text-amber-400",children:[u(1500),"g"]})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-slate-400 mb-3",children:[r.jsx("span",{className:"text-emerald-400 font-bold",children:"FULL Stamina"}),r.jsx("span",{className:"text-rose-400 font-bold",children:"+50 HP"}),r.jsx("span",{className:"bg-amber-500/20 text-amber-300 px-1.5 py-0.5 rounded border border-amber-500/30",children:"Buff: Luksusliv"})]}),r.jsx("button",{onClick:()=>s({type:"REST_ROYAL",locationId:"tavern_bar"}),className:"w-full py-2 bg-gradient-to-r from-amber-600 to-orange-600 hover:from-amber-500 hover:to-orange-500 text-white text-sm font-bold rounded-lg transition-colors shadow-lg shadow-amber-900/20",children:"Lei Suite"})]})]})]})]})})},pV={KING:Wc,BARON:ib,PEASANT:dl,SOLDIER:af,MERCHANT:sb},gV={KING:["Sikre rikets stabilitet","Samle inn skatter fra baronene","Beskytte 'The Orb of Power'"],BARON:["Administrer din region","Krev inn skatter fra bndene","Bygg opp forsvaret mot invasjoner"],PEASANT:["Dyrk jorden og hst korn","Betal skatt for  unng fengsel","Overlev vinteren"],SOLDIER:["Beskytt riket mot farer","Tren deg opp i kamp","Adlyde ordrer fra Kongen"],MERCHANT:["Kjp og selg varer p markedet","Tjen deg rik p handel","Unng  bli plyndret"]},xV={KING:"Du er den verste lederen. Din makt er absolutt, men ditt ansvar er tungt. Riket hviler p dine skuldre.",BARON:"Du styrer et av rikets store landomrder. Du er bindeleddet mellom Kongen og folket.",PEASANT:"Du er ryggraden i samfunnet. Uten ditt harde arbeid ville riket sultet. Livet er hardt, men rlig.",SOLDIER:"Du er sverdets mester. Din plikt er  beskytte de svake og opprettholde lov og orden.",MERCHANT:"Du forstr verdien av gull. Mens andre slss eller dyrker, bygger du formuer gjennom smart handel."},bV=({player:t,pin:e,onComplete:s})=>{var d,f;const[n,i]=_.useState(0),[a,l]=_.useState(!1),o=pV[t.role]||Ia,c=gV[t.role]||["Overlev","Utforsk","Lr"];_.useEffect(()=>{if(n===0){const h=setTimeout(()=>i(1),3e3);return()=>clearTimeout(h)}},[n]);const u=async()=>{l(!0);try{const h={};h[`simulation_rooms/${e}/players/${t.id}/hasSeenIntro`]=!0,await ne($(G),h),setTimeout(s,500)}catch(h){console.error("Failed to save intro state",h),s()}};return n===0?r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-950 text-white animate-in fade-in duration-1000",children:r.jsxs("div",{className:"text-center space-y-8 animate-in zoom-in duration-1000 slide-in-from-bottom-10 fill-mode-forwards",children:[r.jsxs("div",{className:"relative inline-block",children:[r.jsx("div",{className:"absolute inset-0 bg-indigo-500/20 blur-[100px] rounded-full animate-pulse"}),r.jsx(o,{size:120,className:"relative z-10 text-white drop-shadow-[0_0_30px_rgba(255,255,255,0.5)]"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("p",{className:"text-slate-400 font-bold uppercase tracking-[0.5em] text-sm animate-in fade-in delay-500 duration-1000",children:"Skjebnen har valgt..."}),r.jsx("h1",{className:"text-6xl md:text-8xl font-black italic tracking-tighter uppercase animate-in slide-in-from-bottom-5 delay-700 duration-500",children:((d=rc[t.role])==null?void 0:d.label)||t.role})]})]})}):r.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center bg-slate-950/90 backdrop-blur-3xl transition-opacity duration-500 ${a?"opacity-0":"opacity-100"}`,children:r.jsxs("div",{className:"max-w-4xl w-full mx-4 grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-16 items-center",children:[r.jsxs("div",{className:"text-center space-y-8 order-2 md:order-1 animate-in slide-in-from-left-10 duration-700",children:[r.jsxs("div",{className:"relative inline-block p-10 bg-gradient-to-br from-indigo-500/20 to-purple-500/20 rounded-[3rem] border border-white/10 shadow-2xl",children:[r.jsx(o,{size:180,className:"text-white drop-shadow-2xl"}),r.jsx("div",{className:"absolute -bottom-6 left-1/2 -translate-x-1/2 bg-slate-900 border border-white/20 px-6 py-2 rounded-full whitespace-nowrap",children:r.jsx("span",{className:"text-xs font-black uppercase tracking-widest text-indigo-300",children:"Din tildelte rolle"})})]}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-4xl font-black italic tracking-tighter uppercase mb-4",children:(f=rc[t.role])==null?void 0:f.label}),r.jsx("p",{className:"text-slate-400 font-medium leading-relaxed max-w-sm mx-auto",children:xV[t.role]})]})]}),r.jsxs("div",{className:"space-y-8 order-1 md:order-2 animate-in slide-in-from-right-10 duration-700 delay-200",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx("h3",{className:"text-sm font-black uppercase tracking-[0.3em] text-indigo-400",children:"Dine Ml"}),r.jsx("h1",{className:"text-5xl font-black italic tracking-tighter text-white",children:"Oppdrag"})]}),r.jsx("div",{className:"space-y-4",children:c.map((h,m)=>r.jsxs("div",{className:"flex items-center gap-4 bg-white/5 border border-white/5 p-4 rounded-2xl hover:bg-white/10 transition-colors group",children:[r.jsx("div",{className:"w-10 h-10 rounded-full bg-emerald-500/20 flex items-center justify-center text-emerald-400 border border-emerald-500/20 group-hover:scale-110 transition-transform",children:r.jsx("span",{className:"font-black text-sm",children:m+1})}),r.jsx("span",{className:"font-bold text-slate-200",children:h})]},m))}),r.jsx("div",{className:"pt-8",children:r.jsxs("button",{onClick:u,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white py-6 rounded-[2rem] font-black uppercase text-lg tracking-widest shadow-2xl shadow-indigo-600/30 hover:scale-105 active:scale-95 transition-all flex items-center justify-center gap-4 group",children:["Start Din Reise ",r.jsx(Ca,{className:"group-hover:translate-x-2 transition-transform"})]})})]})]})})},vV=(t,e)=>{const[s,n]=_.useState("global"),[i,a]=_.useState({}),[l,o]=_.useState({}),[c,u]=_.useState(!1),[d,f]=_.useState(0),[h,m]=_.useState(()=>{if(!(e!=null&&e.id))return{};const x=localStorage.getItem(`chat_last_read_${t}_${e.id}`);return x?JSON.parse(x):{}}),v=x=>{const b=Date.now();m(g=>{const p={...g,[x]:b};return e!=null&&e.id&&localStorage.setItem(`chat_last_read_${t}_${e.id}`,JSON.stringify(p)),p})};return _.useEffect(()=>{if(!e)return;const x={};if(x.global={id:"global",name:"Riket",type:"GLOBAL",unreadCount:0,description:"Offentlig torg"},e.role==="KING")x.region_vest={id:"region_vest",name:"Vest",type:"REGION",unreadCount:0,description:"Regional kanal for Vest"},x.region_ost={id:"region_ost",name:"st",type:"REGION",unreadCount:0,description:"Regional kanal for st"},x.capital={id:"capital",name:"Hovedstaden",type:"REGION",unreadCount:0,description:"Hovedstaden"};else if(e.regionId){const b=e.regionId==="capital"?"Hovedstaden":e.regionId==="region_vest"?"Vest":e.regionId==="region_ost"?"st":e.regionId;x[e.regionId]={id:e.regionId,name:b,type:"REGION",unreadCount:0,description:"Ditt hjemsted"}}(e.role==="BARON"||e.role==="KING")&&(x.diplomacy={id:"diplomacy",name:"Rdet",type:"DIPLOMACY",unreadCount:0,description:"Hemmelig kanal for ledere"}),a(b=>{const g={...x};return Object.keys(b).forEach(p=>{g[p]&&(g[p].unreadCount=b[p].unreadCount)}),g})},[e==null?void 0:e.regionId,e==null?void 0:e.role]),_.useEffect(()=>{if(!t||!e||Object.keys(i).length===0)return;const x=[];return Object.keys(i).forEach(b=>{const g=$(G,`simulation_rooms/${t}/channels/${b}/messages`),p=FL(g,GL(20)),y=$e(p,k=>{const N=k.val(),S=N?Object.values(N):[];S.sort((j,A)=>j.timestamp-A.timestamp),o(j=>({...j,[b]:S}));const w=h[b]||0,E=S.filter(j=>j.timestamp>w&&j.senderId!==e.id).length;a(j=>j[b]&&j[b].unreadCount===E?j:{...j,[b]:{...j[b],unreadCount:E}})});x.push(y)}),()=>x.forEach(b=>b())},[t,e==null?void 0:e.id,Object.keys(i).join(","),h]),_.useEffect(()=>{const x=Object.values(i).reduce((b,g)=>b+(g.unreadCount||0),0);f(x)},[i]),{activeChannelId:s,setActiveChannelId:n,channels:i,messages:l[s]||[],isLoading:c&&!l[s],totalUnreadCount:d,markChannelAsRead:v}},Nu=(...t)=>t.filter(Boolean).join(" "),yV=({pin:t,player:e,onOpenProfile:s})=>{var y;const[n,i]=_.useState(!1),{activeChannelId:a,setActiveChannelId:l,channels:o,messages:c,totalUnreadCount:u,markChannelAsRead:d,isLoading:f}=vV(t,e),[h,m]=_.useState(""),[v,x]=_.useState(!1),b=_.useRef(null);_.useEffect(()=>{b.current&&b.current.scrollIntoView({behavior:"smooth"})},[c,n]),_.useEffect(()=>{n&&d(a)},[n,a,d]),_.useEffect(()=>{const k=N=>{var S;["INPUT","TEXTAREA"].includes(((S=document.activeElement)==null?void 0:S.tagName)||"")||N.key.toLowerCase()==="c"&&i(w=>!w)};return window.addEventListener("keydown",k),()=>window.removeEventListener("keydown",k)},[]);const g=async()=>{if(!h.trim()||v)return;x(!0);const k=await P6(t,e.id,h,a);k.success?m(""):alert(k.error||"Feil ved sending."),x(!1)},p=k=>{switch(k){case"GLOBAL":return r.jsx(ab,{size:14});case"REGION":return r.jsx(dj,{size:14});case"DIPLOMACY":return r.jsx(Wc,{size:14,className:"text-amber-400"});case"DM":return r.jsx(Ml,{size:14});default:return r.jsx(fc,{size:14})}};return n?r.jsxs("div",{className:"fixed bottom-6 left-6 z-50 w-[380px] h-[500px] flex flex-col bg-slate-950/95 border border-slate-800/80 rounded-2xl shadow-2xl backdrop-blur-xl animate-in slide-in-from-bottom-10 fade-in duration-300",children:[r.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-slate-800/50 bg-slate-900/50 rounded-t-2xl drag-handle cursor-grab active:cursor-grabbing",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500 animate-pulse"}),r.jsx("span",{className:"text-xs font-bold uppercase tracking-widest text-slate-400",children:"Comms Array"})]}),r.jsx("button",{onClick:()=>i(!1),className:"text-slate-500 hover:text-white transition-colors",children:r.jsx(FU,{size:18})})]}),r.jsx("div",{className:"flex gap-1 p-2 bg-slate-900/30 overflow-x-auto scrollbar-hide",children:Object.values(o).map(k=>r.jsxs("button",{onClick:()=>l(k.id),className:Nu("flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-semibold whitespace-nowrap transition-all relative",a===k.id?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"bg-slate-800/50 text-slate-400 hover:bg-slate-800 hover:text-slate-200"),children:[p(k.type),k.name,k.unreadCount>0&&a!==k.id&&r.jsx("div",{className:"absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full border border-slate-900"})]},k.id))}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar bg-gradient-to-b from-slate-950/50 to-transparent",children:[f?r.jsx("div",{className:"flex justify-center p-4",children:r.jsx("div",{className:"w-6 h-6 border-2 border-indigo-500 border-t-transparent rounded-full animate-spin"})}):c.length===0?r.jsx("div",{className:"text-center text-slate-600 text-xs italic mt-10",children:"Ingen meldinger i denne kanalen enn."}):c.map(k=>{const N=k.senderId===e.id;return r.jsxs("div",{className:Nu("flex flex-col gap-1 max-w-[85%]",N?"ml-auto items-end":"mr-auto items-start"),children:[r.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-slate-500 px-1",children:[r.jsx("span",{onClick:()=>s&&s(k.senderId||""),className:Nu("font-bold hover:underline cursor-pointer",N?"text-indigo-400":"text-amber-500"),children:k.senderName}),r.jsxs("span",{className:"opacity-50",children:[" ",new Date(k.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),r.jsxs("div",{className:Nu("px-3 py-2 rounded-2xl text-sm leading-relaxed shadow-sm break-words relative group",N?"bg-indigo-600 text-white rounded-tr-sm":"bg-slate-800 text-slate-200 rounded-tl-sm border border-slate-700/50"),children:[k.content,!N&&k.senderRole!=="PEASANT"&&r.jsx("div",{className:"absolute -top-2 -right-2 bg-slate-950 border border-slate-700 text-[8px] font-black uppercase px-1.5 py-0.5 rounded shadow-xl scale-0 group-hover:scale-100 transition-transform",children:k.senderRole})]})]},k.id)}),r.jsx("div",{ref:b})]}),r.jsx("div",{className:"p-3 bg-slate-900/80 border-t border-slate-800 backdrop-blur-md",children:r.jsxs("div",{className:"relative flex items-center gap-2",children:[r.jsx("input",{value:h,onChange:k=>m(k.target.value),onKeyDown:k=>k.key==="Enter"&&!k.shiftKey&&g(),placeholder:`Melding til #${((y=o[a])==null?void 0:y.name)||"kanal"}...`,className:"flex-1 bg-slate-950 border border-slate-700 rounded-xl px-4 py-2.5 text-sm text-white placeholder:text-slate-600 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500 transition-all shadow-inner",disabled:v}),r.jsx("button",{onClick:g,disabled:!h.trim()||v,className:"bg-indigo-600 hover:bg-indigo-500 text-white p-2.5 rounded-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-indigo-500/20 active:scale-95",children:v?r.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):r.jsx(gj,{size:16})}),e.role!=="KING"&&a==="global"&&r.jsx("div",{className:"absolute -top-6 right-2 text-[10px] text-amber-500 font-mono bg-amber-950/30 px-2 py-0.5 rounded border border-amber-900/50",children:"Kostnad: 2 Gull"})]})})]}):r.jsx("button",{onClick:()=>i(!0),className:"fixed bottom-6 left-6 z-50 bg-slate-900/90 border border-slate-700/50 text-white p-3 rounded-full shadow-2xl hover:bg-indigo-600 hover:scale-105 transition-all group backdrop-blur-md",children:r.jsxs("div",{className:"relative",children:[r.jsx(fc,{size:24,className:"group-hover:text-white text-slate-200"}),u>0&&r.jsx("div",{className:"absolute -top-2 -right-2 min-w-[20px] h-5 bg-red-500 rounded-full flex items-center justify-center text-[10px] font-black border-2 border-slate-900 px-1 animate-in zoom-in duration-300",children:u>9?"9+":u})]})})},G_=["gold","grain","wood","iron_ore","stone","plank","iron_ingot","bread","swords","armor","cloth","wool"],_V=({isOpen:t,onClose:e,myPlayer:s,targetPlayer:n,pin:i})=>{const[a,l]=_.useState({gold:0}),[o,c]=_.useState({gold:0}),[u,d]=_.useState(!1),[f,h]=_.useState(null);if(!t)return null;Ne.useEffect(()=>{const g=p=>{p.key==="Escape"&&e()};return window.addEventListener("keydown",g),()=>window.removeEventListener("keydown",g)},[e]);const m=async()=>{d(!0),h(null);try{const g=await VF(i,s.id,n.id,a,o);g.success?(h("Handelstilbud sendt!"),setTimeout(e,1500)):(h("Feil: "+g.error),d(!1))}catch(g){console.error(g),h("En ukjent feil oppstod."),d(!1)}},v=(g,p)=>{l(y=>({...y,[g]:Math.max(0,p)}))},x=(g,p)=>{c(y=>({...y,[g]:Math.max(0,p)}))},b=({label:g,values:p,onChange:y,max:k})=>r.jsxs("div",{className:"space-y-2",children:[r.jsx("h4",{className:"text-xs font-bold uppercase text-slate-400 tracking-wider mb-2",children:g}),r.jsxs("div",{className:"space-y-2 max-h-60 overflow-y-auto pr-2 custom-scrollbar",children:[G_.map(N=>{var E;const S=p[N]||0,w=k?k(N):9999;return k&&w<=0&&S<=0?null:r.jsxs("div",{className:"flex items-center gap-2 bg-slate-900/50 p-2 rounded-lg border border-slate-700/50",children:[r.jsx("span",{className:"text-lg w-8 text-center",children:ol[N.toUpperCase()]||""}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"text-xs text-slate-300 font-medium capitalize truncate",children:((E=Ie[N])==null?void 0:E.label)||N.replace("_"," ")}),k&&r.jsxs("div",{className:"text-[10px] text-slate-500",children:["Du har: ",w]})]}),r.jsx("input",{type:"number",value:S||"",placeholder:"0",onChange:j=>y(N,parseInt(j.target.value)||0),className:"w-20 bg-slate-800 border border-slate-700 rounded px-2 py-1 text-right text-sm font-mono focus:outline-none focus:border-indigo-500"})]},N)}),!k&&r.jsx("div",{className:"text-xs text-slate-500 text-center italic mt-2",children:"Velg hva du krever"})]})]});return r.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:r.jsxs("div",{className:"w-full max-w-4xl bg-slate-900 border border-indigo-500/30 rounded-2xl shadow-2xl flex flex-col max-h-[90vh] overflow-hidden",children:[r.jsxs("div",{className:"p-6 bg-slate-900 border-b border-indigo-500/20 flex justify-between items-center relative overflow-hidden",children:[r.jsx("div",{className:"absolute inset-0 bg-indigo-600/5 opacity-0 group-hover:opacity-100 transition-opacity"}),r.jsxs("div",{children:[r.jsxs("h2",{className:"text-2xl font-black italic text-white flex items-center gap-3",children:[r.jsx(nb,{className:"text-indigo-400"}),"HANDELSKONTRAKT"]}),r.jsxs("p",{className:"text-slate-400 text-sm",children:["Opprett et tilbud til ",r.jsx("span",{className:"text-white font-bold",children:n.name})]})]}),r.jsx("button",{onClick:e,className:"relative z-10 p-2 hover:bg-slate-800 rounded-full transition-colors cursor-pointer",children:r.jsx(pn,{className:"text-slate-400"})})]}),r.jsxs("div",{className:"flex-1 overflow-hidden grid grid-cols-1 md:grid-cols-2 divide-y md:divide-y-0 md:divide-x divide-slate-800 bg-slate-950/50",children:[r.jsx("div",{className:"p-6 overflow-hidden flex flex-col",children:r.jsx(b,{label:"Ditt Tilbud (Assets)",values:a,onChange:v,max:g=>s.resources[g]||0})}),r.jsx("div",{className:"p-6 overflow-hidden flex flex-col",children:r.jsxs("div",{className:"space-y-2 max-h-[60vh] overflow-y-auto pr-2 custom-scrollbar",children:[r.jsx("h4",{className:"text-xs font-bold uppercase text-slate-400 tracking-wider mb-2",children:"Ditt Krav (Liabilities)"}),G_.map(g=>{var p;return r.jsxs("div",{className:"flex items-center gap-2 bg-slate-900/50 p-2 rounded-lg border border-slate-700/50 hover:border-indigo-500/30 transition-colors",children:[r.jsx("span",{className:"text-lg w-8 text-center opacity-70",children:ol[g.toUpperCase()]||""}),r.jsx("span",{className:"flex-1 text-xs text-slate-300 font-medium capitalize truncate",children:((p=Ie[g])==null?void 0:p.label)||g.replace("_"," ")}),r.jsx("input",{type:"number",value:o[g]||"",placeholder:"0",onChange:y=>x(g,parseInt(y.target.value)||0),className:"w-20 bg-slate-800 border border-slate-700 rounded px-2 py-1 text-right text-sm font-mono focus:outline-none focus:border-indigo-500"})]},g)})]})})]}),r.jsxs("div",{className:"p-6 bg-slate-900 border-t border-indigo-500/20 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2 text-yellow-500/80 text-xs",children:[r.jsx(mp,{size:14}),r.jsx("span",{children:"Ressursene trekkes umiddelbart (Escrow)."})]}),r.jsxs("div",{className:"flex items-center gap-4",children:[f&&r.jsx("span",{className:`text-sm font-bold ${f.startsWith("Feil")?"text-red-400":"text-green-400"}`,children:f}),r.jsx("button",{onClick:m,disabled:u||f!==null,className:"px-6 py-3 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-xl flex items-center gap-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-indigo-500/20",children:u?"Signerer...":r.jsxs(r.Fragment,{children:[r.jsx(gj,{size:18}),"Send Kontrakt"]})})]})]})]})})},wV=["gold","grain","wood","iron_ore","bread"],kV=({isOpen:t,onClose:e,myPlayer:s,targetPlayer:n,pin:i})=>{const[a,l]=_.useState("INFO"),[o,c]=_.useState(!1);Ne.useEffect(()=>{const g=p=>{p.key==="Escape"&&e()};return window.addEventListener("keydown",g),()=>window.removeEventListener("keydown",g)},[e]);const[u,d]=_.useState("gold"),[f,h]=_.useState(0),[m,v]=_.useState(null),x=g=>{switch(g){case"KING":return r.jsx(Wc,{size:32,className:"text-yellow-400"});case"BARON":return r.jsx(ib,{size:32,className:"text-purple-400"});case"SOLDIER":return r.jsx(af,{size:32,className:"text-red-400"});case"MERCHANT":return r.jsx(sb,{size:32,className:"text-emerald-400"});default:return r.jsx(Ia,{size:32,className:"text-slate-400"})}},b=async()=>{if(f<=0)return;v("Sender...");const g={};g[u]=f;const p=await FF(i,s.id,n.id,g);p.success?(v(`Sendte ${f} ${u}!`),setTimeout(()=>{v(null),l("INFO")},1500)):v("Feil: "+p.error)};return t?o?r.jsx(_V,{isOpen:!0,onClose:()=>c(!1),myPlayer:s,targetPlayer:n,pin:i}):r.jsx("div",{className:"fixed inset-0 z-[50] flex items-center justify-center p-4 bg-slate-950/60 backdrop-blur-sm animate-in fade-in duration-200",children:r.jsxs("div",{className:"w-full max-w-md bg-slate-900 border border-slate-700 rounded-3xl shadow-2xl overflow-hidden flex flex-col relative",children:[r.jsx("div",{className:`h-32 w-full relative bg-gradient-to-br ${n.role==="KING"?"from-yellow-900/40 to-slate-900":"from-indigo-900/40 to-slate-900"}`,children:r.jsx("div",{className:"absolute top-4 right-4",children:r.jsx("button",{onClick:e,className:"p-2 bg-black/20 hover:bg-black/40 rounded-full transition-colors backdrop-blur-sm text-white",children:r.jsx(pn,{size:20})})})}),r.jsxs("div",{className:"px-8 relative -mt-16 mb-4 flex flex-col items-center",children:[r.jsxs("div",{className:"w-32 h-32 rounded-full border-4 border-slate-900 bg-slate-800 flex items-center justify-center shadow-xl relative group overflow-hidden",children:[n.avatar?r.jsx("img",{src:n.avatar,alt:n.name,className:"w-full h-full object-cover"}):x(n.role),r.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"})]}),r.jsx("h2",{className:"text-2xl font-black text-white mt-4",children:n.name}),r.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-sm font-medium uppercase tracking-wider",children:[r.jsx("span",{className:"text-indigo-400",children:n.role}),r.jsx("span",{children:""}),r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(dj,{size:12})," ",n.regionId||"Ukjent"]})]})]}),r.jsxs("div",{className:"flex-1 px-8 pb-8 space-y-6",children:[a==="INFO"&&r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-slate-950/50 p-4 rounded-2xl border border-slate-800 text-center",children:[r.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-widest font-bold mb-1",children:"Level"}),r.jsx("div",{className:"text-3xl font-black text-white",children:n.stats.level})]}),r.jsxs("div",{className:"bg-slate-950/50 p-4 rounded-2xl border border-slate-800 text-center",children:[r.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-widest font-bold mb-1",children:"Reputasjon"}),r.jsx("div",{className:"text-3xl font-black text-indigo-400",children:n.stats.reputation})]})]}),a==="GIFT"&&r.jsxs("div",{className:"bg-slate-950/50 p-6 rounded-2xl border border-slate-800 space-y-4 animate-in slide-in-from-bottom-4 duration-300",children:[r.jsx("h3",{className:"text-center text-slate-300 font-bold",children:"Send en gave"}),r.jsx("div",{className:"flex gap-2 justify-center",children:wV.map(g=>r.jsx("button",{onClick:()=>d(g),className:`p-2 rounded-lg border transition-all ${u===g?"bg-indigo-600 border-indigo-500":"bg-slate-900 border-slate-700 hover:border-slate-500"}`,children:r.jsx("span",{className:"text-xl",children:ol[g.toUpperCase()]||""})},g))}),r.jsxs("div",{className:"flex items-center gap-2 bg-slate-900 border border-slate-700 rounded-xl px-4 py-2",children:[r.jsx("input",{type:"number",className:"bg-transparent w-full text-center text-xl font-bold focus:outline-none",value:f,onChange:g=>h(parseInt(g.target.value)||0),placeholder:"0"}),r.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase",children:u})]}),r.jsx("button",{onClick:b,disabled:!!m,className:"w-full py-3 bg-emerald-600 hover:bg-emerald-500 text-white rounded-xl font-bold shadow-lg shadow-emerald-500/20 disabled:opacity-50",children:m||"Send Gave"})]}),r.jsx("div",{className:"flex gap-2",children:a==="INFO"?r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:()=>l("GIFT"),className:"flex-1 py-3 bg-slate-800 hover:bg-slate-700 text-slate-200 rounded-xl font-bold flex items-center justify-center gap-2 transition-transform active:scale-95",children:[r.jsx(oj,{size:18}),r.jsx("span",{children:"Gave"})]}),r.jsxs("button",{onClick:()=>c(!0),className:"flex-1 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold flex items-center justify-center gap-2 transition-transform active:scale-95 shadow-lg shadow-indigo-500/20",children:[r.jsx(nb,{size:18}),r.jsx("span",{children:"Handel"})]})]}):r.jsx("button",{onClick:()=>l("INFO"),className:"w-full py-3 text-slate-400 hover:text-white font-bold",children:"Avbryt"})}),n.role==="SOLDIER"&&s.role==="SOLDIER"&&r.jsxs("button",{className:"w-full py-2 border border-red-500/30 text-red-400 hover:bg-red-500/10 rounded-xl font-bold uppercase tracking-widest text-xs flex items-center justify-center gap-2",children:[r.jsx(af,{size:14}),"Utfordre til Duell (Kommer snart)"]})]})]})}):null},F_=[{id:"CHASSIS",label:"Vogn",icon:""},{id:"WHEELS",label:"Hjul",icon:""},{id:"COVER",label:"Kalesje",icon:""},{id:"LANTERNS",label:"Lykter",icon:""},{id:"SKIN",label:"Trekkdyr",icon:""},{id:"FLAG",label:"Flagg",icon:""},{id:"COMPANION",label:"Passasjer",icon:""},{id:"TRAIL",label:"Spor",icon:""},{id:"DECOR",label:"Dekor",icon:""}],NV=({player:t,onBuy:e,onEquip:s})=>{var u,d,f;const[n,i]=_.useState(()=>sessionStorage.getItem("caravan_shop_cat")||"CHASSIS");Ne.useEffect(()=>{sessionStorage.setItem("caravan_shop_cat",n)},[n]);const a=((d=(u=t.caravan)==null?void 0:u.customization)==null?void 0:d.unlocked)||[],l=((f=t.caravan)==null?void 0:f.customization)||{},o=_.useMemo(()=>Object.values(rb).filter(h=>h.category===n),[n]),c=h=>{var m;(t.resources.gold||0)<h.cost||h.reqLevel&&(((m=t.caravan)==null?void 0:m.level)||1)<h.reqLevel||e(h.id)};return r.jsxs("div",{className:"flex h-full p-6 pt-0 gap-8 relative",children:[r.jsx("div",{className:"w-56 flex flex-col relative z-10 h-full border-r border-white/5 pr-6",children:r.jsx("div",{className:"flex-1 flex flex-col gap-2 overflow-y-auto no-scrollbar mask-scroll pb-2",children:F_.map(h=>r.jsxs("button",{onClick:()=>i(h.id),className:`relative group shrink-0 h-14 flex items-center px-4 gap-4 rounded-xl transition-all duration-200 ${n===h.id?"bg-gradient-to-r from-amber-400 to-amber-500 text-black shadow-lg shadow-amber-500/20 z-10 scale-[1.02]":"bg-transparent text-slate-400 hover:text-white hover:bg-white/5"}`,children:[r.jsx("span",{className:`text-2xl filter transition-all ${n===h.id?"scale-110 drop-shadow-sm":"grayscale opacity-70 group-hover:grayscale-0 group-hover:opacity-100"}`,children:h.icon}),r.jsx("span",{className:`text-xs uppercase font-black tracking-widest leading-none ${n===h.id?"opacity-100":"opacity-70"}`,children:h.label}),n===h.id&&r.jsx("div",{className:"absolute inset-0 rounded-xl border border-white/20 pointer-events-none"})]},h.id))})}),r.jsx("div",{className:"flex-1 pt-0 pb-6 overflow-y-auto no-scrollbar mask-scroll-content",children:r.jsx(kt,{mode:"popLayout",children:r.jsx(q.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},transition:{duration:.15},className:"flex flex-col gap-2.5",children:o.map(h=>{var k,N,S;const m=a.includes(h.id),v=Object.values(l).includes(h.id),x=(t.resources.gold||0)>=h.cost,b=(((k=t.caravan)==null?void 0:k.level)||1)>=(h.reqLevel||0),g=h.id==="skin_horse_linked",p=(N=t.horseCustomization)==null?void 0:N.skinId;let y="";return m||(b?x||(y="Mangler Gull"):y=`Lvl ${h.reqLevel}`),g&&!p&&(y="Ingen Hest"),r.jsx(q.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`relative p-[1px] rounded-xl transition-all group overflow-hidden ${v?"bg-gradient-to-r from-amber-400 to-amber-600 shadow-md shadow-amber-500/10":"bg-slate-800"}`,children:r.jsxs("div",{className:"bg-[#0B0F19] rounded-[11px] h-16 pr-4 flex items-center gap-5 relative z-10 pl-3",children:[r.jsx("div",{className:`w-10 h-10 rounded-lg flex-shrink-0 flex items-center justify-center text-xl bg-slate-900 border border-white/5 ${v?"shadow-[0_0_10px_rgba(251,191,36,0.1)]":""}`,children:(S=F_.find(w=>w.id===n))==null?void 0:S.icon}),r.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-center",children:[r.jsx("h4",{className:`font-black uppercase text-sm truncate leading-none mb-1.5 ${v?"text-white":"text-slate-300"}`,children:h.name.replace("Vogn: ","")}),r.jsxs("div",{className:"flex items-center gap-2",children:[h.reqLevel&&!m&&r.jsxs("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest ",children:["Lvl ",h.reqLevel]}),!m&&r.jsxs("span",{className:"text-xs text-amber-500 font-bold bg-amber-500/10 px-2 py-0.5 rounded border border-amber-500/20",children:[h.cost,"g"]}),m&&!v&&r.jsx("span",{className:"text-xs text-emerald-500 font-bold uppercase tracking-widest",children:"Eies"})]})]}),r.jsx("div",{className:"flex-shrink-0 w-28",children:m?r.jsx("button",{onClick:()=>s(h.id),disabled:v||g&&!p,className:`w-full py-2 rounded-lg text-xs font-black uppercase tracking-widest transition-all ${v?"bg-amber-500/10 text-amber-500 border border-amber-500/20 cursor-default shadow-[0_0_10px_rgba(245,158,11,0.1)]":g&&!p?"bg-slate-800 text-red-500 cursor-not-allowed":"bg-white text-black hover:bg-amber-400 hover:scale-[1.02]"}`,children:v?"VALGT":g&&!p?"MANGLER HEST":"VELG"}):r.jsx("button",{onClick:()=>c(h),disabled:!!y,className:`w-full py-2 rounded-lg text-xs font-black uppercase tracking-widest transition-all ${y?"bg-slate-800 text-slate-500 cursor-not-allowed":"bg-amber-400 text-black hover:bg-amber-300 hover:scale-[1.02] shadow-lg shadow-amber-900/10"}`,children:y||"KJP"})})]})},h.id)})},n)})}),r.jsx("style",{children:`
                .no-scrollbar::-webkit-scrollbar {
                    display: none;
                }
                .no-scrollbar {
                    -ms-overflow-style: none;
                    scrollbar-width: none;
                }
                .mask-scroll {
                     mask-image: linear-gradient(to bottom, black 85%, transparent 100%);
                    -webkit-mask-image: linear-gradient(to bottom, black 85%, transparent 100%);
                }
                .mask-scroll-content {
                    mask-image: linear-gradient(to bottom, black 95%, transparent 100%);
                    -webkit-mask-image: linear-gradient(to bottom, black 95%, transparent 100%);
                }
            `})]})},SV=({player:t,onAction:e,onClose:s,preselectedTarget:n})=>{var x;const[i,a]=_.useState(()=>sessionStorage.getItem("caravan_tab")||(n?"TRAVEL":"CARGO"));Ne.useEffect(()=>{sessionStorage.setItem("caravan_tab",i)},[i]);const l=Ne.useMemo(()=>{const b=t.caravan||{};return{level:b.level||1,inventory:b.inventory||{},durability:b.durability??100,upgrades:b.upgrades||[],customization:b.customization}},[t.caravan]),o=te.CARAVAN.LEVELS.find(b=>b.level===l.level)||te.CARAVAN.LEVELS[0],c=Object.values(l.inventory).reduce((b,g)=>b+(g||0),0),u=o.capacity,d=b=>{e({type:"LOAD_CARAVAN",resource:b,amount:1})},f=b=>{e({type:"UNLOAD_CARAVAN",resource:b,amount:1})},h=(b,g)=>{e({type:"UPGRADE_CARAVAN",upgradeType:b,upgradeId:g})},m=b=>{e({type:"TRAVEL_START",targetRegionId:b}),s()},v=()=>{e({type:"REPAIR_CARAVAN"})};return r.jsx(q.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/60 backdrop-blur-md",children:r.jsxs("div",{className:"relative w-full max-w-7xl h-[750px] bg-[#0B0F19] rounded-[2rem] overflow-hidden flex shadow-2xl border border-white/5",children:[r.jsxs("div",{className:"w-[38%] relative flex flex-col pointer-events-none",children:[r.jsxs("div",{className:"absolute inset-0 bg-gradient-to-b from-slate-900 to-[#05080f]",children:[r.jsx("div",{className:"absolute top-[-20%] left-[-20%] w-[140%] h-[80%] bg-blue-500/10 blur-[100px] rounded-full"}),r.jsx("div",{className:"absolute bottom-[0%] right-[0%] w-[80%] h-[60%] bg-amber-500/5 blur-[80px] rounded-full"})]}),r.jsxs("div",{className:"relative z-10 px-8 pt-8 space-y-6",children:[r.jsx("div",{className:"flex justify-between items-start",children:r.jsxs("div",{children:[r.jsx("h1",{className:"text-4xl font-black text-white italic tracking-tighter uppercase drop-shadow-lg",children:"Karavane"}),r.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[r.jsxs("span",{className:"px-2 py-0.5 bg-amber-400/10 border border-amber-400/20 text-amber-400 text-xs font-black uppercase rounded",children:["Niv ",l.level]}),r.jsx("span",{className:"text-slate-500 text-xs font-bold uppercase tracking-widest",children:o.name})]})]})}),r.jsxs("div",{className:"space-y-3 bg-black/20 p-4 rounded-xl border border-white/5 backdrop-blur-sm pointer-events-auto",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex justify-between text-xs font-bold uppercase tracking-wider text-slate-400",children:[r.jsx("span",{children:"Lastkapasitet"}),r.jsxs("span",{className:c>=u?"text-rose-400":"text-white",children:[c," / ",u]})]}),r.jsx("div",{className:"h-1.5 w-full bg-slate-800 rounded-full overflow-hidden",children:r.jsx(q.div,{initial:{width:0},animate:{width:`${c/u*100}%`},className:"h-full bg-amber-400 shadow-[0_0_10px_rgba(251,191,36,0.5)]"})})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex justify-between text-xs font-bold uppercase tracking-wider text-slate-400",children:[r.jsx("span",{children:"Tilstand"}),r.jsxs("span",{className:l.durability<o.durability*.3?"text-rose-500":"text-emerald-400",children:[Math.round(l.durability)," / ",o.durability]})]}),r.jsx("div",{className:"h-1.5 w-full bg-slate-800 rounded-full overflow-hidden",children:r.jsx(q.div,{initial:{width:0},animate:{width:`${l.durability/o.durability*100}%`},className:`h-full shadow-[0_0_10px_rgba(16,185,129,0.5)] ${l.durability<o.durability*.3?"bg-rose-500":"bg-emerald-500"}`})})]}),l.durability<o.durability&&r.jsxs("button",{onClick:v,className:"w-full mt-2 py-2 bg-emerald-500/10 hover:bg-emerald-500/20 border border-emerald-500/30 text-emerald-400 rounded-lg text-xs font-black uppercase transition-all flex items-center justify-center gap-2 group",children:[r.jsx("span",{children:" Reparer"}),r.jsxs("span",{className:"opacity-50 group-hover:opacity-100",children:["(",Math.round((o.durability-(l.durability||0))*2),"g)"]})]})]})]}),r.jsxs("div",{className:"flex-1 flex items-center justify-center relative translate-y-[-20px] pointer-events-auto",children:[r.jsx(Sj,{level:l.level,upgrades:l.upgrades,customization:(x=t.caravan)==null?void 0:x.customization,horseCustomization:t.horseCustomization,className:"w-full max-w-[340px] drop-shadow-[0_50px_60px_rgba(0,0,0,0.6)] z-10"}),r.jsx("div",{className:"absolute bottom-[20%] w-[60%] h-[20px] bg-black/40 blur-xl rounded-[100%]"})]})]}),r.jsxs("div",{className:"flex-1 flex flex-col bg-[#111624] border-l border-white/5 relative z-20",children:[r.jsxs("div",{className:"h-20 flex items-center justify-between px-8 border-b border-white/5",children:[r.jsx("div",{className:"flex gap-1 bg-slate-900/50 p-1 rounded-xl border border-white/5",children:["CARGO","UPGRADES","STYLE","TRAVEL"].map(b=>r.jsx("button",{onClick:()=>a(b),className:`px-5 py-2 text-xs font-black uppercase tracking-widest rounded-lg transition-all ${i===b?"bg-amber-400 text-black shadow-lg shadow-amber-400/20":"text-slate-500 hover:text-white hover:bg-white/5"}`,children:b==="CARGO"?"Last":b==="UPGRADES"?"Oppgraderinger":b==="STYLE"?"Style":"Reise"},b))}),r.jsx("button",{onClick:s,className:"w-8 h-8 rounded-full bg-white/5 hover:bg-rose-500/20 hover:text-rose-400 flex items-center justify-center text-slate-400 transition-colors",children:""})]}),r.jsx("div",{className:"flex-1 overflow-hidden relative",children:r.jsx("div",{className:"absolute inset-0 overflow-y-auto custom-scrollbar p-8",children:r.jsxs(kt,{mode:"wait",children:[i==="CARGO"&&r.jsx(q.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},className:"space-y-6",children:r.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsxs("h3",{className:"text-xs font-black text-slate-500 uppercase tracking-widest flex items-center gap-2",children:[r.jsx("span",{children:"Ditt Lager"}),r.jsx("div",{className:"h-px bg-slate-800 flex-1"})]}),r.jsx("div",{className:"space-y-2",children:Object.entries(t.resources).map(([b,g])=>{if(b==="gold"||g<=0)return null;const p=Ie[b];return r.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-900/40 rounded-xl border border-white/5 hover:border-amber-400/30 transition-colors group",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-8 h-8 rounded-lg bg-slate-800 flex items-center justify-center text-lg shadow-inner",children:ol[b.toUpperCase()]||""}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs font-bold text-white uppercase group-hover:text-amber-400 transition-colors",children:(p==null?void 0:p.label)||b}),r.jsxs("div",{className:"text-xs text-slate-500 font-bold",children:["Antall: ",g]})]})]}),r.jsx("button",{onClick:()=>d(b),className:"px-3 py-1.5 bg-slate-800 text-white hover:bg-amber-400 hover:text-black text-xs font-black uppercase rounded-lg transition-all",children:""})]},b)})})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("h3",{className:"text-xs font-black text-slate-500 uppercase tracking-widest flex items-center gap-2",children:[r.jsx("span",{children:"Karavane-Lass"}),r.jsx("div",{className:"h-px bg-slate-800 flex-1"})]}),r.jsxs("div",{className:"space-y-2",children:[Object.entries(l.inventory).map(([b,g])=>{if(g<=0)return null;const p=Ie[b];return r.jsxs("div",{className:"flex items-center justify-between p-3 bg-amber-400/5 rounded-xl border border-amber-400/20 hover:bg-amber-400/10 transition-colors group",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-8 h-8 rounded-lg bg-amber-400/10 flex items-center justify-center text-lg border border-amber-400/20",children:ol[b.toUpperCase()]||""}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs font-bold text-amber-200 uppercase",children:(p==null?void 0:p.label)||b}),r.jsxs("div",{className:"text-xs text-amber-400/60 font-bold",children:["Lastet: ",g]})]})]}),r.jsx("button",{onClick:()=>f(b),className:"px-3 py-1.5 bg-slate-900 text-slate-300 hover:text-white border border-slate-700 hover:border-slate-500 text-xs font-black uppercase rounded-lg transition-all",children:"Loss"})]},b)}),Object.values(l.inventory).every(b=>!b||b<=0)&&r.jsx("div",{className:"h-24 flex items-center justify-center border-2 border-dashed border-slate-800 rounded-xl",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl opacity-20 mb-1",children:""}),r.jsx("div",{className:"text-slate-600 text-xs font-bold uppercase",children:"Tomt Lasterom"})]})})]})]})]})},"cargo"),i==="UPGRADES"&&r.jsxs(q.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-8",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-xs font-black text-slate-500 uppercase tracking-widest",children:"Neste Niv"}),(()=>{const b=te.CARAVAN.LEVELS.find(g=>g.level===l.level+1);return b?r.jsxs("div",{className:"p-6 bg-gradient-to-br from-indigo-900/20 to-slate-900/50 rounded-2xl border border-indigo-500/30 flex justify-between items-center group hover:border-indigo-400/50 transition-colors",children:[r.jsxs("div",{className:"flex gap-4 items-center",children:[r.jsx("div",{className:"w-12 h-12 bg-indigo-500/20 rounded-xl flex items-center justify-center text-2xl border border-indigo-500/30",children:""}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-white font-black uppercase italic text-lg group-hover:text-indigo-300 transition-colors",children:b.name}),r.jsxs("p",{className:"text-slate-400 text-xs font-bold uppercase tracking-widest",children:["Kapasitet: ",r.jsx("span",{className:"text-indigo-400",children:b.capacity}),"  Fart: ",r.jsxs("span",{className:"text-indigo-400",children:[b.speed,"x"]})]})]})]}),r.jsxs("button",{onClick:()=>h("LEVEL"),className:"px-6 py-3 bg-white text-slate-950 font-black uppercase italic rounded-xl hover:bg-indigo-400 hover:scale-105 transition-all shadow-lg shadow-indigo-900/20",children:["Kjp ",b.cost,"g"]})]}):r.jsx("p",{className:"text-xs text-emerald-400 font-bold uppercase italic bg-emerald-500/10 p-4 rounded-xl border border-emerald-500/20",children:"Maks niv ndd!"})})()]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-xs font-black text-slate-500 uppercase tracking-widest",children:"Spesialmoduler"}),r.jsx("div",{className:"grid grid-cols-2 gap-4",children:Object.entries(te.CARAVAN.UPGRADES).map(([b,g])=>{const p=(l.upgrades||[]).includes(g.id);return r.jsxs("div",{className:`p-5 rounded-2xl border transition-all ${p?"bg-emerald-900/10 border-emerald-500/20":"bg-slate-900/40 border-white/5 hover:border-white/10"}`,children:[r.jsxs("div",{className:"flex justify-between items-start mb-3",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center text-sm ${p?"bg-emerald-500/20 text-emerald-400":"bg-slate-800 text-slate-400"}`,children:""}),r.jsx("h4",{className:`font-black text-xs uppercase ${p?"text-emerald-400":"text-white"}`,children:g.name})]}),p&&r.jsx("span",{className:"text-xs font-black text-emerald-950 bg-emerald-400 px-2 py-0.5 rounded uppercase",children:"Eies"})]}),r.jsx("p",{className:"text-slate-500 text-xs font-bold uppercase leading-relaxed mb-4 h-8",children:g.benefit}),!p&&r.jsxs("button",{onClick:()=>h("MODULE",b.toLowerCase()),className:"w-full py-2 bg-slate-800 text-white text-xs font-black uppercase rounded-lg hover:bg-slate-700 border border-slate-700 transition-colors",children:["Kjp for ",g.cost,"g"]})]},b)})})]})]},"upgrades"),i==="STYLE"&&r.jsx(q.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"h-full -m-8",children:r.jsx(NV,{player:t,onBuy:b=>e({type:"BUY_CARAVAN_COSMETIC",cosmeticId:b}),onEquip:b=>e({type:"EQUIP_CARAVAN_COSMETIC",cosmeticId:b})})},"style"),i==="TRAVEL"&&r.jsxs(q.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[r.jsx("div",{className:"bg-amber-400/10 p-4 border border-amber-400/20 rounded-xl",children:r.jsxs("p",{className:"text-xs text-amber-200 font-bold uppercase flex items-center gap-2",children:[r.jsx("span",{children:""})," Reisen krever 20 Stamina og 1 Brd-niste."]})}),r.jsx("div",{className:"grid grid-cols-1 gap-4",children:["region_ost","region_vest","capital"].map(b=>{if(b===t.regionId)return null;const g=b==="capital"?"Hovedstaden":b==="region_vest"?"Vestfjella":"stlandet",p=b===n;return r.jsxs("button",{onClick:()=>m(b),className:`group p-6 rounded-2xl border transition-all text-left flex justify-between items-center ${p?"bg-indigo-600/20 border-indigo-400 shadow-[0_0_30px_rgba(99,102,241,0.2)]":"bg-slate-900/40 border-white/5 hover:border-amber-400/50 hover:bg-amber-400/5"}`,children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("h4",{className:`font-black uppercase italic text-xl transition-colors ${p?"text-indigo-300":"text-white group-hover:text-amber-400"}`,children:g}),p&&r.jsx("span",{className:"bg-indigo-500 text-white text-xs font-black px-2 py-0.5 rounded uppercase animate-pulse",children:"Destinasjon"})]}),r.jsx("p",{className:"text-slate-500 text-xs font-bold uppercase tracking-widest mt-1 group-hover:text-slate-400",children:"Klikk for  starte reisen"})]}),r.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center text-2xl group-hover:scale-110 transition-transform ${p?"bg-indigo-500 text-white":"bg-slate-800 text-slate-500 group-hover:bg-amber-400 group-hover:text-black"}`,children:""})]},b)})})]},"travel")]})})})]})]})})},Rj=Ne.memo(({pos:t})=>{const[i,a]=_.useState(0);_.useEffect(()=>{let o;const c=()=>{a(u=>u+.15),o=requestAnimationFrame(c)};return o=requestAnimationFrame(c),()=>cancelAnimationFrame(o)},[]);const l=_.useMemo(()=>Array.from({length:15},(o,c)=>({id:c,seedX:c*777%4e3,seedY:c*999%4e3,scale:.6+c%5*.4,parallaxFactor:1,driftSpeedX:.15+c%3*.1,driftSpeedY:.05+c%2*.05,opacity:.25+c%3*.15,blur:10+c%3*10,hue:200+c%5*2})),[]);return r.jsxs("div",{className:"absolute inset-0 pointer-events-none overflow-hidden z-[200]",style:{contain:"strict"},children:[r.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[6000px] h-[6000px] opacity-[0.03] mix-blend-overlay z-[-1]",style:{backgroundColor:"hsl(210, 65%, 12%)",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1000' height='1000'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.04' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='1000' height='1000' filter='url(%23noise)'/%3E%3C/svg%3E")`,transform:`translate3d(${-t.x*.4}px, ${-t.y*.4}px, 0)`,willChange:"transform"}}),r.jsx("div",{className:"absolute inset-0",style:{perspective:"1000px"},children:l.map(o=>{let c=(o.seedX+i*o.driftSpeedX-t.x*o.parallaxFactor)%4e3,u=(o.seedY+i*o.driftSpeedY-t.y*o.parallaxFactor)%4e3;return c<-2e3&&(c+=4e3),c>2e3&&(c-=4e3),u<-2e3&&(u+=4e3),u>2e3&&(u-=4e3),r.jsx("div",{className:"absolute left-1/2 top-1/2 rounded-full mix-blend-screen",style:{width:250*o.scale,height:150*o.scale,background:`radial-gradient(circle at 30% 40%, hsla(${o.hue}, 20%, 100%, ${o.opacity}) 0%, hsla(${o.hue}, 10%, 90%, ${o.opacity*.6}) 40%, transparent 80%)`,boxShadow:`
                                    ${20*o.scale}px ${10*o.scale}px ${30*o.scale}px hsla(${o.hue}, 10%, 95%, ${o.opacity*.8}),
                                    ${-30*o.scale}px ${20*o.scale}px ${40*o.scale}px hsla(${o.hue}, 10%, 90%, ${o.opacity*.5})
                                `,filter:`blur(${o.blur}px)`,transform:`translate3d(${c}px, ${u}px, 0)`,willChange:"transform"}},o.id)})}),r.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[1200px] h-[1200px] rounded-full pointer-events-none opacity-20 mix-blend-soft-light",style:{background:"radial-gradient(circle, hsla(200, 100%, 50%, 0.2) 0%, transparent 70%)"}})]})});Rj.displayName="SeaBackground";const ii=5e3,Su=[{id:1,x:1200,y:800,r:180,color:"#064e3b",name:"Furuy"},{id:2,x:3500,y:1200,r:250,color:"#14532d",name:"Jungel-atollen"},{id:3,x:800,y:3800,r:120,color:"#451a03",name:"Smuglerbukta"},{id:4,x:4200,y:4e3,r:200,color:"#0f172a",name:"Jernfestningen"},{id:5,x:2500,y:2500,r:150,color:"#1e3a8a",name:"Hovedposten"}],EV=({player:t,roomPin:e,onExit:s,onActionResult:n})=>{var Me,qe,ge,me,ht,Fe,Q,fe;const{setActiveMinigame:i}=ll(),[a,l]=_.useState({x:1e3,y:1e3}),[o,c]=_.useState(0),[u,d]=_.useState(!1),[f,h]=_.useState({}),[m,v]=_.useState([]),[x,b]=_.useState(((Me=t.boat)==null?void 0:Me.hp)||100),[g]=_.useState(((qe=t.boat)==null?void 0:qe.maxHp)||100),[p,y]=_.useState(((ge=t.boat)==null?void 0:ge.cannonballs)||0),[k,N]=_.useState(!1),[S,w]=_.useState(0),[E,j]=_.useState([]),[A,O]=_.useState([]),[L,Y]=_.useState(0),[W,H]=_.useState(null),[M,U]=_.useState([]),C=_.useRef(0),T=_.useRef(0),R=_.useRef({x:0,y:0}),D=_.useRef({x:1e3,y:1e3,rotation:0,angularVelocity:0,speed:0,targetSpeed:0,targetRotation:0,velocityVector:{x:0,y:0},projectiles:[],explosions:[],net:null}),I=_.useRef(0),F=_.useRef(Date.now()),P=_.useRef(Date.now()),B=_.useRef({left:!1,right:!1,up:!1,down:!1,action:!1});_.useEffect(()=>{const V=$(G,`simulation_rooms/${e}/sea_state`),ue=$e(V,St=>{const Ve=St.val();if(Ve){const{[t.id]:qc,...Ll}=Ve;h(Ll)}else h({})}),z=$(G,`simulation_rooms/${e}/world/sea_resources`),gt=$e(z,St=>{const Ve=St.val();v(Ve?Object.values(Ve):[])}),fs=$(G,`simulation_rooms/${e}/sea_state/${t.id}/hp`),es=$e(fs,St=>{const Ve=St.val();Ve!=null&&(b(Ve),Ve<=0&&N(!0))}),Es=$(G,`simulation_rooms/${e}/sea_state/${t.id}`);return $e(Es,St=>{const Ve=St.val();Ve&&Ve.x&&Ve.y&&D.current.x===1e3&&D.current.y===1e3&&(D.current.x=Ve.x,D.current.y=Ve.y,D.current.rotation=Ve.rotation||0,l({x:Ve.x,y:Ve.y}),c(Ve.rotation||0))},{onlyOnce:!0}),()=>{ue(),gt(),es()}},[e,t.id]),_.useEffect(()=>{var V;y(((V=t.boat)==null?void 0:V.cannonballs)||0)},[(me=t.boat)==null?void 0:me.cannonballs]),_.useEffect(()=>(i("SAILING"),()=>i(null)),[]),_.useEffect(()=>{const V=()=>{const ue=$(G,`simulation_rooms/${e}/sea_state/${t.id}`);ne(ue,{isOffline:!0,timestamp:Date.now()})};return window.addEventListener("beforeunload",V),()=>window.removeEventListener("beforeunload",V)},[e,t.id]),_.useEffect(()=>{ne($(G,`simulation_rooms/${e}/sea_state/${t.id}`),{hp:x,maxHp:g,isOffline:!1})},[]);const J=V=>{const ue={CANNON:"sounds/sfx/cannon_fire.mp3",EXPLOSION:"sounds/sfx/explosion.mp3",SPLASH:"sounds/sfx/splash.mp3"},z=new Audio(`/Simulation_StandAlone_Pro/${ue[V]}`);z.volume=.5,z.play().catch(()=>{})},se=async()=>{try{await ne($(G,`simulation_rooms/${e}/players/${t.id}/boat`),{hp:x,isDamaged:x<=0}),s()}catch(V){console.error("Failed to save boat state:",V),s()}},ie=()=>{const V=Date.now();if(V-S<1500||u||k||p<=0)return;const ue=p-1;y(ue),ne($(G,`simulation_rooms/${e}/players/${t.id}/boat`),{cannonballs:ue}),w(V),Y(5),setTimeout(()=>Y(0),200),J("CANNON");const z=D.current,gt=z.rotation*Math.PI/180,fs=40,es=z.x+Math.cos(gt)*fs,Es=z.y+Math.sin(gt)*fs,St=600,Ve=Math.cos(gt)*St,qc=Math.sin(gt)*St,Ll={id:T.current++,x:es,y:Es,vx:Ve,vy:qc,ownerId:t.id,createdAt:V};D.current.projectiles.push(Ll)},Ee=async V=>{if(V==="FIRE"){ie();return}if(V==="FISH"){if(u||D.current.speed>1)return;const ue=D.current,z=ue.rotation*Math.PI/180,gt=60;ue.net={active:!0,x:ue.x+Math.cos(z)*gt,y:ue.y+Math.sin(z)*gt,radius:0,t:0,caught:!1},d(!0),H({...ue.net}),Y(2),setTimeout(()=>Y(0),100)}},ye=V=>1+2.70158*Math.pow(V-1,3)+1.70158*Math.pow(V-1,2),ae=V=>2.70158*V*V*V-1.70158*V*V,Z=()=>{const V=Date.now(),ue=(V-F.current)/1e3;F.current=V;const z=D.current;if(x<=0&&!k){N(!0),z.speed=0,z.targetSpeed=0;return}if(k)return;const gt=.92,fs=.2,es=.15,Es=.985,St=.05;B.current.left&&(z.angularVelocity-=fs),B.current.right&&(z.angularVelocity+=fs),z.angularVelocity*=gt,z.rotation+=z.angularVelocity,B.current.up&&(z.targetSpeed=Math.min(z.targetSpeed+St,5)),B.current.down&&(z.targetSpeed=Math.max(z.targetSpeed-St,0)),z.speed=z.speed*Es+z.targetSpeed*(1-Es);const Ve=z.rotation*Math.PI/180,qc=Math.cos(Ve)*z.speed,Ll=Math.sin(Ve)*z.speed;z.velocityVector.x=z.velocityVector.x*(1-es)+qc*es,z.velocityVector.y=z.velocityVector.y*(1-es)+Ll*es;let Xc=z.x+z.velocityVector.x,Qc=z.y+z.velocityVector.y,yn=null;for(const Te of Su)if(Math.hypot(Xc-Te.x,Qc-Te.y)<Te.r+30){yn=Te;break}if(!yn&&Xc>0&&Xc<ii&&Qc>0&&Qc<ii)z.x=Xc,z.y=Qc;else if(yn){const Te=(z.x-yn.x)/Math.hypot(z.x-yn.x,z.y-yn.y),ts=(z.y-yn.y)/Math.hypot(z.x-yn.x,z.y-yn.y),Pt=z.velocityVector.x*Te+z.velocityVector.y*ts;z.velocityVector.x=(z.velocityVector.x-2*Pt*Te)*.5,z.velocityVector.y=(z.velocityVector.y-2*Pt*ts)*.5,z.speed*=.5,z.targetSpeed*=.3,Y(8),setTimeout(()=>Y(0),300)}else z.velocityVector.x*=-.5,z.velocityVector.y*=-.5;l({x:z.x,y:z.y}),c(z.rotation);const Cj=z.projectiles,ob=[];for(const Te of Cj){if(Te.x+=Te.vx*ue,Te.y+=Te.vy*ue,V-Te.createdAt>2e3)continue;let ts=!1;for(const Pt of Su)if(Math.hypot(Te.x-Pt.x,Te.y-Pt.y)<Pt.r){ts=!0,D.current.explosions.push({id:Math.random(),x:Te.x,y:Te.y,createdAt:V}),J("EXPLOSION");break}if(!ts){for(const Pt in f){const ra=f[Pt];if(Math.hypot(Te.x-ra.x,Te.y-ra.y)<40){ts=!0,D.current.explosions.push({id:Math.random(),x:Te.x,y:Te.y,createdAt:V}),J("EXPLOSION");const Jc=$(G,`simulation_rooms/${e}/sea_state/${Pt}/hp`);je(Jc,ub=>ub===null?100:Math.max(0,ub-25));break}}ts||ob.push(Te)}}z.projectiles=ob,z.explosions=z.explosions.filter(Te=>V-Te.createdAt<500),j([...z.projectiles]),O([...z.explosions]);const cb=40,th=z.x-Math.cos(Ve)*cb,sh=z.y-Math.sin(Ve)*cb;if(Math.hypot(th-R.current.x,sh-R.current.y)>25&&(U(Te=>{const ts=[...Te,{x:th,y:sh,id:C.current++}];return ts.length>40&&ts.shift(),ts}),R.current={x:th,y:sh}),z.net&&z.net.active){if(z.net.t+=ue*.8,z.net.t<.5){const Te=z.net.t*2;z.net.radius=ye(Te)*120}else if(z.net.t<.6){if(!z.net.caught){const Te=z.net.x,ts=z.net.y,Pt=m.find(ra=>{const la=ra.x-Te,Jc=ra.y-ts;return Math.sqrt(la*la+Jc*Jc)<120});if(Pt){z.net.caught=!0;const ra=$(G,`simulation_rooms/${e}/world/sea_resources/${Pt.id}`);je(ra,la=>{if(la!==null)return null}).then(()=>{const la=(t.resources.fish_raw||0)+Pt.amount;ne($(G,`simulation_rooms/${e}/players/${t.id}/resources`),{fish_raw:la}),J("SPLASH")}).catch(()=>{z.net.caught=!1}),n&&n({success:!0,timestamp:Date.now(),message:`Du fanget ${Pt.amount} stk ${Pt.type}!`,utbytte:[{resource:"fish_raw",amount:Pt.amount,name:Pt.type,icon:""}],xp:[{skill:"SAILING",amount:15}],durability:[]})}}z.net.radius=120}else{const Te=(z.net.t-.6)/.4;z.net.radius=(1-ae(Te))*120}z.net.t>=1&&(z.net.active=!1,d(!1),z.net=null),H(z.net?{...z.net}:null)}I.current=requestAnimationFrame(Z)};return _.useEffect(()=>{let V;const ue=()=>{var gt,fs,es,Es;const z=Date.now();z-P.current>100&&(ne($(G,`simulation_rooms/${e}/sea_state/${t.id}`),{id:t.id,name:t.name,x:D.current.x,y:D.current.y,rotation:D.current.rotation,speed:D.current.speed,stage:((gt=t.boat)==null?void 0:gt.stage)||1,model:((fs=t.boat)==null?void 0:fs.model)||"standard",componentLevels:((es=t.boat)==null?void 0:es.componentLevels)||{sails:0,hull:0,cannons:0,nets:0},customization:((Es=t.boat)==null?void 0:Es.customization)||{color:"#4b2c20",flagId:"none",figurehead:"none",unlocked:[]},isFishing:u,timestamp:z}),P.current=z),V=requestAnimationFrame(ue)};return ue(),I.current=requestAnimationFrame(Z),()=>{cancelAnimationFrame(V),cancelAnimationFrame(I.current)}},[e,t.id,u]),_.useEffect(()=>{const V=z=>{(z.key==="a"||z.key==="ArrowLeft")&&(B.current.left=!0),(z.key==="d"||z.key==="ArrowRight")&&(B.current.right=!0),(z.key==="w"||z.key==="ArrowUp")&&(B.current.up=!0),(z.key==="s"||z.key==="ArrowDown")&&(B.current.down=!0),z.key===" "&&Ee("FISH"),z.key==="f"&&Ee("FIRE")},ue=z=>{(z.key==="a"||z.key==="ArrowLeft")&&(B.current.left=!1),(z.key==="d"||z.key==="ArrowRight")&&(B.current.right=!1),(z.key==="w"||z.key==="ArrowUp")&&(B.current.up=!1),(z.key==="s"||z.key==="ArrowDown")&&(B.current.down=!1)};return window.addEventListener("keydown",V),window.addEventListener("keyup",ue),()=>{window.removeEventListener("keydown",V),window.removeEventListener("keyup",ue)}},[]),k?r.jsxs("div",{className:"fixed inset-0 z-[300] bg-black flex flex-col items-center justify-center text-red-600 font-black animate-in fade-in duration-1000",children:[r.jsx(n$,{size:128,className:"mb-4 animate-pulse"}),r.jsx("h1",{className:"text-6xl uppercase tracking-tighter",children:"Skipbrudden"}),r.jsx("p",{className:"text-white/50 mt-4 text-xl",children:"Ditt skip er sunket til havets bunn."}),r.jsx("button",{onClick:async()=>{try{await ne($(G,`simulation_rooms/${e}/players/${t.id}/boat`),{hp:10,isDamaged:!0}),s()}catch(V){console.error("Failed to wash ashore:",V),s()}},className:"mt-12 px-8 py-3 bg-red-900/20 border border-red-900 hover:bg-red-900/40 text-red-500 rounded transition-all uppercase tracking-widest",children:"Skyll i land"})]}):r.jsxs("div",{className:"absolute inset-0 z-0 bg-[#051a2e] overflow-hidden cursor-crosshair font-sans",onMouseDown:()=>Ee("FIRE"),style:{background:"radial-gradient(circle at 50% 50%, #0a2e4d 0%, #051a2e 100%)",transform:L>0?`translate(${(Math.random()-.5)*L}px, ${(Math.random()-.5)*L}px)`:"none",transition:"transform 0.05s linear",contain:"strict"},children:[r.jsx(Rj,{pos:a}),r.jsx("svg",{className:"absolute inset-0 w-full h-full overflow-visible blur-md pointer-events-none",children:M.map((V,ue)=>{if(ue===0)return null;const z=M[ue-1],gt=ue/M.length;return r.jsx("line",{x1:z.x-a.x+window.innerWidth/2,y1:z.y-a.y+window.innerHeight/2,x2:V.x-a.x+window.innerWidth/2,y2:V.y-a.y+window.innerHeight/2,stroke:"#fff",strokeWidth:25*gt,strokeOpacity:.08*gt,strokeLinecap:"round"},V.id)})}),Su.map(V=>r.jsxs("div",{className:"absolute pointer-events-none",style:{transform:`translate3d(${V.x-a.x+window.innerWidth/2}px, ${V.y-a.y+window.innerHeight/2}px, 0)`},children:[r.jsx("div",{className:"absolute inset-0 bg-white/5 blur-3xl opacity-30 rounded-full",style:{width:V.r*3,height:V.r*3,transform:"translate(-50%, -50%)"}}),r.jsx("div",{className:"absolute rounded-full shadow-[0_0_50px_rgba(0,0,0,0.5)]",style:{width:V.r*2,height:V.r*2,backgroundColor:V.color,transform:"translate(-50%, -50%)",border:"8px solid rgba(255,255,255,0.05)"}}),r.jsx("div",{className:"absolute top-[110%] left-1/2 -translate-x-1/2 text-white/20 text-[10px] uppercase tracking-[0.3em] font-black whitespace-nowrap",children:V.name})]},V.id)),m.map(V=>r.jsxs("div",{className:"absolute pointer-events-none",style:{transform:`translate3d(${V.x-a.x+window.innerWidth/2}px, ${V.y-a.y+window.innerHeight/2}px, 0)`},children:[r.jsx("div",{className:"absolute inset-0 bg-white/30 blur-md rounded-full animate-ping",style:{width:40,height:40,transform:"translate(-50%, -50%)",animationDuration:"3s"}}),r.jsxs("div",{className:"absolute flex flex-col items-center",style:{transform:"translate(-50%, -50%)"},children:[r.jsx(q.div,{animate:{y:[0,-5,0]},transition:{repeat:1/0,duration:2,ease:"easeInOut"},children:r.jsx(uH,{size:20,className:"text-cyan-400 drop-shadow-[0_0_8px_rgba(34,211,238,0.8)]"})}),r.jsxs("div",{className:"text-[9px] font-black text-cyan-200/60 uppercase tracking-widest mt-1 bg-black/40 px-1.5 py-0.5 rounded backdrop-blur-sm border border-white/5",children:[V.amount," ",V.type]})]})]},V.id)),r.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[E.map(V=>r.jsx("div",{className:"absolute w-2 h-2 bg-black rounded-full shadow-lg",style:{transform:`translate3d(${V.x-a.x+window.innerWidth/2}px, ${V.y-a.y+window.innerHeight/2}px, 0)`}},V.id)),A.map(V=>r.jsx("div",{className:"absolute w-16 h-16 bg-orange-500 rounded-full animate-ping opacity-60",style:{transform:`translate3d(${V.x-a.x+window.innerWidth/2}px, ${V.y-a.y+window.innerHeight/2}px, 0) translate(-50%, -50%)`}},V.id))]}),W&&W.active&&r.jsxs("div",{className:"absolute pointer-events-none",style:{transform:`translate3d(${W.x-a.x+window.innerWidth/2}px, ${W.y-a.y+window.innerHeight/2}px, 0)`},children:[W.t>=.5&&W.t<.7&&r.jsx(q.div,{initial:{scale:.8,opacity:.8},animate:{scale:1.2,opacity:0},className:"absolute inset-0 rounded-full border-4 border-white/40 blur-sm",style:{width:240,height:240,transform:"translate(-50%, -50%)"}}),r.jsxs("svg",{width:W.radius*2.5,height:W.radius*2.5,viewBox:"0 0 100 100",className:"absolute",style:{transform:"translate(-50%, -50%)"},children:[r.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"hsl(28, 55%, 35%)",strokeWidth:"3",strokeDasharray:"4 2",className:"opacity-80"}),r.jsx("circle",{cx:"50",cy:"50",r:"38",fill:"hsl(28, 55%, 20%)",fillOpacity:"0.1",stroke:"hsl(28, 55%, 45%)",strokeWidth:"1"}),r.jsx("path",{d:"M 50 10 L 50 90 M 10 50 L 90 50 M 22 22 L 78 78 M 22 78 L 78 22",stroke:"hsl(28, 55%, 35%)",strokeWidth:"1",strokeOpacity:"0.3"})]}),W.caught&&r.jsx(q.div,{initial:{scale:0},animate:{scale:[0,1.5,1]},className:"absolute -top-12 left-1/2 -translate-x-1/2 text-cyan-400 font-black text-xs uppercase tracking-widest bg-black/60 px-2 py-1 rounded backdrop-blur-md border border-cyan-500/30",children:"Fangst!"})]}),Object.values(f).map(V=>V.isOffline?null:r.jsxs("div",{className:"absolute w-32 h-32",style:{transform:`translate3d(${V.x-a.x+window.innerWidth/2}px, ${V.y-a.y+window.innerHeight/2}px, 0) translate(-50%, -50%)`},children:[r.jsx(q.div,{style:{rotate:V.rotation},className:"w-full h-full",children:r.jsx(lf,{stage:V.stage,model:V.model,componentLevels:V.componentLevels,customization:V.customization||{color:"#64748b"},rotation:0})}),r.jsx("div",{className:"absolute -top-10 left-1/2 -translate-x-1/2 text-center w-48",children:r.jsx("div",{className:"text-[10px] font-black text-white/40 uppercase tracking-widest shadow-black drop-shadow-md",children:V.name})})]},V.id)),r.jsx(q.div,{animate:{scale:S>Date.now()-200?[1,.92,1]:W!=null&&W.active?[1,1.05,1]:1,opacity:u?.9:1},transition:{duration:.2},className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-40 h-40 z-10 pointer-events-none",children:r.jsx(lf,{stage:((ht=t.boat)==null?void 0:ht.stage)||1,model:(Fe=t.boat)==null?void 0:Fe.model,componentLevels:(Q=t.boat)==null?void 0:Q.componentLevels,customization:(fe=t.boat)==null?void 0:fe.customization,rotation:o})}),r.jsx(kt,{children:r.jsxs(q.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},className:"absolute bottom-12 left-1/2 -translate-x-1/2 flex flex-col items-center gap-2 pointer-events-none",children:[r.jsx("div",{className:"px-3 py-1 bg-black/40 backdrop-blur-xl border border-white/10 rounded-full text-[10px] font-black uppercase text-red-500 tracking-[0.2em]",children:"Skrog"}),r.jsx("div",{className:"w-80 h-3 bg-black/60 border border-white/5 rounded-full overflow-hidden shadow-2xl backdrop-blur-md",role:"progressbar","aria-valuenow":x,"aria-valuemin":0,"aria-valuemax":g,"aria-label":"Skipets holdbarhet",children:r.jsx(q.div,{className:"h-full bg-gradient-to-r from-red-600 via-orange-500 to-red-600 shadow-[0_0_20px_rgba(220,38,38,0.5)]",animate:{width:`${x/g*100}%`},transition:{type:"spring",stiffness:50,damping:15}})}),r.jsxs("div",{className:"text-[10px] text-white/30 font-bold uppercase tracking-widest",children:[Math.round(x)," / ",g," HP"]})]})}),r.jsx(kt,{children:r.jsxs(q.div,{initial:{x:50,opacity:0},animate:{x:0,opacity:1},className:"absolute bottom-12 right-12 flex flex-col items-end gap-2 pointer-events-none",children:[r.jsx("div",{className:"px-3 py-1 bg-black/40 backdrop-blur-xl border border-white/10 rounded-full text-[10px] font-black uppercase text-amber-500 tracking-[0.2em]",children:"AMMUNISJON"}),r.jsxs("div",{className:`p-6 rounded-[2rem] border backdrop-blur-2xl flex flex-col items-center justify-center min-w-[120px] transition-colors duration-500
                        ${p>10?"bg-slate-950/40 border-white/10":p>0?"bg-amber-950/40 border-amber-500/30":"bg-red-950/60 border-red-500/50 animate-pulse"}
                    `,children:[r.jsxs("div",{className:"flex items-end gap-1 mb-1",children:[r.jsx("span",{className:`text-5xl font-black italic tracking-tighter leading-none
                                ${p>10?"text-white":p>0?"text-amber-400":"text-red-500"}
                            `,children:p}),r.jsx("span",{className:"text-white/20 text-sm font-bold uppercase mb-1",children:"stk"})]}),r.jsxs("div",{className:"flex items-center gap-2 opacity-50",children:[r.jsx(QU,{size:12,className:p>0?"fill-current text-white":"text-red-500"}),r.jsx("div",{className:"w-12 h-1 bg-white/10 rounded-full overflow-hidden",children:r.jsx(q.div,{className:`h-full ${p>0?"bg-white":"bg-red-500"}`,animate:{width:`${Math.min(100,p/50*100)}%`}})})]})]})]})}),r.jsx(q.button,{whileHover:{scale:1.05,backgroundColor:"rgba(127, 29, 29, 0.6)"},whileTap:{scale:.95},onClick:se,"aria-label":"Tilbake til kai",className:"absolute top-8 left-8 z-[110] px-6 py-2 bg-red-950/40 backdrop-blur-md border border-[#c29d0b]/40 rounded-sm text-[10px] text-[#e5e7eb] font-black uppercase tracking-[0.25em] transition-all hover:border-[#c29d0b] shadow-2xl",children:"Tilbake til kai"}),r.jsxs("div",{className:"absolute bottom-6 right-8 flex gap-8 text-white/20 text-[9px] font-black uppercase tracking-[0.2em]",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-white/40",children:"WASD"})," Manvrering"]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-white/40",children:"SPACE"})," Fisking"]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-white/40",children:"F"})," Avfyr Kanon"]})]}),r.jsx("div",{className:"absolute top-6 right-6 w-44 h-44 bg-black/30 rounded-full border border-white/5 backdrop-blur-md overflow-hidden z-50 pointer-events-none opacity-60",children:r.jsxs("div",{className:"relative w-full h-full p-6",children:[Su.map(V=>r.jsx("div",{className:"absolute rounded-full bg-emerald-500/20",style:{width:V.r/ii*100+"%",height:V.r/ii*100+"%",left:V.x/ii*100+"%",top:V.y/ii*100+"%",transform:"translate(-50%, -50%)"}},V.id)),r.jsx("div",{className:"absolute w-1.5 h-1.5 bg-cyan-400 rounded-full shadow-[0_0_10px_cyan]",style:{left:a.x/ii*100+"%",top:a.y/ii*100+"%",transform:"translate(-50%, -50%)"}})]})}),window.matchMedia("(pointer: coarse)").matches&&r.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[r.jsxs("div",{className:"absolute bottom-12 right-12 flex flex-col items-center gap-2 pointer-events-auto scale-75 md:scale-100 origin-bottom-right",children:[r.jsx(q.button,{whileTap:{scale:.9},onTouchStart:()=>{B.current.up=!0},onTouchEnd:()=>{B.current.up=!1},"aria-label":"Manvrer opp",className:"w-16 h-16 bg-white/5 backdrop-blur-md rounded-full border border-white/10 flex items-center justify-center text-white/40 font-black",children:"W"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(q.button,{whileTap:{scale:.9},onTouchStart:()=>{B.current.left=!0},onTouchEnd:()=>{B.current.left=!1},"aria-label":"Snu til venstre",className:"w-16 h-16 bg-white/5 backdrop-blur-md rounded-full border border-white/10 flex items-center justify-center text-white/40 font-black",children:"A"}),r.jsx(q.button,{whileTap:{scale:.9},onTouchStart:()=>{B.current.down=!0},onTouchEnd:()=>{B.current.down=!1},"aria-label":"Manvrer ned",className:"w-16 h-16 bg-white/5 backdrop-blur-md rounded-full border border-white/10 flex items-center justify-center text-white/40 font-black",children:"S"}),r.jsx(q.button,{whileTap:{scale:.9},onTouchStart:()=>{B.current.right=!0},onTouchEnd:()=>{B.current.right=!1},"aria-label":"Snu til hyre",className:"w-16 h-16 bg-white/5 backdrop-blur-md rounded-full border border-white/10 flex items-center justify-center text-white/40 font-black",children:"D"})]})]}),r.jsxs("div",{className:"absolute bottom-12 left-12 flex gap-4 pointer-events-auto scale-75 md:scale-100 origin-bottom-left",children:[r.jsxs(q.button,{whileTap:{scale:.9},onClick:()=>Ee("FIRE"),"aria-label":"Avfyr kanon",className:"w-20 h-20 bg-red-900/20 backdrop-blur-md rounded-full border border-red-500/20 flex flex-col items-center justify-center text-red-500/60 font-black text-[10px] tracking-widest",children:[r.jsx("span",{children:"F"}),r.jsx("span",{children:"ILD"})]}),r.jsxs(q.button,{whileTap:{scale:.9},onClick:()=>Ee("FISH"),"aria-label":"Fiske",className:"w-20 h-20 bg-blue-900/20 backdrop-blur-md rounded-full border border-blue-500/20 flex flex-col items-center justify-center text-blue-500/60 font-black text-[10px] tracking-widest",children:[r.jsx("span",{children:"SPACE"}),r.jsx("span",{children:"FISK"})]})]})]})]})},jV=()=>{const{pin:t}=sS(),[e]=RC(),s=e.get("impersonate"),n=_l(),{user:i,account:a,loading:l}=Wf(),{activeMinigame:o,setActiveMinigame:c,activeMinigameAction:u,setActiveMinigameAction:d,activeMinigameMethod:f,setActiveMinigameMethod:h}=ll(),{setHideHeader:m,setFullWidth:v}=lS();Ne.useEffect(()=>{m(!0),v(!0);const ge=()=>{zt(async()=>{const{audioManager:me}=await Promise.resolve().then(()=>l6);return{audioManager:me}},void 0).then(({audioManager:me})=>{me.resume()}),window.removeEventListener("click",ge),window.removeEventListener("keydown",ge)};return window.addEventListener("click",ge),window.addEventListener("keydown",ge),()=>{m(!1),v(!1),window.removeEventListener("click",ge),window.removeEventListener("keydown",ge)}},[m,v]);const{player:x,world:b,players:g,roomStatus:p,markets:y,messages:k,diplomacy:N,activeVote:S,worldEvents:w,trades:E,regions:j,hasAttemptedPlayerLoad:A,isRetired:O}=zG(t,s);Ne.useEffect(()=>{if(!x||!t||!x.resources)return;const ge=x.resources,me=ge.oak_log||0,ht=ge.oak_lumber||0;if(me>0||ht>0){console.log("MIGRATION: Converting Legacy Oak...",{oakLog:me,oakLumber:ht});const Fe={};Fe[`players/${x.id}/resources/oak_log`]=null,Fe[`players/${x.id}/resources/oak_lumber`]=null,Fe[`players/${x.id}/resources/wood`]=(ge.wood||0)+me,Fe[`players/${x.id}/resources/plank`]=(ge.plank||0)+ht;const Q=$(G,`simulation_rooms/${t}`);ne(Q,Fe).then(()=>console.log("MIGRATION: Success")).catch(fe=>console.error("MIGRATION: Failed",fe))}},[x==null?void 0:x.id,x==null?void 0:x.resources,t]);const{handleAction:L,actionResult:Y,setActionResult:W,handleClearActionResult:H}=Nj(t,x,b,c,h,d,o),[M,U]=_.useState(!1),[C,T]=_.useState(null),[R,D]=_.useState(null),[I,F]=_.useState(!1),[P,B]=_.useState(!1),[J,se]=_.useState(!1),[ie,Ee]=_.useState(!1),[ye,ae]=_.useState(void 0),Z=ge=>{const me=typeof ge=="string"?ge:ge.type;if(me==="MOUNT_HORSE"&&!ge.method){F(!0);return}if(me==="OPEN_TAVERN_MENU"){B(!0);return}if(me==="OPEN_WEAPON_RACK"){se(!0);return}if(me==="OPEN_CARAVAN"){ge.targetRegionId&&ae(ge.targetRegionId),Ee(!0);return}L(ge)},Me=async(ge,me)=>{if(!(!t||!i)){U(!0);try{const ht=$(G,`simulation_rooms/${t}`),Fe=s||i.uid;let Q=Math.random()>.5?"region_ost":"region_vest";me==="BARON"?Q=`region_${Fe}`:me==="KING"&&(Q="capital");const fe={id:Fe,uid:i.uid,name:ge,role:me,regionId:Q,resources:Gt[me]||Gt.PEASANT,skills:Fs[me]||Fs.PEASANT,stats:{xp:0,level:1,reputation:50,contribution:0},status:{hp:100,morale:100,stamina:50,legitimacy:100,authority:50,loyalty:100,isJailed:!1,isFrozen:!1},equipment:F0[me]||F0.PEASANT,upgrades:[],lastActive:Date.now()},V={id:Fe,uid:i.uid,name:ge,role:me,regionId:Q,stats:{level:1},status:{isJailed:!1,isFrozen:!1,legitimacy:100},online:!0,lastActive:Date.now()},ue={};ue[`players/${Fe}`]=fe,ue[`public_profiles/${Fe}`]=V,await ne(ht,ue)}catch(ht){console.error("Failed to create player:",ht),alert("Kunne ikke opprette karakter.")}finally{U(!1)}}},qe=_.useMemo(()=>({status:p,world:b,players:g||{},messages:k||[],markets:y||{},market:(y&&(x!=null&&x.regionId)?y[x.regionId]:Object.values(y||{})[0])||{},diplomacy:N||{},trades:E||{},activeVote:S,worldEvents:w||{},regions:j||{},settings:"feudal_europe",pin:t||""}),[p,b,g,k,y,N,S,w,E,j,t]);return l||!A?r.jsxs("div",{className:"min-h-screen bg-slate-950 flex flex-col items-center justify-center gap-8 p-12",children:[r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"w-24 h-24 border-4 border-indigo-500/20 rounded-full"}),r.jsx("div",{className:"absolute inset-0 w-24 h-24 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"})]}),r.jsx("h2",{className:"text-2xl font-black italic text-white animate-pulse",children:"Kaller p ndene..."})]}):O?r.jsx("div",{className:"fixed inset-0 z-[100] bg-slate-950/90 backdrop-blur-xl flex items-center justify-center p-6 text-center",children:r.jsxs("div",{className:"max-w-md bg-slate-900 border-2 border-indigo-500/30 rounded-[3rem] p-12 space-y-8 shadow-2xl",children:[r.jsx(mc,{size:48,className:"text-white mx-auto animate-bounce"}),r.jsx("h2",{className:"text-4xl font-black italic text-white",children:"ET LIV ER OVER"}),r.jsx("button",{onClick:()=>n("/sim"),className:"w-full py-4 bg-indigo-600 text-white rounded-2xl font-black uppercase",children:"Tilbake til Lobby"})]})}):x?b?r.jsxs("div",{className:"relative min-h-screen bg-slate-900 text-white overflow-hidden flex flex-col",children:[r.jsx("div",{className:"flex-1 flex flex-col relative",children:r.jsxs("div",{className:"fixed inset-0 top-0 bg-slate-950 text-slate-200 flex overflow-hidden",children:[r.jsx("div",{className:"fixed inset-0 pointer-events-none opacity-20",children:r.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-indigo-600/20 blur-[120px] rounded-full animate-pulse"})}),!x.hasSeenIntro&&r.jsx(bV,{player:x,pin:t||"",onComplete:()=>{x.hasSeenIntro=!0}}),o&&o!=="SAILING"&&r.jsx(pF,{type:o,player:x,playerUpgrades:x.upgrades,equipment:Object.values(x.equipment||{}),skills:x.skills,selectedMethod:f||void 0,action:u,onComplete:(ge,me)=>{o==="TRAVEL_START"?ge>0?(console.log("[SimulationPlayer] Minigame Complete. Data:",me),L({type:"TRAVEL_COMPLETE",targetRegionId:u==null?void 0:u.targetRegionId,finalDurability:me==null?void 0:me.durability})):L({type:"TRAVEL_FAILED",targetRegionId:u==null?void 0:u.targetRegionId,finalDurability:0}):L({...u||{},performance:ge,method:f})},onCancel:()=>{c(null),d(null),h(null)},currentSeason:(b==null?void 0:b.season)||"Spring",currentWeather:(b==null?void 0:b.weather)||"Clear",totalTicks:(b==null?void 0:b.totalTicks)||0}),I&&r.jsx(hV,{player:x,onAction:L,onClose:()=>F(!1)}),P&&r.jsx(mV,{player:x,room:qe,onAction:L,onClose:()=>B(!1)}),J&&r.jsx(AF,{player:x,onAction:L,onClose:()=>se(!1)}),ie&&r.jsx(SV,{player:x,onAction:L,onClose:()=>{Ee(!1),ae(void 0)},preselectedTarget:ye}),r.jsx(lV,{}),r.jsxs("div",{className:"flex flex-col h-full w-full overflow-hidden",children:[r.jsx(KG,{room:qe,player:x,pin:t,onAction:Z}),r.jsxs("main",{className:"flex-1 relative overflow-hidden bg-slate-950/50",children:[r.jsx(rV,{player:x,room:qe,pin:t,onAction:Z,actionResult:Y,onClearActionResult:H}),r.jsx(kt,{children:o==="SAILING"&&r.jsx(q.div,{initial:{opacity:0,scale:1.05},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.4,ease:[.22,1,.36,1]},className:"absolute inset-0 z-50 bg-slate-950",children:r.jsx(EV,{player:x,roomPin:qe.pin,onExit:()=>c(null),onActionResult:W})})})]})]})]})}),C&&r.jsx(oV,{level:C.level,title:C.title,onClose:()=>T(null)}),r.jsx(yV,{pin:t||"",player:x,onOpenProfile:ge=>{const me=qe.players[ge];me?D(me):console.warn("Spiller ikke funnet i rommet:",ge)}}),R&&r.jsx(kV,{isOpen:!0,onClose:()=>D(null),myPlayer:x,targetPlayer:R,pin:t||""})]}):r.jsxs("div",{className:"min-h-screen bg-slate-950 flex flex-col items-center justify-center gap-4 text-white",children:[r.jsx("div",{className:"w-12 h-12 border-4 border-indigo-500 border-t-white rounded-full animate-spin"}),r.jsx("p",{className:"text-sm font-bold uppercase tracking-widest text-indigo-400",children:"Laster verden..."})]}):r.jsx("div",{className:"min-h-screen bg-slate-950 flex items-center justify-center p-6",children:r.jsx(cV,{pin:t||"",account:a,onCreatePlayer:Me,isCreating:M})})},TV=()=>r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[1,2,3,4].map(t=>r.jsx("div",{className:"h-36 bg-white/5 rounded-2xl animate-pulse border border-white/5 relative overflow-hidden",children:r.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent -translate-x-full animate-[shimmer_2s_infinite]"})},t))}),AV=({server:t,onClick:e})=>{const s={Spring:{color:"text-emerald-400",icon:kH,label:"Vr",bg:"group-hover:bg-emerald-500/10"},Summer:{color:"text-amber-400",icon:o$,label:"Sommer",bg:"group-hover:bg-amber-500/10"},Autumn:{color:"text-orange-400",icon:bj,label:"Hst",bg:"group-hover:bg-orange-500/10"},Winter:{color:"text-blue-400",icon:a$,label:"Vinter",bg:"group-hover:bg-blue-500/10"}},n=s[t.season]||s.Spring;return r.jsxs(q.button,{layout:!0,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},whileHover:{y:-4},onClick:e,className:`group relative overflow-hidden flex flex-col p-6 bg-white/5 border border-white/5 hover:border-white/20 rounded-2xl transition-all text-left shadow-xl ${n.bg}`,children:[r.jsxs("div",{className:"flex justify-between items-start mb-6 relative z-10",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("h3",{className:"text-lg font-black text-white group-hover:text-white transition-colors leading-tight truncate max-w-[200px]",children:t.name||`Rike #${t.pin}`}),r.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-black text-white/30 uppercase tracking-[0.2em] mt-1",children:[r.jsxs("span",{className:"px-1.5 py-0.5 bg-white/5 rounded",children:["PIN: ",t.pin]}),r.jsxs("span",{className:"opacity-50",children:["BY: ",t.hostName]})]})]}),r.jsx("div",{className:`p-2.5 rounded-xl bg-white/5 backdrop-blur-md border border-white/10 ${n.color} group-hover:scale-110 transition-transform`,children:r.jsx(n.icon,{size:20})})]}),r.jsxs("div",{className:"mt-auto flex items-center justify-between relative z-10",children:[r.jsxs("div",{className:"flex items-center gap-6",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[9px] uppercase tracking-[0.15em] text-white/20 font-black mb-1",children:"Live N"}),r.jsxs("div",{className:"flex items-center gap-1.5 text-white/80 font-black",children:[r.jsx(ab,{size:14,className:"text-indigo-400"}),r.jsx("span",{className:"text-sm tabular-nums",children:t.playerCount||0})]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[9px] uppercase tracking-[0.15em] text-white/20 font-black mb-1",children:"Tidsalder"}),r.jsxs("div",{className:"flex items-center gap-1.5 text-white/80 font-black",children:[r.jsx(HU,{size:14,className:"text-amber-500"}),r.jsxs("span",{className:"text-sm italic",children:[n.label," ",t.worldYear]})]})]})]}),r.jsxs("div",{className:"flex items-center gap-1 text-[10px] font-black uppercase tracking-wider text-white/10 group-hover:text-white transition-colors",children:["Join ",r.jsx(Ca,{size:14})]})]}),r.jsx("div",{className:"absolute -bottom-6 -right-6 opacity-[0.02] group-hover:opacity-[0.05] transition-opacity",children:r.jsx(n.icon,{size:120})}),r.jsx("div",{className:"absolute inset-0 border-2 border-indigo-500/0 group-hover:border-indigo-500/20 rounded-2xl transition-all"})]})},RV=()=>{const[t,e]=_.useState([]),[s,n]=_.useState(!0),[i,a]=_.useState(""),l=_l();_.useEffect(()=>{const c=$(G,"simulation_server_metadata"),u=$e(c,d=>{const f=d.val();if(f){const h=Object.values(f);e(h.filter(m=>m.isPublic&&(m.status==="LOBBY"||m.status==="PLAYING")).sort((m,v)=>v.lastUpdated-m.lastUpdated))}else e([]);n(!1)});return()=>u()},[]);const o=t.filter(c=>{var u;return c.pin.includes(i)||((u=c.name)==null?void 0:u.toLowerCase().includes(i.toLowerCase()))||c.hostName.toLowerCase().includes(i.toLowerCase())});return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"relative group",children:[r.jsx("div",{className:"absolute inset-0 bg-indigo-500/20 blur-xl opacity-0 group-focus-within:opacity-100 transition-opacity rounded-2xl"}),r.jsx(zH,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-white/40 group-focus-within:text-indigo-400 transition-colors",size:18}),r.jsx("input",{type:"text",placeholder:"Sk etter en verden  erobre...",value:i,onChange:c=>a(c.target.value),className:"relative w-full bg-white/5 border border-white/10 focus:border-indigo-500/50 rounded-2xl py-4 pl-12 pr-4 text-sm text-white placeholder:text-white/20 outline-none transition-all shadow-inner"})]}),r.jsx(kt,{mode:"popLayout",children:s?r.jsx(q.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:r.jsx(TV,{})},"loading"):o.length===0?r.jsx(q.div,{initial:{opacity:0},animate:{opacity:1},className:"py-16 text-center border-2 border-white/5 border-dashed rounded-[2rem] bg-white/[0.02]",children:r.jsx("p",{className:"text-lg text-white/20 font-black italic uppercase tracking-widest",children:"Ingen riker funnet for sket."})},"empty"):r.jsx(q.div,{className:"grid grid-cols-1 md:grid-cols-2 gap-4",initial:"hidden",animate:"show",variants:{show:{transition:{staggerChildren:.05}}},children:o.map(c=>r.jsx(AV,{server:c,onClick:()=>l(`/play/${c.pin}`)},c.pin))},"list")})]})},CV=({isOpen:t,onClose:e,initialMode:s="REGISTER"})=>{const{login:n,register:i,resetPassword:a,checkNameAvailability:l,error:o}=Wf(),[c,u]=_.useState(s),[d,f]=_.useState(""),[h,m]=_.useState(""),[v,x]=_.useState(""),[b,g]=_.useState(!1),[p,y]=_.useState(null),[k,N]=_.useState(null),[S,w]=_.useState(null),[E,j]=_.useState(!1);if(_.useEffect(()=>{if(c!=="REGISTER"||v.length<3){w(null);return}const O=setTimeout(async()=>{j(!0);try{const L=await l(v);w(L)}catch(L){console.error(L)}finally{j(!1)}},500);return()=>clearTimeout(O)},[v,c,l]),!t)return null;const A=async O=>{O.preventDefault(),y(null),N(null),g(!0);try{if(c==="LOGIN")await n(d,h),e();else if(c==="REGISTER"){if(S===!1)throw new Error("Navnet er allerede tatt.");await i(d,h,v),e()}else c==="FORGOT"&&(await a(d),N("E-post for tilbakestilling er sendt!"))}catch(L){y(L.message||"Noe gikk galt. Vennligst prv igjen.")}finally{g(!1)}};return r.jsxs("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center p-4",children:[r.jsx("div",{className:"absolute inset-0 bg-slate-950/80 backdrop-blur-sm",onClick:e}),r.jsxs("div",{className:"relative w-full max-w-md bg-slate-900 border border-white/10 rounded-[2.5rem] shadow-2xl overflow-hidden animate-in fade-in zoom-in duration-300",children:[r.jsx("div",{className:"bg-indigo-600 h-2 w-full"}),r.jsxs("div",{className:"p-8 space-y-8",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-3xl font-black italic text-white tracking-tighter uppercase",children:c==="LOGIN"?"Velkommen tilbake":c==="REGISTER"?"Opprett Profil":"Glemt Passord"}),r.jsx("p",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mt-1",children:c==="LOGIN"?"Fortsett din reise i simulation":"Bli en del av historien"})]}),r.jsx("button",{onClick:e,className:"p-2 hover:bg-white/5 rounded-xl transition-colors",children:r.jsx(pn,{className:"text-slate-500",size:20})})]}),r.jsxs("form",{onSubmit:A,className:"space-y-4",children:[c==="REGISTER"&&r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"Vises som (Unikt navn)"}),r.jsxs("div",{className:"relative group",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:r.jsx(Ia,{size:18,className:"text-slate-600 group-focus-within:text-indigo-400 transition-colors"})}),r.jsx("input",{type:"text",required:!0,placeholder:"Ditt kallenavn...",className:"w-full bg-slate-950/50 border border-white/5 focus:border-indigo-500/50 rounded-2xl py-3.5 pl-11 pr-4 text-white outline-none transition-all",value:v,onChange:O=>x(O.target.value)}),r.jsx("div",{className:"absolute inset-y-0 right-0 pr-4 flex items-center",children:E?r.jsx(j_,{size:16,className:"text-slate-500 animate-spin"}):S===!0?r.jsx(bp,{size:16,className:"text-emerald-500"}):S===!1?r.jsx(mp,{size:16,className:"text-rose-500"}):null})]}),S===!1&&r.jsx("p",{className:"text-[10px] text-rose-400 font-bold px-1 italic",children:"Dette navnet er dessverre opptatt."})]}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"E-post"}),r.jsxs("div",{className:"relative group",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:r.jsx(jH,{size:18,className:"text-slate-600 group-focus-within:text-indigo-400 transition-colors"})}),r.jsx("input",{type:"email",required:!0,placeholder:"navn@epost.no",className:"w-full bg-slate-950/50 border border-white/5 focus:border-indigo-500/50 rounded-2xl py-3.5 pl-11 pr-4 text-white outline-none transition-all",value:d,onChange:O=>f(O.target.value)})]})]}),c!=="FORGOT"&&r.jsxs("div",{className:"space-y-1.5",children:[r.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"Passord"}),r.jsxs("div",{className:"relative group",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:r.jsx(Ml,{size:18,className:"text-slate-600 group-focus-within:text-indigo-400 transition-colors"})}),r.jsx("input",{type:"password",required:!0,placeholder:"Min. 8 tegn...",className:"w-full bg-slate-950/50 border border-white/5 focus:border-indigo-500/50 rounded-2xl py-3.5 pl-11 pr-4 text-white outline-none transition-all",value:h,onChange:O=>m(O.target.value)})]})]}),(p||o)&&r.jsxs("div",{className:"bg-rose-500/10 border border-rose-500/20 p-4 rounded-2xl flex items-center gap-3 text-rose-400",children:[r.jsx(mp,{size:18}),r.jsx("p",{className:"text-xs font-bold",children:p||o})]}),k&&r.jsxs("div",{className:"bg-emerald-500/10 border border-emerald-500/20 p-4 rounded-2xl flex items-center gap-3 text-emerald-400",children:[r.jsx(bp,{size:18}),r.jsx("p",{className:"text-xs font-bold",children:k})]}),r.jsxs("div",{className:"pt-4 space-y-4",children:[r.jsx("button",{type:"submit",disabled:b||c==="REGISTER"&&S===!1,className:"w-full bg-indigo-600 hover:bg-indigo-500 disabled:bg-slate-800 disabled:text-slate-500 text-white rounded-2xl py-4 font-black uppercase tracking-widest text-sm flex items-center justify-center gap-2 transition-all active:scale-95 shadow-lg shadow-indigo-600/20",children:b?r.jsx(j_,{className:"animate-spin",size:20}):r.jsxs(r.Fragment,{children:[c==="LOGIN"?"Logg Inn":c==="REGISTER"?"Opprett Profil":"Send E-post",r.jsx(Ca,{size:18})]})}),r.jsx("div",{className:"flex items-center justify-between px-2",children:c==="LOGIN"?r.jsxs(r.Fragment,{children:[r.jsx("button",{type:"button",onClick:()=>u("REGISTER"),className:"text-[10px] font-black text-indigo-400 uppercase tracking-widest hover:text-white transition-colors",children:"Ny her? Opprett profil"}),r.jsx("button",{type:"button",onClick:()=>u("FORGOT"),className:"text-[10px] font-medium text-slate-500 hover:text-white transition-colors",children:"Glemt passord?"})]}):r.jsx("button",{type:"button",onClick:()=>u("LOGIN"),className:"w-full text-center text-[10px] font-black text-indigo-400 uppercase tracking-widest hover:text-white transition-colors",children:"Har du allerede profil? Logg inn"})})]})]})]})]})]})},IV=()=>{const{user:t,isAnonymous:e,logout:s}=Wf(),[n,i]=_.useState(!1),[a,l]=_.useState("LOGIN"),o=_l(),{startPlaylist:c,resume:u}=vx(),[d,f]=_.useState(!1),[h,m]=_.useState(0);_.useEffect(()=>{const b=$(G,"simulation_server_metadata"),g=$e(b,p=>{if(p.exists()){const y=p.val(),k=Object.values(y).reduce((N,S)=>N+(S.playerCount||0),0);m(k)}});return()=>g()},[]),_.useEffect(()=>{c()},[c]);const v=()=>{d||(u(),c(),f(!0))},x=b=>{v(),l(b),i(!0)};return r.jsxs("div",{onClick:v,className:"min-h-screen relative font-sans text-slate-200 overflow-x-hidden",children:[r.jsxs("div",{className:"absolute inset-0 z-0",children:[r.jsx("img",{src:"/Simulation_StandAlone_Pro/makthjulet_landingpage_bakgrunn.png",alt:"Background",className:"w-full h-full object-cover"}),r.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-950 via-slate-950/60 to-transparent"}),r.jsx("div",{className:"absolute inset-0 bg-black/40"})]}),r.jsxs("div",{className:"relative z-10 flex flex-col min-h-screen",children:[r.jsxs("header",{className:"w-full px-8 py-8 flex justify-between items-center",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(Wc,{className:"text-white/90",size:24,strokeWidth:1.5}),r.jsx("span",{className:"text-sm font-black tracking-[0.2em] text-white/90 uppercase",children:"Simuleringshallen"})]}),r.jsx("div",{className:"flex items-center gap-6 text-xs font-bold tracking-widest uppercase",children:t&&!e?r.jsxs("div",{className:"flex items-center gap-6",children:[r.jsxs("span",{className:"text-white/70",children:["Velkommen, ",r.jsx("span",{className:"text-white",children:t.displayName})]}),r.jsx("button",{onClick:()=>s(),className:"hover:text-amber-400 transition-colors",children:"Logg ut"})]}):r.jsxs("div",{className:"flex items-center gap-6",children:[r.jsx("button",{onClick:()=>x("LOGIN"),className:"hover:text-white transition-colors text-white/70",children:"Logg Inn"}),r.jsx("button",{onClick:()=>x("REGISTER"),className:"px-5 py-2 bg-white/10 hover:bg-white/20 backdrop-blur-sm border border-white/20 rounded-full transition-all text-white",children:"Bli Med"})]})})]}),r.jsxs("main",{className:"flex-1 flex flex-col items-center justify-center w-full max-w-7xl mx-auto px-6 py-12",children:[r.jsxs("div",{className:"text-center mb-16 space-y-6 max-w-3xl",children:[r.jsx("h1",{className:"text-7xl md:text-9xl font-black text-white tracking-tighter leading-none drop-shadow-2xl",children:"MAKTHJULET"}),r.jsx("p",{className:"text-lg md:text-xl text-white/80 font-light tracking-wide max-w-xl mx-auto leading-relaxed",children:"Skjebnen er ikke skrevet. Den smis i ilden av ambisjoner."})]}),r.jsxs("div",{className:"w-full max-w-5xl bg-black/40 backdrop-blur-3xl border border-white/10 rounded-[2.5rem] p-4 md:p-10 shadow-2xl relative overflow-hidden",children:[r.jsx("div",{className:"absolute inset-0 opacity-[0.03] pointer-events-none bg-[url('https://grainy-gradients.vercel.app/noise.svg')] bg-repeat"}),r.jsxs("div",{className:"relative z-10",children:[r.jsxs("div",{className:"mb-8 flex items-center justify-between border-b border-white/5 pb-6",children:[r.jsxs("h3",{className:"text-[10px] font-black tracking-[0.3em] text-white/40 uppercase flex items-center gap-3",children:[r.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500 shadow-[0_0_10px_rgba(16,185,129,0.5)]"}),"Aktive Verdener"]}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("div",{className:"flex -space-x-1.5 items-center mr-1",children:[[...Array(Math.min(3,h))].map((b,g)=>r.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-slate-900 bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.3)]"},g)),h>3&&r.jsxs("div",{className:"w-5 h-5 rounded-full border-2 border-slate-900 bg-slate-800 flex items-center justify-center text-[8px] font-black text-white/60",children:["+",h-3]}),h===0&&r.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-slate-800 bg-slate-900/50"})]}),r.jsxs("span",{className:"text-[10px] text-white/40 uppercase font-black tracking-widest",children:[h," Live N"]})]})]}),r.jsx("div",{className:"max-h-[500px] overflow-y-auto custom-scrollbar pr-2",children:r.jsx(RV,{})})]})]})]}),r.jsxs("footer",{className:"w-full p-8 relative flex justify-center text-[10px] uppercase tracking-[0.2em] text-white/30",children:[r.jsx("span",{children:" 2026 Eiriksbok  Maktens Pris"}),r.jsx("button",{onClick:()=>o("/host"),className:"absolute right-8 bottom-8 text-white/10 hover:text-white/50 transition-colors duration-500 font-bold",children:"Admin"})]})]}),r.jsx(CV,{isOpen:n,onClose:()=>i(!1),initialMode:a})]})},OV=()=>r.jsx(AC,{basename:"/Simulation_StandAlone_Pro/",children:r.jsx(CC,{children:r.jsx(r6,{children:r.jsx(o6,{children:r.jsx("div",{className:"min-h-screen bg-slate-950 text-white",children:r.jsxs(SC,{children:[r.jsx(eo,{path:"/",element:r.jsx(IV,{})}),r.jsx(eo,{path:"/host",element:r.jsx(VG,{})}),r.jsx(eo,{path:"/play/:pin/*",element:r.jsx(c6,{children:r.jsx(jV,{})})}),r.jsx(eo,{path:"*",element:r.jsx(kC,{to:"/",replace:!0})})]})})})})})});class MV extends Ne.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,s){console.error("Uncaught error:",e,s)}render(){var e,s,n,i,a,l,o;if(this.state.hasError){const c=((e=this.state.error)==null?void 0:e.name)==="TypeError"&&(((n=(s=this.state.error)==null?void 0:s.message)==null?void 0:n.toLowerCase().includes("failed to fetch dynamically imported module"))||((a=(i=this.state.error)==null?void 0:i.message)==null?void 0:a.toLowerCase().includes("loading chunk"))||((o=(l=this.state.error)==null?void 0:l.message)==null?void 0:o.toLowerCase().includes("dynamic import")));return r.jsx("div",{style:{padding:"2rem",backgroundColor:"#0f172a",color:"#f8fafc",height:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",fontFamily:"Inter, system-ui, sans-serif",textAlign:"center"},children:r.jsxs("div",{style:{maxWidth:"600px",padding:"3rem",backgroundColor:"#1e293b",borderRadius:"2rem",border:"1px solid rgba(255,255,255,0.1)",boxShadow:"0 25px 50px -12px rgba(0,0,0,0.5)"},children:[r.jsx("div",{style:{fontSize:"4rem",marginBottom:"1rem"},children:""}),r.jsx("h1",{style:{fontSize:"2rem",fontWeight:"900",marginBottom:"1rem",color:"#ef4444"},children:c?"Applikasjonen m oppdateres":"Noe gikk galt"}),r.jsx("p",{style:{color:"#94a3b8",marginBottom:"2rem",fontSize:"1.1rem"},children:c?"En ny versjon av simulatoren er tilgjengelig. Trykk p knappen under for  laste inn p nytt.":"Det oppstod en uventet feil i simuleringshallen."}),r.jsx("button",{onClick:()=>window.location.reload(),style:{padding:"1rem 2rem",backgroundColor:"#4f46e5",color:"white",border:"none",borderRadius:"1rem",fontWeight:"bold",fontSize:"1rem",cursor:"pointer",transition:"all 0.2s",boxShadow:"0 10px 15px -3px rgba(79, 70, 229, 0.4)"},onMouseOver:u=>u.currentTarget.style.backgroundColor="#4338ca",onMouseOut:u=>u.currentTarget.style.backgroundColor="#4f46e5",children:"Oppdater applikasjonen"}),r.jsxs("details",{style:{marginTop:"2rem",textAlign:"left"},children:[r.jsx("summary",{style:{cursor:"pointer",color:"#64748b",fontSize:"0.8rem"},children:"Teknisk feilinfo"}),r.jsx("pre",{style:{marginTop:"1rem",padding:"1rem",backgroundColor:"#0f172a",borderRadius:"0.5rem",fontSize:"0.75rem",overflowX:"auto",color:"#ef4444",whiteSpace:"pre-wrap"},children:this.state.error&&this.state.error.toString()+`

`+this.state.error.stack})]})]})})}return this.props.children}}OR.createRoot(document.getElementById("root")).render(r.jsx(Ne.StrictMode,{children:r.jsx(MV,{children:r.jsx(OV,{})})}));export{yj as $,Rl as A,Ji as B,Hs as C,ol as D,gF as E,PV as F,te as G,xH as H,st as I,vx as J,y$ as K,Xd as L,fc as M,MH as N,xj as O,UV as P,sS as Q,Xi as R,tn as S,rf as T,Ia as U,cs as V,BV as W,HV as X,GV as Y,vp as Z,$V as _,Ie as a,Hi as a0,ab as a1,zH as a2,Wc as a3,QU as a4,sb as a5,kV as a6,Oe as a7,mj as a8,iT as a9,rj as aa,pn as ab,Ys as ac,Ca as ad,G0 as ae,uj as af,Ne as b,ne as c,h6 as d,m6 as e,_ as f,n$ as g,af as h,ib as i,r as j,kt as k,yF as l,q as m,FH as n,WH as o,lj as p,ee as q,$ as r,G as s,f6 as t,ll as u,Ml as v,hc as w,dl as x,Hn as y,u1 as z};
