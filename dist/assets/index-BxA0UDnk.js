const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SimulationMarket-Dow0X2Ju.js","assets/GameCard-DdgKS5aq.js","assets/Badge-CZME6l8m.js","assets/SimulationVault-BikxEDg3.js","assets/timer-DLSd0l-M.js","assets/SimulationSkills-CvBiMqQs.js","assets/SimulationProduction-Dl7EVZUn.js","assets/RecipeCard-C83Zumf9.js","assets/SimulationHierarchy-C10qKay1.js","assets/PoliticalHub-Cx_yfpw9.js","assets/SimulationProfile-DA-M97R8.js","assets/ApothecaryWindow-C9KxsgmH.js"])))=>i.map(i=>d[i]);
var PA=Object.defineProperty;var BA=(t,e,n)=>e in t?PA(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var et=(t,e,n)=>BA(t,typeof e!="symbol"?e+"":e,n);function UA(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const i in s)if(i!=="default"&&!(i in t)){const r=Object.getOwnPropertyDescriptor(s,i);r&&Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:()=>s[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();function u_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var d_={exports:{}},Vd={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HA=Symbol.for("react.transitional.element"),GA=Symbol.for("react.fragment");function f_(t,e,n){var s=null;if(n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),"key"in e){n={};for(var i in e)i!=="key"&&(n[i]=e[i])}else n=e;return e=n.ref,{$$typeof:HA,type:t,key:s,ref:e!==void 0?e:null,props:n}}Vd.Fragment=GA;Vd.jsx=f_;Vd.jsxs=f_;d_.exports=Vd;var o=d_.exports,h_={exports:{}},pe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xp=Symbol.for("react.transitional.element"),$A=Symbol.for("react.portal"),FA=Symbol.for("react.fragment"),zA=Symbol.for("react.strict_mode"),VA=Symbol.for("react.profiler"),KA=Symbol.for("react.consumer"),YA=Symbol.for("react.context"),WA=Symbol.for("react.forward_ref"),qA=Symbol.for("react.suspense"),XA=Symbol.for("react.memo"),m_=Symbol.for("react.lazy"),QA=Symbol.for("react.activity"),Lx=Symbol.iterator;function JA(t){return t===null||typeof t!="object"?null:(t=Lx&&t[Lx]||t["@@iterator"],typeof t=="function"?t:null)}var p_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g_=Object.assign,x_={};function so(t,e,n){this.props=t,this.context=e,this.refs=x_,this.updater=n||p_}so.prototype.isReactComponent={};so.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};so.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function b_(){}b_.prototype=so.prototype;function Qp(t,e,n){this.props=t,this.context=e,this.refs=x_,this.updater=n||p_}var Jp=Qp.prototype=new b_;Jp.constructor=Qp;g_(Jp,so.prototype);Jp.isPureReactComponent=!0;var Px=Array.isArray;function tm(){}var Xe={H:null,A:null,T:null,S:null},v_=Object.prototype.hasOwnProperty;function Zp(t,e,n){var s=n.ref;return{$$typeof:Xp,type:t,key:e,ref:s!==void 0?s:null,props:n}}function ZA(t,e){return Zp(t.type,e,t.props)}function e0(t){return typeof t=="object"&&t!==null&&t.$$typeof===Xp}function e2(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Bx=/\/+/g;function Gf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?e2(""+t.key):e.toString(36)}function t2(t){switch(t.status){case"fulfilled":return t.value;case"rejected":throw t.reason;default:switch(typeof t.status=="string"?t.then(tm,tm):(t.status="pending",t.then(function(e){t.status==="pending"&&(t.status="fulfilled",t.value=e)},function(e){t.status==="pending"&&(t.status="rejected",t.reason=e)})),t.status){case"fulfilled":return t.value;case"rejected":throw t.reason}}throw t}function Qr(t,e,n,s,i){var r=typeof t;(r==="undefined"||r==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(r){case"bigint":case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Xp:case $A:a=!0;break;case m_:return a=t._init,Qr(a(t._payload),e,n,s,i)}}if(a)return i=i(t),a=s===""?"."+Gf(t,0):s,Px(i)?(n="",a!=null&&(n=a.replace(Bx,"$&/")+"/"),Qr(i,e,n,"",function(u){return u})):i!=null&&(e0(i)&&(i=ZA(i,n+(i.key==null||t&&t.key===i.key?"":(""+i.key).replace(Bx,"$&/")+"/")+a)),e.push(i)),1;a=0;var l=s===""?".":s+":";if(Px(t))for(var c=0;c<t.length;c++)s=t[c],r=l+Gf(s,c),a+=Qr(s,e,n,r,i);else if(c=JA(t),typeof c=="function")for(t=c.call(t),c=0;!(s=t.next()).done;)s=s.value,r=l+Gf(s,c++),a+=Qr(s,e,n,r,i);else if(r==="object"){if(typeof t.then=="function")return Qr(t2(t),e,n,s,i);throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.")}return a}function Bc(t,e,n){if(t==null)return t;var s=[],i=0;return Qr(t,s,"","",function(r){return e.call(n,r,i++)}),s}function n2(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ux=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},s2={map:Bc,forEach:function(t,e,n){Bc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Bc(t,function(){e++}),e},toArray:function(t){return Bc(t,function(e){return e})||[]},only:function(t){if(!e0(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};pe.Activity=QA;pe.Children=s2;pe.Component=so;pe.Fragment=FA;pe.Profiler=VA;pe.PureComponent=Qp;pe.StrictMode=zA;pe.Suspense=qA;pe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Xe;pe.__COMPILER_RUNTIME={__proto__:null,c:function(t){return Xe.H.useMemoCache(t)}};pe.cache=function(t){return function(){return t.apply(null,arguments)}};pe.cacheSignal=function(){return null};pe.cloneElement=function(t,e,n){if(t==null)throw Error("The argument must be a React element, but you passed "+t+".");var s=g_({},t.props),i=t.key;if(e!=null)for(r in e.key!==void 0&&(i=""+e.key),e)!v_.call(e,r)||r==="key"||r==="__self"||r==="__source"||r==="ref"&&e.ref===void 0||(s[r]=e[r]);var r=arguments.length-2;if(r===1)s.children=n;else if(1<r){for(var a=Array(r),l=0;l<r;l++)a[l]=arguments[l+2];s.children=a}return Zp(t.type,i,s)};pe.createContext=function(t){return t={$$typeof:YA,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null},t.Provider=t,t.Consumer={$$typeof:KA,_context:t},t};pe.createElement=function(t,e,n){var s,i={},r=null;if(e!=null)for(s in e.key!==void 0&&(r=""+e.key),e)v_.call(e,s)&&s!=="key"&&s!=="__self"&&s!=="__source"&&(i[s]=e[s]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(s in a=t.defaultProps,a)i[s]===void 0&&(i[s]=a[s]);return Zp(t,r,i)};pe.createRef=function(){return{current:null}};pe.forwardRef=function(t){return{$$typeof:WA,render:t}};pe.isValidElement=e0;pe.lazy=function(t){return{$$typeof:m_,_payload:{_status:-1,_result:t},_init:n2}};pe.memo=function(t,e){return{$$typeof:XA,type:t,compare:e===void 0?null:e}};pe.startTransition=function(t){var e=Xe.T,n={};Xe.T=n;try{var s=t(),i=Xe.S;i!==null&&i(n,s),typeof s=="object"&&s!==null&&typeof s.then=="function"&&s.then(tm,Ux)}catch(r){Ux(r)}finally{e!==null&&n.types!==null&&(e.types=n.types),Xe.T=e}};pe.unstable_useCacheRefresh=function(){return Xe.H.useCacheRefresh()};pe.use=function(t){return Xe.H.use(t)};pe.useActionState=function(t,e,n){return Xe.H.useActionState(t,e,n)};pe.useCallback=function(t,e){return Xe.H.useCallback(t,e)};pe.useContext=function(t){return Xe.H.useContext(t)};pe.useDebugValue=function(){};pe.useDeferredValue=function(t,e){return Xe.H.useDeferredValue(t,e)};pe.useEffect=function(t,e){return Xe.H.useEffect(t,e)};pe.useEffectEvent=function(t){return Xe.H.useEffectEvent(t)};pe.useId=function(){return Xe.H.useId()};pe.useImperativeHandle=function(t,e,n){return Xe.H.useImperativeHandle(t,e,n)};pe.useInsertionEffect=function(t,e){return Xe.H.useInsertionEffect(t,e)};pe.useLayoutEffect=function(t,e){return Xe.H.useLayoutEffect(t,e)};pe.useMemo=function(t,e){return Xe.H.useMemo(t,e)};pe.useOptimistic=function(t,e){return Xe.H.useOptimistic(t,e)};pe.useReducer=function(t,e,n){return Xe.H.useReducer(t,e,n)};pe.useRef=function(t){return Xe.H.useRef(t)};pe.useState=function(t){return Xe.H.useState(t)};pe.useSyncExternalStore=function(t,e,n){return Xe.H.useSyncExternalStore(t,e,n)};pe.useTransition=function(){return Xe.H.useTransition()};pe.version="19.2.3";h_.exports=pe;var _=h_.exports;const Ge=u_(_),i2=UA({__proto__:null,default:Ge},[_]);var y_={exports:{}},Kd={},__={exports:{}},w_={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(D,M){var C=D.length;D.push(M);e:for(;0<C;){var U=C-1>>>1,K=D[U];if(0<i(K,M))D[U]=M,D[C]=K,C=U;else break e}}function n(D){return D.length===0?null:D[0]}function s(D){if(D.length===0)return null;var M=D[0],C=D.pop();if(C!==M){D[0]=C;e:for(var U=0,K=D.length,J=K>>>1;U<J;){var H=2*(U+1)-1,$=D[H],F=H+1,Q=D[F];if(0>i($,C))F<K&&0>i(Q,$)?(D[U]=Q,D[F]=C,U=F):(D[U]=$,D[H]=C,U=H);else if(F<K&&0>i(Q,C))D[U]=Q,D[F]=C,U=F;else break e}}return M}function i(D,M){var C=D.sortIndex-M.sortIndex;return C!==0?C:D.id-M.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;t.unstable_now=function(){return r.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],d=1,f=null,h=3,m=!1,v=!1,y=!1,b=!1,g=typeof setTimeout=="function"?setTimeout:null,p=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;function w(D){for(var M=n(u);M!==null;){if(M.callback===null)s(u);else if(M.startTime<=D)s(u),M.sortIndex=M.expirationTime,e(c,M);else break;M=n(u)}}function k(D){if(y=!1,w(D),!v)if(n(c)!==null)v=!0,S||(S=!0,I());else{var M=n(u);M!==null&&O(k,M.startTime-D)}}var S=!1,N=-1,T=5,E=-1;function j(){return b?!0:!(t.unstable_now()-E<T)}function R(){if(b=!1,S){var D=t.unstable_now();E=D;var M=!0;try{e:{v=!1,y&&(y=!1,p(N),N=-1),m=!0;var C=h;try{t:{for(w(D),f=n(c);f!==null&&!(f.expirationTime>D&&j());){var U=f.callback;if(typeof U=="function"){f.callback=null,h=f.priorityLevel;var K=U(f.expirationTime<=D);if(D=t.unstable_now(),typeof K=="function"){f.callback=K,w(D),M=!0;break t}f===n(c)&&s(c),w(D)}else s(c);f=n(c)}if(f!==null)M=!0;else{var J=n(u);J!==null&&O(k,J.startTime-D),M=!1}}break e}finally{f=null,h=C,m=!1}M=void 0}}finally{M?I():S=!1}}}var I;if(typeof x=="function")I=function(){x(R)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,B=V.port2;V.port1.onmessage=R,I=function(){B.postMessage(null)}}else I=function(){g(R,0)};function O(D,M){N=g(function(){D(t.unstable_now())},M)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(D){D.callback=null},t.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<D?Math.floor(1e3/D):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_next=function(D){switch(h){case 1:case 2:case 3:var M=3;break;default:M=h}var C=h;h=M;try{return D()}finally{h=C}},t.unstable_requestPaint=function(){b=!0},t.unstable_runWithPriority=function(D,M){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var C=h;h=D;try{return M()}finally{h=C}},t.unstable_scheduleCallback=function(D,M,C){var U=t.unstable_now();switch(typeof C=="object"&&C!==null?(C=C.delay,C=typeof C=="number"&&0<C?U+C:U):C=U,D){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=C+K,D={id:d++,callback:M,priorityLevel:D,startTime:C,expirationTime:K,sortIndex:-1},C>U?(D.sortIndex=C,e(u,D),n(c)===null&&D===n(u)&&(y?(p(N),N=-1):y=!0,O(k,C-U))):(D.sortIndex=K,e(c,D),v||m||(v=!0,S||(S=!0,I()))),D},t.unstable_shouldYield=j,t.unstable_wrapCallback=function(D){var M=h;return function(){var C=h;h=M;try{return D.apply(this,arguments)}finally{h=C}}}})(w_);__.exports=w_;var r2=__.exports,k_={exports:{}},qt={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a2=_;function N_(t){var e="https://react.dev/errors/"+t;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Qs(){}var zt={d:{f:Qs,r:function(){throw Error(N_(522))},D:Qs,C:Qs,L:Qs,m:Qs,X:Qs,S:Qs,M:Qs},p:0,findDOMNode:null},o2=Symbol.for("react.portal");function l2(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o2,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}var qo=a2.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function Yd(t,e){if(t==="font")return"";if(typeof e=="string")return e==="use-credentials"?e:""}qt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=zt;qt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)throw Error(N_(299));return l2(t,e,null,n)};qt.flushSync=function(t){var e=qo.T,n=zt.p;try{if(qo.T=null,zt.p=2,t)return t()}finally{qo.T=e,zt.p=n,zt.d.f()}};qt.preconnect=function(t,e){typeof t=="string"&&(e?(e=e.crossOrigin,e=typeof e=="string"?e==="use-credentials"?e:"":void 0):e=null,zt.d.C(t,e))};qt.prefetchDNS=function(t){typeof t=="string"&&zt.d.D(t)};qt.preinit=function(t,e){if(typeof t=="string"&&e&&typeof e.as=="string"){var n=e.as,s=Yd(n,e.crossOrigin),i=typeof e.integrity=="string"?e.integrity:void 0,r=typeof e.fetchPriority=="string"?e.fetchPriority:void 0;n==="style"?zt.d.S(t,typeof e.precedence=="string"?e.precedence:void 0,{crossOrigin:s,integrity:i,fetchPriority:r}):n==="script"&&zt.d.X(t,{crossOrigin:s,integrity:i,fetchPriority:r,nonce:typeof e.nonce=="string"?e.nonce:void 0})}};qt.preinitModule=function(t,e){if(typeof t=="string")if(typeof e=="object"&&e!==null){if(e.as==null||e.as==="script"){var n=Yd(e.as,e.crossOrigin);zt.d.M(t,{crossOrigin:n,integrity:typeof e.integrity=="string"?e.integrity:void 0,nonce:typeof e.nonce=="string"?e.nonce:void 0})}}else e==null&&zt.d.M(t)};qt.preload=function(t,e){if(typeof t=="string"&&typeof e=="object"&&e!==null&&typeof e.as=="string"){var n=e.as,s=Yd(n,e.crossOrigin);zt.d.L(t,n,{crossOrigin:s,integrity:typeof e.integrity=="string"?e.integrity:void 0,nonce:typeof e.nonce=="string"?e.nonce:void 0,type:typeof e.type=="string"?e.type:void 0,fetchPriority:typeof e.fetchPriority=="string"?e.fetchPriority:void 0,referrerPolicy:typeof e.referrerPolicy=="string"?e.referrerPolicy:void 0,imageSrcSet:typeof e.imageSrcSet=="string"?e.imageSrcSet:void 0,imageSizes:typeof e.imageSizes=="string"?e.imageSizes:void 0,media:typeof e.media=="string"?e.media:void 0})}};qt.preloadModule=function(t,e){if(typeof t=="string")if(e){var n=Yd(e.as,e.crossOrigin);zt.d.m(t,{as:typeof e.as=="string"&&e.as!=="script"?e.as:void 0,crossOrigin:n,integrity:typeof e.integrity=="string"?e.integrity:void 0})}else zt.d.m(t)};qt.requestFormReset=function(t){zt.d.r(t)};qt.unstable_batchedUpdates=function(t,e){return t(e)};qt.useFormState=function(t,e,n){return qo.H.useFormState(t,e,n)};qt.useFormStatus=function(){return qo.H.useHostTransitionStatus()};qt.version="19.2.3";function S_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(S_)}catch(t){console.error(t)}}S_(),k_.exports=qt;var c2=k_.exports;/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kt=r2,E_=_,u2=c2;function G(t){var e="https://react.dev/errors/"+t;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function T_(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ic(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function A_(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function j_(t){if(t.tag===31){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Hx(t){if(ic(t)!==t)throw Error(G(188))}function d2(t){var e=t.alternate;if(!e){if(e=ic(t),e===null)throw Error(G(188));return e!==t?null:t}for(var n=t,s=e;;){var i=n.return;if(i===null)break;var r=i.alternate;if(r===null){if(s=i.return,s!==null){n=s;continue}break}if(i.child===r.child){for(r=i.child;r;){if(r===n)return Hx(i),t;if(r===s)return Hx(i),e;r=r.sibling}throw Error(G(188))}if(n.return!==s.return)n=i,s=r;else{for(var a=!1,l=i.child;l;){if(l===n){a=!0,n=i,s=r;break}if(l===s){a=!0,s=i,n=r;break}l=l.sibling}if(!a){for(l=r.child;l;){if(l===n){a=!0,n=r,s=i;break}if(l===s){a=!0,s=r,n=i;break}l=l.sibling}if(!a)throw Error(G(189))}}if(n.alternate!==s)throw Error(G(190))}if(n.tag!==3)throw Error(G(188));return n.stateNode.current===n?t:e}function R_(t){var e=t.tag;if(e===5||e===26||e===27||e===6)return t;for(t=t.child;t!==null;){if(e=R_(t),e!==null)return e;t=t.sibling}return null}var Je=Object.assign,f2=Symbol.for("react.element"),Uc=Symbol.for("react.transitional.element"),Bo=Symbol.for("react.portal"),ea=Symbol.for("react.fragment"),I_=Symbol.for("react.strict_mode"),nm=Symbol.for("react.profiler"),C_=Symbol.for("react.consumer"),ks=Symbol.for("react.context"),t0=Symbol.for("react.forward_ref"),sm=Symbol.for("react.suspense"),im=Symbol.for("react.suspense_list"),n0=Symbol.for("react.memo"),ei=Symbol.for("react.lazy"),rm=Symbol.for("react.activity"),h2=Symbol.for("react.memo_cache_sentinel"),Gx=Symbol.iterator;function Eo(t){return t===null||typeof t!="object"?null:(t=Gx&&t[Gx]||t["@@iterator"],typeof t=="function"?t:null)}var m2=Symbol.for("react.client.reference");function am(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===m2?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ea:return"Fragment";case nm:return"Profiler";case I_:return"StrictMode";case sm:return"Suspense";case im:return"SuspenseList";case rm:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case Bo:return"Portal";case ks:return t.displayName||"Context";case C_:return(t._context.displayName||"Context")+".Consumer";case t0:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case n0:return e=t.displayName||null,e!==null?e:am(t.type)||"Memo";case ei:e=t._payload,t=t._init;try{return am(t(e))}catch{}}return null}var Uo=Array.isArray,le=E_.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ie=u2.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,hr={pending:!1,data:null,method:null,action:null},om=[],ta=-1;function ds(t){return{current:t}}function jt(t){0>ta||(t.current=om[ta],om[ta]=null,ta--)}function Ke(t,e){ta++,om[ta]=t.current,t.current=e}var is=ds(null),yl=ds(null),bi=ds(null),Ou=ds(null);function Mu(t,e){switch(Ke(bi,e),Ke(yl,t),Ke(is,null),e.nodeType){case 9:case 11:t=(t=e.documentElement)&&(t=t.namespaceURI)?Yb(t):0;break;default:if(t=e.tagName,e=e.namespaceURI)e=Yb(e),t=Jk(e,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}jt(is),Ke(is,t)}function Ma(){jt(is),jt(yl),jt(bi)}function lm(t){t.memoizedState!==null&&Ke(Ou,t);var e=is.current,n=Jk(e,t.type);e!==n&&(Ke(yl,t),Ke(is,n))}function Du(t){yl.current===t&&(jt(is),jt(yl)),Ou.current===t&&(jt(Ou),Il._currentValue=hr)}var $f,$x;function nr(t){if($f===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);$f=e&&e[1]||"",$x=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+$f+t+$x}var Ff=!1;function zf(t,e){if(!t||Ff)return"";Ff=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var s={DetermineComponentFrameRoot:function(){try{if(e){var f=function(){throw Error()};if(Object.defineProperty(f.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(f,[])}catch(m){var h=m}Reflect.construct(t,[],f)}else{try{f.call()}catch(m){h=m}t.call(f.prototype)}}else{try{throw Error()}catch(m){h=m}(f=t())&&typeof f.catch=="function"&&f.catch(function(){})}}catch(m){if(m&&h&&typeof m.stack=="string")return[m.stack,h.stack]}return[null,null]}};s.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var i=Object.getOwnPropertyDescriptor(s.DetermineComponentFrameRoot,"name");i&&i.configurable&&Object.defineProperty(s.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var r=s.DetermineComponentFrameRoot(),a=r[0],l=r[1];if(a&&l){var c=a.split(`
`),u=l.split(`
`);for(i=s=0;s<c.length&&!c[s].includes("DetermineComponentFrameRoot");)s++;for(;i<u.length&&!u[i].includes("DetermineComponentFrameRoot");)i++;if(s===c.length||i===u.length)for(s=c.length-1,i=u.length-1;1<=s&&0<=i&&c[s]!==u[i];)i--;for(;1<=s&&0<=i;s--,i--)if(c[s]!==u[i]){if(s!==1||i!==1)do if(s--,i--,0>i||c[s]!==u[i]){var d=`
`+c[s].replace(" at new "," at ");return t.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",t.displayName)),d}while(1<=s&&0<=i);break}}}finally{Ff=!1,Error.prepareStackTrace=n}return(n=t?t.displayName||t.name:"")?nr(n):""}function p2(t,e){switch(t.tag){case 26:case 27:case 5:return nr(t.type);case 16:return nr("Lazy");case 13:return t.child!==e&&e!==null?nr("Suspense Fallback"):nr("Suspense");case 19:return nr("SuspenseList");case 0:case 15:return zf(t.type,!1);case 11:return zf(t.type.render,!1);case 1:return zf(t.type,!0);case 31:return nr("Activity");default:return""}}function Fx(t){try{var e="",n=null;do e+=p2(t,n),n=t,t=t.return;while(t);return e}catch(s){return`
Error generating stack: `+s.message+`
`+s.stack}}var cm=Object.prototype.hasOwnProperty,s0=kt.unstable_scheduleCallback,Vf=kt.unstable_cancelCallback,g2=kt.unstable_shouldYield,x2=kt.unstable_requestPaint,hn=kt.unstable_now,b2=kt.unstable_getCurrentPriorityLevel,O_=kt.unstable_ImmediatePriority,M_=kt.unstable_UserBlockingPriority,Lu=kt.unstable_NormalPriority,v2=kt.unstable_LowPriority,D_=kt.unstable_IdlePriority,y2=kt.log,_2=kt.unstable_setDisableYieldValue,rc=null,mn=null;function ui(t){if(typeof y2=="function"&&_2(t),mn&&typeof mn.setStrictMode=="function")try{mn.setStrictMode(rc,t)}catch{}}var pn=Math.clz32?Math.clz32:N2,w2=Math.log,k2=Math.LN2;function N2(t){return t>>>=0,t===0?32:31-(w2(t)/k2|0)|0}var Hc=256,Gc=262144,$c=4194304;function sr(t){var e=t&42;if(e!==0)return e;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function Wd(t,e,n){var s=t.pendingLanes;if(s===0)return 0;var i=0,r=t.suspendedLanes,a=t.pingedLanes;t=t.warmLanes;var l=s&134217727;return l!==0?(s=l&~r,s!==0?i=sr(s):(a&=l,a!==0?i=sr(a):n||(n=l&~t,n!==0&&(i=sr(n))))):(l=s&~r,l!==0?i=sr(l):a!==0?i=sr(a):n||(n=s&~t,n!==0&&(i=sr(n)))),i===0?0:e!==0&&e!==i&&!(e&r)&&(r=i&-i,n=e&-e,r>=n||r===32&&(n&4194048)!==0)?e:i}function ac(t,e){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&e)===0}function S2(t,e){switch(t){case 1:case 2:case 4:case 8:case 64:return e+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function L_(){var t=$c;return $c<<=1,!($c&62914560)&&($c=4194304),t}function Kf(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function oc(t,e){t.pendingLanes|=e,e!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function E2(t,e,n,s,i,r){var a=t.pendingLanes;t.pendingLanes=n,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=n,t.entangledLanes&=n,t.errorRecoveryDisabledLanes&=n,t.shellSuspendCounter=0;var l=t.entanglements,c=t.expirationTimes,u=t.hiddenUpdates;for(n=a&~n;0<n;){var d=31-pn(n),f=1<<d;l[d]=0,c[d]=-1;var h=u[d];if(h!==null)for(u[d]=null,d=0;d<h.length;d++){var m=h[d];m!==null&&(m.lane&=-536870913)}n&=~f}s!==0&&P_(t,s,0),r!==0&&i===0&&t.tag!==0&&(t.suspendedLanes|=r&~(a&~e))}function P_(t,e,n){t.pendingLanes|=e,t.suspendedLanes&=~e;var s=31-pn(e);t.entangledLanes|=e,t.entanglements[s]=t.entanglements[s]|1073741824|n&261930}function B_(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-pn(n),i=1<<s;i&e|t[s]&e&&(t[s]|=e),n&=~i}}function U_(t,e){var n=e&-e;return n=n&42?1:i0(n),n&(t.suspendedLanes|e)?0:n}function i0(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function r0(t){return t&=-t,2<t?8<t?t&134217727?32:268435456:8:2}function H_(){var t=Ie.p;return t!==0?t:(t=window.event,t===void 0?32:cN(t.type))}function zx(t,e){var n=Ie.p;try{return Ie.p=t,e()}finally{Ie.p=n}}var Vi=Math.random().toString(36).slice(2),Mt="__reactFiber$"+Vi,rn="__reactProps$"+Vi,io="__reactContainer$"+Vi,um="__reactEvents$"+Vi,T2="__reactListeners$"+Vi,A2="__reactHandles$"+Vi,Vx="__reactResources$"+Vi,lc="__reactMarker$"+Vi;function a0(t){delete t[Mt],delete t[rn],delete t[um],delete t[T2],delete t[A2]}function na(t){var e=t[Mt];if(e)return e;for(var n=t.parentNode;n;){if(e=n[io]||n[Mt]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Jb(t);t!==null;){if(n=t[Mt])return n;t=Jb(t)}return e}t=n,n=t.parentNode}return null}function ro(t){if(t=t[Mt]||t[io]){var e=t.tag;if(e===5||e===6||e===13||e===31||e===26||e===27||e===3)return t}return null}function Ho(t){var e=t.tag;if(e===5||e===26||e===27||e===6)return t.stateNode;throw Error(G(33))}function ya(t){var e=t[Vx];return e||(e=t[Vx]={hoistableStyles:new Map,hoistableScripts:new Map}),e}function Tt(t){t[lc]=!0}var G_=new Set,$_={};function Lr(t,e){Da(t,e),Da(t+"Capture",e)}function Da(t,e){for($_[t]=e,t=0;t<e.length;t++)G_.add(e[t])}var j2=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Kx={},Yx={};function R2(t){return cm.call(Yx,t)?!0:cm.call(Kx,t)?!1:j2.test(t)?Yx[t]=!0:(Kx[t]=!0,!1)}function uu(t,e,n){if(R2(e))if(n===null)t.removeAttribute(e);else{switch(typeof n){case"undefined":case"function":case"symbol":t.removeAttribute(e);return;case"boolean":var s=e.toLowerCase().slice(0,5);if(s!=="data-"&&s!=="aria-"){t.removeAttribute(e);return}}t.setAttribute(e,""+n)}}function Fc(t,e,n){if(n===null)t.removeAttribute(e);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(e);return}t.setAttribute(e,""+n)}}function ps(t,e,n,s){if(s===null)t.removeAttribute(n);else{switch(typeof s){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(n);return}t.setAttributeNS(e,n,""+s)}}function Tn(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function F_(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function I2(t,e,n){var s=Object.getOwnPropertyDescriptor(t.constructor.prototype,e);if(!t.hasOwnProperty(e)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var i=s.get,r=s.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,r.call(this,a)}}),Object.defineProperty(t,e,{enumerable:s.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function dm(t){if(!t._valueTracker){var e=F_(t)?"checked":"value";t._valueTracker=I2(t,e,""+t[e])}}function z_(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=F_(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function Pu(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var C2=/[\n"\\]/g;function Rn(t){return t.replace(C2,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function fm(t,e,n,s,i,r,a,l){t.name="",a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"?t.type=a:t.removeAttribute("type"),e!=null?a==="number"?(e===0&&t.value===""||t.value!=e)&&(t.value=""+Tn(e)):t.value!==""+Tn(e)&&(t.value=""+Tn(e)):a!=="submit"&&a!=="reset"||t.removeAttribute("value"),e!=null?hm(t,a,Tn(e)):n!=null?hm(t,a,Tn(n)):s!=null&&t.removeAttribute("value"),i==null&&r!=null&&(t.defaultChecked=!!r),i!=null&&(t.checked=i&&typeof i!="function"&&typeof i!="symbol"),l!=null&&typeof l!="function"&&typeof l!="symbol"&&typeof l!="boolean"?t.name=""+Tn(l):t.removeAttribute("name")}function V_(t,e,n,s,i,r,a,l){if(r!=null&&typeof r!="function"&&typeof r!="symbol"&&typeof r!="boolean"&&(t.type=r),e!=null||n!=null){if(!(r!=="submit"&&r!=="reset"||e!=null)){dm(t);return}n=n!=null?""+Tn(n):"",e=e!=null?""+Tn(e):n,l||e===t.value||(t.value=e),t.defaultValue=e}s=s??i,s=typeof s!="function"&&typeof s!="symbol"&&!!s,t.checked=l?t.checked:!!s,t.defaultChecked=!!s,a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"&&(t.name=a),dm(t)}function hm(t,e,n){e==="number"&&Pu(t.ownerDocument)===t||t.defaultValue===""+n||(t.defaultValue=""+n)}function _a(t,e,n,s){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&s&&(t[n].defaultSelected=!0)}else{for(n=""+Tn(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,s&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function K_(t,e,n){if(e!=null&&(e=""+Tn(e),e!==t.value&&(t.value=e),n==null)){t.defaultValue!==e&&(t.defaultValue=e);return}t.defaultValue=n!=null?""+Tn(n):""}function Y_(t,e,n,s){if(e==null){if(s!=null){if(n!=null)throw Error(G(92));if(Uo(s)){if(1<s.length)throw Error(G(93));s=s[0]}n=s}n==null&&(n=""),e=n}n=Tn(e),t.defaultValue=n,s=t.textContent,s===n&&s!==""&&s!==null&&(t.value=s),dm(t)}function La(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var O2=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Wx(t,e,n){var s=e.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?s?t.setProperty(e,""):e==="float"?t.cssFloat="":t[e]="":s?t.setProperty(e,n):typeof n!="number"||n===0||O2.has(e)?e==="float"?t.cssFloat=n:t[e]=(""+n).trim():t[e]=n+"px"}function W_(t,e,n){if(e!=null&&typeof e!="object")throw Error(G(62));if(t=t.style,n!=null){for(var s in n)!n.hasOwnProperty(s)||e!=null&&e.hasOwnProperty(s)||(s.indexOf("--")===0?t.setProperty(s,""):s==="float"?t.cssFloat="":t[s]="");for(var i in e)s=e[i],e.hasOwnProperty(i)&&n[i]!==s&&Wx(t,i,s)}else for(var r in e)e.hasOwnProperty(r)&&Wx(t,r,e[r])}function o0(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var M2=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),D2=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function du(t){return D2.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function Ns(){}var mm=null;function l0(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var sa=null,wa=null;function qx(t){var e=ro(t);if(e&&(t=e.stateNode)){var n=t[rn]||null;e:switch(t=e.stateNode,e.type){case"input":if(fm(t,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+Rn(""+e)+'"][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var i=s[rn]||null;if(!i)throw Error(G(90));fm(s,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(e=0;e<n.length;e++)s=n[e],s.form===t.form&&z_(s)}break e;case"textarea":K_(t,n.value,n.defaultValue);break e;case"select":e=n.value,e!=null&&_a(t,!!n.multiple,e,!1)}}}var Yf=!1;function q_(t,e,n){if(Yf)return t(e,n);Yf=!0;try{var s=t(e);return s}finally{if(Yf=!1,(sa!==null||wa!==null)&&(of(),sa&&(e=sa,t=wa,wa=sa=null,qx(e),t)))for(e=0;e<t.length;e++)qx(t[e])}}function _l(t,e){var n=t.stateNode;if(n===null)return null;var s=n[rn]||null;if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(G(231,e,typeof n));return n}var Ps=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),pm=!1;if(Ps)try{var To={};Object.defineProperty(To,"passive",{get:function(){pm=!0}}),window.addEventListener("test",To,To),window.removeEventListener("test",To,To)}catch{pm=!1}var di=null,c0=null,fu=null;function X_(){if(fu)return fu;var t,e=c0,n=e.length,s,i="value"in di?di.value:di.textContent,r=i.length;for(t=0;t<n&&e[t]===i[t];t++);var a=n-t;for(s=1;s<=a&&e[n-s]===i[r-s];s++);return fu=i.slice(t,1<s?1-s:void 0)}function hu(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function zc(){return!0}function Xx(){return!1}function an(t){function e(n,s,i,r,a){this._reactName=n,this._targetInst=i,this.type=s,this.nativeEvent=r,this.target=a,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(r):r[l]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?zc:Xx,this.isPropagationStopped=Xx,this}return Je(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=zc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=zc)},persist:function(){},isPersistent:zc}),e}var Pr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qd=an(Pr),cc=Je({},Pr,{view:0,detail:0}),L2=an(cc),Wf,qf,Ao,Xd=Je({},cc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:u0,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ao&&(Ao&&t.type==="mousemove"?(Wf=t.screenX-Ao.screenX,qf=t.screenY-Ao.screenY):qf=Wf=0,Ao=t),Wf)},movementY:function(t){return"movementY"in t?t.movementY:qf}}),Qx=an(Xd),P2=Je({},Xd,{dataTransfer:0}),B2=an(P2),U2=Je({},cc,{relatedTarget:0}),Xf=an(U2),H2=Je({},Pr,{animationName:0,elapsedTime:0,pseudoElement:0}),G2=an(H2),$2=Je({},Pr,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),F2=an($2),z2=Je({},Pr,{data:0}),Jx=an(z2),V2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},K2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Y2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function W2(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Y2[t])?!!e[t]:!1}function u0(){return W2}var q2=Je({},cc,{key:function(t){if(t.key){var e=V2[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=hu(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?K2[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:u0,charCode:function(t){return t.type==="keypress"?hu(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?hu(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),X2=an(q2),Q2=Je({},Xd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zx=an(Q2),J2=Je({},cc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:u0}),Z2=an(J2),e5=Je({},Pr,{propertyName:0,elapsedTime:0,pseudoElement:0}),t5=an(e5),n5=Je({},Xd,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),s5=an(n5),i5=Je({},Pr,{newState:0,oldState:0}),r5=an(i5),a5=[9,13,27,32],d0=Ps&&"CompositionEvent"in window,Xo=null;Ps&&"documentMode"in document&&(Xo=document.documentMode);var o5=Ps&&"TextEvent"in window&&!Xo,Q_=Ps&&(!d0||Xo&&8<Xo&&11>=Xo),eb=" ",tb=!1;function J_(t,e){switch(t){case"keyup":return a5.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Z_(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ia=!1;function l5(t,e){switch(t){case"compositionend":return Z_(e);case"keypress":return e.which!==32?null:(tb=!0,eb);case"textInput":return t=e.data,t===eb&&tb?null:t;default:return null}}function c5(t,e){if(ia)return t==="compositionend"||!d0&&J_(t,e)?(t=X_(),fu=c0=di=null,ia=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Q_&&e.locale!=="ko"?null:e.data;default:return null}}var u5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function nb(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!u5[t.type]:e==="textarea"}function ew(t,e,n,s){sa?wa?wa.push(s):wa=[s]:sa=s,e=td(e,"onChange"),0<e.length&&(n=new qd("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var Qo=null,wl=null;function d5(t){qk(t,0)}function Qd(t){var e=Ho(t);if(z_(e))return t}function sb(t,e){if(t==="change")return e}var tw=!1;if(Ps){var Qf;if(Ps){var Jf="oninput"in document;if(!Jf){var ib=document.createElement("div");ib.setAttribute("oninput","return;"),Jf=typeof ib.oninput=="function"}Qf=Jf}else Qf=!1;tw=Qf&&(!document.documentMode||9<document.documentMode)}function rb(){Qo&&(Qo.detachEvent("onpropertychange",nw),wl=Qo=null)}function nw(t){if(t.propertyName==="value"&&Qd(wl)){var e=[];ew(e,wl,t,l0(t)),q_(d5,e)}}function f5(t,e,n){t==="focusin"?(rb(),Qo=e,wl=n,Qo.attachEvent("onpropertychange",nw)):t==="focusout"&&rb()}function h5(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Qd(wl)}function m5(t,e){if(t==="click")return Qd(e)}function p5(t,e){if(t==="input"||t==="change")return Qd(e)}function g5(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var bn=typeof Object.is=="function"?Object.is:g5;function kl(t,e){if(bn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var i=n[s];if(!cm.call(e,i)||!bn(t[i],e[i]))return!1}return!0}function ab(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ob(t,e){var n=ab(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=ab(n)}}function sw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?sw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function iw(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var e=Pu(t.document);e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Pu(t.document)}return e}function f0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}var x5=Ps&&"documentMode"in document&&11>=document.documentMode,ra=null,gm=null,Jo=null,xm=!1;function lb(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;xm||ra==null||ra!==Pu(s)||(s=ra,"selectionStart"in s&&f0(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Jo&&kl(Jo,s)||(Jo=s,s=td(gm,"onSelect"),0<s.length&&(e=new qd("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=ra)))}function Ji(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var aa={animationend:Ji("Animation","AnimationEnd"),animationiteration:Ji("Animation","AnimationIteration"),animationstart:Ji("Animation","AnimationStart"),transitionrun:Ji("Transition","TransitionRun"),transitionstart:Ji("Transition","TransitionStart"),transitioncancel:Ji("Transition","TransitionCancel"),transitionend:Ji("Transition","TransitionEnd")},Zf={},rw={};Ps&&(rw=document.createElement("div").style,"AnimationEvent"in window||(delete aa.animationend.animation,delete aa.animationiteration.animation,delete aa.animationstart.animation),"TransitionEvent"in window||delete aa.transitionend.transition);function Br(t){if(Zf[t])return Zf[t];if(!aa[t])return t;var e=aa[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in rw)return Zf[t]=e[n];return t}var aw=Br("animationend"),ow=Br("animationiteration"),lw=Br("animationstart"),b5=Br("transitionrun"),v5=Br("transitionstart"),y5=Br("transitioncancel"),cw=Br("transitionend"),uw=new Map,bm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");bm.push("scrollEnd");function Zn(t,e){uw.set(t,e),Lr(e,[t])}var Bu=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},En=[],oa=0,h0=0;function Jd(){for(var t=oa,e=h0=oa=0;e<t;){var n=En[e];En[e++]=null;var s=En[e];En[e++]=null;var i=En[e];En[e++]=null;var r=En[e];if(En[e++]=null,s!==null&&i!==null){var a=s.pending;a===null?i.next=i:(i.next=a.next,a.next=i),s.pending=i}r!==0&&dw(n,i,r)}}function Zd(t,e,n,s){En[oa++]=t,En[oa++]=e,En[oa++]=n,En[oa++]=s,h0|=s,t.lanes|=s,t=t.alternate,t!==null&&(t.lanes|=s)}function m0(t,e,n,s){return Zd(t,e,n,s),Uu(t)}function Ur(t,e){return Zd(t,null,null,e),Uu(t)}function dw(t,e,n){t.lanes|=n;var s=t.alternate;s!==null&&(s.lanes|=n);for(var i=!1,r=t.return;r!==null;)r.childLanes|=n,s=r.alternate,s!==null&&(s.childLanes|=n),r.tag===22&&(t=r.stateNode,t===null||t._visibility&1||(i=!0)),t=r,r=r.return;return t.tag===3?(r=t.stateNode,i&&e!==null&&(i=31-pn(n),t=r.hiddenUpdates,s=t[i],s===null?t[i]=[e]:s.push(e),e.lane=n|536870912),r):null}function Uu(t){if(50<ol)throw ol=0,Um=null,Error(G(185));for(var e=t.return;e!==null;)t=e,e=t.return;return t.tag===3?t.stateNode:null}var la={};function _5(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function un(t,e,n,s){return new _5(t,e,n,s)}function p0(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Rs(t,e){var n=t.alternate;return n===null?(n=un(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&65011712,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n.refCleanup=t.refCleanup,n}function fw(t,e){t.flags&=65011714;var n=t.alternate;return n===null?(t.childLanes=0,t.lanes=e,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,t.type=n.type,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),t}function mu(t,e,n,s,i,r){var a=0;if(s=t,typeof t=="function")p0(t)&&(a=1);else if(typeof t=="string")a=Ej(t,n,is.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case rm:return t=un(31,n,e,i),t.elementType=rm,t.lanes=r,t;case ea:return mr(n.children,i,r,e);case I_:a=8,i|=24;break;case nm:return t=un(12,n,e,i|2),t.elementType=nm,t.lanes=r,t;case sm:return t=un(13,n,e,i),t.elementType=sm,t.lanes=r,t;case im:return t=un(19,n,e,i),t.elementType=im,t.lanes=r,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case ks:a=10;break e;case C_:a=9;break e;case t0:a=11;break e;case n0:a=14;break e;case ei:a=16,s=null;break e}a=29,n=Error(G(130,t===null?"null":typeof t,"")),s=null}return e=un(a,n,e,i),e.elementType=t,e.type=s,e.lanes=r,e}function mr(t,e,n,s){return t=un(7,t,s,e),t.lanes=n,t}function eh(t,e,n){return t=un(6,t,null,e),t.lanes=n,t}function hw(t){var e=un(18,null,null,0);return e.stateNode=t,e}function th(t,e,n){return e=un(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}var cb=new WeakMap;function In(t,e){if(typeof t=="object"&&t!==null){var n=cb.get(t);return n!==void 0?n:(e={value:t,source:e,stack:Fx(e)},cb.set(t,e),e)}return{value:t,source:e,stack:Fx(e)}}var ca=[],ua=0,Hu=null,Nl=0,An=[],jn=0,Oi=null,ts=1,ns="";function _s(t,e){ca[ua++]=Nl,ca[ua++]=Hu,Hu=t,Nl=e}function mw(t,e,n){An[jn++]=ts,An[jn++]=ns,An[jn++]=Oi,Oi=t;var s=ts;t=ns;var i=32-pn(s)-1;s&=~(1<<i),n+=1;var r=32-pn(e)+i;if(30<r){var a=i-i%5;r=(s&(1<<a)-1).toString(32),s>>=a,i-=a,ts=1<<32-pn(e)+i|n<<i|s,ns=r+t}else ts=1<<r|n<<i|s,ns=t}function g0(t){t.return!==null&&(_s(t,1),mw(t,1,0))}function x0(t){for(;t===Hu;)Hu=ca[--ua],ca[ua]=null,Nl=ca[--ua],ca[ua]=null;for(;t===Oi;)Oi=An[--jn],An[jn]=null,ns=An[--jn],An[jn]=null,ts=An[--jn],An[jn]=null}function pw(t,e){An[jn++]=ts,An[jn++]=ns,An[jn++]=Oi,ts=e.id,ns=e.overflow,Oi=t}var Dt=null,qe=null,Ee=!1,vi=null,Cn=!1,vm=Error(G(519));function Mi(t){var e=Error(G(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Sl(In(e,t)),vm}function ub(t){var e=t.stateNode,n=t.type,s=t.memoizedProps;switch(e[Mt]=t,e[rn]=s,n){case"dialog":ke("cancel",e),ke("close",e);break;case"iframe":case"object":case"embed":ke("load",e);break;case"video":case"audio":for(n=0;n<jl.length;n++)ke(jl[n],e);break;case"source":ke("error",e);break;case"img":case"image":case"link":ke("error",e),ke("load",e);break;case"details":ke("toggle",e);break;case"input":ke("invalid",e),V_(e,s.value,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name,!0);break;case"select":ke("invalid",e);break;case"textarea":ke("invalid",e),Y_(e,s.value,s.defaultValue,s.children)}n=s.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||e.textContent===""+n||s.suppressHydrationWarning===!0||Qk(e.textContent,n)?(s.popover!=null&&(ke("beforetoggle",e),ke("toggle",e)),s.onScroll!=null&&ke("scroll",e),s.onScrollEnd!=null&&ke("scrollend",e),s.onClick!=null&&(e.onclick=Ns),e=!0):e=!1,e||Mi(t,!0)}function db(t){for(Dt=t.return;Dt;)switch(Dt.tag){case 5:case 31:case 13:Cn=!1;return;case 27:case 3:Cn=!0;return;default:Dt=Dt.return}}function Kr(t){if(t!==Dt)return!1;if(!Ee)return db(t),Ee=!0,!1;var e=t.tag,n;if((n=e!==3&&e!==27)&&((n=e===5)&&(n=t.type,n=!(n!=="form"&&n!=="button")||zm(t.type,t.memoizedProps)),n=!n),n&&qe&&Mi(t),db(t),e===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(G(317));qe=Qb(t)}else if(e===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(G(317));qe=Qb(t)}else e===27?(e=qe,Ki(t.type)?(t=Wm,Wm=null,qe=t):qe=e):qe=Dt?Dn(t.stateNode.nextSibling):null;return!0}function kr(){qe=Dt=null,Ee=!1}function nh(){var t=vi;return t!==null&&(en===null?en=t:en.push.apply(en,t),vi=null),t}function Sl(t){vi===null?vi=[t]:vi.push(t)}var ym=ds(null),Hr=null,Ss=null;function ni(t,e,n){Ke(ym,e._currentValue),e._currentValue=n}function Is(t){t._currentValue=ym.current,jt(ym)}function _m(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function wm(t,e,n,s){var i=t.child;for(i!==null&&(i.return=t);i!==null;){var r=i.dependencies;if(r!==null){var a=i.child;r=r.firstContext;e:for(;r!==null;){var l=r;r=i;for(var c=0;c<e.length;c++)if(l.context===e[c]){r.lanes|=n,l=r.alternate,l!==null&&(l.lanes|=n),_m(r.return,n,t),s||(a=null);break e}r=l.next}}else if(i.tag===18){if(a=i.return,a===null)throw Error(G(341));a.lanes|=n,r=a.alternate,r!==null&&(r.lanes|=n),_m(a,n,t),a=null}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===t){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}}function ao(t,e,n,s){t=null;for(var i=e,r=!1;i!==null;){if(!r){if(i.flags&524288)r=!0;else if(i.flags&262144)break}if(i.tag===10){var a=i.alternate;if(a===null)throw Error(G(387));if(a=a.memoizedProps,a!==null){var l=i.type;bn(i.pendingProps.value,a.value)||(t!==null?t.push(l):t=[l])}}else if(i===Ou.current){if(a=i.alternate,a===null)throw Error(G(387));a.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(t!==null?t.push(Il):t=[Il])}i=i.return}t!==null&&wm(e,t,n,s),e.flags|=262144}function Gu(t){for(t=t.firstContext;t!==null;){if(!bn(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function Nr(t){Hr=t,Ss=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function Pt(t){return gw(Hr,t)}function Vc(t,e){return Hr===null&&Nr(t),gw(t,e)}function gw(t,e){var n=e._currentValue;if(e={context:e,memoizedValue:n,next:null},Ss===null){if(t===null)throw Error(G(308));Ss=e,t.dependencies={lanes:0,firstContext:e},t.flags|=524288}else Ss=Ss.next=e;return n}var w5=typeof AbortController<"u"?AbortController:function(){var t=[],e=this.signal={aborted:!1,addEventListener:function(n,s){t.push(s)}};this.abort=function(){e.aborted=!0,t.forEach(function(n){return n()})}},k5=kt.unstable_scheduleCallback,N5=kt.unstable_NormalPriority,gt={$$typeof:ks,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function b0(){return{controller:new w5,data:new Map,refCount:0}}function uc(t){t.refCount--,t.refCount===0&&k5(N5,function(){t.controller.abort()})}var Zo=null,km=0,Pa=0,ka=null;function S5(t,e){if(Zo===null){var n=Zo=[];km=0,Pa=F0(),ka={status:"pending",value:void 0,then:function(s){n.push(s)}}}return km++,e.then(fb,fb),e}function fb(){if(--km===0&&Zo!==null){ka!==null&&(ka.status="fulfilled");var t=Zo;Zo=null,Pa=0,ka=null;for(var e=0;e<t.length;e++)(0,t[e])()}}function E5(t,e){var n=[],s={status:"pending",value:null,reason:null,then:function(i){n.push(i)}};return t.then(function(){s.status="fulfilled",s.value=e;for(var i=0;i<n.length;i++)(0,n[i])(e)},function(i){for(s.status="rejected",s.reason=i,i=0;i<n.length;i++)(0,n[i])(void 0)}),s}var hb=le.S;le.S=function(t,e){Rk=hn(),typeof e=="object"&&e!==null&&typeof e.then=="function"&&S5(t,e),hb!==null&&hb(t,e)};var pr=ds(null);function v0(){var t=pr.current;return t!==null?t:$e.pooledCache}function pu(t,e){e===null?Ke(pr,pr.current):Ke(pr,e.pool)}function xw(){var t=v0();return t===null?null:{parent:gt._currentValue,pool:t}}var oo=Error(G(460)),y0=Error(G(474)),ef=Error(G(542)),$u={then:function(){}};function mb(t){return t=t.status,t==="fulfilled"||t==="rejected"}function bw(t,e,n){switch(n=t[n],n===void 0?t.push(e):n!==e&&(e.then(Ns,Ns),e=n),e.status){case"fulfilled":return e.value;case"rejected":throw t=e.reason,gb(t),t;default:if(typeof e.status=="string")e.then(Ns,Ns);else{if(t=$e,t!==null&&100<t.shellSuspendCounter)throw Error(G(482));t=e,t.status="pending",t.then(function(s){if(e.status==="pending"){var i=e;i.status="fulfilled",i.value=s}},function(s){if(e.status==="pending"){var i=e;i.status="rejected",i.reason=s}})}switch(e.status){case"fulfilled":return e.value;case"rejected":throw t=e.reason,gb(t),t}throw gr=e,oo}}function ir(t){try{var e=t._init;return e(t._payload)}catch(n){throw n!==null&&typeof n=="object"&&typeof n.then=="function"?(gr=n,oo):n}}var gr=null;function pb(){if(gr===null)throw Error(G(459));var t=gr;return gr=null,t}function gb(t){if(t===oo||t===ef)throw Error(G(483))}var Na=null,El=0;function Kc(t){var e=El;return El+=1,Na===null&&(Na=[]),bw(Na,t,e)}function jo(t,e){e=e.props.ref,t.ref=e!==void 0?e:null}function Yc(t,e){throw e.$$typeof===f2?Error(G(525)):(t=Object.prototype.toString.call(e),Error(G(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)))}function vw(t){function e(g,p){if(t){var x=g.deletions;x===null?(g.deletions=[p],g.flags|=16):x.push(p)}}function n(g,p){if(!t)return null;for(;p!==null;)e(g,p),p=p.sibling;return null}function s(g){for(var p=new Map;g!==null;)g.key!==null?p.set(g.key,g):p.set(g.index,g),g=g.sibling;return p}function i(g,p){return g=Rs(g,p),g.index=0,g.sibling=null,g}function r(g,p,x){return g.index=x,t?(x=g.alternate,x!==null?(x=x.index,x<p?(g.flags|=67108866,p):x):(g.flags|=67108866,p)):(g.flags|=1048576,p)}function a(g){return t&&g.alternate===null&&(g.flags|=67108866),g}function l(g,p,x,w){return p===null||p.tag!==6?(p=eh(x,g.mode,w),p.return=g,p):(p=i(p,x),p.return=g,p)}function c(g,p,x,w){var k=x.type;return k===ea?d(g,p,x.props.children,w,x.key):p!==null&&(p.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===ei&&ir(k)===p.type)?(p=i(p,x.props),jo(p,x),p.return=g,p):(p=mu(x.type,x.key,x.props,null,g.mode,w),jo(p,x),p.return=g,p)}function u(g,p,x,w){return p===null||p.tag!==4||p.stateNode.containerInfo!==x.containerInfo||p.stateNode.implementation!==x.implementation?(p=th(x,g.mode,w),p.return=g,p):(p=i(p,x.children||[]),p.return=g,p)}function d(g,p,x,w,k){return p===null||p.tag!==7?(p=mr(x,g.mode,w,k),p.return=g,p):(p=i(p,x),p.return=g,p)}function f(g,p,x){if(typeof p=="string"&&p!==""||typeof p=="number"||typeof p=="bigint")return p=eh(""+p,g.mode,x),p.return=g,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case Uc:return x=mu(p.type,p.key,p.props,null,g.mode,x),jo(x,p),x.return=g,x;case Bo:return p=th(p,g.mode,x),p.return=g,p;case ei:return p=ir(p),f(g,p,x)}if(Uo(p)||Eo(p))return p=mr(p,g.mode,x,null),p.return=g,p;if(typeof p.then=="function")return f(g,Kc(p),x);if(p.$$typeof===ks)return f(g,Vc(g,p),x);Yc(g,p)}return null}function h(g,p,x,w){var k=p!==null?p.key:null;if(typeof x=="string"&&x!==""||typeof x=="number"||typeof x=="bigint")return k!==null?null:l(g,p,""+x,w);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Uc:return x.key===k?c(g,p,x,w):null;case Bo:return x.key===k?u(g,p,x,w):null;case ei:return x=ir(x),h(g,p,x,w)}if(Uo(x)||Eo(x))return k!==null?null:d(g,p,x,w,null);if(typeof x.then=="function")return h(g,p,Kc(x),w);if(x.$$typeof===ks)return h(g,p,Vc(g,x),w);Yc(g,x)}return null}function m(g,p,x,w,k){if(typeof w=="string"&&w!==""||typeof w=="number"||typeof w=="bigint")return g=g.get(x)||null,l(p,g,""+w,k);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Uc:return g=g.get(w.key===null?x:w.key)||null,c(p,g,w,k);case Bo:return g=g.get(w.key===null?x:w.key)||null,u(p,g,w,k);case ei:return w=ir(w),m(g,p,x,w,k)}if(Uo(w)||Eo(w))return g=g.get(x)||null,d(p,g,w,k,null);if(typeof w.then=="function")return m(g,p,x,Kc(w),k);if(w.$$typeof===ks)return m(g,p,x,Vc(p,w),k);Yc(p,w)}return null}function v(g,p,x,w){for(var k=null,S=null,N=p,T=p=0,E=null;N!==null&&T<x.length;T++){N.index>T?(E=N,N=null):E=N.sibling;var j=h(g,N,x[T],w);if(j===null){N===null&&(N=E);break}t&&N&&j.alternate===null&&e(g,N),p=r(j,p,T),S===null?k=j:S.sibling=j,S=j,N=E}if(T===x.length)return n(g,N),Ee&&_s(g,T),k;if(N===null){for(;T<x.length;T++)N=f(g,x[T],w),N!==null&&(p=r(N,p,T),S===null?k=N:S.sibling=N,S=N);return Ee&&_s(g,T),k}for(N=s(N);T<x.length;T++)E=m(N,g,T,x[T],w),E!==null&&(t&&E.alternate!==null&&N.delete(E.key===null?T:E.key),p=r(E,p,T),S===null?k=E:S.sibling=E,S=E);return t&&N.forEach(function(R){return e(g,R)}),Ee&&_s(g,T),k}function y(g,p,x,w){if(x==null)throw Error(G(151));for(var k=null,S=null,N=p,T=p=0,E=null,j=x.next();N!==null&&!j.done;T++,j=x.next()){N.index>T?(E=N,N=null):E=N.sibling;var R=h(g,N,j.value,w);if(R===null){N===null&&(N=E);break}t&&N&&R.alternate===null&&e(g,N),p=r(R,p,T),S===null?k=R:S.sibling=R,S=R,N=E}if(j.done)return n(g,N),Ee&&_s(g,T),k;if(N===null){for(;!j.done;T++,j=x.next())j=f(g,j.value,w),j!==null&&(p=r(j,p,T),S===null?k=j:S.sibling=j,S=j);return Ee&&_s(g,T),k}for(N=s(N);!j.done;T++,j=x.next())j=m(N,g,T,j.value,w),j!==null&&(t&&j.alternate!==null&&N.delete(j.key===null?T:j.key),p=r(j,p,T),S===null?k=j:S.sibling=j,S=j);return t&&N.forEach(function(I){return e(g,I)}),Ee&&_s(g,T),k}function b(g,p,x,w){if(typeof x=="object"&&x!==null&&x.type===ea&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Uc:e:{for(var k=x.key;p!==null;){if(p.key===k){if(k=x.type,k===ea){if(p.tag===7){n(g,p.sibling),w=i(p,x.props.children),w.return=g,g=w;break e}}else if(p.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===ei&&ir(k)===p.type){n(g,p.sibling),w=i(p,x.props),jo(w,x),w.return=g,g=w;break e}n(g,p);break}else e(g,p);p=p.sibling}x.type===ea?(w=mr(x.props.children,g.mode,w,x.key),w.return=g,g=w):(w=mu(x.type,x.key,x.props,null,g.mode,w),jo(w,x),w.return=g,g=w)}return a(g);case Bo:e:{for(k=x.key;p!==null;){if(p.key===k)if(p.tag===4&&p.stateNode.containerInfo===x.containerInfo&&p.stateNode.implementation===x.implementation){n(g,p.sibling),w=i(p,x.children||[]),w.return=g,g=w;break e}else{n(g,p);break}else e(g,p);p=p.sibling}w=th(x,g.mode,w),w.return=g,g=w}return a(g);case ei:return x=ir(x),b(g,p,x,w)}if(Uo(x))return v(g,p,x,w);if(Eo(x)){if(k=Eo(x),typeof k!="function")throw Error(G(150));return x=k.call(x),y(g,p,x,w)}if(typeof x.then=="function")return b(g,p,Kc(x),w);if(x.$$typeof===ks)return b(g,p,Vc(g,x),w);Yc(g,x)}return typeof x=="string"&&x!==""||typeof x=="number"||typeof x=="bigint"?(x=""+x,p!==null&&p.tag===6?(n(g,p.sibling),w=i(p,x),w.return=g,g=w):(n(g,p),w=eh(x,g.mode,w),w.return=g,g=w),a(g)):n(g,p)}return function(g,p,x,w){try{El=0;var k=b(g,p,x,w);return Na=null,k}catch(N){if(N===oo||N===ef)throw N;var S=un(29,N,null,g.mode);return S.lanes=w,S.return=g,S}finally{}}}var Sr=vw(!0),yw=vw(!1),ti=!1;function _0(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Nm(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function yi(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function _i(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,Re&2){var i=s.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),s.pending=e,e=Uu(t),dw(t,null,n),e}return Zd(t,s,e,n),Uu(t)}function el(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194048)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,B_(t,n)}}function sh(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var i=null,r=null;if(n=n.firstBaseUpdate,n!==null){do{var a={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};r===null?i=r=a:r=r.next=a,n=n.next}while(n!==null);r===null?i=r=e:r=r.next=e}else i=r=e;n={baseState:s.baseState,firstBaseUpdate:i,lastBaseUpdate:r,shared:s.shared,callbacks:s.callbacks},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}var Sm=!1;function tl(){if(Sm){var t=ka;if(t!==null)throw t}}function nl(t,e,n,s){Sm=!1;var i=t.updateQueue;ti=!1;var r=i.firstBaseUpdate,a=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,u=c.next;c.next=null,a===null?r=u:a.next=u,a=c;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==a&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(r!==null){var f=i.baseState;a=0,d=u=c=null,l=r;do{var h=l.lane&-536870913,m=h!==l.lane;if(m?(Se&h)===h:(s&h)===h){h!==0&&h===Pa&&(Sm=!0),d!==null&&(d=d.next={lane:0,tag:l.tag,payload:l.payload,callback:null,next:null});e:{var v=t,y=l;h=e;var b=n;switch(y.tag){case 1:if(v=y.payload,typeof v=="function"){f=v.call(b,f,h);break e}f=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=y.payload,h=typeof v=="function"?v.call(b,f,h):v,h==null)break e;f=Je({},f,h);break e;case 2:ti=!0}}h=l.callback,h!==null&&(t.flags|=64,m&&(t.flags|=8192),m=i.callbacks,m===null?i.callbacks=[h]:m.push(h))}else m={lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=m,c=f):d=d.next=m,a|=h;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;m=l,l=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);d===null&&(c=f),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=d,r===null&&(i.shared.lanes=0),Li|=a,t.lanes=a,t.memoizedState=f}}function _w(t,e){if(typeof t!="function")throw Error(G(191,t));t.call(e)}function ww(t,e){var n=t.callbacks;if(n!==null)for(t.callbacks=null,t=0;t<n.length;t++)_w(n[t],e)}var Ba=ds(null),Fu=ds(0);function xb(t,e){t=Gs,Ke(Fu,t),Ke(Ba,e),Gs=t|e.baseLanes}function Em(){Ke(Fu,Gs),Ke(Ba,Ba.current)}function w0(){Gs=Fu.current,jt(Ba),jt(Fu)}var vn=ds(null),Mn=null;function si(t){var e=t.alternate;Ke(ft,ft.current&1),Ke(vn,t),Mn===null&&(e===null||Ba.current!==null||e.memoizedState!==null)&&(Mn=t)}function Tm(t){Ke(ft,ft.current),Ke(vn,t),Mn===null&&(Mn=t)}function kw(t){t.tag===22?(Ke(ft,ft.current),Ke(vn,t),Mn===null&&(Mn=t)):ii()}function ii(){Ke(ft,ft.current),Ke(vn,vn.current)}function cn(t){jt(vn),Mn===t&&(Mn=null),jt(ft)}var ft=ds(0);function zu(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||Km(n)||Ym(n)))return e}else if(e.tag===19&&(e.memoizedProps.revealOrder==="forwards"||e.memoizedProps.revealOrder==="backwards"||e.memoizedProps.revealOrder==="unstable_legacy-backwards"||e.memoizedProps.revealOrder==="together")){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Bs=0,ge=null,Ue=null,mt=null,Vu=!1,Sa=!1,Er=!1,Ku=0,Tl=0,Ea=null,T5=0;function at(){throw Error(G(321))}function k0(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!bn(t[n],e[n]))return!1;return!0}function N0(t,e,n,s,i,r){return Bs=r,ge=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,le.H=t===null||t.memoizedState===null?ek:D0,Er=!1,r=n(s,i),Er=!1,Sa&&(r=Sw(e,n,s,i)),Nw(t),r}function Nw(t){le.H=Al;var e=Ue!==null&&Ue.next!==null;if(Bs=0,mt=Ue=ge=null,Vu=!1,Tl=0,Ea=null,e)throw Error(G(300));t===null||xt||(t=t.dependencies,t!==null&&Gu(t)&&(xt=!0))}function Sw(t,e,n,s){ge=t;var i=0;do{if(Sa&&(Ea=null),Tl=0,Sa=!1,25<=i)throw Error(G(301));if(i+=1,mt=Ue=null,t.updateQueue!=null){var r=t.updateQueue;r.lastEffect=null,r.events=null,r.stores=null,r.memoCache!=null&&(r.memoCache.index=0)}le.H=tk,r=e(n,s)}while(Sa);return r}function A5(){var t=le.H,e=t.useState()[0];return e=typeof e.then=="function"?dc(e):e,t=t.useState()[0],(Ue!==null?Ue.memoizedState:null)!==t&&(ge.flags|=1024),e}function S0(){var t=Ku!==0;return Ku=0,t}function E0(t,e,n){e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~n}function T0(t){if(Vu){for(t=t.memoizedState;t!==null;){var e=t.queue;e!==null&&(e.pending=null),t=t.next}Vu=!1}Bs=0,mt=Ue=ge=null,Sa=!1,Tl=Ku=0,Ea=null}function Ft(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mt===null?ge.memoizedState=mt=t:mt=mt.next=t,mt}function ht(){if(Ue===null){var t=ge.alternate;t=t!==null?t.memoizedState:null}else t=Ue.next;var e=mt===null?ge.memoizedState:mt.next;if(e!==null)mt=e,Ue=t;else{if(t===null)throw ge.alternate===null?Error(G(467)):Error(G(310));Ue=t,t={memoizedState:Ue.memoizedState,baseState:Ue.baseState,baseQueue:Ue.baseQueue,queue:Ue.queue,next:null},mt===null?ge.memoizedState=mt=t:mt=mt.next=t}return mt}function tf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function dc(t){var e=Tl;return Tl+=1,Ea===null&&(Ea=[]),t=bw(Ea,t,e),e=ge,(mt===null?e.memoizedState:mt.next)===null&&(e=e.alternate,le.H=e===null||e.memoizedState===null?ek:D0),t}function nf(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return dc(t);if(t.$$typeof===ks)return Pt(t)}throw Error(G(438,String(t)))}function A0(t){var e=null,n=ge.updateQueue;if(n!==null&&(e=n.memoCache),e==null){var s=ge.alternate;s!==null&&(s=s.updateQueue,s!==null&&(s=s.memoCache,s!=null&&(e={data:s.data.map(function(i){return i.slice()}),index:0})))}if(e==null&&(e={data:[],index:0}),n===null&&(n=tf(),ge.updateQueue=n),n.memoCache=e,n=e.data[e.index],n===void 0)for(n=e.data[e.index]=Array(t),s=0;s<t;s++)n[s]=h2;return e.index++,n}function Us(t,e){return typeof e=="function"?e(t):e}function gu(t){var e=ht();return j0(e,Ue,t)}function j0(t,e,n){var s=t.queue;if(s===null)throw Error(G(311));s.lastRenderedReducer=n;var i=t.baseQueue,r=s.pending;if(r!==null){if(i!==null){var a=i.next;i.next=r.next,r.next=a}e.baseQueue=i=r,s.pending=null}if(r=t.baseState,i===null)t.memoizedState=r;else{e=i.next;var l=a=null,c=null,u=e,d=!1;do{var f=u.lane&-536870913;if(f!==u.lane?(Se&f)===f:(Bs&f)===f){var h=u.revertLane;if(h===0)c!==null&&(c=c.next={lane:0,revertLane:0,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),f===Pa&&(d=!0);else if((Bs&h)===h){u=u.next,h===Pa&&(d=!0);continue}else f={lane:0,revertLane:u.revertLane,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},c===null?(l=c=f,a=r):c=c.next=f,ge.lanes|=h,Li|=h;f=u.action,Er&&n(r,f),r=u.hasEagerState?u.eagerState:n(r,f)}else h={lane:f,revertLane:u.revertLane,gesture:u.gesture,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},c===null?(l=c=h,a=r):c=c.next=h,ge.lanes|=f,Li|=f;u=u.next}while(u!==null&&u!==e);if(c===null?a=r:c.next=l,!bn(r,t.memoizedState)&&(xt=!0,d&&(n=ka,n!==null)))throw n;t.memoizedState=r,t.baseState=a,t.baseQueue=c,s.lastRenderedState=r}return i===null&&(s.lanes=0),[t.memoizedState,s.dispatch]}function ih(t){var e=ht(),n=e.queue;if(n===null)throw Error(G(311));n.lastRenderedReducer=t;var s=n.dispatch,i=n.pending,r=e.memoizedState;if(i!==null){n.pending=null;var a=i=i.next;do r=t(r,a.action),a=a.next;while(a!==i);bn(r,e.memoizedState)||(xt=!0),e.memoizedState=r,e.baseQueue===null&&(e.baseState=r),n.lastRenderedState=r}return[r,s]}function Ew(t,e,n){var s=ge,i=ht(),r=Ee;if(r){if(n===void 0)throw Error(G(407));n=n()}else n=e();var a=!bn((Ue||i).memoizedState,n);if(a&&(i.memoizedState=n,xt=!0),i=i.queue,R0(jw.bind(null,s,i,t),[t]),i.getSnapshot!==e||a||mt!==null&&mt.memoizedState.tag&1){if(s.flags|=2048,Ua(9,{destroy:void 0},Aw.bind(null,s,i,n,e),null),$e===null)throw Error(G(349));r||Bs&127||Tw(s,e,n)}return n}function Tw(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ge.updateQueue,e===null?(e=tf(),ge.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Aw(t,e,n,s){e.value=n,e.getSnapshot=s,Rw(e)&&Iw(t)}function jw(t,e,n){return n(function(){Rw(e)&&Iw(t)})}function Rw(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!bn(t,n)}catch{return!0}}function Iw(t){var e=Ur(t,2);e!==null&&sn(e,t,2)}function Am(t){var e=Ft();if(typeof t=="function"){var n=t;if(t=n(),Er){ui(!0);try{n()}finally{ui(!1)}}}return e.memoizedState=e.baseState=t,e.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Us,lastRenderedState:t},e}function Cw(t,e,n,s){return t.baseState=n,j0(t,Ue,typeof s=="function"?s:Us)}function j5(t,e,n,s,i){if(rf(t))throw Error(G(485));if(t=e.action,t!==null){var r={payload:i,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(a){r.listeners.push(a)}};le.T!==null?n(!0):r.isTransition=!1,s(r),n=e.pending,n===null?(r.next=e.pending=r,Ow(e,r)):(r.next=n.next,e.pending=n.next=r)}}function Ow(t,e){var n=e.action,s=e.payload,i=t.state;if(e.isTransition){var r=le.T,a={};le.T=a;try{var l=n(i,s),c=le.S;c!==null&&c(a,l),bb(t,e,l)}catch(u){jm(t,e,u)}finally{r!==null&&a.types!==null&&(r.types=a.types),le.T=r}}else try{r=n(i,s),bb(t,e,r)}catch(u){jm(t,e,u)}}function bb(t,e,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(s){vb(t,e,s)},function(s){return jm(t,e,s)}):vb(t,e,n)}function vb(t,e,n){e.status="fulfilled",e.value=n,Mw(e),t.state=n,e=t.pending,e!==null&&(n=e.next,n===e?t.pending=null:(n=n.next,e.next=n,Ow(t,n)))}function jm(t,e,n){var s=t.pending;if(t.pending=null,s!==null){s=s.next;do e.status="rejected",e.reason=n,Mw(e),e=e.next;while(e!==s)}t.action=null}function Mw(t){t=t.listeners;for(var e=0;e<t.length;e++)(0,t[e])()}function Dw(t,e){return e}function yb(t,e){if(Ee){var n=$e.formState;if(n!==null){e:{var s=ge;if(Ee){if(qe){t:{for(var i=qe,r=Cn;i.nodeType!==8;){if(!r){i=null;break t}if(i=Dn(i.nextSibling),i===null){i=null;break t}}r=i.data,i=r==="F!"||r==="F"?i:null}if(i){qe=Dn(i.nextSibling),s=i.data==="F!";break e}}Mi(s)}s=!1}s&&(e=n[0])}}return n=Ft(),n.memoizedState=n.baseState=e,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Dw,lastRenderedState:e},n.queue=s,n=Qw.bind(null,ge,s),s.dispatch=n,s=Am(!1),r=M0.bind(null,ge,!1,s.queue),s=Ft(),i={state:e,dispatch:null,action:t,pending:null},s.queue=i,n=j5.bind(null,ge,i,r,n),i.dispatch=n,s.memoizedState=t,[e,n,!1]}function _b(t){var e=ht();return Lw(e,Ue,t)}function Lw(t,e,n){if(e=j0(t,e,Dw)[0],t=gu(Us)[0],typeof e=="object"&&e!==null&&typeof e.then=="function")try{var s=dc(e)}catch(a){throw a===oo?ef:a}else s=e;e=ht();var i=e.queue,r=i.dispatch;return n!==e.memoizedState&&(ge.flags|=2048,Ua(9,{destroy:void 0},R5.bind(null,i,n),null)),[s,r,t]}function R5(t,e){t.action=e}function wb(t){var e=ht(),n=Ue;if(n!==null)return Lw(e,n,t);ht(),e=e.memoizedState,n=ht();var s=n.queue.dispatch;return n.memoizedState=t,[e,s,!1]}function Ua(t,e,n,s){return t={tag:t,create:n,deps:s,inst:e,next:null},e=ge.updateQueue,e===null&&(e=tf(),ge.updateQueue=e),n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t),t}function Pw(){return ht().memoizedState}function xu(t,e,n,s){var i=Ft();ge.flags|=t,i.memoizedState=Ua(1|e,{destroy:void 0},n,s===void 0?null:s)}function sf(t,e,n,s){var i=ht();s=s===void 0?null:s;var r=i.memoizedState.inst;Ue!==null&&s!==null&&k0(s,Ue.memoizedState.deps)?i.memoizedState=Ua(e,r,n,s):(ge.flags|=t,i.memoizedState=Ua(1|e,r,n,s))}function kb(t,e){xu(8390656,8,t,e)}function R0(t,e){sf(2048,8,t,e)}function I5(t){ge.flags|=4;var e=ge.updateQueue;if(e===null)e=tf(),ge.updateQueue=e,e.events=[t];else{var n=e.events;n===null?e.events=[t]:n.push(t)}}function Bw(t){var e=ht().memoizedState;return I5({ref:e,nextImpl:t}),function(){if(Re&2)throw Error(G(440));return e.impl.apply(void 0,arguments)}}function Uw(t,e){return sf(4,2,t,e)}function Hw(t,e){return sf(4,4,t,e)}function Gw(t,e){if(typeof e=="function"){t=t();var n=e(t);return function(){typeof n=="function"?n():e(null)}}if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function $w(t,e,n){n=n!=null?n.concat([t]):null,sf(4,4,Gw.bind(null,e,t),n)}function I0(){}function Fw(t,e){var n=ht();e=e===void 0?null:e;var s=n.memoizedState;return e!==null&&k0(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function zw(t,e){var n=ht();e=e===void 0?null:e;var s=n.memoizedState;if(e!==null&&k0(e,s[1]))return s[0];if(s=t(),Er){ui(!0);try{t()}finally{ui(!1)}}return n.memoizedState=[s,e],s}function C0(t,e,n){return n===void 0||Bs&1073741824&&!(Se&261930)?t.memoizedState=e:(t.memoizedState=n,t=Ck(),ge.lanes|=t,Li|=t,n)}function Vw(t,e,n,s){return bn(n,e)?n:Ba.current!==null?(t=C0(t,n,s),bn(t,e)||(xt=!0),t):!(Bs&42)||Bs&1073741824&&!(Se&261930)?(xt=!0,t.memoizedState=n):(t=Ck(),ge.lanes|=t,Li|=t,e)}function Kw(t,e,n,s,i){var r=Ie.p;Ie.p=r!==0&&8>r?r:8;var a=le.T,l={};le.T=l,M0(t,!1,e,n);try{var c=i(),u=le.S;if(u!==null&&u(l,c),c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=E5(c,s);sl(t,e,d,gn(t))}else sl(t,e,s,gn(t))}catch(f){sl(t,e,{then:function(){},status:"rejected",reason:f},gn())}finally{Ie.p=r,a!==null&&l.types!==null&&(a.types=l.types),le.T=a}}function C5(){}function Rm(t,e,n,s){if(t.tag!==5)throw Error(G(476));var i=Yw(t).queue;Kw(t,i,e,hr,n===null?C5:function(){return Ww(t),n(s)})}function Yw(t){var e=t.memoizedState;if(e!==null)return e;e={memoizedState:hr,baseState:hr,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Us,lastRenderedState:hr},next:null};var n={};return e.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Us,lastRenderedState:n},next:null},t.memoizedState=e,t=t.alternate,t!==null&&(t.memoizedState=e),e}function Ww(t){var e=Yw(t);e.next===null&&(e=t.alternate.memoizedState),sl(t,e.next.queue,{},gn())}function O0(){return Pt(Il)}function qw(){return ht().memoizedState}function Xw(){return ht().memoizedState}function O5(t){for(var e=t.return;e!==null;){switch(e.tag){case 24:case 3:var n=gn();t=yi(n);var s=_i(e,t,n);s!==null&&(sn(s,e,n),el(s,e,n)),e={cache:b0()},t.payload=e;return}e=e.return}}function M5(t,e,n){var s=gn();n={lane:s,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},rf(t)?Jw(e,n):(n=m0(t,e,n,s),n!==null&&(sn(n,t,s),Zw(n,e,s)))}function Qw(t,e,n){var s=gn();sl(t,e,n,s)}function sl(t,e,n,s){var i={lane:s,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(rf(t))Jw(e,i);else{var r=t.alternate;if(t.lanes===0&&(r===null||r.lanes===0)&&(r=e.lastRenderedReducer,r!==null))try{var a=e.lastRenderedState,l=r(a,n);if(i.hasEagerState=!0,i.eagerState=l,bn(l,a))return Zd(t,e,i,0),$e===null&&Jd(),!1}catch{}finally{}if(n=m0(t,e,i,s),n!==null)return sn(n,t,s),Zw(n,e,s),!0}return!1}function M0(t,e,n,s){if(s={lane:2,revertLane:F0(),gesture:null,action:s,hasEagerState:!1,eagerState:null,next:null},rf(t)){if(e)throw Error(G(479))}else e=m0(t,n,s,2),e!==null&&sn(e,t,2)}function rf(t){var e=t.alternate;return t===ge||e!==null&&e===ge}function Jw(t,e){Sa=Vu=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Zw(t,e,n){if(n&4194048){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,B_(t,n)}}var Al={readContext:Pt,use:nf,useCallback:at,useContext:at,useEffect:at,useImperativeHandle:at,useLayoutEffect:at,useInsertionEffect:at,useMemo:at,useReducer:at,useRef:at,useState:at,useDebugValue:at,useDeferredValue:at,useTransition:at,useSyncExternalStore:at,useId:at,useHostTransitionStatus:at,useFormState:at,useActionState:at,useOptimistic:at,useMemoCache:at,useCacheRefresh:at};Al.useEffectEvent=at;var ek={readContext:Pt,use:nf,useCallback:function(t,e){return Ft().memoizedState=[t,e===void 0?null:e],t},useContext:Pt,useEffect:kb,useImperativeHandle:function(t,e,n){n=n!=null?n.concat([t]):null,xu(4194308,4,Gw.bind(null,e,t),n)},useLayoutEffect:function(t,e){return xu(4194308,4,t,e)},useInsertionEffect:function(t,e){xu(4,2,t,e)},useMemo:function(t,e){var n=Ft();e=e===void 0?null:e;var s=t();if(Er){ui(!0);try{t()}finally{ui(!1)}}return n.memoizedState=[s,e],s},useReducer:function(t,e,n){var s=Ft();if(n!==void 0){var i=n(e);if(Er){ui(!0);try{n(e)}finally{ui(!1)}}}else i=e;return s.memoizedState=s.baseState=i,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:i},s.queue=t,t=t.dispatch=M5.bind(null,ge,t),[s.memoizedState,t]},useRef:function(t){var e=Ft();return t={current:t},e.memoizedState=t},useState:function(t){t=Am(t);var e=t.queue,n=Qw.bind(null,ge,e);return e.dispatch=n,[t.memoizedState,n]},useDebugValue:I0,useDeferredValue:function(t,e){var n=Ft();return C0(n,t,e)},useTransition:function(){var t=Am(!1);return t=Kw.bind(null,ge,t.queue,!0,!1),Ft().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,e,n){var s=ge,i=Ft();if(Ee){if(n===void 0)throw Error(G(407));n=n()}else{if(n=e(),$e===null)throw Error(G(349));Se&127||Tw(s,e,n)}i.memoizedState=n;var r={value:n,getSnapshot:e};return i.queue=r,kb(jw.bind(null,s,r,t),[t]),s.flags|=2048,Ua(9,{destroy:void 0},Aw.bind(null,s,r,n,e),null),n},useId:function(){var t=Ft(),e=$e.identifierPrefix;if(Ee){var n=ns,s=ts;n=(s&~(1<<32-pn(s)-1)).toString(32)+n,e="_"+e+"R_"+n,n=Ku++,0<n&&(e+="H"+n.toString(32)),e+="_"}else n=T5++,e="_"+e+"r_"+n.toString(32)+"_";return t.memoizedState=e},useHostTransitionStatus:O0,useFormState:yb,useActionState:yb,useOptimistic:function(t){var e=Ft();e.memoizedState=e.baseState=t;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return e.queue=n,e=M0.bind(null,ge,!0,n),n.dispatch=e,[t,e]},useMemoCache:A0,useCacheRefresh:function(){return Ft().memoizedState=O5.bind(null,ge)},useEffectEvent:function(t){var e=Ft(),n={impl:t};return e.memoizedState=n,function(){if(Re&2)throw Error(G(440));return n.impl.apply(void 0,arguments)}}},D0={readContext:Pt,use:nf,useCallback:Fw,useContext:Pt,useEffect:R0,useImperativeHandle:$w,useInsertionEffect:Uw,useLayoutEffect:Hw,useMemo:zw,useReducer:gu,useRef:Pw,useState:function(){return gu(Us)},useDebugValue:I0,useDeferredValue:function(t,e){var n=ht();return Vw(n,Ue.memoizedState,t,e)},useTransition:function(){var t=gu(Us)[0],e=ht().memoizedState;return[typeof t=="boolean"?t:dc(t),e]},useSyncExternalStore:Ew,useId:qw,useHostTransitionStatus:O0,useFormState:_b,useActionState:_b,useOptimistic:function(t,e){var n=ht();return Cw(n,Ue,t,e)},useMemoCache:A0,useCacheRefresh:Xw};D0.useEffectEvent=Bw;var tk={readContext:Pt,use:nf,useCallback:Fw,useContext:Pt,useEffect:R0,useImperativeHandle:$w,useInsertionEffect:Uw,useLayoutEffect:Hw,useMemo:zw,useReducer:ih,useRef:Pw,useState:function(){return ih(Us)},useDebugValue:I0,useDeferredValue:function(t,e){var n=ht();return Ue===null?C0(n,t,e):Vw(n,Ue.memoizedState,t,e)},useTransition:function(){var t=ih(Us)[0],e=ht().memoizedState;return[typeof t=="boolean"?t:dc(t),e]},useSyncExternalStore:Ew,useId:qw,useHostTransitionStatus:O0,useFormState:wb,useActionState:wb,useOptimistic:function(t,e){var n=ht();return Ue!==null?Cw(n,Ue,t,e):(n.baseState=t,[t,n.queue.dispatch])},useMemoCache:A0,useCacheRefresh:Xw};tk.useEffectEvent=Bw;function rh(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:Je({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Im={enqueueSetState:function(t,e,n){t=t._reactInternals;var s=gn(),i=yi(s);i.payload=e,n!=null&&(i.callback=n),e=_i(t,i,s),e!==null&&(sn(e,t,s),el(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=gn(),i=yi(s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=_i(t,i,s),e!==null&&(sn(e,t,s),el(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=gn(),s=yi(n);s.tag=2,e!=null&&(s.callback=e),e=_i(t,s,n),e!==null&&(sn(e,t,n),el(e,t,n))}};function Nb(t,e,n,s,i,r,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,r,a):e.prototype&&e.prototype.isPureReactComponent?!kl(n,s)||!kl(i,r):!0}function Sb(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&Im.enqueueReplaceState(e,e.state,null)}function Tr(t,e){var n=e;if("ref"in e){n={};for(var s in e)s!=="ref"&&(n[s]=e[s])}if(t=t.defaultProps){n===e&&(n=Je({},n));for(var i in t)n[i]===void 0&&(n[i]=t[i])}return n}function nk(t){Bu(t)}function sk(t){console.error(t)}function ik(t){Bu(t)}function Yu(t,e){try{var n=t.onUncaughtError;n(e.value,{componentStack:e.stack})}catch(s){setTimeout(function(){throw s})}}function Eb(t,e,n){try{var s=t.onCaughtError;s(n.value,{componentStack:n.stack,errorBoundary:e.tag===1?e.stateNode:null})}catch(i){setTimeout(function(){throw i})}}function Cm(t,e,n){return n=yi(n),n.tag=3,n.payload={element:null},n.callback=function(){Yu(t,e)},n}function rk(t){return t=yi(t),t.tag=3,t}function ak(t,e,n,s){var i=n.type.getDerivedStateFromError;if(typeof i=="function"){var r=s.value;t.payload=function(){return i(r)},t.callback=function(){Eb(e,n,s)}}var a=n.stateNode;a!==null&&typeof a.componentDidCatch=="function"&&(t.callback=function(){Eb(e,n,s),typeof i!="function"&&(wi===null?wi=new Set([this]):wi.add(this));var l=s.stack;this.componentDidCatch(s.value,{componentStack:l!==null?l:""})})}function D5(t,e,n,s,i){if(n.flags|=32768,s!==null&&typeof s=="object"&&typeof s.then=="function"){if(e=n.alternate,e!==null&&ao(e,n,i,!0),n=vn.current,n!==null){switch(n.tag){case 31:case 13:return Mn===null?Ju():n.alternate===null&&ct===0&&(ct=3),n.flags&=-257,n.flags|=65536,n.lanes=i,s===$u?n.flags|=16384:(e=n.updateQueue,e===null?n.updateQueue=new Set([s]):e.add(s),gh(t,s,i)),!1;case 22:return n.flags|=65536,s===$u?n.flags|=16384:(e=n.updateQueue,e===null?(e={transitions:null,markerInstances:null,retryQueue:new Set([s])},n.updateQueue=e):(n=e.retryQueue,n===null?e.retryQueue=new Set([s]):n.add(s)),gh(t,s,i)),!1}throw Error(G(435,n.tag))}return gh(t,s,i),Ju(),!1}if(Ee)return e=vn.current,e!==null?(!(e.flags&65536)&&(e.flags|=256),e.flags|=65536,e.lanes=i,s!==vm&&(t=Error(G(422),{cause:s}),Sl(In(t,n)))):(s!==vm&&(e=Error(G(423),{cause:s}),Sl(In(e,n))),t=t.current.alternate,t.flags|=65536,i&=-i,t.lanes|=i,s=In(s,n),i=Cm(t.stateNode,s,i),sh(t,i),ct!==4&&(ct=2)),!1;var r=Error(G(520),{cause:s});if(r=In(r,n),al===null?al=[r]:al.push(r),ct!==4&&(ct=2),e===null)return!0;s=In(s,n),n=e;do{switch(n.tag){case 3:return n.flags|=65536,t=i&-i,n.lanes|=t,t=Cm(n.stateNode,s,t),sh(n,t),!1;case 1:if(e=n.type,r=n.stateNode,(n.flags&128)===0&&(typeof e.getDerivedStateFromError=="function"||r!==null&&typeof r.componentDidCatch=="function"&&(wi===null||!wi.has(r))))return n.flags|=65536,i&=-i,n.lanes|=i,i=rk(i),ak(i,t,n,s),sh(n,i),!1}n=n.return}while(n!==null);return!1}var L0=Error(G(461)),xt=!1;function Ot(t,e,n,s){e.child=t===null?yw(e,null,n,s):Sr(e,t.child,n,s)}function Tb(t,e,n,s,i){n=n.render;var r=e.ref;if("ref"in s){var a={};for(var l in s)l!=="ref"&&(a[l]=s[l])}else a=s;return Nr(e),s=N0(t,e,n,a,r,i),l=S0(),t!==null&&!xt?(E0(t,e,i),Hs(t,e,i)):(Ee&&l&&g0(e),e.flags|=1,Ot(t,e,s,i),e.child)}function Ab(t,e,n,s,i){if(t===null){var r=n.type;return typeof r=="function"&&!p0(r)&&r.defaultProps===void 0&&n.compare===null?(e.tag=15,e.type=r,ok(t,e,r,s,i)):(t=mu(n.type,null,s,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(r=t.child,!P0(t,i)){var a=r.memoizedProps;if(n=n.compare,n=n!==null?n:kl,n(a,s)&&t.ref===e.ref)return Hs(t,e,i)}return e.flags|=1,t=Rs(r,s),t.ref=e.ref,t.return=e,e.child=t}function ok(t,e,n,s,i){if(t!==null){var r=t.memoizedProps;if(kl(r,s)&&t.ref===e.ref)if(xt=!1,e.pendingProps=s=r,P0(t,i))t.flags&131072&&(xt=!0);else return e.lanes=t.lanes,Hs(t,e,i)}return Om(t,e,n,s,i)}function lk(t,e,n,s){var i=s.children,r=t!==null?t.memoizedState:null;if(t===null&&e.stateNode===null&&(e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.mode==="hidden"){if(e.flags&128){if(r=r!==null?r.baseLanes|n:n,t!==null){for(s=e.child=t.child,i=0;s!==null;)i=i|s.lanes|s.childLanes,s=s.sibling;s=i&~r}else s=0,e.child=null;return jb(t,e,r,n,s)}if(n&536870912)e.memoizedState={baseLanes:0,cachePool:null},t!==null&&pu(e,r!==null?r.cachePool:null),r!==null?xb(e,r):Em(),kw(e);else return s=e.lanes=536870912,jb(t,e,r!==null?r.baseLanes|n:n,n,s)}else r!==null?(pu(e,r.cachePool),xb(e,r),ii(),e.memoizedState=null):(t!==null&&pu(e,null),Em(),ii());return Ot(t,e,i,n),e.child}function Go(t,e){return t!==null&&t.tag===22||e.stateNode!==null||(e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),e.sibling}function jb(t,e,n,s,i){var r=v0();return r=r===null?null:{parent:gt._currentValue,pool:r},e.memoizedState={baseLanes:n,cachePool:r},t!==null&&pu(e,null),Em(),kw(e),t!==null&&ao(t,e,s,!0),e.childLanes=i,null}function bu(t,e){return e=Wu({mode:e.mode,children:e.children},t.mode),e.ref=t.ref,t.child=e,e.return=t,e}function Rb(t,e,n){return Sr(e,t.child,null,n),t=bu(e,e.pendingProps),t.flags|=2,cn(e),e.memoizedState=null,t}function L5(t,e,n){var s=e.pendingProps,i=(e.flags&128)!==0;if(e.flags&=-129,t===null){if(Ee){if(s.mode==="hidden")return t=bu(e,s),e.lanes=536870912,Go(null,t);if(Tm(e),(t=qe)?(t=eN(t,Cn),t=t!==null&&t.data==="&"?t:null,t!==null&&(e.memoizedState={dehydrated:t,treeContext:Oi!==null?{id:ts,overflow:ns}:null,retryLane:536870912,hydrationErrors:null},n=hw(t),n.return=e,e.child=n,Dt=e,qe=null)):t=null,t===null)throw Mi(e);return e.lanes=536870912,null}return bu(e,s)}var r=t.memoizedState;if(r!==null){var a=r.dehydrated;if(Tm(e),i)if(e.flags&256)e.flags&=-257,e=Rb(t,e,n);else if(e.memoizedState!==null)e.child=t.child,e.flags|=128,e=null;else throw Error(G(558));else if(xt||ao(t,e,n,!1),i=(n&t.childLanes)!==0,xt||i){if(s=$e,s!==null&&(a=U_(s,n),a!==0&&a!==r.retryLane))throw r.retryLane=a,Ur(t,a),sn(s,t,a),L0;Ju(),e=Rb(t,e,n)}else t=r.treeContext,qe=Dn(a.nextSibling),Dt=e,Ee=!0,vi=null,Cn=!1,t!==null&&pw(e,t),e=bu(e,s),e.flags|=4096;return e}return t=Rs(t.child,{mode:s.mode,children:s.children}),t.ref=e.ref,e.child=t,t.return=e,t}function vu(t,e){var n=e.ref;if(n===null)t!==null&&t.ref!==null&&(e.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(G(284));(t===null||t.ref!==n)&&(e.flags|=4194816)}}function Om(t,e,n,s,i){return Nr(e),n=N0(t,e,n,s,void 0,i),s=S0(),t!==null&&!xt?(E0(t,e,i),Hs(t,e,i)):(Ee&&s&&g0(e),e.flags|=1,Ot(t,e,n,i),e.child)}function Ib(t,e,n,s,i,r){return Nr(e),e.updateQueue=null,n=Sw(e,s,n,i),Nw(t),s=S0(),t!==null&&!xt?(E0(t,e,r),Hs(t,e,r)):(Ee&&s&&g0(e),e.flags|=1,Ot(t,e,n,r),e.child)}function Cb(t,e,n,s,i){if(Nr(e),e.stateNode===null){var r=la,a=n.contextType;typeof a=="object"&&a!==null&&(r=Pt(a)),r=new n(s,r),e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=Im,e.stateNode=r,r._reactInternals=e,r=e.stateNode,r.props=s,r.state=e.memoizedState,r.refs={},_0(e),a=n.contextType,r.context=typeof a=="object"&&a!==null?Pt(a):la,r.state=e.memoizedState,a=n.getDerivedStateFromProps,typeof a=="function"&&(rh(e,n,a,s),r.state=e.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(a=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),a!==r.state&&Im.enqueueReplaceState(r,r.state,null),nl(e,s,r,i),tl(),r.state=e.memoizedState),typeof r.componentDidMount=="function"&&(e.flags|=4194308),s=!0}else if(t===null){r=e.stateNode;var l=e.memoizedProps,c=Tr(n,l);r.props=c;var u=r.context,d=n.contextType;a=la,typeof d=="object"&&d!==null&&(a=Pt(d));var f=n.getDerivedStateFromProps;d=typeof f=="function"||typeof r.getSnapshotBeforeUpdate=="function",l=e.pendingProps!==l,d||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(l||u!==a)&&Sb(e,r,s,a),ti=!1;var h=e.memoizedState;r.state=h,nl(e,s,r,i),tl(),u=e.memoizedState,l||h!==u||ti?(typeof f=="function"&&(rh(e,n,f,s),u=e.memoizedState),(c=ti||Nb(e,n,c,s,h,u,a))?(d||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount()),typeof r.componentDidMount=="function"&&(e.flags|=4194308)):(typeof r.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=u),r.props=s,r.state=u,r.context=a,s=c):(typeof r.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{r=e.stateNode,Nm(t,e),a=e.memoizedProps,d=Tr(n,a),r.props=d,f=e.pendingProps,h=r.context,u=n.contextType,c=la,typeof u=="object"&&u!==null&&(c=Pt(u)),l=n.getDerivedStateFromProps,(u=typeof l=="function"||typeof r.getSnapshotBeforeUpdate=="function")||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(a!==f||h!==c)&&Sb(e,r,s,c),ti=!1,h=e.memoizedState,r.state=h,nl(e,s,r,i),tl();var m=e.memoizedState;a!==f||h!==m||ti||t!==null&&t.dependencies!==null&&Gu(t.dependencies)?(typeof l=="function"&&(rh(e,n,l,s),m=e.memoizedState),(d=ti||Nb(e,n,d,s,h,m,c)||t!==null&&t.dependencies!==null&&Gu(t.dependencies))?(u||typeof r.UNSAFE_componentWillUpdate!="function"&&typeof r.componentWillUpdate!="function"||(typeof r.componentWillUpdate=="function"&&r.componentWillUpdate(s,m,c),typeof r.UNSAFE_componentWillUpdate=="function"&&r.UNSAFE_componentWillUpdate(s,m,c)),typeof r.componentDidUpdate=="function"&&(e.flags|=4),typeof r.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof r.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=m),r.props=s,r.state=m,r.context=c,s=d):(typeof r.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),s=!1)}return r=s,vu(t,e),s=(e.flags&128)!==0,r||s?(r=e.stateNode,n=s&&typeof n.getDerivedStateFromError!="function"?null:r.render(),e.flags|=1,t!==null&&s?(e.child=Sr(e,t.child,null,i),e.child=Sr(e,null,n,i)):Ot(t,e,n,i),e.memoizedState=r.state,t=e.child):t=Hs(t,e,i),t}function Ob(t,e,n,s){return kr(),e.flags|=256,Ot(t,e,n,s),e.child}var ah={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function oh(t){return{baseLanes:t,cachePool:xw()}}function lh(t,e,n){return t=t!==null?t.childLanes&~n:0,e&&(t|=fn),t}function ck(t,e,n){var s=e.pendingProps,i=!1,r=(e.flags&128)!==0,a;if((a=r)||(a=t!==null&&t.memoizedState===null?!1:(ft.current&2)!==0),a&&(i=!0,e.flags&=-129),a=(e.flags&32)!==0,e.flags&=-33,t===null){if(Ee){if(i?si(e):ii(),(t=qe)?(t=eN(t,Cn),t=t!==null&&t.data!=="&"?t:null,t!==null&&(e.memoizedState={dehydrated:t,treeContext:Oi!==null?{id:ts,overflow:ns}:null,retryLane:536870912,hydrationErrors:null},n=hw(t),n.return=e,e.child=n,Dt=e,qe=null)):t=null,t===null)throw Mi(e);return Ym(t)?e.lanes=32:e.lanes=536870912,null}var l=s.children;return s=s.fallback,i?(ii(),i=e.mode,l=Wu({mode:"hidden",children:l},i),s=mr(s,i,n,null),l.return=e,s.return=e,l.sibling=s,e.child=l,s=e.child,s.memoizedState=oh(n),s.childLanes=lh(t,a,n),e.memoizedState=ah,Go(null,s)):(si(e),Mm(e,l))}var c=t.memoizedState;if(c!==null&&(l=c.dehydrated,l!==null)){if(r)e.flags&256?(si(e),e.flags&=-257,e=ch(t,e,n)):e.memoizedState!==null?(ii(),e.child=t.child,e.flags|=128,e=null):(ii(),l=s.fallback,i=e.mode,s=Wu({mode:"visible",children:s.children},i),l=mr(l,i,n,null),l.flags|=2,s.return=e,l.return=e,s.sibling=l,e.child=s,Sr(e,t.child,null,n),s=e.child,s.memoizedState=oh(n),s.childLanes=lh(t,a,n),e.memoizedState=ah,e=Go(null,s));else if(si(e),Ym(l)){if(a=l.nextSibling&&l.nextSibling.dataset,a)var u=a.dgst;a=u,s=Error(G(419)),s.stack="",s.digest=a,Sl({value:s,source:null,stack:null}),e=ch(t,e,n)}else if(xt||ao(t,e,n,!1),a=(n&t.childLanes)!==0,xt||a){if(a=$e,a!==null&&(s=U_(a,n),s!==0&&s!==c.retryLane))throw c.retryLane=s,Ur(t,s),sn(a,t,s),L0;Km(l)||Ju(),e=ch(t,e,n)}else Km(l)?(e.flags|=192,e.child=t.child,e=null):(t=c.treeContext,qe=Dn(l.nextSibling),Dt=e,Ee=!0,vi=null,Cn=!1,t!==null&&pw(e,t),e=Mm(e,s.children),e.flags|=4096);return e}return i?(ii(),l=s.fallback,i=e.mode,c=t.child,u=c.sibling,s=Rs(c,{mode:"hidden",children:s.children}),s.subtreeFlags=c.subtreeFlags&65011712,u!==null?l=Rs(u,l):(l=mr(l,i,n,null),l.flags|=2),l.return=e,s.return=e,s.sibling=l,e.child=s,Go(null,s),s=e.child,l=t.child.memoizedState,l===null?l=oh(n):(i=l.cachePool,i!==null?(c=gt._currentValue,i=i.parent!==c?{parent:c,pool:c}:i):i=xw(),l={baseLanes:l.baseLanes|n,cachePool:i}),s.memoizedState=l,s.childLanes=lh(t,a,n),e.memoizedState=ah,Go(t.child,s)):(si(e),n=t.child,t=n.sibling,n=Rs(n,{mode:"visible",children:s.children}),n.return=e,n.sibling=null,t!==null&&(a=e.deletions,a===null?(e.deletions=[t],e.flags|=16):a.push(t)),e.child=n,e.memoizedState=null,n)}function Mm(t,e){return e=Wu({mode:"visible",children:e},t.mode),e.return=t,t.child=e}function Wu(t,e){return t=un(22,t,null,e),t.lanes=0,t}function ch(t,e,n){return Sr(e,t.child,null,n),t=Mm(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Mb(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),_m(t.return,e,n)}function uh(t,e,n,s,i,r){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:i,treeForkCount:r}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=s,a.tail=n,a.tailMode=i,a.treeForkCount=r)}function uk(t,e,n){var s=e.pendingProps,i=s.revealOrder,r=s.tail;s=s.children;var a=ft.current,l=(a&2)!==0;if(l?(a=a&1|2,e.flags|=128):a&=1,Ke(ft,a),Ot(t,e,s,n),s=Ee?Nl:0,!l&&t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Mb(t,n,e);else if(t.tag===19)Mb(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&zu(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),uh(e,!1,i,n,r,s);break;case"backwards":case"unstable_legacy-backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&zu(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}uh(e,!0,n,null,r,s);break;case"together":uh(e,!1,null,null,void 0,s);break;default:e.memoizedState=null}return e.child}function Hs(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Li|=e.lanes,!(n&e.childLanes))if(t!==null){if(ao(t,e,n,!1),(n&e.childLanes)===0)return null}else return null;if(t!==null&&e.child!==t.child)throw Error(G(153));if(e.child!==null){for(t=e.child,n=Rs(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Rs(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function P0(t,e){return t.lanes&e?!0:(t=t.dependencies,!!(t!==null&&Gu(t)))}function P5(t,e,n){switch(e.tag){case 3:Mu(e,e.stateNode.containerInfo),ni(e,gt,t.memoizedState.cache),kr();break;case 27:case 5:lm(e);break;case 4:Mu(e,e.stateNode.containerInfo);break;case 10:ni(e,e.type,e.memoizedProps.value);break;case 31:if(e.memoizedState!==null)return e.flags|=128,Tm(e),null;break;case 13:var s=e.memoizedState;if(s!==null)return s.dehydrated!==null?(si(e),e.flags|=128,null):n&e.child.childLanes?ck(t,e,n):(si(e),t=Hs(t,e,n),t!==null?t.sibling:null);si(e);break;case 19:var i=(t.flags&128)!==0;if(s=(n&e.childLanes)!==0,s||(ao(t,e,n,!1),s=(n&e.childLanes)!==0),i){if(s)return uk(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ke(ft,ft.current),s)break;return null;case 22:return e.lanes=0,lk(t,e,n,e.pendingProps);case 24:ni(e,gt,t.memoizedState.cache)}return Hs(t,e,n)}function dk(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps)xt=!0;else{if(!P0(t,n)&&!(e.flags&128))return xt=!1,P5(t,e,n);xt=!!(t.flags&131072)}else xt=!1,Ee&&e.flags&1048576&&mw(e,Nl,e.index);switch(e.lanes=0,e.tag){case 16:e:{var s=e.pendingProps;if(t=ir(e.elementType),e.type=t,typeof t=="function")p0(t)?(s=Tr(t,s),e.tag=1,e=Cb(null,e,t,s,n)):(e.tag=0,e=Om(null,e,t,s,n));else{if(t!=null){var i=t.$$typeof;if(i===t0){e.tag=11,e=Tb(null,e,t,s,n);break e}else if(i===n0){e.tag=14,e=Ab(null,e,t,s,n);break e}}throw e=am(t)||t,Error(G(306,e,""))}}return e;case 0:return Om(t,e,e.type,e.pendingProps,n);case 1:return s=e.type,i=Tr(s,e.pendingProps),Cb(t,e,s,i,n);case 3:e:{if(Mu(e,e.stateNode.containerInfo),t===null)throw Error(G(387));s=e.pendingProps;var r=e.memoizedState;i=r.element,Nm(t,e),nl(e,s,null,n);var a=e.memoizedState;if(s=a.cache,ni(e,gt,s),s!==r.cache&&wm(e,[gt],n,!0),tl(),s=a.element,r.isDehydrated)if(r={element:s,isDehydrated:!1,cache:a.cache},e.updateQueue.baseState=r,e.memoizedState=r,e.flags&256){e=Ob(t,e,s,n);break e}else if(s!==i){i=In(Error(G(424)),e),Sl(i),e=Ob(t,e,s,n);break e}else{switch(t=e.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(qe=Dn(t.firstChild),Dt=e,Ee=!0,vi=null,Cn=!0,n=yw(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(kr(),s===i){e=Hs(t,e,n);break e}Ot(t,e,s,n)}e=e.child}return e;case 26:return vu(t,e),t===null?(n=ev(e.type,null,e.pendingProps,null))?e.memoizedState=n:Ee||(n=e.type,t=e.pendingProps,s=nd(bi.current).createElement(n),s[Mt]=e,s[rn]=t,Bt(s,n,t),Tt(s),e.stateNode=s):e.memoizedState=ev(e.type,t.memoizedProps,e.pendingProps,t.memoizedState),null;case 27:return lm(e),t===null&&Ee&&(s=e.stateNode=tN(e.type,e.pendingProps,bi.current),Dt=e,Cn=!0,i=qe,Ki(e.type)?(Wm=i,qe=Dn(s.firstChild)):qe=i),Ot(t,e,e.pendingProps.children,n),vu(t,e),t===null&&(e.flags|=4194304),e.child;case 5:return t===null&&Ee&&((i=s=qe)&&(s=hj(s,e.type,e.pendingProps,Cn),s!==null?(e.stateNode=s,Dt=e,qe=Dn(s.firstChild),Cn=!1,i=!0):i=!1),i||Mi(e)),lm(e),i=e.type,r=e.pendingProps,a=t!==null?t.memoizedProps:null,s=r.children,zm(i,r)?s=null:a!==null&&zm(i,a)&&(e.flags|=32),e.memoizedState!==null&&(i=N0(t,e,A5,null,null,n),Il._currentValue=i),vu(t,e),Ot(t,e,s,n),e.child;case 6:return t===null&&Ee&&((t=n=qe)&&(n=mj(n,e.pendingProps,Cn),n!==null?(e.stateNode=n,Dt=e,qe=null,t=!0):t=!1),t||Mi(e)),null;case 13:return ck(t,e,n);case 4:return Mu(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=Sr(e,null,s,n):Ot(t,e,s,n),e.child;case 11:return Tb(t,e,e.type,e.pendingProps,n);case 7:return Ot(t,e,e.pendingProps,n),e.child;case 8:return Ot(t,e,e.pendingProps.children,n),e.child;case 12:return Ot(t,e,e.pendingProps.children,n),e.child;case 10:return s=e.pendingProps,ni(e,e.type,s.value),Ot(t,e,s.children,n),e.child;case 9:return i=e.type._context,s=e.pendingProps.children,Nr(e),i=Pt(i),s=s(i),e.flags|=1,Ot(t,e,s,n),e.child;case 14:return Ab(t,e,e.type,e.pendingProps,n);case 15:return ok(t,e,e.type,e.pendingProps,n);case 19:return uk(t,e,n);case 31:return L5(t,e,n);case 22:return lk(t,e,n,e.pendingProps);case 24:return Nr(e),s=Pt(gt),t===null?(i=v0(),i===null&&(i=$e,r=b0(),i.pooledCache=r,r.refCount++,r!==null&&(i.pooledCacheLanes|=n),i=r),e.memoizedState={parent:s,cache:i},_0(e),ni(e,gt,i)):(t.lanes&n&&(Nm(t,e),nl(e,null,null,n),tl()),i=t.memoizedState,r=e.memoizedState,i.parent!==s?(i={parent:s,cache:s},e.memoizedState=i,e.lanes===0&&(e.memoizedState=e.updateQueue.baseState=i),ni(e,gt,s)):(s=r.cache,ni(e,gt,s),s!==i.cache&&wm(e,[gt],n,!0))),Ot(t,e,e.pendingProps.children,n),e.child;case 29:throw e.pendingProps}throw Error(G(156,e.tag))}function gs(t){t.flags|=4}function dh(t,e,n,s,i){if((e=(t.mode&32)!==0)&&(e=!1),e){if(t.flags|=16777216,(i&335544128)===i)if(t.stateNode.complete)t.flags|=8192;else if(Dk())t.flags|=8192;else throw gr=$u,y0}else t.flags&=-16777217}function Db(t,e){if(e.type!=="stylesheet"||e.state.loading&4)t.flags&=-16777217;else if(t.flags|=16777216,!iN(e))if(Dk())t.flags|=8192;else throw gr=$u,y0}function Wc(t,e){e!==null&&(t.flags|=4),t.flags&16384&&(e=t.tag!==22?L_():536870912,t.lanes|=e,Ha|=e)}function Ro(t,e){if(!Ee)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function Ye(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,s|=i.subtreeFlags&65011712,s|=i.flags&65011712,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,s|=i.subtreeFlags,s|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function B5(t,e,n){var s=e.pendingProps;switch(x0(e),e.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ye(e),null;case 1:return Ye(e),null;case 3:return n=e.stateNode,s=null,t!==null&&(s=t.memoizedState.cache),e.memoizedState.cache!==s&&(e.flags|=2048),Is(gt),Ma(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Kr(e)?gs(e):t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,nh())),Ye(e),null;case 26:var i=e.type,r=e.memoizedState;return t===null?(gs(e),r!==null?(Ye(e),Db(e,r)):(Ye(e),dh(e,i,null,s,n))):r?r!==t.memoizedState?(gs(e),Ye(e),Db(e,r)):(Ye(e),e.flags&=-16777217):(t=t.memoizedProps,t!==s&&gs(e),Ye(e),dh(e,i,t,s,n)),null;case 27:if(Du(e),n=bi.current,i=e.type,t!==null&&e.stateNode!=null)t.memoizedProps!==s&&gs(e);else{if(!s){if(e.stateNode===null)throw Error(G(166));return Ye(e),null}t=is.current,Kr(e)?ub(e):(t=tN(i,s,n),e.stateNode=t,gs(e))}return Ye(e),null;case 5:if(Du(e),i=e.type,t!==null&&e.stateNode!=null)t.memoizedProps!==s&&gs(e);else{if(!s){if(e.stateNode===null)throw Error(G(166));return Ye(e),null}if(r=is.current,Kr(e))ub(e);else{var a=nd(bi.current);switch(r){case 1:r=a.createElementNS("http://www.w3.org/2000/svg",i);break;case 2:r=a.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;default:switch(i){case"svg":r=a.createElementNS("http://www.w3.org/2000/svg",i);break;case"math":r=a.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;case"script":r=a.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof s.is=="string"?a.createElement("select",{is:s.is}):a.createElement("select"),s.multiple?r.multiple=!0:s.size&&(r.size=s.size);break;default:r=typeof s.is=="string"?a.createElement(i,{is:s.is}):a.createElement(i)}}r[Mt]=e,r[rn]=s;e:for(a=e.child;a!==null;){if(a.tag===5||a.tag===6)r.appendChild(a.stateNode);else if(a.tag!==4&&a.tag!==27&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===e)break e;for(;a.sibling===null;){if(a.return===null||a.return===e)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}e.stateNode=r;e:switch(Bt(r,i,s),i){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&gs(e)}}return Ye(e),dh(e,e.type,t===null?null:t.memoizedProps,e.pendingProps,n),null;case 6:if(t&&e.stateNode!=null)t.memoizedProps!==s&&gs(e);else{if(typeof s!="string"&&e.stateNode===null)throw Error(G(166));if(t=bi.current,Kr(e)){if(t=e.stateNode,n=e.memoizedProps,s=null,i=Dt,i!==null)switch(i.tag){case 27:case 5:s=i.memoizedProps}t[Mt]=e,t=!!(t.nodeValue===n||s!==null&&s.suppressHydrationWarning===!0||Qk(t.nodeValue,n)),t||Mi(e,!0)}else t=nd(t).createTextNode(s),t[Mt]=e,e.stateNode=t}return Ye(e),null;case 31:if(n=e.memoizedState,t===null||t.memoizedState!==null){if(s=Kr(e),n!==null){if(t===null){if(!s)throw Error(G(318));if(t=e.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(G(557));t[Mt]=e}else kr(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ye(e),t=!1}else n=nh(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=n),t=!0;if(!t)return e.flags&256?(cn(e),e):(cn(e),null);if(e.flags&128)throw Error(G(558))}return Ye(e),null;case 13:if(s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(i=Kr(e),s!==null&&s.dehydrated!==null){if(t===null){if(!i)throw Error(G(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(G(317));i[Mt]=e}else kr(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ye(e),i=!1}else i=nh(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=i),i=!0;if(!i)return e.flags&256?(cn(e),e):(cn(e),null)}return cn(e),e.flags&128?(e.lanes=n,e):(n=s!==null,t=t!==null&&t.memoizedState!==null,n&&(s=e.child,i=null,s.alternate!==null&&s.alternate.memoizedState!==null&&s.alternate.memoizedState.cachePool!==null&&(i=s.alternate.memoizedState.cachePool.pool),r=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(r=s.memoizedState.cachePool.pool),r!==i&&(s.flags|=2048)),n!==t&&n&&(e.child.flags|=8192),Wc(e,e.updateQueue),Ye(e),null);case 4:return Ma(),t===null&&z0(e.stateNode.containerInfo),Ye(e),null;case 10:return Is(e.type),Ye(e),null;case 19:if(jt(ft),s=e.memoizedState,s===null)return Ye(e),null;if(i=(e.flags&128)!==0,r=s.rendering,r===null)if(i)Ro(s,!1);else{if(ct!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(r=zu(t),r!==null){for(e.flags|=128,Ro(s,!1),t=r.updateQueue,e.updateQueue=t,Wc(e,t),e.subtreeFlags=0,t=n,n=e.child;n!==null;)fw(n,t),n=n.sibling;return Ke(ft,ft.current&1|2),Ee&&_s(e,s.treeForkCount),e.child}t=t.sibling}s.tail!==null&&hn()>Xu&&(e.flags|=128,i=!0,Ro(s,!1),e.lanes=4194304)}else{if(!i)if(t=zu(r),t!==null){if(e.flags|=128,i=!0,t=t.updateQueue,e.updateQueue=t,Wc(e,t),Ro(s,!0),s.tail===null&&s.tailMode==="hidden"&&!r.alternate&&!Ee)return Ye(e),null}else 2*hn()-s.renderingStartTime>Xu&&n!==536870912&&(e.flags|=128,i=!0,Ro(s,!1),e.lanes=4194304);s.isBackwards?(r.sibling=e.child,e.child=r):(t=s.last,t!==null?t.sibling=r:e.child=r,s.last=r)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=hn(),t.sibling=null,n=ft.current,Ke(ft,i?n&1|2:n&1),Ee&&_s(e,s.treeForkCount),t):(Ye(e),null);case 22:case 23:return cn(e),w0(),s=e.memoizedState!==null,t!==null?t.memoizedState!==null!==s&&(e.flags|=8192):s&&(e.flags|=8192),s?n&536870912&&!(e.flags&128)&&(Ye(e),e.subtreeFlags&6&&(e.flags|=8192)):Ye(e),n=e.updateQueue,n!==null&&Wc(e,n.retryQueue),n=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(n=t.memoizedState.cachePool.pool),s=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(s=e.memoizedState.cachePool.pool),s!==n&&(e.flags|=2048),t!==null&&jt(pr),null;case 24:return n=null,t!==null&&(n=t.memoizedState.cache),e.memoizedState.cache!==n&&(e.flags|=2048),Is(gt),Ye(e),null;case 25:return null;case 30:return null}throw Error(G(156,e.tag))}function U5(t,e){switch(x0(e),e.tag){case 1:return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Is(gt),Ma(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 26:case 27:case 5:return Du(e),null;case 31:if(e.memoizedState!==null){if(cn(e),e.alternate===null)throw Error(G(340));kr()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 13:if(cn(e),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(G(340));kr()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return jt(ft),null;case 4:return Ma(),null;case 10:return Is(e.type),null;case 22:case 23:return cn(e),w0(),t!==null&&jt(pr),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 24:return Is(gt),null;case 25:return null;default:return null}}function fk(t,e){switch(x0(e),e.tag){case 3:Is(gt),Ma();break;case 26:case 27:case 5:Du(e);break;case 4:Ma();break;case 31:e.memoizedState!==null&&cn(e);break;case 13:cn(e);break;case 19:jt(ft);break;case 10:Is(e.type);break;case 22:case 23:cn(e),w0(),t!==null&&jt(pr);break;case 24:Is(gt)}}function fc(t,e){try{var n=e.updateQueue,s=n!==null?n.lastEffect:null;if(s!==null){var i=s.next;n=i;do{if((n.tag&t)===t){s=void 0;var r=n.create,a=n.inst;s=r(),a.destroy=s}n=n.next}while(n!==i)}}catch(l){De(e,e.return,l)}}function Di(t,e,n){try{var s=e.updateQueue,i=s!==null?s.lastEffect:null;if(i!==null){var r=i.next;s=r;do{if((s.tag&t)===t){var a=s.inst,l=a.destroy;if(l!==void 0){a.destroy=void 0,i=e;var c=n,u=l;try{u()}catch(d){De(i,c,d)}}}s=s.next}while(s!==r)}}catch(d){De(e,e.return,d)}}function hk(t){var e=t.updateQueue;if(e!==null){var n=t.stateNode;try{ww(e,n)}catch(s){De(t,t.return,s)}}}function mk(t,e,n){n.props=Tr(t.type,t.memoizedProps),n.state=t.memoizedState;try{n.componentWillUnmount()}catch(s){De(t,e,s)}}function il(t,e){try{var n=t.ref;if(n!==null){switch(t.tag){case 26:case 27:case 5:var s=t.stateNode;break;case 30:s=t.stateNode;break;default:s=t.stateNode}typeof n=="function"?t.refCleanup=n(s):n.current=s}}catch(i){De(t,e,i)}}function ss(t,e){var n=t.ref,s=t.refCleanup;if(n!==null)if(typeof s=="function")try{s()}catch(i){De(t,e,i)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(i){De(t,e,i)}else n.current=null}function pk(t){var e=t.type,n=t.memoizedProps,s=t.stateNode;try{e:switch(e){case"button":case"input":case"select":case"textarea":n.autoFocus&&s.focus();break e;case"img":n.src?s.src=n.src:n.srcSet&&(s.srcset=n.srcSet)}}catch(i){De(t,t.return,i)}}function fh(t,e,n){try{var s=t.stateNode;oj(s,t.type,n,e),s[rn]=e}catch(i){De(t,t.return,i)}}function gk(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&Ki(t.type)||t.tag===4}function hh(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||gk(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&Ki(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Dm(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(t,e):(e=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,e.appendChild(t),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Ns));else if(s!==4&&(s===27&&Ki(t.type)&&(n=t.stateNode,e=null),t=t.child,t!==null))for(Dm(t,e,n),t=t.sibling;t!==null;)Dm(t,e,n),t=t.sibling}function qu(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(s===27&&Ki(t.type)&&(n=t.stateNode),t=t.child,t!==null))for(qu(t,e,n),t=t.sibling;t!==null;)qu(t,e,n),t=t.sibling}function xk(t){var e=t.stateNode,n=t.memoizedProps;try{for(var s=t.type,i=e.attributes;i.length;)e.removeAttributeNode(i[0]);Bt(e,s,n),e[Mt]=t,e[rn]=n}catch(r){De(t,t.return,r)}}var ws=!1,pt=!1,mh=!1,Lb=typeof WeakSet=="function"?WeakSet:Set,St=null;function H5(t,e){if(t=t.containerInfo,$m=ad,t=iw(t),f0(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var i=s.anchorOffset,r=s.focusNode;s=s.focusOffset;try{n.nodeType,r.nodeType}catch{n=null;break e}var a=0,l=-1,c=-1,u=0,d=0,f=t,h=null;t:for(;;){for(var m;f!==n||i!==0&&f.nodeType!==3||(l=a+i),f!==r||s!==0&&f.nodeType!==3||(c=a+s),f.nodeType===3&&(a+=f.nodeValue.length),(m=f.firstChild)!==null;)h=f,f=m;for(;;){if(f===t)break t;if(h===n&&++u===i&&(l=a),h===r&&++d===s&&(c=a),(m=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=m}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Fm={focusedElem:t,selectionRange:n},ad=!1,St=e;St!==null;)if(e=St,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,St=t;else for(;St!==null;){switch(e=St,r=e.alternate,t=e.flags,e.tag){case 0:if(t&4&&(t=e.updateQueue,t=t!==null?t.events:null,t!==null))for(n=0;n<t.length;n++)i=t[n],i.ref.impl=i.nextImpl;break;case 11:case 15:break;case 1:if(t&1024&&r!==null){t=void 0,n=e,i=r.memoizedProps,r=r.memoizedState,s=n.stateNode;try{var v=Tr(n.type,i);t=s.getSnapshotBeforeUpdate(v,r),s.__reactInternalSnapshotBeforeUpdate=t}catch(y){De(n,n.return,y)}}break;case 3:if(t&1024){if(t=e.stateNode.containerInfo,n=t.nodeType,n===9)Vm(t);else if(n===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":Vm(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(t&1024)throw Error(G(163))}if(t=e.sibling,t!==null){t.return=e.return,St=t;break}St=e.return}}function bk(t,e,n){var s=n.flags;switch(n.tag){case 0:case 11:case 15:bs(t,n),s&4&&fc(5,n);break;case 1:if(bs(t,n),s&4)if(t=n.stateNode,e===null)try{t.componentDidMount()}catch(a){De(n,n.return,a)}else{var i=Tr(n.type,e.memoizedProps);e=e.memoizedState;try{t.componentDidUpdate(i,e,t.__reactInternalSnapshotBeforeUpdate)}catch(a){De(n,n.return,a)}}s&64&&hk(n),s&512&&il(n,n.return);break;case 3:if(bs(t,n),s&64&&(t=n.updateQueue,t!==null)){if(e=null,n.child!==null)switch(n.child.tag){case 27:case 5:e=n.child.stateNode;break;case 1:e=n.child.stateNode}try{ww(t,e)}catch(a){De(n,n.return,a)}}break;case 27:e===null&&s&4&&xk(n);case 26:case 5:bs(t,n),e===null&&s&4&&pk(n),s&512&&il(n,n.return);break;case 12:bs(t,n);break;case 31:bs(t,n),s&4&&_k(t,n);break;case 13:bs(t,n),s&4&&wk(t,n),s&64&&(t=n.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(n=q5.bind(null,n),pj(t,n))));break;case 22:if(s=n.memoizedState!==null||ws,!s){e=e!==null&&e.memoizedState!==null||pt,i=ws;var r=pt;ws=s,(pt=e)&&!r?ys(t,n,(n.subtreeFlags&8772)!==0):bs(t,n),ws=i,pt=r}break;case 30:break;default:bs(t,n)}}function vk(t){var e=t.alternate;e!==null&&(t.alternate=null,vk(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&a0(e)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var tt=null,Zt=!1;function xs(t,e,n){for(n=n.child;n!==null;)yk(t,e,n),n=n.sibling}function yk(t,e,n){if(mn&&typeof mn.onCommitFiberUnmount=="function")try{mn.onCommitFiberUnmount(rc,n)}catch{}switch(n.tag){case 26:pt||ss(n,e),xs(t,e,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:pt||ss(n,e);var s=tt,i=Zt;Ki(n.type)&&(tt=n.stateNode,Zt=!1),xs(t,e,n),ll(n.stateNode),tt=s,Zt=i;break;case 5:pt||ss(n,e);case 6:if(s=tt,i=Zt,tt=null,xs(t,e,n),tt=s,Zt=i,tt!==null)if(Zt)try{(tt.nodeType===9?tt.body:tt.nodeName==="HTML"?tt.ownerDocument.body:tt).removeChild(n.stateNode)}catch(r){De(n,e,r)}else try{tt.removeChild(n.stateNode)}catch(r){De(n,e,r)}break;case 18:tt!==null&&(Zt?(t=tt,qb(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,n.stateNode),za(t)):qb(tt,n.stateNode));break;case 4:s=tt,i=Zt,tt=n.stateNode.containerInfo,Zt=!0,xs(t,e,n),tt=s,Zt=i;break;case 0:case 11:case 14:case 15:Di(2,n,e),pt||Di(4,n,e),xs(t,e,n);break;case 1:pt||(ss(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"&&mk(n,e,s)),xs(t,e,n);break;case 21:xs(t,e,n);break;case 22:pt=(s=pt)||n.memoizedState!==null,xs(t,e,n),pt=s;break;default:xs(t,e,n)}}function _k(t,e){if(e.memoizedState===null&&(t=e.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{za(t)}catch(n){De(e,e.return,n)}}}function wk(t,e){if(e.memoizedState===null&&(t=e.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{za(t)}catch(n){De(e,e.return,n)}}function G5(t){switch(t.tag){case 31:case 13:case 19:var e=t.stateNode;return e===null&&(e=t.stateNode=new Lb),e;case 22:return t=t.stateNode,e=t._retryCache,e===null&&(e=t._retryCache=new Lb),e;default:throw Error(G(435,t.tag))}}function qc(t,e){var n=G5(t);e.forEach(function(s){if(!n.has(s)){n.add(s);var i=X5.bind(null,t,s);s.then(i,i)}})}function Qt(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var i=n[s],r=t,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 27:if(Ki(l.type)){tt=l.stateNode,Zt=!1;break e}break;case 5:tt=l.stateNode,Zt=!1;break e;case 3:case 4:tt=l.stateNode.containerInfo,Zt=!0;break e}l=l.return}if(tt===null)throw Error(G(160));yk(r,a,i),tt=null,Zt=!1,r=i.alternate,r!==null&&(r.return=null),i.return=null}if(e.subtreeFlags&13886)for(e=e.child;e!==null;)kk(e,t),e=e.sibling}var Vn=null;function kk(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:Qt(e,t),Jt(t),s&4&&(Di(3,t,t.return),fc(3,t),Di(5,t,t.return));break;case 1:Qt(e,t),Jt(t),s&512&&(pt||n===null||ss(n,n.return)),s&64&&ws&&(t=t.updateQueue,t!==null&&(s=t.callbacks,s!==null&&(n=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=n===null?s:n.concat(s))));break;case 26:var i=Vn;if(Qt(e,t),Jt(t),s&512&&(pt||n===null||ss(n,n.return)),s&4){var r=n!==null?n.memoizedState:null;if(s=t.memoizedState,n===null)if(s===null)if(t.stateNode===null){e:{s=t.type,n=t.memoizedProps,i=i.ownerDocument||i;t:switch(s){case"title":r=i.getElementsByTagName("title")[0],(!r||r[lc]||r[Mt]||r.namespaceURI==="http://www.w3.org/2000/svg"||r.hasAttribute("itemprop"))&&(r=i.createElement(s),i.head.insertBefore(r,i.querySelector("head > title"))),Bt(r,s,n),r[Mt]=t,Tt(r),s=r;break e;case"link":var a=nv("link","href",i).get(s+(n.href||""));if(a){for(var l=0;l<a.length;l++)if(r=a[l],r.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&r.getAttribute("rel")===(n.rel==null?null:n.rel)&&r.getAttribute("title")===(n.title==null?null:n.title)&&r.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){a.splice(l,1);break t}}r=i.createElement(s),Bt(r,s,n),i.head.appendChild(r);break;case"meta":if(a=nv("meta","content",i).get(s+(n.content||""))){for(l=0;l<a.length;l++)if(r=a[l],r.getAttribute("content")===(n.content==null?null:""+n.content)&&r.getAttribute("name")===(n.name==null?null:n.name)&&r.getAttribute("property")===(n.property==null?null:n.property)&&r.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&r.getAttribute("charset")===(n.charSet==null?null:n.charSet)){a.splice(l,1);break t}}r=i.createElement(s),Bt(r,s,n),i.head.appendChild(r);break;default:throw Error(G(468,s))}r[Mt]=t,Tt(r),s=r}t.stateNode=s}else sv(i,t.type,t.stateNode);else t.stateNode=tv(i,s,t.memoizedProps);else r!==s?(r===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):r.count--,s===null?sv(i,t.type,t.stateNode):tv(i,s,t.memoizedProps)):s===null&&t.stateNode!==null&&fh(t,t.memoizedProps,n.memoizedProps)}break;case 27:Qt(e,t),Jt(t),s&512&&(pt||n===null||ss(n,n.return)),n!==null&&s&4&&fh(t,t.memoizedProps,n.memoizedProps);break;case 5:if(Qt(e,t),Jt(t),s&512&&(pt||n===null||ss(n,n.return)),t.flags&32){i=t.stateNode;try{La(i,"")}catch(v){De(t,t.return,v)}}s&4&&t.stateNode!=null&&(i=t.memoizedProps,fh(t,i,n!==null?n.memoizedProps:i)),s&1024&&(mh=!0);break;case 6:if(Qt(e,t),Jt(t),s&4){if(t.stateNode===null)throw Error(G(162));s=t.memoizedProps,n=t.stateNode;try{n.nodeValue=s}catch(v){De(t,t.return,v)}}break;case 3:if(wu=null,i=Vn,Vn=sd(e.containerInfo),Qt(e,t),Vn=i,Jt(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{za(e.containerInfo)}catch(v){De(t,t.return,v)}mh&&(mh=!1,Nk(t));break;case 4:s=Vn,Vn=sd(t.stateNode.containerInfo),Qt(e,t),Jt(t),Vn=s;break;case 12:Qt(e,t),Jt(t);break;case 31:Qt(e,t),Jt(t),s&4&&(s=t.updateQueue,s!==null&&(t.updateQueue=null,qc(t,s)));break;case 13:Qt(e,t),Jt(t),t.child.flags&8192&&t.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(af=hn()),s&4&&(s=t.updateQueue,s!==null&&(t.updateQueue=null,qc(t,s)));break;case 22:i=t.memoizedState!==null;var c=n!==null&&n.memoizedState!==null,u=ws,d=pt;if(ws=u||i,pt=d||c,Qt(e,t),pt=d,ws=u,Jt(t),s&8192)e:for(e=t.stateNode,e._visibility=i?e._visibility&-2:e._visibility|1,i&&(n===null||c||ws||pt||rr(t)),n=null,e=t;;){if(e.tag===5||e.tag===26){if(n===null){c=n=e;try{if(r=c.stateNode,i)a=r.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none";else{l=c.stateNode;var f=c.memoizedProps.style,h=f!=null&&f.hasOwnProperty("display")?f.display:null;l.style.display=h==null||typeof h=="boolean"?"":(""+h).trim()}}catch(v){De(c,c.return,v)}}}else if(e.tag===6){if(n===null){c=e;try{c.stateNode.nodeValue=i?"":c.memoizedProps}catch(v){De(c,c.return,v)}}}else if(e.tag===18){if(n===null){c=e;try{var m=c.stateNode;i?Xb(m,!0):Xb(c.stateNode,!1)}catch(v){De(c,c.return,v)}}}else if((e.tag!==22&&e.tag!==23||e.memoizedState===null||e===t)&&e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;n===e&&(n=null),e=e.return}n===e&&(n=null),e.sibling.return=e.return,e=e.sibling}s&4&&(s=t.updateQueue,s!==null&&(n=s.retryQueue,n!==null&&(s.retryQueue=null,qc(t,n))));break;case 19:Qt(e,t),Jt(t),s&4&&(s=t.updateQueue,s!==null&&(t.updateQueue=null,qc(t,s)));break;case 30:break;case 21:break;default:Qt(e,t),Jt(t)}}function Jt(t){var e=t.flags;if(e&2){try{for(var n,s=t.return;s!==null;){if(gk(s)){n=s;break}s=s.return}if(n==null)throw Error(G(160));switch(n.tag){case 27:var i=n.stateNode,r=hh(t);qu(t,r,i);break;case 5:var a=n.stateNode;n.flags&32&&(La(a,""),n.flags&=-33);var l=hh(t);qu(t,l,a);break;case 3:case 4:var c=n.stateNode.containerInfo,u=hh(t);Dm(t,u,c);break;default:throw Error(G(161))}}catch(d){De(t,t.return,d)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Nk(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var e=t;Nk(e),e.tag===5&&e.flags&1024&&e.stateNode.reset(),t=t.sibling}}function bs(t,e){if(e.subtreeFlags&8772)for(e=e.child;e!==null;)bk(t,e.alternate,e),e=e.sibling}function rr(t){for(t=t.child;t!==null;){var e=t;switch(e.tag){case 0:case 11:case 14:case 15:Di(4,e,e.return),rr(e);break;case 1:ss(e,e.return);var n=e.stateNode;typeof n.componentWillUnmount=="function"&&mk(e,e.return,n),rr(e);break;case 27:ll(e.stateNode);case 26:case 5:ss(e,e.return),rr(e);break;case 22:e.memoizedState===null&&rr(e);break;case 30:rr(e);break;default:rr(e)}t=t.sibling}}function ys(t,e,n){for(n=n&&(e.subtreeFlags&8772)!==0,e=e.child;e!==null;){var s=e.alternate,i=t,r=e,a=r.flags;switch(r.tag){case 0:case 11:case 15:ys(i,r,n),fc(4,r);break;case 1:if(ys(i,r,n),s=r,i=s.stateNode,typeof i.componentDidMount=="function")try{i.componentDidMount()}catch(u){De(s,s.return,u)}if(s=r,i=s.updateQueue,i!==null){var l=s.stateNode;try{var c=i.shared.hiddenCallbacks;if(c!==null)for(i.shared.hiddenCallbacks=null,i=0;i<c.length;i++)_w(c[i],l)}catch(u){De(s,s.return,u)}}n&&a&64&&hk(r),il(r,r.return);break;case 27:xk(r);case 26:case 5:ys(i,r,n),n&&s===null&&a&4&&pk(r),il(r,r.return);break;case 12:ys(i,r,n);break;case 31:ys(i,r,n),n&&a&4&&_k(i,r);break;case 13:ys(i,r,n),n&&a&4&&wk(i,r);break;case 22:r.memoizedState===null&&ys(i,r,n),il(r,r.return);break;case 30:break;default:ys(i,r,n)}e=e.sibling}}function B0(t,e){var n=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(n=t.memoizedState.cachePool.pool),t=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(t=e.memoizedState.cachePool.pool),t!==n&&(t!=null&&t.refCount++,n!=null&&uc(n))}function U0(t,e){t=null,e.alternate!==null&&(t=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==t&&(e.refCount++,t!=null&&uc(t))}function $n(t,e,n,s){if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Sk(t,e,n,s),e=e.sibling}function Sk(t,e,n,s){var i=e.flags;switch(e.tag){case 0:case 11:case 15:$n(t,e,n,s),i&2048&&fc(9,e);break;case 1:$n(t,e,n,s);break;case 3:$n(t,e,n,s),i&2048&&(t=null,e.alternate!==null&&(t=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==t&&(e.refCount++,t!=null&&uc(t)));break;case 12:if(i&2048){$n(t,e,n,s),t=e.stateNode;try{var r=e.memoizedProps,a=r.id,l=r.onPostCommit;typeof l=="function"&&l(a,e.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(c){De(e,e.return,c)}}else $n(t,e,n,s);break;case 31:$n(t,e,n,s);break;case 13:$n(t,e,n,s);break;case 23:break;case 22:r=e.stateNode,a=e.alternate,e.memoizedState!==null?r._visibility&2?$n(t,e,n,s):rl(t,e):r._visibility&2?$n(t,e,n,s):(r._visibility|=2,Jr(t,e,n,s,(e.subtreeFlags&10256)!==0||!1)),i&2048&&B0(a,e);break;case 24:$n(t,e,n,s),i&2048&&U0(e.alternate,e);break;default:$n(t,e,n,s)}}function Jr(t,e,n,s,i){for(i=i&&((e.subtreeFlags&10256)!==0||!1),e=e.child;e!==null;){var r=t,a=e,l=n,c=s,u=a.flags;switch(a.tag){case 0:case 11:case 15:Jr(r,a,l,c,i),fc(8,a);break;case 23:break;case 22:var d=a.stateNode;a.memoizedState!==null?d._visibility&2?Jr(r,a,l,c,i):rl(r,a):(d._visibility|=2,Jr(r,a,l,c,i)),i&&u&2048&&B0(a.alternate,a);break;case 24:Jr(r,a,l,c,i),i&&u&2048&&U0(a.alternate,a);break;default:Jr(r,a,l,c,i)}e=e.sibling}}function rl(t,e){if(e.subtreeFlags&10256)for(e=e.child;e!==null;){var n=t,s=e,i=s.flags;switch(s.tag){case 22:rl(n,s),i&2048&&B0(s.alternate,s);break;case 24:rl(n,s),i&2048&&U0(s.alternate,s);break;default:rl(n,s)}e=e.sibling}}var $o=8192;function Yr(t,e,n){if(t.subtreeFlags&$o)for(t=t.child;t!==null;)Ek(t,e,n),t=t.sibling}function Ek(t,e,n){switch(t.tag){case 26:Yr(t,e,n),t.flags&$o&&t.memoizedState!==null&&Tj(n,Vn,t.memoizedState,t.memoizedProps);break;case 5:Yr(t,e,n);break;case 3:case 4:var s=Vn;Vn=sd(t.stateNode.containerInfo),Yr(t,e,n),Vn=s;break;case 22:t.memoizedState===null&&(s=t.alternate,s!==null&&s.memoizedState!==null?(s=$o,$o=16777216,Yr(t,e,n),$o=s):Yr(t,e,n));break;default:Yr(t,e,n)}}function Tk(t){var e=t.alternate;if(e!==null&&(t=e.child,t!==null)){e.child=null;do e=t.sibling,t.sibling=null,t=e;while(t!==null)}}function Io(t){var e=t.deletions;if(t.flags&16){if(e!==null)for(var n=0;n<e.length;n++){var s=e[n];St=s,jk(s,t)}Tk(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Ak(t),t=t.sibling}function Ak(t){switch(t.tag){case 0:case 11:case 15:Io(t),t.flags&2048&&Di(9,t,t.return);break;case 3:Io(t);break;case 12:Io(t);break;case 22:var e=t.stateNode;t.memoizedState!==null&&e._visibility&2&&(t.return===null||t.return.tag!==13)?(e._visibility&=-3,yu(t)):Io(t);break;default:Io(t)}}function yu(t){var e=t.deletions;if(t.flags&16){if(e!==null)for(var n=0;n<e.length;n++){var s=e[n];St=s,jk(s,t)}Tk(t)}for(t=t.child;t!==null;){switch(e=t,e.tag){case 0:case 11:case 15:Di(8,e,e.return),yu(e);break;case 22:n=e.stateNode,n._visibility&2&&(n._visibility&=-3,yu(e));break;default:yu(e)}t=t.sibling}}function jk(t,e){for(;St!==null;){var n=St;switch(n.tag){case 0:case 11:case 15:Di(8,n,e);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var s=n.memoizedState.cachePool.pool;s!=null&&s.refCount++}break;case 24:uc(n.memoizedState.cache)}if(s=n.child,s!==null)s.return=n,St=s;else e:for(n=t;St!==null;){s=St;var i=s.sibling,r=s.return;if(vk(s),s===n){St=null;break e}if(i!==null){i.return=r,St=i;break e}St=r}}}var $5={getCacheForType:function(t){var e=Pt(gt),n=e.data.get(t);return n===void 0&&(n=t(),e.data.set(t,n)),n},cacheSignal:function(){return Pt(gt).controller.signal}},F5=typeof WeakMap=="function"?WeakMap:Map,Re=0,$e=null,Ne=null,Se=0,Me=0,ln=null,fi=!1,lo=!1,H0=!1,Gs=0,ct=0,Li=0,xr=0,G0=0,fn=0,Ha=0,al=null,en=null,Lm=!1,af=0,Rk=0,Xu=1/0,Qu=null,wi=null,_t=0,ki=null,Ga=null,Cs=0,Pm=0,Bm=null,Ik=null,ol=0,Um=null;function gn(){return Re&2&&Se!==0?Se&-Se:le.T!==null?F0():H_()}function Ck(){if(fn===0)if(!(Se&536870912)||Ee){var t=Gc;Gc<<=1,!(Gc&3932160)&&(Gc=262144),fn=t}else fn=536870912;return t=vn.current,t!==null&&(t.flags|=32),fn}function sn(t,e,n){(t===$e&&(Me===2||Me===9)||t.cancelPendingCommit!==null)&&($a(t,0),hi(t,Se,fn,!1)),oc(t,n),(!(Re&2)||t!==$e)&&(t===$e&&(!(Re&2)&&(xr|=n),ct===4&&hi(t,Se,fn,!1)),fs(t))}function Ok(t,e,n){if(Re&6)throw Error(G(327));var s=!n&&(e&127)===0&&(e&t.expiredLanes)===0||ac(t,e),i=s?K5(t,e):ph(t,e,!0),r=s;do{if(i===0){lo&&!s&&hi(t,e,0,!1);break}else{if(n=t.current.alternate,r&&!z5(n)){i=ph(t,e,!1),r=!1;continue}if(i===2){if(r=e,t.errorRecoveryDisabledLanes&r)var a=0;else a=t.pendingLanes&-536870913,a=a!==0?a:a&536870912?536870912:0;if(a!==0){e=a;e:{var l=t;i=al;var c=l.current.memoizedState.isDehydrated;if(c&&($a(l,a).flags|=256),a=ph(l,a,!1),a!==2){if(H0&&!c){l.errorRecoveryDisabledLanes|=r,xr|=r,i=4;break e}r=en,en=i,r!==null&&(en===null?en=r:en.push.apply(en,r))}i=a}if(r=!1,i!==2)continue}}if(i===1){$a(t,0),hi(t,e,0,!0);break}e:{switch(s=t,r=i,r){case 0:case 1:throw Error(G(345));case 4:if((e&4194048)!==e)break;case 6:hi(s,e,fn,!fi);break e;case 2:en=null;break;case 3:case 5:break;default:throw Error(G(329))}if((e&62914560)===e&&(i=af+300-hn(),10<i)){if(hi(s,e,fn,!fi),Wd(s,0,!0)!==0)break e;Cs=e,s.timeoutHandle=Zk(Pb.bind(null,s,n,en,Qu,Lm,e,fn,xr,Ha,fi,r,"Throttled",-0,0),i);break e}Pb(s,n,en,Qu,Lm,e,fn,xr,Ha,fi,r,null,-0,0)}}break}while(!0);fs(t)}function Pb(t,e,n,s,i,r,a,l,c,u,d,f,h,m){if(t.timeoutHandle=-1,f=e.subtreeFlags,f&8192||(f&16785408)===16785408){f={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ns},Ek(e,r,f);var v=(r&62914560)===r?af-hn():(r&4194048)===r?Rk-hn():0;if(v=Aj(f,v),v!==null){Cs=r,t.cancelPendingCommit=v(Ub.bind(null,t,e,r,n,s,i,a,l,c,d,f,null,h,m)),hi(t,r,a,!u);return}}Ub(t,e,r,n,s,i,a,l,c)}function z5(t){for(var e=t;;){var n=e.tag;if((n===0||n===11||n===15)&&e.flags&16384&&(n=e.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var s=0;s<n.length;s++){var i=n[s],r=i.getSnapshot;i=i.value;try{if(!bn(r(),i))return!1}catch{return!1}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function hi(t,e,n,s){e&=~G0,e&=~xr,t.suspendedLanes|=e,t.pingedLanes&=~e,s&&(t.warmLanes|=e),s=t.expirationTimes;for(var i=e;0<i;){var r=31-pn(i),a=1<<r;s[r]=-1,i&=~a}n!==0&&P_(t,n,e)}function of(){return Re&6?!0:(hc(0),!1)}function $0(){if(Ne!==null){if(Me===0)var t=Ne.return;else t=Ne,Ss=Hr=null,T0(t),Na=null,El=0,t=Ne;for(;t!==null;)fk(t.alternate,t),t=t.return;Ne=null}}function $a(t,e){var n=t.timeoutHandle;n!==-1&&(t.timeoutHandle=-1,uj(n)),n=t.cancelPendingCommit,n!==null&&(t.cancelPendingCommit=null,n()),Cs=0,$0(),$e=t,Ne=n=Rs(t.current,null),Se=e,Me=0,ln=null,fi=!1,lo=ac(t,e),H0=!1,Ha=fn=G0=xr=Li=ct=0,en=al=null,Lm=!1,e&8&&(e|=e&32);var s=t.entangledLanes;if(s!==0)for(t=t.entanglements,s&=e;0<s;){var i=31-pn(s),r=1<<i;e|=t[i],s&=~r}return Gs=e,Jd(),n}function Mk(t,e){ge=null,le.H=Al,e===oo||e===ef?(e=pb(),Me=3):e===y0?(e=pb(),Me=4):Me=e===L0?8:e!==null&&typeof e=="object"&&typeof e.then=="function"?6:1,ln=e,Ne===null&&(ct=1,Yu(t,In(e,t.current)))}function Dk(){var t=vn.current;return t===null?!0:(Se&4194048)===Se?Mn===null:(Se&62914560)===Se||Se&536870912?t===Mn:!1}function Lk(){var t=le.H;return le.H=Al,t===null?Al:t}function Pk(){var t=le.A;return le.A=$5,t}function Ju(){ct=4,fi||(Se&4194048)!==Se&&vn.current!==null||(lo=!0),!(Li&134217727)&&!(xr&134217727)||$e===null||hi($e,Se,fn,!1)}function ph(t,e,n){var s=Re;Re|=2;var i=Lk(),r=Pk();($e!==t||Se!==e)&&(Qu=null,$a(t,e)),e=!1;var a=ct;e:do try{if(Me!==0&&Ne!==null){var l=Ne,c=ln;switch(Me){case 8:$0(),a=6;break e;case 3:case 2:case 9:case 6:vn.current===null&&(e=!0);var u=Me;if(Me=0,ln=null,da(t,l,c,u),n&&lo){a=0;break e}break;default:u=Me,Me=0,ln=null,da(t,l,c,u)}}V5(),a=ct;break}catch(d){Mk(t,d)}while(!0);return e&&t.shellSuspendCounter++,Ss=Hr=null,Re=s,le.H=i,le.A=r,Ne===null&&($e=null,Se=0,Jd()),a}function V5(){for(;Ne!==null;)Bk(Ne)}function K5(t,e){var n=Re;Re|=2;var s=Lk(),i=Pk();$e!==t||Se!==e?(Qu=null,Xu=hn()+500,$a(t,e)):lo=ac(t,e);e:do try{if(Me!==0&&Ne!==null){e=Ne;var r=ln;t:switch(Me){case 1:Me=0,ln=null,da(t,e,r,1);break;case 2:case 9:if(mb(r)){Me=0,ln=null,Bb(e);break}e=function(){Me!==2&&Me!==9||$e!==t||(Me=7),fs(t)},r.then(e,e);break e;case 3:Me=7;break e;case 4:Me=5;break e;case 7:mb(r)?(Me=0,ln=null,Bb(e)):(Me=0,ln=null,da(t,e,r,7));break;case 5:var a=null;switch(Ne.tag){case 26:a=Ne.memoizedState;case 5:case 27:var l=Ne;if(a?iN(a):l.stateNode.complete){Me=0,ln=null;var c=l.sibling;if(c!==null)Ne=c;else{var u=l.return;u!==null?(Ne=u,lf(u)):Ne=null}break t}}Me=0,ln=null,da(t,e,r,5);break;case 6:Me=0,ln=null,da(t,e,r,6);break;case 8:$0(),ct=6;break e;default:throw Error(G(462))}}Y5();break}catch(d){Mk(t,d)}while(!0);return Ss=Hr=null,le.H=s,le.A=i,Re=n,Ne!==null?0:($e=null,Se=0,Jd(),ct)}function Y5(){for(;Ne!==null&&!g2();)Bk(Ne)}function Bk(t){var e=dk(t.alternate,t,Gs);t.memoizedProps=t.pendingProps,e===null?lf(t):Ne=e}function Bb(t){var e=t,n=e.alternate;switch(e.tag){case 15:case 0:e=Ib(n,e,e.pendingProps,e.type,void 0,Se);break;case 11:e=Ib(n,e,e.pendingProps,e.type.render,e.ref,Se);break;case 5:T0(e);default:fk(n,e),e=Ne=fw(e,Gs),e=dk(n,e,Gs)}t.memoizedProps=t.pendingProps,e===null?lf(t):Ne=e}function da(t,e,n,s){Ss=Hr=null,T0(e),Na=null,El=0;var i=e.return;try{if(D5(t,i,e,n,Se)){ct=1,Yu(t,In(n,t.current)),Ne=null;return}}catch(r){if(i!==null)throw Ne=i,r;ct=1,Yu(t,In(n,t.current)),Ne=null;return}e.flags&32768?(Ee||s===1?t=!0:lo||Se&536870912?t=!1:(fi=t=!0,(s===2||s===9||s===3||s===6)&&(s=vn.current,s!==null&&s.tag===13&&(s.flags|=16384))),Uk(e,t)):lf(e)}function lf(t){var e=t;do{if(e.flags&32768){Uk(e,fi);return}t=e.return;var n=B5(e.alternate,e,Gs);if(n!==null){Ne=n;return}if(e=e.sibling,e!==null){Ne=e;return}Ne=e=t}while(e!==null);ct===0&&(ct=5)}function Uk(t,e){do{var n=U5(t.alternate,t);if(n!==null){n.flags&=32767,Ne=n;return}if(n=t.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!e&&(t=t.sibling,t!==null)){Ne=t;return}Ne=t=n}while(t!==null);ct=6,Ne=null}function Ub(t,e,n,s,i,r,a,l,c){t.cancelPendingCommit=null;do cf();while(_t!==0);if(Re&6)throw Error(G(327));if(e!==null){if(e===t.current)throw Error(G(177));if(r=e.lanes|e.childLanes,r|=h0,E2(t,n,r,a,l,c),t===$e&&(Ne=$e=null,Se=0),Ga=e,ki=t,Cs=n,Pm=r,Bm=i,Ik=s,e.subtreeFlags&10256||e.flags&10256?(t.callbackNode=null,t.callbackPriority=0,Q5(Lu,function(){return zk(),null})):(t.callbackNode=null,t.callbackPriority=0),s=(e.flags&13878)!==0,e.subtreeFlags&13878||s){s=le.T,le.T=null,i=Ie.p,Ie.p=2,a=Re,Re|=4;try{H5(t,e,n)}finally{Re=a,Ie.p=i,le.T=s}}_t=1,Hk(),Gk(),$k()}}function Hk(){if(_t===1){_t=0;var t=ki,e=Ga,n=(e.flags&13878)!==0;if(e.subtreeFlags&13878||n){n=le.T,le.T=null;var s=Ie.p;Ie.p=2;var i=Re;Re|=4;try{kk(e,t);var r=Fm,a=iw(t.containerInfo),l=r.focusedElem,c=r.selectionRange;if(a!==l&&l&&l.ownerDocument&&sw(l.ownerDocument.documentElement,l)){if(c!==null&&f0(l)){var u=c.start,d=c.end;if(d===void 0&&(d=u),"selectionStart"in l)l.selectionStart=u,l.selectionEnd=Math.min(d,l.value.length);else{var f=l.ownerDocument||document,h=f&&f.defaultView||window;if(h.getSelection){var m=h.getSelection(),v=l.textContent.length,y=Math.min(c.start,v),b=c.end===void 0?y:Math.min(c.end,v);!m.extend&&y>b&&(a=b,b=y,y=a);var g=ob(l,y),p=ob(l,b);if(g&&p&&(m.rangeCount!==1||m.anchorNode!==g.node||m.anchorOffset!==g.offset||m.focusNode!==p.node||m.focusOffset!==p.offset)){var x=f.createRange();x.setStart(g.node,g.offset),m.removeAllRanges(),y>b?(m.addRange(x),m.extend(p.node,p.offset)):(x.setEnd(p.node,p.offset),m.addRange(x))}}}}for(f=[],m=l;m=m.parentNode;)m.nodeType===1&&f.push({element:m,left:m.scrollLeft,top:m.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<f.length;l++){var w=f[l];w.element.scrollLeft=w.left,w.element.scrollTop=w.top}}ad=!!$m,Fm=$m=null}finally{Re=i,Ie.p=s,le.T=n}}t.current=e,_t=2}}function Gk(){if(_t===2){_t=0;var t=ki,e=Ga,n=(e.flags&8772)!==0;if(e.subtreeFlags&8772||n){n=le.T,le.T=null;var s=Ie.p;Ie.p=2;var i=Re;Re|=4;try{bk(t,e.alternate,e)}finally{Re=i,Ie.p=s,le.T=n}}_t=3}}function $k(){if(_t===4||_t===3){_t=0,x2();var t=ki,e=Ga,n=Cs,s=Ik;e.subtreeFlags&10256||e.flags&10256?_t=5:(_t=0,Ga=ki=null,Fk(t,t.pendingLanes));var i=t.pendingLanes;if(i===0&&(wi=null),r0(n),e=e.stateNode,mn&&typeof mn.onCommitFiberRoot=="function")try{mn.onCommitFiberRoot(rc,e,void 0,(e.current.flags&128)===128)}catch{}if(s!==null){e=le.T,i=Ie.p,Ie.p=2,le.T=null;try{for(var r=t.onRecoverableError,a=0;a<s.length;a++){var l=s[a];r(l.value,{componentStack:l.stack})}}finally{le.T=e,Ie.p=i}}Cs&3&&cf(),fs(t),i=t.pendingLanes,n&261930&&i&42?t===Um?ol++:(ol=0,Um=t):ol=0,hc(0)}}function Fk(t,e){(t.pooledCacheLanes&=e)===0&&(e=t.pooledCache,e!=null&&(t.pooledCache=null,uc(e)))}function cf(){return Hk(),Gk(),$k(),zk()}function zk(){if(_t!==5)return!1;var t=ki,e=Pm;Pm=0;var n=r0(Cs),s=le.T,i=Ie.p;try{Ie.p=32>n?32:n,le.T=null,n=Bm,Bm=null;var r=ki,a=Cs;if(_t=0,Ga=ki=null,Cs=0,Re&6)throw Error(G(331));var l=Re;if(Re|=4,Ak(r.current),Sk(r,r.current,a,n),Re=l,hc(0,!1),mn&&typeof mn.onPostCommitFiberRoot=="function")try{mn.onPostCommitFiberRoot(rc,r)}catch{}return!0}finally{Ie.p=i,le.T=s,Fk(t,e)}}function Hb(t,e,n){e=In(n,e),e=Cm(t.stateNode,e,2),t=_i(t,e,2),t!==null&&(oc(t,2),fs(t))}function De(t,e,n){if(t.tag===3)Hb(t,t,n);else for(;e!==null;){if(e.tag===3){Hb(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(wi===null||!wi.has(s))){t=In(n,t),n=rk(2),s=_i(e,n,2),s!==null&&(ak(n,s,e,t),oc(s,2),fs(s));break}}e=e.return}}function gh(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new F5;var i=new Set;s.set(e,i)}else i=s.get(e),i===void 0&&(i=new Set,s.set(e,i));i.has(n)||(H0=!0,i.add(n),t=W5.bind(null,t,e,n),e.then(t,t))}function W5(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),t.pingedLanes|=t.suspendedLanes&n,t.warmLanes&=~n,$e===t&&(Se&n)===n&&(ct===4||ct===3&&(Se&62914560)===Se&&300>hn()-af?!(Re&2)&&$a(t,0):G0|=n,Ha===Se&&(Ha=0)),fs(t)}function Vk(t,e){e===0&&(e=L_()),t=Ur(t,e),t!==null&&(oc(t,e),fs(t))}function q5(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Vk(t,n)}function X5(t,e){var n=0;switch(t.tag){case 31:case 13:var s=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:s=t.stateNode;break;case 22:s=t.stateNode._retryCache;break;default:throw Error(G(314))}s!==null&&s.delete(e),Vk(t,n)}function Q5(t,e){return s0(t,e)}var Zu=null,Zr=null,Hm=!1,ed=!1,xh=!1,mi=0;function fs(t){t!==Zr&&t.next===null&&(Zr===null?Zu=Zr=t:Zr=Zr.next=t),ed=!0,Hm||(Hm=!0,Z5())}function hc(t,e){if(!xh&&ed){xh=!0;do for(var n=!1,s=Zu;s!==null;){if(t!==0){var i=s.pendingLanes;if(i===0)var r=0;else{var a=s.suspendedLanes,l=s.pingedLanes;r=(1<<31-pn(42|t)+1)-1,r&=i&~(a&~l),r=r&201326741?r&201326741|1:r?r|2:0}r!==0&&(n=!0,Gb(s,r))}else r=Se,r=Wd(s,s===$e?r:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),!(r&3)||ac(s,r)||(n=!0,Gb(s,r));s=s.next}while(n);xh=!1}}function J5(){Kk()}function Kk(){ed=Hm=!1;var t=0;mi!==0&&cj()&&(t=mi);for(var e=hn(),n=null,s=Zu;s!==null;){var i=s.next,r=Yk(s,e);r===0?(s.next=null,n===null?Zu=i:n.next=i,i===null&&(Zr=n)):(n=s,(t!==0||r&3)&&(ed=!0)),s=i}_t!==0&&_t!==5||hc(t),mi!==0&&(mi=0)}function Yk(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,i=t.expirationTimes,r=t.pendingLanes&-62914561;0<r;){var a=31-pn(r),l=1<<a,c=i[a];c===-1?(!(l&n)||l&s)&&(i[a]=S2(l,e)):c<=e&&(t.expiredLanes|=l),r&=~l}if(e=$e,n=Se,n=Wd(t,t===e?n:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),s=t.callbackNode,n===0||t===e&&(Me===2||Me===9)||t.cancelPendingCommit!==null)return s!==null&&s!==null&&Vf(s),t.callbackNode=null,t.callbackPriority=0;if(!(n&3)||ac(t,n)){if(e=n&-n,e===t.callbackPriority)return e;switch(s!==null&&Vf(s),r0(n)){case 2:case 8:n=M_;break;case 32:n=Lu;break;case 268435456:n=D_;break;default:n=Lu}return s=Wk.bind(null,t),n=s0(n,s),t.callbackPriority=e,t.callbackNode=n,e}return s!==null&&s!==null&&Vf(s),t.callbackPriority=2,t.callbackNode=null,2}function Wk(t,e){if(_t!==0&&_t!==5)return t.callbackNode=null,t.callbackPriority=0,null;var n=t.callbackNode;if(cf()&&t.callbackNode!==n)return null;var s=Se;return s=Wd(t,t===$e?s:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),s===0?null:(Ok(t,s,e),Yk(t,hn()),t.callbackNode!=null&&t.callbackNode===n?Wk.bind(null,t):null)}function Gb(t,e){if(cf())return null;Ok(t,e,!0)}function Z5(){dj(function(){Re&6?s0(O_,J5):Kk()})}function F0(){if(mi===0){var t=Pa;t===0&&(t=Hc,Hc<<=1,!(Hc&261888)&&(Hc=256)),mi=t}return mi}function $b(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:du(""+t)}function Fb(t,e){var n=e.ownerDocument.createElement("input");return n.name=e.name,n.value=e.value,t.id&&n.setAttribute("form",t.id),e.parentNode.insertBefore(n,e),t=new FormData(t),n.parentNode.removeChild(n),t}function ej(t,e,n,s,i){if(e==="submit"&&n&&n.stateNode===i){var r=$b((i[rn]||null).action),a=s.submitter;a&&(e=(e=a[rn]||null)?$b(e.formAction):a.getAttribute("formAction"),e!==null&&(r=e,a=null));var l=new qd("action","action",null,s,i);t.push({event:l,listeners:[{instance:null,listener:function(){if(s.defaultPrevented){if(mi!==0){var c=a?Fb(i,a):new FormData(i);Rm(n,{pending:!0,data:c,method:i.method,action:r},null,c)}}else typeof r=="function"&&(l.preventDefault(),c=a?Fb(i,a):new FormData(i),Rm(n,{pending:!0,data:c,method:i.method,action:r},r,c))},currentTarget:i}]})}}for(var bh=0;bh<bm.length;bh++){var vh=bm[bh],tj=vh.toLowerCase(),nj=vh[0].toUpperCase()+vh.slice(1);Zn(tj,"on"+nj)}Zn(aw,"onAnimationEnd");Zn(ow,"onAnimationIteration");Zn(lw,"onAnimationStart");Zn("dblclick","onDoubleClick");Zn("focusin","onFocus");Zn("focusout","onBlur");Zn(b5,"onTransitionRun");Zn(v5,"onTransitionStart");Zn(y5,"onTransitionCancel");Zn(cw,"onTransitionEnd");Da("onMouseEnter",["mouseout","mouseover"]);Da("onMouseLeave",["mouseout","mouseover"]);Da("onPointerEnter",["pointerout","pointerover"]);Da("onPointerLeave",["pointerout","pointerover"]);Lr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Lr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Lr("onBeforeInput",["compositionend","keypress","textInput","paste"]);Lr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Lr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Lr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var jl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),sj=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(jl));function qk(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],i=s.event;s=s.listeners;e:{var r=void 0;if(e)for(var a=s.length-1;0<=a;a--){var l=s[a],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==r&&i.isPropagationStopped())break e;r=l,i.currentTarget=u;try{r(i)}catch(d){Bu(d)}i.currentTarget=null,r=c}else for(a=0;a<s.length;a++){if(l=s[a],c=l.instance,u=l.currentTarget,l=l.listener,c!==r&&i.isPropagationStopped())break e;r=l,i.currentTarget=u;try{r(i)}catch(d){Bu(d)}i.currentTarget=null,r=c}}}}function ke(t,e){var n=e[um];n===void 0&&(n=e[um]=new Set);var s=t+"__bubble";n.has(s)||(Xk(e,t,2,!1),n.add(s))}function yh(t,e,n){var s=0;e&&(s|=4),Xk(n,t,s,e)}var Xc="_reactListening"+Math.random().toString(36).slice(2);function z0(t){if(!t[Xc]){t[Xc]=!0,G_.forEach(function(n){n!=="selectionchange"&&(sj.has(n)||yh(n,!1,t),yh(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Xc]||(e[Xc]=!0,yh("selectionchange",!1,e))}}function Xk(t,e,n,s){switch(cN(e)){case 2:var i=Ij;break;case 8:i=Cj;break;default:i=W0}n=i.bind(null,e,n,t),i=void 0,!pm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),s?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function _h(t,e,n,s,i){var r=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var a=s.tag;if(a===3||a===4){var l=s.stateNode.containerInfo;if(l===i)break;if(a===4)for(a=s.return;a!==null;){var c=a.tag;if((c===3||c===4)&&a.stateNode.containerInfo===i)return;a=a.return}for(;l!==null;){if(a=na(l),a===null)return;if(c=a.tag,c===5||c===6||c===26||c===27){s=r=a;continue e}l=l.parentNode}}s=s.return}q_(function(){var u=r,d=l0(n),f=[];e:{var h=uw.get(t);if(h!==void 0){var m=qd,v=t;switch(t){case"keypress":if(hu(n)===0)break e;case"keydown":case"keyup":m=X2;break;case"focusin":v="focus",m=Xf;break;case"focusout":v="blur",m=Xf;break;case"beforeblur":case"afterblur":m=Xf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Qx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=B2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=Z2;break;case aw:case ow:case lw:m=G2;break;case cw:m=t5;break;case"scroll":case"scrollend":m=L2;break;case"wheel":m=s5;break;case"copy":case"cut":case"paste":m=F2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Zx;break;case"toggle":case"beforetoggle":m=r5}var y=(e&4)!==0,b=!y&&(t==="scroll"||t==="scrollend"),g=y?h!==null?h+"Capture":null:h;y=[];for(var p=u,x;p!==null;){var w=p;if(x=w.stateNode,w=w.tag,w!==5&&w!==26&&w!==27||x===null||g===null||(w=_l(p,g),w!=null&&y.push(Rl(p,w,x))),b)break;p=p.return}0<y.length&&(h=new m(h,v,null,n,d),f.push({event:h,listeners:y}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",h&&n!==mm&&(v=n.relatedTarget||n.fromElement)&&(na(v)||v[io]))break e;if((m||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,m?(v=n.relatedTarget||n.toElement,m=u,v=v?na(v):null,v!==null&&(b=ic(v),y=v.tag,v!==b||y!==5&&y!==27&&y!==6)&&(v=null)):(m=null,v=u),m!==v)){if(y=Qx,w="onMouseLeave",g="onMouseEnter",p="mouse",(t==="pointerout"||t==="pointerover")&&(y=Zx,w="onPointerLeave",g="onPointerEnter",p="pointer"),b=m==null?h:Ho(m),x=v==null?h:Ho(v),h=new y(w,p+"leave",m,n,d),h.target=b,h.relatedTarget=x,w=null,na(d)===u&&(y=new y(g,p+"enter",v,n,d),y.target=x,y.relatedTarget=b,w=y),b=w,m&&v)t:{for(y=ij,g=m,p=v,x=0,w=g;w;w=y(w))x++;w=0;for(var k=p;k;k=y(k))w++;for(;0<x-w;)g=y(g),x--;for(;0<w-x;)p=y(p),w--;for(;x--;){if(g===p||p!==null&&g===p.alternate){y=g;break t}g=y(g),p=y(p)}y=null}else y=null;m!==null&&zb(f,h,m,y,!1),v!==null&&b!==null&&zb(f,b,v,y,!0)}}e:{if(h=u?Ho(u):window,m=h.nodeName&&h.nodeName.toLowerCase(),m==="select"||m==="input"&&h.type==="file")var S=sb;else if(nb(h))if(tw)S=p5;else{S=h5;var N=f5}else m=h.nodeName,!m||m.toLowerCase()!=="input"||h.type!=="checkbox"&&h.type!=="radio"?u&&o0(u.elementType)&&(S=sb):S=m5;if(S&&(S=S(t,u))){ew(f,S,n,d);break e}N&&N(t,h,u),t==="focusout"&&u&&h.type==="number"&&u.memoizedProps.value!=null&&hm(h,"number",h.value)}switch(N=u?Ho(u):window,t){case"focusin":(nb(N)||N.contentEditable==="true")&&(ra=N,gm=u,Jo=null);break;case"focusout":Jo=gm=ra=null;break;case"mousedown":xm=!0;break;case"contextmenu":case"mouseup":case"dragend":xm=!1,lb(f,n,d);break;case"selectionchange":if(x5)break;case"keydown":case"keyup":lb(f,n,d)}var T;if(d0)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else ia?J_(t,n)&&(E="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(Q_&&n.locale!=="ko"&&(ia||E!=="onCompositionStart"?E==="onCompositionEnd"&&ia&&(T=X_()):(di=d,c0="value"in di?di.value:di.textContent,ia=!0)),N=td(u,E),0<N.length&&(E=new Jx(E,t,null,n,d),f.push({event:E,listeners:N}),T?E.data=T:(T=Z_(n),T!==null&&(E.data=T)))),(T=o5?l5(t,n):c5(t,n))&&(E=td(u,"onBeforeInput"),0<E.length&&(N=new Jx("onBeforeInput","beforeinput",null,n,d),f.push({event:N,listeners:E}),N.data=T)),ej(f,t,u,n,d)}qk(f,e)})}function Rl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function td(t,e){for(var n=e+"Capture",s=[];t!==null;){var i=t,r=i.stateNode;if(i=i.tag,i!==5&&i!==26&&i!==27||r===null||(i=_l(t,n),i!=null&&s.unshift(Rl(t,i,r)),i=_l(t,e),i!=null&&s.push(Rl(t,i,r))),t.tag===3)return s;t=t.return}return[]}function ij(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function zb(t,e,n,s,i){for(var r=e._reactName,a=[];n!==null&&n!==s;){var l=n,c=l.alternate,u=l.stateNode;if(l=l.tag,c!==null&&c===s)break;l!==5&&l!==26&&l!==27||u===null||(c=u,i?(u=_l(n,r),u!=null&&a.unshift(Rl(n,u,c))):i||(u=_l(n,r),u!=null&&a.push(Rl(n,u,c)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var rj=/\r\n?/g,aj=/\u0000|\uFFFD/g;function Vb(t){return(typeof t=="string"?t:""+t).replace(rj,`
`).replace(aj,"")}function Qk(t,e){return e=Vb(e),Vb(t)===e}function Pe(t,e,n,s,i,r){switch(n){case"children":typeof s=="string"?e==="body"||e==="textarea"&&s===""||La(t,s):(typeof s=="number"||typeof s=="bigint")&&e!=="body"&&La(t,""+s);break;case"className":Fc(t,"class",s);break;case"tabIndex":Fc(t,"tabindex",s);break;case"dir":case"role":case"viewBox":case"width":case"height":Fc(t,n,s);break;case"style":W_(t,s,r);break;case"data":if(e!=="object"){Fc(t,"data",s);break}case"src":case"href":if(s===""&&(e!=="a"||n!=="href")){t.removeAttribute(n);break}if(s==null||typeof s=="function"||typeof s=="symbol"||typeof s=="boolean"){t.removeAttribute(n);break}s=du(""+s),t.setAttribute(n,s);break;case"action":case"formAction":if(typeof s=="function"){t.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof r=="function"&&(n==="formAction"?(e!=="input"&&Pe(t,e,"name",i.name,i,null),Pe(t,e,"formEncType",i.formEncType,i,null),Pe(t,e,"formMethod",i.formMethod,i,null),Pe(t,e,"formTarget",i.formTarget,i,null)):(Pe(t,e,"encType",i.encType,i,null),Pe(t,e,"method",i.method,i,null),Pe(t,e,"target",i.target,i,null)));if(s==null||typeof s=="symbol"||typeof s=="boolean"){t.removeAttribute(n);break}s=du(""+s),t.setAttribute(n,s);break;case"onClick":s!=null&&(t.onclick=Ns);break;case"onScroll":s!=null&&ke("scroll",t);break;case"onScrollEnd":s!=null&&ke("scrollend",t);break;case"dangerouslySetInnerHTML":if(s!=null){if(typeof s!="object"||!("__html"in s))throw Error(G(61));if(n=s.__html,n!=null){if(i.children!=null)throw Error(G(60));t.innerHTML=n}}break;case"multiple":t.multiple=s&&typeof s!="function"&&typeof s!="symbol";break;case"muted":t.muted=s&&typeof s!="function"&&typeof s!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(s==null||typeof s=="function"||typeof s=="boolean"||typeof s=="symbol"){t.removeAttribute("xlink:href");break}n=du(""+s),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":s!=null&&typeof s!="function"&&typeof s!="symbol"?t.setAttribute(n,""+s):t.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":s&&typeof s!="function"&&typeof s!="symbol"?t.setAttribute(n,""):t.removeAttribute(n);break;case"capture":case"download":s===!0?t.setAttribute(n,""):s!==!1&&s!=null&&typeof s!="function"&&typeof s!="symbol"?t.setAttribute(n,s):t.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":s!=null&&typeof s!="function"&&typeof s!="symbol"&&!isNaN(s)&&1<=s?t.setAttribute(n,s):t.removeAttribute(n);break;case"rowSpan":case"start":s==null||typeof s=="function"||typeof s=="symbol"||isNaN(s)?t.removeAttribute(n):t.setAttribute(n,s);break;case"popover":ke("beforetoggle",t),ke("toggle",t),uu(t,"popover",s);break;case"xlinkActuate":ps(t,"http://www.w3.org/1999/xlink","xlink:actuate",s);break;case"xlinkArcrole":ps(t,"http://www.w3.org/1999/xlink","xlink:arcrole",s);break;case"xlinkRole":ps(t,"http://www.w3.org/1999/xlink","xlink:role",s);break;case"xlinkShow":ps(t,"http://www.w3.org/1999/xlink","xlink:show",s);break;case"xlinkTitle":ps(t,"http://www.w3.org/1999/xlink","xlink:title",s);break;case"xlinkType":ps(t,"http://www.w3.org/1999/xlink","xlink:type",s);break;case"xmlBase":ps(t,"http://www.w3.org/XML/1998/namespace","xml:base",s);break;case"xmlLang":ps(t,"http://www.w3.org/XML/1998/namespace","xml:lang",s);break;case"xmlSpace":ps(t,"http://www.w3.org/XML/1998/namespace","xml:space",s);break;case"is":uu(t,"is",s);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=M2.get(n)||n,uu(t,n,s))}}function Gm(t,e,n,s,i,r){switch(n){case"style":W_(t,s,r);break;case"dangerouslySetInnerHTML":if(s!=null){if(typeof s!="object"||!("__html"in s))throw Error(G(61));if(n=s.__html,n!=null){if(i.children!=null)throw Error(G(60));t.innerHTML=n}}break;case"children":typeof s=="string"?La(t,s):(typeof s=="number"||typeof s=="bigint")&&La(t,""+s);break;case"onScroll":s!=null&&ke("scroll",t);break;case"onScrollEnd":s!=null&&ke("scrollend",t);break;case"onClick":s!=null&&(t.onclick=Ns);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!$_.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(i=n.endsWith("Capture"),e=n.slice(2,i?n.length-7:void 0),r=t[rn]||null,r=r!=null?r[n]:null,typeof r=="function"&&t.removeEventListener(e,r,i),typeof s=="function")){typeof r!="function"&&r!==null&&(n in t?t[n]=null:t.hasAttribute(n)&&t.removeAttribute(n)),t.addEventListener(e,s,i);break e}n in t?t[n]=s:s===!0?t.setAttribute(n,""):uu(t,n,s)}}}function Bt(t,e,n){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ke("error",t),ke("load",t);var s=!1,i=!1,r;for(r in n)if(n.hasOwnProperty(r)){var a=n[r];if(a!=null)switch(r){case"src":s=!0;break;case"srcSet":i=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(G(137,e));default:Pe(t,e,r,a,n,null)}}i&&Pe(t,e,"srcSet",n.srcSet,n,null),s&&Pe(t,e,"src",n.src,n,null);return;case"input":ke("invalid",t);var l=r=a=i=null,c=null,u=null;for(s in n)if(n.hasOwnProperty(s)){var d=n[s];if(d!=null)switch(s){case"name":i=d;break;case"type":a=d;break;case"checked":c=d;break;case"defaultChecked":u=d;break;case"value":r=d;break;case"defaultValue":l=d;break;case"children":case"dangerouslySetInnerHTML":if(d!=null)throw Error(G(137,e));break;default:Pe(t,e,s,d,n,null)}}V_(t,r,l,c,u,a,i,!1);return;case"select":ke("invalid",t),s=a=r=null;for(i in n)if(n.hasOwnProperty(i)&&(l=n[i],l!=null))switch(i){case"value":r=l;break;case"defaultValue":a=l;break;case"multiple":s=l;default:Pe(t,e,i,l,n,null)}e=r,n=a,t.multiple=!!s,e!=null?_a(t,!!s,e,!1):n!=null&&_a(t,!!s,n,!0);return;case"textarea":ke("invalid",t),r=i=s=null;for(a in n)if(n.hasOwnProperty(a)&&(l=n[a],l!=null))switch(a){case"value":s=l;break;case"defaultValue":i=l;break;case"children":r=l;break;case"dangerouslySetInnerHTML":if(l!=null)throw Error(G(91));break;default:Pe(t,e,a,l,n,null)}Y_(t,s,i,r);return;case"option":for(c in n)if(n.hasOwnProperty(c)&&(s=n[c],s!=null))switch(c){case"selected":t.selected=s&&typeof s!="function"&&typeof s!="symbol";break;default:Pe(t,e,c,s,n,null)}return;case"dialog":ke("beforetoggle",t),ke("toggle",t),ke("cancel",t),ke("close",t);break;case"iframe":case"object":ke("load",t);break;case"video":case"audio":for(s=0;s<jl.length;s++)ke(jl[s],t);break;case"image":ke("error",t),ke("load",t);break;case"details":ke("toggle",t);break;case"embed":case"source":case"link":ke("error",t),ke("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&(s=n[u],s!=null))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(G(137,e));default:Pe(t,e,u,s,n,null)}return;default:if(o0(e)){for(d in n)n.hasOwnProperty(d)&&(s=n[d],s!==void 0&&Gm(t,e,d,s,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(s=n[l],s!=null&&Pe(t,e,l,s,n,null))}function oj(t,e,n,s){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,r=null,a=null,l=null,c=null,u=null,d=null;for(m in n){var f=n[m];if(n.hasOwnProperty(m)&&f!=null)switch(m){case"checked":break;case"value":break;case"defaultValue":c=f;default:s.hasOwnProperty(m)||Pe(t,e,m,null,s,f)}}for(var h in s){var m=s[h];if(f=n[h],s.hasOwnProperty(h)&&(m!=null||f!=null))switch(h){case"type":r=m;break;case"name":i=m;break;case"checked":u=m;break;case"defaultChecked":d=m;break;case"value":a=m;break;case"defaultValue":l=m;break;case"children":case"dangerouslySetInnerHTML":if(m!=null)throw Error(G(137,e));break;default:m!==f&&Pe(t,e,h,m,s,f)}}fm(t,a,l,c,u,d,r,i);return;case"select":m=a=l=h=null;for(r in n)if(c=n[r],n.hasOwnProperty(r)&&c!=null)switch(r){case"value":break;case"multiple":m=c;default:s.hasOwnProperty(r)||Pe(t,e,r,null,s,c)}for(i in s)if(r=s[i],c=n[i],s.hasOwnProperty(i)&&(r!=null||c!=null))switch(i){case"value":h=r;break;case"defaultValue":l=r;break;case"multiple":a=r;default:r!==c&&Pe(t,e,i,r,s,c)}e=l,n=a,s=m,h!=null?_a(t,!!n,h,!1):!!s!=!!n&&(e!=null?_a(t,!!n,e,!0):_a(t,!!n,n?[]:"",!1));return;case"textarea":m=h=null;for(l in n)if(i=n[l],n.hasOwnProperty(l)&&i!=null&&!s.hasOwnProperty(l))switch(l){case"value":break;case"children":break;default:Pe(t,e,l,null,s,i)}for(a in s)if(i=s[a],r=n[a],s.hasOwnProperty(a)&&(i!=null||r!=null))switch(a){case"value":h=i;break;case"defaultValue":m=i;break;case"children":break;case"dangerouslySetInnerHTML":if(i!=null)throw Error(G(91));break;default:i!==r&&Pe(t,e,a,i,s,r)}K_(t,h,m);return;case"option":for(var v in n)if(h=n[v],n.hasOwnProperty(v)&&h!=null&&!s.hasOwnProperty(v))switch(v){case"selected":t.selected=!1;break;default:Pe(t,e,v,null,s,h)}for(c in s)if(h=s[c],m=n[c],s.hasOwnProperty(c)&&h!==m&&(h!=null||m!=null))switch(c){case"selected":t.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:Pe(t,e,c,h,s,m)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var y in n)h=n[y],n.hasOwnProperty(y)&&h!=null&&!s.hasOwnProperty(y)&&Pe(t,e,y,null,s,h);for(u in s)if(h=s[u],m=n[u],s.hasOwnProperty(u)&&h!==m&&(h!=null||m!=null))switch(u){case"children":case"dangerouslySetInnerHTML":if(h!=null)throw Error(G(137,e));break;default:Pe(t,e,u,h,s,m)}return;default:if(o0(e)){for(var b in n)h=n[b],n.hasOwnProperty(b)&&h!==void 0&&!s.hasOwnProperty(b)&&Gm(t,e,b,void 0,s,h);for(d in s)h=s[d],m=n[d],!s.hasOwnProperty(d)||h===m||h===void 0&&m===void 0||Gm(t,e,d,h,s,m);return}}for(var g in n)h=n[g],n.hasOwnProperty(g)&&h!=null&&!s.hasOwnProperty(g)&&Pe(t,e,g,null,s,h);for(f in s)h=s[f],m=n[f],!s.hasOwnProperty(f)||h===m||h==null&&m==null||Pe(t,e,f,h,s,m)}function Kb(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function lj(){if(typeof performance.getEntriesByType=="function"){for(var t=0,e=0,n=performance.getEntriesByType("resource"),s=0;s<n.length;s++){var i=n[s],r=i.transferSize,a=i.initiatorType,l=i.duration;if(r&&l&&Kb(a)){for(a=0,l=i.responseEnd,s+=1;s<n.length;s++){var c=n[s],u=c.startTime;if(u>l)break;var d=c.transferSize,f=c.initiatorType;d&&Kb(f)&&(c=c.responseEnd,a+=d*(c<l?1:(l-u)/(c-u)))}if(--s,e+=8*(r+a)/(i.duration/1e3),t++,10<t)break}}if(0<t)return e/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var $m=null,Fm=null;function nd(t){return t.nodeType===9?t:t.ownerDocument}function Yb(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Jk(t,e){if(t===0)switch(e){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&e==="foreignObject"?0:t}function zm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.children=="bigint"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var wh=null;function cj(){var t=window.event;return t&&t.type==="popstate"?t===wh?!1:(wh=t,!0):(wh=null,!1)}var Zk=typeof setTimeout=="function"?setTimeout:void 0,uj=typeof clearTimeout=="function"?clearTimeout:void 0,Wb=typeof Promise=="function"?Promise:void 0,dj=typeof queueMicrotask=="function"?queueMicrotask:typeof Wb<"u"?function(t){return Wb.resolve(null).then(t).catch(fj)}:Zk;function fj(t){setTimeout(function(){throw t})}function Ki(t){return t==="head"}function qb(t,e){var n=e,s=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"||n==="/&"){if(s===0){t.removeChild(i),za(e);return}s--}else if(n==="$"||n==="$?"||n==="$~"||n==="$!"||n==="&")s++;else if(n==="html")ll(t.ownerDocument.documentElement);else if(n==="head"){n=t.ownerDocument.head,ll(n);for(var r=n.firstChild;r;){var a=r.nextSibling,l=r.nodeName;r[lc]||l==="SCRIPT"||l==="STYLE"||l==="LINK"&&r.rel.toLowerCase()==="stylesheet"||n.removeChild(r),r=a}}else n==="body"&&ll(t.ownerDocument.body);n=i}while(n);za(e)}function Xb(t,e){var n=t;t=0;do{var s=n.nextSibling;if(n.nodeType===1?e?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",n.getAttribute("style")===""&&n.removeAttribute("style")):n.nodeType===3&&(e?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(t===0)break;t--}else n!=="$"&&n!=="$?"&&n!=="$~"&&n!=="$!"||t++;n=s}while(n)}function Vm(t){var e=t.firstChild;for(e&&e.nodeType===10&&(e=e.nextSibling);e;){var n=e;switch(e=e.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":Vm(n),a0(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}t.removeChild(n)}}function hj(t,e,n,s){for(;t.nodeType===1;){var i=n;if(t.nodeName.toLowerCase()!==e.toLowerCase()){if(!s&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(s){if(!t[lc])switch(e){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(r=t.getAttribute("rel"),r==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(r!==i.rel||t.getAttribute("href")!==(i.href==null||i.href===""?null:i.href)||t.getAttribute("crossorigin")!==(i.crossOrigin==null?null:i.crossOrigin)||t.getAttribute("title")!==(i.title==null?null:i.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(r=t.getAttribute("src"),(r!==(i.src==null?null:i.src)||t.getAttribute("type")!==(i.type==null?null:i.type)||t.getAttribute("crossorigin")!==(i.crossOrigin==null?null:i.crossOrigin))&&r&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(e==="input"&&t.type==="hidden"){var r=i.name==null?null:""+i.name;if(i.type==="hidden"&&t.getAttribute("name")===r)return t}else return t;if(t=Dn(t.nextSibling),t===null)break}return null}function mj(t,e,n){if(e==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!n||(t=Dn(t.nextSibling),t===null))return null;return t}function eN(t,e){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!e||(t=Dn(t.nextSibling),t===null))return null;return t}function Km(t){return t.data==="$?"||t.data==="$~"}function Ym(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function pj(t,e){var n=t.ownerDocument;if(t.data==="$~")t._reactRetry=e;else if(t.data!=="$?"||n.readyState!=="loading")e();else{var s=function(){e(),n.removeEventListener("DOMContentLoaded",s)};n.addEventListener("DOMContentLoaded",s),t._reactRetry=s}}function Dn(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?"||e==="$~"||e==="&"||e==="F!"||e==="F")break;if(e==="/$"||e==="/&")return null}}return t}var Wm=null;function Qb(t){t=t.nextSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"||n==="/&"){if(e===0)return Dn(t.nextSibling);e--}else n!=="$"&&n!=="$!"&&n!=="$?"&&n!=="$~"&&n!=="&"||e++}t=t.nextSibling}return null}function Jb(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"){if(e===0)return t;e--}else n!=="/$"&&n!=="/&"||e++}t=t.previousSibling}return null}function tN(t,e,n){switch(e=nd(n),t){case"html":if(t=e.documentElement,!t)throw Error(G(452));return t;case"head":if(t=e.head,!t)throw Error(G(453));return t;case"body":if(t=e.body,!t)throw Error(G(454));return t;default:throw Error(G(451))}}function ll(t){for(var e=t.attributes;e.length;)t.removeAttributeNode(e[0]);a0(t)}var Un=new Map,Zb=new Set;function sd(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var Ys=Ie.d;Ie.d={f:gj,r:xj,D:bj,C:vj,L:yj,m:_j,X:kj,S:wj,M:Nj};function gj(){var t=Ys.f(),e=of();return t||e}function xj(t){var e=ro(t);e!==null&&e.tag===5&&e.type==="form"?Ww(e):Ys.r(t)}var co=typeof document>"u"?null:document;function nN(t,e,n){var s=co;if(s&&typeof e=="string"&&e){var i=Rn(e);i='link[rel="'+t+'"][href="'+i+'"]',typeof n=="string"&&(i+='[crossorigin="'+n+'"]'),Zb.has(i)||(Zb.add(i),t={rel:t,crossOrigin:n,href:e},s.querySelector(i)===null&&(e=s.createElement("link"),Bt(e,"link",t),Tt(e),s.head.appendChild(e)))}}function bj(t){Ys.D(t),nN("dns-prefetch",t,null)}function vj(t,e){Ys.C(t,e),nN("preconnect",t,e)}function yj(t,e,n){Ys.L(t,e,n);var s=co;if(s&&t&&e){var i='link[rel="preload"][as="'+Rn(e)+'"]';e==="image"&&n&&n.imageSrcSet?(i+='[imagesrcset="'+Rn(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(i+='[imagesizes="'+Rn(n.imageSizes)+'"]')):i+='[href="'+Rn(t)+'"]';var r=i;switch(e){case"style":r=Fa(t);break;case"script":r=uo(t)}Un.has(r)||(t=Je({rel:"preload",href:e==="image"&&n&&n.imageSrcSet?void 0:t,as:e},n),Un.set(r,t),s.querySelector(i)!==null||e==="style"&&s.querySelector(mc(r))||e==="script"&&s.querySelector(pc(r))||(e=s.createElement("link"),Bt(e,"link",t),Tt(e),s.head.appendChild(e)))}}function _j(t,e){Ys.m(t,e);var n=co;if(n&&t){var s=e&&typeof e.as=="string"?e.as:"script",i='link[rel="modulepreload"][as="'+Rn(s)+'"][href="'+Rn(t)+'"]',r=i;switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":r=uo(t)}if(!Un.has(r)&&(t=Je({rel:"modulepreload",href:t},e),Un.set(r,t),n.querySelector(i)===null)){switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(pc(r)))return}s=n.createElement("link"),Bt(s,"link",t),Tt(s),n.head.appendChild(s)}}}function wj(t,e,n){Ys.S(t,e,n);var s=co;if(s&&t){var i=ya(s).hoistableStyles,r=Fa(t);e=e||"default";var a=i.get(r);if(!a){var l={loading:0,preload:null};if(a=s.querySelector(mc(r)))l.loading=5;else{t=Je({rel:"stylesheet",href:t,"data-precedence":e},n),(n=Un.get(r))&&V0(t,n);var c=a=s.createElement("link");Tt(c),Bt(c,"link",t),c._p=new Promise(function(u,d){c.onload=u,c.onerror=d}),c.addEventListener("load",function(){l.loading|=1}),c.addEventListener("error",function(){l.loading|=2}),l.loading|=4,_u(a,e,s)}a={type:"stylesheet",instance:a,count:1,state:l},i.set(r,a)}}}function kj(t,e){Ys.X(t,e);var n=co;if(n&&t){var s=ya(n).hoistableScripts,i=uo(t),r=s.get(i);r||(r=n.querySelector(pc(i)),r||(t=Je({src:t,async:!0},e),(e=Un.get(i))&&K0(t,e),r=n.createElement("script"),Tt(r),Bt(r,"link",t),n.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},s.set(i,r))}}function Nj(t,e){Ys.M(t,e);var n=co;if(n&&t){var s=ya(n).hoistableScripts,i=uo(t),r=s.get(i);r||(r=n.querySelector(pc(i)),r||(t=Je({src:t,async:!0,type:"module"},e),(e=Un.get(i))&&K0(t,e),r=n.createElement("script"),Tt(r),Bt(r,"link",t),n.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},s.set(i,r))}}function ev(t,e,n,s){var i=(i=bi.current)?sd(i):null;if(!i)throw Error(G(446));switch(t){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(e=Fa(n.href),n=ya(i).hoistableStyles,s=n.get(e),s||(s={type:"style",instance:null,count:0,state:null},n.set(e,s)),s):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){t=Fa(n.href);var r=ya(i).hoistableStyles,a=r.get(t);if(a||(i=i.ownerDocument||i,a={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},r.set(t,a),(r=i.querySelector(mc(t)))&&!r._p&&(a.instance=r,a.state.loading=5),Un.has(t)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Un.set(t,n),r||Sj(i,t,n,a.state))),e&&s===null)throw Error(G(528,""));return a}if(e&&s!==null)throw Error(G(529,""));return null;case"script":return e=n.async,n=n.src,typeof n=="string"&&e&&typeof e!="function"&&typeof e!="symbol"?(e=uo(n),n=ya(i).hoistableScripts,s=n.get(e),s||(s={type:"script",instance:null,count:0,state:null},n.set(e,s)),s):{type:"void",instance:null,count:0,state:null};default:throw Error(G(444,t))}}function Fa(t){return'href="'+Rn(t)+'"'}function mc(t){return'link[rel="stylesheet"]['+t+"]"}function sN(t){return Je({},t,{"data-precedence":t.precedence,precedence:null})}function Sj(t,e,n,s){t.querySelector('link[rel="preload"][as="style"]['+e+"]")?s.loading=1:(e=t.createElement("link"),s.preload=e,e.addEventListener("load",function(){return s.loading|=1}),e.addEventListener("error",function(){return s.loading|=2}),Bt(e,"link",n),Tt(e),t.head.appendChild(e))}function uo(t){return'[src="'+Rn(t)+'"]'}function pc(t){return"script[async]"+t}function tv(t,e,n){if(e.count++,e.instance===null)switch(e.type){case"style":var s=t.querySelector('style[data-href~="'+Rn(n.href)+'"]');if(s)return e.instance=s,Tt(s),s;var i=Je({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return s=(t.ownerDocument||t).createElement("style"),Tt(s),Bt(s,"style",i),_u(s,n.precedence,t),e.instance=s;case"stylesheet":i=Fa(n.href);var r=t.querySelector(mc(i));if(r)return e.state.loading|=4,e.instance=r,Tt(r),r;s=sN(n),(i=Un.get(i))&&V0(s,i),r=(t.ownerDocument||t).createElement("link"),Tt(r);var a=r;return a._p=new Promise(function(l,c){a.onload=l,a.onerror=c}),Bt(r,"link",s),e.state.loading|=4,_u(r,n.precedence,t),e.instance=r;case"script":return r=uo(n.src),(i=t.querySelector(pc(r)))?(e.instance=i,Tt(i),i):(s=n,(i=Un.get(r))&&(s=Je({},n),K0(s,i)),t=t.ownerDocument||t,i=t.createElement("script"),Tt(i),Bt(i,"link",s),t.head.appendChild(i),e.instance=i);case"void":return null;default:throw Error(G(443,e.type))}else e.type==="stylesheet"&&!(e.state.loading&4)&&(s=e.instance,e.state.loading|=4,_u(s,n.precedence,t));return e.instance}function _u(t,e,n){for(var s=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),i=s.length?s[s.length-1]:null,r=i,a=0;a<s.length;a++){var l=s[a];if(l.dataset.precedence===e)r=l;else if(r!==i)break}r?r.parentNode.insertBefore(t,r.nextSibling):(e=n.nodeType===9?n.head:n,e.insertBefore(t,e.firstChild))}function V0(t,e){t.crossOrigin==null&&(t.crossOrigin=e.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=e.referrerPolicy),t.title==null&&(t.title=e.title)}function K0(t,e){t.crossOrigin==null&&(t.crossOrigin=e.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=e.referrerPolicy),t.integrity==null&&(t.integrity=e.integrity)}var wu=null;function nv(t,e,n){if(wu===null){var s=new Map,i=wu=new Map;i.set(n,s)}else i=wu,s=i.get(n),s||(s=new Map,i.set(n,s));if(s.has(t))return s;for(s.set(t,null),n=n.getElementsByTagName(t),i=0;i<n.length;i++){var r=n[i];if(!(r[lc]||r[Mt]||t==="link"&&r.getAttribute("rel")==="stylesheet")&&r.namespaceURI!=="http://www.w3.org/2000/svg"){var a=r.getAttribute(e)||"";a=t+a;var l=s.get(a);l?l.push(r):s.set(a,[r])}}return s}function sv(t,e,n){t=t.ownerDocument||t,t.head.insertBefore(n,e==="title"?t.querySelector("head > title"):null)}function Ej(t,e,n){if(n===1||e.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof e.precedence!="string"||typeof e.href!="string"||e.href==="")break;return!0;case"link":if(typeof e.rel!="string"||typeof e.href!="string"||e.href===""||e.onLoad||e.onError)break;switch(e.rel){case"stylesheet":return t=e.disabled,typeof e.precedence=="string"&&t==null;default:return!0}case"script":if(e.async&&typeof e.async!="function"&&typeof e.async!="symbol"&&!e.onLoad&&!e.onError&&e.src&&typeof e.src=="string")return!0}return!1}function iN(t){return!(t.type==="stylesheet"&&!(t.state.loading&3))}function Tj(t,e,n,s){if(n.type==="stylesheet"&&(typeof s.media!="string"||matchMedia(s.media).matches!==!1)&&!(n.state.loading&4)){if(n.instance===null){var i=Fa(s.href),r=e.querySelector(mc(i));if(r){e=r._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(t.count++,t=id.bind(t),e.then(t,t)),n.state.loading|=4,n.instance=r,Tt(r);return}r=e.ownerDocument||e,s=sN(s),(i=Un.get(i))&&V0(s,i),r=r.createElement("link"),Tt(r);var a=r;a._p=new Promise(function(l,c){a.onload=l,a.onerror=c}),Bt(r,"link",s),n.instance=r}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(n,e),(e=n.state.preload)&&!(n.state.loading&3)&&(t.count++,n=id.bind(t),e.addEventListener("load",n),e.addEventListener("error",n))}}var kh=0;function Aj(t,e){return t.stylesheets&&t.count===0&&ku(t,t.stylesheets),0<t.count||0<t.imgCount?function(n){var s=setTimeout(function(){if(t.stylesheets&&ku(t,t.stylesheets),t.unsuspend){var r=t.unsuspend;t.unsuspend=null,r()}},6e4+e);0<t.imgBytes&&kh===0&&(kh=62500*lj());var i=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&ku(t,t.stylesheets),t.unsuspend)){var r=t.unsuspend;t.unsuspend=null,r()}},(t.imgBytes>kh?50:800)+e);return t.unsuspend=n,function(){t.unsuspend=null,clearTimeout(s),clearTimeout(i)}}:null}function id(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)ku(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var rd=null;function ku(t,e){t.stylesheets=null,t.unsuspend!==null&&(t.count++,rd=new Map,e.forEach(jj,t),rd=null,id.call(t))}function jj(t,e){if(!(e.state.loading&4)){var n=rd.get(t);if(n)var s=n.get(null);else{n=new Map,rd.set(t,n);for(var i=t.querySelectorAll("link[data-precedence],style[data-precedence]"),r=0;r<i.length;r++){var a=i[r];(a.nodeName==="LINK"||a.getAttribute("media")!=="not all")&&(n.set(a.dataset.precedence,a),s=a)}s&&n.set(null,s)}i=e.instance,a=i.getAttribute("data-precedence"),r=n.get(a)||s,r===s&&n.set(null,i),n.set(a,i),this.count++,s=id.bind(this),i.addEventListener("load",s),i.addEventListener("error",s),r?r.parentNode.insertBefore(i,r.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(i,t.firstChild)),e.state.loading|=4}}var Il={$$typeof:ks,Provider:null,Consumer:null,_currentValue:hr,_currentValue2:hr,_threadCount:0};function Rj(t,e,n,s,i,r,a,l,c){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Kf(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Kf(0),this.hiddenUpdates=Kf(null),this.identifierPrefix=s,this.onUncaughtError=i,this.onCaughtError=r,this.onRecoverableError=a,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=c,this.incompleteTransitions=new Map}function rN(t,e,n,s,i,r,a,l,c,u,d,f){return t=new Rj(t,e,n,a,c,u,d,f,l),e=1,r===!0&&(e|=24),r=un(3,null,null,e),t.current=r,r.stateNode=t,e=b0(),e.refCount++,t.pooledCache=e,e.refCount++,r.memoizedState={element:s,isDehydrated:n,cache:e},_0(r),t}function aN(t){return t?(t=la,t):la}function oN(t,e,n,s,i,r){i=aN(i),s.context===null?s.context=i:s.pendingContext=i,s=yi(e),s.payload={element:n},r=r===void 0?null:r,r!==null&&(s.callback=r),n=_i(t,s,e),n!==null&&(sn(n,t,e),el(n,t,e))}function iv(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Y0(t,e){iv(t,e),(t=t.alternate)&&iv(t,e)}function lN(t){if(t.tag===13||t.tag===31){var e=Ur(t,67108864);e!==null&&sn(e,t,67108864),Y0(t,67108864)}}function rv(t){if(t.tag===13||t.tag===31){var e=gn();e=i0(e);var n=Ur(t,e);n!==null&&sn(n,t,e),Y0(t,e)}}var ad=!0;function Ij(t,e,n,s){var i=le.T;le.T=null;var r=Ie.p;try{Ie.p=2,W0(t,e,n,s)}finally{Ie.p=r,le.T=i}}function Cj(t,e,n,s){var i=le.T;le.T=null;var r=Ie.p;try{Ie.p=8,W0(t,e,n,s)}finally{Ie.p=r,le.T=i}}function W0(t,e,n,s){if(ad){var i=qm(s);if(i===null)_h(t,e,s,od,n),av(t,s);else if(Mj(i,t,e,n,s))s.stopPropagation();else if(av(t,s),e&4&&-1<Oj.indexOf(t)){for(;i!==null;){var r=ro(i);if(r!==null)switch(r.tag){case 3:if(r=r.stateNode,r.current.memoizedState.isDehydrated){var a=sr(r.pendingLanes);if(a!==0){var l=r;for(l.pendingLanes|=2,l.entangledLanes|=2;a;){var c=1<<31-pn(a);l.entanglements[1]|=c,a&=~c}fs(r),!(Re&6)&&(Xu=hn()+500,hc(0))}}break;case 31:case 13:l=Ur(r,2),l!==null&&sn(l,r,2),of(),Y0(r,2)}if(r=qm(s),r===null&&_h(t,e,s,od,n),r===i)break;i=r}i!==null&&s.stopPropagation()}else _h(t,e,s,null,n)}}function qm(t){return t=l0(t),q0(t)}var od=null;function q0(t){if(od=null,t=na(t),t!==null){var e=ic(t);if(e===null)t=null;else{var n=e.tag;if(n===13){if(t=A_(e),t!==null)return t;t=null}else if(n===31){if(t=j_(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null)}}return od=t,null}function cN(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(b2()){case O_:return 2;case M_:return 8;case Lu:case v2:return 32;case D_:return 268435456;default:return 32}default:return 32}}var Xm=!1,Ni=null,Si=null,Ei=null,Cl=new Map,Ol=new Map,ri=[],Oj="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function av(t,e){switch(t){case"focusin":case"focusout":Ni=null;break;case"dragenter":case"dragleave":Si=null;break;case"mouseover":case"mouseout":Ei=null;break;case"pointerover":case"pointerout":Cl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ol.delete(e.pointerId)}}function Co(t,e,n,s,i,r){return t===null||t.nativeEvent!==r?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:r,targetContainers:[i]},e!==null&&(e=ro(e),e!==null&&lN(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function Mj(t,e,n,s,i){switch(e){case"focusin":return Ni=Co(Ni,t,e,n,s,i),!0;case"dragenter":return Si=Co(Si,t,e,n,s,i),!0;case"mouseover":return Ei=Co(Ei,t,e,n,s,i),!0;case"pointerover":var r=i.pointerId;return Cl.set(r,Co(Cl.get(r)||null,t,e,n,s,i)),!0;case"gotpointercapture":return r=i.pointerId,Ol.set(r,Co(Ol.get(r)||null,t,e,n,s,i)),!0}return!1}function uN(t){var e=na(t.target);if(e!==null){var n=ic(e);if(n!==null){if(e=n.tag,e===13){if(e=A_(n),e!==null){t.blockedOn=e,zx(t.priority,function(){rv(n)});return}}else if(e===31){if(e=j_(n),e!==null){t.blockedOn=e,zx(t.priority,function(){rv(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Nu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=qm(t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);mm=s,n.target.dispatchEvent(s),mm=null}else return e=ro(n),e!==null&&lN(e),t.blockedOn=n,!1;e.shift()}return!0}function ov(t,e,n){Nu(t)&&n.delete(e)}function Dj(){Xm=!1,Ni!==null&&Nu(Ni)&&(Ni=null),Si!==null&&Nu(Si)&&(Si=null),Ei!==null&&Nu(Ei)&&(Ei=null),Cl.forEach(ov),Ol.forEach(ov)}function Qc(t,e){t.blockedOn===e&&(t.blockedOn=null,Xm||(Xm=!0,kt.unstable_scheduleCallback(kt.unstable_NormalPriority,Dj)))}var Jc=null;function lv(t){Jc!==t&&(Jc=t,kt.unstable_scheduleCallback(kt.unstable_NormalPriority,function(){Jc===t&&(Jc=null);for(var e=0;e<t.length;e+=3){var n=t[e],s=t[e+1],i=t[e+2];if(typeof s!="function"){if(q0(s||n)===null)continue;break}var r=ro(n);r!==null&&(t.splice(e,3),e-=3,Rm(r,{pending:!0,data:i,method:n.method,action:s},s,i))}}))}function za(t){function e(c){return Qc(c,t)}Ni!==null&&Qc(Ni,t),Si!==null&&Qc(Si,t),Ei!==null&&Qc(Ei,t),Cl.forEach(e),Ol.forEach(e);for(var n=0;n<ri.length;n++){var s=ri[n];s.blockedOn===t&&(s.blockedOn=null)}for(;0<ri.length&&(n=ri[0],n.blockedOn===null);)uN(n),n.blockedOn===null&&ri.shift();if(n=(t.ownerDocument||t).$$reactFormReplay,n!=null)for(s=0;s<n.length;s+=3){var i=n[s],r=n[s+1],a=i[rn]||null;if(typeof r=="function")a||lv(n);else if(a){var l=null;if(r&&r.hasAttribute("formAction")){if(i=r,a=r[rn]||null)l=a.formAction;else if(q0(i)!==null)continue}else l=a.action;typeof l=="function"?n[s+1]=l:(n.splice(s,3),s-=3),lv(n)}}}function dN(){function t(r){r.canIntercept&&r.info==="react-transition"&&r.intercept({handler:function(){return new Promise(function(a){return i=a})},focusReset:"manual",scroll:"manual"})}function e(){i!==null&&(i(),i=null),s||setTimeout(n,20)}function n(){if(!s&&!navigation.transition){var r=navigation.currentEntry;r&&r.url!=null&&navigation.navigate(r.url,{state:r.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var s=!1,i=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",e),navigation.addEventListener("navigateerror",e),setTimeout(n,100),function(){s=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",e),navigation.removeEventListener("navigateerror",e),i!==null&&(i(),i=null)}}}function X0(t){this._internalRoot=t}uf.prototype.render=X0.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(G(409));var n=e.current,s=gn();oN(n,s,t,e,null,null)};uf.prototype.unmount=X0.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;oN(t.current,2,null,t,null,null),of(),e[io]=null}};function uf(t){this._internalRoot=t}uf.prototype.unstable_scheduleHydration=function(t){if(t){var e=H_();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ri.length&&e!==0&&e<ri[n].priority;n++);ri.splice(n,0,t),n===0&&uN(t)}};var cv=E_.version;if(cv!=="19.2.3")throw Error(G(527,cv,"19.2.3"));Ie.findDOMNode=function(t){var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(G(188)):(t=Object.keys(t).join(","),Error(G(268,t)));return t=d2(e),t=t!==null?R_(t):null,t=t===null?null:t.stateNode,t};var Lj={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:le,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Zc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zc.isDisabled&&Zc.supportsFiber)try{rc=Zc.inject(Lj),mn=Zc}catch{}}Kd.createRoot=function(t,e){if(!T_(t))throw Error(G(299));var n=!1,s="",i=nk,r=sk,a=ik;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onUncaughtError!==void 0&&(i=e.onUncaughtError),e.onCaughtError!==void 0&&(r=e.onCaughtError),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=rN(t,1,!1,null,null,n,s,null,i,r,a,dN),t[io]=e.current,z0(t),new X0(e)};Kd.hydrateRoot=function(t,e,n){if(!T_(t))throw Error(G(299));var s=!1,i="",r=nk,a=sk,l=ik,c=null;return n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onUncaughtError!==void 0&&(r=n.onUncaughtError),n.onCaughtError!==void 0&&(a=n.onCaughtError),n.onRecoverableError!==void 0&&(l=n.onRecoverableError),n.formState!==void 0&&(c=n.formState)),e=rN(t,1,!0,e,n??null,s,i,c,r,a,l,dN),e.context=aN(null),n=e.current,s=gn(),s=i0(s),i=yi(s),i.callback=null,_i(n,i,s),n=s,e.current.lanes=n,oc(e,n),fs(e),t[io]=e.current,z0(t),new uf(e)};Kd.version="19.2.3";function fN(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(fN)}catch(t){console.error(t)}}fN(),y_.exports=Kd;var Pj=y_.exports;const Bj=u_(Pj);/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ml(){return Ml=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Ml.apply(this,arguments)}var pi;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(pi||(pi={}));const uv="popstate";function Uj(t){t===void 0&&(t={});function e(s,i){let{pathname:r,search:a,hash:l}=s.location;return Qm("",{pathname:r,search:a,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(s,i){return typeof i=="string"?i:hN(i)}return Gj(e,n,null,t)}function bt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Q0(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Hj(){return Math.random().toString(36).substr(2,8)}function dv(t,e){return{usr:t.state,key:t.key,idx:e}}function Qm(t,e,n,s){return n===void 0&&(n=null),Ml({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?fo(e):e,{state:n,key:e&&e.key||s||Hj()})}function hN(t){let{pathname:e="/",search:n="",hash:s=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function fo(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function Gj(t,e,n,s){s===void 0&&(s={});let{window:i=document.defaultView,v5Compat:r=!1}=s,a=i.history,l=pi.Pop,c=null,u=d();u==null&&(u=0,a.replaceState(Ml({},a.state,{idx:u}),""));function d(){return(a.state||{idx:null}).idx}function f(){l=pi.Pop;let b=d(),g=b==null?null:b-u;u=b,c&&c({action:l,location:y.location,delta:g})}function h(b,g){l=pi.Push;let p=Qm(y.location,b,g);u=d()+1;let x=dv(p,u),w=y.createHref(p);try{a.pushState(x,"",w)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;i.location.assign(w)}r&&c&&c({action:l,location:y.location,delta:1})}function m(b,g){l=pi.Replace;let p=Qm(y.location,b,g);u=d();let x=dv(p,u),w=y.createHref(p);a.replaceState(x,"",w),r&&c&&c({action:l,location:y.location,delta:0})}function v(b){let g=i.location.origin!=="null"?i.location.origin:i.location.href,p=typeof b=="string"?b:hN(b);return p=p.replace(/ $/,"%20"),bt(g,"No window.location.(origin|href) available to create URL for href: "+p),new URL(p,g)}let y={get action(){return l},get location(){return t(i,a)},listen(b){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(uv,f),c=b,()=>{i.removeEventListener(uv,f),c=null}},createHref(b){return e(i,b)},createURL:v,encodeLocation(b){let g=v(b);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:h,replace:m,go(b){return a.go(b)}};return y}var fv;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(fv||(fv={}));function $j(t,e,n){return n===void 0&&(n="/"),Fj(t,e,n)}function Fj(t,e,n,s){let i=typeof e=="string"?fo(e):e,r=gN(i.pathname||"/",n);if(r==null)return null;let a=mN(t);zj(a);let l=null;for(let c=0;l==null&&c<a.length;++c){let u=nR(r);l=Zj(a[c],u)}return l}function mN(t,e,n,s){e===void 0&&(e=[]),n===void 0&&(n=[]),s===void 0&&(s="");let i=(r,a,l)=>{let c={relativePath:l===void 0?r.path||"":l,caseSensitive:r.caseSensitive===!0,childrenIndex:a,route:r};c.relativePath.startsWith("/")&&(bt(c.relativePath.startsWith(s),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(s.length));let u=br([s,c.relativePath]),d=n.concat(c);r.children&&r.children.length>0&&(bt(r.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),mN(r.children,e,d,u)),!(r.path==null&&!r.index)&&e.push({path:u,score:Qj(u,r.index),routesMeta:d})};return t.forEach((r,a)=>{var l;if(r.path===""||!((l=r.path)!=null&&l.includes("?")))i(r,a);else for(let c of pN(r.path))i(r,a,c)}),e}function pN(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,i=n.endsWith("?"),r=n.replace(/\?$/,"");if(s.length===0)return i?[r,""]:[r];let a=pN(s.join("/")),l=[];return l.push(...a.map(c=>c===""?r:[r,c].join("/"))),i&&l.push(...a),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function zj(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:Jj(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const Vj=/^:[\w-]+$/,Kj=3,Yj=2,Wj=1,qj=10,Xj=-2,hv=t=>t==="*";function Qj(t,e){let n=t.split("/"),s=n.length;return n.some(hv)&&(s+=Xj),e&&(s+=Yj),n.filter(i=>!hv(i)).reduce((i,r)=>i+(Vj.test(r)?Kj:r===""?Wj:qj),s)}function Jj(t,e){return t.length===e.length&&t.slice(0,-1).every((s,i)=>s===e[i])?t[t.length-1]-e[e.length-1]:0}function Zj(t,e,n){let{routesMeta:s}=t,i={},r="/",a=[];for(let l=0;l<s.length;++l){let c=s[l],u=l===s.length-1,d=r==="/"?e:e.slice(r.length)||"/",f=eR({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),h=c.route;if(!f)return null;Object.assign(i,f.params),a.push({params:i,pathname:br([r,f.pathname]),pathnameBase:oR(br([r,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(r=br([r,f.pathnameBase]))}return a}function eR(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=tR(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let r=i[0],a=r.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:s.reduce((u,d,f)=>{let{paramName:h,isOptional:m}=d;if(h==="*"){let y=l[f]||"";a=r.slice(0,r.length-y.length).replace(/(.)\/+$/,"$1")}const v=l[f];return m&&!v?u[h]=void 0:u[h]=(v||"").replace(/%2F/g,"/"),u},{}),pathname:r,pathnameBase:a,pattern:t}}function tR(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Q0(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,l,c)=>(s.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),s]}function nR(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Q0(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function gN(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}const sR=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,iR=t=>sR.test(t);function rR(t,e){e===void 0&&(e="/");let{pathname:n,search:s="",hash:i=""}=typeof t=="string"?fo(t):t,r;if(n)if(iR(n))r=n;else{if(n.includes("//")){let a=n;n=n.replace(/\/\/+/g,"/"),Q0(!1,"Pathnames cannot have embedded double slashes - normalizing "+(a+" -> "+n))}n.startsWith("/")?r=mv(n.substring(1),"/"):r=mv(n,e)}else r=e;return{pathname:r,search:lR(s),hash:cR(i)}}function mv(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function Nh(t,e,n,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function aR(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function xN(t,e){let n=aR(t);return e?n.map((s,i)=>i===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function bN(t,e,n,s){s===void 0&&(s=!1);let i;typeof t=="string"?i=fo(t):(i=Ml({},t),bt(!i.pathname||!i.pathname.includes("?"),Nh("?","pathname","search",i)),bt(!i.pathname||!i.pathname.includes("#"),Nh("#","pathname","hash",i)),bt(!i.search||!i.search.includes("#"),Nh("#","search","hash",i)));let r=t===""||i.pathname==="",a=r?"/":i.pathname,l;if(a==null)l=n;else{let f=e.length-1;if(!s&&a.startsWith("..")){let h=a.split("/");for(;h[0]==="..";)h.shift(),f-=1;i.pathname=h.join("/")}l=f>=0?e[f]:"/"}let c=rR(i,l),u=a&&a!=="/"&&a.endsWith("/"),d=(r||a===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const br=t=>t.join("/").replace(/\/\/+/g,"/"),oR=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),lR=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,cR=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function uR(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const vN=["post","put","patch","delete"];new Set(vN);const dR=["get",...vN];new Set(dR);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Dl(){return Dl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Dl.apply(this,arguments)}const J0=_.createContext(null),fR=_.createContext(null),gc=_.createContext(null),df=_.createContext(null),Yi=_.createContext({outlet:null,matches:[],isDataRoute:!1}),yN=_.createContext(null);function xc(){return _.useContext(df)!=null}function ff(){return xc()||bt(!1),_.useContext(df).location}function _N(t){_.useContext(gc).static||_.useLayoutEffect(t)}function ho(){let{isDataRoute:t}=_.useContext(Yi);return t?SR():hR()}function hR(){xc()||bt(!1);let t=_.useContext(J0),{basename:e,future:n,navigator:s}=_.useContext(gc),{matches:i}=_.useContext(Yi),{pathname:r}=ff(),a=JSON.stringify(xN(i,n.v7_relativeSplatPath)),l=_.useRef(!1);return _N(()=>{l.current=!0}),_.useCallback(function(u,d){if(d===void 0&&(d={}),!l.current)return;if(typeof u=="number"){s.go(u);return}let f=bN(u,JSON.parse(a),r,d.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:br([e,f.pathname])),(d.replace?s.replace:s.push)(f,d.state,d)},[e,s,a,r,t])}function wN(){let{matches:t}=_.useContext(Yi),e=t[t.length-1];return e?e.params:{}}function mR(t,e){return pR(t,e)}function pR(t,e,n,s){xc()||bt(!1);let{navigator:i}=_.useContext(gc),{matches:r}=_.useContext(Yi),a=r[r.length-1],l=a?a.params:{};a&&a.pathname;let c=a?a.pathnameBase:"/";a&&a.route;let u=ff(),d;if(e){var f;let b=typeof e=="string"?fo(e):e;c==="/"||(f=b.pathname)!=null&&f.startsWith(c)||bt(!1),d=b}else d=u;let h=d.pathname||"/",m=h;if(c!=="/"){let b=c.replace(/^\//,"").split("/");m="/"+h.replace(/^\//,"").split("/").slice(b.length).join("/")}let v=$j(t,{pathname:m}),y=yR(v&&v.map(b=>Object.assign({},b,{params:Object.assign({},l,b.params),pathname:br([c,i.encodeLocation?i.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?c:br([c,i.encodeLocation?i.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),r,n,s);return e&&y?_.createElement(df.Provider,{value:{location:Dl({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:pi.Pop}},y):y}function gR(){let t=NR(),e=uR(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return _.createElement(_.Fragment,null,_.createElement("h2",null,"Unexpected Application Error!"),_.createElement("h3",{style:{fontStyle:"italic"}},e),n?_.createElement("pre",{style:i},n):null,null)}const xR=_.createElement(gR,null);class bR extends _.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?_.createElement(Yi.Provider,{value:this.props.routeContext},_.createElement(yN.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function vR(t){let{routeContext:e,match:n,children:s}=t,i=_.useContext(J0);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),_.createElement(Yi.Provider,{value:e},s)}function yR(t,e,n,s){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),s===void 0&&(s=null),t==null){var r;if(!n)return null;if(n.errors)t=n.matches;else if((r=s)!=null&&r.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let a=t,l=(i=n)==null?void 0:i.errors;if(l!=null){let d=a.findIndex(f=>f.route.id&&(l==null?void 0:l[f.route.id])!==void 0);d>=0||bt(!1),a=a.slice(0,Math.min(a.length,d+1))}let c=!1,u=-1;if(n&&s&&s.v7_partialHydration)for(let d=0;d<a.length;d++){let f=a[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=d),f.route.id){let{loaderData:h,errors:m}=n,v=f.route.loader&&h[f.route.id]===void 0&&(!m||m[f.route.id]===void 0);if(f.route.lazy||v){c=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((d,f,h)=>{let m,v=!1,y=null,b=null;n&&(m=l&&f.route.id?l[f.route.id]:void 0,y=f.route.errorElement||xR,c&&(u<0&&h===0?(ER("route-fallback"),v=!0,b=null):u===h&&(v=!0,b=f.route.hydrateFallbackElement||null)));let g=e.concat(a.slice(0,h+1)),p=()=>{let x;return m?x=y:v?x=b:f.route.Component?x=_.createElement(f.route.Component,null):f.route.element?x=f.route.element:x=d,_.createElement(vR,{match:f,routeContext:{outlet:d,matches:g,isDataRoute:n!=null},children:x})};return n&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?_.createElement(bR,{location:n.location,revalidation:n.revalidation,component:y,error:m,children:p(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):p()},null)}var kN=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(kN||{}),NN=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(NN||{});function _R(t){let e=_.useContext(J0);return e||bt(!1),e}function wR(t){let e=_.useContext(fR);return e||bt(!1),e}function kR(t){let e=_.useContext(Yi);return e||bt(!1),e}function SN(t){let e=kR(),n=e.matches[e.matches.length-1];return n.route.id||bt(!1),n.route.id}function NR(){var t;let e=_.useContext(yN),n=wR(),s=SN();return e!==void 0?e:(t=n.errors)==null?void 0:t[s]}function SR(){let{router:t}=_R(kN.UseNavigateStable),e=SN(NN.UseNavigateStable),n=_.useRef(!1);return _N(()=>{n.current=!0}),_.useCallback(function(i,r){r===void 0&&(r={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Dl({fromRouteId:e},r)))},[t,e])}const pv={};function ER(t,e,n){pv[t]||(pv[t]=!0)}function TR(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function AR(t){let{to:e,replace:n,state:s,relative:i}=t;xc()||bt(!1);let{future:r,static:a}=_.useContext(gc),{matches:l}=_.useContext(Yi),{pathname:c}=ff(),u=ho(),d=bN(e,xN(l,r.v7_relativeSplatPath),c,i==="path"),f=JSON.stringify(d);return _.useEffect(()=>u(JSON.parse(f),{replace:n,state:s,relative:i}),[u,f,i,n,s]),null}function Fo(t){bt(!1)}function jR(t){let{basename:e="/",children:n=null,location:s,navigationType:i=pi.Pop,navigator:r,static:a=!1,future:l}=t;xc()&&bt(!1);let c=e.replace(/^\/*/,"/"),u=_.useMemo(()=>({basename:c,navigator:r,static:a,future:Dl({v7_relativeSplatPath:!1},l)}),[c,l,r,a]);typeof s=="string"&&(s=fo(s));let{pathname:d="/",search:f="",hash:h="",state:m=null,key:v="default"}=s,y=_.useMemo(()=>{let b=gN(d,c);return b==null?null:{location:{pathname:b,search:f,hash:h,state:m,key:v},navigationType:i}},[c,d,f,h,m,v,i]);return y==null?null:_.createElement(gc.Provider,{value:u},_.createElement(df.Provider,{children:n,value:y}))}function RR(t){let{children:e,location:n}=t;return mR(Jm(e),n)}new Promise(()=>{});function Jm(t,e){e===void 0&&(e=[]);let n=[];return _.Children.forEach(t,(s,i)=>{if(!_.isValidElement(s))return;let r=[...e,i];if(s.type===_.Fragment){n.push.apply(n,Jm(s.props.children,r));return}s.type!==Fo&&bt(!1),!s.props.index||!s.props.children||bt(!1);let a={id:s.props.id||r.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(a.children=Jm(s.props.children,r)),n.push(a)}),n}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Zm(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let s=t[n];return e.concat(Array.isArray(s)?s.map(i=>[n,i]):[[n,s]])},[]))}function IR(t,e){let n=Zm(t);return e&&e.forEach((s,i)=>{n.has(i)||e.getAll(i).forEach(r=>{n.append(i,r)})}),n}const CR="6";try{window.__reactRouterVersion=CR}catch{}const OR="startTransition",gv=i2[OR];function MR(t){let{basename:e,children:n,future:s,window:i}=t,r=_.useRef();r.current==null&&(r.current=Uj({window:i,v5Compat:!0}));let a=r.current,[l,c]=_.useState({action:a.action,location:a.location}),{v7_startTransition:u}=s||{},d=_.useCallback(f=>{u&&gv?gv(()=>c(f)):c(f)},[c,u]);return _.useLayoutEffect(()=>a.listen(d),[a,d]),_.useEffect(()=>TR(s),[s]),_.createElement(jR,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:a,future:s})}var xv;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(xv||(xv={}));var bv;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(bv||(bv={}));function DR(t){let e=_.useRef(Zm(t)),n=_.useRef(!1),s=ff(),i=_.useMemo(()=>IR(s.search,n.current?null:e.current),[s.search]),r=ho(),a=_.useCallback((l,c)=>{const u=Zm(typeof l=="function"?l(i):l);n.current=!0,r("?"+u,c)},[r,i]);return[i,a]}const EN=_.createContext({setFullWidth:()=>{},setHideHeader:()=>{}}),TN=()=>_.useContext(EN),LR=({children:t})=>{const[,e]=_.useState(!1),[,n]=_.useState(!1);return o.jsx(EN.Provider,{value:{setFullWidth:e,setHideHeader:n},children:t})},PR=()=>{};var vv={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AN={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y=function(t,e){if(!t)throw mo(e)},mo=function(t){return new Error("Firebase Database ("+AN.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jN=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let i=t.charCodeAt(s);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},BR=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const i=t[n++];if(i<128)e[s++]=String.fromCharCode(i);else if(i>191&&i<224){const r=t[n++];e[s++]=String.fromCharCode((i&31)<<6|r&63)}else if(i>239&&i<365){const r=t[n++],a=t[n++],l=t[n++],c=((i&7)<<18|(r&63)<<12|(a&63)<<6|l&63)-65536;e[s++]=String.fromCharCode(55296+(c>>10)),e[s++]=String.fromCharCode(56320+(c&1023))}else{const r=t[n++],a=t[n++];e[s++]=String.fromCharCode((i&15)<<12|(r&63)<<6|a&63)}}return e.join("")},Z0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let i=0;i<t.length;i+=3){const r=t[i],a=i+1<t.length,l=a?t[i+1]:0,c=i+2<t.length,u=c?t[i+2]:0,d=r>>2,f=(r&3)<<4|l>>4;let h=(l&15)<<2|u>>6,m=u&63;c||(m=64,a||(h=64)),s.push(n[d],n[f],n[h],n[m])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(jN(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):BR(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let i=0;i<t.length;){const r=n[t.charAt(i++)],l=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const f=i<t.length?n[t.charAt(i)]:64;if(++i,r==null||l==null||u==null||f==null)throw new UR;const h=r<<2|l>>4;if(s.push(h),u!==64){const m=l<<4&240|u>>2;if(s.push(m),f!==64){const v=u<<6&192|f;s.push(v)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class UR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const RN=function(t){const e=jN(t);return Z0.encodeByteArray(e,!0)},ld=function(t){return RN(t).replace(/\./g,"")},cd=function(t){try{return Z0.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HR(t){return IN(void 0,t)}function IN(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!GR(n)||(t[n]=IN(t[n],e[n]));return t}function GR(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $R(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FR=()=>$R().__FIREBASE_DEFAULTS__,zR=()=>{if(typeof process>"u"||typeof vv>"u")return;const t=vv.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},VR=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&cd(t[1]);return e&&JSON.parse(e)},eg=()=>{try{return PR()||FR()||zR()||VR()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},CN=t=>{var e,n;return(n=(e=eg())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},KR=t=>{const e=CN(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),s]:[e.substring(0,n),s]},ON=()=>{var t;return(t=eg())===null||t===void 0?void 0:t.config},MN=t=>{var e;return(e=eg())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function po(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function DN(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YR(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",i=t.iat||0,r=t.sub||t.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},t);return[ld(JSON.stringify(n)),ld(JSON.stringify(a)),""].join(".")}const cl={};function WR(){const t={prod:[],emulator:[]};for(const e of Object.keys(cl))cl[e]?t.emulator.push(e):t.prod.push(e);return t}function qR(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let yv=!1;function LN(t,e){if(typeof window>"u"||typeof document>"u"||!po(window.location.host)||cl[t]===e||cl[t]||yv)return;cl[t]=e;function n(h){return`__firebase__banner__${h}`}const s="__firebase__banner",r=WR().prod.length>0;function a(){const h=document.getElementById(s);h&&h.remove()}function l(h){h.style.display="flex",h.style.background="#7faaf0",h.style.position="fixed",h.style.bottom="5px",h.style.left="5px",h.style.padding=".5em",h.style.borderRadius="5px",h.style.alignItems="center"}function c(h,m){h.setAttribute("width","24"),h.setAttribute("id",m),h.setAttribute("height","24"),h.setAttribute("viewBox","0 0 24 24"),h.setAttribute("fill","none"),h.style.marginLeft="-6px"}function u(){const h=document.createElement("span");return h.style.cursor="pointer",h.style.marginLeft="16px",h.style.fontSize="24px",h.innerHTML=" &times;",h.onclick=()=>{yv=!0,a()},h}function d(h,m){h.setAttribute("id",m),h.innerText="Learn more",h.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",h.setAttribute("target","__blank"),h.style.paddingLeft="5px",h.style.textDecoration="underline"}function f(){const h=qR(s),m=n("text"),v=document.getElementById(m)||document.createElement("span"),y=n("learnmore"),b=document.getElementById(y)||document.createElement("a"),g=n("preprendIcon"),p=document.getElementById(g)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(h.created){const x=h.element;l(x),d(b,y);const w=u();c(p,g),x.append(p,v,b,w),document.body.appendChild(x)}r?(v.innerText="Preview backend disconnected.",p.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(p.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,v.innerText="Preview backend running in this workspace."),v.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function tg(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Wt())}function XR(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function QR(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function PN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function JR(){const t=Wt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function ZR(){return AN.NODE_ADMIN===!0}function eI(){try{return typeof indexedDB=="object"}catch{return!1}}function tI(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(s);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var r;e(((r=i.error)===null||r===void 0?void 0:r.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nI="FirebaseError";class Wi extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=nI,Object.setPrototypeOf(this,Wi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,bc.prototype.create)}}class bc{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},i=`${this.service}/${e}`,r=this.errors[e],a=r?sI(r,s):"Error",l=`${this.serviceName}: ${a} (${i}).`;return new Wi(i,l,s)}}function sI(t,e){return t.replace(iI,(n,s)=>{const i=e[s];return i!=null?String(i):`<${s}?>`})}const iI=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ll(t){return JSON.parse(t)}function wt(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BN=function(t){let e={},n={},s={},i="";try{const r=t.split(".");e=Ll(cd(r[0])||""),n=Ll(cd(r[1])||""),i=r[2],s=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:s,signature:i}},rI=function(t){const e=BN(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},aI=function(t){const e=BN(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function es(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Ar(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function ud(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function dd(t,e,n){const s={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(s[i]=e.call(n,t[i],i,t));return s}function jr(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const i of n){if(!s.includes(i))return!1;const r=t[i],a=e[i];if(_v(r)&&_v(a)){if(!jr(r,a))return!1}else if(r!==a)return!1}for(const i of s)if(!n.includes(i))return!1;return!0}function _v(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function go(t){const e=[];for(const[n,s]of Object.entries(t))Array.isArray(s)?s.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function zo(t){const e={};return t.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[i,r]=s.split("=");e[decodeURIComponent(i)]=decodeURIComponent(r)}}),e}function Vo(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oI{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const s=this.W_;if(typeof e=="string")for(let f=0;f<16;f++)s[f]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let f=0;f<16;f++)s[f]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let f=16;f<80;f++){const h=s[f-3]^s[f-8]^s[f-14]^s[f-16];s[f]=(h<<1|h>>>31)&4294967295}let i=this.chain_[0],r=this.chain_[1],a=this.chain_[2],l=this.chain_[3],c=this.chain_[4],u,d;for(let f=0;f<80;f++){f<40?f<20?(u=l^r&(a^l),d=1518500249):(u=r^a^l,d=1859775393):f<60?(u=r&a|l&(r|a),d=2400959708):(u=r^a^l,d=3395469782);const h=(i<<5|i>>>27)+u+c+d+s[f]&4294967295;c=l,l=a,a=(r<<30|r>>>2)&4294967295,r=i,i=h}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+r&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const s=n-this.blockSize;let i=0;const r=this.buf_;let a=this.inbuf_;for(;i<n;){if(a===0)for(;i<=s;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<n;)if(r[a]=e.charCodeAt(i),++a,++i,a===this.blockSize){this.compress_(r),a=0;break}}else for(;i<n;)if(r[a]=e[i],++a,++i,a===this.blockSize){this.compress_(r),a=0;break}}this.inbuf_=a,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=n&255,n/=256;this.compress_(this.buf_);let s=0;for(let i=0;i<5;i++)for(let r=24;r>=0;r-=8)e[s]=this.chain_[i]>>r&255,++s;return e}}function lI(t,e){const n=new cI(t,e);return n.subscribe.bind(n)}class cI{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,s){let i;if(e===void 0&&n===void 0&&s===void 0)throw new Error("Missing Observer.");uI(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:s},i.next===void 0&&(i.next=Sh),i.error===void 0&&(i.error=Sh),i.complete===void 0&&(i.complete=Sh);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),r}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function uI(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Sh(){}function Va(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dI=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let i=t.charCodeAt(s);if(i>=55296&&i<=56319){const r=i-55296;s++,Y(s<t.length,"Surrogate pair missing trail surrogate.");const a=t.charCodeAt(s)-56320;i=65536+(r<<10)+a}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},hf=function(t){let e=0;for(let n=0;n<t.length;n++){const s=t.charCodeAt(n);s<128?e++:s<2048?e+=2:s>=55296&&s<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vt(t){return t&&t._delegate?t._delegate:t}class Rr{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ar="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fI{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new Kn;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&s.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(mI(e))try{this.getOrInitializeService({instanceIdentifier:ar})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const r=this.getOrInitializeService({instanceIdentifier:i});s.resolve(r)}catch{}}}}clearInstance(e=ar){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ar){return this.instances.has(e)}getOptions(e=ar){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[r,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(r);s===l&&a.resolve(i)}return i}onInit(e,n){var s;const i=this.normalizeInstanceIdentifier(n),r=(s=this.onInitCallbacks.get(i))!==null&&s!==void 0?s:new Set;r.add(e),this.onInitCallbacks.set(i,r);const a=this.instances.get(i);return a&&e(a,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(s)for(const i of s)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:hI(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=ar){return this.component?this.component.multipleInstances?e:ar:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function hI(t){return t===ar?void 0:t}function mI(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new fI(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Be;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Be||(Be={}));const gI={debug:Be.DEBUG,verbose:Be.VERBOSE,info:Be.INFO,warn:Be.WARN,error:Be.ERROR,silent:Be.SILENT},xI=Be.INFO,bI={[Be.DEBUG]:"log",[Be.VERBOSE]:"log",[Be.INFO]:"info",[Be.WARN]:"warn",[Be.ERROR]:"error"},vI=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),i=bI[e];if(i)console[i](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ng{constructor(e){this.name=e,this._logLevel=xI,this._logHandler=vI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Be))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?gI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Be.DEBUG,...e),this._logHandler(this,Be.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Be.VERBOSE,...e),this._logHandler(this,Be.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Be.INFO,...e),this._logHandler(this,Be.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Be.WARN,...e),this._logHandler(this,Be.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Be.ERROR,...e),this._logHandler(this,Be.ERROR,...e)}}const yI=(t,e)=>e.some(n=>t instanceof n);let wv,kv;function _I(){return wv||(wv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function wI(){return kv||(kv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const UN=new WeakMap,ep=new WeakMap,HN=new WeakMap,Eh=new WeakMap,sg=new WeakMap;function kI(t){const e=new Promise((n,s)=>{const i=()=>{t.removeEventListener("success",r),t.removeEventListener("error",a)},r=()=>{n(Ti(t.result)),i()},a=()=>{s(t.error),i()};t.addEventListener("success",r),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&UN.set(n,t)}).catch(()=>{}),sg.set(e,t),e}function NI(t){if(ep.has(t))return;const e=new Promise((n,s)=>{const i=()=>{t.removeEventListener("complete",r),t.removeEventListener("error",a),t.removeEventListener("abort",a)},r=()=>{n(),i()},a=()=>{s(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",r),t.addEventListener("error",a),t.addEventListener("abort",a)});ep.set(t,e)}let tp={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return ep.get(t);if(e==="objectStoreNames")return t.objectStoreNames||HN.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ti(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function SI(t){tp=t(tp)}function EI(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(Th(this),e,...n);return HN.set(s,e.sort?e.sort():[e]),Ti(s)}:wI().includes(t)?function(...e){return t.apply(Th(this),e),Ti(UN.get(this))}:function(...e){return Ti(t.apply(Th(this),e))}}function TI(t){return typeof t=="function"?EI(t):(t instanceof IDBTransaction&&NI(t),yI(t,_I())?new Proxy(t,tp):t)}function Ti(t){if(t instanceof IDBRequest)return kI(t);if(Eh.has(t))return Eh.get(t);const e=TI(t);return e!==t&&(Eh.set(t,e),sg.set(e,t)),e}const Th=t=>sg.get(t);function AI(t,e,{blocked:n,upgrade:s,blocking:i,terminated:r}={}){const a=indexedDB.open(t,e),l=Ti(a);return s&&a.addEventListener("upgradeneeded",c=>{s(Ti(a.result),c.oldVersion,c.newVersion,Ti(a.transaction),c)}),n&&a.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{r&&c.addEventListener("close",()=>r()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const jI=["get","getKey","getAll","getAllKeys","count"],RI=["put","add","delete","clear"],Ah=new Map;function Nv(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Ah.get(e))return Ah.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,i=RI.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(i||jI.includes(n)))return;const r=async function(a,...l){const c=this.transaction(a,i?"readwrite":"readonly");let u=c.store;return s&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),i&&c.done]))[0]};return Ah.set(e,r),r}SI(t=>({...t,get:(e,n,s)=>Nv(e,n)||t.get(e,n,s),has:(e,n)=>!!Nv(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class II{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(CI(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function CI(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const np="@firebase/app",Sv="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $s=new ng("@firebase/app"),OI="@firebase/app-compat",MI="@firebase/analytics-compat",DI="@firebase/analytics",LI="@firebase/app-check-compat",PI="@firebase/app-check",BI="@firebase/auth",UI="@firebase/auth-compat",HI="@firebase/database",GI="@firebase/data-connect",$I="@firebase/database-compat",FI="@firebase/functions",zI="@firebase/functions-compat",VI="@firebase/installations",KI="@firebase/installations-compat",YI="@firebase/messaging",WI="@firebase/messaging-compat",qI="@firebase/performance",XI="@firebase/performance-compat",QI="@firebase/remote-config",JI="@firebase/remote-config-compat",ZI="@firebase/storage",eC="@firebase/storage-compat",tC="@firebase/firestore",nC="@firebase/ai",sC="@firebase/firestore-compat",iC="firebase",rC="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sp="[DEFAULT]",aC={[np]:"fire-core",[OI]:"fire-core-compat",[DI]:"fire-analytics",[MI]:"fire-analytics-compat",[PI]:"fire-app-check",[LI]:"fire-app-check-compat",[BI]:"fire-auth",[UI]:"fire-auth-compat",[HI]:"fire-rtdb",[GI]:"fire-data-connect",[$I]:"fire-rtdb-compat",[FI]:"fire-fn",[zI]:"fire-fn-compat",[VI]:"fire-iid",[KI]:"fire-iid-compat",[YI]:"fire-fcm",[WI]:"fire-fcm-compat",[qI]:"fire-perf",[XI]:"fire-perf-compat",[QI]:"fire-rc",[JI]:"fire-rc-compat",[ZI]:"fire-gcs",[eC]:"fire-gcs-compat",[tC]:"fire-fst",[sC]:"fire-fst-compat",[nC]:"fire-vertex","fire-js":"fire-js",[iC]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fd=new Map,oC=new Map,ip=new Map;function Ev(t,e){try{t.container.addComponent(e)}catch(n){$s.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ka(t){const e=t.name;if(ip.has(e))return $s.debug(`There were multiple attempts to register component ${e}.`),!1;ip.set(e,t);for(const n of fd.values())Ev(n,t);for(const n of oC.values())Ev(n,t);return!0}function ig(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function dn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ai=new bc("app","Firebase",lC);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cC{constructor(e,n,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Rr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ai.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xo=rC;function GN(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const s=Object.assign({name:sp,automaticDataCollectionEnabled:!0},e),i=s.name;if(typeof i!="string"||!i)throw Ai.create("bad-app-name",{appName:String(i)});if(n||(n=ON()),!n)throw Ai.create("no-options");const r=fd.get(i);if(r){if(jr(n,r.options)&&jr(s,r.config))return r;throw Ai.create("duplicate-app",{appName:i})}const a=new pI(i);for(const c of ip.values())a.addComponent(c);const l=new cC(n,s,a);return fd.set(i,l),l}function $N(t=sp){const e=fd.get(t);if(!e&&t===sp&&ON())return GN();if(!e)throw Ai.create("no-app",{appName:t});return e}function ji(t,e,n){var s;let i=(s=aC[t])!==null&&s!==void 0?s:t;n&&(i+=`-${n}`);const r=i.match(/\s|\//),a=e.match(/\s|\//);if(r||a){const l=[`Unable to register library "${i}" with version "${e}":`];r&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),$s.warn(l.join(" "));return}Ka(new Rr(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uC="firebase-heartbeat-database",dC=1,Pl="firebase-heartbeat-store";let jh=null;function FN(){return jh||(jh=AI(uC,dC,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Pl)}catch(n){console.warn(n)}}}}).catch(t=>{throw Ai.create("idb-open",{originalErrorMessage:t.message})})),jh}async function fC(t){try{const n=(await FN()).transaction(Pl),s=await n.objectStore(Pl).get(zN(t));return await n.done,s}catch(e){if(e instanceof Wi)$s.warn(e.message);else{const n=Ai.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});$s.warn(n.message)}}}async function Tv(t,e){try{const s=(await FN()).transaction(Pl,"readwrite");await s.objectStore(Pl).put(e,zN(t)),await s.done}catch(n){if(n instanceof Wi)$s.warn(n.message);else{const s=Ai.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});$s.warn(s.message)}}}function zN(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hC=1024,mC=30;class pC{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new xC(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Av();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(a=>a.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:i}),this._heartbeatsCache.heartbeats.length>mC){const a=bC(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){$s.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Av(),{heartbeatsToSend:s,unsentEntries:i}=gC(this._heartbeatsCache.heartbeats),r=ld(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(n){return $s.warn(n),""}}}function Av(){return new Date().toISOString().substring(0,10)}function gC(t,e=hC){const n=[];let s=t.slice();for(const i of t){const r=n.find(a=>a.agent===i.agent);if(r){if(r.dates.push(i.date),jv(n)>e){r.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),jv(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class xC{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return eI()?tI().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await fC(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Tv(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Tv(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function jv(t){return ld(JSON.stringify({version:2,heartbeats:t})).length}function bC(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let s=1;s<t.length;s++)t[s].date<n&&(n=t[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vC(t){Ka(new Rr("platform-logger",e=>new II(e),"PRIVATE")),Ka(new Rr("heartbeat",e=>new pC(e),"PRIVATE")),ji(np,Sv,t),ji(np,Sv,"esm2017"),ji("fire-js","")}vC("");function rg(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(t);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(t,s[i])&&(n[s[i]]=t[s[i]]);return n}function VN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const yC=VN,KN=new bc("auth","Firebase",VN());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hd=new ng("@firebase/auth");function _C(t,...e){hd.logLevel<=Be.WARN&&hd.warn(`Auth (${xo}): ${t}`,...e)}function Su(t,...e){hd.logLevel<=Be.ERROR&&hd.error(`Auth (${xo}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jn(t,...e){throw ag(t,...e)}function rs(t,...e){return ag(t,...e)}function YN(t,e,n){const s=Object.assign(Object.assign({},yC()),{[e]:n});return new bc("auth","Firebase",s).create(e,{appName:t.name})}function as(t){return YN(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ag(t,...e){if(typeof t!="string"){const n=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=t.name),t._errorFactory.create(n,...s)}return KN.create(t,...e)}function ae(t,e,...n){if(!t)throw ag(e,...n)}function Es(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Su(e),new Error(e)}function Fs(t,e){t||Es(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rp(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function wC(){return Rv()==="http:"||Rv()==="https:"}function Rv(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kC(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(wC()||QR()||"connection"in navigator)?navigator.onLine:!0}function NC(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vc{constructor(e,n){this.shortDelay=e,this.longDelay=n,Fs(n>e,"Short delay should be less than long delay!"),this.isMobile=tg()||PN()}get(){return kC()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function og(t,e){Fs(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WN{static initialize(e,n,s){this.fetchImpl=e,n&&(this.headersImpl=n),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Es("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Es("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Es("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SC={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EC=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],TC=new vc(3e4,6e4);function Ws(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function qs(t,e,n,s,i={}){return qN(t,i,async()=>{let r={},a={};s&&(e==="GET"?a=s:r={body:JSON.stringify(s)});const l=go(Object.assign({key:t.config.apiKey},a)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:c},r);return XR()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&po(t.emulatorConfig.host)&&(u.credentials="include"),WN.fetch()(await XN(t,t.config.apiHost,n,l),u)})}async function qN(t,e,n){t._canInitEmulator=!1;const s=Object.assign(Object.assign({},SC),e);try{const i=new jC(t),r=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const a=await r.json();if("needConfirmation"in a)throw eu(t,"account-exists-with-different-credential",a);if(r.ok&&!("errorMessage"in a))return a;{const l=r.ok?a.errorMessage:a.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw eu(t,"credential-already-in-use",a);if(c==="EMAIL_EXISTS")throw eu(t,"email-already-in-use",a);if(c==="USER_DISABLED")throw eu(t,"user-disabled",a);const d=s[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw YN(t,d,u);Jn(t,d)}}catch(i){if(i instanceof Wi)throw i;Jn(t,"network-request-failed",{message:String(i)})}}async function yc(t,e,n,s,i={}){const r=await qs(t,e,n,s,i);return"mfaPendingCredential"in r&&Jn(t,"multi-factor-auth-required",{_serverResponse:r}),r}async function XN(t,e,n,s){const i=`${e}${n}?${s}`,r=t,a=r.config.emulator?og(t.config,i):`${t.config.apiScheme}://${i}`;return EC.includes(n)&&(await r._persistenceManagerAvailable,r._getPersistenceType()==="COOKIE")?r._getPersistence()._getFinalTarget(a).toString():a}function AC(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class jC{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,s)=>{this.timer=setTimeout(()=>s(rs(this.auth,"network-request-failed")),TC.get())})}}function eu(t,e,n){const s={appName:t.name};n.email&&(s.email=n.email),n.phoneNumber&&(s.phoneNumber=n.phoneNumber);const i=rs(t,e,s);return i.customData._tokenResponse=n,i}function Iv(t){return t!==void 0&&t.enterprise!==void 0}class RC{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return AC(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function IC(t,e){return qs(t,"GET","/v2/recaptchaConfig",Ws(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CC(t,e){return qs(t,"POST","/v1/accounts:delete",e)}async function md(t,e){return qs(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ul(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function OC(t,e=!1){const n=vt(t),s=await n.getIdToken(e),i=lg(s);ae(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const r=typeof i.firebase=="object"?i.firebase:void 0,a=r==null?void 0:r.sign_in_provider;return{claims:i,token:s,authTime:ul(Rh(i.auth_time)),issuedAtTime:ul(Rh(i.iat)),expirationTime:ul(Rh(i.exp)),signInProvider:a||null,signInSecondFactor:(r==null?void 0:r.sign_in_second_factor)||null}}function Rh(t){return Number(t)*1e3}function lg(t){const[e,n,s]=t.split(".");if(e===void 0||n===void 0||s===void 0)return Su("JWT malformed, contained fewer than 3 sections"),null;try{const i=cd(n);return i?JSON.parse(i):(Su("Failed to decode base64 JWT payload"),null)}catch(i){return Su("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function Cv(t){const e=lg(t);return ae(e,"internal-error"),ae(typeof e.exp<"u","internal-error"),ae(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bl(t,e,n=!1){if(n)return e;try{return await e}catch(s){throw s instanceof Wi&&MC(s)&&t.auth.currentUser===t&&await t.auth.signOut(),s}}function MC({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=ul(this.lastLoginAt),this.creationTime=ul(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ul(t){var e;const n=t.auth,s=await t.getIdToken(),i=await Bl(t,md(n,{idToken:s}));ae(i==null?void 0:i.users.length,n,"internal-error");const r=i.users[0];t._notifyReloadListener(r);const a=!((e=r.providerUserInfo)===null||e===void 0)&&e.length?QN(r.providerUserInfo):[],l=PC(t.providerData,a),c=t.isAnonymous,u=!(t.email&&r.passwordHash)&&!(l!=null&&l.length),d=c?u:!1,f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:l,metadata:new ap(r.createdAt,r.lastLoginAt),isAnonymous:d};Object.assign(t,f)}async function LC(t){const e=vt(t);await Ul(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function PC(t,e){return[...t.filter(s=>!e.some(i=>i.providerId===s.providerId)),...e]}function QN(t){return t.map(e=>{var{providerId:n}=e,s=rg(e,["providerId"]);return{providerId:n,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BC(t,e){const n=await qN(t,{},async()=>{const s=go({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:r}=t.config,a=await XN(t,i,"/v1/token",`key=${r}`),l=await t._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:l,body:s};return t.emulatorConfig&&po(t.emulatorConfig.host)&&(c.credentials="include"),WN.fetch()(a,c)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function UC(t,e){return qs(t,"POST","/v2/accounts:revokeToken",Ws(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ta{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ae(e.idToken,"internal-error"),ae(typeof e.idToken<"u","internal-error"),ae(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Cv(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ae(e.length!==0,"internal-error");const n=Cv(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ae(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:s,refreshToken:i,expiresIn:r}=await BC(e,n);this.updateTokensAndExpiration(s,i,Number(r))}updateTokensAndExpiration(e,n,s){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,n){const{refreshToken:s,accessToken:i,expirationTime:r}=n,a=new Ta;return s&&(ae(typeof s=="string","internal-error",{appName:e}),a.refreshToken=s),i&&(ae(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),r&&(ae(typeof r=="number","internal-error",{appName:e}),a.expirationTime=r),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ta,this.toJSON())}_performRefresh(){return Es("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Js(t,e){ae(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Wn{constructor(e){var{uid:n,auth:s,stsTokenManager:i}=e,r=rg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new DC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=s,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new ap(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const n=await Bl(this,this.stsTokenManager.getToken(this.auth,e));return ae(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return OC(this,e)}reload(){return LC(this)}_assign(e){this!==e&&(ae(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Wn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){ae(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),n&&await Ul(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(dn(this.auth.app))return Promise.reject(as(this.auth));const e=await this.getIdToken();return await Bl(this,CC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var s,i,r,a,l,c,u,d;const f=(s=n.displayName)!==null&&s!==void 0?s:void 0,h=(i=n.email)!==null&&i!==void 0?i:void 0,m=(r=n.phoneNumber)!==null&&r!==void 0?r:void 0,v=(a=n.photoURL)!==null&&a!==void 0?a:void 0,y=(l=n.tenantId)!==null&&l!==void 0?l:void 0,b=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,g=(u=n.createdAt)!==null&&u!==void 0?u:void 0,p=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:x,emailVerified:w,isAnonymous:k,providerData:S,stsTokenManager:N}=n;ae(x&&N,e,"internal-error");const T=Ta.fromJSON(this.name,N);ae(typeof x=="string",e,"internal-error"),Js(f,e.name),Js(h,e.name),ae(typeof w=="boolean",e,"internal-error"),ae(typeof k=="boolean",e,"internal-error"),Js(m,e.name),Js(v,e.name),Js(y,e.name),Js(b,e.name),Js(g,e.name),Js(p,e.name);const E=new Wn({uid:x,auth:e,email:h,emailVerified:w,displayName:f,isAnonymous:k,photoURL:v,phoneNumber:m,tenantId:y,stsTokenManager:T,createdAt:g,lastLoginAt:p});return S&&Array.isArray(S)&&(E.providerData=S.map(j=>Object.assign({},j))),b&&(E._redirectEventId=b),E}static async _fromIdTokenResponse(e,n,s=!1){const i=new Ta;i.updateFromServerResponse(n);const r=new Wn({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:s});return await Ul(r),r}static async _fromGetAccountInfoResponse(e,n,s){const i=n.users[0];ae(i.localId!==void 0,"internal-error");const r=i.providerUserInfo!==void 0?QN(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(r!=null&&r.length),l=new Ta;l.updateFromIdToken(s);const c=new Wn({uid:i.localId,auth:e,stsTokenManager:l,isAnonymous:a}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:r,metadata:new ap(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(r!=null&&r.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ov=new Map;function Ts(t){Fs(t instanceof Function,"Expected a class definition");let e=Ov.get(t);return e?(Fs(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Ov.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}JN.type="NONE";const Mv=JN;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eu(t,e,n){return`firebase:${t}:${e}:${n}`}class Aa{constructor(e,n,s){this.persistence=e,this.auth=n,this.userKey=s;const{config:i,name:r}=this.auth;this.fullUserKey=Eu(this.userKey,i.apiKey,r),this.fullPersistenceKey=Eu("persistence",i.apiKey,r),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await md(this.auth,{idToken:e}).catch(()=>{});return n?Wn._fromGetAccountInfoResponse(this.auth,n,e):null}return Wn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,s="authUser"){if(!n.length)return new Aa(Ts(Mv),e,s);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let r=i[0]||Ts(Mv);const a=Eu(s,e.config.apiKey,e.name);let l=null;for(const u of n)try{const d=await u._get(a);if(d){let f;if(typeof d=="string"){const h=await md(e,{idToken:d}).catch(()=>{});if(!h)break;f=await Wn._fromGetAccountInfoResponse(e,h,d)}else f=Wn._fromJSON(e,d);u!==r&&(l=f),r=u;break}}catch{}const c=i.filter(u=>u._shouldAllowMigration);return!r._shouldAllowMigration||!c.length?new Aa(r,e,s):(r=c[0],l&&await r._set(a,l.toJSON()),await Promise.all(n.map(async u=>{if(u!==r)try{await u._remove(a)}catch{}})),new Aa(r,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dv(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(nS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(ZN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(iS(e))return"Blackberry";if(rS(e))return"Webos";if(eS(e))return"Safari";if((e.includes("chrome/")||tS(e))&&!e.includes("edge/"))return"Chrome";if(sS(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=t.match(n);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function ZN(t=Wt()){return/firefox\//i.test(t)}function eS(t=Wt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function tS(t=Wt()){return/crios\//i.test(t)}function nS(t=Wt()){return/iemobile/i.test(t)}function sS(t=Wt()){return/android/i.test(t)}function iS(t=Wt()){return/blackberry/i.test(t)}function rS(t=Wt()){return/webos/i.test(t)}function cg(t=Wt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function HC(t=Wt()){var e;return cg(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function GC(){return JR()&&document.documentMode===10}function aS(t=Wt()){return cg(t)||sS(t)||rS(t)||iS(t)||/windows phone/i.test(t)||nS(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oS(t,e=[]){let n;switch(t){case"Browser":n=Dv(Wt());break;case"Worker":n=`${Dv(Wt())}-${t}`;break;default:n=t}const s=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${xo}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $C{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const s=r=>new Promise((a,l)=>{try{const c=e(r);a(c)}catch(c){l(c)}});s.onAbort=n,this.queue.push(s);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const s of this.queue)await s(e),s.onAbort&&n.push(s.onAbort)}catch(s){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FC(t,e={}){return qs(t,"GET","/v2/passwordPolicy",Ws(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zC=6;class VC{constructor(e){var n,s,i,r;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=a.minPasswordLength)!==null&&n!==void 0?n:zC,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(s=e.allowedNonAlphanumericCharacters)===null||s===void 0?void 0:s.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(r=e.forceUpgradeOnSignin)!==null&&r!==void 0?r:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,s,i,r,a,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(s=c.meetsMaxPasswordLength)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(r=c.containsUppercaseLetter)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(a=c.containsNumericCharacter)!==null&&a!==void 0?a:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,n){const s=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;s&&(n.meetsMinPasswordLength=e.length>=s),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let s;for(let i=0;i<e.length;i++)s=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,n,s,i,r){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KC{constructor(e,n,s,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=s,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Lv(this),this.idTokenSubscription=new Lv(this),this.beforeStateQueue=new $C(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=KN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(r=>this._resolvePersistenceManagerAvailable=r)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Ts(n)),this._initializationPromise=this.queue(async()=>{var s,i,r;if(!this._deleted&&(this.persistenceManager=await Aa.create(this,e),(s=this._resolvePersistenceManagerAvailable)===null||s===void 0||s.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((r=this.currentUser)===null||r===void 0?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await md(this,{idToken:e}),s=await Wn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(s)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(dn(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(l,l))}):this.directlySetCurrentUser(null)}const s=await this.assertedPersistence.getCurrentUser();let i=s,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=i==null?void 0:i._redirectEventId,c=await this.tryRedirectSignIn(e);(!a||a===l)&&(c!=null&&c.user)&&(i=c.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ae(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Ul(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=NC()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(dn(this.app))return Promise.reject(as(this));const n=e?vt(e):null;return n&&ae(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ae(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return dn(this.app)?Promise.reject(as(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return dn(this.app)?Promise.reject(as(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ts(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await FC(this),n=new VC(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new bc("auth","Firebase",e())}onAuthStateChanged(e,n,s){return this.registerStateListener(this.authStateSubscription,e,n,s)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,s){return this.registerStateListener(this.idTokenSubscription,e,n,s)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(s.tenantId=this.tenantId),await UC(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const s=await this.getOrInitRedirectPersistenceManager(n);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Ts(e)||this._popupRedirectResolver;ae(n,this,"argument-error"),this.redirectPersistenceManager=await Aa.create(this,[Ts(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,s;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,s,i){if(this._deleted)return()=>{};const r=typeof n=="function"?n:n.next.bind(n);let a=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(ae(l,this,"internal-error"),l.then(()=>{a||r(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,s,i);return()=>{a=!0,c()}}else{const c=e.addObserver(n);return()=>{a=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ae(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=oS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());s&&(n["X-Firebase-Client"]=s);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;if(dn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&_C(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Xs(t){return vt(t)}class Lv{constructor(e){this.auth=e,this.observer=null,this.addObserver=lI(n=>this.observer=n)}get next(){return ae(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function YC(t){mf=t}function lS(t){return mf.loadJS(t)}function WC(){return mf.recaptchaEnterpriseScript}function qC(){return mf.gapiScript}function XC(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class QC{constructor(){this.enterprise=new JC}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class JC{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const ZC="recaptcha-enterprise",cS="NO_RECAPTCHA";class eO{constructor(e){this.type=ZC,this.auth=Xs(e)}async verify(e="verify",n=!1){async function s(r){if(!n){if(r.tenantId==null&&r._agentRecaptchaConfig!=null)return r._agentRecaptchaConfig.siteKey;if(r.tenantId!=null&&r._tenantRecaptchaConfigs[r.tenantId]!==void 0)return r._tenantRecaptchaConfigs[r.tenantId].siteKey}return new Promise(async(a,l)=>{IC(r,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new RC(c);return r.tenantId==null?r._agentRecaptchaConfig=u:r._tenantRecaptchaConfigs[r.tenantId]=u,a(u.siteKey)}}).catch(c=>{l(c)})})}function i(r,a,l){const c=window.grecaptcha;Iv(c)?c.enterprise.ready(()=>{c.enterprise.execute(r,{action:e}).then(u=>{a(u)}).catch(()=>{a(cS)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new QC().execute("siteKey",{action:"verify"}):new Promise((r,a)=>{s(this.auth).then(l=>{if(!n&&Iv(window.grecaptcha))i(l,r,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let c=WC();c.length!==0&&(c+=l),lS(c).then(()=>{i(l,r,a)}).catch(u=>{a(u)})}}).catch(l=>{a(l)})})}}async function Pv(t,e,n,s=!1,i=!1){const r=new eO(t);let a;if(i)a=cS;else try{a=await r.verify(n)}catch{a=await r.verify(n,!0)}const l=Object.assign({},e);if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const c=l.phoneEnrollmentInfo.phoneNumber,u=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:u,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const c=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return s?Object.assign(l,{captchaResp:a}):Object.assign(l,{captchaResponse:a}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function pd(t,e,n,s,i){var r;if(!((r=t._getRecaptchaConfig())===null||r===void 0)&&r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await Pv(t,e,n,n==="getOobCode");return s(t,a)}else return s(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await Pv(t,e,n,n==="getOobCode");return s(t,l)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tO(t,e){const n=ig(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),r=n.getOptions();if(jr(r,e??{}))return i;Jn(i,"already-initialized")}return n.initialize({options:e})}function nO(t,e){const n=(e==null?void 0:e.persistence)||[],s=(Array.isArray(n)?n:[n]).map(Ts);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function sO(t,e,n){const s=Xs(t);ae(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const i=!1,r=uS(e),{host:a,port:l}=iO(e),c=l===null?"":`:${l}`,u={url:`${r}//${a}${c}/`},d=Object.freeze({host:a,port:l,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!s._canInitEmulator){ae(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),ae(jr(u,s.config.emulator)&&jr(d,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=u,s.emulatorConfig=d,s.settings.appVerificationDisabledForTesting=!0,po(a)?(DN(`${r}//${a}${c}`),LN("Auth",!0)):rO()}function uS(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function iO(t){const e=uS(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const s=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(s);if(i){const r=i[1];return{host:r,port:Bv(s.substr(r.length+1))}}else{const[r,a]=s.split(":");return{host:r,port:Bv(a)}}}function Bv(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function rO(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ug{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Es("not implemented")}_getIdTokenResponse(e){return Es("not implemented")}_linkToIdToken(e,n){return Es("not implemented")}_getReauthenticationResolver(e){return Es("not implemented")}}async function aO(t,e){return qs(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oO(t,e){return yc(t,"POST","/v1/accounts:signInWithPassword",Ws(t,e))}async function lO(t,e){return qs(t,"POST","/v1/accounts:sendOobCode",Ws(t,e))}async function cO(t,e){return lO(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uO(t,e){return yc(t,"POST","/v1/accounts:signInWithEmailLink",Ws(t,e))}async function dO(t,e){return yc(t,"POST","/v1/accounts:signInWithEmailLink",Ws(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl extends ug{constructor(e,n,s,i=null){super("password",s),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new Hl(e,n,"password")}static _fromEmailAndCode(e,n,s=null){return new Hl(e,n,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return pd(e,n,"signInWithPassword",oO);case"emailLink":return uO(e,{email:this._email,oobCode:this._password});default:Jn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const s={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return pd(e,s,"signUpPassword",aO);case"emailLink":return dO(e,{idToken:n,email:this._email,oobCode:this._password});default:Jn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ja(t,e){return yc(t,"POST","/v1/accounts:signInWithIdp",Ws(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fO="http://localhost";class Ir extends ug{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ir(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Jn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:i}=n,r=rg(n,["providerId","signInMethod"]);if(!s||!i)return null;const a=new Ir(s,i);return a.idToken=r.idToken||void 0,a.accessToken=r.accessToken||void 0,a.secret=r.secret,a.nonce=r.nonce,a.pendingToken=r.pendingToken||null,a}_getIdTokenResponse(e){const n=this.buildRequest();return ja(e,n)}_linkToIdToken(e,n){const s=this.buildRequest();return s.idToken=n,ja(e,s)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ja(e,n)}buildRequest(){const e={requestUri:fO,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=go(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hO(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function mO(t){const e=zo(Vo(t)).link,n=e?zo(Vo(e)).deep_link_id:null,s=zo(Vo(t)).deep_link_id;return(s?zo(Vo(s)).link:null)||s||n||e||t}class dg{constructor(e){var n,s,i,r,a,l;const c=zo(Vo(e)),u=(n=c.apiKey)!==null&&n!==void 0?n:null,d=(s=c.oobCode)!==null&&s!==void 0?s:null,f=hO((i=c.mode)!==null&&i!==void 0?i:null);ae(u&&d&&f,"argument-error"),this.apiKey=u,this.operation=f,this.code=d,this.continueUrl=(r=c.continueUrl)!==null&&r!==void 0?r:null,this.languageCode=(a=c.lang)!==null&&a!==void 0?a:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const n=mO(e);try{return new dg(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr{constructor(){this.providerId=Gr.PROVIDER_ID}static credential(e,n){return Hl._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const s=dg.parseLink(n);return ae(s,"argument-error"),Hl._fromEmailAndCode(e,s.code,s.tenantId)}}Gr.PROVIDER_ID="password";Gr.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Gr.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dS{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c extends dS{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai extends _c{constructor(){super("facebook.com")}static credential(e){return Ir._fromParams({providerId:ai.PROVIDER_ID,signInMethod:ai.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ai.credentialFromTaggedObject(e)}static credentialFromError(e){return ai.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ai.credential(e.oauthAccessToken)}catch{return null}}}ai.FACEBOOK_SIGN_IN_METHOD="facebook.com";ai.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi extends _c{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ir._fromParams({providerId:oi.PROVIDER_ID,signInMethod:oi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return oi.credentialFromTaggedObject(e)}static credentialFromError(e){return oi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:s}=e;if(!n&&!s)return null;try{return oi.credential(n,s)}catch{return null}}}oi.GOOGLE_SIGN_IN_METHOD="google.com";oi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class li extends _c{constructor(){super("github.com")}static credential(e){return Ir._fromParams({providerId:li.PROVIDER_ID,signInMethod:li.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return li.credentialFromTaggedObject(e)}static credentialFromError(e){return li.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return li.credential(e.oauthAccessToken)}catch{return null}}}li.GITHUB_SIGN_IN_METHOD="github.com";li.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci extends _c{constructor(){super("twitter.com")}static credential(e,n){return Ir._fromParams({providerId:ci.PROVIDER_ID,signInMethod:ci.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return ci.credentialFromTaggedObject(e)}static credentialFromError(e){return ci.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:s}=e;if(!n||!s)return null;try{return ci.credential(n,s)}catch{return null}}}ci.TWITTER_SIGN_IN_METHOD="twitter.com";ci.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fS(t,e){return yc(t,"POST","/v1/accounts:signUp",Ws(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,s,i=!1){const r=await Wn._fromIdTokenResponse(e,s,i),a=Uv(s);return new zs({user:r,providerId:a,_tokenResponse:s,operationType:n})}static async _forOperation(e,n,s){await e._updateTokensIfNecessary(s,!0);const i=Uv(s);return new zs({user:e,providerId:i,_tokenResponse:s,operationType:n})}}function Uv(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pO(t){var e;if(dn(t.app))return Promise.reject(as(t));const n=Xs(t);if(await n._initializationPromise,!((e=n.currentUser)===null||e===void 0)&&e.isAnonymous)return new zs({user:n.currentUser,providerId:null,operationType:"signIn"});const s=await fS(n,{returnSecureToken:!0}),i=await zs._fromIdTokenResponse(n,"signIn",s,!0);return await n._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gd extends Wi{constructor(e,n,s,i){var r;super(n.code,n.message),this.operationType=s,this.user=i,Object.setPrototypeOf(this,gd.prototype),this.customData={appName:e.name,tenantId:(r=e.tenantId)!==null&&r!==void 0?r:void 0,_serverResponse:n.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,n,s,i){return new gd(e,n,s,i)}}function hS(t,e,n,s){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(r=>{throw r.code==="auth/multi-factor-auth-required"?gd._fromErrorAndOperation(t,r,e,s):r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gO(t){return new Set(t.map(({providerId:e})=>e).filter(e=>!!e))}async function mS(t,e,n=!1){const s=await Bl(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return zs._forOperation(t,"link",s)}async function xO(t,e,n){await Ul(e);const s=gO(e.providerData);ae(s.has(n)===t,e.auth,"provider-already-linked")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bO(t,e,n=!1){const{auth:s}=t;if(dn(s.app))return Promise.reject(as(s));const i="reauthenticate";try{const r=await Bl(t,hS(s,i,e,t),n);ae(r.idToken,s,"internal-error");const a=lg(r.idToken);ae(a,s,"internal-error");const{sub:l}=a;return ae(t.uid===l,s,"user-mismatch"),zs._forOperation(t,i,r)}catch(r){throw(r==null?void 0:r.code)==="auth/user-not-found"&&Jn(s,"user-mismatch"),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pS(t,e,n=!1){if(dn(t.app))return Promise.reject(as(t));const s="signIn",i=await hS(t,s,e),r=await zs._fromIdTokenResponse(t,s,i);return n||await t._updateCurrentUser(r.user),r}async function vO(t,e){return pS(Xs(t),e)}async function yO(t,e){const n=vt(t);return await xO(!1,n,e.providerId),mS(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gS(t){const e=Xs(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function _O(t,e,n){const s=Xs(t);await pd(s,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",cO)}async function wO(t,e,n){if(dn(t.app))return Promise.reject(as(t));const s=Xs(t),a=await pd(s,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",fS).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&gS(t),c}),l=await zs._fromIdTokenResponse(s,"signIn",a);return await s._updateCurrentUser(l.user),l}function kO(t,e,n){return dn(t.app)?Promise.reject(as(t)):vO(vt(t),Gr.credential(e,n)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&gS(t),s})}function NO(t,e,n,s){return vt(t).onIdTokenChanged(e,n,s)}function SO(t,e,n){return vt(t).beforeAuthStateChanged(e,n)}function EO(t,e,n,s){return vt(t).onAuthStateChanged(e,n,s)}function TO(t){return vt(t).signOut()}const xd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(xd,"1"),this.storage.removeItem(xd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AO=1e3,jO=10;class bS extends xS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=aS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const s=this.storage.getItem(n),i=this.localCache[n];s!==i&&e(n,i,s)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((a,l,c)=>{this.notifyListeners(a,c)});return}const s=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(s);!n&&this.localCache[s]===a||this.notifyListeners(s,a)},r=this.storage.getItem(s);GC()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,jO):i()}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:s}),!0)})},AO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}bS.type="LOCAL";const RO=bS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vS extends xS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}vS.type="SESSION";const yS=vS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IO(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const s=new pf(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:s,eventType:i,data:r}=n.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;n.ports[0].postMessage({status:"ack",eventId:s,eventType:i});const l=Array.from(a).map(async u=>u(n.origin,r)),c=await IO(l);n.ports[0].postMessage({status:"done",eventId:s,eventType:i,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}pf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fg(t="",e=10){let n="";for(let s=0;s<e;s++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CO{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,s=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,a;return new Promise((l,c)=>{const u=fg("",20);i.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},s);a={messageChannel:i,onMessage(f){const h=f;if(h.data.eventId===u)switch(h.data.status){case"ack":clearTimeout(d),r=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),l(h.data.response);break;default:clearTimeout(d),clearTimeout(r),c(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function os(){return window}function OO(t){os().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _S(){return typeof os().WorkerGlobalScope<"u"&&typeof os().importScripts=="function"}async function MO(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function DO(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function LO(){return _S()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wS="firebaseLocalStorageDb",PO=1,bd="firebaseLocalStorage",kS="fbase_key";class wc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function gf(t,e){return t.transaction([bd],e?"readwrite":"readonly").objectStore(bd)}function BO(){const t=indexedDB.deleteDatabase(wS);return new wc(t).toPromise()}function op(){const t=indexedDB.open(wS,PO);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const s=t.result;try{s.createObjectStore(bd,{keyPath:kS})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const s=t.result;s.objectStoreNames.contains(bd)?e(s):(s.close(),await BO(),e(await op()))})})}async function Hv(t,e,n){const s=gf(t,!0).put({[kS]:e,value:n});return new wc(s).toPromise()}async function UO(t,e){const n=gf(t,!1).get(e),s=await new wc(n).toPromise();return s===void 0?null:s.value}function Gv(t,e){const n=gf(t,!0).delete(e);return new wc(n).toPromise()}const HO=800,GO=3;class NS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await op(),this.db)}async _withRetries(e){let n=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(n++>GO)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return _S()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=pf._getInstance(LO()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await MO(),!this.activeServiceWorker)return;this.sender=new CO(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);s&&!((e=s[0])===null||e===void 0)&&e.fulfilled&&!((n=s[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||DO()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await op();return await Hv(e,xd,"1"),await Gv(e,xd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(s=>Hv(s,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(s=>UO(s,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Gv(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const r=gf(i,!1).getAll();return new wc(r).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],s=new Set;if(e.length!==0)for(const{fbase_key:i,value:r}of e)s.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!s.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),HO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}NS.type="LOCAL";const $O=NS;new vc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FO(t,e){return e?Ts(e):(ae(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hg extends ug{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ja(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ja(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ja(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function zO(t){return pS(t.auth,new hg(t),t.bypassAuthState)}function VO(t){const{auth:e,user:n}=t;return ae(n,e,"internal-error"),bO(n,new hg(t),t.bypassAuthState)}async function KO(t){const{auth:e,user:n}=t;return ae(n,e,"internal-error"),mS(n,new hg(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SS{constructor(e,n,s,i,r=!1){this.auth=e,this.resolver=s,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:s,postBody:i,tenantId:r,error:a,type:l}=e;if(a){this.reject(a);return}const c={auth:this.auth,requestUri:n,sessionId:s,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return zO;case"linkViaPopup":case"linkViaRedirect":return KO;case"reauthViaPopup":case"reauthViaRedirect":return VO;default:Jn(this.auth,"internal-error")}}resolve(e){Fs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Fs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YO=new vc(2e3,1e4);class fa extends SS{constructor(e,n,s,i,r){super(e,n,i,r),this.provider=s,this.authWindow=null,this.pollId=null,fa.currentPopupAction&&fa.currentPopupAction.cancel(),fa.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ae(e,this.auth,"internal-error"),e}async onExecution(){Fs(this.filter.length===1,"Popup operations only handle one event");const e=fg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(rs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(rs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,fa.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,s;if(!((s=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(rs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,YO.get())};e()}}fa.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WO="pendingRedirect",Tu=new Map;class qO extends SS{constructor(e,n,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,s),this.eventId=null}async execute(){let e=Tu.get(this.auth._key());if(!e){try{const s=await XO(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(n){e=()=>Promise.reject(n)}Tu.set(this.auth._key(),e)}return this.bypassAuthState||Tu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function XO(t,e){const n=ZO(e),s=JO(t);if(!await s._isAvailable())return!1;const i=await s._get(n)==="true";return await s._remove(n),i}function QO(t,e){Tu.set(t._key(),e)}function JO(t){return Ts(t._redirectPersistence)}function ZO(t){return Eu(WO,t.config.apiKey,t.name)}async function eM(t,e,n=!1){if(dn(t.app))return Promise.reject(as(t));const s=Xs(t),i=FO(s,e),a=await new qO(s,i,n).execute();return a&&!n&&(delete a.user._redirectEventId,await s._persistUserIfCurrent(a.user),await s._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tM=10*60*1e3;class nM{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(n=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!sM(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var s;if(e.error&&!ES(e)){const i=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";n.onError(rs(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const s=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=tM&&this.cachedEventUids.clear(),this.cachedEventUids.has($v(e))}saveEventToCache(e){this.cachedEventUids.add($v(e)),this.lastProcessedEventTime=Date.now()}}function $v(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function ES({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function sM(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ES(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iM(t,e={}){return qs(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rM=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,aM=/^https?/;async function oM(t){if(t.config.emulator)return;const{authorizedDomains:e}=await iM(t);for(const n of e)try{if(lM(n))return}catch{}Jn(t,"unauthorized-domain")}function lM(t){const e=rp(),{protocol:n,hostname:s}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&s===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&a.hostname===s}if(!aM.test(n))return!1;if(rM.test(t))return s===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cM=new vc(3e4,6e4);function Fv(){const t=os().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function uM(t){return new Promise((e,n)=>{var s,i,r;function a(){Fv(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Fv(),n(rs(t,"network-request-failed"))},timeout:cM.get()})}if(!((i=(s=os().gapi)===null||s===void 0?void 0:s.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((r=os().gapi)===null||r===void 0)&&r.load)a();else{const l=XC("iframefcb");return os()[l]=()=>{gapi.load?a():n(rs(t,"network-request-failed"))},lS(`${qC()}?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw Au=null,e})}let Au=null;function dM(t){return Au=Au||uM(t),Au}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fM=new vc(5e3,15e3),hM="__/auth/iframe",mM="emulator/auth/iframe",pM={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},gM=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function xM(t){const e=t.config;ae(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?og(e,mM):`https://${t.config.authDomain}/${hM}`,s={apiKey:e.apiKey,appName:t.name,v:xo},i=gM.get(t.config.apiHost);i&&(s.eid=i);const r=t._getFrameworks();return r.length&&(s.fw=r.join(",")),`${n}?${go(s).slice(1)}`}async function bM(t){const e=await dM(t),n=os().gapi;return ae(n,t,"internal-error"),e.open({where:document.body,url:xM(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:pM,dontclear:!0},s=>new Promise(async(i,r)=>{await s.restyle({setHideOnLeave:!1});const a=rs(t,"network-request-failed"),l=os().setTimeout(()=>{r(a)},fM.get());function c(){os().clearTimeout(l),i(s)}s.ping(c).then(c,()=>{r(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vM={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},yM=500,_M=600,wM="_blank",kM="http://localhost";class zv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function NM(t,e,n,s=yM,i=_M){const r=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-s)/2,0).toString();let l="";const c=Object.assign(Object.assign({},vM),{width:s.toString(),height:i.toString(),top:r,left:a}),u=Wt().toLowerCase();n&&(l=tS(u)?wM:n),ZN(u)&&(e=e||kM,c.scrollbars="yes");const d=Object.entries(c).reduce((h,[m,v])=>`${h}${m}=${v},`,"");if(HC(u)&&l!=="_self")return SM(e||"",l),new zv(null);const f=window.open(e||"",l,d);ae(f,t,"popup-blocked");try{f.focus()}catch{}return new zv(f)}function SM(t,e){const n=document.createElement("a");n.href=t,n.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EM="__/auth/handler",TM="emulator/auth/handler",AM=encodeURIComponent("fac");async function Vv(t,e,n,s,i,r){ae(t.config.authDomain,t,"auth-domain-config-required"),ae(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:s,v:xo,eventId:i};if(e instanceof dS){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",ud(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries({}))a[d]=f}if(e instanceof _c){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(a.scopes=d.join(","))}t.tenantId&&(a.tid=t.tenantId);const l=a;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const c=await t._getAppCheckToken(),u=c?`#${AM}=${encodeURIComponent(c)}`:"";return`${jM(t)}?${go(l).slice(1)}${u}`}function jM({config:t}){return t.emulator?og(t,TM):`https://${t.authDomain}/${EM}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ih="webStorageSupport";class RM{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=yS,this._completeRedirectFn=eM,this._overrideRedirectResult=QO}async _openPopup(e,n,s,i){var r;Fs((r=this.eventManagers[e._key()])===null||r===void 0?void 0:r.manager,"_initialize() not called before _openPopup()");const a=await Vv(e,n,s,rp(),i);return NM(e,a,fg())}async _openRedirect(e,n,s,i){await this._originValidation(e);const r=await Vv(e,n,s,rp(),i);return OO(r),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:r}=this.eventManagers[n];return i?Promise.resolve(i):(Fs(r,"If manager is not set, promise should be"),r)}const s=this.initAndGetManager(e);return this.eventManagers[n]={promise:s},s.catch(()=>{delete this.eventManagers[n]}),s}async initAndGetManager(e){const n=await bM(e),s=new nM(e);return n.register("authEvent",i=>(ae(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:s.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=n,s}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Ih,{type:Ih},i=>{var r;const a=(r=i==null?void 0:i[0])===null||r===void 0?void 0:r[Ih];a!==void 0&&n(!!a),Jn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=oM(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return aS()||eS()||cg()}}const IM=RM;var Kv="@firebase/auth",Yv="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CM{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ae(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OM(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function MM(t){Ka(new Rr("auth",(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),r=e.getProvider("app-check-internal"),{apiKey:a,authDomain:l}=s.options;ae(a&&!a.includes(":"),"invalid-api-key",{appName:s.name});const c={apiKey:a,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:oS(t)},u=new KC(s,i,r,c);return nO(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,s)=>{e.getProvider("auth-internal").initialize()})),Ka(new Rr("auth-internal",e=>{const n=Xs(e.getProvider("auth").getImmediate());return(s=>new CM(s))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),ji(Kv,Yv,OM(t)),ji(Kv,Yv,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DM=5*60,LM=MN("authIdTokenMaxAge")||DM;let Wv=null;const PM=t=>async e=>{const n=e&&await e.getIdTokenResult(),s=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(s&&s>LM)return;const i=n==null?void 0:n.token;Wv!==i&&(Wv=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function BM(t=$N()){const e=ig(t,"auth");if(e.isInitialized())return e.getImmediate();const n=tO(t,{popupRedirectResolver:IM,persistence:[$O,RO,yS]}),s=MN("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const r=new URL(s,location.origin);if(location.origin===r.origin){const a=PM(r.toString());SO(n,a,()=>a(n.currentUser)),NO(n,l=>a(l))}}const i=CN("auth");return i&&sO(n,`http://${i}`),n}function UM(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}YC({loadJS(t){return new Promise((e,n)=>{const s=document.createElement("script");s.setAttribute("src",t),s.onload=e,s.onerror=i=>{const r=rs("internal-error");r.customData=i,n(r)},s.type="text/javascript",s.charset="UTF-8",UM().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});MM("Browser");var qv={};const Xv="@firebase/database",Qv="1.0.20";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let TS="";function HM(t){TS=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GM{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),wt(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Ll(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $M{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return es(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AS=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new GM(e)}}catch{}return new $M},dr=AS("localStorage"),FM=AS("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ra=new ng("@firebase/database"),jS=function(){let t=1;return function(){return t++}}(),RS=function(t){const e=dI(t),n=new oI;n.update(e);const s=n.digest();return Z0.encodeByteArray(s)},kc=function(...t){let e="";for(let n=0;n<t.length;n++){const s=t[n];Array.isArray(s)||s&&typeof s=="object"&&typeof s.length=="number"?e+=kc.apply(null,s):typeof s=="object"?e+=wt(s):e+=s,e+=" "}return e};let dl=null,Jv=!0;const zM=function(t,e){Y(!0,"Can't turn on custom loggers persistently."),Ra.logLevel=Be.VERBOSE,dl=Ra.log.bind(Ra)},At=function(...t){if(Jv===!0&&(Jv=!1,dl===null&&FM.get("logging_enabled")===!0&&zM()),dl){const e=kc.apply(null,t);dl(e)}},Nc=function(t){return function(...e){At(t,...e)}},lp=function(...t){const e="FIREBASE INTERNAL ERROR: "+kc(...t);Ra.error(e)},Vs=function(...t){const e=`FIREBASE FATAL ERROR: ${kc(...t)}`;throw Ra.error(e),new Error(e)},Yt=function(...t){const e="FIREBASE WARNING: "+kc(...t);Ra.warn(e)},VM=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Yt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},xf=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},KM=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Ya="[MIN_NAME]",Cr="[MAX_NAME]",$r=function(t,e){if(t===e)return 0;if(t===Ya||e===Cr)return-1;if(e===Ya||t===Cr)return 1;{const n=Zv(t),s=Zv(e);return n!==null?s!==null?n-s===0?t.length-e.length:n-s:-1:s!==null?1:t<e?-1:1}},YM=function(t,e){return t===e?0:t<e?-1:1},Oo=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+wt(e))},mg=function(t){if(typeof t!="object"||t===null)return wt(t);const e=[];for(const s in t)e.push(s);e.sort();let n="{";for(let s=0;s<e.length;s++)s!==0&&(n+=","),n+=wt(e[s]),n+=":",n+=mg(t[e[s]]);return n+="}",n},IS=function(t,e){const n=t.length;if(n<=e)return[t];const s=[];for(let i=0;i<n;i+=e)i+e>n?s.push(t.substring(i,n)):s.push(t.substring(i,i+e));return s};function It(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const CS=function(t){Y(!xf(t),"Invalid JSON number");const e=11,n=52,s=(1<<e-1)-1;let i,r,a,l,c;t===0?(r=0,a=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-s)?(l=Math.min(Math.floor(Math.log(t)/Math.LN2),s),r=l+s,a=Math.round(t*Math.pow(2,n-l)-Math.pow(2,n))):(r=0,a=Math.round(t/Math.pow(2,1-s-n))));const u=[];for(c=n;c;c-=1)u.push(a%2?1:0),a=Math.floor(a/2);for(c=e;c;c-=1)u.push(r%2?1:0),r=Math.floor(r/2);u.push(i?1:0),u.reverse();const d=u.join("");let f="";for(c=0;c<64;c+=8){let h=parseInt(d.substr(c,8),2).toString(16);h.length===1&&(h="0"+h),f=f+h}return f.toLowerCase()},WM=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},qM=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function XM(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const s=new Error(t+" at "+e._path.toString()+": "+n);return s.code=t.toUpperCase(),s}const QM=new RegExp("^-?(0*)\\d{1,10}$"),JM=-2147483648,ZM=2147483647,Zv=function(t){if(QM.test(t)){const e=Number(t);if(e>=JM&&e<=ZM)return e}return null},bo=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw Yt("Exception was thrown by user callback.",n),e},Math.floor(0))}},eD=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},fl=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tD{constructor(e,n){this.appCheckProvider=n,this.appName=e.name,dn(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(s=>this.appCheck=s)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((n,s)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(s=>s.addTokenListener(e))}notifyForInvalidToken(){Yt(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nD{constructor(e,n,s){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=s,this.auth_=null,this.auth_=s.getImmediate({optional:!0}),this.auth_||s.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(At("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,s)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Yt(e)}}class ju{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}ju.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pg="5",OS="v",MS="s",DS="r",LS="f",PS=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,BS="ls",US="p",cp="ac",HS="websocket",GS="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $S{constructor(e,n,s,i,r=!1,a="",l=!1,c=!1,u=null){this.secure=n,this.namespace=s,this.webSocketOnly=i,this.nodeAdmin=r,this.persistenceKey=a,this.includeNamespaceInQueryParams=l,this.isUsingEmulator=c,this.emulatorOptions=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=dr.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&dr.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function sD(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function FS(t,e,n){Y(typeof e=="string","typeof type must == string"),Y(typeof n=="object","typeof params must == object");let s;if(e===HS)s=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===GS)s=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);sD(t)&&(n.ns=t.namespace);const i=[];return It(n,(r,a)=>{i.push(r+"="+a)}),s+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iD{constructor(){this.counters_={}}incrementCounter(e,n=1){es(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return HR(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ch={},Oh={};function gg(t){const e=t.toString();return Ch[e]||(Ch[e]=new iD),Ch[e]}function rD(t,e){const n=t.toString();return Oh[n]||(Oh[n]=e()),Oh[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aD{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const s=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<s.length;++i)s[i]&&bo(()=>{this.onMessage_(s[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ey="start",oD="close",lD="pLPCommand",cD="pRTLPCB",zS="id",VS="pw",KS="ser",uD="cb",dD="seg",fD="ts",hD="d",mD="dframe",YS=1870,WS=30,pD=YS-WS,gD=25e3,xD=3e4;class ha{constructor(e,n,s,i,r,a,l){this.connId=e,this.repoInfo=n,this.applicationId=s,this.appCheckToken=i,this.authToken=r,this.transportSessionId=a,this.lastSessionId=l,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Nc(e),this.stats_=gg(n),this.urlFn=c=>(this.appCheckToken&&(c[cp]=this.appCheckToken),FS(n,GS,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new aD(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(xD)),KM(()=>{if(this.isClosed_)return;this.scriptTagHolder=new xg((...r)=>{const[a,l,c,u,d]=r;if(this.incrementIncomingBytes_(r),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,a===ey)this.id=l,this.password=c;else if(a===oD)l?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(l,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+a)},(...r)=>{const[a,l]=r;this.incrementIncomingBytes_(r),this.myPacketOrderer.handleResponse(a,l)},()=>{this.onClosed_()},this.urlFn);const s={};s[ey]="t",s[KS]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(s[uD]=this.scriptTagHolder.uniqueCallbackIdentifier),s[OS]=pg,this.transportSessionId&&(s[MS]=this.transportSessionId),this.lastSessionId&&(s[BS]=this.lastSessionId),this.applicationId&&(s[US]=this.applicationId),this.appCheckToken&&(s[cp]=this.appCheckToken),typeof location<"u"&&location.hostname&&PS.test(location.hostname)&&(s[DS]=LS);const i=this.urlFn(s);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){ha.forceAllow_=!0}static forceDisallow(){ha.forceDisallow_=!0}static isAvailable(){return ha.forceAllow_?!0:!ha.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!WM()&&!qM()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=wt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=RN(n),i=IS(s,pD);for(let r=0;r<i.length;r++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[r]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const s={};s[mD]="t",s[zS]=e,s[VS]=n,this.myDisconnFrame.src=this.urlFn(s),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=wt(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class xg{constructor(e,n,s,i){this.onDisconnect=s,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=jS(),window[lD+this.uniqueCallbackIdentifier]=e,window[cD+this.uniqueCallbackIdentifier]=n,this.myIFrame=xg.createIFrame_();let r="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(r='<script>document.domain="'+document.domain+'";<\/script>');const a="<html><body>"+r+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(l){At("frame writing exception"),l.stack&&At(l.stack),At(l)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||At("No IE domain setting required")}catch{const s=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+s+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[zS]=this.myID,e[VS]=this.myPW,e[KS]=this.currentSerial;let n=this.urlFn(e),s="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+WS+s.length<=YS;){const a=this.pendingSegs.shift();s=s+"&"+dD+i+"="+a.seg+"&"+fD+i+"="+a.ts+"&"+hD+i+"="+a.d,i++}return n=n+s,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,s){this.pendingSegs.push({seg:e,ts:n,d:s}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const s=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(s,Math.floor(gD)),r=()=>{clearTimeout(i),s()};this.addTag(e,r)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const s=this.myIFrame.doc.createElement("script");s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){const i=s.readyState;(!i||i==="loaded"||i==="complete")&&(s.onload=s.onreadystatechange=null,s.parentNode&&s.parentNode.removeChild(s),n())},s.onerror=()=>{At("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(s)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bD=16384,vD=45e3;let vd=null;typeof MozWebSocket<"u"?vd=MozWebSocket:typeof WebSocket<"u"&&(vd=WebSocket);class Yn{constructor(e,n,s,i,r,a,l){this.connId=e,this.applicationId=s,this.appCheckToken=i,this.authToken=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Nc(this.connId),this.stats_=gg(n),this.connURL=Yn.connectionURL_(n,a,l,i,s),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,s,i,r){const a={};return a[OS]=pg,typeof location<"u"&&location.hostname&&PS.test(location.hostname)&&(a[DS]=LS),n&&(a[MS]=n),s&&(a[BS]=s),i&&(a[cp]=i),r&&(a[US]=r),FS(e,HS,a)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,dr.set("previous_websocket_failure",!0);try{let s;ZR(),this.mySock=new vd(this.connURL,[],s)}catch(s){this.log_("Error instantiating WebSocket.");const i=s.message||s.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=s=>{this.handleIncomingFrame(s)},this.mySock.onerror=s=>{this.log_("WebSocket error.  Closing connection.");const i=s.message||s.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){Yn.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,s=navigator.userAgent.match(n);s&&s.length>1&&parseFloat(s[1])<4.4&&(e=!0)}return!e&&vd!==null&&!Yn.forceDisallow_}static previouslyFailed(){return dr.isInMemoryStorage||dr.get("previous_websocket_failure")===!0}markConnectionHealthy(){dr.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const s=Ll(n);this.onMessage(s)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(Y(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const s=this.extractFrameCount_(n);s!==null&&this.appendFrame_(s)}}send(e){this.resetKeepAlive();const n=wt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=IS(n,bD);s.length>1&&this.sendString_(String(s.length));for(let i=0;i<s.length;i++)this.sendString_(s[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(vD))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Yn.responsesRequiredToBeHealthy=2;Yn.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gl{static get ALL_TRANSPORTS(){return[ha,Yn]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const n=Yn&&Yn.isAvailable();let s=n&&!Yn.previouslyFailed();if(e.webSocketOnly&&(n||Yt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[Yn];else{const i=this.transports_=[];for(const r of Gl.ALL_TRANSPORTS)r&&r.isAvailable()&&i.push(r);Gl.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Gl.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yD=6e4,_D=5e3,wD=10*1024,kD=100*1024,Mh="t",ty="d",ND="s",ny="r",SD="e",sy="o",iy="a",ry="n",ay="p",ED="h";class TD{constructor(e,n,s,i,r,a,l,c,u,d){this.id=e,this.repoInfo_=n,this.applicationId_=s,this.appCheckToken_=i,this.authToken_=r,this.onMessage_=a,this.onReady_=l,this.onDisconnect_=c,this.onKill_=u,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Nc("c:"+this.id+":"),this.transportManager_=new Gl(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),s=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,s)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=fl(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>kD?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>wD?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Mh in e){const n=e[Mh];n===iy?this.upgradeIfSecondaryHealthy_():n===ny?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===sy&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=Oo("t",e),s=Oo("d",e);if(n==="c")this.onSecondaryControl_(s);else if(n==="d")this.pendingDataMessages.push(s);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:ay,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:iy,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:ry,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=Oo("t",e),s=Oo("d",e);n==="c"?this.onControl_(s):n==="d"&&this.onDataMessage_(s)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=Oo(Mh,e);if(ty in e){const s=e[ty];if(n===ED){const i=Object.assign({},s);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===ry){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===ND?this.onConnectionShutdown_(s):n===ny?this.onReset_(s):n===SD?lp("Server Error: "+s):n===sy?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):lp("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,s=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),pg!==s&&Yt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),s=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,s),fl(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(yD))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):fl(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(_D))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:ay,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(dr.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qS{put(e,n,s,i){}merge(e,n,s,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,s){}onDisconnectMerge(e,n,s){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XS{constructor(e){this.allowedEvents_=e,this.listeners_={},Y(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const s=[...this.listeners_[e]];for(let i=0;i<s.length;i++)s[i].callback.apply(s[i].context,n)}}on(e,n,s){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:s});const i=this.getInitialEvent(e);i&&n.apply(s,i)}off(e,n,s){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let r=0;r<i.length;r++)if(i[r].callback===n&&(!s||s===i[r].context)){i.splice(r,1);return}}validateEventType_(e){Y(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd extends XS{static getInstance(){return new yd}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!tg()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return Y(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oy=32,ly=768;class Le{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let s=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[s]=this.pieces_[i],s++);this.pieces_.length=s,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function Ae(){return new Le("")}function be(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Pi(t){return t.pieces_.length-t.pieceNum_}function He(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Le(t.pieces_,e)}function bg(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function AD(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function $l(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function QS(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Le(e,0)}function it(t,e){const n=[];for(let s=t.pieceNum_;s<t.pieces_.length;s++)n.push(t.pieces_[s]);if(e instanceof Le)for(let s=e.pieceNum_;s<e.pieces_.length;s++)n.push(e.pieces_[s]);else{const s=e.split("/");for(let i=0;i<s.length;i++)s[i].length>0&&n.push(s[i])}return new Le(n,0)}function _e(t){return t.pieceNum_>=t.pieces_.length}function Vt(t,e){const n=be(t),s=be(e);if(n===null)return e;if(n===s)return Vt(He(t),He(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function jD(t,e){const n=$l(t,0),s=$l(e,0);for(let i=0;i<n.length&&i<s.length;i++){const r=$r(n[i],s[i]);if(r!==0)return r}return n.length===s.length?0:n.length<s.length?-1:1}function vg(t,e){if(Pi(t)!==Pi(e))return!1;for(let n=t.pieceNum_,s=e.pieceNum_;n<=t.pieces_.length;n++,s++)if(t.pieces_[n]!==e.pieces_[s])return!1;return!0}function On(t,e){let n=t.pieceNum_,s=e.pieceNum_;if(Pi(t)>Pi(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[s])return!1;++n,++s}return!0}class RD{constructor(e,n){this.errorPrefix_=n,this.parts_=$l(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let s=0;s<this.parts_.length;s++)this.byteLength_+=hf(this.parts_[s]);JS(this)}}function ID(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=hf(e),JS(t)}function CD(t){const e=t.parts_.pop();t.byteLength_-=hf(e),t.parts_.length>0&&(t.byteLength_-=1)}function JS(t){if(t.byteLength_>ly)throw new Error(t.errorPrefix_+"has a key path longer than "+ly+" bytes ("+t.byteLength_+").");if(t.parts_.length>oy)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+oy+") or object contains a cycle "+or(t))}function or(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yg extends XS{static getInstance(){return new yg}constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const s=!document[e];s!==this.visible_&&(this.visible_=s,this.trigger("visible",s))},!1)}getInitialEvent(e){return Y(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mo=1e3,OD=60*5*1e3,cy=30*1e3,MD=1.3,DD=3e4,LD="server_kill",uy=3;class Os extends qS{constructor(e,n,s,i,r,a,l,c){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=s,this.onConnectStatus_=i,this.onServerInfoUpdate_=r,this.authTokenProvider_=a,this.appCheckTokenProvider_=l,this.authOverride_=c,this.id=Os.nextPersistentConnectionId_++,this.log_=Nc("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Mo,this.maxReconnectDelay_=OD,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");yg.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&yd.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,s){const i=++this.requestNumber_,r={r:i,a:e,b:n};this.log_(wt(r)),Y(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),s&&(this.requestCBHash_[i]=s)}get(e){this.initConnection_();const n=new Kn,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:a=>{const l=a.d;a.s==="ok"?n.resolve(l):n.reject(l)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),n.promise}listen(e,n,s,i){this.initConnection_();const r=e._queryIdentifier,a=e._path.toString();this.log_("Listen called for "+a+" "+r),this.listens.has(a)||this.listens.set(a,new Map),Y(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Y(!this.listens.get(a).has(r),"listen() called twice for same path/queryId.");const l={onComplete:i,hashFn:n,query:e,tag:s};this.listens.get(a).set(r,l),this.connected_&&this.sendListen_(l)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,s=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(s)})}sendListen_(e){const n=e.query,s=n._path.toString(),i=n._queryIdentifier;this.log_("Listen on "+s+" for "+i);const r={p:s},a="q";e.tag&&(r.q=n._queryObject,r.t=e.tag),r.h=e.hashFn(),this.sendRequest(a,r,l=>{const c=l.d,u=l.s;Os.warnOnListenWarnings_(c,n),(this.listens.get(s)&&this.listens.get(s).get(i))===e&&(this.log_("listen response",l),u!=="ok"&&this.removeListen_(s,i),e.onComplete&&e.onComplete(u,c))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&es(e,"w")){const s=Ar(e,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){const i='".indexOn": "'+n._queryParams.getIndex().toString()+'"',r=n._path.toString();Yt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${r} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||aI(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=cy)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=rI(e)?"auth":"gauth",s={cred:e};this.authOverride_===null?s.noauth=!0:typeof this.authOverride_=="object"&&(s.authvar=this.authOverride_),this.sendRequest(n,s,i=>{const r=i.s,a=i.d||"error";this.authToken_===e&&(r==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(r,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,s=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,s)})}unlisten(e,n){const s=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+s+" "+i),Y(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,i)&&this.connected_&&this.sendUnlisten_(s,i,e._queryObject,n)}sendUnlisten_(e,n,s,i){this.log_("Unlisten on "+e+" for "+n);const r={p:e},a="n";i&&(r.q=s,r.t=i),this.sendRequest(a,r)}onDisconnectPut(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:s})}onDisconnectMerge(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:s})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,s,i){const r={p:n,d:s};this.log_("onDisconnect "+e,r),this.sendRequest(e,r,a=>{i&&setTimeout(()=>{i(a.s,a.d)},Math.floor(0))})}put(e,n,s,i){this.putInternal("p",e,n,s,i)}merge(e,n,s,i){this.putInternal("m",e,n,s,i)}putInternal(e,n,s,i,r){this.initConnection_();const a={p:n,d:s};r!==void 0&&(a.h=r),this.outstandingPuts_.push({action:e,request:a,onComplete:i}),this.outstandingPutCount_++;const l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,s=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,s,r=>{this.log_(n+" response",r),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(r.s,r.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,s=>{if(s.s!=="ok"){const r=s.d;this.log_("reportStats","Error sending stats: "+r)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+wt(e));const n=e.r,s=this.requestCBHash_[n];s&&(delete this.requestCBHash_[n],s(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):lp("Unrecognized action received from server: "+wt(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){Y(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Mo,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Mo,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>DD&&(this.reconnectDelay_=Mo),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*MD)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),s=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+Os.nextConnectionId_++,r=this.lastSessionId;let a=!1,l=null;const c=function(){l?l.close():(a=!0,s())},u=function(f){Y(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(f)};this.realtime_={close:c,sendRequest:u};const d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[f,h]=await Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);a?At("getToken() completed but was canceled"):(At("getToken() completed. Creating connection."),this.authToken_=f&&f.accessToken,this.appCheckToken_=h&&h.token,l=new TD(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,s,m=>{Yt(m+" ("+this.repoInfo_.toString()+")"),this.interrupt(LD)},r))}catch(f){this.log_("Failed to get token: "+f),a||(this.repoInfo_.nodeAdmin&&Yt(f),c())}}}interrupt(e){At("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){At("Resuming connection for reason: "+e),delete this.interruptReasons_[e],ud(this.interruptReasons_)&&(this.reconnectDelay_=Mo,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let s;n?s=n.map(r=>mg(r)).join("$"):s="default";const i=this.removeListen_(e,s);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,n){const s=new Le(e).toString();let i;if(this.listens.has(s)){const r=this.listens.get(s);i=r.get(n),r.delete(n),r.size===0&&this.listens.delete(s)}else i=void 0;return i}onAuthRevoked_(e,n){At("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=uy&&(this.reconnectDelay_=cy,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){At("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=uy&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+TS.replace(/\./g,"-")]=1,tg()?e["framework.cordova"]=1:PN()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=yd.getInstance().currentlyOnline();return ud(this.interruptReasons_)&&e}}Os.nextPersistentConnectionId_=0;Os.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new we(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const s=new we(Ya,e),i=new we(Ya,n);return this.compare(s,i)!==0}minPost(){return we.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tu;class ZS extends bf{static get __EMPTY_NODE(){return tu}static set __EMPTY_NODE(e){tu=e}compare(e,n){return $r(e.name,n.name)}isDefinedOn(e){throw mo("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return we.MIN}maxPost(){return new we(Cr,tu)}makePost(e,n){return Y(typeof e=="string","KeyIndex indexValue must always be a string."),new we(e,tu)}toString(){return".key"}}const Ia=new ZS;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nu{constructor(e,n,s,i,r=null){this.isReverse_=i,this.resultGenerator_=r,this.nodeStack_=[];let a=1;for(;!e.isEmpty();)if(e=e,a=n?s(e.key,n):1,i&&(a*=-1),a<0)this.isReverse_?e=e.left:e=e.right;else if(a===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Et{constructor(e,n,s,i,r){this.key=e,this.value=n,this.color=s??Et.RED,this.left=i??nn.EMPTY_NODE,this.right=r??nn.EMPTY_NODE}copy(e,n,s,i,r){return new Et(e??this.key,n??this.value,s??this.color,i??this.left,r??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let i=this;const r=s(e,i.key);return r<0?i=i.copy(null,null,null,i.left.insert(e,n,s),null):r===0?i=i.copy(null,n,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,n,s)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return nn.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let s,i;if(s=this,n(e,s.key)<0)!s.left.isEmpty()&&!s.left.isRed_()&&!s.left.left.isRed_()&&(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),!s.right.isEmpty()&&!s.right.isRed_()&&!s.right.left.isRed_()&&(s=s.moveRedRight_()),n(e,s.key)===0){if(s.right.isEmpty())return nn.EMPTY_NODE;i=s.right.min_(),s=s.copy(i.key,i.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Et.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Et.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Et.RED=!0;Et.BLACK=!1;class PD{copy(e,n,s,i,r){return this}insert(e,n,s){return new Et(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class nn{constructor(e,n=nn.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new nn(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Et.BLACK,null,null))}remove(e){return new nn(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Et.BLACK,null,null))}get(e){let n,s=this.root_;for(;!s.isEmpty();){if(n=this.comparator_(e,s.key),n===0)return s.value;n<0?s=s.left:n>0&&(s=s.right)}return null}getPredecessorKey(e){let n,s=this.root_,i=null;for(;!s.isEmpty();)if(n=this.comparator_(e,s.key),n===0){if(s.left.isEmpty())return i?i.key:null;for(s=s.left;!s.right.isEmpty();)s=s.right;return s.key}else n<0?s=s.left:n>0&&(i=s,s=s.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new nu(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new nu(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new nu(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new nu(this.root_,null,this.comparator_,!0,e)}}nn.EMPTY_NODE=new PD;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BD(t,e){return $r(t.name,e.name)}function _g(t,e){return $r(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let up;function UD(t){up=t}const eE=function(t){return typeof t=="number"?"number:"+CS(t):"string:"+t},tE=function(t){if(t.isLeafNode()){const e=t.val();Y(typeof e=="string"||typeof e=="number"||typeof e=="object"&&es(e,".sv"),"Priority must be a string or number.")}else Y(t===up||t.isEmpty(),"priority of unexpected type.");Y(t===up||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dy;class Nt{static set __childrenNodeConstructor(e){dy=e}static get __childrenNodeConstructor(){return dy}constructor(e,n=Nt.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,Y(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),tE(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Nt(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:Nt.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return _e(e)?this:be(e)===".priority"?this.priorityNode_:Nt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:Nt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const s=be(e);return s===null?n:n.isEmpty()&&s!==".priority"?this:(Y(s!==".priority"||Pi(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(s,Nt.__childrenNodeConstructor.EMPTY_NODE.updateChild(He(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+eE(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=CS(this.value_):e+=this.value_,this.lazyHash_=RS(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Nt.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Nt.__childrenNodeConstructor?-1:(Y(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,s=typeof this.value_,i=Nt.VALUE_TYPE_ORDER.indexOf(n),r=Nt.VALUE_TYPE_ORDER.indexOf(s);return Y(i>=0,"Unknown leaf type: "+n),Y(r>=0,"Unknown leaf type: "+s),i===r?s==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:r-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}Nt.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nE,sE;function HD(t){nE=t}function GD(t){sE=t}class $D extends bf{compare(e,n){const s=e.node.getPriority(),i=n.node.getPriority(),r=s.compareTo(i);return r===0?$r(e.name,n.name):r}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return we.MIN}maxPost(){return new we(Cr,new Nt("[PRIORITY-POST]",sE))}makePost(e,n){const s=nE(e);return new we(n,new Nt("[PRIORITY-POST]",s))}toString(){return".priority"}}const nt=new $D;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FD=Math.log(2);class zD{constructor(e){const n=r=>parseInt(Math.log(r)/FD,10),s=r=>parseInt(Array(r+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const i=s(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const _d=function(t,e,n,s){t.sort(e);const i=function(c,u){const d=u-c;let f,h;if(d===0)return null;if(d===1)return f=t[c],h=n?n(f):f,new Et(h,f.node,Et.BLACK,null,null);{const m=parseInt(d/2,10)+c,v=i(c,m),y=i(m+1,u);return f=t[m],h=n?n(f):f,new Et(h,f.node,Et.BLACK,v,y)}},r=function(c){let u=null,d=null,f=t.length;const h=function(v,y){const b=f-v,g=f;f-=v;const p=i(b+1,g),x=t[b],w=n?n(x):x;m(new Et(w,x.node,y,null,p))},m=function(v){u?(u.left=v,u=v):(d=v,u=v)};for(let v=0;v<c.count;++v){const y=c.nextBitIsOne(),b=Math.pow(2,c.count-(v+1));y?h(b,Et.BLACK):(h(b,Et.BLACK),h(b,Et.RED))}return d},a=new zD(t.length),l=r(a);return new nn(s||e,l)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Dh;const Wr={};class As{static get Default(){return Y(Wr&&nt,"ChildrenNode.ts has not been loaded"),Dh=Dh||new As({".priority":Wr},{".priority":nt}),Dh}constructor(e,n){this.indexes_=e,this.indexSet_=n}get(e){const n=Ar(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof nn?n:null}hasIndex(e){return es(this.indexSet_,e.toString())}addIndex(e,n){Y(e!==Ia,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const s=[];let i=!1;const r=n.getIterator(we.Wrap);let a=r.getNext();for(;a;)i=i||e.isDefinedOn(a.node),s.push(a),a=r.getNext();let l;i?l=_d(s,e.getCompare()):l=Wr;const c=e.toString(),u=Object.assign({},this.indexSet_);u[c]=e;const d=Object.assign({},this.indexes_);return d[c]=l,new As(d,u)}addToIndexes(e,n){const s=dd(this.indexes_,(i,r)=>{const a=Ar(this.indexSet_,r);if(Y(a,"Missing index implementation for "+r),i===Wr)if(a.isDefinedOn(e.node)){const l=[],c=n.getIterator(we.Wrap);let u=c.getNext();for(;u;)u.name!==e.name&&l.push(u),u=c.getNext();return l.push(e),_d(l,a.getCompare())}else return Wr;else{const l=n.get(e.name);let c=i;return l&&(c=c.remove(new we(e.name,l))),c.insert(e,e.node)}});return new As(s,this.indexSet_)}removeFromIndexes(e,n){const s=dd(this.indexes_,i=>{if(i===Wr)return i;{const r=n.get(e.name);return r?i.remove(new we(e.name,r)):i}});return new As(s,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Do;class oe{static get EMPTY_NODE(){return Do||(Do=new oe(new nn(_g),null,As.Default))}constructor(e,n,s){this.children_=e,this.priorityNode_=n,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&tE(this.priorityNode_),this.children_.isEmpty()&&Y(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Do}updatePriority(e){return this.children_.isEmpty()?this:new oe(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?Do:n}}getChild(e){const n=be(e);return n===null?this:this.getImmediateChild(n).getChild(He(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(Y(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const s=new we(e,n);let i,r;n.isEmpty()?(i=this.children_.remove(e),r=this.indexMap_.removeFromIndexes(s,this.children_)):(i=this.children_.insert(e,n),r=this.indexMap_.addToIndexes(s,this.children_));const a=i.isEmpty()?Do:this.priorityNode_;return new oe(i,a,r)}}updateChild(e,n){const s=be(e);if(s===null)return n;{Y(be(e)!==".priority"||Pi(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(s).updateChild(He(e),n);return this.updateImmediateChild(s,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let s=0,i=0,r=!0;if(this.forEachChild(nt,(a,l)=>{n[a]=l.val(e),s++,r&&oe.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):r=!1}),!e&&r&&i<2*s){const a=[];for(const l in n)a[l]=n[l];return a}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+eE(this.getPriority().val())+":"),this.forEachChild(nt,(n,s)=>{const i=s.hash();i!==""&&(e+=":"+n+":"+i)}),this.lazyHash_=e===""?"":RS(e)}return this.lazyHash_}getPredecessorChildName(e,n,s){const i=this.resolveIndex_(s);if(i){const r=i.getPredecessorKey(new we(e,n));return r?r.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.minKey();return s&&s.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new we(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.maxKey();return s&&s.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new we(n,this.children_.get(n)):null}forEachChild(e,n){const s=this.resolveIndex_(e);return s?s.inorderTraversal(i=>n(i.name,i.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,we.Wrap);let r=i.peek();for(;r!=null&&n.compare(r,e)<0;)i.getNext(),r=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,we.Wrap);let r=i.peek();for(;r!=null&&n.compare(r,e)>0;)i.getNext(),r=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Sc?-1:0}withIndex(e){if(e===Ia||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new oe(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===Ia||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const s=this.getIterator(nt),i=n.getIterator(nt);let r=s.getNext(),a=i.getNext();for(;r&&a;){if(r.name!==a.name||!r.node.equals(a.node))return!1;r=s.getNext(),a=i.getNext()}return r===null&&a===null}else return!1;else return!1}}resolveIndex_(e){return e===Ia?null:this.indexMap_.get(e.toString())}}oe.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class VD extends oe{constructor(){super(new nn(_g),oe.EMPTY_NODE,As.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return oe.EMPTY_NODE}isEmpty(){return!1}}const Sc=new VD;Object.defineProperties(we,{MIN:{value:new we(Ya,oe.EMPTY_NODE)},MAX:{value:new we(Cr,Sc)}});ZS.__EMPTY_NODE=oe.EMPTY_NODE;Nt.__childrenNodeConstructor=oe;UD(Sc);GD(Sc);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KD=!0;function st(t,e=null){if(t===null)return oe.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),Y(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new Nt(n,st(e))}if(!(t instanceof Array)&&KD){const n=[];let s=!1;if(It(t,(a,l)=>{if(a.substring(0,1)!=="."){const c=st(l);c.isEmpty()||(s=s||!c.getPriority().isEmpty(),n.push(new we(a,c)))}}),n.length===0)return oe.EMPTY_NODE;const r=_d(n,BD,a=>a.name,_g);if(s){const a=_d(n,nt.getCompare());return new oe(r,st(e),new As({".priority":a},{".priority":nt}))}else return new oe(r,st(e),As.Default)}else{let n=oe.EMPTY_NODE;return It(t,(s,i)=>{if(es(t,s)&&s.substring(0,1)!=="."){const r=st(i);(r.isLeafNode()||!r.isEmpty())&&(n=n.updateImmediateChild(s,r))}}),n.updatePriority(st(e))}}HD(st);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YD extends bf{constructor(e){super(),this.indexPath_=e,Y(!_e(e)&&be(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const s=this.extractChild(e.node),i=this.extractChild(n.node),r=s.compareTo(i);return r===0?$r(e.name,n.name):r}makePost(e,n){const s=st(e),i=oe.EMPTY_NODE.updateChild(this.indexPath_,s);return new we(n,i)}maxPost(){const e=oe.EMPTY_NODE.updateChild(this.indexPath_,Sc);return new we(Cr,e)}toString(){return $l(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WD extends bf{compare(e,n){const s=e.node.compareTo(n.node);return s===0?$r(e.name,n.name):s}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return we.MIN}maxPost(){return we.MAX}makePost(e,n){const s=st(e);return new we(n,s)}toString(){return".value"}}const qD=new WD;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iE(t){return{type:"value",snapshotNode:t}}function Wa(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Fl(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function zl(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function XD(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wg{constructor(e){this.index_=e}updateChild(e,n,s,i,r,a){Y(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const l=e.getImmediateChild(n);return l.getChild(i).equals(s.getChild(i))&&l.isEmpty()===s.isEmpty()||(a!=null&&(s.isEmpty()?e.hasChild(n)?a.trackChildChange(Fl(n,l)):Y(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):l.isEmpty()?a.trackChildChange(Wa(n,s)):a.trackChildChange(zl(n,s,l))),e.isLeafNode()&&s.isEmpty())?e:e.updateImmediateChild(n,s).withIndex(this.index_)}updateFullNode(e,n,s){return s!=null&&(e.isLeafNode()||e.forEachChild(nt,(i,r)=>{n.hasChild(i)||s.trackChildChange(Fl(i,r))}),n.isLeafNode()||n.forEachChild(nt,(i,r)=>{if(e.hasChild(i)){const a=e.getImmediateChild(i);a.equals(r)||s.trackChildChange(zl(i,r,a))}else s.trackChildChange(Wa(i,r))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?oe.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl{constructor(e){this.indexedFilter_=new wg(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Vl.getStartPost_(e),this.endPost_=Vl.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,s=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&s}updateChild(e,n,s,i,r,a){return this.matches(new we(n,s))||(s=oe.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,s,i,r,a)}updateFullNode(e,n,s){n.isLeafNode()&&(n=oe.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(oe.EMPTY_NODE);const r=this;return n.forEachChild(nt,(a,l)=>{r.matches(new we(a,l))||(i=i.updateImmediateChild(a,oe.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QD{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const s=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?s<=0:s<0},this.withinEndPost=n=>{const s=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?s<=0:s<0},this.rangedFilter_=new Vl(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,s,i,r,a){return this.rangedFilter_.matches(new we(n,s))||(s=oe.EMPTY_NODE),e.getImmediateChild(n).equals(s)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,s,i,r,a):this.fullLimitUpdateChild_(e,n,s,r,a)}updateFullNode(e,n,s){let i;if(n.isLeafNode()||n.isEmpty())i=oe.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=oe.EMPTY_NODE.withIndex(this.index_);let r;this.reverse_?r=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):r=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let a=0;for(;r.hasNext()&&a<this.limit_;){const l=r.getNext();if(this.withinDirectionalStart(l))if(this.withinDirectionalEnd(l))i=i.updateImmediateChild(l.name,l.node),a++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(oe.EMPTY_NODE);let r;this.reverse_?r=i.getReverseIterator(this.index_):r=i.getIterator(this.index_);let a=0;for(;r.hasNext();){const l=r.getNext();a<this.limit_&&this.withinDirectionalStart(l)&&this.withinDirectionalEnd(l)?a++:i=i.updateImmediateChild(l.name,oe.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,s,i,r){let a;if(this.reverse_){const f=this.index_.getCompare();a=(h,m)=>f(m,h)}else a=this.index_.getCompare();const l=e;Y(l.numChildren()===this.limit_,"");const c=new we(n,s),u=this.reverse_?l.getFirstChild(this.index_):l.getLastChild(this.index_),d=this.rangedFilter_.matches(c);if(l.hasChild(n)){const f=l.getImmediateChild(n);let h=i.getChildAfterChild(this.index_,u,this.reverse_);for(;h!=null&&(h.name===n||l.hasChild(h.name));)h=i.getChildAfterChild(this.index_,h,this.reverse_);const m=h==null?1:a(h,c);if(d&&!s.isEmpty()&&m>=0)return r!=null&&r.trackChildChange(zl(n,s,f)),l.updateImmediateChild(n,s);{r!=null&&r.trackChildChange(Fl(n,f));const y=l.updateImmediateChild(n,oe.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(r!=null&&r.trackChildChange(Wa(h.name,h.node)),y.updateImmediateChild(h.name,h.node)):y}}else return s.isEmpty()?e:d&&a(u,c)>=0?(r!=null&&(r.trackChildChange(Fl(u.name,u.node)),r.trackChildChange(Wa(n,s))),l.updateImmediateChild(n,s).updateImmediateChild(u.name,oe.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kg{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=nt}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return Y(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return Y(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ya}hasEnd(){return this.endSet_}getIndexEndValue(){return Y(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return Y(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Cr}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return Y(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===nt}copy(){const e=new kg;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function JD(t){return t.loadsAllData()?new wg(t.getIndex()):t.hasLimit()?new QD(t):new Vl(t)}function ZD(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function fy(t){const e={};if(t.isDefault())return e;let n;if(t.index_===nt?n="$priority":t.index_===qD?n="$value":t.index_===Ia?n="$key":(Y(t.index_ instanceof YD,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=wt(n),t.startSet_){const s=t.startAfterSet_?"startAfter":"startAt";e[s]=wt(t.indexStartValue_),t.startNameSet_&&(e[s]+=","+wt(t.indexStartName_))}if(t.endSet_){const s=t.endBeforeSet_?"endBefore":"endAt";e[s]=wt(t.indexEndValue_),t.endNameSet_&&(e[s]+=","+wt(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function hy(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==nt&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd extends qS{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(Y(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,n,s,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=s,this.appCheckTokenProvider_=i,this.log_=Nc("p:rest:"),this.listens_={}}listen(e,n,s,i){const r=e._path.toString();this.log_("Listen called for "+r+" "+e._queryIdentifier);const a=wd.getListenId_(e,s),l={};this.listens_[a]=l;const c=fy(e._queryParams);this.restRequest_(r+".json",c,(u,d)=>{let f=d;if(u===404&&(f=null,u=null),u===null&&this.onDataUpdate_(r,f,!1,s),Ar(this.listens_,a)===l){let h;u?u===401?h="permission_denied":h="rest_error:"+u:h="ok",i(h,null)}})}unlisten(e,n){const s=wd.getListenId_(e,n);delete this.listens_[s]}get(e){const n=fy(e._queryParams),s=e._path.toString(),i=new Kn;return this.restRequest_(s+".json",n,(r,a)=>{let l=a;r===404&&(l=null,r=null),r===null?(this.onDataUpdate_(s,l,!1,null),i.resolve(l)):i.reject(new Error(l))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},s){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,r])=>{i&&i.accessToken&&(n.auth=i.accessToken),r&&r.token&&(n.ac=r.token);const a=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+go(n);this.log_("Sending REST request for "+a);const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(s&&l.readyState===4){this.log_("REST Response for "+a+" received. status:",l.status,"response:",l.responseText);let c=null;if(l.status>=200&&l.status<300){try{c=Ll(l.responseText)}catch{Yt("Failed to parse JSON response for "+a+": "+l.responseText)}s(null,c)}else l.status!==401&&l.status!==404&&Yt("Got unsuccessful REST response for "+a+" Status: "+l.status),s(l.status);s=null}},l.open("GET",a,!0),l.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e4{constructor(){this.rootNode_=oe.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kd(){return{value:null,children:new Map}}function vo(t,e,n){if(_e(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const s=be(e);t.children.has(s)||t.children.set(s,kd());const i=t.children.get(s);e=He(e),vo(i,e,n)}}function dp(t,e){if(_e(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(nt,(s,i)=>{vo(t,new Le(s),i)}),dp(t,e)}}else if(t.children.size>0){const n=be(e);return e=He(e),t.children.has(n)&&dp(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function fp(t,e,n){t.value!==null?n(e,t.value):t4(t,(s,i)=>{const r=new Le(e.toString()+"/"+s);fp(i,r,n)})}function t4(t,e){t.children.forEach((n,s)=>{e(s,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n4{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&It(this.last_,(s,i)=>{n[s]=n[s]-i}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const my=10*1e3,s4=30*1e3,i4=5*60*1e3;class r4{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new n4(e);const s=my+(s4-my)*Math.random();fl(this.reportStats_.bind(this),Math.floor(s))}reportStats_(){const e=this.statsListener_.get(),n={};let s=!1;It(e,(i,r)=>{r>0&&es(this.statsToReport_,i)&&(n[i]=r,s=!0)}),s&&this.server_.reportStats(n),fl(this.reportStats_.bind(this),Math.floor(Math.random()*2*i4))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var qn;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(qn||(qn={}));function Ng(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Sg(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Eg(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd{constructor(e,n,s){this.path=e,this.affectedTree=n,this.revert=s,this.type=qn.ACK_USER_WRITE,this.source=Ng()}operationForChild(e){if(_e(this.path)){if(this.affectedTree.value!=null)return Y(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Le(e));return new Nd(Ae(),n,this.revert)}}else return Y(be(this.path)===e,"operationForChild called for unrelated child."),new Nd(He(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kl{constructor(e,n){this.source=e,this.path=n,this.type=qn.LISTEN_COMPLETE}operationForChild(e){return _e(this.path)?new Kl(this.source,Ae()):new Kl(this.source,He(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(e,n,s){this.source=e,this.path=n,this.snap=s,this.type=qn.OVERWRITE}operationForChild(e){return _e(this.path)?new Or(this.source,Ae(),this.snap.getImmediateChild(e)):new Or(this.source,He(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qa{constructor(e,n,s){this.source=e,this.path=n,this.children=s,this.type=qn.MERGE}operationForChild(e){if(_e(this.path)){const n=this.children.subtree(new Le(e));return n.isEmpty()?null:n.value?new Or(this.source,Ae(),n.value):new qa(this.source,Ae(),n)}else return Y(be(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new qa(this.source,He(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(e,n,s){this.node_=e,this.fullyInitialized_=n,this.filtered_=s}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(_e(e))return this.isFullyInitialized()&&!this.filtered_;const n=be(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a4{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function o4(t,e,n,s){const i=[],r=[];return e.forEach(a=>{a.type==="child_changed"&&t.index_.indexedValueChanged(a.oldSnap,a.snapshotNode)&&r.push(XD(a.childName,a.snapshotNode))}),Lo(t,i,"child_removed",e,s,n),Lo(t,i,"child_added",e,s,n),Lo(t,i,"child_moved",r,s,n),Lo(t,i,"child_changed",e,s,n),Lo(t,i,"value",e,s,n),i}function Lo(t,e,n,s,i,r){const a=s.filter(l=>l.type===n);a.sort((l,c)=>c4(t,l,c)),a.forEach(l=>{const c=l4(t,l,r);i.forEach(u=>{u.respondsTo(l.type)&&e.push(u.createEvent(c,t.query_))})})}function l4(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function c4(t,e,n){if(e.childName==null||n.childName==null)throw mo("Should only compare child_ events.");const s=new we(e.childName,e.snapshotNode),i=new we(n.childName,n.snapshotNode);return t.index_.compare(s,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vf(t,e){return{eventCache:t,serverCache:e}}function hl(t,e,n,s){return vf(new Bi(e,n,s),t.serverCache)}function rE(t,e,n,s){return vf(t.eventCache,new Bi(e,n,s))}function Sd(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Mr(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Lh;const u4=()=>(Lh||(Lh=new nn(YM)),Lh);class Ve{static fromObject(e){let n=new Ve(null);return It(e,(s,i)=>{n=n.set(new Le(s),i)}),n}constructor(e,n=u4()){this.value=e,this.children=n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:Ae(),value:this.value};if(_e(e))return null;{const s=be(e),i=this.children.get(s);if(i!==null){const r=i.findRootMostMatchingPathAndValue(He(e),n);return r!=null?{path:it(new Le(s),r.path),value:r.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(_e(e))return this;{const n=be(e),s=this.children.get(n);return s!==null?s.subtree(He(e)):new Ve(null)}}set(e,n){if(_e(e))return new Ve(n,this.children);{const s=be(e),r=(this.children.get(s)||new Ve(null)).set(He(e),n),a=this.children.insert(s,r);return new Ve(this.value,a)}}remove(e){if(_e(e))return this.children.isEmpty()?new Ve(null):new Ve(null,this.children);{const n=be(e),s=this.children.get(n);if(s){const i=s.remove(He(e));let r;return i.isEmpty()?r=this.children.remove(n):r=this.children.insert(n,i),this.value===null&&r.isEmpty()?new Ve(null):new Ve(this.value,r)}else return this}}get(e){if(_e(e))return this.value;{const n=be(e),s=this.children.get(n);return s?s.get(He(e)):null}}setTree(e,n){if(_e(e))return n;{const s=be(e),r=(this.children.get(s)||new Ve(null)).setTree(He(e),n);let a;return r.isEmpty()?a=this.children.remove(s):a=this.children.insert(s,r),new Ve(this.value,a)}}fold(e){return this.fold_(Ae(),e)}fold_(e,n){const s={};return this.children.inorderTraversal((i,r)=>{s[i]=r.fold_(it(e,i),n)}),n(e,this.value,s)}findOnPath(e,n){return this.findOnPath_(e,Ae(),n)}findOnPath_(e,n,s){const i=this.value?s(n,this.value):!1;if(i)return i;if(_e(e))return null;{const r=be(e),a=this.children.get(r);return a?a.findOnPath_(He(e),it(n,r),s):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,Ae(),n)}foreachOnPath_(e,n,s){if(_e(e))return this;{this.value&&s(n,this.value);const i=be(e),r=this.children.get(i);return r?r.foreachOnPath_(He(e),it(n,i),s):new Ve(null)}}foreach(e){this.foreach_(Ae(),e)}foreach_(e,n){this.children.inorderTraversal((s,i)=>{i.foreach_(it(e,s),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,s)=>{s.value&&e(n,s.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn{constructor(e){this.writeTree_=e}static empty(){return new Xn(new Ve(null))}}function ml(t,e,n){if(_e(e))return new Xn(new Ve(n));{const s=t.writeTree_.findRootMostValueAndPath(e);if(s!=null){const i=s.path;let r=s.value;const a=Vt(i,e);return r=r.updateChild(a,n),new Xn(t.writeTree_.set(i,r))}else{const i=new Ve(n),r=t.writeTree_.setTree(e,i);return new Xn(r)}}}function hp(t,e,n){let s=t;return It(n,(i,r)=>{s=ml(s,it(e,i),r)}),s}function py(t,e){if(_e(e))return Xn.empty();{const n=t.writeTree_.setTree(e,new Ve(null));return new Xn(n)}}function mp(t,e){return Fr(t,e)!=null}function Fr(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Vt(n.path,e)):null}function gy(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(nt,(s,i)=>{e.push(new we(s,i))}):t.writeTree_.children.inorderTraversal((s,i)=>{i.value!=null&&e.push(new we(s,i.value))}),e}function Ri(t,e){if(_e(e))return t;{const n=Fr(t,e);return n!=null?new Xn(new Ve(n)):new Xn(t.writeTree_.subtree(e))}}function pp(t){return t.writeTree_.isEmpty()}function Xa(t,e){return aE(Ae(),t.writeTree_,e)}function aE(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let s=null;return e.children.inorderTraversal((i,r)=>{i===".priority"?(Y(r.value!==null,"Priority writes must always be leaf nodes"),s=r.value):n=aE(it(t,i),r,n)}),!n.getChild(t).isEmpty()&&s!==null&&(n=n.updateChild(it(t,".priority"),s)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yf(t,e){return uE(e,t)}function d4(t,e,n,s,i){Y(s>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:s,visible:i}),i&&(t.visibleWrites=ml(t.visibleWrites,e,n)),t.lastWriteId=s}function f4(t,e,n,s){Y(s>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:s,visible:!0}),t.visibleWrites=hp(t.visibleWrites,e,n),t.lastWriteId=s}function h4(t,e){for(let n=0;n<t.allWrites.length;n++){const s=t.allWrites[n];if(s.writeId===e)return s}return null}function m4(t,e){const n=t.allWrites.findIndex(l=>l.writeId===e);Y(n>=0,"removeWrite called with nonexistent writeId.");const s=t.allWrites[n];t.allWrites.splice(n,1);let i=s.visible,r=!1,a=t.allWrites.length-1;for(;i&&a>=0;){const l=t.allWrites[a];l.visible&&(a>=n&&p4(l,s.path)?i=!1:On(s.path,l.path)&&(r=!0)),a--}if(i){if(r)return g4(t),!0;if(s.snap)t.visibleWrites=py(t.visibleWrites,s.path);else{const l=s.children;It(l,c=>{t.visibleWrites=py(t.visibleWrites,it(s.path,c))})}return!0}else return!1}function p4(t,e){if(t.snap)return On(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&On(it(t.path,n),e))return!0;return!1}function g4(t){t.visibleWrites=oE(t.allWrites,x4,Ae()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function x4(t){return t.visible}function oE(t,e,n){let s=Xn.empty();for(let i=0;i<t.length;++i){const r=t[i];if(e(r)){const a=r.path;let l;if(r.snap)On(n,a)?(l=Vt(n,a),s=ml(s,l,r.snap)):On(a,n)&&(l=Vt(a,n),s=ml(s,Ae(),r.snap.getChild(l)));else if(r.children){if(On(n,a))l=Vt(n,a),s=hp(s,l,r.children);else if(On(a,n))if(l=Vt(a,n),_e(l))s=hp(s,Ae(),r.children);else{const c=Ar(r.children,be(l));if(c){const u=c.getChild(He(l));s=ml(s,Ae(),u)}}}else throw mo("WriteRecord should have .snap or .children")}}return s}function lE(t,e,n,s,i){if(!s&&!i){const r=Fr(t.visibleWrites,e);if(r!=null)return r;{const a=Ri(t.visibleWrites,e);if(pp(a))return n;if(n==null&&!mp(a,Ae()))return null;{const l=n||oe.EMPTY_NODE;return Xa(a,l)}}}else{const r=Ri(t.visibleWrites,e);if(!i&&pp(r))return n;if(!i&&n==null&&!mp(r,Ae()))return null;{const a=function(u){return(u.visible||i)&&(!s||!~s.indexOf(u.writeId))&&(On(u.path,e)||On(e,u.path))},l=oE(t.allWrites,a,e),c=n||oe.EMPTY_NODE;return Xa(l,c)}}}function b4(t,e,n){let s=oe.EMPTY_NODE;const i=Fr(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(nt,(r,a)=>{s=s.updateImmediateChild(r,a)}),s;if(n){const r=Ri(t.visibleWrites,e);return n.forEachChild(nt,(a,l)=>{const c=Xa(Ri(r,new Le(a)),l);s=s.updateImmediateChild(a,c)}),gy(r).forEach(a=>{s=s.updateImmediateChild(a.name,a.node)}),s}else{const r=Ri(t.visibleWrites,e);return gy(r).forEach(a=>{s=s.updateImmediateChild(a.name,a.node)}),s}}function v4(t,e,n,s,i){Y(s||i,"Either existingEventSnap or existingServerSnap must exist");const r=it(e,n);if(mp(t.visibleWrites,r))return null;{const a=Ri(t.visibleWrites,r);return pp(a)?i.getChild(n):Xa(a,i.getChild(n))}}function y4(t,e,n,s){const i=it(e,n),r=Fr(t.visibleWrites,i);if(r!=null)return r;if(s.isCompleteForChild(n)){const a=Ri(t.visibleWrites,i);return Xa(a,s.getNode().getImmediateChild(n))}else return null}function _4(t,e){return Fr(t.visibleWrites,e)}function w4(t,e,n,s,i,r,a){let l;const c=Ri(t.visibleWrites,e),u=Fr(c,Ae());if(u!=null)l=u;else if(n!=null)l=Xa(c,n);else return[];if(l=l.withIndex(a),!l.isEmpty()&&!l.isLeafNode()){const d=[],f=a.getCompare(),h=r?l.getReverseIteratorFrom(s,a):l.getIteratorFrom(s,a);let m=h.getNext();for(;m&&d.length<i;)f(m,s)!==0&&d.push(m),m=h.getNext();return d}else return[]}function k4(){return{visibleWrites:Xn.empty(),allWrites:[],lastWriteId:-1}}function Ed(t,e,n,s){return lE(t.writeTree,t.treePath,e,n,s)}function Tg(t,e){return b4(t.writeTree,t.treePath,e)}function xy(t,e,n,s){return v4(t.writeTree,t.treePath,e,n,s)}function Td(t,e){return _4(t.writeTree,it(t.treePath,e))}function N4(t,e,n,s,i,r){return w4(t.writeTree,t.treePath,e,n,s,i,r)}function Ag(t,e,n){return y4(t.writeTree,t.treePath,e,n)}function cE(t,e){return uE(it(t.treePath,e),t.writeTree)}function uE(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S4{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,s=e.childName;Y(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),Y(s!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(s);if(i){const r=i.type;if(n==="child_added"&&r==="child_removed")this.changeMap.set(s,zl(s,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&r==="child_added")this.changeMap.delete(s);else if(n==="child_removed"&&r==="child_changed")this.changeMap.set(s,Fl(s,i.oldSnap));else if(n==="child_changed"&&r==="child_added")this.changeMap.set(s,Wa(s,e.snapshotNode));else if(n==="child_changed"&&r==="child_changed")this.changeMap.set(s,zl(s,e.snapshotNode,i.oldSnap));else throw mo("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(s,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E4{getCompleteChild(e){return null}getChildAfterChild(e,n,s){return null}}const dE=new E4;class jg{constructor(e,n,s=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=s}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const s=this.optCompleteServerCache_!=null?new Bi(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Ag(this.writes_,e,s)}}getChildAfterChild(e,n,s){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Mr(this.viewCache_),r=N4(this.writes_,i,n,1,s,e);return r.length===0?null:r[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T4(t){return{filter:t}}function A4(t,e){Y(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),Y(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function j4(t,e,n,s,i){const r=new S4;let a,l;if(n.type===qn.OVERWRITE){const u=n;u.source.fromUser?a=gp(t,e,u.path,u.snap,s,i,r):(Y(u.source.fromServer,"Unknown source."),l=u.source.tagged||e.serverCache.isFiltered()&&!_e(u.path),a=Ad(t,e,u.path,u.snap,s,i,l,r))}else if(n.type===qn.MERGE){const u=n;u.source.fromUser?a=I4(t,e,u.path,u.children,s,i,r):(Y(u.source.fromServer,"Unknown source."),l=u.source.tagged||e.serverCache.isFiltered(),a=xp(t,e,u.path,u.children,s,i,l,r))}else if(n.type===qn.ACK_USER_WRITE){const u=n;u.revert?a=M4(t,e,u.path,s,i,r):a=C4(t,e,u.path,u.affectedTree,s,i,r)}else if(n.type===qn.LISTEN_COMPLETE)a=O4(t,e,n.path,s,r);else throw mo("Unknown operation type: "+n.type);const c=r.getChanges();return R4(e,a,c),{viewCache:a,changes:c}}function R4(t,e,n){const s=e.eventCache;if(s.isFullyInitialized()){const i=s.getNode().isLeafNode()||s.getNode().isEmpty(),r=Sd(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!s.getNode().equals(r)||!s.getNode().getPriority().equals(r.getPriority()))&&n.push(iE(Sd(e)))}}function fE(t,e,n,s,i,r){const a=e.eventCache;if(Td(s,n)!=null)return e;{let l,c;if(_e(n))if(Y(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const u=Mr(e),d=u instanceof oe?u:oe.EMPTY_NODE,f=Tg(s,d);l=t.filter.updateFullNode(e.eventCache.getNode(),f,r)}else{const u=Ed(s,Mr(e));l=t.filter.updateFullNode(e.eventCache.getNode(),u,r)}else{const u=be(n);if(u===".priority"){Y(Pi(n)===1,"Can't have a priority with additional path components");const d=a.getNode();c=e.serverCache.getNode();const f=xy(s,n,d,c);f!=null?l=t.filter.updatePriority(d,f):l=a.getNode()}else{const d=He(n);let f;if(a.isCompleteForChild(u)){c=e.serverCache.getNode();const h=xy(s,n,a.getNode(),c);h!=null?f=a.getNode().getImmediateChild(u).updateChild(d,h):f=a.getNode().getImmediateChild(u)}else f=Ag(s,u,e.serverCache);f!=null?l=t.filter.updateChild(a.getNode(),u,f,d,i,r):l=a.getNode()}}return hl(e,l,a.isFullyInitialized()||_e(n),t.filter.filtersNodes())}}function Ad(t,e,n,s,i,r,a,l){const c=e.serverCache;let u;const d=a?t.filter:t.filter.getIndexedFilter();if(_e(n))u=d.updateFullNode(c.getNode(),s,null);else if(d.filtersNodes()&&!c.isFiltered()){const m=c.getNode().updateChild(n,s);u=d.updateFullNode(c.getNode(),m,null)}else{const m=be(n);if(!c.isCompleteForPath(n)&&Pi(n)>1)return e;const v=He(n),b=c.getNode().getImmediateChild(m).updateChild(v,s);m===".priority"?u=d.updatePriority(c.getNode(),b):u=d.updateChild(c.getNode(),m,b,v,dE,null)}const f=rE(e,u,c.isFullyInitialized()||_e(n),d.filtersNodes()),h=new jg(i,f,r);return fE(t,f,n,i,h,l)}function gp(t,e,n,s,i,r,a){const l=e.eventCache;let c,u;const d=new jg(i,e,r);if(_e(n))u=t.filter.updateFullNode(e.eventCache.getNode(),s,a),c=hl(e,u,!0,t.filter.filtersNodes());else{const f=be(n);if(f===".priority")u=t.filter.updatePriority(e.eventCache.getNode(),s),c=hl(e,u,l.isFullyInitialized(),l.isFiltered());else{const h=He(n),m=l.getNode().getImmediateChild(f);let v;if(_e(h))v=s;else{const y=d.getCompleteChild(f);y!=null?bg(h)===".priority"&&y.getChild(QS(h)).isEmpty()?v=y:v=y.updateChild(h,s):v=oe.EMPTY_NODE}if(m.equals(v))c=e;else{const y=t.filter.updateChild(l.getNode(),f,v,h,d,a);c=hl(e,y,l.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function by(t,e){return t.eventCache.isCompleteForChild(e)}function I4(t,e,n,s,i,r,a){let l=e;return s.foreach((c,u)=>{const d=it(n,c);by(e,be(d))&&(l=gp(t,l,d,u,i,r,a))}),s.foreach((c,u)=>{const d=it(n,c);by(e,be(d))||(l=gp(t,l,d,u,i,r,a))}),l}function vy(t,e,n){return n.foreach((s,i)=>{e=e.updateChild(s,i)}),e}function xp(t,e,n,s,i,r,a,l){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,u;_e(n)?u=s:u=new Ve(null).setTree(n,s);const d=e.serverCache.getNode();return u.children.inorderTraversal((f,h)=>{if(d.hasChild(f)){const m=e.serverCache.getNode().getImmediateChild(f),v=vy(t,m,h);c=Ad(t,c,new Le(f),v,i,r,a,l)}}),u.children.inorderTraversal((f,h)=>{const m=!e.serverCache.isCompleteForChild(f)&&h.value===null;if(!d.hasChild(f)&&!m){const v=e.serverCache.getNode().getImmediateChild(f),y=vy(t,v,h);c=Ad(t,c,new Le(f),y,i,r,a,l)}}),c}function C4(t,e,n,s,i,r,a){if(Td(i,n)!=null)return e;const l=e.serverCache.isFiltered(),c=e.serverCache;if(s.value!=null){if(_e(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return Ad(t,e,n,c.getNode().getChild(n),i,r,l,a);if(_e(n)){let u=new Ve(null);return c.getNode().forEachChild(Ia,(d,f)=>{u=u.set(new Le(d),f)}),xp(t,e,n,u,i,r,l,a)}else return e}else{let u=new Ve(null);return s.foreach((d,f)=>{const h=it(n,d);c.isCompleteForPath(h)&&(u=u.set(d,c.getNode().getChild(h)))}),xp(t,e,n,u,i,r,l,a)}}function O4(t,e,n,s,i){const r=e.serverCache,a=rE(e,r.getNode(),r.isFullyInitialized()||_e(n),r.isFiltered());return fE(t,a,n,s,dE,i)}function M4(t,e,n,s,i,r){let a;if(Td(s,n)!=null)return e;{const l=new jg(s,e,i),c=e.eventCache.getNode();let u;if(_e(n)||be(n)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=Ed(s,Mr(e));else{const f=e.serverCache.getNode();Y(f instanceof oe,"serverChildren would be complete if leaf node"),d=Tg(s,f)}d=d,u=t.filter.updateFullNode(c,d,r)}else{const d=be(n);let f=Ag(s,d,e.serverCache);f==null&&e.serverCache.isCompleteForChild(d)&&(f=c.getImmediateChild(d)),f!=null?u=t.filter.updateChild(c,d,f,He(n),l,r):e.eventCache.getNode().hasChild(d)?u=t.filter.updateChild(c,d,oe.EMPTY_NODE,He(n),l,r):u=c,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(a=Ed(s,Mr(e)),a.isLeafNode()&&(u=t.filter.updateFullNode(u,a,r)))}return a=e.serverCache.isFullyInitialized()||Td(s,Ae())!=null,hl(e,u,a,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D4{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const s=this.query_._queryParams,i=new wg(s.getIndex()),r=JD(s);this.processor_=T4(r);const a=n.serverCache,l=n.eventCache,c=i.updateFullNode(oe.EMPTY_NODE,a.getNode(),null),u=r.updateFullNode(oe.EMPTY_NODE,l.getNode(),null),d=new Bi(c,a.isFullyInitialized(),i.filtersNodes()),f=new Bi(u,l.isFullyInitialized(),r.filtersNodes());this.viewCache_=vf(f,d),this.eventGenerator_=new a4(this.query_)}get query(){return this.query_}}function L4(t){return t.viewCache_.serverCache.getNode()}function P4(t){return Sd(t.viewCache_)}function B4(t,e){const n=Mr(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!_e(e)&&!n.getImmediateChild(be(e)).isEmpty())?n.getChild(e):null}function yy(t){return t.eventRegistrations_.length===0}function U4(t,e){t.eventRegistrations_.push(e)}function _y(t,e,n){const s=[];if(n){Y(e==null,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach(r=>{const a=r.createCancelEvent(n,i);a&&s.push(a)})}if(e){let i=[];for(let r=0;r<t.eventRegistrations_.length;++r){const a=t.eventRegistrations_[r];if(!a.matches(e))i.push(a);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(r+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return s}function wy(t,e,n,s){e.type===qn.MERGE&&e.source.queryId!==null&&(Y(Mr(t.viewCache_),"We should always have a full cache before handling merges"),Y(Sd(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,r=j4(t.processor_,i,e,n,s);return A4(t.processor_,r.viewCache),Y(r.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=r.viewCache,hE(t,r.changes,r.viewCache.eventCache.getNode(),null)}function H4(t,e){const n=t.viewCache_.eventCache,s=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(nt,(r,a)=>{s.push(Wa(r,a))}),n.isFullyInitialized()&&s.push(iE(n.getNode())),hE(t,s,n.getNode(),e)}function hE(t,e,n,s){const i=s?[s]:t.eventRegistrations_;return o4(t.eventGenerator_,e,n,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jd;class mE{constructor(){this.views=new Map}}function G4(t){Y(!jd,"__referenceConstructor has already been defined"),jd=t}function $4(){return Y(jd,"Reference.ts has not been loaded"),jd}function F4(t){return t.views.size===0}function Rg(t,e,n,s){const i=e.source.queryId;if(i!==null){const r=t.views.get(i);return Y(r!=null,"SyncTree gave us an op for an invalid query."),wy(r,e,n,s)}else{let r=[];for(const a of t.views.values())r=r.concat(wy(a,e,n,s));return r}}function pE(t,e,n,s,i){const r=e._queryIdentifier,a=t.views.get(r);if(!a){let l=Ed(n,i?s:null),c=!1;l?c=!0:s instanceof oe?(l=Tg(n,s),c=!1):(l=oe.EMPTY_NODE,c=!1);const u=vf(new Bi(l,c,!1),new Bi(s,i,!1));return new D4(e,u)}return a}function z4(t,e,n,s,i,r){const a=pE(t,e,s,i,r);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,a),U4(a,n),H4(a,n)}function V4(t,e,n,s){const i=e._queryIdentifier,r=[];let a=[];const l=Ui(t);if(i==="default")for(const[c,u]of t.views.entries())a=a.concat(_y(u,n,s)),yy(u)&&(t.views.delete(c),u.query._queryParams.loadsAllData()||r.push(u.query));else{const c=t.views.get(i);c&&(a=a.concat(_y(c,n,s)),yy(c)&&(t.views.delete(i),c.query._queryParams.loadsAllData()||r.push(c.query)))}return l&&!Ui(t)&&r.push(new($4())(e._repo,e._path)),{removed:r,events:a}}function gE(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Ii(t,e){let n=null;for(const s of t.views.values())n=n||B4(s,e);return n}function xE(t,e){if(e._queryParams.loadsAllData())return _f(t);{const s=e._queryIdentifier;return t.views.get(s)}}function bE(t,e){return xE(t,e)!=null}function Ui(t){return _f(t)!=null}function _f(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rd;function K4(t){Y(!Rd,"__referenceConstructor has already been defined"),Rd=t}function Y4(){return Y(Rd,"Reference.ts has not been loaded"),Rd}let W4=1;class ky{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Ve(null),this.pendingWriteTree_=k4(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Ig(t,e,n,s,i){return d4(t.pendingWriteTree_,e,n,s,i),i?yo(t,new Or(Ng(),e,n)):[]}function q4(t,e,n,s){f4(t.pendingWriteTree_,e,n,s);const i=Ve.fromObject(n);return yo(t,new qa(Ng(),e,i))}function gi(t,e,n=!1){const s=h4(t.pendingWriteTree_,e);if(m4(t.pendingWriteTree_,e)){let r=new Ve(null);return s.snap!=null?r=r.set(Ae(),!0):It(s.children,a=>{r=r.set(new Le(a),!0)}),yo(t,new Nd(s.path,r,n))}else return[]}function Ec(t,e,n){return yo(t,new Or(Sg(),e,n))}function X4(t,e,n){const s=Ve.fromObject(n);return yo(t,new qa(Sg(),e,s))}function Q4(t,e){return yo(t,new Kl(Sg(),e))}function J4(t,e,n){const s=Cg(t,n);if(s){const i=Og(s),r=i.path,a=i.queryId,l=Vt(r,e),c=new Kl(Eg(a),l);return Mg(t,r,c)}else return[]}function Id(t,e,n,s,i=!1){const r=e._path,a=t.syncPointTree_.get(r);let l=[];if(a&&(e._queryIdentifier==="default"||bE(a,e))){const c=V4(a,e,n,s);F4(a)&&(t.syncPointTree_=t.syncPointTree_.remove(r));const u=c.removed;if(l=c.events,!i){const d=u.findIndex(h=>h._queryParams.loadsAllData())!==-1,f=t.syncPointTree_.findOnPath(r,(h,m)=>Ui(m));if(d&&!f){const h=t.syncPointTree_.subtree(r);if(!h.isEmpty()){const m=t3(h);for(let v=0;v<m.length;++v){const y=m[v],b=y.query,g=wE(t,y);t.listenProvider_.startListening(pl(b),Yl(t,b),g.hashFn,g.onComplete)}}}!f&&u.length>0&&!s&&(d?t.listenProvider_.stopListening(pl(e),null):u.forEach(h=>{const m=t.queryToTagMap.get(kf(h));t.listenProvider_.stopListening(pl(h),m)}))}n3(t,u)}return l}function vE(t,e,n,s){const i=Cg(t,s);if(i!=null){const r=Og(i),a=r.path,l=r.queryId,c=Vt(a,e),u=new Or(Eg(l),c,n);return Mg(t,a,u)}else return[]}function Z4(t,e,n,s){const i=Cg(t,s);if(i){const r=Og(i),a=r.path,l=r.queryId,c=Vt(a,e),u=Ve.fromObject(n),d=new qa(Eg(l),c,u);return Mg(t,a,d)}else return[]}function bp(t,e,n,s=!1){const i=e._path;let r=null,a=!1;t.syncPointTree_.foreachOnPath(i,(h,m)=>{const v=Vt(h,i);r=r||Ii(m,v),a=a||Ui(m)});let l=t.syncPointTree_.get(i);l?(a=a||Ui(l),r=r||Ii(l,Ae())):(l=new mE,t.syncPointTree_=t.syncPointTree_.set(i,l));let c;r!=null?c=!0:(c=!1,r=oe.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((m,v)=>{const y=Ii(v,Ae());y&&(r=r.updateImmediateChild(m,y))}));const u=bE(l,e);if(!u&&!e._queryParams.loadsAllData()){const h=kf(e);Y(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");const m=s3();t.queryToTagMap.set(h,m),t.tagToQueryMap.set(m,h)}const d=yf(t.pendingWriteTree_,i);let f=z4(l,e,n,d,r,c);if(!u&&!a&&!s){const h=xE(l,e);f=f.concat(i3(t,e,h))}return f}function wf(t,e,n){const i=t.pendingWriteTree_,r=t.syncPointTree_.findOnPath(e,(a,l)=>{const c=Vt(a,e),u=Ii(l,c);if(u)return u});return lE(i,e,r,n,!0)}function e3(t,e){const n=e._path;let s=null;t.syncPointTree_.foreachOnPath(n,(u,d)=>{const f=Vt(u,n);s=s||Ii(d,f)});let i=t.syncPointTree_.get(n);i?s=s||Ii(i,Ae()):(i=new mE,t.syncPointTree_=t.syncPointTree_.set(n,i));const r=s!=null,a=r?new Bi(s,!0,!1):null,l=yf(t.pendingWriteTree_,e._path),c=pE(i,e,l,r?a.getNode():oe.EMPTY_NODE,r);return P4(c)}function yo(t,e){return yE(e,t.syncPointTree_,null,yf(t.pendingWriteTree_,Ae()))}function yE(t,e,n,s){if(_e(t.path))return _E(t,e,n,s);{const i=e.get(Ae());n==null&&i!=null&&(n=Ii(i,Ae()));let r=[];const a=be(t.path),l=t.operationForChild(a),c=e.children.get(a);if(c&&l){const u=n?n.getImmediateChild(a):null,d=cE(s,a);r=r.concat(yE(l,c,u,d))}return i&&(r=r.concat(Rg(i,t,s,n))),r}}function _E(t,e,n,s){const i=e.get(Ae());n==null&&i!=null&&(n=Ii(i,Ae()));let r=[];return e.children.inorderTraversal((a,l)=>{const c=n?n.getImmediateChild(a):null,u=cE(s,a),d=t.operationForChild(a);d&&(r=r.concat(_E(d,l,c,u)))}),i&&(r=r.concat(Rg(i,t,s,n))),r}function wE(t,e){const n=e.query,s=Yl(t,n);return{hashFn:()=>(L4(e)||oe.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return s?J4(t,n._path,s):Q4(t,n._path);{const r=XM(i,n);return Id(t,n,null,r)}}}}function Yl(t,e){const n=kf(e);return t.queryToTagMap.get(n)}function kf(t){return t._path.toString()+"$"+t._queryIdentifier}function Cg(t,e){return t.tagToQueryMap.get(e)}function Og(t){const e=t.indexOf("$");return Y(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Le(t.substr(0,e))}}function Mg(t,e,n){const s=t.syncPointTree_.get(e);Y(s,"Missing sync point for query tag that we're tracking");const i=yf(t.pendingWriteTree_,e);return Rg(s,n,i,null)}function t3(t){return t.fold((e,n,s)=>{if(n&&Ui(n))return[_f(n)];{let i=[];return n&&(i=gE(n)),It(s,(r,a)=>{i=i.concat(a)}),i}})}function pl(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(Y4())(t._repo,t._path):t}function n3(t,e){for(let n=0;n<e.length;++n){const s=e[n];if(!s._queryParams.loadsAllData()){const i=kf(s),r=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(r)}}}function s3(){return W4++}function i3(t,e,n){const s=e._path,i=Yl(t,e),r=wE(t,n),a=t.listenProvider_.startListening(pl(e),i,r.hashFn,r.onComplete),l=t.syncPointTree_.subtree(s);if(i)Y(!Ui(l.value),"If we're adding a query, it shouldn't be shadowed");else{const c=l.fold((u,d,f)=>{if(!_e(u)&&d&&Ui(d))return[_f(d).query];{let h=[];return d&&(h=h.concat(gE(d).map(m=>m.query))),It(f,(m,v)=>{h=h.concat(v)}),h}});for(let u=0;u<c.length;++u){const d=c[u];t.listenProvider_.stopListening(pl(d),Yl(t,d))}}return a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dg{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new Dg(n)}node(){return this.node_}}class Lg{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=it(this.path_,e);return new Lg(this.syncTree_,n)}node(){return wf(this.syncTree_,this.path_)}}const r3=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},Ny=function(t,e,n){if(!t||typeof t!="object")return t;if(Y(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return a3(t[".sv"],e,n);if(typeof t[".sv"]=="object")return o3(t[".sv"],e);Y(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},a3=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:Y(!1,"Unexpected server value: "+t)}},o3=function(t,e,n){t.hasOwnProperty("increment")||Y(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const s=t.increment;typeof s!="number"&&Y(!1,"Unexpected increment value: "+s);const i=e.node();if(Y(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return s;const a=i.getValue();return typeof a!="number"?s:a+s},kE=function(t,e,n,s){return Bg(e,new Lg(n,t),s)},Pg=function(t,e,n){return Bg(t,new Dg(e),n)};function Bg(t,e,n){const s=t.getPriority().val(),i=Ny(s,e.getImmediateChild(".priority"),n);let r;if(t.isLeafNode()){const a=t,l=Ny(a.getValue(),e,n);return l!==a.getValue()||i!==a.getPriority().val()?new Nt(l,st(i)):t}else{const a=t;return r=a,i!==a.getPriority().val()&&(r=r.updatePriority(new Nt(i))),a.forEachChild(nt,(l,c)=>{const u=Bg(c,e.getImmediateChild(l),n);u!==c&&(r=r.updateImmediateChild(l,u))}),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ug{constructor(e="",n=null,s={children:{},childCount:0}){this.name=e,this.parent=n,this.node=s}}function Nf(t,e){let n=e instanceof Le?e:new Le(e),s=t,i=be(n);for(;i!==null;){const r=Ar(s.node.children,i)||{children:{},childCount:0};s=new Ug(i,s,r),n=He(n),i=be(n)}return s}function zr(t){return t.node.value}function Hg(t,e){t.node.value=e,vp(t)}function NE(t){return t.node.childCount>0}function l3(t){return zr(t)===void 0&&!NE(t)}function Sf(t,e){It(t.node.children,(n,s)=>{e(new Ug(n,t,s))})}function SE(t,e,n,s){n&&e(t),Sf(t,i=>{SE(i,e,!0)})}function c3(t,e,n){let s=t.parent;for(;s!==null;){if(e(s))return!0;s=s.parent}return!1}function Tc(t){return new Le(t.parent===null?t.name:Tc(t.parent)+"/"+t.name)}function vp(t){t.parent!==null&&u3(t.parent,t.name,t)}function u3(t,e,n){const s=l3(n),i=es(t.node.children,e);s&&i?(delete t.node.children[e],t.node.childCount--,vp(t)):!s&&!i&&(t.node.children[e]=n.node,t.node.childCount++,vp(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d3=/[\[\].#$\/\u0000-\u001F\u007F]/,f3=/[\[\].#$\u0000-\u001F\u007F]/,Ph=10*1024*1024,Gg=function(t){return typeof t=="string"&&t.length!==0&&!d3.test(t)},EE=function(t){return typeof t=="string"&&t.length!==0&&!f3.test(t)},h3=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),EE(t)},$g=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!xf(t)||t&&typeof t=="object"&&es(t,".sv")},Cd=function(t,e,n,s){s&&e===void 0||Ac(Va(t,"value"),e,n)},Ac=function(t,e,n){const s=n instanceof Le?new RD(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+or(s));if(typeof e=="function")throw new Error(t+"contains a function "+or(s)+" with contents = "+e.toString());if(xf(e))throw new Error(t+"contains "+e.toString()+" "+or(s));if(typeof e=="string"&&e.length>Ph/3&&hf(e)>Ph)throw new Error(t+"contains a string greater than "+Ph+" utf8 bytes "+or(s)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,r=!1;if(It(e,(a,l)=>{if(a===".value")i=!0;else if(a!==".priority"&&a!==".sv"&&(r=!0,!Gg(a)))throw new Error(t+" contains an invalid key ("+a+") "+or(s)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);ID(s,a),Ac(t,l,s),CD(s)}),i&&r)throw new Error(t+' contains ".value" child '+or(s)+" in addition to actual children.")}},m3=function(t,e){let n,s;for(n=0;n<e.length;n++){s=e[n];const r=$l(s);for(let a=0;a<r.length;a++)if(!(r[a]===".priority"&&a===r.length-1)){if(!Gg(r[a]))throw new Error(t+"contains an invalid key ("+r[a]+") in path "+s.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(jD);let i=null;for(n=0;n<e.length;n++){if(s=e[n],i!==null&&On(i,s))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+s.toString());i=s}},TE=function(t,e,n,s){const i=Va(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const r=[];It(e,(a,l)=>{const c=new Le(a);if(Ac(i,l,it(n,c)),bg(c)===".priority"&&!$g(l))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");r.push(c)}),m3(i,r)},p3=function(t,e,n){if(xf(e))throw new Error(Va(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!$g(e))throw new Error(Va(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},AE=function(t,e,n,s){if(!EE(n))throw new Error(Va(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},g3=function(t,e,n,s){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),AE(t,e,n)},xi=function(t,e){if(be(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},x3=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Gg(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!h3(n))throw new Error(Va(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b3{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Ef(t,e){let n=null;for(let s=0;s<e.length;s++){const i=e[s],r=i.getPath();n!==null&&!vg(r,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:r}),n.events.push(i)}n&&t.eventLists_.push(n)}function jE(t,e,n){Ef(t,n),RE(t,s=>vg(s,e))}function yn(t,e,n){Ef(t,n),RE(t,s=>On(s,e)||On(e,s))}function RE(t,e){t.recursionDepth_++;let n=!0;for(let s=0;s<t.eventLists_.length;s++){const i=t.eventLists_[s];if(i){const r=i.path;e(r)?(v3(t.eventLists_[s]),t.eventLists_[s]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function v3(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const s=n.getEventRunner();dl&&At("event: "+n.toString()),bo(s)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y3="repo_interrupt",_3=25;class w3{constructor(e,n,s,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=s,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new b3,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=kd(),this.transactionQueueTree_=new Ug,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function k3(t,e,n){if(t.stats_=gg(t.repoInfo_),t.forceRestClient_||eD())t.server_=new wd(t.repoInfo_,(s,i,r,a)=>{Sy(t,s,i,r,a)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>Ey(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{wt(n)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}t.persistentConnection_=new Os(t.repoInfo_,e,(s,i,r,a)=>{Sy(t,s,i,r,a)},s=>{Ey(t,s)},s=>{N3(t,s)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(s=>{t.server_.refreshAuthToken(s)}),t.appCheckProvider_.addTokenChangeListener(s=>{t.server_.refreshAppCheckToken(s.token)}),t.statsReporter_=rD(t.repoInfo_,()=>new r4(t.stats_,t.server_)),t.infoData_=new e4,t.infoSyncTree_=new ky({startListening:(s,i,r,a)=>{let l=[];const c=t.infoData_.getNode(s._path);return c.isEmpty()||(l=Ec(t.infoSyncTree_,s._path,c),setTimeout(()=>{a("ok")},0)),l},stopListening:()=>{}}),Fg(t,"connected",!1),t.serverSyncTree_=new ky({startListening:(s,i,r,a)=>(t.server_.listen(s,r,i,(l,c)=>{const u=a(l,c);yn(t.eventQueue_,s._path,u)}),[]),stopListening:(s,i)=>{t.server_.unlisten(s,i)}})}function IE(t){const n=t.infoData_.getNode(new Le(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function jc(t){return r3({timestamp:IE(t)})}function Sy(t,e,n,s,i){t.dataUpdateCount++;const r=new Le(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let a=[];if(i)if(s){const c=dd(n,u=>st(u));a=Z4(t.serverSyncTree_,r,c,i)}else{const c=st(n);a=vE(t.serverSyncTree_,r,c,i)}else if(s){const c=dd(n,u=>st(u));a=X4(t.serverSyncTree_,r,c)}else{const c=st(n);a=Ec(t.serverSyncTree_,r,c)}let l=r;a.length>0&&(l=Qa(t,r)),yn(t.eventQueue_,l,a)}function Ey(t,e){Fg(t,"connected",e),e===!1&&A3(t)}function N3(t,e){It(e,(n,s)=>{Fg(t,n,s)})}function Fg(t,e,n){const s=new Le("/.info/"+e),i=st(n);t.infoData_.updateSnapshot(s,i);const r=Ec(t.infoSyncTree_,s,i);yn(t.eventQueue_,s,r)}function Tf(t){return t.nextWriteId_++}function S3(t,e,n){const s=e3(t.serverSyncTree_,e);return s!=null?Promise.resolve(s):t.server_.get(e).then(i=>{const r=st(i).withIndex(e._queryParams.getIndex());bp(t.serverSyncTree_,e,n,!0);let a;if(e._queryParams.loadsAllData())a=Ec(t.serverSyncTree_,e._path,r);else{const l=Yl(t.serverSyncTree_,e);a=vE(t.serverSyncTree_,e._path,r,l)}return yn(t.eventQueue_,e._path,a),Id(t.serverSyncTree_,e,n,null,!0),r},i=>(_o(t,"get for query "+wt(e)+" failed: "+i),Promise.reject(new Error(i))))}function E3(t,e,n,s,i){_o(t,"set",{path:e.toString(),value:n,priority:s});const r=jc(t),a=st(n,s),l=wf(t.serverSyncTree_,e),c=Pg(a,l,r),u=Tf(t),d=Ig(t.serverSyncTree_,e,c,u,!0);Ef(t.eventQueue_,d),t.server_.put(e.toString(),a.val(!0),(h,m)=>{const v=h==="ok";v||Yt("set at "+e+" failed: "+h);const y=gi(t.serverSyncTree_,u,!v);yn(t.eventQueue_,e,y),Hi(t,i,h,m)});const f=Vg(t,e);Qa(t,f),yn(t.eventQueue_,f,[])}function T3(t,e,n,s){_o(t,"update",{path:e.toString(),value:n});let i=!0;const r=jc(t),a={};if(It(n,(l,c)=>{i=!1,a[l]=kE(it(e,l),st(c),t.serverSyncTree_,r)}),i)At("update() called with empty data.  Don't do anything."),Hi(t,s,"ok",void 0);else{const l=Tf(t),c=q4(t.serverSyncTree_,e,a,l);Ef(t.eventQueue_,c),t.server_.merge(e.toString(),n,(u,d)=>{const f=u==="ok";f||Yt("update at "+e+" failed: "+u);const h=gi(t.serverSyncTree_,l,!f),m=h.length>0?Qa(t,e):e;yn(t.eventQueue_,m,h),Hi(t,s,u,d)}),It(n,u=>{const d=Vg(t,it(e,u));Qa(t,d)}),yn(t.eventQueue_,e,[])}}function A3(t){_o(t,"onDisconnectEvents");const e=jc(t),n=kd();fp(t.onDisconnect_,Ae(),(i,r)=>{const a=kE(i,r,t.serverSyncTree_,e);vo(n,i,a)});let s=[];fp(n,Ae(),(i,r)=>{s=s.concat(Ec(t.serverSyncTree_,i,r));const a=Vg(t,i);Qa(t,a)}),t.onDisconnect_=kd(),yn(t.eventQueue_,Ae(),s)}function j3(t,e,n){t.server_.onDisconnectCancel(e.toString(),(s,i)=>{s==="ok"&&dp(t.onDisconnect_,e),Hi(t,n,s,i)})}function Ty(t,e,n,s){const i=st(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(r,a)=>{r==="ok"&&vo(t.onDisconnect_,e,i),Hi(t,s,r,a)})}function R3(t,e,n,s,i){const r=st(n,s);t.server_.onDisconnectPut(e.toString(),r.val(!0),(a,l)=>{a==="ok"&&vo(t.onDisconnect_,e,r),Hi(t,i,a,l)})}function I3(t,e,n,s){if(ud(n)){At("onDisconnect().update() called with empty data.  Don't do anything."),Hi(t,s,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,r)=>{i==="ok"&&It(n,(a,l)=>{const c=st(l);vo(t.onDisconnect_,it(e,a),c)}),Hi(t,s,i,r)})}function C3(t,e,n){let s;be(e._path)===".info"?s=bp(t.infoSyncTree_,e,n):s=bp(t.serverSyncTree_,e,n),jE(t.eventQueue_,e._path,s)}function O3(t,e,n){let s;be(e._path)===".info"?s=Id(t.infoSyncTree_,e,n):s=Id(t.serverSyncTree_,e,n),jE(t.eventQueue_,e._path,s)}function M3(t){t.persistentConnection_&&t.persistentConnection_.interrupt(y3)}function _o(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),At(n,...e)}function Hi(t,e,n,s){e&&bo(()=>{if(n==="ok")e(null);else{const i=(n||"error").toUpperCase();let r=i;s&&(r+=": "+s);const a=new Error(r);a.code=i,e(a)}})}function D3(t,e,n,s,i,r){_o(t,"transaction on "+e);const a={path:e,update:n,onComplete:s,status:null,order:jS(),applyLocally:r,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},l=zg(t,e,void 0);a.currentInputSnapshot=l;const c=a.update(l.val());if(c===void 0)a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete&&a.onComplete(null,!1,a.currentInputSnapshot);else{Ac("transaction failed: Data returned ",c,a.path),a.status=0;const u=Nf(t.transactionQueueTree_,e),d=zr(u)||[];d.push(a),Hg(u,d);let f;typeof c=="object"&&c!==null&&es(c,".priority")?(f=Ar(c,".priority"),Y($g(f),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):f=(wf(t.serverSyncTree_,e)||oe.EMPTY_NODE).getPriority().val();const h=jc(t),m=st(c,f),v=Pg(m,l,h);a.currentOutputSnapshotRaw=m,a.currentOutputSnapshotResolved=v,a.currentWriteId=Tf(t);const y=Ig(t.serverSyncTree_,e,v,a.currentWriteId,a.applyLocally);yn(t.eventQueue_,e,y),Af(t,t.transactionQueueTree_)}}function zg(t,e,n){return wf(t.serverSyncTree_,e,n)||oe.EMPTY_NODE}function Af(t,e=t.transactionQueueTree_){if(e||jf(t,e),zr(e)){const n=OE(t,e);Y(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&L3(t,Tc(e),n)}else NE(e)&&Sf(e,n=>{Af(t,n)})}function L3(t,e,n){const s=n.map(u=>u.currentWriteId),i=zg(t,e,s);let r=i;const a=i.hash();for(let u=0;u<n.length;u++){const d=n[u];Y(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;const f=Vt(e,d.path);r=r.updateChild(f,d.currentOutputSnapshotRaw)}const l=r.val(!0),c=e;t.server_.put(c.toString(),l,u=>{_o(t,"transaction put response",{path:c.toString(),status:u});let d=[];if(u==="ok"){const f=[];for(let h=0;h<n.length;h++)n[h].status=2,d=d.concat(gi(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&f.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();jf(t,Nf(t.transactionQueueTree_,e)),Af(t,t.transactionQueueTree_),yn(t.eventQueue_,e,d);for(let h=0;h<f.length;h++)bo(f[h])}else{if(u==="datastale")for(let f=0;f<n.length;f++)n[f].status===3?n[f].status=4:n[f].status=0;else{Yt("transaction at "+c.toString()+" failed: "+u);for(let f=0;f<n.length;f++)n[f].status=4,n[f].abortReason=u}Qa(t,e)}},a)}function Qa(t,e){const n=CE(t,e),s=Tc(n),i=OE(t,n);return P3(t,i,s),s}function P3(t,e,n){if(e.length===0)return;const s=[];let i=[];const a=e.filter(l=>l.status===0).map(l=>l.currentWriteId);for(let l=0;l<e.length;l++){const c=e[l],u=Vt(n,c.path);let d=!1,f;if(Y(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)d=!0,f=c.abortReason,i=i.concat(gi(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=_3)d=!0,f="maxretry",i=i.concat(gi(t.serverSyncTree_,c.currentWriteId,!0));else{const h=zg(t,c.path,a);c.currentInputSnapshot=h;const m=e[l].update(h.val());if(m!==void 0){Ac("transaction failed: Data returned ",m,c.path);let v=st(m);typeof m=="object"&&m!=null&&es(m,".priority")||(v=v.updatePriority(h.getPriority()));const b=c.currentWriteId,g=jc(t),p=Pg(v,h,g);c.currentOutputSnapshotRaw=v,c.currentOutputSnapshotResolved=p,c.currentWriteId=Tf(t),a.splice(a.indexOf(b),1),i=i.concat(Ig(t.serverSyncTree_,c.path,p,c.currentWriteId,c.applyLocally)),i=i.concat(gi(t.serverSyncTree_,b,!0))}else d=!0,f="nodata",i=i.concat(gi(t.serverSyncTree_,c.currentWriteId,!0))}yn(t.eventQueue_,n,i),i=[],d&&(e[l].status=2,function(h){setTimeout(h,Math.floor(0))}(e[l].unwatcher),e[l].onComplete&&(f==="nodata"?s.push(()=>e[l].onComplete(null,!1,e[l].currentInputSnapshot)):s.push(()=>e[l].onComplete(new Error(f),!1,null))))}jf(t,t.transactionQueueTree_);for(let l=0;l<s.length;l++)bo(s[l]);Af(t,t.transactionQueueTree_)}function CE(t,e){let n,s=t.transactionQueueTree_;for(n=be(e);n!==null&&zr(s)===void 0;)s=Nf(s,n),e=He(e),n=be(e);return s}function OE(t,e){const n=[];return ME(t,e,n),n.sort((s,i)=>s.order-i.order),n}function ME(t,e,n){const s=zr(e);if(s)for(let i=0;i<s.length;i++)n.push(s[i]);Sf(e,i=>{ME(t,i,n)})}function jf(t,e){const n=zr(e);if(n){let s=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[s]=n[i],s++);n.length=s,Hg(e,n.length>0?n:void 0)}Sf(e,s=>{jf(t,s)})}function Vg(t,e){const n=Tc(CE(t,e)),s=Nf(t.transactionQueueTree_,e);return c3(s,i=>{Bh(t,i)}),Bh(t,s),SE(s,i=>{Bh(t,i)}),n}function Bh(t,e){const n=zr(e);if(n){const s=[];let i=[],r=-1;for(let a=0;a<n.length;a++)n[a].status===3||(n[a].status===1?(Y(r===a-1,"All SENT items should be at beginning of queue."),r=a,n[a].status=3,n[a].abortReason="set"):(Y(n[a].status===0,"Unexpected transaction status in abort"),n[a].unwatcher(),i=i.concat(gi(t.serverSyncTree_,n[a].currentWriteId,!0)),n[a].onComplete&&s.push(n[a].onComplete.bind(null,new Error("set"),!1,null))));r===-1?Hg(e,void 0):n.length=r+1,yn(t.eventQueue_,Tc(e),i);for(let a=0;a<s.length;a++)bo(s[a])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B3(t){let e="";const n=t.split("/");for(let s=0;s<n.length;s++)if(n[s].length>0){let i=n[s];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function U3(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const s=n.split("=");s.length===2?e[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):Yt(`Invalid query segment '${n}' in query '${t}'`)}return e}const Ay=function(t,e){const n=H3(t),s=n.namespace;n.domain==="firebase.com"&&Vs(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!s||s==="undefined")&&n.domain!=="localhost"&&Vs("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||VM();const i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new $S(n.host,n.secure,s,i,e,"",s!==n.subdomain),path:new Le(n.pathString)}},H3=function(t){let e="",n="",s="",i="",r="",a=!0,l="https",c=443;if(typeof t=="string"){let u=t.indexOf("//");u>=0&&(l=t.substring(0,u-1),t=t.substring(u+2));let d=t.indexOf("/");d===-1&&(d=t.length);let f=t.indexOf("?");f===-1&&(f=t.length),e=t.substring(0,Math.min(d,f)),d<f&&(i=B3(t.substring(d,f)));const h=U3(t.substring(Math.min(t.length,f)));u=e.indexOf(":"),u>=0?(a=l==="https"||l==="wss",c=parseInt(e.substring(u+1),10)):u=e.length;const m=e.slice(0,u);if(m.toLowerCase()==="localhost")n="localhost";else if(m.split(".").length<=2)n=m;else{const v=e.indexOf(".");s=e.substring(0,v).toLowerCase(),n=e.substring(v+1),r=s}"ns"in h&&(r=h.ns)}return{host:e,port:c,domain:n,subdomain:s,secure:a,scheme:l,pathString:i,namespace:r}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jy="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",G3=function(){let t=0;const e=[];return function(n){const s=n===t;t=n;let i;const r=new Array(8);for(i=7;i>=0;i--)r[i]=jy.charAt(n%64),n=Math.floor(n/64);Y(n===0,"Cannot push at time == 0");let a=r.join("");if(s){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)a+=jy.charAt(e[i]);return Y(a.length===20,"nextPushId: Length should be 20."),a}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $3{constructor(e,n,s,i){this.eventType=e,this.eventRegistration=n,this.snapshot=s,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+wt(this.snapshot.exportVal())}}class F3{constructor(e,n,s){this.eventRegistration=e,this.error=n,this.path=s}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DE{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return Y(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z3{constructor(e,n){this._repo=e,this._path=n}cancel(){const e=new Kn;return j3(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){xi("OnDisconnect.remove",this._path);const e=new Kn;return Ty(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){xi("OnDisconnect.set",this._path),Cd("OnDisconnect.set",e,this._path,!1);const n=new Kn;return Ty(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){xi("OnDisconnect.setWithPriority",this._path),Cd("OnDisconnect.setWithPriority",e,this._path,!1),p3("OnDisconnect.setWithPriority",n);const s=new Kn;return R3(this._repo,this._path,e,n,s.wrapCallback(()=>{})),s.promise}update(e){xi("OnDisconnect.update",this._path),TE("OnDisconnect.update",e,this._path);const n=new Kn;return I3(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rf{constructor(e,n,s,i){this._repo=e,this._path=n,this._queryParams=s,this._orderByCalled=i}get key(){return _e(this._path)?null:bg(this._path)}get ref(){return new hs(this._repo,this._path)}get _queryIdentifier(){const e=hy(this._queryParams),n=mg(e);return n==="{}"?"default":n}get _queryObject(){return hy(this._queryParams)}isEqual(e){if(e=vt(e),!(e instanceof Rf))return!1;const n=this._repo===e._repo,s=vg(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&s&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+AD(this._path)}}class hs extends Rf{constructor(e,n){super(e,n,new kg,!1)}get parent(){const e=QS(this._path);return e===null?null:new hs(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class Ja{constructor(e,n,s){this._node=e,this.ref=n,this._index=s}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new Le(e),s=Wl(this.ref,e);return new Ja(this._node.getChild(n),s,nt)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(s,i)=>e(new Ja(i,Wl(this.ref,s),nt)))}hasChild(e){const n=new Le(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function L(t,e){return t=vt(t),t._checkNotDeleted("ref"),e!==void 0?Wl(t._root,e):t._root}function Wl(t,e){return t=vt(t),be(t._path)===null?g3("child","path",e):AE("child","path",e),new hs(t._repo,it(t._path,e))}function Ry(t){return t=vt(t),new z3(t._repo,t._path)}function LE(t,e){t=vt(t),xi("push",t._path),Cd("push",e,t._path,!0);const n=IE(t._repo),s=G3(n),i=Wl(t,s),r=Wl(t,s);let a;return a=Promise.resolve(r),i.then=a.then.bind(a),i.catch=a.then.bind(a,void 0),i}function Iy(t){return xi("remove",t._path),Dr(t,null)}function Dr(t,e){t=vt(t),xi("set",t._path),Cd("set",e,t._path,!1);const n=new Kn;return E3(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function ne(t,e){TE("update",e,t._path);const n=new Kn;return T3(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function xe(t){t=vt(t);const e=new DE(()=>{}),n=new If(e);return S3(t._repo,t,n).then(s=>new Ja(s,new hs(t._repo,t._path),t._queryParams.getIndex()))}class If{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const s=n._queryParams.getIndex();return new $3("value",this,new Ja(e.snapshotNode,new hs(n._repo,n._path),s))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new F3(this,e,n):null}matches(e){return e instanceof If?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function V3(t,e,n,s,i){const r=new DE(n,void 0),a=new If(r);return C3(t._repo,t,a),()=>O3(t._repo,t,a)}function We(t,e,n,s){return V3(t,"value",e)}class K3{}class Y3 extends K3{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Rf(e._repo,e._path,ZD(e._queryParams,this._limit),e._orderByCalled)}}function W3(t){if(Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new Y3(t)}function q3(t,...e){let n=vt(t);for(const s of e)n=s._apply(n);return n}G4(hs);K4(hs);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X3="FIREBASE_DATABASE_EMULATOR_HOST",yp={};let Q3=!1;function J3(t,e,n,s){const i=e.lastIndexOf(":"),r=e.substring(0,i),a=po(r);t.repoInfo_=new $S(e,a,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0,n),s&&(t.authTokenProvider_=s)}function Z3(t,e,n,s,i){let r=s||t.options.databaseURL;r===void 0&&(t.options.projectId||Vs("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),At("Using default host for project ",t.options.projectId),r=`${t.options.projectId}-default-rtdb.firebaseio.com`);let a=Ay(r,i),l=a.repoInfo,c;typeof process<"u"&&qv&&(c=qv[X3]),c?(r=`http://${c}?ns=${l.namespace}`,a=Ay(r,i),l=a.repoInfo):a.repoInfo.secure;const u=new nD(t.name,t.options,e);x3("Invalid Firebase Database URL",a),_e(a.path)||Vs("Database URL must point to the root of a Firebase Database (not including a child path).");const d=tL(l,t,u,new tD(t,n));return new nL(d,t)}function eL(t,e){const n=yp[e];(!n||n[t.key]!==t)&&Vs(`Database ${e}(${t.repoInfo_}) has already been deleted.`),M3(t),delete n[t.key]}function tL(t,e,n,s){let i=yp[e.name];i||(i={},yp[e.name]=i);let r=i[t.toURLString()];return r&&Vs("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new w3(t,Q3,n,s),i[t.toURLString()]=r,r}class nL{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(k3(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new hs(this._repo,Ae())),this._rootInternal}_delete(){return this._rootInternal!==null&&(eL(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Vs("Cannot call "+e+" on a deleted database.")}}function sL(t=$N(),e){const n=ig(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const s=KR("database");s&&iL(n,...s)}return n}function iL(t,e,n,s={}){t=vt(t),t._checkNotDeleted("useEmulator");const i=`${e}:${n}`,r=t._repoInternal;if(t._instanceStarted){if(i===t._repoInternal.repoInfo_.host&&jr(s,r.repoInfo_.emulatorOptions))return;Vs("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let a;if(r.repoInfo_.nodeAdmin)s.mockUserToken&&Vs('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new ju(ju.OWNER);else if(s.mockUserToken){const l=typeof s.mockUserToken=="string"?s.mockUserToken:YR(s.mockUserToken,t.app.options.projectId);a=new ju(l)}po(e)&&(DN(e),LN("Database",!0)),J3(r,i,s,a)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rL(t){HM(xo),Ka(new Rr("database",(e,{instanceIdentifier:n})=>{const s=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),r=e.getProvider("app-check-internal");return Z3(s,i,r,n)},"PUBLIC").setMultipleInstances(!0)),ji(Xv,Qv,t),ji(Xv,Qv,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aL={".sv":"timestamp"};function oL(){return aL}function PE(t){return{".sv":{increment:t}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lL{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function Te(t,e,n){var s;if(t=vt(t),xi("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";const i=(s=void 0)!==null&&s!==void 0?s:!0,r=new Kn,a=(c,u,d)=>{let f=null;c?r.reject(c):(f=new Ja(d,new hs(t._repo,t._path),nt),r.resolve(new lL(u,f)))},l=We(t,()=>{});return D3(t._repo,t._path,e,a,l,i),r.promise}Os.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Os.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};rL();var cL="firebase",uL="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ji(cL,uL,"app");const dL={apiKey:"AIzaSyBU11CvtAaUkADomFxcMuN6fH9ipx-VtAs",authDomain:"eiriksbok-simuleringfeudal.firebaseapp.com",databaseURL:"https://eiriksbok-simuleringfeudal-default-rtdb.europe-west1.firebasedatabase.app",projectId:"eiriksbok-simuleringfeudal",storageBucket:"eiriksbok-simuleringfeudal.firebasestorage.app",messagingSenderId:"772081963542",appId:"1:772081963542:web:05edb87535f629fd36db37",measurementId:"G-NDR8LNVQNX"},BE=GN(dL,"simulationApp"),P=sL(BE),qr=BM(BE),UE=_.createContext(void 0),fL=({children:t})=>{const[e,n]=_.useState(null),[s,i]=_.useState(null),[r,a]=_.useState(!0),[l,c]=_.useState(null),[u,d]=_.useState(!0);_.useEffect(()=>{const b=EO(qr,async g=>{if(g){n(g),d(g.isAnonymous);const p=L(P,`simulation_accounts/${g.uid}`),x=We(p,async w=>{if(w.exists())i(w.val()),a(!1);else{const k={uid:g.uid,displayName:g.displayName||`Eventyrer_${g.uid.slice(0,4)}`,globalXp:0,globalLevel:1,totalGoldEarned:0,unlockedAchievements:[],characterHistory:[],lastActive:Date.now()};await Dr(p,k),i(k),a(!1)}});return()=>x()}else{d(!0);try{await pO(qr)}catch(p){console.error("Auth failed:",p),a(!1)}}});return()=>b()},[]);const f=async(b,g)=>{c(null);try{await kO(qr,b,g)}catch(p){throw c(p.message),p}},h=async b=>{const g=b.trim().toLowerCase();if(!g||g.length<3)return!1;const p=L(P,`simulation_reserved_names/${g}`);return!(await xe(p)).exists()},m=async(b,g,p)=>{c(null);const x=p.trim(),w=x.toLowerCase();try{if(!await h(x))throw new Error("Navnet er allerede tatt.");if(e&&e.isAnonymous){const S=Gr.credential(b,g);await yO(e,S);const N={};N[`simulation_accounts/${e.uid}/displayName`]=x,N[`simulation_reserved_names/${w}`]=e.uid,await ne(L(P),N)}else{const S=await wO(qr,b,g),N={};N[`simulation_reserved_names/${w}`]=S.user.uid;const T={uid:S.user.uid,displayName:x,globalXp:0,globalLevel:1,totalGoldEarned:0,unlockedAchievements:[],characterHistory:[],lastActive:Date.now()};N[`simulation_accounts/${S.user.uid}`]=T,await ne(L(P),N)}}catch(k){throw c(k.message),k}},v=async()=>{await TO(qr)},y=async b=>{try{await _O(qr,b)}catch(g){throw c(g.message),g}};return o.jsx(UE.Provider,{value:{user:e,account:s,loading:r,isAnonymous:u,error:l,login:f,register:m,logout:v,resetPassword:y,checkNameAvailability:h},children:t})},Cf=()=>{const t=_.useContext(UE);if(!t)throw new Error("useSimulationAuth must be used within a SimulationAuthProvider");return t},HE=[{id:"Ashes of the Keep.mp3",title:"Festningens Aske",mood:"Dark"},{id:"Banner at the Old Stone Keep.mp3",title:"Gamle Steiner",mood:"Epic"},{id:"Banner at the Old Stone Keep (1).mp3",title:"Steinhallens Hymne",mood:"Epic"},{id:"Burning Banners Over Stone.mp3",title:"Brennende Bannere",mood:"Dark"},{id:"Candlelit Keep.mp3",title:"Lys i Hallen",mood:"Calm"},{id:"Candlelit Keep (1).mp3",title:"Nattens Vakt",mood:"Calm"},{id:"Crown of Quiet Rooms.mp3",title:"Stillhetens Krone",mood:"Mysterious"},{id:"Crown of Quiet Rooms (1).mp3",title:"Kongens Tvil",mood:"Mysterious"}],ur=class ur{constructor(){et(this,"sfxVolume",.5);et(this,"musicVolume",.3);et(this,"currentMusic",null);et(this,"currentMusicKey",null);et(this,"playlist",[]);et(this,"playlistIndex",0);et(this,"isPlaylistActive",!1);et(this,"ignoredTracks",new Set);et(this,"audioContext",null);et(this,"filterNode",null);et(this,"isMuffledState",!1);et(this,"activeFades",new Map);const e=localStorage.getItem("sim_sfx_volume"),n=localStorage.getItem("sim_music_volume"),s=localStorage.getItem("sim_music_muffled"),i=localStorage.getItem("sim_music_ignored");if(e&&(this.sfxVolume=parseFloat(e)),n&&(this.musicVolume=parseFloat(n)),s&&(this.isMuffledState=s==="true"),i)try{this.ignoredTracks=new Set(JSON.parse(i))}catch(r){console.error("Failed to parse ignored tracks",r)}this.playlist=HE.map(r=>r.id),this.shufflePlaylist()}shufflePlaylist(){this.playlist=this.playlist.sort(()=>Math.random()-.5)}initAudioContext(){if(!this.audioContext)try{this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.filterNode=this.audioContext.createBiquadFilter(),this.filterNode.type="lowpass",this.filterNode.frequency.setValueAtTime(this.isMuffledState?12e3:2e4,this.audioContext.currentTime),this.filterNode.connect(this.audioContext.destination)}catch(e){console.error("Failed to initialize AudioContext",e)}this.audioContext&&this.audioContext.state==="suspended"&&this.audioContext.resume()}static getInstance(){return ur.instance||(ur.instance=new ur),ur.instance}setSfxVolume(e){this.sfxVolume=Math.max(0,Math.min(1,e)),localStorage.setItem("sim_sfx_volume",this.sfxVolume.toString())}setMusicVolume(e){this.musicVolume=Math.max(0,Math.min(1,e)),localStorage.setItem("sim_music_volume",this.musicVolume.toString()),this.currentMusic&&(this.currentMusic.volume=this.musicVolume)}setMuffled(e){this.isMuffledState=e,localStorage.setItem("sim_music_muffled",e.toString()),this.filterNode&&this.audioContext&&this.filterNode.frequency.setTargetAtTime(e?15e3:2e4,this.audioContext.currentTime,.1)}toggleIgnoreTrack(e){this.ignoredTracks.has(e)?this.ignoredTracks.delete(e):this.ignoredTracks.add(e),localStorage.setItem("sim_music_ignored",JSON.stringify(Array.from(this.ignoredTracks))),this.ignoredTracks.has(e)&&this.currentMusicKey===e&&this.isPlaylistActive&&this.playNextInPlaylist()}isIgnored(e){return this.ignoredTracks.has(e)}getSfxVolume(){return this.sfxVolume}getMusicVolume(){return this.musicVolume}isMuffled(){return this.isMuffledState}getCurrentTrackId(){return this.currentMusicKey}playSfx(e){if(this.sfxVolume===0)return;const i=`/Simulation_StandAlone_Pro//sounds/sfx/${e.includes(".")?e:`${e}.mp3`}`.replace("//","/"),r=new Audio(i);r.volume=this.sfxVolume,r.play().catch(()=>{})}startPlaylist(){this.isPlaylistActive&&this.currentMusic||(this.isPlaylistActive=!0,this.currentMusic||this.playNextInPlaylist())}playNextInPlaylist(){if(!this.isPlaylistActive)return;let e=0,n=!1;for(;e<this.playlist.length;){this.playlistIndex=(this.playlistIndex+1)%this.playlist.length;const s=this.playlist[this.playlistIndex];if(!this.ignoredTracks.has(s)){this.playMusic(s,2e3,!1),n=!0;break}e++}n||(console.warn("All tracks are ignored! Playing fallback."),this.playMusic(this.playlist[0],2e3,!1))}playPreviousInPlaylist(){if(!this.isPlaylistActive)return;let e=0,n=!1;for(;e<this.playlist.length;){this.playlistIndex=(this.playlistIndex-1+this.playlist.length)%this.playlist.length;const s=this.playlist[this.playlistIndex];if(!this.ignoredTracks.has(s)){this.playMusic(s,2e3,!1),n=!0;break}e++}n||this.playMusic(this.playlist[0],2e3,!1)}async resume(){this.audioContext||this.initAudioContext(),this.audioContext&&this.audioContext.state==="suspended"&&await this.audioContext.resume()}playMusic(e,n=1e3,s=!0){if(s&&(this.isPlaylistActive=!1),this.currentMusicKey===e&&this.currentMusic&&!this.currentMusic.paused){this.fadeIn(this.currentMusic,this.musicVolume,500);return}const a=`/Simulation_StandAlone_Pro//sounds/music/${e.includes(".")?e:`${e}.mp3`}`.replace("//","/"),l=new Audio(a);if(l.loop=!this.isPlaylistActive,l.volume=0,this.initAudioContext(),this.audioContext&&this.filterNode)try{this.audioContext.createMediaElementSource(l).connect(this.filterNode)}catch(c){console.warn("Could not route through Web Audio API",c)}this.isPlaylistActive&&(l.onended=()=>{this.playNextInPlaylist()}),this.currentMusic&&this.fadeOut(this.currentMusic,n),this.currentMusic=l,this.currentMusicKey=e,l.play().then(()=>{this.fadeIn(l,this.musicVolume,n),this.audioContext&&this.audioContext.state==="suspended"&&this.audioContext.resume()}).catch(c=>{console.warn(`Failed to play music: ${e}`,c),this.currentMusic===l&&(this.currentMusic=null,this.currentMusicKey=null),this.isPlaylistActive&&setTimeout(()=>this.playNextInPlaylist(),2e3)})}stopMusic(e=1e3){this.isPlaylistActive=!1,this.currentMusic&&(this.fadeOut(this.currentMusic,e),this.currentMusic=null,this.currentMusicKey=null)}fadeOut(e,n){this.activeFades.has(e)&&clearInterval(this.activeFades.get(e));const s=e.volume,i=20,r=n/i,a=s/i;let l=0;const c=setInterval(()=>{l++;const u=Math.max(0,s-a*l);e.volume=u,u<=0&&(e.pause(),e.src="",clearInterval(c),this.activeFades.delete(e))},r);this.activeFades.set(e,c)}fadeIn(e,n,s){this.activeFades.has(e)&&(clearInterval(this.activeFades.get(e)),this.activeFades.delete(e));const i=20,r=s/i,a=n/i;let l=0;const c=setInterval(()=>{l++;const u=Math.min(n,a*l);e.volume=u,(u>=n||e.paused)&&clearInterval(c)},r)}};et(ur,"instance");let _p=ur;const ot=_p.getInstance(),hL=Object.freeze(Object.defineProperty({__proto__:null,audioManager:ot},Symbol.toStringTag,{value:"Module"})),GE=_.createContext(void 0),mL=({children:t})=>{const[e,n]=_.useState(ot.getSfxVolume()),[s,i]=_.useState(ot.getMusicVolume()),[r,a]=_.useState(ot.isMuffled()),[l,c]=_.useState(ot.getCurrentTrackId()),[u,d]=_.useState(0);_.useEffect(()=>{const N=setInterval(()=>{const T=ot.getCurrentTrackId();T!==l&&c(T)},1e3);return()=>clearInterval(N)},[l]);const f=_.useCallback(N=>{ot.setSfxVolume(N),n(N)},[]),h=_.useCallback(N=>{ot.setMusicVolume(N),i(N)},[]),m=_.useCallback(N=>{ot.setMuffled(N),a(N)},[]),v=_.useCallback(N=>{ot.playSfx(N)},[]),y=_.useCallback(N=>{ot.playMusic(N),c(N)},[]),b=_.useCallback(()=>{ot.stopMusic(),c(null)},[]),g=_.useCallback(()=>{ot.startPlaylist(),c(ot.getCurrentTrackId())},[]),p=_.useCallback(()=>{ot.playNextInPlaylist(),c(ot.getCurrentTrackId())},[]),x=_.useCallback(()=>{ot.playPreviousInPlaylist(),c(ot.getCurrentTrackId())},[]),w=_.useCallback(N=>{ot.toggleIgnoreTrack(N),d(T=>T+1)},[]),k=_.useCallback(N=>ot.isIgnored(N),[u]),S=_.useCallback(()=>{ot.resume()},[]);return o.jsx(GE.Provider,{value:{playSfx:v,playMusic:y,startPlaylist:g,stopMusic:b,playNext:p,playPrevious:x,toggleIgnoreTrack:w,isIgnored:k,currentTrackId:l,playlist:HE,sfxVolume:e,setSfxVolume:f,musicVolume:s,setMusicVolume:h,isMuffled:r,setMuffled:m,resume:S},children:t})},Kg=()=>{const t=_.useContext(GE);if(!t)throw new Error("useAudio must be used within a SimulationAudioProvider");return t},$E=_.createContext(void 0),pL=({children:t})=>{const{pin:e,tab:n}=wN(),s=R=>{if(!R)return"MAP";const I=R.toUpperCase();return I==="ACTIVITY"||I==="LOG"?"ACTIVITY":I},i=R=>R.toLowerCase(),[r,a]=_.useState(()=>s(n)),[l,c]=_.useState("global"),[u,d]=_.useState(null),[f,h]=_.useState(!1),[m,v]=_.useState(!1),[y,b]=_.useState(null),[g,p]=_.useState(null),[x,w]=_.useState(null),[k,S]=_.useState(null),[N,T]=_.useState(null),E=R=>{a(R);const I=i(R),V=`/Simulation_StandAlone_Pro/play/${e}/${I}`;window.history.replaceState({...window.history.state,idx:window.history.length},"",V)},j=R=>{h(R),R?E("MARKET"):r==="MARKET"&&E("MAP")};return o.jsx($E.Provider,{value:{activeTab:r,setActiveTab:E,viewMode:l,setViewMode:c,viewingRegionId:u,setViewingRegionId:d,isMarketOpen:f,setMarketOpen:j,isMusicWindowOpen:m,setMusicWindowOpen:v,activeMinigame:y,setActiveMinigame:b,activeMinigameMethod:g,setActiveMinigameMethod:p,activeMinigameAction:x,setActiveMinigameAction:w,actionLoading:k,setActionLoading:S,productionContext:N,setProductionContext:T},children:t})},ql=()=>{const t=_.useContext($E);if(!t)throw new Error("useSimulation must be used within a SimulationProvider");return t},gL="modulepreload",xL=function(t){return"/Simulation_StandAlone_Pro/"+t},Cy={},Ut=function(e,n,s){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(n.map(c=>{if(c=xL(c),c in Cy)return;Cy[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":gL,u||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),u)return new Promise((h,m)=>{f.addEventListener("load",h),f.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return i.then(a=>{for(const l of a||[])l.status==="rejected"&&r(l.reason);return e().catch(r)})},Yg=_.createContext({});function Wg(t){const e=_.useRef(null);return e.current===null&&(e.current=t()),e.current}const Of=_.createContext(null),qg=_.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class bL extends _.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const s=this.props.sizeRef.current;s.height=n.offsetHeight||0,s.width=n.offsetWidth||0,s.top=n.offsetTop,s.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function vL({children:t,isPresent:e}){const n=_.useId(),s=_.useRef(null),i=_.useRef({width:0,height:0,top:0,left:0}),{nonce:r}=_.useContext(qg);return _.useInsertionEffect(()=>{const{width:a,height:l,top:c,left:u}=i.current;if(e||!s.current||!a||!l)return;s.current.dataset.motionPopId=n;const d=document.createElement("style");return r&&(d.nonce=r),document.head.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${l}px !important;
            top: ${c}px !important;
            left: ${u}px !important;
          }
        `),()=>{document.head.removeChild(d)}},[e]),o.jsx(bL,{isPresent:e,childRef:s,sizeRef:i,children:_.cloneElement(t,{ref:s})})}const yL=({children:t,initial:e,isPresent:n,onExitComplete:s,custom:i,presenceAffectsLayout:r,mode:a})=>{const l=Wg(_L),c=_.useId(),u=_.useCallback(f=>{l.set(f,!0);for(const h of l.values())if(!h)return;s&&s()},[l,s]),d=_.useMemo(()=>({id:c,initial:e,isPresent:n,custom:i,onExitComplete:u,register:f=>(l.set(f,!1),()=>l.delete(f))}),r?[Math.random(),u]:[n,u]);return _.useMemo(()=>{l.forEach((f,h)=>l.set(h,!1))},[n]),_.useEffect(()=>{!n&&!l.size&&s&&s()},[n]),a==="popLayout"&&(t=o.jsx(vL,{isPresent:n,children:t})),o.jsx(Of.Provider,{value:d,children:t})};function _L(){return new Map}function FE(t=!0){const e=_.useContext(Of);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:s,register:i}=e,r=_.useId();_.useEffect(()=>{t&&i(r)},[t]);const a=_.useCallback(()=>t&&s&&s(r),[r,s,t]);return!n&&s?[!1,a]:[!0]}const su=t=>t.key||"";function Oy(t){const e=[];return _.Children.forEach(t,n=>{_.isValidElement(n)&&e.push(n)}),e}const Xg=typeof window<"u",zE=Xg?_.useLayoutEffect:_.useEffect,Ln=({children:t,custom:e,initial:n=!0,onExitComplete:s,presenceAffectsLayout:i=!0,mode:r="sync",propagate:a=!1})=>{const[l,c]=FE(a),u=_.useMemo(()=>Oy(t),[t]),d=a&&!l?[]:u.map(su),f=_.useRef(!0),h=_.useRef(u),m=Wg(()=>new Map),[v,y]=_.useState(u),[b,g]=_.useState(u);zE(()=>{f.current=!1,h.current=u;for(let w=0;w<b.length;w++){const k=su(b[w]);d.includes(k)?m.delete(k):m.get(k)!==!0&&m.set(k,!1)}},[b,d.length,d.join("-")]);const p=[];if(u!==v){let w=[...u];for(let k=0;k<b.length;k++){const S=b[k],N=su(S);d.includes(N)||(w.splice(k,0,S),p.push(S))}r==="wait"&&p.length&&(w=p),g(Oy(w)),y(u);return}const{forceRender:x}=_.useContext(Yg);return o.jsx(o.Fragment,{children:b.map(w=>{const k=su(w),S=a&&!l?!1:u===b||d.includes(k),N=()=>{if(m.has(k))m.set(k,!0);else return;let T=!0;m.forEach(E=>{E||(T=!1)}),T&&(x==null||x(),g(h.current),a&&(c==null||c()),s&&s())};return o.jsx(yL,{isPresent:S,initial:!f.current||n?void 0:!1,custom:S?void 0:e,presenceAffectsLayout:i,mode:r,onExitComplete:S?void 0:N,children:w},k)})})},xn=t=>t;let VE=xn;function Qg(t){let e;return()=>(e===void 0&&(e=t()),e)}const Za=(t,e,n)=>{const s=e-t;return s===0?1:(n-t)/s},Ms=t=>t*1e3,Ds=t=>t/1e3,wL={useManualTiming:!1};function kL(t){let e=new Set,n=new Set,s=!1,i=!1;const r=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function l(u){r.has(u)&&(c.schedule(u),t()),u(a)}const c={schedule:(u,d=!1,f=!1)=>{const m=f&&s?e:n;return d&&r.add(u),m.has(u)||m.add(u),u},cancel:u=>{n.delete(u),r.delete(u)},process:u=>{if(a=u,s){i=!0;return}s=!0,[e,n]=[n,e],e.forEach(l),e.clear(),s=!1,i&&(i=!1,c.process(u))}};return c}const iu=["read","resolveKeyframes","update","preRender","render","postRender"],NL=40;function KE(t,e){let n=!1,s=!0;const i={delta:0,timestamp:0,isProcessing:!1},r=()=>n=!0,a=iu.reduce((g,p)=>(g[p]=kL(r),g),{}),{read:l,resolveKeyframes:c,update:u,preRender:d,render:f,postRender:h}=a,m=()=>{const g=performance.now();n=!1,i.delta=s?1e3/60:Math.max(Math.min(g-i.timestamp,NL),1),i.timestamp=g,i.isProcessing=!0,l.process(i),c.process(i),u.process(i),d.process(i),f.process(i),h.process(i),i.isProcessing=!1,n&&e&&(s=!1,t(m))},v=()=>{n=!0,s=!0,i.isProcessing||t(m)};return{schedule:iu.reduce((g,p)=>{const x=a[p];return g[p]=(w,k=!1,S=!1)=>(n||v(),x.schedule(w,k,S)),g},{}),cancel:g=>{for(let p=0;p<iu.length;p++)a[iu[p]].cancel(g)},state:i,steps:a}}const{schedule:Qe,cancel:Gi,state:Ct,steps:Uh}=KE(typeof requestAnimationFrame<"u"?requestAnimationFrame:xn,!0),YE=_.createContext({strict:!1}),My={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},eo={};for(const t in My)eo[t]={isEnabled:e=>My[t].some(n=>!!e[n])};function SL(t){for(const e in t)eo[e]={...eo[e],...t[e]}}const EL=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Od(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||EL.has(t)}let WE=t=>!Od(t);function TL(t){t&&(WE=e=>e.startsWith("on")?!Od(e):t(e))}try{TL(require("@emotion/is-prop-valid").default)}catch{}function AL(t,e,n){const s={};for(const i in t)i==="values"&&typeof t.values=="object"||(WE(i)||n===!0&&Od(i)||!e&&!Od(i)||t.draggable&&i.startsWith("onDrag"))&&(s[i]=t[i]);return s}function jL(t){if(typeof Proxy>"u")return t;const e=new Map,n=(...s)=>t(...s);return new Proxy(n,{get:(s,i)=>i==="create"?t:(e.has(i)||e.set(i,t(i)),e.get(i))})}const Mf=_.createContext({});function Xl(t){return typeof t=="string"||Array.isArray(t)}function Df(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const Jg=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Zg=["initial",...Jg];function Lf(t){return Df(t.animate)||Zg.some(e=>Xl(t[e]))}function qE(t){return!!(Lf(t)||t.variants)}function RL(t,e){if(Lf(t)){const{initial:n,animate:s}=t;return{initial:n===!1||Xl(n)?n:void 0,animate:Xl(s)?s:void 0}}return t.inherit!==!1?e:{}}function IL(t){const{initial:e,animate:n}=RL(t,_.useContext(Mf));return _.useMemo(()=>({initial:e,animate:n}),[Dy(e),Dy(n)])}function Dy(t){return Array.isArray(t)?t.join(" "):t}const CL=Symbol.for("motionComponentSymbol");function ma(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function OL(t,e,n){return _.useCallback(s=>{s&&t.onMount&&t.onMount(s),e&&(s?e.mount(s):e.unmount()),n&&(typeof n=="function"?n(s):ma(n)&&(n.current=s))},[e])}const ex=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),ML="framerAppearId",XE="data-"+ex(ML),{schedule:tx}=KE(queueMicrotask,!1),QE=_.createContext({});function DL(t,e,n,s,i){var r,a;const{visualElement:l}=_.useContext(Mf),c=_.useContext(YE),u=_.useContext(Of),d=_.useContext(qg).reducedMotion,f=_.useRef(null);s=s||c.renderer,!f.current&&s&&(f.current=s(t,{visualState:e,parent:l,props:n,presenceContext:u,blockInitialAnimation:u?u.initial===!1:!1,reducedMotionConfig:d}));const h=f.current,m=_.useContext(QE);h&&!h.projection&&i&&(h.type==="html"||h.type==="svg")&&LL(f.current,n,i,m);const v=_.useRef(!1);_.useInsertionEffect(()=>{h&&v.current&&h.update(n,u)});const y=n[XE],b=_.useRef(!!y&&!(!((r=window.MotionHandoffIsComplete)===null||r===void 0)&&r.call(window,y))&&((a=window.MotionHasOptimisedAnimation)===null||a===void 0?void 0:a.call(window,y)));return zE(()=>{h&&(v.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),tx.render(h.render),b.current&&h.animationState&&h.animationState.animateChanges())}),_.useEffect(()=>{h&&(!b.current&&h.animationState&&h.animationState.animateChanges(),b.current&&(queueMicrotask(()=>{var g;(g=window.MotionHandoffMarkAsComplete)===null||g===void 0||g.call(window,y)}),b.current=!1))}),h}function LL(t,e,n,s){const{layoutId:i,layout:r,drag:a,dragConstraints:l,layoutScroll:c,layoutRoot:u}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:JE(t.parent)),t.projection.setOptions({layoutId:i,layout:r,alwaysMeasureLayout:!!a||l&&ma(l),visualElement:t,animationType:typeof r=="string"?r:"both",initialPromotionConfig:s,layoutScroll:c,layoutRoot:u})}function JE(t){if(t)return t.options.allowProjection!==!1?t.projection:JE(t.parent)}function PL({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:s,Component:i}){var r,a;t&&SL(t);function l(u,d){let f;const h={..._.useContext(qg),...u,layoutId:BL(u)},{isStatic:m}=h,v=IL(u),y=s(u,m);if(!m&&Xg){UL();const b=HL(h);f=b.MeasureLayout,v.visualElement=DL(i,y,h,e,b.ProjectionNode)}return o.jsxs(Mf.Provider,{value:v,children:[f&&v.visualElement?o.jsx(f,{visualElement:v.visualElement,...h}):null,n(i,u,OL(y,v.visualElement,d),y,m,v.visualElement)]})}l.displayName=`motion.${typeof i=="string"?i:`create(${(a=(r=i.displayName)!==null&&r!==void 0?r:i.name)!==null&&a!==void 0?a:""})`}`;const c=_.forwardRef(l);return c[CL]=i,c}function BL({layoutId:t}){const e=_.useContext(Yg).id;return e&&t!==void 0?e+"-"+t:t}function UL(t,e){_.useContext(YE).strict}function HL(t){const{drag:e,layout:n}=eo;if(!e&&!n)return{};const s={...e,...n};return{MeasureLayout:e!=null&&e.isEnabled(t)||n!=null&&n.isEnabled(t)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}const GL=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function nx(t){return typeof t!="string"||t.includes("-")?!1:!!(GL.indexOf(t)>-1||/[A-Z]/u.test(t))}function Ly(t){const e=[{},{}];return t==null||t.values.forEach((n,s)=>{e[0][s]=n.get(),e[1][s]=n.getVelocity()}),e}function sx(t,e,n,s){if(typeof e=="function"){const[i,r]=Ly(s);e=e(n!==void 0?n:t.custom,i,r)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[i,r]=Ly(s);e=e(n!==void 0?n:t.custom,i,r)}return e}const wp=t=>Array.isArray(t),$L=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),FL=t=>wp(t)?t[t.length-1]||0:t,Gt=t=>!!(t&&t.getVelocity);function Ru(t){const e=Gt(t)?t.get():t;return $L(e)?e.toValue():e}function zL({scrapeMotionValuesFromProps:t,createRenderState:e,onUpdate:n},s,i,r){const a={latestValues:VL(s,i,r,t),renderState:e()};return n&&(a.onMount=l=>n({props:s,current:l,...a}),a.onUpdate=l=>n(l)),a}const ZE=t=>(e,n)=>{const s=_.useContext(Mf),i=_.useContext(Of),r=()=>zL(t,e,s,i);return n?r():Wg(r)};function VL(t,e,n,s){const i={},r=s(t,{});for(const h in r)i[h]=Ru(r[h]);let{initial:a,animate:l}=t;const c=Lf(t),u=qE(t);e&&u&&!c&&t.inherit!==!1&&(a===void 0&&(a=e.initial),l===void 0&&(l=e.animate));let d=n?n.initial===!1:!1;d=d||a===!1;const f=d?l:a;if(f&&typeof f!="boolean"&&!Df(f)){const h=Array.isArray(f)?f:[f];for(let m=0;m<h.length;m++){const v=sx(t,h[m]);if(v){const{transitionEnd:y,transition:b,...g}=v;for(const p in g){let x=g[p];if(Array.isArray(x)){const w=d?x.length-1:0;x=x[w]}x!==null&&(i[p]=x)}for(const p in y)i[p]=y[p]}}}return i}const wo=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Vr=new Set(wo),eT=t=>e=>typeof e=="string"&&e.startsWith(t),tT=eT("--"),KL=eT("var(--"),ix=t=>KL(t)?YL.test(t.split("/*")[0].trim()):!1,YL=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,nT=(t,e)=>e&&typeof t=="number"?e.transform(t):t,Ks=(t,e,n)=>n>e?e:n<t?t:n,ko={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Ql={...ko,transform:t=>Ks(0,1,t)},ru={...ko,default:1},Rc=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Zs=Rc("deg"),ls=Rc("%"),re=Rc("px"),WL=Rc("vh"),qL=Rc("vw"),Py={...ls,parse:t=>ls.parse(t)/100,transform:t=>ls.transform(t*100)},XL={borderWidth:re,borderTopWidth:re,borderRightWidth:re,borderBottomWidth:re,borderLeftWidth:re,borderRadius:re,radius:re,borderTopLeftRadius:re,borderTopRightRadius:re,borderBottomRightRadius:re,borderBottomLeftRadius:re,width:re,maxWidth:re,height:re,maxHeight:re,top:re,right:re,bottom:re,left:re,padding:re,paddingTop:re,paddingRight:re,paddingBottom:re,paddingLeft:re,margin:re,marginTop:re,marginRight:re,marginBottom:re,marginLeft:re,backgroundPositionX:re,backgroundPositionY:re},QL={rotate:Zs,rotateX:Zs,rotateY:Zs,rotateZ:Zs,scale:ru,scaleX:ru,scaleY:ru,scaleZ:ru,skew:Zs,skewX:Zs,skewY:Zs,distance:re,translateX:re,translateY:re,translateZ:re,x:re,y:re,z:re,perspective:re,transformPerspective:re,opacity:Ql,originX:Py,originY:Py,originZ:re},By={...ko,transform:Math.round},rx={...XL,...QL,zIndex:By,size:re,fillOpacity:Ql,strokeOpacity:Ql,numOctaves:By},JL={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},ZL=wo.length;function eP(t,e,n){let s="",i=!0;for(let r=0;r<ZL;r++){const a=wo[r],l=t[a];if(l===void 0)continue;let c=!0;if(typeof l=="number"?c=l===(a.startsWith("scale")?1:0):c=parseFloat(l)===0,!c||n){const u=nT(l,rx[a]);if(!c){i=!1;const d=JL[a]||a;s+=`${d}(${u}) `}n&&(e[a]=u)}}return s=s.trim(),n?s=n(e,i?"":s):i&&(s="none"),s}function ax(t,e,n){const{style:s,vars:i,transformOrigin:r}=t;let a=!1,l=!1;for(const c in e){const u=e[c];if(Vr.has(c)){a=!0;continue}else if(tT(c)){i[c]=u;continue}else{const d=nT(u,rx[c]);c.startsWith("origin")?(l=!0,r[c]=d):s[c]=d}}if(e.transform||(a||n?s.transform=eP(e,t.transform,n):s.transform&&(s.transform="none")),l){const{originX:c="50%",originY:u="50%",originZ:d=0}=r;s.transformOrigin=`${c} ${u} ${d}`}}const tP={offset:"stroke-dashoffset",array:"stroke-dasharray"},nP={offset:"strokeDashoffset",array:"strokeDasharray"};function sP(t,e,n=1,s=0,i=!0){t.pathLength=1;const r=i?tP:nP;t[r.offset]=re.transform(-s);const a=re.transform(e),l=re.transform(n);t[r.array]=`${a} ${l}`}function Uy(t,e,n){return typeof t=="string"?t:re.transform(e+n*t)}function iP(t,e,n){const s=Uy(e,t.x,t.width),i=Uy(n,t.y,t.height);return`${s} ${i}`}function ox(t,{attrX:e,attrY:n,attrScale:s,originX:i,originY:r,pathLength:a,pathSpacing:l=1,pathOffset:c=0,...u},d,f){if(ax(t,u,f),d){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:h,style:m,dimensions:v}=t;h.transform&&(v&&(m.transform=h.transform),delete h.transform),v&&(i!==void 0||r!==void 0||m.transform)&&(m.transformOrigin=iP(v,i!==void 0?i:.5,r!==void 0?r:.5)),e!==void 0&&(h.x=e),n!==void 0&&(h.y=n),s!==void 0&&(h.scale=s),a!==void 0&&sP(h,a,l,c,!1)}const lx=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),sT=()=>({...lx(),attrs:{}}),cx=t=>typeof t=="string"&&t.toLowerCase()==="svg";function iT(t,{style:e,vars:n},s,i){Object.assign(t.style,e,i&&i.getProjectionStyles(s));for(const r in n)t.style.setProperty(r,n[r])}const rT=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function aT(t,e,n,s){iT(t,e,void 0,s);for(const i in e.attrs)t.setAttribute(rT.has(i)?i:ex(i),e.attrs[i])}const Md={};function rP(t){Object.assign(Md,t)}function oT(t,{layout:e,layoutId:n}){return Vr.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!Md[t]||t==="opacity")}function ux(t,e,n){var s;const{style:i}=t,r={};for(const a in i)(Gt(i[a])||e.style&&Gt(e.style[a])||oT(a,t)||((s=n==null?void 0:n.getValue(a))===null||s===void 0?void 0:s.liveStyle)!==void 0)&&(r[a]=i[a]);return r}function lT(t,e,n){const s=ux(t,e,n);for(const i in t)if(Gt(t[i])||Gt(e[i])){const r=wo.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;s[r]=t[i]}return s}function aP(t,e){try{e.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const Hy=["x","y","width","height","cx","cy","r"],oP={useVisualState:ZE({scrapeMotionValuesFromProps:lT,createRenderState:sT,onUpdate:({props:t,prevProps:e,current:n,renderState:s,latestValues:i})=>{if(!n)return;let r=!!t.drag;if(!r){for(const l in i)if(Vr.has(l)){r=!0;break}}if(!r)return;let a=!e;if(e)for(let l=0;l<Hy.length;l++){const c=Hy[l];t[c]!==e[c]&&(a=!0)}a&&Qe.read(()=>{aP(n,s),Qe.render(()=>{ox(s,i,cx(n.tagName),t.transformTemplate),aT(n,s)})})}})},lP={useVisualState:ZE({scrapeMotionValuesFromProps:ux,createRenderState:lx})};function cT(t,e,n){for(const s in e)!Gt(e[s])&&!oT(s,n)&&(t[s]=e[s])}function cP({transformTemplate:t},e){return _.useMemo(()=>{const n=lx();return ax(n,e,t),Object.assign({},n.vars,n.style)},[e])}function uP(t,e){const n=t.style||{},s={};return cT(s,n,t),Object.assign(s,cP(t,e)),s}function dP(t,e){const n={},s=uP(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=s,n}function fP(t,e,n,s){const i=_.useMemo(()=>{const r=sT();return ox(r,e,cx(s),t.transformTemplate),{...r.attrs,style:{...r.style}}},[e]);if(t.style){const r={};cT(r,t.style,t),i.style={...r,...i.style}}return i}function hP(t=!1){return(n,s,i,{latestValues:r},a)=>{const c=(nx(n)?fP:dP)(s,r,a,n),u=AL(s,typeof n=="string",t),d=n!==_.Fragment?{...u,...c,ref:i}:{},{children:f}=s,h=_.useMemo(()=>Gt(f)?f.get():f,[f]);return _.createElement(n,{...d,children:h})}}function mP(t,e){return function(s,{forwardMotionProps:i}={forwardMotionProps:!1}){const a={...nx(s)?oP:lP,preloadedFeatures:t,useRender:hP(i),createVisualElement:e,Component:s};return PL(a)}}function uT(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let s=0;s<n;s++)if(e[s]!==t[s])return!1;return!0}function Pf(t,e,n){const s=t.getProps();return sx(s,e,n!==void 0?n:s.custom,t)}const pP=Qg(()=>window.ScrollTimeline!==void 0);class gP{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,n){for(let s=0;s<this.animations.length;s++)this.animations[s][e]=n}attachTimeline(e,n){const s=this.animations.map(i=>{if(pP()&&i.attachTimeline)return i.attachTimeline(e);if(typeof n=="function")return n(i)});return()=>{s.forEach((i,r)=>{i&&i(),this.animations[r].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let n=0;n<this.animations.length;n++)e=Math.max(e,this.animations[n].duration);return e}runAll(e){this.animations.forEach(n=>n[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class xP extends gP{then(e,n){return Promise.all(this.animations).then(e).catch(n)}}function dx(t,e){return t?t[e]||t.default||t:void 0}const kp=2e4;function dT(t){let e=0;const n=50;let s=t.next(e);for(;!s.done&&e<kp;)e+=n,s=t.next(e);return e>=kp?1/0:e}function fx(t){return typeof t=="function"}function Gy(t,e){t.timeline=e,t.onfinish=null}const hx=t=>Array.isArray(t)&&typeof t[0]=="number",bP={linearEasing:void 0};function vP(t,e){const n=Qg(t);return()=>{var s;return(s=bP[e])!==null&&s!==void 0?s:n()}}const Dd=vP(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),fT=(t,e,n=10)=>{let s="";const i=Math.max(Math.round(e/n),2);for(let r=0;r<i;r++)s+=t(Za(0,i-1,r))+", ";return`linear(${s.substring(0,s.length-2)})`};function hT(t){return!!(typeof t=="function"&&Dd()||!t||typeof t=="string"&&(t in Np||Dd())||hx(t)||Array.isArray(t)&&t.every(hT))}const Ko=([t,e,n,s])=>`cubic-bezier(${t}, ${e}, ${n}, ${s})`,Np={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Ko([0,.65,.55,1]),circOut:Ko([.55,0,1,.45]),backIn:Ko([.31,.01,.66,-.59]),backOut:Ko([.33,1.53,.69,.99])};function mT(t,e){if(t)return typeof t=="function"&&Dd()?fT(t,e):hx(t)?Ko(t):Array.isArray(t)?t.map(n=>mT(n,e)||Np.easeOut):Np[t]}const Fn={x:!1,y:!1};function pT(){return Fn.x||Fn.y}function yP(t,e,n){var s;if(t instanceof Element)return[t];if(typeof t=="string"){let i=document;const r=(s=void 0)!==null&&s!==void 0?s:i.querySelectorAll(t);return r?Array.from(r):[]}return Array.from(t)}function gT(t,e){const n=yP(t),s=new AbortController,i={passive:!0,...e,signal:s.signal};return[n,i,()=>s.abort()]}function $y(t){return e=>{e.pointerType==="touch"||pT()||t(e)}}function _P(t,e,n={}){const[s,i,r]=gT(t,n),a=$y(l=>{const{target:c}=l,u=e(l);if(typeof u!="function"||!c)return;const d=$y(f=>{u(f),c.removeEventListener("pointerleave",d)});c.addEventListener("pointerleave",d,i)});return s.forEach(l=>{l.addEventListener("pointerenter",a,i)}),r}const xT=(t,e)=>e?t===e?!0:xT(t,e.parentElement):!1,mx=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,wP=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function kP(t){return wP.has(t.tagName)||t.tabIndex!==-1}const Yo=new WeakSet;function Fy(t){return e=>{e.key==="Enter"&&t(e)}}function Hh(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const NP=(t,e)=>{const n=t.currentTarget;if(!n)return;const s=Fy(()=>{if(Yo.has(n))return;Hh(n,"down");const i=Fy(()=>{Hh(n,"up")}),r=()=>Hh(n,"cancel");n.addEventListener("keyup",i,e),n.addEventListener("blur",r,e)});n.addEventListener("keydown",s,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",s),e)};function zy(t){return mx(t)&&!pT()}function SP(t,e,n={}){const[s,i,r]=gT(t,n),a=l=>{const c=l.currentTarget;if(!zy(l)||Yo.has(c))return;Yo.add(c);const u=e(l),d=(m,v)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",h),!(!zy(m)||!Yo.has(c))&&(Yo.delete(c),typeof u=="function"&&u(m,{success:v}))},f=m=>{d(m,n.useGlobalTarget||xT(c,m.target))},h=m=>{d(m,!1)};window.addEventListener("pointerup",f,i),window.addEventListener("pointercancel",h,i)};return s.forEach(l=>{!kP(l)&&l.getAttribute("tabindex")===null&&(l.tabIndex=0),(n.useGlobalTarget?window:l).addEventListener("pointerdown",a,i),l.addEventListener("focus",u=>NP(u,i),i)}),r}function EP(t){return t==="x"||t==="y"?Fn[t]?null:(Fn[t]=!0,()=>{Fn[t]=!1}):Fn.x||Fn.y?null:(Fn.x=Fn.y=!0,()=>{Fn.x=Fn.y=!1})}const bT=new Set(["width","height","top","left","right","bottom",...wo]);let Iu;function TP(){Iu=void 0}const cs={now:()=>(Iu===void 0&&cs.set(Ct.isProcessing||wL.useManualTiming?Ct.timestamp:performance.now()),Iu),set:t=>{Iu=t,queueMicrotask(TP)}};function px(t,e){t.indexOf(e)===-1&&t.push(e)}function gx(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class xx{constructor(){this.subscriptions=[]}add(e){return px(this.subscriptions,e),()=>gx(this.subscriptions,e)}notify(e,n,s){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,n,s);else for(let r=0;r<i;r++){const a=this.subscriptions[r];a&&a(e,n,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function vT(t,e){return e?t*(1e3/e):0}const Vy=30,AP=t=>!isNaN(parseFloat(t));class jP{constructor(e,n={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(s,i=!0)=>{const r=cs.now();this.updatedAt!==r&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=cs.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=AP(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new xx);const s=this.events[e].add(n);return e==="change"?()=>{s(),Qe.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,s){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-s}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=cs.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>Vy)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,Vy);return vT(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Jl(t,e){return new jP(t,e)}function RP(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Jl(n))}function IP(t,e){const n=Pf(t,e);let{transitionEnd:s={},transition:i={},...r}=n||{};r={...r,...s};for(const a in r){const l=FL(r[a]);RP(t,a,l)}}function CP(t){return!!(Gt(t)&&t.add)}function Sp(t,e){const n=t.getValue("willChange");if(CP(n))return n.add(e)}function yT(t){return t.props[XE]}const _T=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,OP=1e-7,MP=12;function DP(t,e,n,s,i){let r,a,l=0;do a=e+(n-e)/2,r=_T(a,s,i)-t,r>0?n=a:e=a;while(Math.abs(r)>OP&&++l<MP);return a}function Ic(t,e,n,s){if(t===e&&n===s)return xn;const i=r=>DP(r,0,1,t,n);return r=>r===0||r===1?r:_T(i(r),e,s)}const wT=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,kT=t=>e=>1-t(1-e),NT=Ic(.33,1.53,.69,.99),bx=kT(NT),ST=wT(bx),ET=t=>(t*=2)<1?.5*bx(t):.5*(2-Math.pow(2,-10*(t-1))),vx=t=>1-Math.sin(Math.acos(t)),TT=kT(vx),AT=wT(vx),jT=t=>/^0[^.\s]+$/u.test(t);function LP(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||jT(t):!0}const gl=t=>Math.round(t*1e5)/1e5,yx=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function PP(t){return t==null}const BP=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,_x=(t,e)=>n=>!!(typeof n=="string"&&BP.test(n)&&n.startsWith(t)||e&&!PP(n)&&Object.prototype.hasOwnProperty.call(n,e)),RT=(t,e,n)=>s=>{if(typeof s!="string")return s;const[i,r,a,l]=s.match(yx);return{[t]:parseFloat(i),[e]:parseFloat(r),[n]:parseFloat(a),alpha:l!==void 0?parseFloat(l):1}},UP=t=>Ks(0,255,t),Gh={...ko,transform:t=>Math.round(UP(t))},fr={test:_x("rgb","red"),parse:RT("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:s=1})=>"rgba("+Gh.transform(t)+", "+Gh.transform(e)+", "+Gh.transform(n)+", "+gl(Ql.transform(s))+")"};function HP(t){let e="",n="",s="",i="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),s=t.substring(5,7),i=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),s=t.substring(3,4),i=t.substring(4,5),e+=e,n+=n,s+=s,i+=i),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(s,16),alpha:i?parseInt(i,16)/255:1}}const Ep={test:_x("#"),parse:HP,transform:fr.transform},pa={test:_x("hsl","hue"),parse:RT("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:s=1})=>"hsla("+Math.round(t)+", "+ls.transform(gl(e))+", "+ls.transform(gl(n))+", "+gl(Ql.transform(s))+")"},Ht={test:t=>fr.test(t)||Ep.test(t)||pa.test(t),parse:t=>fr.test(t)?fr.parse(t):pa.test(t)?pa.parse(t):Ep.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?fr.transform(t):pa.transform(t)},GP=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function $P(t){var e,n;return isNaN(t)&&typeof t=="string"&&(((e=t.match(yx))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(GP))===null||n===void 0?void 0:n.length)||0)>0}const IT="number",CT="color",FP="var",zP="var(",Ky="${}",VP=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Zl(t){const e=t.toString(),n=[],s={color:[],number:[],var:[]},i=[];let r=0;const l=e.replace(VP,c=>(Ht.test(c)?(s.color.push(r),i.push(CT),n.push(Ht.parse(c))):c.startsWith(zP)?(s.var.push(r),i.push(FP),n.push(c)):(s.number.push(r),i.push(IT),n.push(parseFloat(c))),++r,Ky)).split(Ky);return{values:n,split:l,indexes:s,types:i}}function OT(t){return Zl(t).values}function MT(t){const{split:e,types:n}=Zl(t),s=e.length;return i=>{let r="";for(let a=0;a<s;a++)if(r+=e[a],i[a]!==void 0){const l=n[a];l===IT?r+=gl(i[a]):l===CT?r+=Ht.transform(i[a]):r+=i[a]}return r}}const KP=t=>typeof t=="number"?0:t;function YP(t){const e=OT(t);return MT(t)(e.map(KP))}const $i={test:$P,parse:OT,createTransformer:MT,getAnimatableNone:YP},WP=new Set(["brightness","contrast","saturate","opacity"]);function qP(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[s]=n.match(yx)||[];if(!s)return t;const i=n.replace(s,"");let r=WP.has(e)?1:0;return s!==n&&(r*=100),e+"("+r+i+")"}const XP=/\b([a-z-]*)\(.*?\)/gu,Tp={...$i,getAnimatableNone:t=>{const e=t.match(XP);return e?e.map(qP).join(" "):t}},QP={...rx,color:Ht,backgroundColor:Ht,outlineColor:Ht,fill:Ht,stroke:Ht,borderColor:Ht,borderTopColor:Ht,borderRightColor:Ht,borderBottomColor:Ht,borderLeftColor:Ht,filter:Tp,WebkitFilter:Tp},wx=t=>QP[t];function DT(t,e){let n=wx(t);return n!==Tp&&(n=$i),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const JP=new Set(["auto","none","0"]);function ZP(t,e,n){let s=0,i;for(;s<t.length&&!i;){const r=t[s];typeof r=="string"&&!JP.has(r)&&Zl(r).values.length&&(i=t[s]),s++}if(i&&n)for(const r of e)t[r]=DT(n,i)}const Yy=t=>t===ko||t===re,Wy=(t,e)=>parseFloat(t.split(", ")[e]),qy=(t,e)=>(n,{transform:s})=>{if(s==="none"||!s)return 0;const i=s.match(/^matrix3d\((.+)\)$/u);if(i)return Wy(i[1],e);{const r=s.match(/^matrix\((.+)\)$/u);return r?Wy(r[1],t):0}},e6=new Set(["x","y","z"]),t6=wo.filter(t=>!e6.has(t));function n6(t){const e=[];return t6.forEach(n=>{const s=t.getValue(n);s!==void 0&&(e.push([n,s.get()]),s.set(n.startsWith("scale")?1:0))}),e}const to={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:qy(4,13),y:qy(5,14)};to.translateX=to.x;to.translateY=to.y;const vr=new Set;let Ap=!1,jp=!1;function LT(){if(jp){const t=Array.from(vr).filter(s=>s.needsMeasurement),e=new Set(t.map(s=>s.element)),n=new Map;e.forEach(s=>{const i=n6(s);i.length&&(n.set(s,i),s.render())}),t.forEach(s=>s.measureInitialState()),e.forEach(s=>{s.render();const i=n.get(s);i&&i.forEach(([r,a])=>{var l;(l=s.getValue(r))===null||l===void 0||l.set(a)})}),t.forEach(s=>s.measureEndState()),t.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}jp=!1,Ap=!1,vr.forEach(t=>t.complete()),vr.clear()}function PT(){vr.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(jp=!0)})}function s6(){PT(),LT()}class kx{constructor(e,n,s,i,r,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=s,this.motionValue=i,this.element=r,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(vr.add(this),Ap||(Ap=!0,Qe.read(PT),Qe.resolveKeyframes(LT))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:s,motionValue:i}=this;for(let r=0;r<e.length;r++)if(e[r]===null)if(r===0){const a=i==null?void 0:i.get(),l=e[e.length-1];if(a!==void 0)e[0]=a;else if(s&&n){const c=s.readValue(n,l);c!=null&&(e[0]=c)}e[0]===void 0&&(e[0]=l),i&&a===void 0&&i.set(e[0])}else e[r]=e[r-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),vr.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,vr.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const BT=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),i6=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function r6(t){const e=i6.exec(t);if(!e)return[,];const[,n,s,i]=e;return[`--${n??s}`,i]}function UT(t,e,n=1){const[s,i]=r6(t);if(!s)return;const r=window.getComputedStyle(e).getPropertyValue(s);if(r){const a=r.trim();return BT(a)?parseFloat(a):a}return ix(i)?UT(i,e,n+1):i}const HT=t=>e=>e.test(t),a6={test:t=>t==="auto",parse:t=>t},GT=[ko,re,ls,Zs,qL,WL,a6],Xy=t=>GT.find(HT(t));class $T extends kx{constructor(e,n,s,i,r){super(e,n,s,i,r,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:s}=this;if(!n||!n.current)return;super.readKeyframes();for(let c=0;c<e.length;c++){let u=e[c];if(typeof u=="string"&&(u=u.trim(),ix(u))){const d=UT(u,n.current);d!==void 0&&(e[c]=d),c===e.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!bT.has(s)||e.length!==2)return;const[i,r]=e,a=Xy(i),l=Xy(r);if(a!==l)if(Yy(a)&&Yy(l))for(let c=0;c<e.length;c++){const u=e[c];typeof u=="string"&&(e[c]=parseFloat(u))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,s=[];for(let i=0;i<e.length;i++)LP(e[i])&&s.push(i);s.length&&ZP(e,s,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:s}=this;if(!e||!e.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=to[s](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const i=n[n.length-1];i!==void 0&&e.getValue(s,i).jump(i,!1)}measureEndState(){var e;const{element:n,name:s,unresolvedKeyframes:i}=this;if(!n||!n.current)return;const r=n.getValue(s);r&&r.jump(this.measuredOrigin,!1);const a=i.length-1,l=i[a];i[a]=to[s](n.measureViewportBox(),window.getComputedStyle(n.current)),l!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=l),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([c,u])=>{n.getValue(c).set(u)}),this.resolveNoneKeyframes()}}const Qy=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&($i.test(t)||t==="0")&&!t.startsWith("url("));function o6(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function l6(t,e,n,s){const i=t[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const r=t[t.length-1],a=Qy(i,e),l=Qy(r,e);return!a||!l?!1:o6(t)||(n==="spring"||fx(n))&&s}const c6=t=>t!==null;function Bf(t,{repeat:e,repeatType:n="loop"},s){const i=t.filter(c6),r=e&&n!=="loop"&&e%2===1?0:i.length-1;return!r||s===void 0?i[r]:s}const u6=40;class FT{constructor({autoplay:e=!0,delay:n=0,type:s="keyframes",repeat:i=0,repeatDelay:r=0,repeatType:a="loop",...l}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=cs.now(),this.options={autoplay:e,delay:n,type:s,repeat:i,repeatDelay:r,repeatType:a,...l},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>u6?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&s6(),this._resolved}onKeyframesResolved(e,n){this.resolvedAt=cs.now(),this.hasAttemptedResolve=!0;const{name:s,type:i,velocity:r,delay:a,onComplete:l,onUpdate:c,isGenerator:u}=this.options;if(!u&&!l6(e,s,i,r))if(a)this.options.duration=0;else{c&&c(Bf(e,this.options,n)),l&&l(),this.resolveFinishedPromise();return}const d=this.initPlayback(e,n);d!==!1&&(this._resolved={keyframes:e,finalKeyframe:n,...d},this.onPostResolved())}onPostResolved(){}then(e,n){return this.currentFinishedPromise.then(e,n)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const rt=(t,e,n)=>t+(e-t)*n;function $h(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function d6({hue:t,saturation:e,lightness:n,alpha:s}){t/=360,e/=100,n/=100;let i=0,r=0,a=0;if(!e)i=r=a=n;else{const l=n<.5?n*(1+e):n+e-n*e,c=2*n-l;i=$h(c,l,t+1/3),r=$h(c,l,t),a=$h(c,l,t-1/3)}return{red:Math.round(i*255),green:Math.round(r*255),blue:Math.round(a*255),alpha:s}}function Ld(t,e){return n=>n>0?e:t}const Fh=(t,e,n)=>{const s=t*t,i=n*(e*e-s)+s;return i<0?0:Math.sqrt(i)},f6=[Ep,fr,pa],h6=t=>f6.find(e=>e.test(t));function Jy(t){const e=h6(t);if(!e)return!1;let n=e.parse(t);return e===pa&&(n=d6(n)),n}const Zy=(t,e)=>{const n=Jy(t),s=Jy(e);if(!n||!s)return Ld(t,e);const i={...n};return r=>(i.red=Fh(n.red,s.red,r),i.green=Fh(n.green,s.green,r),i.blue=Fh(n.blue,s.blue,r),i.alpha=rt(n.alpha,s.alpha,r),fr.transform(i))},m6=(t,e)=>n=>e(t(n)),Cc=(...t)=>t.reduce(m6),Rp=new Set(["none","hidden"]);function p6(t,e){return Rp.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function g6(t,e){return n=>rt(t,e,n)}function Nx(t){return typeof t=="number"?g6:typeof t=="string"?ix(t)?Ld:Ht.test(t)?Zy:v6:Array.isArray(t)?zT:typeof t=="object"?Ht.test(t)?Zy:x6:Ld}function zT(t,e){const n=[...t],s=n.length,i=t.map((r,a)=>Nx(r)(r,e[a]));return r=>{for(let a=0;a<s;a++)n[a]=i[a](r);return n}}function x6(t,e){const n={...t,...e},s={};for(const i in n)t[i]!==void 0&&e[i]!==void 0&&(s[i]=Nx(t[i])(t[i],e[i]));return i=>{for(const r in s)n[r]=s[r](i);return n}}function b6(t,e){var n;const s=[],i={color:0,var:0,number:0};for(let r=0;r<e.values.length;r++){const a=e.types[r],l=t.indexes[a][i[a]],c=(n=t.values[l])!==null&&n!==void 0?n:0;s[r]=c,i[a]++}return s}const v6=(t,e)=>{const n=$i.createTransformer(e),s=Zl(t),i=Zl(e);return s.indexes.var.length===i.indexes.var.length&&s.indexes.color.length===i.indexes.color.length&&s.indexes.number.length>=i.indexes.number.length?Rp.has(t)&&!i.values.length||Rp.has(e)&&!s.values.length?p6(t,e):Cc(zT(b6(s,i),i.values),n):Ld(t,e)};function VT(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?rt(t,e,n):Nx(t)(t,e)}const y6=5;function KT(t,e,n){const s=Math.max(e-y6,0);return vT(n-t(s),e-s)}const lt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},zh=.001;function _6({duration:t=lt.duration,bounce:e=lt.bounce,velocity:n=lt.velocity,mass:s=lt.mass}){let i,r,a=1-e;a=Ks(lt.minDamping,lt.maxDamping,a),t=Ks(lt.minDuration,lt.maxDuration,Ds(t)),a<1?(i=u=>{const d=u*a,f=d*t,h=d-n,m=Ip(u,a),v=Math.exp(-f);return zh-h/m*v},r=u=>{const f=u*a*t,h=f*n+n,m=Math.pow(a,2)*Math.pow(u,2)*t,v=Math.exp(-f),y=Ip(Math.pow(u,2),a);return(-i(u)+zh>0?-1:1)*((h-m)*v)/y}):(i=u=>{const d=Math.exp(-u*t),f=(u-n)*t+1;return-zh+d*f},r=u=>{const d=Math.exp(-u*t),f=(n-u)*(t*t);return d*f});const l=5/t,c=k6(i,r,l);if(t=Ms(t),isNaN(c))return{stiffness:lt.stiffness,damping:lt.damping,duration:t};{const u=Math.pow(c,2)*s;return{stiffness:u,damping:a*2*Math.sqrt(s*u),duration:t}}}const w6=12;function k6(t,e,n){let s=n;for(let i=1;i<w6;i++)s=s-t(s)/e(s);return s}function Ip(t,e){return t*Math.sqrt(1-e*e)}const N6=["duration","bounce"],S6=["stiffness","damping","mass"];function e1(t,e){return e.some(n=>t[n]!==void 0)}function E6(t){let e={velocity:lt.velocity,stiffness:lt.stiffness,damping:lt.damping,mass:lt.mass,isResolvedFromDuration:!1,...t};if(!e1(t,S6)&&e1(t,N6))if(t.visualDuration){const n=t.visualDuration,s=2*Math.PI/(n*1.2),i=s*s,r=2*Ks(.05,1,1-(t.bounce||0))*Math.sqrt(i);e={...e,mass:lt.mass,stiffness:i,damping:r}}else{const n=_6(t);e={...e,...n,mass:lt.mass},e.isResolvedFromDuration=!0}return e}function YT(t=lt.visualDuration,e=lt.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:s,restDelta:i}=n;const r=n.keyframes[0],a=n.keyframes[n.keyframes.length-1],l={done:!1,value:r},{stiffness:c,damping:u,mass:d,duration:f,velocity:h,isResolvedFromDuration:m}=E6({...n,velocity:-Ds(n.velocity||0)}),v=h||0,y=u/(2*Math.sqrt(c*d)),b=a-r,g=Ds(Math.sqrt(c/d)),p=Math.abs(b)<5;s||(s=p?lt.restSpeed.granular:lt.restSpeed.default),i||(i=p?lt.restDelta.granular:lt.restDelta.default);let x;if(y<1){const k=Ip(g,y);x=S=>{const N=Math.exp(-y*g*S);return a-N*((v+y*g*b)/k*Math.sin(k*S)+b*Math.cos(k*S))}}else if(y===1)x=k=>a-Math.exp(-g*k)*(b+(v+g*b)*k);else{const k=g*Math.sqrt(y*y-1);x=S=>{const N=Math.exp(-y*g*S),T=Math.min(k*S,300);return a-N*((v+y*g*b)*Math.sinh(T)+k*b*Math.cosh(T))/k}}const w={calculatedDuration:m&&f||null,next:k=>{const S=x(k);if(m)l.done=k>=f;else{let N=0;y<1&&(N=k===0?Ms(v):KT(x,k,S));const T=Math.abs(N)<=s,E=Math.abs(a-S)<=i;l.done=T&&E}return l.value=l.done?a:S,l},toString:()=>{const k=Math.min(dT(w),kp),S=fT(N=>w.next(k*N).value,k,30);return k+"ms "+S}};return w}function t1({keyframes:t,velocity:e=0,power:n=.8,timeConstant:s=325,bounceDamping:i=10,bounceStiffness:r=500,modifyTarget:a,min:l,max:c,restDelta:u=.5,restSpeed:d}){const f=t[0],h={done:!1,value:f},m=T=>l!==void 0&&T<l||c!==void 0&&T>c,v=T=>l===void 0?c:c===void 0||Math.abs(l-T)<Math.abs(c-T)?l:c;let y=n*e;const b=f+y,g=a===void 0?b:a(b);g!==b&&(y=g-f);const p=T=>-y*Math.exp(-T/s),x=T=>g+p(T),w=T=>{const E=p(T),j=x(T);h.done=Math.abs(E)<=u,h.value=h.done?g:j};let k,S;const N=T=>{m(h.value)&&(k=T,S=YT({keyframes:[h.value,v(h.value)],velocity:KT(x,T,h.value),damping:i,stiffness:r,restDelta:u,restSpeed:d}))};return N(0),{calculatedDuration:null,next:T=>{let E=!1;return!S&&k===void 0&&(E=!0,w(T),N(T)),k!==void 0&&T>=k?S.next(T-k):(!E&&w(T),h)}}}const T6=Ic(.42,0,1,1),A6=Ic(0,0,.58,1),WT=Ic(.42,0,.58,1),j6=t=>Array.isArray(t)&&typeof t[0]!="number",R6={linear:xn,easeIn:T6,easeInOut:WT,easeOut:A6,circIn:vx,circInOut:AT,circOut:TT,backIn:bx,backInOut:ST,backOut:NT,anticipate:ET},n1=t=>{if(hx(t)){VE(t.length===4);const[e,n,s,i]=t;return Ic(e,n,s,i)}else if(typeof t=="string")return R6[t];return t};function I6(t,e,n){const s=[],i=n||VT,r=t.length-1;for(let a=0;a<r;a++){let l=i(t[a],t[a+1]);if(e){const c=Array.isArray(e)?e[a]||xn:e;l=Cc(c,l)}s.push(l)}return s}function C6(t,e,{clamp:n=!0,ease:s,mixer:i}={}){const r=t.length;if(VE(r===e.length),r===1)return()=>e[0];if(r===2&&e[0]===e[1])return()=>e[1];const a=t[0]===t[1];t[0]>t[r-1]&&(t=[...t].reverse(),e=[...e].reverse());const l=I6(e,s,i),c=l.length,u=d=>{if(a&&d<t[0])return e[0];let f=0;if(c>1)for(;f<t.length-2&&!(d<t[f+1]);f++);const h=Za(t[f],t[f+1],d);return l[f](h)};return n?d=>u(Ks(t[0],t[r-1],d)):u}function O6(t,e){const n=t[t.length-1];for(let s=1;s<=e;s++){const i=Za(0,e,s);t.push(rt(n,1,i))}}function M6(t){const e=[0];return O6(e,t.length-1),e}function D6(t,e){return t.map(n=>n*e)}function L6(t,e){return t.map(()=>e||WT).splice(0,t.length-1)}function Pd({duration:t=300,keyframes:e,times:n,ease:s="easeInOut"}){const i=j6(s)?s.map(n1):n1(s),r={done:!1,value:e[0]},a=D6(n&&n.length===e.length?n:M6(e),t),l=C6(a,e,{ease:Array.isArray(i)?i:L6(e,i)});return{calculatedDuration:t,next:c=>(r.value=l(c),r.done=c>=t,r)}}const P6=t=>{const e=({timestamp:n})=>t(n);return{start:()=>Qe.update(e,!0),stop:()=>Gi(e),now:()=>Ct.isProcessing?Ct.timestamp:cs.now()}},B6={decay:t1,inertia:t1,tween:Pd,keyframes:Pd,spring:YT},U6=t=>t/100;class Sx extends FT{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:c}=this.options;c&&c()};const{name:n,motionValue:s,element:i,keyframes:r}=this.options,a=(i==null?void 0:i.KeyframeResolver)||kx,l=(c,u)=>this.onKeyframesResolved(c,u);this.resolver=new a(r,l,n,s,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:n="keyframes",repeat:s=0,repeatDelay:i=0,repeatType:r,velocity:a=0}=this.options,l=fx(n)?n:B6[n]||Pd;let c,u;l!==Pd&&typeof e[0]!="number"&&(c=Cc(U6,VT(e[0],e[1])),e=[0,100]);const d=l({...this.options,keyframes:e});r==="mirror"&&(u=l({...this.options,keyframes:[...e].reverse(),velocity:-a})),d.calculatedDuration===null&&(d.calculatedDuration=dT(d));const{calculatedDuration:f}=d,h=f+i,m=h*(s+1)-i;return{generator:d,mirroredGenerator:u,mapPercentToKeyframes:c,calculatedDuration:f,resolvedDuration:h,totalDuration:m}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,n=!1){const{resolved:s}=this;if(!s){const{keyframes:T}=this.options;return{done:!0,value:T[T.length-1]}}const{finalKeyframe:i,generator:r,mirroredGenerator:a,mapPercentToKeyframes:l,keyframes:c,calculatedDuration:u,totalDuration:d,resolvedDuration:f}=s;if(this.startTime===null)return r.next(0);const{delay:h,repeat:m,repeatType:v,repeatDelay:y,onUpdate:b}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-d/this.speed,this.startTime)),n?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const g=this.currentTime-h*(this.speed>=0?1:-1),p=this.speed>=0?g<0:g>d;this.currentTime=Math.max(g,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=d);let x=this.currentTime,w=r;if(m){const T=Math.min(this.currentTime,d)/f;let E=Math.floor(T),j=T%1;!j&&T>=1&&(j=1),j===1&&E--,E=Math.min(E,m+1),!!(E%2)&&(v==="reverse"?(j=1-j,y&&(j-=y/f)):v==="mirror"&&(w=a)),x=Ks(0,1,j)*f}const k=p?{done:!1,value:c[0]}:w.next(x);l&&(k.value=l(k.value));let{done:S}=k;!p&&u!==null&&(S=this.speed>=0?this.currentTime>=d:this.currentTime<=0);const N=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&S);return N&&i!==void 0&&(k.value=Bf(c,this.options,i)),b&&b(k.value),N&&this.finish(),k}get duration(){const{resolved:e}=this;return e?Ds(e.calculatedDuration):0}get time(){return Ds(this.currentTime)}set time(e){e=Ms(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=Ds(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=P6,onPlay:n,startTime:s}=this.options;this.driver||(this.driver=e(r=>this.tick(r))),n&&n();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=s??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const H6=new Set(["opacity","clipPath","filter","transform"]);function G6(t,e,n,{delay:s=0,duration:i=300,repeat:r=0,repeatType:a="loop",ease:l="easeInOut",times:c}={}){const u={[e]:n};c&&(u.offset=c);const d=mT(l,i);return Array.isArray(d)&&(u.easing=d),t.animate(u,{delay:s,duration:i,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:r+1,direction:a==="reverse"?"alternate":"normal"})}const $6=Qg(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Bd=10,F6=2e4;function z6(t){return fx(t.type)||t.type==="spring"||!hT(t.ease)}function V6(t,e){const n=new Sx({...e,keyframes:t,repeat:0,delay:0,isGenerator:!0});let s={done:!1,value:t[0]};const i=[];let r=0;for(;!s.done&&r<F6;)s=n.sample(r),i.push(s.value),r+=Bd;return{times:void 0,keyframes:i,duration:r-Bd,ease:"linear"}}const qT={anticipate:ET,backInOut:ST,circInOut:AT};function K6(t){return t in qT}class s1 extends FT{constructor(e){super(e);const{name:n,motionValue:s,element:i,keyframes:r}=this.options;this.resolver=new $T(r,(a,l)=>this.onKeyframesResolved(a,l),n,s,i),this.resolver.scheduleResolve()}initPlayback(e,n){let{duration:s=300,times:i,ease:r,type:a,motionValue:l,name:c,startTime:u}=this.options;if(!l.owner||!l.owner.current)return!1;if(typeof r=="string"&&Dd()&&K6(r)&&(r=qT[r]),z6(this.options)){const{onComplete:f,onUpdate:h,motionValue:m,element:v,...y}=this.options,b=V6(e,y);e=b.keyframes,e.length===1&&(e[1]=e[0]),s=b.duration,i=b.times,r=b.ease,a="keyframes"}const d=G6(l.owner.current,c,e,{...this.options,duration:s,times:i,ease:r});return d.startTime=u??this.calcStartTime(),this.pendingTimeline?(Gy(d,this.pendingTimeline),this.pendingTimeline=void 0):d.onfinish=()=>{const{onComplete:f}=this.options;l.set(Bf(e,this.options,n)),f&&f(),this.cancel(),this.resolveFinishedPromise()},{animation:d,duration:s,times:i,type:a,ease:r,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:n}=e;return Ds(n)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:n}=e;return Ds(n.currentTime||0)}set time(e){const{resolved:n}=this;if(!n)return;const{animation:s}=n;s.currentTime=Ms(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:n}=e;return n.playbackRate}set speed(e){const{resolved:n}=this;if(!n)return;const{animation:s}=n;s.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:n}=e;return n.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:n}=e;return n.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:n}=this;if(!n)return xn;const{animation:s}=n;Gy(s,e)}return xn}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.playState==="finished"&&this.updateFinishedPromise(),n.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:n,keyframes:s,duration:i,type:r,ease:a,times:l}=e;if(n.playState==="idle"||n.playState==="finished")return;if(this.time){const{motionValue:u,onUpdate:d,onComplete:f,element:h,...m}=this.options,v=new Sx({...m,keyframes:s,duration:i,type:r,ease:a,times:l,isGenerator:!0}),y=Ms(this.time);u.setWithVelocity(v.sample(y-Bd).value,v.sample(y).value,Bd)}const{onStop:c}=this.options;c&&c(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:n,name:s,repeatDelay:i,repeatType:r,damping:a,type:l}=e;if(!n||!n.owner||!(n.owner.current instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:u}=n.owner.getProps();return $6()&&s&&H6.has(s)&&!c&&!u&&!i&&r!=="mirror"&&a!==0&&l!=="inertia"}}const Y6={type:"spring",stiffness:500,damping:25,restSpeed:10},W6=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),q6={type:"keyframes",duration:.8},X6={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Q6=(t,{keyframes:e})=>e.length>2?q6:Vr.has(t)?t.startsWith("scale")?W6(e[1]):Y6:X6;function J6({when:t,delay:e,delayChildren:n,staggerChildren:s,staggerDirection:i,repeat:r,repeatType:a,repeatDelay:l,from:c,elapsed:u,...d}){return!!Object.keys(d).length}const Ex=(t,e,n,s={},i,r)=>a=>{const l=dx(s,t)||{},c=l.delay||s.delay||0;let{elapsed:u=0}=s;u=u-Ms(c);let d={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...l,delay:-u,onUpdate:h=>{e.set(h),l.onUpdate&&l.onUpdate(h)},onComplete:()=>{a(),l.onComplete&&l.onComplete()},name:t,motionValue:e,element:r?void 0:i};J6(l)||(d={...d,...Q6(t,d)}),d.duration&&(d.duration=Ms(d.duration)),d.repeatDelay&&(d.repeatDelay=Ms(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let f=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(d.duration=0,d.delay===0&&(f=!0)),f&&!r&&e.get()!==void 0){const h=Bf(d.keyframes,l);if(h!==void 0)return Qe.update(()=>{d.onUpdate(h),d.onComplete()}),new xP([])}return!r&&s1.supports(d)?new s1(d):new Sx(d)};function Z6({protectedKeys:t,needsAnimating:e},n){const s=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,s}function XT(t,e,{delay:n=0,transitionOverride:s,type:i}={}){var r;let{transition:a=t.getDefaultTransition(),transitionEnd:l,...c}=e;s&&(a=s);const u=[],d=i&&t.animationState&&t.animationState.getState()[i];for(const f in c){const h=t.getValue(f,(r=t.latestValues[f])!==null&&r!==void 0?r:null),m=c[f];if(m===void 0||d&&Z6(d,f))continue;const v={delay:n,...dx(a||{},f)};let y=!1;if(window.MotionHandoffAnimation){const g=yT(t);if(g){const p=window.MotionHandoffAnimation(g,f,Qe);p!==null&&(v.startTime=p,y=!0)}}Sp(t,f),h.start(Ex(f,h,m,t.shouldReduceMotion&&bT.has(f)?{type:!1}:v,t,y));const b=h.animation;b&&u.push(b)}return l&&Promise.all(u).then(()=>{Qe.update(()=>{l&&IP(t,l)})}),u}function Cp(t,e,n={}){var s;const i=Pf(t,e,n.type==="exit"?(s=t.presenceContext)===null||s===void 0?void 0:s.custom:void 0);let{transition:r=t.getDefaultTransition()||{}}=i||{};n.transitionOverride&&(r=n.transitionOverride);const a=i?()=>Promise.all(XT(t,i,n)):()=>Promise.resolve(),l=t.variantChildren&&t.variantChildren.size?(u=0)=>{const{delayChildren:d=0,staggerChildren:f,staggerDirection:h}=r;return e8(t,e,d+u,f,h,n)}:()=>Promise.resolve(),{when:c}=r;if(c){const[u,d]=c==="beforeChildren"?[a,l]:[l,a];return u().then(()=>d())}else return Promise.all([a(),l(n.delay)])}function e8(t,e,n=0,s=0,i=1,r){const a=[],l=(t.variantChildren.size-1)*s,c=i===1?(u=0)=>u*s:(u=0)=>l-u*s;return Array.from(t.variantChildren).sort(t8).forEach((u,d)=>{u.notify("AnimationStart",e),a.push(Cp(u,e,{...r,delay:n+c(d)}).then(()=>u.notify("AnimationComplete",e)))}),Promise.all(a)}function t8(t,e){return t.sortNodePosition(e)}function n8(t,e,n={}){t.notify("AnimationStart",e);let s;if(Array.isArray(e)){const i=e.map(r=>Cp(t,r,n));s=Promise.all(i)}else if(typeof e=="string")s=Cp(t,e,n);else{const i=typeof e=="function"?Pf(t,e,n.custom):e;s=Promise.all(XT(t,i,n))}return s.then(()=>{t.notify("AnimationComplete",e)})}const s8=Zg.length;function QT(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?QT(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<s8;n++){const s=Zg[n],i=t.props[s];(Xl(i)||i===!1)&&(e[s]=i)}return e}const i8=[...Jg].reverse(),r8=Jg.length;function a8(t){return e=>Promise.all(e.map(({animation:n,options:s})=>n8(t,n,s)))}function o8(t){let e=a8(t),n=i1(),s=!0;const i=c=>(u,d)=>{var f;const h=Pf(t,d,c==="exit"?(f=t.presenceContext)===null||f===void 0?void 0:f.custom:void 0);if(h){const{transition:m,transitionEnd:v,...y}=h;u={...u,...y,...v}}return u};function r(c){e=c(t)}function a(c){const{props:u}=t,d=QT(t.parent)||{},f=[],h=new Set;let m={},v=1/0;for(let b=0;b<r8;b++){const g=i8[b],p=n[g],x=u[g]!==void 0?u[g]:d[g],w=Xl(x),k=g===c?p.isActive:null;k===!1&&(v=b);let S=x===d[g]&&x!==u[g]&&w;if(S&&s&&t.manuallyAnimateOnMount&&(S=!1),p.protectedKeys={...m},!p.isActive&&k===null||!x&&!p.prevProp||Df(x)||typeof x=="boolean")continue;const N=l8(p.prevProp,x);let T=N||g===c&&p.isActive&&!S&&w||b>v&&w,E=!1;const j=Array.isArray(x)?x:[x];let R=j.reduce(i(g),{});k===!1&&(R={});const{prevResolvedValues:I={}}=p,V={...I,...R},B=M=>{T=!0,h.has(M)&&(E=!0,h.delete(M)),p.needsAnimating[M]=!0;const C=t.getValue(M);C&&(C.liveStyle=!1)};for(const M in V){const C=R[M],U=I[M];if(m.hasOwnProperty(M))continue;let K=!1;wp(C)&&wp(U)?K=!uT(C,U):K=C!==U,K?C!=null?B(M):h.add(M):C!==void 0&&h.has(M)?B(M):p.protectedKeys[M]=!0}p.prevProp=x,p.prevResolvedValues=R,p.isActive&&(m={...m,...R}),s&&t.blockInitialAnimation&&(T=!1),T&&(!(S&&N)||E)&&f.push(...j.map(M=>({animation:M,options:{type:g}})))}if(h.size){const b={};h.forEach(g=>{const p=t.getBaseTarget(g),x=t.getValue(g);x&&(x.liveStyle=!0),b[g]=p??null}),f.push({animation:b})}let y=!!f.length;return s&&(u.initial===!1||u.initial===u.animate)&&!t.manuallyAnimateOnMount&&(y=!1),s=!1,y?e(f):Promise.resolve()}function l(c,u){var d;if(n[c].isActive===u)return Promise.resolve();(d=t.variantChildren)===null||d===void 0||d.forEach(h=>{var m;return(m=h.animationState)===null||m===void 0?void 0:m.setActive(c,u)}),n[c].isActive=u;const f=a(c);for(const h in n)n[h].protectedKeys={};return f}return{animateChanges:a,setActive:l,setAnimateFunction:r,getState:()=>n,reset:()=>{n=i1(),s=!0}}}function l8(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!uT(e,t):!1}function Zi(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function i1(){return{animate:Zi(!0),whileInView:Zi(),whileHover:Zi(),whileTap:Zi(),whileDrag:Zi(),whileFocus:Zi(),exit:Zi()}}class qi{constructor(e){this.isMounted=!1,this.node=e}update(){}}class c8 extends qi{constructor(e){super(e),e.animationState||(e.animationState=o8(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Df(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let u8=0;class d8 extends qi{constructor(){super(...arguments),this.id=u8++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===s)return;const i=this.node.animationState.setActive("exit",!e);n&&!e&&i.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const f8={animation:{Feature:c8},exit:{Feature:d8}};function ec(t,e,n,s={passive:!0}){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n)}function Oc(t){return{point:{x:t.pageX,y:t.pageY}}}const h8=t=>e=>mx(e)&&t(e,Oc(e));function xl(t,e,n,s){return ec(t,e,h8(n),s)}const r1=(t,e)=>Math.abs(t-e);function m8(t,e){const n=r1(t.x,e.x),s=r1(t.y,e.y);return Math.sqrt(n**2+s**2)}class JT{constructor(e,n,{transformPagePoint:s,contextWindow:i,dragSnapToOrigin:r=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=Kh(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,m=m8(f.offset,{x:0,y:0})>=3;if(!h&&!m)return;const{point:v}=f,{timestamp:y}=Ct;this.history.push({...v,timestamp:y});const{onStart:b,onMove:g}=this.handlers;h||(b&&b(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),g&&g(this.lastMoveEvent,f)},this.handlePointerMove=(f,h)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=Vh(h,this.transformPagePoint),Qe.update(this.updatePoint,!0)},this.handlePointerUp=(f,h)=>{this.end();const{onEnd:m,onSessionEnd:v,resumeAnimation:y}=this.handlers;if(this.dragSnapToOrigin&&y&&y(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const b=Kh(f.type==="pointercancel"?this.lastMoveEventInfo:Vh(h,this.transformPagePoint),this.history);this.startEvent&&m&&m(f,b),v&&v(f,b)},!mx(e))return;this.dragSnapToOrigin=r,this.handlers=n,this.transformPagePoint=s,this.contextWindow=i||window;const a=Oc(e),l=Vh(a,this.transformPagePoint),{point:c}=l,{timestamp:u}=Ct;this.history=[{...c,timestamp:u}];const{onSessionStart:d}=n;d&&d(e,Kh(l,this.history)),this.removeListeners=Cc(xl(this.contextWindow,"pointermove",this.handlePointerMove),xl(this.contextWindow,"pointerup",this.handlePointerUp),xl(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Gi(this.updatePoint)}}function Vh(t,e){return e?{point:e(t.point)}:t}function a1(t,e){return{x:t.x-e.x,y:t.y-e.y}}function Kh({point:t},e){return{point:t,delta:a1(t,ZT(e)),offset:a1(t,p8(e)),velocity:g8(e,.1)}}function p8(t){return t[0]}function ZT(t){return t[t.length-1]}function g8(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,s=null;const i=ZT(t);for(;n>=0&&(s=t[n],!(i.timestamp-s.timestamp>Ms(e)));)n--;if(!s)return{x:0,y:0};const r=Ds(i.timestamp-s.timestamp);if(r===0)return{x:0,y:0};const a={x:(i.x-s.x)/r,y:(i.y-s.y)/r};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}const eA=1e-4,x8=1-eA,b8=1+eA,tA=.01,v8=0-tA,y8=0+tA;function _n(t){return t.max-t.min}function _8(t,e,n){return Math.abs(t-e)<=n}function o1(t,e,n,s=.5){t.origin=s,t.originPoint=rt(e.min,e.max,t.origin),t.scale=_n(n)/_n(e),t.translate=rt(n.min,n.max,t.origin)-t.originPoint,(t.scale>=x8&&t.scale<=b8||isNaN(t.scale))&&(t.scale=1),(t.translate>=v8&&t.translate<=y8||isNaN(t.translate))&&(t.translate=0)}function bl(t,e,n,s){o1(t.x,e.x,n.x,s?s.originX:void 0),o1(t.y,e.y,n.y,s?s.originY:void 0)}function l1(t,e,n){t.min=n.min+e.min,t.max=t.min+_n(e)}function w8(t,e,n){l1(t.x,e.x,n.x),l1(t.y,e.y,n.y)}function c1(t,e,n){t.min=e.min-n.min,t.max=t.min+_n(e)}function vl(t,e,n){c1(t.x,e.x,n.x),c1(t.y,e.y,n.y)}function k8(t,{min:e,max:n},s){return e!==void 0&&t<e?t=s?rt(e,t,s.min):Math.max(t,e):n!==void 0&&t>n&&(t=s?rt(n,t,s.max):Math.min(t,n)),t}function u1(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function N8(t,{top:e,left:n,bottom:s,right:i}){return{x:u1(t.x,n,i),y:u1(t.y,e,s)}}function d1(t,e){let n=e.min-t.min,s=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,s]=[s,n]),{min:n,max:s}}function S8(t,e){return{x:d1(t.x,e.x),y:d1(t.y,e.y)}}function E8(t,e){let n=.5;const s=_n(t),i=_n(e);return i>s?n=Za(e.min,e.max-s,t.min):s>i&&(n=Za(t.min,t.max-i,e.min)),Ks(0,1,n)}function T8(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const Op=.35;function A8(t=Op){return t===!1?t=0:t===!0&&(t=Op),{x:f1(t,"left","right"),y:f1(t,"top","bottom")}}function f1(t,e,n){return{min:h1(t,e),max:h1(t,n)}}function h1(t,e){return typeof t=="number"?t:t[e]||0}const m1=()=>({translate:0,scale:1,origin:0,originPoint:0}),ga=()=>({x:m1(),y:m1()}),p1=()=>({min:0,max:0}),dt=()=>({x:p1(),y:p1()});function Sn(t){return[t("x"),t("y")]}function nA({top:t,left:e,right:n,bottom:s}){return{x:{min:e,max:n},y:{min:t,max:s}}}function j8({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function R8(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),s=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:s.y,right:s.x}}function Yh(t){return t===void 0||t===1}function Mp({scale:t,scaleX:e,scaleY:n}){return!Yh(t)||!Yh(e)||!Yh(n)}function lr(t){return Mp(t)||sA(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function sA(t){return g1(t.x)||g1(t.y)}function g1(t){return t&&t!=="0%"}function Ud(t,e,n){const s=t-n,i=e*s;return n+i}function x1(t,e,n,s,i){return i!==void 0&&(t=Ud(t,i,s)),Ud(t,n,s)+e}function Dp(t,e=0,n=1,s,i){t.min=x1(t.min,e,n,s,i),t.max=x1(t.max,e,n,s,i)}function iA(t,{x:e,y:n}){Dp(t.x,e.translate,e.scale,e.originPoint),Dp(t.y,n.translate,n.scale,n.originPoint)}const b1=.999999999999,v1=1.0000000000001;function I8(t,e,n,s=!1){const i=n.length;if(!i)return;e.x=e.y=1;let r,a;for(let l=0;l<i;l++){r=n[l],a=r.projectionDelta;const{visualElement:c}=r.options;c&&c.props.style&&c.props.style.display==="contents"||(s&&r.options.layoutScroll&&r.scroll&&r!==r.root&&ba(t,{x:-r.scroll.offset.x,y:-r.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,iA(t,a)),s&&lr(r.latestValues)&&ba(t,r.latestValues))}e.x<v1&&e.x>b1&&(e.x=1),e.y<v1&&e.y>b1&&(e.y=1)}function xa(t,e){t.min=t.min+e,t.max=t.max+e}function y1(t,e,n,s,i=.5){const r=rt(t.min,t.max,i);Dp(t,e,n,r,s)}function ba(t,e){y1(t.x,e.x,e.scaleX,e.scale,e.originX),y1(t.y,e.y,e.scaleY,e.scale,e.originY)}function rA(t,e){return nA(R8(t.getBoundingClientRect(),e))}function C8(t,e,n){const s=rA(t,n),{scroll:i}=e;return i&&(xa(s.x,i.offset.x),xa(s.y,i.offset.y)),s}const aA=({current:t})=>t?t.ownerDocument.defaultView:null,O8=new WeakMap;class M8{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=dt(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const i=d=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(Oc(d).point)},r=(d,f)=>{const{drag:h,dragPropagation:m,onDragStart:v}=this.getProps();if(h&&!m&&(this.openDragLock&&this.openDragLock(),this.openDragLock=EP(h),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Sn(b=>{let g=this.getAxisMotionValue(b).get()||0;if(ls.test(g)){const{projection:p}=this.visualElement;if(p&&p.layout){const x=p.layout.layoutBox[b];x&&(g=_n(x)*(parseFloat(g)/100))}}this.originPoint[b]=g}),v&&Qe.postRender(()=>v(d,f)),Sp(this.visualElement,"transform");const{animationState:y}=this.visualElement;y&&y.setActive("whileDrag",!0)},a=(d,f)=>{const{dragPropagation:h,dragDirectionLock:m,onDirectionLock:v,onDrag:y}=this.getProps();if(!h&&!this.openDragLock)return;const{offset:b}=f;if(m&&this.currentDirection===null){this.currentDirection=D8(b),this.currentDirection!==null&&v&&v(this.currentDirection);return}this.updateAxis("x",f.point,b),this.updateAxis("y",f.point,b),this.visualElement.render(),y&&y(d,f)},l=(d,f)=>this.stop(d,f),c=()=>Sn(d=>{var f;return this.getAnimationState(d)==="paused"&&((f=this.getAxisMotionValue(d).animation)===null||f===void 0?void 0:f.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new JT(e,{onSessionStart:i,onStart:r,onMove:a,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:aA(this.visualElement)})}stop(e,n){const s=this.isDragging;if(this.cancel(),!s)return;const{velocity:i}=n;this.startAnimation(i);const{onDragEnd:r}=this.getProps();r&&Qe.postRender(()=>r(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,s){const{drag:i}=this.getProps();if(!s||!au(e,i,this.currentDirection))return;const r=this.getAxisMotionValue(e);let a=this.originPoint[e]+s[e];this.constraints&&this.constraints[e]&&(a=k8(a,this.constraints[e],this.elastic[e])),r.set(a)}resolveConstraints(){var e;const{dragConstraints:n,dragElastic:s}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,r=this.constraints;n&&ma(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&i?this.constraints=N8(i.layoutBox,n):this.constraints=!1,this.elastic=A8(s),r!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&Sn(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=T8(i.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!ma(e))return!1;const s=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const r=C8(s,i.root,this.visualElement.getTransformPagePoint());let a=S8(i.layout.layoutBox,r);if(n){const l=n(j8(a));this.hasMutatedConstraints=!!l,l&&(a=nA(l))}return a}startAnimation(e){const{drag:n,dragMomentum:s,dragElastic:i,dragTransition:r,dragSnapToOrigin:a,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},u=Sn(d=>{if(!au(d,n,this.currentDirection))return;let f=c&&c[d]||{};a&&(f={min:0,max:0});const h=i?200:1e6,m=i?40:1e7,v={type:"inertia",velocity:s?e[d]:0,bounceStiffness:h,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...r,...f};return this.startAxisValueAnimation(d,v)});return Promise.all(u).then(l)}startAxisValueAnimation(e,n){const s=this.getAxisMotionValue(e);return Sp(this.visualElement,e),s.start(Ex(e,s,0,n,this.visualElement,!1))}stopAnimation(){Sn(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Sn(e=>{var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,s=this.visualElement.getProps(),i=s[n];return i||this.visualElement.getValue(e,(s.initial?s.initial[e]:void 0)||0)}snapToCursor(e){Sn(n=>{const{drag:s}=this.getProps();if(!au(n,s,this.currentDirection))return;const{projection:i}=this.visualElement,r=this.getAxisMotionValue(n);if(i&&i.layout){const{min:a,max:l}=i.layout.layoutBox[n];r.set(e[n]-rt(a,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:s}=this.visualElement;if(!ma(n)||!s||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};Sn(a=>{const l=this.getAxisMotionValue(a);if(l&&this.constraints!==!1){const c=l.get();i[a]=E8({min:c,max:c},this.constraints[a])}});const{transformTemplate:r}=this.visualElement.getProps();this.visualElement.current.style.transform=r?r({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),Sn(a=>{if(!au(a,e,null))return;const l=this.getAxisMotionValue(a),{min:c,max:u}=this.constraints[a];l.set(rt(c,u,i[a]))})}addListeners(){if(!this.visualElement.current)return;O8.set(this.visualElement,this);const e=this.visualElement.current,n=xl(e,"pointerdown",c=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(c)}),s=()=>{const{dragConstraints:c}=this.getProps();ma(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,r=i.addEventListener("measure",s);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),Qe.read(s);const a=ec(window,"resize",()=>this.scalePositionWithinConstraints()),l=i.addEventListener("didUpdate",({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&(Sn(d=>{const f=this.getAxisMotionValue(d);f&&(this.originPoint[d]+=c[d].translate,f.set(f.get()+c[d].translate))}),this.visualElement.render())});return()=>{a(),n(),r(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:s=!1,dragPropagation:i=!1,dragConstraints:r=!1,dragElastic:a=Op,dragMomentum:l=!0}=e;return{...e,drag:n,dragDirectionLock:s,dragPropagation:i,dragConstraints:r,dragElastic:a,dragMomentum:l}}}function au(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function D8(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class L8 extends qi{constructor(e){super(e),this.removeGroupControls=xn,this.removeListeners=xn,this.controls=new M8(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||xn}unmount(){this.removeGroupControls(),this.removeListeners()}}const _1=t=>(e,n)=>{t&&Qe.postRender(()=>t(e,n))};class P8 extends qi{constructor(){super(...arguments),this.removePointerDownListener=xn}onPointerDown(e){this.session=new JT(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:aA(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:s,onPanEnd:i}=this.node.getProps();return{onSessionStart:_1(e),onStart:_1(n),onMove:s,onEnd:(r,a)=>{delete this.session,i&&Qe.postRender(()=>i(r,a))}}}mount(){this.removePointerDownListener=xl(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Cu={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function w1(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Po={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(re.test(t))t=parseFloat(t);else return t;const n=w1(t,e.target.x),s=w1(t,e.target.y);return`${n}% ${s}%`}},B8={correct:(t,{treeScale:e,projectionDelta:n})=>{const s=t,i=$i.parse(t);if(i.length>5)return s;const r=$i.createTransformer(t),a=typeof i[0]!="number"?1:0,l=n.x.scale*e.x,c=n.y.scale*e.y;i[0+a]/=l,i[1+a]/=c;const u=rt(l,c,.5);return typeof i[2+a]=="number"&&(i[2+a]/=u),typeof i[3+a]=="number"&&(i[3+a]/=u),r(i)}};class U8 extends _.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:s,layoutId:i}=this.props,{projection:r}=e;rP(H8),r&&(n.group&&n.group.add(r),s&&s.register&&i&&s.register(r),r.root.didUpdate(),r.addEventListener("animationComplete",()=>{this.safeToRemove()}),r.setOptions({...r.options,onExitComplete:()=>this.safeToRemove()})),Cu.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:s,drag:i,isPresent:r}=this.props,a=s.projection;return a&&(a.isPresent=r,i||e.layoutDependency!==n||n===void 0?a.willUpdate():this.safeToRemove(),e.isPresent!==r&&(r?a.promote():a.relegate()||Qe.postRender(()=>{const l=a.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),tx.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:s}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(i),s&&s.deregister&&s.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function oA(t){const[e,n]=FE(),s=_.useContext(Yg);return o.jsx(U8,{...t,layoutGroup:s,switchLayoutGroup:_.useContext(QE),isPresent:e,safeToRemove:n})}const H8={borderRadius:{...Po,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Po,borderTopRightRadius:Po,borderBottomLeftRadius:Po,borderBottomRightRadius:Po,boxShadow:B8};function G8(t,e,n){const s=Gt(t)?t:Jl(t);return s.start(Ex("",s,e,n)),s.animation}function $8(t){return t instanceof SVGElement&&t.tagName!=="svg"}const F8=(t,e)=>t.depth-e.depth;class z8{constructor(){this.children=[],this.isDirty=!1}add(e){px(this.children,e),this.isDirty=!0}remove(e){gx(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(F8),this.isDirty=!1,this.children.forEach(e)}}function V8(t,e){const n=cs.now(),s=({timestamp:i})=>{const r=i-n;r>=e&&(Gi(s),t(r-e))};return Qe.read(s,!0),()=>Gi(s)}const lA=["TopLeft","TopRight","BottomLeft","BottomRight"],K8=lA.length,k1=t=>typeof t=="string"?parseFloat(t):t,N1=t=>typeof t=="number"||re.test(t);function Y8(t,e,n,s,i,r){i?(t.opacity=rt(0,n.opacity!==void 0?n.opacity:1,W8(s)),t.opacityExit=rt(e.opacity!==void 0?e.opacity:1,0,q8(s))):r&&(t.opacity=rt(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,s));for(let a=0;a<K8;a++){const l=`border${lA[a]}Radius`;let c=S1(e,l),u=S1(n,l);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||N1(c)===N1(u)?(t[l]=Math.max(rt(k1(c),k1(u),s),0),(ls.test(u)||ls.test(c))&&(t[l]+="%")):t[l]=u}(e.rotate||n.rotate)&&(t.rotate=rt(e.rotate||0,n.rotate||0,s))}function S1(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const W8=cA(0,.5,TT),q8=cA(.5,.95,xn);function cA(t,e,n){return s=>s<t?0:s>e?1:n(Za(t,e,s))}function E1(t,e){t.min=e.min,t.max=e.max}function Nn(t,e){E1(t.x,e.x),E1(t.y,e.y)}function T1(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function A1(t,e,n,s,i){return t-=e,t=Ud(t,1/n,s),i!==void 0&&(t=Ud(t,1/i,s)),t}function X8(t,e=0,n=1,s=.5,i,r=t,a=t){if(ls.test(e)&&(e=parseFloat(e),e=rt(a.min,a.max,e/100)-a.min),typeof e!="number")return;let l=rt(r.min,r.max,s);t===r&&(l-=e),t.min=A1(t.min,e,n,l,i),t.max=A1(t.max,e,n,l,i)}function j1(t,e,[n,s,i],r,a){X8(t,e[n],e[s],e[i],e.scale,r,a)}const Q8=["x","scaleX","originX"],J8=["y","scaleY","originY"];function R1(t,e,n,s){j1(t.x,e,Q8,n?n.x:void 0,s?s.x:void 0),j1(t.y,e,J8,n?n.y:void 0,s?s.y:void 0)}function I1(t){return t.translate===0&&t.scale===1}function uA(t){return I1(t.x)&&I1(t.y)}function C1(t,e){return t.min===e.min&&t.max===e.max}function Z8(t,e){return C1(t.x,e.x)&&C1(t.y,e.y)}function O1(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function dA(t,e){return O1(t.x,e.x)&&O1(t.y,e.y)}function M1(t){return _n(t.x)/_n(t.y)}function D1(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class eB{constructor(){this.members=[]}add(e){px(this.members,e),e.scheduleRender()}remove(e){if(gx(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(i=>e===i);if(n===0)return!1;let s;for(let i=n;i>=0;i--){const r=this.members[i];if(r.isPresent!==!1){s=r;break}}return s?(this.promote(s),!0):!1}promote(e,n){const s=this.lead;if(e!==s&&(this.prevLead=s,this.lead=e,e.show(),s)){s.instance&&s.scheduleRender(),e.scheduleRender(),e.resumeFrom=s,n&&(e.resumeFrom.preserveOpacity=!0),s.snapshot&&(e.snapshot=s.snapshot,e.snapshot.latestValues=s.animationValues||s.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:s}=e;n.onExitComplete&&n.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function tB(t,e,n){let s="";const i=t.x.translate/e.x,r=t.y.translate/e.y,a=(n==null?void 0:n.z)||0;if((i||r||a)&&(s=`translate3d(${i}px, ${r}px, ${a}px) `),(e.x!==1||e.y!==1)&&(s+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:u,rotate:d,rotateX:f,rotateY:h,skewX:m,skewY:v}=n;u&&(s=`perspective(${u}px) ${s}`),d&&(s+=`rotate(${d}deg) `),f&&(s+=`rotateX(${f}deg) `),h&&(s+=`rotateY(${h}deg) `),m&&(s+=`skewX(${m}deg) `),v&&(s+=`skewY(${v}deg) `)}const l=t.x.scale*e.x,c=t.y.scale*e.y;return(l!==1||c!==1)&&(s+=`scale(${l}, ${c})`),s||"none"}const cr={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},Wo=typeof window<"u"&&window.MotionDebug!==void 0,Wh=["","X","Y","Z"],nB={visibility:"hidden"},L1=1e3;let sB=0;function qh(t,e,n,s){const{latestValues:i}=e;i[t]&&(n[t]=i[t],e.setStaticValue(t,0),s&&(s[t]=0))}function fA(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=yT(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:i,layoutId:r}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",Qe,!(i||r))}const{parent:s}=t;s&&!s.hasCheckedOptimisedAppear&&fA(s)}function hA({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:s,resetTransform:i}){return class{constructor(a={},l=e==null?void 0:e()){this.id=sB++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Wo&&(cr.totalNodes=cr.resolvedTargetDeltas=cr.recalculatedProjection=0),this.nodes.forEach(aB),this.nodes.forEach(dB),this.nodes.forEach(fB),this.nodes.forEach(oB),Wo&&window.MotionDebug.record(cr)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new z8)}addEventListener(a,l){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new xx),this.eventHandlers.get(a).add(l)}notifyListeners(a,...l){const c=this.eventHandlers.get(a);c&&c.notify(...l)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=$8(a),this.instance=a;const{layoutId:c,layout:u,visualElement:d}=this.options;if(d&&!d.current&&d.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(u||c)&&(this.isLayoutDirty=!0),t){let f;const h=()=>this.root.updateBlockedByResize=!1;t(a,()=>{this.root.updateBlockedByResize=!0,f&&f(),f=V8(h,250),Cu.hasAnimatedSinceResize&&(Cu.hasAnimatedSinceResize=!1,this.nodes.forEach(B1))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||u)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:h,hasRelativeTargetChanged:m,layout:v})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const y=this.options.transition||d.getDefaultTransition()||xB,{onLayoutAnimationStart:b,onLayoutAnimationComplete:g}=d.getProps(),p=!this.targetLayout||!dA(this.targetLayout,v)||m,x=!h&&m;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||x||h&&(p||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(f,x);const w={...dx(y,"layout"),onPlay:b,onComplete:g};(d.shouldReduceMotion||this.options.layoutRoot)&&(w.delay=0,w.type=!1),this.startAnimation(w)}else h||B1(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=v})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Gi(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(hB),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&fA(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const f=this.path[d];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(P1);return}this.isUpdating||this.nodes.forEach(cB),this.isUpdating=!1,this.nodes.forEach(uB),this.nodes.forEach(iB),this.nodes.forEach(rB),this.clearAllSnapshots();const l=cs.now();Ct.delta=Ks(0,1e3/60,l-Ct.timestamp),Ct.timestamp=l,Ct.isProcessing=!0,Uh.update.process(Ct),Uh.preRender.process(Ct),Uh.render.process(Ct),Ct.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,tx.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(lB),this.sharedNodes.forEach(mB)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Qe.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Qe.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=dt(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(l=!1),l){const c=s(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:c,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!i)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!uA(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;a&&(l||lr(this.latestValues)||d)&&(i(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return a&&(c=this.removeTransform(c)),bB(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var a;const{visualElement:l}=this.options;if(!l)return dt();const c=l.measureViewportBox();if(!(((a=this.scroll)===null||a===void 0?void 0:a.wasRoot)||this.path.some(vB))){const{scroll:d}=this.root;d&&(xa(c.x,d.offset.x),xa(c.y,d.offset.y))}return c}removeElementScroll(a){var l;const c=dt();if(Nn(c,a),!((l=this.scroll)===null||l===void 0)&&l.wasRoot)return c;for(let u=0;u<this.path.length;u++){const d=this.path[u],{scroll:f,options:h}=d;d!==this.root&&f&&h.layoutScroll&&(f.wasRoot&&Nn(c,a),xa(c.x,f.offset.x),xa(c.y,f.offset.y))}return c}applyTransform(a,l=!1){const c=dt();Nn(c,a);for(let u=0;u<this.path.length;u++){const d=this.path[u];!l&&d.options.layoutScroll&&d.scroll&&d!==d.root&&ba(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),lr(d.latestValues)&&ba(c,d.latestValues)}return lr(this.latestValues)&&ba(c,this.latestValues),c}removeTransform(a){const l=dt();Nn(l,a);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!lr(u.latestValues))continue;Mp(u.latestValues)&&u.updateSnapshot();const d=dt(),f=u.measurePageBox();Nn(d,f),R1(l,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return lr(this.latestValues)&&R1(l,this.latestValues),l}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Ct.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var l;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==c;if(!(a||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:f,layoutId:h}=this.options;if(!(!this.layout||!(f||h))){if(this.resolvedRelativeTargetAt=Ct.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=dt(),this.relativeTargetOrigin=dt(),vl(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),Nn(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=dt(),this.targetWithTransforms=dt()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),w8(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Nn(this.target,this.layout.layoutBox),iA(this.target,this.targetDelta)):Nn(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=dt(),this.relativeTargetOrigin=dt(),vl(this.relativeTargetOrigin,this.target,m.target),Nn(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Wo&&cr.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||Mp(this.parent.latestValues)||sA(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const l=this.getLead(),c=!!this.resumingFrom||this!==l;let u=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(u=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===Ct.timestamp&&(u=!1),u)return;const{layout:d,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||f))return;Nn(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,m=this.treeScale.y;I8(this.layoutCorrected,this.treeScale,this.path,c),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox,l.targetWithTransforms=dt());const{target:v}=l;if(!v){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(T1(this.prevProjectionDelta.x,this.projectionDelta.x),T1(this.prevProjectionDelta.y,this.projectionDelta.y)),bl(this.projectionDelta,this.layoutCorrected,v,this.latestValues),(this.treeScale.x!==h||this.treeScale.y!==m||!D1(this.projectionDelta.x,this.prevProjectionDelta.x)||!D1(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",v)),Wo&&cr.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var l;if((l=this.options.visualElement)===null||l===void 0||l.scheduleRender(),a){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=ga(),this.projectionDelta=ga(),this.projectionDeltaWithTransform=ga()}setAnimationOrigin(a,l=!1){const c=this.snapshot,u=c?c.latestValues:{},d={...this.latestValues},f=ga();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const h=dt(),m=c?c.source:void 0,v=this.layout?this.layout.source:void 0,y=m!==v,b=this.getStack(),g=!b||b.members.length<=1,p=!!(y&&!g&&this.options.crossfade===!0&&!this.path.some(gB));this.animationProgress=0;let x;this.mixTargetDelta=w=>{const k=w/1e3;U1(f.x,a.x,k),U1(f.y,a.y,k),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(vl(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),pB(this.relativeTarget,this.relativeTargetOrigin,h,k),x&&Z8(this.relativeTarget,x)&&(this.isProjectionDirty=!1),x||(x=dt()),Nn(x,this.relativeTarget)),y&&(this.animationValues=d,Y8(d,u,this.latestValues,k,p,g)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=k},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Gi(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Qe.update(()=>{Cu.hasAnimatedSinceResize=!0,this.currentAnimation=G8(0,L1,{...a,onUpdate:l=>{this.mixTargetDelta(l),a.onUpdate&&a.onUpdate(l)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(L1),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:l,target:c,layout:u,latestValues:d}=a;if(!(!l||!c||!u)){if(this!==a&&this.layout&&u&&mA(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||dt();const f=_n(this.layout.layoutBox.x);c.x.min=a.target.x.min,c.x.max=c.x.min+f;const h=_n(this.layout.layoutBox.y);c.y.min=a.target.y.min,c.y.max=c.y.min+h}Nn(l,c),ba(l,d),bl(this.projectionDeltaWithTransform,this.layoutCorrected,l,d)}}registerSharedNode(a,l){this.sharedNodes.has(a)||this.sharedNodes.set(a,new eB),this.sharedNodes.get(a).add(l);const u=l.options.initialPromotionConfig;l.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(l):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:l}=this.options;return l?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:l}=this.options;return l?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:l,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),a&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let l=!1;const{latestValues:c}=a;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(l=!0),!l)return;const u={};c.z&&qh("z",a,u,this.animationValues);for(let d=0;d<Wh.length;d++)qh(`rotate${Wh[d]}`,a,u,this.animationValues),qh(`skew${Wh[d]}`,a,u,this.animationValues);a.render();for(const d in u)a.setStaticValue(d,u[d]),this.animationValues&&(this.animationValues[d]=u[d]);a.scheduleRender()}getProjectionStyles(a){var l,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return nB;const u={visibility:""},d=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=Ru(a==null?void 0:a.pointerEvents)||"",u.transform=d?d(this.latestValues,""):"none",u;const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){const y={};return this.options.layoutId&&(y.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,y.pointerEvents=Ru(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!lr(this.latestValues)&&(y.transform=d?d({},""):"none",this.hasProjected=!1),y}const h=f.animationValues||f.latestValues;this.applyTransformsToTarget(),u.transform=tB(this.projectionDeltaWithTransform,this.treeScale,h),d&&(u.transform=d(h,u.transform));const{x:m,y:v}=this.projectionDelta;u.transformOrigin=`${m.origin*100}% ${v.origin*100}% 0`,f.animationValues?u.opacity=f===this?(c=(l=h.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:u.opacity=f===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const y in Md){if(h[y]===void 0)continue;const{correct:b,applyTo:g}=Md[y],p=u.transform==="none"?h[y]:b(h[y],f);if(g){const x=g.length;for(let w=0;w<x;w++)u[g[w]]=p}else u[y]=p}return this.options.layoutId&&(u.pointerEvents=f===this?Ru(a==null?void 0:a.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var l;return(l=a.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(P1),this.root.sharedNodes.clear()}}}function iB(t){t.updateLayout()}function rB(t){var e;const n=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:i}=t.layout,{animationType:r}=t.options,a=n.source!==t.layout.source;r==="size"?Sn(f=>{const h=a?n.measuredBox[f]:n.layoutBox[f],m=_n(h);h.min=s[f].min,h.max=h.min+m}):mA(r,n.layoutBox,s)&&Sn(f=>{const h=a?n.measuredBox[f]:n.layoutBox[f],m=_n(s[f]);h.max=h.min+m,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[f].max=t.relativeTarget[f].min+m)});const l=ga();bl(l,s,n.layoutBox);const c=ga();a?bl(c,t.applyTransform(i,!0),n.measuredBox):bl(c,s,n.layoutBox);const u=!uA(l);let d=!1;if(!t.resumeFrom){const f=t.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:h,layout:m}=f;if(h&&m){const v=dt();vl(v,n.layoutBox,h.layoutBox);const y=dt();vl(y,s,m.layoutBox),dA(v,y)||(d=!0),f.options.layoutRoot&&(t.relativeTarget=y,t.relativeTargetOrigin=v,t.relativeParent=f)}}}t.notifyListeners("didUpdate",{layout:s,snapshot:n,delta:c,layoutDelta:l,hasLayoutChanged:u,hasRelativeTargetChanged:d})}else if(t.isLead()){const{onExitComplete:s}=t.options;s&&s()}t.options.transition=void 0}function aB(t){Wo&&cr.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function oB(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function lB(t){t.clearSnapshot()}function P1(t){t.clearMeasurements()}function cB(t){t.isLayoutDirty=!1}function uB(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function B1(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function dB(t){t.resolveTargetDelta()}function fB(t){t.calcProjection()}function hB(t){t.resetSkewAndRotation()}function mB(t){t.removeLeadSnapshot()}function U1(t,e,n){t.translate=rt(e.translate,0,n),t.scale=rt(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function H1(t,e,n,s){t.min=rt(e.min,n.min,s),t.max=rt(e.max,n.max,s)}function pB(t,e,n,s){H1(t.x,e.x,n.x,s),H1(t.y,e.y,n.y,s)}function gB(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const xB={duration:.45,ease:[.4,0,.1,1]},G1=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),$1=G1("applewebkit/")&&!G1("chrome/")?Math.round:xn;function F1(t){t.min=$1(t.min),t.max=$1(t.max)}function bB(t){F1(t.x),F1(t.y)}function mA(t,e,n){return t==="position"||t==="preserve-aspect"&&!_8(M1(e),M1(n),.2)}function vB(t){var e;return t!==t.root&&((e=t.scroll)===null||e===void 0?void 0:e.wasRoot)}const yB=hA({attachResizeListener:(t,e)=>ec(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Xh={current:void 0},pA=hA({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!Xh.current){const t=new yB({});t.mount(window),t.setOptions({layoutScroll:!0}),Xh.current=t}return Xh.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),_B={pan:{Feature:P8},drag:{Feature:L8,ProjectionNode:pA,MeasureLayout:oA}};function z1(t,e,n){const{props:s}=t;t.animationState&&s.whileHover&&t.animationState.setActive("whileHover",n==="Start");const i="onHover"+n,r=s[i];r&&Qe.postRender(()=>r(e,Oc(e)))}class wB extends qi{mount(){const{current:e}=this.node;e&&(this.unmount=_P(e,n=>(z1(this.node,n,"Start"),s=>z1(this.node,s,"End"))))}unmount(){}}class kB extends qi{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Cc(ec(this.node.current,"focus",()=>this.onFocus()),ec(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function V1(t,e,n){const{props:s}=t;t.animationState&&s.whileTap&&t.animationState.setActive("whileTap",n==="Start");const i="onTap"+(n==="End"?"":n),r=s[i];r&&Qe.postRender(()=>r(e,Oc(e)))}class NB extends qi{mount(){const{current:e}=this.node;e&&(this.unmount=SP(e,n=>(V1(this.node,n,"Start"),(s,{success:i})=>V1(this.node,s,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Lp=new WeakMap,Qh=new WeakMap,SB=t=>{const e=Lp.get(t.target);e&&e(t)},EB=t=>{t.forEach(SB)};function TB({root:t,...e}){const n=t||document;Qh.has(n)||Qh.set(n,{});const s=Qh.get(n),i=JSON.stringify(e);return s[i]||(s[i]=new IntersectionObserver(EB,{root:t,...e})),s[i]}function AB(t,e,n){const s=TB(e);return Lp.set(t,n),s.observe(t),()=>{Lp.delete(t),s.unobserve(t)}}const jB={some:0,all:1};class RB extends qi{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:s,amount:i="some",once:r}=e,a={root:n?n.current:void 0,rootMargin:s,threshold:typeof i=="number"?i:jB[i]},l=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,r&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:f}=this.node.getProps(),h=u?d:f;h&&h(c)};return AB(this.node.current,a,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(IB(e,n))&&this.startObserver()}unmount(){}}function IB({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const CB={inView:{Feature:RB},tap:{Feature:NB},focus:{Feature:kB},hover:{Feature:wB}},OB={layout:{ProjectionNode:pA,MeasureLayout:oA}},Pp={current:null},gA={current:!1};function MB(){if(gA.current=!0,!!Xg)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>Pp.current=t.matches;t.addListener(e),e()}else Pp.current=!1}const DB=[...GT,Ht,$i],LB=t=>DB.find(HT(t)),K1=new WeakMap;function PB(t,e,n){for(const s in e){const i=e[s],r=n[s];if(Gt(i))t.addValue(s,i);else if(Gt(r))t.addValue(s,Jl(i,{owner:t}));else if(r!==i)if(t.hasValue(s)){const a=t.getValue(s);a.liveStyle===!0?a.jump(i):a.hasAnimated||a.set(i)}else{const a=t.getStaticValue(s);t.addValue(s,Jl(a!==void 0?a:i,{owner:t}))}}for(const s in n)e[s]===void 0&&t.removeValue(s);return e}const Y1=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class BB{scrapeMotionValuesFromProps(e,n,s){return{}}constructor({parent:e,props:n,presenceContext:s,reducedMotionConfig:i,blockInitialAnimation:r,visualState:a},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=kx,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=cs.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,Qe.render(this.render,!1,!0))};const{latestValues:c,renderState:u,onUpdate:d}=a;this.onUpdate=d,this.latestValues=c,this.baseTarget={...c},this.initialValues=n.initial?{...c}:{},this.renderState=u,this.parent=e,this.props=n,this.presenceContext=s,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=l,this.blockInitialAnimation=!!r,this.isControllingVariants=Lf(n),this.isVariantNode=qE(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:f,...h}=this.scrapeMotionValuesFromProps(n,{},this);for(const m in h){const v=h[m];c[m]!==void 0&&Gt(v)&&v.set(c[m],!1)}}mount(e){this.current=e,K1.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,s)=>this.bindToMotionValue(s,n)),gA.current||MB(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Pp.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){K1.delete(this.current),this.projection&&this.projection.unmount(),Gi(this.notifyUpdate),Gi(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const n=this.features[e];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const s=Vr.has(e),i=n.on("change",l=>{this.latestValues[e]=l,this.props.onUpdate&&Qe.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0)}),r=n.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{i(),r(),a&&a(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in eo){const n=eo[e];if(!n)continue;const{isEnabled:s,Feature:i}=n;if(!this.features[e]&&i&&s(this.props)&&(this.features[e]=new i(this)),this.features[e]){const r=this.features[e];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):dt()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let s=0;s<Y1.length;s++){const i=Y1[s];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const r="on"+i,a=e[r];a&&(this.propEventSubscriptions[i]=this.on(i,a))}this.prevMotionValues=PB(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const s=this.values.get(e);n!==s&&(s&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let s=this.values.get(e);return s===void 0&&n!==void 0&&(s=Jl(n===null?void 0:n,{owner:this}),this.addValue(e,s)),s}readValue(e,n){var s;let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(s=this.getBaseTargetFromProps(this.props,e))!==null&&s!==void 0?s:this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(BT(i)||jT(i))?i=parseFloat(i):!LB(i)&&$i.test(n)&&(i=DT(e,n)),this.setBaseTarget(e,Gt(i)?i.get():i)),Gt(i)?i.get():i}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:s}=this.props;let i;if(typeof s=="string"||typeof s=="object"){const a=sx(this.props,s,(n=this.presenceContext)===null||n===void 0?void 0:n.custom);a&&(i=a[e])}if(s&&i!==void 0)return i;const r=this.getBaseTargetFromProps(this.props,e);return r!==void 0&&!Gt(r)?r:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new xx),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class xA extends BB{constructor(){super(...arguments),this.KeyframeResolver=$T}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:s}){delete n[e],delete s[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Gt(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function UB(t){return window.getComputedStyle(t)}class HB extends xA{constructor(){super(...arguments),this.type="html",this.renderInstance=iT}readValueFromInstance(e,n){if(Vr.has(n)){const s=wx(n);return s&&s.default||0}else{const s=UB(e),i=(tT(n)?s.getPropertyValue(n):s[n])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:n}){return rA(e,n)}build(e,n,s){ax(e,n,s.transformTemplate)}scrapeMotionValuesFromProps(e,n,s){return ux(e,n,s)}}class GB extends xA{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=dt}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(Vr.has(n)){const s=wx(n);return s&&s.default||0}return n=rT.has(n)?n:ex(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,s){return lT(e,n,s)}build(e,n,s){ox(e,n,this.isSVGTag,s.transformTemplate)}renderInstance(e,n,s,i){aT(e,n,s,i)}mount(e){this.isSVGTag=cx(e.tagName),super.mount(e)}}const $B=(t,e)=>nx(t)?new GB(e):new HB(e,{allowProjection:t!==_.Fragment}),FB=mP({...f8,...CB,..._B,...OB},$B),he=jL(FB),ee={MARKET:{SELL_RATIO:.8,PRICE_IMPACT_BUY:.005,PRICE_IMPACT_SELL:.005,MIN_PRICE_MULTIPLIER:.2,MAX_PRICE_MULTIPLIER:5,VISCOSITY:100},CONTRIBUTION_VALUES:{gold:1,wood:.5,stone:1,iron_ore:1,iron_ingot:5,plank:2,grain:.1,flour:.5,bread:1,meat:1,honey:1,cloth:1,wool:.5,default:.1},CAREERS:{SOLDIER:{COST:200,LEVEL_REQ:3},MERCHANT:{COST:500,LEVEL_REQ:3}},TAX:{PEASANT_RATE_DEFAULT:.15,PEASANT_RATE_CUT:.07,ROYAL_RATE:.2,LOYALTY_PENALTY_PEASANT:10,LOYALTY_PENALTY_BARON:5},GATHERING:{NO_TOOL_PENALTY:.75},YIELD:{WORK_GRAIN:12,CHOP_WOOD:8,MINE_ORE:6,QUARRY_STONE:10,FORAGE_BREAD:1,PLOW_BONUS:5,SUMMER_WOOD_BONUS:3},DURABILITY:{MAX:100,LOSS_WORK:5,LOSS_COMBAT_WEAPON:10,LOSS_COMBAT_ARMOR:15,REPAIR_AMOUNT:30},MINIGAME:{BASE_MULTIPLIER:.5,PERFORMANCE_WEIGHT:1,CRAFTING_WEIGHT:1.5,THRESHOLD_GREAT:.8},RELIGION:{PRAY_MIN:1,PRAY_MAX:5,XP_PRAY:2},COMBAT:{RAID_LOOT_FACTOR:.4,DEFEND_GOLD_BASE:20,XP_WIN:20,XP_LOSS:0},LUCKY_DROP:{CHANCE:.05,MULTIPLIER:2},PASSIVE_INCOME:{COW:2,ACCOUNTING_BOOKS:5,CARAVAN:10},SKILLS:{GATHERING_BONUS:.1,REFINING_BONUS:.1,CRAFTING_XP:25,REFINING_XP:10},COUP:{BASE_BRIBE_COST:500,HONEYMOON_DURATION:6e5,VACANCY_DURATION:3e5,RESTORE_ORDER_COST:600,LEGITIMACY_SHIELD_MULT:2,KING_VOTE_WEIGHT:15,PEASANT_VOTE_WEIGHT:1}},Mc={WORK:{xp:5},CHOP:{xp:5},FORAGE:{xp:2}},Hd=[0,100,300,700,1500,3e3,6e3],Pn={Spring:{label:"Vr",yieldMod:1,staminaMod:1,color:"#4ade80"},Summer:{label:"Sommer",yieldMod:1.2,staminaMod:1,color:"#fbbf24"},Autumn:{label:"Hst",yieldMod:1.5,staminaMod:1,color:"#f97316"},Winter:{label:"Vinter",yieldMod:.2,staminaMod:1.5,color:"#38bdf8"}},js={Clear:{label:"Klart Vr",desc:"Ideelle forhold for alt arbeid.",mod:1,icon:"",speedMod:1,staminaMod:1},Rain:{label:"Regn",desc:"Glatte forhold. Minispill gr litt fortere.",mod:.9,icon:"",speedMod:1.2,staminaMod:1},Storm:{label:"Storm",desc:"Farlig vr. Hy stamina-kostnad og lavt utbytte!",mod:.5,icon:"",speedMod:1.5,staminaMod:2},Fog:{label:"Tke",desc:"Drlig sikt. Vanskeligere  treffe blinker.",mod:.8,icon:"",speedMod:.8,staminaMod:1}},Dc={WORK:{bread:1,stamina:10},CHOP:{bread:1,stamina:15},FORAGE:{stamina:40},MINE:{bread:1,stamina:25},RAID:{bread:3,stamina:40},TAX:{stamina:20},TAX_PEASANTS:{stamina:25},TAX_ROYAL:{stamina:30},MILL:{grain:10},SMELT:{iron_ore:5,wood:2},SAWMILL:{wood:5},BAKERY:{flour:5},REFINE:{},CRAFT:{},QUARRY:{bread:1,stamina:20},REPAIR:{stamina:15},HUNT:{stamina:30},GATHER_WOOL:{stamina:15},GATHER_HONEY:{stamina:20},PRAY:{stamina:15},FEAST:{bread:30,gold:100,stamina:10},CONTRIBUTE:{stamina:10},CONSTRUCT:{stamina:20},SLEEP:{stamina:0},EAT:{bread:1,stamina:0},PLANT:{grain:5,stamina:25},HARVEST:{stamina:15},BAKE:{},WEAVE:{},MIX:{},DEFEND:{stamina:30},EXPLORE:{stamina:25},PATROL:{stamina:10},MAINTAIN_CROP:{stamina:5},MOUNT_HORSE:{stamina:5},BUY_HORSE_COSMETIC:{stamina:0},SELECT_HORSE_COSMETIC:{stamina:0}},Bp={great_forge:{material:"iron_ingot",goldCost:20,staminaCost:15,slots:["MAIN_HAND","OFF_HAND","HEAD","BODY","FEET","AXE","PICKAXE","SCYTHE","HAMMER","BOW","TRAP","CHISEL"]},weavery:{material:"cloth",goldCost:10,staminaCost:10,slots:["BODY","FEET","HEAD"]},sawmill:{material:"plank",goldCost:5,staminaCost:10,slots:["OFF_HAND","MAIN_HAND"]}},Gd={GOLD:"",GRAIN:"",WOOD:"",IRON_ORE:"",STONE:"",PLANK:"",IRON_INGOT:"",BREAD:"",SWORDS:"",ARMOR:"",CLOTH:"",WOOL:"",MEAT:"",HONEY:"",GLASS:"",FLOUR:"",EGG:"",OMELETTE:"",MANPOWER:"",FAVOR:""},Rt={gold:{label:"Gull",icon:""},grain:{label:"Korn",icon:""},flour:{label:"Mel",icon:""},bread:{label:"Brd",icon:""},wood:{label:"Ved",icon:""},plank:{label:"Planker",icon:""},iron_ore:{label:"Jernmalm",icon:""},iron_ingot:{label:"Jernbarre",icon:""},stone:{label:"Stein",icon:""},swords:{label:"Beleiringsvpen",icon:""},armor:{label:"Beleiringsrustning",icon:""},favor:{label:"Gunst",icon:""},honey:{label:"Honning",icon:""},meat:{label:"Kjtt",icon:""},wool:{label:"Ull",icon:""},cloth:{label:"Stoff",icon:""},glass:{label:"Glass",icon:""},egg:{label:"Egg",icon:""},omelette:{label:"Omelett",icon:""},minor_stamina_potion:{label:"Liten Stamina-brygg",icon:""},herbal_balm:{label:"Urtebalsam",icon:""},focus_brew:{label:"Fokus-brygg",icon:""},strength_tincture:{label:"Styrke-tinktur",icon:""},masters_draught:{label:"Mester-drikk",icon:""},elixir_of_life:{label:"Livseliksir",icon:""}},Lt={KING:{gold:1e3,grain:500,flour:200,bread:50,wood:200,plank:50,iron_ore:0,iron_ingot:20,stone:100,swords:50,armor:20,favor:0,wool:50,cloth:20,honey:0,meat:0,glass:0,manpower:0,egg:0,omelette:0},BARON:{gold:300,grain:100,flour:50,bread:20,wood:50,plank:20,iron_ore:0,iron_ingot:10,stone:20,swords:10,armor:10,favor:0,wool:20,cloth:5,honey:0,meat:0,glass:0,manpower:0,egg:0,omelette:0},PEASANT:{gold:20,grain:30,flour:5,bread:10,wood:0,plank:0,iron_ore:0,iron_ingot:0,stone:0,swords:0,armor:0,favor:0,wool:10,cloth:0,honey:0,meat:0,glass:0,manpower:0,egg:0,omelette:0},SOLDIER:{gold:50,grain:10,flour:10,bread:10,wood:0,plank:0,iron_ore:0,iron_ingot:0,stone:0,swords:5,armor:2,favor:0,wool:0,cloth:0,honey:0,meat:0,glass:0,manpower:0,egg:0,omelette:0},MERCHANT:{gold:500,grain:50,flour:50,bread:20,wood:50,plank:20,iron_ore:0,iron_ingot:5,stone:50,swords:5,armor:2,favor:0,wool:20,cloth:10,honey:0,meat:0,glass:0,manpower:0,egg:0,omelette:0}},Tx={PEASANT:[{id:"iron_plow",name:"Jernplog",description:"ker kornhst med +5.",cost:{gold:50,wood:10},benefit:"YIELD_GRAIN"},{id:"fence",name:"Solid Gjerde",description:"Beskytter mot smtyveri.",cost:{wood:50},benefit:"DEFENSE_REGION"},{id:"cow",name:"Melkeku",description:"Gir passivt 2 gull per minutt (simulert via actions).",cost:{gold:80},benefit:"PASSIVE_GOLD"},{id:"roof",name:"Tett Tak",description:"Bedre hvile. Mer utholdenhet.",cost:{wood:20,gold:10},benefit:"STAMINA_REGEN"}],BARON:[{id:"stone_keep",name:"Steintrn",description:"Gjr raiding av deg mye vanskeligere.",cost:{gold:200,wood:100},benefit:"FORTRESS"},{id:"armory",name:"Vpenkammer",description:"Dobbelt s effektiv rekruttering.",cost:{gold:150},benefit:"DRAFT_BONUS"},{id:"stables",name:"Staller",description:"Raskere raids.",cost:{gold:100,wood:50},benefit:"RAID_SPEED"}],KING:[{id:"cathedral",name:"Katedral",description:"ker din legitimitet og skattevilje.",cost:{gold:500,stone:200},benefit:"ROYAL_AUTHORITY"},{id:"royal_guard",name:"Kongelig Garde",description:"Uovervinnelig defensiv styrke.",cost:{gold:400,iron:100},benefit:"ELITE_DEFENSE"}],SOLDIER:[{id:"knight_armor",name:"Ridderrustning",description:"Du tar mindre skade og ser tffere ut.",cost:{gold:100,swords:5},benefit:"ARMOR"},{id:"warhorse",name:"Stridshest",description:"Gjr deg til en Ridder. 2x XP fra kamp.",cost:{gold:200,grain:100},benefit:"KNIGHT"}],MERCHANT:[{id:"trade_license",name:"Handelsbrev",description:"Bedre salgspriser p markedet.",cost:{gold:150},benefit:"MARKET_BONUS"},{id:"accounting_books",name:"Regnskapsbker",description:"Gir passivt 5 gull per minutt.",cost:{gold:200,wood:20},benefit:"PASSIVE_GOLD_HIGH"},{id:"caravan",name:"Karavane",description:"Tjen penger p handel med utlandet.",cost:{gold:300,wood:50},benefit:"CARAVAN"}]},Hn={PEASANT:{FARMING:{level:1,xp:0,maxXp:100},WOODCUTTING:{level:1,xp:0,maxXp:100},MINING:{level:0,xp:0,maxXp:100},CRAFTING:{level:0,xp:0,maxXp:100},STEWARDSHIP:{level:0,xp:0,maxXp:100},COMBAT:{level:0,xp:0,maxXp:100},TRADING:{level:0,xp:0,maxXp:100},THEOLOGY:{level:0,xp:0,maxXp:100}},BARON:{FARMING:{level:3,xp:0,maxXp:300},WOODCUTTING:{level:3,xp:0,maxXp:300},MINING:{level:1,xp:0,maxXp:100},CRAFTING:{level:1,xp:0,maxXp:100},STEWARDSHIP:{level:5,xp:0,maxXp:1e3},COMBAT:{level:3,xp:0,maxXp:300},TRADING:{level:3,xp:0,maxXp:300},THEOLOGY:{level:1,xp:0,maxXp:100}},KING:{FARMING:{level:1,xp:0,maxXp:100},WOODCUTTING:{level:1,xp:0,maxXp:100},MINING:{level:1,xp:0,maxXp:100},CRAFTING:{level:1,xp:0,maxXp:100},STEWARDSHIP:{level:10,xp:0,maxXp:5e3},COMBAT:{level:5,xp:0,maxXp:1500},TRADING:{level:5,xp:0,maxXp:1500},THEOLOGY:{level:5,xp:0,maxXp:1500}},SOLDIER:{FARMING:{level:1,xp:0,maxXp:100},WOODCUTTING:{level:1,xp:0,maxXp:100},MINING:{level:0,xp:0,maxXp:100},CRAFTING:{level:1,xp:0,maxXp:100},STEWARDSHIP:{level:0,xp:0,maxXp:100},COMBAT:{level:5,xp:0,maxXp:1500},TRADING:{level:0,xp:0,maxXp:100},THEOLOGY:{level:0,xp:0,maxXp:100}},MERCHANT:{FARMING:{level:1,xp:0,maxXp:100},WOODCUTTING:{level:1,xp:0,maxXp:100},MINING:{level:0,xp:0,maxXp:100},CRAFTING:{level:2,xp:0,maxXp:200},STEWARDSHIP:{level:1,xp:0,maxXp:100},COMBAT:{level:0,xp:0,maxXp:100},TRADING:{level:5,xp:0,maxXp:1500},THEOLOGY:{level:0,xp:0,maxXp:100}}},zB={FARMING:{label:"Jordbruk",description:"Dyrking av mark, hsting av avlinger og husdyrhold.",color:"#10b981",bonuses:{2:"10% raskere hsting.",5:"Avlinger gir 20% mer utbytte.",10:"Mesterbonde: Lser opp avanserte avlinger."}},WOODCUTTING:{label:"Vedhogging",description:"Kunsten  felle trr og bearbeide tmmer.",color:"#8b5cf6",bonuses:{3:"15% raskere tmmerhogst.",7:"Sjanse for  finne sjelden kvae.",12:"Skovens vokter: kt utbytte fra alle trr."}},MINING:{label:"Gruvedrift",description:"Uthenting av malm og edle metaller fra fjellet.",color:"#f59e0b",bonuses:{4:"Bedre verktyeffektivitet i gruver.",8:"Lser opp utvinning av edelstener.",15:"Fjellkonge: Maksimalt utbytte fra dype rer."}},CRAFTING:{label:"Hndverk",description:"Smiing, snekring og tilvirking av avansert utstyr.",color:"#3b82f6",bonuses:{2:"Mindre materialsvinn ved refining.",5:"Bedre sjanse for hyere kvalitet.",10:"Stormester: Kan smie legendarisk utstyr."}},STEWARDSHIP:{label:"Godsforvaltning",description:"Administrasjon av land, folk og ressurser.",color:"#ec4899",bonuses:{5:"Redusert skattetrykk fra overordnede.",10:"kt passiv inntekt fra oppgraderinger.",20:"Rikets forvalter: Maksimal konomisk innsikt."}},COMBAT:{label:"Kamp",description:"Ferdighet i sverd, bue og forsvar av riket.",color:"#ef4444",bonuses:{3:"kt angrepskraft (+10%).",6:"Bedre forsvarsevne i beleiringer.",12:"Krigsherre: Fryktinngytende p slagmarken."}},TRADING:{label:"Handel",description:"Kjp, salg og markedsspekulering.",color:"#facc15",bonuses:{2:"Lavere gebyrer p markedet.",5:"Bedre priser ved handel med NPCs.",10:"Handelsfyrste: Kontroll over handelsruter."}},THEOLOGY:{label:"Teologi",description:"Tro, bnn og forstelse av det guddommelige.",color:"#6366f1",bonuses:{5:"Bnner gir mer stamina.",10:"Guddommelig beskyttelse mot ulykker.",15:"Helgen: Utstrler en aura av ro og verdighet."}}},Up={PEASANT:{},BARON:{MAIN_HAND:{id:"iron_sword",name:"Jernsverd",icon:"",type:"MAIN_HAND",durability:100,maxDurability:100,level:5,stats:{attack:10}},BODY:{id:"fine_clothes",name:"Fie Klr",icon:"",type:"BODY",durability:50,maxDurability:50,level:5,stats:{defense:2,speedBonus:1.1}}},KING:{MAIN_HAND:{id:"royal_scepter",name:"Kongens Septer",icon:"",type:"MAIN_HAND",durability:200,maxDurability:200,level:10,stats:{luckBonus:.2}},HEAD:{id:"crown",name:"Krone",icon:"",type:"HEAD",durability:100,maxDurability:100,level:10,stats:{luckBonus:.1}}},SOLDIER:{MAIN_HAND:{id:"iron_sword",name:"Jernsverd",icon:"",type:"MAIN_HAND",durability:100,maxDurability:100,level:3,stats:{attack:8}},OFF_HAND:{id:"wooden_shield",name:"Treskjold",icon:"",type:"OFF_HAND",durability:50,maxDurability:50,level:2,stats:{defense:5}},BODY:{id:"leather_armor",name:"Lrrustning",icon:"",type:"BODY",durability:80,maxDurability:80,level:2,stats:{defense:5}}},MERCHANT:{MAIN_HAND:{id:"walking_stick",name:"Vandrestav",icon:"",type:"MAIN_HAND",durability:50,maxDurability:50,level:2,stats:{speedBonus:1.05}},TRINKET:{id:"abacus",name:"Kuleramme",icon:"",type:"TRINKET",durability:100,maxDurability:100,level:3,stats:{yieldBonus:2}}}},Oe={tools:{id:"tools",name:"Verkty",icon:"",type:"MAIN_HAND",durability:100,maxDurability:100,level:1,description:"Grunnleggende verkty."},weapon:{id:"weapon",name:"Enkelt Sverd",icon:"",type:"MAIN_HAND",durability:100,maxDurability:100,level:1,description:"Et enkelt sverd."},armor:{id:"armor",name:"Enkel Rustning",icon:"",type:"BODY",durability:100,maxDurability:100,level:1,description:"Beskyttende rustning."},stone_axe:{id:"stone_axe",name:"Steinks",icon:"",type:"AXE",durability:30,maxDurability:30,level:1,description:"Primitiv ks hugget fra mrke fjell. Sagnet sier at de frste fedrene brukte slike til  bane vei gjennom de tette skogene fr sivilisasjonens inntog. +1 Utbytte.",stats:{yieldBonus:1},relevantActions:["CHOP"],nextTierId:"iron_axe"},stone_pickaxe:{id:"stone_pickaxe",name:"Steinhakke",icon:"",type:"PICKAXE",durability:30,maxDurability:30,level:1,description:"En enkel hakke i flint og tre. Brukt i generasjoner av de som sker fjellets hemmeligheter. +1 Utbytte.",stats:{yieldBonus:1},relevantActions:["MINE"],nextTierId:"iron_pickaxe"},rusty_axe:{id:"rusty_axe",name:"Rusten ks",icon:"",type:"AXE",durability:50,maxDurability:50,level:1,description:"Et glemt relikvie fra en svunnen tid, n bare en skygge av sin fordums prakt. Slv og uplitelig.",stats:{yieldBonus:0},relevantActions:["CHOP"],nextTierId:"stone_axe"},iron_axe:{id:"iron_axe",name:"Jernks",icon:"",type:"AXE",durability:100,maxDurability:100,level:3,description:"Smid i landsbyens esse under fullmnen. Jernet synger nr det treffer treverket. +3 Utbytte.",stats:{yieldBonus:3},relevantActions:["CHOP"],nextTierId:"steel_axe"},iron_pickaxe:{id:"iron_pickaxe",name:"Jernhakke",icon:"",type:"PICKAXE",durability:100,maxDurability:100,level:3,description:"Tung og balansert. Laget for  trenge dypt inn i rikets rike rer. +3 Utbytte.",stats:{yieldBonus:3},relevantActions:["MINE"],nextTierId:"steel_pickaxe"},stone_chisel:{id:"stone_chisel",name:"Steinmeisel",icon:"",type:"CHISEL",durability:30,maxDurability:30,level:1,description:"En enkel meisel av herdet stein. Perfekt for  forme steinblokker. +1 Utbytte.",stats:{yieldBonus:1},relevantActions:["QUARRY"],nextTierId:"iron_chisel"},iron_chisel:{id:"iron_chisel",name:"Jernmeisel",icon:"",type:"CHISEL",durability:80,maxDurability:80,level:3,description:"Smid i landsbyens esse. Gjr steinhugging til en lek. +3 Utbytte.",stats:{yieldBonus:3},relevantActions:["QUARRY"],nextTierId:"steel_chisel"},royal_scepter:{id:"royal_scepter",name:"Kongens Septer",icon:"",type:"MAIN_HAND",durability:200,maxDurability:200,level:10,description:"Et symbol p guddommelig rett og folkets vilje. Det glitrer med en makt som kan bye selve skjebnen. +20% Flaks.",stats:{luckBonus:.2}},steel_axe:{id:"steel_axe",name:"Stlks",icon:"",type:"AXE",durability:200,maxDurability:200,level:8,description:"Mesterlig stl. +8 Utbytte, 20% raskere arbeid.",stats:{yieldBonus:8,speedBonus:1.2},relevantActions:["CHOP"]},steel_hja:{id:"steel_hja",name:"Stlhj",icon:"",type:"SCYTHE",durability:120,maxDurability:120,level:4,description:"Sylskarp hj. +5 Utbytte, 10% raskere hsting.",stats:{yieldBonus:5,speedBonus:1.1},relevantActions:["WORK","HST"]},stone_sickle:{id:"stone_sickle",name:"Steinsigd",icon:"",type:"SCYTHE",durability:40,maxDurability:40,level:1,description:"Enkel sigd for jordbruk. +1 Utbytte ved kornhsting.",stats:{yieldBonus:1},relevantActions:["WORK"]},blacksmith_hammer:{id:"blacksmith_hammer",name:"Smedhammer",icon:"",type:"HAMMER",durability:200,maxDurability:200,level:5,description:"Mesterverkty. 20% raskere smiing.",stats:{speedBonus:1.2},relevantActions:["CRAFT","REFINE","SMELT"]},shears:{id:"shears",name:"Saks",icon:"",type:"MAIN_HAND",durability:50,maxDurability:50,level:1,description:"Brukt til  klippe sauer. Helt ndvendig for ull-produksjon.",stats:{yieldBonus:2},relevantActions:["GATHER_WOOL"]},iron_sword:{id:"iron_sword",name:"Jernsverd",icon:"",type:"MAIN_HAND",durability:100,maxDurability:100,level:5,description:"Standard sverd. +10 Angrepskraft.",stats:{attack:10},relevantActions:["DEFEND","PATROL","EXPLORE","HUNT"],nextTierId:"steel_sword"},steel_sword:{id:"steel_sword",name:"Stlsverd",icon:"",type:"MAIN_HAND",durability:250,maxDurability:250,level:10,description:"Ddelig stl. +25 Angrep, 10% raskere hugg.",stats:{attack:25,speedBonus:1.1},relevantActions:["DEFEND","PATROL","EXPLORE","HUNT"]},tunic:{id:"tunic",name:"Slitt Tunika",icon:"",type:"BODY",durability:20,maxDurability:20,level:1,description:"Gammel og hullete. Minimal beskyttelse.",stats:{defense:1},relevantActions:["DEFEND","PATROL"],nextTierId:"leather_armor"},leather_armor:{id:"leather_armor",name:"Lrrustning",icon:"",type:"BODY",durability:80,maxDurability:80,level:3,description:"Herdet skinn. +5 Forsvar.",stats:{defense:5},relevantActions:["DEFEND","PATROL"],nextTierId:"iron_armor"},whetstone:{id:"whetstone",name:"Bryne",icon:"",type:"OFF_HAND",durability:100,maxDurability:100,level:1,description:"Bruk bryne for  holde verkty skarpe. Gir +1 i utbytte p de fleste sanke-oppgaver.",stats:{yieldBonus:1},relevantActions:["CHOP","MINE","QUARRY","WORK","GATHER_WOOL"]},hunting_bow:{id:"hunting_bow",name:"Jaktbue",icon:"",type:"BOW",durability:80,maxDurability:80,level:1,description:"En stdig bue av barlind. +2 Utbytte.",stats:{yieldBonus:2},relevantActions:["HUNT"],nextTierId:"longbow"},longbow:{id:"longbow",name:"Langbue",icon:"",type:"BOW",durability:150,maxDurability:150,level:5,description:"En mektig langbue som krever styrke  spenne. +5 Utbytte, 10% raskere.",stats:{yieldBonus:5,speedBonus:1.1},relevantActions:["HUNT"]},hunting_trap:{id:"hunting_trap",name:"Jaktfelle",icon:"",type:"TRAP",durability:30,maxDurability:30,level:1,description:"En enkel snarefangst-felle. +1 Utbytte ved smviltjakt.",stats:{yieldBonus:1},relevantActions:["HUNT","FORAGE"]},omelette:{id:"omelette",name:"Omelett",icon:"",type:"CONSUMABLE",durability:1,maxDurability:1,level:1,description:'En nringsrik frokost. Gir buff: "Lett til beins" (20% mindre stamina kostnad i 15 min).',stats:{},relevantActions:["CONSUME"]},bread:{id:"bread",name:"Brd",icon:"",type:"CONSUMABLE",durability:1,maxDurability:1,level:1,description:"Ferskt brd fra bakeriet. Gjenoppretter +20 Stamina.",stats:{},relevantActions:["CONSUME"]},minor_stamina_potion:{id:"minor_stamina_potion",name:"Liten Stamina-brygg",icon:"",type:"CONSUMABLE",durability:1,maxDurability:1,level:1,description:"Gjenoppretter 30 Stamina umiddelbart.",stats:{},relevantActions:["CONSUME"]},herbal_balm:{id:"herbal_balm",name:"Urtebalsam",icon:"",type:"CONSUMABLE",durability:1,maxDurability:1,level:1,description:"ker sankehastighet med 15% i 10 minutter.",stats:{},relevantActions:["CONSUME"]},focus_brew:{id:"focus_brew",name:"Fokus-brygg",icon:"",type:"CONSUMABLE",durability:1,maxDurability:1,level:2,description:"Reduserer stamina-kostnad med 20% i 15 minutter.",stats:{},relevantActions:["CONSUME"]},strength_tincture:{id:"strength_tincture",name:"Styrke-tinktur",icon:"",type:"CONSUMABLE",durability:1,maxDurability:1,level:2,description:"ker angrepskraft med 10 i 10 minutter.",stats:{},relevantActions:["CONSUME"]},masters_draught:{id:"masters_draught",name:"Mester-drikk",icon:"",type:"CONSUMABLE",durability:1,maxDurability:1,level:3,description:"Mesterens hemmelighet. Gir +50% utbytte i 20 minutter.",stats:{},relevantActions:["CONSUME"]},elixir_of_life:{id:"elixir_of_life",name:"Livseliksir",icon:"",type:"CONSUMABLE",durability:1,maxDurability:1,level:3,description:"En legendarisk eliksir. Gjenoppretter 100 Stamina og 50 HP.",stats:{},relevantActions:["CONSUME"]}},Ax={grain:{label:"Kornker",seed:"grain",yieldResource:"grain",duration:3*60*1e3,minYield:15,maxYield:25,xp:20}},Kt={farm_house:{id:"farm_house",name:"Grdshuset",icon:"",locationId:"peasant_farm",description:"Ditt personlige hjem. Oppgraderinger gir bedre hvile og mer matlagingsplass.",levels:{1:{requirements:{},unlocks:["SLEEP","EAT"],bonus:"Base hvile"},2:{requirements:{wood:50,gold:100},unlocks:["FARM_UPGRADE"],bonus:"+20% Stamina fra peisen"},3:{requirements:{plank:20,stone:50,gold:300},unlocks:["FARM_UPGRADE_MASTER"],bonus:"+30% Stamina fra senga"},4:{requirements:{plank:50,stone:100,gold:600},unlocks:["FARM_UPGRADE_ELITE"],bonus:"+50% Stamina fra hvile"},5:{requirements:{plank:100,stone:200,gold:1e3,iron_ingot:20},unlocks:["FARM_UPGRADE_GODLY"],bonus:"Restaurerer all Stamina ved hvile"}}},sawmill:{id:"sawmill",name:"Sagbruk",icon:"",locationId:"village",description:"Gjr det mulig  foredle Ved til Tmmer.",levels:{1:{requirements:{},unlocks:["REFINE_PLANK_BASIC","hunting_bow"],bonus:"Base produksjon"},2:{requirements:{wood:100,stone:50,gold:100},unlocks:["REFINE_PLANK_FAST"],bonus:"+10% Woodcutting XP"},3:{requirements:{plank:50,stone:150,gold:300},unlocks:["REFINE_PLANK_MASTER","longbow"],bonus:"Lser opp Tier 3 verkty og Langbue"}}},windmill:{id:"windmill",name:"Vindmlle",icon:"",locationId:"village",description:"Gjr det mulig  foredle Korn til Mel mer effektivt.",levels:{1:{requirements:{},unlocks:["REFINE_FLOUR_BASIC"],bonus:"Base produksjon"},2:{requirements:{plank:30,stone:50,gold:150},unlocks:["REFINE_FLOUR_FAST"],bonus:"+10% Farming XP"},3:{requirements:{plank:100,stone:200,gold:500},unlocks:["REFINE_FLOUR_AUTO"],bonus:"Sjanse for dobbel avling"}}},smeltery:{id:"smeltery",name:"Smeltehytte",icon:"",locationId:"village",description:"Gjr det mulig  smelte Jernmalm til Jernbarrer.",levels:{1:{requirements:{},unlocks:["REFINE_IRON_BASIC"],bonus:"Base produksjon"},2:{requirements:{stone:150,wood:100,gold:200},unlocks:["REFINE_IRON_FAST"],bonus:"+10% Mining XP"},3:{requirements:{stone:300,plank:50,gold:600},unlocks:["REFINE_STEEL","glass"],bonus:"Lser opp Stl og Glass"}}},great_forge:{id:"great_forge",name:"Storsmie",icon:"",locationId:"village",description:"Gjr det mulig  lage avanserte verkty og vpen.",levels:{1:{requirements:{},unlocks:["stone_axe","stone_pickaxe","stone_sickle","whetstone","hunting_trap"],bonus:"Base produksjon"},2:{requirements:{iron_ingot:20,plank:30,gold:300},unlocks:["iron_axe","iron_pickaxe","iron_sword","leather_armor","shears","siege_swords","siege_armor"],bonus:"+10% Crafting XP"},3:{requirements:{iron_ingot:100,plank:100,gold:1e3},unlocks:["steel_axe","steel_sword","blacksmith_hammer","repair_advanced"],bonus:"Lser opp Mester-utstyr"}}},bakery:{id:"bakery",name:"Bakeri",icon:"",locationId:"village",description:"Gjr det mulig  bake Brd fra Mel.",levels:{1:{requirements:{},unlocks:["CRAFT_BREAD","CRAFT_omelette"],bonus:"Base produksjon"},2:{requirements:{stone:50,plank:20,gold:100},unlocks:["CRAFT_PIE"],bonus:"Bedre stamina fra mat"},3:{requirements:{stone:150,plank:50,gold:400},unlocks:["CRAFT_FEAST"],bonus:"Lser opp Gildemltid"}}},tavern:{id:"tavern",name:"Vertshuset",icon:"",locationId:"village",description:"Et sted for hvile og rykter. ker stamina-regenerering.",levels:{1:{requirements:{},unlocks:["ENTER_TAVERN","REST_BASIC","BUY_MEAL","OPEN_DICE_GAME","OPEN_RESOURCE_GAME","CHAT_LOCAL"],bonus:"Standard hvile"},2:{requirements:{wood:100,stone:50,gold:250},unlocks:["REST_COMFY"],bonus:"Dobbel stamina-regen"},3:{requirements:{plank:50,stone:150,gold:750},unlocks:["REST_ROYAL"],bonus:"Gjenoppretter all stamina raskt"}}},weavery:{id:"weavery",name:"Veveri",icon:"",locationId:"village",description:"Foredler Ull til Stoff for videre salg eller klr.",levels:{1:{requirements:{},unlocks:["REFINE_CLOTH_BASIC"],bonus:"Base produksjon"},2:{requirements:{plank:40,stone:30,gold:150},unlocks:["REFINE_CLOTH_FAST"],bonus:"+10% Trading XP"},3:{requirements:{plank:100,stone:100,gold:400},unlocks:["REFINE_CLOTH_MASTER"],bonus:"Lser opp Silke-produksjon"}}},well:{id:"well",name:"Bybrnn",icon:"",locationId:"village",description:"Gir tilgang til ferskvann for baking og hygiene.",levels:{1:{requirements:{},unlocks:["GATHER_WATER"],bonus:"Basiskilde"},2:{requirements:{stone:50,gold:50},unlocks:["GATHER_WATER_FAST"],bonus:"Bedre vanntilgang"},3:{requirements:{stone:150,gold:200},unlocks:["GATHER_WATER_MASTER"],bonus:"Hellig kilde: +5 Stamina ved drikking"}}},apothecary:{id:"apothecary",name:"Apoteker",icon:"",locationId:"village",description:"Fremstiller medisin og salver.",levels:{1:{requirements:{},unlocks:["REFINE_minor_stamina_potion","REFINE_herbal_balm"],bonus:"Basis urter"},2:{requirements:{wood:100,stone:50,gold:250},unlocks:["REFINE_focus_brew","REFINE_strength_tincture"],bonus:"Gift og Tinkturer"},3:{requirements:{plank:100,glass:50,gold:1e3},unlocks:["REFINE_masters_draught","REFINE_elixir_of_life"],bonus:"Mesterverk & Eliksirer"}}},watchtower:{id:"watchtower",name:"Vaktrn",icon:"",locationId:"village",description:"Bedre oversikt og forsvar av landsbyen.",levels:{1:{requirements:{},unlocks:["PATROL"],bonus:"+5 Forsvar"},2:{requirements:{stone:100,plank:50,gold:200},unlocks:["SCOUT"],bonus:"+15 Forsvar"},3:{requirements:{stone:300,plank:100,gold:800},unlocks:["VOLLEY"],bonus:"Bueskytter-sttte i kamp"}}},stables:{id:"stables",name:"Stall",icon:"",locationId:"village",description:"Muliggjr raskere reise og kavaleri.",levels:{1:{requirements:{},unlocks:["MOUNT_HORSE"],bonus:"Transport"},2:{requirements:{plank:50,wood:50,gold:150},unlocks:["BREED_WARHORSE"],bonus:"Stridshester"},3:{requirements:{plank:150,iron_ingot:20,gold:400},unlocks:["KNIGHT_TRAINING"],bonus:"Riddere"}}},manor_ost:{id:"manor_ost",name:"Slott st",icon:"",locationId:"castle",description:"Setet til den stlige herre. Krever enorme ressurser  bygge.",levels:{1:{requirements:{stone:500,plank:300,iron_ingot:50,gold:1e3},unlocks:["BARON_STATUS"],bonus:"Krav p regionen"}}},manor_vest:{id:"manor_vest",name:"Slott Vest",icon:"",locationId:"castle",description:"Setet til den vestlige herre. Krever enorme ressurser  bygge.",levels:{1:{requirements:{stone:500,plank:300,iron_ingot:50,gold:1e3},unlocks:["BARON_STATUS"],bonus:"Krav p regionen"}}},throne_room:{id:"throne_room",name:"Slottet",icon:"",locationId:"castle",description:"Kongens stol. Den frste Baronen som fullfrer denne blir Konge.",levels:{1:{requirements:{stone:2e3,plank:1e3,iron_ingot:200,gold:5e3},unlocks:["KING_STATUS"],bonus:"Krav p riket"}}}},Fi={plank:{label:"Planker",icon:"",input:{wood:5},outputResource:"plank",outputAmount:1,buildingId:"sawmill",stamina:10,xp:5,skill:"WOODCUTTING"},flour:{label:"Fint Mel",icon:"",input:{grain:10},outputResource:"flour",outputAmount:10,buildingId:"windmill",stamina:15,xp:8,skill:"FARMING",duration:12e4},iron_ingot:{label:"Jernbarre",icon:"",input:{iron_ore:5,wood:2},outputResource:"iron_ingot",outputAmount:1,buildingId:"smeltery",stamina:20,xp:12,skill:"CRAFTING"},bread:{label:"Bondebrd",icon:"",input:{flour:2},outputResource:"bread",outputAmount:5,buildingId:"bakery",stamina:5,xp:3,skill:"CRAFTING"},pie:{label:"Kjttpai",icon:"",input:{flour:4,meat:2},outputResource:"bread",outputAmount:15,buildingId:"bakery",stamina:15,xp:10,skill:"CRAFTING"},mead:{label:"Mjd",icon:"",input:{honey:5},outputResource:"stamina",outputAmount:20,buildingId:"tavern",stamina:5,xp:5,skill:"CRAFTING"},cloth:{label:"Lin-stoff",icon:"",input:{wool:5},outputResource:"cloth",outputAmount:1,buildingId:"weavery",stamina:15,xp:10,skill:"CRAFTING"},glass:{label:"Glass",icon:"",input:{stone:10,wood:5},outputResource:"glass",outputAmount:1,buildingId:"smeltery",requiredLevel:3,stamina:25,xp:15,skill:"CRAFTING"},minor_stamina_potion:{label:"Liten Stamina-brygg",icon:"",input:{honey:2,glass:1},outputResource:"minor_stamina_potion",outputAmount:1,buildingId:"apothecary",requiredLevel:1,stamina:20,xp:15,skill:"CRAFTING",duration:3e4},herbal_balm:{label:"Urtebalsam",icon:"",input:{wood:5,honey:3},outputResource:"herbal_balm",outputAmount:1,buildingId:"apothecary",requiredLevel:1,stamina:20,xp:15,skill:"CRAFTING",duration:45e3},focus_brew:{label:"Fokus-brygg",icon:"",input:{honey:5,glass:1,grain:10},outputResource:"focus_brew",outputAmount:1,buildingId:"apothecary",requiredLevel:2,stamina:30,xp:30,skill:"CRAFTING",duration:6e4},strength_tincture:{label:"Styrke-tinktur",icon:"",input:{iron_ore:5,honey:5,glass:1},outputResource:"strength_tincture",outputAmount:1,buildingId:"apothecary",requiredLevel:2,stamina:40,xp:40,skill:"CRAFTING",duration:9e4},masters_draught:{label:"Mester-drikk",icon:"",input:{gold:100,honey:10,glass:2},outputResource:"masters_draught",outputAmount:1,buildingId:"apothecary",requiredLevel:3,stamina:60,xp:100,skill:"CRAFTING",duration:18e4},elixir_of_life:{label:"Livseliksir",icon:"",input:{gold:250,honey:20,glass:5},outputResource:"elixir_of_life",outputAmount:1,buildingId:"apothecary",requiredLevel:3,stamina:100,xp:250,skill:"CRAFTING",duration:3e5}},Bn={stone_axe:{label:"Steinks",icon:"",input:{stone:10,wood:5,gold:5},outputItemId:"stone_axe",buildingId:"great_forge",level:1,stamina:15,xp:10,description:"Et enkelt redskap for tmmerhogst.",skill:"CRAFTING"},stone_pickaxe:{label:"Steinhakke",icon:"",input:{stone:10,wood:5,gold:5},outputItemId:"stone_pickaxe",buildingId:"great_forge",level:1,stamina:15,xp:10,description:"En primitiv hakke for gruvearbeid.",skill:"CRAFTING"},stone_sickle:{label:"Steinsigd",icon:"",input:{stone:5,wood:5,gold:10},outputItemId:"stone_sickle",buildingId:"great_forge",level:1,stamina:10,xp:5,description:"Enkel sigd for kornhsting.",skill:"CRAFTING"},whetstone:{label:"Bryne",icon:"",input:{stone:15,gold:20},outputItemId:"whetstone",buildingId:"great_forge",level:1,stamina:10,xp:5,description:"Brukt for  slipe verkty og ke utbyttet.",skill:"CRAFTING"},stone_chisel:{label:"Steinmeisel",icon:"",input:{stone:10,gold:10},outputItemId:"stone_chisel",buildingId:"great_forge",level:1,stamina:10,xp:8,description:"Ndvendig for  hugge stein i steinhuggeriet.",skill:"CRAFTING"},iron_chisel:{label:"Jernmeisel",icon:"",input:{iron_ingot:5,gold:80},outputItemId:"iron_chisel",buildingId:"great_forge",level:2,stamina:20,xp:15,description:"Effektiv mesiel for steinhugging.",skill:"CRAFTING"},iron_axe:{label:"Jernks",icon:"",input:{iron_ingot:5,plank:2,gold:50},outputItemId:"iron_axe",buildingId:"great_forge",level:2,stamina:25,xp:20,description:"Et solid verkty av jern.",skill:"CRAFTING"},iron_pickaxe:{label:"Jernhakke",icon:"",input:{iron_ingot:5,plank:2,gold:50},outputItemId:"iron_pickaxe",buildingId:"great_forge",level:2,stamina:25,xp:20,description:"Effektiv hakke for dypere graving.",skill:"CRAFTING"},iron_sword:{label:"Jernsverd",icon:"",input:{iron_ingot:10,plank:2,gold:100},outputItemId:"iron_sword",buildingId:"great_forge",level:2,stamina:40,xp:35,description:"Et skarpt sverd for krigere.",skill:"CRAFTING"},leather_armor:{label:"Lrrustning",icon:"",input:{cloth:10,gold:150},outputItemId:"leather_armor",buildingId:"great_forge",level:2,stamina:30,xp:25,description:"God beskyttelse for en reisende.",skill:"CRAFTING"},shears:{label:"Saks",icon:"",input:{iron_ingot:5,gold:100},outputItemId:"shears",buildingId:"great_forge",level:2,stamina:20,xp:15,description:"Ndvendig for  klippe sauer og f ull.",skill:"CRAFTING"},siege_swords:{label:"Beleiringsvpen (x10)",icon:"",input:{iron_ingot:5,plank:5,gold:50},outputItemId:"swords",outputAmount:10,buildingId:"great_forge",level:2,stamina:40,xp:30,description:"En kasse med vpen til garnisonen.",skill:"CRAFTING"},siege_armor:{label:"Beleiringsrustning (x10)",icon:"",input:{iron_ingot:5,cloth:5,gold:50},outputItemId:"armor",outputAmount:10,buildingId:"great_forge",level:2,stamina:40,xp:30,description:"En kasse med rustninger til garnisonen.",skill:"CRAFTING"},steel_axe:{label:"Stlks",icon:"",input:{iron_ingot:20,plank:10,gold:250},outputItemId:"steel_axe",buildingId:"great_forge",level:3,stamina:50,xp:50,description:"Mesterlig utformet ks av herdet stl.",skill:"CRAFTING"},steel_sword:{label:"Stlsverd",icon:"",input:{iron_ingot:30,plank:5,gold:500},outputItemId:"steel_sword",buildingId:"great_forge",level:3,stamina:80,xp:100,description:"Det ultimate vpenet for en herre.",skill:"CRAFTING"},blacksmith_hammer:{label:"Smedhammer",icon:"",input:{iron_ingot:15,plank:5,gold:200},outputItemId:"blacksmith_hammer",buildingId:"great_forge",level:3,stamina:40,xp:50,description:"Mesterverkty for en ekte smed.",skill:"CRAFTING"},omelette:{label:"Omelett",icon:"",input:{egg:3},outputItemId:"omelette",buildingId:"bakery",level:1,stamina:10,xp:8,description:"En mettende frokost. Gir energi-buff.",skill:"CRAFTING"},hunting_trap:{label:"Jaktfelle",icon:"",input:{wood:10,iron_ingot:2,gold:30},outputItemId:"hunting_trap",buildingId:"great_forge",level:1,stamina:20,xp:15,description:"En enkel snare for smvilt.",skill:"CRAFTING"},hunting_bow:{label:"Jaktbue",icon:"",input:{plank:5,cloth:5,gold:50},outputItemId:"hunting_bow",buildingId:"sawmill",level:1,stamina:25,xp:20,description:"En stdig bue for jakt.",skill:"CRAFTING"},longbow:{label:"Langbue",icon:"",input:{plank:15,cloth:10,iron_ingot:1,gold:250},outputItemId:"longbow",buildingId:"sawmill",level:3,stamina:40,xp:45,description:"En kraftig bue med lang rekkevidde.",skill:"CRAFTING"}},tc={KING:{label:"Konge",description:"Styrer riket, krever skatt og dmmer i store saker."},BARON:{label:"Baron",description:"Styrer en region, krever inn skatt fra bnder, og beskytter mot krig."},PEASANT:{label:"Bonde",description:"Produserer mat og ressurser. Betaler skatt."},SOLDIER:{label:"Soldat",description:"Beskytter riket og deltar i raids."},MERCHANT:{label:"Kjpmann",description:"Tjener penger p handel og markedsspekulasjon."}},VB={PEASANT:["Trell","Leilending","Selveier","Storbondi","Odalbonde"],BARON:["Landmann","Vpner","Ridder","Baron","Grev"],KING:["Prins","Hertug","Konungr"],SOLDIER:["Rekrutt","Vakt","Kjempe","Hvding"],MERCHANT:["Gutt","Svenn","Mester","Hanseat"]},KB={PEASANT:[["Basis rettigheter som bonde."],["+10% resurseffektivitet ved innhsting."],["Redusert skattetreff (-5%) fra din lensherre."],["Lser opp bruk av spesialverkty og ploger."],["Fullstendig selveie: Maksimal frihet og prestisje."]],BARON:[["Rett til  kreve inn skatt i din region."],["+20% forsvarsstyrke for dine vakter."],["Lser opp bygging av avanserte steinborger."],["Hyere status i Tinget: Dine stemmer teller mer."],["Maksimal autoritet og kontroll over landegrenser."]],KING:[["Gunst fra understtene og rett til tronen."],["Nasjonal autoritet: Kan passere lover uten Tinget."],["Gudegitt makt: Maksimal legitimitet og kontroll."]],SOLDIER:[["Grunnleggende kamptrening og utstyr."],["+15% skade i raids og forsvar."],["Lser opp bruk av tunge rustninger og hester."],["Elite-kriger: Fryktet over hele riket."]],MERCHANT:[["Rett til  drive handel p markedsplassen."],["Bedre priser ved kjp og salg (+10%)."],["Lser opp utlandshandel og karavaner."],["Finansfyrste: Kontrollerer markedstrender."]]},tn={grain:{price:10,stock:500,demand:1},flour:{price:15,stock:100,demand:1},bread:{price:25,stock:50,demand:1},wood:{price:15,stock:300,demand:1},plank:{price:25,stock:100,demand:1},iron_ore:{price:30,stock:100,demand:1},iron_ingot:{price:60,stock:50,demand:1},stone:{price:20,stock:200,demand:1},wool:{price:12,stock:200,demand:1},cloth:{price:45,stock:50,demand:1},honey:{price:30,stock:50,demand:1},meat:{price:25,stock:100,demand:1}},YB=[{type:"RAID",title:"Vikinger p horisonten!",description:"Et vikingskip er sett nr kysten. Forsvar jordene fr de stjeler kornet!",locationId:"fields"},{type:"RAID",title:"Bandittleir funnet",description:"Banditter har sltt seg ned i skogen. De stjeler ved hver time!",locationId:"forest"},{type:"QUEST",title:"Den Hellige Gral?",description:"Rykter sier en eremitt ved klosteret har funnet noe verdifullt.",locationId:"village"},{type:"QUEST",title:"Markedsdag i nabolaget",description:"En sjelden mulighet for god handel p grensen.",locationId:"marketplace"}],WB=[{id:"tax_cut",label:"Skattekutt",description:"Alle skatter halveres i 10 minutter. Lojaliteten stiger."},{id:"peace",label:"Fredsavtale",description:"Ingen raids tillatt de neste 10 minuttene."},{id:"salt_tax",label:"Saltskatt",description:"ker kornprisene, men reduserer lojalitet."},{id:"conscription",label:"Verneplikt",description:"Soldater koster mindre  verve, men bnder jobber 20% tregere."}],W1=Object.freeze(Object.defineProperty({__proto__:null,ACTION_COSTS:Dc,ACTION_ICONS:Gd,CRAFTING_RECIPES:Bn,CROP_DATA:Ax,GAME_BALANCE:ee,INITIAL_EQUIPMENT:Up,INITIAL_MARKET:tn,INITIAL_RESOURCES:Lt,INITIAL_SKILLS:Hn,ITEM_TEMPLATES:Oe,LAW_TEMPLATES:WB,LEVEL_XP:Hd,RANK_BENEFITS:KB,REFINERY_RECIPES:Fi,REPAIR_CONFIG:Bp,RESOURCE_DETAILS:Rt,REWARDS:Mc,ROLE_DEFINITIONS:tc,ROLE_TITLES:VB,SEASONS:Pn,SKILL_DETAILS:zB,UPGRADES_LIST:Tx,VILLAGE_BUILDINGS:Kt,WEATHER:js,WORLD_EVENT_TEMPLATES:YB},Symbol.toStringTag,{value:"Module"}));/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qB=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),XB=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,s)=>s?s.toUpperCase():n.toLowerCase()),q1=t=>{const e=XB(t);return e.charAt(0).toUpperCase()+e.slice(1)},bA=(...t)=>t.filter((e,n,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===n).join(" ").trim(),QB=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var JB={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZB=_.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:i="",children:r,iconNode:a,...l},c)=>_.createElement("svg",{ref:c,...JB,width:e,height:e,stroke:t,strokeWidth:s?Number(n)*24/Number(e):n,className:bA("lucide",i),...!r&&!QB(l)&&{"aria-hidden":"true"},...l},[...a.map(([u,d])=>_.createElement(u,d)),...Array.isArray(r)?r:[r]]));/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=(t,e)=>{const n=_.forwardRef(({className:s,...i},r)=>_.createElement(ZB,{ref:r,iconNode:e,className:bA(`lucide-${qB(q1(t))}`,`lucide-${t}`,s),...i}));return n.displayName=q1(t),n};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eU=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],X1=Z("activity",eU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tU=[["path",{d:"M11 9a1 1 0 0 0 1-1V5.061a1 1 0 0 1 1.811-.75l6.836 6.836a1.207 1.207 0 0 1 0 1.707l-6.836 6.835a1 1 0 0 1-1.811-.75V16a1 1 0 0 0-1-1H5a1 1 0 0 1-1-1v-4a1 1 0 0 1 1-1z",key:"1232du"}]],nU=Z("arrow-big-right",tU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sU=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],yr=Z("arrow-right",sU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iU=[["path",{d:"M2 4v16",key:"vw9hq8"}],["path",{d:"M2 8h18a2 2 0 0 1 2 2v10",key:"1dgv2r"}],["path",{d:"M2 17h20",key:"18nfp3"}],["path",{d:"M6 8v9",key:"1yriud"}]],Q1=Z("bed",iU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rU=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],aU=Z("brain",rU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oU=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],lU=Z("calendar",oU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cU=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Uf=Z("check",cU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uU=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],dU=Z("chevron-down",uU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fU=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],vA=Z("chevron-right",fU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hU=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Hp=Z("circle-alert",hU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mU=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]],pU=Z("circle-arrow-up",mU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gU=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],xU=Z("circle-check",gU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bU=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Gp=Z("clock",bU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vU=[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]],yU=Z("coffee",vU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _U=[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]],jx=Z("coins",_U);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wU=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],Lc=Z("crown",wU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kU=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],NU=Z("disc",kU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SU=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],EU=Z("eye-off",SU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TU=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],AU=Z("eye",TU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jU=[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]],yA=Z("gift",jU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RU=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],IU=Z("globe",RU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CU=[["path",{d:"m15 12-9.373 9.373a1 1 0 0 1-3.001-3L12 9",key:"1hayfq"}],["path",{d:"m18 15 4-4",key:"16gjal"}],["path",{d:"m21.5 11.5-1.914-1.914A2 2 0 0 1 19 8.172v-.344a2 2 0 0 0-.586-1.414l-1.657-1.657A6 6 0 0 0 12.516 3H9l1.243 1.243A6 6 0 0 1 12 8.485V10l2 2h1.172a2 2 0 0 1 1.414.586L18.5 14.5",key:"15ts47"}]],$d=Z("hammer",CU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OU=[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]],Rx=Z("handshake",OU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MU=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],_A=Z("history",MU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DU=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],wA=Z("info",DU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LU=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],PU=Z("layout-grid",LU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BU=[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]],UU=Z("leaf",BU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HU=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],J1=Z("loader-circle",HU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GU=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],no=Z("lock",GU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $U=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],FU=Z("mail",$U);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zU=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],kA=Z("map-pin",zU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VU=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],KU=Z("map",VU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YU=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],WU=Z("menu",YU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qU=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],nc=Z("message-square",qU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XU=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],QU=Z("music",XU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JU=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],ZU=Z("navigation",JU);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eH=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],tH=Z("package",eH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nH=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],$p=Z("pause",nH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sH=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],Fp=Z("play",sH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iH=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],rH=Z("scale",iH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aH=[["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]],oH=Z("scroll",aH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lH=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],cH=Z("search",lH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uH=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],NA=Z("send",uH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dH=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],fH=Z("settings",dH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hH=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],mH=Z("shield-alert",hH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pH=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],zp=Z("shield-check",pH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gH=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Ix=Z("shield",gH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xH=[["path",{d:"M17.971 4.285A2 2 0 0 1 21 6v12a2 2 0 0 1-3.029 1.715l-9.997-5.998a2 2 0 0 1-.003-3.432z",key:"15892j"}],["path",{d:"M3 20V4",key:"1ptbpl"}]],bH=Z("skip-back",xH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vH=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],yH=Z("skip-forward",vH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _H=[["path",{d:"m10 20-1.25-2.5L6 18",key:"18frcb"}],["path",{d:"M10 4 8.75 6.5 6 6",key:"7mghy3"}],["path",{d:"m14 20 1.25-2.5L18 18",key:"1chtki"}],["path",{d:"m14 4 1.25 2.5L18 6",key:"1b4wsy"}],["path",{d:"m17 21-3-6h-4",key:"15hhxa"}],["path",{d:"m17 3-3 6 1.5 3",key:"11697g"}],["path",{d:"M2 12h6.5L10 9",key:"kv9z4n"}],["path",{d:"m20 10-1.5 2 1.5 2",key:"1swlpi"}],["path",{d:"M22 12h-6.5L14 15",key:"1mxi28"}],["path",{d:"m4 10 1.5 2L4 14",key:"k9enpj"}],["path",{d:"m7 21 3-6-1.5-3",key:"j8hb9u"}],["path",{d:"m7 3 3 6h4",key:"1otusx"}]],wH=Z("snowflake",_H);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kH=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Ca=Z("sparkles",kH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NH=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],SH=Z("sun",NH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EH=[["path",{d:"m11 19-6-6",key:"s7kpr"}],["path",{d:"m5 21-2-2",key:"1kw20b"}],["path",{d:"m8 16-4 4",key:"1oqv8h"}],["path",{d:"M9.5 17.5 21 6V3h-3L6.5 14.5",key:"pkxemp"}]],Fd=Z("sword",EH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TH=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Vp=Z("trending-up",TH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AH=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],zd=Z("triangle-alert",AH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jH=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],sc=Z("trophy",jH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RH=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],_r=Z("user",RH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IH=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Cx=Z("users",IH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CH=[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]],OH=Z("utensils",CH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MH=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],DH=Z("volume-2",MH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LH=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],PH=Z("wand-sparkles",LH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BH=[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]],UH=Z("wind",BH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HH=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],us=Z("x",HH);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GH=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],$H=Z("zap",GH),FH=t=>{const e=Object.keys(t),n=[...e].sort(()=>Math.random()-.5),s={...t};if(e.length===0)return s;const r=n.shift();r&&(s[r]={...s[r],role:"KING",resources:JSON.parse(JSON.stringify(Lt.KING)),regionId:"capital",status:{hp:100,stamina:100,morale:100,legitimacy:100,authority:100,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:1,xp:0,reputation:50,contribution:0},equipment:{MAIN_HAND:{id:"tools",name:"Kongens Verkty",icon:"",type:"MAIN_HAND",level:1,durability:100,maxDurability:100},OFF_HAND:{id:"weapon",name:"Kongens Sverd",icon:"",type:"OFF_HAND",level:1,durability:100,maxDurability:100},BODY:{id:"armor",name:"Kongens Rustning",icon:"",type:"BODY",level:1,durability:100,maxDurability:100}}});const l=Math.min(2,n.length);for(let m=0;m<l;m++){const v=n.shift();if(v){const y=m===0?"region_ost":"region_vest";s[v]={...s[v],role:"BARON",resources:JSON.parse(JSON.stringify(Lt.BARON)),regionId:y,status:{hp:100,stamina:100,morale:100,legitimacy:80,authority:50,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:1,xp:0,reputation:40,contribution:0},equipment:{MAIN_HAND:{id:"tools",name:"Baronens Verkty",icon:"",type:"MAIN_HAND",level:1,durability:100,maxDurability:100},OFF_HAND:{id:"weapon",name:"Baronens Sverd",icon:"",type:"OFF_HAND",level:1,durability:100,maxDurability:100},BODY:{id:"armor",name:"Baronens Rustning",icon:"",type:"BODY",level:1,durability:100,maxDurability:100}}}}}let c=0;const u=()=>{const m=c%2===0?"region_ost":"region_vest";return c++,m},d=n.length;let f=0,h=0;d>=4?(f=Math.max(1,Math.floor(d/6)),h=Math.max(1,Math.floor(d/5))):d>0&&d<4&&(f=0,h=0);for(let m=0;m<f;m++){const v=n.shift();v&&(s[v]={...s[v],role:"MERCHANT",resources:JSON.parse(JSON.stringify(Lt.MERCHANT)),regionId:u(),status:{hp:100,stamina:100,morale:100,legitimacy:100,authority:30,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:1,xp:0,reputation:30,contribution:0},equipment:{MAIN_HAND:{id:"tools",name:"Hndverkty",icon:"",type:"MAIN_HAND",level:1,durability:100,maxDurability:100},OFF_HAND:{id:"weapon",name:"Kort sverd",icon:"",type:"OFF_HAND",level:1,durability:100,maxDurability:100},BODY:{id:"armor",name:"Kjpmannskappe",icon:"",type:"BODY",level:1,durability:100,maxDurability:100}}})}for(let m=0;m<h;m++){const v=n.shift();v&&(s[v]={...s[v],role:"SOLDIER",resources:JSON.parse(JSON.stringify(Lt.SOLDIER)),regionId:u(),status:{hp:100,stamina:100,morale:100,legitimacy:100,authority:50,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:1,xp:0,reputation:20,contribution:0},equipment:{MAIN_HAND:{id:"tools",name:"Feltverkty",icon:"",type:"MAIN_HAND",level:1,durability:100,maxDurability:100},OFF_HAND:{id:"weapon",name:"Soldatens Sverd",icon:"",type:"OFF_HAND",level:1,durability:100,maxDurability:100},BODY:{id:"armor",name:"Brynjekofte",icon:"",type:"BODY",level:1,durability:100,maxDurability:100}}})}for(;n.length>0;){const m=n.shift();m&&(s[m]={...s[m],role:"PEASANT",resources:JSON.parse(JSON.stringify(Lt.PEASANT)),regionId:u(),status:{hp:100,stamina:100,morale:80,legitimacy:100,authority:10,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:1,xp:0,reputation:10,contribution:0},equipment:{}})}return s},zH=(t,e)=>{const n={...t},s=[];return Object.values(n).forEach(i=>{if(i.role==="PEASANT"){const a=Math.ceil((i.resources.grain||0)*.15),l=Math.ceil((i.resources.gold||0)*(15/100));if(a>0||l>0){const c=Object.values(n).find(u=>u.role==="BARON"&&(u.regionId===i.regionId||i.regionId==="test_region"&&u.regionId==="test_region"));c&&(i.resources.grain=Math.max(0,i.resources.grain-a),i.resources.gold=Math.max(0,i.resources.gold-l),n[c.id].resources.grain+=a,n[c.id].resources.gold+=l,s.push(`${i.name} betalte ${a} korn og ${l} gull i skatt til ${c.name}`))}}}),Object.values(n).forEach(i=>{if(i.role==="BARON"){const r=Math.ceil((i.resources.grain||0)*(e/100)),a=Math.ceil((i.resources.gold||0)*(e/100));if(r>0||a>0){const l=Object.values(n).find(c=>c.role==="KING");l&&(i.resources.grain=Math.max(0,i.resources.grain-r),i.resources.gold=Math.max(0,i.resources.gold-a),n[l.id].resources.grain+=r,n[l.id].resources.gold+=a,s.push(`${i.name} betalte ${r} korn og ${a} gull i skatt til Kongen`))}}}),Object.values(n).forEach(i=>{if(i.role==="MERCHANT"||i.role==="SOLDIER"){const r=i.role==="MERCHANT"?e/50:e/100,a=Math.ceil((i.resources.gold||0)*r);if(a>0){const l=Object.values(n).find(c=>c.role==="KING");l&&(i.resources.gold=Math.max(0,i.resources.gold-a),n[l.id].resources.gold+=a,s.push(`${i.name} (${i.role}) betalte ${a} gull i skatt til Kongen`))}}}),{updatedPlayers:n,results:s}},VH=(t,e)=>{if(!t||Object.keys(t).length===0)return null;const n=ee.CONTRIBUTION_VALUES,s=Object.entries(t).map(([a,l])=>{let c=0;return Object.entries(l.resources||{}).forEach(([u,d])=>{c+=d*(n[u]||.1)}),{pid:a,score:c,name:l.name}});s.sort((a,l)=>l.score-a.score);const i=s[0];if(!i)return null;const r=e==="throne_room"?"KING":"BARON";return{winningPlayerId:i.pid,role:r}},KH=(t,e)=>({pin:t,name:e,status:"PLAYING",settings:"feudal_europe",hostName:"Host",isPublic:!0,market:JSON.parse(JSON.stringify(tn)),world:{year:1100,season:"Spring",weather:"Clear",gameTick:0,lastTickAt:Date.now(),taxRateDetails:{kingTax:20},settlement:{buildings:Object.entries(Kt).reduce((n,[s])=>({...n,[s]:{id:s,level:0,progress:{},target:200,contributions:{}}}),{})}},markets:{capital:{...tn},region_vest:{...tn},region_ost:{...tn}},players:{},public_profiles:{},messages:[],regions:{region_vest:{id:"region_vest",name:"Baroniet Vest",taxRate:10,defenseLevel:50,rulerName:"Ingen"},region_ost:{id:"region_ost",name:"Baroniet st",taxRate:10,defenseLevel:50,rulerName:"Ingen"}},diplomacy:{},worldEvents:{}}),va=async(t,e)=>{var i,r;if(!t||!e)return;const n=L(P,`simulation_server_metadata/${t}`);if(e.isPublic===!1){await Dr(n,null);return}const s={pin:t,lastUpdated:Date.now()};e.name&&(s.name=e.name),e.status&&(s.status=e.status),e.players&&(s.playerCount=Object.keys(e.players).length),e.playerCount!==void 0&&(s.playerCount=e.playerCount),(i=e.world)!=null&&i.year&&(s.worldYear=e.world.year),(r=e.world)!=null&&r.season&&(s.season=e.world.season),e.hostName&&(s.hostName=e.hostName),e.isPublic!==void 0&&(s.isPublic=e.isPublic),await ne(n,s)},Kp=30,YH=21,WH=120,SA=480,qH=["Spring","Summer","Autumn","Winter"],XH=t=>t%Kp,Ls=t=>XH(t)<YH?"DAY":"NIGHT",QH=(t,e=0)=>{let n=t;if(e>0){const l=(Date.now()-e)/6e4;n+=Math.min(1,Math.max(0,l))}const i=n%Kp/Kp*24,r=(6+Math.floor(i))%24,a=Math.floor(i%1*60);return`${r.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`},JH=t=>{const e=Math.floor(t%SA/WH);return qH[e]||"Spring"},ZH=(t,e=1)=>e+Math.floor(t/SA),Ci=t=>!t||!t.id?null:Oe[t.id]?t.id:Object.keys(Oe).sort((s,i)=>i.length-s.length).find(s=>t.id.startsWith(s+"_"))||null,EA=(t,e)=>{if(!e)return;const s=(Array.isArray(e)?e:Object.values(e)).filter(i=>{if(!i)return!1;const r=Ci(i),a=r?Oe[r]:null,l=i.relevantActions||(a==null?void 0:a.relevantActions);return l==null?void 0:l.includes(t)}).filter(i=>!!i);if(s.length!==0)return s.sort((i,r)=>{var h,m;const a=Ci(i),l=Ci(r),c=i.stats||(a?(h=Oe[a])==null?void 0:h.stats:{}),u=r.stats||(l?(m=Oe[l])==null?void 0:m.stats:{}),d=(c==null?void 0:c.yieldBonus)||0;return((u==null?void 0:u.yieldBonus)||0)-d})[0]},ut=async(t,e)=>{const n=L(P,`simulation_rooms/${t}/messages`);await Te(n,s=>{let i=[];Array.isArray(s)?i=s:s&&typeof s=="object"&&(i=Object.values(s));const r={id:`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,content:e,timestamp:Date.now(),type:"SYSTEM"};return i.push(r),i.length>50&&(i=i.sort((a,l)=>a.timestamp-l.timestamp).slice(i.length-50)),i})},ms=(t,e,n,s={})=>{var v,y;let i=0,r=!1;t.equipment&&Object.keys(t.equipment).forEach(g=>{var k,S;const p=t.equipment[g];if(!p)return;let x=p.relevantActions;if(!x&&p.id){const N=Ci(p);N&&(x=(k=Oe[N])==null?void 0:k.relevantActions)}if(!s.actionType||(x==null?void 0:x.includes(s.actionType))){const N=p.stats||(Ci(p)?(S=Oe[Ci(p)])==null?void 0:S.stats:void 0);N!=null&&N.yieldBonus&&(i+=N.yieldBonus),(g==="AXE"||g==="PICKAXE"||g==="SCYTHE"||g==="MAIN_HAND"||g==="OFF_HAND"||g==="BOW"||g==="TRAP"||g==="CHISEL")&&(r=!0)}});let a=e+i;const l=((v=t.skills)==null?void 0:v[n])||{level:0},c=s.isRefining?ee.SKILLS.REFINING_BONUS:ee.SKILLS.GATHERING_BONUS,u=1+l.level*c;a*=u;const d=s.actionType==="FORAGE"||s.actionType==="GATHER_HONEY";if(!s.isRefining&&!r&&!d){if(s.requiresTool)return 0;const b=(y=ee.GATHERING)==null?void 0:y.NO_TOOL_PENALTY;a*=1-b}let f=1;s.regionId&&(s.actionType==="MINE"&&(s.regionId==="region_vest"?f=1.2:s.regionId==="region_ost"&&(f=.8)),s.actionType==="CHOP"&&(s.regionId==="region_vest"?f=.8:s.regionId==="region_ost"&&(f=1.2)));let h=1;if(t.activeBuffs&&t.activeBuffs.length>0){const b=Date.now(),g=t.activeBuffs.find(p=>p.type==="YIELD_BONUS"&&p.expiresAt>b);g&&(h+=g.value)}const m=(s.season||1)*(s.weather||1)*(s.law||1)*(s.upgrades||1)*f*h;if(a=Math.floor(a*m),s.performance!==void 0){const b=ee.MINIGAME.BASE_MULTIPLIER+s.performance*ee.MINIGAME.PERFORMANCE_WEIGHT;a=Math.ceil(a*b)}return Math.max(0,a)},zn=(t,e,n,s,i=0)=>{const r=Pn[e],a=js[n],l=(r==null?void 0:r.staminaMod)||1,c=(a==null?void 0:a.staminaMod)||1,d=Ls(i)==="NIGHT"?1.2:1;let h=t*l*c*d;if(s&&s.length>0){const m=Date.now(),v=s.find(y=>y.type==="STAMINA_SAVE"&&y.expiresAt>m);v&&(h*=1-v.value)}return Math.ceil(h)},Qn=(t,e,n,s=1)=>{if(!t||!e||!n)return;const i=n.replace(/\./g,"_"),r=L(P,`simulation_rooms/${t}/stats/${e}`);ne(r,{[i]:PE(s)}).catch(a=>console.error("Failed to log systemic stat:",a))},eG=async(t,e,n)=>{const{resource:s,type:i}=n,r=L(P,`simulation_rooms/${t}/players/${e}`),a=await xe(r);if(!a.exists())return{success:!1,error:"Player not found"};const l=a.val(),c=l.regionId||"capital",u=L(P,`simulation_rooms/${t}/markets/${c}/${s}`);let d={success:!1,amount:0};if(await Te(u,m=>{if(m){if(i==="BUY"){if(m.stock<=0)return;d.price=m.price,d.cost=m.price,d.amount=1,m.stock-=1,m.price+=m.price*ee.MARKET.PRICE_IMPACT_BUY,d.success=!0}else if(i==="SELL"){d.price=m.price;const v=m.price*ee.MARKET.SELL_RATIO;d.revenue=v,d.amount=1,m.stock+=1,m.price-=m.price*ee.MARKET.PRICE_IMPACT_SELL,d.success=!0}return m}}),!d.success)return{success:!1,error:"Handel feilet (Vare mangler eller utsolgt)"};let f=!1,h="";return await Te(r,m=>{if(m){if(m.resources||(m.resources={}),m.inventory||(m.inventory=[]),i==="BUY"){const v=d.cost||0;if((m.resources.gold||0)<v)return;m.resources.gold=(m.resources.gold||0)-v,m.resources[s]=(m.resources[s]||0)+1;const y=Rt[s];h=`Kjpte 1 ${y?y.label:s} for ${v.toFixed(2)}g`,f=!0}else if(i==="SELL"){const v=d.revenue||0;if((m.resources[s]||0)<1)return;m.resources[s]-=1,m.resources.gold=(m.resources.gold||0)+v;const y=Rt[s];h=`Solgte 1 ${y?y.label:s} for ${v.toFixed(2)}g`,f=!0}return m}}),f?(ut(t,`[${new Date().toLocaleTimeString()}] ${l.name}: ${h}`),{success:!0,data:{success:!0,timestamp:Date.now(),message:h,utbytte:i==="BUY"?[{resource:s,amount:1}]:[{resource:"gold",amount:d.revenue}],xp:[],durability:[]}}):{success:!1,error:"Transaksjon avbrutt (Mangler ressurser)"}},tG=async(t,e,n)=>{var g;const{buildingId:s,resource:i,amount:r}=n,a=L(P,`simulation_rooms/${t}/world/settlement/buildings/${s}`),l=L(P,`simulation_rooms/${t}/players/${e}`),c=await xe(l);if(!c.exists())return{success:!1,error:"Player missing"};const u=c.val();if((((g=u.resources)==null?void 0:g[i])||0)<r)return{success:!1,error:"Not enough resources"};let d=!1,f=0,h="",m=!1,v=0,y="Ukjent feil i transaksjon";if(await Te(a,p=>{var C,U,K,J;p||(p={id:s,level:0,progress:{},contributions:{}});const x=Kt[s];if(!x){y=`Systemfeil: BuildingDef mangler for ID: ${s}`;return}h=(x==null?void 0:x.name)||s;const w=Number(p.level??0),k=p.progress&&Object.keys(p.progress).length>0,S=p.contributions&&Object.keys(p.contributions).length>0,N=!((C=x.levels)!=null&&C[w+1]);let T=!1;N&&(k||S)&&(console.log(`[Auto-Repair] Building ${s} is stuck at Level ${w}. Resetting to 0 to enable completion.`),p.level=0,T=!0);const E=Number(p.level??0),j=E+1,R=(U=x==null?void 0:x.levels)==null?void 0:U[j];if(!R)return y=`Bygget er ferdig (Level ${E}). Ingen flere oppgraderinger tilgjengelig.`,T?p:void 0;const I=((K=R.requirements)==null?void 0:K[i])||0,V=((J=p.progress)==null?void 0:J[i])||0,B=I-V;let O=!0;if(Object.entries(R.requirements).forEach(([H,$])=>{(p.progress[H]||0)<$&&(O=!1)}),B<=0&&!O)return y=`Fullt lager for ${i}. (Krav: ${I}, Har: ${V}, Niv: ${E}->${j})`,T?p:void 0;f=Math.min(r,B),p.progress||(p.progress={}),p.progress[i]=V+f,p.contributions||(p.contributions={}),p.contributions[e]||(p.contributions[e]={name:u.name,resources:{}});const D=p.contributions[e].resources;D[i]=(D[i]||0)+f;let M=!0;if(Object.entries(R.requirements).forEach(([H,$])=>{(p.progress[H]||0)<$&&(M=!1)}),M){p.level=j,p.progress={};const H=R.unlocks||[];if(H.includes("BARON_STATUS")||H.includes("KING_STATUS")){const $=VH(p.contributions,s);$&&(p.pendingWinnerId=$.winningPlayerId,p.pendingRole=$.role)}p.contributions={},m=!0,v=j}return d=!0,Qn(t,"contributions",i,f),p}),!d)return{success:!1,error:`${y}`};if(m){const x=(await xe(a)).val();if(x.pendingWinnerId){const w=x.pendingWinnerId,k=x.pendingRole,S=L(P,`simulation_rooms/${t}/players/${w}`),T=(await xe(S)).val(),E=L(P,`simulation_rooms/${t}`),j={};if(j[`players/${w}/role`]=k,j[`public_profiles/${w}/role`]=k,k==="BARON"){const I=s==="manor_ost"?"region_ost":"region_vest";j[`players/${w}/regionId`]=I,j[`public_profiles/${w}/regionId`]=I,j[`regions/${I}/rulerId`]=w,j[`regions/${I}/rulerName`]=T.name}else k==="KING"&&(j[`players/${w}/regionId`]="capital",j[`public_profiles/${w}/regionId`]="capital");await ne(E,j);const R=` ${T.name} har fullfrt ${h} og er n utnevnt til ${k==="BARON"?"Baron":"Konge"}!`;ut(t,R),await ne(a,{pendingWinnerId:null,pendingRole:null})}}let b=`Bidro med ${f} ${i} til ${h}`;return m&&(b+=`  ${h} ndde niv ${v}!`),await Te(l,p=>{var x;if(p)return((x=p.resources)==null?void 0:x[i])>=f&&(p.resources[i]-=f),p}),ut(t,`[${new Date().toLocaleTimeString()}] ${u.name}: ${b}`),{success:!0,data:{success:!0,timestamp:Date.now(),message:b,utbytte:[{resource:i,amount:-f}],xp:[],durability:[]}}},nG=async(t,e,n)=>{const s=L(P,`simulation_rooms/${t}/players/${e}`),i=await xe(s);if(!i.exists())return{success:!1,error:"Spiller finnes ikke"};const r=i.val(),a=n.type||"TAX",l=r.role==="KING"||a==="TAX_ROYAL",c=n.taxRate!==void 0?n.taxRate:10,u=c/100,d=L(P,`simulation_rooms/${t}/players`),f=await xe(d);if(!f.exists())return{success:!1,error:"Ingen spillere i rommet"};const h=f.val();let m=0,v=0,y=0;const b=(r.regionId||"").trim().toLowerCase(),g=Object.entries(h).map(async([I,V])=>{if(I===e)return;const B=(V.regionId||"").trim().toLowerCase();if(!(l?V.role==="BARON":V.role==="PEASANT"&&(B===b||B.includes(b)||b.includes(B))))return;const D=L(P,`simulation_rooms/${t}/players/${I}`);let M={goldFloat:0,grainFloat:0};await Te(D,C=>{var $,F,Q;if(!C)return;C.resources||(C.resources={gold:0,grain:0});const U=Number(C.resources.gold??C.gold??C.wealth??(($=C.stats)==null?void 0:$.gold)??((Q=(F=C.inventory)==null?void 0:F.find(ce=>ce.id==="gold"))==null?void 0:Q.amount)??0),K=Number(C.resources.grain??0),J=U*u,H=K*u;if(J>0){const ce=Math.floor(J);C.resources.gold!==void 0?C.resources.gold-=ce:C.gold!==void 0&&(C.gold-=ce),M.goldFloat=J}if(H>0){const ce=Math.floor(H);C.resources.grain-=ce,M.grainFloat=H}return C}),(M.goldFloat>0||M.grainFloat>0)&&(y++,m+=M.goldFloat,v+=M.grainFloat)});await Promise.all(g);const p=Math.floor(m),x=Math.floor(v);await Te(s,I=>{if(!I)return;I.resources||(I.resources={gold:0,grain:0}),I.resources.gold=(I.resources.gold||0)+p,I.resources.grain=(I.resources.grain||0)+x;const V=Math.max(0,5+Math.floor((c-10)/2));return I.status.legitimacy=Math.max(0,(I.status.legitimacy||100)-V),I});const w=Date.now(),k=L(P,`simulation_rooms/${t}/world`),N=(await xe(k)).val()||{year:1,season:"Spring"},T=N.year||1,E=N.season||"Spring",j={year:T,season:E,amountGold:p,amountGrain:x,rate:c,timestamp:w};if(l){const I={};I.lastRoyalTaxCollection={year:T,season:E},N.taxRateDetails?I["taxRateDetails/kingTax"]=c:I.taxRateDetails={kingTax:c},await ne(k,I);const V=L(P,`simulation_rooms/${t}/world/royalTaxHistory`),B=await xe(V),O=B.exists()?B.val():[];O.push(j),O.length>10&&O.shift(),await Dr(V,O)}else{const I=L(P,`simulation_rooms/${t}/regions/${r.regionId}`),V={};V.taxRate=c,V.lastTaxCollection={year:T,season:E},await ne(I,V);const B=L(P,`simulation_rooms/${t}/regions/${r.regionId}/taxHistory`),O=await xe(B),D=O.exists()?O.val():[];D.push(j),D.length>10&&D.shift(),await Dr(B,D)}const R=l?`Kongelig Skatt (${c}%): ${p}g og ${x} korn fra ${y} baroner.`:`Skatteinnkreving (${c}%): ${p}g og ${x} korn fra ${y} bnder.`;return ut(t,`[${new Date().toLocaleTimeString()}] ${r.name}: ${R}`),{success:!0,data:{success:!0,timestamp:w,message:R,utbytte:[{resource:"gold",amount:p},{resource:"grain",amount:x}],xp:[],durability:[]}}},VF=async(t,e,n)=>{const s=L(P,`simulation_rooms/${t}/players/${e}`),i=await xe(s);if(!i.exists())return{success:!1,error:"Fant ikke spilleren."};const r=i.val();if(r.role!=="PEASANT")return{success:!1,error:"Du har alt en karriere."};if(n!=="SOLDIER"&&n!=="MERCHANT")return{success:!1,error:"Ugyldig karrierevalg."};const a=ee.CAREERS[n];if(r.stats.level<a.LEVEL_REQ)return{success:!1,error:`Du m vre level ${a.LEVEL_REQ} for  bli ${n==="SOLDIER"?"Soldat":"Kjpmann"}.`};if((r.resources.gold||0)<a.COST)return{success:!1,error:`Du mangler ${a.COST-(r.resources.gold||0)} gull.`};let l=!1;return await Te(s,c=>{if(c&&!(c.resources.gold<a.COST))return c.resources.gold-=a.COST,c.role=n,l=!0,c}),l?(ut(t,`[KARRIERE] ${r.name} er n en ${n}!`),{success:!0,message:`Gratulerer! Du er n en ${n==="SOLDIER"?"Soldat":"Kjpmann"}.`}):{success:!1,error:"Transaksjon feilet."}},sG=async(t,e)=>{var b,g;Qn(t,"coups","start",1);const n=L(P,`simulation_rooms/${t}/regions/${e}`),i=(await xe(n)).val(),r=i.rulerId,a=i.rulerName;if(r){const p=L(P,`simulation_rooms/${t}/players/${r}`);await Te(p,x=>{if(x)return x.role="PEASANT",x.status.legitimacy=0,x}),await ne(L(P,`simulation_rooms/${t}/public_profiles/${r}`),{role:"PEASANT"})}const l={},c=((b=i.coup)==null?void 0:b.contributions)||{},u=((g=i.coup)==null?void 0:g.preVotes)||{};Object.entries(c).sort((p,x)=>x[1].amount-p[1].amount).slice(0,3).forEach(([p,x])=>{l[p]={id:p,name:x.name,votes:0,weightedVotes:0,contribution:x.amount}});const d=Date.now(),f={startedAt:d,expiresAt:d+ee.COUP.VACANCY_DURATION,candidates:l,votes:{}};let h=0;const m=L(P,`simulation_rooms/${t}/players`),y=(await xe(m)).val()||{};Object.entries(u).forEach(([p,x])=>{if(l[x]){const w=y[p];if(w){let k=ee.COUP.PEASANT_VOTE_WEIGHT;w.role==="KING"&&(k=ee.COUP.KING_VOTE_WEIGHT),f.votes[p]={candidateId:x,weight:k},l[x].votes+=1,l[x].weightedVotes+=k,h++}}}),await ne(n,{rulerId:null,rulerName:"VAKANT",activeElection:f,"coup/bribeProgress":0,"coup/preVotes":null}),ut(t,` REVOLUSJON i ${i.name}! ${a} er styrtet. ${h} skyggelfter ble automatisk talt opp!`)},KF=async(t,e,n)=>{var x,w;const{regionId:s,amount:i}=n,r=L(P,`simulation_rooms/${t}/regions/${s}`),a=L(P,`simulation_rooms/${t}/players/${e}`),l=await xe(a);if(!l.exists())return{success:!1,error:"Fant ikke spilleren."};const c=l.val();if((((x=c.resources)==null?void 0:x.gold)||0)<i)return{success:!1,error:"Du har ikke nok gull."};const d=(await xe(r)).val();if(!d)return{success:!1,error:"Region finnes ikke."};const f=((w=d.coup)==null?void 0:w.lastRulerChange)||0,h=Date.now();if(h-f<ee.COUP.HONEYMOON_DURATION&&c.role!=="KING")return{success:!1,error:`Regionen er for stabil. Prv igjen om ${Math.ceil((ee.COUP.HONEYMOON_DURATION-(h-f))/6e4)} minutter.`};if(d.activeElection)return{success:!1,error:"Et valg pgr allerede."};let m=0,v=!1;if(await Te(r,k=>{k||(k={id:s,name:s==="capital"?"Kongeriket":s==="region_vest"?"Baroniet Vest":"Baroniet st",rulerName:"Ingen",coup:{lastRulerChange:0,bribeProgress:0,contributions:{}}}),k.coup||(k.coup={lastRulerChange:0,bribeProgress:0,contributions:{}}),k.garrison||(k.garrison={swords:0,armor:0,morale:100}),k.fortification||(k.fortification={hp:1e3,maxHp:1e3,level:1});const S=k.coup.bribeProgress||0,N=i/ee.COUP.BASE_BRIBE_COST*10;return e===d.rulerId?k.coup.bribeProgress=Math.max(0,S-N):(k.coup.bribeProgress=Math.min(100,S+N),k.coup.challengerId=e,k.coup.challengerName=c.name),k.coup.contributions||(k.coup.contributions={}),k.coup.contributions[e]||(k.coup.contributions[e]={name:c.name,amount:0}),k.coup.contributions[e].amount+=i,m=k.coup.bribeProgress,v=!0,k}),!v)return{success:!1,error:"Transaksjon feilet (Region oppdatert)."};await Te(a,k=>{if(k)return k.resources.gold=(k.resources.gold||0)-i,k});const y=L(P,`simulation_rooms/${t}/players`),b=await xe(y);let g={};b.exists()&&(g=b.val());let p=d.rulerId;if(!p&&Object.keys(g).length>0){if(s==="capital"){const k=Object.values(g).find(S=>S.role==="KING");k&&(p=k.id)}else{const k=Object.values(g).find(S=>S.role==="BARON"&&S.regionId===s);k&&(p=k.id)}p&&await ne(r,{rulerId:p})}if(p){const k=L(P,`simulation_rooms/${t}/players/${p}`),S=Math.floor(i/100);if(await Te(k,N=>{if(N)return N.status&&(N.status.legitimacy=Math.max(0,(N.status.legitimacy||0)-S)),N}),Object.keys(g).length>0){const N=Object.keys(g).filter(T=>g[T].regionId===s&&T!==e&&(g[T].role==="PEASANT"||g[T].role==="SOLDIER"));if(N.length>0){const T=Math.floor(i/N.length);T>0&&await Promise.all(N.map(E=>{const j=L(P,`simulation_rooms/${t}/players/${E}/resources`);return ne(j,{gold:PE(T)})})),ut(t,`[FOLKEGAVE] ${c.name} donerte ${i}g. ${N.length} innbyggere fikk ${T}g hver! (Opprr: ${m.toFixed(0)}%)`)}else ut(t,`[FOLKEGAVE] ${c.name} donerte ${i}g til saken, men fant ingen trengende i ${d.name}. (Opprr: ${m.toFixed(0)}%)`)}else ut(t,`[FOLKEGAVE] ${c.name} donerte ${i}g. (Opprr: ${m.toFixed(0)}%)`);return m>=100&&await sG(t,s),{success:!0,message:`Besteikkelse gjennomfrt! Opprr: ${m.toFixed(1)}%`}}return{success:!0,message:"Besteikkelse registrert."}},YF=async(t,e,n,s)=>{const i=L(P,`simulation_rooms/${t}/regions/${n}`);let r=!1;return await Te(i,a=>{if(a)return a.coup||(a.coup={bribeProgress:0,contributions:{},preVotes:{}}),a.coup.preVotes||(a.coup.preVotes={}),a.coup.preVotes[e]=s,r=!0,a}),r?{success:!0,message:"Skyggelfte avgitt!"}:{success:!1,error:"Kunne ikke avgi lfte."}},WF=async(t,e,n)=>{const s=L(P,`simulation_rooms/${t}/regions/${n}`),i=L(P,`simulation_rooms/${t}/players/${e}`),r=ee.COUP.RESTORE_ORDER_COST,a=await xe(i);if(!a.exists())return{success:!1,error:"Spiller mangler"};const l=a.val();if(l.resources.gold<r)return{success:!1,error:`Trenger ${r}g for  gjenopprette ro.`};let c=!1;return await Te(s,u=>{if(!(!u||u.rulerId!==e)&&u.coup)return u.coup.bribeProgress=Math.max(0,(u.coup.bribeProgress||0)-25),c=!0,u}),c?(await Te(i,u=>{if(u)return u.resources.gold-=r,u.status.legitimacy=Math.min(100,(u.status.legitimacy||0)+10),u}),ut(t,` ${l.name} har gjenopprettet ro i ${n} ved  dele ut midler til vaktene.`),{success:!0,message:"Ro gjenopprettet (-25% opprr)"}):{success:!1,error:"Kunne ikke gjenopprette ro."}},qF=async(t,e,n)=>{const{regionId:s,candidateId:i}=n,r=L(P,`simulation_rooms/${t}/regions/${s}`),a=L(P,`simulation_rooms/${t}/players/${e}`),l=await xe(a);if(!l.exists())return{success:!1};const c=l.val();let u=ee.COUP.PEASANT_VOTE_WEIGHT;c.role==="KING"&&(u=ee.COUP.KING_VOTE_WEIGHT);let d=!1;return await Te(r,f=>{if(!f||!f.activeElection||Date.now()>f.activeElection.expiresAt)return;f.activeElection.votes||(f.activeElection.votes={});const h=f.activeElection.votes[e];if(h){const v=f.activeElection.candidates[h.candidateId];v&&(v.votes=Math.max(0,(v.votes||0)-1),v.weightedVotes=Math.max(0,(v.weightedVotes||0)-h.weight))}f.activeElection.votes[e]={candidateId:i,weight:u};const m=f.activeElection.candidates[i];return m&&(m.votes=(m.votes||0)+1,m.weightedVotes=(m.weightedVotes||0)+u),d=!0,f}),{success:d}},iG=async(t,e,n)=>{const{amount:s,resource:i}=n,r=L(P,`simulation_rooms/${t}/players/${e}`),a=await xe(r);if(!a.exists())return{success:!1,error:"Spiller mangler"};const l=a.val(),c=l.regionId||"capital",u=L(P,`simulation_rooms/${t}/regions/${c}`),d=i==="swords"?"iron_sword":"leather_armor",f=l.inventory||[];if(f.filter(v=>v.id===d).length<s)return{success:!1,error:`Mangler ${s} ${i==="swords"?"sverd":"rustninger"} i inventory.`};let m=!1;if(await Te(u,v=>(v||(v={id:c,name:c,defenseLevel:1,taxRate:10,rulerName:l.name}),v.garrison||(v.garrison={swords:0,armor:0,morale:100}),v.garrison[i]+=s,m=!0,v)),m){let v=0;const y=f.filter(g=>v<s&&g.id===d?(v++,!1):!0);await ne(r,{inventory:y});const b=`Forsterket garnisonen i ${c} med ${s} ${i==="swords"?"sverd":"rustninger"}.`;return ut(t,`[${new Date().toLocaleTimeString()}] ${l.name}: ${b}`),{success:!0,data:{message:b}}}return{success:!1,error:"Kunne ikke oppdatere garnisonen."}},rG=async(t,e,n)=>{const s=L(P,`simulation_rooms/${t}/players/${e}`),i=await xe(s);if(!i.exists())return{success:!1,error:"Spiller mangler"};const r=i.val(),a=10,l=10,c=50;if((r.resources.stone||0)<a||(r.resources.wood||0)<l)return{success:!1,error:"Mangler stein eller ved for reparasjon."};const u=r.regionId||"capital",d=L(P,`simulation_rooms/${t}/regions/${u}`);let f=!1,h="";if(await Te(d,m=>{if(m){if(m.fortification||(m.fortification={hp:1e3,maxHp:1e3,level:1}),m.fortification.hp>=m.fortification.maxHp){h="Murene er allerede feilfrie.";return}return m.fortification.hp=Math.min(m.fortification.maxHp,m.fortification.hp+c),f=!0,m}}),f){await Te(s,v=>{if(v)return v.resources.stone-=a,v.resources.wood-=l,v});const m=`Reparerte murer i ${u} (+${c} HP).`;return ut(t,`[${new Date().toLocaleTimeString()}] ${r.name}: ${m}`),{success:!0,data:{message:m}}}return{success:!1,error:h||"Kunne ikke reparere murene."}},aG=async(t,e,n)=>{const{newRate:s}=n,i=L(P,`simulation_rooms/${t}/players/${e}`),r=await xe(i);if(!r.exists())return{success:!1,error:"Spiller mangler"};const a=r.val(),l=a.regionId||"capital",c=L(P,`simulation_rooms/${t}/regions/${l}`),u=Math.max(0,Math.min(20,s));await ne(c,{taxRate:u});const d=`Skatteniv i ${l} satt til ${u}%.`;return ut(t,`[${new Date().toLocaleTimeString()}] ${a.name}: ${d}`),{success:!0,data:{message:d}}},XF=async(t,e)=>{const n=L(P,`simulation_rooms/${t}/regions/${e}`),i=(await xe(n)).val(),r=(i==null?void 0:i.name)||e;let a=null;if(await Te(n,l=>{if(!l||!l.activeElection||Date.now()<l.activeElection.expiresAt)return;const c=Object.values(l.activeElection.candidates);if(c.length===0)return l.rulerId=null,l.rulerName="Ingen Hersker",l.activeElection=null,l;const u=c.sort((d,f)=>f.weightedVotes-d.weightedVotes)[0];return a={winnerId:u.id,winnerName:u.name},l.rulerId=u.id,l.rulerName=u.name,l.activeElection=null,l.coup||(l.coup={lastRulerChange:Date.now(),bribeProgress:0,contributions:{}}),l.coup.lastRulerChange=Date.now(),l.coup.bribeProgress=0,l.coup.contributions={},l}),a){Qn(t,"coups","success",1);const l=a.winnerId,c=L(P,`simulation_rooms/${t}/players/${l}`),d=(await xe(c)).val(),f=L(P,`simulation_rooms/${t}`),h={};return h[`players/${l}/role`]="BARON",h[`players/${l}/regionId`]=e,h[`public_profiles/${l}/role`]="BARON",h[`public_profiles/${l}/regionId`]=e,await ne(f,h),ut(t,` KRONING: ${d.name} har vunnet valget og er n Baron av ${r}!`),{success:!0}}return{success:!1}},oG=async(t,e,n)=>{const s=L(P,`simulation_rooms/${t}/players/${e}`);let i=!1;return await Te(s,r=>{if(r)return r.resources||(r.resources={}),r.resources.gold=(r.resources.gold||0)+n,i=!0,r}),i&&ut(t,` ADMIN: Gitt ${n}g til en spiller.`),{success:i}},lG=async(t,e,n,s)=>{const i=L(P,`simulation_rooms/${t}/players/${e}`),r=Oe[n];if(!r)return{success:!1,error:"Invalid Item ID"};let a=!1;return await Te(i,l=>{if(l){l.inventory||(l.inventory=[]);for(let c=0;c<s;c++){const u=JSON.parse(JSON.stringify(r));u.instanceId=`${n}_${Date.now()}_${Math.random().toString(36).substr(2,5)}`,l.inventory.push(u)}return a=!0,l}}),a&&ut(t,` ADMIN: Gitt ${s}x ${r.name} til en spiller.`),{success:a}},cG=async(t,e,n,s)=>{const i=L(P,`simulation_rooms/${t}/players/${e}`);let r=!1;return await Te(i,a=>{if(a)return a.resources||(a.resources={}),a.resources[n]=(a.resources[n]||0)+s,a.resources[n]<0&&(a.resources[n]=0),r=!0,a}),r&&ut(t,` ADMIN: Gitt ${s}x ${n} til en spiller.`),{success:r}},uG=async(t,e,n,s)=>{var d;const i=L(P,`simulation_rooms/${t}/players/${e}`),r=L(P,`simulation_rooms/${t}/channels/${s}/messages`),a=await xe(i);if(!a.exists())return{success:!1,error:"Spiller mangler"};const l=a.val();let c=0;if(l.role!=="KING"&&(s==="global"?c=2:s!==l.regionId&&s!=="diplomacy"&&s.includes(e)&&s.length>20&&(c=5)),(((d=l.resources)==null?void 0:d.gold)||0)<c)return{success:!1,error:`Trenger ${c}g for  sende denne meldingen.`};let u=!1;if(c>0?await Te(i,f=>{if(f&&!((f.resources.gold||0)<c))return f.resources.gold-=c,u=!0,f}):u=!0,!u)return{success:!1,error:"Har ikke rd."};try{const f=LE(r);return await ne(f,{id:f.key,senderId:e,senderName:l.name,senderRole:l.role,content:n.trim(),timestamp:oL(),isPremiere:c>0}),{success:!0}}catch(f){return console.error("Chat Send Error:",f),{success:!1,error:`Kunne ikke sende melding: ${f.message||"Ukjent feil"}`}}},TA=(t,e,n,s)=>{_.useEffect(()=>{if(!t||e==="LOBBY")return;const i=setInterval(async()=>{const r=Date.now(),a=(n==null?void 0:n.lastTickAt)||0;if(!(r-a<1e3))if(r-a>=6e4){const l=L(P,`simulation_rooms/${t}/world`);try{let c=null;await Te(l,u=>{if(!u)return;const d=u.lastTickAt||0;if(Date.now()-d>=6e4){const f=(u.gameTick||0)+1;return u.gameTick=f,u.lastTickAt=Date.now(),u.season=JH(f),u.year=ZH(f,1100),c={...u},u}else return}),c&&va(t,{world:c,pin:t,playerCount:s})}catch{}}else n!=null&&n.lastTickAt||ne(L(P,`simulation_rooms/${t}/world`),{lastTickAt:Date.now()})},5e3);return()=>clearInterval(i)},[t,e,n==null?void 0:n.lastTickAt,n==null?void 0:n.gameTick,s]),_.useEffect(()=>{if(!t||s===void 0)return;const i=setTimeout(()=>{va(t,{playerCount:s})},2e3);return()=>clearTimeout(i)},[t,s])};class dG{constructor(e){et(this,"genome");this.genome=e}decide(e,n){var c;const s=[],i=e.status.stamina,r=(1-i/100)*this.genome.weights.hungerThreshold*5;e.resources.bread>0&&i<80&&s.push({action:{type:"EAT"},score:r,reason:"Sulten"}),i<50&&s.push({action:{type:"SLEEP"},score:(1-i/100)*this.genome.weights.restFocus*3,reason:"Trtt"}),s.push({action:{type:"CHOP"},score:this.genome.weights.gatherWood*this.getNeedMultiplier(e,"wood"),reason:"Trengte ved"}),s.push({action:{type:"QUARRY"},score:this.genome.weights.gatherStone*this.getNeedMultiplier(e,"stone"),reason:"Trengte stein"}),s.push({action:{type:"MINE"},score:this.genome.weights.gatherIron*this.getNeedMultiplier(e,"iron_ore"),reason:"Trengte jernmalm"}),s.push({action:{type:"WORK"},score:this.genome.weights.gatherGrain*this.getNeedMultiplier(e,"grain"),reason:"Trengte korn"});const a=((c=n.markets)==null?void 0:c[e.regionId])||n.market;a&&Object.entries(e.resources).forEach(([u,d])=>{if(u==="gold")return;const f=a[u];if(f&&d>10){const h=f.price;s.push({action:{type:"SELL",itemId:u,amount:Math.floor(d/2)},score:this.genome.weights.marketAggression*(h/20)*(d/50),reason:`Selger ${u} for gull`})}}),e.resources.gold>200&&s.push({action:{type:"CONTRIBUTE_TO_UPGRADE",buildingId:"great_hall"},score:this.genome.weights.promotionFocus*(e.resources.gold/1e3),reason:"Vil bli mektigere"});const l=s.filter(u=>{const d=typeof u.action=="string"?u.action:u.action.type,f=Dc[d];if(!f)return!0;if(i<(f.stamina||0))return!1;for(const[h,m]of Object.entries(f))if(h!=="stamina"&&(e.resources[h]||0)<m)return!1;return!0});return l.length===0?{action:"IDLE",score:0,reason:"Ingenting  gjre"}:(l.sort((u,d)=>d.score-u.score),l[0])}getNeedMultiplier(e,n){const s=e.resources[n]||0;return s<5?2:s<20?1.2:s>100?.5:1}}const fG=(t=0)=>({id:`genome_${Date.now()}_${Math.floor(Math.random()*1e3)}`,generation:t,weights:{gatherWood:Math.random()*2,gatherStone:Math.random()*2,gatherIron:Math.random()*2,gatherGrain:Math.random()*2,marketAggression:Math.random()*2,savingsFocus:Math.random()*2,upgradeFocus:Math.random()*2,hungerThreshold:.2+Math.random()*.6,restFocus:Math.random()*2,promotionFocus:Math.random()*2,contributionFocus:Math.random()*2}}),hG=(t,e=.1)=>{const n={...t.weights};return Object.keys(n).forEach(s=>{if(Math.random()<.2){const i=(Math.random()*2-1)*e;n[s]=Math.max(0,Math.min(2,n[s]+i))}}),{...t,id:`genome_${Date.now()}_${Math.floor(Math.random()*1e3)}`,weights:n,generation:t.generation+1,parents:[t.id],fitness:void 0}},Z1="eiriksbok_ai_top_genomes";class Yp{static calculateFitness(e,n){const s=(e.resources.gold||0)+Object.values(e.resources).reduce((l,c)=>l+(typeof c=="number"?c:0),0)*.5,r={PEASANT:1,SOLDIER:5,MERCHANT:10,BARON:50,KING:200}[e.role]||1,a=Math.max(1,(Date.now()-n)/6e4);return(s+r*100)/a}static saveTopGenomes(e){const n=[...e].filter(s=>s.fitness!==void 0).sort((s,i)=>(i.fitness||0)-(s.fitness||0)).slice(0,3);localStorage.setItem(Z1,JSON.stringify(n))}static getTopGenomes(){const e=localStorage.getItem(Z1);if(!e)return[];try{return JSON.parse(e)}catch{return[]}}static getNextGenerationGenome(){const e=this.getTopGenomes();if(e.length===0)return fG(0);const n=e[Math.floor(Math.random()*e.length)];return hG(n)}}const AA={CHOP:["AXE","OFF_HAND"],MINE:["PICKAXE","OFF_HAND"],QUARRY:["CHISEL","OFF_HAND"],WORK:["SCYTHE","OFF_HAND"],RAID:["MAIN_HAND","OFF_HAND","BODY","HEAD","FEET"],DEFEND:["MAIN_HAND","OFF_HAND","BODY","HEAD","FEET"],PATROL:["MAIN_HAND","OFF_HAND","BODY"],EXPLORE:["MAIN_HAND","OFF_HAND","BODY","HEAD","FEET"],CRAFT:["MAIN_HAND","AXE","PICKAXE","SCYTHE","HAMMER"],HUNT:["MAIN_HAND","BOW","TRAP"],FORAGE:["MAIN_HAND","TRAP"],GATHER_WOOL:["MAIN_HAND","OFF_HAND"],SAWMILL:["MAIN_HAND","OFF_HAND"],PLANT:["MAIN_HAND","OFF_HAND"],HARVEST:["SCYTHE","OFF_HAND","MAIN_HAND"]},Wp=(t,e)=>{const n=AA[e];return!n||!t.equipment?[]:n.map(s=>{var i;return(i=t.equipment)==null?void 0:i[s]}).filter(s=>{var i,r;if(!s)return!1;if((i=s.relevantActions)!=null&&i.includes(e))return!0;if(!s.relevantActions){const a=s.id.split("_").slice(0,2).join("_"),l=Oe[s.id]||Oe[a]||Object.values(Oe).find(c=>s.id.startsWith(c.id));return(r=l==null?void 0:l.relevantActions)!=null&&r.includes(e)?!0:!l||!l.relevantActions}return!1})},No=(t,e)=>{const n=AA[e];return!n||!t.equipment?[]:n.filter(s=>{var r,a,l;const i=(r=t.equipment)==null?void 0:r[s];if(!i)return!1;if((a=i.relevantActions)!=null&&a.includes(e))return!0;if(!i.relevantActions){const c=i.id.split("_").slice(0,2).join("_"),u=Oe[i.id]||Oe[c]||Object.values(Oe).find(d=>i.id.startsWith(d.id));return(l=u==null?void 0:u.relevantActions)!=null&&l.includes(e)?!0:!u||!u.relevantActions}return!1})},jA=(t,e,n="Spring",s="Clear",i=0)=>{var d;let r=typeof e=="string"?e:e.type,a=typeof e=="object"?{...e}:{};r.startsWith("REFINE_")&&!Fi[r]?(a.recipeId=r.replace("REFINE_","").toLowerCase(),r="REFINE"):r.startsWith("CRAFT_")&&!Bn[r]?(a.subType=r.replace("CRAFT_","").toLowerCase(),r="CRAFT"):Bn[r]&&(a.subType=r,r="CRAFT");const l=Wp(t,r);for(const f of l)if(f.durability<=0)return{success:!1,reason:`delagt: ${f.name}`};if(r==="GATHER_WOOL"&&l.length===0)return{success:!1,reason:"Du mangler Saks"};let c={};const u=Dc[r];if(u&&(c={...u}),r==="REFINE"||r==="CRAFT"){let f;r==="REFINE"&&(f=Fi[a.recipeId]),r==="CRAFT"&&(f=Bn[a.subType]),f&&(f.stamina!==void 0&&(c.stamina=f.stamina),f.input&&Object.entries(f.input).forEach(([h,m])=>{c[h]=(c[h]||0)+m}))}if(Object.keys(c).length>0){const f=Pn[n],h=js[s],m=(f==null?void 0:f.staminaMod)||1,v=(h==null?void 0:h.staminaMod)||1,y=Ls(i)==="NIGHT",b=y?1.2:1,g=c.stamina||0;if(r==="SLEEP"&&!y)return{success:!1,reason:"Du kan bare sove nr det er natt"};if(r==="PLANT"&&n==="Winter")return{success:!1,reason:"Bakken er frossen - du kan ikke s om vinteren"};if(a.locationId==="farm_well"||a.locationId==="well_water"||r==="GATHER_WATER"){const k=a.locationId||(r==="GATHER_WATER"?"well_water":null);if(k){const S=(d=t.activeProcesses)==null?void 0:d.find(N=>N.type==="WELL"&&N.locationId===k);if(S&&S.readyAt>Date.now())return{success:!1,reason:"Brnnen fyller seg med vann..."}}}const x=Math.ceil(g*m*v*b);if((t.status.stamina||0)<x)return{success:!1,reason:`Du mangler ${Math.ceil(x-(t.status.stamina||0))} energi`};const w={bread:"brd",gold:"gull",wood:"tre",flour:"mel",grain:"korn",iron_ingot:"jernbarrer",plank:"planker",stone:"stein",meat:"kjtt",honey:"honning",wool:"ull",iron_ore:"jernmalm",cloth:"stoff",stamina:"energi"};for(const[k,S]of Object.entries(c)){if(k==="stamina")continue;const N=t.resources[k]||0;if(N<S){const T=w[k]||k;return{success:!1,reason:`Du mangler ${S-N} ${T}`}}}}return{success:!0}},RA=(t,e="Spring",n="Clear",s=0)=>{let i=typeof t=="string"?t:t.type,r=typeof t=="object"?{...t}:{};i.startsWith("REFINE_")&&!Fi[i]?(r.recipeId=i.replace("REFINE_","").toLowerCase(),i="REFINE"):i.startsWith("CRAFT_")&&!Bn[i]?(r.subType=i.replace("CRAFT_","").toLowerCase(),i="CRAFT"):Bn[i]&&(r.subType=i,i="CRAFT");let a={};const l=Dc[i];if(l&&(a={...l}),i==="REFINE"||i==="CRAFT"){let d;i==="REFINE"&&(d=Fi[r.recipeId]),i==="CRAFT"&&(d=Bn[r.subType]),d&&(d.stamina!==void 0&&(a.stamina=d.stamina),d.input&&Object.entries(d.input).forEach(([f,h])=>{a[f]=(a[f]||0)+h}))}if(Object.keys(a).length===0)return null;const c=[];if(a.stamina){const d=Pn[e],f=js[n],m=Ls(s)==="NIGHT"?1.2:1,v=((d==null?void 0:d.staminaMod)||1)*((f==null?void 0:f.staminaMod)||1)*m,y=Math.ceil(a.stamina*v);let b="-";a.stamina<0&&(b="+"),c.push(`${b}${Math.abs(y)}`)}const u={bread:"",gold:"",wood:"",flour:"",grain:"",iron_ingot:"",plank:"",stone:"",meat:"",honey:"",wool:"",iron_ore:"",cloth:""};for(const[d,f]of Object.entries(a)){if(d==="stamina")continue;const h=f,m=u[d]||d;c.push(`-${h}${m}`)}return c.join(" ")},mG=(t,e,n)=>{t.activeProcesses||(t.activeProcesses=[]),t.activeProcesses.push({id:`cd_${Date.now()}_${Math.random().toString(36).substr(2,5)}`,type:"COOLDOWN",locationId:e,itemId:"cooldown",notified:!1,startedAt:Date.now(),readyAt:Date.now()+n,duration:n})},pG=t=>{const{actor:e,action:n,localResult:s}=t,i=n.processId;if(!e.activeProcesses)return s.success=!1,s.message="Ingen aktive prosesser.",!1;const r=e.activeProcesses.find(l=>l.id===i);if(!r)return s.success=!1,s.message="Fant ikke avlingen (kanskje den allerede er ferdig?).",!1;if(r.type!=="CROP")return s.success=!1,s.message="Kan bare vedlikeholde avlinger.",!1;if(r.maintainCount===void 0&&(r.maintainCount=0),r.yieldBonus===void 0&&(r.yieldBonus=0),r.maintainCount>=3)return s.success=!1,s.message="Denne keren er allerede perfekt vedlikeholdt.",!1;r.maintainCount+=1,r.yieldBonus+=.05;const a=n.subType==="WEED"?"Lukte ugress":"Skremte vekk krka";return s.message=`${a}! (+5% Utbytte).`,!0},gG=t=>{var f;const{actor:e,action:n,localResult:s,timestamp:i}=t,r=n.cropId||"grain",a=Ax[r];if(!a)return s.success=!1,s.message=`Ukjent grde: ${r}`,!1;if((((f=t.room.world)==null?void 0:f.season)||"Spring")==="Winter")return s.success=!1,s.message="Du kan ikke s om vinteren - bakken er frossen.",!1;e.activeProcesses||(e.activeProcesses=[]);const c=n.locationId||"grain_fields",u=e.activeProcesses.find(h=>h.type==="CROP"&&h.locationId===c);if(u){const h=Date.now();if(u.readyAt<=h){const m=e.activeProcesses.indexOf(u);m>-1&&e.activeProcesses.splice(m,1)}else return s.success=!1,s.message="Det vokser allerede noe her.",!1}const d={id:Math.random().toString(36).substr(2,9),type:"CROP",itemId:r,locationId:c,startedAt:Date.now(),duration:a.duration,readyAt:Date.now()+a.duration,notified:!1};return e.activeProcesses.push(d),s.message=`Sdde ${a.label}. Klar om ${Math.ceil(a.duration/6e4)} min.`,!0},xG=t=>{var x,w,k;const{actor:e,action:n,localResult:s,trackXp:i,damageTool:r,room:a}=t,l=Date.now(),c=n.locationId||"grain_fields",u=(x=e.activeProcesses)==null?void 0:x.findIndex(S=>S.locationId===c&&S.readyAt<=l);if(u===void 0||u===-1)return s.success=!1,s.message="Ingenting er klart til innhsting her.",!1;const d=e.activeProcesses[u];let f="",h=0,m="",v=0,y="FARMING";const b=Ax[d.itemId],g=Fi[d.itemId];if(b){m=b.label,f=b.yieldResource;const S=n.performance||.5,N=b.minYield+(b.maxYield-b.minYield)*S,T=((w=a.world)==null?void 0:w.season)||"Spring",E=Pn[T],j=1+(d.yieldBonus||0);h=Math.ceil(N*((E==null?void 0:E.yieldMod)||1)*j),v=Math.ceil(b.xp*(1+S))}else if(g){m=g.label,f=g.outputResource;const S=((k=g.output)==null?void 0:k.amount)||g.outputAmount||1,N=n.performance||.5;h=ms(e,S,"CRAFTING",{performance:N,isRefining:!0}),v=g.xp||10,y=g.skill||"CRAFTING"}else return s.success=!1,s.message="Ugyldig prosess-data.",!1;return e.activeProcesses.filter(S=>S.locationId===c&&S.readyAt<=l).forEach(S=>{const N=e.activeProcesses.indexOf(S);N>-1&&e.activeProcesses.splice(N,1)}),No(e,"WORK").forEach(S=>{r(S,ee.DURABILITY.LOSS_WORK)}),e.resources[f]||(e.resources[f]=0),e.resources[f]+=h,s.utbytte.push({resource:f,amount:h}),s.message=`Hstet ${h} ${m}`,i(y,v),!0},bG=t=>{var b,g,p,x,w,k,S;const{actor:e,room:n,action:s,localResult:i,trackXp:r,damageTool:a}=t,l=((b=n.world)==null?void 0:b.activeLaws)||[];No(e,"WORK").forEach(N=>{a(N,ee.DURABILITY.LOSS_WORK)});let c=1;l.includes("conscription")&&(c=.8);const u=ee.YIELD.WORK_GRAIN+((g=e.upgrades)!=null&&g.includes("iron_plow")?5:0),d=((p=n.world)==null?void 0:p.season)||"Spring",f=((x=n.world)==null?void 0:x.weather)||"Clear",h=Pn[d],m=js[f],v=s.performance||.5,y=ms(e,u,"FARMING",{season:(h==null?void 0:h.yieldMod)||1,weather:(m==null?void 0:m.yieldMod)||1,law:c,performance:v,actionType:"WORK",regionId:e.regionId});if(e.resources.grain=(e.resources.grain||0)+y,i.utbytte.push({resource:"grain",amount:y}),i.message=`Hstet ${y} korn`,r("FARMING",Math.ceil(Mc.WORK.xp*(1+v))),Math.random()<ee.LUCKY_DROP.CHANCE+(((S=(k=(w=e.equipment)==null?void 0:w.HEAD)==null?void 0:k.stats)==null?void 0:S.luckBonus)||0)){const N=Math.ceil(y*.5),T=y+N;e.resources.grain+=N,i.utbytte.push({resource:"grain",amount:N,bonus:!0}),i.message=`Innhstet ${T} korn! (inkl. ${N} flaks)`}return!0},vG=t=>{var f,h,m,v;const{actor:e,room:n,action:s,localResult:i,trackXp:r,damageTool:a}=t,l=((f=n.world)==null?void 0:f.season)||"Spring";No(e,"CHOP").forEach(y=>{a(y,ee.DURABILITY.LOSS_WORK)});let c=ee.YIELD.CHOP_WOOD;l==="Summer"&&(c+=ee.YIELD.SUMMER_WOOD_BONUS);const u=s.performance||.5,d=ms(e,c,"WOODCUTTING",{performance:u,actionType:"CHOP",regionId:e.regionId});if(e.resources.wood=(e.resources.wood||0)+d,i.utbytte.push({resource:"wood",amount:d}),i.message=`Felte ${d} ved`,r("WOODCUTTING",Math.ceil(Mc.CHOP.xp*(1+u))),Math.random()<ee.LUCKY_DROP.CHANCE+(((v=(m=(h=e.equipment)==null?void 0:h.HEAD)==null?void 0:m.stats)==null?void 0:v.luckBonus)||0)){const y=Math.ceil(d*.5),b=d+y;e.resources.wood+=y,i.utbytte.push({resource:"wood",amount:y,bonus:!0}),i.message=`Felte ${b} ved! (inkl. ${y} flaks)`}return!0},e_=t=>{const{actor:e,action:n,localResult:s,trackXp:i,damageTool:r}=t,a=typeof n=="string"?n:n.type;No(e,a).forEach(h=>{r(h,ee.DURABILITY.LOSS_WORK)});const l="MINING",c=a==="MINE"?ee.YIELD.MINE_ORE:ee.YIELD.QUARRY_STONE,u=a==="MINE"?"iron_ore":"stone",d=n.performance||.5,f=ms(e,c,l,{performance:d,actionType:a,regionId:e.regionId});return e.resources[u]=(e.resources[u]||0)+f,s.utbytte.push({resource:u,amount:f}),s.message=a==="MINE"?`Utvant ${f} jernmalm`:`Hogde ${f} stein`,i(l,Math.ceil(Mc.WORK.xp*(1+d))),!0},yG=t=>{const{actor:e,action:n,localResult:s,trackXp:i,damageTool:r}=t;No(e,"FORAGE").forEach(u=>{r(u,1)});const a=ee.YIELD.FORAGE_BREAD,l=n.performance||.5,c=ms(e,a,"FARMING",{performance:l,actionType:"FORAGE"});return e.resources||(e.resources={}),e.resources.bread=(e.resources.bread||0)+c,s.utbytte.push({resource:"bread",amount:c}),s.message=`Sanket ${c} ndproviant (brd/br)`,i("FARMING",Math.ceil(Mc.FORAGE.xp*(1+l))),!0},_G=t=>{const{actor:e,action:n,localResult:s,trackXp:i,damageTool:r}=t;No(e,"HUNT").forEach(u=>{r(u,2)});const a=8,l=n.performance||.5,c=ms(e,a,"COMBAT",{performance:l,actionType:"HUNT"});return e.resources.meat=(e.resources.meat||0)+c,s.utbytte.push({resource:"meat",amount:c}),s.message=`Felte bytte og fikk ${c} kjtt`,i("COMBAT",Math.ceil(15*(1+l))),!0},wG=t=>{const{actor:e,action:n,localResult:s,trackXp:i}=t,r=6,a=n.performance||.5,l=ms(e,r,"FARMING",{performance:a,actionType:"GATHER_WOOL",requiresTool:!0});return l===0?(s.message="Du trenger en Saks for  klippe sauene!",!1):(e.resources.wool=(e.resources.wool||0)+l,s.utbytte.push({resource:"wool",amount:l}),s.message=`Klippet sauer og fikk ${l} ull`,i("FARMING",Math.ceil(10*(1+a))),!0)},kG=t=>{const{actor:e,action:n,localResult:s,trackXp:i}=t,r=n.locationId||"beehives";e.activeProcesses||(e.activeProcesses=[]);const a=e.activeProcesses.find(d=>d.type==="HIVE"&&d.locationId===r);if(a){if(a.readyAt>Date.now())return s.success=!1,s.message="Biene trenger hvile fr de kan lage mer honning.",!1;e.activeProcesses=e.activeProcesses.filter(d=>d.id!==a.id)}const l=4,c=n.performance||.5,u=ms(e,l,"FARMING",{performance:c,actionType:"GATHER_HONEY"});return e.resources.honey=(e.resources.honey||0)+u,s.utbytte.push({resource:"honey",amount:u}),s.message=`Hentet ${u} honning fra bikubene`,i("FARMING",Math.ceil(12*(1+c))),e.activeProcesses.push({id:"hive_"+Date.now(),type:"HIVE",itemId:"honey",locationId:r,startedAt:Date.now(),duration:3e5,readyAt:Date.now()+3e5,notified:!1}),!0},NG=t=>{const{actor:e,localResult:n}=t,s=5;if((e.resources.grain||0)<s)return n.success=!1,n.message=`Mangler korn. Trenger ${s} korn for  mate hnene.`,!1;if(e.activeProcesses||(e.activeProcesses=[]),e.activeProcesses.find(l=>l.type==="COOP"&&l.locationId==="chicken_coop"&&l.readyAt>Date.now()))return n.success=!1,n.message="Hnene har allerede mat.",!1;e.resources.grain-=s,n.utbytte.push({resource:"grain",amount:-s});const r=24e4,a={id:Math.random().toString(36).substr(2,9),type:"COOP",itemId:"egg",locationId:"chicken_coop",startedAt:Date.now(),duration:r,readyAt:Date.now()+r,notified:!1};return e.activeProcesses.push(a),n.message="Matet hnene. Egg klare om 4 minutter.",!0},SG=t=>{var l;const{actor:e,localResult:n,trackXp:s}=t,i=Date.now(),r=(l=e.activeProcesses)==null?void 0:l.findIndex(c=>c.type==="COOP"&&c.locationId==="chicken_coop"&&c.readyAt<=i);if(r===void 0||r===-1)return n.success=!1,n.message="Ingen egg  hente enn.",!1;e.activeProcesses.splice(r,1);const a=Math.floor(Math.random()*3)+3;return e.resources.egg||(e.resources.egg=0),e.resources.egg+=a,n.utbytte.push({resource:"egg",amount:a}),n.message=`Samlet ${a} egg.`,s("FARMING",15),!0},EG=t=>{var c,u,d,f,h,m,v;const{actor:e,room:n,action:s,localResult:i,trackXp:r}=t,a=s.subType,l=Bn[a];if(l){if((((f=(d=(u=(c=n.world)==null?void 0:c.settlement)==null?void 0:u.buildings)==null?void 0:d[l.buildingId])==null?void 0:f.level)||1)<l.level)return i.success=!1,i.message=`Mangler bygningsniv ${l.level} for  lage dette.`,!1;let b=!0;if(Object.entries(l.input).forEach(([g,p])=>{e.resources[g]<p&&(b=!1)}),b){Object.entries(l.input).forEach(([x,w])=>{e.resources[x]-=w});const g=l.outputItemId;if(Rt[g]||g==="omelette"){const x=l.outputAmount||1;e.resources[g]=(e.resources[g]||0)+x,i.utbytte.push({resource:g,amount:x});const w=Oe[g];i.message=`Laget ${x}x ${(w==null?void 0:w.name)||g}!`,r("CRAFTING",25*l.level),Qn(n.pin,"crafted",g,x)}else{const x=Oe[g];if(x){const w={...x,id:`${x.id}_${Date.now()}_${Math.floor(Math.random()*1e3)}`};e.inventory||(e.inventory=[]),e.inventory.push(w),i.utbytte.push({resource:g,amount:1}),i.message=`Smidde ${w.name}!`,r("CRAFTING",25*l.level),Qn(n.pin,"crafted",g,1)}}if(l.stamina){const x=((h=n.world)==null?void 0:h.season)||"Spring",w=((m=n.world)==null?void 0:m.weather)||"Clear",k=zn(l.stamina,x,w,e.activeBuffs,((v=n.world)==null?void 0:v.gameTick)||0);(e.status.stamina||0)<k?(i.success=!1,i.message=`For lite stamina! Krever ${k}`):e.status.stamina-=k}}else return i.success=!1,i.message="Mangler ressurser for  smi.",!1}return!0},Xr=t=>{var c,u,d,f,h,m,v,y,b;const{actor:e,room:n,action:s,localResult:i,trackXp:r}=t,a=s.recipeId,l=Fi[a];if(l){const g=((f=(d=(u=(c=n.world)==null?void 0:c.settlement)==null?void 0:u.buildings)==null?void 0:d[l.buildingId])==null?void 0:f.level)||1;if(l.requiredLevel&&g<l.requiredLevel)return i.success=!1,i.message=`Utvidelse kreves: ${l.buildingId} m vre Niv ${l.requiredLevel}.`,!1;let p=!0;Object.entries(l.input).forEach(([N,T])=>{e.resources[N]<T&&(p=!1)});const x=((h=n.world)==null?void 0:h.season)||"Spring",w=((m=n.world)==null?void 0:m.weather)||"Clear",k=l.stamina||0,S=zn(k,x,w,e.activeBuffs,((v=n.world)==null?void 0:v.gameTick)||0);if((e.status.stamina||0)<S)return p=!1,i.message=`For lite stamina! Krever ${S}`,i.success=!1,!1;if(p){let N=s.performance||0;const E=Math.max(0,g-(l.requiredLevel||1))*.25,j=N*.5,R=1-Math.min(.9,E+j),I=l.duration?Math.max(l.duration*.1,l.duration*R):0;if(l.duration){e.activeProcesses||(e.activeProcesses=[]);const U=s.locationId||l.buildingId;if(e.activeProcesses.find(H=>H.locationId===U))return i.success=!1,i.message="Det pgr allerede en prosess her.",!1;Object.entries(l.input).forEach(([H,$])=>{e.resources[H]-=$}),e.status.stamina-=S;const J={id:Math.random().toString(36).substr(2,9),type:a==="flour"?"MILL":"CRAFT",itemId:a,locationId:U,startedAt:Date.now(),duration:I,readyAt:Date.now()+I,notified:!1};return e.activeProcesses.push(J),i.message=`Startet ${l.label.toLowerCase()}. Ferdig om ${Math.ceil(I/6e4)} minutter (-${S}).`,!0}Object.entries(l.input).forEach(([U,K])=>{e.resources[U]-=K}),e.status.stamina-=S,N=s.performance!==void 0?s.performance:.5;const V=((y=l.output)==null?void 0:y.amount)||l.outputAmount||1,O=1+Math.max(0,g-(l.requiredLevel||1))*.2,D=ms(e,V,"CRAFTING",{performance:N,isRefining:!0,upgrades:O}),M=e.resources[l.outputResource]||0;e.resources[l.outputResource]=M+D;const C=((b=Rt[l.outputResource])==null?void 0:b.label)||l.outputResource;i.utbytte.push({resource:l.outputResource,amount:D}),i.message=`Produserte ${D} ${C}`,r("CRAFTING",ee.SKILLS.REFINING_XP),Qn(n.pin,"crafted",l.outputResource,D)}else return i.success=!1,i.message="Mangler ressurser til raffinering.",!1}return!0},TG=t=>{var y,b;const{actor:e,action:n,localResult:s}=t,{targetSlot:i,itemUid:r,buildingId:a}=n;if(!a||!Bp[a])return s.success=!1,s.message="Ugyldig reparasjonsstasjon.",!1;const l=Bp[a];let c,u="gjenstanden";if(i?c=e.equipment[i]:r&&(c=(y=e.inventory)==null?void 0:y.find(g=>g.id===r)),!c)return s.success=!1,s.message="Fant ikke gjenstanden som skulle repareres.",!1;if(u=c.name,!l.slots.includes(c.type))return s.success=!1,s.message=`Denne stasjonen kan ikke reparere ${u}.`,!1;if(c.durability>=c.maxDurability)return s.success=!1,s.message=`${u} er allerede i perfekt stand.`,!1;const d=l.goldCost,f=1,h=l.material,m=(e.resources.gold||0)>=d,v=(e.resources[h]||0)>=f;if(m&&v){e.resources.gold-=d,e.resources[h]-=f;const g=ee.DURABILITY.REPAIR_AMOUNT,p=c.durability;c.durability=Math.min(c.maxDurability,c.durability+g);const x=c.durability-p;s.durability.push({slot:i||c.type,item:c.name,amount:x}),s.message=`Reparerte ${c.name} (+${x} holdbarhet).`}else{s.success=!1;const g=((b=Rt[h])==null?void 0:b.label)||h;return s.message=`Mangler ${m?"":`${d} gull`}${!m&&!v?" og ":""}${v?"":`${f} ${g}`}.`,!1}return!0},AG=t=>{const{actor:e,action:n,localResult:s}=t,{itemId:i,slot:r}=n;e.inventory&&!Array.isArray(e.inventory)&&(e.inventory=Object.values(e.inventory)),e.inventory||(e.inventory=[]);const a=e.inventory.findIndex(l=>l.id===i);if(a!==-1){const l=e.inventory[a],c=e.equipment[r];e.inventory.splice(a,1),e.equipment[r]=l,c&&e.inventory.push(c),s.message=`Utstyrte ${l.name}`}return!0},jG=t=>{const{actor:e,action:n,localResult:s}=t,{slot:i}=n,r=e.equipment[i];return r&&(e.equipment[i]=null,e.inventory&&!Array.isArray(e.inventory)&&(e.inventory=Object.values(e.inventory)),e.inventory||(e.inventory=[]),e.inventory.push(r),s.message=`Tok av ${r.name}`),!0},RG=t=>{const{actor:e,action:n,localResult:s}=t,{itemId:i}=n;e.inventory&&!Array.isArray(e.inventory)&&(e.inventory=Object.values(e.inventory)),e.inventory||(e.inventory=[]);const r=e.inventory.findIndex(a=>a.id===i);if(r!==-1){const a=e.inventory[r];return e.inventory.splice(r,1),s.message=`Slettet ${a.name}`,!0}return s.message="Fant ikke gjenstanden som skulle slettes.",!1},IG=t=>{const{actor:e,room:n,action:s,localResult:i}=t;if(e.role!=="BARON")return i.success=!1,i.message="Kun Baroner kan kreve inn lokal skatt.",!1;const r=e.regionId,a=n.regions[r];if(!a)return!1;const l=n.world.season,c=n.world.year;if(a.taxHistory||(a.taxHistory=[]),a.lastTaxCollection&&a.lastTaxCollection.year===c&&a.lastTaxCollection.season===l)return i.success=!1,i.message=`Du har allerede krevd inn skatt for ${l} ${c}.`,!1;const u=s.taxRate!==void 0?s.taxRate:a.taxRate||10,d=u/100;let f=0,h=0,m=0,v=0,y=0;const b=(e.regionId||"").trim().toLowerCase();Object.values(n.players).forEach(x=>{var S,N,T;if(!x||x.id===e.id)return;const w=(x.regionId||"").trim().toLowerCase();if(x.role==="PEASANT"&&(w===b||w.includes(b)||b.includes(w))){x.resources||(x.resources={gold:0,grain:0});const E=Number(x.resources.gold??x.gold??x.wealth??((S=x.stats)==null?void 0:S.gold)??((T=(N=x.inventory)==null?void 0:N.find(V=>V.id==="gold"))==null?void 0:T.amount)??0),j=Number(x.resources.grain??0),R=E*d,I=j*d;if(R>0){const V=Math.floor(R);x.resources.gold!==void 0?x.resources.gold-=V:x.gold!==void 0&&(x.gold-=V),v+=R}if(I>0){const V=Math.floor(I);x.resources.grain-=V,y+=I}(R>0||I>0)&&m++}}),f=Math.floor(v),h=Math.floor(y),e.resources||(e.resources={gold:0,grain:0}),e.resources.gold=(e.resources.gold||0)+f,e.resources.grain=(e.resources.grain||0)+h,a.taxRate=u,a.lastTaxCollection={year:c,season:l};const g={year:c,season:l,amountGold:f,amountGrain:h,rate:u,timestamp:Date.now()};a.taxHistory.push(g),a.taxHistory.length>10&&a.taxHistory.shift();const p=Math.max(0,5+Math.floor((u-10)/2));return e.status.legitimacy=Math.max(0,(e.status.legitimacy||100)-p),f>0||h>0?(i.utbytte.push({resource:"gold",amount:f}),i.utbytte.push({resource:"grain",amount:h}),i.message=`Skatteinnkreving (${u}%): ${f}g og ${h} korn fra ${m} bnder. (-${p} Legitimet)`):i.message=`Ingen skatt  hente (sats: ${u}%). (-${p} Legitimet)`,!0},CG=t=>{const{actor:e,localResult:n}=t;if(e.role!=="BARON"&&e.role!=="KING")return n.success=!1,!1;const s=5,i=10;if((e.resources.gold||0)>=s&&(e.resources.grain||0)>=i)e.resources.gold-=s,e.resources.grain-=i,e.resources.manpower=(e.resources.manpower||0)+10,n.utbytte.push({resource:"manpower",amount:10}),n.message="Mobiliserte tropper (+10 Manpower).";else return n.success=!1,n.message="Mangler ressurser for  mobilisere.",!1;return!0},OG=t=>{const{actor:e,room:n,localResult:s}=t;if(e.role!=="KING")return!1;s.message="UTSTEDTE KONGELIG DEKRET: Ekstraskatt!";let i=0;return Object.values(n.players).forEach(r=>{r.role==="BARON"&&r.resources.gold>=20&&(r.resources.gold-=20,i+=20)}),e.resources.gold=(e.resources.gold||0)+i,s.utbytte.push({resource:"gold",amount:i}),!0},Jh=t=>{const{actor:e,room:n,action:s,localResult:i}=t,{buildingId:r,resource:a,amount:l}=s,c=Kt[r];if(!c)return i.success=!1,i.message=`Fant ikke bygning med ID: ${r}`,!1;const u=r==="farm_house";let d;if(u)e.buildings||(e.buildings={}),e.buildings[r]||(e.buildings[r]={level:1,progress:{}}),d=e.buildings[r];else{if(n.world||(n.world={season:"Spring",weather:"Clear",year:1066,gameTick:0,lastTickAt:Date.now(),taxRateDetails:{kingTax:.1},settlement:{buildings:{}}}),n.world.settlement||(n.world.settlement={buildings:{}}),n.world.settlement.buildings||(n.world.settlement.buildings={}),!n.world.settlement.buildings[r]){const S=["manor_ost","manor_vest","throne_room"].includes(r)?0:1;n.world.settlement.buildings[r]={id:r,level:S,progress:{},contributions:{}}}d=n.world.settlement.buildings[r]}if(d.progress||(d.progress={}),e.resources||(e.resources=JSON.parse(JSON.stringify(Lt.PEASANT))),!d.level&&d.level!==0){const k=["manor_ost","manor_vest","throne_room"].includes(r);d.level=k?0:1}const f=d.level+1,h=c.levels[f];if(!h)return i.success=!1,i.message="Maksimalt niv ndd.",!1;const v=(h.requirements||{})[a]||0,y=d.progress[a]||0,b=v-y;let g=!0;if(Object.entries(h.requirements).forEach(([k,S])=>{(d.progress[k]||0)<S&&(g=!1)}),b<=0&&!g)return i.success=!1,i.message="Ressurskravet er allerede oppfylt.",!1;const p=e.resources[a]||0,x=Math.min(l,b,p);if(x<=0)return i.success=!1,i.message=`Kan ikke bidra 0 (Har: ${p}, Trenger: ${b}, Bud: ${l})`,!1;if(e.resources[a]=p-x,d.progress[a]=y+x,!u){d.contributions||(d.contributions={}),d.contributions[e.id]||(d.contributions[e.id]={name:e.name,resources:{}});const k=d.contributions[e.id].resources;k[a]=(k[a]||0)+x}i.message=`Bidro med ${x} ${a} til ${c.name}.`,i.utbytte.push({resource:a,amount:-x});let w=!0;if(Object.entries(h.requirements).forEach(([k,S])=>{(d.progress[k]||0)<S&&(w=!1)}),w){if(d.level=f,d.progress={},u||(d.contributions={}),["watchtower","manor_ost","manor_vest"].includes(c.id)){let k="capital";if(c.id==="manor_ost"&&(k="region_ost"),c.id==="manor_vest"&&(k="region_vest"),n.regions&&n.regions[k]){const S=n.regions[k].fortification||{hp:1e3,maxHp:1e3,level:1};S.maxHp+=500,S.hp+=500,S.level=Math.max(S.level,f),n.regions[k].fortification=S,i.message+="  Murene forsterket! (+500 HP)"}}i.message+=`  NYTT NIV: ${c.name} ndde Niv ${f}!`}return!0},MG=t=>{var c;const{actor:e,room:n,action:s,localResult:i}=t,r=typeof s=="string"?s:s.type,a=s.buildingId||r.replace("UPGRADE_BUILDING_",""),l=Kt[a];if(l){n.world.settlement||(n.world.settlement={buildings:{}});const d=(((c=n.world.settlement.buildings[a])==null?void 0:c.level)||1)+1,f=l.levels[d];if(f){let h=!0;if(Object.entries(f.requirements||{}).forEach(([m,v])=>{(e.resources[m]||0)<v&&(h=!1)}),h){if(Object.entries(f.requirements||{}).forEach(([m,v])=>{e.resources[m]-=v}),n.world.settlement.buildings[a]||(n.world.settlement.buildings[a]={id:a,level:1,progress:{},contributions:{}}),n.world.settlement.buildings[a].level=d,["watchtower","manor_ost","manor_vest"].includes(a)){let m="capital";if(a==="manor_ost"&&(m="region_ost"),a==="manor_vest"&&(m="region_vest"),n.regions&&n.regions[m]){const v=n.regions[m].fortification||{hp:1e3,maxHp:1e3,level:1};v.maxHp+=500,v.hp+=500,v.level=Math.max(v.level,d),n.regions[m].fortification=v}}i.message=`Oppgraderte ${l.name} til Niv ${d}!`}else return i.success=!1,i.message="Mangler ressurser for oppgradering.",!1}}return!0},DG=t=>{var l;const{actor:e,action:n,localResult:s}=t,i=n.upgradeId,r=e.role,a=Tx[r];if(a){const c=a.find(u=>u.id===i);if(c&&!((l=e.upgrades)!=null&&l.includes(i))){let u=!0;if(Object.entries(c.cost).forEach(([d,f])=>{e.resources[d]<f&&(u=!1)}),u)Object.entries(c.cost).forEach(([d,f])=>{e.resources[d]-=f}),e.upgrades||(e.upgrades=[]),e.upgrades.push(i),s.message=`Oppgradering fullfrt: ${c.name}`;else return s.success=!1,s.message="Har ikke rd til oppgradering.",!1}}return!0},LG=t=>{var c,u;const{actor:e,action:n,localResult:s}=t,i=n.targetRole;if(!i)return s.success=!1,s.message="Ingen rolle spesifisert.",!1;if(e.role===i)return s.success=!1,s.message=`Du er allerede ${i}.`,!1;if(["SOLDIER","MERCHANT","BARON","KING"].includes(i)&&i!=="BARON"&&i!=="KING"){const d=(c=e.roleStats)==null?void 0:c.PEASANT,f=(d==null?void 0:d.level)||(e.role==="PEASANT"?e.stats.level:1),h=ee.CAREERS[i];if(h&&f<h.LEVEL_REQ)return s.success=!1,s.message=`Du m vre Bonde Niv ${h.LEVEL_REQ} for  bli ${i}. (N: ${f})`,!1}const a=((u=ee.CAREERS[i])==null?void 0:u.COST)||0;if((e.resources.gold||0)<a)return s.success=!1,s.message=`Det koster ${a}g  bli ${i}. (Har: ${e.resources.gold}g)`,!1;e.roleStats||(e.roleStats={}),e.roleStats[e.role]={level:e.stats.level,xp:e.stats.xp,skills:JSON.parse(JSON.stringify(e.skills))},a>0&&(e.resources.gold-=a,s.utbytte.push({resource:"gold",amount:-a}));const l=e.roleStats[i];return l?(e.stats.level=l.level,e.stats.xp=l.xp,e.skills=l.skills):(e.stats.level=1,e.stats.xp=0,e.skills=JSON.parse(JSON.stringify(Hn[i]||Hn.PEASANT))),e.role=i,s.message=`Gratulerer! Du er n ${i}.`,!0},PG=.15,t_=15,BG=t=>{var u,d,f;const{actor:e,room:n,localResult:s,action:i}=t,r=((u=i.payload)==null?void 0:u.targetRegionId)||e.regionId;if(!r||r==="capital"||r==="unassigned")return s.success=!1,s.message="Du m angi en gyldig region for  starte beleiring.",!1;if(!n.regions)return console.error("CRITICAL: room.regions is undefined in handleStartSiege",n),s.success=!1,s.message="Systemfeil: Kunne ikke hente regiondata.",!1;const a=n.regions[r];if(!a)return s.success=!1,s.message="Regionen eksisterer ikke.",!1;if(a.activeSiege)return s.success=!1,s.message="Beleiring pgr allerede!",!1;if(a.rulerName===e.name)return s.success=!1,s.message="Du kan ikke beleire ditt eget slott!",!1;const l=((d=e.resources)==null?void 0:d.swords)||0;if(l<500)return s.success=!1,s.message=`Du trenger minst 500 sverd i forsyninger for  starte en beleiring! (Eier: ${l})`,!1;const c=((f=a.fortification)==null?void 0:f.hp)||1e3;return a.activeSiege={phase:"BREACH",startedAt:Date.now(),lastTick:Date.now(),attackers:{[e.id]:{lane:1,hp:100,name:e.name}},defenders:{},gateHp:c,maxGateHp:c},s.message=`Beleiringen av ${a.name} har startet!`,!0},UG=t=>{var m,v,y;const{actor:e,room:n,localResult:s,action:i}=t,r=((m=i.payload)==null?void 0:m.targetRegionId)||e.regionId;if(!r||!((v=n.regions[r])!=null&&v.activeSiege))return s.success=!1,s.message="Ingen aktiv beleiring her.",!1;const a=n.regions[r].activeSiege,l=a.attackers||{},c=a.defenders||{};if(l[e.id]||c[e.id])return s.message="Du deltar allerede.",!1;const u=e.regionId===r,d=["BARON","KING"].includes(e.role);if(!u&&!d)return s.success=!1,s.message="Bare innbyggere eller adelen kan delta i krigfring i dette omrdet.",!1;const f=((y=i.payload)==null?void 0:y.side)==="DEFENDER",h={damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0};return f?(a.defenders||(a.defenders={}),a.defenders[e.id]={lane:1,hp:100,name:e.name,stats:h},s.message="Du forsvarer murene!"):(a.attackers||(a.attackers={}),a.attackers[e.id]={lane:1,hp:100,name:e.name,stats:h},s.message="Du har sluttet deg til beleiringen!"),!0},HG=t=>{var d,f,h,m,v,y,b,g,p,x,w,k,S,N,T;const{actor:e,room:n,action:s,localResult:i}=t,r=((d=s.payload)==null?void 0:d.targetRegionId)||e.regionId;if(!r||!((f=n.regions[r])!=null&&f.activeSiege))return i.success=!1,i.message="Ingen aktiv beleiring funnet i dette omrdet.",!1;const a=n.regions[r].activeSiege,l=a.attackers||{},c=a.defenders||{},u=l[e.id]||c[e.id];if(!u)return i.message="Du m vre deltaker i beleiringen (angriper eller forsvarer) for  delta i kapplpet.",!1;if(a.phase==="BREACH"){if(s.subType==="ATTACK_GATE"){const j=(((h=e.resources)==null?void 0:h.swords)||0)>0,R=j?25:2;return j&&(e.resources.swords-=1),a.gateHp=Math.max(0,(a.gateHp||1e3)-R),u.stats=u.stats||{damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0},u.stats.damageDealt+=R,i.message=j?` Du hugger ls p porten! (-${R} HP). Du har ${e.resources.swords} sverd igjen.`:` Du slr p porten med nevene... det gjr nesten ingen skade. (-${R} HP)`,j&&i.utbytte.push({resource:"swords",amount:-1}),a.gateHp<=0&&(a.phase="COURTYARD",a.gateHp=0,i.message="PORTEN ER KNUST! Storm borggrden!"),!0}if(s.subType==="SHIELD_WALL")return!0}if(a.phase==="COURTYARD"){const E=a;if(E.bossHp||(E.bossHp=1e4,E.maxBossHp=1e4,E.bossTargetLane=1,E.nextBossAttack=Date.now()+5e3),s.subType==="MOVE_LANE"){const I=(m=s.payload)==null?void 0:m.lane;I>=0&&I<=2&&(u.lane=I,i.message=`Forflyttet til bane ${I===0?"Venstre":I===1?"Midten":"Hyre"}.`)}s.subType==="ATTACK_BOSS"&&(E.bossHp-=25,u.stats=u.stats||{damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0},u.stats.damageDealt+=25,i.message=`Angrep Bossen! HP: ${E.bossHp}`);const j=((y=(v=n.regions[r])==null?void 0:v.fortification)==null?void 0:y.level)||1,R=PG+j*.05;if(Date.now()>E.nextBossAttack){const I=E.bossTargetLane,V=u.lane===I,B=Math.random()<R;if(V||B){const O=(V?20:0)+(B?t_:0),D=((b=e.resources)==null?void 0:b.armor)||0,M=Math.min(D,O),C=O-M;M>0&&(e.resources.armor-=M,i.utbytte.push({resource:"armor",amount:-M})),u.hp-=C,u.stats=u.stats||{damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0},u.stats.damageTaken+=O,V&&(i.message+=M>=20?"  Rustningen din tok sttet fra bossen!":"  AU! Bossen traff deg!"),B&&(i.message+=M>=t_?"  Rustningen din stoppet pilene!":`  Piler fra murene traff deg! (-${C} HP)`),C>0&&M>0&&(i.message+=` (Rustningen absorberte ${M} skade)`)}E.bossTargetLane=Math.floor(Math.random()*3),E.nextBossAttack=Date.now()+5e3}if(E.bossHp<=0){a.phase="THRONE_ROOM";const I=n.regions[r].rulerId,V=n.players[I||""],B=V&&Date.now()-(V.lastActive||0)<6e4,O={};B&&I&&V&&(O[I]={id:I,name:V.name,armor:100,progress:20,joinedAt:Date.now()}),a.throne={mode:B?"PVP":"PVE",occupation:0,plundered:!1,bossHp:B?(((g=V==null?void 0:V.status)==null?void 0:g.hp)||100)*5:5e3,maxBossHp:B?(((p=V==null?void 0:V.status)==null?void 0:p.hp)||100)*5:5e3,defendingPlayerId:I,occupiers:O},i.message="GARNISONSSJEFEN ER BESEIRET! Drene til Tronsalen sls opp!"}return!0}if(a.phase==="THRONE_ROOM"||a.phase==="THRONE"){let E=a.throne;(!E||!E.occupiers)&&(E=E||{},E.occupiers=E.occupiers||{},E.lastTick=Date.now(),a.throne=E);const j=Date.now();if(j-(E.lastTick||0)>1e3){const R=Math.floor((j-(E.lastTick||0))/1e3);E.lastTick=j;const I=Object.values(E.occupiers||{}),V=((w=(x=n.regions[r])==null?void 0:x.garrison)==null?void 0:w.armor)||0,B=Math.min(.8,V/100*.1);I.forEach(O=>{var H;const M=O.id===n.regions[r].rulerId?1*(1-B):1;O.armor=Math.max(0,O.armor-M*R);const C=l[O.id]||c[O.id],J=1*(1+(((H=C==null?void 0:C.stats)==null?void 0:H.damageDealt)||0)/200)*R;if(O.progress=Math.min(100,O.progress+J),C&&(C.stats=C.stats||{damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0},C.stats.ticksOnThrone+=R),O.armor<=0)delete E.occupiers[O.id],i.message=`${O.name} falt fra tronen! (0 Beleiringsrustning)`;else if(O.progress>=100){delete n.regions[r].activeSiege;const $=n.regions[r];O.id===$.rulerId?i.message=` ${O.name} har knust opprret og gjenopprettet kontroll over ${$.name}!`:(i.message=` ${O.name} har vunnet kappelpet og TATT TRONEN med makt!`,i.siegeWinnerId=O.id,i.targetRegionId=r)}})}if(s.subType==="CLAIM_THRONE"){E.occupiers||(E.occupiers={});const R=10,I=e.resources.armor||0;return I<R?(i.message=`Mangler Beleiringsrustning! Du har ${I}, men trenger ${R}.`,!1):(e.resources.armor=0,E.occupiers[e.id]={id:e.id,name:e.name,armor:I,progress:0,joinedAt:Date.now()},i.message=`${e.name} kastet seg inn i kampen om tronen med ${I} rustning!`,!0)}if(s.subType==="DONATE_ARMOR"){const R=(k=s.payload)==null?void 0:k.targetId,I=E.occupiers[R];if(!I)return i.message="Ugyldig ml.",!1;const V=e.resources.armor||0;return V<1?(i.message="Du har ingen beleiringsrustning  gi!",!1):(e.resources.armor=V-1,I.armor+=1,u.stats=u.stats||{damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0},u.stats.armorDonated+=1,i.message=`Donerte rustning til ${I.name}`,!0)}if(s.subType==="SUNDER_ARMOR"){const R=(S=s.payload)==null?void 0:S.targetId,I=E.occupiers[R];if(!I)return i.success=!1,i.message="Ingen p tronen  angripe!",!1;I.armor=Math.max(0,I.armor-1),u.stats=u.stats||{damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0},u.stats.damageDealt+=1;const V=R===n.regions[r].rulerId,B=((T=(N=n.regions[r])==null?void 0:N.garrison)==null?void 0:T.armor)||0;return V&&B>0?i.message=` Du angriper ${I.name}! Angrepet er mindre effektivt pga. slottets garnison-skjold.`:i.message=` Angrep ${I.name} p tronen!`,!0}return s.subType==="TICK",!0}return!1},GG=t=>{const{actor:e,room:n,action:s,localResult:i}=t,{resource:r,amount:a}=s,l=e.regionId==="capital"||!e.regionId?"capital":e.regionId;return r!=="swords"&&r!=="armor"?(i.success=!1,i.message="Ugyldig ressurs for garnisonen.",!1):(e.resources[r]||0)<a?(i.success=!1,i.message=`Du har ikke nok ${r}.`,!1):(n.regions[l].garrison||(n.regions[l].garrison={swords:0,armor:0,morale:100}),e.resources[r]-=a,n.regions[l].garrison[r]=(n.regions[l].garrison[r]||0)+a,i.utbytte.push({resource:r,amount:-a}),i.message=`Forsterket garnisonen med ${a} ${r==="swords"?"vpen":"rustninger"}.`,!0)},$G=t=>{const{actor:e,room:n,action:s,localResult:i}=t,{amount:r}=s,a=e.regionId==="capital"||!e.regionId?"capital":e.regionId,l=n.regions[a];l.fortification||(l.fortification={hp:1e3,maxHp:1e3,level:1});const c=l.fortification;if(c.hp>=c.maxHp)return i.success=!1,i.message="Murene er allerede i perfekt stand.",!1;const u=10*r,d=10*r;if((e.resources.stone||0)<u||(e.resources.wood||0)<d)return i.success=!1,i.message="Mangler stein eller ved til reparasjon.",!1;e.resources.stone=(e.resources.stone||0)-u,e.resources.wood=(e.resources.wood||0)-d;const f=50*r;return c.hp=Math.min(c.maxHp,c.hp+f),i.utbytte.push({resource:"stone",amount:-u}),i.utbytte.push({resource:"wood",amount:-d}),i.message=`Reparerte murene (+${f} HP).`,l.activeSiege&&l.activeSiege.gateHp!==void 0&&(l.activeSiege.gateHp+=f),!0},FG=t=>{var l,c,u,d,f,h;const{actor:e,room:n,localResult:s,trackXp:i,damageTool:r}=t;if(e.role!=="BARON")return s.success=!1,!1;const a=Object.values(n.players).find(m=>m.role==="BARON"&&m.id!==e.id);if(a){if((((l=n.world)==null?void 0:l.activeLaws)||[]).includes("peace"))return s.success=!1,s.message="Fredsavtale blokkerer raid!",!1;const v=e.resources.manpower||0;let y=a.resources.manpower||0,b=Math.random()*.5+.75;if((c=a.upgrades)!=null&&c.includes("stone_keep")&&(y+=30),(u=a.upgrades)!=null&&u.includes("fence")&&(y+=10),(d=e.upgrades)!=null&&d.includes("stables")&&(b+=.1),e.activeBuffs&&e.activeBuffs.length>0){const g=Date.now(),p=e.activeBuffs.find(x=>x.type==="STRENGTH_BONUS"&&x.expiresAt>g);p&&(b+=p.value/100)}if((f=e.equipment)!=null&&f.MAIN_HAND&&r("MAIN_HAND",ee.DURABILITY.LOSS_COMBAT_WEAPON),(h=e.equipment)!=null&&h.BODY&&r("BODY",ee.DURABILITY.LOSS_COMBAT_ARMOR),v*b>y){const g=Math.floor((a.resources.gold||0)*ee.COMBAT.RAID_LOOT_FACTOR),p=Math.floor((a.resources.grain||0)*ee.COMBAT.RAID_LOOT_FACTOR);a.resources.gold=Math.max(0,(a.resources.gold||0)-g),a.resources.grain=Math.max(0,(a.resources.grain||0)-p),e.resources.gold=(e.resources.gold||0)+g,e.resources.grain=(e.resources.grain||0)+p,e.resources.manpower=Math.max(0,e.resources.manpower-5),a.resources.manpower=Math.max(0,a.resources.manpower-8),s.utbytte.push({resource:"gold",amount:g}),s.utbytte.push({resource:"grain",amount:p}),s.message=`Plyndret ${a.name} for ${g}g og ${p} korn!`,i("COMBAT",50)}else return e.resources.manpower=Math.max(0,e.resources.manpower-10),s.success=!1,s.message=`Angrepet p ${a.name} ble sltt tilbake.`,i("COMBAT",10),!1}else return s.success=!1,s.message="Fant ingen annen baron  raide.",!1;return!0},zG=t=>{const{actor:e,action:n,localResult:s,trackXp:i}=t,r=n.performance||.5,a=Math.ceil(15*r);return e.resources.gold=(e.resources.gold||0)+a,i("COMBAT",10),s.utbytte.push({resource:"gold",amount:a}),s.message="Utfrte patrulje.",!0},VG=t=>{var d;const{actor:e,room:n,action:s,localResult:i}=t,{resource:r}=s,a=e.regionId||"capital";let l=((d=n.markets)==null?void 0:d[a])||n.market;if(l||(n.markets||(n.markets={}),l=JSON.parse(JSON.stringify(tn)),n.markets[a]=l),!l)return i.success=!1,i.message="Markedet er ikke tilgjengelig.",!1;if(!l[r])return i.success=!1,i.message="Markedet tilbyr ikke denne varen her.",!1;const c=l[r];if(!c)return i.success=!1,i.message="Varen finnes ikke p dette markedet.",!1;const u=c.price;return c.stock<=0?(i.success=!1,i.message="Varen er utsolgt.",!1):(e.resources.gold||0)<u?(i.success=!1,i.message="Du har ikke nok gull.",!1):(e.resources.gold=(e.resources.gold||0)-u,e.resources[r]=(e.resources[r]||0)+1,c.stock-=1,c.price+=c.price*ee.MARKET.PRICE_IMPACT_BUY,i.message=`Kjpte 1 ${r} for ${u.toFixed(2)}g`,i.utbytte.push({resource:r,amount:1}),!0)},KG=t=>{var f;const{actor:e,room:n,action:s,localResult:i}=t,{resource:r}=s,a=e.regionId||"capital";let l=((f=n.markets)==null?void 0:f[a])||n.market;if(l||(n.markets||(n.markets={}),l=JSON.parse(JSON.stringify(tn)),n.markets[a]=l),!l)return i.success=!1,i.message="Markedet er ikke tilgjengelig.",!1;if(!l[r]||!l[r])return i.success=!1,i.message="Markedet tar ikke imot denne varen her.",!1;const c=e.resources[r]||0;if(typeof c!="number"||c<1)return i.success=!1,i.message=`Du har ingen ${r}  selge.`,!1;const u=l[r];if(!u)return i.success=!1,i.message="Markedet tar ikke imot denne varen.",!1;const d=u.price*ee.MARKET.SELL_RATIO;return e.resources[r]-=1,e.resources.gold=(e.resources.gold||0)+d,u.stock+=1,u.price-=u.price*ee.MARKET.PRICE_IMPACT_SELL,i.message=`Solgte 1 ${r} for ${d.toFixed(2)}g`,!0},YG=t=>{var v,y;const{actor:e,room:n,action:s,localResult:i,trackXp:r}=t,{resource:a,targetRegionId:l,action:c}=s,u=e.regionId||"capital",d=((v=n.markets)==null?void 0:v[u])||n.market,f=(y=n.markets)==null?void 0:y[l];if(!d||!f||!d[a]||!f[a])return i.success=!1,i.message="Ugyldig handelsrute eller vare.",!1;const h=d[a],m=f[a];if(!h||!m)return i.success=!1,i.message="Varen handles ikke p disse markedene.",!1;if(c==="IMPORT"){const g=m.price*5;if((e.resources.gold||0)<g)return i.success=!1,i.message="Ikke nok gull til bulk-import.",!1;if(m.stock<5)return i.success=!1,i.message="Mangler bulk-lager ved kilden.",!1;e.resources.gold-=g,e.resources[a]=(e.resources[a]||0)+5,m.stock-=5,m.price+=m.price*.02,i.message=`Importerte 5 ${a} fra ${l} for ${g.toFixed(2)}g`}else{if((e.resources[a]||0)<5)return i.success=!1,i.message=`Mangler 5 ${a} for eksport.`,!1;const g=m.price*ee.MARKET.SELL_RATIO*5;e.resources[a]-=5,e.resources.gold+=g,m.stock+=5,m.price-=m.price*.02,i.message=`Eksporterte 5 ${a} til ${l} for ${g.toFixed(2)}g`}return r("TRADING",25),!0},WG=t=>{var d,f,h;const{actor:e,room:n,localResult:s}=t;if(!(Ls(((d=n.world)==null?void 0:d.gameTick)||0)==="NIGHT"))return s.success=!1,s.message=" Du kan bare sove nr det er natt.",!1;const a=100-(e.status.stamina||0);e.status.stamina=100,e.status.hp=Math.min(100,(e.status.hp||100)+20),e.activeBuffs||(e.activeBuffs=[]),e.activeBuffs=e.activeBuffs.filter(m=>m.type!=="STAMINA_SAVE"||m.label!=="Godt utvilt");const l=((h=(f=e.buildings)==null?void 0:f.farm_house)==null?void 0:h.level)||1;let c=.5,u=3e5;return l>=3&&(c=.6),l>=4&&(c=.7,u=6e5),e.activeBuffs.push({id:"well_rested_"+Date.now(),type:"STAMINA_SAVE",value:c,label:"Godt utvilt",description:`${Math.round(c*100)}% mindre stamina-forbruk etter en god natts svn (Grd Niv ${l}).`,expiresAt:Date.now()+u}),s.message="Du sov tungt gjennom natten. Vknet opp uthvilt og full av energi!",s.utbytte.push({resource:"stamina",amount:a}),!0},er=t=>{var d;const{actor:e,action:n,localResult:s}=t,i=typeof n=="string"?n:n.type,r=n.locationId;let a=30,l=0,c="Hvilte.";if(i==="EAT"&&(a=40,c="Satt ved varmen og spiste."),i==="FEAST"&&(a=100,l=20,c="Holdt gjestebud!"),i==="GATHER_WATER"||r==="farm_well"||r==="well_water"){e.activeProcesses||(e.activeProcesses=[]);const f=r||(i==="GATHER_WATER"?"well_water":null);if(f){const h=e.activeProcesses.find(m=>m.type==="WELL"&&m.locationId===f);if(h){if(h.readyAt>Date.now())return s.success=!1,s.message="Brnnen er tom. Den fyller seg med vann...",!1;e.activeProcesses=e.activeProcesses.filter(m=>m.id!==h.id)}a=5,c="Drakk friskt vann fra brnnen.",e.activeProcesses.push({id:"well_"+Date.now(),type:"WELL",itemId:"water",locationId:f,startedAt:Date.now(),duration:3e5,readyAt:Date.now()+3e5,notified:!1})}}if(r==="village_square"&&(a=10,c="Hvilte p torget.",mG(e,"REST_SQUARE",6*60*1e3)),(r==="village"||r==="tavern_bar")&&["REST_BASIC","REST_COMFY","REST_ROYAL"].includes(i)){t.room.metadata||(t.room.metadata={});const f=t.room.metadata,h=Date.now(),m=f.lastTavernRest||h,v=(h-m)/3e5;let y=f.tavernDemand||1;v>0&&(y=Math.max(1,y-v*.05));let b=150,g=30,p=0,x=null,w="Hvilte i salen";i==="REST_BASIC"?(b=150,g=30,w="Hvilte i salen"):i==="REST_COMFY"?(b=500,g=80,p=10,w="Hvilte i komfortabelt rom",x={id:"rest_comfy_"+h,type:"STAMINA_SAVE",value:.2,label:"Utvilt",description:"20% redusert stamina-forbruk i 10 min.",expiresAt:h+6e5}):i==="REST_ROYAL"&&(b=1500,g=100,p=50,w="Hvilte i Kongesuite",x={id:"rest_royal_"+h,type:"STAMINA_SAVE",value:.5,label:"Luksusliv",description:"50% redusert stamina, +1 HP/sek regenerering i 20 min.",expiresAt:h+12e5,passiveEffect:"HP_REGEN"});const k=Math.ceil(b*y);return(e.resources.gold||0)<k?(s.success=!1,s.message=`Vertshuset krever ${k}g (Ettersprsel: ${Math.round(y*100)}%). Du har ikke rd.`,!1):(e.resources.gold-=k,s.utbytte.push({resource:"gold",amount:-k}),a=g,l=p,c=`${w} (-${k}g). Fler deg bedre!`,x&&(e.activeBuffs||(e.activeBuffs=[]),e.activeBuffs=e.activeBuffs.filter(S=>S.type!=="STAMINA_SAVE"),e.activeBuffs.push(x),c+=` (Buff: ${x.label})`),f.tavernDemand=y+.1,f.lastTavernRest=h,!0)}return(d=e.upgrades)!=null&&d.includes("roof")&&(a+=20),r==="royal_chambers"&&(a=100,l=100,c="Hvilte ut i de kongelige kamrene. Fler deg som en konge igjen!",e.activeBuffs||(e.activeBuffs=[]),e.activeBuffs=e.activeBuffs.filter(f=>f.label!=="Kongelig Velvre"),e.activeBuffs.push({id:"royal_wellness_"+Date.now(),type:"STAMINA_SAVE",value:.6,label:"Kongelig Velvre",description:"Fyrstelig velvre reduserer stamina-forbruk med 60%.",expiresAt:Date.now()+6e5})),e.status.stamina=Math.min(100,(e.status.stamina||0)+a),l>0&&(e.status.hp=Math.min(100,(e.status.hp||100)+l)),s.utbytte.push({resource:"stamina",amount:a}),s.message=c,!0},qG=t=>{const{actor:e,localResult:n,trackXp:s}=t,i=Math.floor(Math.random()*5)+1;return e.resources.favor=(e.resources.favor||0)+i,n.utbytte.push({resource:"favor",amount:i}),s("THEOLOGY",10),n.message=`Ba til gudene. (+${i} velvilje)`,!0},XG=t=>{const{localResult:e}=t,n=["Baronen ser nervs ut i dag.","Hrte du ulvene i natt?","Prisen p korn gr opp.","Kongens soldater er p vei."];return e.message=`Sladder: "${n[Math.floor(Math.random()*n.length)]}"`,!0},n_=t=>{const{actor:e,action:n,localResult:s}=t,{amount:i,isWin:r,playerRoll:a,houseRoll:l}=n;return r?(e.resources.gold=(e.resources.gold||0)+i,s.utbytte.push({resource:"gold",amount:i}),s.message=`Vant ${i}g p terninger! (${a} mot ${l})`):(e.resources.gold=Math.max(0,(e.resources.gold||0)-i),s.message=`Tapte ${i}g p terninger. (${a} mot ${l})`),!0},QG=t=>{const{actor:e,action:n,localResult:s}=t,{resource:i,amount:r,multiplier:a,isWin:l}=n,c=i,u=e.resources[c]||0;if(u<r)return s.success=!1,s.message=`Du har ikke nok ${i}!`,!1;if(e.resources[c]=Math.max(0,u-r),l){const d=r*a;e.resources[c]+=d;const f=d-r;s.utbytte.push({resource:c,amount:f}),s.message=`Soga-hjulet vider seg til din fordel! Vant ${d} ${i}.`,a>=2.5&&(e.status.morale=Math.min(100,(e.status.morale||50)+5))}else s.message=`Skjebnen var hard. Du mistet ${r} ${i} til soga-hjulet.`,s.utbytte.push({resource:c,amount:-r});return!0},JG=t=>{var c;const{actor:e,room:n,localResult:s}=t,i=e.regionId||"capital",r=((c=n.markets)==null?void 0:c[i])||n.market;let a=5;r&&r.bread&&(a=r.bread.price);const l=Math.ceil(a*1.2);if((e.resources.gold||0)>=l){e.resources.gold-=l;const u=10;e.status.stamina=Math.min(100,(e.status.stamina||0)+u),s.utbytte.push({resource:"stamina",amount:u}),s.utbytte.push({resource:"gold",amount:-l}),s.message=`Kjpte et mltid i baren for ${l}g. (+10 Stamina)`}else return s.success=!1,s.message=`Har ikke rd til mat (koster ${l}g).`,!1;return!0},ZG=t=>{const{actor:e,room:n,localResult:s}=t;return s.message=`${e.name} har valgt  trekke seg tilbake fra dette livet.`,delete n.players[e.id],!0},e$=t=>{const{actor:e,action:n,localResult:s,room:i}=t,r=n.itemId,l=!!n.isResource,c=Array.isArray(e.inventory)?e.inventory:Object.values(e.inventory||{});if(l){if(!e.resources[r]||e.resources[r]<1)return s.success=!1,s.message="Du har ikke mer igjen.",!1;e.resources[r]--,s.utbytte.push({resource:r,amount:-1})}else{const d=c.findIndex(f=>f.id===r);if(d===-1)return s.success=!1,s.message="Fant ikke gjenstanden.",!1;e.inventory=c.filter((f,h)=>h!==d)}e.activeBuffs||(e.activeBuffs=[]);const u=Date.now();switch(r){case"bread":e.status.stamina=Math.min(100,(e.status.stamina||0)+20),s.message="Spiste Brd. (+20 Stamina)",s.utbytte.push({resource:"stamina",amount:20});break;case"omelette":e.activeBuffs=e.activeBuffs.filter(d=>d.type!=="STAMINA_SAVE"),e.activeBuffs.push({id:"buff_omelette_"+u,type:"STAMINA_SAVE",value:.2,label:"Lett til beins",description:"Reduserer stamina-kostnad med 20%.",expiresAt:u+9e5,sourceItem:"omelette"}),s.message="Spiste Omelett. (20% stamina-spare buff)";break;case"minor_stamina_potion":e.status.stamina=Math.min(100,(e.status.stamina||0)+30),s.message="Drakk Liten Stamina-brygg. (+30 Stamina)",s.utbytte.push({resource:"stamina",amount:30});break;case"herbal_balm":e.activeBuffs=e.activeBuffs.filter(d=>d.type!=="SPEED_BONUS"),e.activeBuffs.push({id:"buff_balm_"+u,type:"SPEED_BONUS",value:.15,label:"Lett p foten",description:"ker sankehastighet med 15%.",expiresAt:u+6e5,sourceItem:"herbal_balm"}),s.message="Brukte Urtebalsam. (+15% Arbeidshastighet)";break;case"focus_brew":e.activeBuffs=e.activeBuffs.filter(d=>d.type!=="STAMINA_SAVE"),e.activeBuffs.push({id:"buff_focus_"+u,type:"STAMINA_SAVE",value:.2,label:"Skjerpet Fokus",description:"Reduserer stamina-kostnad med 20% i 15 min.",expiresAt:u+9e5,sourceItem:"focus_brew"}),s.message="Drakk Fokus-brygg. (Bedre fokus!)";break;case"strength_tincture":e.activeBuffs=e.activeBuffs.filter(d=>d.type!=="STRENGTH_BONUS"),e.activeBuffs.push({id:"buff_strength_"+u,type:"STRENGTH_BONUS",value:10,label:"Kjempestyrke",description:"ker angrepskraft med 10.",expiresAt:u+6e5,sourceItem:"strength_tincture"}),s.message="Drakk Styrke-tinktur. (+10 Angrep)";break;case"masters_draught":e.activeBuffs=e.activeBuffs.filter(d=>d.type!=="YIELD_BONUS"),e.activeBuffs.push({id:"buff_master_"+u,type:"YIELD_BONUS",value:.5,label:"Mesterhnd",description:"ker utbytte fra alle sankeoppgaver med 50%.",expiresAt:u+12e5,sourceItem:"masters_draught"}),s.message="Drakk Mester-drikk. (Fler deg som en mester!)";break;case"elixir_of_life":e.status.stamina=100,e.status.hp=Math.min(100,(e.status.hp||100)+50),s.message="Drakk Livseliksir. Full Stamina og +50 HP!",s.utbytte.push({resource:"stamina",amount:100});break;default:return s.success=!1,s.message=`Kan ikke bruke ${r}.`,!1}return Qn(i.pin,"consumed",r,1),!0},t$=t=>{const{actor:e,action:n,localResult:s,trackXp:i}=t,r=n.performance||.5,a=n.method||"ride_easy",l=n.level||1;let c=1,u="lav";a==="ride_medium"?(c=1.6,u="middels"):a==="ride_hard"&&(c=2.5,u="hy");const d=1+(l-1)*.5,f=Math.ceil(10*c*d);if(r===.5&&!n.isComplete){if((e.resources.grain||0)<f)return s.message=`Du har ikke nok korn! Trenger ${f} korn.`,!1;e.resources.grain=(e.resources.grain||0)-f}const h=c*(1+(l-1)*.2);e.status.stamina=Math.min(100,(e.status.stamina||0)+5);const m=Math.ceil(20*(1+r)*h);if(i("STEWARDSHIP",m),r>=.8){e.minigameProgress||(e.minigameProgress={});const v=e.minigameProgress[a]||1;l===v&&v<5?(e.minigameProgress[a]=v+1,s.message=`Glimrende ridning! Du har lst opp niv ${v+1} for ${a==="ride_easy"?"Engelskogen":a==="ride_medium"?"Fjellpasset":"Ulvestien"}! (Brukt ${f} korn)`):s.message=`Du red en tur i ${u} vanskelighetsgrad (Lvl ${l}). Fler deg forfrisket! (Brukt ${f} korn)`}else s.message=`Du red en tur i ${u} vanskelighetsgrad (Lvl ${l}). (Ytelse: ${Math.round(r*100)}%, Brukt ${f} korn)`;return!0},n$=t=>{const{actor:e,action:n,localResult:s}=t,{cosmeticId:i,cosmeticType:r,price:a}=n;return e.horseCustomization||(e.horseCustomization={skinId:"brown",maneColor:"#1e1b4b",unlockedSkins:["brown"],unlockedManeColors:["#1e1b4b"],unlockedHats:[]}),(e.resources.gold||0)<a?(s.message=`Du har ikke nok gull! Trenger ${a}g.`,!1):(e.resources.gold=(e.resources.gold||0)-a,r==="skin"?(e.horseCustomization.unlockedSkins||(e.horseCustomization.unlockedSkins=["brown"]),e.horseCustomization.unlockedSkins.includes(i)||e.horseCustomization.unlockedSkins.push(i)):r==="mane"?(e.horseCustomization.unlockedManeColors||(e.horseCustomization.unlockedManeColors=["#1e1b4b"]),e.horseCustomization.unlockedManeColors.includes(i)||e.horseCustomization.unlockedManeColors.push(i)):r==="hat"&&(e.horseCustomization.unlockedHats||(e.horseCustomization.unlockedHats=[]),e.horseCustomization.unlockedHats.includes(i)||e.horseCustomization.unlockedHats.push(i)),s.message=`Du kjpte en ny ting til hesten din for ${a}g!`,!0)},s$=t=>{const{actor:e,action:n}=t,{cosmeticId:s,cosmeticType:i}=n;return e.horseCustomization||(e.horseCustomization={skinId:"brown",maneColor:"#1e1b4b",unlockedSkins:["brown"],unlockedManeColors:["#1e1b4b"],unlockedHats:[]}),i==="skin"?e.horseCustomization.skinId=s:i==="mane"?e.horseCustomization.maneColor=s:i==="hat"&&(e.horseCustomization.hatId=s),!0},IA={WORK:bG,CHOP:vG,MINE:e_,QUARRY:e_,FORAGE:yG,HUNT:_G,GATHER_WOOL:wG,GATHER_HONEY:kG,PLANT:gG,HARVEST:xG,MAINTAIN_CROP:pG,CRAFT:EG,REFINE:Xr,BAKE:Xr,MILL:Xr,SMELT:Xr,WEAVE:Xr,MIX:Xr,REPAIR:TG,EQUIP_ITEM:AG,UNEQUIP_ITEM:jG,DISCARD_ITEM:RG,TAX:IG,DRAFT:CG,DECREE:OG,CONSTRUCT:Jh,CONTRIBUTE_TO_UPGRADE:Jh,CONTRIBUTE_TO_PRIVATE_UPGRADE:Jh,UPGRADE_BUILDING:MG,UPGRADE:DG,JOIN_ROLE:LG,START_SIEGE:BG,JOIN_SIEGE:UG,SIEGE_ACTION:HG,REINFORCE_GARRISON:GG,REPAIR_WALLS:$G,RAID:FG,PATROL:zG,SLEEP:WG,REST:er,REST_BASIC:er,REST_COMFY:er,REST_ROYAL:er,EAT:er,FEAST:er,PRAY:qG,CHAT_LOCAL:XG,GAMBLE_RESULT:n_,PLAY_DICE:n_,PLAY_RESOURCE_GAME:QG,BUY_MEAL:JG,RETIRE:ZG,CONSUME:e$,FEED_CHICKENS:NG,COLLECT_EGGS:SG,GATHER_WATER:er,TRADE_ROUTE:YG,MOUNT_HORSE:t$,BUY_HORSE_COSMETIC:n$,SELECT_HORSE_COSMETIC:s$,BUY:VG,SELL:KG},Zh=[{level:0,label:"Gammelt Trestativ",slots:2,cost:{wood:50}},{level:1,label:"Forsterket Jernstativ",slots:4,cost:{wood:100,ore:50}},{level:2,label:"Forgylt Kongestativ",slots:6,cost:{wood:200,ore:100,gold:500}}],i$=async(t,e,n)=>{const s=L(P,`simulation_rooms/${t}/players/${e}`),{type:i,slotId:r,itemId:a,instanceId:l,trophyId:c,price:u}=n;let d=!1,f="";return await Te(s,h=>{if(!h)return;h.weaponRack||(h.weaponRack={level:0,slots:[],unlockedTrophies:[]});const m=h.weaponRack;m.slots||(m.slots=[]),m.unlockedTrophies||(m.unlockedTrophies=[]);const y=(Zh.find(b=>b.level===m.level)||Zh[0]).slots;if(i==="RACK_UPGRADE"){const b=Zh.find(x=>x.level===m.level+1);if(!b)return;const g=b.cost;if(!Object.entries(g).every(([x,w])=>(h.resources[x]||0)>=w))return;Object.entries(g).forEach(([x,w])=>{const k=x;h.resources[k]=(h.resources[k]||0)-w}),m.level+=1,f=`Oppgraderte vpenstativet til ${b.label}!`,d=!0}if(i==="RACK_MOUNT_ITEM"){if(m.slots.length>=y)return;const b=(h.inventory||[]).findIndex(p=>p.id===a||p.id===l);if(b===-1)return;const g=h.inventory[b];h.inventory.splice(b,1),m.slots.push({id:`slot_${Date.now()}`,type:"ITEM",itemId:g.id,instanceId:g.id}),f=`Hengte opp ${g.name}`,d=!0}if(i==="RACK_MOUNT_TROPHY"){if(m.slots.length>=y||!m.unlockedTrophies.includes(c)||m.slots.some(b=>b.itemId===c))return;m.slots.push({id:`slot_${Date.now()}`,type:"TROPHY",itemId:c}),f="Plasserte trof p utstilling.",d=!0}if(i==="RACK_UNMOUNT"){const b=m.slots.findIndex(p=>p.id===r);if(b===-1)return;const g=m.slots[b];if(g.type==="ITEM"){const p=Oe[g.itemId];if(p){const x=JSON.parse(JSON.stringify(p));h.inventory||(h.inventory=[]),h.inventory.push(x)}}m.slots.splice(b,1),f="Tok ned gjenstand.",d=!0}if(i==="RACK_BUY_TROPHY"){if(h.resources.gold<u||m.unlockedTrophies.includes(c))return;h.resources.gold-=u,m.unlockedTrophies.push(c),f="Kjpte nytt trof!",d=!0}if(i==="RACK_POLISH"){const b=Date.now(),g=m.lastPolishedAt||0;if(b-g<6e4*60){f="Du m vente fr du kan pusse utstyret igjen.";return}m.lastPolishedAt=b,h.status.morale||(h.status.morale=50),h.status.morale=Math.min(100,h.status.morale+10),f="Pusset samlingen. Moralen ker!",d=!0}return h}),d&&f&&ut(t,f),{success:d}},r$=(t,e,n,s)=>{var u,d;t.roleStats||(t.roleStats={});const i=t.role;t.roleStats[i]||(t.roleStats[i]={level:((u=t.stats)==null?void 0:u.level)||1,xp:((d=t.stats)==null?void 0:d.xp)||0,skills:JSON.parse(JSON.stringify(t.skills||Hn[i]||Hn.PEASANT))});const r=t.roleStats[i],a=r.skills[e];a&&(a.xp+=n||0,a.xp>=a.maxXp&&(a.level+=1,a.xp-=a.maxXp,a.maxXp=Math.floor(a.maxXp*1.5),s.push(` ${t.name} ble bedre i ${e}! (Niv ${a.level})`))),r.xp=(r.xp||0)+(n||0);const c=(f=>{const h=Hd.findIndex(m=>f<m);return h===-1?Hd.length:h})(r.xp);c>r.level&&(r.level=c,s.push(` ${t.name} har steget i rang som ${i} til Niv ${c}!`)),t.stats.xp=r.xp,t.stats.level=r.level,t.skills=r.skills};async function a$(t,e,n){var i,r,a;if(!t||!n)return;const s=L(P,`simulation_accounts/${t}`);try{const l=await xe(s);if(!l.exists())return;const c=l.val(),u=c.characterHistory||[],d={name:n.name,role:n.role,level:((i=n.stats)==null?void 0:i.level)||1,xp:((r=n.stats)==null?void 0:r.xp)||0,roomPin:e,timestamp:Date.now()},f=[...u,d],h=((a=n.stats)==null?void 0:a.xp)||0,m=(c.globalXp||0)+h,v=Math.floor(Math.sqrt(m/100))+1;await ne(s,{characterHistory:f,globalXp:m,globalLevel:v,lastActive:Date.now()}),console.log(`Character life recorded for ${n.name} (${t})`)}catch(l){console.error("Failed to record character life:",l)}}async function o$(t,e,n){const s=typeof n=="string"?n:n.type,i=L(P,`simulation_rooms/${t}/players/${e}`),r=L(P,`simulation_rooms/${t}/regions`),a=L(P,`simulation_rooms/${t}/world`);try{const[l,c,u]=await Promise.all([xe(i),xe(r),xe(a)]);if(!l.exists())return{success:!1,error:"Spiller finnes ikke"};const d=l.val();d.resources||(d.resources=Lt[d.role]||Lt.PEASANT);const f=c.val()||{},h=u.val()||{},m={success:!0,timestamp:Date.now(),message:"",utbytte:[],xp:[],durability:[]},v={world:h,regions:f,players:{[e]:d},markets:{},messages:[]},y={actor:d,room:v,pin:t,action:n,timestamp:new Date().toLocaleTimeString(),localResult:m,trackXp:(k,S)=>{},damageTool:()=>!0},b=IA[s];if(!b)return{success:!1,error:"Ukjent handling"};if(!b(y)||!m.success)return{success:!1,data:m};const p={};p[`players/${e}`]=d;const x=m.siegeWinnerId,w=m.targetRegionId;if(x&&w){const k=f[w],S=k.rulerId;if(S&&S!==x){const T=await xe(L(P,`simulation_rooms/${t}/players/${S}`));if(T.exists()){const E=T.val();E.role="PEASANT",E.status&&(E.status.legitimacy=0),p[`players/${S}`]=E,p[`public_profiles/${S}/role`]="PEASANT",Qn(t,"roleChanges","PEASANT (Demoted)",1)}}const N=await xe(L(P,`simulation_rooms/${t}/players/${x}`));if(N.exists()){const T=N.val();T.role="BARON",T.regionId=w,T.status&&(T.status.legitimacy=100),p[`players/${x}`]=T,p[`public_profiles/${x}/role`]="BARON",p[`public_profiles/${x}/regionId`]=w,k.rulerId=x,k.rulerName=T.name}}return p.regions=f,await ne(L(P,`simulation_rooms/${t}`),p),{success:!0,data:m}}catch(l){return console.error("Siege Transaction Failed",l),{success:!1,error:l.message||"Beleiring feilet"}}}const l$=["RAID","TAX","TAX_PEASANTS","TAX_ROYAL","TRADE","TRADE_ROUTE","CONTRIBUTE_TO_UPGRADE","BUY","SELL","CONTRIBUTE","CONSTRUCT","UPGRADE_BUILDING","START_SIEGE","JOIN_SIEGE","SIEGE_ACTION","REINFORCE_GARRISON","REPAIR_WALLS","SET_TAX"],CA=async(t,e,n)=>{const s=typeof n=="string"?n:n.type;return l$.includes(s)?await u$(t,e,n):n.type.startsWith("RACK_")?await i$(t,e,n):c$(t,e,n)};async function c$(t,e,n){const s=L(P,`simulation_rooms/${t}/players/${e}`),i=L(P,`simulation_rooms/${t}/world`);let r=null;try{const a=await xe(i),l=a.exists()?a.val():{season:"Spring",weather:"Clear",activeLaws:[]};if(await Te(s,c=>{var w,k,S;if(!c)return c;c.resources||(c.resources=JSON.parse(JSON.stringify(Lt[c.role]||Lt.PEASANT))),c.skills||(c.skills=JSON.parse(JSON.stringify(Hn[c.role]||Hn.PEASANT))),c.status||(c.status={stamina:100,hp:100,authority:0,gold:c.resources.gold||0,level:1,xp:0}),c.equipment||(c.equipment={HEAD:null,BODY:null,MAIN_HAND:null,OFF_HAND:null,FEET:null,TRINKET:null,AXE:null,PICKAXE:null,SCYTHE:null,HAMMER:null}),c.stats||(c.stats={level:1,xp:0}),c.activeBuffs||(c.activeBuffs=[]);const u={success:!0,timestamp:Date.now(),message:"",utbytte:[],xp:[],durability:[]},d=(N,T)=>{var D,M,C,U,K,J;let E=T;const j=((D=l.settlement)==null?void 0:D.buildings)||{},I={WOODCUTTING:"sawmill",FARMING:"windmill",MINING:"smeltery",CRAFTING:"great_forge",TRADING:"weavery"}[N];I&&(((M=j[I])==null?void 0:M.level)||1)>=2&&(E=Math.ceil(E*1.1));const V=((U=(C=c.skills)==null?void 0:C[N])==null?void 0:U.level)||0,B=[];r$(c,N,E,B),B.length>0&&(u.message+=" "+B.join(" "));const O=((J=(K=c.skills)==null?void 0:K[N])==null?void 0:J.level)||0;u.xp.push({skill:N,amount:E,levelUp:O>V})},f=c.stats.level||1,h=(N,T)=>{var j;const E=(j=c.equipment)==null?void 0:j[N];return E&&(E.durability=Math.max(0,E.durability-T),u.durability.push({slot:N,item:E.name||"Gjenstand",amount:T,broken:E.durability<=0}),E.durability<=0)?(u.message=` ${E.name} ble delagt!`,u.success=!1,!1):!0},m=Date.now(),v=m-(c.lastActive||m),y=Math.min(60,isNaN(v)?0:v/6e4);if(y>.1){let N=0;(w=c.upgrades)!=null&&w.includes("cow")&&(N+=y*ee.PASSIVE_INCOME.COW),(k=c.upgrades)!=null&&k.includes("accounting_books")&&(N+=y*ee.PASSIVE_INCOME.ACCOUNTING_BOOKS),(S=c.upgrades)!=null&&S.includes("caravan")&&(N+=y*ee.PASSIVE_INCOME.CARAVAN),N>0&&(c.resources.gold=(c.resources.gold||0)+Math.floor(N));const T=y*2;c.status.stamina=Math.min(100,(c.status.stamina||0)+T)}const b=c.role,g=typeof n=="string"?n:n.type,p=Dc[g];if(p){const N=zn(p.stamina||0,l.season,l.weather,c.activeBuffs,l.gameTick||0);for(const[T,E]of Object.entries(p)){if(T==="stamina")continue;const j=T;if((c.resources[j]||0)<E)return u.success=!1,u.message=` Mangler ${E} ${T}!`,r=u,c}if((c.status.stamina||0)<N)return u.success=!1,u.message=` For sliten! (${N} kreves)`,r=u,c;for(const[T,E]of Object.entries(p)){if(T==="stamina")continue;const j=T;c.resources[j]=(c.resources[j]||0)-E,Qn(t,"consumed",T,E)}c.status.stamina-=N}const x=IA[g];if(x){const N={actor:c,room:{world:l,players:{[e]:c},messages:[]},pin:t,action:n,timestamp:new Date().toLocaleTimeString(),localResult:u,trackXp:d,damageTool:h};if(x(N)===!1)return r=u,c}else u.success=!1,u.message=`Ukjent handling: ${g}`;return u.message||(u.message="Handling utfrt."),u.success&&Math.random()<.005&&(c.resources.gold=(c.resources.gold||0)+150,u.utbytte.push({id:"ancient_relic",name:"Gammel Relikvie",type:"ITEM",icon:"",amount:1,jackpot:!0}),u.message+="  ET JORDFUNN! Du fant en eldgammel relikvie!"),c.lastActive=Date.now(),r=u,g==="RETIRE"&&u.success&&(r.characterSnapshot=JSON.parse(JSON.stringify(c))),c.stats.level>f&&(r.newLevel=c.stats.level),c.role!==b&&Qn(t,"roleChanges",c.role,1),c}),r&&r.success){if(r.message&&await ut(t,`[${new Date().toLocaleTimeString()}] ${r.message}`),r.utbytte&&r.utbytte.length>0&&r.utbytte.forEach(c=>{const u=c.type==="ITEM"?"crafted":"produced";Qn(t,u,c.id||c.resource,c.amount||1)}),r.characterSnapshot){const c=r.characterSnapshot.uid||e;await a$(c,t,r.characterSnapshot)}if(r.newLevel)try{await ne(L(P,`simulation_rooms/${t}/public_profiles/${e}`),{"stats/level":r.newLevel,lastActive:Date.now()})}catch(c){console.error("Failed to sync level",c)}}return{success:!!(r!=null&&r.success),data:r||void 0}}catch(a){return console.error("Action error:",a),{success:!1,error:a.message||"Handling feilet"}}}async function u$(t,e,n){const s=typeof n=="string"?n:n.type;try{return s==="BUY"||s==="SELL"||s==="TRADE_ROUTE"?await eG(t,e,n):s==="CONTRIBUTE"||s==="CONTRIBUTE_TO_UPGRADE"||s==="CONSTRUCT"||s==="UPGRADE_BUILDING"?await tG(t,e,n):s==="TAX"||s==="TAX_PEASANTS"||s==="TAX_ROYAL"?await nG(t,e,n):s==="START_SIEGE"||s==="JOIN_SIEGE"||s==="SIEGE_ACTION"?await o$(t,e,n):s==="REINFORCE_GARRISON"?await iG(t,e,n):s==="REPAIR_WALLS"?await rG(t,e,n):s==="SET_TAX"?await aG(t,e,n):{success:!1,error:"Global handling not available."}}catch(i){return console.error("Global Action ERROR:",i),{success:!1,error:i.message||"Global handling feilet"}}}class d${constructor(e,n){et(this,"player");et(this,"genome");et(this,"brain");et(this,"startTime");et(this,"history",[]);et(this,"status","RUNNING");et(this,"lastActionAt",0);et(this,"stuckThreshold",6e4);this.player=e,this.genome=n,this.brain=new dG(n),this.startTime=Date.now()}async tick(e,n){if(this.status!=="RUNNING")return;const s=this.brain.decide(this.player,e);if(this.history.push(s),this.history.length>20&&this.history.shift(),s.action==="IDLE"){Date.now()-this.lastActionAt>this.stuckThreshold&&(this.status="STUCK",this.dumpLog("Bottleneck detected: Stuck for > 60s"));return}this.lastActionAt=Date.now(),(await CA(n,this.player.id,s.action)).success,this.player.role==="KING"&&(this.status="SUCCESS")}getFitness(){return Yp.calculateFitness(this.player,this.startTime)}dumpLog(e){const n={reason:e,genome:this.genome,history:this.history,playerState:this.player,timestamp:Date.now()};console.error("AI Training Lab - Game Balance Issue:",n),window.lastAILog=n}}const f$=({roomData:t,pin:e})=>{var k;const[n,s]=_.useState([]),[i,r]=_.useState(0),[a,l]=_.useState(!1),[c,u]=_.useState([]),[d,f]=_.useState({}),[h,m]=_.useState({}),[v,y]=_.useState(null),b=_.useRef(t);_.useEffect(()=>{b.current=t},[t]);const g=_.useRef(null),p=async()=>{const S={};for(let N=1;N<=5;N++){const T=`bot_${Date.now()}_${N}`,E={id:T,name:`BOT Alpha ${N}`,role:"PEASANT",regionId:Math.random()>.5?"region_ost":"region_vest",resources:{...Lt.PEASANT},status:{hp:100,stamina:100,morale:100,legitimacy:100,authority:50,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:1,xp:0,reputation:10,contribution:0},skills:{...Hn.PEASANT},lastActive:Date.now(),online:!0};S[`simulation_rooms/${e}/players/${T}`]=E,S[`simulation_rooms/${e}/public_profiles/${T}`]={id:T,stats:{level:1},status:E.status,online:!0,lastActive:Date.now()}}try{await ne(L(P),S)}catch(N){console.error("Failed to spawn bots",N)}},x=()=>{t.players&&l(!0)},w=()=>{l(!1),g.current&&cancelIdleCallback(g.current)};return _.useEffect(()=>{if(a){const S=async()=>{const N=b.current,T=Object.values(N.players||{}).filter(E=>E.name.includes("BOT"));await Promise.all(T.map(async E=>{let j=n.find(R=>R.player.id===E.id);if(j)j.player=E;else{const R=Yp.getNextGenerationGenome();j=new d$(E,R),s(I=>[...I,j]),r(R.generation)}if(await j.tick(N,e),j.history.length>0){const R=j.history[j.history.length-1];let I=R.action.type||"IDLE";I==="SELL"&&R.action.itemId?I=`SELL (${R.action.itemId})`:I==="BUY"&&R.action.itemId&&(I=`BUY (${R.action.itemId})`),f(V=>({...V,[I]:(V[I]||0)+1})),m(V=>({...V,[j.player.id]:{name:j.player.name,action:I,reason:R.reason,score:R.score.toFixed(2),fitness:j.getFitness().toFixed(1),resources:{...j.player.resources},stamina:j.player.status.stamina}}))}if((j.status==="STUCK"||j.status==="DEAD")&&y(window.lastAILog),j.status==="SUCCESS"||j.status==="DEAD"||j.status==="STUCK"){const R=j.getFitness();j.genome.fitness=R,Yp.saveTopGenomes([j.genome]),u(I=>[...I.slice(-19),R])}})),g.current=window.setTimeout(()=>S(),1e3)};S()}return()=>{g.current&&clearTimeout(g.current)}},[a,e]),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex justify-between items-center bg-slate-900/50 p-6 rounded-2xl border border-white/10",children:[o.jsxs("div",{children:[o.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[o.jsx(aU,{className:"text-indigo-400"})," AI Training Lab"]}),o.jsx("p",{className:"text-slate-400 text-sm",children:"Genetisk Algoritme-optimalisering av spillbalanse"})]}),o.jsx("div",{className:"flex gap-3",children:a?o.jsxs("button",{onClick:w,className:"bg-red-600 hover:bg-red-500 px-4 py-2 rounded-lg flex items-center gap-2 font-bold transition-all",children:[o.jsx($p,{size:18})," Stopp Trening"]}):o.jsxs("button",{onClick:x,className:"bg-indigo-600 hover:bg-indigo-500 px-4 py-2 rounded-lg flex items-center gap-2 font-bold transition-all",children:[o.jsx(Fp,{size:18})," Start Trening"]})})]}),a&&Object.values(t.players||{}).filter(S=>S.name.includes("BOT")||S.id.startsWith("bot_")).length===0&&o.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/20 p-6 rounded-2xl flex items-center justify-between animate-in slide-in-from-top-2",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("div",{className:"bg-amber-500/20 p-3 rounded-full text-amber-500",children:o.jsx(Cx,{size:24})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-amber-500 font-black uppercase text-sm",children:"Ingen bot-subjekter funnet"}),o.jsx("p",{className:"text-amber-200/60 text-xs",children:"AI-en trenger kropper  kontrollere (navn med 'BOT' eller ID 'bot_')."})]})]}),o.jsx("button",{onClick:p,className:"bg-amber-500 hover:bg-amber-400 text-black px-6 py-3 rounded-xl font-black uppercase text-xs tracking-widest transition-all shadow-lg hover:scale-105",children:" Spawn Alpha Squad (5 stk)"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsxs("div",{className:"bg-slate-900/50 p-6 rounded-2xl border border-white/10",children:[o.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-xs uppercase font-black mb-2",children:[o.jsx(X1,{size:14})," Generasjon"]}),o.jsx("div",{className:"text-4xl font-black",children:i})]}),o.jsxs("div",{className:"bg-slate-900/50 p-6 rounded-2xl border border-white/10 flex flex-col justify-between",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-xs uppercase font-black mb-2",children:[o.jsx(Vp,{size:14})," Fitness Trend"]}),o.jsx("div",{className:"text-4xl font-black mb-4",children:c.length>0?(c.reduce((S,N)=>S+N,0)/c.length).toFixed(1):"0.0"})]}),o.jsxs("div",{className:"h-12 flex items-end gap-1 px-1",children:[c.map((S,N)=>{const T=Math.max(...c,1),E=S/T*100;return o.jsx("div",{className:"flex-1 bg-indigo-500/50 rounded-t-sm transition-all duration-500 hover:bg-indigo-400",style:{height:`${E}%`},title:`Fitness: ${S.toFixed(1)}`},N)}),c.length===0&&o.jsx("div",{className:"w-full h-[1px] bg-white/10"})]})]}),o.jsxs("div",{className:"bg-slate-900/50 p-6 rounded-2xl border border-white/10 text-amber-500",children:[o.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-xs uppercase font-black mb-2",children:[o.jsx(zd,{size:14})," Bottlenecks"]}),o.jsx("div",{className:"text-4xl font-black text-amber-500",children:n.filter(S=>S.status==="STUCK").length})]})]}),o.jsxs("div",{className:"bg-slate-900/50 p-6 rounded-2xl border border-white/10",children:[o.jsx("h3",{className:"text-sm font-bold uppercase tracking-widest text-slate-400 mb-4",children:"Decision Heatmap"}),o.jsxs("div",{className:"flex flex-wrap gap-4",children:[Object.entries(d).sort((S,N)=>N[1]-S[1]).map(([S,N])=>o.jsxs("div",{className:"bg-white/5 p-3 rounded-lg border border-white/5 flex flex-col items-center min-w-[80px]",children:[o.jsx("span",{className:"text-xs text-slate-500 uppercase",children:S}),o.jsx("span",{className:"text-lg font-bold",children:N})]},S)),Object.keys(d).length===0&&o.jsx("p",{className:"text-slate-600 italic",children:"Ingen data enn..."})]})]}),o.jsxs("div",{className:"bg-slate-900/50 p-6 rounded-2xl border border-white/10",children:[o.jsxs("h3",{className:"text-sm font-bold uppercase tracking-widest text-slate-400 mb-4 flex items-center gap-2",children:[o.jsx(X1,{size:16,className:"text-indigo-400"})," Live Neural Feed"]}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full text-left border-collapse",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"text-xs uppercase text-slate-500 border-b border-white/10",children:[o.jsx("th",{className:"p-3",children:"Subject"}),o.jsx("th",{className:"p-3",children:"Last Decision"}),o.jsx("th",{className:"p-3",children:"Reasoning"}),o.jsx("th",{className:"p-3",children:"Score"}),o.jsx("th",{className:"p-3",children:"Fitness"}),o.jsx("th",{className:"p-3",children:"Gold"}),o.jsx("th",{className:"p-3",children:"Stamina"})]})}),o.jsxs("tbody",{className:"text-sm",children:[Object.entries(h).map(([S,N])=>o.jsxs("tr",{className:"border-b border-white/5 hover:bg-white/5 transition-colors font-mono",children:[o.jsx("td",{className:"p-3 font-bold text-indigo-300",children:N.name}),o.jsx("td",{className:"p-3",children:o.jsx("span",{className:"bg-indigo-500/20 text-indigo-300 px-2 py-1 rounded text-xs font-bold border border-indigo-500/30",children:N.action})}),o.jsxs("td",{className:"p-3 text-slate-400 italic text-xs",children:['"',N.reason,'"']}),o.jsx("td",{className:"p-3 text-slate-300",children:N.score}),o.jsx("td",{className:"p-3 font-bold text-white",children:N.fitness}),o.jsx("td",{className:"p-3 text-amber-400",children:N.resources.gold}),o.jsx("td",{className:"p-3",children:o.jsx("div",{className:"w-16 h-1 bg-slate-700 rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full bg-emerald-500",style:{width:`${N.stamina}%`}})})})]},S)),Object.keys(h).length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:7,className:"p-8 text-center text-slate-600 italic",children:"Venter p telemetri..."})})]})]})})]}),v&&o.jsxs("div",{className:"bg-red-950/30 border border-red-500/30 p-6 rounded-2xl",children:[o.jsxs("h3",{className:"text-red-400 font-bold flex items-center gap-2 mb-4",children:[o.jsx(zd,{size:18})," Game Balance Issue Detected"]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[o.jsxs("div",{className:"bg-black/40 p-4 rounded-lg",children:[o.jsx("p",{className:"text-slate-400 text-xs uppercase mb-2",children:"Grunn"}),o.jsx("p",{className:"font-mono",children:v.reason})]}),o.jsxs("div",{className:"bg-black/40 p-4 rounded-lg",children:[o.jsx("p",{className:"text-slate-400 text-xs uppercase mb-2",children:"Siste Handling"}),o.jsx("p",{className:"font-mono",children:((k=v.history[v.history.length-1])==null?void 0:k.action.type)||"None"})]})]}),o.jsx("pre",{className:"mt-4 p-4 bg-black/40 rounded-lg overflow-x-auto text-[10px] text-slate-300 custom-scrollbar",children:JSON.stringify(v,null,2)})]})]})},h$="Enevelde",m$=()=>{var Xi,Qi,Fe,ze,So,Pc,Ox,Mx,Dx;const[t,e]=_.useState(""),[n,s]=_.useState(null),[i,r]=_.useState([]),[a,l]=_.useState(!1),[c,u]=_.useState("LIST"),[d,f]=_.useState(()=>sessionStorage.getItem("admin_session")==="active"),[h,m]=_.useState(""),[v,y]=_.useState(!1),[b,g]=_.useState({}),[p,x]=_.useState({}),[w,k]=_.useState({}),{setFullWidth:S,setHideHeader:N}=TN(),[T,E]=_.useState(null);_.useEffect(()=>{Ut(()=>import("./SimulationEconomyBlueprint-BvfDKmgf.js"),[]).then(A=>{E(()=>A.SimulationEconomyBlueprint)})},[]);const j=async A=>{if(window.confirm(`ER DU SIKKER? Dette vil slette rommet ${A} permanent! Denne handlingen kan ikke angres.`)){l(!0);try{await Iy(L(P,`simulation_rooms/${A}`)),await Iy(L(P,`simulation_server_metadata/${A}`))}catch(z){console.error(z),alert("Kunne ikke slette rommet.")}finally{l(!1)}}};_.useEffect(()=>(S(!0),N(!0),()=>{S(!1),N(!1)}),[S,N]),_.useEffect(()=>{const A=L(P,"simulation_rooms"),z=We(A,W=>{const se=W.val();if(se){const ue=Object.entries(se).map(([ie,q])=>({...q,pin:q.pin||ie}));r(ue.reverse())}else r([])});return()=>z()},[]),_.useEffect(()=>{if(!t)return;const A=`simulation_rooms/${t}`,z=We(L(P,`${A}/status`),ie=>{s(q=>q?{...q,status:ie.val()||"LOBBY"}:null)}),W=We(L(P,`${A}/world`),ie=>{s(q=>q?{...q,world:ie.val()}:null)}),se=We(L(P,`${A}/markets`),ie=>{const q=ie.val()||{};s(ye=>ye?{...ye,markets:q}:null)}),ue=We(L(P,`${A}/regions`),ie=>{s(q=>q?{...q,regions:ie.val()||{}}:null)});return()=>{z(),W(),se(),ue()}},[t]);const R=Ge.useMemo(()=>{if(!(n!=null&&n.players))return 0;const A=Date.now();return Object.values(n.players).filter(z=>z.online&&A-(z.lastActive||0)<6e4).length},[n==null?void 0:n.players]);TA(t,(n==null?void 0:n.status)||"LOBBY",n==null?void 0:n.world,R),_.useEffect(()=>{if(!t)return;const A=`simulation_rooms/${t}`,z=We(L(P,`${A}/messages`),W=>{s(se=>se?{...se,messages:W.val()||[]}:null)});return()=>z()},[t]),_.useEffect(()=>{if(!t)return;const A=`simulation_rooms/${t}`,z=We(L(P,`${A}/players`),ie=>{const q=ie.val()||{};s(ye=>ye?{...ye,players:q}:null)}),W=We(L(P,`${A}/worldEvents`),ie=>{s(q=>q?{...q,worldEvents:ie.val()||{}}:null)}),se=We(L(P,`${A}/activeVote`),ie=>{s(q=>q?{...q,activeVote:ie.val()}:null)}),ue=We(L(P,`${A}/regions`),ie=>{s(q=>q?{...q,regions:ie.val()||{}}:null)});return xe(L(P,A)).then(ie=>{if(ie.exists()){const q=ie.val();s(ye=>({...ye,pin:q.pin,status:q.status,settings:q.settings,hostName:q.hostName,isPublic:q.isPublic??!0,world:q.world,markets:q.markets||{},market:q.market||tn,players:(ye==null?void 0:ye.players)||{},messages:(ye==null?void 0:ye.messages)||[],regions:q.regions||{},diplomacy:{},worldEvents:{}}))}}),()=>{z(),W(),se(),ue()}},[t]),_.useEffect(()=>(t&&c==="MANAGE"?document.title=`Host: ${t} | Eiriksbok`:document.title="Simuleringshallen | Eiriksbok",()=>{document.title="Eiriksbok"}),[t,c]);const I=async()=>{const A=prompt("Hva skal riket hete? (La st tomt for automatisk navn)");if(A===null)return;l(!0);const z=Math.floor(1e3+Math.random()*9e3).toString(),W=A.trim()||`Rike #${z}`,se=KH(z,W);try{await Dr(L(P,`simulation_rooms/${z}`),se),await va(z,se),e(z),u("MANAGE")}catch(ue){console.error(ue),alert("Kunne ikke opprette rom.")}finally{l(!1)}},V=async()=>{if(!(!n||!n.players)){l(!0);try{const A=FH(n.players),z={region_vest:{id:"region_vest",name:"Baroniet Vest",taxRate:10,defenseLevel:50,rulerName:"Ingen"},region_ost:{id:"region_ost",name:"Baroniet st",taxRate:10,defenseLevel:50,rulerName:"Ingen"}},W={...n.markets};W.capital||(W.capital=JSON.parse(JSON.stringify(tn))),["region_vest","region_ost"].forEach(q=>{W[q]||(W[q]=JSON.parse(JSON.stringify(tn)))}),Object.values(A).forEach(q=>{if(q.role==="BARON"){z[q.regionId]={...z[q.regionId],rulerName:q.name};const ye=JSON.parse(JSON.stringify(tn));Object.keys(ye).forEach(te=>{const Ce=ye[te];Ce.price=Math.floor(Ce.price*(.8+Math.random()*.4)),Ce.stock=Math.floor(Ce.stock*(.8+Math.random()*.4))}),W[q.regionId]=ye}});const se={};Object.values(A).forEach(q=>{se[q.id]={id:q.id,name:q.name,role:q.role,regionId:q.regionId,stats:{level:q.stats.level||1},status:{isJailed:!1,isFrozen:!1,legitimacy:100},online:!0,lastActive:q.lastActive}});const ue={};ue[`simulation_rooms/${t}/players`]=A,ue[`simulation_rooms/${t}/public_profiles`]=se,ue[`simulation_rooms/${t}/regions`]=z,ue[`simulation_rooms/${t}/markets`]=W,ue[`simulation_rooms/${t}/status`]="PLAYING",await ne(L(P),ue);const ie={...n,status:"PLAYING"};await va(t,ie)}catch(A){console.error(A),alert("Klarte ikke starte.")}finally{l(!1)}}},B=async()=>{var A,z;if(!(!n||!n.players)){l(!0);try{const W=((z=(A=n.world)==null?void 0:A.taxRateDetails)==null?void 0:z.kingTax)||20,{updatedPlayers:se,results:ue}=zH(n.players,W);await ne(L(P,`simulation_rooms/${t}/players`),se),alert(`Suksess! ${ue.length} bnder og baroner ble skattlagt.`)}catch(W){console.error(W)}finally{l(!1)}}},O=async()=>{if(n!=null&&n.regions&&window.confirm("Vil du nullstille all politisk uro (bestikkelser) i alle regioner?")){l(!0);try{const A={};Object.keys(n.regions).forEach(z=>{A[`simulation_rooms/${t}/regions/${z}/coup/bribeProgress`]=0,A[`simulation_rooms/${t}/regions/${z}/coup/contributions`]={},A[`simulation_rooms/${t}/regions/${z}/coup/challengerId`]=null,A[`simulation_rooms/${t}/regions/${z}/coup/challengerName`]=null}),await ne(L(P),A),alert("Politisk ro er gjenopprettet i alle regioner!")}catch(A){console.error(A)}finally{l(!1)}}},D=async()=>{if(!(!n||!n.players)){l(!0);try{const A={};Object.keys(n.players).forEach(z=>{A[`simulation_rooms/${t}/players/${z}/status/stamina`]=100}),await ne(L(P),A),alert("All energi er gjenopprettet!")}catch(A){console.error(A)}finally{l(!1)}}},M=A=>A?Array.isArray(A)?A:Object.values(A).sort((z,W)=>z.timestamp-W.timestamp):[],C=async()=>{var ue,ie;if(!n)return;const A=["Spring","Summer","Autumn","Winter"],W=(A.indexOf(((ue=n.world)==null?void 0:ue.season)||"Spring")+1)%A.length,se=A[W];l(!0);try{const ye=` rstiden har skiftet til ${((ie=Pn[se])==null?void 0:ie.label)||se}!`,te={id:`msg_${Date.now()}`,content:ye,timestamp:Date.now(),type:"SEASON_CHANGE"},on=[...M(n.messages),te].slice(-50),Hf={};Hf[`simulation_rooms/${t}/world/season`]=se,Hf[`simulation_rooms/${t}/messages`]=on,await ne(L(P),Hf)}catch(q){console.error(q)}finally{l(!1)}},U=async()=>{if(!n)return;const A=["Clear","Rain","Storm","Fog"],W=(A.indexOf(n.world.weather||"Clear")+1)%A.length,se=A[W];try{const q=` Vret har skiftet til ${{Clear:"Klart",Rain:"Regn",Storm:"Storm",Fog:"Tke"}[se]||se}!`,ye={id:`msg_${Date.now()}`,content:q,timestamp:Date.now(),type:"WEATHER_CHANGE"},Ce=[...M(n.messages),ye].slice(-50),on={};on[`simulation_rooms/${t}/world/weather`]=se,on[`simulation_rooms/${t}/messages`]=Ce,await ne(L(P),on)}catch(ue){console.error(ue)}},K=async()=>{if(!n)return;const{LAW_TEMPLATES:A}=await Ut(async()=>{const{LAW_TEMPLATES:se}=await Promise.resolve().then(()=>W1);return{LAW_TEMPLATES:se}},void 0),z=A[Math.floor(Math.random()*A.length)],W={lawId:z.id,title:z.label,votes:{},expiresAt:Date.now()+60*1e3};try{await ne(L(P,`simulation_rooms/${t}`),{activeVote:W});const se=` TINGET ER SATT! Det skal stemmes over loven: "${z.label}"!`,ue={id:`msg_${Date.now()}`,content:se,timestamp:Date.now(),type:"VOTE_START"},q=[...M(n.messages),ue].slice(-50);await ne(L(P,`simulation_rooms/${t}`),{messages:q}),setTimeout(()=>J(z.id),6e4)}catch(se){console.error(se)}},J=async A=>{var Ce;const z=await xe(L(P,`simulation_rooms/${t}/activeVote`));if(!z.exists())return;const W=z.val(),se=Object.values(W.votes||{}),ue=se.filter(on=>on==="YES").length,ie=se.filter(on=>on==="NO").length;let q="",ye=((Ce=n==null?void 0:n.world)==null?void 0:Ce.activeLaws)||[];ue>ie?(q=` LOVEN ER VEDTATT! "${W.title}" er n gjeldende.`,ye=[...ye,A]):q=` LOVEN BLE FORKASTET. "${W.title}" ble nedstemt.`;const te={id:`msg_${Date.now()}`,content:q,timestamp:Date.now(),type:"VOTE_RESULT"};try{await ne(L(P,`simulation_rooms/${t}/world`),{activeLaws:ye});const on=M(n==null?void 0:n.messages);await ne(L(P,`simulation_rooms/${t}`),{activeVote:null,messages:[...on,te].slice(-50)})}catch(on){console.error(on)}},H=async()=>{if(!n)return;const{WORLD_EVENT_TEMPLATES:A}=await Ut(async()=>{const{WORLD_EVENT_TEMPLATES:ue}=await Promise.resolve().then(()=>W1);return{WORLD_EVENT_TEMPLATES:ue}},void 0),z=A[Math.floor(Math.random()*A.length)],W=`event_${Date.now()}`,se={...z,id:W,expiresAt:Date.now()+5*60*1e3};try{await ne(L(P,`simulation_rooms/${t}/worldEvents`),{[W]:se});const ue=` HENDELSE: ${z.title}! Sjekk kartet!`,ie={id:`msg_${Date.now()}`,content:ue,timestamp:Date.now(),type:"EVENT_SPAWN"},ye=[...M(n.messages),ie].slice(-50);await ne(L(P,`simulation_rooms/${t}`),{messages:ye})}catch(ue){console.error(ue)}},$=async(A,z)=>{var ue,ie,q;if(!((q=(ie=(ue=n==null?void 0:n.world)==null?void 0:ue.settlement)==null?void 0:ie.buildings)!=null&&q[A]))return;const W=n.world.settlement.buildings[A],se=Math.max(0,W.level+z);try{await ne(L(P,`simulation_rooms/${t}/world/settlement/buildings/${A}`),{level:se,progress:{}})}catch(ye){console.error(ye)}},[F,Q]=_.useState({name:"",role:"PEASANT",level:1}),ce=async()=>{if(!F.name){alert("Vennligst oppgi et navn.");return}l(!0);try{const A=`char_${Math.random().toString(36).substr(2,9)}`,z={id:A,name:F.name,role:F.role||"PEASANT",regionId:F.role==="KING"?"capital":Math.random()>.5?"region_ost":"region_vest",resources:Lt[F.role]||Lt.PEASANT,status:{hp:100,stamina:100,morale:100,legitimacy:100,authority:50,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:F.level,xp:0,reputation:10,contribution:0},skills:Hn[F.role]||Hn.PEASANT,lastActive:Date.now(),online:!0},W={};W[`simulation_rooms/${t}/players/${A}`]=z,W[`simulation_rooms/${t}/public_profiles/${A}`]={id:A,name:z.name,role:z.role,regionId:z.regionId,stats:{level:z.stats.level},status:{isJailed:!1,isFrozen:!1,legitimacy:100},online:!0,lastActive:z.lastActive},await ne(L(P),W),Q({name:"",role:"PEASANT",level:1})}catch(A){console.error(A),alert("Kunne ikke opprette karakter.")}finally{l(!1)}},ve=async(A,z)=>{try{const W={};W[`simulation_rooms/${t}/players/${A}/stats/level`]=z,W[`simulation_rooms/${t}/public_profiles/${A}/stats/level`]=z,await ne(L(P),W)}catch(W){console.error(W)}},de=async()=>{if(n){l(!0);try{await ne(L(P,`simulation_rooms/${t}/world`),{settlement:{buildings:Object.entries(Kt).reduce((A,[z])=>({...A,[z]:{id:z,level:0,progress:{},target:200,contributions:{}}}),{})}})}catch(A){console.error(A)}finally{l(!1)}}},Ze=async()=>{if(console.log("Attempting resetGame..."),!window.confirm("Er du sikker p at du vil starte spillet p nytt? Alle fremdrift slettes.")){console.log("Reset cancelled by user.");return}console.log("Reset confirmed. Pin:",t),l(!0);try{const A={};A[`simulation_rooms/${t}/status`]="LOBBY",A[`simulation_rooms/${t}/worldEvents`]={},A[`simulation_rooms/${t}/messages`]=[],A[`simulation_rooms/${t}/market`]=tn,A[`simulation_rooms/${t}/markets`]={capital:tn},A[`simulation_rooms/${t}/regions`]={},A[`simulation_rooms/${t}/world/monumentProgress`]=0,A[`simulation_rooms/${t}/world/activeLaws`]=[],A[`simulation_rooms/${t}/world/settlement`]={buildings:Object.entries(Kt).reduce((z,[W])=>({...z,[W]:{id:W,level:0,progress:{},target:200,contributions:{}}}),{})},Object.keys((n==null?void 0:n.players)||{}).forEach(z=>{A[`simulation_rooms/${t}/players/${z}/role`]="PEASANT",A[`simulation_rooms/${t}/players/${z}/regionId`]="capital",A[`simulation_rooms/${t}/players/${z}/resources`]=Lt.PEASANT,A[`simulation_rooms/${t}/players/${z}/status`]={stamina:100,legitimacy:100,authority:50},A[`simulation_rooms/${t}/players/${z}/equipment`]={};const W=`simulation_rooms/${t}/public_profiles/${z}`;A[`${W}/role`]="PEASANT",A[`${W}/regionId`]="capital",A[`${W}/stats/level`]=1,A[`simulation_rooms/${t}/players/${z}/roleStats`]=null}),console.log("Constructed updates:",A),await ne(L(P),A),n&&s({...n,status:"LOBBY",messages:[]}),console.log("Update successful!"),alert("Spillet er nullstilt!")}catch(A){console.error("Reset failed:",A),alert("Kunne ikke nullstille spill: "+A)}finally{l(!1)}},X=async(A,z)=>{if(window.confirm(`Er du sikker p at du vil kaste ut ${z}?`))try{const W={};W[`simulation_rooms/${t}/players/${A}`]=null,W[`simulation_rooms/${t}/public_profiles/${A}`]=null,await ne(L(P),W)}catch(W){console.error(W),alert("Kunne ikke kaste ut spiller.")}},fe=async()=>{if(window.confirm("ER DU SIKKER? Dette vil kaste ut ALLE spillere fra rommet!"))try{const A={};A[`simulation_rooms/${t}/players`]={},await ne(L(P),A),alert("Alle spillere er kastet ut.")}catch(A){console.error(A),alert("Kunne ikke utfre handlingen.")}},me=A=>{const z=`${window.location.origin}/Simulation_StandAlone_Pro/play/${t}?impersonate=${A}`;window.open(z,"_blank")},yt=async(A,z)=>{try{const W={};W[`simulation_rooms/${t}/players/${A}/role`]=z,W[`simulation_rooms/${t}/public_profiles/${A}/role`]=z,await ne(L(P),W)}catch(W){console.error(W),alert("Kunne ikke endre rolle.")}},Xt=async(A,z)=>{try{const W={};W[`simulation_rooms/${t}/players/${A}/regionId`]=z,W[`simulation_rooms/${t}/public_profiles/${A}/regionId`]=z,await ne(L(P),W)}catch(W){console.error(W),alert("Kunne ikke endre baroni.")}},kn=async()=>{if(!n)return;const A=!n.isPublic;try{await ne(L(P,`simulation_rooms/${t}`),{isPublic:A}),await va(t,{...n,isPublic:A})}catch(z){console.error(z)}},Gn=A=>{A&&A.preventDefault(),h===h$?(f(!0),sessionStorage.setItem("admin_session","active"),y(!1)):(y(!0),m(""),navigator.vibrate&&navigator.vibrate(50))};if(!d)return o.jsxs("div",{className:"fixed inset-0 bg-slate-950 flex items-center justify-center z-[100] overflow-hidden",children:[o.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[o.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full h-full bg-[radial-gradient(circle_at_center,rgba(99,102,241,0.08)_0%,transparent_70%)]"}),o.jsx(he.div,{animate:{scale:[1,1.1,1],opacity:[.3,.5,.3]},transition:{duration:8,repeat:1/0,ease:"easeInOut"},className:"absolute top-[-20%] left-[-10%] w-[60%] h-[60%] bg-indigo-600/10 blur-[150px] rounded-full"})]}),o.jsxs(he.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},className:"w-full max-w-md p-8 relative",children:[o.jsxs("div",{className:"text-center mb-10",children:[o.jsx(he.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",damping:12,stiffness:200,delay:.2},className:"w-20 h-20 bg-indigo-500/10 rounded-3xl flex items-center justify-center mx-auto mb-6 border border-indigo-500/20 backdrop-blur-xl",children:o.jsx(no,{className:"w-10 h-10 text-indigo-400"})}),o.jsx("h2",{className:"text-3xl font-black text-white tracking-tight mb-2",children:"Begrenset tilgang"}),o.jsx("p",{className:"text-slate-400 font-medium",children:"Vennligst oppgi passord for  fortsette"})]}),o.jsxs("form",{onSubmit:Gn,className:"space-y-4",children:[o.jsxs("div",{className:"relative group",children:[o.jsx(he.div,{animate:v?{x:[-10,10,-10,10,0]}:{},transition:{duration:.4},children:o.jsx("input",{autoFocus:!0,type:"password",value:h,onChange:A=>{m(A.target.value),v&&y(!1)},placeholder:"Passord...",className:`w-full bg-slate-900/50 border-2 ${v?"border-red-500/50 focus:border-red-500":"border-slate-800 focus:border-indigo-500"} rounded-2xl px-6 py-4 text-white text-lg font-medium outline-none transition-all duration-300 backdrop-blur-md placeholder:text-slate-600`})}),o.jsx(Ln,{children:v&&o.jsx(he.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"text-red-400 text-sm font-bold mt-2 ml-2",children:"Ugyldig passord. Prv igjen."})})]}),o.jsx("button",{type:"submit",className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-4 rounded-2xl transition-all duration-300 shadow-lg shadow-indigo-600/20 active:scale-[0.98]",children:"Ls opp panel"})]}),o.jsx("div",{className:"mt-12 text-center",children:o.jsx("button",{onClick:()=>window.location.href="/",className:"text-slate-500 hover:text-slate-300 text-sm font-bold transition-colors",children:"Tilbake til forsiden"})})]})]});if(c==="LIST")return o.jsxs("div",{className:"fixed inset-0 top-0 bg-slate-950 text-slate-200 p-12 overflow-y-auto custom-scrollbar font-sans z-20",children:[o.jsxs("div",{className:"fixed inset-0 pointer-events-none opacity-20",children:[o.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-indigo-600/20 blur-[120px] rounded-full"}),o.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-amber-600/10 blur-[120px] rounded-full"})]}),o.jsxs("div",{className:"max-w-5xl mx-auto relative z-10",children:[o.jsxs("div",{className:"flex justify-between items-center mb-12",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-5xl font-black text-white px-2 tracking-tighter",children:"Simuleringshallen"}),o.jsx("p",{className:"text-slate-500 font-bold uppercase tracking-widest text-[10px] mt-2 px-2",children:"Sentralt kontrollpanel for administratoren"})]}),o.jsxs("div",{className:"flex gap-4",children:[o.jsx("button",{onClick:async()=>{l(!0);try{const A=L(P,"simulation_server_metadata"),z=L(P,"simulation_rooms"),[W,se]=await Promise.all([xe(A),xe(z)]),ue=W.val()||{},ie=se.val()||{};let q=0;const ye={};Object.keys(ue).forEach(te=>{ie[te]||(ye[`simulation_server_metadata/${te}`]=null,q++)}),q>0?(await ne(L(P),ye),alert(`Ryddet opp ${q} dde serverkoblinger!`)):alert("Alt ser ryddig ut! Ingen dde linker funnet.")}catch(A){console.error(A),alert("Kunne ikke rydde opp "+A)}finally{l(!1)}},disabled:a,className:"bg-slate-800 hover:bg-rose-500/20 text-slate-400 hover:text-rose-400 border border-slate-700 hover:border-rose-500/50 px-6 py-5 rounded-2xl font-black text-xs uppercase tracking-widest transition-all",children:" Vask Serverlisten"}),o.jsx("button",{onClick:I,disabled:a,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-10 py-5 rounded-2xl font-black text-lg shadow-2xl shadow-indigo-600/30 transition-all hover:scale-105 active:scale-95",children:"+ Opprett Nytt Rike"})]})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map(A=>{var z,W;return o.jsxs("div",{className:"bg-slate-900/50 backdrop-blur-xl border border-white/5 p-8 rounded-[2.5rem] group hover:border-indigo-500/50 transition-all shadow-xl flex flex-col justify-between",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between items-start mb-2",children:[o.jsx("h2",{className:"text-2xl font-black text-white group-hover:text-indigo-400 transition-colors truncate pr-4",title:A.name||`Rike #${A.pin}`,children:A.name||`Rike #${A.pin}`}),o.jsx("span",{className:`px-2 py-0.5 rounded-full text-[8px] font-black uppercase tracking-widest ${A.status==="PLAYING"?"bg-emerald-500/20 text-emerald-400":"bg-amber-500/20 text-amber-400"} shrink-0`,children:typeof A.status=="string"?A.status:"KORRUPT"})]}),o.jsxs("div",{className:"text-[10px] font-mono text-slate-600 mb-6 uppercase tracking-widest",children:["PIN: ",o.jsx("span",{className:"text-slate-400 font-bold",children:A.pin})]}),o.jsxs("div",{className:"space-y-4 mb-8",children:[o.jsxs("div",{className:"flex items-center justify-between text-sm font-bold text-slate-500",children:[o.jsx("span",{children:"Innbyggere:"}),o.jsxs("span",{className:"text-white",children:[Object.keys(A.players||{}).length," sjeler"]})]}),o.jsxs("div",{className:"flex items-center justify-between text-sm font-bold text-slate-500",children:[o.jsx("span",{children:"rstid:"}),o.jsx("span",{className:"text-indigo-300",children:tn[(z=A.world)==null?void 0:z.season]||((W=A.world)==null?void 0:W.season)||"Ukjent"})]})]})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx("button",{onClick:()=>{e(A.pin),u("MANAGE")},className:"flex-1 bg-white/5 hover:bg-white/10 text-white py-4 rounded-2xl font-black uppercase tracking-widest text-xs transition-all border border-white/5",children:"Administrer "}),o.jsx("button",{onClick:()=>j(A.pin),className:"bg-rose-500/10 hover:bg-rose-500/20 text-rose-500 w-16 rounded-2xl flex items-center justify-center border border-rose-500/20 transition-all hover:scale-105 active:scale-95",title:"Slett rom",children:""})]})]},A.pin)})})]})]});if(!n)return null;const $t=async()=>{if(window.confirm("Er du sikker? Dette vil regenerere 'public_profiles' basert p 'players'. Bruk kun hvis listen er tom.")){l(!0);try{const A=await xe(L(P,`simulation_rooms/${t}`));if(!A.exists())return;const z=A.val(),W=z.players||{},se={};Object.entries(W).forEach(([ue,ie])=>{var q,ye,te,Ce;se[`simulation_rooms/${t}/public_profiles/${ue}`]={id:ue,uid:ie.uid||null,name:ie.name,role:ie.role,regionId:ie.regionId,stats:{level:((q=ie.stats)==null?void 0:q.level)||1},status:{isJailed:((ye=ie.status)==null?void 0:ye.isJailed)||!1,isFrozen:((te=ie.status)==null?void 0:te.isFrozen)||!1,legitimacy:((Ce=ie.status)==null?void 0:Ce.legitimacy)||100},online:!0,lastActive:ie.lastActive||Date.now()}}),z.status||(se[`simulation_rooms/${t}/status`]="LOBBY"),z.world||(se[`simulation_rooms/${t}/world`]={year:1100,season:"Spring",weather:"Clear",gameTick:0,lastTickAt:Date.now(),taxRateDetails:{kingTax:20},settlement:{buildings:Object.entries(Kt).reduce((ue,[ie])=>({...ue,[ie]:{id:ie,level:0,progress:{},target:200,contributions:{}}}),{})}}),await ne(L(P),se),alert("Data reparert! Profiler er synkronisert."),await va(t,{...z,players:W})}catch(A){console.error(A),alert("Reparasjon feilet: "+A)}finally{l(!1)}}};return o.jsxs("div",{className:"fixed inset-0 top-0 bg-slate-950 text-slate-200 flex overflow-hidden font-sans selection:bg-indigo-500/30 z-20",children:[o.jsxs("div",{className:"fixed inset-0 pointer-events-none opacity-20",children:[o.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-indigo-600/20 blur-[120px] rounded-full animate-pulse"}),o.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-amber-600/10 blur-[120px] rounded-full"})]}),o.jsxs("aside",{className:"w-80 border-r border-white/10 bg-slate-900/50 backdrop-blur-xl flex flex-col z-20 shadow-2xl overflow-y-auto no-scrollbar",children:[o.jsxs("div",{className:"p-8 border-b border-white/5 bg-black/20",children:[o.jsx("button",{onClick:()=>u("LIST"),className:"text-indigo-400 font-black text-[10px] uppercase tracking-widest mb-4 hover:text-white transition-colors flex items-center gap-2",children:" Tilbake til oversikt"}),o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("h1",{className:"text-4xl font-mono font-black text-white",children:t}),o.jsx("span",{className:"text-[10px] font-black uppercase text-indigo-500 tracking-widest bg-indigo-500/10 px-3 py-1 rounded-full",children:"Admin"})]}),o.jsxs("p",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-6",children:[typeof n.status=="string"?n.status:"FEIL: DATA KORRUPT"," MODUS"]}),o.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[o.jsx("button",{onClick:V,disabled:n.status==="PLAYING"||a,className:`w-full py-4 rounded-xl font-black uppercase tracking-widest text-sm transition-all shadow-lg ${n.status==="PLAYING"?"bg-emerald-600/20 text-emerald-500 cursor-default":"bg-emerald-600 hover:bg-emerald-500 text-white shadow-emerald-600/20"}`,children:n.status==="PLAYING"?" SPILL AKTIVT":" START SPILL"}),o.jsxs("button",{onClick:kn,disabled:a,className:`w-full py-3 rounded-xl font-black uppercase tracking-widest text-[10px] transition-all border flex items-center justify-center gap-2 ${n.isPublic?"bg-indigo-600/10 text-indigo-400 border-indigo-500/20 hover:bg-indigo-600 hover:text-white":"bg-slate-800 text-slate-500 border-white/5 hover:border-indigo-500/20"}`,children:[n.isPublic?o.jsx(IU,{size:14}):o.jsx(no,{size:14}),n.isPublic?"OFFENTLIG SERVER":"PRIVAT (KUN PIN)"]}),o.jsx("button",{onClick:$t,disabled:a,className:"w-full py-3 rounded-xl font-black uppercase tracking-widest text-[10px] bg-amber-600/10 text-amber-500 hover:bg-amber-600 hover:text-white transition-all border border-amber-500/20",children:" REPARER DATA"}),o.jsx("button",{onClick:Ze,disabled:a,className:"w-full py-3 rounded-xl font-black uppercase tracking-widest text-[10px] bg-rose-600/10 text-rose-500 hover:bg-rose-600 hover:text-white transition-all border border-rose-500/20",children:" NULLSTILL ALT"})]})]}),o.jsxs("div",{className:"p-8 space-y-8 flex-1 overflow-y-auto custom-scrollbar",children:[o.jsxs("section",{children:[o.jsx("h3",{className:"text-[10px] font-black uppercase text-slate-500 tracking-[0.2em] mb-4",children:"Verdensstyring"}),o.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[o.jsxs("div",{className:"bg-white/5 p-4 rounded-2xl border border-white/5 group",children:[o.jsxs("div",{className:"flex justify-between items-center mb-3",children:[o.jsxs("span",{className:"text-xs font-bold text-slate-400 italic",children:["rstid: ",((Qi=Pn[(Xi=n.world)==null?void 0:Xi.season])==null?void 0:Qi.label)||"Ukjent"]}),o.jsx("span",{className:"text-2xl group-hover:rotate-12 transition-transform",children:{Spring:"",Summer:"",Autumn:"",Winter:""}[((Fe=n.world)==null?void 0:Fe.season)||"Spring"]})]}),o.jsx("button",{onClick:C,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white py-2 rounded-lg font-black uppercase text-[10px] transition-all",children:"Neste rstid"})]}),o.jsxs("div",{className:"bg-white/5 p-4 rounded-2xl border border-white/5 group",children:[o.jsxs("div",{className:"flex justify-between items-center mb-3",children:[o.jsxs("span",{className:"text-xs font-bold text-slate-400 italic",children:["Vr: ",((ze=n.world)==null?void 0:ze.weather)||"Klart"]}),o.jsx("span",{className:"text-2xl group-hover:scale-110 transition-transform",children:""})]}),o.jsx("button",{onClick:U,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white py-2 rounded-lg font-black uppercase text-[10px] transition-all",children:"Endre Vr"})]})]})]}),o.jsxs("section",{children:[o.jsx("h3",{className:"text-[10px] font-black uppercase text-slate-500 tracking-[0.2em] mb-4",children:"Massehandlinger"}),o.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[o.jsx("button",{onClick:B,className:"w-full bg-amber-600/10 hover:bg-amber-600 text-amber-500 hover:text-white border border-amber-600/20 py-4 rounded-2xl font-black uppercase text-[10px] transition-all flex items-center justify-center gap-2",children:" Skattlegg Riket"}),o.jsx("button",{onClick:D,className:"w-full bg-blue-600/10 hover:bg-blue-600 text-blue-500 hover:text-white border border-blue-600/20 py-4 rounded-2xl font-black uppercase text-[10px] transition-all flex items-center justify-center gap-2 text-center",children:" Gjenopprett Stamina"}),o.jsx("button",{onClick:O,className:"w-full bg-indigo-600/10 hover:bg-indigo-600 text-indigo-500 hover:text-white border border-indigo-600/20 py-4 rounded-2xl font-black uppercase text-[10px] transition-all flex items-center justify-center gap-2 text-center",children:" Nullstill Politisk Uro"}),o.jsx("button",{onClick:fe,className:"w-full bg-rose-600/10 hover:bg-rose-600 text-rose-500 hover:text-white border border-rose-600/20 py-4 rounded-2xl font-black uppercase text-[10px] transition-all flex items-center justify-center gap-2 text-center mt-2",children:" Kast ut alle"})]})]}),o.jsxs("section",{children:[o.jsx("h3",{className:"text-[10px] font-black uppercase text-slate-500 tracking-[0.2em] mb-4 text-center",children:"Intervensjoner"}),o.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsx("button",{onClick:H,className:"bg-rose-600/80 hover:bg-rose-600 text-white py-4 rounded-2xl font-black uppercase text-[10px] shadow-lg shadow-rose-600/20 transition-all active:scale-95",children:" Event"}),o.jsx("button",{onClick:K,disabled:!!n.activeVote,className:"bg-amber-600/80 hover:bg-amber-600 text-white py-4 rounded-2xl font-black uppercase text-[10px] shadow-lg shadow-amber-600/20 disabled:opacity-20 text-center transition-all active:scale-95",children:" Tinget"})]}),o.jsxs("section",{className:"bg-white/5 border border-white/5 rounded-[2.5rem] p-6 space-y-4 shadow-inner",children:[o.jsx("h3",{className:"text-[10px] font-black uppercase text-indigo-400 tracking-[0.2em] mb-2 px-2",children:"Legg til Karakter"}),o.jsxs("div",{className:"space-y-3",children:[o.jsx("input",{type:"text",placeholder:"Navn...",value:F.name,onChange:A=>Q({...F,name:A.target.value}),className:"w-full bg-black/40 border border-white/5 rounded-xl px-4 py-3 text-xs font-bold text-white placeholder:text-slate-600 focus:border-indigo-500/50 focus:ring-0 transition-all"}),o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsx("select",{value:F.role,onChange:A=>Q({...F,role:A.target.value}),className:"bg-black/40 border border-white/5 rounded-xl px-3 py-2 text-[10px] font-black uppercase text-slate-400 focus:ring-0",children:Object.keys(tc).map(A=>o.jsx("option",{value:A,children:A},A))}),o.jsxs("div",{className:"flex items-center gap-2 bg-black/40 border border-white/5 rounded-xl px-3 py-2",children:[o.jsx("span",{className:"text-[8px] font-black text-slate-600",children:"LVL"}),o.jsx("input",{type:"number",value:F.level,onChange:A=>Q({...F,level:parseInt(A.target.value)}),className:"w-full bg-transparent border-none p-0 text-xs font-black text-white focus:ring-0 font-mono"})]})]}),o.jsx("button",{onClick:ce,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-xl font-black uppercase text-[10px] shadow-lg shadow-indigo-600/20 transition-all active:scale-95",children:" SKAP KARAKTER"})]})]})]})]}),o.jsxs("section",{children:[o.jsx("h3",{className:"text-[10px] font-black uppercase text-slate-500 tracking-[0.2em] mb-4",children:"Landsby-fokus"}),(So=n.world)!=null&&So.settlement?o.jsx("div",{className:"text-xs text-slate-500 italic",children:"Landsbyen er initialisert."}):o.jsx("button",{onClick:de,className:"w-full bg-amber-500 text-black py-4 rounded-2xl font-black uppercase text-[10px] animate-pulse",children:"Initialiser Landsby"})]})]})]}),o.jsxs("main",{className:"flex-1 relative flex flex-col bg-slate-900/10 overflow-hidden no-scrollbar",children:[o.jsxs("header",{className:"h-16 border-b border-white/5 bg-slate-950/30 backdrop-blur-md flex items-center justify-between px-8 shrink-0 z-10",children:[o.jsxs("div",{className:"flex items-center gap-8",children:[o.jsxs("nav",{className:"flex items-center bg-white/5 p-1 rounded-xl border border-white/10",children:[o.jsx("button",{onClick:()=>u("MANAGE"),className:`px-4 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${c==="MANAGE"?"bg-indigo-600 text-white shadow-lg":"text-slate-500 hover:text-white"}`,children:"Overvking"}),o.jsx("button",{onClick:()=>u("ECONOMY"),className:`px-4 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${c==="ECONOMY"?"bg-indigo-600 text-white shadow-lg":"text-slate-500 hover:text-white"}`,children:"Blueprint"}),o.jsx("button",{onClick:()=>u("AI_LAB"),className:`px-4 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${c==="AI_LAB"?"bg-indigo-600 text-white shadow-lg":"text-slate-500 hover:text-white"}`,children:"AI Training Lab"})]}),o.jsx("div",{className:"h-4 w-[1px] bg-white/10 mx-2"}),o.jsxs("div",{className:"flex items-center gap-8",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Innbyggere:"}),o.jsx("span",{className:"text-sm font-bold text-white",children:Object.keys(n.players||{}).length})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"r i Riket:"}),o.jsx("span",{className:"text-sm font-bold text-white",children:((Pc=n.world)==null?void 0:Pc.year)||1100})]})]})]}),a&&o.jsx("div",{className:"text-[10px] font-black uppercase tracking-widest text-indigo-400 animate-pulse",children:"Prosesserer Endringer..."})]}),o.jsx("div",{className:"flex-1 p-8 overflow-y-auto custom-scrollbar no-scrollbar",children:c==="ECONOMY"?T?o.jsx(T,{}):o.jsx("div",{className:"p-20 text-center animate-pulse text-slate-500 font-black uppercase tracking-widest",children:"Laster Blueprint..."}):c==="AI_LAB"?o.jsx(f$,{roomData:n,pin:t}):o.jsxs("div",{className:"space-y-12 pb-20",children:[o.jsxs("section",{children:[o.jsx("h2",{className:"text-3xl font-black text-white px-2 mb-8 tracking-tighter",children:"Innbyggere i Riket"}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[Object.values(n.players||{}).map(A=>{var z,W,se,ue,ie,q,ye;return o.jsxs("div",{className:"relative bg-slate-900/80 border border-white/5 p-6 rounded-[2rem] hover:border-indigo-500/30 transition-all group",children:[o.jsx("button",{onClick:te=>{te.stopPropagation(),X(A.id,A.name)},className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-rose-500/10 text-rose-500 opacity-0 group-hover:opacity-100 transition-all hover:bg-rose-500 hover:text-white flex items-center justify-center font-bold text-xs",title:"Kast ut spiller",children:""}),o.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[o.jsx("div",{className:"w-12 h-12 bg-indigo-600/20 rounded-xl flex items-center justify-center text-2xl shrink-0 group-hover:scale-110 transition-transform overflow-hidden",children:A.avatar?o.jsx("img",{src:A.avatar,alt:A.role,className:"w-full h-full object-cover"}):{KING:"",BARON:"",PEASANT:"",SOLDIER:"",MERCHANT:""}[A.role]||""}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsx("h3",{className:"text-lg font-black text-white truncate leading-tight",children:A.name}),o.jsxs("div",{className:"flex items-center gap-1 bg-white/5 px-2 py-0.5 rounded-lg border border-white/5",children:[o.jsx("span",{className:"text-[8px] font-black text-slate-500 uppercase",children:"LVL"}),o.jsx("input",{type:"number",value:((z=A.stats)==null?void 0:z.level)||1,onChange:te=>ve(A.id,parseInt(te.target.value)),className:"w-8 bg-transparent border-none p-0 text-[10px] font-black text-indigo-400 focus:ring-0 text-center font-mono"})]})]}),o.jsxs("div",{className:"flex flex-col gap-1 mt-1",children:[o.jsx("select",{value:A.role,onChange:te=>yt(A.id,te.target.value),className:"bg-indigo-500/10 text-indigo-400 text-[10px] font-black uppercase tracking-widest border-none p-0 focus:ring-0 cursor-pointer hover:text-white transition-colors w-full text-left",children:Object.entries(tc).map(([te,Ce])=>o.jsx("option",{value:te,className:"bg-slate-900",children:Ce.label},te))}),o.jsxs("select",{value:A.regionId||"region_ost",onChange:te=>Xt(A.id,te.target.value),className:"bg-white/5 text-slate-500 text-[9px] font-bold uppercase tracking-wider border-none p-0 focus:ring-0 cursor-pointer hover:text-slate-300 transition-colors w-full text-left",children:[o.jsx("option",{value:"capital",className:"bg-slate-900",children:"Hovedstaden"}),o.jsx("option",{value:"region_ost",className:"bg-slate-900",children:"Baroniet st"}),o.jsx("option",{value:"region_vest",className:"bg-slate-900",children:"Baroniet Vest"})]})]})]})]}),A.id.startsWith("bot_")&&((W=A.status)==null?void 0:W.thought)&&o.jsxs("div",{className:"mb-4 p-3 bg-indigo-500/10 rounded-xl border border-indigo-500/20",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("span",{className:"text-[8px] font-black text-indigo-400 uppercase tracking-widest",children:"Mental Tilstand"}),o.jsx("div",{className:"flex-1 h-[1px] bg-indigo-500/20"})]}),o.jsxs("p",{className:"text-[10px] text-white/90 font-bold leading-relaxed mb-2",children:['"',A.status.thought,'"']}),o.jsxs("div",{className:"flex justify-between items-center text-[8px] font-black uppercase tracking-tighter text-indigo-400/60",children:[o.jsxs("span",{children:["Handling: ",A.status.lastAction]}),o.jsxs("span",{children:["Tid: ",A.status.lastTick?new Date(A.status.lastTick).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"N"]})]})]}),o.jsxs("div",{className:"space-y-3 mb-6",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex justify-between text-[8px] font-black uppercase text-slate-500 mb-1",children:[o.jsx("span",{children:"Stamina"}),o.jsxs("span",{className:"text-white",children:[A.status.stamina,"%"]})]}),o.jsx("div",{className:"h-1 bg-slate-800 rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full bg-emerald-500",style:{width:`${A.status.stamina}%`}})})]}),o.jsxs("div",{className:"flex justify-between items-center text-xs font-bold",children:[o.jsx("span",{className:"text-slate-500",children:"Gull:"}),o.jsxs("span",{className:"text-amber-500 font-black",children:[A.resources.gold,""]})]})]}),o.jsxs("div",{className:"flex flex-wrap gap-1 mb-6",children:[(se=A.upgrades)==null?void 0:se.map(te=>o.jsx("span",{className:"text-[7px] font-black bg-indigo-500/10 text-indigo-400 px-1.5 py-0.5 rounded border border-indigo-500/20 uppercase tracking-tighter",children:te},te)),(!A.upgrades||A.upgrades.length===0)&&o.jsx("span",{className:"text-[7px] font-bold text-slate-700 uppercase italic",children:"Ingen oppgraderinger"})]}),o.jsxs("button",{onClick:()=>me(A.id),className:"w-full py-4 rounded-2xl bg-indigo-600/10 hover:bg-indigo-600 text-indigo-400 hover:text-white font-black uppercase text-[10px] tracking-widest transition-all border border-indigo-500/20 flex items-center justify-center gap-2 group/btn",children:[o.jsx("span",{className:"group-hover/btn:scale-125 transition-transform",children:""}),"Styr spiller"]}),o.jsxs("div",{className:"mt-4 pt-4 border-t border-white/5 flex flex-col gap-2",children:[o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"number",placeholder:"Gull...",value:b[A.id]||"",onChange:te=>g({...b,[A.id]:parseInt(te.target.value)||0}),className:"flex-1 bg-black/40 border border-white/5 rounded-xl px-3 py-2 text-[10px] font-black text-white focus:border-indigo-500/50 transition-all font-mono"}),o.jsx("button",{onClick:()=>{const te=b[A.id]||0;te>0&&(oG(t,A.id,te),g({...b,[A.id]:0}))},className:"bg-emerald-600/20 hover:bg-emerald-600 text-emerald-400 hover:text-white border border-emerald-500/30 px-3 py-2 rounded-xl text-[8px] font-black uppercase transition-all",children:"GI GULL"})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("select",{value:((ue=w[A.id])==null?void 0:ue.resourceId)||"",onChange:te=>{var Ce;return k({...w,[A.id]:{resourceId:te.target.value,amount:((Ce=w[A.id])==null?void 0:Ce.amount)||10}})},className:"flex-[2] bg-black/40 border border-white/5 rounded-xl px-2 py-2 text-[10px] font-bold text-amber-300 focus:border-amber-500/50 transition-all cursor-pointer",children:[o.jsx("option",{value:"",children:"Velg Ressurs..."}),Object.entries(Rt).map(([te,Ce])=>o.jsxs("option",{value:te,children:[Ce.icon," ",Ce.label]},te))]}),o.jsx("input",{type:"number",placeholder:"#",value:((ie=w[A.id])==null?void 0:ie.amount)||10,onChange:te=>{var Ce;return k({...w,[A.id]:{resourceId:((Ce=w[A.id])==null?void 0:Ce.resourceId)||"",amount:parseInt(te.target.value)||1}})},className:"w-12 bg-black/40 border border-white/5 rounded-xl px-2 py-2 text-[10px] font-black text-white focus:border-amber-500/50 transition-all font-mono text-center"}),o.jsx("button",{onClick:()=>{const te=w[A.id];te&&te.resourceId&&te.amount>0&&(cG(t,A.id,te.resourceId,te.amount),k({...w,[A.id]:{resourceId:"",amount:10}}))},className:"bg-amber-600/20 hover:bg-amber-600 text-amber-400 hover:text-white border border-amber-500/30 px-3 py-2 rounded-xl text-[8px] font-black uppercase transition-all",children:"GI RESSURS"})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("select",{value:((q=p[A.id])==null?void 0:q.itemId)||"",onChange:te=>{var Ce;return x({...p,[A.id]:{itemId:te.target.value,amount:((Ce=p[A.id])==null?void 0:Ce.amount)||1}})},className:"flex-[2] bg-black/40 border border-white/5 rounded-xl px-2 py-2 text-[10px] font-bold text-slate-300 focus:border-indigo-500/50 transition-all cursor-pointer",children:[o.jsx("option",{value:"",children:"Velg Gjenstand..."}),Object.values(Oe).map(te=>o.jsxs("option",{value:te.id,children:[te.icon," ",te.name]},te.id))]}),o.jsx("input",{type:"number",placeholder:"#",value:((ye=p[A.id])==null?void 0:ye.amount)||1,onChange:te=>{var Ce;return x({...p,[A.id]:{itemId:((Ce=p[A.id])==null?void 0:Ce.itemId)||"",amount:parseInt(te.target.value)||1}})},className:"w-12 bg-black/40 border border-white/5 rounded-xl px-2 py-2 text-[10px] font-black text-white focus:border-indigo-500/50 transition-all font-mono text-center"}),o.jsx("button",{onClick:()=>{const te=p[A.id];te&&te.itemId&&te.amount>0&&(lG(t,A.id,te.itemId,te.amount),x({...p,[A.id]:{itemId:"",amount:1}}))},className:"bg-indigo-600/20 hover:bg-indigo-600 text-indigo-400 hover:text-white border border-indigo-500/30 px-3 py-2 rounded-xl text-[8px] font-black uppercase transition-all",children:"GI ITEM"})]})]})]},A.id)}),Object.keys(n.players||{}).length===0&&o.jsxs("div",{className:"col-span-full py-20 text-center border-2 border-dashed border-white/5 rounded-[3rem]",children:[o.jsx("span",{className:"text-6xl block mb-4 opacity-20",children:""}),o.jsx("p",{className:"text-slate-500 font-bold uppercase tracking-widest text-xs",children:"Venter p at understter skal ankomme..."})]})]})]}),((Ox=n.world)==null?void 0:Ox.settlement)&&o.jsxs("section",{className:"bg-indigo-900/10 border border-indigo-500/10 p-10 rounded-[3rem] relative overflow-hidden group",children:[o.jsxs("div",{className:"relative z-10",children:[o.jsxs("h2",{className:"text-3xl font-black text-white mb-8 tracking-tighter flex items-center justify-between",children:["Landsbyutvikling",o.jsx("span",{className:"text-xs font-black uppercase tracking-widest text-indigo-400 bg-indigo-500/10 px-4 py-2 rounded-full",children:"Status Rapport"})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:Object.values(((Dx=(Mx=n.world)==null?void 0:Mx.settlement)==null?void 0:Dx.buildings)||{}).map(A=>{const z=Kt[A.id],W=A.progress/(A.target||200)*100;return o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between items-end",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-black text-white uppercase",children:z==null?void 0:z.name}),o.jsxs("p",{className:"text-[10px] text-slate-500 font-bold tracking-tight",children:["Niv ",A.level]})]}),o.jsxs("span",{className:"text-xs font-mono text-indigo-500",children:[Object.values(A.progress||{}).reduce((se,ue)=>se+ue,0)," / ",A.target||200]})]}),o.jsxs("div",{className:"h-4 bg-black/40 rounded-full overflow-hidden border border-white/5 relative group/progress",children:[o.jsx("div",{className:"h-full bg-gradient-to-r from-indigo-600 via-indigo-400 to-fuchsia-500 transition-all duration-1000 shadow-[0_0_15px_rgba(99,102,241,0.4)] relative",style:{width:`${W}%`},children:o.jsx("div",{className:"absolute inset-0 bg-white/20 animate-pulse"})}),o.jsxs("div",{className:"absolute inset-0 opacity-0 group-hover/progress:opacity-100 transition-opacity flex justify-between items-center px-1 pointer-events-none",children:[o.jsx("button",{onClick:se=>{se.stopPropagation(),$(A.id,-1)},className:"w-5 h-5 bg-white/10 hover:bg-rose-500 text-white rounded-full flex items-center justify-center text-[10px] font-black pointer-events-auto transition-all",children:"-"}),o.jsx("button",{onClick:se=>{se.stopPropagation(),$(A.id,1)},className:"w-5 h-5 bg-white/10 hover:bg-emerald-500 text-white rounded-full flex items-center justify-center text-[10px] font-black pointer-events-auto transition-all",children:"+"})]})]})]},A.id)})})]}),o.jsx("div",{className:"absolute top-[-20%] right-[-10%] text-[15rem] text-indigo-500 opacity-[0.03] pointer-events-none group-hover:rotate-6 transition-transform duration-[3000ms]",children:""})]})]})})]}),o.jsxs("aside",{className:"w-80 border-l border-white/10 bg-slate-900/50 backdrop-blur-xl flex flex-col z-20 shadow-2xl overflow-hidden",children:[o.jsxs("div",{className:"p-8 border-b border-white/5 bg-black/20 shrink-0",children:[o.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-amber-500 mb-6 flex items-center justify-between",children:["Rikets Formue",o.jsx("div",{className:"w-2 h-2 bg-amber-500 rounded-full animate-pulse shadow-[0_0_10px_rgba(245,158,11,0.5)]"})]}),o.jsxs("div",{className:"space-y-4",children:[Object.values(n.players||{}).sort((A,z)=>(z.resources.gold||0)-(A.resources.gold||0)).slice(0,5).map((A,z)=>o.jsxs("div",{className:"flex justify-between items-center group",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("span",{className:"text-xs font-black text-slate-600 font-mono",children:["#",z+1]}),o.jsx("span",{className:"text-sm font-bold text-white group-hover:translate-x-1 transition-transform",children:A.name})]}),o.jsxs("span",{className:"text-sm font-black text-amber-400",children:[A.resources.gold,""]})]},A.id)),Object.keys(n.players||{}).length===0&&o.jsx("p",{className:"text-[10px] text-slate-600 font-bold italic text-center py-4",children:"Ingen data tilgjengelig..."})]})]}),o.jsxs("div",{className:"p-8 border-b border-white/5 shrink-0",children:[o.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-indigo-400 mb-6",children:"Markedsanalyse"}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[Object.entries(n.market||{}).slice(0,4).map(([A,z])=>{const W=Rt[A]||{label:A};return o.jsxs("div",{className:"bg-white/5 p-3 rounded-xl border border-white/5",children:[o.jsx("div",{className:"text-[8px] font-black uppercase text-slate-500 mb-1",children:W.label}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-xs font-black text-white",children:z.stock}),o.jsxs("span",{className:"text-[10px] font-mono text-emerald-400",children:[z.price.toFixed(1),"g"]})]})]},A)}),Object.entries(n.market||{}).slice(0,4).length===0&&o.jsx("div",{className:"col-span-2 text-[10px] text-slate-600 font-bold italic text-center py-4",children:"Ingen markedsdata..."})]})]}),o.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[o.jsx("div",{className:"p-8 pb-4 shrink-0",children:o.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-rose-500 flex items-center gap-2",children:[o.jsx("span",{className:"w-2 h-2 bg-rose-600 rounded-full animate-pulse shadow-[0_0_10px_rgba(225,29,72,0.5)]"}),"Global Logg"]})}),o.jsxs("div",{className:"flex-1 overflow-y-auto px-6 space-y-3 pb-8 custom-scrollbar",children:[M(n.messages).slice().reverse().map((A,z)=>o.jsx("div",{className:"bg-indigo-950/20 border-l-2 border-indigo-500/50 p-4 rounded-r-2xl animate-in slide-in-from-right-4 duration-300",children:o.jsx("p",{className:"text-[10px] font-medium leading-relaxed text-slate-400 antialiased italic font-serif opacity-80",children:typeof A=="object"?JSON.stringify(A):A})},z)),M(n.messages).length===0&&o.jsxs("div",{className:"h-full flex flex-col items-center justify-center opacity-20 py-20",children:[o.jsx("span",{className:"text-4xl mb-4",children:""}),o.jsx("p",{className:"text-[8px] font-black uppercase tracking-[0.2em]",children:"Arkivet er tomt"})]})]})]})]}),o.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .custom-scrollbar::-webkit-scrollbar {
                    width: 4px;
                }
                .custom-scrollbar::-webkit-scrollbar-track {
                    background: transparent;
                }
                .custom-scrollbar::-webkit-scrollbar-thumb {
                    background: rgba(255, 255, 255, 0.1);
                    border-radius: 10px;
                }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover {
                    background: rgba(255, 255, 255, 0.2);
                }
                .no-scrollbar::-webkit-scrollbar {
                    display: none;
                }
            `}})]})};function p$(t,e){const{user:n,authLoading:s}=Cf(),[i,r]=_.useState(null),[a,l]=_.useState(null),[c,u]=_.useState({}),[d,f]=_.useState("LOBBY"),[h,m]=_.useState({}),[v,y]=_.useState({}),[b,g]=_.useState([]),[p,x]=_.useState(null),[w,k]=_.useState({}),[S,N]=_.useState({}),[T,E]=_.useState(!1),[j,R]=_.useState(!1),[I,V]=_.useState(!1),B=_.useRef(null),O=_.useRef(null);_.useEffect(()=>{if(s)return;const M=localStorage.getItem("sim_player_id");let C=e;if(C||(n!=null&&n.uid?C=n.uid:C=M),!C||!t)return;const U=`simulation_rooms/${t}`,K=L(P,`${U}/players/${C}`),J=We(K,Fe=>{if(E(!0),Fe.exists()){B.current&&(clearTimeout(B.current),B.current=null);const ze=Fe.val();if(t==="TEST"&&ze.regionId==="unassigned"&&ze.role!=="KING"){const Pc=Math.random()>.5?"region_east":"region_west";ne(K,{regionId:Pc})}const So={...ze,id:C};r(So),O.current=So,R(!0)}else j?B.current||(B.current=setTimeout(()=>{V(!0),r(null),R(!1),O.current=null},5e3)):r(null)}),H=L(P,`${U}/world`),$=We(H,Fe=>{const ze=Fe.val();ze&&l(ze)}),F=L(P,`${U}/status`),Q=We(F,Fe=>{const ze=Fe.val();ze&&f(ze||"LOBBY")}),ce=L(P,`${U}/markets`),ve=We(ce,Fe=>{const ze=Fe.val();ze&&m(ze)}),de=L(P,`${U}/messages`),Ze=We(de,Fe=>{const ze=Fe.val();ze&&g(ze)}),X=L(P,`${U}/activeVote`),fe=We(X,Fe=>{x(Fe.val())}),me=L(P,`${U}/diplomacy`),yt=We(me,Fe=>{k(Fe.val()||{})}),Xt=L(P,`${U}/trades`),kn=We(Xt,Fe=>{N(Fe.val()||{})}),Gn=L(P,`${U}/players`),$t=We(Gn,Fe=>{const ze=Fe.val()||{};u(ze)}),Xi=L(P,`${U}/regions`),Qi=We(Xi,Fe=>{y(Fe.val()||{})});return()=>{J(),$(),Q(),ve(),Ze(),fe(),yt(),$t(),kn(),Qi()}},[t,e,n==null?void 0:n.uid,s,j]),_.useEffect(()=>{if(!i||!t)return;const M=L(P,`simulation_rooms/${t}/players/${i.id}`),C=L(P,`simulation_rooms/${t}/public_profiles/${i.id}`);Ry(M).update({online:!1}),Ry(C).update({online:!1});const U=setInterval(()=>{const K=Date.now();ne(M,{lastActive:K,online:!0}),ne(C,{lastActive:K,online:!0})},3e4);return ne(M,{lastActive:Date.now(),online:!0}),ne(C,{lastActive:Date.now(),online:!0}),()=>clearInterval(U)},[t,i==null?void 0:i.id]),_.useEffect(()=>{if(!t||!t.startsWith("v"))return;const M=localStorage.getItem("nexus_active_vessel");if(M)try{const C=JSON.parse(M);if(C.id===t){console.log("Nexus Vessel Detected. Injecting Mock Data...",C);const U={id:C.id,uid:(n==null?void 0:n.uid)||"nexus_user",name:C.name,role:C.role.toUpperCase(),regionId:"nexus_region",resources:{gold:C.gold,grain:100,flour:0,bread:5,wood:50,plank:0,iron_ore:0,iron_ingot:0,stone:0,swords:0,armor:0,favor:0,wool:0,cloth:0,honey:0,meat:0,glass:0,manpower:10,egg:0,omelette:0},stats:{xp:0,level:1,reputation:50,contribution:0},status:{hp:C.health,morale:100,stamina:100,legitimacy:100,authority:100,loyalty:100,isJailed:!1,isFrozen:!1},equipment:{},skills:{FARMING:{level:1,xp:0,maxXp:100},WOODCUTTING:{level:1,xp:0,maxXp:100},MINING:{level:1,xp:0,maxXp:100},CRAFTING:{level:1,xp:0,maxXp:100},STEWARDSHIP:{level:1,xp:0,maxXp:100},COMBAT:{level:1,xp:0,maxXp:100},TRADING:{level:1,xp:0,maxXp:100},THEOLOGY:{level:1,xp:0,maxXp:100}},upgrades:[],lastActive:Date.now()};r(U),R(!0),E(!0),f("PLAYING"),l({year:1250,season:"Spring",weather:"Clear",gameTick:100,lastTickAt:Date.now(),taxRateDetails:{kingTax:10},settlement:{buildings:{}}})}}catch(C){console.error("Failed to parse Nexus vessel data",C)}},[t,n==null?void 0:n.uid]);const D=Object.values(c||{}).filter(M=>M.online&&Date.now()-(M.lastActive||0)<6e4).length;return TA(t,d,a,D),{player:i,world:a,players:c,roomStatus:d,markets:h,regions:v,messages:b,activeVote:p,diplomacy:w,trades:S,hasAttemptedPlayerLoad:T,hasActiveSession:j,isRetired:I,setIsRetired:V,setPlayer:r,lastValidPlayer:O.current}}function OA(t,e,n,s,i,r,a){const[l,c]=_.useState(null),[u,d]=_.useState(null);_.useEffect(()=>{if(l){const m=setTimeout(()=>{console.warn("[useSimulationActions] Self-Healing: Resetting stuck loading state:",l),c(null)},5e3);return()=>clearTimeout(m)}},[l]);const f=_.useCallback(()=>{d(null)},[]),h=_.useCallback(async m=>{var x;if(!t||!e||l)return;const v=typeof m=="string"?m:m.type,y=typeof m=="object"?m.method:null;if(["WORK","CHOP","CRAFT","DEFEND","EXPLORE","MINE","QUARRY","PATROL","FORAGE","REFINE","SMELT","BAKE","WEAVE","MIX","PLANT","HARVEST","GATHER_WOOL","HUNT","SAWMILL","MOUNT_HORSE"].includes(v)&&!a&&!m.performance){const w=(n==null?void 0:n.season)||"Spring",k=(n==null?void 0:n.weather)||"Clear",S=(n==null?void 0:n.gameTick)||0,N=jA(e,m,w,k,S);if(!N.success){alert(`Du har ikke rd til dette: ${N.reason}`),d({success:!1,timestamp:Date.now(),message:`Kan ikke utfre: ${N.reason}`,utbytte:[],xp:[],durability:[]});return}let T=v;if(v==="REFINE"){const R=m.recipeId;(R==="iron_ingot"||R==="glass"||R==="smelt")&&(T="SMELT"),(R==="bread"||R==="pie"||R==="mead"||R==="bake")&&(T="BAKE"),(R==="cloth"||R==="weave")&&(T="WEAVE"),R==="plank"&&(T="SAWMILL"),["minor_stamina_potion","herbal_balm","focus_brew","strength_tincture","masters_draught","elixir_of_life"].includes(R)&&(T="MIX")}v==="CRAFT"&&m.subType==="omelette"&&(T="BAKE");const j=(e.activeProcesses||[]).find(R=>{var I;return(R.locationId===m.locationId||m.locationId&&((I=R.locationId)==null?void 0:I.startsWith(m.locationId)))&&R.readyAt<=Date.now()});if(!(v==="REFINE"&&m.recipeId==="flour"||v==="HARVEST"&&((j==null?void 0:j.type)==="MILL"||(j==null?void 0:j.type)==="CRAFT"))){s(T),y&&i(y),r(m),d(null);return}}const g=v==="EQUIP_ITEM"||v==="UNEQUIP_ITEM"||v==="CONSUME";m.performance&&!g&&(s(null),r(null),i(null)),g||c(v);const p=new Promise((w,k)=>{setTimeout(()=>k(new Error("Handlingen tok for lang tid (Timeout)")),3e4)});try{const w=await Promise.race([CA(t,e.id,m),p]);(!g||v==="CONSUME")&&(w.data?d(w.data):w.success||d({success:!1,timestamp:Date.now(),message:`Handlingen feilet: ${((x=w.error)==null?void 0:x.message)||w.error||"Ukjent feil"}`,utbytte:[],xp:[],durability:[]}))}catch(w){console.error("Action Timeout/Error:",w),g||d({success:!1,timestamp:Date.now(),message:` ${w.message||"Ukjent feil"}`,utbytte:[],xp:[],durability:[]})}finally{g||c(null),s(null),r(null),i(null)}},[t,e,l,n,a,s,i,r]);return{actionLoading:l,actionResult:u,handleAction:h,handleClearActionResult:f,setActionLoading:c}}const qp=({resource:t,amount:e,size:n="md",showLabel:s=!1})=>{const i=Rt[t]||{label:t,icon:""},r={sm:"text-xl",md:"text-3xl",lg:"text-7xl"};return o.jsxs("div",{className:"flex items-center gap-2",title:i.label,children:[o.jsx("span",{className:`${r[n]}`,children:i.icon}),o.jsxs("div",{className:"flex flex-col",children:[s&&o.jsx("span",{className:"text-xs uppercase text-game-stone_light font-bold tracking-wider",children:i.label}),e!==void 0&&o.jsx("span",{className:`font-mono font-bold text-white ${n==="lg"?"text-xl":"text-sm"}`,children:e.toLocaleString()})]})]})},s_=(t,e=800)=>{const[n,s]=_.useState(t),i=_.useRef(t);return _.useEffect(()=>{if(i.current===t)return;const r=i.current,a=t;let l=null;const c=u=>{l||(l=u);const d=Math.min((u-l)/e,1);s(r+(a-r)*d),d<1?requestAnimationFrame(c):i.current=t};requestAnimationFrame(c)},[t,e]),n},g$=({room:t,player:e,onAction:n})=>{var T,E,j,R,I,V,B,O,D,M,C;const{activeTab:s,setActiveTab:i}=ql(),{playSfx:r}=Kg(),[a,l]=_.useState(!1),[c,u]=_.useState({tick:((T=t.world)==null?void 0:T.gameTick)||0,time:Date.now()});_.useEffect(()=>{var U,K;((U=t.world)==null?void 0:U.gameTick)!==c.tick&&u({tick:((K=t.world)==null?void 0:K.gameTick)||0,time:Date.now()})},[(E=t.world)==null?void 0:E.gameTick,c.tick]);const d=(j=t.regions)==null?void 0:j[e.regionId||"capital"],f=(((R=d==null?void 0:d.coup)==null?void 0:R.bribeProgress)||0)>0||!!(d!=null&&d.activeElection);_.useEffect(()=>{const U=K=>{if(K.target instanceof HTMLInputElement||K.target instanceof HTMLTextAreaElement)return;const J=K.key.toLowerCase(),H={m:"MAP",l:"ACTIVITY",p:"PROFILE",i:"INVENTORY",f:"SKILLS",d:"DIPLOMACY",h:"HIERARCHY"};if(H[J]){if(J==="d"&&e.role==="PEASANT")return;i(H[J]),r("ui_click.ogg")}};return window.addEventListener("keydown",U),()=>window.removeEventListener("keydown",U)},[i,e.role,r]);const[,h]=_.useState(0);_.useEffect(()=>{const U=setInterval(()=>h(K=>K+1),1e3);return()=>clearInterval(U)},[]);const m=e.status.stamina||0,v=e.status.hp||0,y=e.stats.xp||0,b=e.stats.level||1,g=Hd[b]||1e3,p=Math.min(100,y/g*100),x=s_(m),w=s_(v),k=[{id:"MAP",label:"Kart",icon:KU,short:"M"},{id:"ACTIVITY",label:"Live",icon:nc,short:"L"},{id:"INVENTORY",label:"Eiendeler",icon:tH,short:"I"},{id:"SKILLS",label:"Ferdigheter",icon:oH,short:"F"},...e.role!=="PEASANT"?[{id:"DIPLOMACY",label:"Diplomati",icon:nc,short:"D"}]:[],{id:"HIERARCHY",label:"Samfunn",icon:PU,short:"H"}],S=((I=t.world)==null?void 0:I.year)||1100,N=((B=Pn[(V=t.world)==null?void 0:V.season])==null?void 0:B.label)||((O=t.world)==null?void 0:O.season);return o.jsxs("header",{className:"flex-none h-14 md:h-16 border-b border-white/5 bg-slate-950/80 backdrop-blur-xl flex items-center justify-between px-4 md:px-6 z-50 relative shrink-0 transition-all",children:[o.jsxs("div",{className:"flex items-center gap-4 md:gap-6",children:[o.jsxs("div",{className:"flex flex-col",children:[o.jsxs("div",{className:"flex items-baseline gap-2",children:[o.jsx("span",{className:"text-2xl md:text-3xl font-black text-white tracking-tighter leading-none tabular-nums shadow-indigo-500/50 drop-shadow-lg",children:QH(c.tick,c.time)}),o.jsxs("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest hidden sm:inline",children:["R ",S]})]}),o.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold uppercase tracking-widest text-slate-400 mt-0.5",children:[o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("span",{className:((D=t.world)==null?void 0:D.season)==="Winter"?"text-blue-300 drop-shadow-[0_0_8px_rgba(147,197,253,0.5)]":"text-amber-400 drop-shadow-[0_0_8px_rgba(251,191,36,0.5)]",children:N}),o.jsx("span",{className:"text-slate-600",children:""}),o.jsx("span",{className:"",title:Ls(((M=t.world)==null?void 0:M.gameTick)||0)==="DAY"?"Dag":"Natt",children:Ls(((C=t.world)==null?void 0:C.gameTick)||0)==="DAY"?" Dag":" Natt"})]}),f&&o.jsx("button",{onClick:()=>{i("POLITICS"),r("ui_click.ogg")},className:"flex items-center gap-2 bg-rose-600/20 border border-rose-500/50 px-2 py-0.5 rounded-full animate-pulse group hover:bg-rose-500 hover:text-white transition-all ml-2",title:"Uro i regionen! Klikk for  se politisk status.",children:o.jsx("span",{className:"text-[9px] font-black italic tracking-tighter",children:" URO"})})]})]}),o.jsx("nav",{className:"hidden md:flex items-center gap-1 bg-white/5 p-1 rounded-xl border border-white/5",children:k.map(U=>{const K=s===U.id,J=U.icon;return o.jsxs("button",{onClick:()=>{i(U.id),r("ui_click.ogg")},className:`
                                    relative px-3 py-1.5 md:py-2 rounded-lg flex items-center gap-2 transition-all group overflow-hidden
                                    ${K?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-400 hover:text-white hover:bg-white/5"}
                                `,title:U.label,children:[o.jsx(J,{size:16,className:K?"animate-pulse":""}),o.jsx("span",{className:"hidden xl:block text-xs font-bold uppercase tracking-wider ",children:U.label}),U.short&&o.jsx("span",{className:`text-[9px] absolute top-0.5 right-1 font-mono font-bold transition-opacity hidden xl:block ${K?"text-indigo-300":"text-slate-700 group-hover:text-slate-500"}`,children:U.short})]},U.id)})})]}),o.jsxs("div",{className:"flex items-center gap-3 md:gap-5",children:[e.activeBuffs&&e.activeBuffs.length>0&&o.jsx("div",{className:"flex items-center gap-1 mr-1",children:e.activeBuffs.map(U=>o.jsx(b$,{buff:U},U.id))}),o.jsxs("div",{className:"hidden md:flex items-center bg-slate-900/50 rounded-full border border-white/5 overflow-hidden transition-all duration-300",children:[o.jsxs("button",{onClick:()=>{i("INVENTORY"),r("ui_click.ogg")},className:"flex items-center gap-2 hover:bg-white/5 px-3 py-1.5 transition-colors cursor-pointer group active:scale-95",title:"pne Eiendeler (I)",children:[o.jsx(qp,{resource:"gold",amount:e.resources.gold,size:"sm"}),o.jsx("span",{className:"hidden xl:inline text-[10px] font-black uppercase tracking-widest text-slate-500 group-hover:text-slate-300 transition-colors ml-1",children:"Gull"})]}),o.jsx("div",{className:"w-px h-3 bg-white/10"}),o.jsxs("button",{onClick:()=>{e.resources.bread?(n==null||n({type:"CONSUME",itemId:"bread",isResource:!0}),r("eat.ogg")):(i("INVENTORY"),r("ui_click.ogg"))},disabled:!e.resources.bread,className:`flex items-center gap-2 px-3 py-1.5 transition-all cursor-pointer group border-l border-white/0 active:scale-95 ${e.resources.bread?"hover:bg-emerald-500/10 hover:border-emerald-500/20":"opacity-40 cursor-not-allowed"}`,title:e.resources.bread?"Spis Brd (+20 Stamina)":"Tomt for brd",children:[o.jsx(qp,{resource:"bread",amount:e.resources.bread||0,size:"sm"}),o.jsx("div",{className:"hidden xl:flex flex-col items-start -space-y-1",children:o.jsx("span",{className:`text-[10px] font-black uppercase tracking-widest transition-colors ${e.resources.bread?"text-slate-500 group-hover:text-emerald-400":"text-slate-600"}`,children:e.resources.bread?"Spis":"Tom"})})]})]}),o.jsxs("div",{className:"flex flex-col gap-1 w-20 md:w-24",children:[o.jsxs("div",{className:"h-1 bg-slate-800 rounded-full overflow-hidden relative group",children:[o.jsx(he.div,{className:"absolute inset-y-0 left-0 bg-rose-500 rounded-full",initial:{width:0},animate:{width:`${w}%`}}),o.jsxs("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 flex items-center justify-center text-[8px] font-black text-white bg-black/50 transition-opacity",children:["HP ",Math.round(w),"%"]})]}),o.jsxs("div",{className:"h-1 bg-slate-800 rounded-full overflow-hidden relative group",children:[o.jsx(he.div,{className:"absolute inset-y-0 left-0 bg-amber-400 shadow-[0_0_10px_rgba(251,191,36,0.5)]",initial:{width:0},animate:{width:`${x}%`}}),o.jsxs("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 flex items-center justify-center text-[8px] font-black text-black bg-white/50 transition-opacity",children:["STA ",Math.round(x),"%"]})]}),o.jsx("div",{className:"h-0.5 bg-slate-800/50 rounded-full overflow-hidden relative group mt-0.5",children:o.jsx(he.div,{className:"absolute inset-y-0 left-0 bg-indigo-500",initial:{width:0},animate:{width:`${p}%`}})})]}),o.jsxs("button",{onClick:()=>{i("PROFILE"),r("ui_click.ogg")},className:"group flex items-center gap-3 bg-white/0 hover:bg-white/5 pl-2 pr-1 py-1 rounded-2xl border border-transparent hover:border-white/10 transition-all active:scale-95",title:"Min Karakter (P)",children:[o.jsx("div",{className:"hidden 2xl:flex flex-col items-end",children:o.jsx("span",{className:"text-sm font-black italic tracking-tighter text-white leading-none",children:e.name})}),o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"w-8 h-8 md:w-9 md:h-9 rounded-lg bg-gradient-to-br from-indigo-500 to-purple-600 p-0.5 shadow-lg overflow-hidden group-hover:shadow-indigo-500/20",children:e.avatar?o.jsx("img",{src:e.avatar,alt:"Profile",className:"w-full h-full object-cover rounded-[6px]"}):o.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-900 rounded-[6px] text-base",children:e.role==="KING"?"":""})}),o.jsx("div",{className:"absolute -bottom-1 -right-1 w-4 h-4 bg-slate-900 rounded-full flex items-center justify-center border border-white/10 text-[8px] font-black text-white z-10",children:b})]})]}),o.jsx(x$,{icon:fH,onClick:()=>i("SETTINGS"),title:"Innstillinger"}),o.jsx("button",{className:"md:hidden text-white p-2",onClick:()=>l(!a),children:a?o.jsx(us,{}):o.jsx(WU,{})})]}),o.jsx(Ln,{children:a&&o.jsxs(he.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"absolute top-16 left-0 right-0 bg-slate-900 border-b border-white/10 p-4 shadow-2xl md:hidden flex flex-col gap-2 z-40",children:[k.map(U=>o.jsxs("button",{onClick:()=>{i(U.id),l(!1)},className:`w-full p-4 rounded-xl text-left font-black uppercase flex items-center gap-4 ${s===U.id?"bg-indigo-600 text-white":"bg-white/5 text-slate-400"}`,children:[o.jsx(U.icon,{size:20}),U.label]},U.id)),o.jsx("div",{className:"h-px bg-white/5 my-2"}),o.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 font-bold uppercase tracking-widest px-2",children:[o.jsxs("span",{children:["r ",S]}),o.jsx("span",{children:N})]})]})})]})},x$=({icon:t,onClick:e,title:n,className:s})=>o.jsx("button",{onClick:e,title:n,className:`hidden md:flex p-2 text-slate-400 hover:text-white hover:bg-white/5 rounded-lg transition-all ${s}`,children:o.jsx(t,{size:20})}),b$=({buff:t})=>{const[e,n]=_.useState(Math.max(0,Math.ceil((t.expiresAt-Date.now())/6e4)));return _.useEffect(()=>{const s=setInterval(()=>{const i=Math.max(0,Math.ceil((t.expiresAt-Date.now())/6e4));n(i)},1e4);return()=>clearInterval(s)},[t.expiresAt]),Date.now()>t.expiresAt?null:o.jsxs("div",{className:"group relative flex items-center justify-center w-8 h-8 rounded-full bg-emerald-500/10 border border-emerald-500/30 text-emerald-400 cursor-help",children:[o.jsx("span",{className:"text-lg",children:""}),o.jsxs("span",{className:"absolute -bottom-1 -right-1 text-[8px] font-black bg-slate-900 px-1 rounded-full border border-white/10",children:[e,"m"]}),o.jsxs("div",{className:"absolute top-full mt-2 left-1/2 -translate-x-1/2 bg-slate-900 p-2 rounded-lg border border-white/10 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none w-32 text-center z-50",children:[o.jsx("p",{className:"text-[10px] font-bold text-white mb-0.5",children:t.label}),o.jsxs("p",{className:"text-[9px] text-emerald-400",children:[t.value*100,"% mindre stamina"]})]})]})},MA=Ge.memo(({src:t,placeholderSrc:e,alt:n,className:s,imgClassName:i="object-cover w-full h-full",priority:r=!1,disableMotion:a=!1})=>{const[l,c]=_.useState(!1),[u,d]=_.useState(e||t);return _.useEffect(()=>{c(!1),e&&d(e);const f=new Image;f.src=t,f.onload=()=>{d(t),c(!0)}},[t,e]),o.jsx("div",{className:`relative overflow-hidden ${s}`,children:o.jsx(he.img,{src:u,alt:n,loading:r?"eager":"lazy",className:`${i} transition-all duration-700 ease-in-out`,initial:{filter:"blur(20px)",scale:a?1:1.1},animate:{filter:l?"blur(0px)":"blur(20px)",scale:a||l?1:1.1},style:{willChange:"filter, transform"}},t)})});MA.displayName="ProgressiveImage";const wr=[{id:"fields",label:"krene",icon:"",top:"22%",left:"42%",vest:{top:"35%",left:"70%"},ost:{top:"35%",left:"45%"},roles:["PEASANT","BARON","KING"],actions:[],isHub:!0},{id:"forest",label:"Skogen",icon:"",top:"25%",left:"80%",vest:{top:"15%",left:"60%"},ost:{top:"27%",left:"14%"},roles:["PEASANT","BARON","KING"],actions:[],isHub:!0},{id:"castle",label:"Slottet",icon:"",top:"66%",left:"86%",vest:{top:"40%",left:"30%"},ost:{top:"40%",left:"68%"},roles:["PEASANT","BARON","KING","SOLDIER"],actions:[{id:"OPEN_CONSTRUCTION",label:"Bidra til bygging",cost:"Ressurser"},{id:"OPEN_TAXATION",label:"Skattekammeret",cost:"Baron Only",roleReq:"BARON"}],isHub:!0},{id:"peasant_farm",label:"Husmannsplassen",icon:"",top:"30%",left:"60%",vest:{top:"85%",left:"72%"},ost:{top:"75%",left:"30%"},roles:["PEASANT","BARON"],actions:[],isHub:!0},{id:"market",label:"Markedet",icon:"",top:"70%",left:"25%",vest:{top:"70%",left:"37%"},ost:{top:"70%",left:"63%"},roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],actions:[{id:"MARKET_VIEW",label:"pne Handel",cost:"Gratis"},{id:"JOIN_ROLE",label:"Bli Kjpmann",cost:"500g + Niv 3",targetRole:"MERCHANT"}]},{id:"village",label:"Landsbyen",icon:"",top:"42%",left:"42%",vest:{top:"50%",left:"52%"},ost:{top:"55%",left:"44%"},roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],actions:[],isHub:!0},{id:"mine",label:"Gruve-distriktet",icon:"",top:"12%",left:"25%",vest:{top:"13%",left:"39%"},ost:{top:"20%",left:"60%"},roles:["PEASANT","BARON","KING"],actions:[],isHub:!0},{id:"monastery",label:"Klosteret",icon:"",top:"16%",left:"55%",vest:{top:"50%",left:"78%"},ost:{top:"50%",left:"27%"},roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],actions:[],isHub:!0},{id:"border",label:"Grensen",icon:"",top:"85%",left:"80%",vest:{top:"15%",left:"10%"},ost:{top:"15%",left:"10%"},roles:["BARON"],actions:[{id:"RAID",label:"Plyndre Nabo",cost:"-40"}]},{id:"throne_room",label:"Tronsalen",icon:"",top:"40%",left:"50%",roles:["KING"],parentId:"castle",actions:[{id:"DECREE",label:"Utsted Dekret",cost:"King Only"}]},{id:"treasury",label:"Skattekammeret",icon:"",top:"55%",left:"65%",roles:["BARON","KING"],parentId:"castle",actions:[{id:"OPEN_TAXATION",label:"pne Skattekammeret",cost:"Administrasjon"}]},{id:"barracks",label:"Kasernen",icon:"",top:"60%",left:"30%",roles:["PEASANT","BARON","KING","SOLDIER"],parentId:"castle",actions:[{id:"DRAFT",label:"Verve Soldater",cost:"-5g -10"},{id:"JOIN_ROLE",label:"Bli Soldat",cost:"200g + Niv 3",targetRole:"SOLDIER"}]},{id:"royal_chambers",label:"Kongens Kammer",icon:"",top:"30%",left:"70%",roles:["BARON","KING"],parentId:"castle",actions:[{id:"REST",label:"Hvile i Kammeret",cost:"Full rest + Velvre"}]},{id:"castle_construction",label:"Byggeplass",icon:"",top:"75%",left:"80%",roles:["PEASANT","BARON","KING","SOLDIER"],parentId:"castle",actions:[{id:"OPEN_CONSTRUCTION",label:"Bidra til bygging",cost:"Ressurser"}]},{id:"war_room",label:"Krigsrommet",icon:"",top:"25%",left:"35%",roles:["BARON","KING","SOLDIER"],parentId:"castle",actions:[{id:"OPEN_WAR_ROOM",label:"pne Krigsrommet",cost:"Gratis"}]},{id:"village_square",label:"Landsbytorg",icon:"",top:"50%",left:"50%",village:{top:"48%",left:"50%"},roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],parentId:"village",actions:[{id:"REST",label:"Hvile p torget",cost:"+10"}]},{id:"tavern",label:"Vertshuset",icon:"",top:"35%",left:"75%",village:{top:"75%",left:"80%"},roles:["PEASANT","BARON","KING","SOLDIER"],parentId:"village",actions:[{id:"ENTER_TAVERN",label:"G inn",cost:"Gratis"},{id:"REST_BASIC",label:"Hvile i Salen",cost:"Gratis"},{id:"REST_COMFY",label:"Bestille Kammer",cost:"-5g"},{id:"REST_ROYAL",label:"Kongelig Suite",cost:"-20g"}],isHub:!0,isInterior:!0},{id:"bakery",label:"Bakeri",icon:"",top:"80%",left:"30%",village:{top:"38%",left:"35%"},roles:["PEASANT","BARON","KING"],parentId:"village",actions:[],isHub:!0,isInterior:!0},{id:"great_forge",label:"Storsmie",icon:"",top:"35%",left:"15%",village:{top:"48%",left:"23%"},roles:["PEASANT","BARON","KING"],parentId:"village",actions:[],isHub:!0,isInterior:!0},{id:"windmill",label:"Vindmlle",icon:"",top:"20%",left:"37%",village:{top:"25%",left:"17%"},roles:["PEASANT","BARON","KING"],parentId:"village",actions:[{id:"REFINE_flour",label:"Male Mel",cost:"-15 -10korn"}],isHub:!0,isInterior:!0},{id:"smeltery",label:"Smeltehytte",icon:"",top:"60%",left:"95%",village:{top:"75%",left:"12%"},roles:["PEASANT","BARON","KING"],parentId:"village",actions:[{id:"REFINE_IRON_BASIC",label:"Smelte Jern",cost:"-20 -5malm"},{id:"REFINE_IRON_FAST",label:"Industri-smelting",cost:"-30 -10malm"},{id:"REFINE_STEEL",label:"Smelte Stl",cost:"-50 -20malm"}],isHub:!0,isInterior:!0},{id:"sawmill",label:"Sagbruk",icon:"",top:"55%",left:"15%",village:{top:"70%",left:"45%"},roles:["PEASANT","BARON","KING"],parentId:"village",actions:[{id:"REFINE_PLANK_BASIC",label:"Sag Planker",cost:"-10 -5ved"},{id:"REFINE_PLANK_FAST",label:"Hurtig-saging",cost:"-15 -5ved"}],isHub:!0,isInterior:!0},{id:"weavery",label:"Veveri",icon:"",top:"50%",left:"85%",village:{top:"45%",left:"65%"},roles:["PEASANT","BARON","MERCHANT"],parentId:"village",actions:[],isHub:!0,isInterior:!0},{id:"watchtower",label:"Vaktrn",icon:"",top:"15%",left:"68%",village:{top:"25%",left:"82%"},roles:["BARON","SOLDIER","KING"],parentId:"village",actions:[],isHub:!0,isInterior:!0},{id:"stables",label:"Stall",icon:"",top:"80%",left:"80%",village:{top:"45%",left:"90%"},roles:["PEASANT","BARON","SOLDIER","KING","MERCHANT"],parentId:"village",actions:[],isHub:!0,isInterior:!0},{id:"well",label:"Bybrnn",icon:"",top:"69%",left:"60%",village:{top:"48%",left:"50%"},roles:["PEASANT","BARON","KING"],parentId:"village",actions:[],isHub:!0},{id:"apothecary",label:"Apoteker",icon:"",top:"20%",left:"82%",village:{top:"60%",left:"92%"},roles:["PEASANT","BARON","KING","MERCHANT"],parentId:"village",actions:[],isHub:!0,isInterior:!0},{id:"forge_anvil",label:"Ambolt",icon:"",top:"50%",left:"40%",roles:["PEASANT","BARON","KING"],parentId:"great_forge",actions:[{id:"OPEN_CRAFTING",label:"pne Smia",cost:"Gratis"}]},{id:"forge_upgrades",label:"Tegneark",icon:"",top:"40%",left:"75%",roles:["PEASANT","BARON","KING"],parentId:"great_forge",actions:[{id:"BUILDING_UPGRADE_great_forge",label:"Oppgrader Smia",cost:"Varierer"}]},{id:"bakery_oven",label:"Bakerovn",icon:"",top:"50%",left:"50%",roles:["PEASANT","BARON","KING"],parentId:"bakery",actions:[{id:"REFINE",label:"pne Bakeriet",cost:"Gratis"}]},{id:"bakery_upgrades",label:"Tegneark",icon:"",top:"30%",left:"80%",roles:["PEASANT","BARON","KING"],parentId:"bakery",actions:[{id:"BUILDING_UPGRADE_bakery",label:"Oppgrader Bakeriet",cost:"Varierer"}]},{id:"windmill_stones",label:"Kvernsteiner",icon:"",top:"50%",left:"40%",roles:["PEASANT","BARON","KING"],parentId:"windmill",actions:[{id:"REFINE",label:"pne Mlla",cost:"Gratis"}]},{id:"windmill_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON","KING"],parentId:"windmill",actions:[{id:"BUILDING_UPGRADE_windmill",label:"Oppgrader Mlla",cost:"Varierer"}]},{id:"sawmill_blade",label:"Saga",icon:"",top:"50%",left:"40%",roles:["PEASANT","BARON","KING"],parentId:"sawmill",actions:[{id:"REFINE",label:"pne Sagbruket",cost:"Gratis"}]},{id:"sawmill_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON","KING"],parentId:"sawmill",actions:[{id:"BUILDING_UPGRADE_sawmill",label:"Oppgrader Sagbruket",cost:"Varierer"}]},{id:"smeltery_furnace",label:"Smelteovn",icon:"",top:"50%",left:"30%",roles:["PEASANT","BARON","KING"],parentId:"smeltery",actions:[{id:"REFINE",label:"pne Smeltehytta",cost:"Gratis"}]},{id:"smeltery_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON","KING"],parentId:"smeltery",actions:[{id:"BUILDING_UPGRADE_smeltery",label:"Oppgrader Smeltehytta",cost:"Varierer"}]},{id:"weavery_loom",label:"Vevstol",icon:"",top:"50%",left:"40%",roles:["PEASANT","BARON","MERCHANT"],parentId:"weavery",actions:[{id:"REFINE",label:"pne Veveriet",cost:"Gratis"}]},{id:"weavery_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON"],parentId:"weavery",actions:[{id:"BUILDING_UPGRADE_weavery",label:"Oppgrader Veveriet",cost:"Varierer"}]},{id:"stables_stall",label:"Stallplass",icon:"",top:"50%",left:"40%",roles:["PEASANT","BARON","SOLDIER","KING","MERCHANT"],parentId:"stables",actions:[{id:"MOUNT_HORSE",label:"Ri ut",cost:"-5"}]},{id:"stables_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON","KING","MERCHANT"],parentId:"stables",actions:[{id:"BUILDING_UPGRADE_stables",label:"Oppgrader Stallen",cost:"Varierer"}]},{id:"watchtower_top",label:"Vaktpost",icon:"",top:"30%",left:"50%",roles:["PEASANT","BARON","SOLDIER"],parentId:"watchtower",actions:[{id:"OPEN_GARRISON",label:"pne Garnisonen",cost:"Gratis"},{id:"PATROL",label:"Patruljer",cost:"-30"}]},{id:"watchtower_upgrades",label:"Tegneark",icon:"",top:"50%",left:"80%",roles:["BARON"],parentId:"watchtower",actions:[{id:"BUILDING_UPGRADE_watchtower",label:"Oppgrader Trnet",cost:"Varierer"}]},{id:"apothecary_bench",label:"Arbeidsbenk",icon:"",top:"50%",left:"40%",roles:["PEASANT","BARON","KING"],parentId:"apothecary",actions:[{id:"OPEN_CRAFTING",label:"pne Apoteket",cost:"Gratis"}]},{id:"apothecary_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON","KING"],parentId:"apothecary",actions:[{id:"BUILDING_UPGRADE_apothecary",label:"Oppgrader Apoteket",cost:"Varierer"}]},{id:"well_water",label:"Brnnkum",icon:"",top:"50%",left:"50%",roles:["PEASANT","BARON","KING"],parentId:"well",actions:[{id:"GATHER_WATER",label:"Hent Vann",cost:"-10"}]},{id:"well_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON","KING"],parentId:"well",actions:[{id:"BUILDING_UPGRADE_well",label:"Oppgrader Brnnen",cost:"Varierer"}]},{id:"tavern_bar",label:"Baren",icon:"",top:"30%",left:"30%",roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],parentId:"tavern",actions:[{id:"OPEN_TAVERN_MENU",label:"Se Menykart",cost:"Gratis"}]},{id:"tavern_gambling",label:"Spillebordet",icon:"",top:"50%",left:"50%",roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],parentId:"tavern",actions:[{id:"OPEN_DICE_GAME",label:"Spill Terninger",cost:"Min. 0.5g"}]},{id:"tavern_resource_wheel",label:"Soga-hjulet",icon:"",top:"65%",left:"75%",roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],parentId:"tavern",actions:[{id:"OPEN_RESOURCE_GAME",label:"Sats Ressurser",cost:"Varer"}]},{id:"tavern_gossip",label:"Lokalbefolkningen",icon:"",top:"40%",left:"70%",roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],parentId:"tavern",actions:[{id:"CHAT_LOCAL",label:"Snakk med folk",cost:"Gratis"}]},{id:"tavern_upgrades",label:"Tegneark",icon:"",top:"25%",left:"85%",roles:["PEASANT","BARON","KING"],parentId:"tavern",actions:[{id:"BUILDING_UPGRADE_tavern",label:"Oppgrader Vertshuset",cost:"Varierer"}]},{id:"grain_fields",label:"Kornker",icon:"",top:"50%",left:"20%",roles:["PEASANT","BARON","KING"],parentId:"fields",actions:[{id:"PLANT",label:"S Korn",cost:"-5 korn -25"}]},{id:"sheep_pasture",label:"Sauebeite",icon:"",top:"35%",left:"65%",roles:["PEASANT","BARON","KING"],parentId:"fields",actions:[{id:"GATHER_WOOL",label:"Klipp Sauer",cost:"-15"}]},{id:"beehives",label:"Bikuber",icon:"",top:"75%",left:"70%",roles:["PEASANT","BARON","KING"],parentId:"fields",actions:[{id:"GATHER_HONEY",label:"Samle Honning",cost:"-20"}]},{id:"mine_shaft",label:"Jern-gruva",icon:"",top:"50%",left:"12%",roles:["PEASANT","BARON","KING"],parentId:"mine",actions:[{id:"MINE",label:"Bryte Malm",cost:"-25 -1"}]},{id:"quarry_poi",label:"Steinhuggeriet",icon:"",top:"40%",left:"85%",roles:["PEASANT","BARON","KING"],parentId:"mine",actions:[{id:"QUARRY",label:"Hugge Stein",cost:"-20 -1"}]},{id:"forest_clearing",label:"Hogstfeltet",icon:"",top:"60%",left:"30%",roles:["PEASANT","BARON","KING"],parentId:"forest",actions:[{id:"CHOP",label:"Hugge Ved",cost:"-15 -1"}]},{id:"hunting_grounds",label:"Jaktmarker",icon:"",top:"30%",left:"75%",roles:["PEASANT","BARON","KING"],parentId:"forest",actions:[{id:"HUNT",label:"Dra p Jakt",cost:"-30"}]},{id:"forest_forage",label:"Brplukking",icon:"",top:"60%",left:"90%",roles:["PEASANT","BARON","KING"],parentId:"forest",actions:[{id:"FORAGE",label:"Sanke Mat (Nd)",cost:"-40"}]},{id:"monastery_chapel",label:"Klosterkirken",icon:"",top:"50%",left:"50%",roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],parentId:"monastery",actions:[{id:"PRAY",label:"Be en Bnn",cost:"-15"}]},{id:"farm_house",label:"Inne i Stugo",icon:"",top:"52%",left:"58%",roles:["PEASANT"],parentId:"peasant_farm",actions:[],isHub:!0,isInterior:!0},{id:"stugo_bed",label:"Senga",icon:"",top:"65%",left:"42%",roles:["PEASANT"],parentId:"farm_house",actions:[{id:"SLEEP",label:"Sove tungt",cost:"Full "}]},{id:"stugo_fireplace",label:"Peisen",icon:"",top:"55%",left:"80%",roles:["PEASANT"],parentId:"farm_house",actions:[{id:"EAT",label:"Sitte ved varmen",cost:"-1 +40"}]},{id:"farm_well",label:"Brnnen",icon:"",top:"60%",left:"27%",roles:["PEASANT"],parentId:"peasant_farm",actions:[{id:"REST",label:"Drikke vann",cost:"+5"}]},{id:"farm_upgrade_spot",label:"Tegneark",icon:"",top:"40%",left:"15%",roles:["PEASANT"],parentId:"farm_house",actions:[{id:"BUILDING_UPGRADE_farm_house",label:"Bygg ut grden",cost:"Varierer"}]},{id:"chicken_coop",label:"Hnsehus",icon:"",top:"40%",left:"75%",roles:["PEASANT"],parentId:"peasant_farm",actions:[{id:"OPEN_CHICKEN_COOP",label:"G inn til hnene",cost:"Gratis"}]}],i_=[{id:"pilegrim",name:"Sigurd Pilegrim",role:"Vandrer mot Nidaros",description:"Han sitter masserer sine sre ftter. En bredbremmet hatt med et kamskjell ligger p bordet, og vandringsstaven er slitt glatt av tusenvis av grep.",conversation:{start:{text:"Fred vre med deg, reisende. Kjenner du veien nordover? Mine ftter verker som om jeg har gtt p gldende kull, men sjelen... sjelen trekkes mot Hellig Olavs by.",options:[{label:"Hvorfor denne lange reisen?",nextId:"why"},{label:"Er det farlig langs veien?",nextId:"danger"},{label:"Fortell om kamskjellet.",nextId:"shell"},{label:"Lykke til videre. (G)",nextId:"EXIT"}]},why:{text:"For bot og bedring! Vi brer alle synder, min venn. Men i Nidaros, ved kongens skrin, er himmelen nrmere jorden. Det sies at en pilegrimsferd kan korte ned tiden i skjrsilden med mange r.",options:[{label:"Tror du virkelig p det?",nextId:"believe"},{label:"Hva hper du  finne?",nextId:"hope"}]},believe:{text:"Jeg *m* tro. Jeg har sett halte kaste krykkene og blinde f synet tilbake ved katedralen. Olavs kraft er sterk, selv om han har vrt dd i hundrevis av r. Han er Norges evige konge.",options:[{label:"Fortell om Olav.",nextId:"olav"}]},hope:{text:"Tilgivelse. Og kanskje litt sjelefred. Livet er hardt, vinteren er lang.  vite at man har gjort denne ofringen... det gir styrke.",options:[{label:"Forstelig.",nextId:"start"}]},danger:{text:" ja! Dovrefjell er ndelst. Snstormer kan komme midt p sommeren. Og i dalene lurer landeveisrvere som ser p oss pilegrimer som vandrende pengesekker. Men vi reiser ofte i flokk for beskyttelse.",options:[{label:"Har du blitt ranet?",nextId:"robbed"},{label:"Hvor sover dere?",nextId:"sjelehus"}]},robbed:{text:"Nesten. En gang, nr Gudbrandsdalen, s vi skygger i skogen. Vi sang salmer s hyt vi kunne, og drev dem bort med troens styrke! ...og kanskje fordi vi var frti stykker.",options:[{label:"God taktikk.",nextId:"danger"}]},sjelehus:{text:"Det finnes sjelehus  herberger bygget for Guds skyld  langs ruten. Der fr vi tak over hodet og enkel mat. Ofte deler vi rom med dyrene for varmen.",options:[{label:"Hres... koselig ut.",nextId:"danger"}]},shell:{text:"Ah, Ib-skjellet! Symbolet p St. Jakob. Dette viser at jeg har vandret helt til Santiago de Compostela i Spania. Jeg har sett verden, min venn. Fra nordlyset her til de solbrente slettene i sr.",options:[{label:"Du er en bereist mann.",nextId:"start"}]},olav:{text:"Han falt p Stiklestad i 1030. De sier at da de gravde ham opp et r senere, var kroppen like frisk, og hret og neglene hadde vokst! Det var beviset. Han kristnet oss med sverd, men reddet oss med sin hellighet.",options:[{label:"En mektig legende.",nextId:"start"}]}}},{id:"hansa",name:"Gerhard fra Lbeck",role:"Hansa-kjpmann",description:"Kledd i kostbar ull og pels. Han studerer en lang regnskapsrull med rynket panne og nipper til en vin som ser langt bedre ut enn husets vanlige.",conversation:{start:{text:"*Mumler p tysk* ...zwei schock, drei stck... Ah! En lokal? Si meg, har fiskerne i nord ftt opp farten? Mine skip venter i Bergen. Tid er penger, som vi sier i Lbeck.",options:[{label:"Hvem er du?",nextId:"intro"},{label:"Hvorfor er trrfisken s viktig?",nextId:"stockfish"},{label:"Hva er Hansaen egentlig?",nextId:"hansa_deep"},{label:"Jeg lar deg arbeide. (G)",nextId:"EXIT"}]},intro:{text:"Gerhard, handelsmann av Det Tyske Hanseforbund. Vi srger for at dere fr korn og mel, og at dere fr solgt den... vel, illeluktende fisken deres. En god byttehandel, *nicht wahr*?",options:[{label:"Vi klarer oss vel selv?",nextId:"monitor"},{label:"Takk for kornet.",nextId:"grain"}]},grain:{text:"Ja, det burde dere. Uten vrt baltiske korn ville mange nordmenn sultet nr avlingene svikter. Vi binder Nord-Europa sammen med vre kogger.",options:[{label:"Kogger?",nextId:"cog"}]},monitor:{text:"Haha! Tror du det? Uten oss ville fisken deres rtnet p stranden. Vi har nettverket. Vi har markedene i sr  katolikkene trenger fisk til fasten, og vi leverer.",options:[{label:"Dere tar stor fortjeneste.",nextId:"monopoly"}]},monopoly:{text:"Risiko koster! Stormer, pirater, kriger. Vi tar risikoen, vi tar profitten. Og vi har Kongens velsignelse... og privilegier. Vi dmmer vre egne p Bryggen.",options:[{label:"Egne lover?",nextId:"laws"}]},laws:{text:"Ja. En hanseat dmmes etter hansas lov, ikke norsk lov. Det... skaper litt friksjon med byborgerne, innrmmer jeg. Men handelen m flyte!",options:[{label:"Hres urettferdig ut.",nextId:"start"}]},stockfish:{text:'Det er "Det hvite gullet"! Trket i den kalde norske vinden blir den hard som tre og holder i revis. Perfekt mat for soldater og munker i hele Europa. Vi bytter det mot korn, klr, vin og krydder.',options:[{label:"En viktig ressurs.",nextId:"start"}]},hansa_deep:{text:"Et brorskap av handelsbyer. Lbeck, Hamburg, Rostock, Visby... og vrt kontor i Bergen. Vi beskytter hverandre mot konger som vil skattlegge oss for hardt, og mot sjrvere. Sammen er vi sterkere enn noe kongerike.",options:[{label:"Morsomt at du nevner pirater...",nextId:"pirates"},{label:"Imponerende.",nextId:"start"}]},pirates:{text:"Vitaliebrdrene... en plage! De herjer i stersjen. Men Hansaen har sine egne skip. Vi kan bite fra oss. Ikke tro at en kjpmann ikke kan svinge et sverd.",options:[{label:"Notert.",nextId:"EXIT"}]},cog:{text:"Vre skip. Brede, hye, med plass til enorme mengder last. De er ikke raske som vikingenes langskip, men de bygget vr rikdom. Ett skip kan f hele Bergen med korn.",options:[{label:"Teknologi er makt.",nextId:"start"}]}}},{id:"leilending",name:"Tormod",role:"Sliten Leilending",description:"Hendene hans er grove som bark, og ryggen er byd av r med plying. Han drikker tynt l og ser tankefullt ned i kruset.",conversation:{start:{text:"Enda en hst, enda en landskyld  betale. Livet til en leilending er  s for andre og hste smuler selv. Skl for det.",options:[{label:"Hva er landskyld?",nextId:"rent"},{label:"Hvorfor eier du ikke jorda?",nextId:"own"},{label:"Hvordan var det fr?",nextId:"plague"},{label:"Gr det s drlig? (G)",nextId:"EXIT"}]},rent:{text:"Leieavgiften. Jeg driver grden, men Kirken eier grunnen. Hvert r m jeg gi dem en fjerdedel av kornet, tre skippund smr og to kyr. Det som er igjen... det skal f familien min gjennom vinteren.",options:[{label:"Hva hvis avlingen svikter?",nextId:"fail"},{label:"Hvem bestemmer prisen?",nextId:"laws"}]},fail:{text:"Da sulter vi. Eller vi m lne skorn av jordeieren, og da havner vi dypere i gjeld. Det er en sirkel det er vanskelig  bryte.",options:[{label:"Trist skjebne.",nextId:"start"}]},own:{text:"F bnder eier sin egen jord n. Adelen og Kirken har kjpt opp nesten alt. Men jeg har i det minste *bygslebrev*. S lenge jeg betaler og driver jorda, kan de ikke kaste meg ut. Det er norsk lov.",options:[{label:"En viss trygghet.",nextId:"laws"}]},laws:{text:"Ja, Landsloven til Magnus Lagabte. Den gir oss rettigheter. Jordeieren kan ikke bare ta grden fordi han vil. Og jeg kan kreve at snnen min fr overta bygselen. Vi er ikke slaver, vi er frie menn... bare fattige.",options:[{label:"Viktig forskjell.",nextId:"start"}]},plague:{text:"*Han senker stemmen* Bestefar fortalte om Den Store Dden. Da to av tre dde. Etterp... etterp var det gode tider for de som overlevde. Masse ledig jord! Lav landskyld! N? N er vi mange igjen, og jordeierne strammer grepet.",options:[{label:"degrder?",nextId:"deserted"},{label:"Tidene skifter.",nextId:"start"}]},deserted:{text:"Ja, du kan fortsatt se ruinene i skogen. Grder der folk bodde fr, som n er grodd igjen. Noen sier det spker der, at de dde gr igjen og passer p arveslvet sitt.",options:[{label:"Grss.",nextId:"start"}]}}},{id:"steinhugger",name:"Master William",role:"Engelsk Steinhugger",description:"Han tegner geometriske figurer i slt l p bordet. Fingrene er hvite av steinstv.",conversation:{start:{text:"Ser du? Hvis du lfter buen *her*, og krysser hvelvet *slik*... da kan du bygge hyere enn fjellene! Ah, unnskyld. Jeg drmmer om stein.",options:[{label:"Bygger du katedralen?",nextId:"nidaros"},{label:"Du er ikke herfra?",nextId:"english"},{label:"Stein er bare stein. (G)",nextId:"EXIT"}]},nidaros:{text:"Kristkirken i Nidaros, ja! Verdens nordligste gotiske katedral. Vi hugger Kleberstein. Den er myk som smr nr den brytes, men blir hard som jern i luften. Et mirakulst materiale.",options:[{label:"Fortell om stilen.",nextId:"gothic"},{label:"Hvor lenge holder dere p?",nextId:"time"}]},gothic:{text:"Gotikk! Det er lysets arkitektur. I gamle dager bygget de tykke vegger og sm vinduer (romansk stil). N? Vi bruker strebepilarer p utsiden til  bre taket, s vi kan fylle veggene med glassmalerier. Guds lys strmmer inn!",options:[{label:"Hres vakkert ut.",nextId:"symbolism"}]},symbolism:{text:"Det er mer enn vakkert. Kirken er et bilde p himmelen. Hver syle, hver bue peker oppover. Nr bonden kommer inn fra gjrma, skal han fle at han trer inn i Guds rike.",options:[{label:"Mektig.",nextId:"start"}]},english:{text:"Nei, jeg kom fra Lincoln. Erkebiskopen hentet hndverkere fra England. Vi tar med oss kunnskapen om de nye stilene. Det er et internasjonalt laug, steinhuggerne. Vi reiser dit Gud og gullet kaller oss.",options:[{label:"Et reisende liv.",nextId:"start"}]},time:{text:'Haha! "Hvor lenge?" Min oldefar begynte. Jeg fortsetter. Mine barnebarn vil kanskje se spiret reise seg. En katedral bygges ikke for oss, men for evigheten.',options:[{label:"En tlmodighetsprve.",nextId:"EXIT"}]}}},{id:"vaering",name:"Halvdan",role:"Veteran fra Vringgarden",description:"Han brer en kappe av falmet, men kostbar silke. Et stygt arr deler venstre yenbryn i to. Han drikker ikke l, men vin fra en liten flaske.",conversation:{start:{text:"Dette stedet... det er kaldt, mrkt og lukter av vt hund. I Miklagard skinte solen p gulltakene hver dag, og keiserens hager duftet av sjasmin.",options:[{label:"Hvor er Miklagard?",nextId:"miklagard"},{label:"Var du en kriger?",nextId:"guard"},{label:"Hjemme best. (G)",nextId:"EXIT"}]},miklagard:{text:'"Den Store Byen". Konstantinopel! Verdens sentrum. Der mtes st og vest. Gatene er brolagt med marmor, og de har badehus med varmt vann i veggene! Kan du tenke deg? Varmt vann uten  koke det over bl!',options:[{label:"Utrolig.",nextId:"hagia"},{label:"Savner du det?",nextId:"miss"}]},hagia:{text:"Og Hagia Sofia... Guds Helligdoms Kirke. Kuppelen er s stor at den ser ut som om den henger i en gullkjede fra himmelen. Jeg har sett menn grte bare av  g inn der.",options:[{label:"M vre et syn.",nextId:"start"}]},guard:{text:'Vringgarden. Keiserens livvakt. Vi nordboere er hye, sterke og... vel, vi sviker ikke for penger. Grekerne er slueste folk, men de stoler bare p vre kser. "Pelekysphoroi" kaller de oss. ksebrere.',options:[{label:"Mtte dere slss?",nextId:"fight"},{label:"Ble du rik?",nextId:"rich"}]},fight:{text:"Mot sarasenere, mot bulgarere, mot opprrske generaler. Jeg har sett gresk ild  flytende flammer som brenner p vann! Det er djevelens verk, men effektivt.",options:[{label:"Gresk ild?",nextId:"start"}]},rich:{text:'Keiseren er sjeners. Nr han dr, har vi rett til  g gjennom skattkammeret og ta det vi kan bre. "Polutasvarf", kaller vi det. Palass-plyndring. Det er slik jeg fikk denne kappen... og denne ringen.',options:[{label:"En god pensjon.",nextId:"start"}]},miss:{text:"Hver vinter. Men her er min slekt, min jord. Og her snakker folk et sprk man kan forst. Men jeg vil alltid drmme om det Gyldne Horn.",options:[{label:"Skl for minnene.",nextId:"EXIT"}]}}},{id:"munk",name:"Broder Johannes",role:"Lrd Skrivermunk",description:"Fingrene hans er flekkete av blekk. Han myser, som om han er vant til  lese i drlig lys, og snakker lavmelt.",conversation:{start:{text:"Hysj. Hrer du stillheten? Nei, selvsagt ikke. Her er det sty. I skriptoriet hrer man bare fjrpennens skraping mot pergamentet. Guds ord som festes til huden.",options:[{label:"Hva skriver du?",nextId:"write"},{label:"Er du ikke ensom?",nextId:"lonely"},{label:"Jeg lar deg vre i fred. (G)",nextId:"EXIT"}]},write:{text:'Akkurat n? En kopi av "Kongespeilet"  *Konungs skuggsj*. En lrebok for prinser. Den forteller om hflighet, handel, stjernene og Guds orden. En klok konge m vre lrd, ikke bare sterk.',options:[{label:"Er bker dyre?",nextId:"expensive"},{label:"Hvem leser disse?",nextId:"readers"}]},expensive:{text:"Ufattelig. Et stort bibelverk krever skinnet fra 300 kalver! Tenk p flokken... og arbeidet.  forberede skinnet, blande blekket, male initialene med bladgull. En bok kan koste mer enn en grd.",options:[{label:"En skatt alts.",nextId:"start"}]},readers:{text:"De geistlige, kongen, og noen f adelige. Men kunnskapen risler nedover. Det vi bevarer i bibliotekene, er verdens hukommelse. Uten oss ville historien forsvinne i mrket.",options:[{label:"Et viktig ansvar.",nextId:"start"}]},lonely:{text:"Aldri. Jeg er omgitt av apostler, helgener og kirkefedrene. Augustin, Thomas Aquinas... de taler til meg gjennom sidene. Og brdrene i klosteret er min familie. Vi ber sammen, arbeider sammen.",options:[{label:"Ora et labora?",nextId:"rule"},{label:"Hres fredelig ut.",nextId:"start"}]},rule:{text:"Be og arbeid. Ja. Det er St. Benedikts regel. Lediggang er fienden av sjelen. S vi dyrker urter, brygger l (som dette, Guds gave!), og kopierer bker.",options:[{label:"Skl for let.",nextId:"EXIT"}]}}},{id:"pestlege",name:"Doktor Pestus",role:"Pestlege",description:"Han sitter litt for seg selv. En merkelig maske med nebb henger rundt halsen hans, og han lukter sterkt av eddik og trkede blomster.",conversation:{start:{text:"Ikke kom for nr! Balansen i vskene dine ser... urolig ut. Er du sangvinsk? Eller melankolsk? Luften her er tykk av miasma.",options:[{label:"Miasma?",nextId:"miasma"},{label:"Hva er masken til?",nextId:"mask"},{label:"Jeg er frisk! (G)",nextId:"EXIT"}]},miasma:{text:"Drlig luft! Sykdom kommer av rtten luft som stiger opp fra jorden eller fra syke kropper. Den forstyrrer balansen i kroppen  blod, slim, gul og svart galle. Pesten... den er den verste ubalansen.",options:[{label:"Svartedauden?",nextId:"plague"},{label:"Hvordan kurerer man det?",nextId:"cure"}]},plague:{text:"Den store dden. Den kom med et skip til Bergen i 1349. Jeg s hele landsbyer tmmes. Prester dde mens de ga den siste olje. Det var som om Gud hadde forlatt oss. De som overlevde... vi er merket.",options:[{label:"Forferdelig.",nextId:"social"}]},social:{text:"Men se rundt deg! De frre vi er, jo mer verdt er hver mann. Bndene krever bedre lnn n. Tjenestepikene gr med silke. Verden er snudd p hodet etter pesten.",options:[{label:"En ny tid.",nextId:"start"}]},mask:{text:"Nebbet fylles med urter. Nellik, roser, mynte. Sterk lukt motvirker den drlige luften. Det er som et filter mot dden selv. Og kappen er innsatt med voks s pestloppene glir av.",options:[{label:"Smart oppfinnelse.",nextId:"cure"}]},cure:{text:'relating for  fjerne ondt blod. Kopping. Og Theriak  en blanding av over 60 ingredienser, inkludert ormekjtt og opium. Det beste rdet? "Cito, longe, tarde." Dra fort, dra langt, kom sent tilbake.',options:[{label:"Skal huske det.",nextId:"EXIT"}]}}},{id:"birkebeiner",name:"Gunnar",role:"Birkebeiner-opprrer",description:"En hardfr mann med slitte klr, men sverdet ved beltet er velstelt. Han ser mistenksomt mot dren hver gang den pnes.",conversation:{start:{text:"Hvem holder du med? Kongen eller Kirken? Baglerne eller Birkebeinerne? Svar fort, fr let blir varmt.",options:[{label:"Birkebeinerne!",nextId:"birkebeiner"},{label:"Jeg blander meg ikke.",nextId:"neutral"},{label:"Baglerne?",nextId:"bagler"},{label:"Ingen. (G)",nextId:"EXIT"}]},birkebeiner:{text:"Godt svar! Vi er kong Sverres menn. Mange av oss startet med ingenting, med never rundt leggene i snen. Men vi kjemper for norges rettmessige konge mot biskopenes tyranni!",options:[{label:"Hvorfor hater dere biskopene?",nextId:"church"},{label:"Fortell om Kong Sverre.",nextId:"sverre"}]},bagler:{text:"*Han spytter p gulvet* Kirkens lpegutter. De vil at paven i Roma skal styre Norge, ikke kongen. Pass deg, ellers tror jeg du er en spion.",options:[{label:"Jeg mente det ikke snn.",nextId:"start"}]},neutral:{text:"Ingen kan vre nytrale i borgerkrig. Nr bror dreper bror, m man velge side. Men kanskje det er klokest  holde kjeft, ja.",options:[{label:"Nettopp.",nextId:"start"}]},church:{text:'Erkebiskopen vil ha makt. Han nekter  krone Sverre! Han lyste ham i bann! Men Sverre talte Roma midt imot. "En tale mot biskopene", kalte han det. Han sa at kirken er rtten, og at kongen er innsatt av Gud, ikke av Paven.',options:[{label:"Sterke ord.",nextId:"start"}]},sverre:{text:"En prest fra Fryene som ble konge! Han er liten av vekst, men en kjempe i klkt. Han lrte oss  slss p en ny mte. Ikke bare storme frem, men bruke terrenget, sl til og forsvinne. Gerilja, kaller de det visst i sr.",options:[{label:"En taktiker.",nextId:"EXIT"}]}}},{id:"kone",name:"Ragnhild",role:"Klok Kone",description:"En eldre kvinne med grtt hr flettet med fargerike bnd. Hun har en kurv full av trkede planter og rtter p bordet.",conversation:{start:{text:"Har du en plage, ungen min? En verkebyll? Kjrlighetssorg? Eller kanskje kua di har sluttet  melke? Naturen har en bot for alt, hvis man vet hvor man skal lete.",options:[{label:"Er du en heks?",nextId:"witch"},{label:"Har du noe mot sr?",nextId:"herbs"},{label:"Jeg tror p bnner. (G)",nextId:"EXIT"}]},witch:{text:"Hysj! Ikke bruk det ordet. Prestene brenner folk for mindre. Jeg er en hjelper. Jeg bruker bare Guds skaperverk. Er det trolldom  vite at groblad stanser bldning? Nei, det er kunnskap.",options:[{label:"Unnskyld.",nextId:"signs"},{label:"Hva med magi?",nextId:"magic"}]},herbs:{text:"Groblad for sr. Ryllik for feber. Og johannesurt for de tunge tankene som kommer om vinteren. Og honning... honning er bra for alt. Det holder betennelsen borte.",options:[{label:"Nyttig  vite.",nextId:"start"}]},signs:{text:"Man m lese tegnene. Hvis rogna brer mye br, blir vinteren sntung. Hvis krka skriker mot nord, kommer det gjester. Det er ikke magi, det er  lytte til verden.",options:[{label:"Klokt.",nextId:"start"}]},magic:{text:"*Hun lener seg frem* Det finnes krefter... de underjordiske. Nissen p lven, Huldra i skogen. Man m vise dem respekt. Ofre litt grt, litt l. Kirken liker det ikke, men bonden vet at det er best  holde seg inne med dem.",options:[{label:"Best  vre forsiktig.",nextId:"EXIT"}]}}},{id:"skald",name:"Einar Skald",role:"Hoff-poet",description:"Han sitter med lukkede yne og trommer rytmisk p bordet. Plutselig slr han ut med hnden og deklamerer en strofe.",conversation:{start:{text:'"Sverdets sang, blodets brang, ravnens fang..." Nei, nei. Det mangler bokstavrim. En god drpa skal vre som et vevd teppe, hver ord skal lse det neste.',options:[{label:"Hva er en drpa?",nextId:"drapa"},{label:"Fortell en saga!",nextId:"saga"},{label:"Du virker intens. (G)",nextId:"EXIT"}]},drapa:{text:'Det ypperste av kvad! Et hyllingsdikt til en fyrste eller konge. Det m ha "stef"  et omkved som gjentas. Hvis jeg gjr en feil i versefoten foran Jarlen, kan jeg miste hodet. Eller verre, miste min re.',options:[{label:"Hres vanskelig ut.",nextId:"oral"},{label:"Hva er versefot?",nextId:"poetry"}]},saga:{text:'Ah, historiene. Ikke bare dikt, men sannheten om vre forfedre. Som historien om Egil Skallagrimsson... kriger og poet. Han reddet sitt eget liv ved  dikte "Hodelsningen" til Eirik Blodks. Ord er makt, min venn.',options:[{label:"Fortell om Egil.",nextId:"egil"}]},egil:{text:"Han var stygg som juling, men sterk som en bjrn. Og han kunne drepe med et sverd i n hnd og dikte med den andre. En gang spydde han over en hirdmann som prvde  fornrme ham! En ekte helt.",options:[{label:"Fargerik type.",nextId:"start"}]},oral:{text:"Vi brer historien i hodet. Bker kan brenne, men et godt kvede lever p folkemunne i tusen r. Det er min oppgave.  srge for at kongens bedrifter aldri glemmes. Jeg er levende historie.",options:[{label:"Imponerende hukommelse.",nextId:"start"}]},poetry:{text:'Det er regler! Fornyrdislag, Ljogahtt... du m bruke "Kenninger". Du sier ikke "sverd", du sier "sr-isl". Du sier ikke "blod", du sier "sverd-vann". Det gjr sprket rikt og gtefullt.',options:[{label:"Vakkert sprk.",nextId:"EXIT"}]}}}];function v$(t,e,n){const{setActiveTab:s,setProductionContext:i,viewMode:r,setViewMode:a,viewingRegionId:l,setViewingRegionId:c,activeTab:u}=ql(),d=l||t.regionId||"capital",[f,h]=_.useState(null),[m,v]=_.useState(null),[y,b]=_.useState(null),[g,p]=_.useState(null),[x,w]=_.useState("start"),[k,S]=_.useState(!1),[N,T]=_.useState(!1),[E,j]=_.useState(!1),[R,I]=_.useState(!1),[V,B]=_.useState(!1),O=_.useCallback(J=>{if(J==="kingdom")return 0;if(J==="global")return 1;const H=wr.find($=>$.id===J);return H!=null&&H.parentId?3:2},[]),[D,M]=_.useState(r),[C,U]=_.useState("in");if(r!==D){const J=O(D),H=O(r);H>J?U("in"):H<J&&U("out"),M(r)}_.useEffect(()=>{const J=H=>{if(H.key==="Escape"){if(u!=="MAP")return;if(y){b(null);return}if(k){S(!1);return}if(N){T(!1);return}if(R){I(!1);return}if(V){B(!1);return}if(g){p(null);return}if(m){v(null);return}if(f){h(null);return}if(r!=="kingdom"){const $=wr.find(Q=>Q.id===r),F=$!=null&&$.parentId?wr.find(Q=>Q.id===$.parentId):null;a(r==="global"?"kingdom":F?F.id:"global")}}};return window.addEventListener("keydown",J),()=>window.removeEventListener("keydown",J)},[r,y,k,N,R,g,m,f,a,u]);const K=_.useCallback((J,H)=>{const $=typeof H=="string"?H:H.type||H.id,F=de=>de==="windmill_stones"?{buildingId:"windmill",type:"REFINE"}:de==="sawmill_blade"?{buildingId:"sawmill",type:"REFINE"}:de==="smeltery_furnace"?{buildingId:"smeltery",type:"REFINE"}:de==="bakery_oven"?{buildingId:"bakery",type:"REFINE"}:de==="weavery_loom"?{buildingId:"weavery",type:"REFINE"}:de==="forge_anvil"?{buildingId:"great_forge",type:"CRAFT"}:de==="apothecary_bench"?{buildingId:"apothecary",type:"CRAFT"}:null;if($==="OPEN_CHICKEN_COOP"){T(!0),h(null);return}if($==="OPEN_GARRISON"){i({buildingId:"watchtower",type:"CRAFT",initialView:"PRODUCE"}),s("PRODUCTION"),h(null);return}if($==="OPEN_CONSTRUCTION"){j(!0),h(null);return}if($==="OPEN_WAR_ROOM"){s("WAR_ROOM"),h(null);return}if($==="OPEN_TAXATION"){I(!0),h(null);return}const Q=F(J);if(Q&&($==="OPEN_CRAFTING"||$==="CRAFT"||$==="REFINE"||$.startsWith("REFINE_")||$.startsWith("CRAFT_")||Bn[$]||$==="REPAIR")){i({...Q,initialView:$==="REPAIR"?"REPAIR":"PRODUCE"}),s("PRODUCTION"),h(null);return}const ce=d===t.regionId,ve=t.role==="KING";if(!ce&&!ve&&$!=="MARKET_VIEW"){alert("Du har ingen myndighet i dette baroniet.");return}if($==="MARKET_VIEW")n();else if($.startsWith("REFINE_")){const de=$.replace("REFINE_","").split("_")[0].toLowerCase();e({type:"REFINE",recipeId:{plank:"plank",flour:"flour",iron:"iron_ingot",steel:"iron_ingot",cloth:"cloth"}[de]||de})}else if($.startsWith("CRAFT_")){const de=$.replace("CRAFT_","").toLowerCase();e(de==="bread"||de==="pie"||de==="mead"?{type:"REFINE",recipeId:de}:{type:"CRAFT",subType:de})}else if($ in Bn)e({type:"CRAFT",subType:$});else if($.startsWith("BUILDING_UPGRADE_")){const de=$.replace("BUILDING_UPGRADE_","");b(de)}else if($==="OPEN_DICE_GAME")S(!0);else if($==="OPEN_RESOURCE_GAME")B(!0);else if($==="CHAT_LOCAL"){const de=i_[Math.floor(Math.random()*i_.length)];p(de),w("start")}else e($==="BUY_MEAL"?{type:"BUY_MEAL"}:H);h(null)},[d,t,e,n,s,i,h]);return{viewMode:r,setViewMode:a,viewingRegionId:d,setViewingRegionId:c,selectedPOI:f,setSelectedPOI:h,selectedEvent:m,setSelectedEvent:v,upgradingBuildingId:y,setUpgradingBuildingId:b,dialogNPC:g,setDialogNPC:p,dialogStep:x,setDialogStep:w,isDiceGameOpen:k,setIsDiceGameOpen:S,isChickenCoopOpen:N,setIsChickenCoopOpen:T,isConstructionOpen:E,setIsConstructionOpen:j,isTaxationOpen:R,setIsTaxationOpen:I,isResourceGameOpen:V,setIsResourceGameOpen:B,direction:C,handlePOIAction:K}}const y$=({playerGold:t,onClose:e,onPlay:n})=>{const[s,i]=_.useState(1),[r,a]=_.useState(!1),[l,c]=_.useState([1,1]),[u,d]=_.useState([1,1]),[f,h]=_.useState("Plasser din innsats..."),[m,v]=_.useState(t);Ge.useEffect(()=>{v(t)},[t]);const y=()=>Math.floor(Math.random()*6)+1,b=()=>{if(r)return;if(s>t){h("Du har ikke nok gull!");return}if(s<.5){h("Minstesats er 0.5g");return}a(!0),h("Terningene ruller...");let x=0;const w=10,k=setInterval(()=>{c([y(),y()]),d([y(),y()]),x++,x>=w&&(clearInterval(k),g())},100)},g=()=>{const x=y(),w=y(),k=y(),S=y(),N=x+w,T=k+S;c([x,w]),d([k,S]);const E=N>T;E?(h(`DU VANT! ${N} mot ${T}`),v(j=>j+s)):(h(`HUSET VANT. ${T} mot ${N}`),v(j=>Math.max(0,j-s))),n({amount:s,isWin:E,playerRoll:N,houseRoll:T}),a(!1)},p=(x,w)=>o.jsx("div",{className:`w-16 h-16 rounded-xl shadow-[inset_0_0_10px_rgba(0,0,0,0.5)] flex bg-gradient-to-br ${w==="player"?"from-white to-slate-200 text-black":"from-red-600 to-red-800 text-white"} relative transition-transform duration-100 ${r?"animate-bounce":""}`,children:o.jsx("div",{className:"grid grid-cols-3 grid-rows-3 w-full h-full p-2 gap-1",children:[...Array(9)].map((k,S)=>{let N=!1;return x===1&&S===4&&(N=!0),x===2&&(S===0||S===8)&&(N=!0),x===3&&(S===0||S===4||S===8)&&(N=!0),x===4&&(S===0||S===2||S===6||S===8)&&(N=!0),x===5&&(S===0||S===2||S===4||S===6||S===8)&&(N=!0),x===6&&(S===0||S===2||S===3||S===5||S===6||S===8)&&(N=!0),o.jsx("div",{className:"flex items-center justify-center",children:N&&o.jsx("div",{className:`w-3 h-3 rounded-full ${w==="player"?"bg-black":"bg-white"} shadow-sm`})},S)})})});return o.jsxs("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/90 backdrop-blur-sm animate-in fade-in duration-500",children:[o.jsxs("div",{className:"absolute inset-0 z-0 opacity-50",children:[o.jsx("img",{src:"/Simulation_StandAlone_Pro/poi/tavern_dice_bg.png",alt:"Tavern Table",className:"w-full h-full object-cover"}),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-transparent to-black"})]}),o.jsxs("div",{className:"relative z-10 bg-[#1a472a]/90 border-[4px] border-[#5d4037] rounded-[2rem] shadow-[0_50px_100px_rgba(0,0,0,0.8)] w-full max-w-2xl overflow-hidden backdrop-blur-md",children:[o.jsx("div",{className:"absolute inset-0 border-2 border-[#8d6e63] rounded-[1.2rem] pointer-events-none opacity-50"}),o.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-[#d7ccc8] hover:text-white transition-colors bg-black/20 hover:bg-black/40 rounded-full w-8 h-8 flex items-center justify-center font-bold z-50",children:""}),o.jsxs("div",{className:"p-8 flex flex-col items-center gap-8 relative",children:[o.jsxs("div",{className:"text-center space-y-1",children:[o.jsx("h2",{className:"text-3xl font-black text-[#ffecb3] uppercase tracking-widest drop-shadow-md",style:{fontFamily:"serif"},children:"Spillebordet"}),o.jsx("div",{className:"text-[#a5d6a7] font-bold tracking-wider text-sm",children:"Huset vinner ved uavgjort"}),o.jsx("div",{className:"text-xs text-white/50 uppercase tracking-widest font-black",children:"Lykke til!"})]}),o.jsxs("div",{className:"flex justify-between w-full px-8 gap-8",children:[o.jsxs("div",{className:"flex flex-col items-center gap-4",children:[o.jsxs("span",{className:"text-[#90caf9] font-black uppercase tracking-widest text-xs",children:["Deg (",l[0]+l[1],")"]}),o.jsxs("div",{className:"flex gap-3",children:[p(l[0],"player"),p(l[1],"player")]})]}),o.jsx("div",{className:"flex items-center justify-center",children:o.jsx("span",{className:"text-2xl font-black text-white/20",children:"VS"})}),o.jsxs("div",{className:"flex flex-col items-center gap-4",children:[o.jsxs("span",{className:"text-[#ef9a9a] font-black uppercase tracking-widest text-xs",children:["Huset (",u[0]+u[1],")"]}),o.jsxs("div",{className:"flex gap-3",children:[p(u[0],"house"),p(u[1],"house")]})]})]}),o.jsx("div",{className:`h-12 flex items-center justify-center w-full bg-black/30 rounded-xl border border-white/5 transition-all ${f.includes("VANT")?"bg-green-900/40 border-green-500/30":f.includes("tapte")?"bg-red-900/40 border-red-500/30":""}`,children:o.jsx("span",{className:"font-bold text-lg text-[#fff8e1] tracking-wide",children:f})}),o.jsxs("div",{className:"w-full bg-black/20 p-6 rounded-2xl border border-white/5 flex flex-col gap-4",children:[o.jsxs("div",{className:"flex justify-between items-center text-[#d7ccc8] font-bold text-sm uppercase tracking-widest",children:[o.jsx("span",{children:"Innsats"}),o.jsxs("span",{children:["Din Saldo: ",o.jsxs("span",{className:"text-[#ffd54f]",children:[m.toFixed(1),"g"]})]})]}),o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("input",{type:"range",min:.5,max:Math.min(t,100),step:.5,value:s,onChange:x=>i(parseFloat(x.target.value)),className:"w-full h-3 bg-black/50 rounded-lg appearance-none cursor-pointer accent-[#ffb74d]",disabled:r}),o.jsxs("div",{className:"bg-black/40 px-4 py-2 rounded-xl text-[#ffd54f] font-black min-w-[5rem] text-center border border-white/10",children:[s,"g"]})]}),o.jsx("div",{className:"grid grid-cols-4 gap-2",children:[1,5,10,50].map(x=>o.jsxs("button",{onClick:()=>i(x),disabled:x>t||r,className:`py-1 rounded-lg text-xs font-bold uppercase tracking-widest transition-colors ${s===x?"bg-[#ffb74d] text-black":"bg-white/5 text-[#d7ccc8] hover:bg-white/10"}`,children:[x,"g"]},x))}),o.jsx("button",{onClick:b,disabled:r||t<s,className:`w-full py-4 rounded-xl font-black uppercase tracking-widest text-lg shadow-lg transform transition-all active:scale-[0.98] ${r?"bg-gray-600 cursor-not-allowed opacity-50":"bg-gradient-to-r from-[#ffca28] to-[#ff6f00] text-black hover:brightness-110 shadow-orange-900/40"}`,children:r?"Ruller...":"KAST TERNINGENE!"})]})]})]})]})},ou=[{id:"gold",label:"GULL",icon:"",color:"from-yellow-400 to-amber-600",accent:"amber"},{id:"grain",label:"KORN",icon:"",color:"from-amber-400 to-amber-600",accent:"amber"},{id:"wood",label:"TREVIRKE",icon:"",color:"from-orange-500 to-amber-800",accent:"orange"},{id:"stone",label:"STEIN",icon:"",color:"from-slate-500 to-slate-700",accent:"slate"},{id:"iron",label:"JERN",icon:"",color:"from-blue-500 to-indigo-900",accent:"indigo"}],vs=[{value:0,weight:50,label:"Tap",color:"#0f172a",multiplierText:"0x",angle:180},{value:1.5,weight:30,label:"Gevinst",color:"#10b981",multiplierText:"1.5x",angle:90},{value:2.5,weight:15,label:"Stor Gevinst",color:"#3b82f6",multiplierText:"2.5x",angle:60},{value:5,weight:5,label:"JACKPOT!",color:"#f59e0b",multiplierText:"5x",angle:30}],_$=({player:t,onClose:e,onPlay:n})=>{const[s,i]=_.useState("gold"),[r,a]=_.useState(100),[l,c]=_.useState(!1),[u,d]=_.useState(0),[f,h]=_.useState(null),[m,v]=_.useState([]),y=_.useRef(!1),b=t.resources||{},g=b[s]||0;_.useEffect(()=>{r>g&&a(Math.max(1,Math.floor(g)))},[s,g]);const p=()=>{if(y.current||l||r<=0||r>g)return;y.current=!0,c(!0),h(null);const k=vs.reduce((H,$)=>H+$.weight,0),S=Math.random()*k;let N=0,T=0;for(let H=0;H<vs.length;H++)if(T+=vs[H].weight,S<T){N=H;break}const E=vs[N],j=8+Math.floor(Math.random()*4);let R=0;for(let H=0;H<N;H++)R+=vs[H].angle;const I=vs[N],V=R+I.angle/2,B=I.angle/2*.6,O=(Math.random()-.5)*B,M=(360-(V+O+360)%360)%360,C=u,U=C%360,K=(M-U+360)%360,J=C+j*360+K;d(J),setTimeout(()=>{const H=E.value>0,$={multiplier:E.value,isWin:H,label:E.label};h($),c(!1),y.current=!1;const F={resource:s,amount:r,multiplier:E.value,isWin:H,timestamp:Date.now()};v(Q=>[F,...Q].slice(0,4)),n({resource:s,amount:r,multiplier:E.value,isWin:H})},3100)},x=ou.find(k=>k.id===s)||ou[0],w=_.useMemo(()=>{let k=0;return vs.map(S=>{const N=k;return k+=S.angle,`${S.color} ${N}deg ${k}deg`}).join(", ")},[]);return o.jsxs("div",{className:"absolute inset-0 z-[100] flex items-center justify-center p-4",children:[o.jsx(he.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:l?void 0:e,className:"absolute inset-0 bg-slate-950/85 backdrop-blur-xl cursor-pointer"}),o.jsxs(he.div,{initial:{scale:.95,opacity:0,y:30},animate:{scale:1,opacity:1,y:0},exit:{scale:.95,opacity:0,y:30},className:"relative w-full max-w-5xl bg-slate-900 border border-white/5 rounded-[2.5rem] shadow-2xl overflow-hidden flex flex-col lg:flex-row h-[650px]",children:[o.jsx("button",{onClick:e,disabled:l,className:"absolute top-6 right-6 z-50 p-2 bg-white/5 hover:bg-white/10 rounded-full text-white/30 hover:text-white transition-all",children:o.jsx(us,{size:24})}),o.jsxs("div",{className:"flex-1 p-6 flex flex-col gap-4 z-10 overflow-hidden",children:[o.jsx("div",{className:"flex items-center gap-2",children:o.jsxs("div",{className:"px-3 py-0.5 rounded-full bg-amber-500/10 border border-amber-500/20 text-amber-500 text-[9px] font-black uppercase tracking-[0.2em] flex items-center gap-2",children:[o.jsx(Ca,{size:10}),o.jsx("span",{children:"Soga-hjulet"})]})}),o.jsx("h2",{className:"text-3xl font-black text-white italic tracking-tighter leading-none",children:"Sats Dine Ressurser"}),o.jsx("div",{className:"grid grid-cols-5 gap-2",children:ou.map(k=>{const S=s===k.id,N=b[k.id]||0;return o.jsxs("button",{onClick:()=>!l&&i(k.id),className:`relative p-3 rounded-2xl border-2 transition-all duration-300 flex flex-col items-center gap-1.5
                                        ${S?`bg-white/5 border-${k.accent}-500 shadow-lg scale-105`:"bg-black/20 border-white/5 hover:border-white/10 opacity-70"}`,children:[o.jsx("div",{className:"text-2xl",children:k.icon}),o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx("div",{className:"text-[10px] font-black uppercase tracking-widest text-slate-400",children:k.label}),o.jsx("div",{className:`text-lg font-black font-mono ${S?"text-white":"text-slate-300"}`,children:N%1!==0?N.toFixed(1):N.toLocaleString()})]})]},k.id)})}),o.jsxs("div",{className:"bg-black/40 border border-white/5 rounded-[2rem] p-6 space-y-4",children:[o.jsxs("div",{className:"flex justify-between items-end",children:[o.jsxs("div",{className:"space-y-0.5",children:[o.jsx("span",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-slate-500",children:"Innsats Belp"}),o.jsxs("div",{className:"flex items-baseline gap-2",children:[o.jsx("span",{className:"text-5xl font-black text-white font-mono",children:r.toLocaleString()}),o.jsx("span",{className:"text-sm font-black text-indigo-400 uppercase tracking-widest",children:x.label})]})]}),o.jsx("div",{className:"flex gap-2",children:[25,50,100].map(k=>o.jsx("button",{onClick:()=>a(Math.max(1,Math.floor(g*(k/100)))),className:"px-3 py-1.5 rounded-xl bg-white/5 hover:bg-white/10 text-[10px] font-black uppercase tracking-widest text-slate-300 border border-white/5",children:k===100?"MAX":`${k}%`},k))})]}),o.jsxs("div",{className:"relative h-8 flex items-center",children:[o.jsx("input",{type:"range",min:1,max:Math.max(1,Math.floor(g)),step:1,value:r,onChange:k=>a(parseInt(k.target.value)),disabled:l,className:"w-full h-1.5 bg-white/5 rounded-full appearance-none cursor-pointer accent-amber-500 z-10"}),o.jsx("div",{className:"absolute left-0 h-1.5 bg-gradient-to-r from-amber-600 to-amber-400 rounded-full pointer-events-none",style:{width:`${r/Math.max(1,Math.floor(g))*100}%`}})]}),o.jsx("button",{onClick:p,disabled:l||g<r||r<=0,className:`w-full relative h-14 rounded-xl font-black uppercase tracking-[0.3em] text-base shadow-2xl transition-all duration-300 ${l?"bg-slate-800":"bg-amber-500 hover:brightness-110 active:scale-95 text-slate-950"}`,children:l?"Spinner...":"SPINN HJULET!"})]}),o.jsxs("div",{className:"mt-auto border-t border-white/5 pt-3",children:[o.jsxs("div",{className:"flex items-center gap-2 text-[9px] font-black uppercase tracking-[0.3em] text-slate-600 mb-2",children:[o.jsx(_A,{size:10}),o.jsx("span",{children:"Siste Resultater"})]}),o.jsx("div",{className:"grid grid-cols-4 gap-2",children:m.map((k,S)=>{const N=ou.find(T=>T.id===k.resource);return o.jsxs("div",{className:"flex flex-col p-2 rounded-xl bg-black/40 border border-white/5 items-center",children:[o.jsxs("div",{className:"flex items-center gap-1.5 mb-0.5",children:[o.jsx("span",{className:"text-xs",children:N==null?void 0:N.icon}),o.jsx("span",{className:"text-[10px] font-mono font-bold text-slate-400",children:k.amount.toLocaleString()})]}),o.jsx("div",{className:`text-xs font-black font-mono ${k.isWin?"text-emerald-500":"text-rose-900/40"}`,children:k.isWin?`x${k.multiplier}`:"TAP"})]},S)})})]})]}),o.jsxs("div",{className:"w-full lg:w-[480px] bg-black/50 border-l border-white/5 flex flex-col items-center justify-center p-12 relative",children:[o.jsxs("div",{className:"relative w-80 h-80 mb-10",children:[o.jsx("div",{className:`absolute -inset-12 rounded-full blur-[100px] opacity-20 transition-colors duration-1000 bg-${x.accent}-500`}),o.jsxs(he.div,{animate:{rotate:u},transition:{duration:3,ease:[.32,.72,0,1]},className:"w-full h-full rounded-full border-[18px] border-slate-900 shadow-2xl relative overflow-hidden bg-slate-950",children:[o.jsx("div",{className:"absolute inset-0 transition-opacity duration-300",style:{background:`conic-gradient(${w})`,opacity:l?.4:.8}}),vs.map((k,S)=>{let N=0;for(let E=0;E<S;E++)N+=vs[E].angle;const T=N+k.angle/2;return o.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",style:{transform:`rotate(${T}deg)`},children:o.jsx("div",{className:"absolute top-[16%] text-white font-black text-2xl drop-shadow-[0_2px_4px_rgba(0,0,0,1)] font-mono",children:k.multiplierText})},S)}),o.jsx("div",{className:"absolute inset-[80px] rounded-full border-2 border-white/5 bg-slate-950/80 backdrop-blur-md shadow-inner"})]}),o.jsx("div",{className:"absolute -top-12 left-1/2 -translate-x-1/2 z-50",children:o.jsx(he.div,{animate:l?{y:[0,-5,0]}:{},transition:{duration:.1,repeat:1/0},className:"w-10 h-16 bg-amber-500 rounded-b-full shadow-[0_15px_30px_rgba(245,158,11,0.6)] border-4 border-slate-950 flex flex-col items-center justify-end pb-2",children:o.jsx("div",{className:"w-1.5 h-6 bg-slate-950/30 rounded-full"})})}),o.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-40 pointer-events-none",children:o.jsx(Ln,{mode:"wait",children:l?o.jsx(he.div,{initial:{scale:.8},animate:{scale:1.1},exit:{scale:1.2,opacity:0},className:"text-7xl drop-shadow-2xl",children:x.icon},"spinning_icon"):o.jsxs(he.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},className:"flex flex-col items-center gap-1 drop-shadow-2xl",children:[o.jsx("span",{className:"text-6xl",children:x.icon}),f&&o.jsxs(he.span,{initial:{y:10,opacity:0},animate:{y:0,opacity:1},className:`text-3xl font-black font-mono ${f.isWin?"text-emerald-400":"text-slate-500"}`,children:[f.multiplier,"x"]})]},"result_icon")})})]}),o.jsx("div",{className:"h-24 text-center flex flex-col items-center justify-center",children:o.jsx(Ln,{mode:"wait",children:f&&!l&&o.jsxs(he.div,{initial:{opacity:0,y:10,scale:.9},animate:{opacity:1,y:0,scale:1},className:"space-y-1",children:[o.jsxs("div",{className:`text-xs font-black uppercase tracking-[0.3em] flex items-center justify-center gap-2 ${f.isWin?"text-emerald-400":"text-slate-500"}`,children:[f.isWin&&o.jsx(Ca,{size:12,className:"animate-pulse"}),f.label,f.isWin&&o.jsx(Ca,{size:12,className:"animate-pulse"})]}),o.jsx("h4",{className:`text-3xl font-black italic tracking-tighter drop-shadow-lg transition-all ${f.multiplier>=2.5?"text-yellow-400 scale-110":"text-white"}`,children:f.isWin?`+${(r*f.multiplier).toLocaleString()} ${x.label}`:"Fortellingen er over"}),f.multiplier>=5&&o.jsx(he.div,{initial:{opacity:0},animate:{opacity:1},className:"text-[10px] font-black text-amber-500 uppercase tracking-[0.5em] mt-2 animate-bounce",children:"LEGENDARISK GEVINST!"})]})})})]})]})]})};class w${constructor(){et(this,"listeners",[])}subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(n=>n!==e)}}emit(e){this.listeners.forEach(n=>n(e))}spawnFloatingText(e,n,s,i){const r=(Math.random()-.5)*4,a=(Math.random()-.5)*4;this.emit({id:Math.random().toString(36).substr(2,9),type:"FLOATING_TEXT",text:e,x:n+r,y:s+a,color:i,duration:1500})}spawnFlyingResource(e,n,s,i,r){this.emit({id:Math.random().toString(36).substr(2,9),type:"FLYING_RESOURCE",resource:e,startPoint:{x:n,y:s},endPoint:{x:i,y:r},duration:1e3})}spawnParticles(e,n,s){this.emit({id:Math.random().toString(36).substr(2,9),type:"PARTICLE",x:e,y:n,color:s,duration:800})}}const je=new w$,k$=({onComplete:t})=>{const[e,n]=_.useState([]),[s,i]=_.useState(!1),r=10,a=l=>{if(s)return;const c=l.currentTarget.getBoundingClientRect(),u=(l.clientX-c.left)/c.width*100,d=(l.clientY-c.top)/c.height*100,f={x:u,y:d,id:Date.now()};je.spawnParticles(u,d,"bg-emerald-400"),n(h=>{const m=[...h,f];return m.length>=r&&(i(!0),setTimeout(()=>t(1),1500)),m})};return o.jsxs("div",{onClick:a,className:"w-full h-[600px] relative overflow-hidden cursor-crosshair group active:scale-[0.99] transition-transform select-none",style:{backgroundImage:'url("/images/minigames/agriculture_bg.png")',backgroundSize:"cover",backgroundPosition:"center"},children:[o.jsx("div",{className:"absolute inset-0 bg-black/40 z-0 pointer-events-none"}),o.jsx("div",{className:"absolute top-10 left-1/2 -translate-x-1/2 pointer-events-none z-20 text-center",children:s?o.jsx("div",{className:"animate-in zoom-in duration-300",children:o.jsx("h2",{className:"text-5xl font-black text-emerald-400 drop-shadow-[0_4px_0_rgba(0,0,0,0.5)] uppercase tracking-tighter animate-bounce",children:"Mestrerlig Sdd! "})}):o.jsxs(o.Fragment,{children:[o.jsx("h2",{className:"text-3xl font-black text-white drop-shadow-md mb-2",children:"S dine fr"}),o.jsxs("div",{className:"bg-black/40 px-4 py-1 rounded-full text-emerald-400 font-bold uppercase tracking-widest text-sm inline-block",children:[e.length," / ",r]})]})}),e.map(l=>o.jsx("div",{className:"absolute w-4 h-4 bg-emerald-400 rounded-full shadow-[0_0_10px_rgba(52,211,153,0.8)] animate-in zoom-in duration-300",style:{left:`${l.x}%`,top:`${l.y}%`,transform:"translate(-50%, -50%)"},children:o.jsx("div",{className:"absolute -top-4 left-1/2 -translate-x-1/2 w-0.5 h-3 bg-white/50"})},l.id)),o.jsx("div",{className:"absolute inset-0 pointer-events-none z-10 hidden group-hover:block",children:o.jsx("div",{className:"absolute w-8 h-8 border-2 border-white/50 rounded-full -translate-x-1/2 -translate-y-1/2"})})]})},lu=({onComplete:t,equipment:e=[],isMining:n,isQuarrying:s,isForaging:i,speedMultiplier:r=1,possibleYield:a=10,resourceName:l="Ressurs"})=>{const[c,u]=_.useState(0),[d,f]=_.useState([]),[h,m]=_.useState(!1),[v,y]=_.useState(!1),[b,g]=_.useState(!1),p=_.useRef(1),[x,w]=_.useState(50),k=_.useRef(1);_.useEffect(()=>{const T=E=>{E.code==="Space"&&(E.preventDefault(),S())};return window.addEventListener("keydown",T),()=>window.removeEventListener("keydown",T)},[d,h,c,x,e,r,b]),_.useEffect(()=>{if(d.length>=5||h||b)return;const T=setInterval(()=>{u(E=>{let j=2/r,R=E+j*p.current;return R>100?(p.current=-1,100):R<0?(p.current=1,0):R}),w(E=>{let R=E+.3*k.current;return Math.random()<.02&&(k.current*=-1),R>80?(k.current=-1,80):R<20?(k.current=1,20):R})},16);return()=>clearInterval(T)},[d.length,h,r,b]);const S=()=>{var D,M,C;if(d.length>=5||h||b)return;const T=Math.abs(c-x);let E=T<5?1:T<15?.7:T<25?.4:.1;const j=n?"MINE":s?"QUARRY":i?"FORAGE":"WORK",R=EA(j,e||[]);console.log(`[HarvestingGame] Init. Action: ${j}. Equipment Count: ${e==null?void 0:e.length}. Best Tool:`,R);const I=((D=R==null?void 0:R.stats)==null?void 0:D.yieldBonus)||(R&&Ci(R)?(C=(M=Oe[Ci(R)])==null?void 0:M.stats)==null?void 0:C.yieldBonus:0)||0,V=Math.ceil(a/5*(.5+E)),B=Math.ceil(I/5*(.5+E));T<15?(y(!0),g(!0),je.spawnParticles(50,40,T<5?"bg-amber-400":"bg-white"),T<5?je.spawnFloatingText(`PERFEKT! + ${V} ${B>0?`(+${B})`:""} `,50,40,"text-amber-400 font-black text-2xl"):je.spawnFloatingText(`Bra! +${V}`,50,40,"text-white font-bold"),setTimeout(()=>{y(!1),g(!1)},100)):je.spawnFloatingText("Svakt...",50,40,"text-slate-500 font-bold");const O=[...d,E];f(O),O.length===5&&(m(!0),setTimeout(()=>t(O.reduce((U,K)=>U+K,0)/5),800))},N=n||s?'url("/images/minigames/mining_bg.png")':i?'url("/images/minigames/foraging_bg.png")':'url("/images/minigames/agriculture_bg.png")';return o.jsxs("div",{className:`p-8 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden ${v?"animate-shake":""} `,style:{backgroundImage:N,backgroundSize:"cover",backgroundPosition:"center"},children:[o.jsx("div",{className:`absolute inset-0 bg-black/70 z-0 transition-all duration-75 ${b?"bg-indigo-900/50 mix-blend-hard-light":""}`}),o.jsxs("div",{className:`relative z-10 w-full flex flex-col items-center transition-all duration-75 ${b?"scale-105 brightness-150 contrast-125":""}`,children:[o.jsx("h2",{className:"text-4xl font-black text-white mb-8 drop-shadow-lg tracking-tighter uppercase",children:n?"Gruvedrift":s?"Steinhugger":i?"Sanking":"Kornhsting"}),h?o.jsx("div",{className:"py-12 animate-bounce text-5xl font-black text-amber-500 uppercase tracking-tighter drop-shadow-[0_0_20px_rgba(245,158,11,0.5)]",children:"FERDIG! "}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"mb-4 text-xs font-black text-amber-500 uppercase tracking-widest",children:l}),o.jsxs("div",{className:"w-full h-8 bg-white/5 rounded-full mb-12 relative border border-white/10 overflow-hidden shadow-inner",children:[o.jsx("div",{className:"absolute inset-y-0 bg-amber-500/30 border-x border-amber-500/50 transition-all duration-75 linear",style:{left:`${x-8}%`,right:`${100-(x+8)}%`}}),o.jsx("div",{className:"absolute inset-y-0 w-0.5 bg-amber-400/80 z-0",style:{left:`${x}%`}}),o.jsx("div",{className:"absolute inset-y-0 w-1 bg-white shadow-[0_0_20px_white] z-10",style:{left:`${c}% `}})]}),o.jsx("button",{onClick:S,className:`w-full bg-amber-500 hover:bg-amber-400 text-slate-950 py-7 rounded-[2rem] font-black text-2xl shadow-2xl transition-all uppercase tracking-widest border-b-4 border-amber-700 ${b?"scale-95 brightness-125":"active:scale-95"}`,children:"KLIKK N! "})]})]})]})},N$=({onComplete:t,speedMultiplier:e=1})=>{const[n,s]=_.useState(50),[i,r]=_.useState(50),[a,l]=_.useState(0),[c,u]=_.useState(!1),[d,f]=_.useState(!1),[h,m]=_.useState(!1),v=_.useRef(1);_.useEffect(()=>{if(c||h)return;const b=setInterval(()=>{s(g=>{let p=g+.8*v.current*e;return p>90?(v.current=-1,90):p<10?(v.current=1,10):p})},16);return()=>clearInterval(b)},[c,e,h]),_.useEffect(()=>{const b=g=>{g.code==="Space"&&(g.preventDefault(),y({clientX:window.innerWidth/2,clientY:window.innerHeight/2}))};return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[c,i,n,h]);const y=b=>{if(c||h)return;const g=Math.abs(i-n),p=b.clientX,x=b.clientY;g<12?(f(!0),m(!0),l(w=>{const k=w+1;return k>=5&&(u(!0),je.spawnFloatingText("MESTERVERK! ",p,x-60,"text-amber-400 text-3xl font-black"),setTimeout(()=>t(1),1200)),k}),je.spawnParticles(p,x,"bg-amber-400"),je.spawnFloatingText("KLANG!",p,x-40,"text-amber-500 font-black"),setTimeout(()=>{f(!1),m(!1)},100)):g<25?(je.spawnFloatingText("Treff",p,x-40,"text-white font-bold"),je.spawnParticles(p,x,"bg-white")):je.spawnFloatingText("BOM!",p,x-40,"text-slate-500 font-bold")};return o.jsxs("div",{onMouseMove:b=>{const g=b.currentTarget.getBoundingClientRect();r((b.clientX-g.left)/g.width*100)},onClick:y,className:`p-12 min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden cursor-crosshair ${d?"animate-shake":""}`,style:{backgroundImage:'url("/images/minigames/smithing_bg.png")',backgroundSize:"cover",backgroundColor:"#0f172a"},children:[o.jsx("div",{className:`absolute inset-0 bg-black/70 z-0 transition-all duration-75 ${h?"bg-amber-900/40 mix-blend-hard-light":""}`}),o.jsxs("div",{className:`relative z-10 text-center mb-12 transition-all duration-75 ${h?"scale-105 brightness-150 contrast-125":""}`,children:[o.jsx("h2",{className:"text-4xl font-black text-white uppercase tracking-tighter drop-shadow-xl",children:"Smedarbeid"}),o.jsxs("div",{className:"text-amber-500 font-black uppercase tracking-widest text-xs mt-2 bg-black/40 px-4 py-1 rounded-full border border-amber-500/20",children:["Slag: ",a," / 5"]})]}),o.jsxs("div",{className:`relative z-10 w-full max-w-2xl space-y-4 transition-all duration-75 ${h?"scale-105":""}`,children:[o.jsxs("div",{className:"w-full h-24 bg-slate-900/50 rounded-2xl border-2 border-white/10 shadow-2xl flex items-center px-4 overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 bg-amber-500/5 transition-all duration-1000",style:{opacity:a/5}}),o.jsxs("div",{className:"relative w-full h-4 bg-white/5 rounded-full overflow-hidden",children:[o.jsx("div",{className:"absolute inset-y-0 w-24 bg-amber-500/40 blur-sm mix-blend-screen transition-all duration-75",style:{left:`${n}%`,transform:"translateX(-50%)"}}),o.jsx("div",{className:"absolute inset-y-0 w-12 bg-white/40 blur-[2px]",style:{left:`${n}%`,transform:"translateX(-50%)"}}),o.jsx("div",{className:"absolute inset-y-0 w-1 bg-white shadow-[0_0_15px_white] z-20",style:{left:`${i}%`,transform:"translateX(-50%)"}})]})]}),o.jsxs("div",{className:"flex items-center gap-4 px-2",children:[o.jsx("div",{className:"flex-1 h-2 bg-black/40 rounded-full overflow-hidden border border-white/5",children:o.jsx("div",{className:"h-full bg-gradient-to-r from-amber-600 to-amber-400 transition-all duration-500",style:{width:`${a/5*100}%`}})}),o.jsxs("span",{className:"text-[10px] font-black text-amber-500 uppercase tracking-widest",children:[Math.round(a/5*100),"%"]})]})]}),c&&o.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm animate-in fade-in zoom-in duration-300",children:o.jsx("div",{className:"text-6xl font-black text-amber-500 animate-bounce drop-shadow-[0_0_30px_rgba(245,158,11,0.5)]",children:"FERDIG! "})}),o.jsx("div",{className:`mt-12 text-slate-400 text-sm font-bold uppercase tracking-widest animate-pulse relative z-10 transition-opacity ${h?"opacity-0":"opacity-100"}`,children:"Klikk nr markren er over den gldende sonen"})]})},S$=({onComplete:t,speedMultiplier:e=1,icon:n=""})=>{const[s,i]=_.useState(0),[r,a]=_.useState(!1),[l,c]=_.useState(null),[u,d]=_.useState(0),[f,h]=_.useState(80),m=_.useRef(-1);_.useEffect(()=>{if(r||l)return;const y=setInterval(()=>{i(g=>{const p=g+1*e;return p>=100?(c("BRENT! "),setTimeout(()=>{c(null),i(0)},1e3),0):p})},50),b=setInterval(()=>{h(g=>{let x=g+.8*m.current;return x>90?(m.current=-1,90):x<40?(m.current=1,40):x})},50);return()=>{clearInterval(y),clearInterval(b)}},[r,l,e]),_.useEffect(()=>{const y=b=>{b.code==="Space"&&(b.preventDefault(),v())};return window.addEventListener("keydown",y),()=>window.removeEventListener("keydown",y)},[r,l,s,f]);const v=()=>{if(r||l)return;const y=f-10,b=f+10;s>y&&s<b?(c("PERFEKT GYLLEN! "),d(g=>{const p=g+1;return p>=3&&(a(!0),setTimeout(()=>t(1),1e3)),p})):s<y?c("R... "):c("LITT BRENT... "),setTimeout(()=>{c(null),i(0)},1e3)};return o.jsxs("div",{className:"p-12 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden",style:{backgroundImage:'url("/images/minigames/bakery_bg.png")',backgroundSize:"cover",backgroundColor:"#451a03"},children:[o.jsx("div",{className:"absolute inset-0 bg-black/70 z-0"}),o.jsx("h2",{className:"relative z-10 text-4xl font-black text-white mb-8 tracking-tighter uppercase italic",children:"Bakeri: Steking "}),o.jsxs("div",{className:"relative z-10 w-64 h-64 bg-slate-900 border-8 border-amber-900 rounded-3xl flex items-center justify-center overflow-hidden mb-12 shadow-2xl",children:[o.jsx("div",{className:"absolute inset-0 bg-orange-500/10 animate-pulse"}),o.jsx("div",{className:"text-8xl transition-all duration-300 transform",style:{filter:`grayscale(${100-s}%) sepia(${s}%)`,transform:`scale(${.8+s/500})`},children:n}),l&&o.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center text-white font-black text-2xl p-4 animate-in zoom-in",children:l})]}),o.jsxs("div",{className:`relative z-10 w-full max-w-sm h-8 bg-white/10 rounded-full mb-12 border ${s>f-10&&s<f+10?"border-emerald-500 shadow-[0_0_15px_rgba(16,185,129,0.5)]":"border-white/10"} overflow-hidden transition-all shadow-2xl`,children:[o.jsx("div",{className:"absolute inset-y-0 bg-emerald-500/30 border-x border-emerald-500/50 transition-all duration-75 ease-linear",style:{left:`${f-10}%`,right:`${100-(f+10)}%`},children:s>f-10&&s<f+10&&o.jsx("div",{className:"absolute inset-0 bg-emerald-400/20 animate-pulse"})}),o.jsx("div",{className:"h-full bg-orange-500 transition-all duration-75 relative z-10 opacity-80",style:{width:`${s}% `}}),o.jsx("div",{className:"absolute top-0 bottom-0 w-1 bg-white/50 z-20",style:{left:`${f}%`}})]}),o.jsx("div",{className:"relative z-10 flex gap-4 mb-8",children:[...Array(3)].map((y,b)=>o.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center text-2xl border-2 transition-all ${u>b?"bg-amber-500 border-amber-300 scale-110 shadow-lg":"bg-white/5 border-white/10 opacity-30"} `,children:n},b))}),o.jsx("button",{onClick:v,className:"relative z-10 w-full max-w-sm bg-amber-600 hover:bg-amber-500 text-white py-6 rounded-2xl font-black text-2xl shadow-xl active:scale-95 transition-all uppercase tracking-widest border-b-8 border-amber-800",children:"TA UT N! "})]})},E$=(t,e)=>{if(e)return e.find(n=>{var r;if(!n)return!1;const s=Object.keys(Oe).find(a=>n.id===a||n.id.startsWith(a+"_")),i=s?Oe[s]:null;return(r=i==null?void 0:i.relevantActions)==null?void 0:r.includes(t)})},T$=({onComplete:t,equipment:e=[]})=>{const[n,s]=_.useState(0),[i,r]=_.useState(!1),[a,l]=_.useState(!1),[c,u]=_.useState(0),[d,f]=_.useState({x:50,y:50}),[h,m]=_.useState(!1),v=()=>f({x:20+Math.random()*60,y:20+Math.random()*60}),y=g=>{if(a)return;l(!0),r(!0);const p=n+1;s(p);const x=p>5,w=p>2?`${p}x COMBO!`:x?"FLAWLESS!":"TREFF!",k=x?"text-amber-400 font-display":"text-white";je.spawnFloatingText(w,g.clientX,g.clientY-40,k),je.spawnParticles(g.clientX,g.clientY,x?"bg-amber-400":"bg-white"),setTimeout(()=>{l(!1),r(!1),u(S=>(S+1>=10&&(m(!0),je.spawnFloatingText("FULLFRT! ",g.clientX,g.clientY-100,"text-emerald-400 text-2xl"),setTimeout(()=>t(1),1200)),S+1)),v()},80)},b=E$("CHOP",e);return o.jsxs("div",{className:`p-8 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden ${i?"animate-shake":""} `,style:{backgroundImage:'url("/images/minigames/forestry_bg.png")',backgroundSize:"cover"},children:[o.jsx("div",{className:"absolute inset-0 bg-black/60 z-0"}),o.jsx("div",{className:"relative z-10 w-full mb-8",children:o.jsxs("div",{className:"flex flex-col items-center gap-2",children:[o.jsx("h2",{className:"text-4xl font-black text-white drop-shadow-lg tracking-tighter uppercase",children:"Tmmerhogging"}),o.jsxs("div",{className:"flex gap-4",children:[o.jsxs("div",{className:"text-amber-400 font-black uppercase tracking-widest text-xs px-4 py-1 bg-black/40 rounded-full inline-block border border-amber-500/20",children:["Framdrift: ",c,"/10"]}),n>0&&o.jsxs("div",{className:"text-rose-500 font-black uppercase tracking-widest text-xs px-4 py-1 bg-rose-500/10 rounded-full inline-block border border-rose-500/30 animate-bounce",children:["COMBO: x",n]}),b&&o.jsxs("div",{className:"text-indigo-400 font-black uppercase tracking-widest text-xs px-4 py-1 bg-indigo-500/10 rounded-full inline-block border border-indigo-500/30",children:[b.icon," ",b.name]})]})]})}),o.jsxs("div",{className:`relative z-10 w-full h-96 bg-white/5 rounded-[3rem] border border-white/10 shadow-inner overflow-hidden ${a?"opacity-90 grayscale-[0.5]":""}`,children:[o.jsx("div",{className:"absolute bottom-0 left-0 h-2 bg-indigo-500/50 transition-all duration-300 z-0",style:{width:`${c/10*100}%`}}),h?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-4",children:[o.jsx("div",{className:"animate-bounce text-5xl font-black text-amber-500 uppercase tracking-tighter drop-shadow-2xl",children:"VEDHOGST FERDIG! "}),o.jsxs("div",{className:"text-xl font-black text-white uppercase tracking-widest bg-indigo-600 px-8 py-2 rounded-full shadow-lg",children:["Maks Combo: ",n]})]}):o.jsx("button",{onClick:y,onKeyDown:g=>{g.key===" "&&g.preventDefault()},className:`absolute w-20 h-20 bg-rose-500 rounded-full border-4 border-white shadow-[0_0_30px_rose] transition-all active:scale-90 ${a?"scale-110 brightness-150":"animate-pulse cursor-pointer"}`,style:{left:`${d.x}%`,top:`${d.y}%`,transform:"translate(-50%, -50%)"},children:""})]})]})},A$=(t,e)=>{if(e)return e.find(n=>{var r;if(!n)return!1;const s=Object.keys(Oe).find(a=>n.id===a||n.id.startsWith(a+"_")),i=s?Oe[s]:null;return(r=i==null?void 0:i.relevantActions)==null?void 0:r.includes(t)})},r_=({onComplete:t,equipment:e=[],speedMultiplier:n=1,possibleYield:s=10,resourceName:i="Korn"})=>{const[r,a]=_.useState(0),[l,c]=_.useState(0),[u,d]=_.useState(!1),[f,h]=_.useState(!1),[m,v]=_.useState(!1),y=()=>{u||m||a(b=>{var p;const g=b+2*n;if(g>=100){const x=A$("WORK",e),w=((p=x==null?void 0:x.stats)==null?void 0:p.yieldBonus)||0,k=Math.ceil(s/5*1.25),S=Math.ceil(w/5*1.25);return h(!0),v(!0),je.spawnFloatingText(`+ ${k} ${i} ${S>0?`(+${S})`:""} `,50,40,"text-amber-400 font-black text-xl"),je.spawnParticles(50,50,"bg-emerald-400"),setTimeout(()=>{h(!1),v(!1)},100),c(N=>(N+1>=5&&(d(!0),setTimeout(()=>t(1),800)),N+1)),0}return g})};return o.jsxs("div",{onMouseMove:y,className:`p-8 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden ${f?"animate-shake":""} `,style:{backgroundImage:'url("/images/minigames/agriculture_bg.png")',backgroundSize:"cover"},children:[o.jsx("div",{className:`absolute inset-0 bg-black/50 z-0 transition-all duration-75 ${m?"bg-emerald-900/40 mix-blend-hard-light":""}`}),o.jsxs("div",{className:`relative z-10 w-full flex flex-col items-center transition-all duration-75 ${m?"scale-105 brightness-150 contrast-125":""}`,children:[o.jsx("h2",{className:"text-3xl font-black text-white mb-4",children:"Scythe Sweep"}),o.jsx("div",{className:"w-full h-4 bg-white/10 rounded-full mb-8 border border-white/20 overflow-hidden",children:o.jsx("div",{className:"h-full bg-amber-400 transition-all duration-75",style:{width:`${r}% `}})}),o.jsx("div",{className:"grid grid-cols-5 gap-2",children:[...Array(5)].map((b,g)=>o.jsx("div",{className:`w-8 h-8 rounded-lg border-2 ${l>g?"bg-amber-500 border-amber-300":"border-white/20"} `},g))}),o.jsx("div",{className:"mt-8 text-slate-400 text-sm font-bold uppercase tracking-widest animate-pulse",children:"Beveg musen raskt frem og tilbake!"})]})]})},a_=({onComplete:t,speedMultiplier:e=1,variant:n="water"})=>{const[s,i]=_.useState(0),[r,a]=_.useState(0),[l,c]=_.useState(!1),[u,d]=_.useState(50),[f,h]=_.useState(1),[m,v]=_.useState(!1);_.useEffect(()=>{if(l)return;const b=setInterval(()=>{i(g=>{let p=3/e,x=g+p*f;return x>100?(h(-1),100):x<0?(h(1),0):x})},16);return()=>clearInterval(b)},[f,l,e]);const y=()=>{if(Math.abs(s-u)<10)v(!0),setTimeout(()=>v(!1),200),a(g=>{const p=n==="land"?"FANGST! ":"NAPP! ";return je.spawnFloatingText(p,50,40,"text-emerald-400 font-black text-3xl"),je.spawnParticles(50,50,"bg-emerald-400"),g+1>=3&&(c(!0),setTimeout(()=>t(1),1e3)),g+1}),d(20+Math.random()*60);else{v(!0),setTimeout(()=>v(!1),200);const g=n==="land"?"BOM... ":"INGENTING... ";je.spawnFloatingText(g,50,40,"text-rose-400 font-bold text-xl")}};return o.jsxs("div",{className:`p-12 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden transition-transform ${m?"animate-shake":""}`,style:{backgroundImage:n==="land"?'url("/images/textures/bark.png")':'url("/images/minigames/foraging_bg.png")',backgroundColor:n==="land"?"#2f3e28":"#0c4a6e",backgroundSize:"cover"},children:[o.jsx("div",{className:"absolute inset-0 bg-black/70 z-0"}),o.jsx("h2",{className:"relative z-10 text-4xl font-black text-white mb-12 tracking-tighter uppercase italic drop-shadow-lg",children:n==="land"?"Fellefangst ":"Snarefiske "}),o.jsxs("div",{className:"relative z-10 w-full max-w-sm h-12 bg-white/5 rounded-full border border-white/10 mb-12 shadow-inner overflow-hidden",children:[o.jsx("div",{className:"absolute inset-y-0 w-20 bg-amber-500/40 border-x-2 border-amber-500/50 rounded-lg blur-[1px]",style:{left:`${u}%`,transform:"translateX(-50%)"}}),o.jsx("div",{className:"absolute inset-y-0 w-1 bg-white shadow-[0_0_15px_white] z-20",style:{left:`${s}%`}})]}),o.jsx("div",{className:"relative z-10 flex gap-4 mb-12",children:[...Array(3)].map((b,g)=>o.jsx("div",{className:`w-16 h-16 rounded-2xl flex items-center justify-center text-3xl border-2 transition-all duration-300 ${r>g?"bg-emerald-500 border-emerald-300 scale-110 shadow-[0_0_20px_rgba(16,185,129,0.5)]":"bg-white/5 border-white/10 opacity-30 shadow-inner"} `,children:r>g?n==="land"?"":"":""},g))}),o.jsx("button",{onClick:y,className:"relative z-10 w-full max-w-md bg-sky-600 hover:bg-sky-500 text-white py-8 rounded-[2rem] font-black text-3xl shadow-2xl active:scale-95 transition-all uppercase tracking-widest border-b-8 border-sky-800 active:border-b-0 active:translate-y-2 group",children:o.jsx("span",{className:"drop-shadow-md group-hover:scale-105 inline-block transition-transform",children:n==="land"?"SJEKK FELLA! ":"HAL INN! "})})]})},j$=({onComplete:t,speedMultiplier:e=1})=>{const[n,s]=_.useState("right"),[i,r]=_.useState(0),[a,l]=_.useState(!1),[c,u]=_.useState(null),d=f=>{a||f!==n&&(s(f),r(h=>{const m=h+5*e;return m>=100?(l(!0),setTimeout(()=>t(1),1e3),100):m}),u(f==="left"?"":""),setTimeout(()=>u(null),200))};return _.useEffect(()=>{const f=h=>{(h.key==="ArrowLeft"||h.key==="a"||h.key==="A")&&d("left"),(h.key==="ArrowRight"||h.key==="d"||h.key==="D")&&d("right")};return window.addEventListener("keydown",f),()=>window.removeEventListener("keydown",f)},[n,a]),o.jsxs("div",{className:"p-12 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden",style:{backgroundImage:'url("/images/minigames/weavery_bg.png")',backgroundSize:"cover",backgroundColor:"#1e1b4b"},children:[o.jsx("div",{className:"absolute inset-0 bg-black/70 z-0"}),o.jsx("h2",{className:"relative z-10 text-4xl font-black text-white mb-8 tracking-tighter uppercase italic",children:"Veveri: Vevstol "}),o.jsxs("div",{className:`relative z-10 w-full max-w-lg aspect-video bg-slate-900/50 border-4 rounded-3xl p-8 mb-12 flex flex-col justify-between overflow-hidden transition-all ${c?"brightness-125":""} ${n==="left"?"border-indigo-500/50 shadow-[inset_20px_0_40px_rgba(99,102,241,0.1)]":"border-emerald-500/50 shadow-[inset_-20px_0_40px_rgba(16,185,129,0.1)]"} `,children:[o.jsxs("div",{className:"flex justify-between items-center mb-8 relative h-32",children:[o.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 text-6xl transition-all duration-300 ease-out z-20",style:{left:n==="left"?"0%":"calc(100% - 4rem)",transform:`translateY(-50%) rotate(${n==="left"?"0deg":"180deg"})`},children:""}),o.jsx("div",{className:`text-6xl transition-all duration-500 ${n==="left"?"scale-110 opacity-100 rotate-12":"scale-75 opacity-20"} `,children:""}),o.jsx("div",{className:"absolute inset-x-0 h-1 bg-white/20 top-1/2 -translate-y-1/2 pointer-events-none"}),o.jsx("div",{className:`text-6xl transition-all duration-500 ${n==="right"?"scale-110 opacity-100 -rotate-12":"scale-75 opacity-20"} `,children:""})]}),o.jsx("div",{className:"text-sm font-black text-indigo-300 uppercase tracking-[0.3em] h-8 animate-pulse",children:c||"Veksle mellom Venstre / Hyre"})]}),o.jsxs("div",{className:"relative z-10 flex gap-12 mb-8",children:[o.jsx("button",{onClick:()=>d("left"),className:`w-28 h-28 rounded-[2rem] flex items-center justify-center text-4xl border-4 transition-all active:scale-90 ${n==="right"?"bg-indigo-600 border-indigo-400 scale-110 shadow-[0_0_30px_rgba(99,102,241,0.5)]":"bg-white/5 border-white/10 opacity-30 shadow-inner"} `,children:""}),o.jsx("button",{onClick:()=>d("right"),className:`w-28 h-28 rounded-[2rem] flex items-center justify-center text-4xl border-4 transition-all active:scale-90 ${n==="left"?"bg-emerald-600 border-emerald-400 scale-110 shadow-[0_0_30px_rgba(16,185,129,0.5)]":"bg-white/5 border-white/10 opacity-30 shadow-inner"} `,children:""})]}),o.jsx("div",{className:"relative z-10 w-full max-w-sm h-4 bg-white/10 rounded-full border border-white/10 overflow-hidden",children:o.jsx("div",{className:"h-full bg-indigo-500 transition-all duration-300",style:{width:`${i}% `}})})]})},R$=({onComplete:t,speedMultiplier:e=1})=>{var v;const[n,s]=_.useState([]),[i,r]=_.useState([]),[a,l]=_.useState(0),[c,u]=_.useState(!1),[d,f]=_.useState(null),h=[{id:"red",icon:"",label:"Rdurt"},{id:"blue",icon:"",label:"Blbr"},{id:"green",icon:"",label:"Grnnmose"},{id:"yellow",icon:"",label:"Gulrot"}];_.useEffect(()=>{const y=[];for(let b=0;b<5;b++)y.push(h[Math.floor(Math.random()*h.length)].id);s(y)},[]);const m=y=>{if(!(c||d))if(y===n[a]){const b=a+1;r(g=>[...g,y]),l(b),f("RIKTIG! "),setTimeout(()=>f(null),500),b>=n.length&&(u(!0),setTimeout(()=>t(1),1e3))}else f("FEIL... "),l(0),r([]),setTimeout(()=>f(null),1e3)};return o.jsxs("div",{className:"p-12 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden",style:{backgroundImage:'url("/images/minigames/apothecary_bg.png")',backgroundSize:"cover",backgroundColor:"#2e1065"},children:[o.jsx("div",{className:"absolute inset-0 bg-black/70 z-0"}),o.jsx("h2",{className:"relative z-10 text-4xl font-black text-white mb-8 tracking-tighter uppercase italic",children:"Apoteker: Brygging "}),o.jsx("div",{className:"relative z-10 mb-12 flex gap-4 h-24 items-center",children:n.map((y,b)=>{var g;return o.jsx("div",{className:`w-16 h-16 rounded-2xl flex items-center justify-center text-3xl transition-all border-2 border-white/10 ${a>b?"opacity-10 scale-90":"bg-black/40 scale-100"} `,children:(g=h.find(p=>p.id===y))==null?void 0:g.icon},b)})}),d&&o.jsx("div",{className:`relative z-10 text-3xl font-black mb-8 animate-in zoom-in ${d.includes("FEIL")?"text-rose-500":"text-emerald-400"} `,children:d}),o.jsxs("div",{className:"relative z-10 w-48 h-64 bg-white/5 border-4 border-white/20 rounded-b-[4rem] rounded-t-3xl overflow-hidden mb-12 shadow-inner",children:[o.jsx("div",{className:"absolute bottom-0 inset-x-0 transition-all duration-1000 ease-out",style:{height:`${a/n.length*100}%`,backgroundColor:a>0?(v=h.find(y=>y.id===n[a-1]))==null?void 0:v.id:"transparent",opacity:.6},children:o.jsx("div",{className:"absolute top-0 inset-x-0 h-4 bg-white/20 animate-pulse pointer-events-none"})}),o.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-6xl opacity-20 transition-transform duration-500 scale-125",children:""})]}),o.jsx("div",{className:"relative z-10 grid grid-cols-2 gap-4",children:h.map(y=>o.jsxs("button",{onClick:()=>m(y.id),className:`w-32 h-32 bg-slate-900/80 border-2 rounded-3xl flex flex-col items-center justify-center transition-all active:scale-90 shadow-xl group ${d==="RIKTIG! "&&n[a-1]===y.id?"border-emerald-500 scale-105 shadow-emerald-500/20":"border-white/20 hover:border-white/40"} `,children:[o.jsx("span",{className:"text-4xl mb-2 group-hover:scale-110 transition-transform",children:y.icon}),o.jsx("span",{className:"font-bold text-white uppercase text-sm",children:y.label})]},y.id))})]})},I$=({onComplete:t,speedMultiplier:e=1})=>{const[n,s]=_.useState(0),[i,r]=_.useState(0),[a,l]=_.useState(!0),[c,u]=_.useState(0),[d,f]=_.useState(!1),[h,m]=_.useState(1);_.useEffect(()=>{if(d)return;const y=setInterval(()=>{u(b=>{let g=b+h*3*e;return g>=100?(m(-1),100):g<=0?(m(1),0):g})},16);return()=>clearInterval(y)},[h,d,e]);const v=_.useCallback(y=>{if(d)return;const b=Math.abs(c-50),g=b<15,p=b>35;let x=0,w="",k="";g?(x=1,w="PERFEKT!",k="text-amber-400"):p?(x=.1,w="BOM!",k="text-rose-400"):(x=.5,w="BRA!",k="text-emerald-400");const S="clientX"in y?y.clientX:y.touches[0].clientX,N="clientY"in y?y.clientY:y.touches[0].clientY;je.spawnFloatingText(w,S,N-40,k),x>.1&&je.spawnParticles(S,N,x===1?"bg-amber-400":"bg-emerald-400"),r(E=>E+1),l(!a);const T=x*10;s(E=>{const j=E+T;return j>=100?(f(!0),je.spawnFloatingText("PLANKER FERDIG! ",S,N-100,"text-emerald-400 text-2xl font-black"),setTimeout(()=>t(1),1e3),100):j})},[c,d,a,t]);return o.jsxs("div",{className:"p-12 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden",children:[o.jsxs("div",{className:"absolute inset-0 bg-slate-950 z-0",children:[o.jsx("div",{className:"absolute inset-0 opacity-20 bg-[url('/images/textures/wood_pattern.png')] bg-repeat"}),o.jsx("div",{className:"absolute inset-x-0 bottom-0 h-32 bg-gradient-to-t from-indigo-500/10 to-transparent"})]}),o.jsxs("div",{className:"relative z-10 w-full mb-12",children:[o.jsx("h2",{className:"text-5xl font-black text-white uppercase tracking-tighter mb-2 italic drop-shadow-[0_0_20px_rgba(255,255,255,0.2)]",children:"Saging"}),o.jsx("p",{className:"text-slate-400 font-bold uppercase tracking-[0.3em] text-xs",children:"Pull og Push i takt for perfekte planker"})]}),o.jsxs("div",{className:"relative z-10 w-full max-w-2xl h-64 bg-slate-900/50 rounded-[3rem] border border-white/5 shadow-2xl overflow-hidden flex items-center justify-center group cursor-pointer",onClick:v,children:[o.jsx("div",{className:"absolute inset-y-0 left-0 bg-indigo-500/20 transition-all duration-500 z-0",style:{width:`${n}%`}}),o.jsxs("div",{className:"relative w-4/5 h-16 bg-[#3d2b1f] rounded-lg border-2 border-[#2a1d15] shadow-2xl flex items-center",children:[o.jsx("div",{className:"absolute inset-0 opacity-30 bg-[url('/images/textures/bark.png')] bg-cover mix-blend-overlay"}),o.jsx("div",{className:`absolute top-1/2 left-1/2 -translate-y-1/2 -translate-x-1/2 transition-transform duration-300 ${a?"-rotate-12 translate-x-4":"rotate-12 -translate-x-4"}`,children:o.jsx("div",{className:"text-6xl filter drop-shadow-[0_0_15px_rgba(255,255,255,0.3)]",children:""})}),o.jsxs("div",{className:"absolute bottom-0 left-1/2 -translate-x-1/2 flex gap-1 opacity-40",children:[o.jsx("div",{className:"w-1 h-1 bg-amber-200 rounded-full animate-ping"}),o.jsx("div",{className:"w-1 h-1 bg-amber-400 rounded-full animate-ping delay-75"}),o.jsx("div",{className:"w-1 h-1 bg-amber-100 rounded-full animate-ping delay-150"})]})]})]}),o.jsxs("div",{className:"relative z-10 mt-12 w-full max-w-md h-12 bg-black/40 rounded-full border border-white/10 p-1 flex items-center shadow-inner",children:[o.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 w-1/4 h-3/4 bg-amber-500/20 blur-sm rounded-full"}),o.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 w-[2px] h-full bg-amber-500/50"}),o.jsx("div",{className:"absolute w-8 h-8 bg-white rounded-full shadow-[0_0_20px_white] flex items-center justify-center transition-all duration-16 ease-linear",style:{left:`${c}%`,transform:"translateX(-50%)"},children:o.jsx("div",{className:"w-4 h-4 bg-indigo-500 rounded-full animate-pulse"})})]}),o.jsxs("div",{className:"relative z-10 mt-8",children:[o.jsxs("div",{className:"text-3xl font-black text-indigo-400 italic",children:[n.toFixed(0),"%"]}),o.jsxs("div",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mt-2",children:["Stroke: ",i]})]}),o.jsx("div",{className:"absolute inset-0 z-20 cursor-pointer",onClick:v})]})},C$=({onComplete:t,speedMultiplier:e=1})=>{const[n,s]=_.useState(20),[i]=_.useState({min:60,max:85}),[r,a]=_.useState(0),[l,c]=_.useState(!1),u=_.useRef(null),d=_.useRef(null),f=m=>{if(!l){if(d.current===void 0||d.current===null){d.current=m,u.current=requestAnimationFrame(f);return}if(d.current!==void 0){const v=m-d.current;s(y=>Math.max(0,y-.015*v*e)),s(y=>(y>=i.min&&y<=i.max&&a(b=>{const g=b+.01*v;return g>=100&&!l&&(c(!0),je.spawnFloatingText("PERFEKT TEMPERATUR! ",window.innerWidth/2,window.innerHeight/2,"text-orange-500 text-4xl font-black"),setTimeout(()=>t(1),1e3)),g}),y))}d.current=m,u.current=requestAnimationFrame(f)}};_.useEffect(()=>(u.current=requestAnimationFrame(f),()=>{u.current&&cancelAnimationFrame(u.current)}),[l]);const h=()=>{l||(s(m=>Math.min(100,m+12)),je.spawnParticles(window.innerWidth/2,window.innerHeight/2+100,"bg-orange-500"),je.spawnFloatingText("PUST!",window.innerWidth/2,window.innerHeight/2+50,"text-slate-400 font-bold text-xs uppercase"))};return o.jsxs("div",{onClick:h,className:"p-12 min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden cursor-pointer select-none",style:{backgroundImage:'url("/images/minigames/smeltery_bg.png")',backgroundSize:"cover",backgroundColor:"#2a1205"},children:[o.jsx("div",{className:"absolute inset-0 bg-black/80 z-0"}),o.jsxs("div",{className:"relative z-10 text-center mb-12",children:[o.jsx("h2",{className:"text-4xl font-black text-white uppercase tracking-tighter drop-shadow-xl",children:"Smelting"}),o.jsx("div",{className:"text-orange-500 font-black uppercase tracking-widest text-xs mt-2 bg-black/40 px-4 py-1 rounded-full border border-orange-500/20",children:"Hold varmen i den oransje sonen"})]}),o.jsxs("div",{className:"relative z-10 flex gap-12 items-end h-80",children:[o.jsxs("div",{className:"w-20 h-full bg-slate-900/80 rounded-full border-4 border-white/10 relative overflow-hidden shadow-2xl",children:[o.jsx("div",{className:"absolute w-full bg-orange-500/30 border-y-2 border-orange-500/50 flex items-center justify-center",style:{bottom:`${i.min}%`,height:`${i.max-i.min}%`},children:o.jsx("div",{className:"w-full h-full bg-orange-500/10 animate-pulse"})}),o.jsx("div",{className:`absolute bottom-0 w-full transition-all duration-75 shadow-[0_0_30px_rgba(249,115,22,0.5)] ${n>i.max?"bg-white":"bg-gradient-to-t from-red-600 via-orange-500 to-yellow-400"}`,style:{height:`${n}%`},children:o.jsx("div",{className:"absolute top-0 inset-x-0 h-4 bg-white/50 blur-[2px]"})})]}),o.jsxs("div",{className:"flex flex-col gap-4",children:[o.jsx("div",{className:"text-xs font-black text-slate-500 uppercase tracking-widest text-center",children:"Fremgang"}),o.jsx("div",{className:"w-12 h-64 bg-slate-900/80 rounded-2xl border-2 border-white/5 relative overflow-hidden",children:o.jsx("div",{className:"absolute bottom-0 w-full bg-indigo-500 transition-all duration-300",style:{height:`${r}%`}})}),o.jsxs("div",{className:"text-xl font-black text-white text-center",children:[Math.round(r),"%"]})]})]}),o.jsx("div",{className:"mt-16 text-slate-400 text-sm font-bold uppercase tracking-widest animate-pulse relative z-10 text-center max-w-xs",children:"Klikk for  pumpe blsebelgen og ke varmen"}),l&&o.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm animate-in fade-in zoom-in duration-300",children:o.jsx("div",{className:"text-6xl font-black text-orange-500 animate-bounce drop-shadow-[0_0_30px_rgba(249,115,22,0.5)]",children:"FERDIG! "})})]})},o_={ride_easy:{speed:.012,spawnRate:80,targetDistance:8,label:"Engelskogen",colors:{sky:"#1e293b",path:"#451a03"},xpMult:1},ride_medium:{speed:.018,spawnRate:60,targetDistance:12,label:"Fjellpasset",colors:{sky:"#0f172a",path:"#262626"},xpMult:1.5},ride_hard:{speed:.025,spawnRate:45,targetDistance:15,label:"Ulvestien",colors:{sky:"#020617",path:"#171717"},xpMult:2.2}},O$={tree:"",house:"",cow:"",rock:"",bush:""},M$=({onComplete:t,speedMultiplier:e=1,levelId:n="ride_easy",level:s=1,horse:i})=>{const r=o_[n]||o_.ride_easy,a=1+(s-1)*.15,l=1-(s-1)*.1,c=1+(s-1)*.2,u=_.useRef(null),[d,f]=_.useState(!1),[h,m]=_.useState(0),[v,y]=_.useState(0),b=_.useRef({lane:1,targetLane:1,cameraTilt:0,isJumping:!1,jumpTime:0,obstacles:[],sideObjects:[],lastSpawn:0,lastSideSpawn:0,distance:0,speed:r.speed*e*a,gameOver:!1,bobAmt:0,ticks:0});return _.useEffect(()=>{const g=p=>{b.current.gameOver||(p.key==="a"||p.key==="ArrowLeft"?b.current.targetLane=Math.max(0,b.current.targetLane-1):p.key==="d"||p.key==="ArrowRight"?b.current.targetLane=Math.min(2,b.current.targetLane+1):p.code==="Space"&&!b.current.isJumping&&(b.current.isJumping=!0,b.current.jumpTime=0,ot.playSfx("jump")))};return window.addEventListener("keydown",g),()=>window.removeEventListener("keydown",g)},[]),_.useEffect(()=>{const g=u.current;if(!g)return;const p=g.getContext("2d");if(!p)return;let x;const w=()=>{if(b.current.gameOver)return;if(b.current.ticks++,b.current.distance+=b.current.speed,b.current.lane!==b.current.targetLane){const E=b.current.targetLane-b.current.lane;b.current.lane+=E*.2,Math.abs(b.current.targetLane-b.current.lane)<.01&&(b.current.lane=b.current.targetLane),b.current.cameraTilt=E*.15}else b.current.cameraTilt*=.9;if(b.current.isJumping&&(b.current.jumpTime+=.05,b.current.jumpTime>=Math.PI&&(b.current.isJumping=!1,b.current.jumpTime=0)),b.current.bobAmt=Math.sin(b.current.ticks*.2)*5,b.current.ticks-b.current.lastSpawn>r.spawnRate*l/e&&(Math.random()>.4&&b.current.obstacles.push({id:Date.now(),lane:Math.floor(Math.random()*3),z:0,type:Math.random()>.5?"log":"rock"}),b.current.lastSpawn=b.current.ticks),b.current.ticks-b.current.lastSideSpawn>15/e){const E=["tree","tree","bush","rock","house","cow"];b.current.sideObjects.push({id:Date.now(),side:Math.random()>.5?"left":"right",z:0,type:E[Math.floor(Math.random()*E.length)],offset:.2+Math.random()*.5}),b.current.lastSideSpawn=b.current.ticks}b.current.obstacles.forEach(E=>{if(E.z+=b.current.speed,E.z>.88&&E.z<.96){const j=Math.round(b.current.lane);if(E.lane===j){const R=E.type==="log",I=b.current.isJumping&&Math.sin(b.current.jumpTime)>.6;R&&I||k()}}}),b.current.sideObjects.forEach(E=>{E.z+=b.current.speed}),b.current.obstacles=b.current.obstacles.filter(E=>E.z<1.05),b.current.sideObjects=b.current.sideObjects.filter(E=>E.z<1.05);const T=b.current.distance;m(Math.floor(T*100)),T>=r.targetDistance*c&&S(1)},k=()=>{y(15),b.current.speed*=.6,je.spawnFloatingText("OUCH!",50,40,"text-rose-500 font-black text-3xl"),b.current.obstacles=b.current.obstacles.filter(T=>T.z<.85),setTimeout(()=>y(0),300)},S=T=>{b.current.gameOver||(b.current.gameOver=!0,f(!0),setTimeout(()=>t(T),2e3))},N=()=>{var K,J;if(!p)return;p.clearRect(0,0,g.width,g.height);const T=b.current.cameraTilt;p.save(),p.translate(g.width/2,g.height/2),p.rotate(T),p.translate(-g.width/2,-g.height/2);const E=p.createLinearGradient(0,0,0,g.height);E.addColorStop(0,r.colors.sky),E.addColorStop(.5,"#334155"),E.addColorStop(.5,"#064e3b"),E.addColorStop(1,"#065f46"),p.fillStyle=E,p.fillRect(-g.width*.5,0,g.width*2,g.height),p.beginPath(),p.moveTo(g.width*.45,g.height*.5),p.lineTo(g.width*.55,g.height*.5),p.lineTo(g.width*1.3,g.height),p.lineTo(g.width*-.3,g.height),p.closePath(),p.fillStyle=r.colors.path,p.fill(),p.strokeStyle="rgba(255,255,255,0.15)",p.setLineDash([20,10]),p.lineWidth=4,[.33,.66].forEach(H=>{p.beginPath(),p.moveTo(g.width*(.45+H*.1),g.height*.5),p.lineTo(g.width*(-.3+H*1.6),g.height),p.stroke()}),p.setLineDash([]),b.current.sideObjects.forEach(H=>{const $=H.z*H.z,F=g.height*.5,Q=F+(g.height-F)*$,ce=g.width*.1+g.width*1.6*$,ve=ce*H.offset+ce*.1,de=g.width*.5+(H.side==="left"?-ve:ve),Ze=20+200*$;p.save(),p.translate(de,Q),p.font=`${Ze}px serif`,p.textAlign="center",p.textBaseline="bottom",p.globalAlpha=H.z>.95?Math.max(0,1-(H.z-.95)*10):1,p.fillText(O$[H.type]||"",0,0),p.restore()}),b.current.obstacles.forEach(H=>{const $=H.z*H.z,F=g.height*.5,Q=F+(g.height-F)*$,ce=g.width*.1+g.width*1.6*$,ve=g.width*.5+(H.lane-1)*(ce/3),de=30+150*$,Ze=H.z>.95?Math.max(0,1-(H.z-.95)*10):1;p.save(),p.globalAlpha=Ze,p.translate(ve,Q),H.type==="log"?(p.fillStyle="#78350f",p.fillRect(-de/2,-de/6,de,de/3),p.strokeStyle="#451a03",p.lineWidth=2,p.strokeRect(-de/2,-de/6,de,de/3)):(p.fillStyle="#475569",p.beginPath(),p.arc(0,0,de/2,0,Math.PI*2),p.fill(),p.strokeStyle="#1e293b",p.stroke()),p.restore()}),p.restore();const j=b.current.lane,R=g.width*.5+(j-1)*(g.width*.45);p.save(),p.fillStyle="rgba(0,0,0,0.3)",p.beginPath(),p.ellipse(R,g.height-40,60,20,0,0,Math.PI*2),p.fill(),p.restore(),p.save(),p.strokeStyle="rgba(255,255,255,0.1)",p.lineWidth=2;for(let H=0;H<10;H++){const $=(b.current.ticks*20+H*200)%g.width,F=H*77%g.height;p.beginPath(),p.moveTo($,F),p.lineTo($+50,F),p.stroke()}p.restore();const I=b.current.bobAmt,V=b.current.isJumping?-Math.sin(b.current.jumpTime)*120:0,B=i!=null&&i.skinId&&{brown:"#8B4513",white:"#E2E8F0",black:"#1A202C",golden:"#F6E05E",chestnut:"#7C2D12",grey:"#94A3B8"}[i.skinId]||"#8B4513";p.save(),p.translate(R+(v>0?(Math.random()-.5)*v:0),g.height-110+I+V),p.rotate(T*.5),p.fillStyle=B,p.beginPath(),p.ellipse(0,150,80,200,0,0,Math.PI*2),p.fill(),p.beginPath(),p.ellipse(0,0,40,70,0,0,Math.PI*2),p.fill(),p.fillStyle=(i==null?void 0:i.skinId)==="black"||(i==null?void 0:i.skinId)==="chestnut"?"#020617":"#451a03",p.beginPath(),p.ellipse(0,40,30,40,0,0,Math.PI*2),p.fill(),p.fillStyle=B,p.beginPath(),p.moveTo(-30,-50),p.lineTo(-40,-90),p.lineTo(-10,-60),p.fill(),p.beginPath(),p.moveTo(30,-50),p.lineTo(40,-90),p.lineTo(10,-60),p.fill();const O=(i==null?void 0:i.maneColor)||"#1e1b4b";if(O==="rainbow"){const H=p.createLinearGradient(-10,-60,20,100);H.addColorStop(0,"#f43f5e"),H.addColorStop(.3,"#fbbf24"),H.addColorStop(.6,"#10b981"),H.addColorStop(1,"#6366f1"),p.fillStyle=H}else p.fillStyle=O;if(p.fillRect(-10,-60,20,100),i!=null&&i.hatId&&(i==null?void 0:i.hatId)!=="none"){const H={straw_hat:"",cowboy_hat:"",crown:"",viking:"",tophat:""}[i.hatId];H&&(p.font="60px serif",p.textAlign="center",p.fillText(H,0,-60))}p.restore();const D=b.current.distance/(r.targetDistance*c),M=g.width*.6,C=(g.width-M)/2,U=20;p.fillStyle="rgba(0,0,0,0.5)",(K=p.roundRect)==null||K.call(p,C,U,M,10,5),p.fill(),p.fillStyle="#fbbf24",(J=p.roundRect)==null||J.call(p,C,U,M*Math.min(1,D),10,5),p.fill(),p.fillStyle="white",p.font="bold 12px Inter",p.textAlign="center",p.fillText(r.label.toUpperCase()+` - NIV ${s}`,g.width/2,U+25),w(),x=requestAnimationFrame(N)};return N(),()=>cancelAnimationFrame(x)},[e]),o.jsxs("div",{className:"relative w-full h-[600px] bg-slate-950 overflow-hidden flex flex-col items-center justify-center",children:[o.jsx("canvas",{ref:u,width:800,height:600,className:"w-full h-full object-cover"}),o.jsxs("div",{className:"absolute inset-0 pointer-events-none flex flex-col items-center justify-between p-12",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("h2",{className:"text-4xl font-black text-white italic tracking-tighter uppercase drop-shadow-[0_0_10px_rgba(0,0,0,0.5)]",children:"Galopp!"}),o.jsx("p",{className:"text-amber-400 font-bold uppercase tracking-widest text-sm",children:"Bruk A/D for  bytte bane, SPACE for  hoppe"})]}),d&&o.jsxs("div",{className:"bg-slate-950/80 backdrop-blur-xl p-12 rounded-[3rem] border-2 border-amber-500 animate-in zoom-in duration-300",children:[o.jsx("div",{className:"text-6xl mb-4",children:""}),o.jsx("h3",{className:"text-5xl font-black text-white italic mb-2",children:"RITT FULLFRT!"}),o.jsxs("p",{className:"text-xl text-slate-400 font-bold uppercase",children:["Du red ",h," meter"]})]})]}),o.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-20",children:o.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[radial-gradient(circle_at_center,transparent_0%,rgba(255,255,255,0.1)_100%)]"})})]})},l_=({onComplete:t,speedMultiplier:e=1})=>{const[n,s]=_.useState(0),[i,r]=_.useState(5),[a,l]=_.useState(!1),[c,u]=_.useState(50),[d,f]=_.useState(50),h=_.useRef(0),m=_.useRef(0),[v,y]=_.useState({x:50,y:50});_.useEffect(()=>{if(a)return;const g=()=>{h.current+=.02*e;const p=Math.sin(h.current)*4+Math.cos(h.current*2.3)*2,x=Math.cos(h.current*.8)*3+Math.sin(h.current*1.5)*1.5;u(50+p),f(50+x),m.current=requestAnimationFrame(g)};return m.current=requestAnimationFrame(g),()=>cancelAnimationFrame(m.current)},[a,e]);const b=()=>{if(a||i<=0)return;const g=c-v.x,p=d-v.y,x=Math.sqrt(g*g+p*p);let w=0,k="BOM!",S="text-rose-500";x<3?(w=50,k="BULLSEYE! ",S="text-amber-400",je.spawnParticles(50,50,"bg-amber-400")):x<8?(w=20,k="TREFF!",S="text-emerald-400",je.spawnParticles(50,50,"bg-white")):x<15&&(w=5,k="KANTEN...",S="text-slate-400"),je.spawnFloatingText(k,50,40,S),s(N=>N+w),r(N=>{const T=N-1;if(T<=0){l(!0);let E=.5;n+w>=100?E=1.2:n+w>=50?E=1:E=.8,setTimeout(()=>t(E),2e3)}else y({x:45+Math.random()*10,y:45+Math.random()*10});return T})};return o.jsxs("div",{onClick:b,className:"relative w-full h-[600px] overflow-hidden bg-slate-900 cursor-crosshair select-none group",style:{backgroundImage:'url("/images/minigames/forestry_bg.png")',backgroundSize:"cover",backgroundPosition:"center 30%"},children:[o.jsx("div",{className:"absolute inset-0 bg-radial-gradient from-transparent to-black/60 pointer-events-none"}),o.jsx("div",{className:"absolute w-32 h-32 rounded-full bg-white border-4 border-slate-800 shadow-2xl flex items-center justify-center transition-all duration-500",style:{left:`${v.x}%`,top:`${v.y}%`,transform:"translate(-50%, -50%) scale(0.8)"},children:o.jsx("div",{className:"w-24 h-24 rounded-full bg-rose-600 border-4 border-white flex items-center justify-center",children:o.jsx("div",{className:"w-16 h-16 rounded-full bg-white border-4 border-rose-600 flex items-center justify-center",children:o.jsx("div",{className:"w-8 h-8 rounded-full bg-rose-600 shadow-inner"})})})}),o.jsx("div",{className:"absolute pointer-events-none transition-transform duration-75 ease-out z-20",style:{left:`${c}%`,top:`${d}%`,transform:"translate(-50%, -50%)"},children:o.jsxs("div",{className:"relative w-16 h-16 opacity-80",children:[o.jsx("div",{className:"absolute top-1/2 left-0 w-full h-0.5 bg-white shadow-sm"}),o.jsx("div",{className:"absolute left-1/2 top-0 h-full w-0.5 bg-white shadow-sm"}),o.jsx("div",{className:"absolute inset-0 border-2 border-white/50 rounded-full"}),o.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-1 h-1 bg-red-500 rounded-full shadow-[0_0_10px_red]"})]})}),o.jsx("div",{className:"absolute bottom-0 right-10 w-96 h-96 pointer-events-none z-10 translate-y-10 rotate-[-10deg]",children:o.jsxs("div",{className:"w-full h-full relative",children:[o.jsx("div",{className:"absolute bottom-0 right-20 w-8 h-80 bg-stone-800 rounded-full origin-bottom rotate-12"}),o.jsx("div",{className:"absolute bottom-20 right-24 w-0.5 h-[400px] bg-white/20 rotate-12 origin-bottom border-l border-dashed border-white/30"})]})}),o.jsxs("div",{className:"absolute top-8 left-8 text-white font-black text-2xl drop-shadow-md",children:["SCORE: ",o.jsx("span",{className:"text-amber-400",children:n})]}),o.jsx("div",{className:"absolute top-8 right-8 flex gap-2",children:[...Array(5)].map((g,p)=>o.jsx("div",{className:`text-3xl transition-opacity ${p<i?"opacity-100":"opacity-20 grayscale"}`,children:""},p))}),!a&&o.jsx("div",{className:"absolute bottom-10 left-1/2 -translate-x-1/2 text-white/70 text-sm font-bold uppercase tracking-widest animate-pulse",children:"Klikk for  skyte"}),a&&o.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/80 backdrop-blur-sm z-50 animate-in fade-in run-in",children:o.jsx("h1",{className:"text-6xl font-black text-white italic uppercase tracking-tighter drop-shadow-[0_0_30px_rgba(255,255,255,0.5)]",children:n>=100?"Mesterbueskytter!":"Ferdig!"})}),o.jsx("div",{className:"absolute inset-0 bg-stone-800 -z-10"})]})},Oa={WORK:[{id:"sickle",label:"Sigd",icon:"",desc:"Presisjons-hsting for hy kvalitet."},{id:"sweep",label:"Lj",icon:"",desc:"Rask innhsting av store omrder."}],CHOP:[{id:"axe",label:"ks",icon:"",desc:"Fell trr med r makt."}],FORAGE:[{id:"gather",label:"Sanking",icon:"",desc:"Let etter mat og urter i skogen."},{id:"traps",label:"Snarefangst",icon:"",desc:"Sett feller for smvilt."}],MINE:[{id:"pickaxe",label:"Hakke",icon:"",desc:"Hugg ut malm fra fjellet."}],QUARRY:[{id:"chisel",label:"Meisel",icon:"",desc:"Hugg ut steinblokker."}],CRAFT:[{id:"hammer",label:"Smiing",icon:"",desc:"Form metallet p ambolten."}],BAKE:[{id:"oven",label:"Steking",icon:"",desc:"Stek brd i ovnen."}],WEAVE:[{id:"loom",label:"Veving",icon:"",desc:"Vev trd til stoffer."}],MIX:[{id:"brew",label:"Brygging",icon:"",desc:"Bland urter til medisiner."}],SMELT:[{id:"furnace",label:"Smelting",icon:"",desc:"Smelt malm til barrer."}],PLANT:[{id:"manual",label:"Hndsing",icon:"",desc:"S fr for hnd."}],HUNT:[{id:"bow",label:"Bueskyting",icon:"",desc:"Presisjonsjakt fra avstand."},{id:"trap",label:"Fellefangst",icon:"",desc:"Sett ut snarer for smvilt."}],SAWMILL:[{id:"saw",label:"Saging",icon:"",desc:"Sag opp tmmer til planker."}],GATHER_WOOL:[{id:"shears",label:"Saks",icon:"",desc:"Klipp ullen av sauene."}]},D$=({item:t})=>{const e=t.durability/t.maxDurability*100;return o.jsx("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 z-[110] animate-in slide-in-from-bottom-4 fade-in duration-500",children:o.jsxs("div",{className:"bg-slate-900/90 border border-white/10 rounded-full px-6 py-3 flex items-center gap-4 backdrop-blur-md shadow-2xl",children:[o.jsx("div",{className:"text-3xl drop-shadow-[0_0_10px_rgba(255,255,255,0.2)]",children:t.icon}),o.jsxs("div",{className:"flex flex-col gap-1",children:[o.jsx("div",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:t.name}),o.jsxs("div",{className:"flex items-center gap-2 text-xs font-bold text-slate-300",children:[o.jsx("div",{className:`w-2 h-2 rounded-full ${e>20?"bg-emerald-500":"bg-rose-500"} animate-pulse`}),o.jsx("span",{children:"Slitasje"}),o.jsxs("span",{children:[Math.round(e),"%"]})]})]})]})})},L$=({type:t,onComplete:e,onCancel:n,equipment:s,skills:i,playerUpgrades:r,currentSeason:a="Spring",currentWeather:l="Clear",totalTicks:c=0,selectedMethod:u,action:d,player:f})=>{var k,S,N;const[h,m]=Ge.useState(u||null);Ge.useEffect(()=>{const T=Oa[t];T&&T.length===1&&!h&&m(T[0].id)},[t,h]);const v=Ge.useMemo(()=>EA(t,s||[]),[t,s]),y=Ge.useMemo(()=>{var j,R;const T=Pn[a],E=js[l];return{speedMultiplier:((E==null?void 0:E.speedMod)||1)*(((j=v==null?void 0:v.stats)==null?void 0:j.speedBonus)||1),staminaCostMod:((T==null?void 0:T.staminaMod)||1)*((E==null?void 0:E.staminaMod)||1),yieldMod:(((R=v==null?void 0:v.stats)==null?void 0:R.yieldBonus)||0)+((T==null?void 0:T.yieldMod)||1)}},[a,l,v]),b=Ge.useMemo(()=>{var V,B;const T={skills:i||{},equipment:{}};s&&s.forEach(O=>{const D=O.slot||O.type;O&&D&&(T.equipment[D]=O)});let E=10,j="FARMING",R=t;switch(t){case"MINE":E=ee.YIELD.MINE_ORE,j="MINING";break;case"QUARRY":E=ee.YIELD.QUARRY_STONE,j="MINING";break;case"CHOP":E=ee.YIELD.CHOP_WOOD,a==="Summer"&&(E+=ee.YIELD.SUMMER_WOOD_BONUS),j="WOODCUTTING";break;case"WORK":case"HARVEST":E=ee.YIELD.WORK_GRAIN,r!=null&&r.includes("iron_plow")&&(E+=ee.YIELD.PLOW_BONUS),j="FARMING";break;case"FORAGE":E=ee.YIELD.FORAGE_BREAD,j="FARMING";break}const I={season:((V=Pn[a])==null?void 0:V.yieldMod)||1,weather:((B=js[l])==null?void 0:B.yieldMod)||1,actionType:R,upgrades:1};try{const O=ms(T,E,j,I);return console.log(`[MinigameOverlay] Yield Calc. Type: ${t}, Base: ${E}. Result: ${O}. Equipment:`,T.equipment),isNaN(O)?1.5:O}catch(O){return console.error("Yield Calc Error:",O),1.5}},[t,i,s,r,a,l]),g=Ge.useMemo(()=>{let T=10;switch(t){case"MINE":T=ee.YIELD.MINE_ORE;break;case"QUARRY":T=ee.YIELD.QUARRY_STONE;break;case"CHOP":T=ee.YIELD.CHOP_WOOD;break;case"WORK":case"HARVEST":T=ee.YIELD.WORK_GRAIN;break;case"FORAGE":T=ee.YIELD.FORAGE_BREAD;break}return b<=2||b<T*.4},[b,t]),p=T=>{m(T)},[x,w]=Ge.useState(!1);return g&&!x&&(t==="MINE"||t==="QUARRY"||t==="CHOP"||t==="WORK"||t==="HARVEST"||t==="FORAGE")&&h?o.jsx("div",{className:"fixed inset-0 z-[150] flex items-center justify-center bg-black/80 backdrop-blur-md animate-in fade-in zoom-in duration-300",children:o.jsxs("div",{className:"bg-slate-900 border-2 border-rose-500 rounded-3xl p-8 max-w-md w-full text-center shadow-[0_0_50px_rgba(244,63,94,0.3)]",children:[o.jsx("div",{className:"text-6xl mb-6",children:""}),o.jsx("h2",{className:"text-3xl font-black text-white uppercase tracking-tighter mb-4",children:"Manglende Verkty!"}),o.jsxs("p",{className:"text-slate-300 font-medium mb-8 leading-relaxed",children:["Du forsker  utfre ",o.jsx("span",{className:"text-rose-400 font-bold",children:t})," uten riktig verkty. Effektiviteten din er redusert med 80%."]}),o.jsxs("div",{className:"flex flex-col gap-3",children:[o.jsx("button",{onClick:()=>w(!0),className:"w-full py-4 bg-rose-600 hover:bg-rose-500 text-white rounded-xl font-black uppercase tracking-widest shadow-lg active:scale-95 transition-all",children:"Fortsett likevel"}),o.jsx("button",{onClick:n,className:"w-full py-4 bg-white/5 hover:bg-white/10 text-slate-400 hover:text-white rounded-xl font-bold uppercase tracking-widest transition-all",children:"Avbryt"})]})]})}):!h&&Oa[t]?o.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-slate-950/80 backdrop-blur-md animate-in fade-in duration-300",children:o.jsxs("div",{className:"max-w-4xl w-full p-8",children:[o.jsx("h2",{className:"text-4xl font-black text-white text-center mb-12 uppercase tracking-tighter drop-shadow-lg",children:"Velg Metode"}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:Oa[t].map(T=>o.jsxs("button",{onClick:()=>p(T.id),className:"group relative bg-slate-900 border-2 border-slate-700 hover:border-indigo-500 rounded-3xl p-8 transition-all hover:-translate-y-2 hover:shadow-[0_0_50px_rgba(79,70,229,0.3)] text-left overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-500/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),o.jsxs("div",{className:"relative z-10 flex flex-col items-center text-center gap-6",children:[o.jsx("div",{className:"text-6xl group-hover:scale-110 transition-transform duration-300",children:T.icon}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-2xl font-black text-white mb-2 uppercase tracking-wide group-hover:text-indigo-400 transition-colors",children:T.label}),o.jsx("p",{className:"text-slate-400 font-medium leading-relaxed",children:T.desc})]}),o.jsx("div",{className:"mt-4 pt-4 border-t border-white/5 w-full",children:(()=>{const E=RA(t,a,l,c);return E?o.jsx("div",{className:"flex items-center justify-center gap-2 text-sm font-bold text-slate-500",children:o.jsx("span",{children:E})}):null})()})]})]},T.id))}),o.jsx("button",{onClick:n,className:"mt-12 mx-auto block text-slate-500 font-bold hover:text-white transition-colors uppercase tracking-widest text-sm",children:"Avbryt"})]})}):o.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-slate-950/90 backdrop-blur-xl animate-in fade-in duration-300",children:[o.jsx("div",{className:"absolute top-8 right-8 z-[110]",children:o.jsx("button",{onClick:n,className:"bg-black/40 hover:bg-rose-500/20 text-white/50 hover:text-rose-400 w-12 h-12 rounded-full flex items-center justify-center transition-all",children:""})}),o.jsx("div",{className:"absolute top-8 left-8 z-[110] flex gap-4",children:o.jsxs("div",{className:"bg-black/40 backdrop-blur-md px-4 py-2 rounded-2xl border border-white/5 flex items-center gap-3",children:[o.jsx("span",{className:"text-2xl",title:((k=Pn[a])==null?void 0:k.label)||a,children:a==="Winter"?"":a==="Summer"?"":a==="Autumn"?"":""}),o.jsx("span",{className:"text-2xl",title:((S=js[l])==null?void 0:S.label)||l,children:(N=js[l])==null?void 0:N.icon}),o.jsx("div",{className:"h-4 w-[1px] bg-white/10 mx-2"}),o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:"text-[10px] uppercase font-bold text-slate-500 tracking-wider",children:"Forhold"}),o.jsxs("span",{className:`text-xs font-bold ${y.speedMultiplier<1?"text-rose-400":"text-emerald-400"}`,children:[Math.round(y.speedMultiplier*100),"% Hastighet"]})]})]})}),o.jsxs("div",{className:"w-full max-w-5xl bg-slate-900 rounded-[3rem] shadow-2xl relative overflow-hidden border border-white/5",children:[(()=>{var T,E;switch(t){case"PLANT":return o.jsx(k$,{onComplete:e});case"HARVEST":case"WORK":return h==="sweep"||h==="scythe"?o.jsx(r_,{onComplete:e,equipment:s,speedMultiplier:y.speedMultiplier}):o.jsx(lu,{onComplete:e,equipment:s,speedMultiplier:y.speedMultiplier,possibleYield:b});case"CHOP":return o.jsx(T$,{onComplete:e,equipment:s,speedMultiplier:y.speedMultiplier,possibleYield:b});case"SAWMILL":return o.jsx(I$,{onComplete:e,speedMultiplier:y.speedMultiplier});case"FORAGE":return h==="traps"?o.jsx(a_,{onComplete:e,speedMultiplier:y.speedMultiplier,variant:"land"}):o.jsx(lu,{isForaging:!0,onComplete:e,equipment:s,speedMultiplier:y.speedMultiplier,resourceName:"Mat/Urter",possibleYield:b});case"MINE":return o.jsx(lu,{isMining:!0,onComplete:e,equipment:s,speedMultiplier:y.speedMultiplier,resourceName:"Malm",possibleYield:b});case"QUARRY":return o.jsx(lu,{isQuarrying:!0,onComplete:e,equipment:s,speedMultiplier:y.speedMultiplier,resourceName:"Stein",possibleYield:b});case"CRAFT":case"REPAIR":return o.jsx(N$,{onComplete:e,speedMultiplier:y.speedMultiplier});case"SMELT":return o.jsx(C$,{onComplete:e,speedMultiplier:y.speedMultiplier});case"BAKE":const j=d!=null&&d.subType?((T=Oe[d.subType])==null?void 0:T.icon)||"":((E=Rt[d==null?void 0:d.recipeId])==null?void 0:E.icon)||"";return o.jsx(S$,{onComplete:e,speedMultiplier:y.speedMultiplier,icon:j});case"WEAVE":return o.jsx(j$,{onComplete:e,speedMultiplier:y.speedMultiplier});case"MIX":return o.jsx(R$,{onComplete:e,speedMultiplier:y.speedMultiplier});case"GATHER_WOOL":return o.jsx(r_,{onComplete:e,equipment:s,speedMultiplier:y.speedMultiplier});case"MOUNT_HORSE":return o.jsx(M$,{onComplete:e,speedMultiplier:y.speedMultiplier,levelId:h||"ride_easy",level:(d==null?void 0:d.level)||1,horse:f==null?void 0:f.horseCustomization});case"HUNT":return h==="bow"?o.jsx(l_,{onComplete:e,speedMultiplier:y.speedMultiplier}):h==="trap"?o.jsx(a_,{onComplete:e,speedMultiplier:y.speedMultiplier,variant:"land"}):o.jsx(l_,{onComplete:e,speedMultiplier:y.speedMultiplier});default:return o.jsxs("div",{className:"p-12 text-center",children:[o.jsxs("h2",{className:"text-2xl font-bold text-white mb-4",children:["Ukjent Minispill: ",t]}),o.jsx("button",{onClick:()=>e(.5),className:"px-6 py-3 bg-indigo-600 rounded-xl font-bold text-white",children:"Fullfr (Skip)"})]})}})(),v&&o.jsx(D$,{item:v})]})]})},P$=({isOpen:t,onClose:e,onConfirm:n,roleName:s})=>(_.useEffect(()=>{},[t]),t?o.jsxs("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4",children:[o.jsx("div",{className:"absolute inset-0 bg-slate-950/90 backdrop-blur-md transition-opacity duration-300",onClick:e}),o.jsxs("div",{className:"relative z-10 w-full max-w-lg bg-slate-900 border-2 border-red-500/30 rounded-[2rem] shadow-[0_0_100px_rgba(239,68,68,0.2)] overflow-hidden animate-in fade-in zoom-in duration-300",children:[o.jsx("div",{className:"absolute top-0 inset-x-0 h-32 bg-gradient-to-b from-red-900/20 to-transparent pointer-events-none"}),o.jsx("div",{className:"absolute -top-10 -right-10 w-40 h-40 bg-red-500/10 blur-[80px] rounded-full pointer-events-none"}),o.jsxs("div",{className:"p-8 relative",children:[o.jsxs("div",{className:"flex flex-col items-center text-center space-y-6",children:[o.jsxs("div",{className:"w-24 h-24 bg-red-900/20 rounded-[2rem] border border-red-500/30 flex items-center justify-center shadow-[0_0_30px_rgba(239,68,68,0.1)] relative group",children:[o.jsx("div",{className:"absolute inset-0 bg-red-500/10 rounded-[2rem] blur animate-pulse"}),o.jsx(zd,{size:48,className:"text-red-500 relative z-10"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("h2",{className:"text-3xl font-black text-white uppercase tracking-tighter italic",children:["Advarsel: ",o.jsx("span",{className:"text-red-500",children:"Uferdig Innhold"})]}),o.jsx("div",{className:"h-px w-24 bg-gradient-to-r from-transparent via-red-500/50 to-transparent mx-auto"})]}),o.jsxs("div",{className:"space-y-4 text-slate-300 font-medium leading-relaxed bg-black/20 p-6 rounded-2xl border border-white/5",children:[o.jsxs("p",{children:["Du er i ferd med  velge rollen ",o.jsx("strong",{className:"text-white uppercase tracking-wide",children:s}),"."]}),o.jsx("p",{className:"text-sm",children:"Denne rollen er under aktiv utvikling og mangler vesentlig funksjonalitet. Spillopplevelsen kan vre ufullstendig eller ubalansert."}),o.jsxs("div",{className:"flex items-center gap-3 p-3 bg-red-950/30 border border-red-500/20 rounded-xl",children:[o.jsx(mH,{size:20,className:"text-red-400 shrink-0"}),o.jsx("p",{className:"text-xs text-red-300 font-bold uppercase text-left",children:"Dette valget er permanent og kan ikke angres."})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 w-full pt-2",children:[o.jsx("button",{onClick:e,className:"px-6 py-4 rounded-xl bg-slate-800 hover:bg-slate-700 text-white font-bold tracking-wider uppercase text-sm border border-white/10 transition-all hover:scale-[1.02]",children:"Avbryt"}),o.jsx("button",{onClick:n,className:"px-6 py-4 rounded-xl bg-red-600/10 hover:bg-red-600 text-red-500 hover:text-white font-bold tracking-wider uppercase text-sm border-2 border-red-600/30 hover:border-red-500 transition-all hover:scale-[1.02] shadow-[0_0_20px_rgba(239,68,68,0.1)] hover:shadow-[0_0_30px_rgba(239,68,68,0.4)]",children:"Jeg forstr risikoen"})]})]}),o.jsx("button",{onClick:e,className:"absolute top-6 right-6 text-slate-500 hover:text-white transition-colors",children:o.jsx(us,{size:24})})]})]})]}):null),B$=({poi:t,player:e,room:n,viewingRegionId:s,onAction:i,onClose:r})=>{var E,j,R,I,V;const a=_.useRef(null),l=s==="region_ost"&&t.ost?t.ost.top:t.top,c=s==="region_ost"&&t.ost?t.ost.left:t.left,[u,d]=_.useState({x:"3rem",y:"-50%"}),[f,h]=_.useState(!1),[m,v]=_.useState({isOpen:!1,action:null}),y=((E=n.world)==null?void 0:E.season)||"Spring",b=((j=n.world)==null?void 0:j.weather)||"Clear",g=_.useMemo(()=>{var J,H,$;const B=t.id in Kt?t.id:t.parentId,O=Kt[B],M=(($=(H=(((J=n.world)==null?void 0:J.settlement)||{}).buildings)==null?void 0:H[B])==null?void 0:$.level)||1;let C=[];if(O)for(let F=1;F<=M;F++)O.levels[F]&&(C=[...C,...O.levels[F].unlocks]);const U=t.actions.filter(F=>{if(F.id==="TAX_PEASANTS"&&e.role!=="BARON"||F.id==="TAX_ROYAL"&&e.role!=="KING"||F.id==="DECREE"&&e.role!=="KING"||F.id==="RAID"&&e.role!=="BARON"||F.id==="FEAST"&&e.role!=="KING"&&e.role!=="BARON")return!1;const Q=["OPEN_CRAFTING","CRAFT","REFINE","MARKET_VIEW","OPEN_GARRISON","OPEN_TAVERN_MENU","OPEN_WEAPON_RACK","OPEN_DICE_GAME","OPEN_RESOURCE_GAME"];return!(O&&!F.id.startsWith("BUILDING_UPGRADE_")&&!Q.includes(F.id)&&!C.includes(F.id))});return["windmill_stones","sawmill_blade","smeltery_furnace","bakery_oven","weavery_loom","forge_anvil"].includes(t.id)?U.filter(F=>F.id==="OPEN_CRAFTING"||F.id==="REFINE"||F.id==="CRAFT"||F.id.startsWith("REFINE_")||F.id.startsWith("CRAFT_")||F.id in Bn).slice(0,1):U},[t,e.role,(R=n.world)==null?void 0:R.settlement]);_.useLayoutEffect(()=>{if(!a.current)return;const B=a.current.getBoundingClientRect(),O=a.current.offsetParent;if(!O){h(!0);return}const D=O.getBoundingClientRect(),M=parseFloat(c),C=parseFloat(l),U=M<50?"3rem":"calc(-100% - 3rem)",K=C/100*D.height-B.height/2,J=K+B.height;let H="-50%";K<20?H=`calc(-50% + ${20-K}px)`:J>D.height-20&&(H=`calc(-50% - ${J-(D.height-20)}px)`),d({x:U,y:H}),h(!0)},[l,c,g.length]);const p=B=>{var K,J,H;const O=[],D=Wp(e,B);if(D.forEach($=>{var F,Q,ce;(F=$.stats)!=null&&F.speedBonus&&$.stats.speedBonus!==1&&O.push({source:$.name,type:"Fart",value:`+${Math.round(($.stats.speedBonus-1)*100)}%`,icon:$.icon,isBonus:!0}),(Q=$.stats)!=null&&Q.yieldBonus&&O.push({source:$.name,type:"Utbytte",value:`+${$.stats.yieldBonus}`,icon:$.icon,isBonus:!0}),(ce=$.stats)!=null&&ce.luckBonus&&O.push({source:$.name,type:"Flaks",value:`+${Math.round($.stats.luckBonus*100)}%`,icon:$.icon,isBonus:!0})}),e.upgrades){const $=Tx[e.role]||[];e.upgrades.forEach(F=>{const Q=$.find(ce=>ce.id===F);Q&&(Q.benefit==="YIELD_GRAIN"&&(B==="WORK"||B==="MILL")&&O.push({source:Q.name,type:"Utbytte",value:"+5",icon:"",isBonus:!0}),Q.benefit==="RAID_SPEED"&&B==="RAID"&&O.push({source:Q.name,type:"Fart",value:"Raskere",icon:"",isBonus:!0}))})}const M=t.id==="tavern"||t.id==="bakery"||t.id==="great_forge"||t.id==="weavery"||t.id==="sawmill"||t.id==="windmill"||t.id==="smeltery"?t.id:t.parentId,U=((H=(J=(((K=n.world)==null?void 0:K.settlement)||{}).buildings)==null?void 0:J[M])==null?void 0:H.level)||1;if(U>=2&&O.push({source:"Bygningsbonus (Lvl 2)",type:"Utbytte",value:"+10% XP",icon:"",isBonus:!0}),U>=3&&O.push({source:"Bygningsbonus (Lvl 3)",type:"Utbytte",value:"Master Tier",icon:"",isBonus:!0}),Oa[B]){const $=Oa[B][0];$.id==="manual"||$.id==="gather"||D.some(ce=>{var ve;return((ve=ce.type)==null?void 0:ve.toLowerCase().includes($.id.toLowerCase()))||ce.id.toLowerCase().includes($.id.toLowerCase())})||O.push({source:"System",type:"ADVARSEL",value:`Du mangler ${$.label}, utbytte redusert med 80%`,icon:"",isBonus:!1})}return O},x=_.useMemo(()=>{var B;return(B=e.activeProcesses)==null?void 0:B.find(O=>!(O.locationId!==t.id||O.type==="COOP"||O.type==="WELL"&&O.readyAt<=Date.now()))},[e.activeProcesses,t.id]),w=()=>{if(!x)return 0;const B=Date.now();return Math.max(0,x.readyAt-B)},[k,S]=_.useState(w());_.useEffect(()=>{if(!x)return;const B=setInterval(()=>{const O=w();S(O),O<=0&&clearInterval(B)},1e3);return()=>clearInterval(B)},[x]);const N=B=>{const O=Math.floor(B/6e4),D=Math.floor(B%6e4/1e3);return`${O}m ${D}s`},T=o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"absolute inset-0 z-[90]",onClick:r}),o.jsx("div",{ref:a,style:{top:l,left:c,transform:`translate(${u.x}, ${u.y})`,visibility:f?"visible":"hidden",opacity:f?1:0},className:`absolute z-[100] ${f?"animate-in fade-in zoom-in":""} duration-200 pointer-events-auto`,children:o.jsxs("div",{className:"bg-slate-900/90 backdrop-blur-3xl border border-white/10 rounded-[2.5rem] p-6 shadow-[0_40px_100px_rgba(0,0,0,0.8)] min-w-[320px] w-max max-w-[400px] relative transition-all duration-500 overflow-hidden group/tooltip",children:[o.jsx("div",{className:"absolute -top-24 -left-24 w-48 h-48 bg-indigo-500/10 blur-[80px] pointer-events-none group-hover/tooltip:bg-indigo-500/20 transition-all duration-1000"}),o.jsxs("div",{className:"flex items-center justify-between mb-6 relative z-10",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("div",{className:"w-14 h-14 rounded-2xl bg-white/5 border border-white/10 flex items-center justify-center text-3xl shadow-inner relative overflow-hidden group/icon",children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-0 group-hover/icon:opacity-100 transition-opacity"}),t.icon]}),o.jsxs("div",{className:"flex flex-col",children:[o.jsx("h3",{className:"font-display font-black text-white text-xl uppercase tracking-tighter leading-none",children:t.label}),o.jsx("span",{className:"text-xs font-black text-indigo-400 uppercase tracking-[.2em] mt-1 opacity-90",children:"Landemerke"})]})]}),o.jsx("div",{className:"flex items-center gap-3",children:o.jsx("button",{onClick:r,className:"text-white/60 hover:text-white transition-all bg-white/10 hover:bg-white/20 rounded-full w-10 h-10 flex items-center justify-center border border-white/10 hover:border-white/30 active:scale-90",children:""})})]}),o.jsxs("div",{className:"space-y-3",children:[x?o.jsx("div",{className:"w-full relative py-4",children:k<=0?o.jsxs("div",{className:"relative group/harvest",children:[o.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-emerald-500 to-teal-500 rounded-3xl blur opacity-25 group-hover/harvest:opacity-50 transition duration-1000 group-hover:duration-200"}),o.jsxs("button",{onClick:()=>i({type:"HARVEST",locationId:t.id}),disabled:e.status.stamina<zn(15,y,b),className:`w-full relative px-6 py-8 border rounded-3xl flex items-center justify-between overflow-hidden active:scale-[0.98] transition-all
                                                ${e.status.stamina<zn(15,y,b)?"bg-red-900/20 border-red-500/30 cursor-not-allowed grayscale opacity-80":"bg-slate-900 border-emerald-500/50 hover:bg-emerald-950/30"}`,children:[o.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-emerald-500/10 blur-3xl -mr-16 -mt-16"}),o.jsxs("div",{className:"flex flex-col items-start z-10",children:[o.jsx("span",{className:`text-2xl font-black uppercase tracking-tighter italic ${e.status.stamina<zn(15,y,b)?"text-slate-500":"text-white"}`,children:"Innhsting"}),o.jsx("span",{className:`text-xs font-black uppercase tracking-[0.2em] mt-1 ${e.status.stamina<zn(15,y,b)?"text-red-400":"text-emerald-400"}`,children:e.status.stamina<zn(15,y,b)?`Mangler energi (${Math.ceil(e.status.stamina)}/${zn(15,y,b).toFixed(0)})`:"Klar til  hentes!"})]}),o.jsx("div",{className:`w-14 h-14 rounded-2xl flex items-center justify-center text-3xl shadow-[0_0_20px_rgba(16,185,129,0.3)] ${e.status.stamina<zn(15,y,b)?"bg-slate-800 text-slate-600":"bg-emerald-500/20 animate-bounce"}`,children:e.status.stamina<zn(15,y,b)?o.jsx($H,{size:24,className:"text-red-500"}):""})]})]}):o.jsxs("div",{className:"p-8 bg-white/5 border border-white/10 rounded-[2rem] flex flex-col items-center gap-6 relative overflow-hidden group/timer",children:[o.jsx("div",{className:"absolute -bottom-12 -right-12 w-24 h-24 bg-indigo-500/5 blur-2xl rounded-full"}),o.jsxs("div",{className:"relative w-24 h-24",children:[o.jsxs("svg",{className:"w-full h-full -rotate-90",viewBox:"0 0 36 36",children:[o.jsx("circle",{cx:"18",cy:"18",r:"16",fill:"none",className:"stroke-white/5",strokeWidth:"2"}),o.jsx("circle",{cx:"18",cy:"18",r:"16",fill:"none",className:"stroke-emerald-500 transition-all duration-1000 ease-linear",strokeWidth:"2",strokeDasharray:"100",strokeDashoffset:100-(1-k/x.duration)*100,strokeLinecap:"round"})]}),o.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:o.jsx("span",{className:"text-3xl animate-pulse",children:x.type==="MILL"?"":x.type==="WELL"?"":""})})]}),o.jsxs("div",{className:"flex flex-col items-center gap-1",children:[o.jsx("span",{className:"text-sm font-black text-slate-400 uppercase tracking-widest leading-none",children:x.type==="WELL"?"Brnnen fyller seg med vann":"Venter p produksjon"}),o.jsx("span",{className:"text-2xl font-mono font-black text-white",children:N(k)})]}),o.jsx("div",{className:"w-full h-1 bg-white/5 rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full bg-emerald-500 transition-all duration-1000 ease-linear",style:{width:`${(1-k/x.duration)*100}%`}})})]})}):o.jsx("div",{className:"space-y-6",children:g.map(B=>{var $,F,Q,ce;const O=(($=n.world)==null?void 0:$.season)||"Spring",D=((F=n.world)==null?void 0:F.weather)||"Clear",M=p(B.id);let C=!0,U="";const K=["CRAFT","REFINE","OPEN_CRAFTING","BAKE","SMELT","MILL","WEAVE","MIX","OPEN_CHICKEN_COOP","OPEN_DICE_GAME","MARKET_VIEW","OPEN_GARRISON","OPEN_WEAPON_RACK"];if(s!==e.regionId&&e.role!=="KING"&&B.id!=="MARKET_VIEW")C=!1,U="Dette er ikke ditt baroni";else if(!K.includes(B.id)){const ve=jA(e,B.id,O,D,((Q=n.world)==null?void 0:Q.gameTick)||0);ve.success||(C=!1,U=ve.reason||"Krav ikke mtt")}const J=RA(B.id,O,D,((ce=n.world)==null?void 0:ce.gameTick)||0),H=Oa[B.id];return o.jsxs("div",{className:"w-full animate-in fade-in slide-in-from-bottom-2 duration-500",children:[o.jsxs("div",{className:"flex items-center justify-between px-1 mb-3",children:[o.jsx("h4",{className:"text-xs font-black text-slate-300 uppercase tracking-[0.3em]",children:B.label}),J&&o.jsx("span",{className:"text-xs font-black text-indigo-400 uppercase tracking-widest",children:J})]}),H?o.jsx("div",{className:"grid grid-cols-1 gap-4",children:H.map(ve=>{const de=Wp(e,B.id),Ze=de.find(fe=>{var me;return((me=fe.type)==null?void 0:me.toLowerCase().includes(ve.id.toLowerCase()))||fe.id.toLowerCase().includes(ve.id.toLowerCase())})||de[0],X=Ze?Ze.durability/Ze.maxDurability*100:null;return o.jsxs("button",{onClick:()=>i({type:B.id,method:ve.id,locationId:t.id}),disabled:!C,className:`group relative flex items-center gap-6 w-full p-5 rounded-[2rem] border transition-all duration-300 ${C?"bg-white/5 border-white/10 hover:border-indigo-500/50 hover:bg-indigo-500/5 active:scale-[0.98]":"bg-black/20 border-white/5 cursor-not-allowed"}`,children:[o.jsx("div",{className:`w-16 h-16 rounded-2xl bg-white/5 flex-shrink-0 flex items-center justify-center text-4xl group-hover:scale-110 transition-transform duration-500 ${!C&&"opacity-40"}`,children:ve.icon}),o.jsxs("div",{className:"flex-1 flex flex-col justify-center min-w-0 items-start",children:[o.jsx("span",{className:"font-display font-black text-white text-xl uppercase tracking-tighter group-hover:text-indigo-400 transition-colors truncate",children:ve.label}),C?o.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[o.jsx("span",{className:"text-[10px] text-slate-400 font-black uppercase tracking-widest truncate opacity-60",children:ve.desc}),M.length>0&&o.jsx("div",{className:"flex gap-1.5",children:M.filter(fe=>!fe.isBonus||fe.value.includes("+")).slice(0,1).map((fe,me)=>o.jsx("span",{className:"text-[10px] text-emerald-400 font-black px-2 py-0.5 bg-emerald-400/10 rounded-full",children:fe.value},me))})]}):o.jsx("span",{className:"text-xs font-black text-rose-500 uppercase tracking-widest mt-0.5",children:U})]}),o.jsxs("div",{className:"flex flex-col items-end gap-3 ml-2",children:[X!==null&&C&&o.jsx("div",{className:"w-10 h-1.5 bg-white/10 rounded-full overflow-hidden shadow-inner",children:o.jsx("div",{className:`h-full transition-all duration-1000 ${X>50?"bg-indigo-500 shadow-[0_0_8px_rgba(99,102,241,0.5)]":X>20?"bg-amber-500":"bg-rose-500"}`,style:{width:`${X}%`}})}),o.jsx(yr,{size:22,className:`transition-all ${C?"text-white/20 group-hover:text-indigo-400 group-hover:translate-x-1":"text-white/5"}`})]})]},ve.id)})}):o.jsx("button",{onClick:()=>{B.id==="JOIN_ROLE"?v({isOpen:!0,action:{...B,locationId:t.id}}):i({...B,type:B.id,locationId:t.id})},disabled:!C,className:`w-full group relative overflow-hidden p-5 rounded-3xl border transition-all duration-300 ${C?"bg-white/5 border-white/10 hover:border-indigo-500/50 hover:bg-indigo-500/5 active:scale-[0.98]":"bg-black/20 border-white/5 opacity-50 cursor-not-allowed"}`,children:o.jsxs("div",{className:"flex items-center justify-between relative z-10",children:[o.jsxs("div",{className:"flex flex-col items-start",children:[o.jsx("span",{className:"text-xl font-black text-white group-hover:text-indigo-400 transition-colors uppercase tracking-tight",children:B.label}),!C&&o.jsx("span",{className:"text-sm font-black text-rose-500 uppercase tracking-widest mt-1",children:U})]}),o.jsx(yr,{size:20,className:"text-white/20 group-hover:text-indigo-400 group-hover:translate-x-1 transition-all"})]})})]},B.id)})}),(()=>{var U,K,J,H,$;const B=g.map(F=>F.id),O=Object.values(e.equipment||{}),C=Object.values(Oe).filter(F=>{var Q;return(Q=F.relevantActions)==null?void 0:Q.some(ce=>B.includes(ce))}).map(F=>{if(O.find(ce=>ce.id===F.id||ce.id.startsWith(F.id+"_"))){const ce=F.nextTierId;return ce?Oe[ce]:null}else return F.level===1?F:null}).filter(Boolean).filter((F,Q,ce)=>ce.findIndex(ve=>(ve==null?void 0:ve.id)===(F==null?void 0:F.id))===Q).sort((F,Q)=>{if(!F||!Q)return 0;const ce=F.type==="MAIN_HAND"||F.type==="AXE"||F.type==="PICKAXE"||F.type==="SCYTHE"||F.type==="BOW"||F.type==="CHISEL"?1:0;return(Q.type==="MAIN_HAND"||Q.type==="AXE"||Q.type==="PICKAXE"||Q.type==="SCYTHE"||Q.type==="BOW"||Q.type==="CHISEL"?1:0)-ce});if(C.length>0){const F=C[0];if(!F)return null;const Q=Object.values(Bn).find(yt=>yt.outputItemId===F.id),ce=((U=n.world)==null?void 0:U.settlement)||{buildings:{}},ve=(Q==null?void 0:Q.buildingId)||"great_forge",de=((J=(K=ce.buildings)==null?void 0:K[ve])==null?void 0:J.level)||1,Ze=(Q==null?void 0:Q.level)||1,X=de<Ze,fe=((H=Kt[ve])==null?void 0:H.name)||"Smien",me=O.find(yt=>{var Gn;if(!yt)return!1;const Xt=Object.keys(Oe).find($t=>yt.id===$t||yt.id.startsWith($t+"_")),kn=Xt?Oe[Xt]:null;return(Gn=kn==null?void 0:kn.relevantActions)==null?void 0:Gn.some($t=>B.includes($t))});return o.jsx("div",{className:"mt-8 pt-8 border-t border-white/5 relative z-10",children:o.jsxs("div",{className:"flex flex-col gap-4",children:[o.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[o.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-amber-500 to-transparent flex-1"}),o.jsx("span",{className:`text-xs font-black uppercase tracking-[0.2em] ${X?"text-slate-400":"text-amber-500 animate-pulse"}`,children:X?`Krever niv ${Ze}`:"Utvikling venter"}),o.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-amber-500 to-transparent flex-1"})]}),o.jsxs("div",{className:"flex items-center justify-between gap-6 px-4",children:[o.jsxs("div",{className:"flex flex-col items-center gap-2 group/evolve",children:[o.jsx("div",{className:"w-16 h-16 rounded-[1.5rem] bg-white/5 border border-white/10 flex items-center justify-center text-3xl opacity-40 transition-all group-hover/evolve:opacity-60",children:(me==null?void 0:me.icon)||""}),o.jsx("span",{className:"text-[9px] font-black text-slate-500 uppercase tracking-widest",children:"N"})]}),o.jsxs("div",{className:"flex flex-col items-center flex-1 gap-2 pt-2",children:[o.jsxs("div",{className:"relative w-full flex justify-center",children:[o.jsx("div",{className:"absolute top-1/2 left-0 w-full h-px bg-gradient-to-r from-indigo-500/0 via-indigo-500/30 to-indigo-500/0"}),o.jsx(yr,{className:"text-indigo-500/50 w-6 h-6 animate-pulse relative z-10"})]}),(($=F.stats)==null?void 0:$.yieldBonus)&&o.jsxs("span",{className:"text-[10px] font-black text-emerald-400 bg-emerald-400/10 px-2 py-0.5 rounded-full border border-emerald-400/20",children:["+",F.stats.yieldBonus," Utbytte"]})]}),o.jsxs("div",{className:"flex flex-col items-center gap-2 group/next",children:[o.jsx("div",{className:`w-20 h-20 rounded-[2rem] flex items-center justify-center text-4xl border-2 shadow-2xl transition-all duration-500 ${X?"bg-slate-900/50 border-white/5 grayscale":"bg-indigo-600/20 border-indigo-500/50 shadow-indigo-500/20 hover:scale-110 active:scale-95"}`,children:F.icon}),o.jsx("span",{className:`text-xs font-black uppercase tracking-tight ${X?"text-slate-500":"text-amber-500"}`,children:F.name})]})]}),o.jsx("p",{className:"text-xs text-slate-400 text-center font-medium italic px-6 mt-2",children:X?`Forbedre ${fe} til niv ${Ze} for  lse opp.`:`Besk ${fe} i landsbyen for  smi din ${F.name}.`})]})})}return null})()]})]})})]});return o.jsxs(o.Fragment,{children:[T,o.jsx(P$,{isOpen:m.isOpen,onClose:()=>v({isOpen:!1,action:null}),onConfirm:()=>{m.action&&i(m.action),v({isOpen:!1,action:null})},roleName:((I=m.action)==null?void 0:I.targetRole)==="SOLDIER"?"Soldat":((V=m.action)==null?void 0:V.targetRole)||"Ukjent"})]})},U$=({weather:t,season:e,hideClouds:n,isInterior:s})=>{const i=_.useMemo(()=>Array.from({length:12}).map((d,f)=>({id:f,top:`${Math.random()*100}%`,delay:Math.random()*60,duration:40+Math.random()*60,scale:.5+Math.random()*1.5,opacity:.1+Math.random()*.3})),[]),r=_.useMemo(()=>Array.from({length:10}).map((d,f)=>({id:f,left:`${Math.random()*100}%`,delay:Math.random()*20,duration:10+Math.random()*20,size:5+Math.random()*10,rotation:Math.random()*360,drift:50+Math.random()*150})),[]),a=_.useMemo(()=>Array.from({length:5}).map((d,f)=>({id:f,left:`${10+Math.random()*80}%`,top:`${-10+Math.random()*40}%`,rotation:f*45+Math.random()*20,delay:f*2})),[]),l=()=>e==="Autumn"?"":e==="Spring"?"":e==="Winter"?"":"",u=100*(t==="Storm"?2.5:t==="Rain"?1.5:1);return o.jsxs("div",{className:"absolute inset-0 pointer-events-none overflow-hidden z-[5]",children:[t==="Clear"&&!s&&o.jsx("div",{className:"absolute inset-0 opacity-40",children:a.map(d=>o.jsx("div",{className:"absolute w-[400px] h-[800px] animate-sunbeam",style:{left:d.left,top:d.top,background:"radial-gradient(ellipse at top, rgba(253, 224, 71, 0.15) 0%, transparent 70%)",transform:`rotate(${d.rotation}deg)`,animationDelay:`${d.delay}s`}},d.id))}),!n&&!s&&o.jsx("div",{className:"absolute inset-0",children:i.map(d=>o.jsx("div",{className:"absolute text-white animate-cloud-drift select-none",style:{top:d.top,fontSize:`${d.scale*4}rem`,opacity:t==="Storm"?d.opacity*2:d.opacity,filter:"blur(8px)",animationDuration:`${t==="Storm"?d.duration/2:d.duration}s`,animationDelay:`-${d.delay}s`,color:t==="Storm"?"#475569":"white"},children:""},d.id))}),t==="Fog"&&!s&&o.jsx("div",{className:"absolute inset-0 bg-slate-400/10 backdrop-blur-[2px] animate-mist"}),!s&&o.jsx("div",{className:"absolute inset-0",children:r.map(d=>o.jsx("div",{className:"absolute animate-particle opacity-0",style:{left:d.left,fontSize:`${d.size}px`,animationDuration:`${d.duration}s`,animationDelay:`${d.delay}s`,filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.1))","--wind-drift":`${u+d.drift}px`,"--wind-rotation":`${720+d.rotation}deg`},children:l()},d.id))}),(t==="Clear"||s)&&o.jsx("div",{className:"absolute inset-0",children:Array.from({length:15}).map((d,f)=>o.jsx("div",{className:"absolute w-1 h-1 bg-white/40 rounded-full animate-dust-float",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDuration:`${6+Math.random()*8}s`,animationDelay:`${Math.random()*10}s`,filter:"blur(1px)"}},`dust-${f}`))}),(t==="Rain"||t==="Storm")&&!s&&o.jsx("div",{className:"absolute inset-0 bg-indigo-900/10 mix-blend-overlay"})]})},H$=({player:t,room:e})=>{const[n,s]=_.useState(Date.now()),{handleAction:i}=OA(e==null?void 0:e.pin,t,(e==null?void 0:e.world)||null,()=>{},()=>{},()=>{},null),[r,a]=_.useState({});_.useEffect(()=>{const m=setInterval(()=>{var y;const v=Date.now();if(s(v),Math.random()<.05){const b=((y=t.activeProcesses)==null?void 0:y.filter(g=>g.type==="CROP"&&g.readyAt>v))||[];if(b.length>0){const g=b[Math.floor(Math.random()*b.length)];if(!r[g.id]){const p=Math.random()>.5?"CROW":"WEED";a(x=>({...x,[g.id]:{type:p,expiresAt:v+1e4}}))}}}a(b=>{const g={...b};let p=!1;return Object.entries(g).forEach(([x,w])=>{w.expiresAt<v&&(delete g[x],p=!0)}),p?g:b})},1e3);return()=>clearInterval(m)},[t.activeProcesses,r]);const l=_.useCallback((m,v)=>{a(y=>{const b={...y};return delete b[m],b}),i({type:"MAINTAIN_CROP",processId:m,subType:v})},[i]),c=t.activeProcesses||[],u=n,d=c.filter(m=>!(!(m.type==="CROP"||m.type==="COOP"||m.type==="MILL"||m.type==="WELL"||m.type==="CRAFT")||m.type==="WELL"&&m.readyAt>0&&u>m.readyAt+1e4)),f=(t.activeBuffs||[]).filter(m=>m.expiresAt>u);if(d.length===0&&f.length===0)return null;d.sort((m,v)=>m.readyAt-v.readyAt);const h=m=>{const v=Math.floor(m/6e4),y=Math.floor(m%6e4/1e3);return`${v}m ${y}s`};return o.jsxs("div",{className:"absolute top-6 right-6 z-[60] flex flex-col gap-2 pointer-events-none items-end",children:[f.map(m=>{const v=Math.max(0,m.expiresAt-u);return o.jsxs("div",{className:"group bg-indigo-900/90 backdrop-blur-md border border-indigo-500/30 rounded-xl p-3 shadow-xl pointer-events-auto flex items-center gap-4 transition-all hover:bg-indigo-900/100 hover:scale-105 animate-in slide-in-from-right-4 duration-300 relative",children:[o.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center border bg-indigo-500/20 border-indigo-500 text-indigo-300",children:o.jsx("span",{className:"text-xl",children:""})}),o.jsxs("div",{className:"flex flex-col min-w-[120px]",children:[o.jsx("span",{className:"text-xs font-bold text-indigo-300 uppercase tracking-wider",children:m.label}),o.jsx("div",{className:"flex items-center gap-2",children:o.jsx("span",{className:"text-sm font-black text-white",children:h(v)})})]}),m.description&&o.jsx("div",{className:"absolute right-full top-1/2 -translate-y-1/2 mr-3 w-48 bg-slate-900/95 border border-indigo-500/30 p-3 rounded-xl shadow-2xl opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none translate-x-2 group-hover:translate-x-0",children:o.jsx("p",{className:"text-[10px] text-indigo-100 leading-tight",children:m.description})})]},m.id)}),d.map(m=>{const v=Math.max(0,m.readyAt-u),y=v<=0;let b="Avling Gror",g=o.jsx(Gp,{size:20}),p="Innhsting Klar!";const x=Rt[m.itemId];if(m.type==="COOP")b="Hner Spiser",g=o.jsx("span",{className:"text-xl",children:""}),p="Egg klare!";else if(m.type==="MILL")b="Kverner korn",g=o.jsx("span",{className:"text-xl",children:""}),p="Mel klart!";else if(m.type==="WELL")b="Brnnen fyller seg",g=o.jsx("span",{className:"text-xl",children:""}),p="Brnnen er klar!";else if(m.type==="CRAFT"){const S=Fi[m.itemId],N=Oe[m.itemId];S?(g=o.jsx("span",{className:"text-xl",children:S.icon||""}),b=S.label?`Lager ${S.label}...`:"Hndverk pgr...",p=S.label?`${S.label} klar!`:"Hndverk ferdig!"):N?(g=o.jsx("span",{className:"text-xl",children:N.icon||""}),b=`Lager ${N.name}...`,p=`${N.name} ferdig!`):(g=o.jsx("span",{className:"text-xl",children:""}),b="Hndverk pgr...",p="Hndverk ferdig!")}else x?(g=o.jsx("span",{className:"text-xl",children:x.icon}),b=`${x.label} gror`,p=`${x.label} klar!`):g=y?o.jsx(Uf,{size:20}):o.jsx(Gp,{size:20});const w=r[m.id],k=!!w&&!y;return o.jsxs("div",{className:`relative bg-slate-900/90 backdrop-blur-md border rounded-xl p-3 shadow-xl pointer-events-auto flex items-center gap-4 transition-all hover:bg-slate-900/95 animate-in slide-in-from-right-4 duration-300 ${m.type==="WELL"&&y?"animate-pulse":""} ${k?"border-rose-500/50 hover:border-rose-400 cursor-pointer group":"border-white/10"}`,onClick:k?()=>l(m.id,w.type):void 0,children:[k&&o.jsx("div",{className:"absolute -top-3 -right-3 z-50 animate-bounce",children:o.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center shadow-lg border-2 border-white ${w.type==="CROW"?"bg-slate-800":"bg-emerald-700"}`,children:o.jsx("span",{className:"text-lg",children:w.type==="CROW"?"":""})})}),m.yieldBonus&&m.yieldBonus>0&&o.jsxs("div",{className:"absolute -bottom-2 -right-2 px-2 py-0.5 bg-emerald-600 text-white text-[10px] font-black rounded-full shadow-lg border border-emerald-400 z-10",children:["+",Math.round(m.yieldBonus*100),"%"]}),o.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center border ${y?"bg-emerald-500/20 border-emerald-500 text-emerald-400 animate-pulse":"bg-slate-800 border-white/10 text-slate-400"}`,children:g}),o.jsxs("div",{className:"flex flex-col min-w-[120px]",children:[o.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:y?p:k?w.type==="CROW"?"Fjern Krke!":"Luk ugress!":b}),o.jsx("div",{className:"flex items-center gap-2",children:o.jsx("span",{className:`text-sm font-black ${y?"text-emerald-400":k?"text-rose-400":"text-white"}`,children:y?"Hent n":h(v)})})]})]},m.id)})]})},zi=({title:t,subtitle:e,icon:n,headerRight:s,children:i,onClose:r,className:a,maxWidth:l})=>(_.useEffect(()=>{const c=u=>{u.key==="Escape"&&r()};return window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[r]),o.jsxs("div",{className:"absolute inset-0 z-40 flex items-center justify-center p-4 md:p-8",children:[o.jsx(he.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:r,className:"absolute inset-0 bg-black/20 backdrop-blur-[1px] cursor-pointer"}),o.jsxs(he.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{type:"spring",stiffness:260,damping:25,mass:1},className:`relative w-full ${l||"max-w-5xl"} max-h-full bg-slate-950/90 backdrop-blur-md border border-white/10 rounded-3xl shadow-2xl overflow-hidden flex flex-col pointer-events-auto will-change-transform`,children:[o.jsxs("div",{className:"flex-none flex justify-between items-center px-6 py-4 border-b border-white/10 bg-gradient-to-r from-white/5 to-transparent min-h-[72px]",children:[o.jsxs("div",{className:"flex items-center gap-5 overflow-hidden",children:[n&&o.jsx("div",{className:"w-12 h-12 bg-white/5 rounded-2xl flex items-center justify-center text-3xl shadow-inner border border-white/5 shrink-0",children:n}),o.jsxs("div",{className:"flex flex-col min-w-0",children:[t&&o.jsx("h2",{className:"text-xl font-display font-black text-white tracking-tighter uppercase truncate",children:t}),e&&o.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest truncate opacity-80",children:e})]}),s&&o.jsx("div",{className:"hidden sm:flex items-center pl-4 border-l border-white/10 ml-2",children:s})]}),o.jsx("button",{onClick:r,className:"w-8 h-8 bg-white/5 hover:bg-rose-500/20 text-slate-400 hover:text-rose-500 rounded-full flex items-center justify-center transition-all group",title:"Lukk vindu",children:o.jsx("span",{className:"text-lg group-hover:rotate-90 transition-transform",children:""})})]}),o.jsx("div",{className:`flex-1 overflow-y-auto custom-scrollbar p-6 ${a||""}`,children:i})]})]})),G$=({children:t,variant:e="primary",size:n="md",icon:s,className:i="",...r})=>{const a="relative inline-flex items-center justify-center font-bold tracking-wide transition-all duration-200 uppercase rounded shadow-lg active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed",l={primary:"bg-blue-600 hover:bg-blue-500 text-white border-b-4 border-blue-800 hover:border-blue-700",secondary:"bg-game-stone hover:bg-gray-500 text-white border-b-4 border-gray-700",danger:"bg-game-danger hover:bg-red-500 text-white border-b-4 border-red-700",wood:"bg-game-wood hover:bg-amber-800 text-game-paper border-2 border-game-wood_light shadow-inner",ghost:"bg-transparent hover:bg-white/10 text-white shadow-none"},c={sm:"px-3 py-1 text-xs",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"};return o.jsxs("button",{className:`${a} ${l[e]} ${c[n]} ${i}`,...r,children:[s&&o.jsx("span",{className:"mr-2",children:s}),t]})},$$=({player:t,room:e,onAction:n,onClose:s})=>{var S,N,T,E;const i=t.role==="KING",r=(t.regionId||"").trim().toLowerCase(),a=t.regionId||"Riket";if(!e||!e.world)return null;const{world:l,regions:c}=e,u=i?null:c==null?void 0:c[t.regionId||""],d=i?l.lastRoyalTaxCollection:u==null?void 0:u.lastTaxCollection,f=d&&d.year===l.year&&d.season===l.season,h=i?l.royalTaxHistory||[]:(u==null?void 0:u.taxHistory)||[],[m,v]=_.useState(i?((N=(S=e.world)==null?void 0:S.taxRateDetails)==null?void 0:N.kingTax)||20:((E=(T=e.regions)==null?void 0:T[t.regionId||""])==null?void 0:E.taxRate)||10),[y,b]=_.useState("ADJUST"),[g,p]=_.useState(!1),{estimates:x,citizenList:w}=Ge.useMemo(()=>{let j=0,R=0,I=[];const V=m/100;return Object.values(e.players||{}).forEach(O=>{var C,U,K,J,H;if(!O||O.id===t.id)return;const D=(O.regionId||"").trim().toLowerCase();if(i?O.role==="BARON":O.role==="PEASANT"&&(D===r||D.includes(r))){const $=Number(((C=O.resources)==null?void 0:C.gold)??O.gold??O.wealth??((U=O.stats)==null?void 0:U.gold)??((J=(K=O.inventory)==null?void 0:K.find(Q=>Q.id==="gold"))==null?void 0:J.amount)??0),F=Number(((H=O.resources)==null?void 0:H.grain)??0);j+=$*V,R+=F*V,I.push({id:O.id,name:O.name,gold:$,grain:F,role:O.role,hasResources:!!O.resources,raw:O})}}),{estimates:{gold:Math.floor(j),grain:Math.floor(R),count:I.length,penalty:Math.max(0,Math.floor((m-10)/1.5))},citizenList:I.sort((O,D)=>D.gold-O.gold)}},[m,e.players,i,r,t.id]),k=()=>{n({type:i?"TAX_ROYAL":"TAX",taxRate:m}),s()};return o.jsx(zi,{title:i?"STATSKASSEN":`SKATT: ${a.toUpperCase()}`,icon:o.jsx(rH,{size:18,className:"text-game-gold"}),onClose:s,children:o.jsxs("div",{className:`p-4 sm:p-6 lg:p-10 flex flex-col gap-8 w-full ${i?"max-w-6xl":"max-w-3xl"} mx-auto transition-all ${f?"grayscale-[0.5] opacity-90":""}`,children:[o.jsxs("nav",{className:"flex bg-slate-900/80 backdrop-blur-md border border-white/5 rounded-2xl p-1.5 max-w-sm mx-auto w-full shadow-2xl relative z-20",children:[o.jsxs("button",{onClick:()=>b("ADJUST"),className:`flex-1 flex items-center justify-center gap-2 py-3 text-[10px] font-black uppercase tracking-widest transition-all rounded-xl ${y==="ADJUST"?"bg-white text-black shadow-xl scale-[1.02]":"text-slate-500 hover:text-white hover:bg-white/5"}`,children:[o.jsx(Vp,{size:14})," Justering"]}),o.jsxs("button",{onClick:()=>b("HISTORY"),className:`flex-1 flex items-center justify-center gap-2 py-3 text-[10px] font-black uppercase tracking-widest transition-all rounded-xl ${y==="HISTORY"?"bg-white text-black shadow-xl scale-[1.02]":"text-slate-500 hover:text-white hover:bg-white/5"}`,children:[o.jsx(_A,{size:14})," Historikk"]})]}),y==="ADJUST"?o.jsxs("div",{className:`grid grid-cols-1 ${i?"lg:grid-cols-12":"gap-6"} items-start animate-in fade-in zoom-in-95 duration-700`,children:[o.jsxs("div",{className:i?"lg:col-span-4 space-y-6":"space-y-6",children:[o.jsxs("div",{className:"bg-gradient-to-br from-slate-900 via-slate-950 to-black border border-white/10 rounded-[3rem] p-8 lg:p-10 shadow-[0_30px_60px_-15px_rgba(0,0,0,0.7)] relative overflow-hidden group",children:[o.jsx("div",{className:"absolute -top-12 -right-12 w-48 h-48 bg-game-gold/5 blur-[80px] rounded-full group-hover:bg-game-gold/10 transition-colors"}),o.jsxs("div",{className:"flex justify-between items-start mb-10 relative z-10",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("div",{className:"w-12 h-12 rounded-2xl bg-game-gold/10 flex items-center justify-center text-game-gold border border-game-gold/20",children:o.jsx(zp,{size:24})}),o.jsxs("div",{children:[o.jsx("span",{className:"text-[10px] font-black text-game-gold/60 uppercase tracking-[0.3em] block mb-1",children:"Innkrevingsniv"}),o.jsxs("div",{className:"flex items-baseline gap-3",children:[o.jsxs("h2",{className:"text-7xl font-black text-white italic tracking-tighter leading-none",children:[m,"%"]}),o.jsx("div",{className:`px-2.5 py-1 rounded-full border text-[9px] font-black uppercase tracking-widest shadow-lg ${x.penalty>15?"bg-red-500/10 border-red-500/20 text-red-500":"bg-emerald-500/10 border-emerald-500/20 text-emerald-500"}`,children:x.penalty===0?"Optimalt":`-${x.penalty} Lojalitet`})]})]})]}),i&&o.jsx("button",{onClick:()=>p(!g),className:"p-2.5 hover:bg-white/5 rounded-full transition-all group/info",children:o.jsx(wA,{size:18,className:g?"text-game-gold":"text-slate-700 group-hover/info:text-slate-400"})})]}),o.jsxs("div",{className:"relative h-20 flex items-center mb-6 relative z-10 px-2",children:[o.jsx("div",{className:"absolute h-2 w-full bg-slate-800/50 rounded-full"}),o.jsx("div",{className:"absolute h-2 bg-gradient-to-r from-game-gold via-orange-500 to-red-600 rounded-full shadow-[0_0_30px_rgba(251,191,36,0.5)]",style:{width:`${m/50*100}%`}}),o.jsx("input",{type:"range",min:"0",max:"50",step:"1",value:m,onChange:j=>v(parseInt(j.target.value)),disabled:f,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-30"}),o.jsx("div",{className:"absolute w-12 h-12 bg-white border-[6px] border-game-gold rounded-full shadow-[0_10px_30px_rgba(0,0,0,0.6)] transition-all pointer-events-none flex items-center justify-center scale-110",style:{left:`calc(${m/50*100}% - 24px)`},children:o.jsx("div",{className:"w-2.5 h-2.5 bg-game-gold rounded-full"})})]}),o.jsxs("div",{className:"flex justify-between text-[11px] font-black uppercase tracking-[0.25em] px-2",children:[o.jsx("span",{className:"text-slate-600",children:"Sknsel"}),o.jsx("span",{className:"text-slate-400",children:"Rettferd"}),o.jsx("span",{className:"text-red-900/80 shadow-red-500/10",children:"Tyranni"})]})]}),o.jsxs("div",{className:`grid ${i?"grid-cols-1":"grid-cols-1 sm:grid-cols-3"} gap-4`,children:[o.jsxs("div",{className:"bg-slate-900/60 backdrop-blur-sm border border-white/5 p-5 rounded-3xl flex items-center gap-4 transition-all hover:bg-slate-900 hover:border-white/10 group min-h-[90px]",children:[o.jsx("div",{className:"p-3 bg-game-gold/10 text-game-gold rounded-2xl group-hover:scale-110 transition-transform shadow-inner",children:o.jsx(jx,{size:22})}),o.jsxs("div",{className:"min-w-0",children:[o.jsx("p",{className:"text-[9px] text-slate-500 font-black uppercase tracking-widest truncate",children:"Gull"}),o.jsxs("p",{className:"text-2xl font-black text-white italic tracking-tighter truncate leading-none mt-1",children:[x.gold,"g"]})]})]}),o.jsxs("div",{className:"bg-slate-900/60 backdrop-blur-sm border border-white/5 p-5 rounded-3xl flex items-center gap-4 transition-all hover:bg-slate-900 hover:border-white/10 group min-h-[90px]",children:[o.jsx("div",{className:"p-3 bg-orange-500/10 text-orange-400 rounded-2xl group-hover:scale-110 transition-transform shadow-inner",children:o.jsx(Vp,{size:22})}),o.jsxs("div",{className:"min-w-0",children:[o.jsx("p",{className:"text-[9px] text-slate-500 font-black uppercase tracking-widest truncate",children:"Korn"}),o.jsx("p",{className:"text-2xl font-black text-white italic tracking-tighter truncate leading-none mt-1",children:x.grain})]})]}),o.jsxs("div",{className:"bg-slate-900/60 backdrop-blur-sm border border-white/5 p-5 rounded-3xl flex items-center gap-4 transition-all hover:bg-slate-800 hover:border-white/10 group min-h-[90px]",children:[o.jsx("div",{className:"p-3 bg-indigo-500/10 text-indigo-400 rounded-2xl group-hover:scale-110 transition-transform shadow-inner",children:o.jsx(_r,{size:22})}),o.jsxs("div",{className:"min-w-0",children:[o.jsx("p",{className:"text-[9px] text-slate-500 font-black uppercase tracking-widest truncate",children:i?"Baroner":"Borgere"}),o.jsx("p",{className:"text-2xl font-black text-white italic tracking-tighter leading-none mt-1",children:x.count})]})]})]}),o.jsx(G$,{variant:f?"ghost":"primary",onClick:k,disabled:f||m===0||x.count===0,className:"w-full py-8 text-2xl font-black italic uppercase rounded-[2.5rem] shadow-[0_20px_40px_-10px_rgba(37,99,235,0.4)] hover:shadow-[0_25px_50px_-10px_rgba(37,99,235,0.6)] active:scale-95 transition-all h-24",children:f?"Du har skattlagt, vent til neste rstid":"EKSEKVER SKATT"})]}),i&&o.jsx("div",{className:"lg:col-span-8 h-full",children:o.jsxs("div",{className:"bg-slate-900/40 backdrop-blur-xl border border-white/5 rounded-[3.5rem] overflow-hidden flex flex-col shadow-inner h-full min-h-[600px]",children:[o.jsxs("div",{className:"px-10 py-6 border-b border-white/5 flex justify-between items-center bg-black/40",children:[o.jsx("h4",{className:"text-[12px] font-black text-slate-400 uppercase tracking-[0.3em]",children:"Vasaller & Rikdom"}),o.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-game-gold/10 rounded-full border border-game-gold/20",children:[o.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-game-gold animate-pulse"}),o.jsx("span",{className:"text-[10px] font-black uppercase text-game-gold tracking-widest",children:w.length})]})]}),o.jsx("div",{className:"p-8 overflow-y-auto custom-scrollbar flex-1",children:w.length===0?o.jsxs("div",{className:"h-full flex flex-col items-center justify-center opacity-10 italic text-center py-20",children:[o.jsx(_r,{size:64,className:"mb-6"}),o.jsx("p",{className:"text-xl font-black uppercase tracking-[0.4em]",children:"Ingen vasaller funnet"})]}):o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:w.map(j=>o.jsxs("div",{className:"group flex items-center justify-between p-6 bg-slate-900 border border-white/[0.03] rounded-[2rem] hover:bg-white/[0.07] hover:border-white/10 transition-all cursor-default",children:[o.jsxs("div",{className:"flex items-center gap-5 min-w-0",children:[o.jsx("div",{className:"w-14 h-14 rounded-2xl bg-slate-800 flex items-center justify-center text-slate-500 border border-white/5 group-hover:bg-game-gold/10 group-hover:text-game-gold transition-all duration-300",children:o.jsx(_r,{size:22})}),o.jsxs("div",{className:"flex flex-col min-w-0",children:[o.jsx("span",{className:"text-base font-black text-white truncate leading-tight group-hover:tracking-wide transition-all",children:j.name}),o.jsx("span",{className:"text-[10px] font-black uppercase text-slate-600 tracking-widest mt-1.5",children:j.role})]})]}),o.jsxs("div",{className:"text-right ml-4 flex-shrink-0",children:[o.jsxs("p",{className:"text-2xl font-black italic tracking-tighter text-white group-hover:text-game-gold transition-colors",children:[Math.floor(j.gold),"g"]}),o.jsx("div",{className:"w-24 h-1.5 bg-white/[0.03] rounded-full mt-2.5 overflow-hidden border border-white/[0.02]",children:o.jsx("div",{className:"h-full bg-game-gold/30 shadow-[0_0_15px_rgba(251,191,36,0.3)] transition-all duration-700",style:{width:`${Math.min(100,j.gold/500*100)}%`}})})]})]},j.id))})})]})})]}):o.jsx("div",{className:"bg-slate-900/50 backdrop-blur-xl border border-white/5 rounded-[3rem] overflow-hidden animate-in fade-in slide-in-from-right-8 duration-700 max-w-4xl mx-auto w-full shadow-[0_40px_80px_-20px_rgba(0,0,0,0.8)]",children:o.jsxs("table",{className:"w-full text-base text-left",children:[o.jsx("thead",{className:"bg-black/40 text-[11px] text-game-gold font-black uppercase tracking-[0.25em] border-b border-white/5",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-10 py-8",children:"Tidsepoke"}),o.jsx("th",{className:"px-10 py-8 text-right",children:"Sats"}),o.jsx("th",{className:"px-10 py-8 text-right",children:"Gull"}),o.jsx("th",{className:"px-10 py-8 text-right",children:"Korn"})]})}),o.jsx("tbody",{className:"divide-y divide-white/5 font-bold",children:h.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:4,className:"py-40 text-center opacity-10 font-black uppercase tracking-widest text-3xl",children:"Portalens historie er tom"})}):[...h].reverse().map((j,R)=>o.jsxs("tr",{className:"hover:bg-white/5 transition-all group",children:[o.jsxs("td",{className:"px-10 py-7 text-slate-400 group-hover:text-white transition-colors",children:["r ",j.year,", ",o.jsx("span",{className:"font-black italic text-indigo-400 uppercase tracking-widest ml-3",children:j.season.toUpperCase()})]}),o.jsxs("td",{className:"px-10 py-7 text-right font-black italic text-slate-500 group-hover:text-game-gold transition-colors",children:[j.rate,"%"]}),o.jsxs("td",{className:"px-10 py-7 text-right font-black italic text-game-gold text-2xl whitespace-nowrap",children:[j.amountGold,"g"]}),o.jsx("td",{className:"px-10 py-7 text-right font-black italic text-orange-400 text-2xl whitespace-nowrap",children:j.amountGrain||0})]},R))})]})}),g&&i&&o.jsxs("div",{className:"p-8 bg-black/60 backdrop-blur-2xl border border-red-500/20 rounded-[2.5rem] mt-6 animate-in slide-in-from-top-6 max-w-lg mx-auto w-full shadow-2xl",children:[o.jsxs("div",{className:"flex items-center gap-4 mb-5 border-b border-red-500/10 pb-4",children:[o.jsx("div",{className:"p-2 bg-red-500/10 rounded-lg text-red-500",children:o.jsx(zd,{size:20})}),o.jsx("p",{className:"text-[12px] font-black text-red-400 uppercase tracking-[0.3em]",children:"Systemisk Diagnose"})]}),o.jsxs("div",{className:"text-[11px] font-mono text-slate-500 space-y-2",children:[o.jsxs("div",{className:"flex justify-between border-b border-white/[0.02] pb-1",children:[o.jsx("span",{children:"Region ID:"})," ",o.jsx("span",{className:"text-white font-bold",children:r})]}),o.jsxs("div",{className:"flex justify-between border-b border-white/[0.02] pb-1",children:[o.jsx("span",{children:"Active Entities:"})," ",o.jsx("span",{className:"text-white font-bold",children:Object.keys(e.players).length})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"Match Success:"})," ",o.jsx("span",{className:"text-emerald-500 font-bold",children:w.length>0?"YES":"NO"})]})]})]})]})})},F$=({player:t,activeProcesses:e,onAction:n,onClose:s})=>{const i=e.filter(y=>y.type==="COOP"&&y.locationId==="chicken_coop"),r=i.length>0,a=i[0],[l,c]=_.useState(0);_.useEffect(()=>{if(!a){c(0);return}const y=()=>{const g=Math.max(0,a.readyAt-Date.now());c(g)};y();const b=setInterval(y,1e3);return()=>clearInterval(b)},[a]);const u=r&&l<=0,d=t.resources.grain||0,f=()=>{n({type:"FEED_CHICKENS",locationId:"chicken_coop"})},h=()=>{n({type:"COLLECT_EGGS",locationId:"chicken_coop"})},m=a?a.readyAt-a.startedAt:1,v=a?1-l/m:0;return o.jsx(zi,{title:"Hnsehuset",icon:o.jsx("span",{className:"text-2xl",children:""}),onClose:s,children:o.jsxs("div",{className:"p-6 flex flex-col items-center gap-8 min-h-[400px]",children:[o.jsxs("div",{className:"relative w-full h-48 bg-slate-900/50 rounded-2xl overflow-hidden border border-white/10 flex items-center justify-center",children:[o.jsx("img",{src:"/Simulation_StandAlone_Pro/map_peasant_farm.png",className:"absolute inset-0 w-full h-full object-cover opacity-30 grayscale",alt:"Coop Background"}),o.jsxs("div",{className:"relative z-10 flex gap-4",children:[o.jsx(he.div,{animate:{y:[0,-5,0]},transition:{repeat:1/0,duration:2,ease:"easeInOut"},className:"text-6xl",children:""}),r&&!u&&o.jsx(he.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-6xl",children:""}),u&&o.jsx(he.div,{initial:{scale:0},animate:{scale:[1,1.2,1]},transition:{repeat:1/0,duration:1},className:"text-6xl drop-shadow-[0_0_15px_rgba(251,191,36,0.8)]",children:""})]})]}),o.jsxs("div",{className:"text-center space-y-4 max-w-sm",children:[!r&&o.jsxs(o.Fragment,{children:[o.jsx("h3",{className:"text-xl font-bold text-white",children:"Sultne Hner"}),o.jsx("p",{className:"text-slate-400 text-sm",children:"Hnene kakler utlmodig. Gi dem korn for  starte eggproduksjonen."}),o.jsxs("div",{className:"flex items-center justify-center gap-4 bg-slate-800/50 p-4 rounded-xl border border-white/5",children:[o.jsx(qp,{resource:"grain",amount:d,size:"lg"}),o.jsx("button",{onClick:f,disabled:d<5,className:`
                                        px-6 py-3 rounded-xl font-bold uppercase tracking-wider text-sm transition-all
                                        ${d>=5?"bg-amber-500 hover:bg-amber-400 text-amber-950 shadow-amber-500/20 shadow-lg":"bg-slate-700 text-slate-500 cursor-not-allowed"}
                                    `,children:"Fr Hner (5 Korn)"})]})]}),r&&!u&&o.jsxs(o.Fragment,{children:[o.jsx("h3",{className:"text-xl font-bold text-white",children:"Hnene Spiser"}),o.jsx("p",{className:"text-slate-400 text-sm",children:"Det tar tid  lage gode egg..."}),o.jsx("div",{className:"w-full h-4 bg-slate-800 rounded-full overflow-hidden border border-white/10",children:o.jsx(he.div,{className:"h-full bg-amber-500",initial:{width:`${v*100}%`},animate:{width:`${v*100}%`},transition:{duration:1,ease:"linear"}})}),o.jsxs("p",{className:"font-mono text-amber-400 font-bold",children:[Math.ceil(l/6e4)," minutter igjen"]})]}),u&&o.jsxs(o.Fragment,{children:[o.jsx("h3",{className:"text-xl font-bold text-white",children:"Eggene er klare!"}),o.jsx("p",{className:"text-slate-400 text-sm",children:"Redet er fullt av ferske egg."}),o.jsx("button",{onClick:h,className:"px-8 py-4 bg-emerald-500 hover:bg-emerald-400 text-white rounded-xl font-black uppercase tracking-widest text-lg shadow-emerald-500/30 shadow-2xl animate-pulse",children:"Samle Egg"})]})]})]})})},z$=({buildingId:t,player:e,room:n,onAction:s})=>{var b,g,p,x;const i=Kt[t];if(!i)return null;const r=t==="farm_house",l=["manor_ost","manor_vest","throne_room"].includes(t)?0:1,c=r?((b=e.buildings)==null?void 0:b[t])||{level:1,progress:{}}:((x=(p=(g=n.world)==null?void 0:g.settlement)==null?void 0:p.buildings)==null?void 0:x[t])||{level:l,progress:{}},u=c.level??0,d=Object.keys(i.levels).map(Number).sort((w,k)=>w-k),f=d[d.length-1],h=u>=f,m=u+1,v=i.levels[m],y=i.levels[u];return h?o.jsxs("div",{className:"relative w-full overflow-hidden rounded-[2.5rem] bg-gradient-to-br from-amber-600/20 to-slate-900 border border-amber-500/30 shadow-2xl p-8 text-center group",children:[o.jsx("div",{className:"absolute inset-0 bg-[url('/patterns/topographic.svg')] opacity-10"}),o.jsx("div",{className:"absolute top-0 right-0 p-12 opacity-10 group-hover:opacity-20 transition-opacity",children:o.jsx(sc,{size:120,className:"text-amber-400"})}),o.jsxs("div",{className:"relative z-10 flex flex-col items-center gap-6",children:[o.jsx("div",{className:"w-20 h-20 rounded-full bg-gradient-to-br from-amber-400 to-orange-600 flex items-center justify-center shadow-[0_0_40px_rgba(251,191,36,0.4)] animate-pulse",children:o.jsx(sc,{size:40,className:"text-white drop-shadow-md"})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-3xl font-black text-amber-100 uppercase tracking-tighter mb-2",children:"Mesterverk Fullfrt"}),o.jsxs("p",{className:"text-amber-200/60 font-medium max-w-md mx-auto",children:[i.name," har ndd sitt ypperste potensial (Niv ",f,")."]})]}),o.jsx("div",{className:"grid grid-cols-1 gap-3 w-full max-w-md mt-4",children:o.jsxs("div",{className:"bg-amber-950/40 border border-amber-500/20 rounded-xl p-4 flex items-center gap-4",children:[o.jsx("span",{className:"text-2xl",children:""}),o.jsxs("div",{className:"text-left",children:[o.jsx("div",{className:"text-[10px] font-black uppercase text-amber-500 tracking-widest",children:"Aktiv Bonus"}),o.jsx("div",{className:"font-bold text-amber-100",children:(y==null?void 0:y.bonus)||"Maksimal effekt"})]})]})})]})]}):o.jsxs("div",{className:"space-y-8 w-full",children:[o.jsxs("div",{className:"grid grid-cols-[1fr_auto_1fr] gap-4 items-center",children:[o.jsxs("div",{className:"bg-slate-900/50 rounded-2xl p-4 border border-white/5 flex flex-col items-center gap-2 opacity-60",children:[o.jsx("div",{className:"text-[10px] font-black uppercase text-slate-500 tracking-widest",children:"Nvrende"}),o.jsxs("div",{className:"text-3xl font-black text-slate-300",children:["Niv ",u]}),o.jsx("div",{className:"text-xs text-center text-slate-500 font-medium px-2",children:(y==null?void 0:y.bonus)||"Ingen effekt"})]}),o.jsx("div",{className:"flex flex-col items-center justify-center text-indigo-500",children:o.jsx(nU,{size:32,className:"animate-pulse"})}),o.jsxs("div",{className:"bg-indigo-600/10 rounded-2xl p-5 border border-indigo-500/30 flex flex-col items-center gap-2 relative overflow-hidden shadow-[0_0_30px_rgba(99,102,241,0.1)]",children:[o.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-indigo-500"}),o.jsx("div",{className:"text-[10px] font-black uppercase text-indigo-400 tracking-widest",children:"Neste Oppgradering"}),o.jsxs("div",{className:"text-4xl font-black text-white",children:["Niv ",m]}),o.jsx("div",{className:"text-xs text-center text-indigo-200 font-bold px-2 bg-indigo-500/20 py-1 rounded-full mt-1",children:(v==null?void 0:v.bonus)||"???"})]})]}),o.jsx("div",{className:"bg-slate-950/30 rounded-xl p-4 text-center border border-white/5",children:o.jsxs("p",{className:"text-slate-400 text-sm italic",children:['"',i.description,'"']})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between px-2",children:[o.jsx("span",{className:"text-[10px] font-black text-slate-500 uppercase tracking-[0.2em]",children:"Ressurskrav"}),o.jsx("span",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:r?"Privat Bygg":"Felles Dugnad"})]}),o.jsx("div",{className:"grid grid-cols-1 gap-3",children:Object.entries(v.requirements||{}).map(([w,k])=>{var V,B;const S=Math.floor(((V=c.progress)==null?void 0:V[w])||0),N=Math.min(100,S/k*100),T=Math.floor(((B=e.resources)==null?void 0:B[w])||0),E=k-S,j=T>0&&E>0,R=Math.min(T,E),I=S>=k;return o.jsxs("div",{className:"relative group overflow-hidden bg-slate-900 border border-white/10 rounded-2xl transition-all hover:border-white/20",children:[o.jsx("div",{className:"absolute inset-0 bg-slate-950",children:o.jsx("div",{className:`h-full transition-all duration-1000 ease-out opacity-20 ${I?"bg-emerald-500":"bg-indigo-500"}`,style:{width:`${N}%`}})}),o.jsxs("div",{className:"relative z-10 p-4 flex items-center justify-between gap-4",children:[o.jsxs("div",{className:"flex items-center gap-4 min-w-[120px]",children:[o.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center text-xl shadow-inner ${I?"bg-emerald-500/20 text-emerald-400":"bg-slate-800 text-slate-400"}`,children:I?o.jsx(Uf,{size:20}):w==="gold"?"":w==="wood"?"":w==="stone"?"":w==="plank"?"":""}),o.jsxs("div",{children:[o.jsx("div",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:w}),o.jsxs("div",{className:`font-bold ${I?"text-emerald-400":"text-white"}`,children:[S," / ",o.jsx("span",{className:"text-slate-500",children:k})]})]})]}),!I&&o.jsx("div",{className:"flex items-center gap-3",children:j?o.jsxs("div",{className:"flex flex-col items-end gap-1",children:[o.jsxs("span",{className:"text-[9px] text-slate-400 font-bold uppercase tracking-wide",children:["Du har: ",T]}),o.jsxs("button",{onClick:()=>s({type:r?"CONTRIBUTE_TO_PRIVATE_UPGRADE":"CONTRIBUTE_TO_UPGRADE",buildingId:t,resource:w,amount:R}),className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-500 text-white text-xs font-black uppercase tracking-widest rounded-lg transition-all active:scale-95 shadow-lg shadow-indigo-900/20 flex items-center gap-2",children:[o.jsx($d,{size:12}),"Gi ",R]})]}):o.jsxs("div",{className:"px-4 py-2 bg-rose-500/10 border border-rose-500/20 rounded-lg text-rose-500 text-[10px] font-black uppercase tracking-widest flex items-center gap-2",children:[o.jsx(no,{size:12}),"Mangler ",w," (",E,")"]})}),I&&o.jsx("div",{className:"px-4 py-2 bg-emerald-500/10 border border-emerald-500/20 rounded-lg text-emerald-400 text-[10px] font-black uppercase tracking-widest",children:"Fullfrt"})]})]},w)})})]}),Object.entries(v.requirements).every(([k,S])=>{var N;return(((N=c.progress)==null?void 0:N[k])||0)>=S})?o.jsxs("button",{onClick:()=>{s({type:r?"CONTRIBUTE_TO_PRIVATE_UPGRADE":"CONTRIBUTE_TO_UPGRADE",buildingId:t,resource:"dummy",amount:0})},className:"w-full py-5 bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-500 hover:to-teal-500 text-white font-black uppercase tracking-widest rounded-2xl shadow-[0_0_30px_rgba(16,185,129,0.4)] transition-all active:scale-95 flex items-center justify-center gap-3 animate-bounce",children:[o.jsx($d,{size:24}),"Fullfr Oppgradering til Niv ",m,"!"]}):null]})},V$=({npc:t,step:e,setStep:n,onClose:s})=>{var i,r;return o.jsx("div",{className:"absolute inset-0 z-50 bg-black/80 backdrop-blur-sm flex items-center justify-center p-6 animate-in fade-in duration-300",children:o.jsxs("div",{className:"bg-slate-900 border-2 border-amber-600/30 rounded-2xl max-w-lg w-full overflow-hidden shadow-2xl",children:[o.jsxs("div",{className:"bg-slate-950 p-6 border-b border-white/5 flex gap-4 items-center",children:[o.jsx("div",{className:"w-16 h-16 rounded-full bg-slate-800 border-2 border-amber-500/50 flex items-center justify-center text-3xl shadow-inner",children:""}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xl font-black text-amber-500",children:t.name}),o.jsx("p",{className:"text-sm text-slate-400 italic font-medium",children:t.role})]}),o.jsx("button",{onClick:s,className:"ml-auto w-8 h-8 bg-white/5 hover:bg-white/10 rounded-full flex items-center justify-center text-white transition-colors",children:""})]}),o.jsxs("div",{className:"p-8 space-y-6",children:[o.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-widest mb-2 opacity-50",children:t.description}),o.jsxs("p",{className:"text-slate-300 text-lg leading-relaxed italic border-l-4 border-amber-500/20 pl-4 py-2",children:['"',((i=t.conversation[e])==null?void 0:i.text)||"...",'"']}),o.jsx("div",{className:"grid gap-3 pt-4",children:(r=t.conversation[e])==null?void 0:r.options.map((a,l)=>o.jsxs("button",{onClick:()=>{a.nextId==="EXIT"?s():n(a.nextId)},className:"w-full text-left bg-white/5 hover:bg-amber-500/10 hover:border-amber-500/50 border border-white/10 p-4 rounded-xl transition-all font-medium text-slate-200 active:scale-[0.98]",children:[o.jsx("span",{className:"text-amber-500 mr-2",children:""})," ",a.label]},l))})]})]})})},K$=({viewMode:t,viewingRegionId:e,player:n,onSelect:s,onEnterHub:i,onPOIAction:r,room:a})=>{const[l,c]=Ge.useState(Date.now());if(Ge.useEffect(()=>{const d=setInterval(()=>c(Date.now()),1e3);return()=>clearInterval(d)},[]),t==="kingdom")return null;const u=n.activeProcesses||[];return o.jsx(o.Fragment,{children:wr.map(d=>{var V,B,O,D;const f=u.find(M=>M.locationId===d.id&&M.readyAt>l),h=f?Math.ceil((f.readyAt-l)/1e3):0,m=h>0;if(!(t==="global"?!d.parentId:d.parentId===t))return null;const y=n.role==="KING"&&d.id!=="peasant_farm"||d.roles.includes(n.role)||d.id==="market"||d.isHub,b=["grain_fields","forest_clearing","mine_shaft","quarry_poi","forest_forage"].includes(d.id),g=t==="global",p=g&&e==="region_ost",x=g&&(e==="region_vest"||e==="capital"),w=t==="village",k=Object.values(a.players||{});let S=d.top,N=d.left;w&&d.village?(S=d.village.top,N=d.village.left):p&&d.ost?(S=d.ost.top,N=d.ost.left):x&&d.vest&&(S=d.vest.top,N=d.vest.left);const T=d.id==="castle",E=T&&k.some(M=>M.role==="BARON"&&M.regionId===e||e==="capital"&&M.role==="KING"),j=T?e==="capital"?"throne_room":e==="region_ost"?"manor_ost":"manor_vest":"",I=(T&&((D=(O=(B=(V=a.world)==null?void 0:V.settlement)==null?void 0:B.buildings)==null?void 0:O[j])==null?void 0:D.level)||0)>=1||E;return o.jsx(he.div,{style:{top:S,left:N},initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"absolute -translate-x-1/2 -translate-y-1/2 group z-20 pointer-events-auto",children:o.jsxs("button",{onClick:()=>{if(T&&!I){r(d.id,"OPEN_CONSTRUCTION");return}d.isHub?i(d.id):s(d)},className:`flex flex-col items-center transition-all ${y?"scale-100":"scale-75 opacity-40 grayscale pointer-events-none"}`,children:[o.jsxs("div",{className:"w-16 h-16 rounded-3xl flex items-center justify-center text-4xl shadow-2xl border-2 transition-all duration-300 group-hover:scale-110 bg-slate-900/90 backdrop-blur-xl border-white/10 hover:bg-slate-800 overflow-hidden relative",children:[d.icon,m&&o.jsxs("div",{className:"absolute inset-0 bg-slate-900/60 backdrop-blur-[2px] rounded-3xl flex flex-col items-center justify-center z-10 transition-all group-hover:scale-110",children:[o.jsx(Gp,{className:"w-5 h-5 text-indigo-400 mb-0.5 animate-pulse"}),o.jsxs("span",{className:"text-white font-black text-xs",children:[h,"s"]})]})]}),o.jsx("span",{className:"bg-indigo-600 text-white text-[10px] font-black uppercase tracking-widest px-3 py-1 rounded-full mt-2 shadow-2xl opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap shadow-indigo-600/30",children:m?`KLAR OM ${h}S`:b?"KLIKK FOR  STARTE":T?I?"G INN":"BIDRA TIL BYGGING":d.label})]})},d.id)})})},Y$=({viewMode:t,viewingRegionId:e,worldEvents:n,onSelect:s})=>t==="kingdom"||!n?null:o.jsx(o.Fragment,{children:Object.values(n).map(i=>{const r=wr.find(m=>m.id===i.locationId);if(!r||!(t==="global"?!r.parentId:r.parentId===t))return null;const l=t==="global",c=l&&e==="region_ost",u=l&&(e==="region_vest"||e==="capital"),d=t==="village";let f=r.top,h=r.left;return d&&r.village?(f=r.village.top,h=r.village.left):c&&r.ost?(f=r.ost.top,h=r.ost.left):u&&r.vest&&(f=r.vest.top,h=r.vest.left),o.jsx(he.div,{style:{top:f,left:h},initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},className:"absolute -translate-x-1/2 -translate-y-[150%] z-30 pointer-events-auto",children:o.jsx("button",{onClick:()=>s(i),className:`w-14 h-14 rounded-full flex items-center justify-center text-3xl shadow-[0_0_30px_rgba(255,255,255,0.4)] border-4 animate-bounce hover:scale-110 transition-transform ${i.type==="RAID"?"bg-rose-600 border-rose-900 text-white":"bg-amber-400 border-amber-700 text-slate-800"}`,children:i.type==="RAID"?"":""})},i.id)})}),W$=({players:t,setViewingRegionId:e,setViewMode:n})=>{const s=Object.values(t||{}),i=s.find(a=>{var l;return a.role==="BARON"&&(a.regionId==="region_vest"||((l=a.regionId)==null?void 0:l.includes("vest")))}),r=s.find(a=>{var l;return a.role==="BARON"&&(a.regionId==="region_ost"||((l=a.regionId)==null?void 0:l.includes("ost")))});return o.jsxs(o.Fragment,{children:[o.jsx(he.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"absolute top-[35%] left-[50%] -translate-x-1/2 -translate-y-1/2 z-30 group pointer-events-auto",children:o.jsxs("button",{onClick:()=>{e("capital"),n("global")},className:"flex flex-col items-center hover:scale-110 transition-transform",children:[o.jsx("div",{className:"text-6xl drop-shadow-[0_0_15px_rgba(255,215,0,0.8)] animate-pulse",children:""}),o.jsx("div",{className:"bg-black/80 text-amber-400 px-4 py-2 rounded-xl mt-2 font-black uppercase tracking-widest text-xs border border-amber-500/50 shadow-xl backdrop-blur-md",children:"Kongeriket"})]})}),o.jsx(he.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"absolute top-[65%] left-[15%] -translate-x-1/2 -translate-y-1/2 z-30 group pointer-events-auto",children:o.jsxs("button",{onClick:()=>{e("region_vest"),n("global")},className:"flex flex-col items-center hover:scale-110 transition-transform",children:[o.jsx("div",{className:"text-5xl drop-shadow-[0_0_10px_rgba(255,255,255,0.5)]",children:""}),o.jsx("div",{className:"bg-black/80 text-indigo-300 px-3 py-1 rounded-xl mt-2 font-bold text-[10px] uppercase tracking-wider border border-white/10 shadow-xl backdrop-blur-md whitespace-nowrap",children:(i==null?void 0:i.name)||"Baroni Vest"})]})}),o.jsx(he.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"absolute top-[65%] left-[85%] -translate-x-1/2 -translate-y-1/2 z-30 group pointer-events-auto",children:o.jsxs("button",{onClick:()=>{e("region_ost"),n("global")},className:"flex flex-col items-center hover:scale-110 transition-transform",children:[o.jsx("div",{className:"text-5xl drop-shadow-[0_0_10px_rgba(255,255,255,0.5)]",children:""}),o.jsx("div",{className:"bg-black/80 text-emerald-300 px-3 py-1 rounded-xl mt-2 font-bold text-[10px] uppercase tracking-wider border border-white/10 shadow-xl backdrop-blur-md whitespace-nowrap",children:(r==null?void 0:r.name)||"Baroni st"})]})})]})},q$=({player:t,room:e,onAction:n,onClose:s,viewingRegionId:i})=>{var k,S,N,T;const r=i==="capital"||t.role==="BARON"||t.role==="KING"?["throne_room","manor_ost","manor_vest"]:i==="region_ost"?["manor_ost"]:["manor_vest"],[a,l]=_.useState(r[0]),c=((S=(k=e.world)==null?void 0:k.settlement)==null?void 0:S.buildings)||{},u=r.filter(E=>c[E]),d=u.includes(a)?a:u[0]||a,f=c[d],h=Kt[d];if(!f||!h)return o.jsx(zi,{title:"Gjenoppbygging",onClose:s,children:o.jsxs("div",{className:"flex flex-col items-center justify-center h-96 text-center p-12",children:[o.jsx("div",{className:"w-16 h-16 bg-slate-900 rounded-full flex items-center justify-center mb-6 text-2xl opacity-50",children:""}),o.jsx("h3",{className:"text-xl font-black text-white italic mb-2",children:"Ingen aktive byggeprosjekter"}),o.jsx("p",{className:"text-slate-500 text-sm max-w-xs",children:"Det er ingen storsltte prosjekter i dette omrdet som krever din hjelp akkurat n. Prv  dra til hovedstaden eller et av baroniene."}),o.jsx("button",{onClick:s,className:"mt-8 px-8 py-3 bg-white/5 hover:bg-white/10 rounded-xl text-[10px] font-black uppercase tracking-widest text-slate-400",children:"Lukk vindu"})]})});const m=(f.level||0)+1,v=((T=(N=h.levels)==null?void 0:N[m])==null?void 0:T.requirements)||{},y=f.contributions||{};let b=0,g=0;Object.entries(v).forEach(([E,j])=>{var R;b+=j,g+=((R=f.progress)==null?void 0:R[E])||0});const p=b>0?g/b*100:0,x=(E,j)=>{n({type:"CONTRIBUTE",buildingId:d,resource:E,amount:j})},w=Object.entries(y).map(([E,j])=>{const R=ee.CONTRIBUTION_VALUES;let I=0;return Object.entries(j.resources||{}).forEach(([V,B])=>{I+=B*(R[V]||R.default)}),{id:E,name:j.name,total:I}}).sort((E,j)=>j.total-E.total);return o.jsx(zi,{title:"Gjenoppbygging & Lederskap",onClose:s,children:o.jsxs("div",{className:"max-h-[70vh] overflow-y-auto custom-scrollbar p-1",children:[u.length>1&&o.jsx("div",{className:"flex gap-2 mb-6 bg-slate-900/50 p-1.5 rounded-2xl border border-white/5 w-fit",children:u.map(E=>{var j;return o.jsx("button",{onClick:()=>l(E),className:`px-4 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all ${d===E?"bg-indigo-600 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:((j=Kt[E])==null?void 0:j.name)||E},E)})}),o.jsxs("div",{className:"relative h-48 rounded-3xl overflow-hidden mb-8 group border border-white/5",children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-950 via-slate-900/40 to-transparent z-10"}),o.jsx("img",{src:`/Simulation_StandAlone_Pro/images/simulation/${d==="throne_room"?"throne_room_epic.png":"castle_construction_epic.png"}`,alt:h.name,className:"w-full h-48 object-cover rounded-2xl mb-6 shadow-2xl border border-white/10"}),o.jsxs("div",{className:"absolute bottom-6 left-8 z-20",children:[o.jsx("h3",{className:"text-3xl font-black text-white italic tracking-tighter uppercase",children:h.name}),o.jsx("p",{className:"text-slate-300 font-medium text-xs max-w-md",children:h.description})]}),o.jsxs("div",{className:"absolute top-6 right-8 z-20 flex flex-col items-end gap-2",children:[o.jsx("div",{className:"bg-emerald-500/20 backdrop-blur-md px-4 py-2 rounded-full border border-emerald-500/30",children:o.jsxs("span",{className:"text-emerald-400 font-black text-xs tabular-nums",children:[p.toFixed(0),"% FULLFRT"]})}),o.jsx("div",{className:"bg-white/5 backdrop-blur-md px-3 py-1 rounded-full border border-white/10 opacity-40",children:o.jsxs("span",{className:"text-white/60 font-bold text-[8px] uppercase tracking-tighter",children:["DB Niv: ",f.level||0," / Max: ",Object.keys(h.levels||{}).length]})})]})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[o.jsx("div",{className:"space-y-6",children:o.jsxs("section",{children:[o.jsx("h4",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mb-4",children:"Mangler for ferdigstillelse"}),o.jsx("div",{className:"space-y-4",children:Object.entries(v).map(([E,j])=>{var D,M,C,U,K;const R=((D=f.progress)==null?void 0:D[E])||0,I=j,V=Math.min(100,R/I*100),B=R>=I,O=((M=t.resources)==null?void 0:M[E])||0;return o.jsxs("div",{className:`p-4 rounded-2xl border transition-all ${B?"bg-emerald-500/5 border-emerald-500/20":"bg-slate-900/50 border-white/5"}`,children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{className:"text-xl",children:((C=Rt[E])==null?void 0:C.icon)||""}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm font-bold text-white tracking-tight italic",children:((U=Rt[E])==null?void 0:U.label)||E}),o.jsxs("p",{className:"text-[10px] text-slate-500 font-medium",children:["Beholdning: ",o.jsx("span",{className:"text-slate-300",children:typeof O=="number"?O.toLocaleString():O})]})]})]}),o.jsx("div",{className:"text-right",children:o.jsxs("span",{className:`text-xs font-black ${B?"text-emerald-400":"text-slate-300"}`,children:[R," / ",I]})})]}),o.jsx("div",{className:"h-1.5 w-full bg-slate-950 rounded-full overflow-hidden mb-4",children:o.jsx("div",{style:{width:`${V}%`},className:`h-full transition-all duration-500 ${B?"bg-emerald-500":"bg-indigo-500"}`})}),(O>0||B)&&o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:()=>x(E,Math.min(10,O||1)),className:`flex-1 py-2 rounded-xl text-[10px] font-black text-white transition-all uppercase border
                                                            ${B?"bg-white/5 border-white/10 opacity-50":"bg-white/5 hover:bg-white/10 border-white/10"}
                                                        `,children:B?"Lager Fullt":"Gi 10"}),o.jsx("button",{onClick:()=>x(E,Math.min(50,O||1)),className:`flex-1 py-2 rounded-xl text-[10px] font-black text-white transition-all uppercase
                                                            ${B?"bg-indigo-600/20 text-indigo-300/50 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-500"}
                                                        `,children:B?"Fullfrt":"Gi 50"})]}),O<=0&&!B&&o.jsx("div",{className:"py-2 text-center bg-black/20 rounded-xl border border-white/5",children:o.jsxs("span",{className:"text-[8px] font-black text-slate-600 uppercase tracking-widest",children:["Du mangler ",((K=Rt[E])==null?void 0:K.label)||E]})})]},E)})})]})}),o.jsxs("div",{className:"space-y-8",children:[o.jsxs("section",{className:"bg-slate-900/50 border border-white/5 rounded-[2rem] p-6",children:[o.jsx("h4",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mb-6 px-2",children:"Toppbidragsytere"}),o.jsx("div",{className:"space-y-2",children:w.length===0?o.jsx("div",{className:"text-center py-8 text-slate-500 text-xs italic",children:"Ingen bidrag enda. Bli den frste!"}):w.slice(0,5).map((E,j)=>o.jsxs("div",{className:`flex items-center justify-between p-3 rounded-xl ${j===0?"bg-amber-500/10 border border-amber-500/20":"hover:bg-white/5 transition-colors"}`,children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:`w-6 h-6 rounded-lg flex items-center justify-center text-[10px] font-black ${j===0?"bg-amber-500 text-slate-950":"bg-slate-800 text-slate-400"}`,children:j+1}),o.jsx("span",{className:`text-sm font-bold ${j===0?"text-white":"text-slate-300"}`,children:E.name})]}),o.jsxs("span",{className:"text-xs font-mono text-slate-500",children:[E.total.toLocaleString()," poeng"]})]},E.id))})]}),o.jsxs("section",{className:"bg-indigo-600/10 border border-indigo-500/20 rounded-[2rem] p-6 relative overflow-hidden",children:[o.jsx("div",{className:"absolute -top-4 -right-4 w-24 h-24 bg-indigo-500/10 blur-2xl rounded-full"}),o.jsx("h4",{className:"text-[10px] font-black text-indigo-400 uppercase tracking-widest mb-4",children:"Gevinst"}),o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("span",{className:"text-4xl",children:a==="throne_room"?"":""}),o.jsxs("div",{children:[o.jsx("p",{className:"text-white font-black italic tracking-tight underline decoration-indigo-500/50",children:a==="throne_room"?"TITTEL: KONGE":"TITTEL: BARON"}),o.jsx("p",{className:"text-slate-400 text-xs mt-1",children:"Spilleren med hyest poengsum ved ferdigstillelse overtar styringen."})]})]})]})]})]})]})})},em=[{level:0,label:"Gammelt Trestativ",slots:2,cost:{wood:50},visual:"wood"},{level:1,label:"Forsterket Jernstativ",slots:4,cost:{wood:100,ore:50},visual:"iron"},{level:2,label:"Forgylt Kongestativ",slots:6,cost:{wood:200,ore:100,gold:500},visual:"gold"}],X$=[{id:"trophy_rusty_sword",label:"Rustent Sverd",desc:"Funnet i myra.",price:50,icon:o.jsx(Fd,{size:24,className:"text-amber-800"})},{id:"trophy_broken_shield",label:"Knust Skjold",desc:"Fra et glemt slag.",price:100,icon:o.jsx(Ix,{size:24,className:"text-slate-600"})},{id:"trophy_golden_chalice",label:"Gullbeger",desc:"Kanskje litt uekte gull?",price:500,icon:o.jsx(sc,{size:24,className:"text-yellow-400"})},{id:"trophy_dragon_skull",label:"Dragehodeskalle",desc:"En fryktinngytende replika.",price:2500,icon:o.jsx("div",{className:"text-2xl",children:""})}],DA=({level:t,slots:e})=>{const n="#5D4037",s="#3E2723",i="#B7950B",r=()=>t===1?"#263238":t===2?i:s,a={filter:t===2?"drop-shadow(0 0 15px rgba(255, 215, 0, 0.3))":"drop-shadow(0 10px 15px rgba(0,0,0,0.5))"};return o.jsxs("svg",{viewBox:"0 0 400 300",className:"w-full h-full transition-all duration-500",style:a,children:[o.jsxs("defs",{children:[o.jsxs("linearGradient",{id:"woodGradient",x1:"0",y1:"0",x2:"1",y2:"0",children:[o.jsx("stop",{offset:"0%",stopColor:s}),o.jsx("stop",{offset:"50%",stopColor:n}),o.jsx("stop",{offset:"100%",stopColor:s})]}),o.jsxs("linearGradient",{id:"goldGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[o.jsx("stop",{offset:"0%",stopColor:"#FFF9C4"}),o.jsx("stop",{offset:"50%",stopColor:"#FFD700"}),o.jsx("stop",{offset:"100%",stopColor:"#B7950B"})]})]}),o.jsx("ellipse",{cx:"200",cy:"270",rx:"140",ry:"20",fill:"black",opacity:"0.4"}),o.jsx("rect",{x:"60",y:"40",width:"20",height:"240",rx:"4",fill:t===2?"url(#goldGradient)":"url(#woodGradient)",stroke:r(),strokeWidth:"2"}),o.jsx("rect",{x:"320",y:"40",width:"20",height:"240",rx:"4",fill:t===2?"url(#goldGradient)":"url(#woodGradient)",stroke:r(),strokeWidth:"2"}),o.jsx("rect",{x:"50",y:"80",width:"300",height:"15",rx:"4",fill:t===2?"url(#goldGradient)":"url(#woodGradient)",stroke:r(),strokeWidth:"2"}),o.jsx("rect",{x:"50",y:"150",width:"300",height:"15",rx:"4",fill:t===2?"url(#goldGradient)":"url(#woodGradient)",stroke:r(),strokeWidth:"2"}),o.jsx("rect",{x:"50",y:"220",width:"300",height:"15",rx:"4",fill:t===2?"url(#goldGradient)":"url(#woodGradient)",stroke:r(),strokeWidth:"2"}),t>=1&&o.jsxs(o.Fragment,{children:[o.jsx("circle",{cx:"70",cy:"87.5",r:"4",fill:t===2?"black":"#CFD8DC"}),o.jsx("circle",{cx:"330",cy:"87.5",r:"4",fill:t===2?"black":"#CFD8DC"}),o.jsx("circle",{cx:"70",cy:"157.5",r:"4",fill:t===2?"black":"#CFD8DC"}),o.jsx("circle",{cx:"330",cy:"157.5",r:"4",fill:t===2?"black":"#CFD8DC"})]}),e.map((l,c)=>{if(!l||!l.itemId)return null;const u=2,d=Math.floor(c/u),h=c%u===0?140:260,m=90+d*70;return o.jsxs("g",{transform:`translate(${h}, ${m})`,children:[o.jsx("ellipse",{cx:"0",cy:"40",rx:"15",ry:"5",fill:"black",opacity:"0.3"}),l.type==="ITEM"?o.jsxs("g",{transform:"scale(1.2) rotate(15)",children:[o.jsx("path",{d:"M0,-30 L0,30",stroke:"#90A4AE",strokeWidth:"4"}),o.jsx("rect",{x:"-6",y:"-10",width:"12",height:"4",fill:"#546E7A"}),o.jsx("circle",{cx:"0",cy:"32",r:"3",fill:"#FFD700"})]}):o.jsxs("g",{transform:"scale(1.5)",children:[l.itemId==="trophy_rusty_sword"&&o.jsx("text",{x:"-10",y:"10",fontSize:"24",children:""}),l.itemId==="trophy_broken_shield"&&o.jsx("text",{x:"-10",y:"10",fontSize:"24",children:""}),l.itemId==="trophy_golden_chalice"&&o.jsx("text",{x:"-10",y:"10",fontSize:"24",children:""}),l.itemId==="trophy_dragon_skull"&&o.jsx("text",{x:"-12",y:"12",fontSize:"28",children:""})]})]},c)})]})},Q$=({player:t,onAction:e,onClose:n})=>{const[s,i]=_.useState("status"),r=t.weaponRack||{},a={level:r.level||0,slots:r.slots||[],unlockedTrophies:r.unlockedTrophies||[],lastPolishedAt:r.lastPolishedAt||0},l=em.find(p=>p.level===a.level)||em[0],c=em.find(p=>p.level===a.level+1),u=l.slots,d=(t.inventory||[]).filter(p=>["MAIN_HAND","OFF_HAND","BODY","HEAD","FEET","AXE","BOW","HAMMER"].includes(p.type));d.sort((p,x)=>(x.value||0)-(p.value||0));const f=p=>{e({type:"RACK_MOUNT_ITEM",itemId:p.id,instanceId:p.id})},h=p=>{e({type:"RACK_MOUNT_TROPHY",trophyId:p})},m=p=>{e({type:"RACK_UNMOUNT",slotId:p})},v=()=>{e({type:"RACK_UPGRADE"})},y=(p,x)=>{e({type:"RACK_BUY_TROPHY",trophyId:p,price:x})},b=()=>{e({type:"RACK_POLISH"})},g=a.slots.length>=u;return o.jsx(zi,{title:"VPENKAMMERET",subtitle:"The Royal Armory",icon:o.jsx($d,{className:"text-amber-500",size:24}),onClose:n,maxWidth:"max-w-7xl",children:o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6 h-[700px] text-slate-200 select-none overflow-hidden",children:[o.jsxs("div",{className:"lg:col-span-3 flex flex-col bg-slate-900/50 rounded-3xl border border-white/5 overflow-hidden",children:[o.jsxs("div",{className:"p-4 border-b border-white/5 bg-white/5 flex items-center justify-between",children:[o.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-slate-400",children:"Ditt Utstyr"}),o.jsxs("span",{className:"text-[10px] bg-slate-800 px-2 py-1 rounded text-slate-400",children:[d.length," gjenstander"]})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-3 space-y-2",children:[d.length===0&&o.jsx("div",{className:"text-center py-10 text-slate-600 text-xs italic",children:"Tomt i sekken..."}),d.map((p,x)=>o.jsxs("button",{disabled:g,onClick:()=>f(p),className:"w-full flex items-center gap-3 p-3 bg-slate-900 rounded-xl border border-white/5 hover:border-indigo-500/50 hover:bg-indigo-500/10 transition-all text-left disabled:opacity-50 group",children:[o.jsx("div",{className:"w-10 h-10 flex items-center justify-center bg-slate-950 rounded-lg border border-white/5 text-lg shadow-inner group-hover:scale-105 transition-transform",children:""}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-bold text-base text-indigo-100 truncate group-hover:text-indigo-400 transition-colors",children:p.name}),o.jsx("div",{className:"flex items-center gap-2 text-[10px] text-slate-500",children:o.jsxs("span",{children:["Slitasje: ",p.durability||100,"%"]})})]}),o.jsx("div",{className:"opacity-0 group-hover:opacity-100 text-indigo-400 transition-opacity",children:o.jsx(vA,{size:14})})]},`inv-${x}`))]})]}),o.jsx("div",{className:"lg:col-span-6 flex flex-col relative group",children:o.jsxs("div",{className:"flex-1 bg-gradient-to-b from-slate-900 to-slate-950 rounded-3xl border border-white/10 shadow-2xl relative overflow-hidden flex items-center justify-center",children:[o.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-amber-900/10 via-slate-950/50 to-slate-950 pointer-events-none"}),o.jsx("div",{className:"relative z-10 w-full h-full p-8",children:o.jsx(DA,{level:a.level,slots:a.slots})}),o.jsx("div",{className:"absolute bottom-8 right-8 z-20",children:(()=>{const p=Date.now(),x=a.lastPolishedAt||0,w=6e4*60,k=p-x,S=k>=w,N=w-k,T=Math.ceil(N/6e4);return o.jsxs("button",{onClick:b,disabled:!S,className:`flex items-center gap-2 px-4 py-3 rounded-full border transition-all backdrop-blur-sm shadow-xl 
                                            ${S?"bg-amber-500/10 hover:bg-amber-500/20 text-amber-500 hover:text-amber-400 border-amber-500/30 hover:border-amber-500/50 hover:shadow-amber-500/10 cursor-pointer":"bg-slate-900/50 text-slate-500 border-slate-700 cursor-not-allowed grayscale"}`,children:[o.jsx(PH,{size:18,className:S?"animate-pulse":""}),o.jsxs("div",{className:"flex flex-col items-start leading-none",children:[o.jsx("span",{className:"text-xs font-bold uppercase tracking-widest",children:S?"Puss Utstyr":"Ny-pusset"}),!S&&o.jsxs("span",{className:"text-[10px] lowercase text-slate-400",children:[T,"m ventetid"]})]})]})})()})]})}),o.jsxs("div",{className:"lg:col-span-3 flex flex-col gap-4",children:[o.jsxs("div",{className:"bg-slate-900/80 rounded-2xl p-2 flex border border-white/10",children:[o.jsx("button",{onClick:()=>i("status"),className:`flex-1 py-2 rounded-xl text-xs font-bold uppercase tracking-widest transition-all ${s==="status"?"bg-slate-800 text-white shadow":"text-slate-500 hover:text-slate-300"}`,children:"Oversikt"}),o.jsx("button",{onClick:()=>i("shop"),className:`flex-1 py-2 rounded-xl text-xs font-bold uppercase tracking-widest transition-all ${s==="shop"?"bg-amber-900/30 text-amber-500 shadow":"text-slate-500 hover:text-slate-300"}`,children:"Trofer"})]}),o.jsxs("div",{className:"flex-1 bg-slate-900/50 rounded-3xl border border-white/5 p-4 overflow-y-auto custom-scrollbar",children:[s==="status"&&o.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4 duration-300",children:[o.jsxs("div",{children:[o.jsxs("h4",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500 mb-3 flex justify-between",children:[o.jsx("span",{children:"P Veggen"}),o.jsxs("span",{children:[a.slots.length," / ",u]})]}),o.jsxs("div",{className:"space-y-2",children:[a.slots.length===0&&o.jsx("div",{className:"text-xs text-slate-600 italic",children:"Tomt stativ..."}),a.slots.map(p=>o.jsxs("div",{className:"flex items-center gap-3 p-2 bg-slate-800/50 rounded-lg border border-white/5",children:[o.jsx("div",{className:"text-lg",children:p.type==="TROPHY"?"":""}),o.jsx("div",{className:"flex-1 min-w-0",children:o.jsx("div",{className:"text-sm font-bold text-slate-300 truncate",children:p.itemId})}),o.jsx("button",{onClick:()=>m(p.id),className:"text-rose-500 hover:text-rose-400 p-1 hover:bg-rose-500/10 rounded",children:o.jsx("span",{className:"text-xs",children:""})})]},p.id))]})]}),o.jsxs("div",{className:"mt-auto pt-6 border-t border-white/5",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[o.jsx(pU,{className:"text-amber-500",size:16}),o.jsx("h4",{className:"text-xs font-black uppercase tracking-widest text-amber-500",children:"Neste Niv"})]}),c?o.jsxs("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 p-4 rounded-xl border border-white/5",children:[o.jsx("div",{className:"text-sm font-bold text-white mb-2",children:c.label}),o.jsxs("div",{className:"text-[10px] text-slate-400 mb-4",children:["ker kapasiteten til ",o.jsxs("span",{className:"text-amber-400 font-bold",children:[c.slots," plasser"]}),"."]}),o.jsx("div",{className:"grid grid-cols-2 gap-2 mb-4",children:Object.entries(c.cost).map(([p,x])=>o.jsxs("div",{className:`text-xs px-2 py-1 rounded bg-slate-950 flex justify-between ${t.resources[p]>=x?"text-slate-300":"text-rose-400"}`,children:[o.jsx("span",{className:"capitalize",children:p}),o.jsx("span",{className:"font-mono",children:x})]},p))}),o.jsx("button",{onClick:v,disabled:!1,className:"w-full py-2 bg-amber-600 hover:bg-amber-500 text-white rounded-lg font-bold text-xs shadow-lg shadow-amber-900/20 transition-all uppercase tracking-wider",children:"Oppgrader"})]}):o.jsx("div",{className:"text-center py-4 text-emerald-500 text-xs font-bold bg-emerald-500/10 rounded-xl border border-emerald-500/20",children:"Maksimalt niv ndd!"})]})]}),s==="shop"&&o.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-right-4 duration-300",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2 p-3 bg-amber-900/10 border border-amber-500/20 rounded-xl text-amber-200 text-xs",children:[o.jsx(Ca,{size:14,className:"text-amber-400"}),o.jsx("span",{children:"Kjp unike trofer for re og bermmelse!"})]}),X$.map(p=>{const x=a.unlockedTrophies.includes(p.id),w=(t.resources.gold||0)>=p.price;return o.jsx("div",{className:"relative p-3 bg-slate-800/40 rounded-xl border border-white/5 hover:bg-slate-800/80 transition-all group",children:o.jsxs("div",{className:"flex gap-3",children:[o.jsx("div",{className:"w-12 h-12 rounded-lg bg-black/40 flex items-center justify-center text-2xl shadow-inner group-hover:scale-110 transition-transform duration-300",children:p.icon}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h4",{className:"font-bold text-sm text-slate-200",children:p.label}),o.jsx("p",{className:"text-xs text-slate-500 mt-1",children:p.desc}),o.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[o.jsxs("span",{className:"font-mono text-amber-500 font-bold text-xs",children:[p.price,"g"]}),x?a.slots.some(k=>k.itemId===p.id)?o.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider bg-slate-800 px-2 py-0.5 rounded",children:"P veggen"}):o.jsx("button",{onClick:()=>h(p.id),disabled:g,className:"px-3 py-1 rounded text-[10px] font-bold uppercase tracking-wider transition-colors bg-emerald-600/20 text-emerald-400 hover:bg-emerald-600 hover:text-white disabled:opacity-50 disabled:cursor-not-allowed",children:"Heng Opp"}):o.jsx("button",{onClick:()=>y(p.id,p.price),disabled:!w,className:`px-3 py-1 rounded text-[10px] font-bold uppercase tracking-wider transition-colors ${w?"bg-amber-600/20 text-amber-400 hover:bg-amber-600 hover:text-white":"bg-slate-800 text-slate-600 cursor-not-allowed"}`,children:"Kjp"})]})]})]})},p.id)})]})]})]})]})})},LA=Ge.memo(({player:t,room:e,world:n,worldEvents:s,players:i,onAction:r,onOpenMarket:a})=>{var ve,de,Ze;const l=(n==null?void 0:n.season)||"Spring",{viewMode:c,setViewMode:u,viewingRegionId:d,setViewingRegionId:f,selectedPOI:h,setSelectedPOI:m,selectedEvent:v,setSelectedEvent:y,upgradingBuildingId:b,setUpgradingBuildingId:g,dialogNPC:p,setDialogNPC:x,dialogStep:w,setDialogStep:k,isDiceGameOpen:S,setIsDiceGameOpen:N,isChickenCoopOpen:T,setIsChickenCoopOpen:E,isConstructionOpen:j,setIsConstructionOpen:R,isTaxationOpen:I,setIsTaxationOpen:V,isResourceGameOpen:B,setIsResourceGameOpen:O,direction:D,handlePOIAction:M}=v$(t,r,a),C=(n==null?void 0:n.weather)||"Clear",K=(()=>{var Xt,kn,Gn,$t,Xi,Qi,Fe;const X=Ls(((Xt=e.world)==null?void 0:Xt.gameTick)||0)==="NIGHT",fe=l==="Winter";let me="";switch(c){case"kingdom":me=fe?X?"map_kingdom_169_winter_night":"map_kingdom_169_winter":X?"map_kingdom_169_night":"map_kingdom_169";break;case"village":me=fe?X?"map_village_hub_1610_winter_night":"map_village_hub_1610_winter":X?"map_village_hub_1610_night":"map_village_hub_1610";break;case"castle":me="map_castle_interior";break;case"fields":me=fe?X?"map_farm_fields_winter_night":"map_farm_fields_winter":X?"map_farm_fields_night":"map_farm_fields";break;case"peasant_farm":{const ze=(($t=(Gn=(kn=n==null?void 0:n.settlement)==null?void 0:kn.buildings)==null?void 0:Gn.farm_house)==null?void 0:$t.level)||1;me=ze>1?`map_peasant_farm_lvl${ze}`:"map_peasant_farm";break}case"farm_house":{const ze=((Fe=(Qi=(Xi=n==null?void 0:n.settlement)==null?void 0:Xi.buildings)==null?void 0:Qi.farm_house)==null?void 0:Fe.level)||1;me=ze>1?`map_stugo_interior_lvl${ze}`:"map_stugo_interior";break}case"mine":me=fe?X?"map_mountain_pass_winter_night":"map_mountain_pass_winter":X?"map_mountain_pass_night":"map_mountain_pass";break;case"forest":me=fe?X?"map_forest_winter_night":"map_forest_winter":X?"map_forest_night":"map_forest";break;case"monastery":me=fe?X?"map_monastery_winter_night":"map_monastery_winter":X?"map_monastery_night":"map_monastery";break;case"tavern":me="map_tavern_interior";break;case"great_forge":me="map_forge_interior";break;case"bakery":me="map_bakery_interior";break;case"windmill":me="map_windmill_interior";break;case"sawmill":me="map_sawmill_interior";break;case"smeltery":me="map_smeltery_interior";break;case"weavery":me="map_weavery_interior";break;case"stables":me="map_stables_interior";break;case"watchtower":me="map_watchtower_interior";break;case"well":me=fe?X?"map_well_interior_winter_night":"map_well_interior_winter":X?"map_well_interior_night":"map_well_interior";break;case"apothecary":me="map_apothecary_interior";break;case"global":d==="region_ost"?me=fe?X?"map_barony_ost_169_winter_night":"map_barony_ost_169_winter":X?"map_barony_ost_169_night":"map_barony_ost_169":d==="capital"?me=fe?X?"map_hovedstad_169_winter_night":"map_hovedstad_169_winter":X?"map_hovedstad_169_night":"map_hovedstad_169":me=fe?X?"map_barony_vest_v2_1610_winter_night":"map_barony_vest_v2_1610_winter":X?"map_barony_vest_v2_1610_night":"map_barony_vest_v2_1610";break;default:me="map_barony_vest_v2_1610"}const yt="/Simulation_StandAlone_Pro/";return{src:`${yt}${me}.webp`,placeholder:`${yt}${me}_tiny.webp`,original:`${yt}${me}.png`}})(),H=c==="kingdom"||c==="global"&&(d==="region_ost"||d==="capital")?"aspect-video":"aspect-[16/10]",$={initial:X=>({opacity:0,scale:X==="in"?.9:1.1,filter:"blur(10px)"}),animate:{opacity:1,scale:1,filter:"blur(0px)",transition:{duration:.6,ease:[.16,1,.3,1],staggerChildren:.05}},exit:X=>({opacity:0,scale:X==="in"?1.1:.9,filter:"blur(10px)",transition:{duration:.4,ease:[.7,0,.84,0]}})},F=`${c}-${d}`,Q=_.useMemo(()=>wr.find(X=>X.id===c),[c]),ce=!!(Q!=null&&Q.isInterior);return o.jsxs("div",{className:"relative w-full h-full flex flex-col items-center justify-center p-0",children:[o.jsxs("div",{className:`relative w-full max-w-full max-h-full mx-auto ${H} rounded-[2rem] overflow-hidden shadow-[0_0_80px_rgba(0,0,0,0.5)] border-4 border-white/5 bg-slate-950 transition-all duration-1000`,children:[o.jsx(Ln,{mode:"popLayout",custom:D,children:o.jsxs(he.div,{custom:D,variants:$,initial:"initial",animate:"animate",exit:"exit",className:"absolute inset-0 w-full h-full",children:[o.jsxs("div",{className:"w-full h-full relative",children:[o.jsx(MA,{src:K.src,placeholderSrc:K.placeholder,alt:"Map View",className:"w-full h-full",disableMotion:!0}),o.jsx("div",{className:`absolute inset-0 pointer-events-none transition-opacity duration-1000 ${C==="Fog"?"opacity-100 backdrop-blur-sm bg-white/10":"opacity-0"}`})]}),c==="farm_house"&&o.jsxs("div",{className:"absolute bottom-[70%] left-[10%] w-[18%] h-auto z-20 cursor-pointer hover:scale-105 hover:brightness-110 transition-all drop-shadow-2xl opacity-90 hover:opacity-100",onClick:()=>r("OPEN_WEAPON_RACK"),title:"pne Vpenstativet",children:[o.jsx("div",{className:"absolute -inset-4 bg-black/40 blur-xl rounded-full"}),o.jsx("div",{className:"relative",children:o.jsx(DA,{level:((ve=t.weaponRack)==null?void 0:ve.level)||0,slots:((de=t.weaponRack)==null?void 0:de.slots)||[]})})]}),o.jsx(U$,{weather:C,season:l,isInterior:ce}),o.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[c==="kingdom"&&o.jsx(W$,{players:i||{},setViewingRegionId:f,setViewMode:u}),o.jsx(K$,{viewMode:c,viewingRegionId:d,player:t,room:e,onSelect:m,onEnterHub:u,onPOIAction:M}),o.jsx(Y$,{viewMode:c,viewingRegionId:d,worldEvents:s,onSelect:y})]})]},F)}),o.jsx(H$,{player:t,room:e}),c!=="kingdom"&&o.jsxs("button",{onClick:()=>{if(c==="global")u("kingdom");else{const X=wr.find(fe=>fe.id===c);X!=null&&X.parentId?u(X.parentId):u("global")}},className:"absolute top-6 left-6 z-50 px-6 py-3 bg-slate-950/80 backdrop-blur-md border border-white/10 rounded-2xl text-[10px] font-black uppercase tracking-widest text-slate-400 hover:text-white hover:border-white/20 transition-all active:scale-95 flex items-center gap-2 group",children:[o.jsx("span",{className:"text-lg group-hover:-translate-x-1 transition-transform",children:""}),"Tilbake"]}),v&&o.jsx("div",{className:"absolute inset-x-6 bottom-6 z-40 animate-in slide-in-from-bottom-8 duration-500",children:o.jsxs("div",{className:"bg-slate-900/95 backdrop-blur-2xl rounded-[2.5rem] shadow-[0_30px_100px_rgba(0,0,0,0.8)] border border-white/10 p-8",children:[o.jsxs("div",{className:"flex justify-between items-start mb-6",children:[o.jsxs("div",{children:[o.jsx("span",{className:`text-[10px] font-black uppercase tracking-widest px-3 py-1 rounded-full ${v.type==="RAID"?"bg-rose-500/20 text-rose-400":"bg-amber-500/20 text-amber-500"}`,children:v.type==="RAID"?" Akutt Trussel":" Spesielt Oppdrag"}),o.jsx("h3",{className:"text-3xl font-black text-white mt-4 tracking-tighter",children:v.title})]}),o.jsx("button",{onClick:()=>y(null),className:"w-10 h-10 bg-white/5 hover:bg-white/10 text-white rounded-full flex items-center justify-center transition-colors",children:""})]}),o.jsxs("p",{className:"text-sm font-medium text-slate-400 mb-8 leading-relaxed italic opacity-80",children:['"',v.description,'"']}),o.jsx("button",{onClick:()=>{r({type:v.type==="RAID"?"DEFEND":"EXPLORE",eventId:v.id}),y(null)},className:`w-full py-5 rounded-2xl font-black uppercase tracking-widest text-sm shadow-2xl transition-all active:scale-95 ${v.type==="RAID"?"bg-rose-600 text-white shadow-rose-600/20":"bg-amber-500 text-slate-950 shadow-amber-500/20"}`,children:v.type==="RAID"?"TIL VPEN! ":"UTFORSK OMRDET! "})]})}),o.jsx(Ln,{children:h&&o.jsx(B$,{poi:h,player:t,room:e,onAction:X=>M(h.id,X),onClose:()=>m(null),viewingRegionId:d})})]}),o.jsxs(Ln,{children:[b&&o.jsx(zi,{title:"Bygg & Oppgrader",onClose:()=>g(null),children:o.jsx(z$,{buildingId:b,player:t,room:e,onAction:r})}),S&&o.jsx(y$,{playerGold:((Ze=t.resources)==null?void 0:Ze.gold)||0,onClose:()=>N(!1),onPlay:X=>r({type:"PLAY_DICE",...X})}),B&&o.jsx(_$,{player:t,onClose:()=>O(!1),onPlay:X=>r({type:"PLAY_RESOURCE_GAME",...X})}),T&&o.jsx(F$,{player:t,activeProcesses:t.activeProcesses||[],onAction:r,onClose:()=>E(!1)}),p&&o.jsx(V$,{npc:p,step:w,setStep:k,onClose:()=>x(null)}),j&&o.jsx(q$,{player:t,room:e,onAction:r,onClose:()=>R(!1),viewingRegionId:d}),I&&o.jsx($$,{player:t,room:e,onAction:r,onClose:()=>V(!1)})]})]})},(t,e)=>{var i,r,a,l,c,u;if(((i=t.world)==null?void 0:i.season)!==((r=e.world)==null?void 0:r.season)||((a=t.world)==null?void 0:a.weather)!==((l=e.world)==null?void 0:l.weather))return!1;const n=Ls(((c=t.world)==null?void 0:c.gameTick)||0),s=Ls(((u=e.world)==null?void 0:u.gameTick)||0);return n!==s||t.player.activeProcesses!==e.player.activeProcesses?!1:t.player===e.player&&t.room===e.room&&t.world===e.world&&t.worldEvents===e.worldEvents});LA.displayName="GameMap";function wn(t){return Ge.lazy(async()=>{try{return await t()}catch(e){if(/failed to fetch dynamically imported module/i.test(e.message)||/loading chunk/i.test(e.message)||/dynamic import/i.test(e.message)||e.name==="TypeError"&&/fetch/i.test(e.message)){const s="last_chunk_reload",i=Date.now(),r=parseInt(localStorage.getItem(s)||"0",10);if(i-r>1e4)return localStorage.setItem(s,i.toString()),console.warn("Chunk load error detected. Reloading application to fetch latest version..."),window.location.reload(),new Promise(()=>{})}throw e}})}const J$=({onClose:t})=>{const{currentTrackId:e,playlist:n,playNext:s,playPrevious:i,toggleIgnoreTrack:r,isIgnored:a,playMusic:l,stopMusic:c}=Kg(),[u,d]=_.useState(!!e),f=n.find(m=>m.id===e)||n[0],h=()=>{u&&e?(c(),d(!1)):(e?l(e):s(),d(!0))};return o.jsxs("div",{className:"absolute inset-0 z-50 flex items-center justify-center p-4",children:[o.jsx(he.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:t,className:"absolute inset-0 bg-black/60 backdrop-blur-sm cursor-pointer"}),o.jsxs(he.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",bounce:.3},className:"relative w-full max-w-4xl h-[600px] bg-slate-950/80 backdrop-blur-2xl border border-white/10 rounded-[3rem] shadow-2xl overflow-hidden flex flex-col md:flex-row",children:[o.jsx("button",{onClick:t,className:"absolute top-6 right-6 z-20 p-2 rounded-full bg-white/5 hover:bg-white/10 text-white transition-colors",children:o.jsx(us,{size:24})}),o.jsxs("div",{className:"flex-1 relative flex flex-col items-center justify-center p-12 bg-gradient-to-br from-indigo-900/40 to-slate-900/40 border-r border-white/5",children:[o.jsx("div",{className:`absolute inset-0 opacity-30 bg-gradient-to-tr ${(f==null?void 0:f.mood)==="Dark"?"from-rose-900/40":"from-indigo-600/20"} to-transparent transition-colors duration-1000`}),o.jsxs("div",{className:"relative z-10 mb-12 group",children:[o.jsxs("div",{className:`w-64 h-64 rounded-full bg-slate-900 border-4 border-white/10 shadow-[0_0_60px_rgba(0,0,0,0.6)] flex items-center justify-center relative overflow-hidden ${u&&e?"animate-[spin_8s_linear_infinite]":""}`,children:[o.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle,rgba(99,102,241,0.2)0%,transparent_70%)]"}),o.jsx("div",{className:"absolute inset-2 rounded-full border border-white/5 opacity-50"}),o.jsx("div",{className:"absolute inset-8 rounded-full border border-white/5 opacity-30"}),o.jsx(NU,{size:64,className:"text-white/20"})]}),o.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:o.jsx("button",{onClick:h,className:"w-20 h-20 bg-white/90 rounded-full flex items-center justify-center shadow-2xl hover:scale-105 active:scale-95 transition-all text-slate-900",children:u&&e?o.jsx($p,{size:32,fill:"currentColor"}):o.jsx(Fp,{size:32,fill:"currentColor",className:"ml-1"})})})]}),o.jsxs("div",{className:"text-center space-y-2 z-10",children:[o.jsx("p",{className:"text-xs font-black uppercase tracking-[0.3em] text-indigo-400",children:"N Spiller"}),o.jsx("h2",{className:"text-3xl font-black text-white tracking-tighter max-w-sm leading-tight",children:f?f.title:"Ingen Musikk"}),(f==null?void 0:f.mood)&&o.jsxs("span",{className:"inline-block px-3 py-1 bg-white/5 rounded-full text-[10px] font-bold text-slate-400 uppercase tracking-widest border border-white/5",children:[f.mood," Mood"]})]})]}),o.jsxs("div",{className:"w-full md:w-[400px] bg-black/20 flex flex-col",children:[o.jsxs("div",{className:"p-8 pb-4 border-b border-white/5 flex items-center justify-between",children:[o.jsxs("h3",{className:"text-sm font-black text-white uppercase tracking-widest flex items-center gap-2",children:[o.jsx(QU,{size:16,className:"text-indigo-400"})," Spilleliste"]}),o.jsxs("span",{className:"text-[10px] font-bold text-slate-500",children:[n.length," Spor"]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 space-y-2",children:n.map((m,v)=>{const y=e===m.id,b=a(m.id);return o.jsxs("div",{className:`group flex items-center justify-between p-4 rounded-xl border transition-all duration-300 ${y?"bg-indigo-600/10 border-indigo-500/50 shadow-lg shadow-indigo-900/20":b?"bg-transparent border-transparent opacity-40 grayscale hover:opacity-100 hover:bg-slate-800/50":"bg-transparent border-transparent hover:bg-white/5 hover:border-white/5"}`,children:[o.jsxs("button",{onClick:()=>{l(m.id),d(!0)},className:"flex items-center gap-4 flex-1 text-left min-w-0",children:[o.jsx("span",{className:`text-xs font-bold w-6 text-center ${y?"text-indigo-400":"text-slate-600"}`,children:y?o.jsx(DH,{size:14,className:"mx-auto animate-pulse"}):v+1}),o.jsx("div",{className:"min-w-0",children:o.jsx("p",{className:`text-sm font-bold truncate ${y?"text-white":"text-slate-400 group-hover:text-slate-200"}`,children:m.title})})]}),o.jsx("button",{onClick:g=>{g.stopPropagation(),r(m.id)},className:`p-2 rounded-lg opacity-0 group-hover:opacity-100 transition-all ${b?"opacity-100 text-rose-400 hover:bg-rose-500/10":"text-slate-500 hover:text-white hover:bg-white/10"}`,title:b?"Gjenoppta":"Ignorer",children:b?o.jsx(EU,{size:16}):o.jsx(AU,{size:16})})]},m.id)})}),o.jsxs("div",{className:"p-6 border-t border-white/5 bg-black/40 flex items-center justify-between",children:[o.jsx("button",{onClick:i,className:"p-4 rounded-full hover:bg-white/5 text-slate-400 hover:text-white transition-colors",children:o.jsx(bH,{size:20})}),o.jsx("div",{className:"h-10 w-[1px] bg-white/5"}),o.jsx("button",{onClick:h,className:"p-4 rounded-full hover:bg-white/5 text-white transition-colors scale-110 active:scale-95",children:u&&e?o.jsx($p,{size:24,fill:"currentColor"}):o.jsx(Fp,{size:24,fill:"currentColor",className:"ml-1"})}),o.jsx("div",{className:"h-10 w-[1px] bg-white/5"}),o.jsx("button",{onClick:s,className:"p-4 rounded-full hover:bg-white/5 text-slate-400 hover:text-white transition-colors",children:o.jsx(yH,{size:20})})]})]})]})]})},Z$=({result:t,onClear:e})=>(_.useEffect(()=>{if(t){t.success&&t.utbytte&&t.utbytte.length>0&&t.utbytte.forEach((s,i)=>{s.amount>0&&setTimeout(()=>{je.spawnFlyingResource(s.resource,window.innerWidth/2,window.innerHeight/2,window.innerWidth-150,60)},i*200)});const n=setTimeout(()=>{e()},6e3);return()=>clearTimeout(n)}},[t,e]),o.jsx(Ln,{children:t&&o.jsxs(he.div,{initial:{opacity:0,y:-20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},className:"fixed top-[5%] left-1/2 transform -translate-x-1/2 bg-slate-900/95 border-2 border-amber-500/30 p-5 rounded-[2rem] shadow-[0_0_50px_rgba(0,0,0,0.5)] backdrop-blur-md min-w-[300px] text-center z-[300] overflow-hidden",children:[o.jsx("div",{className:"absolute bottom-0 left-0 h-1 bg-amber-500/20 w-full overflow-hidden",children:o.jsx(he.div,{initial:{width:"100%"},animate:{width:"0%"},transition:{duration:7,ease:"linear"},className:"h-full bg-amber-500"})}),o.jsx("button",{onClick:n=>{n.stopPropagation(),e()},className:"absolute top-4 right-4 text-slate-500 hover:text-white transition-colors p-1",children:o.jsx(us,{className:"w-5 h-5"})}),o.jsxs("div",{className:"relative z-10",children:[o.jsx("div",{className:`text-lg font-black mb-3 tracking-tight ${t.success?"text-white":"text-rose-400"}`,children:t.message}),t.utbytte&&t.utbytte.length>0&&o.jsx("div",{className:"flex flex-wrap justify-center gap-2 mb-3",children:t.utbytte.map((n,s)=>{const i=Rt[n.resource]||{label:n.resource,icon:""},r=n.name||i.label,a=n.icon||i.icon,l=n.amount>=0,c=n.jackpot;return o.jsxs(he.div,{initial:{scale:0,y:10},animate:{scale:1,y:0},transition:{delay:.2+s*.1,type:"spring"},className:`flex items-center gap-2 px-4 py-2 rounded-2xl text-sm font-black border shadow-lg ${c?"bg-gradient-to-r from-amber-200 to-yellow-400 border-yellow-300 text-yellow-900 shadow-amber-500/50 animate-pulse":l?"bg-emerald-500/10 border-emerald-500/30 text-emerald-400":"bg-rose-500/10 border-rose-500/30 text-rose-400"}`,children:[o.jsx("span",{className:"text-lg",children:a}),o.jsxs("span",{children:[l?"+":"",n.resource==="gold"?n.amount.toFixed(2):n.amount," ",c&&r]})]},`${n.resource}-${s}`)})}),t.xp&&t.xp.length>0&&o.jsx("div",{className:"flex flex-col gap-2 mb-2",children:t.xp.map((n,s)=>o.jsxs(he.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.4+s*.1},className:"text-xs font-black uppercase tracking-widest text-indigo-400 bg-indigo-500/5 py-1 rounded-lg",children:["+",n.amount," XP ",n.skill,n.levelUp&&o.jsxs(he.div,{initial:{scale:.5,opacity:0,rotate:-5},animate:{scale:[1,1.2,1],opacity:1,rotate:[0,5,-5,0],filter:["brightness(1)","brightness(2)","brightness(1)"]},transition:{duration:.6,times:[0,.5,1],repeat:1/0,repeatType:"reverse"},className:"mt-2 inline-flex items-center gap-2 bg-gradient-to-r from-amber-400 to-amber-600 text-black px-4 py-1.5 rounded-full text-[10px] font-black shadow-[0_0_20px_rgba(245,158,11,0.5)] border border-amber-300/50",children:[o.jsx("span",{children:""}),o.jsx("span",{className:"tracking-[0.2em]",children:"NIV OPPGGRADERT!"}),o.jsx("span",{children:""})]})]},`xp-${s}`))}),t.durability&&t.durability.length>0&&o.jsx("div",{className:"mt-4 pt-4 border-t border-white/5 flex flex-wrap justify-center gap-3",children:t.durability.map((n,s)=>o.jsxs("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider flex items-center gap-1",children:[" ",n.item,": ",o.jsxs("span",{className:n.amount>0?"text-rose-400":"text-emerald-400",children:[n.amount>0?"-":"+",Math.abs(n.amount),"%"]}),n.broken&&o.jsx("span",{className:"text-rose-500 font-black ml-1 animate-pulse",children:"(DELAGT!)"})]},`dura-${s}`))})]})]})})),eF=async(t,e,n,s)=>{if(e===n)return{success:!1,error:"Kan ikke gi gave til deg selv"};const i=L(P,`simulation_rooms/${t}/players/${e}`),r=L(P,`simulation_rooms/${t}/players/${n}`),a=await xe(i),l=await xe(r);if(!a.exists())return{success:!1,error:"Sender finnes ikke"};if(!l.exists())return{success:!1,error:"Mottaker finnes ikke"};const c=a.val(),u=l.val(),d=u.name;if(c.regionId!==u.regionId)return{success:!1,error:"Du kan kun sende gaver til spillere i din region."};let f=!1,h="";if(await Te(i,y=>{if(y===null)return y;y.resources||(y.resources={});for(const[b,g]of Object.entries(s))if((y.resources[b]||0)<g)return;for(const[b,g]of Object.entries(s))y.resources[b]-=g,h+=`${g} ${b}, `;return f=!0,y}),!f)return{success:!1,error:"Ikke nok ressurser til  sende gaven."};let m=!1;if(await Te(r,y=>{if(y===null)return y;y.resources||(y.resources={});for(const[b,g]of Object.entries(s))y.resources[b]=(y.resources[b]||0)+g;return m=!0,y}),!m)return console.error("CRITICAL: Gift transaction partial failure. Sender deducted but target failed.",e,n),{success:!1,error:"Transaksjonsfeil: Gaven gikk tapt i posten (Mottaker utilgjengelig i skrivende stund)."};const v=`Sendte gave (${h.slice(0,-2)}) til ${d}.`;return ut(t,`[GAVE] ${c.name} -> ${d}: ${h}`),{success:!0,data:{success:!0,timestamp:Date.now(),message:v}}},tF=async(t,e,n,s,i)=>{const r=L(P,`simulation_rooms/${t}/players/${e}`),a=L(P,`simulation_rooms/${t}/trades`),l=await xe(r),c=await xe(L(P,`simulation_rooms/${t}/players/${n}`));if(!l.exists()||!c.exists())return{success:!1,error:"Spiller finnes ikke"};const u=l.val(),d=c.val(),f=u.name,h=d.name;if(u.regionId!==d.regionId)return{success:!1,error:"Handel er kun tillatt med spillere i din region."};let m=!1;if(await Te(r,b=>{var g;if(b===null)return b;for(const[p,x]of Object.entries(s))if((((g=b.resources)==null?void 0:g[p])||0)<x)return;for(const[p,x]of Object.entries(s))b.resources[p]-=x;return m=!0,b}),!m)return{success:!1,error:"Ikke nok ressurser til  opprette handelen."};const v=LE(a),y={id:v.key,senderId:e,senderName:f,receiverId:n,receiverName:h,offer:s,demand:i,status:"PENDING",createdAt:Date.now(),expiresAt:Date.now()+1e3*60*60*24};return await Dr(v,y),ut(t,`[HANDEL] ${f} tilbd handel til ${h}.`),{success:!0,message:"Handelstilbud sendt."}},nF=async(t,e,n,s)=>{const i=L(P,`simulation_rooms/${t}/trades/${n}`),r=await xe(i);if(!r.exists())return{success:!1,error:"Handelen finnes ikke lenger."};const a=r.val();if(a.status!=="PENDING")return{success:!1,error:"Handelen er ikke lenger aktiv."};if(a.receiverId!==e&&a.senderId!==e&&!(a.senderId===e&&s==="REJECT"))return{success:!1,error:"Du har ikke tilgang til denne handelen."};if(s==="REJECT"){const l=L(P,`simulation_rooms/${t}/players/${a.senderId}`);return await Te(l,c=>{if(c===null)return c;c.resources||(c.resources={});for(const[u,d]of Object.entries(a.offer))c.resources[u]=(c.resources[u]||0)+d;return c}),await ne(i,{status:a.senderId===e?"CANCELLED":"REJECTED"}),{success:!0,message:"Handel avbrutt/avsltt."}}if(s==="ACCEPT"){const l=L(P,`simulation_rooms/${t}/players/${e}`);let c=!1;if(await Te(l,d=>{var f;if(d===null)return d;for(const[h,m]of Object.entries(a.demand))if((((f=d.resources)==null?void 0:f[h])||0)<m)return;for(const[h,m]of Object.entries(a.demand))d.resources[h]-=m;for(const[h,m]of Object.entries(a.offer))d.resources[h]=(d.resources[h]||0)+m;return c=!0,d}),!c)return{success:!1,error:"Du har ikke rd til denne handelen."};const u=L(P,`simulation_rooms/${t}/players/${a.senderId}`);return await Te(u,d=>{if(d===null)return d;d.resources||(d.resources={});for(const[f,h]of Object.entries(a.demand))d.resources[f]=(d.resources[f]||0)+h;return d}),await ne(i,{status:"ACCEPTED"}),ut(t,`[HANDEL] ${a.receiverName} godtok handelen fra ${a.senderName}.`),{success:!0,message:"Handel gjennomfrt!"}}},sF=({player:t,room:e,onAction:n,pin:s})=>{const[i,r]=_.useState([]),a=_.useRef({}),l=_.useRef(0),c=_.useMemo(()=>e.messages?Array.isArray(e.messages)?e.messages:Object.values(e.messages).sort((m,v)=>m.timestamp-v.timestamp):[],[e.messages]),u=m=>{r(y=>[...y,m]);const v=m.actions?1e4:5e3;setTimeout(()=>d(m.id),v)},d=m=>{r(v=>v.filter(y=>y.id!==m))},f=async(m,v)=>{const y=await nF(s,t.id,m,v);y&&y.success?(d(`trade-${m}`),u({id:`trade-res-${Date.now()}`,title:v==="ACCEPT"?"Handel Gjennomfrt":"Handel Avsltt",message:y.message||"Transaksjon fullfrt.",type:"TRADE"})):u({id:`trade-err-${Date.now()}`,title:"Feil ved handel",message:(y==null?void 0:y.error)||"Noe gikk galt.",type:"TRADE"})},h=(m,v,y)=>!y[m];return _.useEffect(()=>{const m=e.trades||{},v=a.current;Object.entries(m).forEach(([y,b])=>{if(h(y,b,v)&&b.receiverId===t.id&&b.status==="PENDING"){const g=Object.entries(b.offer).map(([x,w])=>`${w} ${x}`).join(", "),p=Object.entries(b.demand).map(([x,w])=>`${w} ${x}`).join(", ");u({id:`trade-${y}`,title:"Nytt Handelstilbud",message:`${b.senderName} tilbyr ${g} for ${p}.`,type:"TRADE",actions:[{label:"Aksepter",variant:"primary",icon:o.jsx(Uf,{size:14}),onClick:()=>f(y,"ACCEPT")},{label:"Forhandle",variant:"neutral",icon:o.jsx(nc,{size:14}),onClick:()=>{d(`trade-${y}`),alert("Forhandling er ikke implementert enn. Avsl handelen for  sende nytt tilbud.")}},{label:"Avsl",variant:"danger",icon:o.jsx(us,{size:14}),onClick:()=>f(y,"REJECT")}]})}}),a.current=m},[e.trades,t.id,s]),_.useEffect(()=>{var y;const m=c;if(m.length===0)return;const v=m[m.length-1];if(l.current===0&&m.length>0){l.current=m[m.length-1].timestamp;return}if(v.timestamp>l.current){const b=v.content;if(b.startsWith("[GAVE]")&&b.includes(`-> ${t.name}`)){const p=b.split("->")[0].replace("[GAVE]","").trim(),x=((y=b.split(":")[1])==null?void 0:y.trim())||"";u({id:`gift-${v.timestamp}`,title:`Gave fra ${p}`,message:`Du mottok: ${x}`,type:"GIFT"})}l.current=v.timestamp}},[c,t.name]),i.length===0?null:o.jsx("div",{className:"absolute top-24 right-8 z-[100] flex flex-col gap-4 pointer-events-none",children:i.map(m=>o.jsxs("div",{className:"pointer-events-auto bg-slate-900/95 backdrop-blur-xl border border-white/10 p-4 rounded-xl shadow-2xl flex flex-col gap-3 animate-in slide-in-from-right duration-300 w-96",children:[o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:`p-3 rounded-lg ${m.type==="GIFT"?"bg-indigo-500/20 text-indigo-400":"bg-emerald-500/20 text-emerald-400"}`,children:m.type==="GIFT"?o.jsx(yA,{size:24}):o.jsx(Rx,{size:24})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h4",{className:"font-bold text-white text-sm",children:m.title}),o.jsx("p",{className:"text-slate-400 text-xs mt-1 leading-relaxed",children:m.message})]}),o.jsx("button",{onClick:()=>d(m.id),className:"text-slate-600 hover:text-white transition-colors",children:o.jsx(us,{size:16})})]}),m.actions&&o.jsx("div",{className:"flex gap-2 pt-2 border-t border-white/5",children:m.actions.map((v,y)=>o.jsxs("button",{onClick:v.onClick,className:`
                                        flex-1 py-2 px-3 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition-all active:scale-95
                                        ${v.variant==="primary"?"bg-emerald-600 hover:bg-emerald-500 text-white shadow-lg shadow-emerald-500/20":""}
                                        ${v.variant==="danger"?"bg-rose-600/20 hover:bg-rose-600/30 text-rose-400 border border-rose-500/30":""}
                                        ${v.variant==="neutral"?"bg-slate-700 hover:bg-slate-600 text-slate-200":""}
                                    `,children:[v.icon,v.label]},y))})]},m.id))})},iF=wn(()=>Ut(()=>import("./SimulationMarket-Dow0X2Ju.js"),__vite__mapDeps([0,1,2])).then(t=>({default:t.SimulationMarket}))),rF=wn(()=>Ut(()=>import("./SimulationVault-BikxEDg3.js"),__vite__mapDeps([3,4])).then(t=>({default:t.SimulationVault}))),aF=wn(()=>Ut(()=>import("./SimulationSkills-CvBiMqQs.js"),__vite__mapDeps([5,1])).then(t=>({default:t.SimulationSkills}))),oF=wn(()=>Ut(()=>import("./SimulationProduction-Dl7EVZUn.js"),__vite__mapDeps([6,7])).then(t=>({default:t.SimulationProduction}))),lF=wn(()=>Ut(()=>import("./SimulationActivity-B9nvTEd8.js"),[]).then(t=>({default:t.SimulationActivity}))),cF=wn(()=>Ut(()=>import("./SimulationDiplomacy-bXRO0MgH.js"),[]).then(t=>({default:t.SimulationDiplomacy}))),uF=wn(()=>Ut(()=>import("./SimulationHierarchy-C10qKay1.js"),__vite__mapDeps([8,9,1,2,4])).then(t=>({default:t.SimulationHierarchy}))),dF=wn(()=>Ut(()=>import("./SimulationProfile-DA-M97R8.js"),__vite__mapDeps([10,2])).then(t=>({default:t.SimulationProfile}))),fF=wn(()=>Ut(()=>import("./SimulationSettings-BkmhtO9i.js"),[]).then(t=>({default:t.SimulationSettings}))),hF=wn(()=>Ut(()=>import("./PoliticalHub-Cx_yfpw9.js"),__vite__mapDeps([9,1,2,4])).then(t=>({default:t.PoliticalHub}))),mF=wn(()=>Ut(()=>import("./SimulationWarRoom-CpzNpccH.js"),[]).then(t=>({default:t.SimulationWarRoom}))),pF=wn(()=>Ut(()=>import("./SiegeEngine-KC1bEOQc.js"),[]).then(t=>({default:t.SiegeEngine}))),gF=wn(()=>Ut(()=>import("./ApothecaryWindow-C9KxsgmH.js"),__vite__mapDeps([11,7,4])).then(t=>({default:t.ApothecaryWindow}))),xF=({player:t,room:e,pin:n,onAction:s,actionResult:i,onClearActionResult:r})=>{var y,b,g;const{activeTab:a,setActiveTab:l,isMusicWindowOpen:c,setMusicWindowOpen:u,viewingRegionId:d}=ql(),[f,h]=Ge.useState(!1),m=async p=>{if(!f){h(!0);try{await ne(L(P,`simulation_rooms/${n}/activeVote/votes`),{[t.id]:p})}catch(x){console.error("Voting failed",x)}finally{setTimeout(()=>h(!1),1500)}}},v=["MAP","PRODUCTION","MARKET","INVENTORY","SKILLS","DIPLOMACY","HIERARCHY","PROFILE","POLITICS"].includes(a);return o.jsxs("div",{className:"flex-1 relative flex flex-col overflow-hidden w-full h-full",children:[o.jsxs("div",{className:`flex-1 relative w-full h-full ${v?"p-2 md:p-3 overflow-hidden flex items-center justify-center":"p-4 md:p-8 overflow-y-auto overflow-x-hidden custom-scrollbar"}`,children:[v&&o.jsx("div",{className:"absolute inset-0 z-0",children:o.jsx(LA,{player:t,room:e,world:e.world,worldEvents:e.worldEvents,players:e.players,onAction:s,onOpenMarket:()=>l("MARKET")})}),o.jsxs(Ge.Suspense,{fallback:o.jsx("div",{className:"w-full h-full flex items-center justify-center pointer-events-none",children:o.jsx("div",{className:"w-8 h-8 border-2 border-white/20 border-t-white rounded-full animate-spin"})}),children:[(()=>{var w;const p=d||t.regionId||"",x=(w=e.regions[p])==null?void 0:w.activeSiege;return!x||!(a==="SIEGE"||v)?null:o.jsx("div",{className:`absolute inset-0 z-10 ${a!=="SIEGE"?"opacity-20 pointer-events-none blur-sm grayscale":""}`,children:o.jsx(pF,{player:t,siege:x,regionId:p,onAction:s,messages:Array.isArray(e.messages)?e.messages:Object.values(e.messages||{})})})})(),o.jsxs("div",{className:"absolute inset-0 z-20 pointer-events-none flex flex-col items-center justify-center",children:[a==="PRODUCTION"&&o.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-6xl md:h-auto md:max-h-[90vh] overflow-hidden",children:((y=ql().productionContext)==null?void 0:y.buildingId)==="apothecary"?o.jsx(gF,{player:t,room:e,onAction:s,pin:n||""}):o.jsx(oF,{player:t,room:e,onAction:s,pin:n||""})}),a==="MARKET"&&o.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-5xl md:h-[90vh] overflow-hidden",children:o.jsx(iF,{player:t,market:((b=e.markets)==null?void 0:b[t.regionId||"capital"])||e.market,regions:e.regions,allMarkets:e.markets,onAction:s,pin:n||""})}),a==="INVENTORY"&&o.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-4xl md:h-[80vh] overflow-hidden",children:o.jsx(rF,{player:t,onAction:s})}),a==="SKILLS"&&o.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-4xl md:h-[80vh] overflow-hidden",children:o.jsx(aF,{player:t})}),a==="DIPLOMACY"&&o.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-4xl md:h-[85vh] overflow-hidden",children:o.jsx(cF,{player:t,diplomacy:e.diplomacy,pin:n||""})}),a==="HIERARCHY"&&o.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-5xl md:h-[85vh] overflow-hidden",children:o.jsx(uF,{players:e.players,currentPlayer:t,regions:e.regions,onAction:s,pin:n||""})}),a==="PROFILE"&&o.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-2xl md:h-[85vh] overflow-hidden",children:o.jsx(dF,{player:t,regions:e.regions||{},allPlayers:e.players||{}})}),a==="POLITICS"&&o.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-6xl md:h-[90vh] overflow-hidden",children:o.jsx(hF,{player:t,room:e,onClose:()=>l("MAP")})}),a==="WAR_ROOM"&&o.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-4xl md:h-[85vh] overflow-hidden",children:o.jsx(mF,{player:t,regions:e.regions,onAction:s,onClose:()=>l("HIERARCHY")})})]}),a!=="MAP"&&!v&&o.jsx("div",{className:"max-w-4xl mx-auto w-full space-y-8 animate-in slide-in-from-bottom-4 duration-500 relative z-20",children:a==="SETTINGS"?o.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-slate-950/40 backdrop-blur-md p-8 animate-in fade-in duration-300",children:o.jsx(fF,{onClose:()=>l("MAP")})}):a==="ACTIVITY"?o.jsx(lF,{messages:e.messages}):null})]})]}),e.activeVote&&!((g=e.activeVote.votes)!=null&&g[t.id])&&o.jsx("div",{className:"absolute bottom-6 right-6 z-[50] w-96 animate-in slide-in-from-right duration-500",children:o.jsxs("div",{className:"bg-slate-900/95 backdrop-blur-xl rounded-2xl border border-indigo-500/50 p-6 shadow-2xl shadow-indigo-500/10",children:[o.jsxs("div",{className:"flex items-start justify-between mb-4",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-white font-bold text-lg leading-tight mb-1",children:"Tinget er satt"}),o.jsx("p",{className:"text-indigo-300 text-xs font-medium uppercase tracking-wider",children:"Avgi din stemme"})]}),o.jsx("div",{className:"bg-indigo-500/20 p-2 rounded-lg",children:o.jsx("span",{className:"text-2xl",children:""})})]}),o.jsxs("div",{className:"mb-6",children:[o.jsx("h4",{className:"text-white font-medium mb-2",children:e.activeVote.title}),o.jsx("p",{className:"text-slate-400 text-sm line-clamp-3 leading-relaxed",children:e.activeVote.description})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("button",{onClick:()=>m("YES"),disabled:f,className:`bg-emerald-600/80 hover:bg-emerald-500 text-white py-3 rounded-xl font-bold text-sm transition-all active:scale-95 flex items-center justify-center gap-2 ${f?"opacity-50 cursor-not-allowed":""}`,children:[o.jsx("span",{children:""})," VEDTA"]}),o.jsxs("button",{onClick:()=>m("NO"),disabled:f,className:`bg-rose-600/80 hover:bg-rose-500 text-white py-3 rounded-xl font-bold text-sm transition-all active:scale-95 flex items-center justify-center gap-2 ${f?"opacity-50 cursor-not-allowed":""}`,children:[o.jsx("span",{children:""})," AVSL"]})]})]})}),o.jsx(Ln,{}),o.jsx(Ln,{children:c&&o.jsx(J$,{onClose:()=>u(!1)})}),o.jsx(sF,{player:t,room:e,onAction:s,pin:n||""}),o.jsx(Z$,{result:i,onClear:r})]})},bF=()=>{const[t,e]=_.useState([]);return _.useEffect(()=>je.subscribe(s=>{e(i=>[...i,s]),setTimeout(()=>{e(i=>i.filter(r=>r.id!==s.id))},s.duration+500)}),[]),o.jsx("div",{className:"fixed inset-0 pointer-events-none z-[200] overflow-hidden",children:o.jsx(Ln,{children:t.map(n=>{if(n.type==="FLOATING_TEXT")return o.jsx(he.div,{initial:{opacity:0,scale:.5,y:0,rotate:(Math.random()-.5)*20},animate:{opacity:1,scale:1.2,y:-120,x:(Math.random()-.5)*40,rotate:(Math.random()-.5)*40},exit:{opacity:0,scale:.8},transition:{duration:.8,ease:"easeOut"},className:`absolute font-black text-4xl drop-shadow-2xl ${n.color||"text-amber-500"}`,style:{left:`${n.x}%`,top:`${n.y}%`,transform:"translate(-50%, -50%)",zIndex:210},children:n.text},n.id);if(n.type==="FLYING_RESOURCE"){const s=Rt[n.resource]||{icon:""};return o.jsx(he.div,{initial:{left:`${n.startPoint.x}px`,top:`${n.startPoint.y}px`,scale:.5,opacity:0},animate:{left:`${n.endPoint.x}px`,top:`${n.endPoint.y}px`,scale:[.5,1.5,1],opacity:1},exit:{opacity:0,scale:.5},transition:{duration:1,ease:"easeInOut"},className:"absolute text-4xl z-[220] drop-shadow-xl",children:s.icon},n.id)}return n.type==="PARTICLE"?o.jsx(Ge.Fragment,{children:[...Array(6)].map((s,i)=>o.jsx(he.div,{initial:{left:`${n.x}%`,top:`${n.y}%`,scale:1,opacity:1},animate:{left:`${n.x+(Math.random()-.5)*15}%`,top:`${n.y+(Math.random()-.5)*15}%`,scale:0,opacity:0},transition:{duration:.6,ease:"easeOut"},className:`absolute w-3 h-3 rounded-sm ${n.color||"bg-amber-400"} z-[205]`},`${n.id}-p-${i}`))},n.id):null})})})},vF=({level:t,title:e,onClose:n})=>o.jsxs("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-500",children:[o.jsx("div",{className:"bg-gradient-to-br from-amber-400 via-amber-500 to-amber-600 p-1 rounded-[2.5rem] shadow-[0_0_50px_rgba(245,158,11,0.5)] animate-in zoom-in duration-500",children:o.jsxs("div",{className:"bg-white rounded-[2.2rem] p-10 text-center relative overflow-hidden max-w-sm",children:[o.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-amber-200 via-yellow-400 to-amber-200"}),o.jsxs("div",{className:"relative z-10",children:[o.jsx("div",{className:"text-7xl mb-6 animate-bounce",children:""}),o.jsx("h2",{className:"text-sm font-black text-amber-600 uppercase tracking-[0.3em] mb-2",children:"Niv Oppndd!"}),o.jsxs("h3",{className:"text-6xl font-black text-slate-800 mb-4",children:["Niv ",t]}),o.jsx("div",{className:"h-0.5 w-16 bg-slate-200 mx-auto mb-6"}),o.jsx("p",{className:"text-slate-500 font-medium mb-1",children:"Ny Tittel:"}),o.jsx("p",{className:"text-3xl font-black text-indigo-600 mb-8",children:e}),o.jsx("button",{onClick:n,className:"w-full bg-slate-900 hover:bg-slate-800 text-white py-5 rounded-2xl font-black text-xl shadow-xl transition-all active:scale-95",children:"FORTSETT REISEN"})]}),o.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-20",children:[...Array(20)].map((s,i)=>o.jsx("div",{className:"absolute w-2 h-2 bg-amber-500 rounded-full animate-ping",style:{top:`${Math.random()*100}%`,left:`${Math.random()*100}%`,animationDelay:`${Math.random()*2}s`,animationDuration:`${2+Math.random()*2}s`}},i))})]})}),o.jsx("style",{dangerouslySetInnerHTML:{__html:`
                    @keyframes ping-slow {
                        0% { transform: scale(1); opacity: 0.8; }
                        100% { transform: scale(3); opacity: 0; }
                    }
                `}})]}),yF=({pin:t,account:e,onCreatePlayer:n,isCreating:s})=>{const i=ho(),[r,a]=_.useState("WELCOME"),[l,c]=_.useState((e==null?void 0:e.displayName)||""),[u,d]=_.useState("PEASANT");return r==="WELCOME"?o.jsxs("div",{className:"bg-slate-900/40 backdrop-blur-3xl border border-white/5 p-12 md:p-16 rounded-[3.5rem] text-center space-y-10 shadow-2xl animate-in fade-in zoom-in duration-500",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsx("h1",{className:"text-6xl md:text-8xl font-black italic text-white tracking-tighter leading-none",children:"FEUDAL SIM"}),o.jsx("p",{className:"text-indigo-400 font-black uppercase tracking-[0.4em] text-xs",children:"En Levende Simulator"})]}),o.jsx("div",{className:"space-y-6",children:o.jsx("p",{className:"text-slate-400 text-lg md:text-xl font-medium max-w-md mx-auto leading-relaxed",children:"Dette er et spill om makt, ressurser og overlevelse i et feydalt samfunn."})}),o.jsxs("div",{className:"pt-4 space-y-4",children:[o.jsxs("button",{onClick:()=>a("CREATE"),className:"px-12 py-5 bg-indigo-600 hover:bg-indigo-500 text-white rounded-[2rem] font-black uppercase tracking-widest text-sm shadow-2xl shadow-indigo-600/40 transition-all hover:scale-105 active:scale-95 flex items-center justify-center gap-3 mx-auto w-64",children:["Skap din Karakter ",o.jsx(yr,{size:20})]}),o.jsx("button",{onClick:()=>i("/sim"),className:"text-slate-500 hover:text-white font-black uppercase tracking-widest text-xs transition-colors",children:"G til Lobby"})]})]}):r==="CREATE"?o.jsxs("div",{className:"bg-slate-900 border border-white/10 p-12 rounded-[3.5rem] shadow-2xl space-y-10 animate-in slide-in-from-bottom-8 duration-500",children:[o.jsxs("div",{className:"text-center space-y-2",children:[o.jsx("h2",{className:"text-4xl font-black italic text-white tracking-tighter uppercase",children:"Hvem er du?"}),o.jsxs("p",{className:"text-slate-500 font-bold uppercase tracking-widest text-xs",children:["Opprett din karakter i ",t]})]}),o.jsxs("div",{className:"space-y-8",children:[o.jsxs("div",{className:"space-y-3",children:[o.jsx("label",{className:"text-xs font-black text-indigo-400 uppercase tracking-[0.2em] ml-2",children:"Ditt Navn i Riket"}),o.jsxs("div",{className:"relative group",children:[o.jsx("div",{className:"absolute inset-y-0 left-6 flex items-center text-slate-500 group-focus-within:text-indigo-400",children:o.jsx(_r,{size:20})}),o.jsx("input",{type:"text",value:l,onChange:f=>c(f.target.value),placeholder:"f.eks. Eirik den Rde",className:"w-full bg-slate-950 border-2 border-white/5 rounded-3xl py-5 pl-16 pr-6 text-xl font-black text-white outline-none focus:border-indigo-500/50 transition-all"})]})]}),t==="TEST"&&o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:["PEASANT","SOLDIER","MERCHANT","BARON"].map(f=>o.jsx("button",{onClick:()=>d(f),className:`py-4 rounded-2xl font-black uppercase tracking-widest text-xs border-2 transition-all ${u===f?"bg-indigo-600/20 border-indigo-500 text-white":"bg-white/5 border-transparent text-slate-500"}`,children:f},f))}),o.jsxs("div",{className:"pt-4 flex gap-4",children:[o.jsx("button",{onClick:()=>a("WELCOME"),className:"flex-1 py-5 bg-white/5 text-slate-400 rounded-3xl font-black uppercase tracking-widest text-xs",children:"Tilbake"}),o.jsx("button",{onClick:()=>{n(l,u),a("SUCCESS")},disabled:!l.trim()||s,className:"flex-[2] py-5 bg-indigo-600 text-white rounded-3xl font-black uppercase tracking-widest text-sm",children:s?"Oppretter...":"Start Reisen"})]})]})]}):o.jsxs("div",{className:"bg-emerald-500/10 backdrop-blur-3xl border border-emerald-500/30 p-16 rounded-[4rem] text-center space-y-8 shadow-2xl animate-in zoom-in duration-500",children:[o.jsx(Uf,{size:48,className:"text-white mx-auto bg-emerald-500 rounded-[2rem] p-4 shadow-2xl"}),o.jsx("h2",{className:"text-4xl font-black italic text-white uppercase",children:"Velkommen inn!"})]})},_F=[{id:"ride_easy",label:"Engelskogen",icon:"",desc:"En rolig tur i vakkert terreng.",difficultly:"Lett",color:"from-emerald-600 to-emerald-800"},{id:"ride_medium",label:"Fjellpasset",icon:"",desc:"Hyere fart og flere klipper.",difficultly:"Medium",color:"from-amber-600 to-amber-800"},{id:"ride_hard",label:"Ulvestien",icon:"",desc:"Livsfarlig galopp gjennom tett mrke.",difficultly:"Hard",color:"from-rose-600 to-rose-800"}],tr={skins:[{id:"brown",label:"Rust",color:"#8B4513",price:0},{id:"white",label:"Pearl",color:"#E2E8F0",price:1e3},{id:"black",label:"Void",color:"#1A202C",price:2500},{id:"golden",label:"Gold",color:"#F6E05E",price:5e3},{id:"chestnut",label:"Red",color:"#7C2D12",price:750},{id:"grey",label:"Mist",color:"#94A3B8",price:1200}],manes:[{id:"#1e1b4b",label:"Shadow",price:0},{id:"#f1f5f9",label:"Snow",price:400},{id:"#ea580c",label:"Flame",price:800},{id:"rainbow",label:"Mythic",price:1500},{id:"#FCD34D",label:"Blonde",price:600}],hats:[{id:"none",label:"Ingen",icon:"",price:0},{id:"straw_hat",label:"Strhatt",icon:"",price:500},{id:"cowboy_hat",label:"Sheriff",icon:"",price:1e3},{id:"crown",label:"Konge",icon:"",price:1500},{id:"viking",label:"Viking",icon:"",price:2e3},{id:"tophat",label:"Grev",icon:"",price:3e3}]},wF=(t,e)=>{let n=1;t==="ride_medium"&&(n=1.6),t==="ride_hard"&&(n=2.5);const s=1+(e-1)*.5;return Math.ceil(10*n*s)},kF=({skinColor:t,maneColor:e,hatId:n})=>{const s=e==="rainbow";return o.jsxs("svg",{viewBox:"0 0 200 200",className:"w-full h-full drop-shadow-2xl",children:[o.jsxs("defs",{children:[o.jsxs("linearGradient",{id:"rainbowGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[o.jsx("stop",{offset:"0%",stopColor:"#ff0000"}),o.jsx("stop",{offset:"20%",stopColor:"#ffff00"}),o.jsx("stop",{offset:"40%",stopColor:"#00ff00"}),o.jsx("stop",{offset:"60%",stopColor:"#00ffff"}),o.jsx("stop",{offset:"80%",stopColor:"#0000ff"}),o.jsx("stop",{offset:"100%",stopColor:"#ff00ff"})]}),o.jsxs("filter",{id:"glow",children:[o.jsx("feGaussianBlur",{stdDeviation:"2.5",result:"coloredBlur"}),o.jsxs("feMerge",{children:[o.jsx("feMergeNode",{in:"coloredBlur"}),o.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),o.jsx("path",{d:"M70,160 L70,190 L85,190 L85,150 Z",fill:t,filter:"brightness(0.7)"}),o.jsx("path",{d:"M140,160 L140,190 L155,190 L155,150 Z",fill:t,filter:"brightness(0.7)"}),o.jsx("path",{d:"M50,100 Q40,60 90,60 L140,60 Q180,60 170,110 Q160,160 120,150 L80,150 Q50,150 50,100 Z",fill:t}),o.jsx("path",{d:"M60,150 L60,195 L75,195 L75,150 Z",fill:t}),o.jsx("path",{d:"M130,150 L130,195 L145,195 L145,150 Z",fill:t}),o.jsx("path",{d:"M130,65 Q130,30 160,20 L165,25 Q185,25 185,50 L175,70 Q160,85 145,65 Z",fill:t}),o.jsx("path",{d:"M185,50 L195,55 L190,65 L175,70 Z",fill:t,filter:"brightness(0.9)"}),o.jsx("path",{d:"M160,20 Q120,20 120,80 L130,90 Q140,30 165,25 Z",fill:s?"url(#rainbowGradient)":e,className:s?"animate-pulse":""}),o.jsx("path",{d:"M50,80 Q20,80 20,140",fill:"none",stroke:s?"url(#rainbowGradient)":e,strokeWidth:"8",strokeLinecap:"round"}),o.jsx("circle",{cx:"170",cy:"40",r:"2",fill:"white"}),o.jsx("circle",{cx:"170.5",cy:"39.5",r:"0.5",fill:"black"}),n==="straw_hat"&&o.jsx("text",{x:"160",y:"25",fontSize:"40",transform:"rotate(10, 160, 25)",children:""}),n==="cowboy_hat"&&o.jsx("text",{x:"155",y:"25",fontSize:"40",transform:"rotate(-5, 155, 25)",children:""}),n==="crown"&&o.jsx("text",{x:"155",y:"20",fontSize:"40",transform:"rotate(-10, 155, 20)",children:""}),n==="viking"&&o.jsx("text",{x:"155",y:"20",fontSize:"40",transform:"rotate(0, 155, 20)",children:""}),n==="tophat"&&o.jsx("text",{x:"152",y:"15",fontSize:"45",transform:"rotate(-10, 155, 20)",children:""})]})},NF=({player:t,onAction:e,onClose:n})=>{var p;const[s,i]=Ge.useState("ride"),[r,a]=Ge.useState("skin"),[l,c]=Ge.useState(null),u=t.minigameProgress||{},d=t.horseCustomization||{},f={skinId:d.skinId||"brown",maneColor:d.maneColor||"#1e1b4b",hatId:d.hatId||"none",unlockedSkins:d.unlockedSkins||["brown"],unlockedManeColors:d.unlockedManeColors||["#1e1b4b"],unlockedHats:d.unlockedHats||[]},h=tr.skins.find(x=>x.id===f.skinId)||tr.skins[0],m=tr.manes.find(x=>x.id===f.maneColor)||tr.manes[0],v=(x,w)=>{e({type:"MOUNT_HORSE",method:x,level:w}),n()},y=(x,w,k)=>{c({id:x,type:w,price:k})},b=()=>{l&&(e({type:"BUY_HORSE_COSMETIC",cosmeticId:l.id,cosmeticType:l.type,price:l.price}),c(null))},g=(x,w)=>{e({type:"SELECT_HORSE_COSMETIC",cosmeticId:x,cosmeticType:w})};return o.jsxs(zi,{title:"KONGELIG STALL",subtitle:"Equestrian Center",icon:o.jsx(sc,{className:"text-amber-500",size:24}),onClose:n,children:[l&&o.jsx("div",{className:"absolute inset-0 z-50 bg-black/80 backdrop-blur-sm flex items-center justify-center p-8 animate-in fade-in duration-200",children:o.jsxs("div",{className:"bg-slate-900 border border-amber-500/30 rounded-3xl p-8 max-w-sm w-full text-center shadow-2xl space-y-6",children:[o.jsx("div",{className:"w-16 h-16 bg-amber-500/10 rounded-full flex items-center justify-center mx-auto text-amber-500 border border-amber-500/20",children:o.jsx(Ca,{size:32})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xl font-black text-white uppercase mb-2",children:"Bekreft Kjp"}),o.jsxs("p",{className:"text-slate-400 text-sm",children:["Er du sikker p at du vil kjpe dette for ",o.jsxs("span",{className:"text-amber-400 font-bold",children:[l.price,"g"]}),"?"]})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx("button",{onClick:()=>c(null),className:"flex-1 py-3 rounded-xl bg-slate-800 text-slate-400 font-bold text-xs uppercase hover:bg-slate-700 transition-colors",children:"Avbryt"}),o.jsx("button",{onClick:b,className:"flex-1 py-3 rounded-xl bg-amber-600 text-white font-bold text-xs uppercase hover:bg-amber-500 shadow-lg shadow-amber-900/20 transition-all",children:"Kjp"})]})]})}),o.jsxs("div",{className:"flex flex-col h-[650px] select-none text-slate-200",children:[o.jsxs("div",{className:"flex items-center gap-4 p-6 pb-2",children:[o.jsxs("div",{className:"flex bg-slate-900/50 p-1 rounded-2xl border border-white/5",children:[o.jsxs("button",{onClick:()=>i("ride"),className:`px-8 py-2.5 rounded-xl font-bold text-xs uppercase tracking-widest transition-all flex items-center gap-2 ${s==="ride"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-400 hover:text-white hover:bg-white/5"}`,children:[o.jsx(ZU,{size:14})," Turer"]}),o.jsxs("button",{onClick:()=>i("horse"),className:`px-8 py-2.5 rounded-xl font-bold text-xs uppercase tracking-widest transition-all flex items-center gap-2 ${s==="horse"?"bg-amber-600 text-white shadow-lg shadow-amber-500/20":"text-slate-400 hover:text-white hover:bg-white/5"}`,children:[o.jsx(Ca,{size:14})," Min Hest"]})]}),o.jsx("div",{className:"flex-1"}),o.jsxs("div",{className:"flex items-center gap-3 px-5 py-2 bg-slate-950/50 rounded-2xl border border-amber-500/20 shadow-inner",children:[o.jsx("span",{className:"text-[10px] font-black text-amber-500 uppercase tracking-widest",children:"Saldo"}),o.jsxs("span",{className:"text-base font-black text-amber-400 font-mono tracking-tight",children:[(((p=t.resources)==null?void 0:p.gold)||0).toLocaleString(),o.jsx("span",{className:"text-xs ml-1 text-amber-600",children:"G"})]})]})]}),o.jsx("div",{className:"flex-1 p-6 overflow-hidden",children:s==="ride"?o.jsx("div",{className:"h-full flex flex-col animate-in fade-in slide-in-from-bottom-4 duration-500",children:o.jsx("div",{className:"grid grid-cols-1 gap-4 overflow-y-auto pr-2 custom-scrollbar pb-4",children:_F.map(x=>{const w=u[x.id]||1;return o.jsxs("div",{className:"group relative bg-gradient-to-r from-slate-900 via-slate-900 to-slate-800/50 border border-white/5 rounded-[2rem] p-1 overflow-hidden hover:border-white/10 transition-all",children:[o.jsx("div",{className:`absolute left-0 top-0 bottom-0 w-1 bg-gradient-to-b ${x.color}`}),o.jsxs("div",{className:"flex flex-col md:flex-row items-stretch gap-6 pl-6 p-5",children:[o.jsxs("div",{className:"flex items-center gap-5 min-w-[200px]",children:[o.jsx("div",{className:"w-16 h-16 rounded-2xl bg-slate-950 flex items-center justify-center text-4xl shadow-inner border border-white/5 group-hover:scale-105 transition-transform duration-500",children:x.icon}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-lg font-black uppercase tracking-tight text-white group-hover:text-indigo-400 transition-colors",children:x.label}),o.jsx("div",{className:"flex items-center gap-2 mt-1",children:o.jsx("span",{className:"px-2 py-0.5 bg-white/5 rounded text-[10px] font-bold text-slate-400 uppercase tracking-wider",children:x.difficultly})})]})]}),o.jsx("div",{className:"flex-1 flex flex-wrap items-center gap-3",children:[1,2,3,4,5].map(k=>{var j;const S=k<=w,N=k<w,T=wF(x.id,k),E=(((j=t.resources)==null?void 0:j.grain)||0)>=T;return o.jsx("button",{disabled:!S||!N&&!E,onClick:()=>v(x.id,k),className:`
                                                                    relative h-12 flex-1 min-w-[60px] max-w-[80px] rounded-xl flex flex-col items-center justify-center gap-0.5 border transition-all duration-300
                                                                    ${N?"bg-emerald-500/10 border-emerald-500/30 text-emerald-400":S?E?"bg-indigo-600 border-indigo-500 text-white shadow-lg shadow-indigo-500/20 hover:-translate-y-1":"bg-slate-800 border-slate-700 text-slate-500 saturate-0":"bg-transparent border-slate-800/50 text-slate-800"}
                                                                `,children:N?o.jsx(xU,{size:20}):S?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"text-sm font-black leading-none",children:k}),o.jsxs("span",{className:"text-[9px] font-medium opacity-80 leading-none",children:[T," "]})]}):o.jsx(no,{size:16})},k)})}),o.jsx("button",{onClick:()=>v(x.id,w),className:"w-14 rounded-xl bg-white/5 hover:bg-white/10 border border-white/5 flex items-center justify-center text-slate-400 hover:text-white transition-all",children:o.jsx(vA,{size:24})})]})]},x.id)})})}):o.jsxs("div",{className:"h-full grid grid-cols-12 gap-8 animate-in fade-in zoom-in-95 duration-500",children:[o.jsx("div",{className:"col-span-5 flex flex-col",children:o.jsxs("div",{className:"flex-1 relative bg-gradient-to-b from-slate-800/50 to-slate-900/90 rounded-[3rem] border border-white/10 shadow-2xl flex items-center justify-center overflow-hidden",children:[o.jsx("div",{className:"absolute inset-x-0 bottom-0 h-1/2 bg-gradient-to-t from-black/60 to-transparent"}),o.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[300px] h-[300px] bg-indigo-500/10 blur-[100px] rounded-full"}),o.jsx("div",{className:"relative z-10 w-full h-full p-8 transition-all hover:scale-105 duration-700 ease-out",children:o.jsx(kF,{skinColor:h.color,maneColor:m.id,hatId:f.hatId})}),o.jsx("div",{className:"absolute bottom-6 inset-x-8 text-center",children:o.jsx("div",{className:"inline-block px-6 py-2 bg-black/40 backdrop-blur-md rounded-full border border-white/5",children:o.jsxs("span",{className:"text-xs font-black uppercase tracking-[0.3em] text-white/80",children:[h.label," Stalon"]})})})]})}),o.jsxs("div",{className:"col-span-7 flex flex-col gap-6",children:[o.jsx("div",{className:"flex p-1 bg-slate-950/50 rounded-xl border border-white/5 w-fit",children:["skin","mane","hat"].map(x=>o.jsx("button",{onClick:()=>a(x),className:`px-5 py-2 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${r===x?"bg-amber-600 text-white shadow-lg shadow-amber-900/20":"text-slate-500 hover:text-slate-300 hover:bg-white/5"}`,children:x==="skin"?"Pels":x==="mane"?"Manke":"Hodeplagg"},x))}),o.jsx("div",{className:"flex-1 overflow-y-auto pr-2 custom-scrollbar",children:o.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[r==="skin"&&tr.skins.map(x=>{const w=f.unlockedSkins.includes(x.id),k=f.skinId===x.id;return o.jsxs("button",{onClick:()=>w?g(x.id,"skin"):y(x.id,"skin",x.price),className:`
                                                        aspect-square rounded-2xl border flex flex-col items-center justify-center gap-2 transition-all group
                                                        ${k?"bg-indigo-600 border-indigo-400 ring-2 ring-indigo-500/30":w?"bg-slate-800 border-white/5 hover:bg-slate-700 hover:border-white/20":"bg-slate-900/50 border-white/5 opacity-70 hover:opacity-100 hover:border-amber-500/50"}
                                                    `,children:[o.jsx("div",{className:"w-8 h-8 rounded-full border border-white/10 shadow-lg",style:{backgroundColor:x.color}}),o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx("span",{className:`text-[10px] font-black uppercase tracking-widest ${k?"text-white":"text-slate-400"}`,children:x.label}),!w&&o.jsxs("span",{className:"text-[10px] font-bold text-amber-500",children:[x.price,"g"]})]})]},x.id)}),r==="mane"&&tr.manes.map(x=>{const w=f.unlockedManeColors.includes(x.id),k=f.maneColor===x.id;return o.jsxs("button",{onClick:()=>w?g(x.id,"mane"):y(x.id,"mane",x.price),className:`
                                                        aspect-square rounded-2xl border flex flex-col items-center justify-center gap-3 transition-all
                                                        ${k?"bg-indigo-600 border-indigo-400":"bg-slate-800 border-white/5 hover:bg-slate-700"}
                                                    `,children:[o.jsx("div",{className:"w-12 h-4 rounded-full border border-white/10 shadow-sm",style:{background:x.id==="rainbow"?"linear-gradient(90deg, #f43f5e, #fbbf24, #10b981, #6366f1)":x.id}}),w?o.jsx("span",{className:`text-[10px] font-black uppercase tracking-widest ${k?"text-white":"text-slate-400"}`,children:x.label}):o.jsxs("span",{className:"text-xs font-bold text-amber-500",children:[x.price,"g"]})]},x.id)}),r==="hat"&&tr.hats.map(x=>{const w=f.unlockedHats.includes(x.id)||x.id==="none",k=f.hatId===x.id||!1;return o.jsxs("button",{onClick:()=>w?g(x.id,"hat"):y(x.id,"hat",x.price),className:`
                                                        aspect-square rounded-2xl border flex flex-col items-center justify-center gap-2 transition-all
                                                        ${k?"bg-indigo-600 border-indigo-400":"bg-slate-800 border-white/5 hover:bg-slate-700"}
                                                    `,children:[o.jsx("span",{className:"text-4xl drop-shadow-lg",children:x.icon}),!w&&o.jsxs("span",{className:"text-xs font-bold text-amber-500",children:[x.price,"g"]})]},x.id)})]})})]})]})})]})]})},SF=({player:t,room:e,onAction:n,onClose:s})=>{var v,y;const i=e.metadata||{},r=Date.now(),a=i.lastTavernRest||r,l=(r-a)/3e5;let c=i.tavernDemand||1;l>0&&(c=Math.max(1,c-l*.05));const u=b=>Math.ceil(b*c),d=t.regionId||"capital",f=((v=e.markets)==null?void 0:v[d])||e.market,h=((y=f==null?void 0:f.bread)==null?void 0:y.price)||5,m=Math.ceil(h*1.2);return o.jsx(zi,{title:"Vertshuset: Den Glade Gris",subtitle:"Mat & Losji",icon:o.jsx(OH,{className:"text-amber-400"}),onClose:s,maxWidth:"max-w-4xl",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[o.jsx("div",{className:"p-2 bg-amber-500/20 rounded-lg text-amber-400",children:o.jsx(yU,{size:20})}),o.jsx("h3",{className:"text-lg font-bold text-white uppercase tracking-wider",children:"Mat & Drikke"})]}),o.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-2xl p-5 hover:bg-white/10 transition-colors group",children:[o.jsxs("div",{className:"flex justify-between items-start mb-3",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"font-bold text-lg text-amber-100",children:"Dagens Husmannskost"}),o.jsx("p",{className:"text-xs text-amber-400/60 uppercase tracking-widest font-bold mt-1",children:"Markedspris + Servering"})]}),o.jsxs("div",{className:"text-right",children:[o.jsxs("div",{className:"text-xl font-black text-amber-400",children:[m,"g"]}),o.jsxs("div",{className:"text-[10px] text-slate-400",children:["oppr. ",h.toFixed(1),"g"]})]})]}),o.jsx("p",{className:"text-slate-300 text-sm mb-4 leading-relaxed",children:"En varm tallerken med brd, litt kjttrester og dagens suppe. Ikke noe fancy, men det metter."}),o.jsx("div",{className:"flex items-center gap-4 text-xs font-medium text-slate-400 mb-5",children:o.jsxs("div",{className:"flex items-center gap-1.5 bg-slate-950/50 px-2.5 py-1 rounded-md border border-white/5",children:[o.jsx("span",{className:"text-emerald-400",children:""}),o.jsx("span",{children:"+10 Stamina"})]})}),o.jsx("button",{onClick:()=>{n({type:"BUY_MEAL",locationId:"tavern_bar"})},className:"w-full py-3 bg-amber-600 hover:bg-amber-500 text-white font-bold rounded-xl flex items-center justify-center gap-2 transition-all active:scale-95 shadow-lg shadow-amber-900/20",children:o.jsx("span",{children:"Kjp Mltid"})})]}),o.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-xl p-4 flex gap-3 text-sm text-blue-200",children:[o.jsx(wA,{className:"shrink-0 mt-0.5",size:16}),o.jsx("p",{children:"Prisene justeres automatisk basert p rvarepriser i markedet."})]})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[o.jsx("div",{className:"p-2 bg-indigo-500/20 rounded-lg text-indigo-400",children:o.jsx(Q1,{size:20})}),o.jsx("h3",{className:"text-lg font-bold text-white uppercase tracking-wider",children:"Overnatting"}),c>1.1&&o.jsxs("span",{className:"ml-auto text-[10px] font-black bg-rose-500 text-white px-2 py-0.5 rounded-full animate-pulse",children:["HY ETTERSPRSEL (x",c.toFixed(2),")"]})]}),o.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-2xl p-4 hover:border-indigo-500/30 transition-colors",children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsx("h4",{className:"font-bold text-slate-200",children:"Sovesal (Hengekye)"}),o.jsxs("span",{className:"font-bold text-amber-400",children:[u(150),"g"]})]}),o.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400 mb-3",children:[o.jsx("span",{className:"text-emerald-400 font-bold",children:"+30 Stamina"}),o.jsx("span",{children:""}),o.jsx("span",{children:"Ingen buffs"})]}),o.jsx("button",{onClick:()=>n({type:"REST_BASIC",locationId:"tavern_bar"}),className:"w-full py-2 bg-slate-700 hover:bg-slate-600 text-white text-sm font-bold rounded-lg transition-colors",children:"Lei Kye"})]}),o.jsxs("div",{className:"bg-gradient-to-br from-indigo-900/20 to-slate-900/40 border border-indigo-500/30 rounded-2xl p-4 hover:border-indigo-400/50 transition-colors relative overflow-hidden group",children:[o.jsx("div",{className:"absolute top-0 right-0 p-2 opacity-5 scale-150 group-hover:scale-110 transition-transform",children:o.jsx(Q1,{size:64})}),o.jsxs("div",{className:"relative",children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsx("h4",{className:"font-bold text-indigo-200",children:"Komfortabelt Rom"}),o.jsxs("span",{className:"font-bold text-amber-400",children:[u(500),"g"]})]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-slate-400 mb-3",children:[o.jsx("span",{className:"text-emerald-400 font-bold",children:"+80 Stamina"}),o.jsx("span",{className:"text-rose-400 font-bold",children:"+10 HP"}),o.jsx("span",{className:"bg-indigo-500/20 text-indigo-300 px-1.5 py-0.5 rounded border border-indigo-500/30",children:"Buff: Utvilt"})]}),o.jsx("button",{onClick:()=>n({type:"REST_COMFY",locationId:"tavern_bar"}),className:"w-full py-2 bg-indigo-600 hover:bg-indigo-500 text-white text-sm font-bold rounded-lg transition-colors shadow-lg shadow-indigo-900/20",children:"Lei Rom"})]})]}),o.jsxs("div",{className:"bg-gradient-to-br from-amber-900/20 to-slate-900/40 border border-amber-500/30 rounded-2xl p-4 hover:border-amber-400/50 transition-colors relative overflow-hidden group",children:[o.jsx("div",{className:"absolute top-0 right-0 p-2 opacity-5 scale-150 group-hover:scale-110 transition-transform",children:o.jsx(Lc,{size:64})}),o.jsxs("div",{className:"relative",children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsx("h4",{className:"font-bold text-amber-200",children:"Kongesuite"}),o.jsxs("span",{className:"font-bold text-amber-400",children:[u(1500),"g"]})]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-slate-400 mb-3",children:[o.jsx("span",{className:"text-emerald-400 font-bold",children:"FULL Stamina"}),o.jsx("span",{className:"text-rose-400 font-bold",children:"+50 HP"}),o.jsx("span",{className:"bg-amber-500/20 text-amber-300 px-1.5 py-0.5 rounded border border-amber-500/30",children:"Buff: Luksusliv"})]}),o.jsx("button",{onClick:()=>n({type:"REST_ROYAL",locationId:"tavern_bar"}),className:"w-full py-2 bg-gradient-to-r from-amber-600 to-orange-600 hover:from-amber-500 hover:to-orange-500 text-white text-sm font-bold rounded-lg transition-colors shadow-lg shadow-amber-900/20",children:"Lei Suite"})]})]})]})]})})},EF={KING:Lc,BARON:Ix,PEASANT:$d,SOLDIER:Fd,MERCHANT:jx},TF={KING:["Sikre rikets stabilitet","Samle inn skatter fra baronene","Beskytte 'The Orb of Power'"],BARON:["Administrer din region","Krev inn skatter fra bndene","Bygg opp forsvaret mot invasjoner"],PEASANT:["Dyrk jorden og hst korn","Betal skatt for  unng fengsel","Overlev vinteren"],SOLDIER:["Beskytt riket mot farer","Tren deg opp i kamp","Adlyde ordrer fra Kongen"],MERCHANT:["Kjp og selg varer p markedet","Tjen deg rik p handel","Unng  bli plyndret"]},AF={KING:"Du er den verste lederen. Din makt er absolutt, men ditt ansvar er tungt. Riket hviler p dine skuldre.",BARON:"Du styrer et av rikets store landomrder. Du er bindeleddet mellom Kongen og folket.",PEASANT:"Du er ryggraden i samfunnet. Uten ditt harde arbeid ville riket sultet. Livet er hardt, men rlig.",SOLDIER:"Du er sverdets mester. Din plikt er  beskytte de svake og opprettholde lov og orden.",MERCHANT:"Du forstr verdien av gull. Mens andre slss eller dyrker, bygger du formuer gjennom smart handel."},jF=({player:t,pin:e,onComplete:n})=>{var d,f;const[s,i]=_.useState(0),[r,a]=_.useState(!1),l=EF[t.role]||_r,c=TF[t.role]||["Overlev","Utforsk","Lr"];_.useEffect(()=>{if(s===0){const h=setTimeout(()=>i(1),3e3);return()=>clearTimeout(h)}},[s]);const u=async()=>{a(!0);try{const h={};h[`simulation_rooms/${e}/players/${t.id}/hasSeenIntro`]=!0,await ne(L(P),h),setTimeout(n,500)}catch(h){console.error("Failed to save intro state",h),n()}};return s===0?o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-950 text-white animate-in fade-in duration-1000",children:o.jsxs("div",{className:"text-center space-y-8 animate-in zoom-in duration-1000 slide-in-from-bottom-10 fill-mode-forwards",children:[o.jsxs("div",{className:"relative inline-block",children:[o.jsx("div",{className:"absolute inset-0 bg-indigo-500/20 blur-[100px] rounded-full animate-pulse"}),o.jsx(l,{size:120,className:"relative z-10 text-white drop-shadow-[0_0_30px_rgba(255,255,255,0.5)]"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-slate-400 font-bold uppercase tracking-[0.5em] text-sm animate-in fade-in delay-500 duration-1000",children:"Skjebnen har valgt..."}),o.jsx("h1",{className:"text-6xl md:text-8xl font-black italic tracking-tighter uppercase animate-in slide-in-from-bottom-5 delay-700 duration-500",children:((d=tc[t.role])==null?void 0:d.label)||t.role})]})]})}):o.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center bg-slate-950/90 backdrop-blur-3xl transition-opacity duration-500 ${r?"opacity-0":"opacity-100"}`,children:o.jsxs("div",{className:"max-w-4xl w-full mx-4 grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-16 items-center",children:[o.jsxs("div",{className:"text-center space-y-8 order-2 md:order-1 animate-in slide-in-from-left-10 duration-700",children:[o.jsxs("div",{className:"relative inline-block p-10 bg-gradient-to-br from-indigo-500/20 to-purple-500/20 rounded-[3rem] border border-white/10 shadow-2xl",children:[o.jsx(l,{size:180,className:"text-white drop-shadow-2xl"}),o.jsx("div",{className:"absolute -bottom-6 left-1/2 -translate-x-1/2 bg-slate-900 border border-white/20 px-6 py-2 rounded-full whitespace-nowrap",children:o.jsx("span",{className:"text-xs font-black uppercase tracking-widest text-indigo-300",children:"Din tildelte rolle"})})]}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-4xl font-black italic tracking-tighter uppercase mb-4",children:(f=tc[t.role])==null?void 0:f.label}),o.jsx("p",{className:"text-slate-400 font-medium leading-relaxed max-w-sm mx-auto",children:AF[t.role]})]})]}),o.jsxs("div",{className:"space-y-8 order-1 md:order-2 animate-in slide-in-from-right-10 duration-700 delay-200",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("h3",{className:"text-sm font-black uppercase tracking-[0.3em] text-indigo-400",children:"Dine Ml"}),o.jsx("h1",{className:"text-5xl font-black italic tracking-tighter text-white",children:"Oppdrag"})]}),o.jsx("div",{className:"space-y-4",children:c.map((h,m)=>o.jsxs("div",{className:"flex items-center gap-4 bg-white/5 border border-white/5 p-4 rounded-2xl hover:bg-white/10 transition-colors group",children:[o.jsx("div",{className:"w-10 h-10 rounded-full bg-emerald-500/20 flex items-center justify-center text-emerald-400 border border-emerald-500/20 group-hover:scale-110 transition-transform",children:o.jsx("span",{className:"font-black text-sm",children:m+1})}),o.jsx("span",{className:"font-bold text-slate-200",children:h})]},m))}),o.jsx("div",{className:"pt-8",children:o.jsxs("button",{onClick:u,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white py-6 rounded-[2rem] font-black uppercase text-lg tracking-widest shadow-2xl shadow-indigo-600/30 hover:scale-105 active:scale-95 transition-all flex items-center justify-center gap-4 group",children:["Start Din Reise ",o.jsx(yr,{className:"group-hover:translate-x-2 transition-transform"})]})})]})]})})},RF=(t,e)=>{const[n,s]=_.useState("global"),[i,r]=_.useState({}),[a,l]=_.useState({}),[c,u]=_.useState(!1),[d,f]=_.useState(0),[h,m]=_.useState(()=>{if(!(e!=null&&e.id))return{};const y=localStorage.getItem(`chat_last_read_${t}_${e.id}`);return y?JSON.parse(y):{}}),v=y=>{const b=Date.now();m(g=>{const p={...g,[y]:b};return e!=null&&e.id&&localStorage.setItem(`chat_last_read_${t}_${e.id}`,JSON.stringify(p)),p})};return _.useEffect(()=>{if(!e)return;const y={};if(y.global={id:"global",name:"Riket",type:"GLOBAL",unreadCount:0,description:"Offentlig torg"},e.role==="KING")y.region_vest={id:"region_vest",name:"Vest",type:"REGION",unreadCount:0,description:"Regional kanal for Vest"},y.region_ost={id:"region_ost",name:"st",type:"REGION",unreadCount:0,description:"Regional kanal for st"},y.capital={id:"capital",name:"Hovedstaden",type:"REGION",unreadCount:0,description:"Hovedstaden"};else if(e.regionId){const b=e.regionId==="capital"?"Hovedstaden":e.regionId==="region_vest"?"Vest":e.regionId==="region_ost"?"st":e.regionId;y[e.regionId]={id:e.regionId,name:b,type:"REGION",unreadCount:0,description:"Ditt hjemsted"}}(e.role==="BARON"||e.role==="KING")&&(y.diplomacy={id:"diplomacy",name:"Rdet",type:"DIPLOMACY",unreadCount:0,description:"Hemmelig kanal for ledere"}),r(b=>{const g={...y};return Object.keys(b).forEach(p=>{g[p]&&(g[p].unreadCount=b[p].unreadCount)}),g})},[e==null?void 0:e.regionId,e==null?void 0:e.role]),_.useEffect(()=>{if(!t||!e||Object.keys(i).length===0)return;const y=[];return Object.keys(i).forEach(b=>{const g=L(P,`simulation_rooms/${t}/channels/${b}/messages`),p=q3(g,W3(20)),x=We(p,w=>{const k=w.val(),S=k?Object.values(k):[];S.sort((E,j)=>E.timestamp-j.timestamp),l(E=>({...E,[b]:S}));const N=h[b]||0,T=S.filter(E=>E.timestamp>N&&E.senderId!==e.id).length;r(E=>E[b]&&E[b].unreadCount===T?E:{...E,[b]:{...E[b],unreadCount:T}})});y.push(x)}),()=>y.forEach(b=>b())},[t,e==null?void 0:e.id,Object.keys(i).join(","),h]),_.useEffect(()=>{const y=Object.values(i).reduce((b,g)=>b+(g.unreadCount||0),0);f(y)},[i]),{activeChannelId:n,setActiveChannelId:s,channels:i,messages:a[n]||[],isLoading:c&&!a[n],totalUnreadCount:d,markChannelAsRead:v}},cu=(...t)=>t.filter(Boolean).join(" "),IF=({pin:t,player:e,onOpenProfile:n})=>{var x;const[s,i]=_.useState(!1),{activeChannelId:r,setActiveChannelId:a,channels:l,messages:c,totalUnreadCount:u,markChannelAsRead:d,isLoading:f}=RF(t,e),[h,m]=_.useState(""),[v,y]=_.useState(!1),b=_.useRef(null);_.useEffect(()=>{b.current&&b.current.scrollIntoView({behavior:"smooth"})},[c,s]),_.useEffect(()=>{s&&d(r)},[s,r,d]),_.useEffect(()=>{const w=k=>{var S;["INPUT","TEXTAREA"].includes(((S=document.activeElement)==null?void 0:S.tagName)||"")||k.key.toLowerCase()==="c"&&i(N=>!N)};return window.addEventListener("keydown",w),()=>window.removeEventListener("keydown",w)},[]);const g=async()=>{if(!h.trim()||v)return;y(!0);const w=await uG(t,e.id,h,r);w.success?m(""):alert(w.error||"Feil ved sending."),y(!1)},p=w=>{switch(w){case"GLOBAL":return o.jsx(Cx,{size:14});case"REGION":return o.jsx(kA,{size:14});case"DIPLOMACY":return o.jsx(Lc,{size:14,className:"text-amber-400"});case"DM":return o.jsx(no,{size:14});default:return o.jsx(nc,{size:14})}};return s?o.jsxs("div",{className:"fixed bottom-6 left-6 z-50 w-[380px] h-[500px] flex flex-col bg-slate-950/95 border border-slate-800/80 rounded-2xl shadow-2xl backdrop-blur-xl animate-in slide-in-from-bottom-10 fade-in duration-300",children:[o.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-slate-800/50 bg-slate-900/50 rounded-t-2xl drag-handle cursor-grab active:cursor-grabbing",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500 animate-pulse"}),o.jsx("span",{className:"text-xs font-bold uppercase tracking-widest text-slate-400",children:"Comms Array"})]}),o.jsx("button",{onClick:()=>i(!1),className:"text-slate-500 hover:text-white transition-colors",children:o.jsx(dU,{size:18})})]}),o.jsx("div",{className:"flex gap-1 p-2 bg-slate-900/30 overflow-x-auto scrollbar-hide",children:Object.values(l).map(w=>o.jsxs("button",{onClick:()=>a(w.id),className:cu("flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-semibold whitespace-nowrap transition-all relative",r===w.id?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"bg-slate-800/50 text-slate-400 hover:bg-slate-800 hover:text-slate-200"),children:[p(w.type),w.name,w.unreadCount>0&&r!==w.id&&o.jsx("div",{className:"absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full border border-slate-900"})]},w.id))}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar bg-gradient-to-b from-slate-950/50 to-transparent",children:[f?o.jsx("div",{className:"flex justify-center p-4",children:o.jsx("div",{className:"w-6 h-6 border-2 border-indigo-500 border-t-transparent rounded-full animate-spin"})}):c.length===0?o.jsx("div",{className:"text-center text-slate-600 text-xs italic mt-10",children:"Ingen meldinger i denne kanalen enn."}):c.map(w=>{const k=w.senderId===e.id;return o.jsxs("div",{className:cu("flex flex-col gap-1 max-w-[85%]",k?"ml-auto items-end":"mr-auto items-start"),children:[o.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-slate-500 px-1",children:[o.jsx("span",{onClick:()=>n&&n(w.senderId||""),className:cu("font-bold hover:underline cursor-pointer",k?"text-indigo-400":"text-amber-500"),children:w.senderName}),o.jsxs("span",{className:"opacity-50",children:[" ",new Date(w.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),o.jsxs("div",{className:cu("px-3 py-2 rounded-2xl text-sm leading-relaxed shadow-sm break-words relative group",k?"bg-indigo-600 text-white rounded-tr-sm":"bg-slate-800 text-slate-200 rounded-tl-sm border border-slate-700/50"),children:[w.content,!k&&w.senderRole!=="PEASANT"&&o.jsx("div",{className:"absolute -top-2 -right-2 bg-slate-950 border border-slate-700 text-[8px] font-black uppercase px-1.5 py-0.5 rounded shadow-xl scale-0 group-hover:scale-100 transition-transform",children:w.senderRole})]})]},w.id)}),o.jsx("div",{ref:b})]}),o.jsx("div",{className:"p-3 bg-slate-900/80 border-t border-slate-800 backdrop-blur-md",children:o.jsxs("div",{className:"relative flex items-center gap-2",children:[o.jsx("input",{value:h,onChange:w=>m(w.target.value),onKeyDown:w=>w.key==="Enter"&&!w.shiftKey&&g(),placeholder:`Melding til #${((x=l[r])==null?void 0:x.name)||"kanal"}...`,className:"flex-1 bg-slate-950 border border-slate-700 rounded-xl px-4 py-2.5 text-sm text-white placeholder:text-slate-600 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500 transition-all shadow-inner",disabled:v}),o.jsx("button",{onClick:g,disabled:!h.trim()||v,className:"bg-indigo-600 hover:bg-indigo-500 text-white p-2.5 rounded-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-indigo-500/20 active:scale-95",children:v?o.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):o.jsx(NA,{size:16})}),e.role!=="KING"&&r==="global"&&o.jsx("div",{className:"absolute -top-6 right-2 text-[10px] text-amber-500 font-mono bg-amber-950/30 px-2 py-0.5 rounded border border-amber-900/50",children:"Kostnad: 2 Gull"})]})})]}):o.jsx("button",{onClick:()=>i(!0),className:"fixed bottom-6 left-6 z-50 bg-slate-900/90 border border-slate-700/50 text-white p-3 rounded-full shadow-2xl hover:bg-indigo-600 hover:scale-105 transition-all group backdrop-blur-md",children:o.jsxs("div",{className:"relative",children:[o.jsx(nc,{size:24,className:"group-hover:text-white text-slate-200"}),u>0&&o.jsx("div",{className:"absolute -top-2 -right-2 min-w-[20px] h-5 bg-red-500 rounded-full flex items-center justify-center text-[10px] font-black border-2 border-slate-900 px-1 animate-in zoom-in duration-300",children:u>9?"9+":u})]})})},c_=["gold","grain","wood","iron_ore","stone","plank","iron_ingot","bread","swords","armor","cloth","wool"],CF=({isOpen:t,onClose:e,myPlayer:n,targetPlayer:s,pin:i})=>{const[r,a]=_.useState({gold:0}),[l,c]=_.useState({gold:0}),[u,d]=_.useState(!1),[f,h]=_.useState(null);if(!t)return null;Ge.useEffect(()=>{const g=p=>{p.key==="Escape"&&e()};return window.addEventListener("keydown",g),()=>window.removeEventListener("keydown",g)},[e]);const m=async()=>{d(!0),h(null);try{const g=await tF(i,n.id,s.id,r,l);g.success?(h("Handelstilbud sendt!"),setTimeout(e,1500)):(h("Feil: "+g.error),d(!1))}catch(g){console.error(g),h("En ukjent feil oppstod."),d(!1)}},v=(g,p)=>{a(x=>({...x,[g]:Math.max(0,p)}))},y=(g,p)=>{c(x=>({...x,[g]:Math.max(0,p)}))},b=({label:g,values:p,onChange:x,max:w})=>o.jsxs("div",{className:"space-y-2",children:[o.jsx("h4",{className:"text-xs font-bold uppercase text-slate-400 tracking-wider mb-2",children:g}),o.jsxs("div",{className:"space-y-2 max-h-60 overflow-y-auto pr-2 custom-scrollbar",children:[c_.map(k=>{var T;const S=p[k]||0,N=w?w(k):9999;return w&&N<=0&&S<=0?null:o.jsxs("div",{className:"flex items-center gap-2 bg-slate-900/50 p-2 rounded-lg border border-slate-700/50",children:[o.jsx("span",{className:"text-lg w-8 text-center",children:Gd[k.toUpperCase()]||""}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"text-xs text-slate-300 font-medium capitalize truncate",children:((T=Rt[k])==null?void 0:T.label)||k.replace("_"," ")}),w&&o.jsxs("div",{className:"text-[10px] text-slate-500",children:["Du har: ",N]})]}),o.jsx("input",{type:"number",value:S||"",placeholder:"0",onChange:E=>x(k,parseInt(E.target.value)||0),className:"w-20 bg-slate-800 border border-slate-700 rounded px-2 py-1 text-right text-sm font-mono focus:outline-none focus:border-indigo-500"})]},k)}),!w&&o.jsx("div",{className:"text-xs text-slate-500 text-center italic mt-2",children:"Velg hva du krever"})]})]});return o.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:o.jsxs("div",{className:"w-full max-w-4xl bg-slate-900 border border-indigo-500/30 rounded-2xl shadow-2xl flex flex-col max-h-[90vh] overflow-hidden",children:[o.jsxs("div",{className:"p-6 bg-slate-900 border-b border-indigo-500/20 flex justify-between items-center relative overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 bg-indigo-600/5 opacity-0 group-hover:opacity-100 transition-opacity"}),o.jsxs("div",{children:[o.jsxs("h2",{className:"text-2xl font-black italic text-white flex items-center gap-3",children:[o.jsx(Rx,{className:"text-indigo-400"}),"HANDELSKONTRAKT"]}),o.jsxs("p",{className:"text-slate-400 text-sm",children:["Opprett et tilbud til ",o.jsx("span",{className:"text-white font-bold",children:s.name})]})]}),o.jsx("button",{onClick:e,className:"relative z-10 p-2 hover:bg-slate-800 rounded-full transition-colors cursor-pointer",children:o.jsx(us,{className:"text-slate-400"})})]}),o.jsxs("div",{className:"flex-1 overflow-hidden grid grid-cols-1 md:grid-cols-2 divide-y md:divide-y-0 md:divide-x divide-slate-800 bg-slate-950/50",children:[o.jsx("div",{className:"p-6 overflow-hidden flex flex-col",children:o.jsx(b,{label:"Ditt Tilbud (Assets)",values:r,onChange:v,max:g=>n.resources[g]||0})}),o.jsx("div",{className:"p-6 overflow-hidden flex flex-col",children:o.jsxs("div",{className:"space-y-2 max-h-[60vh] overflow-y-auto pr-2 custom-scrollbar",children:[o.jsx("h4",{className:"text-xs font-bold uppercase text-slate-400 tracking-wider mb-2",children:"Ditt Krav (Liabilities)"}),c_.map(g=>{var p;return o.jsxs("div",{className:"flex items-center gap-2 bg-slate-900/50 p-2 rounded-lg border border-slate-700/50 hover:border-indigo-500/30 transition-colors",children:[o.jsx("span",{className:"text-lg w-8 text-center opacity-70",children:Gd[g.toUpperCase()]||""}),o.jsx("span",{className:"flex-1 text-xs text-slate-300 font-medium capitalize truncate",children:((p=Rt[g])==null?void 0:p.label)||g.replace("_"," ")}),o.jsx("input",{type:"number",value:l[g]||"",placeholder:"0",onChange:x=>y(g,parseInt(x.target.value)||0),className:"w-20 bg-slate-800 border border-slate-700 rounded px-2 py-1 text-right text-sm font-mono focus:outline-none focus:border-indigo-500"})]},g)})]})})]}),o.jsxs("div",{className:"p-6 bg-slate-900 border-t border-indigo-500/20 flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2 text-yellow-500/80 text-xs",children:[o.jsx(Hp,{size:14}),o.jsx("span",{children:"Ressursene trekkes umiddelbart (Escrow)."})]}),o.jsxs("div",{className:"flex items-center gap-4",children:[f&&o.jsx("span",{className:`text-sm font-bold ${f.startsWith("Feil")?"text-red-400":"text-green-400"}`,children:f}),o.jsx("button",{onClick:m,disabled:u||f!==null,className:"px-6 py-3 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-xl flex items-center gap-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-indigo-500/20",children:u?"Signerer...":o.jsxs(o.Fragment,{children:[o.jsx(NA,{size:18}),"Send Kontrakt"]})})]})]})]})})},OF=["gold","grain","wood","iron_ore","bread"],MF=({isOpen:t,onClose:e,myPlayer:n,targetPlayer:s,pin:i})=>{const[r,a]=_.useState("INFO"),[l,c]=_.useState(!1);Ge.useEffect(()=>{const g=p=>{p.key==="Escape"&&e()};return window.addEventListener("keydown",g),()=>window.removeEventListener("keydown",g)},[e]);const[u,d]=_.useState("gold"),[f,h]=_.useState(0),[m,v]=_.useState(null),y=g=>{switch(g){case"KING":return o.jsx(Lc,{size:32,className:"text-yellow-400"});case"BARON":return o.jsx(Ix,{size:32,className:"text-purple-400"});case"SOLDIER":return o.jsx(Fd,{size:32,className:"text-red-400"});case"MERCHANT":return o.jsx(jx,{size:32,className:"text-emerald-400"});default:return o.jsx(_r,{size:32,className:"text-slate-400"})}},b=async()=>{if(f<=0)return;v("Sender...");const g={};g[u]=f;const p=await eF(i,n.id,s.id,g);p.success?(v(`Sendte ${f} ${u}!`),setTimeout(()=>{v(null),a("INFO")},1500)):v("Feil: "+p.error)};return t?l?o.jsx(CF,{isOpen:!0,onClose:()=>c(!1),myPlayer:n,targetPlayer:s,pin:i}):o.jsx("div",{className:"fixed inset-0 z-[50] flex items-center justify-center p-4 bg-slate-950/60 backdrop-blur-sm animate-in fade-in duration-200",children:o.jsxs("div",{className:"w-full max-w-md bg-slate-900 border border-slate-700 rounded-3xl shadow-2xl overflow-hidden flex flex-col relative",children:[o.jsx("div",{className:`h-32 w-full relative bg-gradient-to-br ${s.role==="KING"?"from-yellow-900/40 to-slate-900":"from-indigo-900/40 to-slate-900"}`,children:o.jsx("div",{className:"absolute top-4 right-4",children:o.jsx("button",{onClick:e,className:"p-2 bg-black/20 hover:bg-black/40 rounded-full transition-colors backdrop-blur-sm text-white",children:o.jsx(us,{size:20})})})}),o.jsxs("div",{className:"px-8 relative -mt-16 mb-4 flex flex-col items-center",children:[o.jsxs("div",{className:"w-32 h-32 rounded-full border-4 border-slate-900 bg-slate-800 flex items-center justify-center shadow-xl relative group overflow-hidden",children:[s.avatar?o.jsx("img",{src:s.avatar,alt:s.name,className:"w-full h-full object-cover"}):y(s.role),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"})]}),o.jsx("h2",{className:"text-2xl font-black text-white mt-4",children:s.name}),o.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-sm font-medium uppercase tracking-wider",children:[o.jsx("span",{className:"text-indigo-400",children:s.role}),o.jsx("span",{children:""}),o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx(kA,{size:12})," ",s.regionId||"Ukjent"]})]})]}),o.jsxs("div",{className:"flex-1 px-8 pb-8 space-y-6",children:[r==="INFO"&&o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"bg-slate-950/50 p-4 rounded-2xl border border-slate-800 text-center",children:[o.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-widest font-bold mb-1",children:"Level"}),o.jsx("div",{className:"text-3xl font-black text-white",children:s.stats.level})]}),o.jsxs("div",{className:"bg-slate-950/50 p-4 rounded-2xl border border-slate-800 text-center",children:[o.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-widest font-bold mb-1",children:"Reputasjon"}),o.jsx("div",{className:"text-3xl font-black text-indigo-400",children:s.stats.reputation})]})]}),r==="GIFT"&&o.jsxs("div",{className:"bg-slate-950/50 p-6 rounded-2xl border border-slate-800 space-y-4 animate-in slide-in-from-bottom-4 duration-300",children:[o.jsx("h3",{className:"text-center text-slate-300 font-bold",children:"Send en gave"}),o.jsx("div",{className:"flex gap-2 justify-center",children:OF.map(g=>o.jsx("button",{onClick:()=>d(g),className:`p-2 rounded-lg border transition-all ${u===g?"bg-indigo-600 border-indigo-500":"bg-slate-900 border-slate-700 hover:border-slate-500"}`,children:o.jsx("span",{className:"text-xl",children:Gd[g.toUpperCase()]||""})},g))}),o.jsxs("div",{className:"flex items-center gap-2 bg-slate-900 border border-slate-700 rounded-xl px-4 py-2",children:[o.jsx("input",{type:"number",className:"bg-transparent w-full text-center text-xl font-bold focus:outline-none",value:f,onChange:g=>h(parseInt(g.target.value)||0),placeholder:"0"}),o.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase",children:u})]}),o.jsx("button",{onClick:b,disabled:!!m,className:"w-full py-3 bg-emerald-600 hover:bg-emerald-500 text-white rounded-xl font-bold shadow-lg shadow-emerald-500/20 disabled:opacity-50",children:m||"Send Gave"})]}),o.jsx("div",{className:"flex gap-2",children:r==="INFO"?o.jsxs(o.Fragment,{children:[o.jsxs("button",{onClick:()=>a("GIFT"),className:"flex-1 py-3 bg-slate-800 hover:bg-slate-700 text-slate-200 rounded-xl font-bold flex items-center justify-center gap-2 transition-transform active:scale-95",children:[o.jsx(yA,{size:18}),o.jsx("span",{children:"Gave"})]}),o.jsxs("button",{onClick:()=>c(!0),className:"flex-1 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold flex items-center justify-center gap-2 transition-transform active:scale-95 shadow-lg shadow-indigo-500/20",children:[o.jsx(Rx,{size:18}),o.jsx("span",{children:"Handel"})]})]}):o.jsx("button",{onClick:()=>a("INFO"),className:"w-full py-3 text-slate-400 hover:text-white font-bold",children:"Avbryt"})}),s.role==="SOLDIER"&&n.role==="SOLDIER"&&o.jsxs("button",{className:"w-full py-2 border border-red-500/30 text-red-400 hover:bg-red-500/10 rounded-xl font-bold uppercase tracking-widest text-xs flex items-center justify-center gap-2",children:[o.jsx(Fd,{size:14}),"Utfordre til Duell (Kommer snart)"]})]})]})}):null},DF=()=>{const{pin:t}=wN(),[e]=DR(),n=e.get("impersonate"),s=ho(),{user:i,account:r,loading:a}=Cf(),{activeMinigame:l,setActiveMinigame:c,activeMinigameAction:u,setActiveMinigameAction:d,activeMinigameMethod:f,setActiveMinigameMethod:h}=ql(),{setHideHeader:m,setFullWidth:v}=TN();Ge.useEffect(()=>{m(!0),v(!0);const X=()=>{Ut(async()=>{const{audioManager:fe}=await Promise.resolve().then(()=>hL);return{audioManager:fe}},void 0).then(({audioManager:fe})=>{fe.resume()}),window.removeEventListener("click",X),window.removeEventListener("keydown",X)};return window.addEventListener("click",X),window.addEventListener("keydown",X),()=>{m(!1),v(!1),window.removeEventListener("click",X),window.removeEventListener("keydown",X)}},[m,v]);const{player:y,world:b,players:g,roomStatus:p,markets:x,messages:w,diplomacy:k,activeVote:S,worldEvents:N,trades:T,regions:E,hasAttemptedPlayerLoad:j,isRetired:R}=p$(t,n),{handleAction:I,actionResult:V,handleClearActionResult:B}=OA(t,y,b,c,h,d,l),[O,D]=_.useState(!1),[M,C]=_.useState(null),[U,K]=_.useState(null),[J,H]=_.useState(!1),[$,F]=_.useState(!1),[Q,ce]=_.useState(!1),ve=X=>{const fe=typeof X=="string"?X:X.type;if(fe==="MOUNT_HORSE"&&!X.method){H(!0);return}if(fe==="OPEN_TAVERN_MENU"){F(!0);return}if(fe==="OPEN_WEAPON_RACK"){ce(!0);return}I(X)},de=async(X,fe)=>{if(!(!t||!i)){D(!0);try{const me=L(P,`simulation_rooms/${t}`),yt=n||i.uid;let Xt=Math.random()>.5?"region_ost":"region_vest";fe==="BARON"?Xt=`region_${yt}`:fe==="KING"&&(Xt="capital");const kn={id:yt,uid:i.uid,name:X,role:fe,regionId:Xt,resources:Lt[fe]||Lt.PEASANT,skills:Hn[fe]||Hn.PEASANT,stats:{xp:0,level:1,reputation:50,contribution:0},status:{hp:100,morale:100,stamina:50,legitimacy:100,authority:50,loyalty:100,isJailed:!1,isFrozen:!1},equipment:Up[fe]||Up.PEASANT,upgrades:[],lastActive:Date.now()},Gn={id:yt,uid:i.uid,name:X,role:fe,regionId:Xt,stats:{level:1},status:{isJailed:!1,isFrozen:!1,legitimacy:100},online:!0,lastActive:Date.now()},$t={};$t[`players/${yt}`]=kn,$t[`public_profiles/${yt}`]=Gn,await ne(me,$t)}catch(me){console.error("Failed to create player:",me),alert("Kunne ikke opprette karakter.")}finally{D(!1)}}},Ze=_.useMemo(()=>({status:p,world:b,players:g||{},messages:w||[],markets:x||{},market:(x&&(y!=null&&y.regionId)?x[y.regionId]:Object.values(x||{})[0])||{},diplomacy:k||{},trades:T||{},activeVote:S,worldEvents:N||{},regions:E||{},settings:"feudal_europe",pin:t||""}),[p,b,g,w,x,k,S,N,T,E,t]);return a||!j?o.jsxs("div",{className:"min-h-screen bg-slate-950 flex flex-col items-center justify-center gap-8 p-12",children:[o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"w-24 h-24 border-4 border-indigo-500/20 rounded-full"}),o.jsx("div",{className:"absolute inset-0 w-24 h-24 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"})]}),o.jsx("h2",{className:"text-2xl font-black italic text-white animate-pulse",children:"Kaller p ndene..."})]}):R?o.jsx("div",{className:"fixed inset-0 z-[100] bg-slate-950/90 backdrop-blur-xl flex items-center justify-center p-6 text-center",children:o.jsxs("div",{className:"max-w-md bg-slate-900 border-2 border-indigo-500/30 rounded-[3rem] p-12 space-y-8 shadow-2xl",children:[o.jsx(sc,{size:48,className:"text-white mx-auto animate-bounce"}),o.jsx("h2",{className:"text-4xl font-black italic text-white",children:"ET LIV ER OVER"}),o.jsx("button",{onClick:()=>s("/sim"),className:"w-full py-4 bg-indigo-600 text-white rounded-2xl font-black uppercase",children:"Tilbake til Lobby"})]})}):y?b?o.jsxs("div",{className:"relative min-h-screen bg-slate-900 text-white overflow-hidden flex flex-col",children:[o.jsx("div",{className:"flex-1 flex flex-col relative",children:o.jsxs("div",{className:"fixed inset-0 top-0 bg-slate-950 text-slate-200 flex overflow-hidden",children:[o.jsx("div",{className:"fixed inset-0 pointer-events-none opacity-20",children:o.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-indigo-600/20 blur-[120px] rounded-full animate-pulse"})}),!y.hasSeenIntro&&o.jsx(jF,{player:y,pin:t||"",onComplete:()=>{y.hasSeenIntro=!0}}),l&&o.jsx(L$,{type:l,player:y,playerUpgrades:y.upgrades,equipment:Object.values(y.equipment||{}),skills:y.skills,selectedMethod:f||void 0,action:u,onComplete:X=>I({...u||{},performance:X,method:f}),onCancel:()=>{c(null),d(null),h(null)},currentSeason:(b==null?void 0:b.season)||"Spring",currentWeather:(b==null?void 0:b.weather)||"Clear",totalTicks:(b==null?void 0:b.totalTicks)||0}),J&&o.jsx(NF,{player:y,onAction:I,onClose:()=>H(!1)}),$&&o.jsx(SF,{player:y,room:Ze,onAction:I,onClose:()=>F(!1)}),Q&&o.jsx(Q$,{player:y,onAction:I,onClose:()=>ce(!1)}),o.jsx(bF,{}),o.jsxs("div",{className:"flex flex-col h-full w-full overflow-hidden",children:[o.jsx(g$,{room:Ze,player:y,pin:t,onAction:ve}),o.jsx("main",{className:"flex-1 relative overflow-hidden bg-slate-950/50",children:o.jsx(xF,{player:y,room:Ze,pin:t,onAction:ve,actionResult:V,onClearActionResult:B})})]})]})}),M&&o.jsx(vF,{level:M.level,title:M.title,onClose:()=>C(null)}),o.jsx(IF,{pin:t||"",player:y,onOpenProfile:X=>{const fe=Ze.players[X];fe?K(fe):console.warn("Spiller ikke funnet i rommet:",X)}}),U&&o.jsx(MF,{isOpen:!0,onClose:()=>K(null),myPlayer:y,targetPlayer:U,pin:t||""})]}):o.jsxs("div",{className:"min-h-screen bg-slate-950 flex flex-col items-center justify-center gap-4 text-white",children:[o.jsx("div",{className:"w-12 h-12 border-4 border-indigo-500 border-t-white rounded-full animate-spin"}),o.jsx("p",{className:"text-sm font-bold uppercase tracking-widest text-indigo-400",children:"Laster verden..."})]}):o.jsx("div",{className:"min-h-screen bg-slate-950 flex items-center justify-center p-6",children:o.jsx(yF,{pin:t||"",account:r,onCreatePlayer:de,isCreating:O})})},LF=()=>o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[1,2,3,4].map(t=>o.jsx("div",{className:"h-36 bg-white/5 rounded-2xl animate-pulse border border-white/5 relative overflow-hidden",children:o.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent -translate-x-full animate-[shimmer_2s_infinite]"})},t))}),PF=({server:t,onClick:e})=>{const n={Spring:{color:"text-emerald-400",icon:UU,label:"Vr",bg:"group-hover:bg-emerald-500/10"},Summer:{color:"text-amber-400",icon:SH,label:"Sommer",bg:"group-hover:bg-amber-500/10"},Autumn:{color:"text-orange-400",icon:UH,label:"Hst",bg:"group-hover:bg-orange-500/10"},Winter:{color:"text-blue-400",icon:wH,label:"Vinter",bg:"group-hover:bg-blue-500/10"}},s=n[t.season]||n.Spring;return o.jsxs(he.button,{layout:!0,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},whileHover:{y:-4},onClick:e,className:`group relative overflow-hidden flex flex-col p-6 bg-white/5 border border-white/5 hover:border-white/20 rounded-2xl transition-all text-left shadow-xl ${s.bg}`,children:[o.jsxs("div",{className:"flex justify-between items-start mb-6 relative z-10",children:[o.jsxs("div",{className:"flex flex-col",children:[o.jsx("h3",{className:"text-lg font-black text-white group-hover:text-white transition-colors leading-tight truncate max-w-[200px]",children:t.name||`Rike #${t.pin}`}),o.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-black text-white/30 uppercase tracking-[0.2em] mt-1",children:[o.jsxs("span",{className:"px-1.5 py-0.5 bg-white/5 rounded",children:["PIN: ",t.pin]}),o.jsxs("span",{className:"opacity-50",children:["BY: ",t.hostName]})]})]}),o.jsx("div",{className:`p-2.5 rounded-xl bg-white/5 backdrop-blur-md border border-white/10 ${s.color} group-hover:scale-110 transition-transform`,children:o.jsx(s.icon,{size:20})})]}),o.jsxs("div",{className:"mt-auto flex items-center justify-between relative z-10",children:[o.jsxs("div",{className:"flex items-center gap-6",children:[o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:"text-[9px] uppercase tracking-[0.15em] text-white/20 font-black mb-1",children:"Live N"}),o.jsxs("div",{className:"flex items-center gap-1.5 text-white/80 font-black",children:[o.jsx(Cx,{size:14,className:"text-indigo-400"}),o.jsx("span",{className:"text-sm tabular-nums",children:t.playerCount||0})]})]}),o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:"text-[9px] uppercase tracking-[0.15em] text-white/20 font-black mb-1",children:"Tidsalder"}),o.jsxs("div",{className:"flex items-center gap-1.5 text-white/80 font-black",children:[o.jsx(lU,{size:14,className:"text-amber-500"}),o.jsxs("span",{className:"text-sm italic",children:[s.label," ",t.worldYear]})]})]})]}),o.jsxs("div",{className:"flex items-center gap-1 text-[10px] font-black uppercase tracking-wider text-white/10 group-hover:text-white transition-colors",children:["Join ",o.jsx(yr,{size:14})]})]}),o.jsx("div",{className:"absolute -bottom-6 -right-6 opacity-[0.02] group-hover:opacity-[0.05] transition-opacity",children:o.jsx(s.icon,{size:120})}),o.jsx("div",{className:"absolute inset-0 border-2 border-indigo-500/0 group-hover:border-indigo-500/20 rounded-2xl transition-all"})]})},BF=()=>{const[t,e]=_.useState([]),[n,s]=_.useState(!0),[i,r]=_.useState(""),a=ho();_.useEffect(()=>{const c=L(P,"simulation_server_metadata"),u=We(c,d=>{const f=d.val();if(f){const h=Object.values(f);e(h.filter(m=>m.isPublic&&(m.status==="LOBBY"||m.status==="PLAYING")).sort((m,v)=>v.lastUpdated-m.lastUpdated))}else e([]);s(!1)});return()=>u()},[]);const l=t.filter(c=>{var u;return c.pin.includes(i)||((u=c.name)==null?void 0:u.toLowerCase().includes(i.toLowerCase()))||c.hostName.toLowerCase().includes(i.toLowerCase())});return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"relative group",children:[o.jsx("div",{className:"absolute inset-0 bg-indigo-500/20 blur-xl opacity-0 group-focus-within:opacity-100 transition-opacity rounded-2xl"}),o.jsx(cH,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-white/40 group-focus-within:text-indigo-400 transition-colors",size:18}),o.jsx("input",{type:"text",placeholder:"Sk etter en verden  erobre...",value:i,onChange:c=>r(c.target.value),className:"relative w-full bg-white/5 border border-white/10 focus:border-indigo-500/50 rounded-2xl py-4 pl-12 pr-4 text-sm text-white placeholder:text-white/20 outline-none transition-all shadow-inner"})]}),o.jsx(Ln,{mode:"popLayout",children:n?o.jsx(he.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:o.jsx(LF,{})},"loading"):l.length===0?o.jsx(he.div,{initial:{opacity:0},animate:{opacity:1},className:"py-16 text-center border-2 border-white/5 border-dashed rounded-[2rem] bg-white/[0.02]",children:o.jsx("p",{className:"text-lg text-white/20 font-black italic uppercase tracking-widest",children:"Ingen riker funnet for sket."})},"empty"):o.jsx(he.div,{className:"grid grid-cols-1 md:grid-cols-2 gap-4",initial:"hidden",animate:"show",variants:{show:{transition:{staggerChildren:.05}}},children:l.map(c=>o.jsx(PF,{server:c,onClick:()=>a(`/play/${c.pin}`)},c.pin))},"list")})]})},UF=({isOpen:t,onClose:e,initialMode:n="REGISTER"})=>{const{login:s,register:i,resetPassword:r,checkNameAvailability:a,error:l}=Cf(),[c,u]=_.useState(n),[d,f]=_.useState(""),[h,m]=_.useState(""),[v,y]=_.useState(""),[b,g]=_.useState(!1),[p,x]=_.useState(null),[w,k]=_.useState(null),[S,N]=_.useState(null),[T,E]=_.useState(!1);if(_.useEffect(()=>{if(c!=="REGISTER"||v.length<3){N(null);return}const R=setTimeout(async()=>{E(!0);try{const I=await a(v);N(I)}catch(I){console.error(I)}finally{E(!1)}},500);return()=>clearTimeout(R)},[v,c,a]),!t)return null;const j=async R=>{R.preventDefault(),x(null),k(null),g(!0);try{if(c==="LOGIN")await s(d,h),e();else if(c==="REGISTER"){if(S===!1)throw new Error("Navnet er allerede tatt.");await i(d,h,v),e()}else c==="FORGOT"&&(await r(d),k("E-post for tilbakestilling er sendt!"))}catch(I){x(I.message||"Noe gikk galt. Vennligst prv igjen.")}finally{g(!1)}};return o.jsxs("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center p-4",children:[o.jsx("div",{className:"absolute inset-0 bg-slate-950/80 backdrop-blur-sm",onClick:e}),o.jsxs("div",{className:"relative w-full max-w-md bg-slate-900 border border-white/10 rounded-[2.5rem] shadow-2xl overflow-hidden animate-in fade-in zoom-in duration-300",children:[o.jsx("div",{className:"bg-indigo-600 h-2 w-full"}),o.jsxs("div",{className:"p-8 space-y-8",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-3xl font-black italic text-white tracking-tighter uppercase",children:c==="LOGIN"?"Velkommen tilbake":c==="REGISTER"?"Opprett Profil":"Glemt Passord"}),o.jsx("p",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mt-1",children:c==="LOGIN"?"Fortsett din reise i simulation":"Bli en del av historien"})]}),o.jsx("button",{onClick:e,className:"p-2 hover:bg-white/5 rounded-xl transition-colors",children:o.jsx(us,{className:"text-slate-500",size:20})})]}),o.jsxs("form",{onSubmit:j,className:"space-y-4",children:[c==="REGISTER"&&o.jsxs("div",{className:"space-y-1.5",children:[o.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"Vises som (Unikt navn)"}),o.jsxs("div",{className:"relative group",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:o.jsx(_r,{size:18,className:"text-slate-600 group-focus-within:text-indigo-400 transition-colors"})}),o.jsx("input",{type:"text",required:!0,placeholder:"Ditt kallenavn...",className:"w-full bg-slate-950/50 border border-white/5 focus:border-indigo-500/50 rounded-2xl py-3.5 pl-11 pr-4 text-white outline-none transition-all",value:v,onChange:R=>y(R.target.value)}),o.jsx("div",{className:"absolute inset-y-0 right-0 pr-4 flex items-center",children:T?o.jsx(J1,{size:16,className:"text-slate-500 animate-spin"}):S===!0?o.jsx(zp,{size:16,className:"text-emerald-500"}):S===!1?o.jsx(Hp,{size:16,className:"text-rose-500"}):null})]}),S===!1&&o.jsx("p",{className:"text-[10px] text-rose-400 font-bold px-1 italic",children:"Dette navnet er dessverre opptatt."})]}),o.jsxs("div",{className:"space-y-1.5",children:[o.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"E-post"}),o.jsxs("div",{className:"relative group",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:o.jsx(FU,{size:18,className:"text-slate-600 group-focus-within:text-indigo-400 transition-colors"})}),o.jsx("input",{type:"email",required:!0,placeholder:"navn@epost.no",className:"w-full bg-slate-950/50 border border-white/5 focus:border-indigo-500/50 rounded-2xl py-3.5 pl-11 pr-4 text-white outline-none transition-all",value:d,onChange:R=>f(R.target.value)})]})]}),c!=="FORGOT"&&o.jsxs("div",{className:"space-y-1.5",children:[o.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"Passord"}),o.jsxs("div",{className:"relative group",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:o.jsx(no,{size:18,className:"text-slate-600 group-focus-within:text-indigo-400 transition-colors"})}),o.jsx("input",{type:"password",required:!0,placeholder:"Min. 8 tegn...",className:"w-full bg-slate-950/50 border border-white/5 focus:border-indigo-500/50 rounded-2xl py-3.5 pl-11 pr-4 text-white outline-none transition-all",value:h,onChange:R=>m(R.target.value)})]})]}),(p||l)&&o.jsxs("div",{className:"bg-rose-500/10 border border-rose-500/20 p-4 rounded-2xl flex items-center gap-3 text-rose-400",children:[o.jsx(Hp,{size:18}),o.jsx("p",{className:"text-xs font-bold",children:p||l})]}),w&&o.jsxs("div",{className:"bg-emerald-500/10 border border-emerald-500/20 p-4 rounded-2xl flex items-center gap-3 text-emerald-400",children:[o.jsx(zp,{size:18}),o.jsx("p",{className:"text-xs font-bold",children:w})]}),o.jsxs("div",{className:"pt-4 space-y-4",children:[o.jsx("button",{type:"submit",disabled:b||c==="REGISTER"&&S===!1,className:"w-full bg-indigo-600 hover:bg-indigo-500 disabled:bg-slate-800 disabled:text-slate-500 text-white rounded-2xl py-4 font-black uppercase tracking-widest text-sm flex items-center justify-center gap-2 transition-all active:scale-95 shadow-lg shadow-indigo-600/20",children:b?o.jsx(J1,{className:"animate-spin",size:20}):o.jsxs(o.Fragment,{children:[c==="LOGIN"?"Logg Inn":c==="REGISTER"?"Opprett Profil":"Send E-post",o.jsx(yr,{size:18})]})}),o.jsx("div",{className:"flex items-center justify-between px-2",children:c==="LOGIN"?o.jsxs(o.Fragment,{children:[o.jsx("button",{type:"button",onClick:()=>u("REGISTER"),className:"text-[10px] font-black text-indigo-400 uppercase tracking-widest hover:text-white transition-colors",children:"Ny her? Opprett profil"}),o.jsx("button",{type:"button",onClick:()=>u("FORGOT"),className:"text-[10px] font-medium text-slate-500 hover:text-white transition-colors",children:"Glemt passord?"})]}):o.jsx("button",{type:"button",onClick:()=>u("LOGIN"),className:"w-full text-center text-[10px] font-black text-indigo-400 uppercase tracking-widest hover:text-white transition-colors",children:"Har du allerede profil? Logg inn"})})]})]})]})]})]})},HF=()=>{const{user:t,isAnonymous:e,logout:n}=Cf(),[s,i]=_.useState(!1),[r,a]=_.useState("LOGIN"),l=ho(),{startPlaylist:c,resume:u}=Kg(),[d,f]=_.useState(!1),[h,m]=_.useState(0);_.useEffect(()=>{const b=L(P,"simulation_server_metadata"),g=We(b,p=>{if(p.exists()){const x=p.val(),w=Object.values(x).reduce((k,S)=>k+(S.playerCount||0),0);m(w)}});return()=>g()},[]),_.useEffect(()=>{c()},[c]);const v=()=>{d||(u(),c(),f(!0))},y=b=>{v(),a(b),i(!0)};return o.jsxs("div",{onClick:v,className:"min-h-screen relative font-sans text-slate-200 overflow-x-hidden",children:[o.jsxs("div",{className:"absolute inset-0 z-0",children:[o.jsx("img",{src:"/Simulation_StandAlone_Pro/makthjulet_landingpage_bakgrunn.png",alt:"Background",className:"w-full h-full object-cover"}),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-950 via-slate-950/60 to-transparent"}),o.jsx("div",{className:"absolute inset-0 bg-black/40"})]}),o.jsxs("div",{className:"relative z-10 flex flex-col min-h-screen",children:[o.jsxs("header",{className:"w-full px-8 py-8 flex justify-between items-center",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Lc,{className:"text-white/90",size:24,strokeWidth:1.5}),o.jsx("span",{className:"text-sm font-black tracking-[0.2em] text-white/90 uppercase",children:"Simuleringshallen"})]}),o.jsx("div",{className:"flex items-center gap-6 text-xs font-bold tracking-widest uppercase",children:t&&!e?o.jsxs("div",{className:"flex items-center gap-6",children:[o.jsxs("span",{className:"text-white/70",children:["Velkommen, ",o.jsx("span",{className:"text-white",children:t.displayName})]}),o.jsx("button",{onClick:()=>n(),className:"hover:text-amber-400 transition-colors",children:"Logg ut"})]}):o.jsxs("div",{className:"flex items-center gap-6",children:[o.jsx("button",{onClick:()=>y("LOGIN"),className:"hover:text-white transition-colors text-white/70",children:"Logg Inn"}),o.jsx("button",{onClick:()=>y("REGISTER"),className:"px-5 py-2 bg-white/10 hover:bg-white/20 backdrop-blur-sm border border-white/20 rounded-full transition-all text-white",children:"Bli Med"})]})})]}),o.jsxs("main",{className:"flex-1 flex flex-col items-center justify-center w-full max-w-7xl mx-auto px-6 py-12",children:[o.jsxs("div",{className:"text-center mb-16 space-y-6 max-w-3xl",children:[o.jsx("h1",{className:"text-7xl md:text-9xl font-black text-white tracking-tighter leading-none drop-shadow-2xl",children:"MAKTHJULET"}),o.jsx("p",{className:"text-lg md:text-xl text-white/80 font-light tracking-wide max-w-xl mx-auto leading-relaxed",children:"Skjebnen er ikke skrevet. Den smis i ilden av ambisjoner."})]}),o.jsxs("div",{className:"w-full max-w-5xl bg-black/40 backdrop-blur-3xl border border-white/10 rounded-[2.5rem] p-4 md:p-10 shadow-2xl relative overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 opacity-[0.03] pointer-events-none bg-[url('https://grainy-gradients.vercel.app/noise.svg')] bg-repeat"}),o.jsxs("div",{className:"relative z-10",children:[o.jsxs("div",{className:"mb-8 flex items-center justify-between border-b border-white/5 pb-6",children:[o.jsxs("h3",{className:"text-[10px] font-black tracking-[0.3em] text-white/40 uppercase flex items-center gap-3",children:[o.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500 shadow-[0_0_10px_rgba(16,185,129,0.5)]"}),"Aktive Verdener"]}),o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("div",{className:"flex -space-x-1.5 items-center mr-1",children:[[...Array(Math.min(3,h))].map((b,g)=>o.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-slate-900 bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.3)]"},g)),h>3&&o.jsxs("div",{className:"w-5 h-5 rounded-full border-2 border-slate-900 bg-slate-800 flex items-center justify-center text-[8px] font-black text-white/60",children:["+",h-3]}),h===0&&o.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-slate-800 bg-slate-900/50"})]}),o.jsxs("span",{className:"text-[10px] text-white/40 uppercase font-black tracking-widest",children:[h," Live N"]})]})]}),o.jsx("div",{className:"max-h-[500px] overflow-y-auto custom-scrollbar pr-2",children:o.jsx(BF,{})})]})]})]}),o.jsxs("footer",{className:"w-full p-8 relative flex justify-center text-[10px] uppercase tracking-[0.2em] text-white/30",children:[o.jsx("span",{children:" 2026 Eiriksbok  Maktens Pris"}),o.jsx("button",{onClick:()=>l("/host"),className:"absolute right-8 bottom-8 text-white/10 hover:text-white/50 transition-colors duration-500 font-bold",children:"Admin"})]})]}),o.jsx(UF,{isOpen:s,onClose:()=>i(!1),initialMode:r})]})},GF=()=>o.jsx(MR,{basename:"/Simulation_StandAlone_Pro/",children:o.jsx(LR,{children:o.jsx(fL,{children:o.jsx(mL,{children:o.jsx("div",{className:"min-h-screen bg-slate-950 text-white",children:o.jsxs(RR,{children:[o.jsx(Fo,{path:"/",element:o.jsx(HF,{})}),o.jsx(Fo,{path:"/host",element:o.jsx(m$,{})}),o.jsx(Fo,{path:"/play/:pin/*",element:o.jsx(pL,{children:o.jsx(DF,{})})}),o.jsx(Fo,{path:"*",element:o.jsx(AR,{to:"/",replace:!0})})]})})})})})});class $F extends Ge.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,n){console.error("Uncaught error:",e,n)}render(){var e,n,s,i,r,a,l;if(this.state.hasError){const c=((e=this.state.error)==null?void 0:e.name)==="TypeError"&&(((s=(n=this.state.error)==null?void 0:n.message)==null?void 0:s.toLowerCase().includes("failed to fetch dynamically imported module"))||((r=(i=this.state.error)==null?void 0:i.message)==null?void 0:r.toLowerCase().includes("loading chunk"))||((l=(a=this.state.error)==null?void 0:a.message)==null?void 0:l.toLowerCase().includes("dynamic import")));return o.jsx("div",{style:{padding:"2rem",backgroundColor:"#0f172a",color:"#f8fafc",height:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",fontFamily:"Inter, system-ui, sans-serif",textAlign:"center"},children:o.jsxs("div",{style:{maxWidth:"600px",padding:"3rem",backgroundColor:"#1e293b",borderRadius:"2rem",border:"1px solid rgba(255,255,255,0.1)",boxShadow:"0 25px 50px -12px rgba(0,0,0,0.5)"},children:[o.jsx("div",{style:{fontSize:"4rem",marginBottom:"1rem"},children:""}),o.jsx("h1",{style:{fontSize:"2rem",fontWeight:"900",marginBottom:"1rem",color:"#ef4444"},children:c?"Applikasjonen m oppdateres":"Noe gikk galt"}),o.jsx("p",{style:{color:"#94a3b8",marginBottom:"2rem",fontSize:"1.1rem"},children:c?"En ny versjon av simulatoren er tilgjengelig. Trykk p knappen under for  laste inn p nytt.":"Det oppstod en uventet feil i simuleringshallen."}),o.jsx("button",{onClick:()=>window.location.reload(),style:{padding:"1rem 2rem",backgroundColor:"#4f46e5",color:"white",border:"none",borderRadius:"1rem",fontWeight:"bold",fontSize:"1rem",cursor:"pointer",transition:"all 0.2s",boxShadow:"0 10px 15px -3px rgba(79, 70, 229, 0.4)"},onMouseOver:u=>u.currentTarget.style.backgroundColor="#4338ca",onMouseOut:u=>u.currentTarget.style.backgroundColor="#4f46e5",children:"Oppdater applikasjonen"}),o.jsxs("details",{style:{marginTop:"2rem",textAlign:"left"},children:[o.jsx("summary",{style:{cursor:"pointer",color:"#64748b",fontSize:"0.8rem"},children:"Teknisk feilinfo"}),o.jsx("pre",{style:{marginTop:"1rem",padding:"1rem",backgroundColor:"#0f172a",borderRadius:"0.5rem",fontSize:"0.75rem",overflowX:"auto",color:"#ef4444",whiteSpace:"pre-wrap"},children:this.state.error&&this.state.error.toString()+`

`+this.state.error.stack})]})]})})}return this.props.children}}Bj.createRoot(document.getElementById("root")).render(o.jsx(Ge.StrictMode,{children:o.jsx($F,{children:o.jsx(GF,{})})}));export{MF as $,Dc as A,YF as B,Bn as C,wN as D,KF as E,WF as F,ee as G,$d as H,XF as I,qF as J,oH as K,Hd as L,nc as M,jA as N,Ca as O,P$ as P,VF as Q,Fi as R,zi as S,Vp as T,_r as U,Kt as V,Cx as W,cH as X,Lc as Y,$H as Z,jx as _,Rt as a,Oe as a0,tH as a1,c2 as a2,us as a3,zn as a4,yr as a5,Bp as a6,wA as a7,Ge as b,ne as c,VB as d,KB as e,fH as f,vA as g,Z as h,_ as i,o as j,zB as k,no as l,he as m,zd as n,G$ as o,qp as p,Fd as q,L as r,P as s,Ix as t,ql as u,Kg as v,DH as w,QU as x,Ln as y,mH as z};
