const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SimulationMarket-D4oBpirc.js","assets/GameCard-DIyDmkk_.js","assets/GameButton-BT2Pulpy.js","assets/Badge-DiAIQs7J.js","assets/SimulationVault-DI9W4Bla.js","assets/timer-Bn9Aip22.js","assets/SimulationSkills-TfYljZy_.js","assets/chevron-right-kyp9E5aj.js","assets/SimulationProduction-D-_Sl8TO.js","assets/SimulationHierarchy-gllXnqL0.js","assets/PoliticalHub-CeVKIVtE.js","assets/SimulationProfile-BzI8BOrX.js","assets/SimulationWarRoom-Dmb0uPmy.js","assets/SiegeEngine-Xf9pdUjs.js"])))=>i.map(i=>d[i]);
var pA=Object.defineProperty;var gA=(t,e,n)=>e in t?pA(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var ze=(t,e,n)=>gA(t,typeof e!="symbol"?e+"":e,n);function vA(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const i in s)if(i!=="default"&&!(i in t)){const r=Object.getOwnPropertyDescriptor(s,i);r&&Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:()=>s[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();function V_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var F_={exports:{}},Ad={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bA=Symbol.for("react.transitional.element"),xA=Symbol.for("react.fragment");function z_(t,e,n){var s=null;if(n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),"key"in e){n={};for(var i in e)i!=="key"&&(n[i]=e[i])}else n=e;return e=n.ref,{$$typeof:bA,type:t,key:s,ref:e!==void 0?e:null,props:n}}Ad.Fragment=xA;Ad.jsx=z_;Ad.jsxs=z_;F_.exports=Ad;var l=F_.exports,$_={exports:{}},le={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mp=Symbol.for("react.transitional.element"),yA=Symbol.for("react.portal"),_A=Symbol.for("react.fragment"),wA=Symbol.for("react.strict_mode"),EA=Symbol.for("react.profiler"),NA=Symbol.for("react.consumer"),kA=Symbol.for("react.context"),SA=Symbol.for("react.forward_ref"),TA=Symbol.for("react.suspense"),AA=Symbol.for("react.memo"),K_=Symbol.for("react.lazy"),RA=Symbol.for("react.activity"),vv=Symbol.iterator;function IA(t){return t===null||typeof t!="object"?null:(t=vv&&t[vv]||t["@@iterator"],typeof t=="function"?t:null)}var Y_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},q_=Object.assign,W_={};function Va(t,e,n){this.props=t,this.context=e,this.refs=W_,this.updater=n||Y_}Va.prototype.isReactComponent={};Va.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Va.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function X_(){}X_.prototype=Va.prototype;function Dp(t,e,n){this.props=t,this.context=e,this.refs=W_,this.updater=n||Y_}var Lp=Dp.prototype=new X_;Lp.constructor=Dp;q_(Lp,Va.prototype);Lp.isPureReactComponent=!0;var bv=Array.isArray;function Lh(){}var Ve={H:null,A:null,T:null,S:null},Q_=Object.prototype.hasOwnProperty;function Pp(t,e,n){var s=n.ref;return{$$typeof:Mp,type:t,key:e,ref:s!==void 0?s:null,props:n}}function CA(t,e){return Pp(t.type,e,t.props)}function Bp(t){return typeof t=="object"&&t!==null&&t.$$typeof===Mp}function jA(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var xv=/\/+/g;function Ef(t,e){return typeof t=="object"&&t!==null&&t.key!=null?jA(""+t.key):e.toString(36)}function OA(t){switch(t.status){case"fulfilled":return t.value;case"rejected":throw t.reason;default:switch(typeof t.status=="string"?t.then(Lh,Lh):(t.status="pending",t.then(function(e){t.status==="pending"&&(t.status="fulfilled",t.value=e)},function(e){t.status==="pending"&&(t.status="rejected",t.reason=e)})),t.status){case"fulfilled":return t.value;case"rejected":throw t.reason}}throw t}function Pr(t,e,n,s,i){var r=typeof t;(r==="undefined"||r==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(r){case"bigint":case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Mp:case yA:a=!0;break;case K_:return a=t._init,Pr(a(t._payload),e,n,s,i)}}if(a)return i=i(t),a=s===""?"."+Ef(t,0):s,bv(i)?(n="",a!=null&&(n=a.replace(xv,"$&/")+"/"),Pr(i,e,n,"",function(u){return u})):i!=null&&(Bp(i)&&(i=CA(i,n+(i.key==null||t&&t.key===i.key?"":(""+i.key).replace(xv,"$&/")+"/")+a)),e.push(i)),1;a=0;var o=s===""?".":s+":";if(bv(t))for(var c=0;c<t.length;c++)s=t[c],r=o+Ef(s,c),a+=Pr(s,e,n,r,i);else if(c=IA(t),typeof c=="function")for(t=c.call(t),c=0;!(s=t.next()).done;)s=s.value,r=o+Ef(s,c++),a+=Pr(s,e,n,r,i);else if(r==="object"){if(typeof t.then=="function")return Pr(OA(t),e,n,s,i);throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.")}return a}function _c(t,e,n){if(t==null)return t;var s=[],i=0;return Pr(t,s,"","",function(r){return e.call(n,r,i++)}),s}function MA(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var yv=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},DA={map:_c,forEach:function(t,e,n){_c(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return _c(t,function(){e++}),e},toArray:function(t){return _c(t,function(e){return e})||[]},only:function(t){if(!Bp(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};le.Activity=RA;le.Children=DA;le.Component=Va;le.Fragment=_A;le.Profiler=EA;le.PureComponent=Dp;le.StrictMode=wA;le.Suspense=TA;le.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Ve;le.__COMPILER_RUNTIME={__proto__:null,c:function(t){return Ve.H.useMemoCache(t)}};le.cache=function(t){return function(){return t.apply(null,arguments)}};le.cacheSignal=function(){return null};le.cloneElement=function(t,e,n){if(t==null)throw Error("The argument must be a React element, but you passed "+t+".");var s=q_({},t.props),i=t.key;if(e!=null)for(r in e.key!==void 0&&(i=""+e.key),e)!Q_.call(e,r)||r==="key"||r==="__self"||r==="__source"||r==="ref"&&e.ref===void 0||(s[r]=e[r]);var r=arguments.length-2;if(r===1)s.children=n;else if(1<r){for(var a=Array(r),o=0;o<r;o++)a[o]=arguments[o+2];s.children=a}return Pp(t.type,i,s)};le.createContext=function(t){return t={$$typeof:kA,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null},t.Provider=t,t.Consumer={$$typeof:NA,_context:t},t};le.createElement=function(t,e,n){var s,i={},r=null;if(e!=null)for(s in e.key!==void 0&&(r=""+e.key),e)Q_.call(e,s)&&s!=="key"&&s!=="__self"&&s!=="__source"&&(i[s]=e[s]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var o=Array(a),c=0;c<a;c++)o[c]=arguments[c+2];i.children=o}if(t&&t.defaultProps)for(s in a=t.defaultProps,a)i[s]===void 0&&(i[s]=a[s]);return Pp(t,r,i)};le.createRef=function(){return{current:null}};le.forwardRef=function(t){return{$$typeof:SA,render:t}};le.isValidElement=Bp;le.lazy=function(t){return{$$typeof:K_,_payload:{_status:-1,_result:t},_init:MA}};le.memo=function(t,e){return{$$typeof:AA,type:t,compare:e===void 0?null:e}};le.startTransition=function(t){var e=Ve.T,n={};Ve.T=n;try{var s=t(),i=Ve.S;i!==null&&i(n,s),typeof s=="object"&&s!==null&&typeof s.then=="function"&&s.then(Lh,yv)}catch(r){yv(r)}finally{e!==null&&n.types!==null&&(e.types=n.types),Ve.T=e}};le.unstable_useCacheRefresh=function(){return Ve.H.useCacheRefresh()};le.use=function(t){return Ve.H.use(t)};le.useActionState=function(t,e,n){return Ve.H.useActionState(t,e,n)};le.useCallback=function(t,e){return Ve.H.useCallback(t,e)};le.useContext=function(t){return Ve.H.useContext(t)};le.useDebugValue=function(){};le.useDeferredValue=function(t,e){return Ve.H.useDeferredValue(t,e)};le.useEffect=function(t,e){return Ve.H.useEffect(t,e)};le.useEffectEvent=function(t){return Ve.H.useEffectEvent(t)};le.useId=function(){return Ve.H.useId()};le.useImperativeHandle=function(t,e,n){return Ve.H.useImperativeHandle(t,e,n)};le.useInsertionEffect=function(t,e){return Ve.H.useInsertionEffect(t,e)};le.useLayoutEffect=function(t,e){return Ve.H.useLayoutEffect(t,e)};le.useMemo=function(t,e){return Ve.H.useMemo(t,e)};le.useOptimistic=function(t,e){return Ve.H.useOptimistic(t,e)};le.useReducer=function(t,e,n){return Ve.H.useReducer(t,e,n)};le.useRef=function(t){return Ve.H.useRef(t)};le.useState=function(t){return Ve.H.useState(t)};le.useSyncExternalStore=function(t,e,n){return Ve.H.useSyncExternalStore(t,e,n)};le.useTransition=function(){return Ve.H.useTransition()};le.version="19.2.3";$_.exports=le;var _=$_.exports;const we=V_(_),LA=vA({__proto__:null,default:we},[_]);var J_={exports:{}},Rd={},Z_={exports:{}},e1={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(U,O){var j=U.length;U.push(O);e:for(;0<j;){var I=j-1>>>1,H=U[I];if(0<i(H,O))U[I]=O,U[j]=H,j=I;else break e}}function n(U){return U.length===0?null:U[0]}function s(U){if(U.length===0)return null;var O=U[0],j=U.pop();if(j!==O){U[0]=j;e:for(var I=0,H=U.length,X=H>>>1;I<X;){var oe=2*(I+1)-1,Ie=U[oe],V=oe+1,me=U[V];if(0>i(Ie,j))V<H&&0>i(me,Ie)?(U[I]=me,U[V]=j,I=V):(U[I]=Ie,U[oe]=j,I=oe);else if(V<H&&0>i(me,j))U[I]=me,U[V]=j,I=V;else break e}}return O}function i(U,O){var j=U.sortIndex-O.sortIndex;return j!==0?j:U.id-O.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;t.unstable_now=function(){return r.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var c=[],u=[],d=1,f=null,h=3,m=!1,g=!1,b=!1,x=!1,p=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;function E(U){for(var O=n(u);O!==null;){if(O.callback===null)s(u);else if(O.startTime<=U)s(u),O.sortIndex=O.expirationTime,e(c,O);else break;O=n(u)}}function N(U){if(b=!1,E(U),!g)if(n(c)!==null)g=!0,T||(T=!0,B());else{var O=n(u);O!==null&&K(N,O.startTime-U)}}var T=!1,w=-1,A=5,k=-1;function R(){return x?!0:!(t.unstable_now()-k<A)}function C(){if(x=!1,T){var U=t.unstable_now();k=U;var O=!0;try{e:{g=!1,b&&(b=!1,v(w),w=-1),m=!0;var j=h;try{t:{for(E(U),f=n(c);f!==null&&!(f.expirationTime>U&&R());){var I=f.callback;if(typeof I=="function"){f.callback=null,h=f.priorityLevel;var H=I(f.expirationTime<=U);if(U=t.unstable_now(),typeof H=="function"){f.callback=H,E(U),O=!0;break t}f===n(c)&&s(c),E(U)}else s(c);f=n(c)}if(f!==null)O=!0;else{var X=n(u);X!==null&&K(N,X.startTime-U),O=!1}}break e}finally{f=null,h=j,m=!1}O=void 0}}finally{O?B():T=!1}}}var B;if(typeof y=="function")B=function(){y(C)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,$=z.port2;z.port1.onmessage=C,B=function(){$.postMessage(null)}}else B=function(){p(C,0)};function K(U,O){w=p(function(){U(t.unstable_now())},O)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(U){U.callback=null},t.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<U?Math.floor(1e3/U):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_next=function(U){switch(h){case 1:case 2:case 3:var O=3;break;default:O=h}var j=h;h=O;try{return U()}finally{h=j}},t.unstable_requestPaint=function(){x=!0},t.unstable_runWithPriority=function(U,O){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var j=h;h=U;try{return O()}finally{h=j}},t.unstable_scheduleCallback=function(U,O,j){var I=t.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?I+j:I):j=I,U){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=j+H,U={id:d++,callback:O,priorityLevel:U,startTime:j,expirationTime:H,sortIndex:-1},j>I?(U.sortIndex=j,e(u,U),n(c)===null&&U===n(u)&&(b?(v(w),w=-1):b=!0,K(N,j-I))):(U.sortIndex=H,e(c,U),g||m||(g=!0,T||(T=!0,B()))),U},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(U){var O=h;return function(){var j=h;h=O;try{return U.apply(this,arguments)}finally{h=j}}}})(e1);Z_.exports=e1;var PA=Z_.exports,t1={exports:{}},Ft={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BA=_;function n1(t){var e="https://react.dev/errors/"+t;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Vs(){}var Lt={d:{f:Vs,r:function(){throw Error(n1(522))},D:Vs,C:Vs,L:Vs,m:Vs,X:Vs,S:Vs,M:Vs},p:0,findDOMNode:null},UA=Symbol.for("react.portal");function HA(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:UA,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}var jo=BA.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function Id(t,e){if(t==="font")return"";if(typeof e=="string")return e==="use-credentials"?e:""}Ft.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Lt;Ft.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)throw Error(n1(299));return HA(t,e,null,n)};Ft.flushSync=function(t){var e=jo.T,n=Lt.p;try{if(jo.T=null,Lt.p=2,t)return t()}finally{jo.T=e,Lt.p=n,Lt.d.f()}};Ft.preconnect=function(t,e){typeof t=="string"&&(e?(e=e.crossOrigin,e=typeof e=="string"?e==="use-credentials"?e:"":void 0):e=null,Lt.d.C(t,e))};Ft.prefetchDNS=function(t){typeof t=="string"&&Lt.d.D(t)};Ft.preinit=function(t,e){if(typeof t=="string"&&e&&typeof e.as=="string"){var n=e.as,s=Id(n,e.crossOrigin),i=typeof e.integrity=="string"?e.integrity:void 0,r=typeof e.fetchPriority=="string"?e.fetchPriority:void 0;n==="style"?Lt.d.S(t,typeof e.precedence=="string"?e.precedence:void 0,{crossOrigin:s,integrity:i,fetchPriority:r}):n==="script"&&Lt.d.X(t,{crossOrigin:s,integrity:i,fetchPriority:r,nonce:typeof e.nonce=="string"?e.nonce:void 0})}};Ft.preinitModule=function(t,e){if(typeof t=="string")if(typeof e=="object"&&e!==null){if(e.as==null||e.as==="script"){var n=Id(e.as,e.crossOrigin);Lt.d.M(t,{crossOrigin:n,integrity:typeof e.integrity=="string"?e.integrity:void 0,nonce:typeof e.nonce=="string"?e.nonce:void 0})}}else e==null&&Lt.d.M(t)};Ft.preload=function(t,e){if(typeof t=="string"&&typeof e=="object"&&e!==null&&typeof e.as=="string"){var n=e.as,s=Id(n,e.crossOrigin);Lt.d.L(t,n,{crossOrigin:s,integrity:typeof e.integrity=="string"?e.integrity:void 0,nonce:typeof e.nonce=="string"?e.nonce:void 0,type:typeof e.type=="string"?e.type:void 0,fetchPriority:typeof e.fetchPriority=="string"?e.fetchPriority:void 0,referrerPolicy:typeof e.referrerPolicy=="string"?e.referrerPolicy:void 0,imageSrcSet:typeof e.imageSrcSet=="string"?e.imageSrcSet:void 0,imageSizes:typeof e.imageSizes=="string"?e.imageSizes:void 0,media:typeof e.media=="string"?e.media:void 0})}};Ft.preloadModule=function(t,e){if(typeof t=="string")if(e){var n=Id(e.as,e.crossOrigin);Lt.d.m(t,{as:typeof e.as=="string"&&e.as!=="script"?e.as:void 0,crossOrigin:n,integrity:typeof e.integrity=="string"?e.integrity:void 0})}else Lt.d.m(t)};Ft.requestFormReset=function(t){Lt.d.r(t)};Ft.unstable_batchedUpdates=function(t,e){return t(e)};Ft.useFormState=function(t,e,n){return jo.H.useFormState(t,e,n)};Ft.useFormStatus=function(){return jo.H.useHostTransitionStatus()};Ft.version="19.2.3";function s1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s1)}catch(t){console.error(t)}}s1(),t1.exports=Ft;var GA=t1.exports;/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pt=PA,i1=_,VA=GA;function P(t){var e="https://react.dev/errors/"+t;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Ul(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function a1(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function o1(t){if(t.tag===31){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function _v(t){if(Ul(t)!==t)throw Error(P(188))}function FA(t){var e=t.alternate;if(!e){if(e=Ul(t),e===null)throw Error(P(188));return e!==t?null:t}for(var n=t,s=e;;){var i=n.return;if(i===null)break;var r=i.alternate;if(r===null){if(s=i.return,s!==null){n=s;continue}break}if(i.child===r.child){for(r=i.child;r;){if(r===n)return _v(i),t;if(r===s)return _v(i),e;r=r.sibling}throw Error(P(188))}if(n.return!==s.return)n=i,s=r;else{for(var a=!1,o=i.child;o;){if(o===n){a=!0,n=i,s=r;break}if(o===s){a=!0,s=i,n=r;break}o=o.sibling}if(!a){for(o=r.child;o;){if(o===n){a=!0,n=r,s=i;break}if(o===s){a=!0,s=r,n=i;break}o=o.sibling}if(!a)throw Error(P(189))}}if(n.alternate!==s)throw Error(P(190))}if(n.tag!==3)throw Error(P(188));return n.stateNode.current===n?t:e}function l1(t){var e=t.tag;if(e===5||e===26||e===27||e===6)return t;for(t=t.child;t!==null;){if(e=l1(t),e!==null)return e;t=t.sibling}return null}var Fe=Object.assign,zA=Symbol.for("react.element"),wc=Symbol.for("react.transitional.element"),Eo=Symbol.for("react.portal"),Hr=Symbol.for("react.fragment"),c1=Symbol.for("react.strict_mode"),Ph=Symbol.for("react.profiler"),u1=Symbol.for("react.consumer"),ps=Symbol.for("react.context"),Up=Symbol.for("react.forward_ref"),Bh=Symbol.for("react.suspense"),Uh=Symbol.for("react.suspense_list"),Hp=Symbol.for("react.memo"),$s=Symbol.for("react.lazy"),Hh=Symbol.for("react.activity"),$A=Symbol.for("react.memo_cache_sentinel"),wv=Symbol.iterator;function uo(t){return t===null||typeof t!="object"?null:(t=wv&&t[wv]||t["@@iterator"],typeof t=="function"?t:null)}var KA=Symbol.for("react.client.reference");function Gh(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===KA?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Hr:return"Fragment";case Ph:return"Profiler";case c1:return"StrictMode";case Bh:return"Suspense";case Uh:return"SuspenseList";case Hh:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case Eo:return"Portal";case ps:return t.displayName||"Context";case u1:return(t._context.displayName||"Context")+".Consumer";case Up:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Hp:return e=t.displayName||null,e!==null?e:Gh(t.type)||"Memo";case $s:e=t._payload,t=t._init;try{return Gh(t(e))}catch{}}return null}var No=Array.isArray,ie=i1.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ne=VA.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,tr={pending:!1,data:null,method:null,action:null},Vh=[],Gr=-1;function is(t){return{current:t}}function wt(t){0>Gr||(t.current=Vh[Gr],Vh[Gr]=null,Gr--)}function Be(t,e){Gr++,Vh[Gr]=t.current,t.current=e}var Jn=is(null),sl=is(null),ci=is(null),bu=is(null);function xu(t,e){switch(Be(ci,e),Be(sl,t),Be(Jn,null),e.nodeType){case 9:case 11:t=(t=e.documentElement)&&(t=t.namespaceURI)?Ab(t):0;break;default:if(t=e.tagName,e=e.namespaceURI)e=Ab(e),t=IE(e,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}wt(Jn),Be(Jn,t)}function ya(){wt(Jn),wt(sl),wt(ci)}function Fh(t){t.memoizedState!==null&&Be(bu,t);var e=Jn.current,n=IE(e,t.type);e!==n&&(Be(sl,t),Be(Jn,n))}function yu(t){sl.current===t&&(wt(Jn),wt(sl)),bu.current===t&&(wt(bu),ml._currentValue=tr)}var Nf,Ev;function zi(t){if(Nf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Nf=e&&e[1]||"",Ev=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Nf+t+Ev}var kf=!1;function Sf(t,e){if(!t||kf)return"";kf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var s={DetermineComponentFrameRoot:function(){try{if(e){var f=function(){throw Error()};if(Object.defineProperty(f.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(f,[])}catch(m){var h=m}Reflect.construct(t,[],f)}else{try{f.call()}catch(m){h=m}t.call(f.prototype)}}else{try{throw Error()}catch(m){h=m}(f=t())&&typeof f.catch=="function"&&f.catch(function(){})}}catch(m){if(m&&h&&typeof m.stack=="string")return[m.stack,h.stack]}return[null,null]}};s.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var i=Object.getOwnPropertyDescriptor(s.DetermineComponentFrameRoot,"name");i&&i.configurable&&Object.defineProperty(s.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var r=s.DetermineComponentFrameRoot(),a=r[0],o=r[1];if(a&&o){var c=a.split(`
`),u=o.split(`
`);for(i=s=0;s<c.length&&!c[s].includes("DetermineComponentFrameRoot");)s++;for(;i<u.length&&!u[i].includes("DetermineComponentFrameRoot");)i++;if(s===c.length||i===u.length)for(s=c.length-1,i=u.length-1;1<=s&&0<=i&&c[s]!==u[i];)i--;for(;1<=s&&0<=i;s--,i--)if(c[s]!==u[i]){if(s!==1||i!==1)do if(s--,i--,0>i||c[s]!==u[i]){var d=`
`+c[s].replace(" at new "," at ");return t.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",t.displayName)),d}while(1<=s&&0<=i);break}}}finally{kf=!1,Error.prepareStackTrace=n}return(n=t?t.displayName||t.name:"")?zi(n):""}function YA(t,e){switch(t.tag){case 26:case 27:case 5:return zi(t.type);case 16:return zi("Lazy");case 13:return t.child!==e&&e!==null?zi("Suspense Fallback"):zi("Suspense");case 19:return zi("SuspenseList");case 0:case 15:return Sf(t.type,!1);case 11:return Sf(t.type.render,!1);case 1:return Sf(t.type,!0);case 31:return zi("Activity");default:return""}}function Nv(t){try{var e="",n=null;do e+=YA(t,n),n=t,t=t.return;while(t);return e}catch(s){return`
Error generating stack: `+s.message+`
`+s.stack}}var zh=Object.prototype.hasOwnProperty,Gp=pt.unstable_scheduleCallback,Tf=pt.unstable_cancelCallback,qA=pt.unstable_shouldYield,WA=pt.unstable_requestPaint,on=pt.unstable_now,XA=pt.unstable_getCurrentPriorityLevel,d1=pt.unstable_ImmediatePriority,f1=pt.unstable_UserBlockingPriority,_u=pt.unstable_NormalPriority,QA=pt.unstable_LowPriority,h1=pt.unstable_IdlePriority,JA=pt.log,ZA=pt.unstable_setDisableYieldValue,Hl=null,ln=null;function ti(t){if(typeof JA=="function"&&ZA(t),ln&&typeof ln.setStrictMode=="function")try{ln.setStrictMode(Hl,t)}catch{}}var cn=Math.clz32?Math.clz32:nR,eR=Math.log,tR=Math.LN2;function nR(t){return t>>>=0,t===0?32:31-(eR(t)/tR|0)|0}var Ec=256,Nc=262144,kc=4194304;function $i(t){var e=t&42;if(e!==0)return e;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function Cd(t,e,n){var s=t.pendingLanes;if(s===0)return 0;var i=0,r=t.suspendedLanes,a=t.pingedLanes;t=t.warmLanes;var o=s&134217727;return o!==0?(s=o&~r,s!==0?i=$i(s):(a&=o,a!==0?i=$i(a):n||(n=o&~t,n!==0&&(i=$i(n))))):(o=s&~r,o!==0?i=$i(o):a!==0?i=$i(a):n||(n=s&~t,n!==0&&(i=$i(n)))),i===0?0:e!==0&&e!==i&&!(e&r)&&(r=i&-i,n=e&-e,r>=n||r===32&&(n&4194048)!==0)?e:i}function Gl(t,e){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&e)===0}function sR(t,e){switch(t){case 1:case 2:case 4:case 8:case 64:return e+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function m1(){var t=kc;return kc<<=1,!(kc&62914560)&&(kc=4194304),t}function Af(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Vl(t,e){t.pendingLanes|=e,e!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function iR(t,e,n,s,i,r){var a=t.pendingLanes;t.pendingLanes=n,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=n,t.entangledLanes&=n,t.errorRecoveryDisabledLanes&=n,t.shellSuspendCounter=0;var o=t.entanglements,c=t.expirationTimes,u=t.hiddenUpdates;for(n=a&~n;0<n;){var d=31-cn(n),f=1<<d;o[d]=0,c[d]=-1;var h=u[d];if(h!==null)for(u[d]=null,d=0;d<h.length;d++){var m=h[d];m!==null&&(m.lane&=-536870913)}n&=~f}s!==0&&p1(t,s,0),r!==0&&i===0&&t.tag!==0&&(t.suspendedLanes|=r&~(a&~e))}function p1(t,e,n){t.pendingLanes|=e,t.suspendedLanes&=~e;var s=31-cn(e);t.entangledLanes|=e,t.entanglements[s]=t.entanglements[s]|1073741824|n&261930}function g1(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-cn(n),i=1<<s;i&e|t[s]&e&&(t[s]|=e),n&=~i}}function v1(t,e){var n=e&-e;return n=n&42?1:Vp(n),n&(t.suspendedLanes|e)?0:n}function Vp(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function Fp(t){return t&=-t,2<t?8<t?t&134217727?32:268435456:8:2}function b1(){var t=Ne.p;return t!==0?t:(t=window.event,t===void 0?32:GE(t.type))}function kv(t,e){var n=Ne.p;try{return Ne.p=t,e()}finally{Ne.p=n}}var Di=Math.random().toString(36).slice(2),Tt="__reactFiber$"+Di,Zt="__reactProps$"+Di,Fa="__reactContainer$"+Di,$h="__reactEvents$"+Di,rR="__reactListeners$"+Di,aR="__reactHandles$"+Di,Sv="__reactResources$"+Di,Fl="__reactMarker$"+Di;function zp(t){delete t[Tt],delete t[Zt],delete t[$h],delete t[rR],delete t[aR]}function Vr(t){var e=t[Tt];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Fa]||n[Tt]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Ob(t);t!==null;){if(n=t[Tt])return n;t=Ob(t)}return e}t=n,n=t.parentNode}return null}function za(t){if(t=t[Tt]||t[Fa]){var e=t.tag;if(e===5||e===6||e===13||e===31||e===26||e===27||e===3)return t}return null}function ko(t){var e=t.tag;if(e===5||e===26||e===27||e===6)return t.stateNode;throw Error(P(33))}function ra(t){var e=t[Sv];return e||(e=t[Sv]={hoistableStyles:new Map,hoistableScripts:new Map}),e}function yt(t){t[Fl]=!0}var x1=new Set,y1={};function Er(t,e){_a(t,e),_a(t+"Capture",e)}function _a(t,e){for(y1[t]=e,t=0;t<e.length;t++)x1.add(e[t])}var oR=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Tv={},Av={};function lR(t){return zh.call(Av,t)?!0:zh.call(Tv,t)?!1:oR.test(t)?Av[t]=!0:(Tv[t]=!0,!1)}function qc(t,e,n){if(lR(e))if(n===null)t.removeAttribute(e);else{switch(typeof n){case"undefined":case"function":case"symbol":t.removeAttribute(e);return;case"boolean":var s=e.toLowerCase().slice(0,5);if(s!=="data-"&&s!=="aria-"){t.removeAttribute(e);return}}t.setAttribute(e,""+n)}}function Sc(t,e,n){if(n===null)t.removeAttribute(e);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(e);return}t.setAttribute(e,""+n)}}function os(t,e,n,s){if(s===null)t.removeAttribute(n);else{switch(typeof s){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(n);return}t.setAttributeNS(e,n,""+s)}}function bn(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function _1(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function cR(t,e,n){var s=Object.getOwnPropertyDescriptor(t.constructor.prototype,e);if(!t.hasOwnProperty(e)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var i=s.get,r=s.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,r.call(this,a)}}),Object.defineProperty(t,e,{enumerable:s.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Kh(t){if(!t._valueTracker){var e=_1(t)?"checked":"value";t._valueTracker=cR(t,e,""+t[e])}}function w1(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=_1(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function wu(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var uR=/[\n"\\]/g;function _n(t){return t.replace(uR,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function Yh(t,e,n,s,i,r,a,o){t.name="",a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"?t.type=a:t.removeAttribute("type"),e!=null?a==="number"?(e===0&&t.value===""||t.value!=e)&&(t.value=""+bn(e)):t.value!==""+bn(e)&&(t.value=""+bn(e)):a!=="submit"&&a!=="reset"||t.removeAttribute("value"),e!=null?qh(t,a,bn(e)):n!=null?qh(t,a,bn(n)):s!=null&&t.removeAttribute("value"),i==null&&r!=null&&(t.defaultChecked=!!r),i!=null&&(t.checked=i&&typeof i!="function"&&typeof i!="symbol"),o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"?t.name=""+bn(o):t.removeAttribute("name")}function E1(t,e,n,s,i,r,a,o){if(r!=null&&typeof r!="function"&&typeof r!="symbol"&&typeof r!="boolean"&&(t.type=r),e!=null||n!=null){if(!(r!=="submit"&&r!=="reset"||e!=null)){Kh(t);return}n=n!=null?""+bn(n):"",e=e!=null?""+bn(e):n,o||e===t.value||(t.value=e),t.defaultValue=e}s=s??i,s=typeof s!="function"&&typeof s!="symbol"&&!!s,t.checked=o?t.checked:!!s,t.defaultChecked=!!s,a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"&&(t.name=a),Kh(t)}function qh(t,e,n){e==="number"&&wu(t.ownerDocument)===t||t.defaultValue===""+n||(t.defaultValue=""+n)}function aa(t,e,n,s){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&s&&(t[n].defaultSelected=!0)}else{for(n=""+bn(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,s&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function N1(t,e,n){if(e!=null&&(e=""+bn(e),e!==t.value&&(t.value=e),n==null)){t.defaultValue!==e&&(t.defaultValue=e);return}t.defaultValue=n!=null?""+bn(n):""}function k1(t,e,n,s){if(e==null){if(s!=null){if(n!=null)throw Error(P(92));if(No(s)){if(1<s.length)throw Error(P(93));s=s[0]}n=s}n==null&&(n=""),e=n}n=bn(e),t.defaultValue=n,s=t.textContent,s===n&&s!==""&&s!==null&&(t.value=s),Kh(t)}function wa(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var dR=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Rv(t,e,n){var s=e.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?s?t.setProperty(e,""):e==="float"?t.cssFloat="":t[e]="":s?t.setProperty(e,n):typeof n!="number"||n===0||dR.has(e)?e==="float"?t.cssFloat=n:t[e]=(""+n).trim():t[e]=n+"px"}function S1(t,e,n){if(e!=null&&typeof e!="object")throw Error(P(62));if(t=t.style,n!=null){for(var s in n)!n.hasOwnProperty(s)||e!=null&&e.hasOwnProperty(s)||(s.indexOf("--")===0?t.setProperty(s,""):s==="float"?t.cssFloat="":t[s]="");for(var i in e)s=e[i],e.hasOwnProperty(i)&&n[i]!==s&&Rv(t,i,s)}else for(var r in e)e.hasOwnProperty(r)&&Rv(t,r,e[r])}function $p(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var fR=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),hR=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Wc(t){return hR.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function gs(){}var Wh=null;function Kp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Fr=null,oa=null;function Iv(t){var e=za(t);if(e&&(t=e.stateNode)){var n=t[Zt]||null;e:switch(t=e.stateNode,e.type){case"input":if(Yh(t,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+_n(""+e)+'"][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var i=s[Zt]||null;if(!i)throw Error(P(90));Yh(s,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(e=0;e<n.length;e++)s=n[e],s.form===t.form&&w1(s)}break e;case"textarea":N1(t,n.value,n.defaultValue);break e;case"select":e=n.value,e!=null&&aa(t,!!n.multiple,e,!1)}}}var Rf=!1;function T1(t,e,n){if(Rf)return t(e,n);Rf=!0;try{var s=t(e);return s}finally{if(Rf=!1,(Fr!==null||oa!==null)&&(Fd(),Fr&&(e=Fr,t=oa,oa=Fr=null,Iv(e),t)))for(e=0;e<t.length;e++)Iv(t[e])}}function il(t,e){var n=t.stateNode;if(n===null)return null;var s=n[Zt]||null;if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(P(231,e,typeof n));return n}var Ts=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Xh=!1;if(Ts)try{var fo={};Object.defineProperty(fo,"passive",{get:function(){Xh=!0}}),window.addEventListener("test",fo,fo),window.removeEventListener("test",fo,fo)}catch{Xh=!1}var ni=null,Yp=null,Xc=null;function A1(){if(Xc)return Xc;var t,e=Yp,n=e.length,s,i="value"in ni?ni.value:ni.textContent,r=i.length;for(t=0;t<n&&e[t]===i[t];t++);var a=n-t;for(s=1;s<=a&&e[n-s]===i[r-s];s++);return Xc=i.slice(t,1<s?1-s:void 0)}function Qc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Tc(){return!0}function Cv(){return!1}function en(t){function e(n,s,i,r,a){this._reactName=n,this._targetInst=i,this.type=s,this.nativeEvent=r,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(n=t[o],this[o]=n?n(r):r[o]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?Tc:Cv,this.isPropagationStopped=Cv,this}return Fe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Tc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Tc)},persist:function(){},isPersistent:Tc}),e}var Nr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},jd=en(Nr),zl=Fe({},Nr,{view:0,detail:0}),mR=en(zl),If,Cf,ho,Od=Fe({},zl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qp,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ho&&(ho&&t.type==="mousemove"?(If=t.screenX-ho.screenX,Cf=t.screenY-ho.screenY):Cf=If=0,ho=t),If)},movementY:function(t){return"movementY"in t?t.movementY:Cf}}),jv=en(Od),pR=Fe({},Od,{dataTransfer:0}),gR=en(pR),vR=Fe({},zl,{relatedTarget:0}),jf=en(vR),bR=Fe({},Nr,{animationName:0,elapsedTime:0,pseudoElement:0}),xR=en(bR),yR=Fe({},Nr,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),_R=en(yR),wR=Fe({},Nr,{data:0}),Ov=en(wR),ER={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},NR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function SR(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=kR[t])?!!e[t]:!1}function qp(){return SR}var TR=Fe({},zl,{key:function(t){if(t.key){var e=ER[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Qc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?NR[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qp,charCode:function(t){return t.type==="keypress"?Qc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Qc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),AR=en(TR),RR=Fe({},Od,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Mv=en(RR),IR=Fe({},zl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qp}),CR=en(IR),jR=Fe({},Nr,{propertyName:0,elapsedTime:0,pseudoElement:0}),OR=en(jR),MR=Fe({},Od,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),DR=en(MR),LR=Fe({},Nr,{newState:0,oldState:0}),PR=en(LR),BR=[9,13,27,32],Wp=Ts&&"CompositionEvent"in window,Oo=null;Ts&&"documentMode"in document&&(Oo=document.documentMode);var UR=Ts&&"TextEvent"in window&&!Oo,R1=Ts&&(!Wp||Oo&&8<Oo&&11>=Oo),Dv=" ",Lv=!1;function I1(t,e){switch(t){case"keyup":return BR.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function C1(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var zr=!1;function HR(t,e){switch(t){case"compositionend":return C1(e);case"keypress":return e.which!==32?null:(Lv=!0,Dv);case"textInput":return t=e.data,t===Dv&&Lv?null:t;default:return null}}function GR(t,e){if(zr)return t==="compositionend"||!Wp&&I1(t,e)?(t=A1(),Xc=Yp=ni=null,zr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return R1&&e.locale!=="ko"?null:e.data;default:return null}}var VR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Pv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!VR[t.type]:e==="textarea"}function j1(t,e,n,s){Fr?oa?oa.push(s):oa=[s]:Fr=s,e=Hu(e,"onChange"),0<e.length&&(n=new jd("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var Mo=null,rl=null;function FR(t){TE(t,0)}function Md(t){var e=ko(t);if(w1(e))return t}function Bv(t,e){if(t==="change")return e}var O1=!1;if(Ts){var Of;if(Ts){var Mf="oninput"in document;if(!Mf){var Uv=document.createElement("div");Uv.setAttribute("oninput","return;"),Mf=typeof Uv.oninput=="function"}Of=Mf}else Of=!1;O1=Of&&(!document.documentMode||9<document.documentMode)}function Hv(){Mo&&(Mo.detachEvent("onpropertychange",M1),rl=Mo=null)}function M1(t){if(t.propertyName==="value"&&Md(rl)){var e=[];j1(e,rl,t,Kp(t)),T1(FR,e)}}function zR(t,e,n){t==="focusin"?(Hv(),Mo=e,rl=n,Mo.attachEvent("onpropertychange",M1)):t==="focusout"&&Hv()}function $R(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Md(rl)}function KR(t,e){if(t==="click")return Md(e)}function YR(t,e){if(t==="input"||t==="change")return Md(e)}function qR(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var dn=typeof Object.is=="function"?Object.is:qR;function al(t,e){if(dn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var i=n[s];if(!zh.call(e,i)||!dn(t[i],e[i]))return!1}return!0}function Gv(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Vv(t,e){var n=Gv(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Gv(n)}}function D1(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?D1(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function L1(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var e=wu(t.document);e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=wu(t.document)}return e}function Xp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}var WR=Ts&&"documentMode"in document&&11>=document.documentMode,$r=null,Qh=null,Do=null,Jh=!1;function Fv(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Jh||$r==null||$r!==wu(s)||(s=$r,"selectionStart"in s&&Xp(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Do&&al(Do,s)||(Do=s,s=Hu(Qh,"onSelect"),0<s.length&&(e=new jd("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=$r)))}function Vi(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Kr={animationend:Vi("Animation","AnimationEnd"),animationiteration:Vi("Animation","AnimationIteration"),animationstart:Vi("Animation","AnimationStart"),transitionrun:Vi("Transition","TransitionRun"),transitionstart:Vi("Transition","TransitionStart"),transitioncancel:Vi("Transition","TransitionCancel"),transitionend:Vi("Transition","TransitionEnd")},Df={},P1={};Ts&&(P1=document.createElement("div").style,"AnimationEvent"in window||(delete Kr.animationend.animation,delete Kr.animationiteration.animation,delete Kr.animationstart.animation),"TransitionEvent"in window||delete Kr.transitionend.transition);function kr(t){if(Df[t])return Df[t];if(!Kr[t])return t;var e=Kr[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in P1)return Df[t]=e[n];return t}var B1=kr("animationend"),U1=kr("animationiteration"),H1=kr("animationstart"),XR=kr("transitionrun"),QR=kr("transitionstart"),JR=kr("transitioncancel"),G1=kr("transitionend"),V1=new Map,Zh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Zh.push("scrollEnd");function zn(t,e){V1.set(t,e),Er(e,[t])}var Eu=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},vn=[],Yr=0,Qp=0;function Dd(){for(var t=Yr,e=Qp=Yr=0;e<t;){var n=vn[e];vn[e++]=null;var s=vn[e];vn[e++]=null;var i=vn[e];vn[e++]=null;var r=vn[e];if(vn[e++]=null,s!==null&&i!==null){var a=s.pending;a===null?i.next=i:(i.next=a.next,a.next=i),s.pending=i}r!==0&&F1(n,i,r)}}function Ld(t,e,n,s){vn[Yr++]=t,vn[Yr++]=e,vn[Yr++]=n,vn[Yr++]=s,Qp|=s,t.lanes|=s,t=t.alternate,t!==null&&(t.lanes|=s)}function Jp(t,e,n,s){return Ld(t,e,n,s),Nu(t)}function Sr(t,e){return Ld(t,null,null,e),Nu(t)}function F1(t,e,n){t.lanes|=n;var s=t.alternate;s!==null&&(s.lanes|=n);for(var i=!1,r=t.return;r!==null;)r.childLanes|=n,s=r.alternate,s!==null&&(s.childLanes|=n),r.tag===22&&(t=r.stateNode,t===null||t._visibility&1||(i=!0)),t=r,r=r.return;return t.tag===3?(r=t.stateNode,i&&e!==null&&(i=31-cn(n),t=r.hiddenUpdates,s=t[i],s===null?t[i]=[e]:s.push(e),e.lane=n|536870912),r):null}function Nu(t){if(50<zo)throw zo=0,ym=null,Error(P(185));for(var e=t.return;e!==null;)t=e,e=t.return;return t.tag===3?t.stateNode:null}var qr={};function ZR(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function sn(t,e,n,s){return new ZR(t,e,n,s)}function Zp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function ws(t,e){var n=t.alternate;return n===null?(n=sn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&65011712,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n.refCleanup=t.refCleanup,n}function z1(t,e){t.flags&=65011714;var n=t.alternate;return n===null?(t.childLanes=0,t.lanes=e,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,t.type=n.type,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),t}function Jc(t,e,n,s,i,r){var a=0;if(s=t,typeof t=="function")Zp(t)&&(a=1);else if(typeof t=="string")a=iC(t,n,Jn.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case Hh:return t=sn(31,n,e,i),t.elementType=Hh,t.lanes=r,t;case Hr:return nr(n.children,i,r,e);case c1:a=8,i|=24;break;case Ph:return t=sn(12,n,e,i|2),t.elementType=Ph,t.lanes=r,t;case Bh:return t=sn(13,n,e,i),t.elementType=Bh,t.lanes=r,t;case Uh:return t=sn(19,n,e,i),t.elementType=Uh,t.lanes=r,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case ps:a=10;break e;case u1:a=9;break e;case Up:a=11;break e;case Hp:a=14;break e;case $s:a=16,s=null;break e}a=29,n=Error(P(130,t===null?"null":typeof t,"")),s=null}return e=sn(a,n,e,i),e.elementType=t,e.type=s,e.lanes=r,e}function nr(t,e,n,s){return t=sn(7,t,s,e),t.lanes=n,t}function Lf(t,e,n){return t=sn(6,t,null,e),t.lanes=n,t}function $1(t){var e=sn(18,null,null,0);return e.stateNode=t,e}function Pf(t,e,n){return e=sn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}var zv=new WeakMap;function wn(t,e){if(typeof t=="object"&&t!==null){var n=zv.get(t);return n!==void 0?n:(e={value:t,source:e,stack:Nv(e)},zv.set(t,e),e)}return{value:t,source:e,stack:Nv(e)}}var Wr=[],Xr=0,ku=null,ol=0,xn=[],yn=0,Ni=null,Wn=1,Xn="";function hs(t,e){Wr[Xr++]=ol,Wr[Xr++]=ku,ku=t,ol=e}function K1(t,e,n){xn[yn++]=Wn,xn[yn++]=Xn,xn[yn++]=Ni,Ni=t;var s=Wn;t=Xn;var i=32-cn(s)-1;s&=~(1<<i),n+=1;var r=32-cn(e)+i;if(30<r){var a=i-i%5;r=(s&(1<<a)-1).toString(32),s>>=a,i-=a,Wn=1<<32-cn(e)+i|n<<i|s,Xn=r+t}else Wn=1<<r|n<<i|s,Xn=t}function eg(t){t.return!==null&&(hs(t,1),K1(t,1,0))}function tg(t){for(;t===ku;)ku=Wr[--Xr],Wr[Xr]=null,ol=Wr[--Xr],Wr[Xr]=null;for(;t===Ni;)Ni=xn[--yn],xn[yn]=null,Xn=xn[--yn],xn[yn]=null,Wn=xn[--yn],xn[yn]=null}function Y1(t,e){xn[yn++]=Wn,xn[yn++]=Xn,xn[yn++]=Ni,Wn=e.id,Xn=e.overflow,Ni=t}var At=null,He=null,be=!1,ui=null,En=!1,em=Error(P(519));function ki(t){var e=Error(P(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ll(wn(e,t)),em}function $v(t){var e=t.stateNode,n=t.type,s=t.memoizedProps;switch(e[Tt]=t,e[Zt]=s,n){case"dialog":pe("cancel",e),pe("close",e);break;case"iframe":case"object":case"embed":pe("load",e);break;case"video":case"audio":for(n=0;n<fl.length;n++)pe(fl[n],e);break;case"source":pe("error",e);break;case"img":case"image":case"link":pe("error",e),pe("load",e);break;case"details":pe("toggle",e);break;case"input":pe("invalid",e),E1(e,s.value,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name,!0);break;case"select":pe("invalid",e);break;case"textarea":pe("invalid",e),k1(e,s.value,s.defaultValue,s.children)}n=s.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||e.textContent===""+n||s.suppressHydrationWarning===!0||RE(e.textContent,n)?(s.popover!=null&&(pe("beforetoggle",e),pe("toggle",e)),s.onScroll!=null&&pe("scroll",e),s.onScrollEnd!=null&&pe("scrollend",e),s.onClick!=null&&(e.onclick=gs),e=!0):e=!1,e||ki(t,!0)}function Kv(t){for(At=t.return;At;)switch(At.tag){case 5:case 31:case 13:En=!1;return;case 27:case 3:En=!0;return;default:At=At.return}}function jr(t){if(t!==At)return!1;if(!be)return Kv(t),be=!0,!1;var e=t.tag,n;if((n=e!==3&&e!==27)&&((n=e===5)&&(n=t.type,n=!(n!=="form"&&n!=="button")||km(t.type,t.memoizedProps)),n=!n),n&&He&&ki(t),Kv(t),e===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(P(317));He=jb(t)}else if(e===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(P(317));He=jb(t)}else e===27?(e=He,Li(t.type)?(t=Rm,Rm=null,He=t):He=e):He=At?Tn(t.stateNode.nextSibling):null;return!0}function ur(){He=At=null,be=!1}function Bf(){var t=ui;return t!==null&&(qt===null?qt=t:qt.push.apply(qt,t),ui=null),t}function ll(t){ui===null?ui=[t]:ui.push(t)}var tm=is(null),Tr=null,vs=null;function Ys(t,e,n){Be(tm,e._currentValue),e._currentValue=n}function Es(t){t._currentValue=tm.current,wt(tm)}function nm(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function sm(t,e,n,s){var i=t.child;for(i!==null&&(i.return=t);i!==null;){var r=i.dependencies;if(r!==null){var a=i.child;r=r.firstContext;e:for(;r!==null;){var o=r;r=i;for(var c=0;c<e.length;c++)if(o.context===e[c]){r.lanes|=n,o=r.alternate,o!==null&&(o.lanes|=n),nm(r.return,n,t),s||(a=null);break e}r=o.next}}else if(i.tag===18){if(a=i.return,a===null)throw Error(P(341));a.lanes|=n,r=a.alternate,r!==null&&(r.lanes|=n),nm(a,n,t),a=null}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===t){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}}function $a(t,e,n,s){t=null;for(var i=e,r=!1;i!==null;){if(!r){if(i.flags&524288)r=!0;else if(i.flags&262144)break}if(i.tag===10){var a=i.alternate;if(a===null)throw Error(P(387));if(a=a.memoizedProps,a!==null){var o=i.type;dn(i.pendingProps.value,a.value)||(t!==null?t.push(o):t=[o])}}else if(i===bu.current){if(a=i.alternate,a===null)throw Error(P(387));a.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(t!==null?t.push(ml):t=[ml])}i=i.return}t!==null&&sm(e,t,n,s),e.flags|=262144}function Su(t){for(t=t.firstContext;t!==null;){if(!dn(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function dr(t){Tr=t,vs=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function It(t){return q1(Tr,t)}function Ac(t,e){return Tr===null&&dr(t),q1(t,e)}function q1(t,e){var n=e._currentValue;if(e={context:e,memoizedValue:n,next:null},vs===null){if(t===null)throw Error(P(308));vs=e,t.dependencies={lanes:0,firstContext:e},t.flags|=524288}else vs=vs.next=e;return n}var eI=typeof AbortController<"u"?AbortController:function(){var t=[],e=this.signal={aborted:!1,addEventListener:function(n,s){t.push(s)}};this.abort=function(){e.aborted=!0,t.forEach(function(n){return n()})}},tI=pt.unstable_scheduleCallback,nI=pt.unstable_NormalPriority,lt={$$typeof:ps,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ng(){return{controller:new eI,data:new Map,refCount:0}}function $l(t){t.refCount--,t.refCount===0&&tI(nI,function(){t.controller.abort()})}var Lo=null,im=0,Ea=0,la=null;function sI(t,e){if(Lo===null){var n=Lo=[];im=0,Ea=Tg(),la={status:"pending",value:void 0,then:function(s){n.push(s)}}}return im++,e.then(Yv,Yv),e}function Yv(){if(--im===0&&Lo!==null){la!==null&&(la.status="fulfilled");var t=Lo;Lo=null,Ea=0,la=null;for(var e=0;e<t.length;e++)(0,t[e])()}}function iI(t,e){var n=[],s={status:"pending",value:null,reason:null,then:function(i){n.push(i)}};return t.then(function(){s.status="fulfilled",s.value=e;for(var i=0;i<n.length;i++)(0,n[i])(e)},function(i){for(s.status="rejected",s.reason=i,i=0;i<n.length;i++)(0,n[i])(void 0)}),s}var qv=ie.S;ie.S=function(t,e){lE=on(),typeof e=="object"&&e!==null&&typeof e.then=="function"&&sI(t,e),qv!==null&&qv(t,e)};var sr=is(null);function sg(){var t=sr.current;return t!==null?t:Le.pooledCache}function Zc(t,e){e===null?Be(sr,sr.current):Be(sr,e.pool)}function W1(){var t=sg();return t===null?null:{parent:lt._currentValue,pool:t}}var Ka=Error(P(460)),ig=Error(P(474)),Pd=Error(P(542)),Tu={then:function(){}};function Wv(t){return t=t.status,t==="fulfilled"||t==="rejected"}function X1(t,e,n){switch(n=t[n],n===void 0?t.push(e):n!==e&&(e.then(gs,gs),e=n),e.status){case"fulfilled":return e.value;case"rejected":throw t=e.reason,Qv(t),t;default:if(typeof e.status=="string")e.then(gs,gs);else{if(t=Le,t!==null&&100<t.shellSuspendCounter)throw Error(P(482));t=e,t.status="pending",t.then(function(s){if(e.status==="pending"){var i=e;i.status="fulfilled",i.value=s}},function(s){if(e.status==="pending"){var i=e;i.status="rejected",i.reason=s}})}switch(e.status){case"fulfilled":return e.value;case"rejected":throw t=e.reason,Qv(t),t}throw ir=e,Ka}}function Ki(t){try{var e=t._init;return e(t._payload)}catch(n){throw n!==null&&typeof n=="object"&&typeof n.then=="function"?(ir=n,Ka):n}}var ir=null;function Xv(){if(ir===null)throw Error(P(459));var t=ir;return ir=null,t}function Qv(t){if(t===Ka||t===Pd)throw Error(P(483))}var ca=null,cl=0;function Rc(t){var e=cl;return cl+=1,ca===null&&(ca=[]),X1(ca,t,e)}function mo(t,e){e=e.props.ref,t.ref=e!==void 0?e:null}function Ic(t,e){throw e.$$typeof===zA?Error(P(525)):(t=Object.prototype.toString.call(e),Error(P(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)))}function Q1(t){function e(p,v){if(t){var y=p.deletions;y===null?(p.deletions=[v],p.flags|=16):y.push(v)}}function n(p,v){if(!t)return null;for(;v!==null;)e(p,v),v=v.sibling;return null}function s(p){for(var v=new Map;p!==null;)p.key!==null?v.set(p.key,p):v.set(p.index,p),p=p.sibling;return v}function i(p,v){return p=ws(p,v),p.index=0,p.sibling=null,p}function r(p,v,y){return p.index=y,t?(y=p.alternate,y!==null?(y=y.index,y<v?(p.flags|=67108866,v):y):(p.flags|=67108866,v)):(p.flags|=1048576,v)}function a(p){return t&&p.alternate===null&&(p.flags|=67108866),p}function o(p,v,y,E){return v===null||v.tag!==6?(v=Lf(y,p.mode,E),v.return=p,v):(v=i(v,y),v.return=p,v)}function c(p,v,y,E){var N=y.type;return N===Hr?d(p,v,y.props.children,E,y.key):v!==null&&(v.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===$s&&Ki(N)===v.type)?(v=i(v,y.props),mo(v,y),v.return=p,v):(v=Jc(y.type,y.key,y.props,null,p.mode,E),mo(v,y),v.return=p,v)}function u(p,v,y,E){return v===null||v.tag!==4||v.stateNode.containerInfo!==y.containerInfo||v.stateNode.implementation!==y.implementation?(v=Pf(y,p.mode,E),v.return=p,v):(v=i(v,y.children||[]),v.return=p,v)}function d(p,v,y,E,N){return v===null||v.tag!==7?(v=nr(y,p.mode,E,N),v.return=p,v):(v=i(v,y),v.return=p,v)}function f(p,v,y){if(typeof v=="string"&&v!==""||typeof v=="number"||typeof v=="bigint")return v=Lf(""+v,p.mode,y),v.return=p,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case wc:return y=Jc(v.type,v.key,v.props,null,p.mode,y),mo(y,v),y.return=p,y;case Eo:return v=Pf(v,p.mode,y),v.return=p,v;case $s:return v=Ki(v),f(p,v,y)}if(No(v)||uo(v))return v=nr(v,p.mode,y,null),v.return=p,v;if(typeof v.then=="function")return f(p,Rc(v),y);if(v.$$typeof===ps)return f(p,Ac(p,v),y);Ic(p,v)}return null}function h(p,v,y,E){var N=v!==null?v.key:null;if(typeof y=="string"&&y!==""||typeof y=="number"||typeof y=="bigint")return N!==null?null:o(p,v,""+y,E);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case wc:return y.key===N?c(p,v,y,E):null;case Eo:return y.key===N?u(p,v,y,E):null;case $s:return y=Ki(y),h(p,v,y,E)}if(No(y)||uo(y))return N!==null?null:d(p,v,y,E,null);if(typeof y.then=="function")return h(p,v,Rc(y),E);if(y.$$typeof===ps)return h(p,v,Ac(p,y),E);Ic(p,y)}return null}function m(p,v,y,E,N){if(typeof E=="string"&&E!==""||typeof E=="number"||typeof E=="bigint")return p=p.get(y)||null,o(v,p,""+E,N);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case wc:return p=p.get(E.key===null?y:E.key)||null,c(v,p,E,N);case Eo:return p=p.get(E.key===null?y:E.key)||null,u(v,p,E,N);case $s:return E=Ki(E),m(p,v,y,E,N)}if(No(E)||uo(E))return p=p.get(y)||null,d(v,p,E,N,null);if(typeof E.then=="function")return m(p,v,y,Rc(E),N);if(E.$$typeof===ps)return m(p,v,y,Ac(v,E),N);Ic(v,E)}return null}function g(p,v,y,E){for(var N=null,T=null,w=v,A=v=0,k=null;w!==null&&A<y.length;A++){w.index>A?(k=w,w=null):k=w.sibling;var R=h(p,w,y[A],E);if(R===null){w===null&&(w=k);break}t&&w&&R.alternate===null&&e(p,w),v=r(R,v,A),T===null?N=R:T.sibling=R,T=R,w=k}if(A===y.length)return n(p,w),be&&hs(p,A),N;if(w===null){for(;A<y.length;A++)w=f(p,y[A],E),w!==null&&(v=r(w,v,A),T===null?N=w:T.sibling=w,T=w);return be&&hs(p,A),N}for(w=s(w);A<y.length;A++)k=m(w,p,A,y[A],E),k!==null&&(t&&k.alternate!==null&&w.delete(k.key===null?A:k.key),v=r(k,v,A),T===null?N=k:T.sibling=k,T=k);return t&&w.forEach(function(C){return e(p,C)}),be&&hs(p,A),N}function b(p,v,y,E){if(y==null)throw Error(P(151));for(var N=null,T=null,w=v,A=v=0,k=null,R=y.next();w!==null&&!R.done;A++,R=y.next()){w.index>A?(k=w,w=null):k=w.sibling;var C=h(p,w,R.value,E);if(C===null){w===null&&(w=k);break}t&&w&&C.alternate===null&&e(p,w),v=r(C,v,A),T===null?N=C:T.sibling=C,T=C,w=k}if(R.done)return n(p,w),be&&hs(p,A),N;if(w===null){for(;!R.done;A++,R=y.next())R=f(p,R.value,E),R!==null&&(v=r(R,v,A),T===null?N=R:T.sibling=R,T=R);return be&&hs(p,A),N}for(w=s(w);!R.done;A++,R=y.next())R=m(w,p,A,R.value,E),R!==null&&(t&&R.alternate!==null&&w.delete(R.key===null?A:R.key),v=r(R,v,A),T===null?N=R:T.sibling=R,T=R);return t&&w.forEach(function(B){return e(p,B)}),be&&hs(p,A),N}function x(p,v,y,E){if(typeof y=="object"&&y!==null&&y.type===Hr&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case wc:e:{for(var N=y.key;v!==null;){if(v.key===N){if(N=y.type,N===Hr){if(v.tag===7){n(p,v.sibling),E=i(v,y.props.children),E.return=p,p=E;break e}}else if(v.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===$s&&Ki(N)===v.type){n(p,v.sibling),E=i(v,y.props),mo(E,y),E.return=p,p=E;break e}n(p,v);break}else e(p,v);v=v.sibling}y.type===Hr?(E=nr(y.props.children,p.mode,E,y.key),E.return=p,p=E):(E=Jc(y.type,y.key,y.props,null,p.mode,E),mo(E,y),E.return=p,p=E)}return a(p);case Eo:e:{for(N=y.key;v!==null;){if(v.key===N)if(v.tag===4&&v.stateNode.containerInfo===y.containerInfo&&v.stateNode.implementation===y.implementation){n(p,v.sibling),E=i(v,y.children||[]),E.return=p,p=E;break e}else{n(p,v);break}else e(p,v);v=v.sibling}E=Pf(y,p.mode,E),E.return=p,p=E}return a(p);case $s:return y=Ki(y),x(p,v,y,E)}if(No(y))return g(p,v,y,E);if(uo(y)){if(N=uo(y),typeof N!="function")throw Error(P(150));return y=N.call(y),b(p,v,y,E)}if(typeof y.then=="function")return x(p,v,Rc(y),E);if(y.$$typeof===ps)return x(p,v,Ac(p,y),E);Ic(p,y)}return typeof y=="string"&&y!==""||typeof y=="number"||typeof y=="bigint"?(y=""+y,v!==null&&v.tag===6?(n(p,v.sibling),E=i(v,y),E.return=p,p=E):(n(p,v),E=Lf(y,p.mode,E),E.return=p,p=E),a(p)):n(p,v)}return function(p,v,y,E){try{cl=0;var N=x(p,v,y,E);return ca=null,N}catch(w){if(w===Ka||w===Pd)throw w;var T=sn(29,w,null,p.mode);return T.lanes=E,T.return=p,T}finally{}}}var fr=Q1(!0),J1=Q1(!1),Ks=!1;function rg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function rm(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function di(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function fi(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,Ee&2){var i=s.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),s.pending=e,e=Nu(t),F1(t,null,n),e}return Ld(t,s,e,n),Nu(t)}function Po(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194048)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,g1(t,n)}}function Uf(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var i=null,r=null;if(n=n.firstBaseUpdate,n!==null){do{var a={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};r===null?i=r=a:r=r.next=a,n=n.next}while(n!==null);r===null?i=r=e:r=r.next=e}else i=r=e;n={baseState:s.baseState,firstBaseUpdate:i,lastBaseUpdate:r,shared:s.shared,callbacks:s.callbacks},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}var am=!1;function Bo(){if(am){var t=la;if(t!==null)throw t}}function Uo(t,e,n,s){am=!1;var i=t.updateQueue;Ks=!1;var r=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var c=o,u=c.next;c.next=null,a===null?r=u:a.next=u,a=c;var d=t.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==a&&(o===null?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=c))}if(r!==null){var f=i.baseState;a=0,d=u=c=null,o=r;do{var h=o.lane&-536870913,m=h!==o.lane;if(m?(ve&h)===h:(s&h)===h){h!==0&&h===Ea&&(am=!0),d!==null&&(d=d.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var g=t,b=o;h=e;var x=n;switch(b.tag){case 1:if(g=b.payload,typeof g=="function"){f=g.call(x,f,h);break e}f=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=b.payload,h=typeof g=="function"?g.call(x,f,h):g,h==null)break e;f=Fe({},f,h);break e;case 2:Ks=!0}}h=o.callback,h!==null&&(t.flags|=64,m&&(t.flags|=8192),m=i.callbacks,m===null?i.callbacks=[h]:m.push(h))}else m={lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(u=d=m,c=f):d=d.next=m,a|=h;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;m=o,o=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);d===null&&(c=f),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=d,r===null&&(i.shared.lanes=0),Ti|=a,t.lanes=a,t.memoizedState=f}}function Z1(t,e){if(typeof t!="function")throw Error(P(191,t));t.call(e)}function ew(t,e){var n=t.callbacks;if(n!==null)for(t.callbacks=null,t=0;t<n.length;t++)Z1(n[t],e)}var Na=is(null),Au=is(0);function Jv(t,e){t=Cs,Be(Au,t),Be(Na,e),Cs=t|e.baseLanes}function om(){Be(Au,Cs),Be(Na,Na.current)}function ag(){Cs=Au.current,wt(Na),wt(Au)}var fn=is(null),Sn=null;function qs(t){var e=t.alternate;Be(nt,nt.current&1),Be(fn,t),Sn===null&&(e===null||Na.current!==null||e.memoizedState!==null)&&(Sn=t)}function lm(t){Be(nt,nt.current),Be(fn,t),Sn===null&&(Sn=t)}function tw(t){t.tag===22?(Be(nt,nt.current),Be(fn,t),Sn===null&&(Sn=t)):Ws()}function Ws(){Be(nt,nt.current),Be(fn,fn.current)}function nn(t){wt(fn),Sn===t&&(Sn=null),wt(nt)}var nt=is(0);function Ru(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||Tm(n)||Am(n)))return e}else if(e.tag===19&&(e.memoizedProps.revealOrder==="forwards"||e.memoizedProps.revealOrder==="backwards"||e.memoizedProps.revealOrder==="unstable_legacy-backwards"||e.memoizedProps.revealOrder==="together")){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var As=0,ce=null,Oe=null,at=null,Iu=!1,ua=!1,hr=!1,Cu=0,ul=0,da=null,rI=0;function Je(){throw Error(P(321))}function og(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!dn(t[n],e[n]))return!1;return!0}function lg(t,e,n,s,i,r){return As=r,ce=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ie.H=t===null||t.memoizedState===null?jw:xg,hr=!1,r=n(s,i),hr=!1,ua&&(r=sw(e,n,s,i)),nw(t),r}function nw(t){ie.H=dl;var e=Oe!==null&&Oe.next!==null;if(As=0,at=Oe=ce=null,Iu=!1,ul=0,da=null,e)throw Error(P(300));t===null||ct||(t=t.dependencies,t!==null&&Su(t)&&(ct=!0))}function sw(t,e,n,s){ce=t;var i=0;do{if(ua&&(da=null),ul=0,ua=!1,25<=i)throw Error(P(301));if(i+=1,at=Oe=null,t.updateQueue!=null){var r=t.updateQueue;r.lastEffect=null,r.events=null,r.stores=null,r.memoCache!=null&&(r.memoCache.index=0)}ie.H=Ow,r=e(n,s)}while(ua);return r}function aI(){var t=ie.H,e=t.useState()[0];return e=typeof e.then=="function"?Kl(e):e,t=t.useState()[0],(Oe!==null?Oe.memoizedState:null)!==t&&(ce.flags|=1024),e}function cg(){var t=Cu!==0;return Cu=0,t}function ug(t,e,n){e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~n}function dg(t){if(Iu){for(t=t.memoizedState;t!==null;){var e=t.queue;e!==null&&(e.pending=null),t=t.next}Iu=!1}As=0,at=Oe=ce=null,ua=!1,ul=Cu=0,da=null}function Dt(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return at===null?ce.memoizedState=at=t:at=at.next=t,at}function st(){if(Oe===null){var t=ce.alternate;t=t!==null?t.memoizedState:null}else t=Oe.next;var e=at===null?ce.memoizedState:at.next;if(e!==null)at=e,Oe=t;else{if(t===null)throw ce.alternate===null?Error(P(467)):Error(P(310));Oe=t,t={memoizedState:Oe.memoizedState,baseState:Oe.baseState,baseQueue:Oe.baseQueue,queue:Oe.queue,next:null},at===null?ce.memoizedState=at=t:at=at.next=t}return at}function Bd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Kl(t){var e=ul;return ul+=1,da===null&&(da=[]),t=X1(da,t,e),e=ce,(at===null?e.memoizedState:at.next)===null&&(e=e.alternate,ie.H=e===null||e.memoizedState===null?jw:xg),t}function Ud(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return Kl(t);if(t.$$typeof===ps)return It(t)}throw Error(P(438,String(t)))}function fg(t){var e=null,n=ce.updateQueue;if(n!==null&&(e=n.memoCache),e==null){var s=ce.alternate;s!==null&&(s=s.updateQueue,s!==null&&(s=s.memoCache,s!=null&&(e={data:s.data.map(function(i){return i.slice()}),index:0})))}if(e==null&&(e={data:[],index:0}),n===null&&(n=Bd(),ce.updateQueue=n),n.memoCache=e,n=e.data[e.index],n===void 0)for(n=e.data[e.index]=Array(t),s=0;s<t;s++)n[s]=$A;return e.index++,n}function Rs(t,e){return typeof e=="function"?e(t):e}function eu(t){var e=st();return hg(e,Oe,t)}function hg(t,e,n){var s=t.queue;if(s===null)throw Error(P(311));s.lastRenderedReducer=n;var i=t.baseQueue,r=s.pending;if(r!==null){if(i!==null){var a=i.next;i.next=r.next,r.next=a}e.baseQueue=i=r,s.pending=null}if(r=t.baseState,i===null)t.memoizedState=r;else{e=i.next;var o=a=null,c=null,u=e,d=!1;do{var f=u.lane&-536870913;if(f!==u.lane?(ve&f)===f:(As&f)===f){var h=u.revertLane;if(h===0)c!==null&&(c=c.next={lane:0,revertLane:0,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),f===Ea&&(d=!0);else if((As&h)===h){u=u.next,h===Ea&&(d=!0);continue}else f={lane:0,revertLane:u.revertLane,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},c===null?(o=c=f,a=r):c=c.next=f,ce.lanes|=h,Ti|=h;f=u.action,hr&&n(r,f),r=u.hasEagerState?u.eagerState:n(r,f)}else h={lane:f,revertLane:u.revertLane,gesture:u.gesture,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},c===null?(o=c=h,a=r):c=c.next=h,ce.lanes|=f,Ti|=f;u=u.next}while(u!==null&&u!==e);if(c===null?a=r:c.next=o,!dn(r,t.memoizedState)&&(ct=!0,d&&(n=la,n!==null)))throw n;t.memoizedState=r,t.baseState=a,t.baseQueue=c,s.lastRenderedState=r}return i===null&&(s.lanes=0),[t.memoizedState,s.dispatch]}function Hf(t){var e=st(),n=e.queue;if(n===null)throw Error(P(311));n.lastRenderedReducer=t;var s=n.dispatch,i=n.pending,r=e.memoizedState;if(i!==null){n.pending=null;var a=i=i.next;do r=t(r,a.action),a=a.next;while(a!==i);dn(r,e.memoizedState)||(ct=!0),e.memoizedState=r,e.baseQueue===null&&(e.baseState=r),n.lastRenderedState=r}return[r,s]}function iw(t,e,n){var s=ce,i=st(),r=be;if(r){if(n===void 0)throw Error(P(407));n=n()}else n=e();var a=!dn((Oe||i).memoizedState,n);if(a&&(i.memoizedState=n,ct=!0),i=i.queue,mg(ow.bind(null,s,i,t),[t]),i.getSnapshot!==e||a||at!==null&&at.memoizedState.tag&1){if(s.flags|=2048,ka(9,{destroy:void 0},aw.bind(null,s,i,n,e),null),Le===null)throw Error(P(349));r||As&127||rw(s,e,n)}return n}function rw(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ce.updateQueue,e===null?(e=Bd(),ce.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function aw(t,e,n,s){e.value=n,e.getSnapshot=s,lw(e)&&cw(t)}function ow(t,e,n){return n(function(){lw(e)&&cw(t)})}function lw(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!dn(t,n)}catch{return!0}}function cw(t){var e=Sr(t,2);e!==null&&Jt(e,t,2)}function cm(t){var e=Dt();if(typeof t=="function"){var n=t;if(t=n(),hr){ti(!0);try{n()}finally{ti(!1)}}}return e.memoizedState=e.baseState=t,e.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Rs,lastRenderedState:t},e}function uw(t,e,n,s){return t.baseState=n,hg(t,Oe,typeof s=="function"?s:Rs)}function oI(t,e,n,s,i){if(Gd(t))throw Error(P(485));if(t=e.action,t!==null){var r={payload:i,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(a){r.listeners.push(a)}};ie.T!==null?n(!0):r.isTransition=!1,s(r),n=e.pending,n===null?(r.next=e.pending=r,dw(e,r)):(r.next=n.next,e.pending=n.next=r)}}function dw(t,e){var n=e.action,s=e.payload,i=t.state;if(e.isTransition){var r=ie.T,a={};ie.T=a;try{var o=n(i,s),c=ie.S;c!==null&&c(a,o),Zv(t,e,o)}catch(u){um(t,e,u)}finally{r!==null&&a.types!==null&&(r.types=a.types),ie.T=r}}else try{r=n(i,s),Zv(t,e,r)}catch(u){um(t,e,u)}}function Zv(t,e,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(s){eb(t,e,s)},function(s){return um(t,e,s)}):eb(t,e,n)}function eb(t,e,n){e.status="fulfilled",e.value=n,fw(e),t.state=n,e=t.pending,e!==null&&(n=e.next,n===e?t.pending=null:(n=n.next,e.next=n,dw(t,n)))}function um(t,e,n){var s=t.pending;if(t.pending=null,s!==null){s=s.next;do e.status="rejected",e.reason=n,fw(e),e=e.next;while(e!==s)}t.action=null}function fw(t){t=t.listeners;for(var e=0;e<t.length;e++)(0,t[e])()}function hw(t,e){return e}function tb(t,e){if(be){var n=Le.formState;if(n!==null){e:{var s=ce;if(be){if(He){t:{for(var i=He,r=En;i.nodeType!==8;){if(!r){i=null;break t}if(i=Tn(i.nextSibling),i===null){i=null;break t}}r=i.data,i=r==="F!"||r==="F"?i:null}if(i){He=Tn(i.nextSibling),s=i.data==="F!";break e}}ki(s)}s=!1}s&&(e=n[0])}}return n=Dt(),n.memoizedState=n.baseState=e,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hw,lastRenderedState:e},n.queue=s,n=Rw.bind(null,ce,s),s.dispatch=n,s=cm(!1),r=bg.bind(null,ce,!1,s.queue),s=Dt(),i={state:e,dispatch:null,action:t,pending:null},s.queue=i,n=oI.bind(null,ce,i,r,n),i.dispatch=n,s.memoizedState=t,[e,n,!1]}function nb(t){var e=st();return mw(e,Oe,t)}function mw(t,e,n){if(e=hg(t,e,hw)[0],t=eu(Rs)[0],typeof e=="object"&&e!==null&&typeof e.then=="function")try{var s=Kl(e)}catch(a){throw a===Ka?Pd:a}else s=e;e=st();var i=e.queue,r=i.dispatch;return n!==e.memoizedState&&(ce.flags|=2048,ka(9,{destroy:void 0},lI.bind(null,i,n),null)),[s,r,t]}function lI(t,e){t.action=e}function sb(t){var e=st(),n=Oe;if(n!==null)return mw(e,n,t);st(),e=e.memoizedState,n=st();var s=n.queue.dispatch;return n.memoizedState=t,[e,s,!1]}function ka(t,e,n,s){return t={tag:t,create:n,deps:s,inst:e,next:null},e=ce.updateQueue,e===null&&(e=Bd(),ce.updateQueue=e),n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t),t}function pw(){return st().memoizedState}function tu(t,e,n,s){var i=Dt();ce.flags|=t,i.memoizedState=ka(1|e,{destroy:void 0},n,s===void 0?null:s)}function Hd(t,e,n,s){var i=st();s=s===void 0?null:s;var r=i.memoizedState.inst;Oe!==null&&s!==null&&og(s,Oe.memoizedState.deps)?i.memoizedState=ka(e,r,n,s):(ce.flags|=t,i.memoizedState=ka(1|e,r,n,s))}function ib(t,e){tu(8390656,8,t,e)}function mg(t,e){Hd(2048,8,t,e)}function cI(t){ce.flags|=4;var e=ce.updateQueue;if(e===null)e=Bd(),ce.updateQueue=e,e.events=[t];else{var n=e.events;n===null?e.events=[t]:n.push(t)}}function gw(t){var e=st().memoizedState;return cI({ref:e,nextImpl:t}),function(){if(Ee&2)throw Error(P(440));return e.impl.apply(void 0,arguments)}}function vw(t,e){return Hd(4,2,t,e)}function bw(t,e){return Hd(4,4,t,e)}function xw(t,e){if(typeof e=="function"){t=t();var n=e(t);return function(){typeof n=="function"?n():e(null)}}if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function yw(t,e,n){n=n!=null?n.concat([t]):null,Hd(4,4,xw.bind(null,e,t),n)}function pg(){}function _w(t,e){var n=st();e=e===void 0?null:e;var s=n.memoizedState;return e!==null&&og(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function ww(t,e){var n=st();e=e===void 0?null:e;var s=n.memoizedState;if(e!==null&&og(e,s[1]))return s[0];if(s=t(),hr){ti(!0);try{t()}finally{ti(!1)}}return n.memoizedState=[s,e],s}function gg(t,e,n){return n===void 0||As&1073741824&&!(ve&261930)?t.memoizedState=e:(t.memoizedState=n,t=uE(),ce.lanes|=t,Ti|=t,n)}function Ew(t,e,n,s){return dn(n,e)?n:Na.current!==null?(t=gg(t,n,s),dn(t,e)||(ct=!0),t):!(As&42)||As&1073741824&&!(ve&261930)?(ct=!0,t.memoizedState=n):(t=uE(),ce.lanes|=t,Ti|=t,e)}function Nw(t,e,n,s,i){var r=Ne.p;Ne.p=r!==0&&8>r?r:8;var a=ie.T,o={};ie.T=o,bg(t,!1,e,n);try{var c=i(),u=ie.S;if(u!==null&&u(o,c),c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=iI(c,s);Ho(t,e,d,un(t))}else Ho(t,e,s,un(t))}catch(f){Ho(t,e,{then:function(){},status:"rejected",reason:f},un())}finally{Ne.p=r,a!==null&&o.types!==null&&(a.types=o.types),ie.T=a}}function uI(){}function dm(t,e,n,s){if(t.tag!==5)throw Error(P(476));var i=kw(t).queue;Nw(t,i,e,tr,n===null?uI:function(){return Sw(t),n(s)})}function kw(t){var e=t.memoizedState;if(e!==null)return e;e={memoizedState:tr,baseState:tr,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Rs,lastRenderedState:tr},next:null};var n={};return e.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Rs,lastRenderedState:n},next:null},t.memoizedState=e,t=t.alternate,t!==null&&(t.memoizedState=e),e}function Sw(t){var e=kw(t);e.next===null&&(e=t.alternate.memoizedState),Ho(t,e.next.queue,{},un())}function vg(){return It(ml)}function Tw(){return st().memoizedState}function Aw(){return st().memoizedState}function dI(t){for(var e=t.return;e!==null;){switch(e.tag){case 24:case 3:var n=un();t=di(n);var s=fi(e,t,n);s!==null&&(Jt(s,e,n),Po(s,e,n)),e={cache:ng()},t.payload=e;return}e=e.return}}function fI(t,e,n){var s=un();n={lane:s,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},Gd(t)?Iw(e,n):(n=Jp(t,e,n,s),n!==null&&(Jt(n,t,s),Cw(n,e,s)))}function Rw(t,e,n){var s=un();Ho(t,e,n,s)}function Ho(t,e,n,s){var i={lane:s,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(Gd(t))Iw(e,i);else{var r=t.alternate;if(t.lanes===0&&(r===null||r.lanes===0)&&(r=e.lastRenderedReducer,r!==null))try{var a=e.lastRenderedState,o=r(a,n);if(i.hasEagerState=!0,i.eagerState=o,dn(o,a))return Ld(t,e,i,0),Le===null&&Dd(),!1}catch{}finally{}if(n=Jp(t,e,i,s),n!==null)return Jt(n,t,s),Cw(n,e,s),!0}return!1}function bg(t,e,n,s){if(s={lane:2,revertLane:Tg(),gesture:null,action:s,hasEagerState:!1,eagerState:null,next:null},Gd(t)){if(e)throw Error(P(479))}else e=Jp(t,n,s,2),e!==null&&Jt(e,t,2)}function Gd(t){var e=t.alternate;return t===ce||e!==null&&e===ce}function Iw(t,e){ua=Iu=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Cw(t,e,n){if(n&4194048){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,g1(t,n)}}var dl={readContext:It,use:Ud,useCallback:Je,useContext:Je,useEffect:Je,useImperativeHandle:Je,useLayoutEffect:Je,useInsertionEffect:Je,useMemo:Je,useReducer:Je,useRef:Je,useState:Je,useDebugValue:Je,useDeferredValue:Je,useTransition:Je,useSyncExternalStore:Je,useId:Je,useHostTransitionStatus:Je,useFormState:Je,useActionState:Je,useOptimistic:Je,useMemoCache:Je,useCacheRefresh:Je};dl.useEffectEvent=Je;var jw={readContext:It,use:Ud,useCallback:function(t,e){return Dt().memoizedState=[t,e===void 0?null:e],t},useContext:It,useEffect:ib,useImperativeHandle:function(t,e,n){n=n!=null?n.concat([t]):null,tu(4194308,4,xw.bind(null,e,t),n)},useLayoutEffect:function(t,e){return tu(4194308,4,t,e)},useInsertionEffect:function(t,e){tu(4,2,t,e)},useMemo:function(t,e){var n=Dt();e=e===void 0?null:e;var s=t();if(hr){ti(!0);try{t()}finally{ti(!1)}}return n.memoizedState=[s,e],s},useReducer:function(t,e,n){var s=Dt();if(n!==void 0){var i=n(e);if(hr){ti(!0);try{n(e)}finally{ti(!1)}}}else i=e;return s.memoizedState=s.baseState=i,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:i},s.queue=t,t=t.dispatch=fI.bind(null,ce,t),[s.memoizedState,t]},useRef:function(t){var e=Dt();return t={current:t},e.memoizedState=t},useState:function(t){t=cm(t);var e=t.queue,n=Rw.bind(null,ce,e);return e.dispatch=n,[t.memoizedState,n]},useDebugValue:pg,useDeferredValue:function(t,e){var n=Dt();return gg(n,t,e)},useTransition:function(){var t=cm(!1);return t=Nw.bind(null,ce,t.queue,!0,!1),Dt().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,e,n){var s=ce,i=Dt();if(be){if(n===void 0)throw Error(P(407));n=n()}else{if(n=e(),Le===null)throw Error(P(349));ve&127||rw(s,e,n)}i.memoizedState=n;var r={value:n,getSnapshot:e};return i.queue=r,ib(ow.bind(null,s,r,t),[t]),s.flags|=2048,ka(9,{destroy:void 0},aw.bind(null,s,r,n,e),null),n},useId:function(){var t=Dt(),e=Le.identifierPrefix;if(be){var n=Xn,s=Wn;n=(s&~(1<<32-cn(s)-1)).toString(32)+n,e="_"+e+"R_"+n,n=Cu++,0<n&&(e+="H"+n.toString(32)),e+="_"}else n=rI++,e="_"+e+"r_"+n.toString(32)+"_";return t.memoizedState=e},useHostTransitionStatus:vg,useFormState:tb,useActionState:tb,useOptimistic:function(t){var e=Dt();e.memoizedState=e.baseState=t;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return e.queue=n,e=bg.bind(null,ce,!0,n),n.dispatch=e,[t,e]},useMemoCache:fg,useCacheRefresh:function(){return Dt().memoizedState=dI.bind(null,ce)},useEffectEvent:function(t){var e=Dt(),n={impl:t};return e.memoizedState=n,function(){if(Ee&2)throw Error(P(440));return n.impl.apply(void 0,arguments)}}},xg={readContext:It,use:Ud,useCallback:_w,useContext:It,useEffect:mg,useImperativeHandle:yw,useInsertionEffect:vw,useLayoutEffect:bw,useMemo:ww,useReducer:eu,useRef:pw,useState:function(){return eu(Rs)},useDebugValue:pg,useDeferredValue:function(t,e){var n=st();return Ew(n,Oe.memoizedState,t,e)},useTransition:function(){var t=eu(Rs)[0],e=st().memoizedState;return[typeof t=="boolean"?t:Kl(t),e]},useSyncExternalStore:iw,useId:Tw,useHostTransitionStatus:vg,useFormState:nb,useActionState:nb,useOptimistic:function(t,e){var n=st();return uw(n,Oe,t,e)},useMemoCache:fg,useCacheRefresh:Aw};xg.useEffectEvent=gw;var Ow={readContext:It,use:Ud,useCallback:_w,useContext:It,useEffect:mg,useImperativeHandle:yw,useInsertionEffect:vw,useLayoutEffect:bw,useMemo:ww,useReducer:Hf,useRef:pw,useState:function(){return Hf(Rs)},useDebugValue:pg,useDeferredValue:function(t,e){var n=st();return Oe===null?gg(n,t,e):Ew(n,Oe.memoizedState,t,e)},useTransition:function(){var t=Hf(Rs)[0],e=st().memoizedState;return[typeof t=="boolean"?t:Kl(t),e]},useSyncExternalStore:iw,useId:Tw,useHostTransitionStatus:vg,useFormState:sb,useActionState:sb,useOptimistic:function(t,e){var n=st();return Oe!==null?uw(n,Oe,t,e):(n.baseState=t,[t,n.queue.dispatch])},useMemoCache:fg,useCacheRefresh:Aw};Ow.useEffectEvent=gw;function Gf(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:Fe({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var fm={enqueueSetState:function(t,e,n){t=t._reactInternals;var s=un(),i=di(s);i.payload=e,n!=null&&(i.callback=n),e=fi(t,i,s),e!==null&&(Jt(e,t,s),Po(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=un(),i=di(s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=fi(t,i,s),e!==null&&(Jt(e,t,s),Po(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=un(),s=di(n);s.tag=2,e!=null&&(s.callback=e),e=fi(t,s,n),e!==null&&(Jt(e,t,n),Po(e,t,n))}};function rb(t,e,n,s,i,r,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,r,a):e.prototype&&e.prototype.isPureReactComponent?!al(n,s)||!al(i,r):!0}function ab(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&fm.enqueueReplaceState(e,e.state,null)}function mr(t,e){var n=e;if("ref"in e){n={};for(var s in e)s!=="ref"&&(n[s]=e[s])}if(t=t.defaultProps){n===e&&(n=Fe({},n));for(var i in t)n[i]===void 0&&(n[i]=t[i])}return n}function Mw(t){Eu(t)}function Dw(t){console.error(t)}function Lw(t){Eu(t)}function ju(t,e){try{var n=t.onUncaughtError;n(e.value,{componentStack:e.stack})}catch(s){setTimeout(function(){throw s})}}function ob(t,e,n){try{var s=t.onCaughtError;s(n.value,{componentStack:n.stack,errorBoundary:e.tag===1?e.stateNode:null})}catch(i){setTimeout(function(){throw i})}}function hm(t,e,n){return n=di(n),n.tag=3,n.payload={element:null},n.callback=function(){ju(t,e)},n}function Pw(t){return t=di(t),t.tag=3,t}function Bw(t,e,n,s){var i=n.type.getDerivedStateFromError;if(typeof i=="function"){var r=s.value;t.payload=function(){return i(r)},t.callback=function(){ob(e,n,s)}}var a=n.stateNode;a!==null&&typeof a.componentDidCatch=="function"&&(t.callback=function(){ob(e,n,s),typeof i!="function"&&(hi===null?hi=new Set([this]):hi.add(this));var o=s.stack;this.componentDidCatch(s.value,{componentStack:o!==null?o:""})})}function hI(t,e,n,s,i){if(n.flags|=32768,s!==null&&typeof s=="object"&&typeof s.then=="function"){if(e=n.alternate,e!==null&&$a(e,n,i,!0),n=fn.current,n!==null){switch(n.tag){case 31:case 13:return Sn===null?Pu():n.alternate===null&&et===0&&(et=3),n.flags&=-257,n.flags|=65536,n.lanes=i,s===Tu?n.flags|=16384:(e=n.updateQueue,e===null?n.updateQueue=new Set([s]):e.add(s),Jf(t,s,i)),!1;case 22:return n.flags|=65536,s===Tu?n.flags|=16384:(e=n.updateQueue,e===null?(e={transitions:null,markerInstances:null,retryQueue:new Set([s])},n.updateQueue=e):(n=e.retryQueue,n===null?e.retryQueue=new Set([s]):n.add(s)),Jf(t,s,i)),!1}throw Error(P(435,n.tag))}return Jf(t,s,i),Pu(),!1}if(be)return e=fn.current,e!==null?(!(e.flags&65536)&&(e.flags|=256),e.flags|=65536,e.lanes=i,s!==em&&(t=Error(P(422),{cause:s}),ll(wn(t,n)))):(s!==em&&(e=Error(P(423),{cause:s}),ll(wn(e,n))),t=t.current.alternate,t.flags|=65536,i&=-i,t.lanes|=i,s=wn(s,n),i=hm(t.stateNode,s,i),Uf(t,i),et!==4&&(et=2)),!1;var r=Error(P(520),{cause:s});if(r=wn(r,n),Fo===null?Fo=[r]:Fo.push(r),et!==4&&(et=2),e===null)return!0;s=wn(s,n),n=e;do{switch(n.tag){case 3:return n.flags|=65536,t=i&-i,n.lanes|=t,t=hm(n.stateNode,s,t),Uf(n,t),!1;case 1:if(e=n.type,r=n.stateNode,(n.flags&128)===0&&(typeof e.getDerivedStateFromError=="function"||r!==null&&typeof r.componentDidCatch=="function"&&(hi===null||!hi.has(r))))return n.flags|=65536,i&=-i,n.lanes|=i,i=Pw(i),Bw(i,t,n,s),Uf(n,i),!1}n=n.return}while(n!==null);return!1}var yg=Error(P(461)),ct=!1;function St(t,e,n,s){e.child=t===null?J1(e,null,n,s):fr(e,t.child,n,s)}function lb(t,e,n,s,i){n=n.render;var r=e.ref;if("ref"in s){var a={};for(var o in s)o!=="ref"&&(a[o]=s[o])}else a=s;return dr(e),s=lg(t,e,n,a,r,i),o=cg(),t!==null&&!ct?(ug(t,e,i),Is(t,e,i)):(be&&o&&eg(e),e.flags|=1,St(t,e,s,i),e.child)}function cb(t,e,n,s,i){if(t===null){var r=n.type;return typeof r=="function"&&!Zp(r)&&r.defaultProps===void 0&&n.compare===null?(e.tag=15,e.type=r,Uw(t,e,r,s,i)):(t=Jc(n.type,null,s,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(r=t.child,!_g(t,i)){var a=r.memoizedProps;if(n=n.compare,n=n!==null?n:al,n(a,s)&&t.ref===e.ref)return Is(t,e,i)}return e.flags|=1,t=ws(r,s),t.ref=e.ref,t.return=e,e.child=t}function Uw(t,e,n,s,i){if(t!==null){var r=t.memoizedProps;if(al(r,s)&&t.ref===e.ref)if(ct=!1,e.pendingProps=s=r,_g(t,i))t.flags&131072&&(ct=!0);else return e.lanes=t.lanes,Is(t,e,i)}return mm(t,e,n,s,i)}function Hw(t,e,n,s){var i=s.children,r=t!==null?t.memoizedState:null;if(t===null&&e.stateNode===null&&(e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.mode==="hidden"){if(e.flags&128){if(r=r!==null?r.baseLanes|n:n,t!==null){for(s=e.child=t.child,i=0;s!==null;)i=i|s.lanes|s.childLanes,s=s.sibling;s=i&~r}else s=0,e.child=null;return ub(t,e,r,n,s)}if(n&536870912)e.memoizedState={baseLanes:0,cachePool:null},t!==null&&Zc(e,r!==null?r.cachePool:null),r!==null?Jv(e,r):om(),tw(e);else return s=e.lanes=536870912,ub(t,e,r!==null?r.baseLanes|n:n,n,s)}else r!==null?(Zc(e,r.cachePool),Jv(e,r),Ws(),e.memoizedState=null):(t!==null&&Zc(e,null),om(),Ws());return St(t,e,i,n),e.child}function So(t,e){return t!==null&&t.tag===22||e.stateNode!==null||(e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),e.sibling}function ub(t,e,n,s,i){var r=sg();return r=r===null?null:{parent:lt._currentValue,pool:r},e.memoizedState={baseLanes:n,cachePool:r},t!==null&&Zc(e,null),om(),tw(e),t!==null&&$a(t,e,s,!0),e.childLanes=i,null}function nu(t,e){return e=Ou({mode:e.mode,children:e.children},t.mode),e.ref=t.ref,t.child=e,e.return=t,e}function db(t,e,n){return fr(e,t.child,null,n),t=nu(e,e.pendingProps),t.flags|=2,nn(e),e.memoizedState=null,t}function mI(t,e,n){var s=e.pendingProps,i=(e.flags&128)!==0;if(e.flags&=-129,t===null){if(be){if(s.mode==="hidden")return t=nu(e,s),e.lanes=536870912,So(null,t);if(lm(e),(t=He)?(t=jE(t,En),t=t!==null&&t.data==="&"?t:null,t!==null&&(e.memoizedState={dehydrated:t,treeContext:Ni!==null?{id:Wn,overflow:Xn}:null,retryLane:536870912,hydrationErrors:null},n=$1(t),n.return=e,e.child=n,At=e,He=null)):t=null,t===null)throw ki(e);return e.lanes=536870912,null}return nu(e,s)}var r=t.memoizedState;if(r!==null){var a=r.dehydrated;if(lm(e),i)if(e.flags&256)e.flags&=-257,e=db(t,e,n);else if(e.memoizedState!==null)e.child=t.child,e.flags|=128,e=null;else throw Error(P(558));else if(ct||$a(t,e,n,!1),i=(n&t.childLanes)!==0,ct||i){if(s=Le,s!==null&&(a=v1(s,n),a!==0&&a!==r.retryLane))throw r.retryLane=a,Sr(t,a),Jt(s,t,a),yg;Pu(),e=db(t,e,n)}else t=r.treeContext,He=Tn(a.nextSibling),At=e,be=!0,ui=null,En=!1,t!==null&&Y1(e,t),e=nu(e,s),e.flags|=4096;return e}return t=ws(t.child,{mode:s.mode,children:s.children}),t.ref=e.ref,e.child=t,t.return=e,t}function su(t,e){var n=e.ref;if(n===null)t!==null&&t.ref!==null&&(e.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(P(284));(t===null||t.ref!==n)&&(e.flags|=4194816)}}function mm(t,e,n,s,i){return dr(e),n=lg(t,e,n,s,void 0,i),s=cg(),t!==null&&!ct?(ug(t,e,i),Is(t,e,i)):(be&&s&&eg(e),e.flags|=1,St(t,e,n,i),e.child)}function fb(t,e,n,s,i,r){return dr(e),e.updateQueue=null,n=sw(e,s,n,i),nw(t),s=cg(),t!==null&&!ct?(ug(t,e,r),Is(t,e,r)):(be&&s&&eg(e),e.flags|=1,St(t,e,n,r),e.child)}function hb(t,e,n,s,i){if(dr(e),e.stateNode===null){var r=qr,a=n.contextType;typeof a=="object"&&a!==null&&(r=It(a)),r=new n(s,r),e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=fm,e.stateNode=r,r._reactInternals=e,r=e.stateNode,r.props=s,r.state=e.memoizedState,r.refs={},rg(e),a=n.contextType,r.context=typeof a=="object"&&a!==null?It(a):qr,r.state=e.memoizedState,a=n.getDerivedStateFromProps,typeof a=="function"&&(Gf(e,n,a,s),r.state=e.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(a=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),a!==r.state&&fm.enqueueReplaceState(r,r.state,null),Uo(e,s,r,i),Bo(),r.state=e.memoizedState),typeof r.componentDidMount=="function"&&(e.flags|=4194308),s=!0}else if(t===null){r=e.stateNode;var o=e.memoizedProps,c=mr(n,o);r.props=c;var u=r.context,d=n.contextType;a=qr,typeof d=="object"&&d!==null&&(a=It(d));var f=n.getDerivedStateFromProps;d=typeof f=="function"||typeof r.getSnapshotBeforeUpdate=="function",o=e.pendingProps!==o,d||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(o||u!==a)&&ab(e,r,s,a),Ks=!1;var h=e.memoizedState;r.state=h,Uo(e,s,r,i),Bo(),u=e.memoizedState,o||h!==u||Ks?(typeof f=="function"&&(Gf(e,n,f,s),u=e.memoizedState),(c=Ks||rb(e,n,c,s,h,u,a))?(d||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount()),typeof r.componentDidMount=="function"&&(e.flags|=4194308)):(typeof r.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=u),r.props=s,r.state=u,r.context=a,s=c):(typeof r.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{r=e.stateNode,rm(t,e),a=e.memoizedProps,d=mr(n,a),r.props=d,f=e.pendingProps,h=r.context,u=n.contextType,c=qr,typeof u=="object"&&u!==null&&(c=It(u)),o=n.getDerivedStateFromProps,(u=typeof o=="function"||typeof r.getSnapshotBeforeUpdate=="function")||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(a!==f||h!==c)&&ab(e,r,s,c),Ks=!1,h=e.memoizedState,r.state=h,Uo(e,s,r,i),Bo();var m=e.memoizedState;a!==f||h!==m||Ks||t!==null&&t.dependencies!==null&&Su(t.dependencies)?(typeof o=="function"&&(Gf(e,n,o,s),m=e.memoizedState),(d=Ks||rb(e,n,d,s,h,m,c)||t!==null&&t.dependencies!==null&&Su(t.dependencies))?(u||typeof r.UNSAFE_componentWillUpdate!="function"&&typeof r.componentWillUpdate!="function"||(typeof r.componentWillUpdate=="function"&&r.componentWillUpdate(s,m,c),typeof r.UNSAFE_componentWillUpdate=="function"&&r.UNSAFE_componentWillUpdate(s,m,c)),typeof r.componentDidUpdate=="function"&&(e.flags|=4),typeof r.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof r.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=m),r.props=s,r.state=m,r.context=c,s=d):(typeof r.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),s=!1)}return r=s,su(t,e),s=(e.flags&128)!==0,r||s?(r=e.stateNode,n=s&&typeof n.getDerivedStateFromError!="function"?null:r.render(),e.flags|=1,t!==null&&s?(e.child=fr(e,t.child,null,i),e.child=fr(e,null,n,i)):St(t,e,n,i),e.memoizedState=r.state,t=e.child):t=Is(t,e,i),t}function mb(t,e,n,s){return ur(),e.flags|=256,St(t,e,n,s),e.child}var Vf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ff(t){return{baseLanes:t,cachePool:W1()}}function zf(t,e,n){return t=t!==null?t.childLanes&~n:0,e&&(t|=an),t}function Gw(t,e,n){var s=e.pendingProps,i=!1,r=(e.flags&128)!==0,a;if((a=r)||(a=t!==null&&t.memoizedState===null?!1:(nt.current&2)!==0),a&&(i=!0,e.flags&=-129),a=(e.flags&32)!==0,e.flags&=-33,t===null){if(be){if(i?qs(e):Ws(),(t=He)?(t=jE(t,En),t=t!==null&&t.data!=="&"?t:null,t!==null&&(e.memoizedState={dehydrated:t,treeContext:Ni!==null?{id:Wn,overflow:Xn}:null,retryLane:536870912,hydrationErrors:null},n=$1(t),n.return=e,e.child=n,At=e,He=null)):t=null,t===null)throw ki(e);return Am(t)?e.lanes=32:e.lanes=536870912,null}var o=s.children;return s=s.fallback,i?(Ws(),i=e.mode,o=Ou({mode:"hidden",children:o},i),s=nr(s,i,n,null),o.return=e,s.return=e,o.sibling=s,e.child=o,s=e.child,s.memoizedState=Ff(n),s.childLanes=zf(t,a,n),e.memoizedState=Vf,So(null,s)):(qs(e),pm(e,o))}var c=t.memoizedState;if(c!==null&&(o=c.dehydrated,o!==null)){if(r)e.flags&256?(qs(e),e.flags&=-257,e=$f(t,e,n)):e.memoizedState!==null?(Ws(),e.child=t.child,e.flags|=128,e=null):(Ws(),o=s.fallback,i=e.mode,s=Ou({mode:"visible",children:s.children},i),o=nr(o,i,n,null),o.flags|=2,s.return=e,o.return=e,s.sibling=o,e.child=s,fr(e,t.child,null,n),s=e.child,s.memoizedState=Ff(n),s.childLanes=zf(t,a,n),e.memoizedState=Vf,e=So(null,s));else if(qs(e),Am(o)){if(a=o.nextSibling&&o.nextSibling.dataset,a)var u=a.dgst;a=u,s=Error(P(419)),s.stack="",s.digest=a,ll({value:s,source:null,stack:null}),e=$f(t,e,n)}else if(ct||$a(t,e,n,!1),a=(n&t.childLanes)!==0,ct||a){if(a=Le,a!==null&&(s=v1(a,n),s!==0&&s!==c.retryLane))throw c.retryLane=s,Sr(t,s),Jt(a,t,s),yg;Tm(o)||Pu(),e=$f(t,e,n)}else Tm(o)?(e.flags|=192,e.child=t.child,e=null):(t=c.treeContext,He=Tn(o.nextSibling),At=e,be=!0,ui=null,En=!1,t!==null&&Y1(e,t),e=pm(e,s.children),e.flags|=4096);return e}return i?(Ws(),o=s.fallback,i=e.mode,c=t.child,u=c.sibling,s=ws(c,{mode:"hidden",children:s.children}),s.subtreeFlags=c.subtreeFlags&65011712,u!==null?o=ws(u,o):(o=nr(o,i,n,null),o.flags|=2),o.return=e,s.return=e,s.sibling=o,e.child=s,So(null,s),s=e.child,o=t.child.memoizedState,o===null?o=Ff(n):(i=o.cachePool,i!==null?(c=lt._currentValue,i=i.parent!==c?{parent:c,pool:c}:i):i=W1(),o={baseLanes:o.baseLanes|n,cachePool:i}),s.memoizedState=o,s.childLanes=zf(t,a,n),e.memoizedState=Vf,So(t.child,s)):(qs(e),n=t.child,t=n.sibling,n=ws(n,{mode:"visible",children:s.children}),n.return=e,n.sibling=null,t!==null&&(a=e.deletions,a===null?(e.deletions=[t],e.flags|=16):a.push(t)),e.child=n,e.memoizedState=null,n)}function pm(t,e){return e=Ou({mode:"visible",children:e},t.mode),e.return=t,t.child=e}function Ou(t,e){return t=sn(22,t,null,e),t.lanes=0,t}function $f(t,e,n){return fr(e,t.child,null,n),t=pm(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function pb(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),nm(t.return,e,n)}function Kf(t,e,n,s,i,r){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:i,treeForkCount:r}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=s,a.tail=n,a.tailMode=i,a.treeForkCount=r)}function Vw(t,e,n){var s=e.pendingProps,i=s.revealOrder,r=s.tail;s=s.children;var a=nt.current,o=(a&2)!==0;if(o?(a=a&1|2,e.flags|=128):a&=1,Be(nt,a),St(t,e,s,n),s=be?ol:0,!o&&t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&pb(t,n,e);else if(t.tag===19)pb(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Ru(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Kf(e,!1,i,n,r,s);break;case"backwards":case"unstable_legacy-backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Ru(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Kf(e,!0,n,null,r,s);break;case"together":Kf(e,!1,null,null,void 0,s);break;default:e.memoizedState=null}return e.child}function Is(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ti|=e.lanes,!(n&e.childLanes))if(t!==null){if($a(t,e,n,!1),(n&e.childLanes)===0)return null}else return null;if(t!==null&&e.child!==t.child)throw Error(P(153));if(e.child!==null){for(t=e.child,n=ws(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ws(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function _g(t,e){return t.lanes&e?!0:(t=t.dependencies,!!(t!==null&&Su(t)))}function pI(t,e,n){switch(e.tag){case 3:xu(e,e.stateNode.containerInfo),Ys(e,lt,t.memoizedState.cache),ur();break;case 27:case 5:Fh(e);break;case 4:xu(e,e.stateNode.containerInfo);break;case 10:Ys(e,e.type,e.memoizedProps.value);break;case 31:if(e.memoizedState!==null)return e.flags|=128,lm(e),null;break;case 13:var s=e.memoizedState;if(s!==null)return s.dehydrated!==null?(qs(e),e.flags|=128,null):n&e.child.childLanes?Gw(t,e,n):(qs(e),t=Is(t,e,n),t!==null?t.sibling:null);qs(e);break;case 19:var i=(t.flags&128)!==0;if(s=(n&e.childLanes)!==0,s||($a(t,e,n,!1),s=(n&e.childLanes)!==0),i){if(s)return Vw(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Be(nt,nt.current),s)break;return null;case 22:return e.lanes=0,Hw(t,e,n,e.pendingProps);case 24:Ys(e,lt,t.memoizedState.cache)}return Is(t,e,n)}function Fw(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps)ct=!0;else{if(!_g(t,n)&&!(e.flags&128))return ct=!1,pI(t,e,n);ct=!!(t.flags&131072)}else ct=!1,be&&e.flags&1048576&&K1(e,ol,e.index);switch(e.lanes=0,e.tag){case 16:e:{var s=e.pendingProps;if(t=Ki(e.elementType),e.type=t,typeof t=="function")Zp(t)?(s=mr(t,s),e.tag=1,e=hb(null,e,t,s,n)):(e.tag=0,e=mm(null,e,t,s,n));else{if(t!=null){var i=t.$$typeof;if(i===Up){e.tag=11,e=lb(null,e,t,s,n);break e}else if(i===Hp){e.tag=14,e=cb(null,e,t,s,n);break e}}throw e=Gh(t)||t,Error(P(306,e,""))}}return e;case 0:return mm(t,e,e.type,e.pendingProps,n);case 1:return s=e.type,i=mr(s,e.pendingProps),hb(t,e,s,i,n);case 3:e:{if(xu(e,e.stateNode.containerInfo),t===null)throw Error(P(387));s=e.pendingProps;var r=e.memoizedState;i=r.element,rm(t,e),Uo(e,s,null,n);var a=e.memoizedState;if(s=a.cache,Ys(e,lt,s),s!==r.cache&&sm(e,[lt],n,!0),Bo(),s=a.element,r.isDehydrated)if(r={element:s,isDehydrated:!1,cache:a.cache},e.updateQueue.baseState=r,e.memoizedState=r,e.flags&256){e=mb(t,e,s,n);break e}else if(s!==i){i=wn(Error(P(424)),e),ll(i),e=mb(t,e,s,n);break e}else{switch(t=e.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(He=Tn(t.firstChild),At=e,be=!0,ui=null,En=!0,n=J1(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(ur(),s===i){e=Is(t,e,n);break e}St(t,e,s,n)}e=e.child}return e;case 26:return su(t,e),t===null?(n=Db(e.type,null,e.pendingProps,null))?e.memoizedState=n:be||(n=e.type,t=e.pendingProps,s=Gu(ci.current).createElement(n),s[Tt]=e,s[Zt]=t,Ct(s,n,t),yt(s),e.stateNode=s):e.memoizedState=Db(e.type,t.memoizedProps,e.pendingProps,t.memoizedState),null;case 27:return Fh(e),t===null&&be&&(s=e.stateNode=OE(e.type,e.pendingProps,ci.current),At=e,En=!0,i=He,Li(e.type)?(Rm=i,He=Tn(s.firstChild)):He=i),St(t,e,e.pendingProps.children,n),su(t,e),t===null&&(e.flags|=4194304),e.child;case 5:return t===null&&be&&((i=s=He)&&(s=$I(s,e.type,e.pendingProps,En),s!==null?(e.stateNode=s,At=e,He=Tn(s.firstChild),En=!1,i=!0):i=!1),i||ki(e)),Fh(e),i=e.type,r=e.pendingProps,a=t!==null?t.memoizedProps:null,s=r.children,km(i,r)?s=null:a!==null&&km(i,a)&&(e.flags|=32),e.memoizedState!==null&&(i=lg(t,e,aI,null,null,n),ml._currentValue=i),su(t,e),St(t,e,s,n),e.child;case 6:return t===null&&be&&((t=n=He)&&(n=KI(n,e.pendingProps,En),n!==null?(e.stateNode=n,At=e,He=null,t=!0):t=!1),t||ki(e)),null;case 13:return Gw(t,e,n);case 4:return xu(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=fr(e,null,s,n):St(t,e,s,n),e.child;case 11:return lb(t,e,e.type,e.pendingProps,n);case 7:return St(t,e,e.pendingProps,n),e.child;case 8:return St(t,e,e.pendingProps.children,n),e.child;case 12:return St(t,e,e.pendingProps.children,n),e.child;case 10:return s=e.pendingProps,Ys(e,e.type,s.value),St(t,e,s.children,n),e.child;case 9:return i=e.type._context,s=e.pendingProps.children,dr(e),i=It(i),s=s(i),e.flags|=1,St(t,e,s,n),e.child;case 14:return cb(t,e,e.type,e.pendingProps,n);case 15:return Uw(t,e,e.type,e.pendingProps,n);case 19:return Vw(t,e,n);case 31:return mI(t,e,n);case 22:return Hw(t,e,n,e.pendingProps);case 24:return dr(e),s=It(lt),t===null?(i=sg(),i===null&&(i=Le,r=ng(),i.pooledCache=r,r.refCount++,r!==null&&(i.pooledCacheLanes|=n),i=r),e.memoizedState={parent:s,cache:i},rg(e),Ys(e,lt,i)):(t.lanes&n&&(rm(t,e),Uo(e,null,null,n),Bo()),i=t.memoizedState,r=e.memoizedState,i.parent!==s?(i={parent:s,cache:s},e.memoizedState=i,e.lanes===0&&(e.memoizedState=e.updateQueue.baseState=i),Ys(e,lt,s)):(s=r.cache,Ys(e,lt,s),s!==i.cache&&sm(e,[lt],n,!0))),St(t,e,e.pendingProps.children,n),e.child;case 29:throw e.pendingProps}throw Error(P(156,e.tag))}function ls(t){t.flags|=4}function Yf(t,e,n,s,i){if((e=(t.mode&32)!==0)&&(e=!1),e){if(t.flags|=16777216,(i&335544128)===i)if(t.stateNode.complete)t.flags|=8192;else if(hE())t.flags|=8192;else throw ir=Tu,ig}else t.flags&=-16777217}function gb(t,e){if(e.type!=="stylesheet"||e.state.loading&4)t.flags&=-16777217;else if(t.flags|=16777216,!LE(e))if(hE())t.flags|=8192;else throw ir=Tu,ig}function Cc(t,e){e!==null&&(t.flags|=4),t.flags&16384&&(e=t.tag!==22?m1():536870912,t.lanes|=e,Sa|=e)}function po(t,e){if(!be)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function Ue(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,s|=i.subtreeFlags&65011712,s|=i.flags&65011712,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,s|=i.subtreeFlags,s|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function gI(t,e,n){var s=e.pendingProps;switch(tg(e),e.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ue(e),null;case 1:return Ue(e),null;case 3:return n=e.stateNode,s=null,t!==null&&(s=t.memoizedState.cache),e.memoizedState.cache!==s&&(e.flags|=2048),Es(lt),ya(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(jr(e)?ls(e):t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Bf())),Ue(e),null;case 26:var i=e.type,r=e.memoizedState;return t===null?(ls(e),r!==null?(Ue(e),gb(e,r)):(Ue(e),Yf(e,i,null,s,n))):r?r!==t.memoizedState?(ls(e),Ue(e),gb(e,r)):(Ue(e),e.flags&=-16777217):(t=t.memoizedProps,t!==s&&ls(e),Ue(e),Yf(e,i,t,s,n)),null;case 27:if(yu(e),n=ci.current,i=e.type,t!==null&&e.stateNode!=null)t.memoizedProps!==s&&ls(e);else{if(!s){if(e.stateNode===null)throw Error(P(166));return Ue(e),null}t=Jn.current,jr(e)?$v(e):(t=OE(i,s,n),e.stateNode=t,ls(e))}return Ue(e),null;case 5:if(yu(e),i=e.type,t!==null&&e.stateNode!=null)t.memoizedProps!==s&&ls(e);else{if(!s){if(e.stateNode===null)throw Error(P(166));return Ue(e),null}if(r=Jn.current,jr(e))$v(e);else{var a=Gu(ci.current);switch(r){case 1:r=a.createElementNS("http://www.w3.org/2000/svg",i);break;case 2:r=a.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;default:switch(i){case"svg":r=a.createElementNS("http://www.w3.org/2000/svg",i);break;case"math":r=a.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;case"script":r=a.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof s.is=="string"?a.createElement("select",{is:s.is}):a.createElement("select"),s.multiple?r.multiple=!0:s.size&&(r.size=s.size);break;default:r=typeof s.is=="string"?a.createElement(i,{is:s.is}):a.createElement(i)}}r[Tt]=e,r[Zt]=s;e:for(a=e.child;a!==null;){if(a.tag===5||a.tag===6)r.appendChild(a.stateNode);else if(a.tag!==4&&a.tag!==27&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===e)break e;for(;a.sibling===null;){if(a.return===null||a.return===e)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}e.stateNode=r;e:switch(Ct(r,i,s),i){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&ls(e)}}return Ue(e),Yf(e,e.type,t===null?null:t.memoizedProps,e.pendingProps,n),null;case 6:if(t&&e.stateNode!=null)t.memoizedProps!==s&&ls(e);else{if(typeof s!="string"&&e.stateNode===null)throw Error(P(166));if(t=ci.current,jr(e)){if(t=e.stateNode,n=e.memoizedProps,s=null,i=At,i!==null)switch(i.tag){case 27:case 5:s=i.memoizedProps}t[Tt]=e,t=!!(t.nodeValue===n||s!==null&&s.suppressHydrationWarning===!0||RE(t.nodeValue,n)),t||ki(e,!0)}else t=Gu(t).createTextNode(s),t[Tt]=e,e.stateNode=t}return Ue(e),null;case 31:if(n=e.memoizedState,t===null||t.memoizedState!==null){if(s=jr(e),n!==null){if(t===null){if(!s)throw Error(P(318));if(t=e.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(P(557));t[Tt]=e}else ur(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ue(e),t=!1}else n=Bf(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=n),t=!0;if(!t)return e.flags&256?(nn(e),e):(nn(e),null);if(e.flags&128)throw Error(P(558))}return Ue(e),null;case 13:if(s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(i=jr(e),s!==null&&s.dehydrated!==null){if(t===null){if(!i)throw Error(P(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(P(317));i[Tt]=e}else ur(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ue(e),i=!1}else i=Bf(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=i),i=!0;if(!i)return e.flags&256?(nn(e),e):(nn(e),null)}return nn(e),e.flags&128?(e.lanes=n,e):(n=s!==null,t=t!==null&&t.memoizedState!==null,n&&(s=e.child,i=null,s.alternate!==null&&s.alternate.memoizedState!==null&&s.alternate.memoizedState.cachePool!==null&&(i=s.alternate.memoizedState.cachePool.pool),r=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(r=s.memoizedState.cachePool.pool),r!==i&&(s.flags|=2048)),n!==t&&n&&(e.child.flags|=8192),Cc(e,e.updateQueue),Ue(e),null);case 4:return ya(),t===null&&Ag(e.stateNode.containerInfo),Ue(e),null;case 10:return Es(e.type),Ue(e),null;case 19:if(wt(nt),s=e.memoizedState,s===null)return Ue(e),null;if(i=(e.flags&128)!==0,r=s.rendering,r===null)if(i)po(s,!1);else{if(et!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(r=Ru(t),r!==null){for(e.flags|=128,po(s,!1),t=r.updateQueue,e.updateQueue=t,Cc(e,t),e.subtreeFlags=0,t=n,n=e.child;n!==null;)z1(n,t),n=n.sibling;return Be(nt,nt.current&1|2),be&&hs(e,s.treeForkCount),e.child}t=t.sibling}s.tail!==null&&on()>Du&&(e.flags|=128,i=!0,po(s,!1),e.lanes=4194304)}else{if(!i)if(t=Ru(r),t!==null){if(e.flags|=128,i=!0,t=t.updateQueue,e.updateQueue=t,Cc(e,t),po(s,!0),s.tail===null&&s.tailMode==="hidden"&&!r.alternate&&!be)return Ue(e),null}else 2*on()-s.renderingStartTime>Du&&n!==536870912&&(e.flags|=128,i=!0,po(s,!1),e.lanes=4194304);s.isBackwards?(r.sibling=e.child,e.child=r):(t=s.last,t!==null?t.sibling=r:e.child=r,s.last=r)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=on(),t.sibling=null,n=nt.current,Be(nt,i?n&1|2:n&1),be&&hs(e,s.treeForkCount),t):(Ue(e),null);case 22:case 23:return nn(e),ag(),s=e.memoizedState!==null,t!==null?t.memoizedState!==null!==s&&(e.flags|=8192):s&&(e.flags|=8192),s?n&536870912&&!(e.flags&128)&&(Ue(e),e.subtreeFlags&6&&(e.flags|=8192)):Ue(e),n=e.updateQueue,n!==null&&Cc(e,n.retryQueue),n=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(n=t.memoizedState.cachePool.pool),s=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(s=e.memoizedState.cachePool.pool),s!==n&&(e.flags|=2048),t!==null&&wt(sr),null;case 24:return n=null,t!==null&&(n=t.memoizedState.cache),e.memoizedState.cache!==n&&(e.flags|=2048),Es(lt),Ue(e),null;case 25:return null;case 30:return null}throw Error(P(156,e.tag))}function vI(t,e){switch(tg(e),e.tag){case 1:return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Es(lt),ya(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 26:case 27:case 5:return yu(e),null;case 31:if(e.memoizedState!==null){if(nn(e),e.alternate===null)throw Error(P(340));ur()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 13:if(nn(e),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(P(340));ur()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return wt(nt),null;case 4:return ya(),null;case 10:return Es(e.type),null;case 22:case 23:return nn(e),ag(),t!==null&&wt(sr),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 24:return Es(lt),null;case 25:return null;default:return null}}function zw(t,e){switch(tg(e),e.tag){case 3:Es(lt),ya();break;case 26:case 27:case 5:yu(e);break;case 4:ya();break;case 31:e.memoizedState!==null&&nn(e);break;case 13:nn(e);break;case 19:wt(nt);break;case 10:Es(e.type);break;case 22:case 23:nn(e),ag(),t!==null&&wt(sr);break;case 24:Es(lt)}}function Yl(t,e){try{var n=e.updateQueue,s=n!==null?n.lastEffect:null;if(s!==null){var i=s.next;n=i;do{if((n.tag&t)===t){s=void 0;var r=n.create,a=n.inst;s=r(),a.destroy=s}n=n.next}while(n!==i)}}catch(o){Se(e,e.return,o)}}function Si(t,e,n){try{var s=e.updateQueue,i=s!==null?s.lastEffect:null;if(i!==null){var r=i.next;s=r;do{if((s.tag&t)===t){var a=s.inst,o=a.destroy;if(o!==void 0){a.destroy=void 0,i=e;var c=n,u=o;try{u()}catch(d){Se(i,c,d)}}}s=s.next}while(s!==r)}}catch(d){Se(e,e.return,d)}}function $w(t){var e=t.updateQueue;if(e!==null){var n=t.stateNode;try{ew(e,n)}catch(s){Se(t,t.return,s)}}}function Kw(t,e,n){n.props=mr(t.type,t.memoizedProps),n.state=t.memoizedState;try{n.componentWillUnmount()}catch(s){Se(t,e,s)}}function Go(t,e){try{var n=t.ref;if(n!==null){switch(t.tag){case 26:case 27:case 5:var s=t.stateNode;break;case 30:s=t.stateNode;break;default:s=t.stateNode}typeof n=="function"?t.refCleanup=n(s):n.current=s}}catch(i){Se(t,e,i)}}function Qn(t,e){var n=t.ref,s=t.refCleanup;if(n!==null)if(typeof s=="function")try{s()}catch(i){Se(t,e,i)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(i){Se(t,e,i)}else n.current=null}function Yw(t){var e=t.type,n=t.memoizedProps,s=t.stateNode;try{e:switch(e){case"button":case"input":case"select":case"textarea":n.autoFocus&&s.focus();break e;case"img":n.src?s.src=n.src:n.srcSet&&(s.srcset=n.srcSet)}}catch(i){Se(t,t.return,i)}}function qf(t,e,n){try{var s=t.stateNode;UI(s,t.type,n,e),s[Zt]=e}catch(i){Se(t,t.return,i)}}function qw(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&Li(t.type)||t.tag===4}function Wf(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||qw(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&Li(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function gm(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(t,e):(e=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,e.appendChild(t),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=gs));else if(s!==4&&(s===27&&Li(t.type)&&(n=t.stateNode,e=null),t=t.child,t!==null))for(gm(t,e,n),t=t.sibling;t!==null;)gm(t,e,n),t=t.sibling}function Mu(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(s===27&&Li(t.type)&&(n=t.stateNode),t=t.child,t!==null))for(Mu(t,e,n),t=t.sibling;t!==null;)Mu(t,e,n),t=t.sibling}function Ww(t){var e=t.stateNode,n=t.memoizedProps;try{for(var s=t.type,i=e.attributes;i.length;)e.removeAttributeNode(i[0]);Ct(e,s,n),e[Tt]=t,e[Zt]=n}catch(r){Se(t,t.return,r)}}var ms=!1,ot=!1,Xf=!1,vb=typeof WeakSet=="function"?WeakSet:Set,vt=null;function bI(t,e){if(t=t.containerInfo,Em=$u,t=L1(t),Xp(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var i=s.anchorOffset,r=s.focusNode;s=s.focusOffset;try{n.nodeType,r.nodeType}catch{n=null;break e}var a=0,o=-1,c=-1,u=0,d=0,f=t,h=null;t:for(;;){for(var m;f!==n||i!==0&&f.nodeType!==3||(o=a+i),f!==r||s!==0&&f.nodeType!==3||(c=a+s),f.nodeType===3&&(a+=f.nodeValue.length),(m=f.firstChild)!==null;)h=f,f=m;for(;;){if(f===t)break t;if(h===n&&++u===i&&(o=a),h===r&&++d===s&&(c=a),(m=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=m}n=o===-1||c===-1?null:{start:o,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Nm={focusedElem:t,selectionRange:n},$u=!1,vt=e;vt!==null;)if(e=vt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,vt=t;else for(;vt!==null;){switch(e=vt,r=e.alternate,t=e.flags,e.tag){case 0:if(t&4&&(t=e.updateQueue,t=t!==null?t.events:null,t!==null))for(n=0;n<t.length;n++)i=t[n],i.ref.impl=i.nextImpl;break;case 11:case 15:break;case 1:if(t&1024&&r!==null){t=void 0,n=e,i=r.memoizedProps,r=r.memoizedState,s=n.stateNode;try{var g=mr(n.type,i);t=s.getSnapshotBeforeUpdate(g,r),s.__reactInternalSnapshotBeforeUpdate=t}catch(b){Se(n,n.return,b)}}break;case 3:if(t&1024){if(t=e.stateNode.containerInfo,n=t.nodeType,n===9)Sm(t);else if(n===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":Sm(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(t&1024)throw Error(P(163))}if(t=e.sibling,t!==null){t.return=e.return,vt=t;break}vt=e.return}}function Xw(t,e,n){var s=n.flags;switch(n.tag){case 0:case 11:case 15:us(t,n),s&4&&Yl(5,n);break;case 1:if(us(t,n),s&4)if(t=n.stateNode,e===null)try{t.componentDidMount()}catch(a){Se(n,n.return,a)}else{var i=mr(n.type,e.memoizedProps);e=e.memoizedState;try{t.componentDidUpdate(i,e,t.__reactInternalSnapshotBeforeUpdate)}catch(a){Se(n,n.return,a)}}s&64&&$w(n),s&512&&Go(n,n.return);break;case 3:if(us(t,n),s&64&&(t=n.updateQueue,t!==null)){if(e=null,n.child!==null)switch(n.child.tag){case 27:case 5:e=n.child.stateNode;break;case 1:e=n.child.stateNode}try{ew(t,e)}catch(a){Se(n,n.return,a)}}break;case 27:e===null&&s&4&&Ww(n);case 26:case 5:us(t,n),e===null&&s&4&&Yw(n),s&512&&Go(n,n.return);break;case 12:us(t,n);break;case 31:us(t,n),s&4&&Zw(t,n);break;case 13:us(t,n),s&4&&eE(t,n),s&64&&(t=n.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(n=TI.bind(null,n),YI(t,n))));break;case 22:if(s=n.memoizedState!==null||ms,!s){e=e!==null&&e.memoizedState!==null||ot,i=ms;var r=ot;ms=s,(ot=e)&&!r?ds(t,n,(n.subtreeFlags&8772)!==0):us(t,n),ms=i,ot=r}break;case 30:break;default:us(t,n)}}function Qw(t){var e=t.alternate;e!==null&&(t.alternate=null,Qw(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&zp(e)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var $e=null,Yt=!1;function cs(t,e,n){for(n=n.child;n!==null;)Jw(t,e,n),n=n.sibling}function Jw(t,e,n){if(ln&&typeof ln.onCommitFiberUnmount=="function")try{ln.onCommitFiberUnmount(Hl,n)}catch{}switch(n.tag){case 26:ot||Qn(n,e),cs(t,e,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:ot||Qn(n,e);var s=$e,i=Yt;Li(n.type)&&($e=n.stateNode,Yt=!1),cs(t,e,n),$o(n.stateNode),$e=s,Yt=i;break;case 5:ot||Qn(n,e);case 6:if(s=$e,i=Yt,$e=null,cs(t,e,n),$e=s,Yt=i,$e!==null)if(Yt)try{($e.nodeType===9?$e.body:$e.nodeName==="HTML"?$e.ownerDocument.body:$e).removeChild(n.stateNode)}catch(r){Se(n,e,r)}else try{$e.removeChild(n.stateNode)}catch(r){Se(n,e,r)}break;case 18:$e!==null&&(Yt?(t=$e,Ib(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,n.stateNode),Ia(t)):Ib($e,n.stateNode));break;case 4:s=$e,i=Yt,$e=n.stateNode.containerInfo,Yt=!0,cs(t,e,n),$e=s,Yt=i;break;case 0:case 11:case 14:case 15:Si(2,n,e),ot||Si(4,n,e),cs(t,e,n);break;case 1:ot||(Qn(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"&&Kw(n,e,s)),cs(t,e,n);break;case 21:cs(t,e,n);break;case 22:ot=(s=ot)||n.memoizedState!==null,cs(t,e,n),ot=s;break;default:cs(t,e,n)}}function Zw(t,e){if(e.memoizedState===null&&(t=e.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{Ia(t)}catch(n){Se(e,e.return,n)}}}function eE(t,e){if(e.memoizedState===null&&(t=e.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{Ia(t)}catch(n){Se(e,e.return,n)}}function xI(t){switch(t.tag){case 31:case 13:case 19:var e=t.stateNode;return e===null&&(e=t.stateNode=new vb),e;case 22:return t=t.stateNode,e=t._retryCache,e===null&&(e=t._retryCache=new vb),e;default:throw Error(P(435,t.tag))}}function jc(t,e){var n=xI(t);e.forEach(function(s){if(!n.has(s)){n.add(s);var i=AI.bind(null,t,s);s.then(i,i)}})}function $t(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var i=n[s],r=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 27:if(Li(o.type)){$e=o.stateNode,Yt=!1;break e}break;case 5:$e=o.stateNode,Yt=!1;break e;case 3:case 4:$e=o.stateNode.containerInfo,Yt=!0;break e}o=o.return}if($e===null)throw Error(P(160));Jw(r,a,i),$e=null,Yt=!1,r=i.alternate,r!==null&&(r.return=null),i.return=null}if(e.subtreeFlags&13886)for(e=e.child;e!==null;)tE(e,t),e=e.sibling}var Pn=null;function tE(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:$t(e,t),Kt(t),s&4&&(Si(3,t,t.return),Yl(3,t),Si(5,t,t.return));break;case 1:$t(e,t),Kt(t),s&512&&(ot||n===null||Qn(n,n.return)),s&64&&ms&&(t=t.updateQueue,t!==null&&(s=t.callbacks,s!==null&&(n=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=n===null?s:n.concat(s))));break;case 26:var i=Pn;if($t(e,t),Kt(t),s&512&&(ot||n===null||Qn(n,n.return)),s&4){var r=n!==null?n.memoizedState:null;if(s=t.memoizedState,n===null)if(s===null)if(t.stateNode===null){e:{s=t.type,n=t.memoizedProps,i=i.ownerDocument||i;t:switch(s){case"title":r=i.getElementsByTagName("title")[0],(!r||r[Fl]||r[Tt]||r.namespaceURI==="http://www.w3.org/2000/svg"||r.hasAttribute("itemprop"))&&(r=i.createElement(s),i.head.insertBefore(r,i.querySelector("head > title"))),Ct(r,s,n),r[Tt]=t,yt(r),s=r;break e;case"link":var a=Pb("link","href",i).get(s+(n.href||""));if(a){for(var o=0;o<a.length;o++)if(r=a[o],r.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&r.getAttribute("rel")===(n.rel==null?null:n.rel)&&r.getAttribute("title")===(n.title==null?null:n.title)&&r.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){a.splice(o,1);break t}}r=i.createElement(s),Ct(r,s,n),i.head.appendChild(r);break;case"meta":if(a=Pb("meta","content",i).get(s+(n.content||""))){for(o=0;o<a.length;o++)if(r=a[o],r.getAttribute("content")===(n.content==null?null:""+n.content)&&r.getAttribute("name")===(n.name==null?null:n.name)&&r.getAttribute("property")===(n.property==null?null:n.property)&&r.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&r.getAttribute("charset")===(n.charSet==null?null:n.charSet)){a.splice(o,1);break t}}r=i.createElement(s),Ct(r,s,n),i.head.appendChild(r);break;default:throw Error(P(468,s))}r[Tt]=t,yt(r),s=r}t.stateNode=s}else Bb(i,t.type,t.stateNode);else t.stateNode=Lb(i,s,t.memoizedProps);else r!==s?(r===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):r.count--,s===null?Bb(i,t.type,t.stateNode):Lb(i,s,t.memoizedProps)):s===null&&t.stateNode!==null&&qf(t,t.memoizedProps,n.memoizedProps)}break;case 27:$t(e,t),Kt(t),s&512&&(ot||n===null||Qn(n,n.return)),n!==null&&s&4&&qf(t,t.memoizedProps,n.memoizedProps);break;case 5:if($t(e,t),Kt(t),s&512&&(ot||n===null||Qn(n,n.return)),t.flags&32){i=t.stateNode;try{wa(i,"")}catch(g){Se(t,t.return,g)}}s&4&&t.stateNode!=null&&(i=t.memoizedProps,qf(t,i,n!==null?n.memoizedProps:i)),s&1024&&(Xf=!0);break;case 6:if($t(e,t),Kt(t),s&4){if(t.stateNode===null)throw Error(P(162));s=t.memoizedProps,n=t.stateNode;try{n.nodeValue=s}catch(g){Se(t,t.return,g)}}break;case 3:if(au=null,i=Pn,Pn=Vu(e.containerInfo),$t(e,t),Pn=i,Kt(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{Ia(e.containerInfo)}catch(g){Se(t,t.return,g)}Xf&&(Xf=!1,nE(t));break;case 4:s=Pn,Pn=Vu(t.stateNode.containerInfo),$t(e,t),Kt(t),Pn=s;break;case 12:$t(e,t),Kt(t);break;case 31:$t(e,t),Kt(t),s&4&&(s=t.updateQueue,s!==null&&(t.updateQueue=null,jc(t,s)));break;case 13:$t(e,t),Kt(t),t.child.flags&8192&&t.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(Vd=on()),s&4&&(s=t.updateQueue,s!==null&&(t.updateQueue=null,jc(t,s)));break;case 22:i=t.memoizedState!==null;var c=n!==null&&n.memoizedState!==null,u=ms,d=ot;if(ms=u||i,ot=d||c,$t(e,t),ot=d,ms=u,Kt(t),s&8192)e:for(e=t.stateNode,e._visibility=i?e._visibility&-2:e._visibility|1,i&&(n===null||c||ms||ot||Yi(t)),n=null,e=t;;){if(e.tag===5||e.tag===26){if(n===null){c=n=e;try{if(r=c.stateNode,i)a=r.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none";else{o=c.stateNode;var f=c.memoizedProps.style,h=f!=null&&f.hasOwnProperty("display")?f.display:null;o.style.display=h==null||typeof h=="boolean"?"":(""+h).trim()}}catch(g){Se(c,c.return,g)}}}else if(e.tag===6){if(n===null){c=e;try{c.stateNode.nodeValue=i?"":c.memoizedProps}catch(g){Se(c,c.return,g)}}}else if(e.tag===18){if(n===null){c=e;try{var m=c.stateNode;i?Cb(m,!0):Cb(c.stateNode,!1)}catch(g){Se(c,c.return,g)}}}else if((e.tag!==22&&e.tag!==23||e.memoizedState===null||e===t)&&e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;n===e&&(n=null),e=e.return}n===e&&(n=null),e.sibling.return=e.return,e=e.sibling}s&4&&(s=t.updateQueue,s!==null&&(n=s.retryQueue,n!==null&&(s.retryQueue=null,jc(t,n))));break;case 19:$t(e,t),Kt(t),s&4&&(s=t.updateQueue,s!==null&&(t.updateQueue=null,jc(t,s)));break;case 30:break;case 21:break;default:$t(e,t),Kt(t)}}function Kt(t){var e=t.flags;if(e&2){try{for(var n,s=t.return;s!==null;){if(qw(s)){n=s;break}s=s.return}if(n==null)throw Error(P(160));switch(n.tag){case 27:var i=n.stateNode,r=Wf(t);Mu(t,r,i);break;case 5:var a=n.stateNode;n.flags&32&&(wa(a,""),n.flags&=-33);var o=Wf(t);Mu(t,o,a);break;case 3:case 4:var c=n.stateNode.containerInfo,u=Wf(t);gm(t,u,c);break;default:throw Error(P(161))}}catch(d){Se(t,t.return,d)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function nE(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var e=t;nE(e),e.tag===5&&e.flags&1024&&e.stateNode.reset(),t=t.sibling}}function us(t,e){if(e.subtreeFlags&8772)for(e=e.child;e!==null;)Xw(t,e.alternate,e),e=e.sibling}function Yi(t){for(t=t.child;t!==null;){var e=t;switch(e.tag){case 0:case 11:case 14:case 15:Si(4,e,e.return),Yi(e);break;case 1:Qn(e,e.return);var n=e.stateNode;typeof n.componentWillUnmount=="function"&&Kw(e,e.return,n),Yi(e);break;case 27:$o(e.stateNode);case 26:case 5:Qn(e,e.return),Yi(e);break;case 22:e.memoizedState===null&&Yi(e);break;case 30:Yi(e);break;default:Yi(e)}t=t.sibling}}function ds(t,e,n){for(n=n&&(e.subtreeFlags&8772)!==0,e=e.child;e!==null;){var s=e.alternate,i=t,r=e,a=r.flags;switch(r.tag){case 0:case 11:case 15:ds(i,r,n),Yl(4,r);break;case 1:if(ds(i,r,n),s=r,i=s.stateNode,typeof i.componentDidMount=="function")try{i.componentDidMount()}catch(u){Se(s,s.return,u)}if(s=r,i=s.updateQueue,i!==null){var o=s.stateNode;try{var c=i.shared.hiddenCallbacks;if(c!==null)for(i.shared.hiddenCallbacks=null,i=0;i<c.length;i++)Z1(c[i],o)}catch(u){Se(s,s.return,u)}}n&&a&64&&$w(r),Go(r,r.return);break;case 27:Ww(r);case 26:case 5:ds(i,r,n),n&&s===null&&a&4&&Yw(r),Go(r,r.return);break;case 12:ds(i,r,n);break;case 31:ds(i,r,n),n&&a&4&&Zw(i,r);break;case 13:ds(i,r,n),n&&a&4&&eE(i,r);break;case 22:r.memoizedState===null&&ds(i,r,n),Go(r,r.return);break;case 30:break;default:ds(i,r,n)}e=e.sibling}}function wg(t,e){var n=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(n=t.memoizedState.cachePool.pool),t=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(t=e.memoizedState.cachePool.pool),t!==n&&(t!=null&&t.refCount++,n!=null&&$l(n))}function Eg(t,e){t=null,e.alternate!==null&&(t=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==t&&(e.refCount++,t!=null&&$l(t))}function Mn(t,e,n,s){if(e.subtreeFlags&10256)for(e=e.child;e!==null;)sE(t,e,n,s),e=e.sibling}function sE(t,e,n,s){var i=e.flags;switch(e.tag){case 0:case 11:case 15:Mn(t,e,n,s),i&2048&&Yl(9,e);break;case 1:Mn(t,e,n,s);break;case 3:Mn(t,e,n,s),i&2048&&(t=null,e.alternate!==null&&(t=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==t&&(e.refCount++,t!=null&&$l(t)));break;case 12:if(i&2048){Mn(t,e,n,s),t=e.stateNode;try{var r=e.memoizedProps,a=r.id,o=r.onPostCommit;typeof o=="function"&&o(a,e.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(c){Se(e,e.return,c)}}else Mn(t,e,n,s);break;case 31:Mn(t,e,n,s);break;case 13:Mn(t,e,n,s);break;case 23:break;case 22:r=e.stateNode,a=e.alternate,e.memoizedState!==null?r._visibility&2?Mn(t,e,n,s):Vo(t,e):r._visibility&2?Mn(t,e,n,s):(r._visibility|=2,Br(t,e,n,s,(e.subtreeFlags&10256)!==0||!1)),i&2048&&wg(a,e);break;case 24:Mn(t,e,n,s),i&2048&&Eg(e.alternate,e);break;default:Mn(t,e,n,s)}}function Br(t,e,n,s,i){for(i=i&&((e.subtreeFlags&10256)!==0||!1),e=e.child;e!==null;){var r=t,a=e,o=n,c=s,u=a.flags;switch(a.tag){case 0:case 11:case 15:Br(r,a,o,c,i),Yl(8,a);break;case 23:break;case 22:var d=a.stateNode;a.memoizedState!==null?d._visibility&2?Br(r,a,o,c,i):Vo(r,a):(d._visibility|=2,Br(r,a,o,c,i)),i&&u&2048&&wg(a.alternate,a);break;case 24:Br(r,a,o,c,i),i&&u&2048&&Eg(a.alternate,a);break;default:Br(r,a,o,c,i)}e=e.sibling}}function Vo(t,e){if(e.subtreeFlags&10256)for(e=e.child;e!==null;){var n=t,s=e,i=s.flags;switch(s.tag){case 22:Vo(n,s),i&2048&&wg(s.alternate,s);break;case 24:Vo(n,s),i&2048&&Eg(s.alternate,s);break;default:Vo(n,s)}e=e.sibling}}var To=8192;function Or(t,e,n){if(t.subtreeFlags&To)for(t=t.child;t!==null;)iE(t,e,n),t=t.sibling}function iE(t,e,n){switch(t.tag){case 26:Or(t,e,n),t.flags&To&&t.memoizedState!==null&&rC(n,Pn,t.memoizedState,t.memoizedProps);break;case 5:Or(t,e,n);break;case 3:case 4:var s=Pn;Pn=Vu(t.stateNode.containerInfo),Or(t,e,n),Pn=s;break;case 22:t.memoizedState===null&&(s=t.alternate,s!==null&&s.memoizedState!==null?(s=To,To=16777216,Or(t,e,n),To=s):Or(t,e,n));break;default:Or(t,e,n)}}function rE(t){var e=t.alternate;if(e!==null&&(t=e.child,t!==null)){e.child=null;do e=t.sibling,t.sibling=null,t=e;while(t!==null)}}function go(t){var e=t.deletions;if(t.flags&16){if(e!==null)for(var n=0;n<e.length;n++){var s=e[n];vt=s,oE(s,t)}rE(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)aE(t),t=t.sibling}function aE(t){switch(t.tag){case 0:case 11:case 15:go(t),t.flags&2048&&Si(9,t,t.return);break;case 3:go(t);break;case 12:go(t);break;case 22:var e=t.stateNode;t.memoizedState!==null&&e._visibility&2&&(t.return===null||t.return.tag!==13)?(e._visibility&=-3,iu(t)):go(t);break;default:go(t)}}function iu(t){var e=t.deletions;if(t.flags&16){if(e!==null)for(var n=0;n<e.length;n++){var s=e[n];vt=s,oE(s,t)}rE(t)}for(t=t.child;t!==null;){switch(e=t,e.tag){case 0:case 11:case 15:Si(8,e,e.return),iu(e);break;case 22:n=e.stateNode,n._visibility&2&&(n._visibility&=-3,iu(e));break;default:iu(e)}t=t.sibling}}function oE(t,e){for(;vt!==null;){var n=vt;switch(n.tag){case 0:case 11:case 15:Si(8,n,e);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var s=n.memoizedState.cachePool.pool;s!=null&&s.refCount++}break;case 24:$l(n.memoizedState.cache)}if(s=n.child,s!==null)s.return=n,vt=s;else e:for(n=t;vt!==null;){s=vt;var i=s.sibling,r=s.return;if(Qw(s),s===n){vt=null;break e}if(i!==null){i.return=r,vt=i;break e}vt=r}}}var yI={getCacheForType:function(t){var e=It(lt),n=e.data.get(t);return n===void 0&&(n=t(),e.data.set(t,n)),n},cacheSignal:function(){return It(lt).controller.signal}},_I=typeof WeakMap=="function"?WeakMap:Map,Ee=0,Le=null,ge=null,ve=0,ke=0,tn=null,si=!1,Ya=!1,Ng=!1,Cs=0,et=0,Ti=0,rr=0,kg=0,an=0,Sa=0,Fo=null,qt=null,vm=!1,Vd=0,lE=0,Du=1/0,Lu=null,hi=null,ht=0,mi=null,Ta=null,Ns=0,bm=0,xm=null,cE=null,zo=0,ym=null;function un(){return Ee&2&&ve!==0?ve&-ve:ie.T!==null?Tg():b1()}function uE(){if(an===0)if(!(ve&536870912)||be){var t=Nc;Nc<<=1,!(Nc&3932160)&&(Nc=262144),an=t}else an=536870912;return t=fn.current,t!==null&&(t.flags|=32),an}function Jt(t,e,n){(t===Le&&(ke===2||ke===9)||t.cancelPendingCommit!==null)&&(Aa(t,0),ii(t,ve,an,!1)),Vl(t,n),(!(Ee&2)||t!==Le)&&(t===Le&&(!(Ee&2)&&(rr|=n),et===4&&ii(t,ve,an,!1)),rs(t))}function dE(t,e,n){if(Ee&6)throw Error(P(327));var s=!n&&(e&127)===0&&(e&t.expiredLanes)===0||Gl(t,e),i=s?NI(t,e):Qf(t,e,!0),r=s;do{if(i===0){Ya&&!s&&ii(t,e,0,!1);break}else{if(n=t.current.alternate,r&&!wI(n)){i=Qf(t,e,!1),r=!1;continue}if(i===2){if(r=e,t.errorRecoveryDisabledLanes&r)var a=0;else a=t.pendingLanes&-536870913,a=a!==0?a:a&536870912?536870912:0;if(a!==0){e=a;e:{var o=t;i=Fo;var c=o.current.memoizedState.isDehydrated;if(c&&(Aa(o,a).flags|=256),a=Qf(o,a,!1),a!==2){if(Ng&&!c){o.errorRecoveryDisabledLanes|=r,rr|=r,i=4;break e}r=qt,qt=i,r!==null&&(qt===null?qt=r:qt.push.apply(qt,r))}i=a}if(r=!1,i!==2)continue}}if(i===1){Aa(t,0),ii(t,e,0,!0);break}e:{switch(s=t,r=i,r){case 0:case 1:throw Error(P(345));case 4:if((e&4194048)!==e)break;case 6:ii(s,e,an,!si);break e;case 2:qt=null;break;case 3:case 5:break;default:throw Error(P(329))}if((e&62914560)===e&&(i=Vd+300-on(),10<i)){if(ii(s,e,an,!si),Cd(s,0,!0)!==0)break e;Ns=e,s.timeoutHandle=CE(bb.bind(null,s,n,qt,Lu,vm,e,an,rr,Sa,si,r,"Throttled",-0,0),i);break e}bb(s,n,qt,Lu,vm,e,an,rr,Sa,si,r,null,-0,0)}}break}while(!0);rs(t)}function bb(t,e,n,s,i,r,a,o,c,u,d,f,h,m){if(t.timeoutHandle=-1,f=e.subtreeFlags,f&8192||(f&16785408)===16785408){f={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:gs},iE(e,r,f);var g=(r&62914560)===r?Vd-on():(r&4194048)===r?lE-on():0;if(g=aC(f,g),g!==null){Ns=r,t.cancelPendingCommit=g(yb.bind(null,t,e,r,n,s,i,a,o,c,d,f,null,h,m)),ii(t,r,a,!u);return}}yb(t,e,r,n,s,i,a,o,c)}function wI(t){for(var e=t;;){var n=e.tag;if((n===0||n===11||n===15)&&e.flags&16384&&(n=e.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var s=0;s<n.length;s++){var i=n[s],r=i.getSnapshot;i=i.value;try{if(!dn(r(),i))return!1}catch{return!1}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ii(t,e,n,s){e&=~kg,e&=~rr,t.suspendedLanes|=e,t.pingedLanes&=~e,s&&(t.warmLanes|=e),s=t.expirationTimes;for(var i=e;0<i;){var r=31-cn(i),a=1<<r;s[r]=-1,i&=~a}n!==0&&p1(t,n,e)}function Fd(){return Ee&6?!0:(ql(0),!1)}function Sg(){if(ge!==null){if(ke===0)var t=ge.return;else t=ge,vs=Tr=null,dg(t),ca=null,cl=0,t=ge;for(;t!==null;)zw(t.alternate,t),t=t.return;ge=null}}function Aa(t,e){var n=t.timeoutHandle;n!==-1&&(t.timeoutHandle=-1,VI(n)),n=t.cancelPendingCommit,n!==null&&(t.cancelPendingCommit=null,n()),Ns=0,Sg(),Le=t,ge=n=ws(t.current,null),ve=e,ke=0,tn=null,si=!1,Ya=Gl(t,e),Ng=!1,Sa=an=kg=rr=Ti=et=0,qt=Fo=null,vm=!1,e&8&&(e|=e&32);var s=t.entangledLanes;if(s!==0)for(t=t.entanglements,s&=e;0<s;){var i=31-cn(s),r=1<<i;e|=t[i],s&=~r}return Cs=e,Dd(),n}function fE(t,e){ce=null,ie.H=dl,e===Ka||e===Pd?(e=Xv(),ke=3):e===ig?(e=Xv(),ke=4):ke=e===yg?8:e!==null&&typeof e=="object"&&typeof e.then=="function"?6:1,tn=e,ge===null&&(et=1,ju(t,wn(e,t.current)))}function hE(){var t=fn.current;return t===null?!0:(ve&4194048)===ve?Sn===null:(ve&62914560)===ve||ve&536870912?t===Sn:!1}function mE(){var t=ie.H;return ie.H=dl,t===null?dl:t}function pE(){var t=ie.A;return ie.A=yI,t}function Pu(){et=4,si||(ve&4194048)!==ve&&fn.current!==null||(Ya=!0),!(Ti&134217727)&&!(rr&134217727)||Le===null||ii(Le,ve,an,!1)}function Qf(t,e,n){var s=Ee;Ee|=2;var i=mE(),r=pE();(Le!==t||ve!==e)&&(Lu=null,Aa(t,e)),e=!1;var a=et;e:do try{if(ke!==0&&ge!==null){var o=ge,c=tn;switch(ke){case 8:Sg(),a=6;break e;case 3:case 2:case 9:case 6:fn.current===null&&(e=!0);var u=ke;if(ke=0,tn=null,Qr(t,o,c,u),n&&Ya){a=0;break e}break;default:u=ke,ke=0,tn=null,Qr(t,o,c,u)}}EI(),a=et;break}catch(d){fE(t,d)}while(!0);return e&&t.shellSuspendCounter++,vs=Tr=null,Ee=s,ie.H=i,ie.A=r,ge===null&&(Le=null,ve=0,Dd()),a}function EI(){for(;ge!==null;)gE(ge)}function NI(t,e){var n=Ee;Ee|=2;var s=mE(),i=pE();Le!==t||ve!==e?(Lu=null,Du=on()+500,Aa(t,e)):Ya=Gl(t,e);e:do try{if(ke!==0&&ge!==null){e=ge;var r=tn;t:switch(ke){case 1:ke=0,tn=null,Qr(t,e,r,1);break;case 2:case 9:if(Wv(r)){ke=0,tn=null,xb(e);break}e=function(){ke!==2&&ke!==9||Le!==t||(ke=7),rs(t)},r.then(e,e);break e;case 3:ke=7;break e;case 4:ke=5;break e;case 7:Wv(r)?(ke=0,tn=null,xb(e)):(ke=0,tn=null,Qr(t,e,r,7));break;case 5:var a=null;switch(ge.tag){case 26:a=ge.memoizedState;case 5:case 27:var o=ge;if(a?LE(a):o.stateNode.complete){ke=0,tn=null;var c=o.sibling;if(c!==null)ge=c;else{var u=o.return;u!==null?(ge=u,zd(u)):ge=null}break t}}ke=0,tn=null,Qr(t,e,r,5);break;case 6:ke=0,tn=null,Qr(t,e,r,6);break;case 8:Sg(),et=6;break e;default:throw Error(P(462))}}kI();break}catch(d){fE(t,d)}while(!0);return vs=Tr=null,ie.H=s,ie.A=i,Ee=n,ge!==null?0:(Le=null,ve=0,Dd(),et)}function kI(){for(;ge!==null&&!qA();)gE(ge)}function gE(t){var e=Fw(t.alternate,t,Cs);t.memoizedProps=t.pendingProps,e===null?zd(t):ge=e}function xb(t){var e=t,n=e.alternate;switch(e.tag){case 15:case 0:e=fb(n,e,e.pendingProps,e.type,void 0,ve);break;case 11:e=fb(n,e,e.pendingProps,e.type.render,e.ref,ve);break;case 5:dg(e);default:zw(n,e),e=ge=z1(e,Cs),e=Fw(n,e,Cs)}t.memoizedProps=t.pendingProps,e===null?zd(t):ge=e}function Qr(t,e,n,s){vs=Tr=null,dg(e),ca=null,cl=0;var i=e.return;try{if(hI(t,i,e,n,ve)){et=1,ju(t,wn(n,t.current)),ge=null;return}}catch(r){if(i!==null)throw ge=i,r;et=1,ju(t,wn(n,t.current)),ge=null;return}e.flags&32768?(be||s===1?t=!0:Ya||ve&536870912?t=!1:(si=t=!0,(s===2||s===9||s===3||s===6)&&(s=fn.current,s!==null&&s.tag===13&&(s.flags|=16384))),vE(e,t)):zd(e)}function zd(t){var e=t;do{if(e.flags&32768){vE(e,si);return}t=e.return;var n=gI(e.alternate,e,Cs);if(n!==null){ge=n;return}if(e=e.sibling,e!==null){ge=e;return}ge=e=t}while(e!==null);et===0&&(et=5)}function vE(t,e){do{var n=vI(t.alternate,t);if(n!==null){n.flags&=32767,ge=n;return}if(n=t.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!e&&(t=t.sibling,t!==null)){ge=t;return}ge=t=n}while(t!==null);et=6,ge=null}function yb(t,e,n,s,i,r,a,o,c){t.cancelPendingCommit=null;do $d();while(ht!==0);if(Ee&6)throw Error(P(327));if(e!==null){if(e===t.current)throw Error(P(177));if(r=e.lanes|e.childLanes,r|=Qp,iR(t,n,r,a,o,c),t===Le&&(ge=Le=null,ve=0),Ta=e,mi=t,Ns=n,bm=r,xm=i,cE=s,e.subtreeFlags&10256||e.flags&10256?(t.callbackNode=null,t.callbackPriority=0,RI(_u,function(){return wE(),null})):(t.callbackNode=null,t.callbackPriority=0),s=(e.flags&13878)!==0,e.subtreeFlags&13878||s){s=ie.T,ie.T=null,i=Ne.p,Ne.p=2,a=Ee,Ee|=4;try{bI(t,e,n)}finally{Ee=a,Ne.p=i,ie.T=s}}ht=1,bE(),xE(),yE()}}function bE(){if(ht===1){ht=0;var t=mi,e=Ta,n=(e.flags&13878)!==0;if(e.subtreeFlags&13878||n){n=ie.T,ie.T=null;var s=Ne.p;Ne.p=2;var i=Ee;Ee|=4;try{tE(e,t);var r=Nm,a=L1(t.containerInfo),o=r.focusedElem,c=r.selectionRange;if(a!==o&&o&&o.ownerDocument&&D1(o.ownerDocument.documentElement,o)){if(c!==null&&Xp(o)){var u=c.start,d=c.end;if(d===void 0&&(d=u),"selectionStart"in o)o.selectionStart=u,o.selectionEnd=Math.min(d,o.value.length);else{var f=o.ownerDocument||document,h=f&&f.defaultView||window;if(h.getSelection){var m=h.getSelection(),g=o.textContent.length,b=Math.min(c.start,g),x=c.end===void 0?b:Math.min(c.end,g);!m.extend&&b>x&&(a=x,x=b,b=a);var p=Vv(o,b),v=Vv(o,x);if(p&&v&&(m.rangeCount!==1||m.anchorNode!==p.node||m.anchorOffset!==p.offset||m.focusNode!==v.node||m.focusOffset!==v.offset)){var y=f.createRange();y.setStart(p.node,p.offset),m.removeAllRanges(),b>x?(m.addRange(y),m.extend(v.node,v.offset)):(y.setEnd(v.node,v.offset),m.addRange(y))}}}}for(f=[],m=o;m=m.parentNode;)m.nodeType===1&&f.push({element:m,left:m.scrollLeft,top:m.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<f.length;o++){var E=f[o];E.element.scrollLeft=E.left,E.element.scrollTop=E.top}}$u=!!Em,Nm=Em=null}finally{Ee=i,Ne.p=s,ie.T=n}}t.current=e,ht=2}}function xE(){if(ht===2){ht=0;var t=mi,e=Ta,n=(e.flags&8772)!==0;if(e.subtreeFlags&8772||n){n=ie.T,ie.T=null;var s=Ne.p;Ne.p=2;var i=Ee;Ee|=4;try{Xw(t,e.alternate,e)}finally{Ee=i,Ne.p=s,ie.T=n}}ht=3}}function yE(){if(ht===4||ht===3){ht=0,WA();var t=mi,e=Ta,n=Ns,s=cE;e.subtreeFlags&10256||e.flags&10256?ht=5:(ht=0,Ta=mi=null,_E(t,t.pendingLanes));var i=t.pendingLanes;if(i===0&&(hi=null),Fp(n),e=e.stateNode,ln&&typeof ln.onCommitFiberRoot=="function")try{ln.onCommitFiberRoot(Hl,e,void 0,(e.current.flags&128)===128)}catch{}if(s!==null){e=ie.T,i=Ne.p,Ne.p=2,ie.T=null;try{for(var r=t.onRecoverableError,a=0;a<s.length;a++){var o=s[a];r(o.value,{componentStack:o.stack})}}finally{ie.T=e,Ne.p=i}}Ns&3&&$d(),rs(t),i=t.pendingLanes,n&261930&&i&42?t===ym?zo++:(zo=0,ym=t):zo=0,ql(0)}}function _E(t,e){(t.pooledCacheLanes&=e)===0&&(e=t.pooledCache,e!=null&&(t.pooledCache=null,$l(e)))}function $d(){return bE(),xE(),yE(),wE()}function wE(){if(ht!==5)return!1;var t=mi,e=bm;bm=0;var n=Fp(Ns),s=ie.T,i=Ne.p;try{Ne.p=32>n?32:n,ie.T=null,n=xm,xm=null;var r=mi,a=Ns;if(ht=0,Ta=mi=null,Ns=0,Ee&6)throw Error(P(331));var o=Ee;if(Ee|=4,aE(r.current),sE(r,r.current,a,n),Ee=o,ql(0,!1),ln&&typeof ln.onPostCommitFiberRoot=="function")try{ln.onPostCommitFiberRoot(Hl,r)}catch{}return!0}finally{Ne.p=i,ie.T=s,_E(t,e)}}function _b(t,e,n){e=wn(n,e),e=hm(t.stateNode,e,2),t=fi(t,e,2),t!==null&&(Vl(t,2),rs(t))}function Se(t,e,n){if(t.tag===3)_b(t,t,n);else for(;e!==null;){if(e.tag===3){_b(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(hi===null||!hi.has(s))){t=wn(n,t),n=Pw(2),s=fi(e,n,2),s!==null&&(Bw(n,s,e,t),Vl(s,2),rs(s));break}}e=e.return}}function Jf(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new _I;var i=new Set;s.set(e,i)}else i=s.get(e),i===void 0&&(i=new Set,s.set(e,i));i.has(n)||(Ng=!0,i.add(n),t=SI.bind(null,t,e,n),e.then(t,t))}function SI(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),t.pingedLanes|=t.suspendedLanes&n,t.warmLanes&=~n,Le===t&&(ve&n)===n&&(et===4||et===3&&(ve&62914560)===ve&&300>on()-Vd?!(Ee&2)&&Aa(t,0):kg|=n,Sa===ve&&(Sa=0)),rs(t)}function EE(t,e){e===0&&(e=m1()),t=Sr(t,e),t!==null&&(Vl(t,e),rs(t))}function TI(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),EE(t,n)}function AI(t,e){var n=0;switch(t.tag){case 31:case 13:var s=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:s=t.stateNode;break;case 22:s=t.stateNode._retryCache;break;default:throw Error(P(314))}s!==null&&s.delete(e),EE(t,n)}function RI(t,e){return Gp(t,e)}var Bu=null,Ur=null,_m=!1,Uu=!1,Zf=!1,ri=0;function rs(t){t!==Ur&&t.next===null&&(Ur===null?Bu=Ur=t:Ur=Ur.next=t),Uu=!0,_m||(_m=!0,CI())}function ql(t,e){if(!Zf&&Uu){Zf=!0;do for(var n=!1,s=Bu;s!==null;){if(t!==0){var i=s.pendingLanes;if(i===0)var r=0;else{var a=s.suspendedLanes,o=s.pingedLanes;r=(1<<31-cn(42|t)+1)-1,r&=i&~(a&~o),r=r&201326741?r&201326741|1:r?r|2:0}r!==0&&(n=!0,wb(s,r))}else r=ve,r=Cd(s,s===Le?r:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),!(r&3)||Gl(s,r)||(n=!0,wb(s,r));s=s.next}while(n);Zf=!1}}function II(){NE()}function NE(){Uu=_m=!1;var t=0;ri!==0&&GI()&&(t=ri);for(var e=on(),n=null,s=Bu;s!==null;){var i=s.next,r=kE(s,e);r===0?(s.next=null,n===null?Bu=i:n.next=i,i===null&&(Ur=n)):(n=s,(t!==0||r&3)&&(Uu=!0)),s=i}ht!==0&&ht!==5||ql(t),ri!==0&&(ri=0)}function kE(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,i=t.expirationTimes,r=t.pendingLanes&-62914561;0<r;){var a=31-cn(r),o=1<<a,c=i[a];c===-1?(!(o&n)||o&s)&&(i[a]=sR(o,e)):c<=e&&(t.expiredLanes|=o),r&=~o}if(e=Le,n=ve,n=Cd(t,t===e?n:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),s=t.callbackNode,n===0||t===e&&(ke===2||ke===9)||t.cancelPendingCommit!==null)return s!==null&&s!==null&&Tf(s),t.callbackNode=null,t.callbackPriority=0;if(!(n&3)||Gl(t,n)){if(e=n&-n,e===t.callbackPriority)return e;switch(s!==null&&Tf(s),Fp(n)){case 2:case 8:n=f1;break;case 32:n=_u;break;case 268435456:n=h1;break;default:n=_u}return s=SE.bind(null,t),n=Gp(n,s),t.callbackPriority=e,t.callbackNode=n,e}return s!==null&&s!==null&&Tf(s),t.callbackPriority=2,t.callbackNode=null,2}function SE(t,e){if(ht!==0&&ht!==5)return t.callbackNode=null,t.callbackPriority=0,null;var n=t.callbackNode;if($d()&&t.callbackNode!==n)return null;var s=ve;return s=Cd(t,t===Le?s:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),s===0?null:(dE(t,s,e),kE(t,on()),t.callbackNode!=null&&t.callbackNode===n?SE.bind(null,t):null)}function wb(t,e){if($d())return null;dE(t,e,!0)}function CI(){FI(function(){Ee&6?Gp(d1,II):NE()})}function Tg(){if(ri===0){var t=Ea;t===0&&(t=Ec,Ec<<=1,!(Ec&261888)&&(Ec=256)),ri=t}return ri}function Eb(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:Wc(""+t)}function Nb(t,e){var n=e.ownerDocument.createElement("input");return n.name=e.name,n.value=e.value,t.id&&n.setAttribute("form",t.id),e.parentNode.insertBefore(n,e),t=new FormData(t),n.parentNode.removeChild(n),t}function jI(t,e,n,s,i){if(e==="submit"&&n&&n.stateNode===i){var r=Eb((i[Zt]||null).action),a=s.submitter;a&&(e=(e=a[Zt]||null)?Eb(e.formAction):a.getAttribute("formAction"),e!==null&&(r=e,a=null));var o=new jd("action","action",null,s,i);t.push({event:o,listeners:[{instance:null,listener:function(){if(s.defaultPrevented){if(ri!==0){var c=a?Nb(i,a):new FormData(i);dm(n,{pending:!0,data:c,method:i.method,action:r},null,c)}}else typeof r=="function"&&(o.preventDefault(),c=a?Nb(i,a):new FormData(i),dm(n,{pending:!0,data:c,method:i.method,action:r},r,c))},currentTarget:i}]})}}for(var eh=0;eh<Zh.length;eh++){var th=Zh[eh],OI=th.toLowerCase(),MI=th[0].toUpperCase()+th.slice(1);zn(OI,"on"+MI)}zn(B1,"onAnimationEnd");zn(U1,"onAnimationIteration");zn(H1,"onAnimationStart");zn("dblclick","onDoubleClick");zn("focusin","onFocus");zn("focusout","onBlur");zn(XR,"onTransitionRun");zn(QR,"onTransitionStart");zn(JR,"onTransitionCancel");zn(G1,"onTransitionEnd");_a("onMouseEnter",["mouseout","mouseover"]);_a("onMouseLeave",["mouseout","mouseover"]);_a("onPointerEnter",["pointerout","pointerover"]);_a("onPointerLeave",["pointerout","pointerover"]);Er("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Er("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Er("onBeforeInput",["compositionend","keypress","textInput","paste"]);Er("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Er("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Er("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),DI=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(fl));function TE(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],i=s.event;s=s.listeners;e:{var r=void 0;if(e)for(var a=s.length-1;0<=a;a--){var o=s[a],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==r&&i.isPropagationStopped())break e;r=o,i.currentTarget=u;try{r(i)}catch(d){Eu(d)}i.currentTarget=null,r=c}else for(a=0;a<s.length;a++){if(o=s[a],c=o.instance,u=o.currentTarget,o=o.listener,c!==r&&i.isPropagationStopped())break e;r=o,i.currentTarget=u;try{r(i)}catch(d){Eu(d)}i.currentTarget=null,r=c}}}}function pe(t,e){var n=e[$h];n===void 0&&(n=e[$h]=new Set);var s=t+"__bubble";n.has(s)||(AE(e,t,2,!1),n.add(s))}function nh(t,e,n){var s=0;e&&(s|=4),AE(n,t,s,e)}var Oc="_reactListening"+Math.random().toString(36).slice(2);function Ag(t){if(!t[Oc]){t[Oc]=!0,x1.forEach(function(n){n!=="selectionchange"&&(DI.has(n)||nh(n,!1,t),nh(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Oc]||(e[Oc]=!0,nh("selectionchange",!1,e))}}function AE(t,e,n,s){switch(GE(e)){case 2:var i=cC;break;case 8:i=uC;break;default:i=jg}n=i.bind(null,e,n,t),i=void 0,!Xh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),s?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function sh(t,e,n,s,i){var r=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var a=s.tag;if(a===3||a===4){var o=s.stateNode.containerInfo;if(o===i)break;if(a===4)for(a=s.return;a!==null;){var c=a.tag;if((c===3||c===4)&&a.stateNode.containerInfo===i)return;a=a.return}for(;o!==null;){if(a=Vr(o),a===null)return;if(c=a.tag,c===5||c===6||c===26||c===27){s=r=a;continue e}o=o.parentNode}}s=s.return}T1(function(){var u=r,d=Kp(n),f=[];e:{var h=V1.get(t);if(h!==void 0){var m=jd,g=t;switch(t){case"keypress":if(Qc(n)===0)break e;case"keydown":case"keyup":m=AR;break;case"focusin":g="focus",m=jf;break;case"focusout":g="blur",m=jf;break;case"beforeblur":case"afterblur":m=jf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=jv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=gR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=CR;break;case B1:case U1:case H1:m=xR;break;case G1:m=OR;break;case"scroll":case"scrollend":m=mR;break;case"wheel":m=DR;break;case"copy":case"cut":case"paste":m=_R;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Mv;break;case"toggle":case"beforetoggle":m=PR}var b=(e&4)!==0,x=!b&&(t==="scroll"||t==="scrollend"),p=b?h!==null?h+"Capture":null:h;b=[];for(var v=u,y;v!==null;){var E=v;if(y=E.stateNode,E=E.tag,E!==5&&E!==26&&E!==27||y===null||p===null||(E=il(v,p),E!=null&&b.push(hl(v,E,y))),x)break;v=v.return}0<b.length&&(h=new m(h,g,null,n,d),f.push({event:h,listeners:b}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",h&&n!==Wh&&(g=n.relatedTarget||n.fromElement)&&(Vr(g)||g[Fa]))break e;if((m||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,m?(g=n.relatedTarget||n.toElement,m=u,g=g?Vr(g):null,g!==null&&(x=Ul(g),b=g.tag,g!==x||b!==5&&b!==27&&b!==6)&&(g=null)):(m=null,g=u),m!==g)){if(b=jv,E="onMouseLeave",p="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(b=Mv,E="onPointerLeave",p="onPointerEnter",v="pointer"),x=m==null?h:ko(m),y=g==null?h:ko(g),h=new b(E,v+"leave",m,n,d),h.target=x,h.relatedTarget=y,E=null,Vr(d)===u&&(b=new b(p,v+"enter",g,n,d),b.target=y,b.relatedTarget=x,E=b),x=E,m&&g)t:{for(b=LI,p=m,v=g,y=0,E=p;E;E=b(E))y++;E=0;for(var N=v;N;N=b(N))E++;for(;0<y-E;)p=b(p),y--;for(;0<E-y;)v=b(v),E--;for(;y--;){if(p===v||v!==null&&p===v.alternate){b=p;break t}p=b(p),v=b(v)}b=null}else b=null;m!==null&&kb(f,h,m,b,!1),g!==null&&x!==null&&kb(f,x,g,b,!0)}}e:{if(h=u?ko(u):window,m=h.nodeName&&h.nodeName.toLowerCase(),m==="select"||m==="input"&&h.type==="file")var T=Bv;else if(Pv(h))if(O1)T=YR;else{T=$R;var w=zR}else m=h.nodeName,!m||m.toLowerCase()!=="input"||h.type!=="checkbox"&&h.type!=="radio"?u&&$p(u.elementType)&&(T=Bv):T=KR;if(T&&(T=T(t,u))){j1(f,T,n,d);break e}w&&w(t,h,u),t==="focusout"&&u&&h.type==="number"&&u.memoizedProps.value!=null&&qh(h,"number",h.value)}switch(w=u?ko(u):window,t){case"focusin":(Pv(w)||w.contentEditable==="true")&&($r=w,Qh=u,Do=null);break;case"focusout":Do=Qh=$r=null;break;case"mousedown":Jh=!0;break;case"contextmenu":case"mouseup":case"dragend":Jh=!1,Fv(f,n,d);break;case"selectionchange":if(WR)break;case"keydown":case"keyup":Fv(f,n,d)}var A;if(Wp)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else zr?I1(t,n)&&(k="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&(R1&&n.locale!=="ko"&&(zr||k!=="onCompositionStart"?k==="onCompositionEnd"&&zr&&(A=A1()):(ni=d,Yp="value"in ni?ni.value:ni.textContent,zr=!0)),w=Hu(u,k),0<w.length&&(k=new Ov(k,t,null,n,d),f.push({event:k,listeners:w}),A?k.data=A:(A=C1(n),A!==null&&(k.data=A)))),(A=UR?HR(t,n):GR(t,n))&&(k=Hu(u,"onBeforeInput"),0<k.length&&(w=new Ov("onBeforeInput","beforeinput",null,n,d),f.push({event:w,listeners:k}),w.data=A)),jI(f,t,u,n,d)}TE(f,e)})}function hl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Hu(t,e){for(var n=e+"Capture",s=[];t!==null;){var i=t,r=i.stateNode;if(i=i.tag,i!==5&&i!==26&&i!==27||r===null||(i=il(t,n),i!=null&&s.unshift(hl(t,i,r)),i=il(t,e),i!=null&&s.push(hl(t,i,r))),t.tag===3)return s;t=t.return}return[]}function LI(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function kb(t,e,n,s,i){for(var r=e._reactName,a=[];n!==null&&n!==s;){var o=n,c=o.alternate,u=o.stateNode;if(o=o.tag,c!==null&&c===s)break;o!==5&&o!==26&&o!==27||u===null||(c=u,i?(u=il(n,r),u!=null&&a.unshift(hl(n,u,c))):i||(u=il(n,r),u!=null&&a.push(hl(n,u,c)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var PI=/\r\n?/g,BI=/\u0000|\uFFFD/g;function Sb(t){return(typeof t=="string"?t:""+t).replace(PI,`
`).replace(BI,"")}function RE(t,e){return e=Sb(e),Sb(t)===e}function Ce(t,e,n,s,i,r){switch(n){case"children":typeof s=="string"?e==="body"||e==="textarea"&&s===""||wa(t,s):(typeof s=="number"||typeof s=="bigint")&&e!=="body"&&wa(t,""+s);break;case"className":Sc(t,"class",s);break;case"tabIndex":Sc(t,"tabindex",s);break;case"dir":case"role":case"viewBox":case"width":case"height":Sc(t,n,s);break;case"style":S1(t,s,r);break;case"data":if(e!=="object"){Sc(t,"data",s);break}case"src":case"href":if(s===""&&(e!=="a"||n!=="href")){t.removeAttribute(n);break}if(s==null||typeof s=="function"||typeof s=="symbol"||typeof s=="boolean"){t.removeAttribute(n);break}s=Wc(""+s),t.setAttribute(n,s);break;case"action":case"formAction":if(typeof s=="function"){t.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof r=="function"&&(n==="formAction"?(e!=="input"&&Ce(t,e,"name",i.name,i,null),Ce(t,e,"formEncType",i.formEncType,i,null),Ce(t,e,"formMethod",i.formMethod,i,null),Ce(t,e,"formTarget",i.formTarget,i,null)):(Ce(t,e,"encType",i.encType,i,null),Ce(t,e,"method",i.method,i,null),Ce(t,e,"target",i.target,i,null)));if(s==null||typeof s=="symbol"||typeof s=="boolean"){t.removeAttribute(n);break}s=Wc(""+s),t.setAttribute(n,s);break;case"onClick":s!=null&&(t.onclick=gs);break;case"onScroll":s!=null&&pe("scroll",t);break;case"onScrollEnd":s!=null&&pe("scrollend",t);break;case"dangerouslySetInnerHTML":if(s!=null){if(typeof s!="object"||!("__html"in s))throw Error(P(61));if(n=s.__html,n!=null){if(i.children!=null)throw Error(P(60));t.innerHTML=n}}break;case"multiple":t.multiple=s&&typeof s!="function"&&typeof s!="symbol";break;case"muted":t.muted=s&&typeof s!="function"&&typeof s!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(s==null||typeof s=="function"||typeof s=="boolean"||typeof s=="symbol"){t.removeAttribute("xlink:href");break}n=Wc(""+s),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":s!=null&&typeof s!="function"&&typeof s!="symbol"?t.setAttribute(n,""+s):t.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":s&&typeof s!="function"&&typeof s!="symbol"?t.setAttribute(n,""):t.removeAttribute(n);break;case"capture":case"download":s===!0?t.setAttribute(n,""):s!==!1&&s!=null&&typeof s!="function"&&typeof s!="symbol"?t.setAttribute(n,s):t.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":s!=null&&typeof s!="function"&&typeof s!="symbol"&&!isNaN(s)&&1<=s?t.setAttribute(n,s):t.removeAttribute(n);break;case"rowSpan":case"start":s==null||typeof s=="function"||typeof s=="symbol"||isNaN(s)?t.removeAttribute(n):t.setAttribute(n,s);break;case"popover":pe("beforetoggle",t),pe("toggle",t),qc(t,"popover",s);break;case"xlinkActuate":os(t,"http://www.w3.org/1999/xlink","xlink:actuate",s);break;case"xlinkArcrole":os(t,"http://www.w3.org/1999/xlink","xlink:arcrole",s);break;case"xlinkRole":os(t,"http://www.w3.org/1999/xlink","xlink:role",s);break;case"xlinkShow":os(t,"http://www.w3.org/1999/xlink","xlink:show",s);break;case"xlinkTitle":os(t,"http://www.w3.org/1999/xlink","xlink:title",s);break;case"xlinkType":os(t,"http://www.w3.org/1999/xlink","xlink:type",s);break;case"xmlBase":os(t,"http://www.w3.org/XML/1998/namespace","xml:base",s);break;case"xmlLang":os(t,"http://www.w3.org/XML/1998/namespace","xml:lang",s);break;case"xmlSpace":os(t,"http://www.w3.org/XML/1998/namespace","xml:space",s);break;case"is":qc(t,"is",s);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=fR.get(n)||n,qc(t,n,s))}}function wm(t,e,n,s,i,r){switch(n){case"style":S1(t,s,r);break;case"dangerouslySetInnerHTML":if(s!=null){if(typeof s!="object"||!("__html"in s))throw Error(P(61));if(n=s.__html,n!=null){if(i.children!=null)throw Error(P(60));t.innerHTML=n}}break;case"children":typeof s=="string"?wa(t,s):(typeof s=="number"||typeof s=="bigint")&&wa(t,""+s);break;case"onScroll":s!=null&&pe("scroll",t);break;case"onScrollEnd":s!=null&&pe("scrollend",t);break;case"onClick":s!=null&&(t.onclick=gs);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!y1.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(i=n.endsWith("Capture"),e=n.slice(2,i?n.length-7:void 0),r=t[Zt]||null,r=r!=null?r[n]:null,typeof r=="function"&&t.removeEventListener(e,r,i),typeof s=="function")){typeof r!="function"&&r!==null&&(n in t?t[n]=null:t.hasAttribute(n)&&t.removeAttribute(n)),t.addEventListener(e,s,i);break e}n in t?t[n]=s:s===!0?t.setAttribute(n,""):qc(t,n,s)}}}function Ct(t,e,n){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":pe("error",t),pe("load",t);var s=!1,i=!1,r;for(r in n)if(n.hasOwnProperty(r)){var a=n[r];if(a!=null)switch(r){case"src":s=!0;break;case"srcSet":i=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(P(137,e));default:Ce(t,e,r,a,n,null)}}i&&Ce(t,e,"srcSet",n.srcSet,n,null),s&&Ce(t,e,"src",n.src,n,null);return;case"input":pe("invalid",t);var o=r=a=i=null,c=null,u=null;for(s in n)if(n.hasOwnProperty(s)){var d=n[s];if(d!=null)switch(s){case"name":i=d;break;case"type":a=d;break;case"checked":c=d;break;case"defaultChecked":u=d;break;case"value":r=d;break;case"defaultValue":o=d;break;case"children":case"dangerouslySetInnerHTML":if(d!=null)throw Error(P(137,e));break;default:Ce(t,e,s,d,n,null)}}E1(t,r,o,c,u,a,i,!1);return;case"select":pe("invalid",t),s=a=r=null;for(i in n)if(n.hasOwnProperty(i)&&(o=n[i],o!=null))switch(i){case"value":r=o;break;case"defaultValue":a=o;break;case"multiple":s=o;default:Ce(t,e,i,o,n,null)}e=r,n=a,t.multiple=!!s,e!=null?aa(t,!!s,e,!1):n!=null&&aa(t,!!s,n,!0);return;case"textarea":pe("invalid",t),r=i=s=null;for(a in n)if(n.hasOwnProperty(a)&&(o=n[a],o!=null))switch(a){case"value":s=o;break;case"defaultValue":i=o;break;case"children":r=o;break;case"dangerouslySetInnerHTML":if(o!=null)throw Error(P(91));break;default:Ce(t,e,a,o,n,null)}k1(t,s,i,r);return;case"option":for(c in n)if(n.hasOwnProperty(c)&&(s=n[c],s!=null))switch(c){case"selected":t.selected=s&&typeof s!="function"&&typeof s!="symbol";break;default:Ce(t,e,c,s,n,null)}return;case"dialog":pe("beforetoggle",t),pe("toggle",t),pe("cancel",t),pe("close",t);break;case"iframe":case"object":pe("load",t);break;case"video":case"audio":for(s=0;s<fl.length;s++)pe(fl[s],t);break;case"image":pe("error",t),pe("load",t);break;case"details":pe("toggle",t);break;case"embed":case"source":case"link":pe("error",t),pe("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&(s=n[u],s!=null))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(P(137,e));default:Ce(t,e,u,s,n,null)}return;default:if($p(e)){for(d in n)n.hasOwnProperty(d)&&(s=n[d],s!==void 0&&wm(t,e,d,s,n,void 0));return}}for(o in n)n.hasOwnProperty(o)&&(s=n[o],s!=null&&Ce(t,e,o,s,n,null))}function UI(t,e,n,s){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,r=null,a=null,o=null,c=null,u=null,d=null;for(m in n){var f=n[m];if(n.hasOwnProperty(m)&&f!=null)switch(m){case"checked":break;case"value":break;case"defaultValue":c=f;default:s.hasOwnProperty(m)||Ce(t,e,m,null,s,f)}}for(var h in s){var m=s[h];if(f=n[h],s.hasOwnProperty(h)&&(m!=null||f!=null))switch(h){case"type":r=m;break;case"name":i=m;break;case"checked":u=m;break;case"defaultChecked":d=m;break;case"value":a=m;break;case"defaultValue":o=m;break;case"children":case"dangerouslySetInnerHTML":if(m!=null)throw Error(P(137,e));break;default:m!==f&&Ce(t,e,h,m,s,f)}}Yh(t,a,o,c,u,d,r,i);return;case"select":m=a=o=h=null;for(r in n)if(c=n[r],n.hasOwnProperty(r)&&c!=null)switch(r){case"value":break;case"multiple":m=c;default:s.hasOwnProperty(r)||Ce(t,e,r,null,s,c)}for(i in s)if(r=s[i],c=n[i],s.hasOwnProperty(i)&&(r!=null||c!=null))switch(i){case"value":h=r;break;case"defaultValue":o=r;break;case"multiple":a=r;default:r!==c&&Ce(t,e,i,r,s,c)}e=o,n=a,s=m,h!=null?aa(t,!!n,h,!1):!!s!=!!n&&(e!=null?aa(t,!!n,e,!0):aa(t,!!n,n?[]:"",!1));return;case"textarea":m=h=null;for(o in n)if(i=n[o],n.hasOwnProperty(o)&&i!=null&&!s.hasOwnProperty(o))switch(o){case"value":break;case"children":break;default:Ce(t,e,o,null,s,i)}for(a in s)if(i=s[a],r=n[a],s.hasOwnProperty(a)&&(i!=null||r!=null))switch(a){case"value":h=i;break;case"defaultValue":m=i;break;case"children":break;case"dangerouslySetInnerHTML":if(i!=null)throw Error(P(91));break;default:i!==r&&Ce(t,e,a,i,s,r)}N1(t,h,m);return;case"option":for(var g in n)if(h=n[g],n.hasOwnProperty(g)&&h!=null&&!s.hasOwnProperty(g))switch(g){case"selected":t.selected=!1;break;default:Ce(t,e,g,null,s,h)}for(c in s)if(h=s[c],m=n[c],s.hasOwnProperty(c)&&h!==m&&(h!=null||m!=null))switch(c){case"selected":t.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:Ce(t,e,c,h,s,m)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var b in n)h=n[b],n.hasOwnProperty(b)&&h!=null&&!s.hasOwnProperty(b)&&Ce(t,e,b,null,s,h);for(u in s)if(h=s[u],m=n[u],s.hasOwnProperty(u)&&h!==m&&(h!=null||m!=null))switch(u){case"children":case"dangerouslySetInnerHTML":if(h!=null)throw Error(P(137,e));break;default:Ce(t,e,u,h,s,m)}return;default:if($p(e)){for(var x in n)h=n[x],n.hasOwnProperty(x)&&h!==void 0&&!s.hasOwnProperty(x)&&wm(t,e,x,void 0,s,h);for(d in s)h=s[d],m=n[d],!s.hasOwnProperty(d)||h===m||h===void 0&&m===void 0||wm(t,e,d,h,s,m);return}}for(var p in n)h=n[p],n.hasOwnProperty(p)&&h!=null&&!s.hasOwnProperty(p)&&Ce(t,e,p,null,s,h);for(f in s)h=s[f],m=n[f],!s.hasOwnProperty(f)||h===m||h==null&&m==null||Ce(t,e,f,h,s,m)}function Tb(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function HI(){if(typeof performance.getEntriesByType=="function"){for(var t=0,e=0,n=performance.getEntriesByType("resource"),s=0;s<n.length;s++){var i=n[s],r=i.transferSize,a=i.initiatorType,o=i.duration;if(r&&o&&Tb(a)){for(a=0,o=i.responseEnd,s+=1;s<n.length;s++){var c=n[s],u=c.startTime;if(u>o)break;var d=c.transferSize,f=c.initiatorType;d&&Tb(f)&&(c=c.responseEnd,a+=d*(c<o?1:(o-u)/(c-u)))}if(--s,e+=8*(r+a)/(i.duration/1e3),t++,10<t)break}}if(0<t)return e/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var Em=null,Nm=null;function Gu(t){return t.nodeType===9?t:t.ownerDocument}function Ab(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function IE(t,e){if(t===0)switch(e){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&e==="foreignObject"?0:t}function km(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.children=="bigint"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ih=null;function GI(){var t=window.event;return t&&t.type==="popstate"?t===ih?!1:(ih=t,!0):(ih=null,!1)}var CE=typeof setTimeout=="function"?setTimeout:void 0,VI=typeof clearTimeout=="function"?clearTimeout:void 0,Rb=typeof Promise=="function"?Promise:void 0,FI=typeof queueMicrotask=="function"?queueMicrotask:typeof Rb<"u"?function(t){return Rb.resolve(null).then(t).catch(zI)}:CE;function zI(t){setTimeout(function(){throw t})}function Li(t){return t==="head"}function Ib(t,e){var n=e,s=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"||n==="/&"){if(s===0){t.removeChild(i),Ia(e);return}s--}else if(n==="$"||n==="$?"||n==="$~"||n==="$!"||n==="&")s++;else if(n==="html")$o(t.ownerDocument.documentElement);else if(n==="head"){n=t.ownerDocument.head,$o(n);for(var r=n.firstChild;r;){var a=r.nextSibling,o=r.nodeName;r[Fl]||o==="SCRIPT"||o==="STYLE"||o==="LINK"&&r.rel.toLowerCase()==="stylesheet"||n.removeChild(r),r=a}}else n==="body"&&$o(t.ownerDocument.body);n=i}while(n);Ia(e)}function Cb(t,e){var n=t;t=0;do{var s=n.nextSibling;if(n.nodeType===1?e?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",n.getAttribute("style")===""&&n.removeAttribute("style")):n.nodeType===3&&(e?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(t===0)break;t--}else n!=="$"&&n!=="$?"&&n!=="$~"&&n!=="$!"||t++;n=s}while(n)}function Sm(t){var e=t.firstChild;for(e&&e.nodeType===10&&(e=e.nextSibling);e;){var n=e;switch(e=e.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":Sm(n),zp(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}t.removeChild(n)}}function $I(t,e,n,s){for(;t.nodeType===1;){var i=n;if(t.nodeName.toLowerCase()!==e.toLowerCase()){if(!s&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(s){if(!t[Fl])switch(e){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(r=t.getAttribute("rel"),r==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(r!==i.rel||t.getAttribute("href")!==(i.href==null||i.href===""?null:i.href)||t.getAttribute("crossorigin")!==(i.crossOrigin==null?null:i.crossOrigin)||t.getAttribute("title")!==(i.title==null?null:i.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(r=t.getAttribute("src"),(r!==(i.src==null?null:i.src)||t.getAttribute("type")!==(i.type==null?null:i.type)||t.getAttribute("crossorigin")!==(i.crossOrigin==null?null:i.crossOrigin))&&r&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(e==="input"&&t.type==="hidden"){var r=i.name==null?null:""+i.name;if(i.type==="hidden"&&t.getAttribute("name")===r)return t}else return t;if(t=Tn(t.nextSibling),t===null)break}return null}function KI(t,e,n){if(e==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!n||(t=Tn(t.nextSibling),t===null))return null;return t}function jE(t,e){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!e||(t=Tn(t.nextSibling),t===null))return null;return t}function Tm(t){return t.data==="$?"||t.data==="$~"}function Am(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function YI(t,e){var n=t.ownerDocument;if(t.data==="$~")t._reactRetry=e;else if(t.data!=="$?"||n.readyState!=="loading")e();else{var s=function(){e(),n.removeEventListener("DOMContentLoaded",s)};n.addEventListener("DOMContentLoaded",s),t._reactRetry=s}}function Tn(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?"||e==="$~"||e==="&"||e==="F!"||e==="F")break;if(e==="/$"||e==="/&")return null}}return t}var Rm=null;function jb(t){t=t.nextSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"||n==="/&"){if(e===0)return Tn(t.nextSibling);e--}else n!=="$"&&n!=="$!"&&n!=="$?"&&n!=="$~"&&n!=="&"||e++}t=t.nextSibling}return null}function Ob(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"){if(e===0)return t;e--}else n!=="/$"&&n!=="/&"||e++}t=t.previousSibling}return null}function OE(t,e,n){switch(e=Gu(n),t){case"html":if(t=e.documentElement,!t)throw Error(P(452));return t;case"head":if(t=e.head,!t)throw Error(P(453));return t;case"body":if(t=e.body,!t)throw Error(P(454));return t;default:throw Error(P(451))}}function $o(t){for(var e=t.attributes;e.length;)t.removeAttributeNode(e[0]);zp(t)}var Cn=new Map,Mb=new Set;function Vu(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var Bs=Ne.d;Ne.d={f:qI,r:WI,D:XI,C:QI,L:JI,m:ZI,X:tC,S:eC,M:nC};function qI(){var t=Bs.f(),e=Fd();return t||e}function WI(t){var e=za(t);e!==null&&e.tag===5&&e.type==="form"?Sw(e):Bs.r(t)}var qa=typeof document>"u"?null:document;function ME(t,e,n){var s=qa;if(s&&typeof e=="string"&&e){var i=_n(e);i='link[rel="'+t+'"][href="'+i+'"]',typeof n=="string"&&(i+='[crossorigin="'+n+'"]'),Mb.has(i)||(Mb.add(i),t={rel:t,crossOrigin:n,href:e},s.querySelector(i)===null&&(e=s.createElement("link"),Ct(e,"link",t),yt(e),s.head.appendChild(e)))}}function XI(t){Bs.D(t),ME("dns-prefetch",t,null)}function QI(t,e){Bs.C(t,e),ME("preconnect",t,e)}function JI(t,e,n){Bs.L(t,e,n);var s=qa;if(s&&t&&e){var i='link[rel="preload"][as="'+_n(e)+'"]';e==="image"&&n&&n.imageSrcSet?(i+='[imagesrcset="'+_n(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(i+='[imagesizes="'+_n(n.imageSizes)+'"]')):i+='[href="'+_n(t)+'"]';var r=i;switch(e){case"style":r=Ra(t);break;case"script":r=Wa(t)}Cn.has(r)||(t=Fe({rel:"preload",href:e==="image"&&n&&n.imageSrcSet?void 0:t,as:e},n),Cn.set(r,t),s.querySelector(i)!==null||e==="style"&&s.querySelector(Wl(r))||e==="script"&&s.querySelector(Xl(r))||(e=s.createElement("link"),Ct(e,"link",t),yt(e),s.head.appendChild(e)))}}function ZI(t,e){Bs.m(t,e);var n=qa;if(n&&t){var s=e&&typeof e.as=="string"?e.as:"script",i='link[rel="modulepreload"][as="'+_n(s)+'"][href="'+_n(t)+'"]',r=i;switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":r=Wa(t)}if(!Cn.has(r)&&(t=Fe({rel:"modulepreload",href:t},e),Cn.set(r,t),n.querySelector(i)===null)){switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Xl(r)))return}s=n.createElement("link"),Ct(s,"link",t),yt(s),n.head.appendChild(s)}}}function eC(t,e,n){Bs.S(t,e,n);var s=qa;if(s&&t){var i=ra(s).hoistableStyles,r=Ra(t);e=e||"default";var a=i.get(r);if(!a){var o={loading:0,preload:null};if(a=s.querySelector(Wl(r)))o.loading=5;else{t=Fe({rel:"stylesheet",href:t,"data-precedence":e},n),(n=Cn.get(r))&&Rg(t,n);var c=a=s.createElement("link");yt(c),Ct(c,"link",t),c._p=new Promise(function(u,d){c.onload=u,c.onerror=d}),c.addEventListener("load",function(){o.loading|=1}),c.addEventListener("error",function(){o.loading|=2}),o.loading|=4,ru(a,e,s)}a={type:"stylesheet",instance:a,count:1,state:o},i.set(r,a)}}}function tC(t,e){Bs.X(t,e);var n=qa;if(n&&t){var s=ra(n).hoistableScripts,i=Wa(t),r=s.get(i);r||(r=n.querySelector(Xl(i)),r||(t=Fe({src:t,async:!0},e),(e=Cn.get(i))&&Ig(t,e),r=n.createElement("script"),yt(r),Ct(r,"link",t),n.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},s.set(i,r))}}function nC(t,e){Bs.M(t,e);var n=qa;if(n&&t){var s=ra(n).hoistableScripts,i=Wa(t),r=s.get(i);r||(r=n.querySelector(Xl(i)),r||(t=Fe({src:t,async:!0,type:"module"},e),(e=Cn.get(i))&&Ig(t,e),r=n.createElement("script"),yt(r),Ct(r,"link",t),n.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},s.set(i,r))}}function Db(t,e,n,s){var i=(i=ci.current)?Vu(i):null;if(!i)throw Error(P(446));switch(t){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(e=Ra(n.href),n=ra(i).hoistableStyles,s=n.get(e),s||(s={type:"style",instance:null,count:0,state:null},n.set(e,s)),s):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){t=Ra(n.href);var r=ra(i).hoistableStyles,a=r.get(t);if(a||(i=i.ownerDocument||i,a={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},r.set(t,a),(r=i.querySelector(Wl(t)))&&!r._p&&(a.instance=r,a.state.loading=5),Cn.has(t)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Cn.set(t,n),r||sC(i,t,n,a.state))),e&&s===null)throw Error(P(528,""));return a}if(e&&s!==null)throw Error(P(529,""));return null;case"script":return e=n.async,n=n.src,typeof n=="string"&&e&&typeof e!="function"&&typeof e!="symbol"?(e=Wa(n),n=ra(i).hoistableScripts,s=n.get(e),s||(s={type:"script",instance:null,count:0,state:null},n.set(e,s)),s):{type:"void",instance:null,count:0,state:null};default:throw Error(P(444,t))}}function Ra(t){return'href="'+_n(t)+'"'}function Wl(t){return'link[rel="stylesheet"]['+t+"]"}function DE(t){return Fe({},t,{"data-precedence":t.precedence,precedence:null})}function sC(t,e,n,s){t.querySelector('link[rel="preload"][as="style"]['+e+"]")?s.loading=1:(e=t.createElement("link"),s.preload=e,e.addEventListener("load",function(){return s.loading|=1}),e.addEventListener("error",function(){return s.loading|=2}),Ct(e,"link",n),yt(e),t.head.appendChild(e))}function Wa(t){return'[src="'+_n(t)+'"]'}function Xl(t){return"script[async]"+t}function Lb(t,e,n){if(e.count++,e.instance===null)switch(e.type){case"style":var s=t.querySelector('style[data-href~="'+_n(n.href)+'"]');if(s)return e.instance=s,yt(s),s;var i=Fe({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return s=(t.ownerDocument||t).createElement("style"),yt(s),Ct(s,"style",i),ru(s,n.precedence,t),e.instance=s;case"stylesheet":i=Ra(n.href);var r=t.querySelector(Wl(i));if(r)return e.state.loading|=4,e.instance=r,yt(r),r;s=DE(n),(i=Cn.get(i))&&Rg(s,i),r=(t.ownerDocument||t).createElement("link"),yt(r);var a=r;return a._p=new Promise(function(o,c){a.onload=o,a.onerror=c}),Ct(r,"link",s),e.state.loading|=4,ru(r,n.precedence,t),e.instance=r;case"script":return r=Wa(n.src),(i=t.querySelector(Xl(r)))?(e.instance=i,yt(i),i):(s=n,(i=Cn.get(r))&&(s=Fe({},n),Ig(s,i)),t=t.ownerDocument||t,i=t.createElement("script"),yt(i),Ct(i,"link",s),t.head.appendChild(i),e.instance=i);case"void":return null;default:throw Error(P(443,e.type))}else e.type==="stylesheet"&&!(e.state.loading&4)&&(s=e.instance,e.state.loading|=4,ru(s,n.precedence,t));return e.instance}function ru(t,e,n){for(var s=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),i=s.length?s[s.length-1]:null,r=i,a=0;a<s.length;a++){var o=s[a];if(o.dataset.precedence===e)r=o;else if(r!==i)break}r?r.parentNode.insertBefore(t,r.nextSibling):(e=n.nodeType===9?n.head:n,e.insertBefore(t,e.firstChild))}function Rg(t,e){t.crossOrigin==null&&(t.crossOrigin=e.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=e.referrerPolicy),t.title==null&&(t.title=e.title)}function Ig(t,e){t.crossOrigin==null&&(t.crossOrigin=e.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=e.referrerPolicy),t.integrity==null&&(t.integrity=e.integrity)}var au=null;function Pb(t,e,n){if(au===null){var s=new Map,i=au=new Map;i.set(n,s)}else i=au,s=i.get(n),s||(s=new Map,i.set(n,s));if(s.has(t))return s;for(s.set(t,null),n=n.getElementsByTagName(t),i=0;i<n.length;i++){var r=n[i];if(!(r[Fl]||r[Tt]||t==="link"&&r.getAttribute("rel")==="stylesheet")&&r.namespaceURI!=="http://www.w3.org/2000/svg"){var a=r.getAttribute(e)||"";a=t+a;var o=s.get(a);o?o.push(r):s.set(a,[r])}}return s}function Bb(t,e,n){t=t.ownerDocument||t,t.head.insertBefore(n,e==="title"?t.querySelector("head > title"):null)}function iC(t,e,n){if(n===1||e.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof e.precedence!="string"||typeof e.href!="string"||e.href==="")break;return!0;case"link":if(typeof e.rel!="string"||typeof e.href!="string"||e.href===""||e.onLoad||e.onError)break;switch(e.rel){case"stylesheet":return t=e.disabled,typeof e.precedence=="string"&&t==null;default:return!0}case"script":if(e.async&&typeof e.async!="function"&&typeof e.async!="symbol"&&!e.onLoad&&!e.onError&&e.src&&typeof e.src=="string")return!0}return!1}function LE(t){return!(t.type==="stylesheet"&&!(t.state.loading&3))}function rC(t,e,n,s){if(n.type==="stylesheet"&&(typeof s.media!="string"||matchMedia(s.media).matches!==!1)&&!(n.state.loading&4)){if(n.instance===null){var i=Ra(s.href),r=e.querySelector(Wl(i));if(r){e=r._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(t.count++,t=Fu.bind(t),e.then(t,t)),n.state.loading|=4,n.instance=r,yt(r);return}r=e.ownerDocument||e,s=DE(s),(i=Cn.get(i))&&Rg(s,i),r=r.createElement("link"),yt(r);var a=r;a._p=new Promise(function(o,c){a.onload=o,a.onerror=c}),Ct(r,"link",s),n.instance=r}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(n,e),(e=n.state.preload)&&!(n.state.loading&3)&&(t.count++,n=Fu.bind(t),e.addEventListener("load",n),e.addEventListener("error",n))}}var rh=0;function aC(t,e){return t.stylesheets&&t.count===0&&ou(t,t.stylesheets),0<t.count||0<t.imgCount?function(n){var s=setTimeout(function(){if(t.stylesheets&&ou(t,t.stylesheets),t.unsuspend){var r=t.unsuspend;t.unsuspend=null,r()}},6e4+e);0<t.imgBytes&&rh===0&&(rh=62500*HI());var i=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&ou(t,t.stylesheets),t.unsuspend)){var r=t.unsuspend;t.unsuspend=null,r()}},(t.imgBytes>rh?50:800)+e);return t.unsuspend=n,function(){t.unsuspend=null,clearTimeout(s),clearTimeout(i)}}:null}function Fu(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)ou(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var zu=null;function ou(t,e){t.stylesheets=null,t.unsuspend!==null&&(t.count++,zu=new Map,e.forEach(oC,t),zu=null,Fu.call(t))}function oC(t,e){if(!(e.state.loading&4)){var n=zu.get(t);if(n)var s=n.get(null);else{n=new Map,zu.set(t,n);for(var i=t.querySelectorAll("link[data-precedence],style[data-precedence]"),r=0;r<i.length;r++){var a=i[r];(a.nodeName==="LINK"||a.getAttribute("media")!=="not all")&&(n.set(a.dataset.precedence,a),s=a)}s&&n.set(null,s)}i=e.instance,a=i.getAttribute("data-precedence"),r=n.get(a)||s,r===s&&n.set(null,i),n.set(a,i),this.count++,s=Fu.bind(this),i.addEventListener("load",s),i.addEventListener("error",s),r?r.parentNode.insertBefore(i,r.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(i,t.firstChild)),e.state.loading|=4}}var ml={$$typeof:ps,Provider:null,Consumer:null,_currentValue:tr,_currentValue2:tr,_threadCount:0};function lC(t,e,n,s,i,r,a,o,c){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Af(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Af(0),this.hiddenUpdates=Af(null),this.identifierPrefix=s,this.onUncaughtError=i,this.onCaughtError=r,this.onRecoverableError=a,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=c,this.incompleteTransitions=new Map}function PE(t,e,n,s,i,r,a,o,c,u,d,f){return t=new lC(t,e,n,a,c,u,d,f,o),e=1,r===!0&&(e|=24),r=sn(3,null,null,e),t.current=r,r.stateNode=t,e=ng(),e.refCount++,t.pooledCache=e,e.refCount++,r.memoizedState={element:s,isDehydrated:n,cache:e},rg(r),t}function BE(t){return t?(t=qr,t):qr}function UE(t,e,n,s,i,r){i=BE(i),s.context===null?s.context=i:s.pendingContext=i,s=di(e),s.payload={element:n},r=r===void 0?null:r,r!==null&&(s.callback=r),n=fi(t,s,e),n!==null&&(Jt(n,t,e),Po(n,t,e))}function Ub(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Cg(t,e){Ub(t,e),(t=t.alternate)&&Ub(t,e)}function HE(t){if(t.tag===13||t.tag===31){var e=Sr(t,67108864);e!==null&&Jt(e,t,67108864),Cg(t,67108864)}}function Hb(t){if(t.tag===13||t.tag===31){var e=un();e=Vp(e);var n=Sr(t,e);n!==null&&Jt(n,t,e),Cg(t,e)}}var $u=!0;function cC(t,e,n,s){var i=ie.T;ie.T=null;var r=Ne.p;try{Ne.p=2,jg(t,e,n,s)}finally{Ne.p=r,ie.T=i}}function uC(t,e,n,s){var i=ie.T;ie.T=null;var r=Ne.p;try{Ne.p=8,jg(t,e,n,s)}finally{Ne.p=r,ie.T=i}}function jg(t,e,n,s){if($u){var i=Im(s);if(i===null)sh(t,e,s,Ku,n),Gb(t,s);else if(fC(i,t,e,n,s))s.stopPropagation();else if(Gb(t,s),e&4&&-1<dC.indexOf(t)){for(;i!==null;){var r=za(i);if(r!==null)switch(r.tag){case 3:if(r=r.stateNode,r.current.memoizedState.isDehydrated){var a=$i(r.pendingLanes);if(a!==0){var o=r;for(o.pendingLanes|=2,o.entangledLanes|=2;a;){var c=1<<31-cn(a);o.entanglements[1]|=c,a&=~c}rs(r),!(Ee&6)&&(Du=on()+500,ql(0))}}break;case 31:case 13:o=Sr(r,2),o!==null&&Jt(o,r,2),Fd(),Cg(r,2)}if(r=Im(s),r===null&&sh(t,e,s,Ku,n),r===i)break;i=r}i!==null&&s.stopPropagation()}else sh(t,e,s,null,n)}}function Im(t){return t=Kp(t),Og(t)}var Ku=null;function Og(t){if(Ku=null,t=Vr(t),t!==null){var e=Ul(t);if(e===null)t=null;else{var n=e.tag;if(n===13){if(t=a1(e),t!==null)return t;t=null}else if(n===31){if(t=o1(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null)}}return Ku=t,null}function GE(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(XA()){case d1:return 2;case f1:return 8;case _u:case QA:return 32;case h1:return 268435456;default:return 32}default:return 32}}var Cm=!1,pi=null,gi=null,vi=null,pl=new Map,gl=new Map,Xs=[],dC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Gb(t,e){switch(t){case"focusin":case"focusout":pi=null;break;case"dragenter":case"dragleave":gi=null;break;case"mouseover":case"mouseout":vi=null;break;case"pointerover":case"pointerout":pl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":gl.delete(e.pointerId)}}function vo(t,e,n,s,i,r){return t===null||t.nativeEvent!==r?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:r,targetContainers:[i]},e!==null&&(e=za(e),e!==null&&HE(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function fC(t,e,n,s,i){switch(e){case"focusin":return pi=vo(pi,t,e,n,s,i),!0;case"dragenter":return gi=vo(gi,t,e,n,s,i),!0;case"mouseover":return vi=vo(vi,t,e,n,s,i),!0;case"pointerover":var r=i.pointerId;return pl.set(r,vo(pl.get(r)||null,t,e,n,s,i)),!0;case"gotpointercapture":return r=i.pointerId,gl.set(r,vo(gl.get(r)||null,t,e,n,s,i)),!0}return!1}function VE(t){var e=Vr(t.target);if(e!==null){var n=Ul(e);if(n!==null){if(e=n.tag,e===13){if(e=a1(n),e!==null){t.blockedOn=e,kv(t.priority,function(){Hb(n)});return}}else if(e===31){if(e=o1(n),e!==null){t.blockedOn=e,kv(t.priority,function(){Hb(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function lu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Im(t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);Wh=s,n.target.dispatchEvent(s),Wh=null}else return e=za(n),e!==null&&HE(e),t.blockedOn=n,!1;e.shift()}return!0}function Vb(t,e,n){lu(t)&&n.delete(e)}function hC(){Cm=!1,pi!==null&&lu(pi)&&(pi=null),gi!==null&&lu(gi)&&(gi=null),vi!==null&&lu(vi)&&(vi=null),pl.forEach(Vb),gl.forEach(Vb)}function Mc(t,e){t.blockedOn===e&&(t.blockedOn=null,Cm||(Cm=!0,pt.unstable_scheduleCallback(pt.unstable_NormalPriority,hC)))}var Dc=null;function Fb(t){Dc!==t&&(Dc=t,pt.unstable_scheduleCallback(pt.unstable_NormalPriority,function(){Dc===t&&(Dc=null);for(var e=0;e<t.length;e+=3){var n=t[e],s=t[e+1],i=t[e+2];if(typeof s!="function"){if(Og(s||n)===null)continue;break}var r=za(n);r!==null&&(t.splice(e,3),e-=3,dm(r,{pending:!0,data:i,method:n.method,action:s},s,i))}}))}function Ia(t){function e(c){return Mc(c,t)}pi!==null&&Mc(pi,t),gi!==null&&Mc(gi,t),vi!==null&&Mc(vi,t),pl.forEach(e),gl.forEach(e);for(var n=0;n<Xs.length;n++){var s=Xs[n];s.blockedOn===t&&(s.blockedOn=null)}for(;0<Xs.length&&(n=Xs[0],n.blockedOn===null);)VE(n),n.blockedOn===null&&Xs.shift();if(n=(t.ownerDocument||t).$$reactFormReplay,n!=null)for(s=0;s<n.length;s+=3){var i=n[s],r=n[s+1],a=i[Zt]||null;if(typeof r=="function")a||Fb(n);else if(a){var o=null;if(r&&r.hasAttribute("formAction")){if(i=r,a=r[Zt]||null)o=a.formAction;else if(Og(i)!==null)continue}else o=a.action;typeof o=="function"?n[s+1]=o:(n.splice(s,3),s-=3),Fb(n)}}}function FE(){function t(r){r.canIntercept&&r.info==="react-transition"&&r.intercept({handler:function(){return new Promise(function(a){return i=a})},focusReset:"manual",scroll:"manual"})}function e(){i!==null&&(i(),i=null),s||setTimeout(n,20)}function n(){if(!s&&!navigation.transition){var r=navigation.currentEntry;r&&r.url!=null&&navigation.navigate(r.url,{state:r.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var s=!1,i=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",e),navigation.addEventListener("navigateerror",e),setTimeout(n,100),function(){s=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",e),navigation.removeEventListener("navigateerror",e),i!==null&&(i(),i=null)}}}function Mg(t){this._internalRoot=t}Kd.prototype.render=Mg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(P(409));var n=e.current,s=un();UE(n,s,t,e,null,null)};Kd.prototype.unmount=Mg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;UE(t.current,2,null,t,null,null),Fd(),e[Fa]=null}};function Kd(t){this._internalRoot=t}Kd.prototype.unstable_scheduleHydration=function(t){if(t){var e=b1();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Xs.length&&e!==0&&e<Xs[n].priority;n++);Xs.splice(n,0,t),n===0&&VE(t)}};var zb=i1.version;if(zb!=="19.2.3")throw Error(P(527,zb,"19.2.3"));Ne.findDOMNode=function(t){var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(P(188)):(t=Object.keys(t).join(","),Error(P(268,t)));return t=FA(e),t=t!==null?l1(t):null,t=t===null?null:t.stateNode,t};var mC={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:ie,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Lc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Lc.isDisabled&&Lc.supportsFiber)try{Hl=Lc.inject(mC),ln=Lc}catch{}}Rd.createRoot=function(t,e){if(!r1(t))throw Error(P(299));var n=!1,s="",i=Mw,r=Dw,a=Lw;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onUncaughtError!==void 0&&(i=e.onUncaughtError),e.onCaughtError!==void 0&&(r=e.onCaughtError),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=PE(t,1,!1,null,null,n,s,null,i,r,a,FE),t[Fa]=e.current,Ag(t),new Mg(e)};Rd.hydrateRoot=function(t,e,n){if(!r1(t))throw Error(P(299));var s=!1,i="",r=Mw,a=Dw,o=Lw,c=null;return n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onUncaughtError!==void 0&&(r=n.onUncaughtError),n.onCaughtError!==void 0&&(a=n.onCaughtError),n.onRecoverableError!==void 0&&(o=n.onRecoverableError),n.formState!==void 0&&(c=n.formState)),e=PE(t,1,!0,e,n??null,s,i,c,r,a,o,FE),e.context=BE(null),n=e.current,s=un(),s=Vp(s),i=di(s),i.callback=null,fi(n,i,s),n=s,e.current.lanes=n,Vl(e,n),rs(e),t[Fa]=e.current,Ag(t),new Kd(e)};Rd.version="19.2.3";function zE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(zE)}catch(t){console.error(t)}}zE(),J_.exports=Rd;var pC=J_.exports;const gC=V_(pC);/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function vl(){return vl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},vl.apply(this,arguments)}var ai;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(ai||(ai={}));const $b="popstate";function vC(t){t===void 0&&(t={});function e(s,i){let{pathname:r,search:a,hash:o}=s.location;return jm("",{pathname:r,search:a,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(s,i){return typeof i=="string"?i:$E(i)}return xC(e,n,null,t)}function ut(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Dg(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function bC(){return Math.random().toString(36).substr(2,8)}function Kb(t,e){return{usr:t.state,key:t.key,idx:e}}function jm(t,e,n,s){return n===void 0&&(n=null),vl({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Xa(e):e,{state:n,key:e&&e.key||s||bC()})}function $E(t){let{pathname:e="/",search:n="",hash:s=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function Xa(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function xC(t,e,n,s){s===void 0&&(s={});let{window:i=document.defaultView,v5Compat:r=!1}=s,a=i.history,o=ai.Pop,c=null,u=d();u==null&&(u=0,a.replaceState(vl({},a.state,{idx:u}),""));function d(){return(a.state||{idx:null}).idx}function f(){o=ai.Pop;let x=d(),p=x==null?null:x-u;u=x,c&&c({action:o,location:b.location,delta:p})}function h(x,p){o=ai.Push;let v=jm(b.location,x,p);u=d()+1;let y=Kb(v,u),E=b.createHref(v);try{a.pushState(y,"",E)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;i.location.assign(E)}r&&c&&c({action:o,location:b.location,delta:1})}function m(x,p){o=ai.Replace;let v=jm(b.location,x,p);u=d();let y=Kb(v,u),E=b.createHref(v);a.replaceState(y,"",E),r&&c&&c({action:o,location:b.location,delta:0})}function g(x){let p=i.location.origin!=="null"?i.location.origin:i.location.href,v=typeof x=="string"?x:$E(x);return v=v.replace(/ $/,"%20"),ut(p,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,p)}let b={get action(){return o},get location(){return t(i,a)},listen(x){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener($b,f),c=x,()=>{i.removeEventListener($b,f),c=null}},createHref(x){return e(i,x)},createURL:g,encodeLocation(x){let p=g(x);return{pathname:p.pathname,search:p.search,hash:p.hash}},push:h,replace:m,go(x){return a.go(x)}};return b}var Yb;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Yb||(Yb={}));function yC(t,e,n){return n===void 0&&(n="/"),_C(t,e,n)}function _C(t,e,n,s){let i=typeof e=="string"?Xa(e):e,r=qE(i.pathname||"/",n);if(r==null)return null;let a=KE(t);wC(a);let o=null;for(let c=0;o==null&&c<a.length;++c){let u=MC(r);o=CC(a[c],u)}return o}function KE(t,e,n,s){e===void 0&&(e=[]),n===void 0&&(n=[]),s===void 0&&(s="");let i=(r,a,o)=>{let c={relativePath:o===void 0?r.path||"":o,caseSensitive:r.caseSensitive===!0,childrenIndex:a,route:r};c.relativePath.startsWith("/")&&(ut(c.relativePath.startsWith(s),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(s.length));let u=ar([s,c.relativePath]),d=n.concat(c);r.children&&r.children.length>0&&(ut(r.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),KE(r.children,e,d,u)),!(r.path==null&&!r.index)&&e.push({path:u,score:RC(u,r.index),routesMeta:d})};return t.forEach((r,a)=>{var o;if(r.path===""||!((o=r.path)!=null&&o.includes("?")))i(r,a);else for(let c of YE(r.path))i(r,a,c)}),e}function YE(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,i=n.endsWith("?"),r=n.replace(/\?$/,"");if(s.length===0)return i?[r,""]:[r];let a=YE(s.join("/")),o=[];return o.push(...a.map(c=>c===""?r:[r,c].join("/"))),i&&o.push(...a),o.map(c=>t.startsWith("/")&&c===""?"/":c)}function wC(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:IC(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const EC=/^:[\w-]+$/,NC=3,kC=2,SC=1,TC=10,AC=-2,qb=t=>t==="*";function RC(t,e){let n=t.split("/"),s=n.length;return n.some(qb)&&(s+=AC),e&&(s+=kC),n.filter(i=>!qb(i)).reduce((i,r)=>i+(EC.test(r)?NC:r===""?SC:TC),s)}function IC(t,e){return t.length===e.length&&t.slice(0,-1).every((s,i)=>s===e[i])?t[t.length-1]-e[e.length-1]:0}function CC(t,e,n){let{routesMeta:s}=t,i={},r="/",a=[];for(let o=0;o<s.length;++o){let c=s[o],u=o===s.length-1,d=r==="/"?e:e.slice(r.length)||"/",f=jC({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),h=c.route;if(!f)return null;Object.assign(i,f.params),a.push({params:i,pathname:ar([r,f.pathname]),pathnameBase:UC(ar([r,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(r=ar([r,f.pathnameBase]))}return a}function jC(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=OC(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let r=i[0],a=r.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:s.reduce((u,d,f)=>{let{paramName:h,isOptional:m}=d;if(h==="*"){let b=o[f]||"";a=r.slice(0,r.length-b.length).replace(/(.)\/+$/,"$1")}const g=o[f];return m&&!g?u[h]=void 0:u[h]=(g||"").replace(/%2F/g,"/"),u},{}),pathname:r,pathnameBase:a,pattern:t}}function OC(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Dg(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,c)=>(s.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),s]}function MC(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Dg(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function qE(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}const DC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,LC=t=>DC.test(t);function PC(t,e){e===void 0&&(e="/");let{pathname:n,search:s="",hash:i=""}=typeof t=="string"?Xa(t):t,r;if(n)if(LC(n))r=n;else{if(n.includes("//")){let a=n;n=n.replace(/\/\/+/g,"/"),Dg(!1,"Pathnames cannot have embedded double slashes - normalizing "+(a+" -> "+n))}n.startsWith("/")?r=Wb(n.substring(1),"/"):r=Wb(n,e)}else r=e;return{pathname:r,search:HC(s),hash:GC(i)}}function Wb(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function ah(t,e,n,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function BC(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function WE(t,e){let n=BC(t);return e?n.map((s,i)=>i===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function XE(t,e,n,s){s===void 0&&(s=!1);let i;typeof t=="string"?i=Xa(t):(i=vl({},t),ut(!i.pathname||!i.pathname.includes("?"),ah("?","pathname","search",i)),ut(!i.pathname||!i.pathname.includes("#"),ah("#","pathname","hash",i)),ut(!i.search||!i.search.includes("#"),ah("#","search","hash",i)));let r=t===""||i.pathname==="",a=r?"/":i.pathname,o;if(a==null)o=n;else{let f=e.length-1;if(!s&&a.startsWith("..")){let h=a.split("/");for(;h[0]==="..";)h.shift(),f-=1;i.pathname=h.join("/")}o=f>=0?e[f]:"/"}let c=PC(i,o),u=a&&a!=="/"&&a.endsWith("/"),d=(r||a===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const ar=t=>t.join("/").replace(/\/\/+/g,"/"),UC=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),HC=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,GC=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function VC(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const QE=["post","put","patch","delete"];new Set(QE);const FC=["get",...QE];new Set(FC);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function bl(){return bl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},bl.apply(this,arguments)}const Lg=_.createContext(null),zC=_.createContext(null),Ql=_.createContext(null),Yd=_.createContext(null),Pi=_.createContext({outlet:null,matches:[],isDataRoute:!1}),JE=_.createContext(null);function Jl(){return _.useContext(Yd)!=null}function qd(){return Jl()||ut(!1),_.useContext(Yd).location}function ZE(t){_.useContext(Ql).static||_.useLayoutEffect(t)}function Qa(){let{isDataRoute:t}=_.useContext(Pi);return t?s2():$C()}function $C(){Jl()||ut(!1);let t=_.useContext(Lg),{basename:e,future:n,navigator:s}=_.useContext(Ql),{matches:i}=_.useContext(Pi),{pathname:r}=qd(),a=JSON.stringify(WE(i,n.v7_relativeSplatPath)),o=_.useRef(!1);return ZE(()=>{o.current=!0}),_.useCallback(function(u,d){if(d===void 0&&(d={}),!o.current)return;if(typeof u=="number"){s.go(u);return}let f=XE(u,JSON.parse(a),r,d.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:ar([e,f.pathname])),(d.replace?s.replace:s.push)(f,d.state,d)},[e,s,a,r,t])}function eN(){let{matches:t}=_.useContext(Pi),e=t[t.length-1];return e?e.params:{}}function KC(t,e){return YC(t,e)}function YC(t,e,n,s){Jl()||ut(!1);let{navigator:i}=_.useContext(Ql),{matches:r}=_.useContext(Pi),a=r[r.length-1],o=a?a.params:{};a&&a.pathname;let c=a?a.pathnameBase:"/";a&&a.route;let u=qd(),d;if(e){var f;let x=typeof e=="string"?Xa(e):e;c==="/"||(f=x.pathname)!=null&&f.startsWith(c)||ut(!1),d=x}else d=u;let h=d.pathname||"/",m=h;if(c!=="/"){let x=c.replace(/^\//,"").split("/");m="/"+h.replace(/^\//,"").split("/").slice(x.length).join("/")}let g=yC(t,{pathname:m}),b=JC(g&&g.map(x=>Object.assign({},x,{params:Object.assign({},o,x.params),pathname:ar([c,i.encodeLocation?i.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?c:ar([c,i.encodeLocation?i.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),r,n,s);return e&&b?_.createElement(Yd.Provider,{value:{location:bl({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:ai.Pop}},b):b}function qC(){let t=n2(),e=VC(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return _.createElement(_.Fragment,null,_.createElement("h2",null,"Unexpected Application Error!"),_.createElement("h3",{style:{fontStyle:"italic"}},e),n?_.createElement("pre",{style:i},n):null,null)}const WC=_.createElement(qC,null);class XC extends _.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?_.createElement(Pi.Provider,{value:this.props.routeContext},_.createElement(JE.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function QC(t){let{routeContext:e,match:n,children:s}=t,i=_.useContext(Lg);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),_.createElement(Pi.Provider,{value:e},s)}function JC(t,e,n,s){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),s===void 0&&(s=null),t==null){var r;if(!n)return null;if(n.errors)t=n.matches;else if((r=s)!=null&&r.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let a=t,o=(i=n)==null?void 0:i.errors;if(o!=null){let d=a.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);d>=0||ut(!1),a=a.slice(0,Math.min(a.length,d+1))}let c=!1,u=-1;if(n&&s&&s.v7_partialHydration)for(let d=0;d<a.length;d++){let f=a[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=d),f.route.id){let{loaderData:h,errors:m}=n,g=f.route.loader&&h[f.route.id]===void 0&&(!m||m[f.route.id]===void 0);if(f.route.lazy||g){c=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((d,f,h)=>{let m,g=!1,b=null,x=null;n&&(m=o&&f.route.id?o[f.route.id]:void 0,b=f.route.errorElement||WC,c&&(u<0&&h===0?(i2("route-fallback"),g=!0,x=null):u===h&&(g=!0,x=f.route.hydrateFallbackElement||null)));let p=e.concat(a.slice(0,h+1)),v=()=>{let y;return m?y=b:g?y=x:f.route.Component?y=_.createElement(f.route.Component,null):f.route.element?y=f.route.element:y=d,_.createElement(QC,{match:f,routeContext:{outlet:d,matches:p,isDataRoute:n!=null},children:y})};return n&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?_.createElement(XC,{location:n.location,revalidation:n.revalidation,component:b,error:m,children:v(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):v()},null)}var tN=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(tN||{}),nN=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(nN||{});function ZC(t){let e=_.useContext(Lg);return e||ut(!1),e}function e2(t){let e=_.useContext(zC);return e||ut(!1),e}function t2(t){let e=_.useContext(Pi);return e||ut(!1),e}function sN(t){let e=t2(),n=e.matches[e.matches.length-1];return n.route.id||ut(!1),n.route.id}function n2(){var t;let e=_.useContext(JE),n=e2(),s=sN();return e!==void 0?e:(t=n.errors)==null?void 0:t[s]}function s2(){let{router:t}=ZC(tN.UseNavigateStable),e=sN(nN.UseNavigateStable),n=_.useRef(!1);return ZE(()=>{n.current=!0}),_.useCallback(function(i,r){r===void 0&&(r={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,bl({fromRouteId:e},r)))},[t,e])}const Xb={};function i2(t,e,n){Xb[t]||(Xb[t]=!0)}function r2(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function a2(t){let{to:e,replace:n,state:s,relative:i}=t;Jl()||ut(!1);let{future:r,static:a}=_.useContext(Ql),{matches:o}=_.useContext(Pi),{pathname:c}=qd(),u=Qa(),d=XE(e,WE(o,r.v7_relativeSplatPath),c,i==="path"),f=JSON.stringify(d);return _.useEffect(()=>u(JSON.parse(f),{replace:n,state:s,relative:i}),[u,f,i,n,s]),null}function Ao(t){ut(!1)}function o2(t){let{basename:e="/",children:n=null,location:s,navigationType:i=ai.Pop,navigator:r,static:a=!1,future:o}=t;Jl()&&ut(!1);let c=e.replace(/^\/*/,"/"),u=_.useMemo(()=>({basename:c,navigator:r,static:a,future:bl({v7_relativeSplatPath:!1},o)}),[c,o,r,a]);typeof s=="string"&&(s=Xa(s));let{pathname:d="/",search:f="",hash:h="",state:m=null,key:g="default"}=s,b=_.useMemo(()=>{let x=qE(d,c);return x==null?null:{location:{pathname:x,search:f,hash:h,state:m,key:g},navigationType:i}},[c,d,f,h,m,g,i]);return b==null?null:_.createElement(Ql.Provider,{value:u},_.createElement(Yd.Provider,{children:n,value:b}))}function l2(t){let{children:e,location:n}=t;return KC(Om(e),n)}new Promise(()=>{});function Om(t,e){e===void 0&&(e=[]);let n=[];return _.Children.forEach(t,(s,i)=>{if(!_.isValidElement(s))return;let r=[...e,i];if(s.type===_.Fragment){n.push.apply(n,Om(s.props.children,r));return}s.type!==Ao&&ut(!1),!s.props.index||!s.props.children||ut(!1);let a={id:s.props.id||r.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(a.children=Om(s.props.children,r)),n.push(a)}),n}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Mm(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let s=t[n];return e.concat(Array.isArray(s)?s.map(i=>[n,i]):[[n,s]])},[]))}function c2(t,e){let n=Mm(t);return e&&e.forEach((s,i)=>{n.has(i)||e.getAll(i).forEach(r=>{n.append(i,r)})}),n}const u2="6";try{window.__reactRouterVersion=u2}catch{}const d2="startTransition",Qb=LA[d2];function f2(t){let{basename:e,children:n,future:s,window:i}=t,r=_.useRef();r.current==null&&(r.current=vC({window:i,v5Compat:!0}));let a=r.current,[o,c]=_.useState({action:a.action,location:a.location}),{v7_startTransition:u}=s||{},d=_.useCallback(f=>{u&&Qb?Qb(()=>c(f)):c(f)},[c,u]);return _.useLayoutEffect(()=>a.listen(d),[a,d]),_.useEffect(()=>r2(s),[s]),_.createElement(o2,{basename:e,children:n,location:o.location,navigationType:o.action,navigator:a,future:s})}var Jb;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Jb||(Jb={}));var Zb;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Zb||(Zb={}));function h2(t){let e=_.useRef(Mm(t)),n=_.useRef(!1),s=qd(),i=_.useMemo(()=>c2(s.search,n.current?null:e.current),[s.search]),r=Qa(),a=_.useCallback((o,c)=>{const u=Mm(typeof o=="function"?o(i):o);n.current=!0,r("?"+u,c)},[r,i]);return[i,a]}const iN=_.createContext({setFullWidth:()=>{},setHideHeader:()=>{}}),rN=()=>_.useContext(iN),m2=({children:t})=>{const[,e]=_.useState(!1),[,n]=_.useState(!1);return l.jsx(iN.Provider,{value:{setFullWidth:e,setHideHeader:n},children:t})},p2=()=>{};var ex={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aN={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F=function(t,e){if(!t)throw Ja(e)},Ja=function(t){return new Error("Firebase Database ("+aN.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oN=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let i=t.charCodeAt(s);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},g2=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const i=t[n++];if(i<128)e[s++]=String.fromCharCode(i);else if(i>191&&i<224){const r=t[n++];e[s++]=String.fromCharCode((i&31)<<6|r&63)}else if(i>239&&i<365){const r=t[n++],a=t[n++],o=t[n++],c=((i&7)<<18|(r&63)<<12|(a&63)<<6|o&63)-65536;e[s++]=String.fromCharCode(55296+(c>>10)),e[s++]=String.fromCharCode(56320+(c&1023))}else{const r=t[n++],a=t[n++];e[s++]=String.fromCharCode((i&15)<<12|(r&63)<<6|a&63)}}return e.join("")},Pg={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let i=0;i<t.length;i+=3){const r=t[i],a=i+1<t.length,o=a?t[i+1]:0,c=i+2<t.length,u=c?t[i+2]:0,d=r>>2,f=(r&3)<<4|o>>4;let h=(o&15)<<2|u>>6,m=u&63;c||(m=64,a||(h=64)),s.push(n[d],n[f],n[h],n[m])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(oN(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):g2(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let i=0;i<t.length;){const r=n[t.charAt(i++)],o=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const f=i<t.length?n[t.charAt(i)]:64;if(++i,r==null||o==null||u==null||f==null)throw new v2;const h=r<<2|o>>4;if(s.push(h),u!==64){const m=o<<4&240|u>>2;if(s.push(m),f!==64){const g=u<<6&192|f;s.push(g)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class v2 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const lN=function(t){const e=oN(t);return Pg.encodeByteArray(e,!0)},Yu=function(t){return lN(t).replace(/\./g,"")},qu=function(t){try{return Pg.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b2(t){return cN(void 0,t)}function cN(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!x2(n)||(t[n]=cN(t[n],e[n]));return t}function x2(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y2(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _2=()=>y2().__FIREBASE_DEFAULTS__,w2=()=>{if(typeof process>"u"||typeof ex>"u")return;const t=ex.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},E2=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&qu(t[1]);return e&&JSON.parse(e)},Bg=()=>{try{return p2()||_2()||w2()||E2()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},uN=t=>{var e,n;return(n=(e=Bg())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},N2=t=>{const e=uN(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),s]:[e.substring(0,n),s]},dN=()=>{var t;return(t=Bg())===null||t===void 0?void 0:t.config},fN=t=>{var e;return(e=Bg())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Za(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function hN(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k2(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",i=t.iat||0,r=t.sub||t.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Yu(JSON.stringify(n)),Yu(JSON.stringify(a)),""].join(".")}const Ko={};function S2(){const t={prod:[],emulator:[]};for(const e of Object.keys(Ko))Ko[e]?t.emulator.push(e):t.prod.push(e);return t}function T2(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let tx=!1;function mN(t,e){if(typeof window>"u"||typeof document>"u"||!Za(window.location.host)||Ko[t]===e||Ko[t]||tx)return;Ko[t]=e;function n(h){return`__firebase__banner__${h}`}const s="__firebase__banner",r=S2().prod.length>0;function a(){const h=document.getElementById(s);h&&h.remove()}function o(h){h.style.display="flex",h.style.background="#7faaf0",h.style.position="fixed",h.style.bottom="5px",h.style.left="5px",h.style.padding=".5em",h.style.borderRadius="5px",h.style.alignItems="center"}function c(h,m){h.setAttribute("width","24"),h.setAttribute("id",m),h.setAttribute("height","24"),h.setAttribute("viewBox","0 0 24 24"),h.setAttribute("fill","none"),h.style.marginLeft="-6px"}function u(){const h=document.createElement("span");return h.style.cursor="pointer",h.style.marginLeft="16px",h.style.fontSize="24px",h.innerHTML=" &times;",h.onclick=()=>{tx=!0,a()},h}function d(h,m){h.setAttribute("id",m),h.innerText="Learn more",h.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",h.setAttribute("target","__blank"),h.style.paddingLeft="5px",h.style.textDecoration="underline"}function f(){const h=T2(s),m=n("text"),g=document.getElementById(m)||document.createElement("span"),b=n("learnmore"),x=document.getElementById(b)||document.createElement("a"),p=n("preprendIcon"),v=document.getElementById(p)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(h.created){const y=h.element;o(y),d(x,b);const E=u();c(v,p),y.append(v,g,x,E),document.body.appendChild(y)}r?(g.innerText="Preview backend disconnected.",v.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(v.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,g.innerText="Preview backend running in this workspace."),g.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Ug(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Vt())}function A2(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function R2(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function pN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function I2(){const t=Vt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function C2(){return aN.NODE_ADMIN===!0}function j2(){try{return typeof indexedDB=="object"}catch{return!1}}function O2(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(s);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var r;e(((r=i.error)===null||r===void 0?void 0:r.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M2="FirebaseError";class Bi extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=M2,Object.setPrototypeOf(this,Bi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Zl.prototype.create)}}class Zl{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},i=`${this.service}/${e}`,r=this.errors[e],a=r?D2(r,s):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new Bi(i,o,s)}}function D2(t,e){return t.replace(L2,(n,s)=>{const i=e[s];return i!=null?String(i):`<${s}?>`})}const L2=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xl(t){return JSON.parse(t)}function mt(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gN=function(t){let e={},n={},s={},i="";try{const r=t.split(".");e=xl(qu(r[0])||""),n=xl(qu(r[1])||""),i=r[2],s=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:s,signature:i}},P2=function(t){const e=gN(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},B2=function(t){const e=gN(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function pr(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function Wu(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Xu(t,e,n){const s={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(s[i]=e.call(n,t[i],i,t));return s}function gr(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const i of n){if(!s.includes(i))return!1;const r=t[i],a=e[i];if(nx(r)&&nx(a)){if(!gr(r,a))return!1}else if(r!==a)return!1}for(const i of s)if(!n.includes(i))return!1;return!0}function nx(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eo(t){const e=[];for(const[n,s]of Object.entries(t))Array.isArray(s)?s.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function Ro(t){const e={};return t.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[i,r]=s.split("=");e[decodeURIComponent(i)]=decodeURIComponent(r)}}),e}function Io(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U2{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const s=this.W_;if(typeof e=="string")for(let f=0;f<16;f++)s[f]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let f=0;f<16;f++)s[f]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let f=16;f<80;f++){const h=s[f-3]^s[f-8]^s[f-14]^s[f-16];s[f]=(h<<1|h>>>31)&4294967295}let i=this.chain_[0],r=this.chain_[1],a=this.chain_[2],o=this.chain_[3],c=this.chain_[4],u,d;for(let f=0;f<80;f++){f<40?f<20?(u=o^r&(a^o),d=1518500249):(u=r^a^o,d=1859775393):f<60?(u=r&a|o&(r|a),d=2400959708):(u=r^a^o,d=3395469782);const h=(i<<5|i>>>27)+u+c+d+s[f]&4294967295;c=o,o=a,a=(r<<30|r>>>2)&4294967295,r=i,i=h}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+r&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+o&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const s=n-this.blockSize;let i=0;const r=this.buf_;let a=this.inbuf_;for(;i<n;){if(a===0)for(;i<=s;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<n;)if(r[a]=e.charCodeAt(i),++a,++i,a===this.blockSize){this.compress_(r),a=0;break}}else for(;i<n;)if(r[a]=e[i],++a,++i,a===this.blockSize){this.compress_(r),a=0;break}}this.inbuf_=a,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=n&255,n/=256;this.compress_(this.buf_);let s=0;for(let i=0;i<5;i++)for(let r=24;r>=0;r-=8)e[s]=this.chain_[i]>>r&255,++s;return e}}function H2(t,e){const n=new G2(t,e);return n.subscribe.bind(n)}class G2{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,s){let i;if(e===void 0&&n===void 0&&s===void 0)throw new Error("Missing Observer.");V2(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:s},i.next===void 0&&(i.next=oh),i.error===void 0&&(i.error=oh),i.complete===void 0&&(i.complete=oh);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),r}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function V2(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function oh(){}function Ca(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F2=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let i=t.charCodeAt(s);if(i>=55296&&i<=56319){const r=i-55296;s++,F(s<t.length,"Surrogate pair missing trail surrogate.");const a=t.charCodeAt(s)-56320;i=65536+(r<<10)+a}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},Wd=function(t){let e=0;for(let n=0;n<t.length;n++){const s=t.charCodeAt(n);s<128?e++:s<2048?e+=2:s>=55296&&s<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dt(t){return t&&t._delegate?t._delegate:t}class vr{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z2{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new Bn;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&s.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(K2(e))try{this.getOrInitializeService({instanceIdentifier:qi})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const r=this.getOrInitializeService({instanceIdentifier:i});s.resolve(r)}catch{}}}}clearInstance(e=qi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=qi){return this.instances.has(e)}getOptions(e=qi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[r,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(r);s===o&&a.resolve(i)}return i}onInit(e,n){var s;const i=this.normalizeInstanceIdentifier(n),r=(s=this.onInitCallbacks.get(i))!==null&&s!==void 0?s:new Set;r.add(e),this.onInitCallbacks.set(i,r);const a=this.instances.get(i);return a&&e(a,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(s)for(const i of s)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:$2(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=qi){return this.component?this.component.multipleInstances?e:qi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function $2(t){return t===qi?void 0:t}function K2(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y2{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new z2(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var je;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(je||(je={}));const q2={debug:je.DEBUG,verbose:je.VERBOSE,info:je.INFO,warn:je.WARN,error:je.ERROR,silent:je.SILENT},W2=je.INFO,X2={[je.DEBUG]:"log",[je.VERBOSE]:"log",[je.INFO]:"info",[je.WARN]:"warn",[je.ERROR]:"error"},Q2=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),i=X2[e];if(i)console[i](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Hg{constructor(e){this.name=e,this._logLevel=W2,this._logHandler=Q2,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in je))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?q2[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,je.DEBUG,...e),this._logHandler(this,je.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,je.VERBOSE,...e),this._logHandler(this,je.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,je.INFO,...e),this._logHandler(this,je.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,je.WARN,...e),this._logHandler(this,je.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,je.ERROR,...e),this._logHandler(this,je.ERROR,...e)}}const J2=(t,e)=>e.some(n=>t instanceof n);let sx,ix;function Z2(){return sx||(sx=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ej(){return ix||(ix=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const vN=new WeakMap,Dm=new WeakMap,bN=new WeakMap,lh=new WeakMap,Gg=new WeakMap;function tj(t){const e=new Promise((n,s)=>{const i=()=>{t.removeEventListener("success",r),t.removeEventListener("error",a)},r=()=>{n(bi(t.result)),i()},a=()=>{s(t.error),i()};t.addEventListener("success",r),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&vN.set(n,t)}).catch(()=>{}),Gg.set(e,t),e}function nj(t){if(Dm.has(t))return;const e=new Promise((n,s)=>{const i=()=>{t.removeEventListener("complete",r),t.removeEventListener("error",a),t.removeEventListener("abort",a)},r=()=>{n(),i()},a=()=>{s(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",r),t.addEventListener("error",a),t.addEventListener("abort",a)});Dm.set(t,e)}let Lm={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Dm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||bN.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return bi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function sj(t){Lm=t(Lm)}function ij(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(ch(this),e,...n);return bN.set(s,e.sort?e.sort():[e]),bi(s)}:ej().includes(t)?function(...e){return t.apply(ch(this),e),bi(vN.get(this))}:function(...e){return bi(t.apply(ch(this),e))}}function rj(t){return typeof t=="function"?ij(t):(t instanceof IDBTransaction&&nj(t),J2(t,Z2())?new Proxy(t,Lm):t)}function bi(t){if(t instanceof IDBRequest)return tj(t);if(lh.has(t))return lh.get(t);const e=rj(t);return e!==t&&(lh.set(t,e),Gg.set(e,t)),e}const ch=t=>Gg.get(t);function aj(t,e,{blocked:n,upgrade:s,blocking:i,terminated:r}={}){const a=indexedDB.open(t,e),o=bi(a);return s&&a.addEventListener("upgradeneeded",c=>{s(bi(a.result),c.oldVersion,c.newVersion,bi(a.transaction),c)}),n&&a.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),o.then(c=>{r&&c.addEventListener("close",()=>r()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),o}const oj=["get","getKey","getAll","getAllKeys","count"],lj=["put","add","delete","clear"],uh=new Map;function rx(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(uh.get(e))return uh.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,i=lj.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(i||oj.includes(n)))return;const r=async function(a,...o){const c=this.transaction(a,i?"readwrite":"readonly");let u=c.store;return s&&(u=u.index(o.shift())),(await Promise.all([u[n](...o),i&&c.done]))[0]};return uh.set(e,r),r}sj(t=>({...t,get:(e,n,s)=>rx(e,n)||t.get(e,n,s),has:(e,n)=>!!rx(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cj{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(uj(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function uj(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Pm="@firebase/app",ax="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const js=new Hg("@firebase/app"),dj="@firebase/app-compat",fj="@firebase/analytics-compat",hj="@firebase/analytics",mj="@firebase/app-check-compat",pj="@firebase/app-check",gj="@firebase/auth",vj="@firebase/auth-compat",bj="@firebase/database",xj="@firebase/data-connect",yj="@firebase/database-compat",_j="@firebase/functions",wj="@firebase/functions-compat",Ej="@firebase/installations",Nj="@firebase/installations-compat",kj="@firebase/messaging",Sj="@firebase/messaging-compat",Tj="@firebase/performance",Aj="@firebase/performance-compat",Rj="@firebase/remote-config",Ij="@firebase/remote-config-compat",Cj="@firebase/storage",jj="@firebase/storage-compat",Oj="@firebase/firestore",Mj="@firebase/ai",Dj="@firebase/firestore-compat",Lj="firebase",Pj="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bm="[DEFAULT]",Bj={[Pm]:"fire-core",[dj]:"fire-core-compat",[hj]:"fire-analytics",[fj]:"fire-analytics-compat",[pj]:"fire-app-check",[mj]:"fire-app-check-compat",[gj]:"fire-auth",[vj]:"fire-auth-compat",[bj]:"fire-rtdb",[xj]:"fire-data-connect",[yj]:"fire-rtdb-compat",[_j]:"fire-fn",[wj]:"fire-fn-compat",[Ej]:"fire-iid",[Nj]:"fire-iid-compat",[kj]:"fire-fcm",[Sj]:"fire-fcm-compat",[Tj]:"fire-perf",[Aj]:"fire-perf-compat",[Rj]:"fire-rc",[Ij]:"fire-rc-compat",[Cj]:"fire-gcs",[jj]:"fire-gcs-compat",[Oj]:"fire-fst",[Dj]:"fire-fst-compat",[Mj]:"fire-vertex","fire-js":"fire-js",[Lj]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qu=new Map,Uj=new Map,Um=new Map;function ox(t,e){try{t.container.addComponent(e)}catch(n){js.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function ja(t){const e=t.name;if(Um.has(e))return js.debug(`There were multiple attempts to register component ${e}.`),!1;Um.set(e,t);for(const n of Qu.values())ox(n,t);for(const n of Uj.values())ox(n,t);return!0}function Vg(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function rn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hj={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},xi=new Zl("app","Firebase",Hj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gj{constructor(e,n,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new vr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw xi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const to=Pj;function xN(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const s=Object.assign({name:Bm,automaticDataCollectionEnabled:!0},e),i=s.name;if(typeof i!="string"||!i)throw xi.create("bad-app-name",{appName:String(i)});if(n||(n=dN()),!n)throw xi.create("no-options");const r=Qu.get(i);if(r){if(gr(n,r.options)&&gr(s,r.config))return r;throw xi.create("duplicate-app",{appName:i})}const a=new Y2(i);for(const c of Um.values())a.addComponent(c);const o=new Gj(n,s,a);return Qu.set(i,o),o}function yN(t=Bm){const e=Qu.get(t);if(!e&&t===Bm&&dN())return xN();if(!e)throw xi.create("no-app",{appName:t});return e}function yi(t,e,n){var s;let i=(s=Bj[t])!==null&&s!==void 0?s:t;n&&(i+=`-${n}`);const r=i.match(/\s|\//),a=e.match(/\s|\//);if(r||a){const o=[`Unable to register library "${i}" with version "${e}":`];r&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),js.warn(o.join(" "));return}ja(new vr(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vj="firebase-heartbeat-database",Fj=1,yl="firebase-heartbeat-store";let dh=null;function _N(){return dh||(dh=aj(Vj,Fj,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(yl)}catch(n){console.warn(n)}}}}).catch(t=>{throw xi.create("idb-open",{originalErrorMessage:t.message})})),dh}async function zj(t){try{const n=(await _N()).transaction(yl),s=await n.objectStore(yl).get(wN(t));return await n.done,s}catch(e){if(e instanceof Bi)js.warn(e.message);else{const n=xi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});js.warn(n.message)}}}async function lx(t,e){try{const s=(await _N()).transaction(yl,"readwrite");await s.objectStore(yl).put(e,wN(t)),await s.done}catch(n){if(n instanceof Bi)js.warn(n.message);else{const s=xi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});js.warn(s.message)}}}function wN(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $j=1024,Kj=30;class Yj{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Wj(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=cx();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(a=>a.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:i}),this._heartbeatsCache.heartbeats.length>Kj){const a=Xj(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){js.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=cx(),{heartbeatsToSend:s,unsentEntries:i}=qj(this._heartbeatsCache.heartbeats),r=Yu(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(n){return js.warn(n),""}}}function cx(){return new Date().toISOString().substring(0,10)}function qj(t,e=$j){const n=[];let s=t.slice();for(const i of t){const r=n.find(a=>a.agent===i.agent);if(r){if(r.dates.push(i.date),ux(n)>e){r.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),ux(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class Wj{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return j2()?O2().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await zj(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return lx(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return lx(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function ux(t){return Yu(JSON.stringify({version:2,heartbeats:t})).length}function Xj(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let s=1;s<t.length;s++)t[s].date<n&&(n=t[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qj(t){ja(new vr("platform-logger",e=>new cj(e),"PRIVATE")),ja(new vr("heartbeat",e=>new Yj(e),"PRIVATE")),yi(Pm,ax,t),yi(Pm,ax,"esm2017"),yi("fire-js","")}Qj("");function Fg(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(t);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(t,s[i])&&(n[s[i]]=t[s[i]]);return n}function EN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Jj=EN,NN=new Zl("auth","Firebase",EN());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ju=new Hg("@firebase/auth");function Zj(t,...e){Ju.logLevel<=je.WARN&&Ju.warn(`Auth (${to}): ${t}`,...e)}function cu(t,...e){Ju.logLevel<=je.ERROR&&Ju.error(`Auth (${to}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fn(t,...e){throw zg(t,...e)}function Zn(t,...e){return zg(t,...e)}function kN(t,e,n){const s=Object.assign(Object.assign({},Jj()),{[e]:n});return new Zl("auth","Firebase",s).create(e,{appName:t.name})}function es(t){return kN(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function zg(t,...e){if(typeof t!="string"){const n=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=t.name),t._errorFactory.create(n,...s)}return NN.create(t,...e)}function ee(t,e,...n){if(!t)throw zg(e,...n)}function bs(t){const e="INTERNAL ASSERTION FAILED: "+t;throw cu(e),new Error(e)}function Os(t,e){t||bs(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hm(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function e5(){return dx()==="http:"||dx()==="https:"}function dx(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t5(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(e5()||R2()||"connection"in navigator)?navigator.onLine:!0}function n5(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ec{constructor(e,n){this.shortDelay=e,this.longDelay=n,Os(n>e,"Short delay should be less than long delay!"),this.isMobile=Ug()||pN()}get(){return t5()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $g(t,e){Os(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SN{static initialize(e,n,s){this.fetchImpl=e,n&&(this.headersImpl=n),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;bs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;bs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;bs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s5={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i5=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],r5=new ec(3e4,6e4);function Us(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Hs(t,e,n,s,i={}){return TN(t,i,async()=>{let r={},a={};s&&(e==="GET"?a=s:r={body:JSON.stringify(s)});const o=eo(Object.assign({key:t.config.apiKey},a)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:c},r);return A2()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&Za(t.emulatorConfig.host)&&(u.credentials="include"),SN.fetch()(await AN(t,t.config.apiHost,n,o),u)})}async function TN(t,e,n){t._canInitEmulator=!1;const s=Object.assign(Object.assign({},s5),e);try{const i=new o5(t),r=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const a=await r.json();if("needConfirmation"in a)throw Pc(t,"account-exists-with-different-credential",a);if(r.ok&&!("errorMessage"in a))return a;{const o=r.ok?a.errorMessage:a.error.message,[c,u]=o.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Pc(t,"credential-already-in-use",a);if(c==="EMAIL_EXISTS")throw Pc(t,"email-already-in-use",a);if(c==="USER_DISABLED")throw Pc(t,"user-disabled",a);const d=s[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw kN(t,d,u);Fn(t,d)}}catch(i){if(i instanceof Bi)throw i;Fn(t,"network-request-failed",{message:String(i)})}}async function tc(t,e,n,s,i={}){const r=await Hs(t,e,n,s,i);return"mfaPendingCredential"in r&&Fn(t,"multi-factor-auth-required",{_serverResponse:r}),r}async function AN(t,e,n,s){const i=`${e}${n}?${s}`,r=t,a=r.config.emulator?$g(t.config,i):`${t.config.apiScheme}://${i}`;return i5.includes(n)&&(await r._persistenceManagerAvailable,r._getPersistenceType()==="COOKIE")?r._getPersistence()._getFinalTarget(a).toString():a}function a5(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class o5{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,s)=>{this.timer=setTimeout(()=>s(Zn(this.auth,"network-request-failed")),r5.get())})}}function Pc(t,e,n){const s={appName:t.name};n.email&&(s.email=n.email),n.phoneNumber&&(s.phoneNumber=n.phoneNumber);const i=Zn(t,e,s);return i.customData._tokenResponse=n,i}function fx(t){return t!==void 0&&t.enterprise!==void 0}class l5{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return a5(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function c5(t,e){return Hs(t,"GET","/v2/recaptchaConfig",Us(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u5(t,e){return Hs(t,"POST","/v1/accounts:delete",e)}async function Zu(t,e){return Hs(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yo(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function d5(t,e=!1){const n=dt(t),s=await n.getIdToken(e),i=Kg(s);ee(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const r=typeof i.firebase=="object"?i.firebase:void 0,a=r==null?void 0:r.sign_in_provider;return{claims:i,token:s,authTime:Yo(fh(i.auth_time)),issuedAtTime:Yo(fh(i.iat)),expirationTime:Yo(fh(i.exp)),signInProvider:a||null,signInSecondFactor:(r==null?void 0:r.sign_in_second_factor)||null}}function fh(t){return Number(t)*1e3}function Kg(t){const[e,n,s]=t.split(".");if(e===void 0||n===void 0||s===void 0)return cu("JWT malformed, contained fewer than 3 sections"),null;try{const i=qu(n);return i?JSON.parse(i):(cu("Failed to decode base64 JWT payload"),null)}catch(i){return cu("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function hx(t){const e=Kg(t);return ee(e,"internal-error"),ee(typeof e.exp<"u","internal-error"),ee(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _l(t,e,n=!1){if(n)return e;try{return await e}catch(s){throw s instanceof Bi&&f5(s)&&t.auth.currentUser===t&&await t.auth.signOut(),s}}function f5({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h5{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gm{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Yo(this.lastLoginAt),this.creationTime=Yo(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wl(t){var e;const n=t.auth,s=await t.getIdToken(),i=await _l(t,Zu(n,{idToken:s}));ee(i==null?void 0:i.users.length,n,"internal-error");const r=i.users[0];t._notifyReloadListener(r);const a=!((e=r.providerUserInfo)===null||e===void 0)&&e.length?RN(r.providerUserInfo):[],o=p5(t.providerData,a),c=t.isAnonymous,u=!(t.email&&r.passwordHash)&&!(o!=null&&o.length),d=c?u:!1,f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new Gm(r.createdAt,r.lastLoginAt),isAnonymous:d};Object.assign(t,f)}async function m5(t){const e=dt(t);await wl(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function p5(t,e){return[...t.filter(s=>!e.some(i=>i.providerId===s.providerId)),...e]}function RN(t){return t.map(e=>{var{providerId:n}=e,s=Fg(e,["providerId"]);return{providerId:n,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g5(t,e){const n=await TN(t,{},async()=>{const s=eo({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:r}=t.config,a=await AN(t,i,"/v1/token",`key=${r}`),o=await t._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:o,body:s};return t.emulatorConfig&&Za(t.emulatorConfig.host)&&(c.credentials="include"),SN.fetch()(a,c)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function v5(t,e){return Hs(t,"POST","/v2/accounts:revokeToken",Us(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fa{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ee(e.idToken,"internal-error"),ee(typeof e.idToken<"u","internal-error"),ee(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):hx(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ee(e.length!==0,"internal-error");const n=hx(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ee(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:s,refreshToken:i,expiresIn:r}=await g5(e,n);this.updateTokensAndExpiration(s,i,Number(r))}updateTokensAndExpiration(e,n,s){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,n){const{refreshToken:s,accessToken:i,expirationTime:r}=n,a=new fa;return s&&(ee(typeof s=="string","internal-error",{appName:e}),a.refreshToken=s),i&&(ee(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),r&&(ee(typeof r=="number","internal-error",{appName:e}),a.expirationTime=r),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new fa,this.toJSON())}_performRefresh(){return bs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fs(t,e){ee(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Hn{constructor(e){var{uid:n,auth:s,stsTokenManager:i}=e,r=Fg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new h5(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=s,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Gm(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const n=await _l(this,this.stsTokenManager.getToken(this.auth,e));return ee(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return d5(this,e)}reload(){return m5(this)}_assign(e){this!==e&&(ee(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Hn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){ee(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),n&&await wl(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(rn(this.auth.app))return Promise.reject(es(this.auth));const e=await this.getIdToken();return await _l(this,u5(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var s,i,r,a,o,c,u,d;const f=(s=n.displayName)!==null&&s!==void 0?s:void 0,h=(i=n.email)!==null&&i!==void 0?i:void 0,m=(r=n.phoneNumber)!==null&&r!==void 0?r:void 0,g=(a=n.photoURL)!==null&&a!==void 0?a:void 0,b=(o=n.tenantId)!==null&&o!==void 0?o:void 0,x=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,p=(u=n.createdAt)!==null&&u!==void 0?u:void 0,v=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:y,emailVerified:E,isAnonymous:N,providerData:T,stsTokenManager:w}=n;ee(y&&w,e,"internal-error");const A=fa.fromJSON(this.name,w);ee(typeof y=="string",e,"internal-error"),Fs(f,e.name),Fs(h,e.name),ee(typeof E=="boolean",e,"internal-error"),ee(typeof N=="boolean",e,"internal-error"),Fs(m,e.name),Fs(g,e.name),Fs(b,e.name),Fs(x,e.name),Fs(p,e.name),Fs(v,e.name);const k=new Hn({uid:y,auth:e,email:h,emailVerified:E,displayName:f,isAnonymous:N,photoURL:g,phoneNumber:m,tenantId:b,stsTokenManager:A,createdAt:p,lastLoginAt:v});return T&&Array.isArray(T)&&(k.providerData=T.map(R=>Object.assign({},R))),x&&(k._redirectEventId=x),k}static async _fromIdTokenResponse(e,n,s=!1){const i=new fa;i.updateFromServerResponse(n);const r=new Hn({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:s});return await wl(r),r}static async _fromGetAccountInfoResponse(e,n,s){const i=n.users[0];ee(i.localId!==void 0,"internal-error");const r=i.providerUserInfo!==void 0?RN(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(r!=null&&r.length),o=new fa;o.updateFromIdToken(s);const c=new Hn({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:r,metadata:new Gm(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(r!=null&&r.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mx=new Map;function xs(t){Os(t instanceof Function,"Expected a class definition");let e=mx.get(t);return e?(Os(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,mx.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}IN.type="NONE";const px=IN;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uu(t,e,n){return`firebase:${t}:${e}:${n}`}class ha{constructor(e,n,s){this.persistence=e,this.auth=n,this.userKey=s;const{config:i,name:r}=this.auth;this.fullUserKey=uu(this.userKey,i.apiKey,r),this.fullPersistenceKey=uu("persistence",i.apiKey,r),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Zu(this.auth,{idToken:e}).catch(()=>{});return n?Hn._fromGetAccountInfoResponse(this.auth,n,e):null}return Hn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,s="authUser"){if(!n.length)return new ha(xs(px),e,s);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let r=i[0]||xs(px);const a=uu(s,e.config.apiKey,e.name);let o=null;for(const u of n)try{const d=await u._get(a);if(d){let f;if(typeof d=="string"){const h=await Zu(e,{idToken:d}).catch(()=>{});if(!h)break;f=await Hn._fromGetAccountInfoResponse(e,h,d)}else f=Hn._fromJSON(e,d);u!==r&&(o=f),r=u;break}}catch{}const c=i.filter(u=>u._shouldAllowMigration);return!r._shouldAllowMigration||!c.length?new ha(r,e,s):(r=c[0],o&&await r._set(a,o.toJSON()),await Promise.all(n.map(async u=>{if(u!==r)try{await u._remove(a)}catch{}})),new ha(r,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gx(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(MN(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(CN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(LN(e))return"Blackberry";if(PN(e))return"Webos";if(jN(e))return"Safari";if((e.includes("chrome/")||ON(e))&&!e.includes("edge/"))return"Chrome";if(DN(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=t.match(n);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function CN(t=Vt()){return/firefox\//i.test(t)}function jN(t=Vt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ON(t=Vt()){return/crios\//i.test(t)}function MN(t=Vt()){return/iemobile/i.test(t)}function DN(t=Vt()){return/android/i.test(t)}function LN(t=Vt()){return/blackberry/i.test(t)}function PN(t=Vt()){return/webos/i.test(t)}function Yg(t=Vt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function b5(t=Vt()){var e;return Yg(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function x5(){return I2()&&document.documentMode===10}function BN(t=Vt()){return Yg(t)||DN(t)||PN(t)||LN(t)||/windows phone/i.test(t)||MN(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UN(t,e=[]){let n;switch(t){case"Browser":n=gx(Vt());break;case"Worker":n=`${gx(Vt())}-${t}`;break;default:n=t}const s=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${to}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y5{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const s=r=>new Promise((a,o)=>{try{const c=e(r);a(c)}catch(c){o(c)}});s.onAbort=n,this.queue.push(s);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const s of this.queue)await s(e),s.onAbort&&n.push(s.onAbort)}catch(s){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _5(t,e={}){return Hs(t,"GET","/v2/passwordPolicy",Us(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w5=6;class E5{constructor(e){var n,s,i,r;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=a.minPasswordLength)!==null&&n!==void 0?n:w5,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(s=e.allowedNonAlphanumericCharacters)===null||s===void 0?void 0:s.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(r=e.forceUpgradeOnSignin)!==null&&r!==void 0?r:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,s,i,r,a,o;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(s=c.meetsMaxPasswordLength)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(r=c.containsUppercaseLetter)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(a=c.containsNumericCharacter)!==null&&a!==void 0?a:!0),c.isValid&&(c.isValid=(o=c.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),c}validatePasswordLengthOptions(e,n){const s=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;s&&(n.meetsMinPasswordLength=e.length>=s),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let s;for(let i=0;i<e.length;i++)s=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,n,s,i,r){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N5{constructor(e,n,s,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=s,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new vx(this),this.idTokenSubscription=new vx(this),this.beforeStateQueue=new y5(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=NN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(r=>this._resolvePersistenceManagerAvailable=r)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=xs(n)),this._initializationPromise=this.queue(async()=>{var s,i,r;if(!this._deleted&&(this.persistenceManager=await ha.create(this,e),(s=this._resolvePersistenceManagerAvailable)===null||s===void 0||s.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((r=this.currentUser)===null||r===void 0?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Zu(this,{idToken:e}),s=await Hn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(s)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(rn(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const s=await this.assertedPersistence.getCurrentUser();let i=s,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,o=i==null?void 0:i._redirectEventId,c=await this.tryRedirectSignIn(e);(!a||a===o)&&(c!=null&&c.user)&&(i=c.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ee(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await wl(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=n5()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(rn(this.app))return Promise.reject(es(this));const n=e?dt(e):null;return n&&ee(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ee(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return rn(this.app)?Promise.reject(es(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return rn(this.app)?Promise.reject(es(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(xs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await _5(this),n=new E5(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Zl("auth","Firebase",e())}onAuthStateChanged(e,n,s){return this.registerStateListener(this.authStateSubscription,e,n,s)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,s){return this.registerStateListener(this.idTokenSubscription,e,n,s)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(s.tenantId=this.tenantId),await v5(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const s=await this.getOrInitRedirectPersistenceManager(n);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&xs(e)||this._popupRedirectResolver;ee(n,this,"argument-error"),this.redirectPersistenceManager=await ha.create(this,[xs(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,s;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,s,i){if(this._deleted)return()=>{};const r=typeof n=="function"?n:n.next.bind(n);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(ee(o,this,"internal-error"),o.then(()=>{a||r(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,s,i);return()=>{a=!0,c()}}else{const c=e.addObserver(n);return()=>{a=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ee(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=UN(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());s&&(n["X-Firebase-Client"]=s);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;if(rn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&Zj(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Gs(t){return dt(t)}class vx{constructor(e){this.auth=e,this.observer=null,this.addObserver=H2(n=>this.observer=n)}get next(){return ee(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function k5(t){Xd=t}function HN(t){return Xd.loadJS(t)}function S5(){return Xd.recaptchaEnterpriseScript}function T5(){return Xd.gapiScript}function A5(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class R5{constructor(){this.enterprise=new I5}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class I5{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const C5="recaptcha-enterprise",GN="NO_RECAPTCHA";class j5{constructor(e){this.type=C5,this.auth=Gs(e)}async verify(e="verify",n=!1){async function s(r){if(!n){if(r.tenantId==null&&r._agentRecaptchaConfig!=null)return r._agentRecaptchaConfig.siteKey;if(r.tenantId!=null&&r._tenantRecaptchaConfigs[r.tenantId]!==void 0)return r._tenantRecaptchaConfigs[r.tenantId].siteKey}return new Promise(async(a,o)=>{c5(r,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const u=new l5(c);return r.tenantId==null?r._agentRecaptchaConfig=u:r._tenantRecaptchaConfigs[r.tenantId]=u,a(u.siteKey)}}).catch(c=>{o(c)})})}function i(r,a,o){const c=window.grecaptcha;fx(c)?c.enterprise.ready(()=>{c.enterprise.execute(r,{action:e}).then(u=>{a(u)}).catch(()=>{a(GN)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new R5().execute("siteKey",{action:"verify"}):new Promise((r,a)=>{s(this.auth).then(o=>{if(!n&&fx(window.grecaptcha))i(o,r,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let c=S5();c.length!==0&&(c+=o),HN(c).then(()=>{i(o,r,a)}).catch(u=>{a(u)})}}).catch(o=>{a(o)})})}}async function bx(t,e,n,s=!1,i=!1){const r=new j5(t);let a;if(i)a=GN;else try{a=await r.verify(n)}catch{a=await r.verify(n,!0)}const o=Object.assign({},e);if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in o){const c=o.phoneEnrollmentInfo.phoneNumber,u=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:u,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const c=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return s?Object.assign(o,{captchaResp:a}):Object.assign(o,{captchaResponse:a}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function ed(t,e,n,s,i){var r;if(!((r=t._getRecaptchaConfig())===null||r===void 0)&&r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await bx(t,e,n,n==="getOobCode");return s(t,a)}else return s(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await bx(t,e,n,n==="getOobCode");return s(t,o)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O5(t,e){const n=Vg(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),r=n.getOptions();if(gr(r,e??{}))return i;Fn(i,"already-initialized")}return n.initialize({options:e})}function M5(t,e){const n=(e==null?void 0:e.persistence)||[],s=(Array.isArray(n)?n:[n]).map(xs);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function D5(t,e,n){const s=Gs(t);ee(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const i=!1,r=VN(e),{host:a,port:o}=L5(e),c=o===null?"":`:${o}`,u={url:`${r}//${a}${c}/`},d=Object.freeze({host:a,port:o,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!s._canInitEmulator){ee(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),ee(gr(u,s.config.emulator)&&gr(d,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=u,s.emulatorConfig=d,s.settings.appVerificationDisabledForTesting=!0,Za(a)?(hN(`${r}//${a}${c}`),mN("Auth",!0)):P5()}function VN(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function L5(t){const e=VN(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const s=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(s);if(i){const r=i[1];return{host:r,port:xx(s.substr(r.length+1))}}else{const[r,a]=s.split(":");return{host:r,port:xx(a)}}}function xx(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function P5(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qg{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return bs("not implemented")}_getIdTokenResponse(e){return bs("not implemented")}_linkToIdToken(e,n){return bs("not implemented")}_getReauthenticationResolver(e){return bs("not implemented")}}async function B5(t,e){return Hs(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U5(t,e){return tc(t,"POST","/v1/accounts:signInWithPassword",Us(t,e))}async function H5(t,e){return Hs(t,"POST","/v1/accounts:sendOobCode",Us(t,e))}async function G5(t,e){return H5(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function V5(t,e){return tc(t,"POST","/v1/accounts:signInWithEmailLink",Us(t,e))}async function F5(t,e){return tc(t,"POST","/v1/accounts:signInWithEmailLink",Us(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class El extends qg{constructor(e,n,s,i=null){super("password",s),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new El(e,n,"password")}static _fromEmailAndCode(e,n,s=null){return new El(e,n,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ed(e,n,"signInWithPassword",U5);case"emailLink":return V5(e,{email:this._email,oobCode:this._password});default:Fn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const s={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ed(e,s,"signUpPassword",B5);case"emailLink":return F5(e,{idToken:n,email:this._email,oobCode:this._password});default:Fn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ma(t,e){return tc(t,"POST","/v1/accounts:signInWithIdp",Us(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z5="http://localhost";class br extends qg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new br(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Fn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:i}=n,r=Fg(n,["providerId","signInMethod"]);if(!s||!i)return null;const a=new br(s,i);return a.idToken=r.idToken||void 0,a.accessToken=r.accessToken||void 0,a.secret=r.secret,a.nonce=r.nonce,a.pendingToken=r.pendingToken||null,a}_getIdTokenResponse(e){const n=this.buildRequest();return ma(e,n)}_linkToIdToken(e,n){const s=this.buildRequest();return s.idToken=n,ma(e,s)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ma(e,n)}buildRequest(){const e={requestUri:z5,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=eo(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $5(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function K5(t){const e=Ro(Io(t)).link,n=e?Ro(Io(e)).deep_link_id:null,s=Ro(Io(t)).deep_link_id;return(s?Ro(Io(s)).link:null)||s||n||e||t}class Wg{constructor(e){var n,s,i,r,a,o;const c=Ro(Io(e)),u=(n=c.apiKey)!==null&&n!==void 0?n:null,d=(s=c.oobCode)!==null&&s!==void 0?s:null,f=$5((i=c.mode)!==null&&i!==void 0?i:null);ee(u&&d&&f,"argument-error"),this.apiKey=u,this.operation=f,this.code=d,this.continueUrl=(r=c.continueUrl)!==null&&r!==void 0?r:null,this.languageCode=(a=c.lang)!==null&&a!==void 0?a:null,this.tenantId=(o=c.tenantId)!==null&&o!==void 0?o:null}static parseLink(e){const n=K5(e);try{return new Wg(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar{constructor(){this.providerId=Ar.PROVIDER_ID}static credential(e,n){return El._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const s=Wg.parseLink(n);return ee(s,"argument-error"),El._fromEmailAndCode(e,s.code,s.tenantId)}}Ar.PROVIDER_ID="password";Ar.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ar.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FN{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nc extends FN{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs extends nc{constructor(){super("facebook.com")}static credential(e){return br._fromParams({providerId:Qs.PROVIDER_ID,signInMethod:Qs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qs.credentialFromTaggedObject(e)}static credentialFromError(e){return Qs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Qs.credential(e.oauthAccessToken)}catch{return null}}}Qs.FACEBOOK_SIGN_IN_METHOD="facebook.com";Qs.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js extends nc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return br._fromParams({providerId:Js.PROVIDER_ID,signInMethod:Js.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Js.credentialFromTaggedObject(e)}static credentialFromError(e){return Js.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:s}=e;if(!n&&!s)return null;try{return Js.credential(n,s)}catch{return null}}}Js.GOOGLE_SIGN_IN_METHOD="google.com";Js.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zs extends nc{constructor(){super("github.com")}static credential(e){return br._fromParams({providerId:Zs.PROVIDER_ID,signInMethod:Zs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Zs.credentialFromTaggedObject(e)}static credentialFromError(e){return Zs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Zs.credential(e.oauthAccessToken)}catch{return null}}}Zs.GITHUB_SIGN_IN_METHOD="github.com";Zs.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei extends nc{constructor(){super("twitter.com")}static credential(e,n){return br._fromParams({providerId:ei.PROVIDER_ID,signInMethod:ei.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return ei.credentialFromTaggedObject(e)}static credentialFromError(e){return ei.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:s}=e;if(!n||!s)return null;try{return ei.credential(n,s)}catch{return null}}}ei.TWITTER_SIGN_IN_METHOD="twitter.com";ei.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zN(t,e){return tc(t,"POST","/v1/accounts:signUp",Us(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,s,i=!1){const r=await Hn._fromIdTokenResponse(e,s,i),a=yx(s);return new Ms({user:r,providerId:a,_tokenResponse:s,operationType:n})}static async _forOperation(e,n,s){await e._updateTokensIfNecessary(s,!0);const i=yx(s);return new Ms({user:e,providerId:i,_tokenResponse:s,operationType:n})}}function yx(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y5(t){var e;if(rn(t.app))return Promise.reject(es(t));const n=Gs(t);if(await n._initializationPromise,!((e=n.currentUser)===null||e===void 0)&&e.isAnonymous)return new Ms({user:n.currentUser,providerId:null,operationType:"signIn"});const s=await zN(n,{returnSecureToken:!0}),i=await Ms._fromIdTokenResponse(n,"signIn",s,!0);return await n._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td extends Bi{constructor(e,n,s,i){var r;super(n.code,n.message),this.operationType=s,this.user=i,Object.setPrototypeOf(this,td.prototype),this.customData={appName:e.name,tenantId:(r=e.tenantId)!==null&&r!==void 0?r:void 0,_serverResponse:n.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,n,s,i){return new td(e,n,s,i)}}function $N(t,e,n,s){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(r=>{throw r.code==="auth/multi-factor-auth-required"?td._fromErrorAndOperation(t,r,e,s):r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q5(t){return new Set(t.map(({providerId:e})=>e).filter(e=>!!e))}async function KN(t,e,n=!1){const s=await _l(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Ms._forOperation(t,"link",s)}async function W5(t,e,n){await wl(e);const s=q5(e.providerData);ee(s.has(n)===t,e.auth,"provider-already-linked")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function X5(t,e,n=!1){const{auth:s}=t;if(rn(s.app))return Promise.reject(es(s));const i="reauthenticate";try{const r=await _l(t,$N(s,i,e,t),n);ee(r.idToken,s,"internal-error");const a=Kg(r.idToken);ee(a,s,"internal-error");const{sub:o}=a;return ee(t.uid===o,s,"user-mismatch"),Ms._forOperation(t,i,r)}catch(r){throw(r==null?void 0:r.code)==="auth/user-not-found"&&Fn(s,"user-mismatch"),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YN(t,e,n=!1){if(rn(t.app))return Promise.reject(es(t));const s="signIn",i=await $N(t,s,e),r=await Ms._fromIdTokenResponse(t,s,i);return n||await t._updateCurrentUser(r.user),r}async function Q5(t,e){return YN(Gs(t),e)}async function J5(t,e){const n=dt(t);return await W5(!1,n,e.providerId),KN(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qN(t){const e=Gs(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Z5(t,e,n){const s=Gs(t);await ed(s,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",G5)}async function eO(t,e,n){if(rn(t.app))return Promise.reject(es(t));const s=Gs(t),a=await ed(s,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",zN).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&qN(t),c}),o=await Ms._fromIdTokenResponse(s,"signIn",a);return await s._updateCurrentUser(o.user),o}function tO(t,e,n){return rn(t.app)?Promise.reject(es(t)):Q5(dt(t),Ar.credential(e,n)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&qN(t),s})}function nO(t,e,n,s){return dt(t).onIdTokenChanged(e,n,s)}function sO(t,e,n){return dt(t).beforeAuthStateChanged(e,n)}function iO(t,e,n,s){return dt(t).onAuthStateChanged(e,n,s)}function rO(t){return dt(t).signOut()}const nd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WN{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(nd,"1"),this.storage.removeItem(nd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aO=1e3,oO=10;class XN extends WN{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=BN(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const s=this.storage.getItem(n),i=this.localCache[n];s!==i&&e(n,i,s)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((a,o,c)=>{this.notifyListeners(a,c)});return}const s=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(s);!n&&this.localCache[s]===a||this.notifyListeners(s,a)},r=this.storage.getItem(s);x5()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,oO):i()}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:s}),!0)})},aO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}XN.type="LOCAL";const lO=XN;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QN extends WN{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}QN.type="SESSION";const JN=QN;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cO(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const s=new Qd(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:s,eventType:i,data:r}=n.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;n.ports[0].postMessage({status:"ack",eventId:s,eventType:i});const o=Array.from(a).map(async u=>u(n.origin,r)),c=await cO(o);n.ports[0].postMessage({status:"done",eventId:s,eventType:i,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Qd.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xg(t="",e=10){let n="";for(let s=0;s<e;s++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uO{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,s=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,a;return new Promise((o,c)=>{const u=Xg("",20);i.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},s);a={messageChannel:i,onMessage(f){const h=f;if(h.data.eventId===u)switch(h.data.status){case"ack":clearTimeout(d),r=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),o(h.data.response);break;default:clearTimeout(d),clearTimeout(r),c(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ts(){return window}function dO(t){ts().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZN(){return typeof ts().WorkerGlobalScope<"u"&&typeof ts().importScripts=="function"}async function fO(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function hO(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function mO(){return ZN()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ek="firebaseLocalStorageDb",pO=1,sd="firebaseLocalStorage",tk="fbase_key";class sc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Jd(t,e){return t.transaction([sd],e?"readwrite":"readonly").objectStore(sd)}function gO(){const t=indexedDB.deleteDatabase(ek);return new sc(t).toPromise()}function Vm(){const t=indexedDB.open(ek,pO);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const s=t.result;try{s.createObjectStore(sd,{keyPath:tk})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const s=t.result;s.objectStoreNames.contains(sd)?e(s):(s.close(),await gO(),e(await Vm()))})})}async function _x(t,e,n){const s=Jd(t,!0).put({[tk]:e,value:n});return new sc(s).toPromise()}async function vO(t,e){const n=Jd(t,!1).get(e),s=await new sc(n).toPromise();return s===void 0?null:s.value}function wx(t,e){const n=Jd(t,!0).delete(e);return new sc(n).toPromise()}const bO=800,xO=3;class nk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Vm(),this.db)}async _withRetries(e){let n=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(n++>xO)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ZN()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Qd._getInstance(mO()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await fO(),!this.activeServiceWorker)return;this.sender=new uO(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);s&&!((e=s[0])===null||e===void 0)&&e.fulfilled&&!((n=s[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||hO()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Vm();return await _x(e,nd,"1"),await wx(e,nd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(s=>_x(s,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(s=>vO(s,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>wx(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const r=Jd(i,!1).getAll();return new sc(r).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],s=new Set;if(e.length!==0)for(const{fbase_key:i,value:r}of e)s.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!s.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),bO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}nk.type="LOCAL";const yO=nk;new ec(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _O(t,e){return e?xs(e):(ee(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qg extends qg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ma(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ma(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ma(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function wO(t){return YN(t.auth,new Qg(t),t.bypassAuthState)}function EO(t){const{auth:e,user:n}=t;return ee(n,e,"internal-error"),X5(n,new Qg(t),t.bypassAuthState)}async function NO(t){const{auth:e,user:n}=t;return ee(n,e,"internal-error"),KN(n,new Qg(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sk{constructor(e,n,s,i,r=!1){this.auth=e,this.resolver=s,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:s,postBody:i,tenantId:r,error:a,type:o}=e;if(a){this.reject(a);return}const c={auth:this.auth,requestUri:n,sessionId:s,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return wO;case"linkViaPopup":case"linkViaRedirect":return NO;case"reauthViaPopup":case"reauthViaRedirect":return EO;default:Fn(this.auth,"internal-error")}}resolve(e){Os(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Os(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kO=new ec(2e3,1e4);class Jr extends sk{constructor(e,n,s,i,r){super(e,n,i,r),this.provider=s,this.authWindow=null,this.pollId=null,Jr.currentPopupAction&&Jr.currentPopupAction.cancel(),Jr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ee(e,this.auth,"internal-error"),e}async onExecution(){Os(this.filter.length===1,"Popup operations only handle one event");const e=Xg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Zn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Zn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Jr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,s;if(!((s=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Zn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,kO.get())};e()}}Jr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SO="pendingRedirect",du=new Map;class TO extends sk{constructor(e,n,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,s),this.eventId=null}async execute(){let e=du.get(this.auth._key());if(!e){try{const s=await AO(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(n){e=()=>Promise.reject(n)}du.set(this.auth._key(),e)}return this.bypassAuthState||du.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function AO(t,e){const n=CO(e),s=IO(t);if(!await s._isAvailable())return!1;const i=await s._get(n)==="true";return await s._remove(n),i}function RO(t,e){du.set(t._key(),e)}function IO(t){return xs(t._redirectPersistence)}function CO(t){return uu(SO,t.config.apiKey,t.name)}async function jO(t,e,n=!1){if(rn(t.app))return Promise.reject(es(t));const s=Gs(t),i=_O(s,e),a=await new TO(s,i,n).execute();return a&&!n&&(delete a.user._redirectEventId,await s._persistUserIfCurrent(a.user),await s._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OO=10*60*1e3;class MO{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(n=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!DO(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var s;if(e.error&&!ik(e)){const i=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";n.onError(Zn(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const s=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=OO&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ex(e))}saveEventToCache(e){this.cachedEventUids.add(Ex(e)),this.lastProcessedEventTime=Date.now()}}function Ex(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function ik({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function DO(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ik(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LO(t,e={}){return Hs(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PO=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,BO=/^https?/;async function UO(t){if(t.config.emulator)return;const{authorizedDomains:e}=await LO(t);for(const n of e)try{if(HO(n))return}catch{}Fn(t,"unauthorized-domain")}function HO(t){const e=Hm(),{protocol:n,hostname:s}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&s===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&a.hostname===s}if(!BO.test(n))return!1;if(PO.test(t))return s===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GO=new ec(3e4,6e4);function Nx(){const t=ts().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function VO(t){return new Promise((e,n)=>{var s,i,r;function a(){Nx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Nx(),n(Zn(t,"network-request-failed"))},timeout:GO.get()})}if(!((i=(s=ts().gapi)===null||s===void 0?void 0:s.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((r=ts().gapi)===null||r===void 0)&&r.load)a();else{const o=A5("iframefcb");return ts()[o]=()=>{gapi.load?a():n(Zn(t,"network-request-failed"))},HN(`${T5()}?onload=${o}`).catch(c=>n(c))}}).catch(e=>{throw fu=null,e})}let fu=null;function FO(t){return fu=fu||VO(t),fu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zO=new ec(5e3,15e3),$O="__/auth/iframe",KO="emulator/auth/iframe",YO={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},qO=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function WO(t){const e=t.config;ee(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?$g(e,KO):`https://${t.config.authDomain}/${$O}`,s={apiKey:e.apiKey,appName:t.name,v:to},i=qO.get(t.config.apiHost);i&&(s.eid=i);const r=t._getFrameworks();return r.length&&(s.fw=r.join(",")),`${n}?${eo(s).slice(1)}`}async function XO(t){const e=await FO(t),n=ts().gapi;return ee(n,t,"internal-error"),e.open({where:document.body,url:WO(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:YO,dontclear:!0},s=>new Promise(async(i,r)=>{await s.restyle({setHideOnLeave:!1});const a=Zn(t,"network-request-failed"),o=ts().setTimeout(()=>{r(a)},zO.get());function c(){ts().clearTimeout(o),i(s)}s.ping(c).then(c,()=>{r(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QO={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},JO=500,ZO=600,eM="_blank",tM="http://localhost";class kx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function nM(t,e,n,s=JO,i=ZO){const r=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-s)/2,0).toString();let o="";const c=Object.assign(Object.assign({},QO),{width:s.toString(),height:i.toString(),top:r,left:a}),u=Vt().toLowerCase();n&&(o=ON(u)?eM:n),CN(u)&&(e=e||tM,c.scrollbars="yes");const d=Object.entries(c).reduce((h,[m,g])=>`${h}${m}=${g},`,"");if(b5(u)&&o!=="_self")return sM(e||"",o),new kx(null);const f=window.open(e||"",o,d);ee(f,t,"popup-blocked");try{f.focus()}catch{}return new kx(f)}function sM(t,e){const n=document.createElement("a");n.href=t,n.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iM="__/auth/handler",rM="emulator/auth/handler",aM=encodeURIComponent("fac");async function Sx(t,e,n,s,i,r){ee(t.config.authDomain,t,"auth-domain-config-required"),ee(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:s,v:to,eventId:i};if(e instanceof FN){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",Wu(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries({}))a[d]=f}if(e instanceof nc){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(a.scopes=d.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const d of Object.keys(o))o[d]===void 0&&delete o[d];const c=await t._getAppCheckToken(),u=c?`#${aM}=${encodeURIComponent(c)}`:"";return`${oM(t)}?${eo(o).slice(1)}${u}`}function oM({config:t}){return t.emulator?$g(t,rM):`https://${t.authDomain}/${iM}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hh="webStorageSupport";class lM{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=JN,this._completeRedirectFn=jO,this._overrideRedirectResult=RO}async _openPopup(e,n,s,i){var r;Os((r=this.eventManagers[e._key()])===null||r===void 0?void 0:r.manager,"_initialize() not called before _openPopup()");const a=await Sx(e,n,s,Hm(),i);return nM(e,a,Xg())}async _openRedirect(e,n,s,i){await this._originValidation(e);const r=await Sx(e,n,s,Hm(),i);return dO(r),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:r}=this.eventManagers[n];return i?Promise.resolve(i):(Os(r,"If manager is not set, promise should be"),r)}const s=this.initAndGetManager(e);return this.eventManagers[n]={promise:s},s.catch(()=>{delete this.eventManagers[n]}),s}async initAndGetManager(e){const n=await XO(e),s=new MO(e);return n.register("authEvent",i=>(ee(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:s.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=n,s}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(hh,{type:hh},i=>{var r;const a=(r=i==null?void 0:i[0])===null||r===void 0?void 0:r[hh];a!==void 0&&n(!!a),Fn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=UO(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return BN()||jN()||Yg()}}const cM=lM;var Tx="@firebase/auth",Ax="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uM{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ee(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dM(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function fM(t){ja(new vr("auth",(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),r=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=s.options;ee(a&&!a.includes(":"),"invalid-api-key",{appName:s.name});const c={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:UN(t)},u=new N5(s,i,r,c);return M5(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,s)=>{e.getProvider("auth-internal").initialize()})),ja(new vr("auth-internal",e=>{const n=Gs(e.getProvider("auth").getImmediate());return(s=>new uM(s))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),yi(Tx,Ax,dM(t)),yi(Tx,Ax,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hM=5*60,mM=fN("authIdTokenMaxAge")||hM;let Rx=null;const pM=t=>async e=>{const n=e&&await e.getIdTokenResult(),s=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(s&&s>mM)return;const i=n==null?void 0:n.token;Rx!==i&&(Rx=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function gM(t=yN()){const e=Vg(t,"auth");if(e.isInitialized())return e.getImmediate();const n=O5(t,{popupRedirectResolver:cM,persistence:[yO,lO,JN]}),s=fN("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const r=new URL(s,location.origin);if(location.origin===r.origin){const a=pM(r.toString());sO(n,a,()=>a(n.currentUser)),nO(n,o=>a(o))}}const i=uN("auth");return i&&D5(n,`http://${i}`),n}function vM(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}k5({loadJS(t){return new Promise((e,n)=>{const s=document.createElement("script");s.setAttribute("src",t),s.onload=e,s.onerror=i=>{const r=Zn("internal-error");r.customData=i,n(r)},s.type="text/javascript",s.charset="UTF-8",vM().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});fM("Browser");var Ix={};const Cx="@firebase/database",jx="1.0.20";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rk="";function bM(t){rk=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xM{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),mt(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:xl(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yM{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return $n(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ak=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new xM(e)}}catch{}return new yM},Ji=ak("localStorage"),_M=ak("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pa=new Hg("@firebase/database"),ok=function(){let t=1;return function(){return t++}}(),lk=function(t){const e=F2(t),n=new U2;n.update(e);const s=n.digest();return Pg.encodeByteArray(s)},ic=function(...t){let e="";for(let n=0;n<t.length;n++){const s=t[n];Array.isArray(s)||s&&typeof s=="object"&&typeof s.length=="number"?e+=ic.apply(null,s):typeof s=="object"?e+=mt(s):e+=s,e+=" "}return e};let qo=null,Ox=!0;const wM=function(t,e){F(!0,"Can't turn on custom loggers persistently."),pa.logLevel=je.VERBOSE,qo=pa.log.bind(pa)},_t=function(...t){if(Ox===!0&&(Ox=!1,qo===null&&_M.get("logging_enabled")===!0&&wM()),qo){const e=ic.apply(null,t);qo(e)}},rc=function(t){return function(...e){_t(t,...e)}},Fm=function(...t){const e="FIREBASE INTERNAL ERROR: "+ic(...t);pa.error(e)},Ds=function(...t){const e=`FIREBASE FATAL ERROR: ${ic(...t)}`;throw pa.error(e),new Error(e)},Ht=function(...t){const e="FIREBASE WARNING: "+ic(...t);pa.warn(e)},EM=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Ht("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Zd=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},NM=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Oa="[MIN_NAME]",xr="[MAX_NAME]",Rr=function(t,e){if(t===e)return 0;if(t===Oa||e===xr)return-1;if(e===Oa||t===xr)return 1;{const n=Mx(t),s=Mx(e);return n!==null?s!==null?n-s===0?t.length-e.length:n-s:-1:s!==null?1:t<e?-1:1}},kM=function(t,e){return t===e?0:t<e?-1:1},bo=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+mt(e))},Jg=function(t){if(typeof t!="object"||t===null)return mt(t);const e=[];for(const s in t)e.push(s);e.sort();let n="{";for(let s=0;s<e.length;s++)s!==0&&(n+=","),n+=mt(e[s]),n+=":",n+=Jg(t[e[s]]);return n+="}",n},ck=function(t,e){const n=t.length;if(n<=e)return[t];const s=[];for(let i=0;i<n;i+=e)i+e>n?s.push(t.substring(i,n)):s.push(t.substring(i,i+e));return s};function Nt(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const uk=function(t){F(!Zd(t),"Invalid JSON number");const e=11,n=52,s=(1<<e-1)-1;let i,r,a,o,c;t===0?(r=0,a=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-s)?(o=Math.min(Math.floor(Math.log(t)/Math.LN2),s),r=o+s,a=Math.round(t*Math.pow(2,n-o)-Math.pow(2,n))):(r=0,a=Math.round(t/Math.pow(2,1-s-n))));const u=[];for(c=n;c;c-=1)u.push(a%2?1:0),a=Math.floor(a/2);for(c=e;c;c-=1)u.push(r%2?1:0),r=Math.floor(r/2);u.push(i?1:0),u.reverse();const d=u.join("");let f="";for(c=0;c<64;c+=8){let h=parseInt(d.substr(c,8),2).toString(16);h.length===1&&(h="0"+h),f=f+h}return f.toLowerCase()},SM=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},TM=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function AM(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const s=new Error(t+" at "+e._path.toString()+": "+n);return s.code=t.toUpperCase(),s}const RM=new RegExp("^-?(0*)\\d{1,10}$"),IM=-2147483648,CM=2147483647,Mx=function(t){if(RM.test(t)){const e=Number(t);if(e>=IM&&e<=CM)return e}return null},no=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw Ht("Exception was thrown by user callback.",n),e},Math.floor(0))}},jM=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Wo=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OM{constructor(e,n){this.appCheckProvider=n,this.appName=e.name,rn(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(s=>this.appCheck=s)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((n,s)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(s=>s.addTokenListener(e))}notifyForInvalidToken(){Ht(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MM{constructor(e,n,s){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=s,this.auth_=null,this.auth_=s.getImmediate({optional:!0}),this.auth_||s.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(_t("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,s)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Ht(e)}}class hu{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}hu.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zg="5",dk="v",fk="s",hk="r",mk="f",pk=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,gk="ls",vk="p",zm="ac",bk="websocket",xk="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yk{constructor(e,n,s,i,r=!1,a="",o=!1,c=!1,u=null){this.secure=n,this.namespace=s,this.webSocketOnly=i,this.nodeAdmin=r,this.persistenceKey=a,this.includeNamespaceInQueryParams=o,this.isUsingEmulator=c,this.emulatorOptions=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Ji.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Ji.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function DM(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function _k(t,e,n){F(typeof e=="string","typeof type must == string"),F(typeof n=="object","typeof params must == object");let s;if(e===bk)s=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===xk)s=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);DM(t)&&(n.ns=t.namespace);const i=[];return Nt(n,(r,a)=>{i.push(r+"="+a)}),s+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LM{constructor(){this.counters_={}}incrementCounter(e,n=1){$n(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return b2(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mh={},ph={};function e0(t){const e=t.toString();return mh[e]||(mh[e]=new LM),mh[e]}function PM(t,e){const n=t.toString();return ph[n]||(ph[n]=e()),ph[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BM{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const s=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<s.length;++i)s[i]&&no(()=>{this.onMessage_(s[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dx="start",UM="close",HM="pLPCommand",GM="pRTLPCB",wk="id",Ek="pw",Nk="ser",VM="cb",FM="seg",zM="ts",$M="d",KM="dframe",kk=1870,Sk=30,YM=kk-Sk,qM=25e3,WM=3e4;class Zr{constructor(e,n,s,i,r,a,o){this.connId=e,this.repoInfo=n,this.applicationId=s,this.appCheckToken=i,this.authToken=r,this.transportSessionId=a,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=rc(e),this.stats_=e0(n),this.urlFn=c=>(this.appCheckToken&&(c[zm]=this.appCheckToken),_k(n,xk,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new BM(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(WM)),NM(()=>{if(this.isClosed_)return;this.scriptTagHolder=new t0((...r)=>{const[a,o,c,u,d]=r;if(this.incrementIncomingBytes_(r),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,a===Dx)this.id=o,this.password=c;else if(a===UM)o?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(o,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+a)},(...r)=>{const[a,o]=r;this.incrementIncomingBytes_(r),this.myPacketOrderer.handleResponse(a,o)},()=>{this.onClosed_()},this.urlFn);const s={};s[Dx]="t",s[Nk]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(s[VM]=this.scriptTagHolder.uniqueCallbackIdentifier),s[dk]=Zg,this.transportSessionId&&(s[fk]=this.transportSessionId),this.lastSessionId&&(s[gk]=this.lastSessionId),this.applicationId&&(s[vk]=this.applicationId),this.appCheckToken&&(s[zm]=this.appCheckToken),typeof location<"u"&&location.hostname&&pk.test(location.hostname)&&(s[hk]=mk);const i=this.urlFn(s);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Zr.forceAllow_=!0}static forceDisallow(){Zr.forceDisallow_=!0}static isAvailable(){return Zr.forceAllow_?!0:!Zr.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!SM()&&!TM()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=mt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=lN(n),i=ck(s,YM);for(let r=0;r<i.length;r++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[r]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const s={};s[KM]="t",s[wk]=e,s[Ek]=n,this.myDisconnFrame.src=this.urlFn(s),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=mt(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class t0{constructor(e,n,s,i){this.onDisconnect=s,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=ok(),window[HM+this.uniqueCallbackIdentifier]=e,window[GM+this.uniqueCallbackIdentifier]=n,this.myIFrame=t0.createIFrame_();let r="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(r='<script>document.domain="'+document.domain+'";<\/script>');const a="<html><body>"+r+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(o){_t("frame writing exception"),o.stack&&_t(o.stack),_t(o)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||_t("No IE domain setting required")}catch{const s=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+s+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[wk]=this.myID,e[Ek]=this.myPW,e[Nk]=this.currentSerial;let n=this.urlFn(e),s="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Sk+s.length<=kk;){const a=this.pendingSegs.shift();s=s+"&"+FM+i+"="+a.seg+"&"+zM+i+"="+a.ts+"&"+$M+i+"="+a.d,i++}return n=n+s,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,s){this.pendingSegs.push({seg:e,ts:n,d:s}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const s=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(s,Math.floor(qM)),r=()=>{clearTimeout(i),s()};this.addTag(e,r)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const s=this.myIFrame.doc.createElement("script");s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){const i=s.readyState;(!i||i==="loaded"||i==="complete")&&(s.onload=s.onreadystatechange=null,s.parentNode&&s.parentNode.removeChild(s),n())},s.onerror=()=>{_t("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(s)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XM=16384,QM=45e3;let id=null;typeof MozWebSocket<"u"?id=MozWebSocket:typeof WebSocket<"u"&&(id=WebSocket);class Un{constructor(e,n,s,i,r,a,o){this.connId=e,this.applicationId=s,this.appCheckToken=i,this.authToken=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=rc(this.connId),this.stats_=e0(n),this.connURL=Un.connectionURL_(n,a,o,i,s),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,s,i,r){const a={};return a[dk]=Zg,typeof location<"u"&&location.hostname&&pk.test(location.hostname)&&(a[hk]=mk),n&&(a[fk]=n),s&&(a[gk]=s),i&&(a[zm]=i),r&&(a[vk]=r),_k(e,bk,a)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Ji.set("previous_websocket_failure",!0);try{let s;C2(),this.mySock=new id(this.connURL,[],s)}catch(s){this.log_("Error instantiating WebSocket.");const i=s.message||s.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=s=>{this.handleIncomingFrame(s)},this.mySock.onerror=s=>{this.log_("WebSocket error.  Closing connection.");const i=s.message||s.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){Un.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,s=navigator.userAgent.match(n);s&&s.length>1&&parseFloat(s[1])<4.4&&(e=!0)}return!e&&id!==null&&!Un.forceDisallow_}static previouslyFailed(){return Ji.isInMemoryStorage||Ji.get("previous_websocket_failure")===!0}markConnectionHealthy(){Ji.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const s=xl(n);this.onMessage(s)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(F(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const s=this.extractFrameCount_(n);s!==null&&this.appendFrame_(s)}}send(e){this.resetKeepAlive();const n=mt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=ck(n,XM);s.length>1&&this.sendString_(String(s.length));for(let i=0;i<s.length;i++)this.sendString_(s[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(QM))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Un.responsesRequiredToBeHealthy=2;Un.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nl{static get ALL_TRANSPORTS(){return[Zr,Un]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const n=Un&&Un.isAvailable();let s=n&&!Un.previouslyFailed();if(e.webSocketOnly&&(n||Ht("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[Un];else{const i=this.transports_=[];for(const r of Nl.ALL_TRANSPORTS)r&&r.isAvailable()&&i.push(r);Nl.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Nl.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JM=6e4,ZM=5e3,eD=10*1024,tD=100*1024,gh="t",Lx="d",nD="s",Px="r",sD="e",Bx="o",Ux="a",Hx="n",Gx="p",iD="h";class rD{constructor(e,n,s,i,r,a,o,c,u,d){this.id=e,this.repoInfo_=n,this.applicationId_=s,this.appCheckToken_=i,this.authToken_=r,this.onMessage_=a,this.onReady_=o,this.onDisconnect_=c,this.onKill_=u,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=rc("c:"+this.id+":"),this.transportManager_=new Nl(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),s=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,s)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Wo(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>tD?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>eD?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(gh in e){const n=e[gh];n===Ux?this.upgradeIfSecondaryHealthy_():n===Px?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===Bx&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=bo("t",e),s=bo("d",e);if(n==="c")this.onSecondaryControl_(s);else if(n==="d")this.pendingDataMessages.push(s);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Gx,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Ux,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Hx,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=bo("t",e),s=bo("d",e);n==="c"?this.onControl_(s):n==="d"&&this.onDataMessage_(s)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=bo(gh,e);if(Lx in e){const s=e[Lx];if(n===iD){const i=Object.assign({},s);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===Hx){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===nD?this.onConnectionShutdown_(s):n===Px?this.onReset_(s):n===sD?Fm("Server Error: "+s):n===Bx?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Fm("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,s=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Zg!==s&&Ht("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),s=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,s),Wo(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(JM))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Wo(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(ZM))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Gx,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Ji.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tk{put(e,n,s,i){}merge(e,n,s,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,s){}onDisconnectMerge(e,n,s){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ak{constructor(e){this.allowedEvents_=e,this.listeners_={},F(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const s=[...this.listeners_[e]];for(let i=0;i<s.length;i++)s[i].callback.apply(s[i].context,n)}}on(e,n,s){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:s});const i=this.getInitialEvent(e);i&&n.apply(s,i)}off(e,n,s){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let r=0;r<i.length;r++)if(i[r].callback===n&&(!s||s===i[r].context)){i.splice(r,1);return}}validateEventType_(e){F(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rd extends Ak{static getInstance(){return new rd}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Ug()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return F(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vx=32,Fx=768;class Re{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let s=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[s]=this.pieces_[i],s++);this.pieces_.length=s,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function _e(){return new Re("")}function ue(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Ai(t){return t.pieces_.length-t.pieceNum_}function Me(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Re(t.pieces_,e)}function n0(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function aD(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function kl(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function Rk(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Re(e,0)}function Xe(t,e){const n=[];for(let s=t.pieceNum_;s<t.pieces_.length;s++)n.push(t.pieces_[s]);if(e instanceof Re)for(let s=e.pieceNum_;s<e.pieces_.length;s++)n.push(e.pieces_[s]);else{const s=e.split("/");for(let i=0;i<s.length;i++)s[i].length>0&&n.push(s[i])}return new Re(n,0)}function fe(t){return t.pieceNum_>=t.pieces_.length}function Pt(t,e){const n=ue(t),s=ue(e);if(n===null)return e;if(n===s)return Pt(Me(t),Me(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function oD(t,e){const n=kl(t,0),s=kl(e,0);for(let i=0;i<n.length&&i<s.length;i++){const r=Rr(n[i],s[i]);if(r!==0)return r}return n.length===s.length?0:n.length<s.length?-1:1}function s0(t,e){if(Ai(t)!==Ai(e))return!1;for(let n=t.pieceNum_,s=e.pieceNum_;n<=t.pieces_.length;n++,s++)if(t.pieces_[n]!==e.pieces_[s])return!1;return!0}function Nn(t,e){let n=t.pieceNum_,s=e.pieceNum_;if(Ai(t)>Ai(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[s])return!1;++n,++s}return!0}class lD{constructor(e,n){this.errorPrefix_=n,this.parts_=kl(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let s=0;s<this.parts_.length;s++)this.byteLength_+=Wd(this.parts_[s]);Ik(this)}}function cD(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Wd(e),Ik(t)}function uD(t){const e=t.parts_.pop();t.byteLength_-=Wd(e),t.parts_.length>0&&(t.byteLength_-=1)}function Ik(t){if(t.byteLength_>Fx)throw new Error(t.errorPrefix_+"has a key path longer than "+Fx+" bytes ("+t.byteLength_+").");if(t.parts_.length>Vx)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Vx+") or object contains a cycle "+Wi(t))}function Wi(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i0 extends Ak{static getInstance(){return new i0}constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const s=!document[e];s!==this.visible_&&(this.visible_=s,this.trigger("visible",s))},!1)}getInitialEvent(e){return F(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xo=1e3,dD=60*5*1e3,zx=30*1e3,fD=1.3,hD=3e4,mD="server_kill",$x=3;class ks extends Tk{constructor(e,n,s,i,r,a,o,c){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=s,this.onConnectStatus_=i,this.onServerInfoUpdate_=r,this.authTokenProvider_=a,this.appCheckTokenProvider_=o,this.authOverride_=c,this.id=ks.nextPersistentConnectionId_++,this.log_=rc("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=xo,this.maxReconnectDelay_=dD,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");i0.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&rd.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,s){const i=++this.requestNumber_,r={r:i,a:e,b:n};this.log_(mt(r)),F(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),s&&(this.requestCBHash_[i]=s)}get(e){this.initConnection_();const n=new Bn,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:a=>{const o=a.d;a.s==="ok"?n.resolve(o):n.reject(o)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),n.promise}listen(e,n,s,i){this.initConnection_();const r=e._queryIdentifier,a=e._path.toString();this.log_("Listen called for "+a+" "+r),this.listens.has(a)||this.listens.set(a,new Map),F(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),F(!this.listens.get(a).has(r),"listen() called twice for same path/queryId.");const o={onComplete:i,hashFn:n,query:e,tag:s};this.listens.get(a).set(r,o),this.connected_&&this.sendListen_(o)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,s=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(s)})}sendListen_(e){const n=e.query,s=n._path.toString(),i=n._queryIdentifier;this.log_("Listen on "+s+" for "+i);const r={p:s},a="q";e.tag&&(r.q=n._queryObject,r.t=e.tag),r.h=e.hashFn(),this.sendRequest(a,r,o=>{const c=o.d,u=o.s;ks.warnOnListenWarnings_(c,n),(this.listens.get(s)&&this.listens.get(s).get(i))===e&&(this.log_("listen response",o),u!=="ok"&&this.removeListen_(s,i),e.onComplete&&e.onComplete(u,c))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&$n(e,"w")){const s=pr(e,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){const i='".indexOn": "'+n._queryParams.getIndex().toString()+'"',r=n._path.toString();Ht(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${r} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||B2(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=zx)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=P2(e)?"auth":"gauth",s={cred:e};this.authOverride_===null?s.noauth=!0:typeof this.authOverride_=="object"&&(s.authvar=this.authOverride_),this.sendRequest(n,s,i=>{const r=i.s,a=i.d||"error";this.authToken_===e&&(r==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(r,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,s=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,s)})}unlisten(e,n){const s=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+s+" "+i),F(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,i)&&this.connected_&&this.sendUnlisten_(s,i,e._queryObject,n)}sendUnlisten_(e,n,s,i){this.log_("Unlisten on "+e+" for "+n);const r={p:e},a="n";i&&(r.q=s,r.t=i),this.sendRequest(a,r)}onDisconnectPut(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:s})}onDisconnectMerge(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:s})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,s,i){const r={p:n,d:s};this.log_("onDisconnect "+e,r),this.sendRequest(e,r,a=>{i&&setTimeout(()=>{i(a.s,a.d)},Math.floor(0))})}put(e,n,s,i){this.putInternal("p",e,n,s,i)}merge(e,n,s,i){this.putInternal("m",e,n,s,i)}putInternal(e,n,s,i,r){this.initConnection_();const a={p:n,d:s};r!==void 0&&(a.h=r),this.outstandingPuts_.push({action:e,request:a,onComplete:i}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,s=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,s,r=>{this.log_(n+" response",r),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(r.s,r.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,s=>{if(s.s!=="ok"){const r=s.d;this.log_("reportStats","Error sending stats: "+r)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+mt(e));const n=e.r,s=this.requestCBHash_[n];s&&(delete this.requestCBHash_[n],s(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):Fm("Unrecognized action received from server: "+mt(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){F(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=xo,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=xo,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>hD&&(this.reconnectDelay_=xo),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*fD)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),s=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+ks.nextConnectionId_++,r=this.lastSessionId;let a=!1,o=null;const c=function(){o?o.close():(a=!0,s())},u=function(f){F(o,"sendRequest call when we're not connected not allowed."),o.sendRequest(f)};this.realtime_={close:c,sendRequest:u};const d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[f,h]=await Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);a?_t("getToken() completed but was canceled"):(_t("getToken() completed. Creating connection."),this.authToken_=f&&f.accessToken,this.appCheckToken_=h&&h.token,o=new rD(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,s,m=>{Ht(m+" ("+this.repoInfo_.toString()+")"),this.interrupt(mD)},r))}catch(f){this.log_("Failed to get token: "+f),a||(this.repoInfo_.nodeAdmin&&Ht(f),c())}}}interrupt(e){_t("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){_t("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Wu(this.interruptReasons_)&&(this.reconnectDelay_=xo,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let s;n?s=n.map(r=>Jg(r)).join("$"):s="default";const i=this.removeListen_(e,s);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,n){const s=new Re(e).toString();let i;if(this.listens.has(s)){const r=this.listens.get(s);i=r.get(n),r.delete(n),r.size===0&&this.listens.delete(s)}else i=void 0;return i}onAuthRevoked_(e,n){_t("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=$x&&(this.reconnectDelay_=zx,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){_t("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=$x&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+rk.replace(/\./g,"-")]=1,Ug()?e["framework.cordova"]=1:pN()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=rd.getInstance().currentlyOnline();return Wu(this.interruptReasons_)&&e}}ks.nextPersistentConnectionId_=0;ks.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class he{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new he(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const s=new he(Oa,e),i=new he(Oa,n);return this.compare(s,i)!==0}minPost(){return he.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bc;class Ck extends ef{static get __EMPTY_NODE(){return Bc}static set __EMPTY_NODE(e){Bc=e}compare(e,n){return Rr(e.name,n.name)}isDefinedOn(e){throw Ja("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return he.MIN}maxPost(){return new he(xr,Bc)}makePost(e,n){return F(typeof e=="string","KeyIndex indexValue must always be a string."),new he(e,Bc)}toString(){return".key"}}const ga=new Ck;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc{constructor(e,n,s,i,r=null){this.isReverse_=i,this.resultGenerator_=r,this.nodeStack_=[];let a=1;for(;!e.isEmpty();)if(e=e,a=n?s(e.key,n):1,i&&(a*=-1),a<0)this.isReverse_?e=e.left:e=e.right;else if(a===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class bt{constructor(e,n,s,i,r){this.key=e,this.value=n,this.color=s??bt.RED,this.left=i??Wt.EMPTY_NODE,this.right=r??Wt.EMPTY_NODE}copy(e,n,s,i,r){return new bt(e??this.key,n??this.value,s??this.color,i??this.left,r??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let i=this;const r=s(e,i.key);return r<0?i=i.copy(null,null,null,i.left.insert(e,n,s),null):r===0?i=i.copy(null,n,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,n,s)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return Wt.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let s,i;if(s=this,n(e,s.key)<0)!s.left.isEmpty()&&!s.left.isRed_()&&!s.left.left.isRed_()&&(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),!s.right.isEmpty()&&!s.right.isRed_()&&!s.right.left.isRed_()&&(s=s.moveRedRight_()),n(e,s.key)===0){if(s.right.isEmpty())return Wt.EMPTY_NODE;i=s.right.min_(),s=s.copy(i.key,i.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,bt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,bt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}bt.RED=!0;bt.BLACK=!1;class pD{copy(e,n,s,i,r){return this}insert(e,n,s){return new bt(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Wt{constructor(e,n=Wt.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new Wt(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,bt.BLACK,null,null))}remove(e){return new Wt(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,bt.BLACK,null,null))}get(e){let n,s=this.root_;for(;!s.isEmpty();){if(n=this.comparator_(e,s.key),n===0)return s.value;n<0?s=s.left:n>0&&(s=s.right)}return null}getPredecessorKey(e){let n,s=this.root_,i=null;for(;!s.isEmpty();)if(n=this.comparator_(e,s.key),n===0){if(s.left.isEmpty())return i?i.key:null;for(s=s.left;!s.right.isEmpty();)s=s.right;return s.key}else n<0?s=s.left:n>0&&(i=s,s=s.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Uc(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Uc(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Uc(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Uc(this.root_,null,this.comparator_,!0,e)}}Wt.EMPTY_NODE=new pD;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gD(t,e){return Rr(t.name,e.name)}function r0(t,e){return Rr(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $m;function vD(t){$m=t}const jk=function(t){return typeof t=="number"?"number:"+uk(t):"string:"+t},Ok=function(t){if(t.isLeafNode()){const e=t.val();F(typeof e=="string"||typeof e=="number"||typeof e=="object"&&$n(e,".sv"),"Priority must be a string or number.")}else F(t===$m||t.isEmpty(),"priority of unexpected type.");F(t===$m||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Kx;class gt{static set __childrenNodeConstructor(e){Kx=e}static get __childrenNodeConstructor(){return Kx}constructor(e,n=gt.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,F(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Ok(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new gt(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:gt.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return fe(e)?this:ue(e)===".priority"?this.priorityNode_:gt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:gt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const s=ue(e);return s===null?n:n.isEmpty()&&s!==".priority"?this:(F(s!==".priority"||Ai(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(s,gt.__childrenNodeConstructor.EMPTY_NODE.updateChild(Me(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+jk(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=uk(this.value_):e+=this.value_,this.lazyHash_=lk(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===gt.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof gt.__childrenNodeConstructor?-1:(F(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,s=typeof this.value_,i=gt.VALUE_TYPE_ORDER.indexOf(n),r=gt.VALUE_TYPE_ORDER.indexOf(s);return F(i>=0,"Unknown leaf type: "+n),F(r>=0,"Unknown leaf type: "+s),i===r?s==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:r-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}gt.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Mk,Dk;function bD(t){Mk=t}function xD(t){Dk=t}class yD extends ef{compare(e,n){const s=e.node.getPriority(),i=n.node.getPriority(),r=s.compareTo(i);return r===0?Rr(e.name,n.name):r}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return he.MIN}maxPost(){return new he(xr,new gt("[PRIORITY-POST]",Dk))}makePost(e,n){const s=Mk(e);return new he(n,new gt("[PRIORITY-POST]",s))}toString(){return".priority"}}const Ye=new yD;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _D=Math.log(2);class wD{constructor(e){const n=r=>parseInt(Math.log(r)/_D,10),s=r=>parseInt(Array(r+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const i=s(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const ad=function(t,e,n,s){t.sort(e);const i=function(c,u){const d=u-c;let f,h;if(d===0)return null;if(d===1)return f=t[c],h=n?n(f):f,new bt(h,f.node,bt.BLACK,null,null);{const m=parseInt(d/2,10)+c,g=i(c,m),b=i(m+1,u);return f=t[m],h=n?n(f):f,new bt(h,f.node,bt.BLACK,g,b)}},r=function(c){let u=null,d=null,f=t.length;const h=function(g,b){const x=f-g,p=f;f-=g;const v=i(x+1,p),y=t[x],E=n?n(y):y;m(new bt(E,y.node,b,null,v))},m=function(g){u?(u.left=g,u=g):(d=g,u=g)};for(let g=0;g<c.count;++g){const b=c.nextBitIsOne(),x=Math.pow(2,c.count-(g+1));b?h(x,bt.BLACK):(h(x,bt.BLACK),h(x,bt.RED))}return d},a=new wD(t.length),o=r(a);return new Wt(s||e,o)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vh;const Mr={};class ys{static get Default(){return F(Mr&&Ye,"ChildrenNode.ts has not been loaded"),vh=vh||new ys({".priority":Mr},{".priority":Ye}),vh}constructor(e,n){this.indexes_=e,this.indexSet_=n}get(e){const n=pr(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Wt?n:null}hasIndex(e){return $n(this.indexSet_,e.toString())}addIndex(e,n){F(e!==ga,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const s=[];let i=!1;const r=n.getIterator(he.Wrap);let a=r.getNext();for(;a;)i=i||e.isDefinedOn(a.node),s.push(a),a=r.getNext();let o;i?o=ad(s,e.getCompare()):o=Mr;const c=e.toString(),u=Object.assign({},this.indexSet_);u[c]=e;const d=Object.assign({},this.indexes_);return d[c]=o,new ys(d,u)}addToIndexes(e,n){const s=Xu(this.indexes_,(i,r)=>{const a=pr(this.indexSet_,r);if(F(a,"Missing index implementation for "+r),i===Mr)if(a.isDefinedOn(e.node)){const o=[],c=n.getIterator(he.Wrap);let u=c.getNext();for(;u;)u.name!==e.name&&o.push(u),u=c.getNext();return o.push(e),ad(o,a.getCompare())}else return Mr;else{const o=n.get(e.name);let c=i;return o&&(c=c.remove(new he(e.name,o))),c.insert(e,e.node)}});return new ys(s,this.indexSet_)}removeFromIndexes(e,n){const s=Xu(this.indexes_,i=>{if(i===Mr)return i;{const r=n.get(e.name);return r?i.remove(new he(e.name,r)):i}});return new ys(s,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yo;class te{static get EMPTY_NODE(){return yo||(yo=new te(new Wt(r0),null,ys.Default))}constructor(e,n,s){this.children_=e,this.priorityNode_=n,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&Ok(this.priorityNode_),this.children_.isEmpty()&&F(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||yo}updatePriority(e){return this.children_.isEmpty()?this:new te(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?yo:n}}getChild(e){const n=ue(e);return n===null?this:this.getImmediateChild(n).getChild(Me(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(F(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const s=new he(e,n);let i,r;n.isEmpty()?(i=this.children_.remove(e),r=this.indexMap_.removeFromIndexes(s,this.children_)):(i=this.children_.insert(e,n),r=this.indexMap_.addToIndexes(s,this.children_));const a=i.isEmpty()?yo:this.priorityNode_;return new te(i,a,r)}}updateChild(e,n){const s=ue(e);if(s===null)return n;{F(ue(e)!==".priority"||Ai(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(s).updateChild(Me(e),n);return this.updateImmediateChild(s,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let s=0,i=0,r=!0;if(this.forEachChild(Ye,(a,o)=>{n[a]=o.val(e),s++,r&&te.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):r=!1}),!e&&r&&i<2*s){const a=[];for(const o in n)a[o]=n[o];return a}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+jk(this.getPriority().val())+":"),this.forEachChild(Ye,(n,s)=>{const i=s.hash();i!==""&&(e+=":"+n+":"+i)}),this.lazyHash_=e===""?"":lk(e)}return this.lazyHash_}getPredecessorChildName(e,n,s){const i=this.resolveIndex_(s);if(i){const r=i.getPredecessorKey(new he(e,n));return r?r.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.minKey();return s&&s.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new he(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.maxKey();return s&&s.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new he(n,this.children_.get(n)):null}forEachChild(e,n){const s=this.resolveIndex_(e);return s?s.inorderTraversal(i=>n(i.name,i.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,he.Wrap);let r=i.peek();for(;r!=null&&n.compare(r,e)<0;)i.getNext(),r=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,he.Wrap);let r=i.peek();for(;r!=null&&n.compare(r,e)>0;)i.getNext(),r=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===ac?-1:0}withIndex(e){if(e===ga||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new te(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===ga||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const s=this.getIterator(Ye),i=n.getIterator(Ye);let r=s.getNext(),a=i.getNext();for(;r&&a;){if(r.name!==a.name||!r.node.equals(a.node))return!1;r=s.getNext(),a=i.getNext()}return r===null&&a===null}else return!1;else return!1}}resolveIndex_(e){return e===ga?null:this.indexMap_.get(e.toString())}}te.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class ED extends te{constructor(){super(new Wt(r0),te.EMPTY_NODE,ys.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return te.EMPTY_NODE}isEmpty(){return!1}}const ac=new ED;Object.defineProperties(he,{MIN:{value:new he(Oa,te.EMPTY_NODE)},MAX:{value:new he(xr,ac)}});Ck.__EMPTY_NODE=te.EMPTY_NODE;gt.__childrenNodeConstructor=te;vD(ac);xD(ac);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ND=!0;function We(t,e=null){if(t===null)return te.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),F(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new gt(n,We(e))}if(!(t instanceof Array)&&ND){const n=[];let s=!1;if(Nt(t,(a,o)=>{if(a.substring(0,1)!=="."){const c=We(o);c.isEmpty()||(s=s||!c.getPriority().isEmpty(),n.push(new he(a,c)))}}),n.length===0)return te.EMPTY_NODE;const r=ad(n,gD,a=>a.name,r0);if(s){const a=ad(n,Ye.getCompare());return new te(r,We(e),new ys({".priority":a},{".priority":Ye}))}else return new te(r,We(e),ys.Default)}else{let n=te.EMPTY_NODE;return Nt(t,(s,i)=>{if($n(t,s)&&s.substring(0,1)!=="."){const r=We(i);(r.isLeafNode()||!r.isEmpty())&&(n=n.updateImmediateChild(s,r))}}),n.updatePriority(We(e))}}bD(We);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kD extends ef{constructor(e){super(),this.indexPath_=e,F(!fe(e)&&ue(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const s=this.extractChild(e.node),i=this.extractChild(n.node),r=s.compareTo(i);return r===0?Rr(e.name,n.name):r}makePost(e,n){const s=We(e),i=te.EMPTY_NODE.updateChild(this.indexPath_,s);return new he(n,i)}maxPost(){const e=te.EMPTY_NODE.updateChild(this.indexPath_,ac);return new he(xr,e)}toString(){return kl(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SD extends ef{compare(e,n){const s=e.node.compareTo(n.node);return s===0?Rr(e.name,n.name):s}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return he.MIN}maxPost(){return he.MAX}makePost(e,n){const s=We(e);return new he(n,s)}toString(){return".value"}}const TD=new SD;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lk(t){return{type:"value",snapshotNode:t}}function Ma(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Sl(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Tl(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function AD(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a0{constructor(e){this.index_=e}updateChild(e,n,s,i,r,a){F(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const o=e.getImmediateChild(n);return o.getChild(i).equals(s.getChild(i))&&o.isEmpty()===s.isEmpty()||(a!=null&&(s.isEmpty()?e.hasChild(n)?a.trackChildChange(Sl(n,o)):F(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?a.trackChildChange(Ma(n,s)):a.trackChildChange(Tl(n,s,o))),e.isLeafNode()&&s.isEmpty())?e:e.updateImmediateChild(n,s).withIndex(this.index_)}updateFullNode(e,n,s){return s!=null&&(e.isLeafNode()||e.forEachChild(Ye,(i,r)=>{n.hasChild(i)||s.trackChildChange(Sl(i,r))}),n.isLeafNode()||n.forEachChild(Ye,(i,r)=>{if(e.hasChild(i)){const a=e.getImmediateChild(i);a.equals(r)||s.trackChildChange(Tl(i,r,a))}else s.trackChildChange(Ma(i,r))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?te.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Al{constructor(e){this.indexedFilter_=new a0(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Al.getStartPost_(e),this.endPost_=Al.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,s=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&s}updateChild(e,n,s,i,r,a){return this.matches(new he(n,s))||(s=te.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,s,i,r,a)}updateFullNode(e,n,s){n.isLeafNode()&&(n=te.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(te.EMPTY_NODE);const r=this;return n.forEachChild(Ye,(a,o)=>{r.matches(new he(a,o))||(i=i.updateImmediateChild(a,te.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const s=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?s<=0:s<0},this.withinEndPost=n=>{const s=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?s<=0:s<0},this.rangedFilter_=new Al(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,s,i,r,a){return this.rangedFilter_.matches(new he(n,s))||(s=te.EMPTY_NODE),e.getImmediateChild(n).equals(s)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,s,i,r,a):this.fullLimitUpdateChild_(e,n,s,r,a)}updateFullNode(e,n,s){let i;if(n.isLeafNode()||n.isEmpty())i=te.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=te.EMPTY_NODE.withIndex(this.index_);let r;this.reverse_?r=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):r=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let a=0;for(;r.hasNext()&&a<this.limit_;){const o=r.getNext();if(this.withinDirectionalStart(o))if(this.withinDirectionalEnd(o))i=i.updateImmediateChild(o.name,o.node),a++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(te.EMPTY_NODE);let r;this.reverse_?r=i.getReverseIterator(this.index_):r=i.getIterator(this.index_);let a=0;for(;r.hasNext();){const o=r.getNext();a<this.limit_&&this.withinDirectionalStart(o)&&this.withinDirectionalEnd(o)?a++:i=i.updateImmediateChild(o.name,te.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,s,i,r){let a;if(this.reverse_){const f=this.index_.getCompare();a=(h,m)=>f(m,h)}else a=this.index_.getCompare();const o=e;F(o.numChildren()===this.limit_,"");const c=new he(n,s),u=this.reverse_?o.getFirstChild(this.index_):o.getLastChild(this.index_),d=this.rangedFilter_.matches(c);if(o.hasChild(n)){const f=o.getImmediateChild(n);let h=i.getChildAfterChild(this.index_,u,this.reverse_);for(;h!=null&&(h.name===n||o.hasChild(h.name));)h=i.getChildAfterChild(this.index_,h,this.reverse_);const m=h==null?1:a(h,c);if(d&&!s.isEmpty()&&m>=0)return r!=null&&r.trackChildChange(Tl(n,s,f)),o.updateImmediateChild(n,s);{r!=null&&r.trackChildChange(Sl(n,f));const b=o.updateImmediateChild(n,te.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(r!=null&&r.trackChildChange(Ma(h.name,h.node)),b.updateImmediateChild(h.name,h.node)):b}}else return s.isEmpty()?e:d&&a(u,c)>=0?(r!=null&&(r.trackChildChange(Sl(u.name,u.node)),r.trackChildChange(Ma(n,s))),o.updateImmediateChild(n,s).updateImmediateChild(u.name,te.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o0{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ye}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return F(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return F(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Oa}hasEnd(){return this.endSet_}getIndexEndValue(){return F(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return F(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:xr}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return F(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ye}copy(){const e=new o0;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function ID(t){return t.loadsAllData()?new a0(t.getIndex()):t.hasLimit()?new RD(t):new Al(t)}function CD(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function Yx(t){const e={};if(t.isDefault())return e;let n;if(t.index_===Ye?n="$priority":t.index_===TD?n="$value":t.index_===ga?n="$key":(F(t.index_ instanceof kD,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=mt(n),t.startSet_){const s=t.startAfterSet_?"startAfter":"startAt";e[s]=mt(t.indexStartValue_),t.startNameSet_&&(e[s]+=","+mt(t.indexStartName_))}if(t.endSet_){const s=t.endBeforeSet_?"endBefore":"endAt";e[s]=mt(t.indexEndValue_),t.endNameSet_&&(e[s]+=","+mt(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function qx(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Ye&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od extends Tk{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(F(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,n,s,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=s,this.appCheckTokenProvider_=i,this.log_=rc("p:rest:"),this.listens_={}}listen(e,n,s,i){const r=e._path.toString();this.log_("Listen called for "+r+" "+e._queryIdentifier);const a=od.getListenId_(e,s),o={};this.listens_[a]=o;const c=Yx(e._queryParams);this.restRequest_(r+".json",c,(u,d)=>{let f=d;if(u===404&&(f=null,u=null),u===null&&this.onDataUpdate_(r,f,!1,s),pr(this.listens_,a)===o){let h;u?u===401?h="permission_denied":h="rest_error:"+u:h="ok",i(h,null)}})}unlisten(e,n){const s=od.getListenId_(e,n);delete this.listens_[s]}get(e){const n=Yx(e._queryParams),s=e._path.toString(),i=new Bn;return this.restRequest_(s+".json",n,(r,a)=>{let o=a;r===404&&(o=null,r=null),r===null?(this.onDataUpdate_(s,o,!1,null),i.resolve(o)):i.reject(new Error(o))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},s){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,r])=>{i&&i.accessToken&&(n.auth=i.accessToken),r&&r.token&&(n.ac=r.token);const a=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+eo(n);this.log_("Sending REST request for "+a);const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(s&&o.readyState===4){this.log_("REST Response for "+a+" received. status:",o.status,"response:",o.responseText);let c=null;if(o.status>=200&&o.status<300){try{c=xl(o.responseText)}catch{Ht("Failed to parse JSON response for "+a+": "+o.responseText)}s(null,c)}else o.status!==401&&o.status!==404&&Ht("Got unsuccessful REST response for "+a+" Status: "+o.status),s(o.status);s=null}},o.open("GET",a,!0),o.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jD{constructor(){this.rootNode_=te.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ld(){return{value:null,children:new Map}}function so(t,e,n){if(fe(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const s=ue(e);t.children.has(s)||t.children.set(s,ld());const i=t.children.get(s);e=Me(e),so(i,e,n)}}function Km(t,e){if(fe(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(Ye,(s,i)=>{so(t,new Re(s),i)}),Km(t,e)}}else if(t.children.size>0){const n=ue(e);return e=Me(e),t.children.has(n)&&Km(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function Ym(t,e,n){t.value!==null?n(e,t.value):OD(t,(s,i)=>{const r=new Re(e.toString()+"/"+s);Ym(i,r,n)})}function OD(t,e){t.children.forEach((n,s)=>{e(s,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MD{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&Nt(this.last_,(s,i)=>{n[s]=n[s]-i}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wx=10*1e3,DD=30*1e3,LD=5*60*1e3;class PD{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new MD(e);const s=Wx+(DD-Wx)*Math.random();Wo(this.reportStats_.bind(this),Math.floor(s))}reportStats_(){const e=this.statsListener_.get(),n={};let s=!1;Nt(e,(i,r)=>{r>0&&$n(this.statsToReport_,i)&&(n[i]=r,s=!0)}),s&&this.server_.reportStats(n),Wo(this.reportStats_.bind(this),Math.floor(Math.random()*2*LD))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gn;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Gn||(Gn={}));function l0(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function c0(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function u0(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cd{constructor(e,n,s){this.path=e,this.affectedTree=n,this.revert=s,this.type=Gn.ACK_USER_WRITE,this.source=l0()}operationForChild(e){if(fe(this.path)){if(this.affectedTree.value!=null)return F(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Re(e));return new cd(_e(),n,this.revert)}}else return F(ue(this.path)===e,"operationForChild called for unrelated child."),new cd(Me(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rl{constructor(e,n){this.source=e,this.path=n,this.type=Gn.LISTEN_COMPLETE}operationForChild(e){return fe(this.path)?new Rl(this.source,_e()):new Rl(this.source,Me(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr{constructor(e,n,s){this.source=e,this.path=n,this.snap=s,this.type=Gn.OVERWRITE}operationForChild(e){return fe(this.path)?new yr(this.source,_e(),this.snap.getImmediateChild(e)):new yr(this.source,Me(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da{constructor(e,n,s){this.source=e,this.path=n,this.children=s,this.type=Gn.MERGE}operationForChild(e){if(fe(this.path)){const n=this.children.subtree(new Re(e));return n.isEmpty()?null:n.value?new yr(this.source,_e(),n.value):new Da(this.source,_e(),n)}else return F(ue(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Da(this.source,Me(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(e,n,s){this.node_=e,this.fullyInitialized_=n,this.filtered_=s}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(fe(e))return this.isFullyInitialized()&&!this.filtered_;const n=ue(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BD{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function UD(t,e,n,s){const i=[],r=[];return e.forEach(a=>{a.type==="child_changed"&&t.index_.indexedValueChanged(a.oldSnap,a.snapshotNode)&&r.push(AD(a.childName,a.snapshotNode))}),_o(t,i,"child_removed",e,s,n),_o(t,i,"child_added",e,s,n),_o(t,i,"child_moved",r,s,n),_o(t,i,"child_changed",e,s,n),_o(t,i,"value",e,s,n),i}function _o(t,e,n,s,i,r){const a=s.filter(o=>o.type===n);a.sort((o,c)=>GD(t,o,c)),a.forEach(o=>{const c=HD(t,o,r);i.forEach(u=>{u.respondsTo(o.type)&&e.push(u.createEvent(c,t.query_))})})}function HD(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function GD(t,e,n){if(e.childName==null||n.childName==null)throw Ja("Should only compare child_ events.");const s=new he(e.childName,e.snapshotNode),i=new he(n.childName,n.snapshotNode);return t.index_.compare(s,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tf(t,e){return{eventCache:t,serverCache:e}}function Xo(t,e,n,s){return tf(new Ri(e,n,s),t.serverCache)}function Pk(t,e,n,s){return tf(t.eventCache,new Ri(e,n,s))}function ud(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function _r(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bh;const VD=()=>(bh||(bh=new Wt(kM)),bh);class Pe{static fromObject(e){let n=new Pe(null);return Nt(e,(s,i)=>{n=n.set(new Re(s),i)}),n}constructor(e,n=VD()){this.value=e,this.children=n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:_e(),value:this.value};if(fe(e))return null;{const s=ue(e),i=this.children.get(s);if(i!==null){const r=i.findRootMostMatchingPathAndValue(Me(e),n);return r!=null?{path:Xe(new Re(s),r.path),value:r.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(fe(e))return this;{const n=ue(e),s=this.children.get(n);return s!==null?s.subtree(Me(e)):new Pe(null)}}set(e,n){if(fe(e))return new Pe(n,this.children);{const s=ue(e),r=(this.children.get(s)||new Pe(null)).set(Me(e),n),a=this.children.insert(s,r);return new Pe(this.value,a)}}remove(e){if(fe(e))return this.children.isEmpty()?new Pe(null):new Pe(null,this.children);{const n=ue(e),s=this.children.get(n);if(s){const i=s.remove(Me(e));let r;return i.isEmpty()?r=this.children.remove(n):r=this.children.insert(n,i),this.value===null&&r.isEmpty()?new Pe(null):new Pe(this.value,r)}else return this}}get(e){if(fe(e))return this.value;{const n=ue(e),s=this.children.get(n);return s?s.get(Me(e)):null}}setTree(e,n){if(fe(e))return n;{const s=ue(e),r=(this.children.get(s)||new Pe(null)).setTree(Me(e),n);let a;return r.isEmpty()?a=this.children.remove(s):a=this.children.insert(s,r),new Pe(this.value,a)}}fold(e){return this.fold_(_e(),e)}fold_(e,n){const s={};return this.children.inorderTraversal((i,r)=>{s[i]=r.fold_(Xe(e,i),n)}),n(e,this.value,s)}findOnPath(e,n){return this.findOnPath_(e,_e(),n)}findOnPath_(e,n,s){const i=this.value?s(n,this.value):!1;if(i)return i;if(fe(e))return null;{const r=ue(e),a=this.children.get(r);return a?a.findOnPath_(Me(e),Xe(n,r),s):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,_e(),n)}foreachOnPath_(e,n,s){if(fe(e))return this;{this.value&&s(n,this.value);const i=ue(e),r=this.children.get(i);return r?r.foreachOnPath_(Me(e),Xe(n,i),s):new Pe(null)}}foreach(e){this.foreach_(_e(),e)}foreach_(e,n){this.children.inorderTraversal((s,i)=>{i.foreach_(Xe(e,s),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,s)=>{s.value&&e(n,s.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(e){this.writeTree_=e}static empty(){return new Vn(new Pe(null))}}function Qo(t,e,n){if(fe(e))return new Vn(new Pe(n));{const s=t.writeTree_.findRootMostValueAndPath(e);if(s!=null){const i=s.path;let r=s.value;const a=Pt(i,e);return r=r.updateChild(a,n),new Vn(t.writeTree_.set(i,r))}else{const i=new Pe(n),r=t.writeTree_.setTree(e,i);return new Vn(r)}}}function qm(t,e,n){let s=t;return Nt(n,(i,r)=>{s=Qo(s,Xe(e,i),r)}),s}function Xx(t,e){if(fe(e))return Vn.empty();{const n=t.writeTree_.setTree(e,new Pe(null));return new Vn(n)}}function Wm(t,e){return Ir(t,e)!=null}function Ir(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Pt(n.path,e)):null}function Qx(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Ye,(s,i)=>{e.push(new he(s,i))}):t.writeTree_.children.inorderTraversal((s,i)=>{i.value!=null&&e.push(new he(s,i.value))}),e}function _i(t,e){if(fe(e))return t;{const n=Ir(t,e);return n!=null?new Vn(new Pe(n)):new Vn(t.writeTree_.subtree(e))}}function Xm(t){return t.writeTree_.isEmpty()}function La(t,e){return Bk(_e(),t.writeTree_,e)}function Bk(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let s=null;return e.children.inorderTraversal((i,r)=>{i===".priority"?(F(r.value!==null,"Priority writes must always be leaf nodes"),s=r.value):n=Bk(Xe(t,i),r,n)}),!n.getChild(t).isEmpty()&&s!==null&&(n=n.updateChild(Xe(t,".priority"),s)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nf(t,e){return Vk(e,t)}function FD(t,e,n,s,i){F(s>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:s,visible:i}),i&&(t.visibleWrites=Qo(t.visibleWrites,e,n)),t.lastWriteId=s}function zD(t,e,n,s){F(s>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:s,visible:!0}),t.visibleWrites=qm(t.visibleWrites,e,n),t.lastWriteId=s}function $D(t,e){for(let n=0;n<t.allWrites.length;n++){const s=t.allWrites[n];if(s.writeId===e)return s}return null}function KD(t,e){const n=t.allWrites.findIndex(o=>o.writeId===e);F(n>=0,"removeWrite called with nonexistent writeId.");const s=t.allWrites[n];t.allWrites.splice(n,1);let i=s.visible,r=!1,a=t.allWrites.length-1;for(;i&&a>=0;){const o=t.allWrites[a];o.visible&&(a>=n&&YD(o,s.path)?i=!1:Nn(s.path,o.path)&&(r=!0)),a--}if(i){if(r)return qD(t),!0;if(s.snap)t.visibleWrites=Xx(t.visibleWrites,s.path);else{const o=s.children;Nt(o,c=>{t.visibleWrites=Xx(t.visibleWrites,Xe(s.path,c))})}return!0}else return!1}function YD(t,e){if(t.snap)return Nn(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&Nn(Xe(t.path,n),e))return!0;return!1}function qD(t){t.visibleWrites=Uk(t.allWrites,WD,_e()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function WD(t){return t.visible}function Uk(t,e,n){let s=Vn.empty();for(let i=0;i<t.length;++i){const r=t[i];if(e(r)){const a=r.path;let o;if(r.snap)Nn(n,a)?(o=Pt(n,a),s=Qo(s,o,r.snap)):Nn(a,n)&&(o=Pt(a,n),s=Qo(s,_e(),r.snap.getChild(o)));else if(r.children){if(Nn(n,a))o=Pt(n,a),s=qm(s,o,r.children);else if(Nn(a,n))if(o=Pt(a,n),fe(o))s=qm(s,_e(),r.children);else{const c=pr(r.children,ue(o));if(c){const u=c.getChild(Me(o));s=Qo(s,_e(),u)}}}else throw Ja("WriteRecord should have .snap or .children")}}return s}function Hk(t,e,n,s,i){if(!s&&!i){const r=Ir(t.visibleWrites,e);if(r!=null)return r;{const a=_i(t.visibleWrites,e);if(Xm(a))return n;if(n==null&&!Wm(a,_e()))return null;{const o=n||te.EMPTY_NODE;return La(a,o)}}}else{const r=_i(t.visibleWrites,e);if(!i&&Xm(r))return n;if(!i&&n==null&&!Wm(r,_e()))return null;{const a=function(u){return(u.visible||i)&&(!s||!~s.indexOf(u.writeId))&&(Nn(u.path,e)||Nn(e,u.path))},o=Uk(t.allWrites,a,e),c=n||te.EMPTY_NODE;return La(o,c)}}}function XD(t,e,n){let s=te.EMPTY_NODE;const i=Ir(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Ye,(r,a)=>{s=s.updateImmediateChild(r,a)}),s;if(n){const r=_i(t.visibleWrites,e);return n.forEachChild(Ye,(a,o)=>{const c=La(_i(r,new Re(a)),o);s=s.updateImmediateChild(a,c)}),Qx(r).forEach(a=>{s=s.updateImmediateChild(a.name,a.node)}),s}else{const r=_i(t.visibleWrites,e);return Qx(r).forEach(a=>{s=s.updateImmediateChild(a.name,a.node)}),s}}function QD(t,e,n,s,i){F(s||i,"Either existingEventSnap or existingServerSnap must exist");const r=Xe(e,n);if(Wm(t.visibleWrites,r))return null;{const a=_i(t.visibleWrites,r);return Xm(a)?i.getChild(n):La(a,i.getChild(n))}}function JD(t,e,n,s){const i=Xe(e,n),r=Ir(t.visibleWrites,i);if(r!=null)return r;if(s.isCompleteForChild(n)){const a=_i(t.visibleWrites,i);return La(a,s.getNode().getImmediateChild(n))}else return null}function ZD(t,e){return Ir(t.visibleWrites,e)}function eL(t,e,n,s,i,r,a){let o;const c=_i(t.visibleWrites,e),u=Ir(c,_e());if(u!=null)o=u;else if(n!=null)o=La(c,n);else return[];if(o=o.withIndex(a),!o.isEmpty()&&!o.isLeafNode()){const d=[],f=a.getCompare(),h=r?o.getReverseIteratorFrom(s,a):o.getIteratorFrom(s,a);let m=h.getNext();for(;m&&d.length<i;)f(m,s)!==0&&d.push(m),m=h.getNext();return d}else return[]}function tL(){return{visibleWrites:Vn.empty(),allWrites:[],lastWriteId:-1}}function dd(t,e,n,s){return Hk(t.writeTree,t.treePath,e,n,s)}function d0(t,e){return XD(t.writeTree,t.treePath,e)}function Jx(t,e,n,s){return QD(t.writeTree,t.treePath,e,n,s)}function fd(t,e){return ZD(t.writeTree,Xe(t.treePath,e))}function nL(t,e,n,s,i,r){return eL(t.writeTree,t.treePath,e,n,s,i,r)}function f0(t,e,n){return JD(t.writeTree,t.treePath,e,n)}function Gk(t,e){return Vk(Xe(t.treePath,e),t.writeTree)}function Vk(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sL{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,s=e.childName;F(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),F(s!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(s);if(i){const r=i.type;if(n==="child_added"&&r==="child_removed")this.changeMap.set(s,Tl(s,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&r==="child_added")this.changeMap.delete(s);else if(n==="child_removed"&&r==="child_changed")this.changeMap.set(s,Sl(s,i.oldSnap));else if(n==="child_changed"&&r==="child_added")this.changeMap.set(s,Ma(s,e.snapshotNode));else if(n==="child_changed"&&r==="child_changed")this.changeMap.set(s,Tl(s,e.snapshotNode,i.oldSnap));else throw Ja("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(s,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iL{getCompleteChild(e){return null}getChildAfterChild(e,n,s){return null}}const Fk=new iL;class h0{constructor(e,n,s=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=s}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const s=this.optCompleteServerCache_!=null?new Ri(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return f0(this.writes_,e,s)}}getChildAfterChild(e,n,s){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:_r(this.viewCache_),r=nL(this.writes_,i,n,1,s,e);return r.length===0?null:r[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rL(t){return{filter:t}}function aL(t,e){F(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),F(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function oL(t,e,n,s,i){const r=new sL;let a,o;if(n.type===Gn.OVERWRITE){const u=n;u.source.fromUser?a=Qm(t,e,u.path,u.snap,s,i,r):(F(u.source.fromServer,"Unknown source."),o=u.source.tagged||e.serverCache.isFiltered()&&!fe(u.path),a=hd(t,e,u.path,u.snap,s,i,o,r))}else if(n.type===Gn.MERGE){const u=n;u.source.fromUser?a=cL(t,e,u.path,u.children,s,i,r):(F(u.source.fromServer,"Unknown source."),o=u.source.tagged||e.serverCache.isFiltered(),a=Jm(t,e,u.path,u.children,s,i,o,r))}else if(n.type===Gn.ACK_USER_WRITE){const u=n;u.revert?a=fL(t,e,u.path,s,i,r):a=uL(t,e,u.path,u.affectedTree,s,i,r)}else if(n.type===Gn.LISTEN_COMPLETE)a=dL(t,e,n.path,s,r);else throw Ja("Unknown operation type: "+n.type);const c=r.getChanges();return lL(e,a,c),{viewCache:a,changes:c}}function lL(t,e,n){const s=e.eventCache;if(s.isFullyInitialized()){const i=s.getNode().isLeafNode()||s.getNode().isEmpty(),r=ud(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!s.getNode().equals(r)||!s.getNode().getPriority().equals(r.getPriority()))&&n.push(Lk(ud(e)))}}function zk(t,e,n,s,i,r){const a=e.eventCache;if(fd(s,n)!=null)return e;{let o,c;if(fe(n))if(F(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const u=_r(e),d=u instanceof te?u:te.EMPTY_NODE,f=d0(s,d);o=t.filter.updateFullNode(e.eventCache.getNode(),f,r)}else{const u=dd(s,_r(e));o=t.filter.updateFullNode(e.eventCache.getNode(),u,r)}else{const u=ue(n);if(u===".priority"){F(Ai(n)===1,"Can't have a priority with additional path components");const d=a.getNode();c=e.serverCache.getNode();const f=Jx(s,n,d,c);f!=null?o=t.filter.updatePriority(d,f):o=a.getNode()}else{const d=Me(n);let f;if(a.isCompleteForChild(u)){c=e.serverCache.getNode();const h=Jx(s,n,a.getNode(),c);h!=null?f=a.getNode().getImmediateChild(u).updateChild(d,h):f=a.getNode().getImmediateChild(u)}else f=f0(s,u,e.serverCache);f!=null?o=t.filter.updateChild(a.getNode(),u,f,d,i,r):o=a.getNode()}}return Xo(e,o,a.isFullyInitialized()||fe(n),t.filter.filtersNodes())}}function hd(t,e,n,s,i,r,a,o){const c=e.serverCache;let u;const d=a?t.filter:t.filter.getIndexedFilter();if(fe(n))u=d.updateFullNode(c.getNode(),s,null);else if(d.filtersNodes()&&!c.isFiltered()){const m=c.getNode().updateChild(n,s);u=d.updateFullNode(c.getNode(),m,null)}else{const m=ue(n);if(!c.isCompleteForPath(n)&&Ai(n)>1)return e;const g=Me(n),x=c.getNode().getImmediateChild(m).updateChild(g,s);m===".priority"?u=d.updatePriority(c.getNode(),x):u=d.updateChild(c.getNode(),m,x,g,Fk,null)}const f=Pk(e,u,c.isFullyInitialized()||fe(n),d.filtersNodes()),h=new h0(i,f,r);return zk(t,f,n,i,h,o)}function Qm(t,e,n,s,i,r,a){const o=e.eventCache;let c,u;const d=new h0(i,e,r);if(fe(n))u=t.filter.updateFullNode(e.eventCache.getNode(),s,a),c=Xo(e,u,!0,t.filter.filtersNodes());else{const f=ue(n);if(f===".priority")u=t.filter.updatePriority(e.eventCache.getNode(),s),c=Xo(e,u,o.isFullyInitialized(),o.isFiltered());else{const h=Me(n),m=o.getNode().getImmediateChild(f);let g;if(fe(h))g=s;else{const b=d.getCompleteChild(f);b!=null?n0(h)===".priority"&&b.getChild(Rk(h)).isEmpty()?g=b:g=b.updateChild(h,s):g=te.EMPTY_NODE}if(m.equals(g))c=e;else{const b=t.filter.updateChild(o.getNode(),f,g,h,d,a);c=Xo(e,b,o.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function Zx(t,e){return t.eventCache.isCompleteForChild(e)}function cL(t,e,n,s,i,r,a){let o=e;return s.foreach((c,u)=>{const d=Xe(n,c);Zx(e,ue(d))&&(o=Qm(t,o,d,u,i,r,a))}),s.foreach((c,u)=>{const d=Xe(n,c);Zx(e,ue(d))||(o=Qm(t,o,d,u,i,r,a))}),o}function ey(t,e,n){return n.foreach((s,i)=>{e=e.updateChild(s,i)}),e}function Jm(t,e,n,s,i,r,a,o){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,u;fe(n)?u=s:u=new Pe(null).setTree(n,s);const d=e.serverCache.getNode();return u.children.inorderTraversal((f,h)=>{if(d.hasChild(f)){const m=e.serverCache.getNode().getImmediateChild(f),g=ey(t,m,h);c=hd(t,c,new Re(f),g,i,r,a,o)}}),u.children.inorderTraversal((f,h)=>{const m=!e.serverCache.isCompleteForChild(f)&&h.value===null;if(!d.hasChild(f)&&!m){const g=e.serverCache.getNode().getImmediateChild(f),b=ey(t,g,h);c=hd(t,c,new Re(f),b,i,r,a,o)}}),c}function uL(t,e,n,s,i,r,a){if(fd(i,n)!=null)return e;const o=e.serverCache.isFiltered(),c=e.serverCache;if(s.value!=null){if(fe(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return hd(t,e,n,c.getNode().getChild(n),i,r,o,a);if(fe(n)){let u=new Pe(null);return c.getNode().forEachChild(ga,(d,f)=>{u=u.set(new Re(d),f)}),Jm(t,e,n,u,i,r,o,a)}else return e}else{let u=new Pe(null);return s.foreach((d,f)=>{const h=Xe(n,d);c.isCompleteForPath(h)&&(u=u.set(d,c.getNode().getChild(h)))}),Jm(t,e,n,u,i,r,o,a)}}function dL(t,e,n,s,i){const r=e.serverCache,a=Pk(e,r.getNode(),r.isFullyInitialized()||fe(n),r.isFiltered());return zk(t,a,n,s,Fk,i)}function fL(t,e,n,s,i,r){let a;if(fd(s,n)!=null)return e;{const o=new h0(s,e,i),c=e.eventCache.getNode();let u;if(fe(n)||ue(n)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=dd(s,_r(e));else{const f=e.serverCache.getNode();F(f instanceof te,"serverChildren would be complete if leaf node"),d=d0(s,f)}d=d,u=t.filter.updateFullNode(c,d,r)}else{const d=ue(n);let f=f0(s,d,e.serverCache);f==null&&e.serverCache.isCompleteForChild(d)&&(f=c.getImmediateChild(d)),f!=null?u=t.filter.updateChild(c,d,f,Me(n),o,r):e.eventCache.getNode().hasChild(d)?u=t.filter.updateChild(c,d,te.EMPTY_NODE,Me(n),o,r):u=c,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(a=dd(s,_r(e)),a.isLeafNode()&&(u=t.filter.updateFullNode(u,a,r)))}return a=e.serverCache.isFullyInitialized()||fd(s,_e())!=null,Xo(e,u,a,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hL{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const s=this.query_._queryParams,i=new a0(s.getIndex()),r=ID(s);this.processor_=rL(r);const a=n.serverCache,o=n.eventCache,c=i.updateFullNode(te.EMPTY_NODE,a.getNode(),null),u=r.updateFullNode(te.EMPTY_NODE,o.getNode(),null),d=new Ri(c,a.isFullyInitialized(),i.filtersNodes()),f=new Ri(u,o.isFullyInitialized(),r.filtersNodes());this.viewCache_=tf(f,d),this.eventGenerator_=new BD(this.query_)}get query(){return this.query_}}function mL(t){return t.viewCache_.serverCache.getNode()}function pL(t){return ud(t.viewCache_)}function gL(t,e){const n=_r(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!fe(e)&&!n.getImmediateChild(ue(e)).isEmpty())?n.getChild(e):null}function ty(t){return t.eventRegistrations_.length===0}function vL(t,e){t.eventRegistrations_.push(e)}function ny(t,e,n){const s=[];if(n){F(e==null,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach(r=>{const a=r.createCancelEvent(n,i);a&&s.push(a)})}if(e){let i=[];for(let r=0;r<t.eventRegistrations_.length;++r){const a=t.eventRegistrations_[r];if(!a.matches(e))i.push(a);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(r+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return s}function sy(t,e,n,s){e.type===Gn.MERGE&&e.source.queryId!==null&&(F(_r(t.viewCache_),"We should always have a full cache before handling merges"),F(ud(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,r=oL(t.processor_,i,e,n,s);return aL(t.processor_,r.viewCache),F(r.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=r.viewCache,$k(t,r.changes,r.viewCache.eventCache.getNode(),null)}function bL(t,e){const n=t.viewCache_.eventCache,s=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Ye,(r,a)=>{s.push(Ma(r,a))}),n.isFullyInitialized()&&s.push(Lk(n.getNode())),$k(t,s,n.getNode(),e)}function $k(t,e,n,s){const i=s?[s]:t.eventRegistrations_;return UD(t.eventGenerator_,e,n,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let md;class Kk{constructor(){this.views=new Map}}function xL(t){F(!md,"__referenceConstructor has already been defined"),md=t}function yL(){return F(md,"Reference.ts has not been loaded"),md}function _L(t){return t.views.size===0}function m0(t,e,n,s){const i=e.source.queryId;if(i!==null){const r=t.views.get(i);return F(r!=null,"SyncTree gave us an op for an invalid query."),sy(r,e,n,s)}else{let r=[];for(const a of t.views.values())r=r.concat(sy(a,e,n,s));return r}}function Yk(t,e,n,s,i){const r=e._queryIdentifier,a=t.views.get(r);if(!a){let o=dd(n,i?s:null),c=!1;o?c=!0:s instanceof te?(o=d0(n,s),c=!1):(o=te.EMPTY_NODE,c=!1);const u=tf(new Ri(o,c,!1),new Ri(s,i,!1));return new hL(e,u)}return a}function wL(t,e,n,s,i,r){const a=Yk(t,e,s,i,r);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,a),vL(a,n),bL(a,n)}function EL(t,e,n,s){const i=e._queryIdentifier,r=[];let a=[];const o=Ii(t);if(i==="default")for(const[c,u]of t.views.entries())a=a.concat(ny(u,n,s)),ty(u)&&(t.views.delete(c),u.query._queryParams.loadsAllData()||r.push(u.query));else{const c=t.views.get(i);c&&(a=a.concat(ny(c,n,s)),ty(c)&&(t.views.delete(i),c.query._queryParams.loadsAllData()||r.push(c.query)))}return o&&!Ii(t)&&r.push(new(yL())(e._repo,e._path)),{removed:r,events:a}}function qk(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function wi(t,e){let n=null;for(const s of t.views.values())n=n||gL(s,e);return n}function Wk(t,e){if(e._queryParams.loadsAllData())return sf(t);{const s=e._queryIdentifier;return t.views.get(s)}}function Xk(t,e){return Wk(t,e)!=null}function Ii(t){return sf(t)!=null}function sf(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pd;function NL(t){F(!pd,"__referenceConstructor has already been defined"),pd=t}function kL(){return F(pd,"Reference.ts has not been loaded"),pd}let SL=1;class iy{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Pe(null),this.pendingWriteTree_=tL(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function p0(t,e,n,s,i){return FD(t.pendingWriteTree_,e,n,s,i),i?io(t,new yr(l0(),e,n)):[]}function TL(t,e,n,s){zD(t.pendingWriteTree_,e,n,s);const i=Pe.fromObject(n);return io(t,new Da(l0(),e,i))}function oi(t,e,n=!1){const s=$D(t.pendingWriteTree_,e);if(KD(t.pendingWriteTree_,e)){let r=new Pe(null);return s.snap!=null?r=r.set(_e(),!0):Nt(s.children,a=>{r=r.set(new Re(a),!0)}),io(t,new cd(s.path,r,n))}else return[]}function oc(t,e,n){return io(t,new yr(c0(),e,n))}function AL(t,e,n){const s=Pe.fromObject(n);return io(t,new Da(c0(),e,s))}function RL(t,e){return io(t,new Rl(c0(),e))}function IL(t,e,n){const s=g0(t,n);if(s){const i=v0(s),r=i.path,a=i.queryId,o=Pt(r,e),c=new Rl(u0(a),o);return b0(t,r,c)}else return[]}function gd(t,e,n,s,i=!1){const r=e._path,a=t.syncPointTree_.get(r);let o=[];if(a&&(e._queryIdentifier==="default"||Xk(a,e))){const c=EL(a,e,n,s);_L(a)&&(t.syncPointTree_=t.syncPointTree_.remove(r));const u=c.removed;if(o=c.events,!i){const d=u.findIndex(h=>h._queryParams.loadsAllData())!==-1,f=t.syncPointTree_.findOnPath(r,(h,m)=>Ii(m));if(d&&!f){const h=t.syncPointTree_.subtree(r);if(!h.isEmpty()){const m=OL(h);for(let g=0;g<m.length;++g){const b=m[g],x=b.query,p=eS(t,b);t.listenProvider_.startListening(Jo(x),Il(t,x),p.hashFn,p.onComplete)}}}!f&&u.length>0&&!s&&(d?t.listenProvider_.stopListening(Jo(e),null):u.forEach(h=>{const m=t.queryToTagMap.get(af(h));t.listenProvider_.stopListening(Jo(h),m)}))}ML(t,u)}return o}function Qk(t,e,n,s){const i=g0(t,s);if(i!=null){const r=v0(i),a=r.path,o=r.queryId,c=Pt(a,e),u=new yr(u0(o),c,n);return b0(t,a,u)}else return[]}function CL(t,e,n,s){const i=g0(t,s);if(i){const r=v0(i),a=r.path,o=r.queryId,c=Pt(a,e),u=Pe.fromObject(n),d=new Da(u0(o),c,u);return b0(t,a,d)}else return[]}function Zm(t,e,n,s=!1){const i=e._path;let r=null,a=!1;t.syncPointTree_.foreachOnPath(i,(h,m)=>{const g=Pt(h,i);r=r||wi(m,g),a=a||Ii(m)});let o=t.syncPointTree_.get(i);o?(a=a||Ii(o),r=r||wi(o,_e())):(o=new Kk,t.syncPointTree_=t.syncPointTree_.set(i,o));let c;r!=null?c=!0:(c=!1,r=te.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((m,g)=>{const b=wi(g,_e());b&&(r=r.updateImmediateChild(m,b))}));const u=Xk(o,e);if(!u&&!e._queryParams.loadsAllData()){const h=af(e);F(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");const m=DL();t.queryToTagMap.set(h,m),t.tagToQueryMap.set(m,h)}const d=nf(t.pendingWriteTree_,i);let f=wL(o,e,n,d,r,c);if(!u&&!a&&!s){const h=Wk(o,e);f=f.concat(LL(t,e,h))}return f}function rf(t,e,n){const i=t.pendingWriteTree_,r=t.syncPointTree_.findOnPath(e,(a,o)=>{const c=Pt(a,e),u=wi(o,c);if(u)return u});return Hk(i,e,r,n,!0)}function jL(t,e){const n=e._path;let s=null;t.syncPointTree_.foreachOnPath(n,(u,d)=>{const f=Pt(u,n);s=s||wi(d,f)});let i=t.syncPointTree_.get(n);i?s=s||wi(i,_e()):(i=new Kk,t.syncPointTree_=t.syncPointTree_.set(n,i));const r=s!=null,a=r?new Ri(s,!0,!1):null,o=nf(t.pendingWriteTree_,e._path),c=Yk(i,e,o,r?a.getNode():te.EMPTY_NODE,r);return pL(c)}function io(t,e){return Jk(e,t.syncPointTree_,null,nf(t.pendingWriteTree_,_e()))}function Jk(t,e,n,s){if(fe(t.path))return Zk(t,e,n,s);{const i=e.get(_e());n==null&&i!=null&&(n=wi(i,_e()));let r=[];const a=ue(t.path),o=t.operationForChild(a),c=e.children.get(a);if(c&&o){const u=n?n.getImmediateChild(a):null,d=Gk(s,a);r=r.concat(Jk(o,c,u,d))}return i&&(r=r.concat(m0(i,t,s,n))),r}}function Zk(t,e,n,s){const i=e.get(_e());n==null&&i!=null&&(n=wi(i,_e()));let r=[];return e.children.inorderTraversal((a,o)=>{const c=n?n.getImmediateChild(a):null,u=Gk(s,a),d=t.operationForChild(a);d&&(r=r.concat(Zk(d,o,c,u)))}),i&&(r=r.concat(m0(i,t,s,n))),r}function eS(t,e){const n=e.query,s=Il(t,n);return{hashFn:()=>(mL(e)||te.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return s?IL(t,n._path,s):RL(t,n._path);{const r=AM(i,n);return gd(t,n,null,r)}}}}function Il(t,e){const n=af(e);return t.queryToTagMap.get(n)}function af(t){return t._path.toString()+"$"+t._queryIdentifier}function g0(t,e){return t.tagToQueryMap.get(e)}function v0(t){const e=t.indexOf("$");return F(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Re(t.substr(0,e))}}function b0(t,e,n){const s=t.syncPointTree_.get(e);F(s,"Missing sync point for query tag that we're tracking");const i=nf(t.pendingWriteTree_,e);return m0(s,n,i,null)}function OL(t){return t.fold((e,n,s)=>{if(n&&Ii(n))return[sf(n)];{let i=[];return n&&(i=qk(n)),Nt(s,(r,a)=>{i=i.concat(a)}),i}})}function Jo(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(kL())(t._repo,t._path):t}function ML(t,e){for(let n=0;n<e.length;++n){const s=e[n];if(!s._queryParams.loadsAllData()){const i=af(s),r=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(r)}}}function DL(){return SL++}function LL(t,e,n){const s=e._path,i=Il(t,e),r=eS(t,n),a=t.listenProvider_.startListening(Jo(e),i,r.hashFn,r.onComplete),o=t.syncPointTree_.subtree(s);if(i)F(!Ii(o.value),"If we're adding a query, it shouldn't be shadowed");else{const c=o.fold((u,d,f)=>{if(!fe(u)&&d&&Ii(d))return[sf(d).query];{let h=[];return d&&(h=h.concat(qk(d).map(m=>m.query))),Nt(f,(m,g)=>{h=h.concat(g)}),h}});for(let u=0;u<c.length;++u){const d=c[u];t.listenProvider_.stopListening(Jo(d),Il(t,d))}}return a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x0{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new x0(n)}node(){return this.node_}}class y0{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=Xe(this.path_,e);return new y0(this.syncTree_,n)}node(){return rf(this.syncTree_,this.path_)}}const PL=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},ry=function(t,e,n){if(!t||typeof t!="object")return t;if(F(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return BL(t[".sv"],e,n);if(typeof t[".sv"]=="object")return UL(t[".sv"],e);F(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},BL=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:F(!1,"Unexpected server value: "+t)}},UL=function(t,e,n){t.hasOwnProperty("increment")||F(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const s=t.increment;typeof s!="number"&&F(!1,"Unexpected increment value: "+s);const i=e.node();if(F(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return s;const a=i.getValue();return typeof a!="number"?s:a+s},tS=function(t,e,n,s){return w0(e,new y0(n,t),s)},_0=function(t,e,n){return w0(t,new x0(e),n)};function w0(t,e,n){const s=t.getPriority().val(),i=ry(s,e.getImmediateChild(".priority"),n);let r;if(t.isLeafNode()){const a=t,o=ry(a.getValue(),e,n);return o!==a.getValue()||i!==a.getPriority().val()?new gt(o,We(i)):t}else{const a=t;return r=a,i!==a.getPriority().val()&&(r=r.updatePriority(new gt(i))),a.forEachChild(Ye,(o,c)=>{const u=w0(c,e.getImmediateChild(o),n);u!==c&&(r=r.updateImmediateChild(o,u))}),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E0{constructor(e="",n=null,s={children:{},childCount:0}){this.name=e,this.parent=n,this.node=s}}function of(t,e){let n=e instanceof Re?e:new Re(e),s=t,i=ue(n);for(;i!==null;){const r=pr(s.node.children,i)||{children:{},childCount:0};s=new E0(i,s,r),n=Me(n),i=ue(n)}return s}function Cr(t){return t.node.value}function N0(t,e){t.node.value=e,ep(t)}function nS(t){return t.node.childCount>0}function HL(t){return Cr(t)===void 0&&!nS(t)}function lf(t,e){Nt(t.node.children,(n,s)=>{e(new E0(n,t,s))})}function sS(t,e,n,s){n&&e(t),lf(t,i=>{sS(i,e,!0)})}function GL(t,e,n){let s=t.parent;for(;s!==null;){if(e(s))return!0;s=s.parent}return!1}function lc(t){return new Re(t.parent===null?t.name:lc(t.parent)+"/"+t.name)}function ep(t){t.parent!==null&&VL(t.parent,t.name,t)}function VL(t,e,n){const s=HL(n),i=$n(t.node.children,e);s&&i?(delete t.node.children[e],t.node.childCount--,ep(t)):!s&&!i&&(t.node.children[e]=n.node,t.node.childCount++,ep(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FL=/[\[\].#$\/\u0000-\u001F\u007F]/,zL=/[\[\].#$\u0000-\u001F\u007F]/,xh=10*1024*1024,k0=function(t){return typeof t=="string"&&t.length!==0&&!FL.test(t)},iS=function(t){return typeof t=="string"&&t.length!==0&&!zL.test(t)},$L=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),iS(t)},S0=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Zd(t)||t&&typeof t=="object"&&$n(t,".sv")},vd=function(t,e,n,s){s&&e===void 0||cc(Ca(t,"value"),e,n)},cc=function(t,e,n){const s=n instanceof Re?new lD(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Wi(s));if(typeof e=="function")throw new Error(t+"contains a function "+Wi(s)+" with contents = "+e.toString());if(Zd(e))throw new Error(t+"contains "+e.toString()+" "+Wi(s));if(typeof e=="string"&&e.length>xh/3&&Wd(e)>xh)throw new Error(t+"contains a string greater than "+xh+" utf8 bytes "+Wi(s)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,r=!1;if(Nt(e,(a,o)=>{if(a===".value")i=!0;else if(a!==".priority"&&a!==".sv"&&(r=!0,!k0(a)))throw new Error(t+" contains an invalid key ("+a+") "+Wi(s)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);cD(s,a),cc(t,o,s),uD(s)}),i&&r)throw new Error(t+' contains ".value" child '+Wi(s)+" in addition to actual children.")}},KL=function(t,e){let n,s;for(n=0;n<e.length;n++){s=e[n];const r=kl(s);for(let a=0;a<r.length;a++)if(!(r[a]===".priority"&&a===r.length-1)){if(!k0(r[a]))throw new Error(t+"contains an invalid key ("+r[a]+") in path "+s.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(oD);let i=null;for(n=0;n<e.length;n++){if(s=e[n],i!==null&&Nn(i,s))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+s.toString());i=s}},rS=function(t,e,n,s){const i=Ca(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const r=[];Nt(e,(a,o)=>{const c=new Re(a);if(cc(i,o,Xe(n,c)),n0(c)===".priority"&&!S0(o))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");r.push(c)}),KL(i,r)},YL=function(t,e,n){if(Zd(e))throw new Error(Ca(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!S0(e))throw new Error(Ca(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},aS=function(t,e,n,s){if(!iS(n))throw new Error(Ca(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},qL=function(t,e,n,s){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),aS(t,e,n)},li=function(t,e){if(ue(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},WL=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!k0(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!$L(n))throw new Error(Ca(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XL{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function cf(t,e){let n=null;for(let s=0;s<e.length;s++){const i=e[s],r=i.getPath();n!==null&&!s0(r,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:r}),n.events.push(i)}n&&t.eventLists_.push(n)}function oS(t,e,n){cf(t,n),lS(t,s=>s0(s,e))}function hn(t,e,n){cf(t,n),lS(t,s=>Nn(s,e)||Nn(e,s))}function lS(t,e){t.recursionDepth_++;let n=!0;for(let s=0;s<t.eventLists_.length;s++){const i=t.eventLists_[s];if(i){const r=i.path;e(r)?(QL(t.eventLists_[s]),t.eventLists_[s]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function QL(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const s=n.getEventRunner();qo&&_t("event: "+n.toString()),no(s)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JL="repo_interrupt",ZL=25;class e4{constructor(e,n,s,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=s,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new XL,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=ld(),this.transactionQueueTree_=new E0,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function t4(t,e,n){if(t.stats_=e0(t.repoInfo_),t.forceRestClient_||jM())t.server_=new od(t.repoInfo_,(s,i,r,a)=>{ay(t,s,i,r,a)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>oy(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{mt(n)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}t.persistentConnection_=new ks(t.repoInfo_,e,(s,i,r,a)=>{ay(t,s,i,r,a)},s=>{oy(t,s)},s=>{n4(t,s)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(s=>{t.server_.refreshAuthToken(s)}),t.appCheckProvider_.addTokenChangeListener(s=>{t.server_.refreshAppCheckToken(s.token)}),t.statsReporter_=PM(t.repoInfo_,()=>new PD(t.stats_,t.server_)),t.infoData_=new jD,t.infoSyncTree_=new iy({startListening:(s,i,r,a)=>{let o=[];const c=t.infoData_.getNode(s._path);return c.isEmpty()||(o=oc(t.infoSyncTree_,s._path,c),setTimeout(()=>{a("ok")},0)),o},stopListening:()=>{}}),T0(t,"connected",!1),t.serverSyncTree_=new iy({startListening:(s,i,r,a)=>(t.server_.listen(s,r,i,(o,c)=>{const u=a(o,c);hn(t.eventQueue_,s._path,u)}),[]),stopListening:(s,i)=>{t.server_.unlisten(s,i)}})}function cS(t){const n=t.infoData_.getNode(new Re(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function uc(t){return PL({timestamp:cS(t)})}function ay(t,e,n,s,i){t.dataUpdateCount++;const r=new Re(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let a=[];if(i)if(s){const c=Xu(n,u=>We(u));a=CL(t.serverSyncTree_,r,c,i)}else{const c=We(n);a=Qk(t.serverSyncTree_,r,c,i)}else if(s){const c=Xu(n,u=>We(u));a=AL(t.serverSyncTree_,r,c)}else{const c=We(n);a=oc(t.serverSyncTree_,r,c)}let o=r;a.length>0&&(o=Pa(t,r)),hn(t.eventQueue_,o,a)}function oy(t,e){T0(t,"connected",e),e===!1&&a4(t)}function n4(t,e){Nt(e,(n,s)=>{T0(t,n,s)})}function T0(t,e,n){const s=new Re("/.info/"+e),i=We(n);t.infoData_.updateSnapshot(s,i);const r=oc(t.infoSyncTree_,s,i);hn(t.eventQueue_,s,r)}function uf(t){return t.nextWriteId_++}function s4(t,e,n){const s=jL(t.serverSyncTree_,e);return s!=null?Promise.resolve(s):t.server_.get(e).then(i=>{const r=We(i).withIndex(e._queryParams.getIndex());Zm(t.serverSyncTree_,e,n,!0);let a;if(e._queryParams.loadsAllData())a=oc(t.serverSyncTree_,e._path,r);else{const o=Il(t.serverSyncTree_,e);a=Qk(t.serverSyncTree_,e._path,r,o)}return hn(t.eventQueue_,e._path,a),gd(t.serverSyncTree_,e,n,null,!0),r},i=>(ro(t,"get for query "+mt(e)+" failed: "+i),Promise.reject(new Error(i))))}function i4(t,e,n,s,i){ro(t,"set",{path:e.toString(),value:n,priority:s});const r=uc(t),a=We(n,s),o=rf(t.serverSyncTree_,e),c=_0(a,o,r),u=uf(t),d=p0(t.serverSyncTree_,e,c,u,!0);cf(t.eventQueue_,d),t.server_.put(e.toString(),a.val(!0),(h,m)=>{const g=h==="ok";g||Ht("set at "+e+" failed: "+h);const b=oi(t.serverSyncTree_,u,!g);hn(t.eventQueue_,e,b),Ci(t,i,h,m)});const f=R0(t,e);Pa(t,f),hn(t.eventQueue_,f,[])}function r4(t,e,n,s){ro(t,"update",{path:e.toString(),value:n});let i=!0;const r=uc(t),a={};if(Nt(n,(o,c)=>{i=!1,a[o]=tS(Xe(e,o),We(c),t.serverSyncTree_,r)}),i)_t("update() called with empty data.  Don't do anything."),Ci(t,s,"ok",void 0);else{const o=uf(t),c=TL(t.serverSyncTree_,e,a,o);cf(t.eventQueue_,c),t.server_.merge(e.toString(),n,(u,d)=>{const f=u==="ok";f||Ht("update at "+e+" failed: "+u);const h=oi(t.serverSyncTree_,o,!f),m=h.length>0?Pa(t,e):e;hn(t.eventQueue_,m,h),Ci(t,s,u,d)}),Nt(n,u=>{const d=R0(t,Xe(e,u));Pa(t,d)}),hn(t.eventQueue_,e,[])}}function a4(t){ro(t,"onDisconnectEvents");const e=uc(t),n=ld();Ym(t.onDisconnect_,_e(),(i,r)=>{const a=tS(i,r,t.serverSyncTree_,e);so(n,i,a)});let s=[];Ym(n,_e(),(i,r)=>{s=s.concat(oc(t.serverSyncTree_,i,r));const a=R0(t,i);Pa(t,a)}),t.onDisconnect_=ld(),hn(t.eventQueue_,_e(),s)}function o4(t,e,n){t.server_.onDisconnectCancel(e.toString(),(s,i)=>{s==="ok"&&Km(t.onDisconnect_,e),Ci(t,n,s,i)})}function ly(t,e,n,s){const i=We(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(r,a)=>{r==="ok"&&so(t.onDisconnect_,e,i),Ci(t,s,r,a)})}function l4(t,e,n,s,i){const r=We(n,s);t.server_.onDisconnectPut(e.toString(),r.val(!0),(a,o)=>{a==="ok"&&so(t.onDisconnect_,e,r),Ci(t,i,a,o)})}function c4(t,e,n,s){if(Wu(n)){_t("onDisconnect().update() called with empty data.  Don't do anything."),Ci(t,s,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,r)=>{i==="ok"&&Nt(n,(a,o)=>{const c=We(o);so(t.onDisconnect_,Xe(e,a),c)}),Ci(t,s,i,r)})}function u4(t,e,n){let s;ue(e._path)===".info"?s=Zm(t.infoSyncTree_,e,n):s=Zm(t.serverSyncTree_,e,n),oS(t.eventQueue_,e._path,s)}function d4(t,e,n){let s;ue(e._path)===".info"?s=gd(t.infoSyncTree_,e,n):s=gd(t.serverSyncTree_,e,n),oS(t.eventQueue_,e._path,s)}function f4(t){t.persistentConnection_&&t.persistentConnection_.interrupt(JL)}function ro(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),_t(n,...e)}function Ci(t,e,n,s){e&&no(()=>{if(n==="ok")e(null);else{const i=(n||"error").toUpperCase();let r=i;s&&(r+=": "+s);const a=new Error(r);a.code=i,e(a)}})}function h4(t,e,n,s,i,r){ro(t,"transaction on "+e);const a={path:e,update:n,onComplete:s,status:null,order:ok(),applyLocally:r,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},o=A0(t,e,void 0);a.currentInputSnapshot=o;const c=a.update(o.val());if(c===void 0)a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete&&a.onComplete(null,!1,a.currentInputSnapshot);else{cc("transaction failed: Data returned ",c,a.path),a.status=0;const u=of(t.transactionQueueTree_,e),d=Cr(u)||[];d.push(a),N0(u,d);let f;typeof c=="object"&&c!==null&&$n(c,".priority")?(f=pr(c,".priority"),F(S0(f),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):f=(rf(t.serverSyncTree_,e)||te.EMPTY_NODE).getPriority().val();const h=uc(t),m=We(c,f),g=_0(m,o,h);a.currentOutputSnapshotRaw=m,a.currentOutputSnapshotResolved=g,a.currentWriteId=uf(t);const b=p0(t.serverSyncTree_,e,g,a.currentWriteId,a.applyLocally);hn(t.eventQueue_,e,b),df(t,t.transactionQueueTree_)}}function A0(t,e,n){return rf(t.serverSyncTree_,e,n)||te.EMPTY_NODE}function df(t,e=t.transactionQueueTree_){if(e||ff(t,e),Cr(e)){const n=dS(t,e);F(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&m4(t,lc(e),n)}else nS(e)&&lf(e,n=>{df(t,n)})}function m4(t,e,n){const s=n.map(u=>u.currentWriteId),i=A0(t,e,s);let r=i;const a=i.hash();for(let u=0;u<n.length;u++){const d=n[u];F(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;const f=Pt(e,d.path);r=r.updateChild(f,d.currentOutputSnapshotRaw)}const o=r.val(!0),c=e;t.server_.put(c.toString(),o,u=>{ro(t,"transaction put response",{path:c.toString(),status:u});let d=[];if(u==="ok"){const f=[];for(let h=0;h<n.length;h++)n[h].status=2,d=d.concat(oi(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&f.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();ff(t,of(t.transactionQueueTree_,e)),df(t,t.transactionQueueTree_),hn(t.eventQueue_,e,d);for(let h=0;h<f.length;h++)no(f[h])}else{if(u==="datastale")for(let f=0;f<n.length;f++)n[f].status===3?n[f].status=4:n[f].status=0;else{Ht("transaction at "+c.toString()+" failed: "+u);for(let f=0;f<n.length;f++)n[f].status=4,n[f].abortReason=u}Pa(t,e)}},a)}function Pa(t,e){const n=uS(t,e),s=lc(n),i=dS(t,n);return p4(t,i,s),s}function p4(t,e,n){if(e.length===0)return;const s=[];let i=[];const a=e.filter(o=>o.status===0).map(o=>o.currentWriteId);for(let o=0;o<e.length;o++){const c=e[o],u=Pt(n,c.path);let d=!1,f;if(F(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)d=!0,f=c.abortReason,i=i.concat(oi(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=ZL)d=!0,f="maxretry",i=i.concat(oi(t.serverSyncTree_,c.currentWriteId,!0));else{const h=A0(t,c.path,a);c.currentInputSnapshot=h;const m=e[o].update(h.val());if(m!==void 0){cc("transaction failed: Data returned ",m,c.path);let g=We(m);typeof m=="object"&&m!=null&&$n(m,".priority")||(g=g.updatePriority(h.getPriority()));const x=c.currentWriteId,p=uc(t),v=_0(g,h,p);c.currentOutputSnapshotRaw=g,c.currentOutputSnapshotResolved=v,c.currentWriteId=uf(t),a.splice(a.indexOf(x),1),i=i.concat(p0(t.serverSyncTree_,c.path,v,c.currentWriteId,c.applyLocally)),i=i.concat(oi(t.serverSyncTree_,x,!0))}else d=!0,f="nodata",i=i.concat(oi(t.serverSyncTree_,c.currentWriteId,!0))}hn(t.eventQueue_,n,i),i=[],d&&(e[o].status=2,function(h){setTimeout(h,Math.floor(0))}(e[o].unwatcher),e[o].onComplete&&(f==="nodata"?s.push(()=>e[o].onComplete(null,!1,e[o].currentInputSnapshot)):s.push(()=>e[o].onComplete(new Error(f),!1,null))))}ff(t,t.transactionQueueTree_);for(let o=0;o<s.length;o++)no(s[o]);df(t,t.transactionQueueTree_)}function uS(t,e){let n,s=t.transactionQueueTree_;for(n=ue(e);n!==null&&Cr(s)===void 0;)s=of(s,n),e=Me(e),n=ue(e);return s}function dS(t,e){const n=[];return fS(t,e,n),n.sort((s,i)=>s.order-i.order),n}function fS(t,e,n){const s=Cr(e);if(s)for(let i=0;i<s.length;i++)n.push(s[i]);lf(e,i=>{fS(t,i,n)})}function ff(t,e){const n=Cr(e);if(n){let s=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[s]=n[i],s++);n.length=s,N0(e,n.length>0?n:void 0)}lf(e,s=>{ff(t,s)})}function R0(t,e){const n=lc(uS(t,e)),s=of(t.transactionQueueTree_,e);return GL(s,i=>{yh(t,i)}),yh(t,s),sS(s,i=>{yh(t,i)}),n}function yh(t,e){const n=Cr(e);if(n){const s=[];let i=[],r=-1;for(let a=0;a<n.length;a++)n[a].status===3||(n[a].status===1?(F(r===a-1,"All SENT items should be at beginning of queue."),r=a,n[a].status=3,n[a].abortReason="set"):(F(n[a].status===0,"Unexpected transaction status in abort"),n[a].unwatcher(),i=i.concat(oi(t.serverSyncTree_,n[a].currentWriteId,!0)),n[a].onComplete&&s.push(n[a].onComplete.bind(null,new Error("set"),!1,null))));r===-1?N0(e,void 0):n.length=r+1,hn(t.eventQueue_,lc(e),i);for(let a=0;a<s.length;a++)no(s[a])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g4(t){let e="";const n=t.split("/");for(let s=0;s<n.length;s++)if(n[s].length>0){let i=n[s];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function v4(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const s=n.split("=");s.length===2?e[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):Ht(`Invalid query segment '${n}' in query '${t}'`)}return e}const cy=function(t,e){const n=b4(t),s=n.namespace;n.domain==="firebase.com"&&Ds(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!s||s==="undefined")&&n.domain!=="localhost"&&Ds("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||EM();const i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new yk(n.host,n.secure,s,i,e,"",s!==n.subdomain),path:new Re(n.pathString)}},b4=function(t){let e="",n="",s="",i="",r="",a=!0,o="https",c=443;if(typeof t=="string"){let u=t.indexOf("//");u>=0&&(o=t.substring(0,u-1),t=t.substring(u+2));let d=t.indexOf("/");d===-1&&(d=t.length);let f=t.indexOf("?");f===-1&&(f=t.length),e=t.substring(0,Math.min(d,f)),d<f&&(i=g4(t.substring(d,f)));const h=v4(t.substring(Math.min(t.length,f)));u=e.indexOf(":"),u>=0?(a=o==="https"||o==="wss",c=parseInt(e.substring(u+1),10)):u=e.length;const m=e.slice(0,u);if(m.toLowerCase()==="localhost")n="localhost";else if(m.split(".").length<=2)n=m;else{const g=e.indexOf(".");s=e.substring(0,g).toLowerCase(),n=e.substring(g+1),r=s}"ns"in h&&(r=h.ns)}return{host:e,port:c,domain:n,subdomain:s,secure:a,scheme:o,pathString:i,namespace:r}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uy="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",x4=function(){let t=0;const e=[];return function(n){const s=n===t;t=n;let i;const r=new Array(8);for(i=7;i>=0;i--)r[i]=uy.charAt(n%64),n=Math.floor(n/64);F(n===0,"Cannot push at time == 0");let a=r.join("");if(s){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)a+=uy.charAt(e[i]);return F(a.length===20,"nextPushId: Length should be 20."),a}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y4{constructor(e,n,s,i){this.eventType=e,this.eventRegistration=n,this.snapshot=s,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+mt(this.snapshot.exportVal())}}class _4{constructor(e,n,s){this.eventRegistration=e,this.error=n,this.path=s}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hS{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return F(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w4{constructor(e,n){this._repo=e,this._path=n}cancel(){const e=new Bn;return o4(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){li("OnDisconnect.remove",this._path);const e=new Bn;return ly(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){li("OnDisconnect.set",this._path),vd("OnDisconnect.set",e,this._path,!1);const n=new Bn;return ly(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){li("OnDisconnect.setWithPriority",this._path),vd("OnDisconnect.setWithPriority",e,this._path,!1),YL("OnDisconnect.setWithPriority",n);const s=new Bn;return l4(this._repo,this._path,e,n,s.wrapCallback(()=>{})),s.promise}update(e){li("OnDisconnect.update",this._path),rS("OnDisconnect.update",e,this._path);const n=new Bn;return c4(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hf{constructor(e,n,s,i){this._repo=e,this._path=n,this._queryParams=s,this._orderByCalled=i}get key(){return fe(this._path)?null:n0(this._path)}get ref(){return new as(this._repo,this._path)}get _queryIdentifier(){const e=qx(this._queryParams),n=Jg(e);return n==="{}"?"default":n}get _queryObject(){return qx(this._queryParams)}isEqual(e){if(e=dt(e),!(e instanceof hf))return!1;const n=this._repo===e._repo,s=s0(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&s&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+aD(this._path)}}class as extends hf{constructor(e,n){super(e,n,new o0,!1)}get parent(){const e=Rk(this._path);return e===null?null:new as(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class Ba{constructor(e,n,s){this._node=e,this.ref=n,this._index=s}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new Re(e),s=Cl(this.ref,e);return new Ba(this._node.getChild(n),s,Ye)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(s,i)=>e(new Ba(i,Cl(this.ref,s),Ye)))}hasChild(e){const n=new Re(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function D(t,e){return t=dt(t),t._checkNotDeleted("ref"),e!==void 0?Cl(t._root,e):t._root}function Cl(t,e){return t=dt(t),ue(t._path)===null?qL("child","path",e):aS("child","path",e),new as(t._repo,Xe(t._path,e))}function dy(t){return t=dt(t),new w4(t._repo,t._path)}function mS(t,e){t=dt(t),li("push",t._path),vd("push",e,t._path,!0);const n=cS(t._repo),s=x4(n),i=Cl(t,s),r=Cl(t,s);let a;return a=Promise.resolve(r),i.then=a.then.bind(a),i.catch=a.then.bind(a,void 0),i}function fy(t){return li("remove",t._path),Ua(t,null)}function Ua(t,e){t=dt(t),li("set",t._path),vd("set",e,t._path,!1);const n=new Bn;return i4(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function J(t,e){rS("update",e,t._path);const n=new Bn;return r4(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function xe(t){t=dt(t);const e=new hS(()=>{}),n=new mf(e);return s4(t._repo,t,n).then(s=>new Ba(s,new as(t._repo,t._path),t._queryParams.getIndex()))}class mf{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const s=n._queryParams.getIndex();return new y4("value",this,new Ba(e.snapshotNode,new as(n._repo,n._path),s))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new _4(this,e,n):null}matches(e){return e instanceof mf?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function E4(t,e,n,s,i){const r=new hS(n,void 0),a=new mf(r);return u4(t._repo,t,a),()=>d4(t._repo,t,a)}function Ke(t,e,n,s){return E4(t,"value",e)}class N4{}class k4 extends N4{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new hf(e._repo,e._path,CD(e._queryParams,this._limit),e._orderByCalled)}}function S4(t){if(Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new k4(t)}function T4(t,...e){let n=dt(t);for(const s of e)n=s._apply(n);return n}xL(as);NL(as);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A4="FIREBASE_DATABASE_EMULATOR_HOST",tp={};let R4=!1;function I4(t,e,n,s){const i=e.lastIndexOf(":"),r=e.substring(0,i),a=Za(r);t.repoInfo_=new yk(e,a,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0,n),s&&(t.authTokenProvider_=s)}function C4(t,e,n,s,i){let r=s||t.options.databaseURL;r===void 0&&(t.options.projectId||Ds("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),_t("Using default host for project ",t.options.projectId),r=`${t.options.projectId}-default-rtdb.firebaseio.com`);let a=cy(r,i),o=a.repoInfo,c;typeof process<"u"&&Ix&&(c=Ix[A4]),c?(r=`http://${c}?ns=${o.namespace}`,a=cy(r,i),o=a.repoInfo):a.repoInfo.secure;const u=new MM(t.name,t.options,e);WL("Invalid Firebase Database URL",a),fe(a.path)||Ds("Database URL must point to the root of a Firebase Database (not including a child path).");const d=O4(o,t,u,new OM(t,n));return new M4(d,t)}function j4(t,e){const n=tp[e];(!n||n[t.key]!==t)&&Ds(`Database ${e}(${t.repoInfo_}) has already been deleted.`),f4(t),delete n[t.key]}function O4(t,e,n,s){let i=tp[e.name];i||(i={},tp[e.name]=i);let r=i[t.toURLString()];return r&&Ds("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new e4(t,R4,n,s),i[t.toURLString()]=r,r}class M4{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(t4(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new as(this._repo,_e())),this._rootInternal}_delete(){return this._rootInternal!==null&&(j4(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Ds("Cannot call "+e+" on a deleted database.")}}function D4(t=yN(),e){const n=Vg(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const s=N2("database");s&&L4(n,...s)}return n}function L4(t,e,n,s={}){t=dt(t),t._checkNotDeleted("useEmulator");const i=`${e}:${n}`,r=t._repoInternal;if(t._instanceStarted){if(i===t._repoInternal.repoInfo_.host&&gr(s,r.repoInfo_.emulatorOptions))return;Ds("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let a;if(r.repoInfo_.nodeAdmin)s.mockUserToken&&Ds('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new hu(hu.OWNER);else if(s.mockUserToken){const o=typeof s.mockUserToken=="string"?s.mockUserToken:k2(s.mockUserToken,t.app.options.projectId);a=new hu(o)}Za(e)&&(hN(e),mN("Database",!0)),I4(r,i,s,a)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P4(t){bM(to),ja(new vr("database",(e,{instanceIdentifier:n})=>{const s=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),r=e.getProvider("app-check-internal");return C4(s,i,r,n)},"PUBLIC").setMultipleInstances(!0)),yi(Cx,jx,t),yi(Cx,jx,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B4={".sv":"timestamp"};function U4(){return B4}function pS(t){return{".sv":{increment:t}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H4{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function Ae(t,e,n){var s;if(t=dt(t),li("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";const i=(s=void 0)!==null&&s!==void 0?s:!0,r=new Bn,a=(c,u,d)=>{let f=null;c?r.reject(c):(f=new Ba(d,new as(t._repo,t._path),Ye),r.resolve(new H4(u,f)))},o=Ke(t,()=>{});return h4(t._repo,t._path,e,a,o,i),r.promise}ks.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};ks.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};P4();var G4="firebase",V4="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */yi(G4,V4,"app");const F4={apiKey:"AIzaSyBU11CvtAaUkADomFxcMuN6fH9ipx-VtAs",authDomain:"eiriksbok-simuleringfeudal.firebaseapp.com",databaseURL:"https://eiriksbok-simuleringfeudal-default-rtdb.europe-west1.firebasedatabase.app",projectId:"eiriksbok-simuleringfeudal",storageBucket:"eiriksbok-simuleringfeudal.firebasestorage.app",messagingSenderId:"772081963542",appId:"1:772081963542:web:05edb87535f629fd36db37",measurementId:"G-NDR8LNVQNX"},gS=xN(F4,"simulationApp"),L=D4(gS),Dr=gM(gS),vS=_.createContext(void 0),z4=({children:t})=>{const[e,n]=_.useState(null),[s,i]=_.useState(null),[r,a]=_.useState(!0),[o,c]=_.useState(null),[u,d]=_.useState(!0);_.useEffect(()=>{const x=iO(Dr,async p=>{if(p){n(p),d(p.isAnonymous);const v=D(L,`simulation_accounts/${p.uid}`),y=Ke(v,async E=>{if(E.exists())i(E.val()),a(!1);else{const N={uid:p.uid,displayName:p.displayName||`Eventyrer_${p.uid.slice(0,4)}`,globalXp:0,globalLevel:1,totalGoldEarned:0,unlockedAchievements:[],characterHistory:[],lastActive:Date.now()};await Ua(v,N),i(N),a(!1)}});return()=>y()}else{d(!0);try{await Y5(Dr)}catch(v){console.error("Auth failed:",v),a(!1)}}});return()=>x()},[]);const f=async(x,p)=>{c(null);try{await tO(Dr,x,p)}catch(v){throw c(v.message),v}},h=async x=>{const p=x.trim().toLowerCase();if(!p||p.length<3)return!1;const v=D(L,`simulation_reserved_names/${p}`);return!(await xe(v)).exists()},m=async(x,p,v)=>{c(null);const y=v.trim(),E=y.toLowerCase();try{if(!await h(y))throw new Error("Navnet er allerede tatt.");if(e&&e.isAnonymous){const T=Ar.credential(x,p);await J5(e,T);const w={};w[`simulation_accounts/${e.uid}/displayName`]=y,w[`simulation_reserved_names/${E}`]=e.uid,await J(D(L),w)}else{const T=await eO(Dr,x,p),w={};w[`simulation_reserved_names/${E}`]=T.user.uid;const A={uid:T.user.uid,displayName:y,globalXp:0,globalLevel:1,totalGoldEarned:0,unlockedAchievements:[],characterHistory:[],lastActive:Date.now()};w[`simulation_accounts/${T.user.uid}`]=A,await J(D(L),w)}}catch(N){throw c(N.message),N}},g=async()=>{await rO(Dr)},b=async x=>{try{await Z5(Dr,x)}catch(p){throw c(p.message),p}};return l.jsx(vS.Provider,{value:{user:e,account:s,loading:r,isAnonymous:u,error:o,login:f,register:m,logout:g,resetPassword:b,checkNameAvailability:h},children:t})},pf=()=>{const t=_.useContext(vS);if(!t)throw new Error("useSimulationAuth must be used within a SimulationAuthProvider");return t},bS=[{id:"Ashes of the Keep.mp3",title:"Festningens Aske",mood:"Dark"},{id:"Banner at the Old Stone Keep.mp3",title:"Gamle Steiner",mood:"Epic"},{id:"Banner at the Old Stone Keep (1).mp3",title:"Steinhallens Hymne",mood:"Epic"},{id:"Burning Banners Over Stone.mp3",title:"Brennende Bannere",mood:"Dark"},{id:"Candlelit Keep.mp3",title:"Lys i Hallen",mood:"Calm"},{id:"Candlelit Keep (1).mp3",title:"Nattens Vakt",mood:"Calm"},{id:"Crown of Quiet Rooms.mp3",title:"Stillhetens Krone",mood:"Mysterious"},{id:"Crown of Quiet Rooms (1).mp3",title:"Kongens Tvil",mood:"Mysterious"}],Qi=class Qi{constructor(){ze(this,"sfxVolume",.5);ze(this,"musicVolume",.3);ze(this,"currentMusic",null);ze(this,"currentMusicKey",null);ze(this,"playlist",[]);ze(this,"playlistIndex",0);ze(this,"isPlaylistActive",!1);ze(this,"ignoredTracks",new Set);ze(this,"audioContext",null);ze(this,"filterNode",null);ze(this,"isMuffledState",!1);ze(this,"activeFades",new Map);const e=localStorage.getItem("sim_sfx_volume"),n=localStorage.getItem("sim_music_volume"),s=localStorage.getItem("sim_music_muffled"),i=localStorage.getItem("sim_music_ignored");if(e&&(this.sfxVolume=parseFloat(e)),n&&(this.musicVolume=parseFloat(n)),s&&(this.isMuffledState=s==="true"),i)try{this.ignoredTracks=new Set(JSON.parse(i))}catch(r){console.error("Failed to parse ignored tracks",r)}this.playlist=bS.map(r=>r.id),this.shufflePlaylist()}shufflePlaylist(){this.playlist=this.playlist.sort(()=>Math.random()-.5)}initAudioContext(){if(!this.audioContext)try{this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.filterNode=this.audioContext.createBiquadFilter(),this.filterNode.type="lowpass",this.filterNode.frequency.setValueAtTime(this.isMuffledState?12e3:2e4,this.audioContext.currentTime),this.filterNode.connect(this.audioContext.destination)}catch(e){console.error("Failed to initialize AudioContext",e)}this.audioContext&&this.audioContext.state==="suspended"&&this.audioContext.resume()}static getInstance(){return Qi.instance||(Qi.instance=new Qi),Qi.instance}setSfxVolume(e){this.sfxVolume=Math.max(0,Math.min(1,e)),localStorage.setItem("sim_sfx_volume",this.sfxVolume.toString())}setMusicVolume(e){this.musicVolume=Math.max(0,Math.min(1,e)),localStorage.setItem("sim_music_volume",this.musicVolume.toString()),this.currentMusic&&(this.currentMusic.volume=this.musicVolume)}setMuffled(e){this.isMuffledState=e,localStorage.setItem("sim_music_muffled",e.toString()),this.filterNode&&this.audioContext&&this.filterNode.frequency.setTargetAtTime(e?15e3:2e4,this.audioContext.currentTime,.1)}toggleIgnoreTrack(e){this.ignoredTracks.has(e)?this.ignoredTracks.delete(e):this.ignoredTracks.add(e),localStorage.setItem("sim_music_ignored",JSON.stringify(Array.from(this.ignoredTracks))),this.ignoredTracks.has(e)&&this.currentMusicKey===e&&this.isPlaylistActive&&this.playNextInPlaylist()}isIgnored(e){return this.ignoredTracks.has(e)}getSfxVolume(){return this.sfxVolume}getMusicVolume(){return this.musicVolume}isMuffled(){return this.isMuffledState}getCurrentTrackId(){return this.currentMusicKey}playSfx(e){if(this.sfxVolume===0)return;const s=`/sounds/sfx/${e.includes(".")?e:`${e}.mp3`}`,i=new Audio(s);i.volume=this.sfxVolume,i.play().catch(()=>{})}startPlaylist(){this.isPlaylistActive&&this.currentMusic||(this.isPlaylistActive=!0,this.currentMusic||this.playNextInPlaylist())}playNextInPlaylist(){if(!this.isPlaylistActive)return;let e=0,n=!1;for(;e<this.playlist.length;){this.playlistIndex=(this.playlistIndex+1)%this.playlist.length;const s=this.playlist[this.playlistIndex];if(!this.ignoredTracks.has(s)){this.playMusic(s,2e3,!1),n=!0;break}e++}n||(console.warn("All tracks are ignored! Playing fallback."),this.playMusic(this.playlist[0],2e3,!1))}playPreviousInPlaylist(){if(!this.isPlaylistActive)return;let e=0,n=!1;for(;e<this.playlist.length;){this.playlistIndex=(this.playlistIndex-1+this.playlist.length)%this.playlist.length;const s=this.playlist[this.playlistIndex];if(!this.ignoredTracks.has(s)){this.playMusic(s,2e3,!1),n=!0;break}e++}n||this.playMusic(this.playlist[0],2e3,!1)}async resume(){this.audioContext||this.initAudioContext(),this.audioContext&&this.audioContext.state==="suspended"&&await this.audioContext.resume()}playMusic(e,n=1e3,s=!0){if(s&&(this.isPlaylistActive=!1),this.currentMusicKey===e&&this.currentMusic&&!this.currentMusic.paused){this.fadeIn(this.currentMusic,this.musicVolume,500);return}const r=`/sounds/music/${e.includes(".")?e:`${e}.mp3`}`,a=new Audio(r);if(a.loop=!this.isPlaylistActive,a.volume=0,this.initAudioContext(),this.audioContext&&this.filterNode)try{this.audioContext.createMediaElementSource(a).connect(this.filterNode)}catch(o){console.warn("Could not route through Web Audio API",o)}this.isPlaylistActive&&(a.onended=()=>{this.playNextInPlaylist()}),this.currentMusic&&this.fadeOut(this.currentMusic,n),this.currentMusic=a,this.currentMusicKey=e,a.play().then(()=>{this.fadeIn(a,this.musicVolume,n),this.audioContext&&this.audioContext.state==="suspended"&&this.audioContext.resume()}).catch(o=>{console.warn(`Failed to play music: ${e}`,o),this.currentMusic===a&&(this.currentMusic=null,this.currentMusicKey=null),this.isPlaylistActive&&setTimeout(()=>this.playNextInPlaylist(),2e3)})}stopMusic(e=1e3){this.isPlaylistActive=!1,this.currentMusic&&(this.fadeOut(this.currentMusic,e),this.currentMusic=null,this.currentMusicKey=null)}fadeOut(e,n){this.activeFades.has(e)&&clearInterval(this.activeFades.get(e));const s=e.volume,i=20,r=n/i,a=s/i;let o=0;const c=setInterval(()=>{o++;const u=Math.max(0,s-a*o);e.volume=u,u<=0&&(e.pause(),e.src="",clearInterval(c),this.activeFades.delete(e))},r);this.activeFades.set(e,c)}fadeIn(e,n,s){this.activeFades.has(e)&&(clearInterval(this.activeFades.get(e)),this.activeFades.delete(e));const i=20,r=s/i,a=n/i;let o=0;const c=setInterval(()=>{o++;const u=Math.min(n,a*o);e.volume=u,(u>=n||e.paused)&&clearInterval(c)},r)}};ze(Qi,"instance");let np=Qi;const it=np.getInstance(),xS=_.createContext(void 0),$4=({children:t})=>{const[e,n]=_.useState(it.getSfxVolume()),[s,i]=_.useState(it.getMusicVolume()),[r,a]=_.useState(it.isMuffled()),[o,c]=_.useState(it.getCurrentTrackId()),[u,d]=_.useState(0);_.useEffect(()=>{const w=setInterval(()=>{const A=it.getCurrentTrackId();A!==o&&c(A)},1e3);return()=>clearInterval(w)},[o]);const f=_.useCallback(w=>{it.setSfxVolume(w),n(w)},[]),h=_.useCallback(w=>{it.setMusicVolume(w),i(w)},[]),m=_.useCallback(w=>{it.setMuffled(w),a(w)},[]),g=_.useCallback(w=>{it.playSfx(w)},[]),b=_.useCallback(w=>{it.playMusic(w),c(w)},[]),x=_.useCallback(()=>{it.stopMusic(),c(null)},[]),p=_.useCallback(()=>{it.startPlaylist(),c(it.getCurrentTrackId())},[]),v=_.useCallback(()=>{it.playNextInPlaylist(),c(it.getCurrentTrackId())},[]),y=_.useCallback(()=>{it.playPreviousInPlaylist(),c(it.getCurrentTrackId())},[]),E=_.useCallback(w=>{it.toggleIgnoreTrack(w),d(A=>A+1)},[]),N=_.useCallback(w=>it.isIgnored(w),[u]),T=_.useCallback(()=>{it.resume()},[]);return l.jsx(xS.Provider,{value:{playSfx:g,playMusic:b,startPlaylist:p,stopMusic:x,playNext:v,playPrevious:y,toggleIgnoreTrack:E,isIgnored:N,currentTrackId:o,playlist:bS,sfxVolume:e,setSfxVolume:f,musicVolume:s,setMusicVolume:h,isMuffled:r,setMuffled:m,resume:T},children:t})},I0=()=>{const t=_.useContext(xS);if(!t)throw new Error("useAudio must be used within a SimulationAudioProvider");return t},yS=_.createContext(void 0),K4=({children:t})=>{const{pin:e,tab:n}=eN(),s=C=>{if(!C)return"MAP";const B=C.toUpperCase();return B==="ACTIVITY"||B==="LOG"?"ACTIVITY":B},i=C=>C.toLowerCase(),[r,a]=_.useState(()=>s(n)),[o,c]=_.useState("global"),[u,d]=_.useState(null),[f,h]=_.useState(!1),[m,g]=_.useState(!1),[b,x]=_.useState(null),[p,v]=_.useState(null),[y,E]=_.useState(null),[N,T]=_.useState(null),[w,A]=_.useState(null),k=C=>{a(C);const B=i(C),z=`/sim/play/${e}/${B}`;window.history.replaceState({...window.history.state,idx:window.history.length},"",z)},R=C=>{h(C),C?k("MARKET"):r==="MARKET"&&k("MAP")};return l.jsx(yS.Provider,{value:{activeTab:r,setActiveTab:k,viewMode:o,setViewMode:c,viewingRegionId:u,setViewingRegionId:d,isMarketOpen:f,setMarketOpen:R,isMusicWindowOpen:m,setMusicWindowOpen:g,activeMinigame:b,setActiveMinigame:x,activeMinigameMethod:p,setActiveMinigameMethod:v,activeMinigameAction:y,setActiveMinigameAction:E,actionLoading:N,setActionLoading:T,productionContext:w,setProductionContext:A},children:t})},gf=()=>{const t=_.useContext(yS);if(!t)throw new Error("useSimulation must be used within a SimulationProvider");return t},Y4="modulepreload",q4=function(t){return"/Simulation_StandAlone_Pro/"+t},hy={},Gt=function(e,n,s){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(n.map(c=>{if(c=q4(c),c in hy)return;hy[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":Y4,u||(f.as="script"),f.crossOrigin="",f.href=c,o&&f.setAttribute("nonce",o),document.head.appendChild(f),u)return new Promise((h,m)=>{f.addEventListener("load",h),f.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&r(o.reason);return e().catch(r)})},q={MARKET:{SELL_RATIO:.8,PRICE_IMPACT_BUY:.005,PRICE_IMPACT_SELL:.005,MIN_PRICE_MULTIPLIER:.2,MAX_PRICE_MULTIPLIER:5,VISCOSITY:100},CONTRIBUTION_VALUES:{gold:1,wood:.5,stone:1,iron_ore:1,iron_ingot:5,plank:2,grain:.1,flour:.5,bread:1,meat:1,honey:1,cloth:1,wool:.5,default:.1},CAREERS:{SOLDIER:{COST:200,LEVEL_REQ:3},MERCHANT:{COST:500,LEVEL_REQ:3}},TAX:{PEASANT_RATE_DEFAULT:.15,PEASANT_RATE_CUT:.07,ROYAL_RATE:.2,LOYALTY_PENALTY_PEASANT:10,LOYALTY_PENALTY_BARON:5},GATHERING:{NO_TOOL_PENALTY:.75},YIELD:{WORK_GRAIN:12,CHOP_WOOD:8,MINE_ORE:6,QUARRY_STONE:10,FORAGE_BREAD:1,PLOW_BONUS:5,SUMMER_WOOD_BONUS:3},DURABILITY:{MAX:100,LOSS_WORK:5,LOSS_COMBAT_WEAPON:10,LOSS_COMBAT_ARMOR:15,REPAIR_AMOUNT:30},MINIGAME:{BASE_MULTIPLIER:.5,PERFORMANCE_WEIGHT:1,CRAFTING_WEIGHT:1.5,THRESHOLD_GREAT:.8},RELIGION:{PRAY_MIN:1,PRAY_MAX:5,XP_PRAY:2},COMBAT:{RAID_LOOT_FACTOR:.4,DEFEND_GOLD_BASE:20,XP_WIN:20,XP_LOSS:0},LUCKY_DROP:{CHANCE:.05,MULTIPLIER:2},PASSIVE_INCOME:{COW:2,ACCOUNTING_BOOKS:5,CARAVAN:10},SKILLS:{GATHERING_BONUS:.1,REFINING_BONUS:.1,CRAFTING_XP:25,REFINING_XP:10},COUP:{BASE_BRIBE_COST:500,HONEYMOON_DURATION:6e5,VACANCY_DURATION:3e5,RESTORE_ORDER_COST:600,LEGITIMACY_SHIELD_MULT:2,KING_VOTE_WEIGHT:15,PEASANT_VOTE_WEIGHT:1}},dc={WORK:{xp:5},CHOP:{xp:5},FORAGE:{xp:2}},bd=[0,100,300,700,1500,3e3,6e3],An={Spring:{label:"Vr",yieldMod:1,staminaMod:1,color:"#4ade80"},Summer:{label:"Sommer",yieldMod:1.2,staminaMod:1,color:"#fbbf24"},Autumn:{label:"Hst",yieldMod:1.5,staminaMod:1,color:"#f97316"},Winter:{label:"Vinter",yieldMod:.2,staminaMod:1.5,color:"#38bdf8"}},_s={Clear:{label:"Klart Vr",desc:"Ideelle forhold for alt arbeid.",mod:1,icon:"",speedMod:1,staminaMod:1},Rain:{label:"Regn",desc:"Glatte forhold. Minispill gr litt fortere.",mod:.9,icon:"",speedMod:1.2,staminaMod:1},Storm:{label:"Storm",desc:"Farlig vr. Hy stamina-kostnad og lavt utbytte!",mod:.5,icon:"",speedMod:1.5,staminaMod:2},Fog:{label:"Tke",desc:"Drlig sikt. Vanskeligere  treffe blinker.",mod:.8,icon:"",speedMod:.8,staminaMod:1}},fc={WORK:{bread:1,stamina:10},CHOP:{bread:1,stamina:15},FORAGE:{stamina:40},MINE:{bread:1,stamina:25},RAID:{bread:3,stamina:40},TAX:{stamina:20},TAX_PEASANTS:{stamina:25},TAX_ROYAL:{stamina:30},MILL:{grain:10,stamina:20},SMELT:{iron_ore:5,wood:2,stamina:15},SAWMILL:{wood:5,stamina:15},BAKERY:{flour:5,stamina:10},REFINE:{stamina:15},CRAFT:{stamina:30},QUARRY:{bread:1,stamina:20},REPAIR:{stamina:15},HUNT:{stamina:30},GATHER_WOOL:{stamina:15},GATHER_HONEY:{stamina:20},PRAY:{stamina:15},FEAST:{bread:30,gold:100,stamina:10},CONTRIBUTE:{stamina:10},CONSTRUCT:{stamina:20},SLEEP:{stamina:0},EAT:{bread:1,stamina:0},PLANT:{grain:5,stamina:25},HARVEST:{stamina:15},BAKE:{stamina:10},WEAVE:{stamina:15},MIX:{stamina:15},DEFEND:{stamina:30},EXPLORE:{stamina:25},PATROL:{stamina:10},MAINTAIN_CROP:{stamina:5}},sp={great_forge:{material:"iron_ingot",goldCost:20,staminaCost:15,slots:["MAIN_HAND","OFF_HAND","HEAD","BODY","FEET","AXE","PICKAXE","SCYTHE","HAMMER","BOW","TRAP"]},weavery:{material:"cloth",goldCost:10,staminaCost:10,slots:["BODY","FEET","HEAD"]},sawmill:{material:"plank",goldCost:5,staminaCost:10,slots:["OFF_HAND","MAIN_HAND"]}},xd={GOLD:"",GRAIN:"",WOOD:"",IRON_ORE:"",STONE:"",PLANK:"",IRON_INGOT:"",BREAD:"",SWORDS:"",ARMOR:"",CLOTH:"",WOOL:"",MEAT:"",HONEY:"",GLASS:"",FLOUR:"",EGG:"",OMELETTE:"",MANPOWER:"",FAVOR:""},mn={gold:{label:"Gull",icon:""},grain:{label:"Korn",icon:""},flour:{label:"Mel",icon:""},bread:{label:"Brd",icon:""},wood:{label:"Ved",icon:""},plank:{label:"Planker",icon:""},iron_ore:{label:"Jernmalm",icon:""},iron_ingot:{label:"Jernbarre",icon:""},stone:{label:"Stein",icon:""},swords:{label:"Beleiringsvpen",icon:""},armor:{label:"Beleiringsrustning",icon:""},favor:{label:"Gunst",icon:""},honey:{label:"Honning",icon:""},meat:{label:"Kjtt",icon:""},wool:{label:"Ull",icon:""},cloth:{label:"Stoff",icon:""},glass:{label:"Glass",icon:""},egg:{label:"Egg",icon:""},omelette:{label:"Omelett",icon:""}},Rt={KING:{gold:1e3,grain:500,flour:200,bread:50,wood:200,plank:50,iron_ore:0,iron_ingot:20,stone:100,swords:50,armor:20,favor:0,wool:50,cloth:20,honey:0,meat:0,glass:0,manpower:0,egg:0,omelette:0},BARON:{gold:300,grain:100,flour:50,bread:20,wood:50,plank:20,iron_ore:0,iron_ingot:10,stone:20,swords:10,armor:10,favor:0,wool:20,cloth:5,honey:0,meat:0,glass:0,manpower:0,egg:0,omelette:0},PEASANT:{gold:20,grain:30,flour:5,bread:10,wood:0,plank:0,iron_ore:0,iron_ingot:0,stone:0,swords:0,armor:0,favor:0,wool:10,cloth:0,honey:0,meat:0,glass:0,manpower:0,egg:0,omelette:0},SOLDIER:{gold:50,grain:10,flour:10,bread:10,wood:0,plank:0,iron_ore:0,iron_ingot:0,stone:0,swords:5,armor:2,favor:0,wool:0,cloth:0,honey:0,meat:0,glass:0,manpower:0,egg:0,omelette:0},MERCHANT:{gold:500,grain:50,flour:50,bread:20,wood:50,plank:20,iron_ore:0,iron_ingot:5,stone:50,swords:5,armor:2,favor:0,wool:20,cloth:10,honey:0,meat:0,glass:0,manpower:0,egg:0,omelette:0}},C0={PEASANT:[{id:"iron_plow",name:"Jernplog",description:"ker kornhst med +5.",cost:{gold:50,wood:10},benefit:"YIELD_GRAIN"},{id:"fence",name:"Solid Gjerde",description:"Beskytter mot smtyveri.",cost:{wood:50},benefit:"DEFENSE_REGION"},{id:"cow",name:"Melkeku",description:"Gir passivt 2 gull per minutt (simulert via actions).",cost:{gold:80},benefit:"PASSIVE_GOLD"},{id:"roof",name:"Tett Tak",description:"Bedre hvile. Mer utholdenhet.",cost:{wood:20,gold:10},benefit:"STAMINA_REGEN"}],BARON:[{id:"stone_keep",name:"Steintrn",description:"Gjr raiding av deg mye vanskeligere.",cost:{gold:200,wood:100},benefit:"FORTRESS"},{id:"armory",name:"Vpenkammer",description:"Dobbelt s effektiv rekruttering.",cost:{gold:150},benefit:"DRAFT_BONUS"},{id:"stables",name:"Staller",description:"Raskere raids.",cost:{gold:100,wood:50},benefit:"RAID_SPEED"}],KING:[{id:"cathedral",name:"Katedral",description:"ker din legitimitet og skattevilje.",cost:{gold:500,stone:200},benefit:"ROYAL_AUTHORITY"},{id:"royal_guard",name:"Kongelig Garde",description:"Uovervinnelig defensiv styrke.",cost:{gold:400,iron:100},benefit:"ELITE_DEFENSE"}],SOLDIER:[{id:"knight_armor",name:"Ridderrustning",description:"Du tar mindre skade og ser tffere ut.",cost:{gold:100,swords:5},benefit:"ARMOR"},{id:"warhorse",name:"Stridshest",description:"Gjr deg til en Ridder. 2x XP fra kamp.",cost:{gold:200,grain:100},benefit:"KNIGHT"}],MERCHANT:[{id:"trade_license",name:"Handelsbrev",description:"Bedre salgspriser p markedet.",cost:{gold:150},benefit:"MARKET_BONUS"},{id:"accounting_books",name:"Regnskapsbker",description:"Gir passivt 5 gull per minutt.",cost:{gold:200,wood:20},benefit:"PASSIVE_GOLD_HIGH"},{id:"caravan",name:"Karavane",description:"Tjen penger p handel med utlandet.",cost:{gold:300,wood:50},benefit:"CARAVAN"}]},jn={PEASANT:{FARMING:{level:1,xp:0,maxXp:100},WOODCUTTING:{level:1,xp:0,maxXp:100},MINING:{level:0,xp:0,maxXp:100},CRAFTING:{level:0,xp:0,maxXp:100},STEWARDSHIP:{level:0,xp:0,maxXp:100},COMBAT:{level:0,xp:0,maxXp:100},TRADING:{level:0,xp:0,maxXp:100},THEOLOGY:{level:0,xp:0,maxXp:100}},BARON:{FARMING:{level:3,xp:0,maxXp:300},WOODCUTTING:{level:3,xp:0,maxXp:300},MINING:{level:1,xp:0,maxXp:100},CRAFTING:{level:1,xp:0,maxXp:100},STEWARDSHIP:{level:5,xp:0,maxXp:1e3},COMBAT:{level:3,xp:0,maxXp:300},TRADING:{level:3,xp:0,maxXp:300},THEOLOGY:{level:1,xp:0,maxXp:100}},KING:{FARMING:{level:1,xp:0,maxXp:100},WOODCUTTING:{level:1,xp:0,maxXp:100},MINING:{level:1,xp:0,maxXp:100},CRAFTING:{level:1,xp:0,maxXp:100},STEWARDSHIP:{level:10,xp:0,maxXp:5e3},COMBAT:{level:5,xp:0,maxXp:1500},TRADING:{level:5,xp:0,maxXp:1500},THEOLOGY:{level:5,xp:0,maxXp:1500}},SOLDIER:{FARMING:{level:1,xp:0,maxXp:100},WOODCUTTING:{level:1,xp:0,maxXp:100},MINING:{level:0,xp:0,maxXp:100},CRAFTING:{level:1,xp:0,maxXp:100},STEWARDSHIP:{level:0,xp:0,maxXp:100},COMBAT:{level:5,xp:0,maxXp:1500},TRADING:{level:0,xp:0,maxXp:100},THEOLOGY:{level:0,xp:0,maxXp:100}},MERCHANT:{FARMING:{level:1,xp:0,maxXp:100},WOODCUTTING:{level:1,xp:0,maxXp:100},MINING:{level:0,xp:0,maxXp:100},CRAFTING:{level:2,xp:0,maxXp:200},STEWARDSHIP:{level:1,xp:0,maxXp:100},COMBAT:{level:0,xp:0,maxXp:100},TRADING:{level:5,xp:0,maxXp:1500},THEOLOGY:{level:0,xp:0,maxXp:100}}},W4={FARMING:{label:"Jordbruk",description:"Dyrking av mark, hsting av avlinger og husdyrhold.",color:"#10b981",bonuses:{2:"10% raskere hsting.",5:"Avlinger gir 20% mer utbytte.",10:"Mesterbonde: Lser opp avanserte avlinger."}},WOODCUTTING:{label:"Vedhogging",description:"Kunsten  felle trr og bearbeide tmmer.",color:"#8b5cf6",bonuses:{3:"15% raskere tmmerhogst.",7:"Sjanse for  finne sjelden kvae.",12:"Skovens vokter: kt utbytte fra alle trr."}},MINING:{label:"Gruvedrift",description:"Uthenting av malm og edle metaller fra fjellet.",color:"#f59e0b",bonuses:{4:"Bedre verktyeffektivitet i gruver.",8:"Lser opp utvinning av edelstener.",15:"Fjellkonge: Maksimalt utbytte fra dype rer."}},CRAFTING:{label:"Hndverk",description:"Smiing, snekring og tilvirking av avansert utstyr.",color:"#3b82f6",bonuses:{2:"Mindre materialsvinn ved refining.",5:"Bedre sjanse for hyere kvalitet.",10:"Stormester: Kan smie legendarisk utstyr."}},STEWARDSHIP:{label:"Godsforvaltning",description:"Administrasjon av land, folk og ressurser.",color:"#ec4899",bonuses:{5:"Redusert skattetrykk fra overordnede.",10:"kt passiv inntekt fra oppgraderinger.",20:"Rikets forvalter: Maksimal konomisk innsikt."}},COMBAT:{label:"Kamp",description:"Ferdighet i sverd, bue og forsvar av riket.",color:"#ef4444",bonuses:{3:"kt angrepskraft (+10%).",6:"Bedre forsvarsevne i beleiringer.",12:"Krigsherre: Fryktinngytende p slagmarken."}},TRADING:{label:"Handel",description:"Kjp, salg og markedsspekulering.",color:"#facc15",bonuses:{2:"Lavere gebyrer p markedet.",5:"Bedre priser ved handel med NPCs.",10:"Handelsfyrste: Kontroll over handelsruter."}},THEOLOGY:{label:"Teologi",description:"Tro, bnn og forstelse av det guddommelige.",color:"#6366f1",bonuses:{5:"Bnner gir mer stamina.",10:"Guddommelig beskyttelse mot ulykker.",15:"Helgen: Utstrler en aura av ro og verdighet."}}},ip={PEASANT:{},BARON:{MAIN_HAND:{id:"iron_sword",name:"Jernsverd",icon:"",type:"MAIN_HAND",durability:100,maxDurability:100,level:5,stats:{attack:10}},BODY:{id:"fine_clothes",name:"Fie Klr",icon:"",type:"BODY",durability:50,maxDurability:50,level:5,stats:{defense:2,speedBonus:1.1}}},KING:{MAIN_HAND:{id:"royal_scepter",name:"Kongens Septer",icon:"",type:"MAIN_HAND",durability:200,maxDurability:200,level:10,stats:{luckBonus:.2}},HEAD:{id:"crown",name:"Krone",icon:"",type:"HEAD",durability:100,maxDurability:100,level:10,stats:{luckBonus:.1}}},SOLDIER:{MAIN_HAND:{id:"iron_sword",name:"Jernsverd",icon:"",type:"MAIN_HAND",durability:100,maxDurability:100,level:3,stats:{attack:8}},OFF_HAND:{id:"wooden_shield",name:"Treskjold",icon:"",type:"OFF_HAND",durability:50,maxDurability:50,level:2,stats:{defense:5}},BODY:{id:"leather_armor",name:"Lrrustning",icon:"",type:"BODY",durability:80,maxDurability:80,level:2,stats:{defense:5}}},MERCHANT:{MAIN_HAND:{id:"walking_stick",name:"Vandrestav",icon:"",type:"MAIN_HAND",durability:50,maxDurability:50,level:2,stats:{speedBonus:1.05}},TRINKET:{id:"abacus",name:"Kuleramme",icon:"",type:"TRINKET",durability:100,maxDurability:100,level:3,stats:{yieldBonus:2}}}},Te={tools:{id:"tools",name:"Verkty",icon:"",type:"MAIN_HAND",durability:100,maxDurability:100,level:1,description:"Grunnleggende verkty."},weapon:{id:"weapon",name:"Enkelt Sverd",icon:"",type:"MAIN_HAND",durability:100,maxDurability:100,level:1,description:"Et enkelt sverd."},armor:{id:"armor",name:"Enkel Rustning",icon:"",type:"BODY",durability:100,maxDurability:100,level:1,description:"Beskyttende rustning."},stone_axe:{id:"stone_axe",name:"Steinks",icon:"",type:"AXE",durability:30,maxDurability:30,level:1,description:"Primitiv ks hugget fra mrke fjell. Sagnet sier at de frste fedrene brukte slike til  bane vei gjennom de tette skogene fr sivilisasjonens inntog. +1 Utbytte.",stats:{yieldBonus:1},relevantActions:["CHOP"],nextTierId:"iron_axe"},stone_pickaxe:{id:"stone_pickaxe",name:"Steinhakke",icon:"",type:"PICKAXE",durability:30,maxDurability:30,level:1,description:"En enkel hakke i flint og tre. Brukt i generasjoner av de som sker fjellets hemmeligheter. +1 Utbytte.",stats:{yieldBonus:1},relevantActions:["MINE"],nextTierId:"iron_pickaxe"},rusty_axe:{id:"rusty_axe",name:"Rusten ks",icon:"",type:"AXE",durability:50,maxDurability:50,level:1,description:"Et glemt relikvie fra en svunnen tid, n bare en skygge av sin fordums prakt. Slv og uplitelig.",stats:{yieldBonus:0},relevantActions:["CHOP"],nextTierId:"stone_axe"},iron_axe:{id:"iron_axe",name:"Jernks",icon:"",type:"AXE",durability:100,maxDurability:100,level:3,description:"Smid i landsbyens esse under fullmnen. Jernet synger nr det treffer treverket. +3 Utbytte.",stats:{yieldBonus:3},relevantActions:["CHOP"],nextTierId:"steel_axe"},iron_pickaxe:{id:"iron_pickaxe",name:"Jernhakke",icon:"",type:"PICKAXE",durability:100,maxDurability:100,level:3,description:"Tung og balansert. Laget for  trenge dypt inn i rikets rike rer. +3 Utbytte.",stats:{yieldBonus:3},relevantActions:["MINE"],nextTierId:"steel_pickaxe"},stone_chisel:{id:"stone_chisel",name:"Steinmeisel",icon:"",type:"CHISEL",durability:30,maxDurability:30,level:1,description:"En enkel meisel av herdet stein. Perfekt for  forme steinblokker. +1 Utbytte.",stats:{yieldBonus:1},relevantActions:["QUARRY"],nextTierId:"iron_chisel"},iron_chisel:{id:"iron_chisel",name:"Jernmeisel",icon:"",type:"CHISEL",durability:80,maxDurability:80,level:3,description:"Smid i landsbyens esse. Gjr steinhugging til en lek. +3 Utbytte.",stats:{yieldBonus:3},relevantActions:["QUARRY"],nextTierId:"steel_chisel"},royal_scepter:{id:"royal_scepter",name:"Kongens Septer",icon:"",type:"MAIN_HAND",durability:200,maxDurability:200,level:10,description:"Et symbol p guddommelig rett og folkets vilje. Det glitrer med en makt som kan bye selve skjebnen. +20% Flaks.",stats:{luckBonus:.2}},steel_axe:{id:"steel_axe",name:"Stlks",icon:"",type:"AXE",durability:200,maxDurability:200,level:8,description:"Mesterlig stl. +8 Utbytte, 20% raskere arbeid.",stats:{yieldBonus:8,speedBonus:1.2},relevantActions:["CHOP"]},steel_hja:{id:"steel_hja",name:"Stlhj",icon:"",type:"SCYTHE",durability:120,maxDurability:120,level:4,description:"Sylskarp hj. +5 Utbytte, 10% raskere hsting.",stats:{yieldBonus:5,speedBonus:1.1},relevantActions:["WORK","HST"]},stone_sickle:{id:"stone_sickle",name:"Steinsigd",icon:"",type:"SCYTHE",durability:40,maxDurability:40,level:1,description:"Enkel sigd for jordbruk. +1 Utbytte ved kornhsting.",stats:{yieldBonus:1},relevantActions:["WORK"]},blacksmith_hammer:{id:"blacksmith_hammer",name:"Smedhammer",icon:"",type:"HAMMER",durability:200,maxDurability:200,level:5,description:"Mesterverkty. 20% raskere smiing.",stats:{speedBonus:1.2},relevantActions:["CRAFT","REFINE","SMELT"]},shears:{id:"shears",name:"Saks",icon:"",type:"MAIN_HAND",durability:50,maxDurability:50,level:1,description:"Brukt til  klippe sauer. Helt ndvendig for ull-produksjon.",stats:{yieldBonus:2},relevantActions:["GATHER_WOOL"]},iron_sword:{id:"iron_sword",name:"Jernsverd",icon:"",type:"MAIN_HAND",durability:100,maxDurability:100,level:5,description:"Standard sverd. +10 Angrepskraft.",stats:{attack:10},relevantActions:["DEFEND","PATROL","EXPLORE","HUNT"],nextTierId:"steel_sword"},steel_sword:{id:"steel_sword",name:"Stlsverd",icon:"",type:"MAIN_HAND",durability:250,maxDurability:250,level:10,description:"Ddelig stl. +25 Angrep, 10% raskere hugg.",stats:{attack:25,speedBonus:1.1},relevantActions:["DEFEND","PATROL","EXPLORE","HUNT"]},tunic:{id:"tunic",name:"Slitt Tunika",icon:"",type:"BODY",durability:20,maxDurability:20,level:1,description:"Gammel og hullete. Minimal beskyttelse.",stats:{defense:1},relevantActions:["DEFEND","PATROL"],nextTierId:"leather_armor"},leather_armor:{id:"leather_armor",name:"Lrrustning",icon:"",type:"BODY",durability:80,maxDurability:80,level:3,description:"Herdet skinn. +5 Forsvar.",stats:{defense:5},relevantActions:["DEFEND","PATROL"],nextTierId:"iron_armor"},whetstone:{id:"whetstone",name:"Bryne",icon:"",type:"OFF_HAND",durability:10,maxDurability:10,level:1,description:"Bruk bryne for  holde verkty skarpe. Gir +1 i utbytte p de fleste sanke-oppgaver.",stats:{yieldBonus:1},relevantActions:["CHOP","MINE","QUARRY","WORK","GATHER_WOOL"]},hunting_bow:{id:"hunting_bow",name:"Jaktbue",icon:"",type:"BOW",durability:80,maxDurability:80,level:1,description:"En stdig bue av barlind. +2 Utbytte.",stats:{yieldBonus:2},relevantActions:["HUNT"],nextTierId:"longbow"},longbow:{id:"longbow",name:"Langbue",icon:"",type:"BOW",durability:150,maxDurability:150,level:5,description:"En mektig langbue som krever styrke  spenne. +5 Utbytte, 10% raskere.",stats:{yieldBonus:5,speedBonus:1.1},relevantActions:["HUNT"]},hunting_trap:{id:"hunting_trap",name:"Jaktfelle",icon:"",type:"TRAP",durability:30,maxDurability:30,level:1,description:"En enkel snarefangst-felle. +1 Utbytte ved smviltjakt.",stats:{yieldBonus:1},relevantActions:["HUNT","FORAGE"]},omelette:{id:"omelette",name:"Omelett",icon:"",type:"CONSUMABLE",durability:1,maxDurability:1,level:1,description:'En nringsrik frokost. Gir buff: "Lett til beins" (20% mindre stamina kostnad i 15 min).',stats:{},relevantActions:["CONSUME"]},bread:{id:"bread",name:"Brd",icon:"",type:"CONSUMABLE",durability:1,maxDurability:1,level:1,description:"Ferskt brd fra bakeriet. Gjenoppretter +20 Stamina.",stats:{},relevantActions:["CONSUME"]}},j0={grain:{label:"Kornker",seed:"grain",yieldResource:"grain",duration:3*60*1e3,minYield:15,maxYield:25,xp:20}},Bt={farm_house:{id:"farm_house",name:"Grdshuset",icon:"",locationId:"peasant_farm",description:"Ditt personlige hjem. Oppgraderinger gir bedre hvile og mer matlagingsplass.",levels:{1:{requirements:{},unlocks:["SLEEP","EAT"],bonus:"Base hvile"},2:{requirements:{wood:50,gold:100},unlocks:["FARM_UPGRADE"],bonus:"+20% Stamina fra peisen"},3:{requirements:{plank:20,stone:50,gold:300},unlocks:["FARM_UPGRADE_MASTER"],bonus:"+30% Stamina fra senga"},4:{requirements:{plank:50,stone:100,gold:600},unlocks:["FARM_UPGRADE_ELITE"],bonus:"+50% Stamina fra hvile"},5:{requirements:{plank:100,stone:200,gold:1e3,iron_ingot:20},unlocks:["FARM_UPGRADE_GODLY"],bonus:"Restaurerer all Stamina ved hvile"}}},sawmill:{id:"sawmill",name:"Sagbruk",icon:"",locationId:"village",description:"Gjr det mulig  foredle Ved til Tmmer.",levels:{1:{requirements:{},unlocks:["REFINE_PLANK_BASIC","hunting_bow"],bonus:"Base produksjon"},2:{requirements:{wood:100,stone:50,gold:100},unlocks:["REFINE_PLANK_FAST"],bonus:"+10% Woodcutting XP"},3:{requirements:{plank:50,stone:150,gold:300},unlocks:["REFINE_PLANK_MASTER","longbow"],bonus:"Lser opp Tier 3 verkty og Langbue"}}},windmill:{id:"windmill",name:"Vindmlle",icon:"",locationId:"village",description:"Gjr det mulig  foredle Korn til Mel mer effektivt.",levels:{1:{requirements:{},unlocks:["REFINE_FLOUR_BASIC"],bonus:"Base produksjon"},2:{requirements:{plank:30,stone:50,gold:150},unlocks:["REFINE_FLOUR_FAST"],bonus:"+10% Farming XP"},3:{requirements:{plank:100,stone:200,gold:500},unlocks:["REFINE_FLOUR_AUTO"],bonus:"Sjanse for dobbel avling"}}},smeltery:{id:"smeltery",name:"Smeltehytte",icon:"",locationId:"village",description:"Gjr det mulig  smelte Jernmalm til Jernbarrer.",levels:{1:{requirements:{},unlocks:["REFINE_IRON_BASIC"],bonus:"Base produksjon"},2:{requirements:{stone:150,wood:100,gold:200},unlocks:["REFINE_IRON_FAST"],bonus:"+10% Mining XP"},3:{requirements:{stone:300,plank:50,gold:600},unlocks:["REFINE_STEEL","glass"],bonus:"Lser opp Stl og Glass"}}},great_forge:{id:"great_forge",name:"Storsmie",icon:"",locationId:"village",description:"Gjr det mulig  lage avanserte verkty og vpen.",levels:{1:{requirements:{},unlocks:["stone_axe","stone_pickaxe","stone_sickle","whetstone","hunting_trap"],bonus:"Base produksjon"},2:{requirements:{iron_ingot:20,plank:30,gold:300},unlocks:["iron_axe","iron_pickaxe","iron_sword","leather_armor","shears","siege_swords","siege_armor"],bonus:"+10% Crafting XP"},3:{requirements:{iron_ingot:100,plank:100,gold:1e3},unlocks:["steel_axe","steel_sword","blacksmith_hammer","repair_advanced"],bonus:"Lser opp Mester-utstyr"}}},bakery:{id:"bakery",name:"Bakeri",icon:"",locationId:"village",description:"Gjr det mulig  bake Brd fra Mel.",levels:{1:{requirements:{},unlocks:["CRAFT_BREAD","CRAFT_omelette"],bonus:"Base produksjon"},2:{requirements:{stone:50,plank:20,gold:100},unlocks:["CRAFT_PIE"],bonus:"Bedre stamina fra mat"},3:{requirements:{stone:150,plank:50,gold:400},unlocks:["CRAFT_FEAST"],bonus:"Lser opp Gildemltid"}}},tavern:{id:"tavern",name:"Vertshuset",icon:"",locationId:"village",description:"Et sted for hvile og rykter. ker stamina-regenerering.",levels:{1:{requirements:{},unlocks:["ENTER_TAVERN","REST_BASIC","BUY_MEAL","OPEN_DICE_GAME","CHAT_LOCAL"],bonus:"Standard hvile"},2:{requirements:{wood:100,stone:50,gold:250},unlocks:["REST_COMFY"],bonus:"Dobbel stamina-regen"},3:{requirements:{plank:50,stone:150,gold:750},unlocks:["REST_ROYAL"],bonus:"Gjenoppretter all stamina raskt"}}},weavery:{id:"weavery",name:"Veveri",icon:"",locationId:"village",description:"Foredler Ull til Stoff for videre salg eller klr.",levels:{1:{requirements:{},unlocks:["REFINE_CLOTH_BASIC"],bonus:"Base produksjon"},2:{requirements:{plank:40,stone:30,gold:150},unlocks:["REFINE_CLOTH_FAST"],bonus:"+10% Trading XP"},3:{requirements:{plank:100,stone:100,gold:400},unlocks:["REFINE_CLOTH_MASTER"],bonus:"Lser opp Silke-produksjon"}}},well:{id:"well",name:"Bybrnn",icon:"",locationId:"village",description:"Gir tilgang til ferskvann for baking og hygiene.",levels:{1:{requirements:{},unlocks:["GATHER_WATER"],bonus:"Basiskilde"},2:{requirements:{stone:50,gold:50},unlocks:["GATHER_WATER_FAST"],bonus:"Bedre vanntilgang"},3:{requirements:{stone:150,gold:200},unlocks:["GATHER_WATER_MASTER"],bonus:"Hellig kilde: +5 Stamina ved drikking"}}},apothecary:{id:"apothecary",name:"Apoteker",icon:"",locationId:"village",description:"Fremstiller medisin og salver.",levels:{1:{requirements:{},unlocks:["CRAFT_MEDICINE"],bonus:"Basis urter"},2:{requirements:{plank:20,wood:50,gold:150},unlocks:["CRAFT_POISON"],bonus:"Kunnskap om gift"},3:{requirements:{plank:50,glass:20,gold:500},unlocks:["CRAFT_ELIXIR"],bonus:"Livseliksir"}}},watchtower:{id:"watchtower",name:"Vaktrn",icon:"",locationId:"village",description:"Bedre oversikt og forsvar av landsbyen.",levels:{1:{requirements:{},unlocks:["PATROL"],bonus:"+5 Forsvar"},2:{requirements:{stone:100,plank:50,gold:200},unlocks:["SCOUT"],bonus:"+15 Forsvar"},3:{requirements:{stone:300,plank:100,gold:800},unlocks:["VOLLEY"],bonus:"Bueskytter-sttte i kamp"}}},stables:{id:"stables",name:"Stall",icon:"",locationId:"village",description:"Muliggjr raskere reise og kavaleri.",levels:{1:{requirements:{},unlocks:["MOUNT_HORSE"],bonus:"Transport"},2:{requirements:{plank:50,wood:50,gold:150},unlocks:["BREED_WARHORSE"],bonus:"Stridshester"},3:{requirements:{plank:150,iron_ingot:20,gold:400},unlocks:["KNIGHT_TRAINING"],bonus:"Riddere"}}},manor_ost:{id:"manor_ost",name:"Slott st",icon:"",locationId:"castle",description:"Setet til den stlige herre. Krever enorme ressurser  bygge.",levels:{1:{requirements:{stone:500,plank:300,iron_ingot:50,gold:1e3},unlocks:["BARON_STATUS"],bonus:"Krav p regionen"}}},manor_vest:{id:"manor_vest",name:"Slott Vest",icon:"",locationId:"castle",description:"Setet til den vestlige herre. Krever enorme ressurser  bygge.",levels:{1:{requirements:{stone:500,plank:300,iron_ingot:50,gold:1e3},unlocks:["BARON_STATUS"],bonus:"Krav p regionen"}}},throne_room:{id:"throne_room",name:"Slottet",icon:"",locationId:"castle",description:"Kongens stol. Den frste Baronen som fullfrer denne blir Konge.",levels:{1:{requirements:{stone:2e3,plank:1e3,iron_ingot:200,gold:5e3},unlocks:["KING_STATUS"],bonus:"Krav p riket"}}}},wr={plank:{label:"Planker",icon:"",input:{wood:5},outputResource:"plank",outputAmount:1,buildingId:"sawmill",stamina:10,xp:5,skill:"WOODCUTTING"},flour:{label:"Fint Mel",icon:"",input:{grain:10},outputResource:"flour",outputAmount:10,buildingId:"windmill",stamina:15,xp:8,skill:"FARMING",duration:12e4},iron_ingot:{label:"Jernbarre",icon:"",input:{iron_ore:5,wood:2},outputResource:"iron_ingot",outputAmount:1,buildingId:"smeltery",stamina:20,xp:12,skill:"CRAFTING"},bread:{label:"Bondebrd",icon:"",input:{flour:2},outputResource:"bread",outputAmount:5,buildingId:"bakery",stamina:5,xp:3,skill:"CRAFTING"},pie:{label:"Kjttpai",icon:"",input:{flour:4,meat:2},outputResource:"bread",outputAmount:15,buildingId:"bakery",stamina:15,xp:10,skill:"CRAFTING"},mead:{label:"Mjd",icon:"",input:{honey:5},outputResource:"stamina",outputAmount:20,buildingId:"tavern",stamina:5,xp:5,skill:"CRAFTING"},cloth:{label:"Lin-stoff",icon:"",input:{wool:5},outputResource:"cloth",outputAmount:1,buildingId:"weavery",stamina:15,xp:10,skill:"CRAFTING"},glass:{label:"Glass",icon:"",input:{stone:10,wood:5},outputResource:"glass",outputAmount:1,buildingId:"smeltery",requiredLevel:3,stamina:25,xp:15,skill:"CRAFTING"},elixir:{label:"Livseliksir",icon:"",input:{honey:10,glass:1},outputResource:"stamina",outputAmount:100,buildingId:"apothecary",requiredLevel:3,stamina:30,xp:25,skill:"CRAFTING"}},Rn={stone_axe:{label:"Steinks",icon:"",input:{stone:10,wood:5,gold:5},outputItemId:"stone_axe",buildingId:"great_forge",level:1,stamina:15,xp:10,description:"Et enkelt redskap for tmmerhogst.",skill:"CRAFTING"},stone_pickaxe:{label:"Steinhakke",icon:"",input:{stone:10,wood:5,gold:5},outputItemId:"stone_pickaxe",buildingId:"great_forge",level:1,stamina:15,xp:10,description:"En primitiv hakke for gruvearbeid.",skill:"CRAFTING"},stone_sickle:{label:"Steinsigd",icon:"",input:{stone:5,wood:5,gold:10},outputItemId:"stone_sickle",buildingId:"great_forge",level:1,stamina:10,xp:5,description:"Enkel sigd for kornhsting.",skill:"CRAFTING"},whetstone:{label:"Bryne",icon:"",input:{stone:15,gold:20},outputItemId:"whetstone",buildingId:"great_forge",level:1,stamina:10,xp:5,description:"Brukt for  slipe verkty og ke utbyttet.",skill:"CRAFTING"},stone_chisel:{label:"Steinmeisel",icon:"",input:{stone:10,gold:10},outputItemId:"stone_chisel",buildingId:"great_forge",level:1,stamina:10,xp:8,description:"Ndvendig for  hugge stein i steinhuggeriet.",skill:"CRAFTING"},iron_chisel:{label:"Jernmeisel",icon:"",input:{iron_ingot:5,gold:80},outputItemId:"iron_chisel",buildingId:"great_forge",level:2,stamina:20,xp:15,description:"Effektiv mesiel for steinhugging.",skill:"CRAFTING"},iron_axe:{label:"Jernks",icon:"",input:{iron_ingot:5,plank:2,gold:50},outputItemId:"iron_axe",buildingId:"great_forge",level:2,stamina:25,xp:20,description:"Et solid verkty av jern.",skill:"CRAFTING"},iron_pickaxe:{label:"Jernhakke",icon:"",input:{iron_ingot:5,plank:2,gold:50},outputItemId:"iron_pickaxe",buildingId:"great_forge",level:2,stamina:25,xp:20,description:"Effektiv hakke for dypere graving.",skill:"CRAFTING"},iron_sword:{label:"Jernsverd",icon:"",input:{iron_ingot:10,plank:2,gold:100},outputItemId:"iron_sword",buildingId:"great_forge",level:2,stamina:40,xp:35,description:"Et skarpt sverd for krigere.",skill:"CRAFTING"},leather_armor:{label:"Lrrustning",icon:"",input:{cloth:10,gold:150},outputItemId:"leather_armor",buildingId:"great_forge",level:2,stamina:30,xp:25,description:"God beskyttelse for en reisende.",skill:"CRAFTING"},shears:{label:"Saks",icon:"",input:{iron_ingot:5,gold:100},outputItemId:"shears",buildingId:"great_forge",level:2,stamina:20,xp:15,description:"Ndvendig for  klippe sauer og f ull.",skill:"CRAFTING"},siege_swords:{label:"Beleiringsvpen (x10)",icon:"",input:{iron_ingot:5,plank:5,gold:50},outputItemId:"swords",outputAmount:10,buildingId:"great_forge",level:2,stamina:40,xp:30,description:"En kasse med vpen til garnisonen.",skill:"CRAFTING"},siege_armor:{label:"Beleiringsrustning (x10)",icon:"",input:{iron_ingot:5,cloth:5,gold:50},outputItemId:"armor",outputAmount:10,buildingId:"great_forge",level:2,stamina:40,xp:30,description:"En kasse med rustninger til garnisonen.",skill:"CRAFTING"},steel_axe:{label:"Stlks",icon:"",input:{iron_ingot:20,plank:10,gold:250},outputItemId:"steel_axe",buildingId:"great_forge",level:3,stamina:50,xp:50,description:"Mesterlig utformet ks av herdet stl.",skill:"CRAFTING"},steel_sword:{label:"Stlsverd",icon:"",input:{iron_ingot:30,plank:5,gold:500},outputItemId:"steel_sword",buildingId:"great_forge",level:3,stamina:80,xp:100,description:"Det ultimate vpenet for en herre.",skill:"CRAFTING"},blacksmith_hammer:{label:"Smedhammer",icon:"",input:{iron_ingot:15,plank:5,gold:200},outputItemId:"blacksmith_hammer",buildingId:"great_forge",level:3,stamina:40,xp:50,description:"Mesterverkty for en ekte smed.",skill:"CRAFTING"},omelette:{label:"Omelett",icon:"",input:{egg:3},outputItemId:"omelette",buildingId:"bakery",level:1,stamina:10,xp:8,description:"En mettende frokost. Gir energi-buff.",skill:"CRAFTING"},hunting_trap:{label:"Jaktfelle",icon:"",input:{wood:10,iron_ingot:2,gold:30},outputItemId:"hunting_trap",buildingId:"great_forge",level:1,stamina:20,xp:15,description:"En enkel snare for smvilt.",skill:"CRAFTING"},hunting_bow:{label:"Jaktbue",icon:"",input:{plank:5,cloth:5,gold:50},outputItemId:"hunting_bow",buildingId:"sawmill",level:1,stamina:25,xp:20,description:"En stdig bue for jakt.",skill:"CRAFTING"},longbow:{label:"Langbue",icon:"",input:{plank:15,cloth:10,iron_ingot:1,gold:250},outputItemId:"longbow",buildingId:"sawmill",level:3,stamina:40,xp:45,description:"En kraftig bue med lang rekkevidde.",skill:"CRAFTING"}},jl={KING:{label:"Konge",description:"Styrer riket, krever skatt og dmmer i store saker."},BARON:{label:"Baron",description:"Styrer en region, krever inn skatt fra bnder, og beskytter mot krig."},PEASANT:{label:"Bonde",description:"Produserer mat og ressurser. Betaler skatt."},SOLDIER:{label:"Soldat",description:"Beskytter riket og deltar i raids."},MERCHANT:{label:"Kjpmann",description:"Tjener penger p handel og markedsspekulasjon."}},X4={PEASANT:["Trell","Leilending","Selveier","Storbondi","Odalbonde"],BARON:["Landmann","Vpner","Ridder","Baron","Grev"],KING:["Prins","Hertug","Konungr"],SOLDIER:["Rekrutt","Vakt","Kjempe","Hvding"],MERCHANT:["Gutt","Svenn","Mester","Hanseat"]},Q4={PEASANT:[["Basis rettigheter som bonde."],["+10% resurseffektivitet ved innhsting."],["Redusert skattetreff (-5%) fra din lensherre."],["Lser opp bruk av spesialverkty og ploger."],["Fullstendig selveie: Maksimal frihet og prestisje."]],BARON:[["Rett til  kreve inn skatt i din region."],["+20% forsvarsstyrke for dine vakter."],["Lser opp bygging av avanserte steinborger."],["Hyere status i Tinget: Dine stemmer teller mer."],["Maksimal autoritet og kontroll over landegrenser."]],KING:[["Gunst fra understtene og rett til tronen."],["Nasjonal autoritet: Kan passere lover uten Tinget."],["Gudegitt makt: Maksimal legitimitet og kontroll."]],SOLDIER:[["Grunnleggende kamptrening og utstyr."],["+15% skade i raids og forsvar."],["Lser opp bruk av tunge rustninger og hester."],["Elite-kriger: Fryktet over hele riket."]],MERCHANT:[["Rett til  drive handel p markedsplassen."],["Bedre priser ved kjp og salg (+10%)."],["Lser opp utlandshandel og karavaner."],["Finansfyrste: Kontrollerer markedstrender."]]},xt={grain:{price:10,stock:500,demand:1},flour:{price:15,stock:100,demand:1},bread:{price:25,stock:50,demand:1},wood:{price:15,stock:300,demand:1},plank:{price:25,stock:100,demand:1},iron_ore:{price:30,stock:100,demand:1},iron_ingot:{price:60,stock:50,demand:1},stone:{price:20,stock:200,demand:1},swords:{price:80,stock:20,demand:1},armor:{price:120,stock:10,demand:1},wool:{price:12,stock:200,demand:1},cloth:{price:45,stock:50,demand:1},honey:{price:30,stock:50,demand:1},meat:{price:25,stock:100,demand:1},glass:{price:50,stock:20,demand:1},iron:{price:40,stock:0,demand:1}},J4=[{type:"RAID",title:"Vikinger p horisonten!",description:"Et vikingskip er sett nr kysten. Forsvar jordene fr de stjeler kornet!",locationId:"fields"},{type:"RAID",title:"Bandittleir funnet",description:"Banditter har sltt seg ned i skogen. De stjeler ved hver time!",locationId:"forest"},{type:"QUEST",title:"Den Hellige Gral?",description:"Rykter sier en eremitt ved klosteret har funnet noe verdifullt.",locationId:"village"},{type:"QUEST",title:"Markedsdag i nabolaget",description:"En sjelden mulighet for god handel p grensen.",locationId:"marketplace"}],Z4=[{id:"tax_cut",label:"Skattekutt",description:"Alle skatter halveres i 10 minutter. Lojaliteten stiger."},{id:"peace",label:"Fredsavtale",description:"Ingen raids tillatt de neste 10 minuttene."},{id:"salt_tax",label:"Saltskatt",description:"ker kornprisene, men reduserer lojalitet."},{id:"conscription",label:"Verneplikt",description:"Soldater koster mindre  verve, men bnder jobber 20% tregere."}],my=Object.freeze(Object.defineProperty({__proto__:null,ACTION_COSTS:fc,ACTION_ICONS:xd,CRAFTING_RECIPES:Rn,CROP_DATA:j0,GAME_BALANCE:q,INITIAL_EQUIPMENT:ip,INITIAL_MARKET:xt,INITIAL_RESOURCES:Rt,INITIAL_SKILLS:jn,ITEM_TEMPLATES:Te,LAW_TEMPLATES:Z4,LEVEL_XP:bd,RANK_BENEFITS:Q4,REFINERY_RECIPES:wr,REPAIR_CONFIG:sp,RESOURCE_DETAILS:mn,REWARDS:dc,ROLE_DEFINITIONS:jl,ROLE_TITLES:X4,SEASONS:An,SKILL_DETAILS:W4,UPGRADES_LIST:C0,VILLAGE_BUILDINGS:Bt,WEATHER:_s,WORLD_EVENT_TEMPLATES:J4},Symbol.toStringTag,{value:"Module"}));/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e3=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),t3=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,s)=>s?s.toUpperCase():n.toLowerCase()),py=t=>{const e=t3(t);return e.charAt(0).toUpperCase()+e.slice(1)},_S=(...t)=>t.filter((e,n,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===n).join(" ").trim(),n3=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var s3={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i3=_.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:i="",children:r,iconNode:a,...o},c)=>_.createElement("svg",{ref:c,...s3,width:e,height:e,stroke:t,strokeWidth:s?Number(n)*24/Number(e):n,className:_S("lucide",i),...!r&&!n3(o)&&{"aria-hidden":"true"},...o},[...a.map(([u,d])=>_.createElement(u,d)),...Array.isArray(r)?r:[r]]));/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=(t,e)=>{const n=_.forwardRef(({className:s,...i},r)=>_.createElement(i3,{ref:r,iconNode:e,className:_S(`lucide-${e3(py(t))}`,`lucide-${t}`,s),...i}));return n.displayName=py(t),n};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r3=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],gy=ae("activity",r3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a3=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],va=ae("arrow-right",a3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o3=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],l3=ae("brain",o3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c3=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],O0=ae("check",c3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u3=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],d3=ae("chevron-down",u3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],rp=ae("circle-alert",f3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h3=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],vy=ae("clock",h3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m3=[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]],wS=ae("coins",m3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p3=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],vf=ae("crown",p3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],v3=ae("disc",g3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b3=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],x3=ae("eye-off",b3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y3=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],_3=ae("eye",y3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w3=[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]],ES=ae("gift",w3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],N3=ae("globe",E3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k3=[["path",{d:"m15 12-9.373 9.373a1 1 0 0 1-3.001-3L12 9",key:"1hayfq"}],["path",{d:"m18 15 4-4",key:"16gjal"}],["path",{d:"m21.5 11.5-1.914-1.914A2 2 0 0 1 19 8.172v-.344a2 2 0 0 0-.586-1.414l-1.657-1.657A6 6 0 0 0 12.516 3H9l1.243 1.243A6 6 0 0 1 12 8.485V10l2 2h1.172a2 2 0 0 1 1.414.586L18.5 14.5",key:"15ts47"}]],S3=ae("hammer",k3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T3=[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]],M0=ae("handshake",T3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A3=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],R3=ae("layout-grid",A3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I3=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],by=ae("loader-circle",I3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C3=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],D0=ae("lock",C3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j3=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],O3=ae("mail",j3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M3=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],NS=ae("map-pin",M3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D3=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],L3=ae("map",D3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P3=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],B3=ae("menu",P3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U3=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],Ol=ae("message-square",U3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H3=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],G3=ae("music",H3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V3=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],F3=ae("package",V3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z3=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],ap=ae("pause",z3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $3=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],yd=ae("play",$3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K3=[["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]],Y3=ae("scroll",K3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q3=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],W3=ae("search",q3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X3=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],kS=ae("send",X3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q3=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],J3=ae("settings",Q3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z3=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],xy=ae("shield-check",Z3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eP=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],L0=ae("shield",eP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tP=[["path",{d:"M17.971 4.285A2 2 0 0 1 21 6v12a2 2 0 0 1-3.029 1.715l-9.997-5.998a2 2 0 0 1-.003-3.432z",key:"15892j"}],["path",{d:"M3 20V4",key:"1ptbpl"}]],nP=ae("skip-back",tP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sP=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],iP=ae("skip-forward",sP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rP=[["path",{d:"m11 19-6-6",key:"s7kpr"}],["path",{d:"m5 21-2-2",key:"1kw20b"}],["path",{d:"m8 16-4 4",key:"1oqv8h"}],["path",{d:"M9.5 17.5 21 6V3h-3L6.5 14.5",key:"pkxemp"}]],op=ae("sword",rP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aP=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],oP=ae("trending-up",aP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lP=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],yy=ae("triangle-alert",lP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cP=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],uP=ae("trophy",cP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dP=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],bf=ae("user",dP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fP=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],P0=ae("users",fP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hP=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],mP=ae("volume-2",hP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pP=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ji=ae("x",pP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gP=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],vP=ae("zap",gP),bP=t=>{const e=Object.keys(t),n=[...e].sort(()=>Math.random()-.5),s={...t};if(e.length===0)return s;const r=n.shift();r&&(s[r]={...s[r],role:"KING",resources:JSON.parse(JSON.stringify(Rt.KING)),regionId:"capital",status:{hp:100,stamina:100,morale:100,legitimacy:100,authority:100,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:1,xp:0,reputation:50,contribution:0},equipment:{MAIN_HAND:{id:"tools",name:"Kongens Verkty",icon:"",type:"MAIN_HAND",level:1,durability:100,maxDurability:100},OFF_HAND:{id:"weapon",name:"Kongens Sverd",icon:"",type:"OFF_HAND",level:1,durability:100,maxDurability:100},BODY:{id:"armor",name:"Kongens Rustning",icon:"",type:"BODY",level:1,durability:100,maxDurability:100}}});const o=Math.min(2,n.length);for(let m=0;m<o;m++){const g=n.shift();if(g){const b=m===0?"region_ost":"region_vest";s[g]={...s[g],role:"BARON",resources:JSON.parse(JSON.stringify(Rt.BARON)),regionId:b,status:{hp:100,stamina:100,morale:100,legitimacy:80,authority:50,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:1,xp:0,reputation:40,contribution:0},equipment:{MAIN_HAND:{id:"tools",name:"Baronens Verkty",icon:"",type:"MAIN_HAND",level:1,durability:100,maxDurability:100},OFF_HAND:{id:"weapon",name:"Baronens Sverd",icon:"",type:"OFF_HAND",level:1,durability:100,maxDurability:100},BODY:{id:"armor",name:"Baronens Rustning",icon:"",type:"BODY",level:1,durability:100,maxDurability:100}}}}}let c=0;const u=()=>{const m=c%2===0?"region_ost":"region_vest";return c++,m},d=n.length;let f=0,h=0;d>=4?(f=Math.max(1,Math.floor(d/6)),h=Math.max(1,Math.floor(d/5))):d>0&&d<4&&(f=0,h=0);for(let m=0;m<f;m++){const g=n.shift();g&&(s[g]={...s[g],role:"MERCHANT",resources:JSON.parse(JSON.stringify(Rt.MERCHANT)),regionId:u(),status:{hp:100,stamina:100,morale:100,legitimacy:100,authority:30,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:1,xp:0,reputation:30,contribution:0},equipment:{MAIN_HAND:{id:"tools",name:"Hndverkty",icon:"",type:"MAIN_HAND",level:1,durability:100,maxDurability:100},OFF_HAND:{id:"weapon",name:"Kort sverd",icon:"",type:"OFF_HAND",level:1,durability:100,maxDurability:100},BODY:{id:"armor",name:"Kjpmannskappe",icon:"",type:"BODY",level:1,durability:100,maxDurability:100}}})}for(let m=0;m<h;m++){const g=n.shift();g&&(s[g]={...s[g],role:"SOLDIER",resources:JSON.parse(JSON.stringify(Rt.SOLDIER)),regionId:u(),status:{hp:100,stamina:100,morale:100,legitimacy:100,authority:50,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:1,xp:0,reputation:20,contribution:0},equipment:{MAIN_HAND:{id:"tools",name:"Feltverkty",icon:"",type:"MAIN_HAND",level:1,durability:100,maxDurability:100},OFF_HAND:{id:"weapon",name:"Soldatens Sverd",icon:"",type:"OFF_HAND",level:1,durability:100,maxDurability:100},BODY:{id:"armor",name:"Brynjekofte",icon:"",type:"BODY",level:1,durability:100,maxDurability:100}}})}for(;n.length>0;){const m=n.shift();m&&(s[m]={...s[m],role:"PEASANT",resources:JSON.parse(JSON.stringify(Rt.PEASANT)),regionId:u(),status:{hp:100,stamina:100,morale:80,legitimacy:100,authority:10,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:1,xp:0,reputation:10,contribution:0},equipment:{}})}return s},xP=(t,e)=>{const n={...t},s=[];return Object.values(n).forEach(i=>{if(i.role==="PEASANT"){const a=Math.ceil((i.resources.grain||0)*.15),o=Math.ceil((i.resources.gold||0)*(15/100));if(a>0||o>0){const c=Object.values(n).find(u=>u.role==="BARON"&&(u.regionId===i.regionId||i.regionId==="test_region"&&u.regionId==="test_region"));c&&(i.resources.grain=Math.max(0,i.resources.grain-a),i.resources.gold=Math.max(0,i.resources.gold-o),n[c.id].resources.grain+=a,n[c.id].resources.gold+=o,s.push(`${i.name} betalte ${a} korn og ${o} gull i skatt til ${c.name}`))}}}),Object.values(n).forEach(i=>{if(i.role==="BARON"){const r=Math.ceil((i.resources.grain||0)*(e/100)),a=Math.ceil((i.resources.gold||0)*(e/100));if(r>0||a>0){const o=Object.values(n).find(c=>c.role==="KING");o&&(i.resources.grain=Math.max(0,i.resources.grain-r),i.resources.gold=Math.max(0,i.resources.gold-a),n[o.id].resources.grain+=r,n[o.id].resources.gold+=a,s.push(`${i.name} betalte ${r} korn og ${a} gull i skatt til Kongen`))}}}),Object.values(n).forEach(i=>{if(i.role==="MERCHANT"||i.role==="SOLDIER"){const r=i.role==="MERCHANT"?e/50:e/100,a=Math.ceil((i.resources.gold||0)*r);if(a>0){const o=Object.values(n).find(c=>c.role==="KING");o&&(i.resources.gold=Math.max(0,i.resources.gold-a),n[o.id].resources.gold+=a,s.push(`${i.name} (${i.role}) betalte ${a} gull i skatt til Kongen`))}}}),{updatedPlayers:n,results:s}},yP=(t,e)=>{if(!t||Object.keys(t).length===0)return null;const n=q.CONTRIBUTION_VALUES,s=Object.entries(t).map(([a,o])=>{let c=0;return Object.entries(o.resources||{}).forEach(([u,d])=>{c+=d*(n[u]||.1)}),{pid:a,score:c,name:o.name}});s.sort((a,o)=>o.score-a.score);const i=s[0];if(!i)return null;const r=e==="throne_room"?"KING":"BARON";return{winningPlayerId:i.pid,role:r}},_P=(t,e)=>({pin:t,name:e,status:"PLAYING",settings:"feudal_europe",hostName:"Host",isPublic:!0,market:JSON.parse(JSON.stringify(xt)),world:{year:1100,season:"Spring",weather:"Clear",gameTick:0,lastTickAt:Date.now(),taxRateDetails:{kingTax:20},settlement:{buildings:Object.entries(Bt).reduce((n,[s])=>({...n,[s]:{id:s,level:0,progress:{},target:200,contributions:{}}}),{})}},markets:{capital:{...xt},region_vest:{...xt},region_ost:{...xt}},players:{},public_profiles:{},messages:[],regions:{region_vest:{id:"region_vest",name:"Baroniet Vest",taxRate:10,defenseLevel:50,rulerName:"Ingen"},region_ost:{id:"region_ost",name:"Baroniet st",taxRate:10,defenseLevel:50,rulerName:"Ingen"}},diplomacy:{},worldEvents:{}}),Hc=async(t,e)=>{var s,i;if(!t||!e)return;const n=D(L,`simulation_server_metadata/${t}`);if(e.isPublic===!1){await Ua(n,null);return}await Ua(n,{pin:t,name:e.name||`Rike #${t}`,status:e.status,playerCount:Object.keys(e.players||{}).length,worldYear:((s=e.world)==null?void 0:s.year)||1100,season:((i=e.world)==null?void 0:i.season)||"Spring",isPublic:e.isPublic??!0,hostName:e.hostName||"Anonym Host",lastUpdated:Date.now()})},lp=30,wP=21,EP=120,SS=480,NP=["Spring","Summer","Autumn","Winter"],kP=t=>t%lp,Ss=t=>kP(t)<wP?"DAY":"NIGHT",SP=(t,e=0)=>{let n=t;if(e>0){const o=(Date.now()-e)/6e4;n+=Math.min(1,Math.max(0,o))}const i=n%lp/lp*24,r=(6+Math.floor(i))%24,a=Math.floor(i%1*60);return`${r.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`},TP=t=>{const e=Math.floor(t%SS/EP);return NP[e]||"Spring"},AP=(t,e=1)=>e+Math.floor(t/SS),Et=async(t,e)=>{const n=D(L,`simulation_rooms/${t}/messages`);await Ae(n,s=>{let i=[];Array.isArray(s)?i=s:s&&typeof s=="object"&&(i=Object.values(s));const r={id:`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,content:e,timestamp:Date.now(),type:"SYSTEM"};return i.push(r),i.length>50&&(i=i.sort((a,o)=>a.timestamp-o.timestamp).slice(i.length-50)),i})},Kn=(t,e,n,s={})=>{var m,g;let i=0,r=!1;t.equipment&&Object.keys(t.equipment).forEach(x=>{var E,N;const p=t.equipment[x];if(!p)return;let v=p.relevantActions;if(!v&&p.id){const T=Object.keys(Te).find(w=>p.id===w||p.id.startsWith(w+"_")||p.id.startsWith(w+"-"));T&&(v=(E=Te[T])==null?void 0:E.relevantActions)}if(!s.actionType||(v==null?void 0:v.includes(s.actionType))){const T=p.stats||((N=Te[p.id])==null?void 0:N.stats);T!=null&&T.yieldBonus&&(i+=T.yieldBonus),(x==="AXE"||x==="PICKAXE"||x==="SCYTHE"||x==="MAIN_HAND"||x==="OFF_HAND"||x==="BOW"||x==="TRAP"||x==="CHISEL")&&(r=!0)}});let a=e+i;const o=((m=t.skills)==null?void 0:m[n])||{level:0},c=s.isRefining?q.SKILLS.REFINING_BONUS:q.SKILLS.GATHERING_BONUS,u=1+o.level*c;a*=u;const d=s.actionType==="FORAGE"||s.actionType==="GATHER_HONEY";if(!s.isRefining&&!r&&!d){if(s.requiresTool)return 0;const b=(g=q.GATHERING)==null?void 0:g.NO_TOOL_PENALTY;a*=1-b}let f=1;s.regionId&&(s.actionType==="MINE"&&(s.regionId==="region_vest"?f=1.2:s.regionId==="region_ost"&&(f=.8)),s.actionType==="CHOP"&&(s.regionId==="region_vest"?f=.8:s.regionId==="region_ost"&&(f=1.2)));const h=(s.season||1)*(s.weather||1)*(s.law||1)*(s.upgrades||1)*f;if(a=Math.floor(a*h),s.performance!==void 0){const b=q.MINIGAME.BASE_MULTIPLIER+s.performance*q.MINIGAME.PERFORMANCE_WEIGHT;a=Math.ceil(a*b)}return Math.max(0,a)},fs=(t,e,n,s,i=0)=>{const r=An[e],a=_s[n],o=(r==null?void 0:r.staminaMod)||1,c=(a==null?void 0:a.staminaMod)||1,d=Ss(i)==="NIGHT"?1.2:1;let h=t*o*c*d;if(s&&s.length>0){const m=Date.now(),g=s.find(b=>b.type==="STAMINA_SAVE"&&b.expiresAt>m);g&&(h*=1-g.value)}return Math.ceil(h)},Xt=(t,e,n,s=1)=>{if(!t||!e||!n)return;const i=n.replace(/\./g,"_"),r=D(L,`simulation_rooms/${t}/stats/${e}`);J(r,{[i]:pS(s)}).catch(a=>console.error("Failed to log systemic stat:",a))},RP=async(t,e,n)=>{const{resource:s,type:i}=n,r=D(L,`simulation_rooms/${t}/players/${e}`),a=await xe(r);if(!a.exists())return{success:!1,error:"Player not found"};const o=a.val(),c=o.regionId||"capital",u=D(L,`simulation_rooms/${t}/markets/${c}/${s}`);let d={success:!1,amount:0};if(await Ae(u,m=>{if(m){if(i==="BUY"){if(m.stock<=0)return;d.price=m.price,d.cost=m.price,d.amount=1,m.stock-=1,m.price+=m.price*q.MARKET.PRICE_IMPACT_BUY,d.success=!0}else if(i==="SELL"){d.price=m.price;const g=m.price*q.MARKET.SELL_RATIO;d.revenue=g,d.amount=1,m.stock+=1,m.price-=m.price*q.MARKET.PRICE_IMPACT_SELL,d.success=!0}return m}}),!d.success)return{success:!1,error:"Handel feilet (Vare mangler eller utsolgt)"};let f=!1,h="";return await Ae(r,m=>{if(!m)return;m.resources||(m.resources={}),m.inventory||(m.inventory=[]);const g=s==="swords"||s==="armor",b={swords:"iron_sword",armor:"leather_armor"};if(i==="BUY"){const x=d.cost||0;if((m.resources.gold||0)<x)return;if(m.resources.gold=(m.resources.gold||0)-x,g){const p=b[s],v=Te[p];if(v){const y=JSON.parse(JSON.stringify(v));m.inventory.push(y),h=`Kjpte 1 ${v.name} for ${x.toFixed(2)}g`}else m.resources[s]=(m.resources[s]||0)+1,h=`Kjpte 1 ${s} (Resource) for ${x.toFixed(2)}g`}else m.resources[s]=(m.resources[s]||0)+1,h=`Kjpte 1 ${s} for ${x.toFixed(2)}g`;f=!0}else if(i==="SELL"){const x=d.revenue||0;if(g){const p=b[s],v=m.inventory.findIndex(E=>E.id===p);if(v===-1)return;m.inventory.splice(v,1),m.resources.gold=(m.resources.gold||0)+x;const y=Te[p];h=`Solgte 1 ${y?y.name:s} for ${x.toFixed(2)}g`,f=!0}else{if((m.resources[s]||0)<1)return;m.resources[s]-=1,m.resources.gold=(m.resources.gold||0)+x,h=`Solgte 1 ${s} for ${x.toFixed(2)}g`,f=!0}}return m}),f?(Et(t,`[${new Date().toLocaleTimeString()}] ${o.name}: ${h}`),{success:!0,data:{success:!0,timestamp:Date.now(),message:h,utbytte:i==="BUY"?[{resource:s,amount:1}]:[{resource:"gold",amount:d.revenue}],xp:[],durability:[]}}):{success:!1,error:"Transaksjon avbrutt (Mangler ressurser)"}},IP=async(t,e,n)=>{var x;const{buildingId:s,resource:i,amount:r}=n,a=D(L,`simulation_rooms/${t}/world/settlement/buildings/${s}`),o=D(L,`simulation_rooms/${t}/players/${e}`),c=await xe(o);if(!c.exists())return{success:!1,error:"Player missing"};const u=c.val();if((((x=u.resources)==null?void 0:x[i])||0)<r)return{success:!1,error:"Not enough resources"};let d=!1,f=0,h="",m=!1,g=0;if(await Ae(a,p=>{var C,B,z;if(!p)return{id:s,level:1,progress:{[i]:r},contributions:{[e]:{name:u.name,resources:{[i]:r}}}};const v=Bt[s];h=(v==null?void 0:v.name)||s;const E=(p.level===void 0?0:p.level)+1,N=(C=v==null?void 0:v.levels)==null?void 0:C[E];if(!N)return;const T=((B=N.requirements)==null?void 0:B[i])||0,w=((z=p.progress)==null?void 0:z[i])||0,A=T-w;if(A<=0)return;f=Math.min(r,A),p.progress||(p.progress={}),p.progress[i]=w+f,p.contributions||(p.contributions={}),p.contributions[e]||(p.contributions[e]={name:u.name,resources:{}});const k=p.contributions[e].resources;k[i]=(k[i]||0)+f;let R=!0;if(Object.entries(N.requirements).forEach(([$,K])=>{(p.progress[$]||0)<K&&(R=!1)}),R){p.level=E,p.progress={};const $=N.unlocks||[];if($.includes("BARON_STATUS")||$.includes("KING_STATUS")){const K=yP(p.contributions,s);K&&(p.pendingWinnerId=K.winningPlayerId,p.pendingRole=K.role)}p.contributions={},m=!0,g=E}return d=!0,Xt(t,"contributions",i,f),p}),!d)return{success:!1,error:"Kunne ikke bidra (Fullt eller ugyldig)"};if(m){const v=(await xe(a)).val();if(v.pendingWinnerId){const y=v.pendingWinnerId,E=v.pendingRole,N=D(L,`simulation_rooms/${t}/players/${y}`),w=(await xe(N)).val(),A={};if(A[`${y}/role`]=E,E==="BARON"){const R=s==="manor_ost"?"region_ost":"region_vest";A[`${y}/regionId`]=R;const C=D(L,`simulation_rooms/${t}/regions/${R}`);await J(C,{rulerId:y,rulerName:w.name})}else E==="KING"&&(A[`${y}/regionId`]="capital");await J(D(L,`simulation_rooms/${t}/players`),A),await J(D(L,`simulation_rooms/${t}/public_profiles`),A);const k=` ${w.name} har fullfrt ${h} og er n utnevnt til ${E==="BARON"?"Baron":"Konge"}!`;Et(t,k),await J(a,{pendingWinnerId:null,pendingRole:null})}}let b=`Bidro med ${f} ${i} til ${h}`;return m&&(b+=`  ${h} ndde niv ${g}!`),await Ae(o,p=>{var v;if(p)return((v=p.resources)==null?void 0:v[i])>=f&&(p.resources[i]-=f),p}),Et(t,`[${new Date().toLocaleTimeString()}] ${u.name}: ${b}`),{success:!0,data:{success:!0,timestamp:Date.now(),message:b,utbytte:[{resource:i,amount:-f}],xp:[],durability:[]}}},CP=async(t,e,n)=>{const s=D(L,`simulation_rooms/${t}/players`),i=await xe(s);if(!i.exists())return{success:!1,error:"No players"};const r=i.val();let a=0,o=0;const c=Object.keys(r).map(async f=>{const h=D(L,`simulation_rooms/${t}/players/${f}`);let m={gold:0,grain:0};await Ae(h,g=>{if(!g||g.role!=="PEASANT"||g.regionId!==e)return;const b=Math.floor((g.resources.gold||0)*q.TAX.PEASANT_RATE_DEFAULT),x=Math.floor((g.resources.grain||0)*q.TAX.PEASANT_RATE_DEFAULT);return b>0&&(g.resources.gold-=b,m.gold=b),x>0&&(g.resources.grain-=x,m.grain=x),g}),m.gold>0&&(a+=m.gold),m.grain>0&&(o+=m.grain)});await Promise.all(c);const u=D(L,`simulation_rooms/${t}/players/${e}`);await Ae(u,f=>{if(f)return f.resources.gold=(f.resources.gold||0)+a,f.resources.grain=(f.resources.grain||0)+o,f.status.legitimacy=Math.max(0,(f.status.legitimacy||100)-5),f});const d=`Skatteinnkreving fullfrt: ${a}g og ${o} korn.`;return Et(t,`[${new Date().toLocaleTimeString()}] ${d}`),{success:!0,data:{success:!0,timestamp:Date.now(),message:d,utbytte:[{resource:"gold",amount:a},{resource:"grain",amount:o}],xp:[],durability:[]}}},IV=async(t,e,n)=>{const s=D(L,`simulation_rooms/${t}/players/${e}`),i=await xe(s);if(!i.exists())return{success:!1,error:"Fant ikke spilleren."};const r=i.val();if(r.role!=="PEASANT")return{success:!1,error:"Du har alt en karriere."};if(n!=="SOLDIER"&&n!=="MERCHANT")return{success:!1,error:"Ugyldig karrierevalg."};const a=q.CAREERS[n];if(r.stats.level<a.LEVEL_REQ)return{success:!1,error:`Du m vre level ${a.LEVEL_REQ} for  bli ${n==="SOLDIER"?"Soldat":"Kjpmann"}.`};if((r.resources.gold||0)<a.COST)return{success:!1,error:`Du mangler ${a.COST-(r.resources.gold||0)} gull.`};let o=!1;return await Ae(s,c=>{if(c&&!(c.resources.gold<a.COST))return c.resources.gold-=a.COST,c.role=n,o=!0,c}),o?(Et(t,`[KARRIERE] ${r.name} er n en ${n}!`),{success:!0,message:`Gratulerer! Du er n en ${n==="SOLDIER"?"Soldat":"Kjpmann"}.`}):{success:!1,error:"Transaksjon feilet."}},jP=async(t,e)=>{var x,p;Xt(t,"coups","start",1);const n=D(L,`simulation_rooms/${t}/regions/${e}`),i=(await xe(n)).val(),r=i.rulerId,a=i.rulerName;if(r){const v=D(L,`simulation_rooms/${t}/players/${r}`);await Ae(v,y=>{if(y)return y.role="PEASANT",y.status.legitimacy=0,y}),await J(D(L,`simulation_rooms/${t}/public_profiles/${r}`),{role:"PEASANT"})}const o={},c=((x=i.coup)==null?void 0:x.contributions)||{},u=((p=i.coup)==null?void 0:p.preVotes)||{};Object.entries(c).sort((v,y)=>y[1].amount-v[1].amount).slice(0,3).forEach(([v,y])=>{o[v]={id:v,name:y.name,votes:0,weightedVotes:0,contribution:y.amount}});const d=Date.now(),f={startedAt:d,expiresAt:d+q.COUP.VACANCY_DURATION,candidates:o,votes:{}};let h=0;const m=D(L,`simulation_rooms/${t}/players`),b=(await xe(m)).val()||{};Object.entries(u).forEach(([v,y])=>{if(o[y]){const E=b[v];if(E){let N=q.COUP.PEASANT_VOTE_WEIGHT;E.role==="KING"&&(N=q.COUP.KING_VOTE_WEIGHT),f.votes[v]={candidateId:y,weight:N},o[y].votes+=1,o[y].weightedVotes+=N,h++}}}),await J(n,{rulerId:null,rulerName:"VAKANT",activeElection:f,"coup/bribeProgress":0,"coup/preVotes":null}),Et(t,` REVOLUSJON i ${i.name}! ${a} er styrtet. ${h} skyggelfter ble automatisk talt opp!`)},CV=async(t,e,n)=>{var y,E;const{regionId:s,amount:i}=n,r=D(L,`simulation_rooms/${t}/regions/${s}`),a=D(L,`simulation_rooms/${t}/players/${e}`),o=await xe(a);if(!o.exists())return{success:!1,error:"Fant ikke spilleren."};const c=o.val();if((((y=c.resources)==null?void 0:y.gold)||0)<i)return{success:!1,error:"Du har ikke nok gull."};const d=(await xe(r)).val();if(!d)return{success:!1,error:"Region finnes ikke."};const f=((E=d.coup)==null?void 0:E.lastRulerChange)||0,h=Date.now();if(h-f<q.COUP.HONEYMOON_DURATION&&c.role!=="KING")return{success:!1,error:`Regionen er for stabil. Prv igjen om ${Math.ceil((q.COUP.HONEYMOON_DURATION-(h-f))/6e4)} minutter.`};if(d.activeElection)return{success:!1,error:"Et valg pgr allerede."};let m=0,g=!1;if(await Ae(r,N=>{N||(N={id:s,name:s==="capital"?"Kongeriket":s==="region_vest"?"Baroniet Vest":"Baroniet st",rulerName:"Ingen",coup:{lastRulerChange:0,bribeProgress:0,contributions:{}}}),N.coup||(N.coup={lastRulerChange:0,bribeProgress:0,contributions:{}}),N.garrison||(N.garrison={swords:0,armor:0,morale:100}),N.fortification||(N.fortification={hp:1e3,maxHp:1e3,level:1});const T=N.coup.bribeProgress||0,w=i/q.COUP.BASE_BRIBE_COST*10;return e===d.rulerId?N.coup.bribeProgress=Math.max(0,T-w):(N.coup.bribeProgress=Math.min(100,T+w),N.coup.challengerId=e,N.coup.challengerName=c.name),N.coup.contributions||(N.coup.contributions={}),N.coup.contributions[e]||(N.coup.contributions[e]={name:c.name,amount:0}),N.coup.contributions[e].amount+=i,m=N.coup.bribeProgress,g=!0,N}),!g)return{success:!1,error:"Transaksjon feilet (Region oppdatert)."};await Ae(a,N=>{if(N)return N.resources.gold=(N.resources.gold||0)-i,N});const b=D(L,`simulation_rooms/${t}/players`),x=await xe(b);let p={};x.exists()&&(p=x.val());let v=d.rulerId;if(!v&&Object.keys(p).length>0){if(s==="capital"){const N=Object.values(p).find(T=>T.role==="KING");N&&(v=N.id)}else{const N=Object.values(p).find(T=>T.role==="BARON"&&T.regionId===s);N&&(v=N.id)}v&&await J(r,{rulerId:v})}if(v){const N=D(L,`simulation_rooms/${t}/players/${v}`),T=Math.floor(i/100);if(await Ae(N,w=>{if(w)return w.status&&(w.status.legitimacy=Math.max(0,(w.status.legitimacy||0)-T)),w}),Object.keys(p).length>0){const w=Object.keys(p).filter(A=>p[A].regionId===s&&A!==e&&(p[A].role==="PEASANT"||p[A].role==="SOLDIER"));if(w.length>0){const A=Math.floor(i/w.length);A>0&&await Promise.all(w.map(k=>{const R=D(L,`simulation_rooms/${t}/players/${k}/resources`);return J(R,{gold:pS(A)})})),Et(t,`[FOLKEGAVE] ${c.name} donerte ${i}g. ${w.length} innbyggere fikk ${A}g hver! (Opprr: ${m.toFixed(0)}%)`)}else Et(t,`[FOLKEGAVE] ${c.name} donerte ${i}g til saken, men fant ingen trengende i ${d.name}. (Opprr: ${m.toFixed(0)}%)`)}else Et(t,`[FOLKEGAVE] ${c.name} donerte ${i}g. (Opprr: ${m.toFixed(0)}%)`);return m>=100&&await jP(t,s),{success:!0,message:`Besteikkelse gjennomfrt! Opprr: ${m.toFixed(1)}%`}}return{success:!0,message:"Besteikkelse registrert."}},jV=async(t,e,n,s)=>{const i=D(L,`simulation_rooms/${t}/regions/${n}`);let r=!1;return await Ae(i,a=>{if(a)return a.coup||(a.coup={bribeProgress:0,contributions:{},preVotes:{}}),a.coup.preVotes||(a.coup.preVotes={}),a.coup.preVotes[e]=s,r=!0,a}),r?{success:!0,message:"Skyggelfte avgitt!"}:{success:!1,error:"Kunne ikke avgi lfte."}},OV=async(t,e,n)=>{const s=D(L,`simulation_rooms/${t}/regions/${n}`),i=D(L,`simulation_rooms/${t}/players/${e}`),r=q.COUP.RESTORE_ORDER_COST,a=await xe(i);if(!a.exists())return{success:!1,error:"Spiller mangler"};const o=a.val();if(o.resources.gold<r)return{success:!1,error:`Trenger ${r}g for  gjenopprette ro.`};let c=!1;return await Ae(s,u=>{if(!(!u||u.rulerId!==e)&&u.coup)return u.coup.bribeProgress=Math.max(0,(u.coup.bribeProgress||0)-25),c=!0,u}),c?(await Ae(i,u=>{if(u)return u.resources.gold-=r,u.status.legitimacy=Math.min(100,(u.status.legitimacy||0)+10),u}),Et(t,` ${o.name} har gjenopprettet ro i ${n} ved  dele ut midler til vaktene.`),{success:!0,message:"Ro gjenopprettet (-25% opprr)"}):{success:!1,error:"Kunne ikke gjenopprette ro."}},MV=async(t,e,n)=>{const{regionId:s,candidateId:i}=n,r=D(L,`simulation_rooms/${t}/regions/${s}`),a=D(L,`simulation_rooms/${t}/players/${e}`),o=await xe(a);if(!o.exists())return{success:!1};const c=o.val();let u=q.COUP.PEASANT_VOTE_WEIGHT;c.role==="KING"&&(u=q.COUP.KING_VOTE_WEIGHT);let d=!1;return await Ae(r,f=>{if(!f||!f.activeElection||Date.now()>f.activeElection.expiresAt)return;f.activeElection.votes||(f.activeElection.votes={});const h=f.activeElection.votes[e];if(h){const g=f.activeElection.candidates[h.candidateId];g&&(g.votes=Math.max(0,(g.votes||0)-1),g.weightedVotes=Math.max(0,(g.weightedVotes||0)-h.weight))}f.activeElection.votes[e]={candidateId:i,weight:u};const m=f.activeElection.candidates[i];return m&&(m.votes=(m.votes||0)+1,m.weightedVotes=(m.weightedVotes||0)+u),d=!0,f}),{success:d}},DV=async(t,e)=>{const n=D(L,`simulation_rooms/${t}/regions/${e}`),i=(await xe(n)).val(),r=(i==null?void 0:i.name)||e;let a=null;if(await Ae(n,o=>{if(!o||!o.activeElection||Date.now()<o.activeElection.expiresAt)return;const c=Object.values(o.activeElection.candidates);if(c.length===0)return o.rulerId=null,o.rulerName="Ingen Hersker",o.activeElection=null,o;const u=c.sort((d,f)=>f.weightedVotes-d.weightedVotes)[0];return a={winnerId:u.id,winnerName:u.name},o.rulerId=u.id,o.rulerName=u.name,o.activeElection=null,o.coup||(o.coup={lastRulerChange:Date.now(),bribeProgress:0,contributions:{}}),o.coup.lastRulerChange=Date.now(),o.coup.bribeProgress=0,o.coup.contributions={},o}),a){Xt(t,"coups","success",1);const o=a.winnerId,c=D(L,`simulation_rooms/${t}/players/${o}`),d=(await xe(c)).val(),f={};return f[`${o}/role`]="BARON",f[`${o}/regionId`]=e,await J(D(L,`simulation_rooms/${t}/players`),f),await J(D(L,`simulation_rooms/${t}/public_profiles`),f),Et(t,` KRONING: ${d.name} har vunnet valget og er n Baron av ${r}!`),{success:!0}}return{success:!1}},OP=async(t,e,n)=>{const s=D(L,`simulation_rooms/${t}/players/${e}`);let i=!1;return await Ae(s,r=>{if(r)return r.resources||(r.resources={}),r.resources.gold=(r.resources.gold||0)+n,i=!0,r}),i&&Et(t,` ADMIN: Gitt ${n}g til en spiller.`),{success:i}},MP=async(t,e,n,s)=>{const i=D(L,`simulation_rooms/${t}/players/${e}`),r=Te[n];if(!r)return{success:!1,error:"Invalid Item ID"};let a=!1;return await Ae(i,o=>{if(o){o.inventory||(o.inventory=[]);for(let c=0;c<s;c++){const u=JSON.parse(JSON.stringify(r));u.instanceId=`${n}_${Date.now()}_${Math.random().toString(36).substr(2,5)}`,o.inventory.push(u)}return a=!0,o}}),a&&Et(t,` ADMIN: Gitt ${s}x ${r.name} til en spiller.`),{success:a}},DP=async(t,e,n,s)=>{const i=D(L,`simulation_rooms/${t}/players/${e}`);let r=!1;return await Ae(i,a=>{if(a)return a.resources||(a.resources={}),a.resources[n]=(a.resources[n]||0)+s,a.resources[n]<0&&(a.resources[n]=0),r=!0,a}),r&&Et(t,` ADMIN: Gitt ${s}x ${n} til en spiller.`),{success:r}},LP=async(t,e,n,s)=>{var d;const i=D(L,`simulation_rooms/${t}/players/${e}`),r=D(L,`simulation_rooms/${t}/channels/${s}/messages`),a=await xe(i);if(!a.exists())return{success:!1,error:"Spiller mangler"};const o=a.val();let c=0;if(o.role!=="KING"&&(s==="global"?c=2:s!==o.regionId&&s!=="diplomacy"&&s.includes(e)&&s.length>20&&(c=5)),(((d=o.resources)==null?void 0:d.gold)||0)<c)return{success:!1,error:`Trenger ${c}g for  sende denne meldingen.`};let u=!1;if(c>0?await Ae(i,f=>{if(f&&!((f.resources.gold||0)<c))return f.resources.gold-=c,u=!0,f}):u=!0,!u)return{success:!1,error:"Har ikke rd."};try{const f=mS(r);return await J(f,{id:f.key,senderId:e,senderName:o.name,senderRole:o.role,content:n.trim(),timestamp:U4(),isPremiere:c>0}),{success:!0}}catch(f){return console.error("Chat Send Error:",f),{success:!1,error:`Kunne ikke sende melding: ${f.message||"Ukjent feil"}`}}},TS=(t,e,n)=>{_.useEffect(()=>{if(!t||e==="LOBBY")return;const s=setInterval(async()=>{const i=Date.now(),r=(n==null?void 0:n.lastTickAt)||0;if(!(i-r<1e3))if(i-r>=6e4){const a=D(L,`simulation_rooms/${t}/world`);try{await Ae(a,o=>{if(!o)return;const c=o.lastTickAt||0;if(Date.now()-c>=6e4){const u=(o.gameTick||0)+1;return o.gameTick=u,o.lastTickAt=Date.now(),o.season=TP(u),o.year=AP(u,1100),o}else return})}catch{}}else n!=null&&n.lastTickAt||J(D(L,`simulation_rooms/${t}/world`),{lastTickAt:Date.now()})},5e3);return()=>clearInterval(s)},[t,e,n==null?void 0:n.lastTickAt,n==null?void 0:n.gameTick])};class PP{constructor(e){ze(this,"genome");this.genome=e}decide(e,n){var c;const s=[],i=e.status.stamina,r=(1-i/100)*this.genome.weights.hungerThreshold*5;e.resources.bread>0&&i<80&&s.push({action:{type:"EAT"},score:r,reason:"Sulten"}),i<50&&s.push({action:{type:"SLEEP"},score:(1-i/100)*this.genome.weights.restFocus*3,reason:"Trtt"}),s.push({action:{type:"CHOP"},score:this.genome.weights.gatherWood*this.getNeedMultiplier(e,"wood"),reason:"Trengte ved"}),s.push({action:{type:"QUARRY"},score:this.genome.weights.gatherStone*this.getNeedMultiplier(e,"stone"),reason:"Trengte stein"}),s.push({action:{type:"MINE"},score:this.genome.weights.gatherIron*this.getNeedMultiplier(e,"iron_ore"),reason:"Trengte jernmalm"}),s.push({action:{type:"WORK"},score:this.genome.weights.gatherGrain*this.getNeedMultiplier(e,"grain"),reason:"Trengte korn"});const a=((c=n.markets)==null?void 0:c[e.regionId])||n.market;a&&Object.entries(e.resources).forEach(([u,d])=>{if(u==="gold")return;const f=a[u];if(f&&d>10){const h=f.price;s.push({action:{type:"SELL",itemId:u,amount:Math.floor(d/2)},score:this.genome.weights.marketAggression*(h/20)*(d/50),reason:`Selger ${u} for gull`})}}),e.resources.gold>200&&s.push({action:{type:"CONTRIBUTE_TO_UPGRADE",buildingId:"great_hall"},score:this.genome.weights.promotionFocus*(e.resources.gold/1e3),reason:"Vil bli mektigere"});const o=s.filter(u=>{const d=typeof u.action=="string"?u.action:u.action.type,f=fc[d];if(!f)return!0;if(i<(f.stamina||0))return!1;for(const[h,m]of Object.entries(f))if(h!=="stamina"&&(e.resources[h]||0)<m)return!1;return!0});return o.length===0?{action:"IDLE",score:0,reason:"Ingenting  gjre"}:(o.sort((u,d)=>d.score-u.score),o[0])}getNeedMultiplier(e,n){const s=e.resources[n]||0;return s<5?2:s<20?1.2:s>100?.5:1}}const BP=(t=0)=>({id:`genome_${Date.now()}_${Math.floor(Math.random()*1e3)}`,generation:t,weights:{gatherWood:Math.random()*2,gatherStone:Math.random()*2,gatherIron:Math.random()*2,gatherGrain:Math.random()*2,marketAggression:Math.random()*2,savingsFocus:Math.random()*2,upgradeFocus:Math.random()*2,hungerThreshold:.2+Math.random()*.6,restFocus:Math.random()*2,promotionFocus:Math.random()*2,contributionFocus:Math.random()*2}}),UP=(t,e=.1)=>{const n={...t.weights};return Object.keys(n).forEach(s=>{if(Math.random()<.2){const i=(Math.random()*2-1)*e;n[s]=Math.max(0,Math.min(2,n[s]+i))}}),{...t,id:`genome_${Date.now()}_${Math.floor(Math.random()*1e3)}`,weights:n,generation:t.generation+1,parents:[t.id],fitness:void 0}},_y="eiriksbok_ai_top_genomes";class cp{static calculateFitness(e,n){const s=(e.resources.gold||0)+Object.values(e.resources).reduce((o,c)=>o+(typeof c=="number"?c:0),0)*.5,r={PEASANT:1,SOLDIER:5,MERCHANT:10,BARON:50,KING:200}[e.role]||1,a=Math.max(1,(Date.now()-n)/6e4);return(s+r*100)/a}static saveTopGenomes(e){const n=[...e].filter(s=>s.fitness!==void 0).sort((s,i)=>(i.fitness||0)-(s.fitness||0)).slice(0,3);localStorage.setItem(_y,JSON.stringify(n))}static getTopGenomes(){const e=localStorage.getItem(_y);if(!e)return[];try{return JSON.parse(e)}catch{return[]}}static getNextGenerationGenome(){const e=this.getTopGenomes();if(e.length===0)return BP(0);const n=e[Math.floor(Math.random()*e.length)];return UP(n)}}const AS={CHOP:["AXE","OFF_HAND"],MINE:["PICKAXE","OFF_HAND"],QUARRY:["CHISEL","OFF_HAND"],WORK:["SCYTHE","OFF_HAND"],RAID:["MAIN_HAND","OFF_HAND","BODY","HEAD","FEET"],DEFEND:["MAIN_HAND","OFF_HAND","BODY","HEAD","FEET"],PATROL:["MAIN_HAND","OFF_HAND","BODY"],EXPLORE:["MAIN_HAND","OFF_HAND","BODY","HEAD","FEET"],CRAFT:["MAIN_HAND","AXE","PICKAXE","SCYTHE","HAMMER"],HUNT:["MAIN_HAND","BOW","TRAP"],FORAGE:["MAIN_HAND","TRAP"],GATHER_WOOL:["MAIN_HAND","OFF_HAND"],SAWMILL:["MAIN_HAND","OFF_HAND"],PLANT:["MAIN_HAND","OFF_HAND"],HARVEST:["SCYTHE","OFF_HAND","MAIN_HAND"]},up=(t,e)=>{const n=AS[e];return!n||!t.equipment?[]:n.map(s=>{var i;return(i=t.equipment)==null?void 0:i[s]}).filter(s=>{var i,r;if(!s)return!1;if((i=s.relevantActions)!=null&&i.includes(e))return!0;if(!s.relevantActions){const a=s.id.split("_").slice(0,2).join("_"),o=Te[s.id]||Te[a]||Object.values(Te).find(c=>s.id.startsWith(c.id));return(r=o==null?void 0:o.relevantActions)!=null&&r.includes(e)?!0:!o||!o.relevantActions}return!1})},ao=(t,e)=>{const n=AS[e];return!n||!t.equipment?[]:n.filter(s=>{var r,a,o;const i=(r=t.equipment)==null?void 0:r[s];if(!i)return!1;if((a=i.relevantActions)!=null&&a.includes(e))return!0;if(!i.relevantActions){const c=i.id.split("_").slice(0,2).join("_"),u=Te[i.id]||Te[c]||Object.values(Te).find(d=>i.id.startsWith(d.id));return(o=u==null?void 0:u.relevantActions)!=null&&o.includes(e)?!0:!u||!u.relevantActions}return!1})},RS=(t,e,n="Spring",s="Clear",i=0)=>{var d;let r=typeof e=="string"?e:e.type,a=typeof e=="object"?{...e}:{};r.startsWith("REFINE_")&&!wr[r]?(a.recipeId=r.replace("REFINE_","").toLowerCase(),r="REFINE"):r.startsWith("CRAFT_")&&!Rn[r]?(a.subType=r.replace("CRAFT_","").toLowerCase(),r="CRAFT"):Rn[r]&&(a.subType=r,r="CRAFT");const o=up(t,r);for(const f of o)if(f.durability<=0)return{success:!1,reason:`delagt: ${f.name}`};if(r==="GATHER_WOOL"&&o.length===0)return{success:!1,reason:"Du mangler Saks"};let c={};const u=fc[r];if(u&&(c={...u}),r==="REFINE"||r==="CRAFT"){let f;r==="REFINE"&&(f=wr[a.recipeId]),r==="CRAFT"&&(f=Rn[a.subType]),f&&(f.stamina!==void 0&&(c.stamina=f.stamina),f.input&&Object.entries(f.input).forEach(([h,m])=>{c[h]=(c[h]||0)+m}))}if(Object.keys(c).length>0){const f=An[n],h=_s[s],m=(f==null?void 0:f.staminaMod)||1,g=(h==null?void 0:h.staminaMod)||1,b=Ss(i)==="NIGHT",x=b?1.2:1,p=c.stamina||0;if(r==="SLEEP"&&!b)return{success:!1,reason:"Du kan bare sove nr det er natt"};if(r==="PLANT"&&n==="Winter")return{success:!1,reason:"Bakken er frossen - du kan ikke s om vinteren"};if(a.locationId==="farm_well"||a.locationId==="well_water"||r==="GATHER_WATER"){const N=a.locationId||(r==="GATHER_WATER"?"well_water":null);if(N){const T=(d=t.activeProcesses)==null?void 0:d.find(w=>w.type==="WELL"&&w.locationId===N);if(T&&T.readyAt>Date.now())return{success:!1,reason:"Brnnen fyller seg med vann..."}}}const y=Math.ceil(p*m*g*x);if((t.status.stamina||0)<y)return{success:!1,reason:`Du mangler ${Math.ceil(y-(t.status.stamina||0))} energi`};const E={bread:"brd",gold:"gull",wood:"tre",flour:"mel",grain:"korn",iron_ingot:"jernbarrer",plank:"planker",stone:"stein",meat:"kjtt",honey:"honning",wool:"ull",iron_ore:"jernmalm",cloth:"stoff",stamina:"energi"};for(const[N,T]of Object.entries(c)){if(N==="stamina")continue;const w=t.resources[N]||0;if(w<T){const A=E[N]||N;return{success:!1,reason:`Du mangler ${T-w} ${A}`}}}}return{success:!0}},IS=(t,e="Spring",n="Clear",s=0)=>{let i=typeof t=="string"?t:t.type,r=typeof t=="object"?{...t}:{};i.startsWith("REFINE_")&&!wr[i]?(r.recipeId=i.replace("REFINE_","").toLowerCase(),i="REFINE"):i.startsWith("CRAFT_")&&!Rn[i]?(r.subType=i.replace("CRAFT_","").toLowerCase(),i="CRAFT"):Rn[i]&&(r.subType=i,i="CRAFT");let a={};const o=fc[i];if(o&&(a={...o}),i==="REFINE"||i==="CRAFT"){let d;i==="REFINE"&&(d=wr[r.recipeId]),i==="CRAFT"&&(d=Rn[r.subType]),d&&(d.stamina!==void 0&&(a.stamina=d.stamina),d.input&&Object.entries(d.input).forEach(([f,h])=>{a[f]=(a[f]||0)+h}))}if(Object.keys(a).length===0)return null;const c=[];if(a.stamina){const d=An[e],f=_s[n],m=Ss(s)==="NIGHT"?1.2:1,g=((d==null?void 0:d.staminaMod)||1)*((f==null?void 0:f.staminaMod)||1)*m,b=Math.ceil(a.stamina*g);let x="-";a.stamina<0&&(x="+"),c.push(`${x}${Math.abs(b)}`)}const u={bread:"",gold:"",wood:"",flour:"",grain:"",iron_ingot:"",plank:"",stone:"",meat:"",honey:"",wool:"",iron_ore:"",cloth:""};for(const[d,f]of Object.entries(a)){if(d==="stamina")continue;const h=f,m=u[d]||d;c.push(`-${h}${m}`)}return c.join(" ")},HP=(t,e,n)=>{t.activeProcesses||(t.activeProcesses=[]),t.activeProcesses.push({id:`cd_${Date.now()}_${Math.random().toString(36).substr(2,5)}`,type:"COOLDOWN",locationId:e,itemId:"cooldown",notified:!1,startedAt:Date.now(),readyAt:Date.now()+n,duration:n})},GP=t=>{const{actor:e,action:n,localResult:s}=t,i=n.processId;if(!e.activeProcesses)return s.success=!1,s.message="Ingen aktive prosesser.",!1;const r=e.activeProcesses.find(o=>o.id===i);if(!r)return s.success=!1,s.message="Fant ikke avlingen (kanskje den allerede er ferdig?).",!1;if(r.type!=="CROP")return s.success=!1,s.message="Kan bare vedlikeholde avlinger.",!1;if(r.maintainCount===void 0&&(r.maintainCount=0),r.yieldBonus===void 0&&(r.yieldBonus=0),r.maintainCount>=3)return s.success=!1,s.message="Denne keren er allerede perfekt vedlikeholdt.",!1;r.maintainCount+=1,r.yieldBonus+=.05;const a=n.subType==="WEED"?"Lukte ugress":"Skremte vekk krka";return s.message=`${a}! (+5% Utbytte).`,!0},VP=t=>{var f;const{actor:e,action:n,localResult:s,timestamp:i}=t,r=n.cropId||"grain",a=j0[r];if(!a)return s.success=!1,s.message=`Ukjent grde: ${r}`,!1;if((((f=t.room.world)==null?void 0:f.season)||"Spring")==="Winter")return s.success=!1,s.message="Du kan ikke s om vinteren - bakken er frossen.",!1;e.activeProcesses||(e.activeProcesses=[]);const c=n.locationId||"grain_fields";if(e.activeProcesses.find(h=>h.type==="CROP"&&h.locationId===c))return s.success=!1,s.message="Det vokser allerede noe her.",!1;const d={id:Math.random().toString(36).substr(2,9),type:"CROP",itemId:r,locationId:c,startedAt:Date.now(),duration:a.duration,readyAt:Date.now()+a.duration,notified:!1};return e.activeProcesses.push(d),s.message=`Sdde ${a.label}. Klar om ${Math.ceil(a.duration/6e4)} min.`,!0},FP=t=>{var v,y,E;const{actor:e,action:n,localResult:s,trackXp:i,damageTool:r,room:a}=t,o=Date.now(),c=n.locationId||"grain_fields",u=(v=e.activeProcesses)==null?void 0:v.findIndex(N=>N.locationId===c&&N.readyAt<=o);if(u===void 0||u===-1)return s.success=!1,s.message="Ingenting er klart til innhsting her.",!1;const d=e.activeProcesses[u];let f="",h=0,m="",g=0,b="FARMING";const x=j0[d.itemId],p=wr[d.itemId];if(x){m=x.label,f=x.yieldResource;const N=n.performance||.5,T=x.minYield+(x.maxYield-x.minYield)*N,w=((y=a.world)==null?void 0:y.season)||"Spring",A=An[w],k=1+(d.yieldBonus||0);h=Math.ceil(T*((A==null?void 0:A.yieldMod)||1)*k),g=Math.ceil(x.xp*(1+N))}else if(p){m=p.label,f=p.outputResource;const N=((E=p.output)==null?void 0:E.amount)||p.outputAmount||1,T=n.performance||.5;h=Kn(e,N,"CRAFTING",{performance:T,isRefining:!0}),g=p.xp||10,b=p.skill||"CRAFTING"}else return s.success=!1,s.message="Ugyldig prosess-data.",!1;return e.activeProcesses.splice(u,1),ao(e,"WORK").forEach(N=>{r(N,q.DURABILITY.LOSS_WORK)}),e.resources[f]||(e.resources[f]=0),e.resources[f]+=h,s.utbytte.push({resource:f,amount:h}),s.message=`Hstet ${h} ${m}`,i(b,g),!0},zP=t=>{var x,p,v,y,E,N,T;const{actor:e,room:n,action:s,localResult:i,trackXp:r,damageTool:a}=t,o=((x=n.world)==null?void 0:x.activeLaws)||[];ao(e,"WORK").forEach(w=>{a(w,q.DURABILITY.LOSS_WORK)});let c=1;o.includes("conscription")&&(c=.8);const u=q.YIELD.WORK_GRAIN+((p=e.upgrades)!=null&&p.includes("iron_plow")?5:0),d=((v=n.world)==null?void 0:v.season)||"Spring",f=((y=n.world)==null?void 0:y.weather)||"Clear",h=An[d],m=_s[f],g=s.performance||.5,b=Kn(e,u,"FARMING",{season:(h==null?void 0:h.yieldMod)||1,weather:(m==null?void 0:m.yieldMod)||1,law:c,performance:g,actionType:"WORK",regionId:e.regionId});if(e.resources.grain=(e.resources.grain||0)+b,i.utbytte.push({resource:"grain",amount:b}),i.message=`Hstet ${b} korn`,r("FARMING",Math.ceil(dc.WORK.xp*(1+g))),Math.random()<q.LUCKY_DROP.CHANCE+(((T=(N=(E=e.equipment)==null?void 0:E.HEAD)==null?void 0:N.stats)==null?void 0:T.luckBonus)||0)){const w=Math.ceil(b*.5),A=b+w;e.resources.grain+=w,i.utbytte.push({resource:"grain",amount:w,bonus:!0}),i.message=`Innhstet ${A} korn! (inkl. ${w} flaks)`}return!0},$P=t=>{var f,h,m,g;const{actor:e,room:n,action:s,localResult:i,trackXp:r,damageTool:a}=t,o=((f=n.world)==null?void 0:f.season)||"Spring";ao(e,"CHOP").forEach(b=>{a(b,q.DURABILITY.LOSS_WORK)});let c=q.YIELD.CHOP_WOOD;o==="Summer"&&(c+=q.YIELD.SUMMER_WOOD_BONUS);const u=s.performance||.5,d=Kn(e,c,"WOODCUTTING",{performance:u,actionType:"CHOP",regionId:e.regionId});if(e.resources.wood=(e.resources.wood||0)+d,i.utbytte.push({resource:"wood",amount:d}),i.message=`Felte ${d} ved`,r("WOODCUTTING",Math.ceil(dc.CHOP.xp*(1+u))),Math.random()<q.LUCKY_DROP.CHANCE+(((g=(m=(h=e.equipment)==null?void 0:h.HEAD)==null?void 0:m.stats)==null?void 0:g.luckBonus)||0)){const b=Math.ceil(d*.5),x=d+b;e.resources.wood+=b,i.utbytte.push({resource:"wood",amount:b,bonus:!0}),i.message=`Felte ${x} ved! (inkl. ${b} flaks)`}return!0},wy=t=>{const{actor:e,action:n,localResult:s,trackXp:i,damageTool:r}=t,a=typeof n=="string"?n:n.type;ao(e,a).forEach(h=>{r(h,q.DURABILITY.LOSS_WORK)});const o="MINING",c=a==="MINE"?q.YIELD.MINE_ORE:q.YIELD.QUARRY_STONE,u=a==="MINE"?"iron_ore":"stone",d=n.performance||.5,f=Kn(e,c,o,{performance:d,actionType:a,regionId:e.regionId});return e.resources[u]=(e.resources[u]||0)+f,s.utbytte.push({resource:u,amount:f}),s.message=a==="MINE"?`Utvant ${f} jernmalm`:`Hogde ${f} stein`,i(o,Math.ceil(dc.WORK.xp*(1+d))),!0},KP=t=>{const{actor:e,action:n,localResult:s,trackXp:i,damageTool:r}=t;ao(e,"FORAGE").forEach(u=>{r(u,1)});const a=q.YIELD.FORAGE_BREAD,o=n.performance||.5,c=Kn(e,a,"FARMING",{performance:o,actionType:"FORAGE"});return e.resources||(e.resources={}),e.resources.bread=(e.resources.bread||0)+c,s.utbytte.push({resource:"bread",amount:c}),s.message=`Sanket ${c} ndproviant (brd/br)`,i("FARMING",Math.ceil(dc.FORAGE.xp*(1+o))),!0},YP=t=>{const{actor:e,action:n,localResult:s,trackXp:i,damageTool:r}=t;ao(e,"HUNT").forEach(u=>{r(u,2)});const a=8,o=n.performance||.5,c=Kn(e,a,"COMBAT",{performance:o,actionType:"HUNT"});return e.resources.meat=(e.resources.meat||0)+c,s.utbytte.push({resource:"meat",amount:c}),s.message=`Felte bytte og fikk ${c} kjtt`,i("COMBAT",Math.ceil(15*(1+o))),!0},qP=t=>{const{actor:e,action:n,localResult:s,trackXp:i}=t,r=6,a=n.performance||.5,o=Kn(e,r,"FARMING",{performance:a,actionType:"GATHER_WOOL",requiresTool:!0});return o===0?(s.message="Du trenger en Saks for  klippe sauene!",!1):(e.resources.wool=(e.resources.wool||0)+o,s.utbytte.push({resource:"wool",amount:o}),s.message=`Klippet sauer og fikk ${o} ull`,i("FARMING",Math.ceil(10*(1+a))),!0)},WP=t=>{const{actor:e,action:n,localResult:s,trackXp:i}=t,r=4,a=n.performance||.5,o=Kn(e,r,"FARMING",{performance:a,actionType:"GATHER_HONEY"});return e.resources.honey=(e.resources.honey||0)+o,s.utbytte.push({resource:"honey",amount:o}),s.message=`Hentet ${o} honning fra bikubene`,i("FARMING",Math.ceil(12*(1+a))),!0},XP=t=>{const{actor:e,localResult:n}=t,s=5;if((e.resources.grain||0)<s)return n.success=!1,n.message=`Mangler korn. Trenger ${s} korn for  mate hnene.`,!1;if(e.activeProcesses||(e.activeProcesses=[]),e.activeProcesses.find(o=>o.type==="COOP"&&o.locationId==="chicken_coop"&&o.readyAt>Date.now()))return n.success=!1,n.message="Hnene har allerede mat.",!1;e.resources.grain-=s,n.utbytte.push({resource:"grain",amount:-s});const r=24e4,a={id:Math.random().toString(36).substr(2,9),type:"COOP",itemId:"egg",locationId:"chicken_coop",startedAt:Date.now(),duration:r,readyAt:Date.now()+r,notified:!1};return e.activeProcesses.push(a),n.message="Matet hnene. Egg klare om 4 minutter.",!0},QP=t=>{var o;const{actor:e,localResult:n,trackXp:s}=t,i=Date.now(),r=(o=e.activeProcesses)==null?void 0:o.findIndex(c=>c.type==="COOP"&&c.locationId==="chicken_coop"&&c.readyAt<=i);if(r===void 0||r===-1)return n.success=!1,n.message="Ingen egg  hente enn.",!1;e.activeProcesses.splice(r,1);const a=Math.floor(Math.random()*3)+3;return e.resources.egg||(e.resources.egg=0),e.resources.egg+=a,n.utbytte.push({resource:"egg",amount:a}),n.message=`Samlet ${a} egg.`,s("FARMING",15),!0},JP=t=>{var c,u,d,f;const{actor:e,room:n,action:s,localResult:i,trackXp:r}=t,a=s.subType,o=Rn[a];if(o){if((((f=(d=(u=(c=n.world)==null?void 0:c.settlement)==null?void 0:u.buildings)==null?void 0:d[o.buildingId])==null?void 0:f.level)||1)<o.level)return i.success=!1,i.message=`Mangler bygningsniv ${o.level} for  lage dette.`,!1;let m=!0;if(Object.entries(o.input).forEach(([g,b])=>{e.resources[g]<b&&(m=!1)}),m){Object.entries(o.input).forEach(([x,p])=>{e.resources[x]-=p});const g=o.outputItemId;if(mn[g]||g==="omelette"){const x=o.outputAmount||1;e.resources[g]=(e.resources[g]||0)+x,i.utbytte.push({resource:g,amount:x});const p=Te[g];i.message=`Laget ${x}x ${(p==null?void 0:p.name)||g}!`,r("CRAFTING",25*o.level),Xt(n.pin,"crafted",g,x)}else{const x=Te[g];if(x){const p={...x,id:`${x.id}_${Date.now()}_${Math.floor(Math.random()*1e3)}`};e.inventory||(e.inventory=[]),e.inventory.push(p),i.utbytte.push({resource:g,amount:1}),i.message=`Smidde ${p.name}!`,r("CRAFTING",25*o.level),Xt(n.pin,"crafted",g,1)}}}else return i.success=!1,i.message="Mangler ressurser for  smi.",!1}else{const h=s.subType||"SWORDS",m=s.performance||.5;let g=1;h==="SWORDS"&&(g=5),h==="ARMOR"&&(g=2);const b=Kn(e,g,"CRAFTING",{performance:m});let x="swords";h==="ARMOR"&&(x="armor"),e.resources[x]=(e.resources[x]||0)+b,i.utbytte.push({resource:x,amount:b}),i.message=`Smidde ${b} ${x}`,r("CRAFTING",Math.ceil(15*(1+m)))}return!0},Lr=t=>{var c,u,d,f,h,m;const{actor:e,room:n,action:s,localResult:i,trackXp:r}=t,a=s.recipeId,o=wr[a];if(o){const g=((f=(d=(u=(c=n.world)==null?void 0:c.settlement)==null?void 0:u.buildings)==null?void 0:d[o.buildingId])==null?void 0:f.level)||1;if(o.requiredLevel&&g<o.requiredLevel)return i.success=!1,i.message=`Utvidelse kreves: ${o.buildingId} m vre Niv ${o.requiredLevel}.`,!1;let b=!0;if(Object.entries(o.input).forEach(([x,p])=>{e.resources[x]<p&&(b=!1)}),b){if(o.duration){e.activeProcesses||(e.activeProcesses=[]);const N=s.locationId||o.buildingId;if(e.activeProcesses.find(A=>A.locationId===N))return i.success=!1,i.message="Det pgr allerede en prosess her.",!1;Object.entries(o.input).forEach(([A,k])=>{e.resources[A]-=k});const w={id:Math.random().toString(36).substr(2,9),type:a==="flour"?"MILL":"CRAFT",itemId:a,locationId:N,startedAt:Date.now(),duration:o.duration,readyAt:Date.now()+o.duration,notified:!1};return e.activeProcesses.push(w),i.message=`Startet ${o.label.toLowerCase()}. Ferdig om ${Math.ceil(o.duration/6e4)} minutter.`,!0}Object.entries(o.input).forEach(([N,T])=>{e.resources[N]-=T});const x=s.performance||.5,p=((h=o.output)==null?void 0:h.amount)||o.outputAmount||1,v=Kn(e,p,"CRAFTING",{performance:x,isRefining:!0}),y=e.resources[o.outputResource]||0;e.resources[o.outputResource]=y+v;const E=((m=mn[o.outputResource])==null?void 0:m.label)||o.outputResource;i.utbytte.push({resource:o.outputResource,amount:v}),i.message=`Produserte ${v} ${E}`,r("CRAFTING",q.SKILLS.REFINING_XP),Xt(n.pin,"crafted",o.outputResource,v)}else return i.success=!1,i.message="Mangler ressurser til raffinering.",!1}return!0},ZP=t=>{var m;const{actor:e,action:n,localResult:s}=t,i=n.targetSlot,r=n.buildingId;if(!r||!sp[r])return s.success=!1,s.message="Ugyldig reparasjonsstasjon.",!1;const a=sp[r];if(!a.slots.includes(i))return s.success=!1,s.message=`Denne stasjonen kan ikke reparere ${i}.`,!1;const o=e.equipment[i];if(!o)return s.success=!1,s.message="Ingen gjenstand i dette sporet.",!1;if(o.durability>=o.maxDurability)return s.success=!1,s.message=`${o.name} er allerede i perfekt stand.`,!1;const c=a.goldCost,u=1,d=a.material,f=(e.resources.gold||0)>=c,h=(e.resources[d]||0)>=u;if(f&&h){e.resources.gold-=c,e.resources[d]-=u;const g=q.DURABILITY.REPAIR_AMOUNT,b=o.durability;o.durability=Math.min(o.maxDurability,o.durability+g);const x=o.durability-b;s.durability.push({slot:i,item:o.name,amount:x}),s.message=`Reparerte ${o.name} (+${x} holdbarhet).`}else{s.success=!1;const g=((m=mn[d])==null?void 0:m.label)||d;return s.message=`Mangler ${f?"":`${c} gull`}${!f&&!h?" og ":""}${h?"":`${u} ${g}`}.`,!1}return!0},e6=t=>{const{actor:e,action:n,localResult:s}=t,{itemId:i,slot:r}=n;e.inventory&&!Array.isArray(e.inventory)&&(e.inventory=Object.values(e.inventory)),e.inventory||(e.inventory=[]);const a=e.inventory.findIndex(o=>o.id===i);if(a!==-1){const o=e.inventory[a],c=e.equipment[r];e.inventory.splice(a,1),e.equipment[r]=o,c&&e.inventory.push(c),s.message=`Utstyrte ${o.name}`}return!0},t6=t=>{const{actor:e,action:n,localResult:s}=t,{slot:i}=n,r=e.equipment[i];return r&&(e.equipment[i]=null,e.inventory&&!Array.isArray(e.inventory)&&(e.inventory=Object.values(e.inventory)),e.inventory||(e.inventory=[]),e.inventory.push(r),s.message=`Tok av ${r.name}`),!0},n6=t=>{const{actor:e,room:n,localResult:s}=t;if(e.role!=="BARON"&&e.role!=="KING")return s.success=!1,!1;let i=0,r=0;return Object.values(n.players).forEach(a=>{if(a.role==="PEASANT"&&a.id!==e.id){const o=Math.floor((a.resources.gold||0)*q.TAX.PEASANT_RATE_DEFAULT),c=Math.floor((a.resources.grain||0)*q.TAX.PEASANT_RATE_DEFAULT);o>0&&(a.resources.gold-=o,i+=o),c>0&&(a.resources.grain-=c,r+=c)}}),e.resources.gold=(e.resources.gold||0)+i,e.resources.grain=(e.resources.grain||0)+r,i>0||r>0?(s.utbytte.push({resource:"gold",amount:i}),s.utbytte.push({resource:"grain",amount:r}),s.message=`Krevde inn skatt: ${i}g og ${r} korn fra bndene.`):s.message="Ingen skatt  kreve inn (bndene er blakke).",e.status.legitimacy=Math.max(0,(e.status.legitimacy||100)-5),!0},s6=t=>{const{actor:e,localResult:n}=t;if(e.role!=="BARON"&&e.role!=="KING")return n.success=!1,!1;const s=5,i=10;if((e.resources.gold||0)>=s&&(e.resources.grain||0)>=i)e.resources.gold-=s,e.resources.grain-=i,e.resources.manpower=(e.resources.manpower||0)+10,n.utbytte.push({resource:"manpower",amount:10}),n.message="Mobiliserte tropper (+10 Manpower).";else return n.success=!1,n.message="Mangler ressurser for  mobilisere.",!1;return!0},i6=t=>{const{actor:e,room:n,localResult:s}=t;if(e.role!=="KING")return!1;s.message="UTSTEDTE KONGELIG DEKRET: Ekstraskatt!";let i=0;return Object.values(n.players).forEach(r=>{r.role==="BARON"&&r.resources.gold>=20&&(r.resources.gold-=20,i+=20)}),e.resources.gold=(e.resources.gold||0)+i,s.utbytte.push({resource:"gold",amount:i}),!0},Ey=t=>{const{actor:e,room:n,action:s,localResult:i}=t,{buildingId:r,resource:a,amount:o}=s,c=Bt[r];if(!c)return i.success=!1,i.message=`Fant ikke bygning med ID: ${r}`,!1;const u=r==="farm_house";let d;u?(e.buildings||(e.buildings={}),e.buildings[r]||(e.buildings[r]={level:1,progress:{}}),d=e.buildings[r]):(n.world||(n.world={season:"Spring",weather:"Clear",year:1066,gameTick:0,lastTickAt:Date.now(),taxRateDetails:{kingTax:.1},settlement:{buildings:{}}}),n.world.settlement||(n.world.settlement={buildings:{}}),n.world.settlement.buildings||(n.world.settlement.buildings={}),n.world.settlement.buildings[r]||(n.world.settlement.buildings[r]={id:r,level:1,progress:{},contributions:{}}),d=n.world.settlement.buildings[r]),d.progress||(d.progress={}),e.resources||(e.resources=JSON.parse(JSON.stringify(Rt.PEASANT))),(!d.level||d.level<1)&&(d.level=1);const f=d.level+1,h=c.levels[f];if(!h)return i.success=!1,i.message="Maksimalt niv ndd.",!1;const g=(h.requirements||{})[a]||0,b=d.progress[a]||0,x=g-b;if(x<=0)return i.success=!1,i.message="Ressurskravet er allerede oppfylt.",!1;const p=e.resources[a]||0,v=Math.min(o,x,p);if(v<=0)return i.success=!1,i.message=`Kan ikke bidra 0 (Har: ${p}, Trenger: ${x}, Bud: ${o})`,!1;if(e.resources[a]=p-v,d.progress[a]=b+v,!u){d.contributions||(d.contributions={}),d.contributions[e.id]||(d.contributions[e.id]={name:e.name,resources:{}});const E=d.contributions[e.id].resources;E[a]=(E[a]||0)+v}i.message=`Bidro med ${v} ${a} til ${c.name}.`,i.utbytte.push({resource:a,amount:-v});let y=!0;return Object.entries(h.requirements).forEach(([E,N])=>{(d.progress[E]||0)<N&&(y=!1)}),y&&(d.level=f,d.progress={},u||(d.contributions={}),i.message+=`  NYTT NIV: ${c.name} ndde Niv ${f}!`),!0},r6=t=>{var c;const{actor:e,room:n,action:s,localResult:i}=t,r=typeof s=="string"?s:s.type,a=s.buildingId||r.replace("UPGRADE_BUILDING_",""),o=Bt[a];if(o){n.world.settlement||(n.world.settlement={buildings:{}});const d=(((c=n.world.settlement.buildings[a])==null?void 0:c.level)||1)+1,f=o.levels[d];if(f){let h=!0;if(Object.entries(f.requirements||{}).forEach(([m,g])=>{(e.resources[m]||0)<g&&(h=!1)}),h)Object.entries(f.requirements||{}).forEach(([m,g])=>{e.resources[m]-=g}),n.world.settlement.buildings[a]||(n.world.settlement.buildings[a]={id:a,level:1,progress:{},contributions:{}}),n.world.settlement.buildings[a].level=d,i.message=`Oppgraderte ${o.name} til Niv ${d}!`;else return i.success=!1,i.message="Mangler ressurser for oppgradering.",!1}}return!0},a6=t=>{var o;const{actor:e,action:n,localResult:s}=t,i=n.upgradeId,r=e.role,a=C0[r];if(a){const c=a.find(u=>u.id===i);if(c&&!((o=e.upgrades)!=null&&o.includes(i))){let u=!0;if(Object.entries(c.cost).forEach(([d,f])=>{e.resources[d]<f&&(u=!1)}),u)Object.entries(c.cost).forEach(([d,f])=>{e.resources[d]-=f}),e.upgrades||(e.upgrades=[]),e.upgrades.push(i),s.message=`Oppgradering fullfrt: ${c.name}`;else return s.success=!1,s.message="Har ikke rd til oppgradering.",!1}}return!0},o6=t=>{var c,u;const{actor:e,action:n,localResult:s}=t,i=n.targetRole;if(!i)return s.success=!1,s.message="Ingen rolle spesifisert.",!1;if(e.role===i)return s.success=!1,s.message=`Du er allerede ${i}.`,!1;if(["SOLDIER","MERCHANT","BARON","KING"].includes(i)&&i!=="BARON"&&i!=="KING"){const d=(c=e.roleStats)==null?void 0:c.PEASANT,f=(d==null?void 0:d.level)||(e.role==="PEASANT"?e.stats.level:1),h=q.CAREERS[i];if(h&&f<h.LEVEL_REQ)return s.success=!1,s.message=`Du m vre Bonde Niv ${h.LEVEL_REQ} for  bli ${i}. (N: ${f})`,!1}const a=((u=q.CAREERS[i])==null?void 0:u.COST)||0;if((e.resources.gold||0)<a)return s.success=!1,s.message=`Det koster ${a}g  bli ${i}. (Har: ${e.resources.gold}g)`,!1;e.roleStats||(e.roleStats={}),e.roleStats[e.role]={level:e.stats.level,xp:e.stats.xp,skills:JSON.parse(JSON.stringify(e.skills))},a>0&&(e.resources.gold-=a,s.utbytte.push({resource:"gold",amount:-a}));const o=e.roleStats[i];return o?(e.stats.level=o.level,e.stats.xp=o.xp,e.skills=o.skills):(e.stats.level=1,e.stats.xp=0,e.skills=JSON.parse(JSON.stringify(jn[i]||jn.PEASANT))),e.role=i,s.message=`Gratulerer! Du er n ${i}.`,!0},l6=t=>{const{actor:e,room:n,action:s,localResult:i}=t,{amount:r,resource:a}=s;if(e.role!=="BARON"&&e.role!=="KING")return!1;const o=e.regionId||"capital";n.regions||(n.regions={}),n.regions[o]||(n.regions[o]={id:o,name:o,defenseLevel:1,taxRate:10,rulerName:e.name});const c=n.regions[o];if(c.garrison||(c.garrison={swords:0,armor:0,morale:100}),e.inventory){const u=a==="swords"?"iron_sword":"leather_armor";let d=0;for(let h=0;h<e.inventory.length&&!((e.inventory[h].id===u||a==="swords"&&e.inventory[h].type==="MAIN_HAND"||a==="armor"&&e.inventory[h].type==="BODY")&&e.inventory[h].id===u&&(d++,d>=r));h++);if(d<r)return i.success=!1,i.message=`Mangler ${r-d} ${a==="swords"?"Jernsverd":"Lrrustninger"} i inventory.`,!1;let f=0;return e.inventory=e.inventory.filter(h=>f<r&&h.id===u?(f++,!1):!0),c.garrison[a]+=r,i.message=`Forsterket garnisonen med ${r} ${a==="swords"?"sverd":"rustninger"}.`,!0}return!1},c6=t=>{const{actor:e,room:n,localResult:s}=t;if(e.role!=="BARON"&&e.role!=="KING")return!1;const i=10,r=10,a=50;if((e.resources.stone||0)<i||(e.resources.wood||0)<r)return s.success=!1,s.message="Mangler stein eller ved for reparasjon.",!1;const o=e.regionId||"capital";if(!n.regions[o])return!1;const c=n.regions[o];return c.fortification||(c.fortification={hp:1e3,maxHp:1e3,level:1}),c.fortification.hp>=c.fortification.maxHp?(s.success=!1,s.message="Murene er allerede feilfrie.",!1):(e.resources.stone-=i,e.resources.wood-=r,c.fortification.hp=Math.min(c.fortification.maxHp,c.fortification.hp+a),s.message=`Reparerte murer (+${a} HP).`,s.utbytte.push({resource:"stone",amount:-i}),!0)},u6=t=>{const{actor:e,room:n,action:s,localResult:i}=t,{newRate:r}=s;if(e.role!=="BARON"&&e.role!=="KING")return!1;const a=Math.max(0,Math.min(20,r)),o=e.regionId||"capital";return n.regions||(n.regions={}),n.regions[o]||(n.regions[o]={id:o,name:o,defenseLevel:1,taxRate:10,rulerName:e.name}),n.regions[o].taxRate=a,i.message=`Skatteniv satt til ${a}%.`,!0},d6=.15,Ny=15,f6=t=>{var u,d,f;const{actor:e,room:n,localResult:s,action:i}=t,r=((u=i.payload)==null?void 0:u.targetRegionId)||e.regionId;if(!r||r==="capital"||r==="unassigned")return s.success=!1,s.message="Du m angi en gyldig region for  starte beleiring.",!1;if(!n.regions)return console.error("CRITICAL: room.regions is undefined in handleStartSiege",n),s.success=!1,s.message="Systemfeil: Kunne ikke hente regiondata.",!1;const a=n.regions[r];if(!a)return s.success=!1,s.message="Regionen eksisterer ikke.",!1;if(a.activeSiege)return s.success=!1,s.message="Beleiring pgr allerede!",!1;if(a.rulerName===e.name)return s.success=!1,s.message="Du kan ikke beleire ditt eget slott!",!1;const o=((d=e.resources)==null?void 0:d.swords)||0;if(o<500)return s.success=!1,s.message=`Du trenger minst 500 sverd i forsyninger for  starte en beleiring! (Eier: ${o})`,!1;const c=((f=a.fortification)==null?void 0:f.hp)||1e3;return a.activeSiege={phase:"BREACH",startedAt:Date.now(),lastTick:Date.now(),attackers:{[e.id]:{lane:1,hp:100,name:e.name}},defenders:{},gateHp:c,maxGateHp:c},s.message=`Beleiringen av ${a.name} har startet!`,!0},h6=t=>{var m,g,b;const{actor:e,room:n,localResult:s,action:i}=t,r=((m=i.payload)==null?void 0:m.targetRegionId)||e.regionId;if(!r||!((g=n.regions[r])!=null&&g.activeSiege))return s.success=!1,s.message="Ingen aktiv beleiring her.",!1;const a=n.regions[r].activeSiege,o=a.attackers||{},c=a.defenders||{};if(o[e.id]||c[e.id])return s.message="Du deltar allerede.",!1;const u=e.regionId===r,d=["BARON","KING"].includes(e.role);if(!u&&!d)return s.success=!1,s.message="Bare innbyggere eller adelen kan delta i krigfring i dette omrdet.",!1;const f=((b=i.payload)==null?void 0:b.side)==="DEFENDER",h={damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0};return f?(a.defenders||(a.defenders={}),a.defenders[e.id]={lane:1,hp:100,name:e.name,stats:h},s.message="Du forsvarer murene!"):(a.attackers||(a.attackers={}),a.attackers[e.id]={lane:1,hp:100,name:e.name,stats:h},s.message="Du har sluttet deg til beleiringen!"),!0},m6=t=>{var d,f,h,m,g,b,x,p,v,y,E,N,T,w,A;const{actor:e,room:n,action:s,localResult:i}=t,r=((d=s.payload)==null?void 0:d.targetRegionId)||e.regionId;if(!r||!((f=n.regions[r])!=null&&f.activeSiege))return i.success=!1,i.message="Ingen aktiv beleiring funnet i dette omrdet.",!1;const a=n.regions[r].activeSiege,o=a.attackers||{},c=a.defenders||{},u=o[e.id]||c[e.id];if(!u)return i.message="Du m vre deltaker i beleiringen (angriper eller forsvarer) for  delta i kapplpet.",!1;if(a.phase==="BREACH"){if(s.subType==="ATTACK_GATE"){const R=(((h=e.resources)==null?void 0:h.swords)||0)>0,C=R?25:2;return R&&(e.resources.swords-=1),a.gateHp=Math.max(0,(a.gateHp||1e3)-C),u.stats=u.stats||{damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0},u.stats.damageDealt+=C,i.message=R?` Du hugger ls p porten! (-${C} HP). Du har ${e.resources.swords} sverd igjen.`:` Du slr p porten med nevene... det gjr nesten ingen skade. (-${C} HP)`,R&&i.utbytte.push({resource:"swords",amount:-1}),a.gateHp<=0&&(a.phase="COURTYARD",a.gateHp=0,i.message="PORTEN ER KNUST! Storm borggrden!"),!0}if(s.subType==="SHIELD_WALL")return!0}if(a.phase==="COURTYARD"){const k=a;if(k.bossHp||(k.bossHp=1e4,k.maxBossHp=1e4,k.bossTargetLane=1,k.nextBossAttack=Date.now()+5e3),s.subType==="MOVE_LANE"){const B=(m=s.payload)==null?void 0:m.lane;B>=0&&B<=2&&(u.lane=B,i.message=`Forflyttet til bane ${B===0?"Venstre":B===1?"Midten":"Hyre"}.`)}s.subType==="ATTACK_BOSS"&&(k.bossHp-=25,u.stats=u.stats||{damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0},u.stats.damageDealt+=25,i.message=`Angrep Bossen! HP: ${k.bossHp}`);const R=((b=(g=n.regions[r])==null?void 0:g.fortification)==null?void 0:b.level)||1,C=d6+R*.05;if(Date.now()>k.nextBossAttack){const B=k.bossTargetLane,z=u.lane===B,$=Math.random()<C;if(z||$){const K=(z?20:0)+($?Ny:0),U=((x=e.resources)==null?void 0:x.armor)||0,O=Math.min(U,K),j=K-O;O>0&&(e.resources.armor-=O,i.utbytte.push({resource:"armor",amount:-O})),u.hp-=j,u.stats=u.stats||{damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0},u.stats.damageTaken+=K,z&&(i.message+=O>=20?"  Rustningen din tok sttet fra bossen!":"  AU! Bossen traff deg!"),$&&(i.message+=O>=Ny?"  Rustningen din stoppet pilene!":`  Piler fra murene traff deg! (-${j} HP)`),j>0&&O>0&&(i.message+=` (Rustningen absorberte ${O} skade)`)}k.bossTargetLane=Math.floor(Math.random()*3),k.nextBossAttack=Date.now()+5e3}if(k.bossHp<=0){a.phase="THRONE_ROOM";const B=n.regions[r].rulerId,z=n.players[B||""],$=z&&Date.now()-(z.lastActive||0)<6e4,K={};$&&B&&z&&(K[B]={id:B,name:z.name,armor:100,progress:20,joinedAt:Date.now()}),a.throne={mode:$?"PVP":"PVE",occupation:0,plundered:!1,bossHp:$?(((p=z==null?void 0:z.status)==null?void 0:p.hp)||100)*5:5e3,maxBossHp:$?(((v=z==null?void 0:z.status)==null?void 0:v.hp)||100)*5:5e3,defendingPlayerId:B,occupiers:K},i.message="GARNISONSSJEFEN ER BESEIRET! Drene til Tronsalen sls opp!"}return!0}if(a.phase==="THRONE_ROOM"||a.phase==="THRONE"){let k=a.throne;(!k||!k.occupiers)&&(k=k||{},k.occupiers=k.occupiers||{},k.lastTick=Date.now(),a.throne=k);const R=Date.now();if(R-(k.lastTick||0)>1e3){const C=Math.floor((R-(k.lastTick||0))/1e3);k.lastTick=R;const B=Object.values(k.occupiers||{}),z=((E=(y=n.regions[r])==null?void 0:y.garrison)==null?void 0:E.armor)||0,$=Math.min(.8,z/100*.1);B.forEach(K=>{var oe;const O=K.id===n.regions[r].rulerId?1*(1-$):1;K.armor=Math.max(0,K.armor-O*C);const j=o[K.id]||c[K.id],X=1*(1+(((oe=j==null?void 0:j.stats)==null?void 0:oe.damageDealt)||0)/200)*C;if(K.progress=Math.min(100,K.progress+X),j&&(j.stats=j.stats||{damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0},j.stats.ticksOnThrone+=C),K.armor<=0)delete k.occupiers[K.id],i.message=`${K.name} falt fra tronen! (0 Beleiringsrustning)`;else if(K.progress>=100){delete n.regions[r].activeSiege;const Ie=n.regions[r];K.id===Ie.rulerId?i.message=` ${K.name} har knust opprret og gjenopprettet kontroll over ${Ie.name}!`:(i.message=` ${K.name} har vunnet kappelpet og TATT TRONEN med makt!`,i.siegeWinnerId=K.id,i.targetRegionId=r)}})}if(s.subType==="CLAIM_THRONE"){k.occupiers||(k.occupiers={});const C=10,B=e.resources.armor||0;return B<C?(i.message=`Mangler Beleiringsrustning! Du har ${B}, men trenger ${C}.`,!1):(e.resources.armor=0,k.occupiers[e.id]={id:e.id,name:e.name,armor:B,progress:0,joinedAt:Date.now()},i.message=`${e.name} kastet seg inn i kampen om tronen med ${B} rustning!`,!0)}if(s.subType==="DONATE_ARMOR"){const C=(N=s.payload)==null?void 0:N.targetId,B=k.occupiers[C];if(!B)return i.message="Ugyldig ml.",!1;const z=e.resources.armor||0;return z<1?(i.message="Du har ingen beleiringsrustning  gi!",!1):(e.resources.armor=z-1,B.armor+=1,u.stats=u.stats||{damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0},u.stats.armorDonated+=1,i.message=`Donerte rustning til ${B.name}`,!0)}if(s.subType==="SUNDER_ARMOR"){const C=(T=s.payload)==null?void 0:T.targetId,B=k.occupiers[C];if(!B)return i.success=!1,i.message="Ingen p tronen  angripe!",!1;B.armor=Math.max(0,B.armor-1),u.stats=u.stats||{damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0},u.stats.damageDealt+=1;const z=C===n.regions[r].rulerId,$=((A=(w=n.regions[r])==null?void 0:w.garrison)==null?void 0:A.armor)||0;return z&&$>0?i.message=` Du angriper ${B.name}! Angrepet er mindre effektivt pga. slottets garnison-skjold.`:i.message=` Angrep ${B.name} p tronen!`,!0}return s.subType==="TICK",!0}return!1},p6=t=>{var o,c,u,d,f,h;const{actor:e,room:n,localResult:s,trackXp:i,damageTool:r}=t;if(e.role!=="BARON")return s.success=!1,!1;const a=Object.values(n.players).find(m=>m.role==="BARON"&&m.id!==e.id);if(a){if((((o=n.world)==null?void 0:o.activeLaws)||[]).includes("peace"))return s.success=!1,s.message="Fredsavtale blokkerer raid!",!1;const g=e.resources.manpower||0;let b=a.resources.manpower||0,x=Math.random()*.5+.75;if((c=a.upgrades)!=null&&c.includes("stone_keep")&&(b+=30),(u=a.upgrades)!=null&&u.includes("fence")&&(b+=10),(d=e.upgrades)!=null&&d.includes("stables")&&(x+=.1),(f=e.equipment)!=null&&f.MAIN_HAND&&r("MAIN_HAND",q.DURABILITY.LOSS_COMBAT_WEAPON),(h=e.equipment)!=null&&h.BODY&&r("BODY",q.DURABILITY.LOSS_COMBAT_ARMOR),g*x>b){const p=Math.floor((a.resources.gold||0)*q.COMBAT.RAID_LOOT_FACTOR),v=Math.floor((a.resources.grain||0)*q.COMBAT.RAID_LOOT_FACTOR);a.resources.gold=Math.max(0,(a.resources.gold||0)-p),a.resources.grain=Math.max(0,(a.resources.grain||0)-v),e.resources.gold=(e.resources.gold||0)+p,e.resources.grain=(e.resources.grain||0)+v,e.resources.manpower=Math.max(0,e.resources.manpower-5),a.resources.manpower=Math.max(0,a.resources.manpower-8),s.utbytte.push({resource:"gold",amount:p}),s.utbytte.push({resource:"grain",amount:v}),s.message=`Plyndret ${a.name} for ${p}g og ${v} korn!`,i("COMBAT",50)}else return e.resources.manpower=Math.max(0,e.resources.manpower-10),s.success=!1,s.message=`Angrepet p ${a.name} ble sltt tilbake.`,i("COMBAT",10),!1}else return s.success=!1,s.message="Fant ingen annen baron  raide.",!1;return!0},g6=t=>{const{actor:e,action:n,localResult:s,trackXp:i}=t,r=n.performance||.5,a=Math.ceil(15*r);return e.resources.gold=(e.resources.gold||0)+a,i("COMBAT",10),s.utbytte.push({resource:"gold",amount:a}),s.message="Utfrte patrulje.",!0},v6=t=>{var d;const{actor:e,room:n,action:s,localResult:i}=t,{resource:r}=s,a=e.regionId||"capital";let o=((d=n.markets)==null?void 0:d[a])||n.market;if(o||(n.markets||(n.markets={}),o=JSON.parse(JSON.stringify(xt)),n.markets[a]=o),!o)return i.success=!1,i.message="Markedet er ikke tilgjengelig.",!1;if(!o[r]&&xt[r]&&(o[r]={...xt[r]}),!o[r])return i.success=!1,i.message="Markedet tilbyr ikke denne varen her.",!1;const c=o[r];if(!c)return i.success=!1,i.message="Varen finnes ikke p dette markedet.",!1;const u=c.price;return c.stock<=0?(i.success=!1,i.message="Varen er utsolgt.",!1):(e.resources.gold||0)<u?(i.success=!1,i.message="Du har ikke nok gull.",!1):(e.resources.gold=(e.resources.gold||0)-u,e.resources[r]=(e.resources[r]||0)+1,c.stock-=1,c.price+=c.price*q.MARKET.PRICE_IMPACT_BUY,i.message=`Kjpte 1 ${r} for ${u.toFixed(2)}g`,i.utbytte.push({resource:r,amount:1}),!0)},b6=t=>{var d;const{actor:e,room:n,action:s,localResult:i}=t,{resource:r}=s,a=e.regionId||"capital";let o=((d=n.markets)==null?void 0:d[a])||n.market;if(o||(n.markets||(n.markets={}),o=JSON.parse(JSON.stringify(xt)),n.markets[a]=o),!o)return i.success=!1,i.message="Markedet er ikke tilgjengelig.",!1;if(!o[r]&&xt[r]&&(console.log(`Lazy patching market: Adding missing ${r}`),o[r]={...xt[r]}),!o[r])return i.success=!1,i.message="Markedet tar ikke imot denne varen her.",!1;if((e.resources[r]||0)<1)return i.success=!1,i.message=`Du har ingen ${r}  selge.`,!1;const c=o[r];if(!c)return i.success=!1,i.message="Markedet tar ikke imot denne varen.",!1;const u=c.price*q.MARKET.SELL_RATIO;return e.resources[r]-=1,e.resources.gold=(e.resources.gold||0)+u,c.stock+=1,c.price-=c.price*q.MARKET.PRICE_IMPACT_SELL,i.message=`Solgte 1 ${r} for ${u.toFixed(2)}g`,!0},x6=t=>{var g,b;const{actor:e,room:n,action:s,localResult:i,trackXp:r}=t,{resource:a,targetRegionId:o,action:c}=s,u=e.regionId||"capital",d=((g=n.markets)==null?void 0:g[u])||n.market,f=(b=n.markets)==null?void 0:b[o];if(!d||!f||!d[a]||!f[a])return i.success=!1,i.message="Ugyldig handelsrute eller vare.",!1;const h=d[a],m=f[a];if(!h||!m)return i.success=!1,i.message="Varen handles ikke p disse markedene.",!1;if(c==="IMPORT"){const p=m.price*5;if((e.resources.gold||0)<p)return i.success=!1,i.message="Ikke nok gull til bulk-import.",!1;if(m.stock<5)return i.success=!1,i.message="Mangler bulk-lager ved kilden.",!1;e.resources.gold-=p,e.resources[a]=(e.resources[a]||0)+5,m.stock-=5,m.price+=m.price*.02,i.message=`Importerte 5 ${a} fra ${o} for ${p.toFixed(2)}g`}else{if((e.resources[a]||0)<5)return i.success=!1,i.message=`Mangler 5 ${a} for eksport.`,!1;const p=m.price*q.MARKET.SELL_RATIO*5;e.resources[a]-=5,e.resources.gold+=p,m.stock+=5,m.price-=m.price*.02,i.message=`Eksporterte 5 ${a} til ${o} for ${p.toFixed(2)}g`}return r("TRADING",25),!0},y6=t=>{var o;const{actor:e,room:n,localResult:s}=t;if(!(Ss(((o=n.world)==null?void 0:o.gameTick)||0)==="NIGHT"))return s.success=!1,s.message=" Du kan bare sove nr det er natt.",!1;const a=100-(e.status.stamina||0);return e.status.stamina=100,e.status.hp=Math.min(100,(e.status.hp||100)+20),e.activeBuffs||(e.activeBuffs=[]),e.activeBuffs=e.activeBuffs.filter(c=>c.type!=="STAMINA_SAVE"||c.label!=="Godt utvilt"),e.activeBuffs.push({id:"well_rested_"+Date.now(),type:"STAMINA_SAVE",value:.5,label:"Godt utvilt",description:"50% mindre stamina-forbruk etter en god natts svn.",expiresAt:Date.now()+3e5}),s.message="Du sov tungt gjennom natten. Vknet opp uthvilt og full av energi!",s.utbytte.push({resource:"stamina",amount:a}),!0},Gc=t=>{var d;const{actor:e,action:n,localResult:s}=t,i=typeof n=="string"?n:n.type,r=n.locationId;let a=30,o=0,c="Hvilte.";if(i==="EAT"&&(a=40,c="Satt ved varmen og spiste."),i==="FEAST"&&(a=100,o=20,c="Holdt gjestebud!"),i==="GATHER_WATER"||r==="farm_well"||r==="well_water"){e.activeProcesses||(e.activeProcesses=[]);const f=r||(i==="GATHER_WATER"?"well_water":null);if(f){const h=e.activeProcesses.find(m=>m.type==="WELL"&&m.locationId===f);if(h){if(h.readyAt>Date.now())return s.success=!1,s.message="Brnnen er tom. Den fyller seg med vann...",!1;e.activeProcesses=e.activeProcesses.filter(m=>m.id!==h.id)}a=5,c="Drakk friskt vann fra brnnen.",e.activeProcesses.push({id:"well_"+Date.now(),type:"WELL",itemId:"water",locationId:f,startedAt:Date.now(),duration:3e5,readyAt:Date.now()+3e5,notified:!1})}}return r==="village_square"&&(a=10,c="Hvilte p torget.",HP(e,"REST_SQUARE",6*60*1e3)),(d=e.upgrades)!=null&&d.includes("roof")&&(a+=20),r==="royal_chambers"&&(a=100,o=100,c="Hvilte ut i de kongelige kamrene. Fler deg som en konge igjen!",e.activeBuffs||(e.activeBuffs=[]),e.activeBuffs=e.activeBuffs.filter(f=>f.label!=="Kongelig Velvre"),e.activeBuffs.push({id:"royal_wellness_"+Date.now(),type:"STAMINA_SAVE",value:.6,label:"Kongelig Velvre",description:"Fyrstelig velvre reduserer stamina-forbruk med 60%.",expiresAt:Date.now()+6e5})),e.status.stamina=Math.min(100,(e.status.stamina||0)+a),o>0&&(e.status.hp=Math.min(100,(e.status.hp||100)+o)),s.utbytte.push({resource:"stamina",amount:a}),s.message=c,!0},_6=t=>{const{actor:e,localResult:n,trackXp:s}=t,i=Math.floor(Math.random()*5)+1;return e.resources.favor=(e.resources.favor||0)+i,n.utbytte.push({resource:"favor",amount:i}),s("THEOLOGY",10),n.message=`Ba til gudene. (+${i} velvilje)`,!0},w6=t=>{const{localResult:e}=t,n=["Baronen ser nervs ut i dag.","Hrte du ulvene i natt?","Prisen p korn gr opp.","Kongens soldater er p vei."];return e.message=`Sladder: "${n[Math.floor(Math.random()*n.length)]}"`,!0},E6=t=>{const{actor:e,action:n,localResult:s}=t,{amount:i,isWin:r,playerRoll:a,houseRoll:o}=n;return r?(e.resources.gold=(e.resources.gold||0)+i,s.utbytte.push({resource:"gold",amount:i}),s.message=`Vant ${i}g p terninger! (${a} mot ${o})`):(e.resources.gold=Math.max(0,(e.resources.gold||0)-i),s.message=`Tapte ${i}g p terninger. (${a} mot ${o})`),!0},N6=t=>{const{actor:e,localResult:n}=t,s=5;if((e.resources.gold||0)>=s){e.resources.gold-=s;const i=10;e.status.stamina=Math.min(100,(e.status.stamina||0)+i),n.utbytte.push({resource:"stamina",amount:i}),n.message="Kjpte et mltid i baren. (+10 Stamina)"}else return n.success=!1,n.message="Har ikke rd til mat (koster 5g).",!1;return!0},k6=t=>{const{actor:e,room:n,localResult:s}=t;return s.message=`${e.name} har valgt  trekke seg tilbake fra dette livet.`,delete n.players[e.id],!0},S6=t=>{const{actor:e,action:n,localResult:s,room:i}=t,r=n.itemId;if(n.isResource)return(e.resources[r]||0)<1?(s.success=!1,s.message="Du har ikke mer igjen.",!1):r==="omelette"?(e.activeBuffs||(e.activeBuffs=[]),e.activeBuffs=e.activeBuffs.filter(d=>d.type!=="STAMINA_SAVE"),e.activeBuffs.push({id:Math.random().toString(36).substr(2,9),type:"STAMINA_SAVE",value:.2,label:"Lett til beins",description:"Reduserer stamina-kostnad med 20%.",expiresAt:Date.now()+9e5,sourceItem:"omelette"}),e.resources.omelette--,s.message="Spiste Omelett. (20% stamina-spare buff)",s.utbytte.push({resource:"omelette",amount:-1}),Xt(i.pin,"consumed","omelette",1),!0):r==="bread"?(e.status.stamina=Math.min(100,(e.status.stamina||0)+20),e.resources.bread--,s.message="Spiste Brd. (+20 Stamina)",s.utbytte.push({resource:"stamina",amount:20}),s.utbytte.push({resource:"bread",amount:-1}),Xt(i.pin,"consumed","bread",1),!0):(s.success=!1,s.message="Kan ikke spises (ukjent ressurs).",!1);if(!e.inventory)return s.success=!1,s.message="Ryggsekk er tom.",!1;const o=e.inventory.findIndex(u=>u.id===r);if(o===-1)return s.success=!1,s.message="Fant ikke gjenstanden.",!1;const c=e.inventory[o];return c.id==="omelette"||c.id.startsWith("omelette_")?(e.activeBuffs||(e.activeBuffs=[]),e.activeBuffs=e.activeBuffs.filter(u=>u.type!=="STAMINA_SAVE"),e.activeBuffs.push({id:Math.random().toString(36).substr(2,9),type:"STAMINA_SAVE",value:.2,label:"Lett til beins",description:"Reduserer stamina-kostnad med 20%.",expiresAt:Date.now()+9e5,sourceItem:"omelette"}),e.inventory.splice(o,1),s.message="Spiste Omelett (Gjenstand).",s.utbytte.push({resource:"omelette",amount:-1}),Xt(i.pin,"consumed","omelette",1),!0):c.id==="bread"||c.id.startsWith("bread_")?(e.status.stamina=Math.min(100,(e.status.stamina||0)+20),e.inventory.splice(o,1),s.message="Spiste Brd (Gjenstand). (+20 Stamina)",s.utbytte.push({resource:"stamina",amount:20}),s.utbytte.push({resource:"stamina",amount:20}),s.utbytte.push({resource:"bread",amount:-1}),Xt(i.pin,"consumed","bread",1),!0):(s.success=!1,s.message="Kan ikke spises.",!1)},CS={WORK:zP,CHOP:$P,MINE:wy,QUARRY:wy,FORAGE:KP,HUNT:YP,GATHER_WOOL:qP,GATHER_HONEY:WP,PLANT:VP,HARVEST:FP,MAINTAIN_CROP:GP,CRAFT:JP,REFINE:Lr,BAKE:Lr,MILL:Lr,SMELT:Lr,WEAVE:Lr,MIX:Lr,REPAIR:ZP,EQUIP_ITEM:e6,UNEQUIP_ITEM:t6,TAX:n6,DRAFT:s6,DECREE:i6,CONSTRUCT:Ey,CONTRIBUTE_TO_UPGRADE:Ey,UPGRADE_BUILDING:r6,UPGRADE:a6,JOIN_ROLE:o6,REINFORCE_GARRISON:l6,REPAIR_WALLS:c6,SET_TAX:u6,START_SIEGE:f6,JOIN_SIEGE:h6,SIEGE_ACTION:m6,RAID:p6,PATROL:g6,SLEEP:y6,REST:Gc,EAT:Gc,FEAST:Gc,PRAY:_6,CHAT_LOCAL:w6,GAMBLE_RESULT:E6,BUY_MEAL:N6,RETIRE:k6,CONSUME:S6,FEED_CHICKENS:XP,COLLECT_EGGS:QP,GATHER_WATER:Gc,TRADE_ROUTE:x6,BUY:v6,SELL:b6},T6=(t,e,n,s)=>{var u,d;t.roleStats||(t.roleStats={});const i=t.role;t.roleStats[i]||(t.roleStats[i]={level:((u=t.stats)==null?void 0:u.level)||1,xp:((d=t.stats)==null?void 0:d.xp)||0,skills:JSON.parse(JSON.stringify(t.skills||jn[i]||jn.PEASANT))});const r=t.roleStats[i],a=r.skills[e];a&&(a.xp+=n||0,a.xp>=a.maxXp&&(a.level+=1,a.xp-=a.maxXp,a.maxXp=Math.floor(a.maxXp*1.5),s.push(` ${t.name} ble bedre i ${e}! (Niv ${a.level})`))),r.xp=(r.xp||0)+(n||0);const c=(f=>{const h=bd.findIndex(m=>f<m);return h===-1?bd.length:h})(r.xp);c>r.level&&(r.level=c,s.push(` ${t.name} har steget i rang som ${i} til Niv ${c}!`)),t.stats.xp=r.xp,t.stats.level=r.level,t.skills=r.skills};async function A6(t,e,n){var i,r,a;if(!t||!n)return;const s=D(L,`simulation_accounts/${t}`);try{const o=await xe(s);if(!o.exists())return;const c=o.val(),u=c.characterHistory||[],d={name:n.name,role:n.role,level:((i=n.stats)==null?void 0:i.level)||1,xp:((r=n.stats)==null?void 0:r.xp)||0,roomPin:e,timestamp:Date.now()},f=[...u,d],h=((a=n.stats)==null?void 0:a.xp)||0,m=(c.globalXp||0)+h,g=Math.floor(Math.sqrt(m/100))+1;await J(s,{characterHistory:f,globalXp:m,globalLevel:g,lastActive:Date.now()}),console.log(`Character life recorded for ${n.name} (${t})`)}catch(o){console.error("Failed to record character life:",o)}}async function R6(t,e,n){const s=typeof n=="string"?n:n.type,i=D(L,`simulation_rooms/${t}/players/${e}`),r=D(L,`simulation_rooms/${t}/regions`),a=D(L,`simulation_rooms/${t}/world`);try{const[o,c,u]=await Promise.all([xe(i),xe(r),xe(a)]);if(!o.exists())return{success:!1,error:"Spiller finnes ikke"};const d=o.val();d.resources||(d.resources=Rt[d.role]||Rt.PEASANT);const f=c.val()||{},h=u.val()||{},m={success:!0,timestamp:Date.now(),message:"",utbytte:[],xp:[],durability:[]},g={world:h,regions:f,players:{[e]:d},markets:{},messages:[]},b={actor:d,room:g,pin:t,action:n,timestamp:new Date().toLocaleTimeString(),localResult:m,trackXp:(N,T)=>{},damageTool:()=>!0},x=CS[s];if(!x)return{success:!1,error:"Ukjent handling"};if(!x(b)||!m.success)return{success:!1,data:m};const v={};v[`players/${e}`]=d;const y=m.siegeWinnerId,E=m.targetRegionId;if(y&&E){const N=f[E],T=N.rulerId;if(T&&T!==y){const A=await xe(D(L,`simulation_rooms/${t}/players/${T}`));if(A.exists()){const k=A.val();k.role="PEASANT",k.status&&(k.status.legitimacy=0),v[`players/${T}`]=k,v[`public_profiles/${T}/role`]="PEASANT",Xt(t,"roleChanges","PEASANT (Demoted)",1)}}const w=await xe(D(L,`simulation_rooms/${t}/players/${y}`));if(w.exists()){const A=w.val();A.role="BARON",A.regionId=E,A.status&&(A.status.legitimacy=100),v[`players/${y}`]=A,v[`public_profiles/${y}/role`]="BARON",v[`public_profiles/${y}/regionId`]=E,N.rulerId=y,N.rulerName=A.name}}return v.regions=f,await J(D(L,`simulation_rooms/${t}`),v),{success:!0,data:m}}catch(o){return console.error("Siege Transaction Failed",o),{success:!1,error:o.message||"Beleiring feilet"}}}const I6=["RAID","TAX","TAX_PEASANTS","TAX_ROYAL","TRADE","TRADE_ROUTE","CONTRIBUTE_TO_UPGRADE","BUY","SELL","CONTRIBUTE","CONSTRUCT","UPGRADE_BUILDING","START_SIEGE","JOIN_SIEGE","SIEGE_ACTION"],jS=async(t,e,n)=>{const s=typeof n=="string"?n:n.type;return I6.includes(s)?j6(t,e,n):C6(t,e,n)};async function C6(t,e,n){const s=D(L,`simulation_rooms/${t}/players/${e}`),i=D(L,`simulation_rooms/${t}/world`);let r=null;try{const a=await xe(i),o=a.exists()?a.val():{season:"Spring",weather:"Clear",activeLaws:[]};if(await Ae(s,c=>{var E,N,T;if(!c)return c;c.resources||(c.resources=JSON.parse(JSON.stringify(Rt[c.role]||Rt.PEASANT))),c.skills||(c.skills=JSON.parse(JSON.stringify(jn[c.role]||jn.PEASANT))),c.status||(c.status={stamina:100,hp:100,authority:0,gold:c.resources.gold||0,level:1,xp:0}),c.equipment||(c.equipment={HEAD:null,BODY:null,MAIN_HAND:null,OFF_HAND:null,FEET:null,TRINKET:null,AXE:null,PICKAXE:null,SCYTHE:null,HAMMER:null}),c.stats||(c.stats={level:1,xp:0}),c.activeBuffs||(c.activeBuffs=[]);const u={success:!0,timestamp:Date.now(),message:"",utbytte:[],xp:[],durability:[]},d=(w,A)=>{var B,z,$,K;const k=((z=(B=c.skills)==null?void 0:B[w])==null?void 0:z.level)||0,R=[];T6(c,w,A,R),R.length>0&&(u.message+=" "+R.join(" "));const C=((K=($=c.skills)==null?void 0:$[w])==null?void 0:K.level)||0;u.xp.push({skill:w,amount:A,levelUp:C>k})},f=c.stats.level||1,h=(w,A)=>{var R;const k=(R=c.equipment)==null?void 0:R[w];return k&&(k.durability=Math.max(0,k.durability-A),u.durability.push({slot:w,item:k.name||"Gjenstand",amount:A,broken:k.durability<=0}),k.durability<=0)?(u.message=` ${k.name} ble delagt!`,u.success=!1,!1):!0},m=Date.now(),g=m-(c.lastActive||m),b=Math.min(60,isNaN(g)?0:g/6e4);if(b>.1){let w=0;(E=c.upgrades)!=null&&E.includes("cow")&&(w+=b*q.PASSIVE_INCOME.COW),(N=c.upgrades)!=null&&N.includes("accounting_books")&&(w+=b*q.PASSIVE_INCOME.ACCOUNTING_BOOKS),(T=c.upgrades)!=null&&T.includes("caravan")&&(w+=b*q.PASSIVE_INCOME.CARAVAN),w>0&&(c.resources.gold=(c.resources.gold||0)+Math.floor(w));const A=b*2;c.status.stamina=Math.min(100,(c.status.stamina||0)+A)}const x=c.role,p=typeof n=="string"?n:n.type,v=fc[p];if(v){const w=fs(v.stamina||0,o.season,o.weather,c.activeBuffs,o.gameTick||0);for(const[A,k]of Object.entries(v)){if(A==="stamina")continue;const R=A;if((c.resources[R]||0)<k)return u.success=!1,u.message=` Mangler ${k} ${A}!`,r=u,c}if((c.status.stamina||0)<w)return u.success=!1,u.message=` For sliten! (${w} kreves)`,r=u,c;for(const[A,k]of Object.entries(v)){if(A==="stamina")continue;const R=A;c.resources[R]=(c.resources[R]||0)-k,Xt(t,"consumed",A,k)}c.status.stamina-=w}const y=CS[p];if(y){const w={actor:c,room:{world:o,players:{[e]:c},messages:[]},pin:t,action:n,timestamp:new Date().toLocaleTimeString(),localResult:u,trackXp:d,damageTool:h};if(y(w)===!1)return r=u,c}else u.success=!1,u.message=`Ukjent handling: ${p}`;return u.message||(u.message="Handling utfrt."),u.success&&Math.random()<.005&&(c.resources.gold=(c.resources.gold||0)+150,u.utbytte.push({id:"ancient_relic",name:"Gammel Relikvie",type:"ITEM",icon:"",amount:1,jackpot:!0}),u.message+="  ET JORDFUNN! Du fant en eldgammel relikvie!"),c.lastActive=Date.now(),r=u,p==="RETIRE"&&u.success&&(r.characterSnapshot=JSON.parse(JSON.stringify(c))),c.stats.level>f&&(r.newLevel=c.stats.level),c.role!==x&&Xt(t,"roleChanges",c.role,1),c}),r&&r.success){if(r.message&&await Et(t,`[${new Date().toLocaleTimeString()}] ${r.message}`),r.utbytte&&r.utbytte.length>0&&r.utbytte.forEach(c=>{const u=c.type==="ITEM"?"crafted":"produced";Xt(t,u,c.id||c.resource,c.amount||1)}),r.characterSnapshot){const c=r.characterSnapshot.uid||e;await A6(c,t,r.characterSnapshot)}if(r.newLevel)try{await J(D(L,`simulation_rooms/${t}/public_profiles/${e}`),{"stats/level":r.newLevel,lastActive:Date.now()})}catch(c){console.error("Failed to sync level",c)}}return{success:!!(r!=null&&r.success),data:r||void 0}}catch(a){return console.error("Action error:",a),{success:!1,error:a.message||"Handling feilet"}}}async function j6(t,e,n){const s=typeof n=="string"?n:n.type;try{return s==="BUY"||s==="SELL"||s==="TRADE_ROUTE"?await RP(t,e,n):s==="CONTRIBUTE"||s==="CONTRIBUTE_TO_UPGRADE"||s==="CONSTRUCT"||s==="UPGRADE_BUILDING"?await IP(t,e,n):s==="TAX"||s==="TAX_PEASANTS"||s==="TAX_ROYAL"?await CP(t,e,n):s==="START_SIEGE"||s==="JOIN_SIEGE"||s==="SIEGE_ACTION"?await R6(t,e,n):{success:!1,error:"Global handling not available."}}catch(i){return console.error("Global Action ERROR:",i),{success:!1,error:i.message||"Global handling feilet"}}}class O6{constructor(e,n){ze(this,"player");ze(this,"genome");ze(this,"brain");ze(this,"startTime");ze(this,"history",[]);ze(this,"status","RUNNING");ze(this,"lastActionAt",0);ze(this,"stuckThreshold",6e4);this.player=e,this.genome=n,this.brain=new PP(n),this.startTime=Date.now()}async tick(e,n){if(this.status!=="RUNNING")return;const s=this.brain.decide(this.player,e);if(this.history.push(s),this.history.length>20&&this.history.shift(),s.action==="IDLE"){Date.now()-this.lastActionAt>this.stuckThreshold&&(this.status="STUCK",this.dumpLog("Bottleneck detected: Stuck for > 60s"));return}this.lastActionAt=Date.now(),(await jS(n,this.player.id,s.action)).success,this.player.role==="KING"&&(this.status="SUCCESS")}getFitness(){return cp.calculateFitness(this.player,this.startTime)}dumpLog(e){const n={reason:e,genome:this.genome,history:this.history,playerState:this.player,timestamp:Date.now()};console.error("AI Training Lab - Game Balance Issue:",n),window.lastAILog=n}}const M6=({roomData:t,pin:e})=>{var N;const[n,s]=_.useState([]),[i,r]=_.useState(0),[a,o]=_.useState(!1),[c,u]=_.useState([]),[d,f]=_.useState({}),[h,m]=_.useState({}),[g,b]=_.useState(null),x=_.useRef(t);_.useEffect(()=>{x.current=t},[t]);const p=_.useRef(null),v=async()=>{const T={};for(let w=1;w<=5;w++){const A=`bot_${Date.now()}_${w}`,k={id:A,name:`BOT Alpha ${w}`,role:"PEASANT",regionId:Math.random()>.5?"region_ost":"region_vest",resources:{...Rt.PEASANT},status:{hp:100,stamina:100,morale:100,legitimacy:100,authority:50,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:1,xp:0,reputation:10,contribution:0},skills:{...jn.PEASANT},lastActive:Date.now(),online:!0};T[`simulation_rooms/${e}/players/${A}`]=k,T[`simulation_rooms/${e}/public_profiles/${A}`]={id:A,stats:{level:1},status:k.status,online:!0,lastActive:Date.now()}}try{await J(D(L),T)}catch(w){console.error("Failed to spawn bots",w)}},y=()=>{t.players&&o(!0)},E=()=>{o(!1),p.current&&cancelIdleCallback(p.current)};return _.useEffect(()=>{if(a){const T=async()=>{const w=x.current,A=Object.values(w.players||{}).filter(k=>k.name.includes("BOT"));await Promise.all(A.map(async k=>{let R=n.find(C=>C.player.id===k.id);if(R)R.player=k;else{const C=cp.getNextGenerationGenome();R=new O6(k,C),s(B=>[...B,R]),r(C.generation)}if(await R.tick(w,e),R.history.length>0){const C=R.history[R.history.length-1];let B=C.action.type||"IDLE";B==="SELL"&&C.action.itemId?B=`SELL (${C.action.itemId})`:B==="BUY"&&C.action.itemId&&(B=`BUY (${C.action.itemId})`),f(z=>({...z,[B]:(z[B]||0)+1})),m(z=>({...z,[R.player.id]:{name:R.player.name,action:B,reason:C.reason,score:C.score.toFixed(2),fitness:R.getFitness().toFixed(1),resources:{...R.player.resources},stamina:R.player.status.stamina}}))}if((R.status==="STUCK"||R.status==="DEAD")&&b(window.lastAILog),R.status==="SUCCESS"||R.status==="DEAD"||R.status==="STUCK"){const C=R.getFitness();R.genome.fitness=C,cp.saveTopGenomes([R.genome]),u(B=>[...B.slice(-19),C])}})),p.current=window.setTimeout(()=>T(),1e3)};T()}return()=>{p.current&&clearTimeout(p.current)}},[a,e]),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center bg-slate-900/50 p-6 rounded-2xl border border-white/10",children:[l.jsxs("div",{children:[l.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[l.jsx(l3,{className:"text-indigo-400"})," AI Training Lab"]}),l.jsx("p",{className:"text-slate-400 text-sm",children:"Genetisk Algoritme-optimalisering av spillbalanse"})]}),l.jsx("div",{className:"flex gap-3",children:a?l.jsxs("button",{onClick:E,className:"bg-red-600 hover:bg-red-500 px-4 py-2 rounded-lg flex items-center gap-2 font-bold transition-all",children:[l.jsx(ap,{size:18})," Stopp Trening"]}):l.jsxs("button",{onClick:y,className:"bg-indigo-600 hover:bg-indigo-500 px-4 py-2 rounded-lg flex items-center gap-2 font-bold transition-all",children:[l.jsx(yd,{size:18})," Start Trening"]})})]}),a&&Object.values(t.players||{}).filter(T=>T.name.includes("BOT")||T.id.startsWith("bot_")).length===0&&l.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/20 p-6 rounded-2xl flex items-center justify-between animate-in slide-in-from-top-2",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:"bg-amber-500/20 p-3 rounded-full text-amber-500",children:l.jsx(P0,{size:24})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-amber-500 font-black uppercase text-sm",children:"Ingen bot-subjekter funnet"}),l.jsx("p",{className:"text-amber-200/60 text-xs",children:"AI-en trenger kropper  kontrollere (navn med 'BOT' eller ID 'bot_')."})]})]}),l.jsx("button",{onClick:v,className:"bg-amber-500 hover:bg-amber-400 text-black px-6 py-3 rounded-xl font-black uppercase text-xs tracking-widest transition-all shadow-lg hover:scale-105",children:" Spawn Alpha Squad (5 stk)"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[l.jsxs("div",{className:"bg-slate-900/50 p-6 rounded-2xl border border-white/10",children:[l.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-xs uppercase font-black mb-2",children:[l.jsx(gy,{size:14})," Generasjon"]}),l.jsx("div",{className:"text-4xl font-black",children:i})]}),l.jsxs("div",{className:"bg-slate-900/50 p-6 rounded-2xl border border-white/10 flex flex-col justify-between",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-xs uppercase font-black mb-2",children:[l.jsx(oP,{size:14})," Fitness Trend"]}),l.jsx("div",{className:"text-4xl font-black mb-4",children:c.length>0?(c.reduce((T,w)=>T+w,0)/c.length).toFixed(1):"0.0"})]}),l.jsxs("div",{className:"h-12 flex items-end gap-1 px-1",children:[c.map((T,w)=>{const A=Math.max(...c,1),k=T/A*100;return l.jsx("div",{className:"flex-1 bg-indigo-500/50 rounded-t-sm transition-all duration-500 hover:bg-indigo-400",style:{height:`${k}%`},title:`Fitness: ${T.toFixed(1)}`},w)}),c.length===0&&l.jsx("div",{className:"w-full h-[1px] bg-white/10"})]})]}),l.jsxs("div",{className:"bg-slate-900/50 p-6 rounded-2xl border border-white/10 text-amber-500",children:[l.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-xs uppercase font-black mb-2",children:[l.jsx(yy,{size:14})," Bottlenecks"]}),l.jsx("div",{className:"text-4xl font-black text-amber-500",children:n.filter(T=>T.status==="STUCK").length})]})]}),l.jsxs("div",{className:"bg-slate-900/50 p-6 rounded-2xl border border-white/10",children:[l.jsx("h3",{className:"text-sm font-bold uppercase tracking-widest text-slate-400 mb-4",children:"Decision Heatmap"}),l.jsxs("div",{className:"flex flex-wrap gap-4",children:[Object.entries(d).sort((T,w)=>w[1]-T[1]).map(([T,w])=>l.jsxs("div",{className:"bg-white/5 p-3 rounded-lg border border-white/5 flex flex-col items-center min-w-[80px]",children:[l.jsx("span",{className:"text-xs text-slate-500 uppercase",children:T}),l.jsx("span",{className:"text-lg font-bold",children:w})]},T)),Object.keys(d).length===0&&l.jsx("p",{className:"text-slate-600 italic",children:"Ingen data enn..."})]})]}),l.jsxs("div",{className:"bg-slate-900/50 p-6 rounded-2xl border border-white/10",children:[l.jsxs("h3",{className:"text-sm font-bold uppercase tracking-widest text-slate-400 mb-4 flex items-center gap-2",children:[l.jsx(gy,{size:16,className:"text-indigo-400"})," Live Neural Feed"]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-left border-collapse",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"text-xs uppercase text-slate-500 border-b border-white/10",children:[l.jsx("th",{className:"p-3",children:"Subject"}),l.jsx("th",{className:"p-3",children:"Last Decision"}),l.jsx("th",{className:"p-3",children:"Reasoning"}),l.jsx("th",{className:"p-3",children:"Score"}),l.jsx("th",{className:"p-3",children:"Fitness"}),l.jsx("th",{className:"p-3",children:"Gold"}),l.jsx("th",{className:"p-3",children:"Stamina"})]})}),l.jsxs("tbody",{className:"text-sm",children:[Object.entries(h).map(([T,w])=>l.jsxs("tr",{className:"border-b border-white/5 hover:bg-white/5 transition-colors font-mono",children:[l.jsx("td",{className:"p-3 font-bold text-indigo-300",children:w.name}),l.jsx("td",{className:"p-3",children:l.jsx("span",{className:"bg-indigo-500/20 text-indigo-300 px-2 py-1 rounded text-xs font-bold border border-indigo-500/30",children:w.action})}),l.jsxs("td",{className:"p-3 text-slate-400 italic text-xs",children:['"',w.reason,'"']}),l.jsx("td",{className:"p-3 text-slate-300",children:w.score}),l.jsx("td",{className:"p-3 font-bold text-white",children:w.fitness}),l.jsx("td",{className:"p-3 text-amber-400",children:w.resources.gold}),l.jsx("td",{className:"p-3",children:l.jsx("div",{className:"w-16 h-1 bg-slate-700 rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-emerald-500",style:{width:`${w.stamina}%`}})})})]},T)),Object.keys(h).length===0&&l.jsx("tr",{children:l.jsx("td",{colSpan:7,className:"p-8 text-center text-slate-600 italic",children:"Venter p telemetri..."})})]})]})})]}),g&&l.jsxs("div",{className:"bg-red-950/30 border border-red-500/30 p-6 rounded-2xl",children:[l.jsxs("h3",{className:"text-red-400 font-bold flex items-center gap-2 mb-4",children:[l.jsx(yy,{size:18})," Game Balance Issue Detected"]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[l.jsxs("div",{className:"bg-black/40 p-4 rounded-lg",children:[l.jsx("p",{className:"text-slate-400 text-xs uppercase mb-2",children:"Grunn"}),l.jsx("p",{className:"font-mono",children:g.reason})]}),l.jsxs("div",{className:"bg-black/40 p-4 rounded-lg",children:[l.jsx("p",{className:"text-slate-400 text-xs uppercase mb-2",children:"Siste Handling"}),l.jsx("p",{className:"font-mono",children:((N=g.history[g.history.length-1])==null?void 0:N.action.type)||"None"})]})]}),l.jsx("pre",{className:"mt-4 p-4 bg-black/40 rounded-lg overflow-x-auto text-[10px] text-slate-300 custom-scrollbar",children:JSON.stringify(g,null,2)})]})]})},D6=()=>{var Mt,Yn,pn,Hi,Gi,qn,vc,bc,xc;const[t,e]=_.useState(""),[n,s]=_.useState(null),[i,r]=_.useState([]),[a,o]=_.useState(!1),[c,u]=_.useState("LIST"),[d,f]=_.useState({}),[h,m]=_.useState({}),[g,b]=_.useState({}),{setFullWidth:x,setHideHeader:p}=rN(),[v,y]=_.useState(null);_.useEffect(()=>{Gt(()=>import("./SimulationEconomyBlueprint-BdpNGmpm.js"),[]).then(S=>{y(()=>S.SimulationEconomyBlueprint)})},[]);const E=async S=>{if(window.confirm(`ER DU SIKKER? Dette vil slette rommet ${S} permanent! Denne handlingen kan ikke angres.`)){o(!0);try{await fy(D(L,`simulation_rooms/${S}`)),await fy(D(L,`simulation_server_metadata/${S}`))}catch(M){console.error(M),alert("Kunne ikke slette rommet.")}finally{o(!1)}}};_.useEffect(()=>(x(!0),p(!0),()=>{x(!1),p(!1)}),[x,p]),_.useEffect(()=>{const S=D(L,"simulation_rooms"),M=Ke(S,G=>{const Q=G.val();if(Q){const re=Object.entries(Q).map(([Z,Y])=>({...Y,pin:Y.pin||Z}));r(re.reverse())}else r([])});return()=>M()},[]),_.useEffect(()=>{if(!t)return;const S=`simulation_rooms/${t}`,M=Ke(D(L,`${S}/status`),Z=>{s(Y=>Y?{...Y,status:Z.val()||"LOBBY"}:null)}),G=Ke(D(L,`${S}/world`),Z=>{s(Y=>Y?{...Y,world:Z.val()}:null)}),Q=Ke(D(L,`${S}/markets`),Z=>{const Y=Z.val()||{};s(de=>de?{...de,markets:Y}:null)}),re=Ke(D(L,`${S}/regions`),Z=>{s(Y=>Y?{...Y,regions:Z.val()||{}}:null)});return()=>{M(),G(),Q(),re()}},[t]),TS(t,(n==null?void 0:n.status)||"LOBBY",n==null?void 0:n.world),_.useEffect(()=>{if(!t)return;const S=`simulation_rooms/${t}`,M=Ke(D(L,`${S}/messages`),G=>{s(Q=>Q?{...Q,messages:G.val()||[]}:null)});return()=>M()},[t]),_.useEffect(()=>{if(!t)return;const S=`simulation_rooms/${t}`,M=Ke(D(L,`${S}/players`),Z=>{const Y=Z.val()||{};s(de=>{if(!de)return null;const W=Object.keys(Y).length,ye=D(L,`simulation_server_metadata/${t}`);return setTimeout(()=>{xe(ye).then(jt=>{jt.exists()&&jt.val().playerCount!==W&&J(ye,{playerCount:W})})},5e3),{...de,players:Y}})}),G=Ke(D(L,`${S}/worldEvents`),Z=>{s(Y=>Y?{...Y,worldEvents:Z.val()||{}}:null)}),Q=Ke(D(L,`${S}/activeVote`),Z=>{s(Y=>Y?{...Y,activeVote:Z.val()}:null)}),re=Ke(D(L,`${S}/regions`),Z=>{s(Y=>Y?{...Y,regions:Z.val()||{}}:null)});return xe(D(L,S)).then(Z=>{if(Z.exists()){const Y=Z.val();s(de=>({...de,pin:Y.pin,status:Y.status,settings:Y.settings,hostName:Y.hostName,isPublic:Y.isPublic??!0,world:Y.world,markets:Y.markets||{},market:Y.market||xt,players:(de==null?void 0:de.players)||{},messages:(de==null?void 0:de.messages)||[],regions:Y.regions||{},diplomacy:{},worldEvents:{}}))}}),()=>{M(),G(),Q(),re()}},[t]),_.useEffect(()=>(t&&c==="MANAGE"?document.title=`Host: ${t} | Eiriksbok`:document.title="Simuleringshallen | Eiriksbok",()=>{document.title="Eiriksbok"}),[t,c]);const N=async()=>{const S=prompt("Hva skal riket hete? (La st tomt for automatisk navn)");if(S===null)return;o(!0);const M=Math.floor(1e3+Math.random()*9e3).toString(),G=S.trim()||`Rike #${M}`,Q=_P(M,G);try{await Ua(D(L,`simulation_rooms/${M}`),Q),await Hc(M,Q),e(M),u("MANAGE")}catch(re){console.error(re),alert("Kunne ikke opprette rom.")}finally{o(!1)}},T=async()=>{if(!(!n||!n.players)){o(!0);try{const S=bP(n.players),M={region_vest:{id:"region_vest",name:"Baroniet Vest",taxRate:10,defenseLevel:50,rulerName:"Ingen"},region_ost:{id:"region_ost",name:"Baroniet st",taxRate:10,defenseLevel:50,rulerName:"Ingen"}},G={...n.markets};G.capital||(G.capital=JSON.parse(JSON.stringify(xt))),["region_vest","region_ost"].forEach(Y=>{G[Y]||(G[Y]=JSON.parse(JSON.stringify(xt)))}),Object.values(S).forEach(Y=>{if(Y.role==="BARON"){M[Y.regionId]={...M[Y.regionId],rulerName:Y.name};const de=JSON.parse(JSON.stringify(xt));Object.keys(de).forEach(W=>{const ye=de[W];ye.price=Math.floor(ye.price*(.8+Math.random()*.4)),ye.stock=Math.floor(ye.stock*(.8+Math.random()*.4))}),G[Y.regionId]=de}});const Q={};Object.values(S).forEach(Y=>{Q[Y.id]={id:Y.id,name:Y.name,role:Y.role,regionId:Y.regionId,stats:{level:Y.stats.level||1},status:{isJailed:!1,isFrozen:!1,legitimacy:100},online:!0,lastActive:Y.lastActive}});const re={};re[`simulation_rooms/${t}/players`]=S,re[`simulation_rooms/${t}/public_profiles`]=Q,re[`simulation_rooms/${t}/regions`]=M,re[`simulation_rooms/${t}/markets`]=G,re[`simulation_rooms/${t}/status`]="PLAYING",await J(D(L),re);const Z={...n,status:"PLAYING"};await Hc(t,Z)}catch(S){console.error(S),alert("Klarte ikke starte.")}finally{o(!1)}}},w=async()=>{var S,M;if(!(!n||!n.players)){o(!0);try{const G=((M=(S=n.world)==null?void 0:S.taxRateDetails)==null?void 0:M.kingTax)||20,{updatedPlayers:Q,results:re}=xP(n.players,G);await J(D(L,`simulation_rooms/${t}/players`),Q),alert(`Suksess! ${re.length} bnder og baroner ble skattlagt.`)}catch(G){console.error(G)}finally{o(!1)}}},A=async()=>{if(n!=null&&n.regions&&window.confirm("Vil du nullstille all politisk uro (bestikkelser) i alle regioner?")){o(!0);try{const S={};Object.keys(n.regions).forEach(M=>{S[`simulation_rooms/${t}/regions/${M}/coup/bribeProgress`]=0,S[`simulation_rooms/${t}/regions/${M}/coup/contributions`]={},S[`simulation_rooms/${t}/regions/${M}/coup/challengerId`]=null,S[`simulation_rooms/${t}/regions/${M}/coup/challengerName`]=null}),await J(D(L),S),alert("Politisk ro er gjenopprettet i alle regioner!")}catch(S){console.error(S)}finally{o(!1)}}},k=async()=>{if(!(!n||!n.players)){o(!0);try{const S={};Object.keys(n.players).forEach(M=>{S[`simulation_rooms/${t}/players/${M}/status/stamina`]=100}),await J(D(L),S),alert("All energi er gjenopprettet!")}catch(S){console.error(S)}finally{o(!1)}}},R=S=>S?Array.isArray(S)?S:Object.values(S).sort((M,G)=>M.timestamp-G.timestamp):[],C=async()=>{var re,Z;if(!n)return;const S=["Spring","Summer","Autumn","Winter"],G=(S.indexOf(((re=n.world)==null?void 0:re.season)||"Spring")+1)%S.length,Q=S[G];o(!0);try{const de=` rstiden har skiftet til ${((Z=An[Q])==null?void 0:Z.label)||Q}!`,W={id:`msg_${Date.now()}`,content:de,timestamp:Date.now(),type:"SEASON_CHANGE"},jt=[...R(n.messages),W].slice(-50),yc={};yc[`simulation_rooms/${t}/world/season`]=Q,yc[`simulation_rooms/${t}/messages`]=jt,await J(D(L),yc)}catch(Y){console.error(Y)}finally{o(!1)}},B=async()=>{if(!n)return;const S=["Clear","Rain","Storm","Fog"],G=(S.indexOf(n.world.weather||"Clear")+1)%S.length,Q=S[G];try{const Y=` Vret har skiftet til ${{Clear:"Klart",Rain:"Regn",Storm:"Storm",Fog:"Tke"}[Q]||Q}!`,de={id:`msg_${Date.now()}`,content:Y,timestamp:Date.now(),type:"WEATHER_CHANGE"},ye=[...R(n.messages),de].slice(-50),jt={};jt[`simulation_rooms/${t}/world/weather`]=Q,jt[`simulation_rooms/${t}/messages`]=ye,await J(D(L),jt)}catch(re){console.error(re)}},z=async()=>{if(!n)return;const{LAW_TEMPLATES:S}=await Gt(async()=>{const{LAW_TEMPLATES:Q}=await Promise.resolve().then(()=>my);return{LAW_TEMPLATES:Q}},void 0),M=S[Math.floor(Math.random()*S.length)],G={lawId:M.id,title:M.label,votes:{},expiresAt:Date.now()+60*1e3};try{await J(D(L,`simulation_rooms/${t}`),{activeVote:G});const Q=` TINGET ER SATT! Det skal stemmes over loven: "${M.label}"!`,re={id:`msg_${Date.now()}`,content:Q,timestamp:Date.now(),type:"VOTE_START"},Y=[...R(n.messages),re].slice(-50);await J(D(L,`simulation_rooms/${t}`),{messages:Y}),setTimeout(()=>$(M.id),6e4)}catch(Q){console.error(Q)}},$=async S=>{var ye;const M=await xe(D(L,`simulation_rooms/${t}/activeVote`));if(!M.exists())return;const G=M.val(),Q=Object.values(G.votes||{}),re=Q.filter(jt=>jt==="YES").length,Z=Q.filter(jt=>jt==="NO").length;let Y="",de=((ye=n==null?void 0:n.world)==null?void 0:ye.activeLaws)||[];re>Z?(Y=` LOVEN ER VEDTATT! "${G.title}" er n gjeldende.`,de=[...de,S]):Y=` LOVEN BLE FORKASTET. "${G.title}" ble nedstemt.`;const W={id:`msg_${Date.now()}`,content:Y,timestamp:Date.now(),type:"VOTE_RESULT"};try{await J(D(L,`simulation_rooms/${t}/world`),{activeLaws:de});const jt=R(n==null?void 0:n.messages);await J(D(L,`simulation_rooms/${t}`),{activeVote:null,messages:[...jt,W].slice(-50)})}catch(jt){console.error(jt)}},K=async()=>{if(!n)return;const{WORLD_EVENT_TEMPLATES:S}=await Gt(async()=>{const{WORLD_EVENT_TEMPLATES:re}=await Promise.resolve().then(()=>my);return{WORLD_EVENT_TEMPLATES:re}},void 0),M=S[Math.floor(Math.random()*S.length)],G=`event_${Date.now()}`,Q={...M,id:G,expiresAt:Date.now()+5*60*1e3};try{await J(D(L,`simulation_rooms/${t}/worldEvents`),{[G]:Q});const re=` HENDELSE: ${M.title}! Sjekk kartet!`,Z={id:`msg_${Date.now()}`,content:re,timestamp:Date.now(),type:"EVENT_SPAWN"},de=[...R(n.messages),Z].slice(-50);await J(D(L,`simulation_rooms/${t}`),{messages:de})}catch(re){console.error(re)}},U=async(S,M)=>{var re,Z,Y;if(!((Y=(Z=(re=n==null?void 0:n.world)==null?void 0:re.settlement)==null?void 0:Z.buildings)!=null&&Y[S]))return;const G=n.world.settlement.buildings[S],Q=Math.max(0,G.level+M);try{await J(D(L,`simulation_rooms/${t}/world/settlement/buildings/${S}`),{level:Q,progress:{}})}catch(de){console.error(de)}},[O,j]=_.useState({name:"",role:"PEASANT",level:1}),I=async()=>{if(!O.name){alert("Vennligst oppgi et navn.");return}o(!0);try{const S=`char_${Math.random().toString(36).substr(2,9)}`,M={id:S,name:O.name,role:O.role||"PEASANT",regionId:O.role==="KING"?"capital":Math.random()>.5?"region_ost":"region_vest",resources:Rt[O.role]||Rt.PEASANT,status:{hp:100,stamina:100,morale:100,legitimacy:100,authority:50,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:O.level,xp:0,reputation:10,contribution:0},skills:jn[O.role]||jn.PEASANT,lastActive:Date.now(),online:!0},G={};G[`simulation_rooms/${t}/players/${S}`]=M,G[`simulation_rooms/${t}/public_profiles/${S}`]={id:S,name:M.name,role:M.role,regionId:M.regionId,stats:{level:M.stats.level},status:{isJailed:!1,isFrozen:!1,legitimacy:100},online:!0,lastActive:M.lastActive},await J(D(L),G),j({name:"",role:"PEASANT",level:1})}catch(S){console.error(S),alert("Kunne ikke opprette karakter.")}finally{o(!1)}},H=async(S,M)=>{try{const G={};G[`simulation_rooms/${t}/players/${S}/stats/level`]=M,G[`simulation_rooms/${t}/public_profiles/${S}/stats/level`]=M,await J(D(L),G)}catch(G){console.error(G)}},X=async()=>{if(n){o(!0);try{await J(D(L,`simulation_rooms/${t}/world`),{settlement:{buildings:Object.entries(Bt).reduce((S,[M])=>({...S,[M]:{id:M,level:0,progress:{},target:200,contributions:{}}}),{})}})}catch(S){console.error(S)}finally{o(!1)}}},oe=async()=>{if(console.log("Attempting resetGame..."),!window.confirm("Er du sikker p at du vil starte spillet p nytt? Alle fremdrift slettes.")){console.log("Reset cancelled by user.");return}console.log("Reset confirmed. Pin:",t),o(!0);try{const S={};S[`simulation_rooms/${t}/status`]="LOBBY",S[`simulation_rooms/${t}/worldEvents`]={},S[`simulation_rooms/${t}/messages`]=[],S[`simulation_rooms/${t}/market`]=xt,S[`simulation_rooms/${t}/markets`]={capital:xt},S[`simulation_rooms/${t}/regions`]={},S[`simulation_rooms/${t}/world/monumentProgress`]=0,S[`simulation_rooms/${t}/world/activeLaws`]=[],S[`simulation_rooms/${t}/world/settlement`]={buildings:Object.entries(Bt).reduce((M,[G])=>({...M,[G]:{id:G,level:0,progress:{},target:200,contributions:{}}}),{})},Object.keys((n==null?void 0:n.players)||{}).forEach(M=>{S[`simulation_rooms/${t}/players/${M}/role`]="PEASANT",S[`simulation_rooms/${t}/players/${M}/regionId`]="capital",S[`simulation_rooms/${t}/players/${M}/resources`]=Rt.PEASANT,S[`simulation_rooms/${t}/players/${M}/status`]={stamina:100,legitimacy:100,authority:50},S[`simulation_rooms/${t}/players/${M}/equipment`]={};const G=`simulation_rooms/${t}/public_profiles/${M}`;S[`${G}/role`]="PEASANT",S[`${G}/regionId`]="capital",S[`${G}/stats/level`]=1,S[`simulation_rooms/${t}/players/${M}/roleStats`]=null}),console.log("Constructed updates:",S),await J(D(L),S),n&&s({...n,status:"LOBBY",messages:[]}),console.log("Update successful!"),alert("Spillet er nullstilt!")}catch(S){console.error("Reset failed:",S),alert("Kunne ikke nullstille spill: "+S)}finally{o(!1)}},Ie=async(S,M)=>{if(window.confirm(`Er du sikker p at du vil kaste ut ${M}?`))try{const G={};G[`simulation_rooms/${t}/players/${S}`]=null,G[`simulation_rooms/${t}/public_profiles/${S}`]=null,await J(D(L),G)}catch(G){console.error(G),alert("Kunne ikke kaste ut spiller.")}},V=async()=>{if(window.confirm("ER DU SIKKER? Dette vil kaste ut ALLE spillere fra rommet!"))try{const S={};S[`simulation_rooms/${t}/players`]={},await J(D(L),S),alert("Alle spillere er kastet ut.")}catch(S){console.error(S),alert("Kunne ikke utfre handlingen.")}},me=S=>{const M=`${window.location.origin}/sim/play/${t}?impersonate=${S}`;window.open(M,"_blank")},ne=async(S,M)=>{try{const G={};G[`simulation_rooms/${t}/players/${S}/role`]=M,G[`simulation_rooms/${t}/public_profiles/${S}/role`]=M,await J(D(L),G)}catch(G){console.error(G),alert("Kunne ikke endre rolle.")}},tt=async(S,M)=>{try{const G={};G[`simulation_rooms/${t}/players/${S}/regionId`]=M,G[`simulation_rooms/${t}/public_profiles/${S}/regionId`]=M,await J(D(L),G)}catch(G){console.error(G),alert("Kunne ikke endre baroni.")}},zt=async()=>{if(!n)return;const S=!n.isPublic;try{await J(D(L,`simulation_rooms/${t}`),{isPublic:S}),await Hc(t,{...n,isPublic:S})}catch(M){console.error(M)}};if(c==="LIST")return l.jsxs("div",{className:"fixed inset-0 top-0 bg-slate-950 text-slate-200 p-12 overflow-y-auto custom-scrollbar font-sans z-20",children:[l.jsxs("div",{className:"fixed inset-0 pointer-events-none opacity-20",children:[l.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-indigo-600/20 blur-[120px] rounded-full"}),l.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-amber-600/10 blur-[120px] rounded-full"})]}),l.jsxs("div",{className:"max-w-5xl mx-auto relative z-10",children:[l.jsxs("div",{className:"flex justify-between items-center mb-12",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-5xl font-black text-white px-2 tracking-tighter",children:"Simuleringshallen"}),l.jsx("p",{className:"text-slate-500 font-bold uppercase tracking-widest text-[10px] mt-2 px-2",children:"Sentralt kontrollpanel for administratoren"})]}),l.jsxs("div",{className:"flex gap-4",children:[l.jsx("button",{onClick:async()=>{o(!0);try{const S=D(L,"simulation_server_metadata"),M=D(L,"simulation_rooms"),[G,Q]=await Promise.all([xe(S),xe(M)]),re=G.val()||{},Z=Q.val()||{};let Y=0;const de={};Object.keys(re).forEach(W=>{Z[W]||(de[`simulation_server_metadata/${W}`]=null,Y++)}),Y>0?(await J(D(L),de),alert(`Ryddet opp ${Y} dde serverkoblinger!`)):alert("Alt ser ryddig ut! Ingen dde linker funnet.")}catch(S){console.error(S),alert("Kunne ikke rydde opp "+S)}finally{o(!1)}},disabled:a,className:"bg-slate-800 hover:bg-rose-500/20 text-slate-400 hover:text-rose-400 border border-slate-700 hover:border-rose-500/50 px-6 py-5 rounded-2xl font-black text-xs uppercase tracking-widest transition-all",children:" Vask Serverlisten"}),l.jsx("button",{onClick:N,disabled:a,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-10 py-5 rounded-2xl font-black text-lg shadow-2xl shadow-indigo-600/30 transition-all hover:scale-105 active:scale-95",children:"+ Opprett Nytt Rike"})]})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map(S=>{var M,G;return l.jsxs("div",{className:"bg-slate-900/50 backdrop-blur-xl border border-white/5 p-8 rounded-[2.5rem] group hover:border-indigo-500/50 transition-all shadow-xl flex flex-col justify-between",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-start mb-2",children:[l.jsx("h2",{className:"text-2xl font-black text-white group-hover:text-indigo-400 transition-colors truncate pr-4",title:S.name||`Rike #${S.pin}`,children:S.name||`Rike #${S.pin}`}),l.jsx("span",{className:`px-2 py-0.5 rounded-full text-[8px] font-black uppercase tracking-widest ${S.status==="PLAYING"?"bg-emerald-500/20 text-emerald-400":"bg-amber-500/20 text-amber-400"} shrink-0`,children:typeof S.status=="string"?S.status:"KORRUPT"})]}),l.jsxs("div",{className:"text-[10px] font-mono text-slate-600 mb-6 uppercase tracking-widest",children:["PIN: ",l.jsx("span",{className:"text-slate-400 font-bold",children:S.pin})]}),l.jsxs("div",{className:"space-y-4 mb-8",children:[l.jsxs("div",{className:"flex items-center justify-between text-sm font-bold text-slate-500",children:[l.jsx("span",{children:"Innbyggere:"}),l.jsxs("span",{className:"text-white",children:[Object.keys(S.players||{}).length," sjeler"]})]}),l.jsxs("div",{className:"flex items-center justify-between text-sm font-bold text-slate-500",children:[l.jsx("span",{children:"rstid:"}),l.jsx("span",{className:"text-indigo-300",children:xt[(M=S.world)==null?void 0:M.season]||((G=S.world)==null?void 0:G.season)||"Ukjent"})]})]})]}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx("button",{onClick:()=>{e(S.pin),u("MANAGE")},className:"flex-1 bg-white/5 hover:bg-white/10 text-white py-4 rounded-2xl font-black uppercase tracking-widest text-xs transition-all border border-white/5",children:"Administrer "}),l.jsx("button",{onClick:()=>E(S.pin),className:"bg-rose-500/10 hover:bg-rose-500/20 text-rose-500 w-16 rounded-2xl flex items-center justify-center border border-rose-500/20 transition-all hover:scale-105 active:scale-95",title:"Slett rom",children:""})]})]},S.pin)})})]})]});if(!n)return null;const On=async()=>{if(window.confirm("Er du sikker? Dette vil regenerere 'public_profiles' basert p 'players'. Bruk kun hvis listen er tom.")){o(!0);try{const S=await xe(D(L,`simulation_rooms/${t}`));if(!S.exists())return;const M=S.val(),G=M.players||{},Q={};Object.entries(G).forEach(([re,Z])=>{var Y,de,W,ye;Q[`simulation_rooms/${t}/public_profiles/${re}`]={id:re,uid:Z.uid||null,name:Z.name,role:Z.role,regionId:Z.regionId,stats:{level:((Y=Z.stats)==null?void 0:Y.level)||1},status:{isJailed:((de=Z.status)==null?void 0:de.isJailed)||!1,isFrozen:((W=Z.status)==null?void 0:W.isFrozen)||!1,legitimacy:((ye=Z.status)==null?void 0:ye.legitimacy)||100},online:!0,lastActive:Z.lastActive||Date.now()}}),M.status||(Q[`simulation_rooms/${t}/status`]="LOBBY"),M.world||(Q[`simulation_rooms/${t}/world`]={year:1100,season:"Spring",weather:"Clear",gameTick:0,lastTickAt:Date.now(),taxRateDetails:{kingTax:20},settlement:{buildings:Object.entries(Bt).reduce((re,[Z])=>({...re,[Z]:{id:Z,level:0,progress:{},target:200,contributions:{}}}),{})}}),await J(D(L),Q),alert("Data reparert! Profiler er synkronisert."),await Hc(t,{...M,players:G})}catch(S){console.error(S),alert("Reparasjon feilet: "+S)}finally{o(!1)}}};return l.jsxs("div",{className:"fixed inset-0 top-0 bg-slate-950 text-slate-200 flex overflow-hidden font-sans selection:bg-indigo-500/30 z-20",children:[l.jsxs("div",{className:"fixed inset-0 pointer-events-none opacity-20",children:[l.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-indigo-600/20 blur-[120px] rounded-full animate-pulse"}),l.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-amber-600/10 blur-[120px] rounded-full"})]}),l.jsxs("aside",{className:"w-80 border-r border-white/10 bg-slate-900/50 backdrop-blur-xl flex flex-col z-20 shadow-2xl overflow-y-auto no-scrollbar",children:[l.jsxs("div",{className:"p-8 border-b border-white/5 bg-black/20",children:[l.jsx("button",{onClick:()=>u("LIST"),className:"text-indigo-400 font-black text-[10px] uppercase tracking-widest mb-4 hover:text-white transition-colors flex items-center gap-2",children:" Tilbake til oversikt"}),l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("h1",{className:"text-4xl font-mono font-black text-white",children:t}),l.jsx("span",{className:"text-[10px] font-black uppercase text-indigo-500 tracking-widest bg-indigo-500/10 px-3 py-1 rounded-full",children:"Admin"})]}),l.jsxs("p",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-6",children:[typeof n.status=="string"?n.status:"FEIL: DATA KORRUPT"," MODUS"]}),l.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[l.jsx("button",{onClick:T,disabled:n.status==="PLAYING"||a,className:`w-full py-4 rounded-xl font-black uppercase tracking-widest text-sm transition-all shadow-lg ${n.status==="PLAYING"?"bg-emerald-600/20 text-emerald-500 cursor-default":"bg-emerald-600 hover:bg-emerald-500 text-white shadow-emerald-600/20"}`,children:n.status==="PLAYING"?" SPILL AKTIVT":" START SPILL"}),l.jsxs("button",{onClick:zt,disabled:a,className:`w-full py-3 rounded-xl font-black uppercase tracking-widest text-[10px] transition-all border flex items-center justify-center gap-2 ${n.isPublic?"bg-indigo-600/10 text-indigo-400 border-indigo-500/20 hover:bg-indigo-600 hover:text-white":"bg-slate-800 text-slate-500 border-white/5 hover:border-indigo-500/20"}`,children:[n.isPublic?l.jsx(N3,{size:14}):l.jsx(D0,{size:14}),n.isPublic?"OFFENTLIG SERVER":"PRIVAT (KUN PIN)"]}),l.jsx("button",{onClick:On,disabled:a,className:"w-full py-3 rounded-xl font-black uppercase tracking-widest text-[10px] bg-amber-600/10 text-amber-500 hover:bg-amber-600 hover:text-white transition-all border border-amber-500/20",children:" REPARER DATA"}),l.jsx("button",{onClick:oe,disabled:a,className:"w-full py-3 rounded-xl font-black uppercase tracking-widest text-[10px] bg-rose-600/10 text-rose-500 hover:bg-rose-600 hover:text-white transition-all border border-rose-500/20",children:" NULLSTILL ALT"})]})]}),l.jsxs("div",{className:"p-8 space-y-8 flex-1 overflow-y-auto custom-scrollbar",children:[l.jsxs("section",{children:[l.jsx("h3",{className:"text-[10px] font-black uppercase text-slate-500 tracking-[0.2em] mb-4",children:"Verdensstyring"}),l.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[l.jsxs("div",{className:"bg-white/5 p-4 rounded-2xl border border-white/5 group",children:[l.jsxs("div",{className:"flex justify-between items-center mb-3",children:[l.jsxs("span",{className:"text-xs font-bold text-slate-400 italic",children:["rstid: ",((Yn=An[(Mt=n.world)==null?void 0:Mt.season])==null?void 0:Yn.label)||"Ukjent"]}),l.jsx("span",{className:"text-2xl group-hover:rotate-12 transition-transform",children:{Spring:"",Summer:"",Autumn:"",Winter:""}[((pn=n.world)==null?void 0:pn.season)||"Spring"]})]}),l.jsx("button",{onClick:C,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white py-2 rounded-lg font-black uppercase text-[10px] transition-all",children:"Neste rstid"})]}),l.jsxs("div",{className:"bg-white/5 p-4 rounded-2xl border border-white/5 group",children:[l.jsxs("div",{className:"flex justify-between items-center mb-3",children:[l.jsxs("span",{className:"text-xs font-bold text-slate-400 italic",children:["Vr: ",((Hi=n.world)==null?void 0:Hi.weather)||"Klart"]}),l.jsx("span",{className:"text-2xl group-hover:scale-110 transition-transform",children:""})]}),l.jsx("button",{onClick:B,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white py-2 rounded-lg font-black uppercase text-[10px] transition-all",children:"Endre Vr"})]})]})]}),l.jsxs("section",{children:[l.jsx("h3",{className:"text-[10px] font-black uppercase text-slate-500 tracking-[0.2em] mb-4",children:"Massehandlinger"}),l.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[l.jsx("button",{onClick:w,className:"w-full bg-amber-600/10 hover:bg-amber-600 text-amber-500 hover:text-white border border-amber-600/20 py-4 rounded-2xl font-black uppercase text-[10px] transition-all flex items-center justify-center gap-2",children:" Skattlegg Riket"}),l.jsx("button",{onClick:k,className:"w-full bg-blue-600/10 hover:bg-blue-600 text-blue-500 hover:text-white border border-blue-600/20 py-4 rounded-2xl font-black uppercase text-[10px] transition-all flex items-center justify-center gap-2 text-center",children:" Gjenopprett Stamina"}),l.jsx("button",{onClick:A,className:"w-full bg-indigo-600/10 hover:bg-indigo-600 text-indigo-500 hover:text-white border border-indigo-600/20 py-4 rounded-2xl font-black uppercase text-[10px] transition-all flex items-center justify-center gap-2 text-center",children:" Nullstill Politisk Uro"}),l.jsx("button",{onClick:V,className:"w-full bg-rose-600/10 hover:bg-rose-600 text-rose-500 hover:text-white border border-rose-600/20 py-4 rounded-2xl font-black uppercase text-[10px] transition-all flex items-center justify-center gap-2 text-center mt-2",children:" Kast ut alle"})]})]}),l.jsxs("section",{children:[l.jsx("h3",{className:"text-[10px] font-black uppercase text-slate-500 tracking-[0.2em] mb-4 text-center",children:"Intervensjoner"}),l.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsx("button",{onClick:K,className:"bg-rose-600/80 hover:bg-rose-600 text-white py-4 rounded-2xl font-black uppercase text-[10px] shadow-lg shadow-rose-600/20 transition-all active:scale-95",children:" Event"}),l.jsx("button",{onClick:z,disabled:!!n.activeVote,className:"bg-amber-600/80 hover:bg-amber-600 text-white py-4 rounded-2xl font-black uppercase text-[10px] shadow-lg shadow-amber-600/20 disabled:opacity-20 text-center transition-all active:scale-95",children:" Tinget"})]}),l.jsxs("section",{className:"bg-white/5 border border-white/5 rounded-[2.5rem] p-6 space-y-4 shadow-inner",children:[l.jsx("h3",{className:"text-[10px] font-black uppercase text-indigo-400 tracking-[0.2em] mb-2 px-2",children:"Legg til Karakter"}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("input",{type:"text",placeholder:"Navn...",value:O.name,onChange:S=>j({...O,name:S.target.value}),className:"w-full bg-black/40 border border-white/5 rounded-xl px-4 py-3 text-xs font-bold text-white placeholder:text-slate-600 focus:border-indigo-500/50 focus:ring-0 transition-all"}),l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsx("select",{value:O.role,onChange:S=>j({...O,role:S.target.value}),className:"bg-black/40 border border-white/5 rounded-xl px-3 py-2 text-[10px] font-black uppercase text-slate-400 focus:ring-0",children:Object.keys(jl).map(S=>l.jsx("option",{value:S,children:S},S))}),l.jsxs("div",{className:"flex items-center gap-2 bg-black/40 border border-white/5 rounded-xl px-3 py-2",children:[l.jsx("span",{className:"text-[8px] font-black text-slate-600",children:"LVL"}),l.jsx("input",{type:"number",value:O.level,onChange:S=>j({...O,level:parseInt(S.target.value)}),className:"w-full bg-transparent border-none p-0 text-xs font-black text-white focus:ring-0 font-mono"})]})]}),l.jsx("button",{onClick:I,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-xl font-black uppercase text-[10px] shadow-lg shadow-indigo-600/20 transition-all active:scale-95",children:" SKAP KARAKTER"})]})]})]})]}),l.jsxs("section",{children:[l.jsx("h3",{className:"text-[10px] font-black uppercase text-slate-500 tracking-[0.2em] mb-4",children:"Landsby-fokus"}),(Gi=n.world)!=null&&Gi.settlement?l.jsx("div",{className:"text-xs text-slate-500 italic",children:"Landsbyen er initialisert."}):l.jsx("button",{onClick:X,className:"w-full bg-amber-500 text-black py-4 rounded-2xl font-black uppercase text-[10px] animate-pulse",children:"Initialiser Landsby"})]})]})]}),l.jsxs("main",{className:"flex-1 relative flex flex-col bg-slate-900/10 overflow-hidden no-scrollbar",children:[l.jsxs("header",{className:"h-16 border-b border-white/5 bg-slate-950/30 backdrop-blur-md flex items-center justify-between px-8 shrink-0 z-10",children:[l.jsxs("div",{className:"flex items-center gap-8",children:[l.jsxs("nav",{className:"flex items-center bg-white/5 p-1 rounded-xl border border-white/10",children:[l.jsx("button",{onClick:()=>u("MANAGE"),className:`px-4 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${c==="MANAGE"?"bg-indigo-600 text-white shadow-lg":"text-slate-500 hover:text-white"}`,children:"Overvking"}),l.jsx("button",{onClick:()=>u("ECONOMY"),className:`px-4 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${c==="ECONOMY"?"bg-indigo-600 text-white shadow-lg":"text-slate-500 hover:text-white"}`,children:"Blueprint"}),l.jsx("button",{onClick:()=>u("AI_LAB"),className:`px-4 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${c==="AI_LAB"?"bg-indigo-600 text-white shadow-lg":"text-slate-500 hover:text-white"}`,children:"AI Training Lab"})]}),l.jsx("div",{className:"h-4 w-[1px] bg-white/10 mx-2"}),l.jsxs("div",{className:"flex items-center gap-8",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Innbyggere:"}),l.jsx("span",{className:"text-sm font-bold text-white",children:Object.keys(n.players||{}).length})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"r i Riket:"}),l.jsx("span",{className:"text-sm font-bold text-white",children:((qn=n.world)==null?void 0:qn.year)||1100})]})]})]}),a&&l.jsx("div",{className:"text-[10px] font-black uppercase tracking-widest text-indigo-400 animate-pulse",children:"Prosesserer Endringer..."})]}),l.jsx("div",{className:"flex-1 p-8 overflow-y-auto custom-scrollbar no-scrollbar",children:c==="ECONOMY"?v?l.jsx(v,{}):l.jsx("div",{className:"p-20 text-center animate-pulse text-slate-500 font-black uppercase tracking-widest",children:"Laster Blueprint..."}):c==="AI_LAB"?l.jsx(M6,{roomData:n,pin:t}):l.jsxs("div",{className:"space-y-12 pb-20",children:[l.jsxs("section",{children:[l.jsx("h2",{className:"text-3xl font-black text-white px-2 mb-8 tracking-tighter",children:"Innbyggere i Riket"}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[Object.values(n.players||{}).map(S=>{var M,G,Q,re,Z,Y,de;return l.jsxs("div",{className:"relative bg-slate-900/80 border border-white/5 p-6 rounded-[2rem] hover:border-indigo-500/30 transition-all group",children:[l.jsx("button",{onClick:W=>{W.stopPropagation(),Ie(S.id,S.name)},className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-rose-500/10 text-rose-500 opacity-0 group-hover:opacity-100 transition-all hover:bg-rose-500 hover:text-white flex items-center justify-center font-bold text-xs",title:"Kast ut spiller",children:""}),l.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[l.jsx("div",{className:"w-12 h-12 bg-indigo-600/20 rounded-xl flex items-center justify-center text-2xl shrink-0 group-hover:scale-110 transition-transform overflow-hidden",children:S.avatar?l.jsx("img",{src:S.avatar,alt:S.role,className:"w-full h-full object-cover"}):{KING:"",BARON:"",PEASANT:"",SOLDIER:"",MERCHANT:""}[S.role]||""}),l.jsxs("div",{className:"min-w-0 flex-1",children:[l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("h3",{className:"text-lg font-black text-white truncate leading-tight",children:S.name}),l.jsxs("div",{className:"flex items-center gap-1 bg-white/5 px-2 py-0.5 rounded-lg border border-white/5",children:[l.jsx("span",{className:"text-[8px] font-black text-slate-500 uppercase",children:"LVL"}),l.jsx("input",{type:"number",value:((M=S.stats)==null?void 0:M.level)||1,onChange:W=>H(S.id,parseInt(W.target.value)),className:"w-8 bg-transparent border-none p-0 text-[10px] font-black text-indigo-400 focus:ring-0 text-center font-mono"})]})]}),l.jsxs("div",{className:"flex flex-col gap-1 mt-1",children:[l.jsx("select",{value:S.role,onChange:W=>ne(S.id,W.target.value),className:"bg-indigo-500/10 text-indigo-400 text-[10px] font-black uppercase tracking-widest border-none p-0 focus:ring-0 cursor-pointer hover:text-white transition-colors w-full text-left",children:Object.entries(jl).map(([W,ye])=>l.jsx("option",{value:W,className:"bg-slate-900",children:ye.label},W))}),l.jsxs("select",{value:S.regionId||"region_ost",onChange:W=>tt(S.id,W.target.value),className:"bg-white/5 text-slate-500 text-[9px] font-bold uppercase tracking-wider border-none p-0 focus:ring-0 cursor-pointer hover:text-slate-300 transition-colors w-full text-left",children:[l.jsx("option",{value:"capital",className:"bg-slate-900",children:"Hovedstaden"}),l.jsx("option",{value:"region_ost",className:"bg-slate-900",children:"Baroniet st"}),l.jsx("option",{value:"region_vest",className:"bg-slate-900",children:"Baroniet Vest"})]})]})]})]}),S.id.startsWith("bot_")&&((G=S.status)==null?void 0:G.thought)&&l.jsxs("div",{className:"mb-4 p-3 bg-indigo-500/10 rounded-xl border border-indigo-500/20",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx("span",{className:"text-[8px] font-black text-indigo-400 uppercase tracking-widest",children:"Mental Tilstand"}),l.jsx("div",{className:"flex-1 h-[1px] bg-indigo-500/20"})]}),l.jsxs("p",{className:"text-[10px] text-white/90 font-bold leading-relaxed mb-2",children:['"',S.status.thought,'"']}),l.jsxs("div",{className:"flex justify-between items-center text-[8px] font-black uppercase tracking-tighter text-indigo-400/60",children:[l.jsxs("span",{children:["Handling: ",S.status.lastAction]}),l.jsxs("span",{children:["Tid: ",S.status.lastTick?new Date(S.status.lastTick).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"N"]})]})]}),l.jsxs("div",{className:"space-y-3 mb-6",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between text-[8px] font-black uppercase text-slate-500 mb-1",children:[l.jsx("span",{children:"Stamina"}),l.jsxs("span",{className:"text-white",children:[S.status.stamina,"%"]})]}),l.jsx("div",{className:"h-1 bg-slate-800 rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-emerald-500",style:{width:`${S.status.stamina}%`}})})]}),l.jsxs("div",{className:"flex justify-between items-center text-xs font-bold",children:[l.jsx("span",{className:"text-slate-500",children:"Gull:"}),l.jsxs("span",{className:"text-amber-500 font-black",children:[S.resources.gold,""]})]})]}),l.jsxs("div",{className:"flex flex-wrap gap-1 mb-6",children:[(Q=S.upgrades)==null?void 0:Q.map(W=>l.jsx("span",{className:"text-[7px] font-black bg-indigo-500/10 text-indigo-400 px-1.5 py-0.5 rounded border border-indigo-500/20 uppercase tracking-tighter",children:W},W)),(!S.upgrades||S.upgrades.length===0)&&l.jsx("span",{className:"text-[7px] font-bold text-slate-700 uppercase italic",children:"Ingen oppgraderinger"})]}),l.jsxs("button",{onClick:()=>me(S.id),className:"w-full py-4 rounded-2xl bg-indigo-600/10 hover:bg-indigo-600 text-indigo-400 hover:text-white font-black uppercase text-[10px] tracking-widest transition-all border border-indigo-500/20 flex items-center justify-center gap-2 group/btn",children:[l.jsx("span",{className:"group-hover/btn:scale-125 transition-transform",children:""}),"Styr spiller"]}),l.jsxs("div",{className:"mt-4 pt-4 border-t border-white/5 flex flex-col gap-2",children:[l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{type:"number",placeholder:"Gull...",value:d[S.id]||"",onChange:W=>f({...d,[S.id]:parseInt(W.target.value)||0}),className:"flex-1 bg-black/40 border border-white/5 rounded-xl px-3 py-2 text-[10px] font-black text-white focus:border-indigo-500/50 transition-all font-mono"}),l.jsx("button",{onClick:()=>{const W=d[S.id]||0;W>0&&(OP(t,S.id,W),f({...d,[S.id]:0}))},className:"bg-emerald-600/20 hover:bg-emerald-600 text-emerald-400 hover:text-white border border-emerald-500/30 px-3 py-2 rounded-xl text-[8px] font-black uppercase transition-all",children:"GI GULL"})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("select",{value:((re=g[S.id])==null?void 0:re.resourceId)||"",onChange:W=>{var ye;return b({...g,[S.id]:{resourceId:W.target.value,amount:((ye=g[S.id])==null?void 0:ye.amount)||10}})},className:"flex-[2] bg-black/40 border border-white/5 rounded-xl px-2 py-2 text-[10px] font-bold text-amber-300 focus:border-amber-500/50 transition-all cursor-pointer",children:[l.jsx("option",{value:"",children:"Velg Ressurs..."}),Object.entries(mn).map(([W,ye])=>l.jsxs("option",{value:W,children:[ye.icon," ",ye.label]},W))]}),l.jsx("input",{type:"number",placeholder:"#",value:((Z=g[S.id])==null?void 0:Z.amount)||10,onChange:W=>{var ye;return b({...g,[S.id]:{resourceId:((ye=g[S.id])==null?void 0:ye.resourceId)||"",amount:parseInt(W.target.value)||1}})},className:"w-12 bg-black/40 border border-white/5 rounded-xl px-2 py-2 text-[10px] font-black text-white focus:border-amber-500/50 transition-all font-mono text-center"}),l.jsx("button",{onClick:()=>{const W=g[S.id];W&&W.resourceId&&W.amount>0&&(DP(t,S.id,W.resourceId,W.amount),b({...g,[S.id]:{resourceId:"",amount:10}}))},className:"bg-amber-600/20 hover:bg-amber-600 text-amber-400 hover:text-white border border-amber-500/30 px-3 py-2 rounded-xl text-[8px] font-black uppercase transition-all",children:"GI RESSURS"})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("select",{value:((Y=h[S.id])==null?void 0:Y.itemId)||"",onChange:W=>{var ye;return m({...h,[S.id]:{itemId:W.target.value,amount:((ye=h[S.id])==null?void 0:ye.amount)||1}})},className:"flex-[2] bg-black/40 border border-white/5 rounded-xl px-2 py-2 text-[10px] font-bold text-slate-300 focus:border-indigo-500/50 transition-all cursor-pointer",children:[l.jsx("option",{value:"",children:"Velg Gjenstand..."}),Object.values(Te).map(W=>l.jsxs("option",{value:W.id,children:[W.icon," ",W.name]},W.id))]}),l.jsx("input",{type:"number",placeholder:"#",value:((de=h[S.id])==null?void 0:de.amount)||1,onChange:W=>{var ye;return m({...h,[S.id]:{itemId:((ye=h[S.id])==null?void 0:ye.itemId)||"",amount:parseInt(W.target.value)||1}})},className:"w-12 bg-black/40 border border-white/5 rounded-xl px-2 py-2 text-[10px] font-black text-white focus:border-indigo-500/50 transition-all font-mono text-center"}),l.jsx("button",{onClick:()=>{const W=h[S.id];W&&W.itemId&&W.amount>0&&(MP(t,S.id,W.itemId,W.amount),m({...h,[S.id]:{itemId:"",amount:1}}))},className:"bg-indigo-600/20 hover:bg-indigo-600 text-indigo-400 hover:text-white border border-indigo-500/30 px-3 py-2 rounded-xl text-[8px] font-black uppercase transition-all",children:"GI ITEM"})]})]})]},S.id)}),Object.keys(n.players||{}).length===0&&l.jsxs("div",{className:"col-span-full py-20 text-center border-2 border-dashed border-white/5 rounded-[3rem]",children:[l.jsx("span",{className:"text-6xl block mb-4 opacity-20",children:""}),l.jsx("p",{className:"text-slate-500 font-bold uppercase tracking-widest text-xs",children:"Venter p at understter skal ankomme..."})]})]})]}),((vc=n.world)==null?void 0:vc.settlement)&&l.jsxs("section",{className:"bg-indigo-900/10 border border-indigo-500/10 p-10 rounded-[3rem] relative overflow-hidden group",children:[l.jsxs("div",{className:"relative z-10",children:[l.jsxs("h2",{className:"text-3xl font-black text-white mb-8 tracking-tighter flex items-center justify-between",children:["Landsbyutvikling",l.jsx("span",{className:"text-xs font-black uppercase tracking-widest text-indigo-400 bg-indigo-500/10 px-4 py-2 rounded-full",children:"Status Rapport"})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:Object.values(((xc=(bc=n.world)==null?void 0:bc.settlement)==null?void 0:xc.buildings)||{}).map(S=>{const M=Bt[S.id],G=S.progress/(S.target||200)*100;return l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex justify-between items-end",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-black text-white uppercase",children:M==null?void 0:M.name}),l.jsxs("p",{className:"text-[10px] text-slate-500 font-bold tracking-tight",children:["Niv ",S.level]})]}),l.jsxs("span",{className:"text-xs font-mono text-indigo-500",children:[Object.values(S.progress||{}).reduce((Q,re)=>Q+re,0)," / ",S.target||200]})]}),l.jsxs("div",{className:"h-4 bg-black/40 rounded-full overflow-hidden border border-white/5 relative group/progress",children:[l.jsx("div",{className:"h-full bg-gradient-to-r from-indigo-600 via-indigo-400 to-fuchsia-500 transition-all duration-1000 shadow-[0_0_15px_rgba(99,102,241,0.4)] relative",style:{width:`${G}%`},children:l.jsx("div",{className:"absolute inset-0 bg-white/20 animate-pulse"})}),l.jsxs("div",{className:"absolute inset-0 opacity-0 group-hover/progress:opacity-100 transition-opacity flex justify-between items-center px-1 pointer-events-none",children:[l.jsx("button",{onClick:Q=>{Q.stopPropagation(),U(S.id,-1)},className:"w-5 h-5 bg-white/10 hover:bg-rose-500 text-white rounded-full flex items-center justify-center text-[10px] font-black pointer-events-auto transition-all",children:"-"}),l.jsx("button",{onClick:Q=>{Q.stopPropagation(),U(S.id,1)},className:"w-5 h-5 bg-white/10 hover:bg-emerald-500 text-white rounded-full flex items-center justify-center text-[10px] font-black pointer-events-auto transition-all",children:"+"})]})]})]},S.id)})})]}),l.jsx("div",{className:"absolute top-[-20%] right-[-10%] text-[15rem] text-indigo-500 opacity-[0.03] pointer-events-none group-hover:rotate-6 transition-transform duration-[3000ms]",children:""})]})]})})]}),l.jsxs("aside",{className:"w-80 border-l border-white/10 bg-slate-900/50 backdrop-blur-xl flex flex-col z-20 shadow-2xl overflow-hidden",children:[l.jsxs("div",{className:"p-8 border-b border-white/5 bg-black/20 shrink-0",children:[l.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-amber-500 mb-6 flex items-center justify-between",children:["Rikets Formue",l.jsx("div",{className:"w-2 h-2 bg-amber-500 rounded-full animate-pulse shadow-[0_0_10px_rgba(245,158,11,0.5)]"})]}),l.jsxs("div",{className:"space-y-4",children:[Object.values(n.players||{}).sort((S,M)=>(M.resources.gold||0)-(S.resources.gold||0)).slice(0,5).map((S,M)=>l.jsxs("div",{className:"flex justify-between items-center group",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("span",{className:"text-xs font-black text-slate-600 font-mono",children:["#",M+1]}),l.jsx("span",{className:"text-sm font-bold text-white group-hover:translate-x-1 transition-transform",children:S.name})]}),l.jsxs("span",{className:"text-sm font-black text-amber-400",children:[S.resources.gold,""]})]},S.id)),Object.keys(n.players||{}).length===0&&l.jsx("p",{className:"text-[10px] text-slate-600 font-bold italic text-center py-4",children:"Ingen data tilgjengelig..."})]})]}),l.jsxs("div",{className:"p-8 border-b border-white/5 shrink-0",children:[l.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-indigo-400 mb-6",children:"Markedsanalyse"}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[Object.entries(n.market||{}).slice(0,4).map(([S,M])=>{const G=mn[S]||{label:S};return l.jsxs("div",{className:"bg-white/5 p-3 rounded-xl border border-white/5",children:[l.jsx("div",{className:"text-[8px] font-black uppercase text-slate-500 mb-1",children:G.label}),l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-xs font-black text-white",children:M.stock}),l.jsxs("span",{className:"text-[10px] font-mono text-emerald-400",children:[M.price.toFixed(1),"g"]})]})]},S)}),Object.entries(n.market||{}).slice(0,4).length===0&&l.jsx("div",{className:"col-span-2 text-[10px] text-slate-600 font-bold italic text-center py-4",children:"Ingen markedsdata..."})]})]}),l.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[l.jsx("div",{className:"p-8 pb-4 shrink-0",children:l.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-rose-500 flex items-center gap-2",children:[l.jsx("span",{className:"w-2 h-2 bg-rose-600 rounded-full animate-pulse shadow-[0_0_10px_rgba(225,29,72,0.5)]"}),"Global Logg"]})}),l.jsxs("div",{className:"flex-1 overflow-y-auto px-6 space-y-3 pb-8 custom-scrollbar",children:[R(n.messages).slice().reverse().map((S,M)=>l.jsx("div",{className:"bg-indigo-950/20 border-l-2 border-indigo-500/50 p-4 rounded-r-2xl animate-in slide-in-from-right-4 duration-300",children:l.jsx("p",{className:"text-[10px] font-medium leading-relaxed text-slate-400 antialiased italic font-serif opacity-80",children:typeof S=="object"?JSON.stringify(S):S})},M)),R(n.messages).length===0&&l.jsxs("div",{className:"h-full flex flex-col items-center justify-center opacity-20 py-20",children:[l.jsx("span",{className:"text-4xl mb-4",children:""}),l.jsx("p",{className:"text-[8px] font-black uppercase tracking-[0.2em]",children:"Arkivet er tomt"})]})]})]})]}),l.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .custom-scrollbar::-webkit-scrollbar {
                    width: 4px;
                }
                .custom-scrollbar::-webkit-scrollbar-track {
                    background: transparent;
                }
                .custom-scrollbar::-webkit-scrollbar-thumb {
                    background: rgba(255, 255, 255, 0.1);
                    border-radius: 10px;
                }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover {
                    background: rgba(255, 255, 255, 0.2);
                }
                .no-scrollbar::-webkit-scrollbar {
                    display: none;
                }
            `}})]})};function L6(t,e){const{user:n,authLoading:s}=pf(),[i,r]=_.useState(null),[a,o]=_.useState(null),[c,u]=_.useState({}),[d,f]=_.useState("LOBBY"),[h,m]=_.useState({}),[g,b]=_.useState({}),[x,p]=_.useState([]),[v,y]=_.useState(null),[E,N]=_.useState({}),[T,w]=_.useState({}),[A,k]=_.useState(!1),[R,C]=_.useState(!1),[B,z]=_.useState(!1),$=_.useRef(null),K=_.useRef(null);return _.useEffect(()=>{if(s)return;const U=localStorage.getItem("sim_player_id");let O=e;if(O||(n!=null&&n.uid?O=n.uid:O=U),!O||!t)return;const j=`simulation_rooms/${t}`,I=D(L,`${j}/players/${O}`),H=Ke(I,S=>{if(k(!0),S.exists()){$.current&&(clearTimeout($.current),$.current=null);const M=S.val();if(t==="TEST"&&M.regionId==="unassigned"&&M.role!=="KING"){const Q=Math.random()>.5?"region_east":"region_west";J(I,{regionId:Q})}const G={...M,id:O};r(G),K.current=G,C(!0)}else R?$.current||($.current=setTimeout(()=>{z(!0),r(null),C(!1),K.current=null},5e3)):r(null)}),X=D(L,`${j}/world`),oe=Ke(X,S=>{const M=S.val();M&&o(M)}),Ie=D(L,`${j}/status`),V=Ke(Ie,S=>{const M=S.val();M&&f(M||"LOBBY")}),me=D(L,`${j}/markets`),ne=Ke(me,S=>{const M=S.val();M&&m(M)}),tt=D(L,`${j}/messages`),zt=Ke(tt,S=>{const M=S.val();M&&p(M)}),On=D(L,`${j}/activeVote`),Mt=Ke(On,S=>{y(S.val())}),Yn=D(L,`${j}/diplomacy`),pn=Ke(Yn,S=>{N(S.val()||{})}),Hi=D(L,`${j}/trades`),Gi=Ke(Hi,S=>{w(S.val()||{})}),qn=D(L,`${j}/public_profiles`),vc=Ke(qn,S=>{const M=S.val()||{};u(M)}),bc=D(L,`${j}/regions`),xc=Ke(bc,S=>{b(S.val()||{})});return()=>{H(),oe(),V(),ne(),zt(),Mt(),pn(),vc(),Gi(),xc()}},[t,e,n==null?void 0:n.uid,s,R]),_.useEffect(()=>{if(!i||!t)return;const U=D(L,`simulation_rooms/${t}/players/${i.id}`),O=D(L,`simulation_rooms/${t}/public_profiles/${i.id}`);dy(U).update({online:!1}),dy(O).update({online:!1});const j=setInterval(()=>{const I=Date.now();J(U,{lastActive:I,online:!0}),J(O,{lastActive:I,online:!0})},3e4);return J(U,{lastActive:Date.now(),online:!0}),J(O,{lastActive:Date.now(),online:!0}),()=>clearInterval(j)},[t,i==null?void 0:i.id]),_.useEffect(()=>{if(!t||!t.startsWith("v"))return;const U=localStorage.getItem("nexus_active_vessel");if(U)try{const O=JSON.parse(U);if(O.id===t){console.log("Nexus Vessel Detected. Injecting Mock Data...",O);const j={id:O.id,uid:(n==null?void 0:n.uid)||"nexus_user",name:O.name,role:O.role.toUpperCase(),regionId:"nexus_region",resources:{gold:O.gold,grain:100,flour:0,bread:5,wood:50,plank:0,iron_ore:0,iron_ingot:0,stone:0,swords:0,armor:0,favor:0,wool:0,cloth:0,honey:0,meat:0,glass:0,manpower:10,egg:0,omelette:0},stats:{xp:0,level:1,reputation:50,contribution:0},status:{hp:O.health,morale:100,stamina:100,legitimacy:100,authority:100,loyalty:100,isJailed:!1,isFrozen:!1},equipment:{},skills:{FARMING:{level:1,xp:0,maxXp:100},WOODCUTTING:{level:1,xp:0,maxXp:100},MINING:{level:1,xp:0,maxXp:100},CRAFTING:{level:1,xp:0,maxXp:100},STEWARDSHIP:{level:1,xp:0,maxXp:100},COMBAT:{level:1,xp:0,maxXp:100},TRADING:{level:1,xp:0,maxXp:100},THEOLOGY:{level:1,xp:0,maxXp:100}},upgrades:[],lastActive:Date.now()};r(j),C(!0),k(!0),f("PLAYING"),o({year:1250,season:"Spring",weather:"Clear",gameTick:100,lastTickAt:Date.now(),taxRateDetails:{kingTax:10},settlement:{buildings:{}}})}}catch(O){console.error("Failed to parse Nexus vessel data",O)}},[t,n==null?void 0:n.uid]),TS(t,d,a),{player:i,world:a,players:c,roomStatus:d,markets:h,regions:g,messages:x,activeVote:v,diplomacy:E,trades:T,hasAttemptedPlayerLoad:A,hasActiveSession:R,isRetired:B,setIsRetired:z,setPlayer:r,lastValidPlayer:K.current}}function OS(t,e,n,s,i,r,a){const[o,c]=_.useState(null),[u,d]=_.useState(null),f=_.useCallback(()=>{d(null)},[]),h=_.useCallback(async m=>{var y;if(!t||!e||o)return;const g=typeof m=="string"?m:m.type,b=typeof m=="object"?m.method:null;if(["WORK","CHOP","CRAFT","DEFEND","EXPLORE","MINE","QUARRY","PATROL","FORAGE","REFINE","SMELT","BAKE","WEAVE","MIX","PLANT","HARVEST","GATHER_WOOL","HUNT","SAWMILL"].includes(g)&&!a&&!m.performance){const E=(n==null?void 0:n.season)||"Spring",N=(n==null?void 0:n.weather)||"Clear",T=(n==null?void 0:n.gameTick)||0,w=RS(e,m,E,N,T);if(!w.success){alert(`Du har ikke rd til dette: ${w.reason}`),d({success:!1,timestamp:Date.now(),message:`Kan ikke utfre: ${w.reason}`,utbytte:[],xp:[],durability:[]});return}let A=g;if(g==="REFINE"){const C=m.recipeId;(C==="iron_ingot"||C==="glass"||C==="smelt")&&(A="SMELT"),(C==="bread"||C==="pie"||C==="mead"||C==="bake")&&(A="BAKE"),(C==="cloth"||C==="weave")&&(A="WEAVE"),C==="plank"&&(A="SAWMILL")}g==="CRAFT"&&m.subType==="omelette"&&(A="BAKE");const R=(e.activeProcesses||[]).find(C=>{var B;return(C.locationId===m.locationId||m.locationId&&((B=C.locationId)==null?void 0:B.startsWith(m.locationId)))&&C.readyAt<=Date.now()});if(!(g==="REFINE"&&m.recipeId==="flour"||g==="HARVEST"&&((R==null?void 0:R.type)==="MILL"||(R==null?void 0:R.type)==="CRAFT"))){s(A),b&&i(b),r(m),d(null);return}}const p=g==="EQUIP_ITEM"||g==="UNEQUIP_ITEM";m.performance&&!p&&(s(null),r(null),i(null)),p||c(g);const v=new Promise((E,N)=>{setTimeout(()=>N(new Error("Handlingen tok for lang tid (Timeout)")),3e4)});try{const E=await Promise.race([jS(t,e.id,m),v]);p||(E.data?d(E.data):E.success||d({success:!1,timestamp:Date.now(),message:`Handlingen feilet: ${((y=E.error)==null?void 0:y.message)||E.error||"Ukjent feil"}`,utbytte:[],xp:[],durability:[]}))}catch(E){console.error("Action Timeout/Error:",E),p||d({success:!1,timestamp:Date.now(),message:` ${E.message||"Ukjent feil"}`,utbytte:[],xp:[],durability:[]})}p||c(null),s(null),r(null),i(null)},[t,e,o,n,a,s,i,r]);return{actionLoading:o,actionResult:u,handleAction:h,handleClearActionResult:f,setActionLoading:c}}const dp=({resource:t,amount:e,size:n="md",showLabel:s=!1})=>{const i=mn[t]||{label:t,icon:""},r={sm:"text-xl",md:"text-3xl",lg:"text-7xl"};return l.jsxs("div",{className:"flex items-center gap-2",title:i.label,children:[l.jsx("span",{className:`${r[n]}`,children:i.icon}),l.jsxs("div",{className:"flex flex-col",children:[s&&l.jsx("span",{className:"text-xs uppercase text-game-stone_light font-bold tracking-wider",children:i.label}),e!==void 0&&l.jsx("span",{className:`font-mono font-bold text-white ${n==="lg"?"text-xl":"text-sm"}`,children:e.toLocaleString()})]})]})},B0=_.createContext({});function U0(t){const e=_.useRef(null);return e.current===null&&(e.current=t()),e.current}const H0=typeof window<"u",MS=H0?_.useLayoutEffect:_.useEffect,xf=_.createContext(null);function G0(t,e){t.indexOf(e)===-1&&t.push(e)}function V0(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}const Ls=(t,e,n)=>n>e?e:n<t?t:n;let F0=()=>{};const Ps={},DS=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function LS(t){return typeof t=="object"&&t!==null}const PS=t=>/^0[^.\s]+$/u.test(t);function z0(t){let e;return()=>(e===void 0&&(e=t()),e)}const In=t=>t,P6=(t,e)=>n=>e(t(n)),hc=(...t)=>t.reduce(P6),Ml=(t,e,n)=>{const s=e-t;return s===0?1:(n-t)/s};class $0{constructor(){this.subscriptions=[]}add(e){return G0(this.subscriptions,e),()=>V0(this.subscriptions,e)}notify(e,n,s){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,n,s);else for(let r=0;r<i;r++){const a=this.subscriptions[r];a&&a(e,n,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const ns=t=>t*1e3,kn=t=>t/1e3;function BS(t,e){return e?t*(1e3/e):0}const US=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,B6=1e-7,U6=12;function H6(t,e,n,s,i){let r,a,o=0;do a=e+(n-e)/2,r=US(a,s,i)-t,r>0?n=a:e=a;while(Math.abs(r)>B6&&++o<U6);return a}function mc(t,e,n,s){if(t===e&&n===s)return In;const i=r=>H6(r,0,1,t,n);return r=>r===0||r===1?r:US(i(r),e,s)}const HS=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,GS=t=>e=>1-t(1-e),VS=mc(.33,1.53,.69,.99),K0=GS(VS),FS=HS(K0),zS=t=>(t*=2)<1?.5*K0(t):.5*(2-Math.pow(2,-10*(t-1))),Y0=t=>1-Math.sin(Math.acos(t)),$S=GS(Y0),KS=HS(Y0),G6=mc(.42,0,1,1),V6=mc(0,0,.58,1),YS=mc(.42,0,.58,1),F6=t=>Array.isArray(t)&&typeof t[0]!="number",qS=t=>Array.isArray(t)&&typeof t[0]=="number",z6={linear:In,easeIn:G6,easeInOut:YS,easeOut:V6,circIn:Y0,circInOut:KS,circOut:$S,backIn:K0,backInOut:FS,backOut:VS,anticipate:zS},$6=t=>typeof t=="string",ky=t=>{if(qS(t)){F0(t.length===4);const[e,n,s,i]=t;return mc(e,n,s,i)}else if($6(t))return z6[t];return t},Vc=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function K6(t,e){let n=new Set,s=new Set,i=!1,r=!1;const a=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function c(d){a.has(d)&&(u.schedule(d),t()),d(o)}const u={schedule:(d,f=!1,h=!1)=>{const g=h&&i?n:s;return f&&a.add(d),g.has(d)||g.add(d),d},cancel:d=>{s.delete(d),a.delete(d)},process:d=>{if(o=d,i){r=!0;return}i=!0,[n,s]=[s,n],n.forEach(c),n.clear(),i=!1,r&&(r=!1,u.process(d))}};return u}const Y6=40;function WS(t,e){let n=!1,s=!0;const i={delta:0,timestamp:0,isProcessing:!1},r=()=>n=!0,a=Vc.reduce((y,E)=>(y[E]=K6(r),y),{}),{setup:o,read:c,resolveKeyframes:u,preUpdate:d,update:f,preRender:h,render:m,postRender:g}=a,b=()=>{const y=Ps.useManualTiming?i.timestamp:performance.now();n=!1,Ps.useManualTiming||(i.delta=s?1e3/60:Math.max(Math.min(y-i.timestamp,Y6),1)),i.timestamp=y,i.isProcessing=!0,o.process(i),c.process(i),u.process(i),d.process(i),f.process(i),h.process(i),m.process(i),g.process(i),i.isProcessing=!1,n&&e&&(s=!1,t(b))},x=()=>{n=!0,s=!0,i.isProcessing||t(b)};return{schedule:Vc.reduce((y,E)=>{const N=a[E];return y[E]=(T,w=!1,A=!1)=>(n||x(),N.schedule(T,w,A)),y},{}),cancel:y=>{for(let E=0;E<Vc.length;E++)a[Vc[E]].cancel(y)},state:i,steps:a}}const{schedule:qe,cancel:Oi,state:kt,steps:_h}=WS(typeof requestAnimationFrame<"u"?requestAnimationFrame:In,!0);let mu;function q6(){mu=void 0}const Qt={now:()=>(mu===void 0&&Qt.set(kt.isProcessing||Ps.useManualTiming?kt.timestamp:performance.now()),mu),set:t=>{mu=t,queueMicrotask(q6)}},XS=t=>e=>typeof e=="string"&&e.startsWith(t),QS=XS("--"),W6=XS("var(--"),q0=t=>W6(t)?X6.test(t.split("/*")[0].trim()):!1,X6=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,oo={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Dl={...oo,transform:t=>Ls(0,1,t)},Fc={...oo,default:1},Zo=t=>Math.round(t*1e5)/1e5,W0=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Q6(t){return t==null}const J6=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,X0=(t,e)=>n=>!!(typeof n=="string"&&J6.test(n)&&n.startsWith(t)||e&&!Q6(n)&&Object.prototype.hasOwnProperty.call(n,e)),JS=(t,e,n)=>s=>{if(typeof s!="string")return s;const[i,r,a,o]=s.match(W0);return{[t]:parseFloat(i),[e]:parseFloat(r),[n]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},Z6=t=>Ls(0,255,t),wh={...oo,transform:t=>Math.round(Z6(t))},Zi={test:X0("rgb","red"),parse:JS("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:s=1})=>"rgba("+wh.transform(t)+", "+wh.transform(e)+", "+wh.transform(n)+", "+Zo(Dl.transform(s))+")"};function eB(t){let e="",n="",s="",i="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),s=t.substring(5,7),i=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),s=t.substring(3,4),i=t.substring(4,5),e+=e,n+=n,s+=s,i+=i),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(s,16),alpha:i?parseInt(i,16)/255:1}}const fp={test:X0("#"),parse:eB,transform:Zi.transform},pc=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),zs=pc("deg"),ss=pc("%"),se=pc("px"),tB=pc("vh"),nB=pc("vw"),Sy={...ss,parse:t=>ss.parse(t)/100,transform:t=>ss.transform(t*100)},ea={test:X0("hsl","hue"),parse:JS("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:s=1})=>"hsla("+Math.round(t)+", "+ss.transform(Zo(e))+", "+ss.transform(Zo(n))+", "+Zo(Dl.transform(s))+")"},rt={test:t=>Zi.test(t)||fp.test(t)||ea.test(t),parse:t=>Zi.test(t)?Zi.parse(t):ea.test(t)?ea.parse(t):fp.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Zi.transform(t):ea.transform(t),getAnimatableNone:t=>{const e=rt.parse(t);return e.alpha=0,rt.transform(e)}},sB=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function iB(t){var e,n;return isNaN(t)&&typeof t=="string"&&(((e=t.match(W0))==null?void 0:e.length)||0)+(((n=t.match(sB))==null?void 0:n.length)||0)>0}const ZS="number",eT="color",rB="var",aB="var(",Ty="${}",oB=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Ll(t){const e=t.toString(),n=[],s={color:[],number:[],var:[]},i=[];let r=0;const o=e.replace(oB,c=>(rt.test(c)?(s.color.push(r),i.push(eT),n.push(rt.parse(c))):c.startsWith(aB)?(s.var.push(r),i.push(rB),n.push(c)):(s.number.push(r),i.push(ZS),n.push(parseFloat(c))),++r,Ty)).split(Ty);return{values:n,split:o,indexes:s,types:i}}function tT(t){return Ll(t).values}function nT(t){const{split:e,types:n}=Ll(t),s=e.length;return i=>{let r="";for(let a=0;a<s;a++)if(r+=e[a],i[a]!==void 0){const o=n[a];o===ZS?r+=Zo(i[a]):o===eT?r+=rt.transform(i[a]):r+=i[a]}return r}}const lB=t=>typeof t=="number"?0:rt.test(t)?rt.getAnimatableNone(t):t;function cB(t){const e=tT(t);return nT(t)(e.map(lB))}const Mi={test:iB,parse:tT,createTransformer:nT,getAnimatableNone:cB};function Eh(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function uB({hue:t,saturation:e,lightness:n,alpha:s}){t/=360,e/=100,n/=100;let i=0,r=0,a=0;if(!e)i=r=a=n;else{const o=n<.5?n*(1+e):n+e-n*e,c=2*n-o;i=Eh(c,o,t+1/3),r=Eh(c,o,t),a=Eh(c,o,t-1/3)}return{red:Math.round(i*255),green:Math.round(r*255),blue:Math.round(a*255),alpha:s}}function _d(t,e){return n=>n>0?e:t}const Qe=(t,e,n)=>t+(e-t)*n,Nh=(t,e,n)=>{const s=t*t,i=n*(e*e-s)+s;return i<0?0:Math.sqrt(i)},dB=[fp,Zi,ea],fB=t=>dB.find(e=>e.test(t));function Ay(t){const e=fB(t);if(!e)return!1;let n=e.parse(t);return e===ea&&(n=uB(n)),n}const Ry=(t,e)=>{const n=Ay(t),s=Ay(e);if(!n||!s)return _d(t,e);const i={...n};return r=>(i.red=Nh(n.red,s.red,r),i.green=Nh(n.green,s.green,r),i.blue=Nh(n.blue,s.blue,r),i.alpha=Qe(n.alpha,s.alpha,r),Zi.transform(i))},hp=new Set(["none","hidden"]);function hB(t,e){return hp.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function mB(t,e){return n=>Qe(t,e,n)}function Q0(t){return typeof t=="number"?mB:typeof t=="string"?q0(t)?_d:rt.test(t)?Ry:vB:Array.isArray(t)?sT:typeof t=="object"?rt.test(t)?Ry:pB:_d}function sT(t,e){const n=[...t],s=n.length,i=t.map((r,a)=>Q0(r)(r,e[a]));return r=>{for(let a=0;a<s;a++)n[a]=i[a](r);return n}}function pB(t,e){const n={...t,...e},s={};for(const i in n)t[i]!==void 0&&e[i]!==void 0&&(s[i]=Q0(t[i])(t[i],e[i]));return i=>{for(const r in s)n[r]=s[r](i);return n}}function gB(t,e){const n=[],s={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const r=e.types[i],a=t.indexes[r][s[r]],o=t.values[a]??0;n[i]=o,s[r]++}return n}const vB=(t,e)=>{const n=Mi.createTransformer(e),s=Ll(t),i=Ll(e);return s.indexes.var.length===i.indexes.var.length&&s.indexes.color.length===i.indexes.color.length&&s.indexes.number.length>=i.indexes.number.length?hp.has(t)&&!i.values.length||hp.has(e)&&!s.values.length?hB(t,e):hc(sT(gB(s,i),i.values),n):_d(t,e)};function iT(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?Qe(t,e,n):Q0(t)(t,e)}const bB=t=>{const e=({timestamp:n})=>t(n);return{start:(n=!0)=>qe.update(e,n),stop:()=>Oi(e),now:()=>kt.isProcessing?kt.timestamp:Qt.now()}},rT=(t,e,n=10)=>{let s="";const i=Math.max(Math.round(e/n),2);for(let r=0;r<i;r++)s+=Math.round(t(r/(i-1))*1e4)/1e4+", ";return`linear(${s.substring(0,s.length-2)})`},wd=2e4;function J0(t){let e=0;const n=50;let s=t.next(e);for(;!s.done&&e<wd;)e+=n,s=t.next(e);return e>=wd?1/0:e}function xB(t,e=100,n){const s=n({...t,keyframes:[0,e]}),i=Math.min(J0(s),wd);return{type:"keyframes",ease:r=>s.next(i*r).value/e,duration:kn(i)}}const yB=5;function aT(t,e,n){const s=Math.max(e-yB,0);return BS(n-t(s),e-s)}const Ze={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},kh=.001;function _B({duration:t=Ze.duration,bounce:e=Ze.bounce,velocity:n=Ze.velocity,mass:s=Ze.mass}){let i,r,a=1-e;a=Ls(Ze.minDamping,Ze.maxDamping,a),t=Ls(Ze.minDuration,Ze.maxDuration,kn(t)),a<1?(i=u=>{const d=u*a,f=d*t,h=d-n,m=mp(u,a),g=Math.exp(-f);return kh-h/m*g},r=u=>{const f=u*a*t,h=f*n+n,m=Math.pow(a,2)*Math.pow(u,2)*t,g=Math.exp(-f),b=mp(Math.pow(u,2),a);return(-i(u)+kh>0?-1:1)*((h-m)*g)/b}):(i=u=>{const d=Math.exp(-u*t),f=(u-n)*t+1;return-kh+d*f},r=u=>{const d=Math.exp(-u*t),f=(n-u)*(t*t);return d*f});const o=5/t,c=EB(i,r,o);if(t=ns(t),isNaN(c))return{stiffness:Ze.stiffness,damping:Ze.damping,duration:t};{const u=Math.pow(c,2)*s;return{stiffness:u,damping:a*2*Math.sqrt(s*u),duration:t}}}const wB=12;function EB(t,e,n){let s=n;for(let i=1;i<wB;i++)s=s-t(s)/e(s);return s}function mp(t,e){return t*Math.sqrt(1-e*e)}const NB=["duration","bounce"],kB=["stiffness","damping","mass"];function Iy(t,e){return e.some(n=>t[n]!==void 0)}function SB(t){let e={velocity:Ze.velocity,stiffness:Ze.stiffness,damping:Ze.damping,mass:Ze.mass,isResolvedFromDuration:!1,...t};if(!Iy(t,kB)&&Iy(t,NB))if(t.visualDuration){const n=t.visualDuration,s=2*Math.PI/(n*1.2),i=s*s,r=2*Ls(.05,1,1-(t.bounce||0))*Math.sqrt(i);e={...e,mass:Ze.mass,stiffness:i,damping:r}}else{const n=_B(t);e={...e,...n,mass:Ze.mass},e.isResolvedFromDuration=!0}return e}function Ed(t=Ze.visualDuration,e=Ze.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:s,restDelta:i}=n;const r=n.keyframes[0],a=n.keyframes[n.keyframes.length-1],o={done:!1,value:r},{stiffness:c,damping:u,mass:d,duration:f,velocity:h,isResolvedFromDuration:m}=SB({...n,velocity:-kn(n.velocity||0)}),g=h||0,b=u/(2*Math.sqrt(c*d)),x=a-r,p=kn(Math.sqrt(c/d)),v=Math.abs(x)<5;s||(s=v?Ze.restSpeed.granular:Ze.restSpeed.default),i||(i=v?Ze.restDelta.granular:Ze.restDelta.default);let y;if(b<1){const N=mp(p,b);y=T=>{const w=Math.exp(-b*p*T);return a-w*((g+b*p*x)/N*Math.sin(N*T)+x*Math.cos(N*T))}}else if(b===1)y=N=>a-Math.exp(-p*N)*(x+(g+p*x)*N);else{const N=p*Math.sqrt(b*b-1);y=T=>{const w=Math.exp(-b*p*T),A=Math.min(N*T,300);return a-w*((g+b*p*x)*Math.sinh(A)+N*x*Math.cosh(A))/N}}const E={calculatedDuration:m&&f||null,next:N=>{const T=y(N);if(m)o.done=N>=f;else{let w=N===0?g:0;b<1&&(w=N===0?ns(g):aT(y,N,T));const A=Math.abs(w)<=s,k=Math.abs(a-T)<=i;o.done=A&&k}return o.value=o.done?a:T,o},toString:()=>{const N=Math.min(J0(E),wd),T=rT(w=>E.next(N*w).value,N,30);return N+"ms "+T},toTransition:()=>{}};return E}Ed.applyToOptions=t=>{const e=xB(t,100,Ed);return t.ease=e.ease,t.duration=ns(e.duration),t.type="keyframes",t};function pp({keyframes:t,velocity:e=0,power:n=.8,timeConstant:s=325,bounceDamping:i=10,bounceStiffness:r=500,modifyTarget:a,min:o,max:c,restDelta:u=.5,restSpeed:d}){const f=t[0],h={done:!1,value:f},m=A=>o!==void 0&&A<o||c!==void 0&&A>c,g=A=>o===void 0?c:c===void 0||Math.abs(o-A)<Math.abs(c-A)?o:c;let b=n*e;const x=f+b,p=a===void 0?x:a(x);p!==x&&(b=p-f);const v=A=>-b*Math.exp(-A/s),y=A=>p+v(A),E=A=>{const k=v(A),R=y(A);h.done=Math.abs(k)<=u,h.value=h.done?p:R};let N,T;const w=A=>{m(h.value)&&(N=A,T=Ed({keyframes:[h.value,g(h.value)],velocity:aT(y,A,h.value),damping:i,stiffness:r,restDelta:u,restSpeed:d}))};return w(0),{calculatedDuration:null,next:A=>{let k=!1;return!T&&N===void 0&&(k=!0,E(A),w(A)),N!==void 0&&A>=N?T.next(A-N):(!k&&E(A),h)}}}function TB(t,e,n){const s=[],i=n||Ps.mix||iT,r=t.length-1;for(let a=0;a<r;a++){let o=i(t[a],t[a+1]);if(e){const c=Array.isArray(e)?e[a]||In:e;o=hc(c,o)}s.push(o)}return s}function AB(t,e,{clamp:n=!0,ease:s,mixer:i}={}){const r=t.length;if(F0(r===e.length),r===1)return()=>e[0];if(r===2&&e[0]===e[1])return()=>e[1];const a=t[0]===t[1];t[0]>t[r-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=TB(e,s,i),c=o.length,u=d=>{if(a&&d<t[0])return e[0];let f=0;if(c>1)for(;f<t.length-2&&!(d<t[f+1]);f++);const h=Ml(t[f],t[f+1],d);return o[f](h)};return n?d=>u(Ls(t[0],t[r-1],d)):u}function RB(t,e){const n=t[t.length-1];for(let s=1;s<=e;s++){const i=Ml(0,e,s);t.push(Qe(n,1,i))}}function IB(t){const e=[0];return RB(e,t.length-1),e}function CB(t,e){return t.map(n=>n*e)}function jB(t,e){return t.map(()=>e||YS).splice(0,t.length-1)}function el({duration:t=300,keyframes:e,times:n,ease:s="easeInOut"}){const i=F6(s)?s.map(ky):ky(s),r={done:!1,value:e[0]},a=CB(n&&n.length===e.length?n:IB(e),t),o=AB(a,e,{ease:Array.isArray(i)?i:jB(e,i)});return{calculatedDuration:t,next:c=>(r.value=o(c),r.done=c>=t,r)}}const OB=t=>t!==null;function Z0(t,{repeat:e,repeatType:n="loop"},s,i=1){const r=t.filter(OB),o=i<0||e&&n!=="loop"&&e%2===1?0:r.length-1;return!o||s===void 0?r[o]:s}const MB={decay:pp,inertia:pp,tween:el,keyframes:el,spring:Ed};function oT(t){typeof t.type=="string"&&(t.type=MB[t.type])}class ev{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,n){return this.finished.then(e,n)}}const DB=t=>t/100;class tv extends ev{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var s,i;const{motionValue:n}=this.options;n&&n.updatedAt!==Qt.now()&&this.tick(Qt.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(i=(s=this.options).onStop)==null||i.call(s))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;oT(e);const{type:n=el,repeat:s=0,repeatDelay:i=0,repeatType:r,velocity:a=0}=e;let{keyframes:o}=e;const c=n||el;c!==el&&typeof o[0]!="number"&&(this.mixKeyframes=hc(DB,iT(o[0],o[1])),o=[0,100]);const u=c({...e,keyframes:o});r==="mirror"&&(this.mirroredGenerator=c({...e,keyframes:[...o].reverse(),velocity:-a})),u.calculatedDuration===null&&(u.calculatedDuration=J0(u));const{calculatedDuration:d}=u;this.calculatedDuration=d,this.resolvedDuration=d+i,this.totalDuration=this.resolvedDuration*(s+1)-i,this.generator=u}updateTime(e){const n=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(e,n=!1){const{generator:s,totalDuration:i,mixKeyframes:r,mirroredGenerator:a,resolvedDuration:o,calculatedDuration:c}=this;if(this.startTime===null)return s.next(0);const{delay:u=0,keyframes:d,repeat:f,repeatType:h,repeatDelay:m,type:g,onUpdate:b,finalKeyframe:x}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-i/this.speed,this.startTime)),n?this.currentTime=e:this.updateTime(e);const p=this.currentTime-u*(this.playbackSpeed>=0?1:-1),v=this.playbackSpeed>=0?p<0:p>i;this.currentTime=Math.max(p,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let y=this.currentTime,E=s;if(f){const A=Math.min(this.currentTime,i)/o;let k=Math.floor(A),R=A%1;!R&&A>=1&&(R=1),R===1&&k--,k=Math.min(k,f+1),!!(k%2)&&(h==="reverse"?(R=1-R,m&&(R-=m/o)):h==="mirror"&&(E=a)),y=Ls(0,1,R)*o}const N=v?{done:!1,value:d[0]}:E.next(y);r&&(N.value=r(N.value));let{done:T}=N;!v&&c!==null&&(T=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const w=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&T);return w&&g!==pp&&(N.value=Z0(d,this.options,x,this.speed)),b&&b(N.value),w&&this.finish(),N}then(e,n){return this.finished.then(e,n)}get duration(){return kn(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+kn(e)}get time(){return kn(this.currentTime)}set time(e){var n;e=ns(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(n=this.driver)==null||n.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Qt.now());const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=kn(this.currentTime))}play(){var i,r;if(this.isStopped)return;const{driver:e=bB,startTime:n}=this.options;this.driver||(this.driver=e(a=>this.tick(a))),(r=(i=this.options).onPlay)==null||r.call(i);const s=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=s):this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime||(this.startTime=n??s),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Qt.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,n;this.notifyFinished(),this.teardown(),this.state="finished",(n=(e=this.options).onComplete)==null||n.call(e)}cancel(){var e,n;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(n=(e=this.options).onCancel)==null||n.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var n;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(n=this.driver)==null||n.stop(),e.observe(this)}}function LB(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const er=t=>t*180/Math.PI,gp=t=>{const e=er(Math.atan2(t[1],t[0]));return vp(e)},PB={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:gp,rotateZ:gp,skewX:t=>er(Math.atan(t[1])),skewY:t=>er(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},vp=t=>(t=t%360,t<0&&(t+=360),t),Cy=gp,jy=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),Oy=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),BB={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:jy,scaleY:Oy,scale:t=>(jy(t)+Oy(t))/2,rotateX:t=>vp(er(Math.atan2(t[6],t[5]))),rotateY:t=>vp(er(Math.atan2(-t[2],t[0]))),rotateZ:Cy,rotate:Cy,skewX:t=>er(Math.atan(t[4])),skewY:t=>er(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function bp(t){return t.includes("scale")?1:0}function xp(t,e){if(!t||t==="none")return bp(e);const n=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let s,i;if(n)s=BB,i=n;else{const o=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);s=PB,i=o}if(!i)return bp(e);const r=s[e],a=i[1].split(",").map(HB);return typeof r=="function"?r(a):a[r]}const UB=(t,e)=>{const{transform:n="none"}=getComputedStyle(t);return xp(n,e)};function HB(t){return parseFloat(t.trim())}const lo=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],co=new Set(lo),My=t=>t===oo||t===se,GB=new Set(["x","y","z"]),VB=lo.filter(t=>!GB.has(t));function FB(t){const e=[];return VB.forEach(n=>{const s=t.getValue(n);s!==void 0&&(e.push([n,s.get()]),s.set(n.startsWith("scale")?1:0))}),e}const or={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>xp(e,"x"),y:(t,{transform:e})=>xp(e,"y")};or.translateX=or.x;or.translateY=or.y;const lr=new Set;let yp=!1,_p=!1,wp=!1;function lT(){if(_p){const t=Array.from(lr).filter(s=>s.needsMeasurement),e=new Set(t.map(s=>s.element)),n=new Map;e.forEach(s=>{const i=FB(s);i.length&&(n.set(s,i),s.render())}),t.forEach(s=>s.measureInitialState()),e.forEach(s=>{s.render();const i=n.get(s);i&&i.forEach(([r,a])=>{var o;(o=s.getValue(r))==null||o.set(a)})}),t.forEach(s=>s.measureEndState()),t.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}_p=!1,yp=!1,lr.forEach(t=>t.complete(wp)),lr.clear()}function cT(){lr.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(_p=!0)})}function zB(){wp=!0,cT(),lT(),wp=!1}class nv{constructor(e,n,s,i,r,a=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=s,this.motionValue=i,this.element=r,this.isAsync=a}scheduleResolve(){this.state="scheduled",this.isAsync?(lr.add(this),yp||(yp=!0,qe.read(cT),qe.resolveKeyframes(lT))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:s,motionValue:i}=this;if(e[0]===null){const r=i==null?void 0:i.get(),a=e[e.length-1];if(r!==void 0)e[0]=r;else if(s&&n){const o=s.readValue(n,a);o!=null&&(e[0]=o)}e[0]===void 0&&(e[0]=a),i&&r===void 0&&i.set(e[0])}LB(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),lr.delete(this)}cancel(){this.state==="scheduled"&&(lr.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const $B=t=>t.startsWith("--");function KB(t,e,n){$B(e)?t.style.setProperty(e,n):t.style[e]=n}const YB=z0(()=>window.ScrollTimeline!==void 0),qB={};function WB(t,e){const n=z0(t);return()=>qB[e]??n()}const uT=WB(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Co=([t,e,n,s])=>`cubic-bezier(${t}, ${e}, ${n}, ${s})`,Dy={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Co([0,.65,.55,1]),circOut:Co([.55,0,1,.45]),backIn:Co([.31,.01,.66,-.59]),backOut:Co([.33,1.53,.69,.99])};function dT(t,e){if(t)return typeof t=="function"?uT()?rT(t,e):"ease-out":qS(t)?Co(t):Array.isArray(t)?t.map(n=>dT(n,e)||Dy.easeOut):Dy[t]}function XB(t,e,n,{delay:s=0,duration:i=300,repeat:r=0,repeatType:a="loop",ease:o="easeOut",times:c}={},u=void 0){const d={[e]:n};c&&(d.offset=c);const f=dT(o,i);Array.isArray(f)&&(d.easing=f);const h={delay:s,duration:i,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:r+1,direction:a==="reverse"?"alternate":"normal"};return u&&(h.pseudoElement=u),t.animate(d,h)}function fT(t){return typeof t=="function"&&"applyToOptions"in t}function QB({type:t,...e}){return fT(t)&&uT()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class JB extends ev{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:n,name:s,keyframes:i,pseudoElement:r,allowFlatten:a=!1,finalKeyframe:o,onComplete:c}=e;this.isPseudoElement=!!r,this.allowFlatten=a,this.options=e,F0(typeof e.type!="string");const u=QB(e);this.animation=XB(n,s,i,u,r),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!r){const d=Z0(i,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(d):KB(n,s,d),this.animation.cancel()}c==null||c(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,n;(n=(e=this.animation).finish)==null||n.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,n;this.isPseudoElement||(n=(e=this.animation).commitStyles)==null||n.call(e)}get duration(){var n,s;const e=((s=(n=this.animation.effect)==null?void 0:n.getComputedTiming)==null?void 0:s.call(n).duration)||0;return kn(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+kn(e)}get time(){return kn(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=ns(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:n}){var s;return this.allowFlatten&&((s=this.animation.effect)==null||s.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&YB()?(this.animation.timeline=e,In):n(this)}}const hT={anticipate:zS,backInOut:FS,circInOut:KS};function ZB(t){return t in hT}function eU(t){typeof t.ease=="string"&&ZB(t.ease)&&(t.ease=hT[t.ease])}const Ly=10;class tU extends JB{constructor(e){eU(e),oT(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:n,onUpdate:s,onComplete:i,element:r,...a}=this.options;if(!n)return;if(e!==void 0){n.set(e);return}const o=new tv({...a,autoplay:!1}),c=ns(this.finishedTime??this.time);n.setWithVelocity(o.sample(c-Ly).value,o.sample(c).value,Ly),o.stop()}}const Py=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Mi.test(t)||t==="0")&&!t.startsWith("url("));function nU(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function sU(t,e,n,s){const i=t[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const r=t[t.length-1],a=Py(i,e),o=Py(r,e);return!a||!o?!1:nU(t)||(n==="spring"||fT(n))&&s}function Ep(t){t.duration=0,t.type="keyframes"}const iU=new Set(["opacity","clipPath","filter","transform"]),rU=z0(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function aU(t){var d;const{motionValue:e,name:n,repeatDelay:s,repeatType:i,damping:r,type:a}=t;if(!(((d=e==null?void 0:e.owner)==null?void 0:d.current)instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:u}=e.owner.getProps();return rU()&&n&&iU.has(n)&&(n!=="transform"||!u)&&!c&&!s&&i!=="mirror"&&r!==0&&a!=="inertia"}const oU=40;class lU extends ev{constructor({autoplay:e=!0,delay:n=0,type:s="keyframes",repeat:i=0,repeatDelay:r=0,repeatType:a="loop",keyframes:o,name:c,motionValue:u,element:d,...f}){var g;super(),this.stop=()=>{var b,x;this._animation&&(this._animation.stop(),(b=this.stopTimeline)==null||b.call(this)),(x=this.keyframeResolver)==null||x.cancel()},this.createdAt=Qt.now();const h={autoplay:e,delay:n,type:s,repeat:i,repeatDelay:r,repeatType:a,name:c,motionValue:u,element:d,...f},m=(d==null?void 0:d.KeyframeResolver)||nv;this.keyframeResolver=new m(o,(b,x,p)=>this.onKeyframesResolved(b,x,h,!p),c,u,d),(g=this.keyframeResolver)==null||g.scheduleResolve()}onKeyframesResolved(e,n,s,i){this.keyframeResolver=void 0;const{name:r,type:a,velocity:o,delay:c,isHandoff:u,onUpdate:d}=s;this.resolvedAt=Qt.now(),sU(e,r,a,o)||((Ps.instantAnimations||!c)&&(d==null||d(Z0(e,s,n))),e[0]=e[e.length-1],Ep(s),s.repeat=0);const h={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>oU?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...s,keyframes:e},m=!u&&aU(h)?new tU({...h,element:h.motionValue.owner.current}):new tv(h);m.finished.then(()=>this.notifyFinished()).catch(In),this.pendingTimeline&&(this.stopTimeline=m.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=m}get finished(){return this._animation?this.animation.finished:this._finished}then(e,n){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),zB()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}const cU=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function uU(t){const e=cU.exec(t);if(!e)return[,];const[,n,s,i]=e;return[`--${n??s}`,i]}function mT(t,e,n=1){const[s,i]=uU(t);if(!s)return;const r=window.getComputedStyle(e).getPropertyValue(s);if(r){const a=r.trim();return DS(a)?parseFloat(a):a}return q0(i)?mT(i,e,n+1):i}function sv(t,e){return(t==null?void 0:t[e])??(t==null?void 0:t.default)??t}const pT=new Set(["width","height","top","left","right","bottom",...lo]),dU={test:t=>t==="auto",parse:t=>t},gT=t=>e=>e.test(t),vT=[oo,se,ss,zs,nB,tB,dU],By=t=>vT.find(gT(t));function fU(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||PS(t):!0}const hU=new Set(["brightness","contrast","saturate","opacity"]);function mU(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[s]=n.match(W0)||[];if(!s)return t;const i=n.replace(s,"");let r=hU.has(e)?1:0;return s!==n&&(r*=100),e+"("+r+i+")"}const pU=/\b([a-z-]*)\(.*?\)/gu,Np={...Mi,getAnimatableNone:t=>{const e=t.match(pU);return e?e.map(mU).join(" "):t}},Uy={...oo,transform:Math.round},gU={rotate:zs,rotateX:zs,rotateY:zs,rotateZ:zs,scale:Fc,scaleX:Fc,scaleY:Fc,scaleZ:Fc,skew:zs,skewX:zs,skewY:zs,distance:se,translateX:se,translateY:se,translateZ:se,x:se,y:se,z:se,perspective:se,transformPerspective:se,opacity:Dl,originX:Sy,originY:Sy,originZ:se},iv={borderWidth:se,borderTopWidth:se,borderRightWidth:se,borderBottomWidth:se,borderLeftWidth:se,borderRadius:se,radius:se,borderTopLeftRadius:se,borderTopRightRadius:se,borderBottomRightRadius:se,borderBottomLeftRadius:se,width:se,maxWidth:se,height:se,maxHeight:se,top:se,right:se,bottom:se,left:se,padding:se,paddingTop:se,paddingRight:se,paddingBottom:se,paddingLeft:se,margin:se,marginTop:se,marginRight:se,marginBottom:se,marginLeft:se,backgroundPositionX:se,backgroundPositionY:se,...gU,zIndex:Uy,fillOpacity:Dl,strokeOpacity:Dl,numOctaves:Uy},vU={...iv,color:rt,backgroundColor:rt,outlineColor:rt,fill:rt,stroke:rt,borderColor:rt,borderTopColor:rt,borderRightColor:rt,borderBottomColor:rt,borderLeftColor:rt,filter:Np,WebkitFilter:Np},bT=t=>vU[t];function xT(t,e){let n=bT(t);return n!==Np&&(n=Mi),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const bU=new Set(["auto","none","0"]);function xU(t,e,n){let s=0,i;for(;s<t.length&&!i;){const r=t[s];typeof r=="string"&&!bU.has(r)&&Ll(r).values.length&&(i=t[s]),s++}if(i&&n)for(const r of e)t[r]=xT(n,i)}class yU extends nv{constructor(e,n,s,i,r){super(e,n,s,i,r,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:s}=this;if(!n||!n.current)return;super.readKeyframes();for(let c=0;c<e.length;c++){let u=e[c];if(typeof u=="string"&&(u=u.trim(),q0(u))){const d=mT(u,n.current);d!==void 0&&(e[c]=d),c===e.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!pT.has(s)||e.length!==2)return;const[i,r]=e,a=By(i),o=By(r);if(a!==o)if(My(a)&&My(o))for(let c=0;c<e.length;c++){const u=e[c];typeof u=="string"&&(e[c]=parseFloat(u))}else or[s]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,s=[];for(let i=0;i<e.length;i++)(e[i]===null||fU(e[i]))&&s.push(i);s.length&&xU(e,s,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:s}=this;if(!e||!e.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=or[s](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const i=n[n.length-1];i!==void 0&&e.getValue(s,i).jump(i,!1)}measureEndState(){var o;const{element:e,name:n,unresolvedKeyframes:s}=this;if(!e||!e.current)return;const i=e.getValue(n);i&&i.jump(this.measuredOrigin,!1);const r=s.length-1,a=s[r];s[r]=or[n](e.measureViewportBox(),window.getComputedStyle(e.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),(o=this.removedTransforms)!=null&&o.length&&this.removedTransforms.forEach(([c,u])=>{e.getValue(c).set(u)}),this.resolveNoneKeyframes()}}function _U(t,e,n){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let s=document;const i=(n==null?void 0:n[t])??s.querySelectorAll(t);return i?Array.from(i):[]}return Array.from(t)}const yT=(t,e)=>e&&typeof t=="number"?e.transform(t):t;function _T(t){return LS(t)&&"offsetHeight"in t}const Hy=30,wU=t=>!isNaN(parseFloat(t));class EU{constructor(e,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=s=>{var r;const i=Qt.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&((r=this.events.change)==null||r.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=Qt.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=wU(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new $0);const s=this.events[e].add(n);return e==="change"?()=>{s(),qe.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,n,s){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-s}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Qt.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>Hy)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,Hy);return BS(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,n;(e=this.dependents)==null||e.clear(),(n=this.events.destroy)==null||n.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Ha(t,e){return new EU(t,e)}const{schedule:rv}=WS(queueMicrotask,!1),Ln={x:!1,y:!1};function wT(){return Ln.x||Ln.y}function NU(t){return t==="x"||t==="y"?Ln[t]?null:(Ln[t]=!0,()=>{Ln[t]=!1}):Ln.x||Ln.y?null:(Ln.x=Ln.y=!0,()=>{Ln.x=Ln.y=!1})}function ET(t,e){const n=_U(t),s=new AbortController,i={passive:!0,...e,signal:s.signal};return[n,i,()=>s.abort()]}function Gy(t){return!(t.pointerType==="touch"||wT())}function kU(t,e,n={}){const[s,i,r]=ET(t,n),a=o=>{if(!Gy(o))return;const{target:c}=o,u=e(c,o);if(typeof u!="function"||!c)return;const d=f=>{Gy(f)&&(u(f),c.removeEventListener("pointerleave",d))};c.addEventListener("pointerleave",d,i)};return s.forEach(o=>{o.addEventListener("pointerenter",a,i)}),r}const NT=(t,e)=>e?t===e?!0:NT(t,e.parentElement):!1,av=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,SU=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function TU(t){return SU.has(t.tagName)||t.tabIndex!==-1}const pu=new WeakSet;function Vy(t){return e=>{e.key==="Enter"&&t(e)}}function Sh(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const AU=(t,e)=>{const n=t.currentTarget;if(!n)return;const s=Vy(()=>{if(pu.has(n))return;Sh(n,"down");const i=Vy(()=>{Sh(n,"up")}),r=()=>Sh(n,"cancel");n.addEventListener("keyup",i,e),n.addEventListener("blur",r,e)});n.addEventListener("keydown",s,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",s),e)};function Fy(t){return av(t)&&!wT()}function RU(t,e,n={}){const[s,i,r]=ET(t,n),a=o=>{const c=o.currentTarget;if(!Fy(o))return;pu.add(c);const u=e(c,o),d=(m,g)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",h),pu.has(c)&&pu.delete(c),Fy(m)&&typeof u=="function"&&u(m,{success:g})},f=m=>{d(m,c===window||c===document||n.useGlobalTarget||NT(c,m.target))},h=m=>{d(m,!1)};window.addEventListener("pointerup",f,i),window.addEventListener("pointercancel",h,i)};return s.forEach(o=>{(n.useGlobalTarget?window:o).addEventListener("pointerdown",a,i),_T(o)&&(o.addEventListener("focus",u=>AU(u,i)),!TU(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),r}function kT(t){return LS(t)&&"ownerSVGElement"in t}function IU(t){return kT(t)&&t.tagName==="svg"}const Ot=t=>!!(t&&t.getVelocity),CU=[...vT,rt,Mi],jU=t=>CU.find(gT(t)),ov=_.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function zy(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function OU(...t){return e=>{let n=!1;const s=t.map(i=>{const r=zy(i,e);return!n&&typeof r=="function"&&(n=!0),r});if(n)return()=>{for(let i=0;i<s.length;i++){const r=s[i];typeof r=="function"?r():zy(t[i],null)}}}}function MU(...t){return _.useCallback(OU(...t),t)}class DU extends _.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const s=n.offsetParent,i=_T(s)&&s.offsetWidth||0,r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft,r.right=i-r.width-r.left}return null}componentDidUpdate(){}render(){return this.props.children}}function LU({children:t,isPresent:e,anchorX:n,root:s}){const i=_.useId(),r=_.useRef(null),a=_.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=_.useContext(ov),c=MU(r,t==null?void 0:t.ref);return _.useInsertionEffect(()=>{const{width:u,height:d,top:f,left:h,right:m}=a.current;if(e||!r.current||!u||!d)return;const g=n==="left"?`left: ${h}`:`right: ${m}`;r.current.dataset.motionPopId=i;const b=document.createElement("style");o&&(b.nonce=o);const x=s??document.head;return x.appendChild(b),b.sheet&&b.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${u}px !important;
            height: ${d}px !important;
            ${g}px !important;
            top: ${f}px !important;
          }
        `),()=>{x.contains(b)&&x.removeChild(b)}},[e]),l.jsx(DU,{isPresent:e,childRef:r,sizeRef:a,children:_.cloneElement(t,{ref:c})})}const PU=({children:t,initial:e,isPresent:n,onExitComplete:s,custom:i,presenceAffectsLayout:r,mode:a,anchorX:o,root:c})=>{const u=U0(BU),d=_.useId();let f=!0,h=_.useMemo(()=>(f=!1,{id:d,initial:e,isPresent:n,custom:i,onExitComplete:m=>{u.set(m,!0);for(const g of u.values())if(!g)return;s&&s()},register:m=>(u.set(m,!1),()=>u.delete(m))}),[n,u,s]);return r&&f&&(h={...h}),_.useMemo(()=>{u.forEach((m,g)=>u.set(g,!1))},[n]),_.useEffect(()=>{!n&&!u.size&&s&&s()},[n]),a==="popLayout"&&(t=l.jsx(LU,{isPresent:n,anchorX:o,root:c,children:t})),l.jsx(xf.Provider,{value:h,children:t})};function BU(){return new Map}function ST(t=!0){const e=_.useContext(xf);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:s,register:i}=e,r=_.useId();_.useEffect(()=>{if(t)return i(r)},[t]);const a=_.useCallback(()=>t&&s&&s(r),[r,s,t]);return!n&&s?[!1,a]:[!0]}const zc=t=>t.key||"";function $y(t){const e=[];return _.Children.forEach(t,n=>{_.isValidElement(n)&&e.push(n)}),e}const Ei=({children:t,custom:e,initial:n=!0,onExitComplete:s,presenceAffectsLayout:i=!0,mode:r="sync",propagate:a=!1,anchorX:o="left",root:c})=>{const[u,d]=ST(a),f=_.useMemo(()=>$y(t),[t]),h=a&&!u?[]:f.map(zc),m=_.useRef(!0),g=_.useRef(f),b=U0(()=>new Map),[x,p]=_.useState(f),[v,y]=_.useState(f);MS(()=>{m.current=!1,g.current=f;for(let T=0;T<v.length;T++){const w=zc(v[T]);h.includes(w)?b.delete(w):b.get(w)!==!0&&b.set(w,!1)}},[v,h.length,h.join("-")]);const E=[];if(f!==x){let T=[...f];for(let w=0;w<v.length;w++){const A=v[w],k=zc(A);h.includes(k)||(T.splice(w,0,A),E.push(A))}return r==="wait"&&E.length&&(T=E),y($y(T)),p(f),null}const{forceRender:N}=_.useContext(B0);return l.jsx(l.Fragment,{children:v.map(T=>{const w=zc(T),A=a&&!u?!1:f===v||h.includes(w),k=()=>{if(b.has(w))b.set(w,!0);else return;let R=!0;b.forEach(C=>{C||(R=!1)}),R&&(N==null||N(),y(g.current),a&&(d==null||d()),s&&s())};return l.jsx(PU,{isPresent:A,initial:!m.current||n?void 0:!1,custom:e,presenceAffectsLayout:i,mode:r,root:c,onExitComplete:A?void 0:k,anchorX:o,children:T},w)})})},TT=_.createContext({strict:!1}),Ky={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Ga={};for(const t in Ky)Ga[t]={isEnabled:e=>Ky[t].some(n=>!!e[n])};function UU(t){for(const e in t)Ga[e]={...Ga[e],...t[e]}}const HU=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Nd(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||HU.has(t)}let AT=t=>!Nd(t);function GU(t){typeof t=="function"&&(AT=e=>e.startsWith("on")?!Nd(e):t(e))}try{GU(require("@emotion/is-prop-valid").default)}catch{}function VU(t,e,n){const s={};for(const i in t)i==="values"&&typeof t.values=="object"||(AT(i)||n===!0&&Nd(i)||!e&&!Nd(i)||t.draggable&&i.startsWith("onDrag"))&&(s[i]=t[i]);return s}const yf=_.createContext({});function _f(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function Pl(t){return typeof t=="string"||Array.isArray(t)}const lv=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],cv=["initial",...lv];function wf(t){return _f(t.animate)||cv.some(e=>Pl(t[e]))}function RT(t){return!!(wf(t)||t.variants)}function FU(t,e){if(wf(t)){const{initial:n,animate:s}=t;return{initial:n===!1||Pl(n)?n:void 0,animate:Pl(s)?s:void 0}}return t.inherit!==!1?e:{}}function zU(t){const{initial:e,animate:n}=FU(t,_.useContext(yf));return _.useMemo(()=>({initial:e,animate:n}),[Yy(e),Yy(n)])}function Yy(t){return Array.isArray(t)?t.join(" "):t}function qy(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const wo={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(se.test(t))t=parseFloat(t);else return t;const n=qy(t,e.target.x),s=qy(t,e.target.y);return`${n}% ${s}%`}},$U={correct:(t,{treeScale:e,projectionDelta:n})=>{const s=t,i=Mi.parse(t);if(i.length>5)return s;const r=Mi.createTransformer(t),a=typeof i[0]!="number"?1:0,o=n.x.scale*e.x,c=n.y.scale*e.y;i[0+a]/=o,i[1+a]/=c;const u=Qe(o,c,.5);return typeof i[2+a]=="number"&&(i[2+a]/=u),typeof i[3+a]=="number"&&(i[3+a]/=u),r(i)}},kp={borderRadius:{...wo,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:wo,borderTopRightRadius:wo,borderBottomLeftRadius:wo,borderBottomRightRadius:wo,boxShadow:$U};function IT(t,{layout:e,layoutId:n}){return co.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!kp[t]||t==="opacity")}const KU={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},YU=lo.length;function qU(t,e,n){let s="",i=!0;for(let r=0;r<YU;r++){const a=lo[r],o=t[a];if(o===void 0)continue;let c=!0;if(typeof o=="number"?c=o===(a.startsWith("scale")?1:0):c=parseFloat(o)===0,!c||n){const u=yT(o,iv[a]);if(!c){i=!1;const d=KU[a]||a;s+=`${d}(${u}) `}n&&(e[a]=u)}}return s=s.trim(),n?s=n(e,i?"":s):i&&(s="none"),s}function uv(t,e,n){const{style:s,vars:i,transformOrigin:r}=t;let a=!1,o=!1;for(const c in e){const u=e[c];if(co.has(c)){a=!0;continue}else if(QS(c)){i[c]=u;continue}else{const d=yT(u,iv[c]);c.startsWith("origin")?(o=!0,r[c]=d):s[c]=d}}if(e.transform||(a||n?s.transform=qU(e,t.transform,n):s.transform&&(s.transform="none")),o){const{originX:c="50%",originY:u="50%",originZ:d=0}=r;s.transformOrigin=`${c} ${u} ${d}`}}const dv=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function CT(t,e,n){for(const s in e)!Ot(e[s])&&!IT(s,n)&&(t[s]=e[s])}function WU({transformTemplate:t},e){return _.useMemo(()=>{const n=dv();return uv(n,e,t),Object.assign({},n.vars,n.style)},[e])}function XU(t,e){const n=t.style||{},s={};return CT(s,n,t),Object.assign(s,WU(t,e)),s}function QU(t,e){const n={},s=XU(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=s,n}const JU={offset:"stroke-dashoffset",array:"stroke-dasharray"},ZU={offset:"strokeDashoffset",array:"strokeDasharray"};function eH(t,e,n=1,s=0,i=!0){t.pathLength=1;const r=i?JU:ZU;t[r.offset]=se.transform(-s);const a=se.transform(e),o=se.transform(n);t[r.array]=`${a} ${o}`}function jT(t,{attrX:e,attrY:n,attrScale:s,pathLength:i,pathSpacing:r=1,pathOffset:a=0,...o},c,u,d){if(uv(t,o,u),c){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:f,style:h}=t;f.transform&&(h.transform=f.transform,delete f.transform),(h.transform||f.transformOrigin)&&(h.transformOrigin=f.transformOrigin??"50% 50%",delete f.transformOrigin),h.transform&&(h.transformBox=(d==null?void 0:d.transformBox)??"fill-box",delete f.transformBox),e!==void 0&&(f.x=e),n!==void 0&&(f.y=n),s!==void 0&&(f.scale=s),i!==void 0&&eH(f,i,r,a,!1)}const OT=()=>({...dv(),attrs:{}}),MT=t=>typeof t=="string"&&t.toLowerCase()==="svg";function tH(t,e,n,s){const i=_.useMemo(()=>{const r=OT();return jT(r,e,MT(s),t.transformTemplate,t.style),{...r.attrs,style:{...r.style}}},[e]);if(t.style){const r={};CT(r,t.style,t),i.style={...r,...i.style}}return i}const nH=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function fv(t){return typeof t!="string"||t.includes("-")?!1:!!(nH.indexOf(t)>-1||/[A-Z]/u.test(t))}function sH(t,e,n,{latestValues:s},i,r=!1){const o=(fv(t)?tH:QU)(e,s,i,t),c=VU(e,typeof t=="string",r),u=t!==_.Fragment?{...c,...o,ref:n}:{},{children:d}=e,f=_.useMemo(()=>Ot(d)?d.get():d,[d]);return _.createElement(t,{...u,children:f})}function Wy(t){const e=[{},{}];return t==null||t.values.forEach((n,s)=>{e[0][s]=n.get(),e[1][s]=n.getVelocity()}),e}function hv(t,e,n,s){if(typeof e=="function"){const[i,r]=Wy(s);e=e(n!==void 0?n:t.custom,i,r)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[i,r]=Wy(s);e=e(n!==void 0?n:t.custom,i,r)}return e}function gu(t){return Ot(t)?t.get():t}function iH({scrapeMotionValuesFromProps:t,createRenderState:e},n,s,i){return{latestValues:rH(n,s,i,t),renderState:e()}}function rH(t,e,n,s){const i={},r=s(t,{});for(const h in r)i[h]=gu(r[h]);let{initial:a,animate:o}=t;const c=wf(t),u=RT(t);e&&u&&!c&&t.inherit!==!1&&(a===void 0&&(a=e.initial),o===void 0&&(o=e.animate));let d=n?n.initial===!1:!1;d=d||a===!1;const f=d?o:a;if(f&&typeof f!="boolean"&&!_f(f)){const h=Array.isArray(f)?f:[f];for(let m=0;m<h.length;m++){const g=hv(t,h[m]);if(g){const{transitionEnd:b,transition:x,...p}=g;for(const v in p){let y=p[v];if(Array.isArray(y)){const E=d?y.length-1:0;y=y[E]}y!==null&&(i[v]=y)}for(const v in b)i[v]=b[v]}}}return i}const DT=t=>(e,n)=>{const s=_.useContext(yf),i=_.useContext(xf),r=()=>iH(t,e,s,i);return n?r():U0(r)};function mv(t,e,n){var r;const{style:s}=t,i={};for(const a in s)(Ot(s[a])||e.style&&Ot(e.style[a])||IT(a,t)||((r=n==null?void 0:n.getValue(a))==null?void 0:r.liveStyle)!==void 0)&&(i[a]=s[a]);return i}const aH=DT({scrapeMotionValuesFromProps:mv,createRenderState:dv});function LT(t,e,n){const s=mv(t,e,n);for(const i in t)if(Ot(t[i])||Ot(e[i])){const r=lo.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;s[r]=t[i]}return s}const oH=DT({scrapeMotionValuesFromProps:LT,createRenderState:OT}),lH=Symbol.for("motionComponentSymbol");function ta(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function cH(t,e,n){return _.useCallback(s=>{s&&t.onMount&&t.onMount(s),e&&(s?e.mount(s):e.unmount()),n&&(typeof n=="function"?n(s):ta(n)&&(n.current=s))},[e])}const pv=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),uH="framerAppearId",PT="data-"+pv(uH),BT=_.createContext({});function dH(t,e,n,s,i){var b,x;const{visualElement:r}=_.useContext(yf),a=_.useContext(TT),o=_.useContext(xf),c=_.useContext(ov).reducedMotion,u=_.useRef(null);s=s||a.renderer,!u.current&&s&&(u.current=s(t,{visualState:e,parent:r,props:n,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:c}));const d=u.current,f=_.useContext(BT);d&&!d.projection&&i&&(d.type==="html"||d.type==="svg")&&fH(u.current,n,i,f);const h=_.useRef(!1);_.useInsertionEffect(()=>{d&&h.current&&d.update(n,o)});const m=n[PT],g=_.useRef(!!m&&!((b=window.MotionHandoffIsComplete)!=null&&b.call(window,m))&&((x=window.MotionHasOptimisedAnimation)==null?void 0:x.call(window,m)));return MS(()=>{d&&(h.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),d.scheduleRenderMicrotask(),g.current&&d.animationState&&d.animationState.animateChanges())}),_.useEffect(()=>{d&&(!g.current&&d.animationState&&d.animationState.animateChanges(),g.current&&(queueMicrotask(()=>{var p;(p=window.MotionHandoffMarkAsComplete)==null||p.call(window,m)}),g.current=!1),d.enteringChildren=void 0)}),d}function fH(t,e,n,s){const{layoutId:i,layout:r,drag:a,dragConstraints:o,layoutScroll:c,layoutRoot:u,layoutCrossfade:d}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:UT(t.parent)),t.projection.setOptions({layoutId:i,layout:r,alwaysMeasureLayout:!!a||o&&ta(o),visualElement:t,animationType:typeof r=="string"?r:"both",initialPromotionConfig:s,crossfade:d,layoutScroll:c,layoutRoot:u})}function UT(t){if(t)return t.options.allowProjection!==!1?t.projection:UT(t.parent)}function Th(t,{forwardMotionProps:e=!1}={},n,s){n&&UU(n);const i=fv(t)?oH:aH;function r(o,c){let u;const d={..._.useContext(ov),...o,layoutId:hH(o)},{isStatic:f}=d,h=zU(o),m=i(o,f);if(!f&&H0){mH();const g=pH(d);u=g.MeasureLayout,h.visualElement=dH(t,m,d,s,g.ProjectionNode)}return l.jsxs(yf.Provider,{value:h,children:[u&&h.visualElement?l.jsx(u,{visualElement:h.visualElement,...d}):null,sH(t,o,cH(m,h.visualElement,c),m,f,e)]})}r.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const a=_.forwardRef(r);return a[lH]=t,a}function hH({layoutId:t}){const e=_.useContext(B0).id;return e&&t!==void 0?e+"-"+t:t}function mH(t,e){_.useContext(TT).strict}function pH(t){const{drag:e,layout:n}=Ga;if(!e&&!n)return{};const s={...e,...n};return{MeasureLayout:e!=null&&e.isEnabled(t)||n!=null&&n.isEnabled(t)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}function gH(t,e){if(typeof Proxy>"u")return Th;const n=new Map,s=(r,a)=>Th(r,a,t,e),i=(r,a)=>s(r,a);return new Proxy(i,{get:(r,a)=>a==="create"?s:(n.has(a)||n.set(a,Th(a,void 0,t,e)),n.get(a))})}function HT({top:t,left:e,right:n,bottom:s}){return{x:{min:e,max:n},y:{min:t,max:s}}}function vH({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function bH(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),s=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:s.y,right:s.x}}function Ah(t){return t===void 0||t===1}function Sp({scale:t,scaleX:e,scaleY:n}){return!Ah(t)||!Ah(e)||!Ah(n)}function Xi(t){return Sp(t)||GT(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function GT(t){return Xy(t.x)||Xy(t.y)}function Xy(t){return t&&t!=="0%"}function kd(t,e,n){const s=t-n,i=e*s;return n+i}function Qy(t,e,n,s,i){return i!==void 0&&(t=kd(t,i,s)),kd(t,n,s)+e}function Tp(t,e=0,n=1,s,i){t.min=Qy(t.min,e,n,s,i),t.max=Qy(t.max,e,n,s,i)}function VT(t,{x:e,y:n}){Tp(t.x,e.translate,e.scale,e.originPoint),Tp(t.y,n.translate,n.scale,n.originPoint)}const Jy=.999999999999,Zy=1.0000000000001;function xH(t,e,n,s=!1){const i=n.length;if(!i)return;e.x=e.y=1;let r,a;for(let o=0;o<i;o++){r=n[o],a=r.projectionDelta;const{visualElement:c}=r.options;c&&c.props.style&&c.props.style.display==="contents"||(s&&r.options.layoutScroll&&r.scroll&&r!==r.root&&sa(t,{x:-r.scroll.offset.x,y:-r.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,VT(t,a)),s&&Xi(r.latestValues)&&sa(t,r.latestValues))}e.x<Zy&&e.x>Jy&&(e.x=1),e.y<Zy&&e.y>Jy&&(e.y=1)}function na(t,e){t.min=t.min+e,t.max=t.max+e}function e_(t,e,n,s,i=.5){const r=Qe(t.min,t.max,i);Tp(t,e,n,r,s)}function sa(t,e){e_(t.x,e.x,e.scaleX,e.scale,e.originX),e_(t.y,e.y,e.scaleY,e.scale,e.originY)}function FT(t,e){return HT(bH(t.getBoundingClientRect(),e))}function yH(t,e,n){const s=FT(t,n),{scroll:i}=e;return i&&(na(s.x,i.offset.x),na(s.y,i.offset.y)),s}const t_=()=>({translate:0,scale:1,origin:0,originPoint:0}),ia=()=>({x:t_(),y:t_()}),n_=()=>({min:0,max:0}),ft=()=>({x:n_(),y:n_()}),Ap={current:null},zT={current:!1};function _H(){if(zT.current=!0,!!H0)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>Ap.current=t.matches;t.addEventListener("change",e),e()}else Ap.current=!1}const wH=new WeakMap;function EH(t,e,n){for(const s in e){const i=e[s],r=n[s];if(Ot(i))t.addValue(s,i);else if(Ot(r))t.addValue(s,Ha(i,{owner:t}));else if(r!==i)if(t.hasValue(s)){const a=t.getValue(s);a.liveStyle===!0?a.jump(i):a.hasAnimated||a.set(i)}else{const a=t.getStaticValue(s);t.addValue(s,Ha(a!==void 0?a:i,{owner:t}))}}for(const s in n)e[s]===void 0&&t.removeValue(s);return e}const s_=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class NH{scrapeMotionValuesFromProps(e,n,s){return{}}constructor({parent:e,props:n,presenceContext:s,reducedMotionConfig:i,blockInitialAnimation:r,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=nv,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=Qt.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,qe.render(this.render,!1,!0))};const{latestValues:c,renderState:u}=a;this.latestValues=c,this.baseTarget={...c},this.initialValues=n.initial?{...c}:{},this.renderState=u,this.parent=e,this.props=n,this.presenceContext=s,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=o,this.blockInitialAnimation=!!r,this.isControllingVariants=wf(n),this.isVariantNode=RT(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:d,...f}=this.scrapeMotionValuesFromProps(n,{},this);for(const h in f){const m=f[h];c[h]!==void 0&&Ot(m)&&m.set(c[h])}}mount(e){var n;this.current=e,wH.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((s,i)=>this.bindToMotionValue(i,s)),zT.current||_H(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Ap.current,(n=this.parent)==null||n.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),Oi(this.notifyUpdate),Oi(this.render),this.valueSubscriptions.forEach(n=>n()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(e=this.parent)==null||e.removeChild(this);for(const n in this.events)this.events[n].clear();for(const n in this.features){const s=this.features[n];s&&(s.unmount(),s.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const s=co.has(e);s&&this.onBindTransform&&this.onBindTransform();const i=n.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&qe.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let r;window.MotionCheckAppearSync&&(r=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{i(),r&&r(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Ga){const n=Ga[e];if(!n)continue;const{isEnabled:s,Feature:i}=n;if(!this.features[e]&&i&&s(this.props)&&(this.features[e]=new i(this)),this.features[e]){const r=this.features[e];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ft()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let s=0;s<s_.length;s++){const i=s_[s];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const r="on"+i,a=e[r];a&&(this.propEventSubscriptions[i]=this.on(i,a))}this.prevMotionValues=EH(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const s=this.values.get(e);n!==s&&(s&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let s=this.values.get(e);return s===void 0&&n!==void 0&&(s=Ha(n===null?void 0:n,{owner:this}),this.addValue(e,s)),s}readValue(e,n){let s=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return s!=null&&(typeof s=="string"&&(DS(s)||PS(s))?s=parseFloat(s):!jU(s)&&Mi.test(n)&&(s=xT(e,n)),this.setBaseTarget(e,Ot(s)?s.get():s)),Ot(s)?s.get():s}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var r;const{initial:n}=this.props;let s;if(typeof n=="string"||typeof n=="object"){const a=hv(this.props,n,(r=this.presenceContext)==null?void 0:r.custom);a&&(s=a[e])}if(n&&s!==void 0)return s;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!Ot(i)?i:this.initialValues[e]!==void 0&&s===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new $0),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}scheduleRenderMicrotask(){rv.render(this.render)}}class $T extends NH{constructor(){super(...arguments),this.KeyframeResolver=yU}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:s}){delete n[e],delete s[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Ot(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function KT(t,{style:e,vars:n},s,i){const r=t.style;let a;for(a in e)r[a]=e[a];i==null||i.applyProjectionStyles(r,s);for(a in n)r.setProperty(a,n[a])}function kH(t){return window.getComputedStyle(t)}class SH extends $T{constructor(){super(...arguments),this.type="html",this.renderInstance=KT}readValueFromInstance(e,n){var s;if(co.has(n))return(s=this.projection)!=null&&s.isProjecting?bp(n):UB(e,n);{const i=kH(e),r=(QS(n)?i.getPropertyValue(n):i[n])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:n}){return FT(e,n)}build(e,n,s){uv(e,n,s.transformTemplate)}scrapeMotionValuesFromProps(e,n,s){return mv(e,n,s)}}const YT=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function TH(t,e,n,s){KT(t,e,void 0,s);for(const i in e.attrs)t.setAttribute(YT.has(i)?i:pv(i),e.attrs[i])}class AH extends $T{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=ft}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(co.has(n)){const s=bT(n);return s&&s.default||0}return n=YT.has(n)?n:pv(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,s){return LT(e,n,s)}build(e,n,s){jT(e,n,this.isSVGTag,s.transformTemplate,s.style)}renderInstance(e,n,s,i){TH(e,n,s,i)}mount(e){this.isSVGTag=MT(e.tagName),super.mount(e)}}const RH=(t,e)=>fv(t)?new AH(e):new SH(e,{allowProjection:t!==_.Fragment});function ba(t,e,n){const s=t.getProps();return hv(s,e,n!==void 0?n:s.custom,t)}const Rp=t=>Array.isArray(t);function IH(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Ha(n))}function CH(t){return Rp(t)?t[t.length-1]||0:t}function jH(t,e){const n=ba(t,e);let{transitionEnd:s={},transition:i={},...r}=n||{};r={...r,...s};for(const a in r){const o=CH(r[a]);IH(t,a,o)}}function OH(t){return!!(Ot(t)&&t.add)}function Ip(t,e){const n=t.getValue("willChange");if(OH(n))return n.add(e);if(!n&&Ps.WillChange){const s=new Ps.WillChange("auto");t.addValue("willChange",s),s.add(e)}}function qT(t){return t.props[PT]}const MH=t=>t!==null;function DH(t,{repeat:e,repeatType:n="loop"},s){const i=t.filter(MH),r=e&&n!=="loop"&&e%2===1?0:i.length-1;return i[r]}const LH={type:"spring",stiffness:500,damping:25,restSpeed:10},PH=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),BH={type:"keyframes",duration:.8},UH={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},HH=(t,{keyframes:e})=>e.length>2?BH:co.has(t)?t.startsWith("scale")?PH(e[1]):LH:UH;function GH({when:t,delay:e,delayChildren:n,staggerChildren:s,staggerDirection:i,repeat:r,repeatType:a,repeatDelay:o,from:c,elapsed:u,...d}){return!!Object.keys(d).length}const gv=(t,e,n,s={},i,r)=>a=>{const o=sv(s,t)||{},c=o.delay||s.delay||0;let{elapsed:u=0}=s;u=u-ns(c);const d={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...o,delay:-u,onUpdate:h=>{e.set(h),o.onUpdate&&o.onUpdate(h)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:t,motionValue:e,element:r?void 0:i};GH(o)||Object.assign(d,HH(t,d)),d.duration&&(d.duration=ns(d.duration)),d.repeatDelay&&(d.repeatDelay=ns(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let f=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(Ep(d),d.delay===0&&(f=!0)),(Ps.instantAnimations||Ps.skipAnimations)&&(f=!0,Ep(d),d.delay=0),d.allowFlatten=!o.type&&!o.ease,f&&!r&&e.get()!==void 0){const h=DH(d.keyframes,o);if(h!==void 0){qe.update(()=>{d.onUpdate(h),d.onComplete()});return}}return o.isSync?new tv(d):new lU(d)};function VH({protectedKeys:t,needsAnimating:e},n){const s=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,s}function WT(t,e,{delay:n=0,transitionOverride:s,type:i}={}){let{transition:r=t.getDefaultTransition(),transitionEnd:a,...o}=e;s&&(r=s);const c=[],u=i&&t.animationState&&t.animationState.getState()[i];for(const d in o){const f=t.getValue(d,t.latestValues[d]??null),h=o[d];if(h===void 0||u&&VH(u,d))continue;const m={delay:n,...sv(r||{},d)},g=f.get();if(g!==void 0&&!f.isAnimating&&!Array.isArray(h)&&h===g&&!m.velocity)continue;let b=!1;if(window.MotionHandoffAnimation){const p=qT(t);if(p){const v=window.MotionHandoffAnimation(p,d,qe);v!==null&&(m.startTime=v,b=!0)}}Ip(t,d),f.start(gv(d,f,h,t.shouldReduceMotion&&pT.has(d)?{type:!1}:m,t,b));const x=f.animation;x&&c.push(x)}return a&&Promise.all(c).then(()=>{qe.update(()=>{a&&jH(t,a)})}),c}function XT(t,e,n,s=0,i=1){const r=Array.from(t).sort((u,d)=>u.sortNodePosition(d)).indexOf(e),a=t.size,o=(a-1)*s;return typeof n=="function"?n(r,a):i===1?r*s:o-r*s}function Cp(t,e,n={}){var c;const s=ba(t,e,n.type==="exit"?(c=t.presenceContext)==null?void 0:c.custom:void 0);let{transition:i=t.getDefaultTransition()||{}}=s||{};n.transitionOverride&&(i=n.transitionOverride);const r=s?()=>Promise.all(WT(t,s,n)):()=>Promise.resolve(),a=t.variantChildren&&t.variantChildren.size?(u=0)=>{const{delayChildren:d=0,staggerChildren:f,staggerDirection:h}=i;return FH(t,e,u,d,f,h,n)}:()=>Promise.resolve(),{when:o}=i;if(o){const[u,d]=o==="beforeChildren"?[r,a]:[a,r];return u().then(()=>d())}else return Promise.all([r(),a(n.delay)])}function FH(t,e,n=0,s=0,i=0,r=1,a){const o=[];for(const c of t.variantChildren)c.notify("AnimationStart",e),o.push(Cp(c,e,{...a,delay:n+(typeof s=="function"?0:s)+XT(t.variantChildren,c,s,i,r)}).then(()=>c.notify("AnimationComplete",e)));return Promise.all(o)}function zH(t,e,n={}){t.notify("AnimationStart",e);let s;if(Array.isArray(e)){const i=e.map(r=>Cp(t,r,n));s=Promise.all(i)}else if(typeof e=="string")s=Cp(t,e,n);else{const i=typeof e=="function"?ba(t,e,n.custom):e;s=Promise.all(WT(t,i,n))}return s.then(()=>{t.notify("AnimationComplete",e)})}function QT(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let s=0;s<n;s++)if(e[s]!==t[s])return!1;return!0}const $H=cv.length;function JT(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?JT(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<$H;n++){const s=cv[n],i=t.props[s];(Pl(i)||i===!1)&&(e[s]=i)}return e}const KH=[...lv].reverse(),YH=lv.length;function qH(t){return e=>Promise.all(e.map(({animation:n,options:s})=>zH(t,n,s)))}function WH(t){let e=qH(t),n=i_(),s=!0;const i=c=>(u,d)=>{var h;const f=ba(t,d,c==="exit"?(h=t.presenceContext)==null?void 0:h.custom:void 0);if(f){const{transition:m,transitionEnd:g,...b}=f;u={...u,...b,...g}}return u};function r(c){e=c(t)}function a(c){const{props:u}=t,d=JT(t.parent)||{},f=[],h=new Set;let m={},g=1/0;for(let x=0;x<YH;x++){const p=KH[x],v=n[p],y=u[p]!==void 0?u[p]:d[p],E=Pl(y),N=p===c?v.isActive:null;N===!1&&(g=x);let T=y===d[p]&&y!==u[p]&&E;if(T&&s&&t.manuallyAnimateOnMount&&(T=!1),v.protectedKeys={...m},!v.isActive&&N===null||!y&&!v.prevProp||_f(y)||typeof y=="boolean")continue;const w=XH(v.prevProp,y);let A=w||p===c&&v.isActive&&!T&&E||x>g&&E,k=!1;const R=Array.isArray(y)?y:[y];let C=R.reduce(i(p),{});N===!1&&(C={});const{prevResolvedValues:B={}}=v,z={...B,...C},$=O=>{A=!0,h.has(O)&&(k=!0,h.delete(O)),v.needsAnimating[O]=!0;const j=t.getValue(O);j&&(j.liveStyle=!1)};for(const O in z){const j=C[O],I=B[O];if(m.hasOwnProperty(O))continue;let H=!1;Rp(j)&&Rp(I)?H=!QT(j,I):H=j!==I,H?j!=null?$(O):h.add(O):j!==void 0&&h.has(O)?$(O):v.protectedKeys[O]=!0}v.prevProp=y,v.prevResolvedValues=C,v.isActive&&(m={...m,...C}),s&&t.blockInitialAnimation&&(A=!1);const K=T&&w;A&&(!K||k)&&f.push(...R.map(O=>{const j={type:p};if(typeof O=="string"&&s&&!K&&t.manuallyAnimateOnMount&&t.parent){const{parent:I}=t,H=ba(I,O);if(I.enteringChildren&&H){const{delayChildren:X}=H.transition||{};j.delay=XT(I.enteringChildren,t,X)}}return{animation:O,options:j}}))}if(h.size){const x={};if(typeof u.initial!="boolean"){const p=ba(t,Array.isArray(u.initial)?u.initial[0]:u.initial);p&&p.transition&&(x.transition=p.transition)}h.forEach(p=>{const v=t.getBaseTarget(p),y=t.getValue(p);y&&(y.liveStyle=!0),x[p]=v??null}),f.push({animation:x})}let b=!!f.length;return s&&(u.initial===!1||u.initial===u.animate)&&!t.manuallyAnimateOnMount&&(b=!1),s=!1,b?e(f):Promise.resolve()}function o(c,u){var f;if(n[c].isActive===u)return Promise.resolve();(f=t.variantChildren)==null||f.forEach(h=>{var m;return(m=h.animationState)==null?void 0:m.setActive(c,u)}),n[c].isActive=u;const d=a(c);for(const h in n)n[h].protectedKeys={};return d}return{animateChanges:a,setActive:o,setAnimateFunction:r,getState:()=>n,reset:()=>{n=i_()}}}function XH(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!QT(e,t):!1}function Fi(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function i_(){return{animate:Fi(!0),whileInView:Fi(),whileHover:Fi(),whileTap:Fi(),whileDrag:Fi(),whileFocus:Fi(),exit:Fi()}}class Ui{constructor(e){this.isMounted=!1,this.node=e}update(){}}class QH extends Ui{constructor(e){super(e),e.animationState||(e.animationState=WH(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();_f(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let JH=0;class ZH extends Ui{constructor(){super(...arguments),this.id=JH++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===s)return;const i=this.node.animationState.setActive("exit",!e);n&&!e&&i.then(()=>{n(this.id)})}mount(){const{register:e,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const e8={animation:{Feature:QH},exit:{Feature:ZH}};function Bl(t,e,n,s={passive:!0}){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n)}function gc(t){return{point:{x:t.pageX,y:t.pageY}}}const t8=t=>e=>av(e)&&t(e,gc(e));function tl(t,e,n,s){return Bl(t,e,t8(n),s)}const ZT=1e-4,n8=1-ZT,s8=1+ZT,eA=.01,i8=0-eA,r8=0+eA;function Ut(t){return t.max-t.min}function a8(t,e,n){return Math.abs(t-e)<=n}function r_(t,e,n,s=.5){t.origin=s,t.originPoint=Qe(e.min,e.max,t.origin),t.scale=Ut(n)/Ut(e),t.translate=Qe(n.min,n.max,t.origin)-t.originPoint,(t.scale>=n8&&t.scale<=s8||isNaN(t.scale))&&(t.scale=1),(t.translate>=i8&&t.translate<=r8||isNaN(t.translate))&&(t.translate=0)}function nl(t,e,n,s){r_(t.x,e.x,n.x,s?s.originX:void 0),r_(t.y,e.y,n.y,s?s.originY:void 0)}function a_(t,e,n){t.min=n.min+e.min,t.max=t.min+Ut(e)}function o8(t,e,n){a_(t.x,e.x,n.x),a_(t.y,e.y,n.y)}function o_(t,e,n){t.min=e.min-n.min,t.max=t.min+Ut(e)}function Sd(t,e,n){o_(t.x,e.x,n.x),o_(t.y,e.y,n.y)}function gn(t){return[t("x"),t("y")]}const tA=({current:t})=>t?t.ownerDocument.defaultView:null,l_=(t,e)=>Math.abs(t-e);function l8(t,e){const n=l_(t.x,e.x),s=l_(t.y,e.y);return Math.sqrt(n**2+s**2)}class nA{constructor(e,n,{transformPagePoint:s,contextWindow:i=window,dragSnapToOrigin:r=!1,distanceThreshold:a=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=Ih(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,g=l8(h.offset,{x:0,y:0})>=this.distanceThreshold;if(!m&&!g)return;const{point:b}=h,{timestamp:x}=kt;this.history.push({...b,timestamp:x});const{onStart:p,onMove:v}=this.handlers;m||(p&&p(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),v&&v(this.lastMoveEvent,h)},this.handlePointerMove=(h,m)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=Rh(m,this.transformPagePoint),qe.update(this.updatePoint,!0)},this.handlePointerUp=(h,m)=>{this.end();const{onEnd:g,onSessionEnd:b,resumeAnimation:x}=this.handlers;if(this.dragSnapToOrigin&&x&&x(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const p=Ih(h.type==="pointercancel"?this.lastMoveEventInfo:Rh(m,this.transformPagePoint),this.history);this.startEvent&&g&&g(h,p),b&&b(h,p)},!av(e))return;this.dragSnapToOrigin=r,this.handlers=n,this.transformPagePoint=s,this.distanceThreshold=a,this.contextWindow=i||window;const o=gc(e),c=Rh(o,this.transformPagePoint),{point:u}=c,{timestamp:d}=kt;this.history=[{...u,timestamp:d}];const{onSessionStart:f}=n;f&&f(e,Ih(c,this.history)),this.removeListeners=hc(tl(this.contextWindow,"pointermove",this.handlePointerMove),tl(this.contextWindow,"pointerup",this.handlePointerUp),tl(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Oi(this.updatePoint)}}function Rh(t,e){return e?{point:e(t.point)}:t}function c_(t,e){return{x:t.x-e.x,y:t.y-e.y}}function Ih({point:t},e){return{point:t,delta:c_(t,sA(e)),offset:c_(t,c8(e)),velocity:u8(e,.1)}}function c8(t){return t[0]}function sA(t){return t[t.length-1]}function u8(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,s=null;const i=sA(t);for(;n>=0&&(s=t[n],!(i.timestamp-s.timestamp>ns(e)));)n--;if(!s)return{x:0,y:0};const r=kn(i.timestamp-s.timestamp);if(r===0)return{x:0,y:0};const a={x:(i.x-s.x)/r,y:(i.y-s.y)/r};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function d8(t,{min:e,max:n},s){return e!==void 0&&t<e?t=s?Qe(e,t,s.min):Math.max(t,e):n!==void 0&&t>n&&(t=s?Qe(n,t,s.max):Math.min(t,n)),t}function u_(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function f8(t,{top:e,left:n,bottom:s,right:i}){return{x:u_(t.x,n,i),y:u_(t.y,e,s)}}function d_(t,e){let n=e.min-t.min,s=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,s]=[s,n]),{min:n,max:s}}function h8(t,e){return{x:d_(t.x,e.x),y:d_(t.y,e.y)}}function m8(t,e){let n=.5;const s=Ut(t),i=Ut(e);return i>s?n=Ml(e.min,e.max-s,t.min):s>i&&(n=Ml(t.min,t.max-i,e.min)),Ls(0,1,n)}function p8(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const jp=.35;function g8(t=jp){return t===!1?t=0:t===!0&&(t=jp),{x:f_(t,"left","right"),y:f_(t,"top","bottom")}}function f_(t,e,n){return{min:h_(t,e),max:h_(t,n)}}function h_(t,e){return typeof t=="number"?t:t[e]||0}const v8=new WeakMap;class b8{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ft(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:n=!1,distanceThreshold:s}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const r=f=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(gc(f).point)},a=(f,h)=>{const{drag:m,dragPropagation:g,onDragStart:b}=this.getProps();if(m&&!g&&(this.openDragLock&&this.openDragLock(),this.openDragLock=NU(m),!this.openDragLock))return;this.latestPointerEvent=f,this.latestPanInfo=h,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),gn(p=>{let v=this.getAxisMotionValue(p).get()||0;if(ss.test(v)){const{projection:y}=this.visualElement;if(y&&y.layout){const E=y.layout.layoutBox[p];E&&(v=Ut(E)*(parseFloat(v)/100))}}this.originPoint[p]=v}),b&&qe.postRender(()=>b(f,h)),Ip(this.visualElement,"transform");const{animationState:x}=this.visualElement;x&&x.setActive("whileDrag",!0)},o=(f,h)=>{this.latestPointerEvent=f,this.latestPanInfo=h;const{dragPropagation:m,dragDirectionLock:g,onDirectionLock:b,onDrag:x}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:p}=h;if(g&&this.currentDirection===null){this.currentDirection=x8(p),this.currentDirection!==null&&b&&b(this.currentDirection);return}this.updateAxis("x",h.point,p),this.updateAxis("y",h.point,p),this.visualElement.render(),x&&x(f,h)},c=(f,h)=>{this.latestPointerEvent=f,this.latestPanInfo=h,this.stop(f,h),this.latestPointerEvent=null,this.latestPanInfo=null},u=()=>gn(f=>{var h;return this.getAnimationState(f)==="paused"&&((h=this.getAxisMotionValue(f).animation)==null?void 0:h.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new nA(e,{onSessionStart:r,onStart:a,onMove:o,onSessionEnd:c,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,distanceThreshold:s,contextWindow:tA(this.visualElement)})}stop(e,n){const s=e||this.latestPointerEvent,i=n||this.latestPanInfo,r=this.isDragging;if(this.cancel(),!r||!i||!s)return;const{velocity:a}=i;this.startAnimation(a);const{onDragEnd:o}=this.getProps();o&&qe.postRender(()=>o(s,i))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,s){const{drag:i}=this.getProps();if(!s||!$c(e,i,this.currentDirection))return;const r=this.getAxisMotionValue(e);let a=this.originPoint[e]+s[e];this.constraints&&this.constraints[e]&&(a=d8(a,this.constraints[e],this.elastic[e])),r.set(a)}resolveConstraints(){var r;const{dragConstraints:e,dragElastic:n}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(r=this.visualElement.projection)==null?void 0:r.layout,i=this.constraints;e&&ta(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&s?this.constraints=f8(s.layoutBox,e):this.constraints=!1,this.elastic=g8(n),i!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&gn(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=p8(s.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!ta(e))return!1;const s=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const r=yH(s,i.root,this.visualElement.getTransformPagePoint());let a=h8(i.layout.layoutBox,r);if(n){const o=n(vH(a));this.hasMutatedConstraints=!!o,o&&(a=HT(o))}return a}startAnimation(e){const{drag:n,dragMomentum:s,dragElastic:i,dragTransition:r,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),c=this.constraints||{},u=gn(d=>{if(!$c(d,n,this.currentDirection))return;let f=c&&c[d]||{};a&&(f={min:0,max:0});const h=i?200:1e6,m=i?40:1e7,g={type:"inertia",velocity:s?e[d]:0,bounceStiffness:h,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...r,...f};return this.startAxisValueAnimation(d,g)});return Promise.all(u).then(o)}startAxisValueAnimation(e,n){const s=this.getAxisMotionValue(e);return Ip(this.visualElement,e),s.start(gv(e,s,0,n,this.visualElement,!1))}stopAnimation(){gn(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){gn(e=>{var n;return(n=this.getAxisMotionValue(e).animation)==null?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)==null?void 0:n.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,s=this.visualElement.getProps(),i=s[n];return i||this.visualElement.getValue(e,(s.initial?s.initial[e]:void 0)||0)}snapToCursor(e){gn(n=>{const{drag:s}=this.getProps();if(!$c(n,s,this.currentDirection))return;const{projection:i}=this.visualElement,r=this.getAxisMotionValue(n);if(i&&i.layout){const{min:a,max:o}=i.layout.layoutBox[n];r.set(e[n]-Qe(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:s}=this.visualElement;if(!ta(n)||!s||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};gn(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const c=o.get();i[a]=m8({min:c,max:c},this.constraints[a])}});const{transformTemplate:r}=this.visualElement.getProps();this.visualElement.current.style.transform=r?r({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),gn(a=>{if(!$c(a,e,null))return;const o=this.getAxisMotionValue(a),{min:c,max:u}=this.constraints[a];o.set(Qe(c,u,i[a]))})}addListeners(){if(!this.visualElement.current)return;v8.set(this.visualElement,this);const e=this.visualElement.current,n=tl(e,"pointerdown",c=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(c)}),s=()=>{const{dragConstraints:c}=this.getProps();ta(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,r=i.addEventListener("measure",s);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),qe.read(s);const a=Bl(window,"resize",()=>this.scalePositionWithinConstraints()),o=i.addEventListener("didUpdate",({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&(gn(d=>{const f=this.getAxisMotionValue(d);f&&(this.originPoint[d]+=c[d].translate,f.set(f.get()+c[d].translate))}),this.visualElement.render())});return()=>{a(),n(),r(),o&&o()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:s=!1,dragPropagation:i=!1,dragConstraints:r=!1,dragElastic:a=jp,dragMomentum:o=!0}=e;return{...e,drag:n,dragDirectionLock:s,dragPropagation:i,dragConstraints:r,dragElastic:a,dragMomentum:o}}}function $c(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function x8(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class y8 extends Ui{constructor(e){super(e),this.removeGroupControls=In,this.removeListeners=In,this.controls=new b8(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||In}unmount(){this.removeGroupControls(),this.removeListeners()}}const m_=t=>(e,n)=>{t&&qe.postRender(()=>t(e,n))};class _8 extends Ui{constructor(){super(...arguments),this.removePointerDownListener=In}onPointerDown(e){this.session=new nA(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:tA(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:s,onPanEnd:i}=this.node.getProps();return{onSessionStart:m_(e),onStart:m_(n),onMove:s,onEnd:(r,a)=>{delete this.session,i&&qe.postRender(()=>i(r,a))}}}mount(){this.removePointerDownListener=tl(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const vu={hasAnimatedSinceResize:!0,hasEverUpdated:!1};let Ch=!1;class w8 extends _.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:s,layoutId:i}=this.props,{projection:r}=e;r&&(n.group&&n.group.add(r),s&&s.register&&i&&s.register(r),Ch&&r.root.didUpdate(),r.addEventListener("animationComplete",()=>{this.safeToRemove()}),r.setOptions({...r.options,onExitComplete:()=>this.safeToRemove()})),vu.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:s,drag:i,isPresent:r}=this.props,{projection:a}=s;return a&&(a.isPresent=r,Ch=!0,i||e.layoutDependency!==n||n===void 0||e.isPresent!==r?a.willUpdate():this.safeToRemove(),e.isPresent!==r&&(r?a.promote():a.relegate()||qe.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),rv.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:s}=this.props,{projection:i}=e;Ch=!0,i&&(i.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(i),s&&s.deregister&&s.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function iA(t){const[e,n]=ST(),s=_.useContext(B0);return l.jsx(w8,{...t,layoutGroup:s,switchLayoutGroup:_.useContext(BT),isPresent:e,safeToRemove:n})}function E8(t,e,n){const s=Ot(t)?t:Ha(t);return s.start(gv("",s,e,n)),s.animation}const N8=(t,e)=>t.depth-e.depth;class k8{constructor(){this.children=[],this.isDirty=!1}add(e){G0(this.children,e),this.isDirty=!0}remove(e){V0(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(N8),this.isDirty=!1,this.children.forEach(e)}}function S8(t,e){const n=Qt.now(),s=({timestamp:i})=>{const r=i-n;r>=e&&(Oi(s),t(r-e))};return qe.setup(s,!0),()=>Oi(s)}const rA=["TopLeft","TopRight","BottomLeft","BottomRight"],T8=rA.length,p_=t=>typeof t=="string"?parseFloat(t):t,g_=t=>typeof t=="number"||se.test(t);function A8(t,e,n,s,i,r){i?(t.opacity=Qe(0,n.opacity??1,R8(s)),t.opacityExit=Qe(e.opacity??1,0,I8(s))):r&&(t.opacity=Qe(e.opacity??1,n.opacity??1,s));for(let a=0;a<T8;a++){const o=`border${rA[a]}Radius`;let c=v_(e,o),u=v_(n,o);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||g_(c)===g_(u)?(t[o]=Math.max(Qe(p_(c),p_(u),s),0),(ss.test(u)||ss.test(c))&&(t[o]+="%")):t[o]=u}(e.rotate||n.rotate)&&(t.rotate=Qe(e.rotate||0,n.rotate||0,s))}function v_(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const R8=aA(0,.5,$S),I8=aA(.5,.95,In);function aA(t,e,n){return s=>s<t?0:s>e?1:n(Ml(t,e,s))}function b_(t,e){t.min=e.min,t.max=e.max}function Dn(t,e){b_(t.x,e.x),b_(t.y,e.y)}function x_(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function y_(t,e,n,s,i){return t-=e,t=kd(t,1/n,s),i!==void 0&&(t=kd(t,1/i,s)),t}function C8(t,e=0,n=1,s=.5,i,r=t,a=t){if(ss.test(e)&&(e=parseFloat(e),e=Qe(a.min,a.max,e/100)-a.min),typeof e!="number")return;let o=Qe(r.min,r.max,s);t===r&&(o-=e),t.min=y_(t.min,e,n,o,i),t.max=y_(t.max,e,n,o,i)}function __(t,e,[n,s,i],r,a){C8(t,e[n],e[s],e[i],e.scale,r,a)}const j8=["x","scaleX","originX"],O8=["y","scaleY","originY"];function w_(t,e,n,s){__(t.x,e,j8,n?n.x:void 0,s?s.x:void 0),__(t.y,e,O8,n?n.y:void 0,s?s.y:void 0)}function E_(t){return t.translate===0&&t.scale===1}function oA(t){return E_(t.x)&&E_(t.y)}function N_(t,e){return t.min===e.min&&t.max===e.max}function M8(t,e){return N_(t.x,e.x)&&N_(t.y,e.y)}function k_(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function lA(t,e){return k_(t.x,e.x)&&k_(t.y,e.y)}function S_(t){return Ut(t.x)/Ut(t.y)}function T_(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class D8{constructor(){this.members=[]}add(e){G0(this.members,e),e.scheduleRender()}remove(e){if(V0(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(i=>e===i);if(n===0)return!1;let s;for(let i=n;i>=0;i--){const r=this.members[i];if(r.isPresent!==!1){s=r;break}}return s?(this.promote(s),!0):!1}promote(e,n){const s=this.lead;if(e!==s&&(this.prevLead=s,this.lead=e,e.show(),s)){s.instance&&s.scheduleRender(),e.scheduleRender(),e.resumeFrom=s,n&&(e.resumeFrom.preserveOpacity=!0),s.snapshot&&(e.snapshot=s.snapshot,e.snapshot.latestValues=s.animationValues||s.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:s}=e;n.onExitComplete&&n.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function L8(t,e,n){let s="";const i=t.x.translate/e.x,r=t.y.translate/e.y,a=(n==null?void 0:n.z)||0;if((i||r||a)&&(s=`translate3d(${i}px, ${r}px, ${a}px) `),(e.x!==1||e.y!==1)&&(s+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:u,rotate:d,rotateX:f,rotateY:h,skewX:m,skewY:g}=n;u&&(s=`perspective(${u}px) ${s}`),d&&(s+=`rotate(${d}deg) `),f&&(s+=`rotateX(${f}deg) `),h&&(s+=`rotateY(${h}deg) `),m&&(s+=`skewX(${m}deg) `),g&&(s+=`skewY(${g}deg) `)}const o=t.x.scale*e.x,c=t.y.scale*e.y;return(o!==1||c!==1)&&(s+=`scale(${o}, ${c})`),s||"none"}const jh=["","X","Y","Z"],P8=1e3;let B8=0;function Oh(t,e,n,s){const{latestValues:i}=e;i[t]&&(n[t]=i[t],e.setStaticValue(t,0),s&&(s[t]=0))}function cA(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=qT(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:i,layoutId:r}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",qe,!(i||r))}const{parent:s}=t;s&&!s.hasCheckedOptimisedAppear&&cA(s)}function uA({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:s,resetTransform:i}){return class{constructor(a={},o=e==null?void 0:e()){this.id=B8++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(G8),this.nodes.forEach($8),this.nodes.forEach(K8),this.nodes.forEach(V8)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new k8)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new $0),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const c=this.eventHandlers.get(a);c&&c.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a){if(this.instance)return;this.isSVG=kT(a)&&!IU(a),this.instance=a;const{layoutId:o,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||o)&&(this.isLayoutDirty=!0),t){let d,f=0;const h=()=>this.root.updateBlockedByResize=!1;qe.read(()=>{f=window.innerWidth}),t(a,()=>{const m=window.innerWidth;m!==f&&(f=m,this.root.updateBlockedByResize=!0,d&&d(),d=S8(h,250),vu.hasAnimatedSinceResize&&(vu.hasAnimatedSinceResize=!1,this.nodes.forEach(I_)))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&u&&(o||c)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:f,hasRelativeLayoutChanged:h,layout:m})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const g=this.options.transition||u.getDefaultTransition()||Q8,{onLayoutAnimationStart:b,onLayoutAnimationComplete:x}=u.getProps(),p=!this.targetLayout||!lA(this.targetLayout,m),v=!f&&h;if(this.options.layoutRoot||this.resumeFrom||v||f&&(p||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const y={...sv(g,"layout"),onPlay:b,onComplete:x};(u.shouldReduceMotion||this.options.layoutRoot)&&(y.delay=0,y.type=!1),this.startAnimation(y),this.setAnimationOrigin(d,v)}else f||I_(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=m})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Oi(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Y8),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&cA(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const f=this.path[d];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:o,layout:c}=this.options;if(o===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(A_);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(R_);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(z8),this.nodes.forEach(U8),this.nodes.forEach(H8)):this.nodes.forEach(R_),this.clearAllSnapshots();const o=Qt.now();kt.delta=Ls(0,1e3/60,o-kt.timestamp),kt.timestamp=o,kt.isProcessing=!0,_h.update.process(kt),_h.preRender.process(kt),_h.render.process(kt),kt.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,rv.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(F8),this.sharedNodes.forEach(q8)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,qe.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){qe.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Ut(this.snapshot.measuredBox.x)&&!Ut(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=ft(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o&&this.instance){const c=s(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:c,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!i)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!oA(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;a&&this.instance&&(o||Xi(this.latestValues)||d)&&(i(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let c=this.removeElementScroll(o);return a&&(c=this.removeTransform(c)),J8(c),{animationId:this.root.animationId,measuredBox:o,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var u;const{visualElement:a}=this.options;if(!a)return ft();const o=a.measureViewportBox();if(!(((u=this.scroll)==null?void 0:u.wasRoot)||this.path.some(Z8))){const{scroll:d}=this.root;d&&(na(o.x,d.offset.x),na(o.y,d.offset.y))}return o}removeElementScroll(a){var c;const o=ft();if(Dn(o,a),(c=this.scroll)!=null&&c.wasRoot)return o;for(let u=0;u<this.path.length;u++){const d=this.path[u],{scroll:f,options:h}=d;d!==this.root&&f&&h.layoutScroll&&(f.wasRoot&&Dn(o,a),na(o.x,f.offset.x),na(o.y,f.offset.y))}return o}applyTransform(a,o=!1){const c=ft();Dn(c,a);for(let u=0;u<this.path.length;u++){const d=this.path[u];!o&&d.options.layoutScroll&&d.scroll&&d!==d.root&&sa(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),Xi(d.latestValues)&&sa(c,d.latestValues)}return Xi(this.latestValues)&&sa(c,this.latestValues),c}removeTransform(a){const o=ft();Dn(o,a);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!Xi(u.latestValues))continue;Sp(u.latestValues)&&u.updateSnapshot();const d=ft(),f=u.measurePageBox();Dn(d,f),w_(o,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return Xi(this.latestValues)&&w_(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==kt.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var m;const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==o;if(!(a||c&&this.isSharedProjectionDirty||this.isProjectionDirty||(m=this.parent)!=null&&m.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:f}=this.options;if(!this.layout||!(d||f))return;this.resolvedRelativeTargetAt=kt.timestamp;const h=this.getClosestProjectingParent();h&&this.linkedParentVersion!==h.layoutVersion&&!h.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(h&&h.layout?this.createRelativeTarget(h,this.layout.layoutBox,h.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=ft(),this.targetWithTransforms=ft()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),o8(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Dn(this.target,this.layout.layoutBox),VT(this.target,this.targetDelta)):Dn(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,h&&!!h.resumingFrom==!!this.resumingFrom&&!h.options.layoutScroll&&h.target&&this.animationProgress!==1?this.createRelativeTarget(h,this.target,h.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||Sp(this.parent.latestValues)||GT(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(a,o,c){this.relativeParent=a,this.linkedParentVersion=a.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ft(),this.relativeTargetOrigin=ft(),Sd(this.relativeTargetOrigin,o,c),Dn(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){var g;const a=this.getLead(),o=!!this.resumingFrom||this!==a;let c=!0;if((this.isProjectionDirty||(g=this.parent)!=null&&g.isProjectionDirty)&&(c=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===kt.timestamp&&(c=!1),c)return;const{layout:u,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||d))return;Dn(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,h=this.treeScale.y;xH(this.layoutCorrected,this.treeScale,this.path,o),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=ft());const{target:m}=a;if(!m){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(x_(this.prevProjectionDelta.x,this.projectionDelta.x),x_(this.prevProjectionDelta.y,this.projectionDelta.y)),nl(this.projectionDelta,this.layoutCorrected,m,this.latestValues),(this.treeScale.x!==f||this.treeScale.y!==h||!T_(this.projectionDelta.x,this.prevProjectionDelta.x)||!T_(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",m))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var o;if((o=this.options.visualElement)==null||o.scheduleRender(),a){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=ia(),this.projectionDelta=ia(),this.projectionDeltaWithTransform=ia()}setAnimationOrigin(a,o=!1){const c=this.snapshot,u=c?c.latestValues:{},d={...this.latestValues},f=ia();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const h=ft(),m=c?c.source:void 0,g=this.layout?this.layout.source:void 0,b=m!==g,x=this.getStack(),p=!x||x.members.length<=1,v=!!(b&&!p&&this.options.crossfade===!0&&!this.path.some(X8));this.animationProgress=0;let y;this.mixTargetDelta=E=>{const N=E/1e3;C_(f.x,a.x,N),C_(f.y,a.y,N),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Sd(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),W8(this.relativeTarget,this.relativeTargetOrigin,h,N),y&&M8(this.relativeTarget,y)&&(this.isProjectionDirty=!1),y||(y=ft()),Dn(y,this.relativeTarget)),b&&(this.animationValues=d,A8(d,u,this.latestValues,N,v,p)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=N},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){var o,c,u;this.notifyListeners("animationStart"),(o=this.currentAnimation)==null||o.stop(),(u=(c=this.resumingFrom)==null?void 0:c.currentAnimation)==null||u.stop(),this.pendingAnimation&&(Oi(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=qe.update(()=>{vu.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Ha(0)),this.currentAnimation=E8(this.motionValue,[0,1e3],{...a,velocity:0,isSync:!0,onUpdate:d=>{this.mixTargetDelta(d),a.onUpdate&&a.onUpdate(d)},onStop:()=>{},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(P8),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:c,layout:u,latestValues:d}=a;if(!(!o||!c||!u)){if(this!==a&&this.layout&&u&&dA(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||ft();const f=Ut(this.layout.layoutBox.x);c.x.min=a.target.x.min,c.x.max=c.x.min+f;const h=Ut(this.layout.layoutBox.y);c.y.min=a.target.y.min,c.y.max=c.y.min+h}Dn(o,c),sa(o,d),nl(this.projectionDeltaWithTransform,this.layoutCorrected,o,d)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new D8),this.sharedNodes.get(a).add(o);const u=o.options.initialPromotionConfig;o.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())==null?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())==null?void 0:o.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:c}=a;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(o=!0),!o)return;const u={};c.z&&Oh("z",a,u,this.animationValues);for(let d=0;d<jh.length;d++)Oh(`rotate${jh[d]}`,a,u,this.animationValues),Oh(`skew${jh[d]}`,a,u,this.animationValues);a.render();for(const d in u)a.setStaticValue(d,u[d]),this.animationValues&&(this.animationValues[d]=u[d]);a.scheduleRender()}applyProjectionStyles(a,o){if(!this.instance||this.isSVG)return;if(!this.isVisible){a.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,a.visibility="",a.opacity="",a.pointerEvents=gu(o==null?void 0:o.pointerEvents)||"",a.transform=c?c(this.latestValues,""):"none";return}const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){this.options.layoutId&&(a.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,a.pointerEvents=gu(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!Xi(this.latestValues)&&(a.transform=c?c({},""):"none",this.hasProjected=!1);return}a.visibility="";const d=u.animationValues||u.latestValues;this.applyTransformsToTarget();let f=L8(this.projectionDeltaWithTransform,this.treeScale,d);c&&(f=c(d,f)),a.transform=f;const{x:h,y:m}=this.projectionDelta;a.transformOrigin=`${h.origin*100}% ${m.origin*100}% 0`,u.animationValues?a.opacity=u===this?d.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:a.opacity=u===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const g in kp){if(d[g]===void 0)continue;const{correct:b,applyTo:x,isCSSVariable:p}=kp[g],v=f==="none"?d[g]:b(d[g],u);if(x){const y=x.length;for(let E=0;E<y;E++)a[x[E]]=v}else p?this.options.visualElement.renderState.vars[g]=v:a[g]=v}this.options.layoutId&&(a.pointerEvents=u===this?gu(o==null?void 0:o.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)==null?void 0:o.stop()}),this.root.nodes.forEach(A_),this.root.sharedNodes.clear()}}}function U8(t){t.updateLayout()}function H8(t){var n;const e=((n=t.resumeFrom)==null?void 0:n.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:i}=t.layout,{animationType:r}=t.options,a=e.source!==t.layout.source;r==="size"?gn(f=>{const h=a?e.measuredBox[f]:e.layoutBox[f],m=Ut(h);h.min=s[f].min,h.max=h.min+m}):dA(r,e.layoutBox,s)&&gn(f=>{const h=a?e.measuredBox[f]:e.layoutBox[f],m=Ut(s[f]);h.max=h.min+m,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[f].max=t.relativeTarget[f].min+m)});const o=ia();nl(o,s,e.layoutBox);const c=ia();a?nl(c,t.applyTransform(i,!0),e.measuredBox):nl(c,s,e.layoutBox);const u=!oA(o);let d=!1;if(!t.resumeFrom){const f=t.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:h,layout:m}=f;if(h&&m){const g=ft();Sd(g,e.layoutBox,h.layoutBox);const b=ft();Sd(b,s,m.layoutBox),lA(g,b)||(d=!0),f.options.layoutRoot&&(t.relativeTarget=b,t.relativeTargetOrigin=g,t.relativeParent=f)}}}t.notifyListeners("didUpdate",{layout:s,snapshot:e,delta:c,layoutDelta:o,hasLayoutChanged:u,hasRelativeLayoutChanged:d})}else if(t.isLead()){const{onExitComplete:s}=t.options;s&&s()}t.options.transition=void 0}function G8(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function V8(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function F8(t){t.clearSnapshot()}function A_(t){t.clearMeasurements()}function R_(t){t.isLayoutDirty=!1}function z8(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function I_(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function $8(t){t.resolveTargetDelta()}function K8(t){t.calcProjection()}function Y8(t){t.resetSkewAndRotation()}function q8(t){t.removeLeadSnapshot()}function C_(t,e,n){t.translate=Qe(e.translate,0,n),t.scale=Qe(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function j_(t,e,n,s){t.min=Qe(e.min,n.min,s),t.max=Qe(e.max,n.max,s)}function W8(t,e,n,s){j_(t.x,e.x,n.x,s),j_(t.y,e.y,n.y,s)}function X8(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const Q8={duration:.45,ease:[.4,0,.1,1]},O_=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),M_=O_("applewebkit/")&&!O_("chrome/")?Math.round:In;function D_(t){t.min=M_(t.min),t.max=M_(t.max)}function J8(t){D_(t.x),D_(t.y)}function dA(t,e,n){return t==="position"||t==="preserve-aspect"&&!a8(S_(e),S_(n),.2)}function Z8(t){var e;return t!==t.root&&((e=t.scroll)==null?void 0:e.wasRoot)}const eG=uA({attachResizeListener:(t,e)=>Bl(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Mh={current:void 0},fA=uA({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!Mh.current){const t=new eG({});t.mount(window),t.setOptions({layoutScroll:!0}),Mh.current=t}return Mh.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),tG={pan:{Feature:_8},drag:{Feature:y8,ProjectionNode:fA,MeasureLayout:iA}};function L_(t,e,n){const{props:s}=t;t.animationState&&s.whileHover&&t.animationState.setActive("whileHover",n==="Start");const i="onHover"+n,r=s[i];r&&qe.postRender(()=>r(e,gc(e)))}class nG extends Ui{mount(){const{current:e}=this.node;e&&(this.unmount=kU(e,(n,s)=>(L_(this.node,s,"Start"),i=>L_(this.node,i,"End"))))}unmount(){}}class sG extends Ui{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=hc(Bl(this.node.current,"focus",()=>this.onFocus()),Bl(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function P_(t,e,n){const{props:s}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&s.whileTap&&t.animationState.setActive("whileTap",n==="Start");const i="onTap"+(n==="End"?"":n),r=s[i];r&&qe.postRender(()=>r(e,gc(e)))}class iG extends Ui{mount(){const{current:e}=this.node;e&&(this.unmount=RU(e,(n,s)=>(P_(this.node,s,"Start"),(i,{success:r})=>P_(this.node,i,r?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Op=new WeakMap,Dh=new WeakMap,rG=t=>{const e=Op.get(t.target);e&&e(t)},aG=t=>{t.forEach(rG)};function oG({root:t,...e}){const n=t||document;Dh.has(n)||Dh.set(n,{});const s=Dh.get(n),i=JSON.stringify(e);return s[i]||(s[i]=new IntersectionObserver(aG,{root:t,...e})),s[i]}function lG(t,e,n){const s=oG(e);return Op.set(t,n),s.observe(t),()=>{Op.delete(t),s.unobserve(t)}}const cG={some:0,all:1};class uG extends Ui{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:s,amount:i="some",once:r}=e,a={root:n?n.current:void 0,rootMargin:s,threshold:typeof i=="number"?i:cG[i]},o=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,r&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:f}=this.node.getProps(),h=u?d:f;h&&h(c)};return lG(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(dG(e,n))&&this.startObserver()}unmount(){}}function dG({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const fG={inView:{Feature:uG},tap:{Feature:iG},focus:{Feature:sG},hover:{Feature:nG}},hG={layout:{ProjectionNode:fA,MeasureLayout:iA}},mG={...e8,...fG,...tG,...hG},De=gH(mG,RH),B_=(t,e=800)=>{const[n,s]=_.useState(t),i=_.useRef(t);return _.useEffect(()=>{if(i.current===t)return;const r=i.current,a=t;let o=null;const c=u=>{o||(o=u);const d=Math.min((u-o)/e,1);s(r+(a-r)*d),d<1?requestAnimationFrame(c):i.current=t};requestAnimationFrame(c)},[t,e]),n},pG=({room:t,player:e,onAction:n})=>{var A,k,R,C,B,z,$,K,U,O,j;const{activeTab:s,setActiveTab:i}=gf(),{playSfx:r}=I0(),[a,o]=_.useState(!1),[c,u]=_.useState({tick:((A=t.world)==null?void 0:A.gameTick)||0,time:Date.now()});_.useEffect(()=>{var I,H;((I=t.world)==null?void 0:I.gameTick)!==c.tick&&u({tick:((H=t.world)==null?void 0:H.gameTick)||0,time:Date.now()})},[(k=t.world)==null?void 0:k.gameTick,c.tick]);const d=(R=t.regions)==null?void 0:R[e.regionId||"capital"],f=(((C=d==null?void 0:d.coup)==null?void 0:C.bribeProgress)||0)>0||!!(d!=null&&d.activeElection);_.useEffect(()=>{const I=H=>{if(H.target instanceof HTMLInputElement||H.target instanceof HTMLTextAreaElement)return;const X=H.key.toLowerCase(),oe={m:"MAP",l:"ACTIVITY",p:"PROFILE",i:"INVENTORY",f:"SKILLS",d:"DIPLOMACY",h:"HIERARCHY"};if(oe[X]){if(X==="d"&&e.role==="PEASANT")return;i(oe[X]),r("ui_click.ogg")}};return window.addEventListener("keydown",I),()=>window.removeEventListener("keydown",I)},[i,e.role,r]);const[,h]=_.useState(0);_.useEffect(()=>{const I=setInterval(()=>h(H=>H+1),1e3);return()=>clearInterval(I)},[]);const m=e.status.stamina||0,g=e.status.hp||0,b=e.stats.xp||0,x=e.stats.level||1,p=bd[x]||1e3,v=Math.min(100,b/p*100),y=B_(m),E=B_(g),N=[{id:"MAP",label:"Kart",icon:L3,short:"M"},{id:"ACTIVITY",label:"Live",icon:Ol,short:"L"},{id:"INVENTORY",label:"Eiendeler",icon:F3,short:"I"},{id:"SKILLS",label:"Ferdigheter",icon:Y3,short:"F"},...e.role!=="PEASANT"?[{id:"DIPLOMACY",label:"Diplomati",icon:Ol,short:"D"}]:[],{id:"HIERARCHY",label:"Samfunn",icon:R3,short:"H"}],T=((B=t.world)==null?void 0:B.year)||1100,w=(($=An[(z=t.world)==null?void 0:z.season])==null?void 0:$.label)||((K=t.world)==null?void 0:K.season);return l.jsxs("header",{className:"flex-none h-16 md:h-20 border-b border-white/5 bg-slate-950/80 backdrop-blur-xl flex items-center justify-between px-4 md:px-8 z-50 relative shrink-0 transition-all",children:[l.jsxs("div",{className:"flex items-center gap-6 md:gap-8",children:[l.jsxs("div",{className:"flex flex-col",children:[l.jsxs("div",{className:"flex items-baseline gap-2",children:[l.jsx("span",{className:"text-3xl md:text-4xl font-black text-white tracking-tighter leading-none tabular-nums shadow-indigo-500/50 drop-shadow-lg",children:SP(c.tick,c.time)}),l.jsxs("span",{className:"text-sm md:text-base font-bold text-slate-500 uppercase tracking-widest",children:["R ",T]})]}),l.jsxs("div",{className:"flex items-center gap-3 text-[10px] md:text-xs font-bold uppercase tracking-widest text-slate-400 mt-1",children:[l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("span",{className:((U=t.world)==null?void 0:U.season)==="Winter"?"text-blue-300 drop-shadow-[0_0_8px_rgba(147,197,253,0.5)]":"text-amber-400 drop-shadow-[0_0_8px_rgba(251,191,36,0.5)]",children:w}),l.jsx("span",{className:"text-slate-600",children:""}),l.jsx("span",{className:"",title:Ss(((O=t.world)==null?void 0:O.gameTick)||0)==="DAY"?"Dag":"Natt",children:Ss(((j=t.world)==null?void 0:j.gameTick)||0)==="DAY"?" Dag":" Natt"})]}),f&&l.jsx("button",{onClick:()=>{i("POLITICS"),r("ui_click.ogg")},className:"flex items-center gap-2 bg-rose-600/20 border border-rose-500/50 px-2 py-0.5 rounded-full animate-pulse group hover:bg-rose-500 hover:text-white transition-all ml-2",title:"Uro i regionen! Klikk for  se politisk status.",children:l.jsx("span",{className:"text-[10px] font-black italic tracking-tighter",children:" URO"})})]})]}),l.jsx("nav",{className:"hidden md:flex items-center gap-1 bg-white/5 p-1 rounded-xl border border-white/5",children:N.map(I=>{const H=s===I.id,X=I.icon;return l.jsxs("button",{onClick:()=>{i(I.id),r("ui_click.ogg")},className:`
                                    relative px-4 py-2 rounded-lg flex items-center gap-2 transition-all group overflow-hidden
                                    ${H?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-400 hover:text-white hover:bg-white/5"}
                                `,children:[l.jsx(X,{size:16,className:H?"animate-pulse":""}),l.jsx("span",{className:"text-xs font-bold uppercase tracking-wider ",children:I.label}),I.short&&l.jsx("span",{className:`text-[10px] absolute top-0.5 right-1 font-mono font-bold transition-opacity ${H?"text-indigo-300":"text-slate-700 group-hover:text-slate-500"}`,children:I.short})]},I.id)})})]}),l.jsxs("div",{className:"flex items-center gap-4 md:gap-6",children:[e.activeBuffs&&e.activeBuffs.length>0&&l.jsx("div",{className:"flex items-center gap-2 mr-2",children:e.activeBuffs.map(I=>l.jsx(vG,{buff:I},I.id))}),l.jsxs("div",{className:"hidden lg:flex items-center bg-slate-900/50 rounded-full border border-white/5 overflow-hidden transition-all duration-300",children:[l.jsxs("button",{onClick:()=>{i("INVENTORY"),r("ui_click.ogg")},className:"flex items-center gap-2 hover:bg-white/5 px-4 py-1.5 transition-colors cursor-pointer group active:scale-95",title:"pne Eiendeler (I)",children:[l.jsx(dp,{resource:"gold",amount:e.resources.gold,size:"sm"}),l.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500 group-hover:text-slate-300 transition-colors ml-1",children:"Gull"})]}),l.jsx("div",{className:"w-px h-4 bg-white/10"}),l.jsxs("button",{onClick:()=>{e.resources.bread?(n==null||n({type:"CONSUME",itemId:"bread",isResource:!0}),r("eat.ogg")):(i("INVENTORY"),r("ui_click.ogg"))},disabled:!e.resources.bread,className:`flex items-center gap-3 px-4 py-1.5 transition-all cursor-pointer group border-l border-white/0 active:scale-95 ${e.resources.bread?"hover:bg-emerald-500/10 hover:border-emerald-500/20":"opacity-40 cursor-not-allowed"}`,title:e.resources.bread?"Spis Brd (+20 Stamina)":"Tomt for brd",children:[l.jsx(dp,{resource:"bread",amount:e.resources.bread||0,size:"sm"}),l.jsx("div",{className:"flex flex-col items-start -space-y-1",children:l.jsx("span",{className:`text-[10px] font-black uppercase tracking-widest transition-colors ${e.resources.bread?"text-slate-500 group-hover:text-emerald-400":"text-slate-600"}`,children:e.resources.bread?"Spis":"Tom"})})]})]}),l.jsxs("div",{className:"flex flex-col gap-1 w-24 md:w-32",children:[l.jsxs("div",{className:"h-1.5 bg-slate-800 rounded-full overflow-hidden relative group",children:[l.jsx(De.div,{className:"absolute inset-y-0 left-0 bg-rose-500 rounded-full",initial:{width:0},animate:{width:`${E}%`}}),l.jsxs("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 flex items-center justify-center text-[8px] font-black text-white bg-black/50 transition-opacity",children:["HP ",Math.round(E),"%"]})]}),l.jsxs("div",{className:"h-1.5 bg-slate-800 rounded-full overflow-hidden relative group",children:[l.jsx(De.div,{className:"absolute inset-y-0 left-0 bg-amber-400 shadow-[0_0_10px_rgba(251,191,36,0.5)]",initial:{width:0},animate:{width:`${y}%`}}),l.jsxs("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 flex items-center justify-center text-[8px] font-black text-black bg-white/50 transition-opacity",children:["STA ",Math.round(y),"%"]})]}),l.jsx("div",{className:"h-1 bg-slate-800/50 rounded-full overflow-hidden relative group mt-0.5",children:l.jsx(De.div,{className:"absolute inset-y-0 left-0 bg-indigo-500",initial:{width:0},animate:{width:`${v}%`}})})]}),l.jsxs("button",{onClick:()=>{i("PROFILE"),r("ui_click.ogg")},className:"group flex items-center gap-3 bg-white/0 hover:bg-white/5 pl-4 pr-1 py-1 rounded-2xl border border-transparent hover:border-white/10 transition-all active:scale-95",title:"Min Karakter (P)",children:[l.jsx("div",{className:"hidden lg:flex flex-col items-end",children:l.jsx("span",{className:"text-xl font-black italic tracking-tighter text-white leading-none",children:e.name})}),l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-600 p-0.5 shadow-lg overflow-hidden group-hover:shadow-indigo-500/20",children:e.avatar?l.jsx("img",{src:e.avatar,alt:"Profile",className:"w-full h-full object-cover rounded-[10px]"}):l.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-900 rounded-[10px] text-lg",children:e.role==="KING"?"":""})}),l.jsx("div",{className:"absolute -bottom-1 -right-1 w-5 h-5 bg-slate-900 rounded-full flex items-center justify-center border border-white/10 text-[9px] font-black text-white z-10",children:x})]})]}),l.jsx(gG,{icon:J3,onClick:()=>i("SETTINGS"),title:"Innstillinger"}),l.jsx("button",{className:"md:hidden text-white p-2",onClick:()=>o(!a),children:a?l.jsx(ji,{}):l.jsx(B3,{})})]}),l.jsx(Ei,{children:a&&l.jsxs(De.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"absolute top-16 left-0 right-0 bg-slate-900 border-b border-white/10 p-4 shadow-2xl md:hidden flex flex-col gap-2 z-40",children:[N.map(I=>l.jsxs("button",{onClick:()=>{i(I.id),o(!1)},className:`w-full p-4 rounded-xl text-left font-black uppercase flex items-center gap-4 ${s===I.id?"bg-indigo-600 text-white":"bg-white/5 text-slate-400"}`,children:[l.jsx(I.icon,{size:20}),I.label]},I.id)),l.jsx("div",{className:"h-px bg-white/5 my-2"}),l.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 font-bold uppercase tracking-widest px-2",children:[l.jsxs("span",{children:["r ",T]}),l.jsx("span",{children:w})]})]})})]})},gG=({icon:t,onClick:e,title:n,className:s})=>l.jsx("button",{onClick:e,title:n,className:`hidden md:flex p-2 text-slate-400 hover:text-white hover:bg-white/5 rounded-lg transition-all ${s}`,children:l.jsx(t,{size:20})}),vG=({buff:t})=>{const[e,n]=_.useState(Math.max(0,Math.ceil((t.expiresAt-Date.now())/6e4)));return _.useEffect(()=>{const s=setInterval(()=>{const i=Math.max(0,Math.ceil((t.expiresAt-Date.now())/6e4));n(i)},1e4);return()=>clearInterval(s)},[t.expiresAt]),Date.now()>t.expiresAt?null:l.jsxs("div",{className:"group relative flex items-center justify-center w-8 h-8 rounded-full bg-emerald-500/10 border border-emerald-500/30 text-emerald-400 cursor-help",children:[l.jsx("span",{className:"text-lg",children:""}),l.jsxs("span",{className:"absolute -bottom-1 -right-1 text-[8px] font-black bg-slate-900 px-1 rounded-full border border-white/10",children:[e,"m"]}),l.jsxs("div",{className:"absolute top-full mt-2 left-1/2 -translate-x-1/2 bg-slate-900 p-2 rounded-lg border border-white/10 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none w-32 text-center z-50",children:[l.jsx("p",{className:"text-[10px] font-bold text-white mb-0.5",children:t.label}),l.jsxs("p",{className:"text-[9px] text-emerald-400",children:[t.value*100,"% mindre stamina"]})]})]})},hA=we.memo(({src:t,placeholderSrc:e,alt:n,className:s,imgClassName:i="object-cover w-full h-full",priority:r=!1,disableMotion:a=!1})=>{const[o,c]=_.useState(!1),[u,d]=_.useState(e||t);return _.useEffect(()=>{c(!1),e&&d(e);const f=new Image;f.src=t,f.onload=()=>{d(t),c(!0)}},[t,e]),l.jsx("div",{className:`relative overflow-hidden ${s}`,children:l.jsx(De.img,{src:u,alt:n,loading:r?"eager":"lazy",className:`${i} transition-all duration-700 ease-in-out`,initial:{filter:"blur(20px)",scale:a?1:1.1},animate:{filter:o?"blur(0px)":"blur(20px)",scale:a||o?1:1.1},style:{willChange:"filter, transform"}},t)})});hA.displayName="ProgressiveImage";const cr=[{id:"fields",label:"krene",icon:"",top:"22%",left:"42%",vest:{top:"35%",left:"70%"},ost:{top:"35%",left:"45%"},roles:["PEASANT","BARON","KING"],actions:[],isHub:!0},{id:"forest",label:"Skogen",icon:"",top:"25%",left:"80%",vest:{top:"15%",left:"60%"},ost:{top:"27%",left:"14%"},roles:["PEASANT","BARON","KING"],actions:[],isHub:!0},{id:"castle",label:"Slottet",icon:"",top:"66%",left:"86%",vest:{top:"40%",left:"30%"},ost:{top:"40%",left:"68%"},roles:["PEASANT","BARON","KING","SOLDIER"],actions:[{id:"OPEN_CONSTRUCTION",label:"Bidra til bygging",cost:"Ressurser"}],isHub:!0},{id:"peasant_farm",label:"Husmannsplassen",icon:"",top:"30%",left:"60%",vest:{top:"85%",left:"72%"},ost:{top:"75%",left:"30%"},roles:["PEASANT","BARON","KING"],actions:[],isHub:!0},{id:"market",label:"Markedet",icon:"",top:"70%",left:"25%",vest:{top:"70%",left:"37%"},ost:{top:"70%",left:"63%"},roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],actions:[{id:"MARKET_VIEW",label:"pne Handel",cost:"Gratis"},{id:"JOIN_ROLE",label:"Bli Kjpmann",cost:"500g + Niv 3",targetRole:"MERCHANT"}]},{id:"village",label:"Landsbyen",icon:"",top:"42%",left:"42%",vest:{top:"50%",left:"52%"},ost:{top:"55%",left:"44%"},roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],actions:[],isHub:!0},{id:"mine",label:"Gruve-distriktet",icon:"",top:"12%",left:"25%",vest:{top:"13%",left:"39%"},ost:{top:"20%",left:"60%"},roles:["PEASANT","BARON","KING"],actions:[],isHub:!0},{id:"monastery",label:"Klosteret",icon:"",top:"16%",left:"55%",vest:{top:"50%",left:"78%"},ost:{top:"50%",left:"27%"},roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],actions:[],isHub:!0},{id:"border",label:"Grensen",icon:"",top:"85%",left:"80%",vest:{top:"15%",left:"10%"},ost:{top:"15%",left:"10%"},roles:["BARON"],actions:[{id:"RAID",label:"Plyndre Nabo",cost:"-40"}]},{id:"throne_room",label:"Tronsalen",icon:"",top:"40%",left:"50%",roles:["KING"],parentId:"castle",actions:[{id:"TAX_ROYAL",label:"Kongelig Skatt",cost:"King Only"},{id:"DECREE",label:"Utsted Dekret",cost:"King Only"}]},{id:"barracks",label:"Kasernen",icon:"",top:"60%",left:"30%",roles:["PEASANT","BARON","KING","SOLDIER"],parentId:"castle",actions:[{id:"DRAFT",label:"Verve Soldater",cost:"-5g -10"},{id:"JOIN_ROLE",label:"Bli Soldat",cost:"200g + Niv 3",targetRole:"SOLDIER"}]},{id:"royal_chambers",label:"Kongens Kammer",icon:"",top:"30%",left:"70%",roles:["BARON","KING"],parentId:"castle",actions:[{id:"REST",label:"Hvile i Kammeret",cost:"Full rest + Velvre"}]},{id:"castle_construction",label:"Byggeplass",icon:"",top:"75%",left:"80%",roles:["PEASANT","BARON","KING","SOLDIER"],parentId:"castle",actions:[{id:"OPEN_CONSTRUCTION",label:"Bidra til bygging",cost:"Ressurser"}]},{id:"village_square",label:"Landsbytorg",icon:"",top:"50%",left:"50%",village:{top:"48%",left:"50%"},roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],parentId:"village",actions:[{id:"REST",label:"Hvile p torget",cost:"+10"}]},{id:"tavern",label:"Vertshuset",icon:"",top:"35%",left:"75%",village:{top:"75%",left:"80%"},roles:["PEASANT","BARON","KING","SOLDIER"],parentId:"village",actions:[{id:"ENTER_TAVERN",label:"G inn",cost:"Gratis"},{id:"REST_BASIC",label:"Hvile i Salen",cost:"Gratis"},{id:"REST_COMFY",label:"Bestille Kammer",cost:"-5g"},{id:"REST_ROYAL",label:"Kongelig Suite",cost:"-20g"}],isHub:!0,isInterior:!0},{id:"bakery",label:"Bakeri",icon:"",top:"80%",left:"30%",village:{top:"38%",left:"35%"},roles:["PEASANT","BARON"],parentId:"village",actions:[],isHub:!0,isInterior:!0},{id:"great_forge",label:"Storsmie",icon:"",top:"35%",left:"15%",village:{top:"48%",left:"23%"},roles:["PEASANT","BARON"],parentId:"village",actions:[],isHub:!0,isInterior:!0},{id:"windmill",label:"Vindmlle",icon:"",top:"20%",left:"37%",village:{top:"25%",left:"17%"},roles:["PEASANT","BARON","KING"],parentId:"village",actions:[{id:"REFINE_flour",label:"Male Mel",cost:"-15 -10korn"}],isHub:!0,isInterior:!0},{id:"smeltery",label:"Smeltehytte",icon:"",top:"60%",left:"95%",village:{top:"75%",left:"12%"},roles:["PEASANT","BARON"],parentId:"village",actions:[{id:"REFINE_IRON_BASIC",label:"Smelte Jern",cost:"-20 -5malm"},{id:"REFINE_IRON_FAST",label:"Industri-smelting",cost:"-30 -10malm"},{id:"REFINE_STEEL",label:"Smelte Stl",cost:"-50 -20malm"}],isHub:!0,isInterior:!0},{id:"sawmill",label:"Sagbruk",icon:"",top:"55%",left:"15%",village:{top:"70%",left:"45%"},roles:["PEASANT","BARON"],parentId:"village",actions:[{id:"REFINE_PLANK_BASIC",label:"Sag Planker",cost:"-10 -5ved"},{id:"REFINE_PLANK_FAST",label:"Hurtig-saging",cost:"-15 -5ved"}],isHub:!0,isInterior:!0},{id:"weavery",label:"Veveri",icon:"",top:"50%",left:"85%",village:{top:"45%",left:"65%"},roles:["PEASANT","BARON","MERCHANT"],parentId:"village",actions:[],isHub:!0,isInterior:!0},{id:"watchtower",label:"Vaktrn",icon:"",top:"15%",left:"68%",village:{top:"25%",left:"82%"},roles:["BARON","SOLDIER"],parentId:"village",actions:[],isHub:!0,isInterior:!0},{id:"stables",label:"Stall",icon:"",top:"80%",left:"80%",village:{top:"45%",left:"90%"},roles:["BARON","SOLDIER","KING"],parentId:"village",actions:[],isHub:!0,isInterior:!0},{id:"well",label:"Bybrnn",icon:"",top:"69%",left:"60%",village:{top:"48%",left:"50%"},roles:["PEASANT","BARON"],parentId:"village",actions:[],isHub:!0},{id:"apothecary",label:"Apoteker",icon:"",top:"20%",left:"82%",village:{top:"60%",left:"92%"},roles:["PEASANT","BARON","KING","MERCHANT"],parentId:"village",actions:[],isHub:!0,isInterior:!0},{id:"forge_anvil",label:"Ambolt",icon:"",top:"50%",left:"40%",roles:["PEASANT","BARON"],parentId:"great_forge",actions:[{id:"OPEN_CRAFTING",label:"pne Smia",cost:"Gratis"}]},{id:"forge_upgrades",label:"Tegneark",icon:"",top:"40%",left:"75%",roles:["PEASANT","BARON"],parentId:"great_forge",actions:[{id:"BUILDING_UPGRADE_great_forge",label:"Oppgrader Smia",cost:"Varierer"}]},{id:"bakery_oven",label:"Bakerovn",icon:"",top:"50%",left:"50%",roles:["PEASANT","BARON"],parentId:"bakery",actions:[{id:"REFINE",label:"pne Bakeriet",cost:"Gratis"}]},{id:"bakery_upgrades",label:"Tegneark",icon:"",top:"30%",left:"80%",roles:["PEASANT","BARON"],parentId:"bakery",actions:[{id:"BUILDING_UPGRADE_bakery",label:"Oppgrader Bakeriet",cost:"Varierer"}]},{id:"windmill_stones",label:"Kvernsteiner",icon:"",top:"50%",left:"40%",roles:["PEASANT","BARON"],parentId:"windmill",actions:[{id:"REFINE",label:"pne Mlla",cost:"Gratis"}]},{id:"windmill_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON"],parentId:"windmill",actions:[{id:"BUILDING_UPGRADE_windmill",label:"Oppgrader Mlla",cost:"Varierer"}]},{id:"sawmill_blade",label:"Saga",icon:"",top:"50%",left:"40%",roles:["PEASANT","BARON"],parentId:"sawmill",actions:[{id:"REFINE",label:"pne Sagbruket",cost:"Gratis"}]},{id:"sawmill_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON"],parentId:"sawmill",actions:[{id:"BUILDING_UPGRADE_sawmill",label:"Oppgrader Sagbruket",cost:"Varierer"}]},{id:"smeltery_furnace",label:"Smelteovn",icon:"",top:"50%",left:"30%",roles:["PEASANT","BARON"],parentId:"smeltery",actions:[{id:"REFINE",label:"pne Smeltehytta",cost:"Gratis"}]},{id:"smeltery_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON"],parentId:"smeltery",actions:[{id:"BUILDING_UPGRADE_smeltery",label:"Oppgrader Smeltehytta",cost:"Varierer"}]},{id:"weavery_loom",label:"Vevstol",icon:"",top:"50%",left:"40%",roles:["PEASANT","BARON","MERCHANT"],parentId:"weavery",actions:[{id:"REFINE",label:"pne Veveriet",cost:"Gratis"}]},{id:"weavery_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON"],parentId:"weavery",actions:[{id:"BUILDING_UPGRADE_weavery",label:"Oppgrader Veveriet",cost:"Varierer"}]},{id:"stables_stall",label:"Stallplass",icon:"",top:"50%",left:"40%",roles:["BARON","SOLDIER","KING"],parentId:"stables",actions:[{id:"MOUNT_HORSE",label:"Ri ut",cost:"-5"}]},{id:"stables_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["BARON","KING"],parentId:"stables",actions:[{id:"BUILDING_UPGRADE_stables",label:"Oppgrader Stallen",cost:"Varierer"}]},{id:"watchtower_top",label:"Vaktpost",icon:"",top:"30%",left:"50%",roles:["PEASANT","BARON","SOLDIER"],parentId:"watchtower",actions:[{id:"OPEN_GARRISON",label:"pne Garnisonen",cost:"Gratis"},{id:"PATROL",label:"Patruljer",cost:"-30"}]},{id:"watchtower_upgrades",label:"Tegneark",icon:"",top:"50%",left:"80%",roles:["BARON"],parentId:"watchtower",actions:[{id:"BUILDING_UPGRADE_watchtower",label:"Oppgrader Trnet",cost:"Varierer"}]},{id:"apothecary_bench",label:"Arbeidsbenk",icon:"",top:"50%",left:"40%",roles:["PEASANT","BARON"],parentId:"apothecary",actions:[{id:"OPEN_CRAFTING",label:"pne Apoteket",cost:"Gratis"}]},{id:"apothecary_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON"],parentId:"apothecary",actions:[{id:"BUILDING_UPGRADE_apothecary",label:"Oppgrader Apoteket",cost:"Varierer"}]},{id:"well_water",label:"Brnnkum",icon:"",top:"50%",left:"50%",roles:["PEASANT","BARON"],parentId:"well",actions:[{id:"GATHER_WATER",label:"Hent Vann",cost:"-10"}]},{id:"well_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON"],parentId:"well",actions:[{id:"BUILDING_UPGRADE_well",label:"Oppgrader Brnnen",cost:"Varierer"}]},{id:"tavern_bar",label:"Baren",icon:"",top:"30%",left:"30%",roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],parentId:"tavern",actions:[{id:"BUY_MEAL",label:"Kjp Mltid",cost:"-5g +10"},{id:"REST_BASIC",label:"Hvile i Salen",cost:"Gratis"},{id:"REST_COMFY",label:"Bestille Kammer",cost:"-5g"},{id:"REST_ROYAL",label:"Kongelig Suite",cost:"-20g"}]},{id:"tavern_gambling",label:"Spillebordet",icon:"",top:"50%",left:"50%",roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],parentId:"tavern",actions:[{id:"OPEN_DICE_GAME",label:"Spill Terninger",cost:"Min. 0.5g"}]},{id:"tavern_gossip",label:"Lokalbefolkningen",icon:"",top:"40%",left:"70%",roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],parentId:"tavern",actions:[{id:"CHAT_LOCAL",label:"Snakk med folk",cost:"Gratis"}]},{id:"tavern_upgrades",label:"Tegneark",icon:"",top:"25%",left:"85%",roles:["PEASANT","BARON","KING"],parentId:"tavern",actions:[{id:"BUILDING_UPGRADE_tavern",label:"Oppgrader Vertshuset",cost:"Varierer"}]},{id:"grain_fields",label:"Kornker",icon:"",top:"50%",left:"20%",roles:["PEASANT","BARON","KING"],parentId:"fields",actions:[{id:"PLANT",label:"S Korn",cost:"-5 korn -25"}]},{id:"sheep_pasture",label:"Sauebeite",icon:"",top:"35%",left:"65%",roles:["PEASANT","BARON","KING"],parentId:"fields",actions:[{id:"GATHER_WOOL",label:"Klipp Sauer",cost:"-15"}]},{id:"beehives",label:"Bikuber",icon:"",top:"75%",left:"70%",roles:["PEASANT","BARON","KING"],parentId:"fields",actions:[{id:"GATHER_HONEY",label:"Samle Honning",cost:"-20"}]},{id:"mine_shaft",label:"Jern-gruva",icon:"",top:"50%",left:"12%",roles:["PEASANT","BARON","KING"],parentId:"mine",actions:[{id:"MINE",label:"Bryte Malm",cost:"-25 -1"}]},{id:"quarry_poi",label:"Steinhuggeriet",icon:"",top:"40%",left:"85%",roles:["PEASANT","BARON","KING"],parentId:"mine",actions:[{id:"QUARRY",label:"Hugge Stein",cost:"-20 -1"}]},{id:"forest_clearing",label:"Hogstfeltet",icon:"",top:"60%",left:"30%",roles:["PEASANT","BARON","KING"],parentId:"forest",actions:[{id:"CHOP",label:"Hugge Ved",cost:"-15 -1"}]},{id:"hunting_grounds",label:"Jaktmarker",icon:"",top:"30%",left:"75%",roles:["PEASANT","BARON","KING"],parentId:"forest",actions:[{id:"HUNT",label:"Dra p Jakt",cost:"-30"}]},{id:"forest_forage",label:"Brplukking",icon:"",top:"60%",left:"90%",roles:["PEASANT","BARON","KING"],parentId:"forest",actions:[{id:"FORAGE",label:"Sanke Mat (Nd)",cost:"-40"}]},{id:"monastery_chapel",label:"Klosterkirken",icon:"",top:"50%",left:"50%",roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],parentId:"monastery",actions:[{id:"PRAY",label:"Be en Bnn",cost:"-15"}]},{id:"farm_house",label:"Inne i Stugo",icon:"",top:"52%",left:"58%",roles:["PEASANT"],parentId:"peasant_farm",actions:[],isHub:!0,isInterior:!0},{id:"stugo_bed",label:"Senga",icon:"",top:"65%",left:"42%",roles:["PEASANT"],parentId:"farm_house",actions:[{id:"SLEEP",label:"Sove tungt",cost:"Full "}]},{id:"stugo_fireplace",label:"Peisen",icon:"",top:"55%",left:"80%",roles:["PEASANT"],parentId:"farm_house",actions:[{id:"EAT",label:"Sitte ved varmen",cost:"-1 +40"}]},{id:"farm_well",label:"Brnnen",icon:"",top:"60%",left:"27%",roles:["PEASANT"],parentId:"peasant_farm",actions:[{id:"REST",label:"Drikke vann",cost:"+5"}]},{id:"farm_upgrade_spot",label:"Tegneark",icon:"",top:"40%",left:"15%",roles:["PEASANT"],parentId:"farm_house",actions:[{id:"BUILDING_UPGRADE_farm_house",label:"Bygg ut grden",cost:"Varierer"}]},{id:"chicken_coop",label:"Hnsehus",icon:"",top:"40%",left:"75%",roles:["PEASANT"],parentId:"peasant_farm",actions:[{id:"OPEN_CHICKEN_COOP",label:"G inn til hnene",cost:"Gratis"}]}],U_=[{id:"pilegrim",name:"Sigurd Pilegrim",role:"Vandrer mot Nidaros",description:"Han sitter masserer sine sre ftter. En bredbremmet hatt med et kamskjell ligger p bordet, og vandringsstaven er slitt glatt av tusenvis av grep.",conversation:{start:{text:"Fred vre med deg, reisende. Kjenner du veien nordover? Mine ftter verker som om jeg har gtt p gldende kull, men sjelen... sjelen trekkes mot Hellig Olavs by.",options:[{label:"Hvorfor denne lange reisen?",nextId:"why"},{label:"Er det farlig langs veien?",nextId:"danger"},{label:"Fortell om kamskjellet.",nextId:"shell"},{label:"Lykke til videre. (G)",nextId:"EXIT"}]},why:{text:"For bot og bedring! Vi brer alle synder, min venn. Men i Nidaros, ved kongens skrin, er himmelen nrmere jorden. Det sies at en pilegrimsferd kan korte ned tiden i skjrsilden med mange r.",options:[{label:"Tror du virkelig p det?",nextId:"believe"},{label:"Hva hper du  finne?",nextId:"hope"}]},believe:{text:"Jeg *m* tro. Jeg har sett halte kaste krykkene og blinde f synet tilbake ved katedralen. Olavs kraft er sterk, selv om han har vrt dd i hundrevis av r. Han er Norges evige konge.",options:[{label:"Fortell om Olav.",nextId:"olav"}]},hope:{text:"Tilgivelse. Og kanskje litt sjelefred. Livet er hardt, vinteren er lang.  vite at man har gjort denne ofringen... det gir styrke.",options:[{label:"Forstelig.",nextId:"start"}]},danger:{text:" ja! Dovrefjell er ndelst. Snstormer kan komme midt p sommeren. Og i dalene lurer landeveisrvere som ser p oss pilegrimer som vandrende pengesekker. Men vi reiser ofte i flokk for beskyttelse.",options:[{label:"Har du blitt ranet?",nextId:"robbed"},{label:"Hvor sover dere?",nextId:"sjelehus"}]},robbed:{text:"Nesten. En gang, nr Gudbrandsdalen, s vi skygger i skogen. Vi sang salmer s hyt vi kunne, og drev dem bort med troens styrke! ...og kanskje fordi vi var frti stykker.",options:[{label:"God taktikk.",nextId:"danger"}]},sjelehus:{text:"Det finnes sjelehus  herberger bygget for Guds skyld  langs ruten. Der fr vi tak over hodet og enkel mat. Ofte deler vi rom med dyrene for varmen.",options:[{label:"Hres... koselig ut.",nextId:"danger"}]},shell:{text:"Ah, Ib-skjellet! Symbolet p St. Jakob. Dette viser at jeg har vandret helt til Santiago de Compostela i Spania. Jeg har sett verden, min venn. Fra nordlyset her til de solbrente slettene i sr.",options:[{label:"Du er en bereist mann.",nextId:"start"}]},olav:{text:"Han falt p Stiklestad i 1030. De sier at da de gravde ham opp et r senere, var kroppen like frisk, og hret og neglene hadde vokst! Det var beviset. Han kristnet oss med sverd, men reddet oss med sin hellighet.",options:[{label:"En mektig legende.",nextId:"start"}]}}},{id:"hansa",name:"Gerhard fra Lbeck",role:"Hansa-kjpmann",description:"Kledd i kostbar ull og pels. Han studerer en lang regnskapsrull med rynket panne og nipper til en vin som ser langt bedre ut enn husets vanlige.",conversation:{start:{text:"*Mumler p tysk* ...zwei schock, drei stck... Ah! En lokal? Si meg, har fiskerne i nord ftt opp farten? Mine skip venter i Bergen. Tid er penger, som vi sier i Lbeck.",options:[{label:"Hvem er du?",nextId:"intro"},{label:"Hvorfor er trrfisken s viktig?",nextId:"stockfish"},{label:"Hva er Hansaen egentlig?",nextId:"hansa_deep"},{label:"Jeg lar deg arbeide. (G)",nextId:"EXIT"}]},intro:{text:"Gerhard, handelsmann av Det Tyske Hanseforbund. Vi srger for at dere fr korn og mel, og at dere fr solgt den... vel, illeluktende fisken deres. En god byttehandel, *nicht wahr*?",options:[{label:"Vi klarer oss vel selv?",nextId:"monitor"},{label:"Takk for kornet.",nextId:"grain"}]},grain:{text:"Ja, det burde dere. Uten vrt baltiske korn ville mange nordmenn sultet nr avlingene svikter. Vi binder Nord-Europa sammen med vre kogger.",options:[{label:"Kogger?",nextId:"cog"}]},monitor:{text:"Haha! Tror du det? Uten oss ville fisken deres rtnet p stranden. Vi har nettverket. Vi har markedene i sr  katolikkene trenger fisk til fasten, og vi leverer.",options:[{label:"Dere tar stor fortjeneste.",nextId:"monopoly"}]},monopoly:{text:"Risiko koster! Stormer, pirater, kriger. Vi tar risikoen, vi tar profitten. Og vi har Kongens velsignelse... og privilegier. Vi dmmer vre egne p Bryggen.",options:[{label:"Egne lover?",nextId:"laws"}]},laws:{text:"Ja. En hanseat dmmes etter hansas lov, ikke norsk lov. Det... skaper litt friksjon med byborgerne, innrmmer jeg. Men handelen m flyte!",options:[{label:"Hres urettferdig ut.",nextId:"start"}]},stockfish:{text:'Det er "Det hvite gullet"! Trket i den kalde norske vinden blir den hard som tre og holder i revis. Perfekt mat for soldater og munker i hele Europa. Vi bytter det mot korn, klr, vin og krydder.',options:[{label:"En viktig ressurs.",nextId:"start"}]},hansa_deep:{text:"Et brorskap av handelsbyer. Lbeck, Hamburg, Rostock, Visby... og vrt kontor i Bergen. Vi beskytter hverandre mot konger som vil skattlegge oss for hardt, og mot sjrvere. Sammen er vi sterkere enn noe kongerike.",options:[{label:"Morsomt at du nevner pirater...",nextId:"pirates"},{label:"Imponerende.",nextId:"start"}]},pirates:{text:"Vitaliebrdrene... en plage! De herjer i stersjen. Men Hansaen har sine egne skip. Vi kan bite fra oss. Ikke tro at en kjpmann ikke kan svinge et sverd.",options:[{label:"Notert.",nextId:"EXIT"}]},cog:{text:"Vre skip. Brede, hye, med plass til enorme mengder last. De er ikke raske som vikingenes langskip, men de bygget vr rikdom. Ett skip kan f hele Bergen med korn.",options:[{label:"Teknologi er makt.",nextId:"start"}]}}},{id:"leilending",name:"Tormod",role:"Sliten Leilending",description:"Hendene hans er grove som bark, og ryggen er byd av r med plying. Han drikker tynt l og ser tankefullt ned i kruset.",conversation:{start:{text:"Enda en hst, enda en landskyld  betale. Livet til en leilending er  s for andre og hste smuler selv. Skl for det.",options:[{label:"Hva er landskyld?",nextId:"rent"},{label:"Hvorfor eier du ikke jorda?",nextId:"own"},{label:"Hvordan var det fr?",nextId:"plague"},{label:"Gr det s drlig? (G)",nextId:"EXIT"}]},rent:{text:"Leieavgiften. Jeg driver grden, men Kirken eier grunnen. Hvert r m jeg gi dem en fjerdedel av kornet, tre skippund smr og to kyr. Det som er igjen... det skal f familien min gjennom vinteren.",options:[{label:"Hva hvis avlingen svikter?",nextId:"fail"},{label:"Hvem bestemmer prisen?",nextId:"laws"}]},fail:{text:"Da sulter vi. Eller vi m lne skorn av jordeieren, og da havner vi dypere i gjeld. Det er en sirkel det er vanskelig  bryte.",options:[{label:"Trist skjebne.",nextId:"start"}]},own:{text:"F bnder eier sin egen jord n. Adelen og Kirken har kjpt opp nesten alt. Men jeg har i det minste *bygslebrev*. S lenge jeg betaler og driver jorda, kan de ikke kaste meg ut. Det er norsk lov.",options:[{label:"En viss trygghet.",nextId:"laws"}]},laws:{text:"Ja, Landsloven til Magnus Lagabte. Den gir oss rettigheter. Jordeieren kan ikke bare ta grden fordi han vil. Og jeg kan kreve at snnen min fr overta bygselen. Vi er ikke slaver, vi er frie menn... bare fattige.",options:[{label:"Viktig forskjell.",nextId:"start"}]},plague:{text:"*Han senker stemmen* Bestefar fortalte om Den Store Dden. Da to av tre dde. Etterp... etterp var det gode tider for de som overlevde. Masse ledig jord! Lav landskyld! N? N er vi mange igjen, og jordeierne strammer grepet.",options:[{label:"degrder?",nextId:"deserted"},{label:"Tidene skifter.",nextId:"start"}]},deserted:{text:"Ja, du kan fortsatt se ruinene i skogen. Grder der folk bodde fr, som n er grodd igjen. Noen sier det spker der, at de dde gr igjen og passer p arveslvet sitt.",options:[{label:"Grss.",nextId:"start"}]}}},{id:"steinhugger",name:"Master William",role:"Engelsk Steinhugger",description:"Han tegner geometriske figurer i slt l p bordet. Fingrene er hvite av steinstv.",conversation:{start:{text:"Ser du? Hvis du lfter buen *her*, og krysser hvelvet *slik*... da kan du bygge hyere enn fjellene! Ah, unnskyld. Jeg drmmer om stein.",options:[{label:"Bygger du katedralen?",nextId:"nidaros"},{label:"Du er ikke herfra?",nextId:"english"},{label:"Stein er bare stein. (G)",nextId:"EXIT"}]},nidaros:{text:"Kristkirken i Nidaros, ja! Verdens nordligste gotiske katedral. Vi hugger Kleberstein. Den er myk som smr nr den brytes, men blir hard som jern i luften. Et mirakulst materiale.",options:[{label:"Fortell om stilen.",nextId:"gothic"},{label:"Hvor lenge holder dere p?",nextId:"time"}]},gothic:{text:"Gotikk! Det er lysets arkitektur. I gamle dager bygget de tykke vegger og sm vinduer (romansk stil). N? Vi bruker strebepilarer p utsiden til  bre taket, s vi kan fylle veggene med glassmalerier. Guds lys strmmer inn!",options:[{label:"Hres vakkert ut.",nextId:"symbolism"}]},symbolism:{text:"Det er mer enn vakkert. Kirken er et bilde p himmelen. Hver syle, hver bue peker oppover. Nr bonden kommer inn fra gjrma, skal han fle at han trer inn i Guds rike.",options:[{label:"Mektig.",nextId:"start"}]},english:{text:"Nei, jeg kom fra Lincoln. Erkebiskopen hentet hndverkere fra England. Vi tar med oss kunnskapen om de nye stilene. Det er et internasjonalt laug, steinhuggerne. Vi reiser dit Gud og gullet kaller oss.",options:[{label:"Et reisende liv.",nextId:"start"}]},time:{text:'Haha! "Hvor lenge?" Min oldefar begynte. Jeg fortsetter. Mine barnebarn vil kanskje se spiret reise seg. En katedral bygges ikke for oss, men for evigheten.',options:[{label:"En tlmodighetsprve.",nextId:"EXIT"}]}}},{id:"vaering",name:"Halvdan",role:"Veteran fra Vringgarden",description:"Han brer en kappe av falmet, men kostbar silke. Et stygt arr deler venstre yenbryn i to. Han drikker ikke l, men vin fra en liten flaske.",conversation:{start:{text:"Dette stedet... det er kaldt, mrkt og lukter av vt hund. I Miklagard skinte solen p gulltakene hver dag, og keiserens hager duftet av sjasmin.",options:[{label:"Hvor er Miklagard?",nextId:"miklagard"},{label:"Var du en kriger?",nextId:"guard"},{label:"Hjemme best. (G)",nextId:"EXIT"}]},miklagard:{text:'"Den Store Byen". Konstantinopel! Verdens sentrum. Der mtes st og vest. Gatene er brolagt med marmor, og de har badehus med varmt vann i veggene! Kan du tenke deg? Varmt vann uten  koke det over bl!',options:[{label:"Utrolig.",nextId:"hagia"},{label:"Savner du det?",nextId:"miss"}]},hagia:{text:"Og Hagia Sofia... Guds Helligdoms Kirke. Kuppelen er s stor at den ser ut som om den henger i en gullkjede fra himmelen. Jeg har sett menn grte bare av  g inn der.",options:[{label:"M vre et syn.",nextId:"start"}]},guard:{text:'Vringgarden. Keiserens livvakt. Vi nordboere er hye, sterke og... vel, vi sviker ikke for penger. Grekerne er slueste folk, men de stoler bare p vre kser. "Pelekysphoroi" kaller de oss. ksebrere.',options:[{label:"Mtte dere slss?",nextId:"fight"},{label:"Ble du rik?",nextId:"rich"}]},fight:{text:"Mot sarasenere, mot bulgarere, mot opprrske generaler. Jeg har sett gresk ild  flytende flammer som brenner p vann! Det er djevelens verk, men effektivt.",options:[{label:"Gresk ild?",nextId:"start"}]},rich:{text:'Keiseren er sjeners. Nr han dr, har vi rett til  g gjennom skattkammeret og ta det vi kan bre. "Polutasvarf", kaller vi det. Palass-plyndring. Det er slik jeg fikk denne kappen... og denne ringen.',options:[{label:"En god pensjon.",nextId:"start"}]},miss:{text:"Hver vinter. Men her er min slekt, min jord. Og her snakker folk et sprk man kan forst. Men jeg vil alltid drmme om det Gyldne Horn.",options:[{label:"Skl for minnene.",nextId:"EXIT"}]}}},{id:"munk",name:"Broder Johannes",role:"Lrd Skrivermunk",description:"Fingrene hans er flekkete av blekk. Han myser, som om han er vant til  lese i drlig lys, og snakker lavmelt.",conversation:{start:{text:"Hysj. Hrer du stillheten? Nei, selvsagt ikke. Her er det sty. I skriptoriet hrer man bare fjrpennens skraping mot pergamentet. Guds ord som festes til huden.",options:[{label:"Hva skriver du?",nextId:"write"},{label:"Er du ikke ensom?",nextId:"lonely"},{label:"Jeg lar deg vre i fred. (G)",nextId:"EXIT"}]},write:{text:'Akkurat n? En kopi av "Kongespeilet"  *Konungs skuggsj*. En lrebok for prinser. Den forteller om hflighet, handel, stjernene og Guds orden. En klok konge m vre lrd, ikke bare sterk.',options:[{label:"Er bker dyre?",nextId:"expensive"},{label:"Hvem leser disse?",nextId:"readers"}]},expensive:{text:"Ufattelig. Et stort bibelverk krever skinnet fra 300 kalver! Tenk p flokken... og arbeidet.  forberede skinnet, blande blekket, male initialene med bladgull. En bok kan koste mer enn en grd.",options:[{label:"En skatt alts.",nextId:"start"}]},readers:{text:"De geistlige, kongen, og noen f adelige. Men kunnskapen risler nedover. Det vi bevarer i bibliotekene, er verdens hukommelse. Uten oss ville historien forsvinne i mrket.",options:[{label:"Et viktig ansvar.",nextId:"start"}]},lonely:{text:"Aldri. Jeg er omgitt av apostler, helgener og kirkefedrene. Augustin, Thomas Aquinas... de taler til meg gjennom sidene. Og brdrene i klosteret er min familie. Vi ber sammen, arbeider sammen.",options:[{label:"Ora et labora?",nextId:"rule"},{label:"Hres fredelig ut.",nextId:"start"}]},rule:{text:"Be og arbeid. Ja. Det er St. Benedikts regel. Lediggang er fienden av sjelen. S vi dyrker urter, brygger l (som dette, Guds gave!), og kopierer bker.",options:[{label:"Skl for let.",nextId:"EXIT"}]}}},{id:"pestlege",name:"Doktor Pestus",role:"Pestlege",description:"Han sitter litt for seg selv. En merkelig maske med nebb henger rundt halsen hans, og han lukter sterkt av eddik og trkede blomster.",conversation:{start:{text:"Ikke kom for nr! Balansen i vskene dine ser... urolig ut. Er du sangvinsk? Eller melankolsk? Luften her er tykk av miasma.",options:[{label:"Miasma?",nextId:"miasma"},{label:"Hva er masken til?",nextId:"mask"},{label:"Jeg er frisk! (G)",nextId:"EXIT"}]},miasma:{text:"Drlig luft! Sykdom kommer av rtten luft som stiger opp fra jorden eller fra syke kropper. Den forstyrrer balansen i kroppen  blod, slim, gul og svart galle. Pesten... den er den verste ubalansen.",options:[{label:"Svartedauden?",nextId:"plague"},{label:"Hvordan kurerer man det?",nextId:"cure"}]},plague:{text:"Den store dden. Den kom med et skip til Bergen i 1349. Jeg s hele landsbyer tmmes. Prester dde mens de ga den siste olje. Det var som om Gud hadde forlatt oss. De som overlevde... vi er merket.",options:[{label:"Forferdelig.",nextId:"social"}]},social:{text:"Men se rundt deg! De frre vi er, jo mer verdt er hver mann. Bndene krever bedre lnn n. Tjenestepikene gr med silke. Verden er snudd p hodet etter pesten.",options:[{label:"En ny tid.",nextId:"start"}]},mask:{text:"Nebbet fylles med urter. Nellik, roser, mynte. Sterk lukt motvirker den drlige luften. Det er som et filter mot dden selv. Og kappen er innsatt med voks s pestloppene glir av.",options:[{label:"Smart oppfinnelse.",nextId:"cure"}]},cure:{text:'relating for  fjerne ondt blod. Kopping. Og Theriak  en blanding av over 60 ingredienser, inkludert ormekjtt og opium. Det beste rdet? "Cito, longe, tarde." Dra fort, dra langt, kom sent tilbake.',options:[{label:"Skal huske det.",nextId:"EXIT"}]}}},{id:"birkebeiner",name:"Gunnar",role:"Birkebeiner-opprrer",description:"En hardfr mann med slitte klr, men sverdet ved beltet er velstelt. Han ser mistenksomt mot dren hver gang den pnes.",conversation:{start:{text:"Hvem holder du med? Kongen eller Kirken? Baglerne eller Birkebeinerne? Svar fort, fr let blir varmt.",options:[{label:"Birkebeinerne!",nextId:"birkebeiner"},{label:"Jeg blander meg ikke.",nextId:"neutral"},{label:"Baglerne?",nextId:"bagler"},{label:"Ingen. (G)",nextId:"EXIT"}]},birkebeiner:{text:"Godt svar! Vi er kong Sverres menn. Mange av oss startet med ingenting, med never rundt leggene i snen. Men vi kjemper for norges rettmessige konge mot biskopenes tyranni!",options:[{label:"Hvorfor hater dere biskopene?",nextId:"church"},{label:"Fortell om Kong Sverre.",nextId:"sverre"}]},bagler:{text:"*Han spytter p gulvet* Kirkens lpegutter. De vil at paven i Roma skal styre Norge, ikke kongen. Pass deg, ellers tror jeg du er en spion.",options:[{label:"Jeg mente det ikke snn.",nextId:"start"}]},neutral:{text:"Ingen kan vre nytrale i borgerkrig. Nr bror dreper bror, m man velge side. Men kanskje det er klokest  holde kjeft, ja.",options:[{label:"Nettopp.",nextId:"start"}]},church:{text:'Erkebiskopen vil ha makt. Han nekter  krone Sverre! Han lyste ham i bann! Men Sverre talte Roma midt imot. "En tale mot biskopene", kalte han det. Han sa at kirken er rtten, og at kongen er innsatt av Gud, ikke av Paven.',options:[{label:"Sterke ord.",nextId:"start"}]},sverre:{text:"En prest fra Fryene som ble konge! Han er liten av vekst, men en kjempe i klkt. Han lrte oss  slss p en ny mte. Ikke bare storme frem, men bruke terrenget, sl til og forsvinne. Gerilja, kaller de det visst i sr.",options:[{label:"En taktiker.",nextId:"EXIT"}]}}},{id:"kone",name:"Ragnhild",role:"Klok Kone",description:"En eldre kvinne med grtt hr flettet med fargerike bnd. Hun har en kurv full av trkede planter og rtter p bordet.",conversation:{start:{text:"Har du en plage, ungen min? En verkebyll? Kjrlighetssorg? Eller kanskje kua di har sluttet  melke? Naturen har en bot for alt, hvis man vet hvor man skal lete.",options:[{label:"Er du en heks?",nextId:"witch"},{label:"Har du noe mot sr?",nextId:"herbs"},{label:"Jeg tror p bnner. (G)",nextId:"EXIT"}]},witch:{text:"Hysj! Ikke bruk det ordet. Prestene brenner folk for mindre. Jeg er en hjelper. Jeg bruker bare Guds skaperverk. Er det trolldom  vite at groblad stanser bldning? Nei, det er kunnskap.",options:[{label:"Unnskyld.",nextId:"signs"},{label:"Hva med magi?",nextId:"magic"}]},herbs:{text:"Groblad for sr. Ryllik for feber. Og johannesurt for de tunge tankene som kommer om vinteren. Og honning... honning er bra for alt. Det holder betennelsen borte.",options:[{label:"Nyttig  vite.",nextId:"start"}]},signs:{text:"Man m lese tegnene. Hvis rogna brer mye br, blir vinteren sntung. Hvis krka skriker mot nord, kommer det gjester. Det er ikke magi, det er  lytte til verden.",options:[{label:"Klokt.",nextId:"start"}]},magic:{text:"*Hun lener seg frem* Det finnes krefter... de underjordiske. Nissen p lven, Huldra i skogen. Man m vise dem respekt. Ofre litt grt, litt l. Kirken liker det ikke, men bonden vet at det er best  holde seg inne med dem.",options:[{label:"Best  vre forsiktig.",nextId:"EXIT"}]}}},{id:"skald",name:"Einar Skald",role:"Hoff-poet",description:"Han sitter med lukkede yne og trommer rytmisk p bordet. Plutselig slr han ut med hnden og deklamerer en strofe.",conversation:{start:{text:'"Sverdets sang, blodets brang, ravnens fang..." Nei, nei. Det mangler bokstavrim. En god drpa skal vre som et vevd teppe, hver ord skal lse det neste.',options:[{label:"Hva er en drpa?",nextId:"drapa"},{label:"Fortell en saga!",nextId:"saga"},{label:"Du virker intens. (G)",nextId:"EXIT"}]},drapa:{text:'Det ypperste av kvad! Et hyllingsdikt til en fyrste eller konge. Det m ha "stef"  et omkved som gjentas. Hvis jeg gjr en feil i versefoten foran Jarlen, kan jeg miste hodet. Eller verre, miste min re.',options:[{label:"Hres vanskelig ut.",nextId:"oral"},{label:"Hva er versefot?",nextId:"poetry"}]},saga:{text:'Ah, historiene. Ikke bare dikt, men sannheten om vre forfedre. Som historien om Egil Skallagrimsson... kriger og poet. Han reddet sitt eget liv ved  dikte "Hodelsningen" til Eirik Blodks. Ord er makt, min venn.',options:[{label:"Fortell om Egil.",nextId:"egil"}]},egil:{text:"Han var stygg som juling, men sterk som en bjrn. Og han kunne drepe med et sverd i n hnd og dikte med den andre. En gang spydde han over en hirdmann som prvde  fornrme ham! En ekte helt.",options:[{label:"Fargerik type.",nextId:"start"}]},oral:{text:"Vi brer historien i hodet. Bker kan brenne, men et godt kvede lever p folkemunne i tusen r. Det er min oppgave.  srge for at kongens bedrifter aldri glemmes. Jeg er levende historie.",options:[{label:"Imponerende hukommelse.",nextId:"start"}]},poetry:{text:'Det er regler! Fornyrdislag, Ljogahtt... du m bruke "Kenninger". Du sier ikke "sverd", du sier "sr-isl". Du sier ikke "blod", du sier "sverd-vann". Det gjr sprket rikt og gtefullt.',options:[{label:"Vakkert sprk.",nextId:"EXIT"}]}}}];function bG(t,e,n){const{setActiveTab:s,setProductionContext:i,viewMode:r,setViewMode:a,viewingRegionId:o,setViewingRegionId:c,activeTab:u}=gf(),d=o||t.regionId||"capital",[f,h]=_.useState(null),[m,g]=_.useState(null),[b,x]=_.useState(null),[p,v]=_.useState(null),[y,E]=_.useState("start"),[N,T]=_.useState(!1),[w,A]=_.useState(!1),[k,R]=_.useState(!1),C=_.useCallback(O=>{if(O==="kingdom")return 0;if(O==="global")return 1;const j=cr.find(I=>I.id===O);return j!=null&&j.parentId?3:2},[]),[B,z]=_.useState(r),[$,K]=_.useState("in");if(r!==B){const O=C(B),j=C(r);j>O?K("in"):j<O&&K("out"),z(r)}_.useEffect(()=>{const O=j=>{if(j.key==="Escape"){if(u!=="MAP")return;if(b){x(null);return}if(N){T(!1);return}if(w){A(!1);return}if(p){v(null);return}if(m){g(null);return}if(f){h(null);return}if(r!=="kingdom"){const I=cr.find(X=>X.id===r),H=I!=null&&I.parentId?cr.find(X=>X.id===I.parentId):null;a(r==="global"?"kingdom":H?H.id:"global")}}};return window.addEventListener("keydown",O),()=>window.removeEventListener("keydown",O)},[r,b,N,w,p,m,f,a,u]);const U=_.useCallback((O,j)=>{const I=typeof j=="string"?j:j.type||j.id,H=V=>V==="windmill_stones"?{buildingId:"windmill",type:"REFINE"}:V==="sawmill_blade"?{buildingId:"sawmill",type:"REFINE"}:V==="smeltery_furnace"?{buildingId:"smeltery",type:"REFINE"}:V==="bakery_oven"?{buildingId:"bakery",type:"REFINE"}:V==="weavery_loom"?{buildingId:"weavery",type:"REFINE"}:V==="forge_anvil"?{buildingId:"great_forge",type:"CRAFT"}:V==="apothecary_bench"?{buildingId:"apothecary",type:"CRAFT"}:null;if(I==="OPEN_CHICKEN_COOP"){A(!0),h(null);return}if(I==="OPEN_GARRISON"){i({buildingId:"watchtower",type:"CRAFT",initialView:"PRODUCE"}),s("PRODUCTION"),h(null);return}if(I==="OPEN_CONSTRUCTION"){R(!0),h(null);return}const X=H(O);if(X&&(I==="OPEN_CRAFTING"||I==="CRAFT"||I==="REFINE"||I.startsWith("REFINE_")||I.startsWith("CRAFT_")||Rn[I]||I==="REPAIR")){i({...X,initialView:I==="REPAIR"?"REPAIR":"PRODUCE"}),s("PRODUCTION"),h(null);return}const oe=d===t.regionId,Ie=t.role==="KING";if(!oe&&!Ie&&I!=="MARKET_VIEW"){alert("Du har ingen myndighet i dette baroniet.");return}if(I==="MARKET_VIEW")n();else if(I.startsWith("REFINE_")){const V=I.replace("REFINE_","").split("_")[0].toLowerCase();e({type:"REFINE",recipeId:{plank:"plank",flour:"flour",iron:"iron_ingot",steel:"iron_ingot",cloth:"cloth"}[V]||V})}else if(I.startsWith("CRAFT_")){const V=I.replace("CRAFT_","").toLowerCase();e(V==="bread"||V==="pie"||V==="mead"?{type:"REFINE",recipeId:V}:{type:"CRAFT",subType:V})}else if(I in Rn)e({type:"CRAFT",subType:I});else if(I.startsWith("BUILDING_UPGRADE_")){const V=I.replace("BUILDING_UPGRADE_","");x(V)}else if(I==="OPEN_DICE_GAME")T(!0);else if(I==="CHAT_LOCAL"){const V=U_[Math.floor(Math.random()*U_.length)];v(V),E("start")}else e(I==="BUY_MEAL"?{type:"BUY_MEAL"}:j);h(null)},[d,t,e,n,s,i,h]);return{viewMode:r,setViewMode:a,viewingRegionId:d,setViewingRegionId:c,selectedPOI:f,setSelectedPOI:h,selectedEvent:m,setSelectedEvent:g,upgradingBuildingId:b,setUpgradingBuildingId:x,dialogNPC:p,setDialogNPC:v,dialogStep:y,setDialogStep:E,isDiceGameOpen:N,setIsDiceGameOpen:T,isChickenCoopOpen:w,setIsChickenCoopOpen:A,isConstructionOpen:k,setIsConstructionOpen:R,direction:$,handlePOIAction:U}}const xG=({playerGold:t,onClose:e,onPlay:n})=>{const[s,i]=_.useState(1),[r,a]=_.useState(!1),[o,c]=_.useState([1,1]),[u,d]=_.useState([1,1]),[f,h]=_.useState("Plasser din innsats..."),[m,g]=_.useState(t);we.useEffect(()=>{g(t)},[t]);const b=()=>Math.floor(Math.random()*6)+1,x=()=>{if(r)return;if(s>t){h("Du har ikke nok gull!");return}if(s<.5){h("Minstesats er 0.5g");return}a(!0),h("Terningene ruller...");let y=0;const E=10,N=setInterval(()=>{c([b(),b()]),d([b(),b()]),y++,y>=E&&(clearInterval(N),p())},100)},p=()=>{const y=b(),E=b(),N=b(),T=b(),w=y+E,A=N+T;c([y,E]),d([N,T]);const k=w>A;k?(h(`DU VANT! ${w} mot ${A}`),g(R=>R+s)):(h(`HUSET VANT. ${A} mot ${w}`),g(R=>Math.max(0,R-s))),n({amount:s,isWin:k,playerRoll:w,houseRoll:A}),a(!1)},v=(y,E)=>l.jsx("div",{className:`w-16 h-16 rounded-xl shadow-[inset_0_0_10px_rgba(0,0,0,0.5)] flex bg-gradient-to-br ${E==="player"?"from-white to-slate-200 text-black":"from-red-600 to-red-800 text-white"} relative transition-transform duration-100 ${r?"animate-bounce":""}`,children:l.jsx("div",{className:"grid grid-cols-3 grid-rows-3 w-full h-full p-2 gap-1",children:[...Array(9)].map((N,T)=>{let w=!1;return y===1&&T===4&&(w=!0),y===2&&(T===0||T===8)&&(w=!0),y===3&&(T===0||T===4||T===8)&&(w=!0),y===4&&(T===0||T===2||T===6||T===8)&&(w=!0),y===5&&(T===0||T===2||T===4||T===6||T===8)&&(w=!0),y===6&&(T===0||T===2||T===3||T===5||T===6||T===8)&&(w=!0),l.jsx("div",{className:"flex items-center justify-center",children:w&&l.jsx("div",{className:`w-3 h-3 rounded-full ${E==="player"?"bg-black":"bg-white"} shadow-sm`})},T)})})});return l.jsxs("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/90 backdrop-blur-sm animate-in fade-in duration-500",children:[l.jsxs("div",{className:"absolute inset-0 z-0 opacity-50",children:[l.jsx("img",{src:"/Simulation_StandAlone_Pro/poi/tavern_dice_bg.png",alt:"Tavern Table",className:"w-full h-full object-cover"}),l.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-transparent to-black"})]}),l.jsxs("div",{className:"relative z-10 bg-[#1a472a]/90 border-[4px] border-[#5d4037] rounded-[2rem] shadow-[0_50px_100px_rgba(0,0,0,0.8)] w-full max-w-2xl overflow-hidden backdrop-blur-md",children:[l.jsx("div",{className:"absolute inset-0 border-2 border-[#8d6e63] rounded-[1.2rem] pointer-events-none opacity-50"}),l.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-[#d7ccc8] hover:text-white transition-colors bg-black/20 hover:bg-black/40 rounded-full w-8 h-8 flex items-center justify-center font-bold z-50",children:""}),l.jsxs("div",{className:"p-8 flex flex-col items-center gap-8 relative",children:[l.jsxs("div",{className:"text-center space-y-1",children:[l.jsx("h2",{className:"text-3xl font-black text-[#ffecb3] uppercase tracking-widest drop-shadow-md",style:{fontFamily:"serif"},children:"Spillebordet"}),l.jsx("div",{className:"text-[#a5d6a7] font-bold tracking-wider text-sm",children:"Huset vinner ved uavgjort"}),l.jsx("div",{className:"text-xs text-white/50 uppercase tracking-widest font-black",children:"Lykke til!"})]}),l.jsxs("div",{className:"flex justify-between w-full px-8 gap-8",children:[l.jsxs("div",{className:"flex flex-col items-center gap-4",children:[l.jsxs("span",{className:"text-[#90caf9] font-black uppercase tracking-widest text-xs",children:["Deg (",o[0]+o[1],")"]}),l.jsxs("div",{className:"flex gap-3",children:[v(o[0],"player"),v(o[1],"player")]})]}),l.jsx("div",{className:"flex items-center justify-center",children:l.jsx("span",{className:"text-2xl font-black text-white/20",children:"VS"})}),l.jsxs("div",{className:"flex flex-col items-center gap-4",children:[l.jsxs("span",{className:"text-[#ef9a9a] font-black uppercase tracking-widest text-xs",children:["Huset (",u[0]+u[1],")"]}),l.jsxs("div",{className:"flex gap-3",children:[v(u[0],"house"),v(u[1],"house")]})]})]}),l.jsx("div",{className:`h-12 flex items-center justify-center w-full bg-black/30 rounded-xl border border-white/5 transition-all ${f.includes("VANT")?"bg-green-900/40 border-green-500/30":f.includes("tapte")?"bg-red-900/40 border-red-500/30":""}`,children:l.jsx("span",{className:"font-bold text-lg text-[#fff8e1] tracking-wide",children:f})}),l.jsxs("div",{className:"w-full bg-black/20 p-6 rounded-2xl border border-white/5 flex flex-col gap-4",children:[l.jsxs("div",{className:"flex justify-between items-center text-[#d7ccc8] font-bold text-sm uppercase tracking-widest",children:[l.jsx("span",{children:"Innsats"}),l.jsxs("span",{children:["Din Saldo: ",l.jsxs("span",{className:"text-[#ffd54f]",children:[m.toFixed(1),"g"]})]})]}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("input",{type:"range",min:.5,max:Math.min(t,100),step:.5,value:s,onChange:y=>i(parseFloat(y.target.value)),className:"w-full h-3 bg-black/50 rounded-lg appearance-none cursor-pointer accent-[#ffb74d]",disabled:r}),l.jsxs("div",{className:"bg-black/40 px-4 py-2 rounded-xl text-[#ffd54f] font-black min-w-[5rem] text-center border border-white/10",children:[s,"g"]})]}),l.jsx("div",{className:"grid grid-cols-4 gap-2",children:[1,5,10,50].map(y=>l.jsxs("button",{onClick:()=>i(y),disabled:y>t||r,className:`py-1 rounded-lg text-xs font-bold uppercase tracking-widest transition-colors ${s===y?"bg-[#ffb74d] text-black":"bg-white/5 text-[#d7ccc8] hover:bg-white/10"}`,children:[y,"g"]},y))}),l.jsx("button",{onClick:x,disabled:r||t<s,className:`w-full py-4 rounded-xl font-black uppercase tracking-widest text-lg shadow-lg transform transition-all active:scale-[0.98] ${r?"bg-gray-600 cursor-not-allowed opacity-50":"bg-gradient-to-r from-[#ffca28] to-[#ff6f00] text-black hover:brightness-110 shadow-orange-900/40"}`,children:r?"Ruller...":"KAST TERNINGENE!"})]})]})]})]})};class yG{constructor(){ze(this,"listeners",[])}subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(n=>n!==e)}}emit(e){this.listeners.forEach(n=>n(e))}spawnFloatingText(e,n,s,i){const r=(Math.random()-.5)*4,a=(Math.random()-.5)*4;this.emit({id:Math.random().toString(36).substr(2,9),type:"FLOATING_TEXT",text:e,x:n+r,y:s+a,color:i,duration:1500})}spawnFlyingResource(e,n,s,i,r){this.emit({id:Math.random().toString(36).substr(2,9),type:"FLYING_RESOURCE",resource:e,startPoint:{x:n,y:s},endPoint:{x:i,y:r},duration:1e3})}spawnParticles(e,n,s){this.emit({id:Math.random().toString(36).substr(2,9),type:"PARTICLE",x:e,y:n,color:s,duration:800})}}const Ge=new yG,_G=({onComplete:t})=>{const[e,n]=_.useState([]),[s,i]=_.useState(!1),r=20,a=o=>{if(s)return;const c=o.currentTarget.getBoundingClientRect(),u=(o.clientX-c.left)/c.width*100,d=(o.clientY-c.top)/c.height*100,f={x:u,y:d,id:Date.now()};Ge.spawnParticles(u,d,"bg-emerald-400"),n(h=>{const m=[...h,f];return m.length>=r&&(i(!0),setTimeout(()=>t(1),1500)),m})};return l.jsxs("div",{onClick:a,className:"w-full h-[600px] relative overflow-hidden cursor-crosshair group active:scale-[0.99] transition-transform select-none",style:{backgroundImage:'url("/images/minigames/agriculture_bg.png")',backgroundSize:"cover",backgroundPosition:"center"},children:[l.jsx("div",{className:"absolute inset-0 bg-black/40 z-0 pointer-events-none"}),l.jsx("div",{className:"absolute top-10 left-1/2 -translate-x-1/2 pointer-events-none z-20 text-center",children:s?l.jsx("div",{className:"animate-in zoom-in duration-300",children:l.jsx("h2",{className:"text-5xl font-black text-emerald-400 drop-shadow-[0_4px_0_rgba(0,0,0,0.5)] uppercase tracking-tighter animate-bounce",children:"Mestrerlig Sdd! "})}):l.jsxs(l.Fragment,{children:[l.jsx("h2",{className:"text-3xl font-black text-white drop-shadow-md mb-2",children:"S dine fr"}),l.jsxs("div",{className:"bg-black/40 px-4 py-1 rounded-full text-emerald-400 font-bold uppercase tracking-widest text-sm inline-block",children:[e.length," / ",r]})]})}),e.map(o=>l.jsx("div",{className:"absolute w-4 h-4 bg-emerald-400 rounded-full shadow-[0_0_10px_rgba(52,211,153,0.8)] animate-in zoom-in duration-300",style:{left:`${o.x}%`,top:`${o.y}%`,transform:"translate(-50%, -50%)"},children:l.jsx("div",{className:"absolute -top-4 left-1/2 -translate-x-1/2 w-0.5 h-3 bg-white/50"})},o.id)),l.jsx("div",{className:"absolute inset-0 pointer-events-none z-10 hidden group-hover:block",children:l.jsx("div",{className:"absolute w-8 h-8 border-2 border-white/50 rounded-full -translate-x-1/2 -translate-y-1/2"})})]})},wG=(t,e)=>{if(e)return e.find(n=>{var r;if(!n)return!1;const s=Object.keys(Te).find(a=>n.id===a||n.id.startsWith(a+"_")),i=s?Te[s]:null;return(r=i==null?void 0:i.relevantActions)==null?void 0:r.includes(t)})},Kc=({onComplete:t,equipment:e=[],isMining:n,isQuarrying:s,isForaging:i,speedMultiplier:r=1,possibleYield:a=10,resourceName:o="Ressurs"})=>{const[c,u]=_.useState(0),[d,f]=_.useState([]),[h,m]=_.useState(!1),[g,b]=_.useState(!1),[x,p]=_.useState(!1),v=_.useRef(1),[y,E]=_.useState(50),N=_.useRef(1);_.useEffect(()=>{const A=k=>{k.code==="Space"&&(k.preventDefault(),T())};return window.addEventListener("keydown",A),()=>window.removeEventListener("keydown",A)},[d,h,c,y,e,r,x]),_.useEffect(()=>{if(d.length>=5||h||x)return;const A=setInterval(()=>{u(k=>{let R=2/r,C=k+R*v.current;return C>100?(v.current=-1,100):C<0?(v.current=1,0):C}),E(k=>{let C=k+.3*N.current;return Math.random()<.02&&(N.current*=-1),C>80?(N.current=-1,80):C<20?(N.current=1,20):C})},16);return()=>clearInterval(A)},[d.length,h,r,x]);const T=()=>{var U;if(d.length>=5||h||x)return;const A=Math.abs(c-y);let k=A<5?1:A<15?.7:A<25?.4:.1;const C=wG(n?"MINE":s?"QUARRY":i?"FORAGE":"WORK",e),B=((U=C==null?void 0:C.stats)==null?void 0:U.yieldBonus)||0,z=Math.ceil(a/5*(.5+k)),$=Math.ceil(B/5*(.5+k));A<15?(b(!0),p(!0),Ge.spawnParticles(50,40,A<5?"bg-amber-400":"bg-white"),A<5?Ge.spawnFloatingText(`PERFEKT! + ${z} ${$>0?`(+${$})`:""} `,50,40,"text-amber-400 font-black text-2xl"):Ge.spawnFloatingText(`Bra! +${z}`,50,40,"text-white font-bold"),setTimeout(()=>{b(!1),p(!1)},100)):Ge.spawnFloatingText("Svakt...",50,40,"text-slate-500 font-bold");const K=[...d,k];f(K),K.length===5&&(m(!0),setTimeout(()=>t(K.reduce((O,j)=>O+j,0)/5),800))},w=n||s?'url("/images/minigames/mining_bg.png")':i?'url("/images/minigames/foraging_bg.png")':'url("/images/minigames/agriculture_bg.png")';return l.jsxs("div",{className:`p-8 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden ${g?"animate-shake":""} `,style:{backgroundImage:w,backgroundSize:"cover",backgroundPosition:"center"},children:[l.jsx("div",{className:`absolute inset-0 bg-black/70 z-0 transition-all duration-75 ${x?"bg-indigo-900/50 mix-blend-hard-light":""}`}),l.jsxs("div",{className:`relative z-10 w-full flex flex-col items-center transition-all duration-75 ${x?"scale-105 brightness-150 contrast-125":""}`,children:[l.jsx("h2",{className:"text-4xl font-black text-white mb-8 drop-shadow-lg tracking-tighter uppercase",children:n?"Gruvedrift":s?"Steinhugger":i?"Sanking":"Kornhsting"}),h?l.jsx("div",{className:"py-12 animate-bounce text-5xl font-black text-amber-500 uppercase tracking-tighter drop-shadow-[0_0_20px_rgba(245,158,11,0.5)]",children:"FERDIG! "}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"mb-4 text-xs font-black text-amber-500 uppercase tracking-widest",children:o}),l.jsxs("div",{className:"w-full h-8 bg-white/5 rounded-full mb-12 relative border border-white/10 overflow-hidden shadow-inner",children:[l.jsx("div",{className:"absolute inset-y-0 bg-amber-500/30 border-x border-amber-500/50 transition-all duration-75 linear",style:{left:`${y-8}%`,right:`${100-(y+8)}%`}}),l.jsx("div",{className:"absolute inset-y-0 w-0.5 bg-amber-400/80 z-0",style:{left:`${y}%`}}),l.jsx("div",{className:"absolute inset-y-0 w-1 bg-white shadow-[0_0_20px_white] z-10",style:{left:`${c}% `}})]}),l.jsx("button",{onClick:T,className:`w-full bg-amber-500 hover:bg-amber-400 text-slate-950 py-7 rounded-[2rem] font-black text-2xl shadow-2xl transition-all uppercase tracking-widest border-b-4 border-amber-700 ${x?"scale-95 brightness-125":"active:scale-95"}`,children:"KLIKK N! "})]})]})]})},EG=({onComplete:t,speedMultiplier:e=1})=>{const[n,s]=_.useState(50),[i,r]=_.useState(50),[a,o]=_.useState(0),[c,u]=_.useState(!1),[d,f]=_.useState(!1),[h,m]=_.useState(!1),g=_.useRef(1);_.useEffect(()=>{if(c||h)return;const x=setInterval(()=>{s(p=>{let v=p+.8*g.current*e;return v>90?(g.current=-1,90):v<10?(g.current=1,10):v})},16);return()=>clearInterval(x)},[c,e,h]),_.useEffect(()=>{const x=p=>{p.code==="Space"&&(p.preventDefault(),b({clientX:window.innerWidth/2,clientY:window.innerHeight/2}))};return window.addEventListener("keydown",x),()=>window.removeEventListener("keydown",x)},[c,i,n,h]);const b=x=>{if(c||h)return;const p=Math.abs(i-n),v=x.clientX,y=x.clientY;p<12?(f(!0),m(!0),o(E=>{const N=E+1;return N>=5&&(u(!0),Ge.spawnFloatingText("MESTERVERK! ",v,y-60,"text-amber-400 text-3xl font-black"),setTimeout(()=>t(1),1200)),N}),Ge.spawnParticles(v,y,"bg-amber-400"),Ge.spawnFloatingText("KLANG!",v,y-40,"text-amber-500 font-black"),setTimeout(()=>{f(!1),m(!1)},100)):p<25?(Ge.spawnFloatingText("Treff",v,y-40,"text-white font-bold"),Ge.spawnParticles(v,y,"bg-white")):Ge.spawnFloatingText("BOM!",v,y-40,"text-slate-500 font-bold")};return l.jsxs("div",{onMouseMove:x=>{const p=x.currentTarget.getBoundingClientRect();r((x.clientX-p.left)/p.width*100)},onClick:b,className:`p-12 min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden cursor-crosshair ${d?"animate-shake":""}`,style:{backgroundImage:'url("/images/minigames/smithing_bg.png")',backgroundSize:"cover"},children:[l.jsx("div",{className:`absolute inset-0 bg-black/70 z-0 transition-all duration-75 ${h?"bg-amber-900/40 mix-blend-hard-light":""}`}),l.jsxs("div",{className:`relative z-10 text-center mb-12 transition-all duration-75 ${h?"scale-105 brightness-150 contrast-125":""}`,children:[l.jsx("h2",{className:"text-4xl font-black text-white uppercase tracking-tighter drop-shadow-xl",children:"Smedarbeid"}),l.jsxs("div",{className:"text-amber-500 font-black uppercase tracking-widest text-xs mt-2 bg-black/40 px-4 py-1 rounded-full border border-amber-500/20",children:["Slag: ",a," / 5"]})]}),l.jsxs("div",{className:`relative z-10 w-full max-w-2xl space-y-4 transition-all duration-75 ${h?"scale-105":""}`,children:[l.jsxs("div",{className:"w-full h-24 bg-slate-900/50 rounded-2xl border-2 border-white/10 shadow-2xl flex items-center px-4 overflow-hidden",children:[l.jsx("div",{className:"absolute inset-0 bg-amber-500/5 transition-all duration-1000",style:{opacity:a/5}}),l.jsxs("div",{className:"relative w-full h-4 bg-white/5 rounded-full overflow-hidden",children:[l.jsx("div",{className:"absolute inset-y-0 w-24 bg-amber-500/40 blur-sm mix-blend-screen transition-all duration-75",style:{left:`${n}%`,transform:"translateX(-50%)"}}),l.jsx("div",{className:"absolute inset-y-0 w-12 bg-white/40 blur-[2px]",style:{left:`${n}%`,transform:"translateX(-50%)"}}),l.jsx("div",{className:"absolute inset-y-0 w-1 bg-white shadow-[0_0_15px_white] z-20",style:{left:`${i}%`,transform:"translateX(-50%)"}})]})]}),l.jsxs("div",{className:"flex items-center gap-4 px-2",children:[l.jsx("div",{className:"flex-1 h-2 bg-black/40 rounded-full overflow-hidden border border-white/5",children:l.jsx("div",{className:"h-full bg-gradient-to-r from-amber-600 to-amber-400 transition-all duration-500",style:{width:`${a/5*100}%`}})}),l.jsxs("span",{className:"text-[10px] font-black text-amber-500 uppercase tracking-widest",children:[Math.round(a/5*100),"%"]})]})]}),c&&l.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm animate-in fade-in zoom-in duration-300",children:l.jsx("div",{className:"text-6xl font-black text-amber-500 animate-bounce drop-shadow-[0_0_30px_rgba(245,158,11,0.5)]",children:"FERDIG! "})}),l.jsx("div",{className:`mt-12 text-slate-400 text-sm font-bold uppercase tracking-widest animate-pulse relative z-10 transition-opacity ${h?"opacity-0":"opacity-100"}`,children:"Klikk nr markren er over den gldende sonen"})]})},NG=({onComplete:t,speedMultiplier:e=1,icon:n=""})=>{const[s,i]=_.useState(0),[r,a]=_.useState(!1),[o,c]=_.useState(null),[u,d]=_.useState(0),[f,h]=_.useState(80),m=_.useRef(-1);_.useEffect(()=>{if(r||o)return;const b=setInterval(()=>{i(p=>{const v=p+1*e;return v>=100?(c("BRENT! "),setTimeout(()=>{c(null),i(0)},1e3),0):v})},50),x=setInterval(()=>{h(p=>{let y=p+.8*m.current;return y>90?(m.current=-1,90):y<40?(m.current=1,40):y})},50);return()=>{clearInterval(b),clearInterval(x)}},[r,o,e]),_.useEffect(()=>{const b=x=>{x.code==="Space"&&(x.preventDefault(),g())};return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[r,o,s,f]);const g=()=>{if(r||o)return;const b=f-10,x=f+10;s>b&&s<x?(c("PERFEKT GYLLEN! "),d(p=>{const v=p+1;return v>=3&&(a(!0),setTimeout(()=>t(1),1e3)),v})):s<b?c("R... "):c("LITT BRENT... "),setTimeout(()=>{c(null),i(0)},1e3)};return l.jsxs("div",{className:"p-12 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden",style:{backgroundImage:'url("/images/minigames/bakery_bg.png")',backgroundSize:"cover"},children:[l.jsx("div",{className:"absolute inset-0 bg-black/70 z-0"}),l.jsx("h2",{className:"relative z-10 text-4xl font-black text-white mb-8 tracking-tighter uppercase italic",children:"Bakeri: Steking "}),l.jsxs("div",{className:"relative z-10 w-64 h-64 bg-slate-900 border-8 border-amber-900 rounded-3xl flex items-center justify-center overflow-hidden mb-12 shadow-2xl",children:[l.jsx("div",{className:"absolute inset-0 bg-orange-500/10 animate-pulse"}),l.jsx("div",{className:"text-8xl transition-all duration-300 transform",style:{filter:`grayscale(${100-s}%) sepia(${s}%)`,transform:`scale(${.8+s/500})`},children:n}),o&&l.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center text-white font-black text-2xl p-4 animate-in zoom-in",children:o})]}),l.jsxs("div",{className:`relative z-10 w-full max-w-sm h-8 bg-white/10 rounded-full mb-12 border ${s>f-10&&s<f+10?"border-emerald-500 shadow-[0_0_15px_rgba(16,185,129,0.5)]":"border-white/10"} overflow-hidden transition-all shadow-2xl`,children:[l.jsx("div",{className:"absolute inset-y-0 bg-emerald-500/30 border-x border-emerald-500/50 transition-all duration-75 ease-linear",style:{left:`${f-10}%`,right:`${100-(f+10)}%`},children:s>f-10&&s<f+10&&l.jsx("div",{className:"absolute inset-0 bg-emerald-400/20 animate-pulse"})}),l.jsx("div",{className:"h-full bg-orange-500 transition-all duration-75 relative z-10 opacity-80",style:{width:`${s}% `}}),l.jsx("div",{className:"absolute top-0 bottom-0 w-1 bg-white/50 z-20",style:{left:`${f}%`}})]}),l.jsx("div",{className:"relative z-10 flex gap-4 mb-8",children:[...Array(3)].map((b,x)=>l.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center text-2xl border-2 transition-all ${u>x?"bg-amber-500 border-amber-300 scale-110 shadow-lg":"bg-white/5 border-white/10 opacity-30"} `,children:n},x))}),l.jsx("button",{onClick:g,className:"relative z-10 w-full max-w-sm bg-amber-600 hover:bg-amber-500 text-white py-6 rounded-2xl font-black text-2xl shadow-xl active:scale-95 transition-all uppercase tracking-widest border-b-8 border-amber-800",children:"TA UT N! "})]})},kG=(t,e)=>{if(e)return e.find(n=>{var r;if(!n)return!1;const s=Object.keys(Te).find(a=>n.id===a||n.id.startsWith(a+"_")),i=s?Te[s]:null;return(r=i==null?void 0:i.relevantActions)==null?void 0:r.includes(t)})},SG=({onComplete:t,equipment:e=[]})=>{const[n,s]=_.useState(0),[i,r]=_.useState(!1),[a,o]=_.useState(!1),[c,u]=_.useState(0),[d,f]=_.useState({x:50,y:50}),[h,m]=_.useState(!1),g=()=>f({x:20+Math.random()*60,y:20+Math.random()*60}),b=p=>{if(a)return;o(!0),r(!0);const v=n+1;s(v);const y=v>5,E=v>2?`${v}x COMBO!`:y?"FLAWLESS!":"TREFF!",N=y?"text-amber-400 font-display":"text-white";Ge.spawnFloatingText(E,p.clientX,p.clientY-40,N),Ge.spawnParticles(p.clientX,p.clientY,y?"bg-amber-400":"bg-white"),setTimeout(()=>{o(!1),r(!1),u(T=>(T+1>=10&&(m(!0),Ge.spawnFloatingText("FULLFRT! ",p.clientX,p.clientY-100,"text-emerald-400 text-2xl"),setTimeout(()=>t(1),1200)),T+1)),g()},80)},x=kG("CHOP",e);return l.jsxs("div",{className:`p-8 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden ${i?"animate-shake":""} `,style:{backgroundImage:'url("/images/minigames/forestry_bg.png")',backgroundSize:"cover"},children:[l.jsx("div",{className:"absolute inset-0 bg-black/60 z-0"}),l.jsx("div",{className:"relative z-10 w-full mb-8",children:l.jsxs("div",{className:"flex flex-col items-center gap-2",children:[l.jsx("h2",{className:"text-4xl font-black text-white drop-shadow-lg tracking-tighter uppercase",children:"Tmmerhogging"}),l.jsxs("div",{className:"flex gap-4",children:[l.jsxs("div",{className:"text-amber-400 font-black uppercase tracking-widest text-xs px-4 py-1 bg-black/40 rounded-full inline-block border border-amber-500/20",children:["Framdrift: ",c,"/10"]}),n>0&&l.jsxs("div",{className:"text-rose-500 font-black uppercase tracking-widest text-xs px-4 py-1 bg-rose-500/10 rounded-full inline-block border border-rose-500/30 animate-bounce",children:["COMBO: x",n]}),x&&l.jsxs("div",{className:"text-indigo-400 font-black uppercase tracking-widest text-xs px-4 py-1 bg-indigo-500/10 rounded-full inline-block border border-indigo-500/30",children:[x.icon," ",x.name]})]})]})}),l.jsxs("div",{className:`relative z-10 w-full h-96 bg-white/5 rounded-[3rem] border border-white/10 shadow-inner overflow-hidden ${a?"opacity-90 grayscale-[0.5]":""}`,children:[l.jsx("div",{className:"absolute bottom-0 left-0 h-2 bg-indigo-500/50 transition-all duration-300 z-0",style:{width:`${c/10*100}%`}}),h?l.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-4",children:[l.jsx("div",{className:"animate-bounce text-5xl font-black text-amber-500 uppercase tracking-tighter drop-shadow-2xl",children:"VEDHOGST FERDIG! "}),l.jsxs("div",{className:"text-xl font-black text-white uppercase tracking-widest bg-indigo-600 px-8 py-2 rounded-full shadow-lg",children:["Maks Combo: ",n]})]}):l.jsx("button",{onClick:b,className:`absolute w-20 h-20 bg-rose-500 rounded-full border-4 border-white shadow-[0_0_30px_rose] transition-all active:scale-90 ${a?"scale-110 brightness-150":"animate-pulse cursor-pointer"}`,style:{left:`${d.x}%`,top:`${d.y}%`,transform:"translate(-50%, -50%)"},children:""})]})]})},TG=(t,e)=>{if(e)return e.find(n=>{var r;if(!n)return!1;const s=Object.keys(Te).find(a=>n.id===a||n.id.startsWith(a+"_")),i=s?Te[s]:null;return(r=i==null?void 0:i.relevantActions)==null?void 0:r.includes(t)})},H_=({onComplete:t,equipment:e=[],speedMultiplier:n=1,possibleYield:s=10,resourceName:i="Korn"})=>{const[r,a]=_.useState(0),[o,c]=_.useState(0),[u,d]=_.useState(!1),[f,h]=_.useState(!1),[m,g]=_.useState(!1),b=()=>{u||m||a(x=>{var v;const p=x+2*n;if(p>=100){const y=TG("WORK",e),E=((v=y==null?void 0:y.stats)==null?void 0:v.yieldBonus)||0,N=Math.ceil(s/5*1.25),T=Math.ceil(E/5*1.25);return h(!0),g(!0),Ge.spawnFloatingText(`+ ${N} ${i} ${T>0?`(+${T})`:""} `,50,40,"text-amber-400 font-black text-xl"),Ge.spawnParticles(50,50,"bg-emerald-400"),setTimeout(()=>{h(!1),g(!1)},100),c(w=>(w+1>=5&&(d(!0),setTimeout(()=>t(1),800)),w+1)),0}return p})};return l.jsxs("div",{onMouseMove:b,className:`p-8 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden ${f?"animate-shake":""} `,style:{backgroundImage:'url("/images/minigames/agriculture_bg.png")',backgroundSize:"cover"},children:[l.jsx("div",{className:`absolute inset-0 bg-black/50 z-0 transition-all duration-75 ${m?"bg-emerald-900/40 mix-blend-hard-light":""}`}),l.jsxs("div",{className:`relative z-10 w-full flex flex-col items-center transition-all duration-75 ${m?"scale-105 brightness-150 contrast-125":""}`,children:[l.jsx("h2",{className:"text-3xl font-black text-white mb-4",children:"Scythe Sweep"}),l.jsx("div",{className:"w-full h-4 bg-white/10 rounded-full mb-8 border border-white/20 overflow-hidden",children:l.jsx("div",{className:"h-full bg-amber-400 transition-all duration-75",style:{width:`${r}% `}})}),l.jsx("div",{className:"grid grid-cols-5 gap-2",children:[...Array(5)].map((x,p)=>l.jsx("div",{className:`w-8 h-8 rounded-lg border-2 ${o>p?"bg-amber-500 border-amber-300":"border-white/20"} `},p))}),l.jsx("div",{className:"mt-8 text-slate-400 text-sm font-bold uppercase tracking-widest animate-pulse",children:"Beveg musen raskt frem og tilbake!"})]})]})},AG=({onComplete:t,speedMultiplier:e=1})=>{const[n,s]=_.useState(0),[i,r]=_.useState(0),[a,o]=_.useState(!1),[c,u]=_.useState(50),[d,f]=_.useState(1);_.useEffect(()=>{if(a)return;const m=setInterval(()=>{s(g=>{let b=3/e,x=g+b*d;return x>100?(f(-1),100):x<0?(f(1),0):x})},16);return()=>clearInterval(m)},[d,a,e]);const h=()=>{Math.abs(n-c)<10&&(r(g=>(Ge.spawnFloatingText("FANT DEN! ",50,40,"text-sky-400"),g+1>=3&&(o(!0),setTimeout(()=>t(1),800)),g+1)),u(20+Math.random()*60))};return l.jsxs("div",{className:"p-12 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden",style:{backgroundImage:'url("/images/minigames/foraging_bg.png")',backgroundSize:"cover"},children:[l.jsx("div",{className:"absolute inset-0 bg-black/70 z-0"}),l.jsx("h2",{className:"relative z-10 text-4xl font-black text-white mb-12 tracking-tighter uppercase italic",children:"Snarefiske "}),l.jsxs("div",{className:"relative z-10 w-full max-w-sm h-12 bg-white/5 rounded-full border border-white/10 mb-12 shadow-inner",children:[l.jsx("div",{className:"absolute inset-y-0 w-20 bg-amber-500/40 border-x-2 border-amber-500/50 rounded-lg blur-[2px]",style:{left:`${c}% `,transform:"translateX(-50%)"}}),l.jsx("div",{className:"absolute inset-y-0 w-2 bg-white shadow-[0_0_15px_white]",style:{left:`${n}% `}})]}),l.jsx("div",{className:"relative z-10 flex gap-4 mb-12",children:[...Array(3)].map((m,g)=>l.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center text-2xl border-2 transition-all ${i>g?"bg-amber-500 border-amber-300 scale-110":"bg-white/5 border-white/10 opacity-30 shadow-inner"} `,children:""},g))}),l.jsx("button",{onClick:h,className:"relative z-10 w-full max-w-md bg-sky-500 hover:bg-sky-400 text-white py-7 rounded-[2rem] font-black text-2xl shadow-2xl active:scale-95 transition-all uppercase tracking-widest border-b-4 border-sky-700",children:"HAL INN! "})]})},RG=({onComplete:t,speedMultiplier:e=1})=>{const[n,s]=_.useState("right"),[i,r]=_.useState(0),[a,o]=_.useState(!1),[c,u]=_.useState(null),d=f=>{a||f!==n&&(s(f),r(h=>{const m=h+5*e;return m>=100?(o(!0),setTimeout(()=>t(1),1e3),100):m}),u(f==="left"?"":""),setTimeout(()=>u(null),200))};return _.useEffect(()=>{const f=h=>{(h.key==="ArrowLeft"||h.key==="a"||h.key==="A")&&d("left"),(h.key==="ArrowRight"||h.key==="d"||h.key==="D")&&d("right")};return window.addEventListener("keydown",f),()=>window.removeEventListener("keydown",f)},[n,a]),l.jsxs("div",{className:"p-12 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden",style:{backgroundImage:'url("/images/minigames/weavery_bg.png")',backgroundSize:"cover"},children:[l.jsx("div",{className:"absolute inset-0 bg-black/70 z-0"}),l.jsx("h2",{className:"relative z-10 text-4xl font-black text-white mb-8 tracking-tighter uppercase italic",children:"Veveri: Vevstol "}),l.jsxs("div",{className:`relative z-10 w-full max-w-lg aspect-video bg-slate-900/50 border-4 rounded-3xl p-8 mb-12 flex flex-col justify-between overflow-hidden transition-all ${c?"brightness-125":""} ${n==="left"?"border-indigo-500/50 shadow-[inset_20px_0_40px_rgba(99,102,241,0.1)]":"border-emerald-500/50 shadow-[inset_-20px_0_40px_rgba(16,185,129,0.1)]"} `,children:[l.jsxs("div",{className:"flex justify-between items-center mb-8 relative h-32",children:[l.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 text-6xl transition-all duration-300 ease-out z-20",style:{left:n==="left"?"0%":"calc(100% - 4rem)",transform:`translateY(-50%) rotate(${n==="left"?"0deg":"180deg"})`},children:""}),l.jsx("div",{className:`text-6xl transition-all duration-500 ${n==="left"?"scale-110 opacity-100 rotate-12":"scale-75 opacity-20"} `,children:""}),l.jsx("div",{className:"absolute inset-x-0 h-1 bg-white/20 top-1/2 -translate-y-1/2 pointer-events-none"}),l.jsx("div",{className:`text-6xl transition-all duration-500 ${n==="right"?"scale-110 opacity-100 -rotate-12":"scale-75 opacity-20"} `,children:""})]}),l.jsx("div",{className:"text-sm font-black text-indigo-300 uppercase tracking-[0.3em] h-8 animate-pulse",children:c||"Veksle mellom Venstre / Hyre"})]}),l.jsxs("div",{className:"relative z-10 flex gap-12 mb-8",children:[l.jsx("button",{onClick:()=>d("left"),className:`w-28 h-28 rounded-[2rem] flex items-center justify-center text-4xl border-4 transition-all active:scale-90 ${n==="right"?"bg-indigo-600 border-indigo-400 scale-110 shadow-[0_0_30px_rgba(99,102,241,0.5)]":"bg-white/5 border-white/10 opacity-30 shadow-inner"} `,children:""}),l.jsx("button",{onClick:()=>d("right"),className:`w-28 h-28 rounded-[2rem] flex items-center justify-center text-4xl border-4 transition-all active:scale-90 ${n==="left"?"bg-emerald-600 border-emerald-400 scale-110 shadow-[0_0_30px_rgba(16,185,129,0.5)]":"bg-white/5 border-white/10 opacity-30 shadow-inner"} `,children:""})]}),l.jsx("div",{className:"relative z-10 w-full max-w-sm h-4 bg-white/10 rounded-full border border-white/10 overflow-hidden",children:l.jsx("div",{className:"h-full bg-indigo-500 transition-all duration-300",style:{width:`${i}% `}})})]})},IG=({onComplete:t,speedMultiplier:e=1})=>{var g;const[n,s]=_.useState([]),[i,r]=_.useState([]),[a,o]=_.useState(0),[c,u]=_.useState(!1),[d,f]=_.useState(null),h=[{id:"red",icon:"",label:"Rdurt"},{id:"blue",icon:"",label:"Blbr"},{id:"green",icon:"",label:"Grnnmose"},{id:"yellow",icon:"",label:"Gulrot"}];_.useEffect(()=>{const b=[];for(let x=0;x<5;x++)b.push(h[Math.floor(Math.random()*h.length)].id);s(b)},[]);const m=b=>{if(!(c||d))if(b===n[a]){const x=a+1;r(p=>[...p,b]),o(x),f("RIKTIG! "),setTimeout(()=>f(null),500),x>=n.length&&(u(!0),setTimeout(()=>t(1),1e3))}else f("FEIL... "),o(0),r([]),setTimeout(()=>f(null),1e3)};return l.jsxs("div",{className:"p-12 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden",style:{backgroundImage:'url("/images/minigames/apothecary_bg.png")',backgroundSize:"cover"},children:[l.jsx("div",{className:"absolute inset-0 bg-black/70 z-0"}),l.jsx("h2",{className:"relative z-10 text-4xl font-black text-white mb-8 tracking-tighter uppercase italic",children:"Apoteker: Brygging "}),l.jsx("div",{className:"relative z-10 mb-12 flex gap-4 h-24 items-center",children:n.map((b,x)=>{var p;return l.jsx("div",{className:`w-16 h-16 rounded-2xl flex items-center justify-center text-3xl transition-all border-2 border-white/10 ${a>x?"opacity-10 scale-90":"bg-black/40 scale-100"} `,children:(p=h.find(v=>v.id===b))==null?void 0:p.icon},x)})}),d&&l.jsx("div",{className:`relative z-10 text-3xl font-black mb-8 animate-in zoom-in ${d.includes("FEIL")?"text-rose-500":"text-emerald-400"} `,children:d}),l.jsxs("div",{className:"relative z-10 w-48 h-64 bg-white/5 border-4 border-white/20 rounded-b-[4rem] rounded-t-3xl overflow-hidden mb-12 shadow-inner",children:[l.jsx("div",{className:"absolute bottom-0 inset-x-0 transition-all duration-1000 ease-out",style:{height:`${a/n.length*100}%`,backgroundColor:a>0?(g=h.find(b=>b.id===n[a-1]))==null?void 0:g.id:"transparent",opacity:.6},children:l.jsx("div",{className:"absolute top-0 inset-x-0 h-4 bg-white/20 animate-pulse pointer-events-none"})}),l.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-6xl opacity-20 transition-transform duration-500 scale-125",children:""})]}),l.jsx("div",{className:"relative z-10 grid grid-cols-2 gap-4",children:h.map(b=>l.jsxs("button",{onClick:()=>m(b.id),className:`w-32 h-32 bg-slate-900/80 border-2 rounded-3xl flex flex-col items-center justify-center transition-all active:scale-90 shadow-xl group ${d==="RIKTIG! "&&n[a-1]===b.id?"border-emerald-500 scale-105 shadow-emerald-500/20":"border-white/20 hover:border-white/40"} `,children:[l.jsx("span",{className:"text-4xl mb-2 group-hover:scale-110 transition-transform",children:b.icon}),l.jsx("span",{className:"font-bold text-white uppercase text-sm",children:b.label})]},b.id))})]})},CG=({onComplete:t,speedMultiplier:e=1})=>{const[n,s]=_.useState(0),[i,r]=_.useState(0),[a,o]=_.useState(!0),[c,u]=_.useState(0),[d,f]=_.useState(!1),[h,m]=_.useState(1);_.useEffect(()=>{if(d)return;const b=setInterval(()=>{u(x=>{let p=x+h*3*e;return p>=100?(m(-1),100):p<=0?(m(1),0):p})},16);return()=>clearInterval(b)},[h,d,e]);const g=_.useCallback(b=>{if(d)return;const x=Math.abs(c-50),p=x<15,v=x>35;let y=0,E="",N="";p?(y=1,E="PERFEKT!",N="text-amber-400"):v?(y=.1,E="BOM!",N="text-rose-400"):(y=.5,E="BRA!",N="text-emerald-400");const T="clientX"in b?b.clientX:b.touches[0].clientX,w="clientY"in b?b.clientY:b.touches[0].clientY;Ge.spawnFloatingText(E,T,w-40,N),y>.1&&Ge.spawnParticles(T,w,y===1?"bg-amber-400":"bg-emerald-400"),r(k=>k+1),o(!a);const A=y*10;s(k=>{const R=k+A;return R>=100?(f(!0),Ge.spawnFloatingText("PLANKER FERDIG! ",T,w-100,"text-emerald-400 text-2xl font-black"),setTimeout(()=>t(1),1e3),100):R})},[c,d,a,t]);return l.jsxs("div",{className:"p-12 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden",children:[l.jsxs("div",{className:"absolute inset-0 bg-slate-950 z-0",children:[l.jsx("div",{className:"absolute inset-0 opacity-20 bg-[url('/images/textures/wood_pattern.png')] bg-repeat"}),l.jsx("div",{className:"absolute inset-x-0 bottom-0 h-32 bg-gradient-to-t from-indigo-500/10 to-transparent"})]}),l.jsxs("div",{className:"relative z-10 w-full mb-12",children:[l.jsx("h2",{className:"text-5xl font-black text-white uppercase tracking-tighter mb-2 italic drop-shadow-[0_0_20px_rgba(255,255,255,0.2)]",children:"Saging"}),l.jsx("p",{className:"text-slate-400 font-bold uppercase tracking-[0.3em] text-xs",children:"Pull og Push i takt for perfekte planker"})]}),l.jsxs("div",{className:"relative z-10 w-full max-w-2xl h-64 bg-slate-900/50 rounded-[3rem] border border-white/5 shadow-2xl overflow-hidden flex items-center justify-center group cursor-pointer",onClick:g,children:[l.jsx("div",{className:"absolute inset-y-0 left-0 bg-indigo-500/20 transition-all duration-500 z-0",style:{width:`${n}%`}}),l.jsxs("div",{className:"relative w-4/5 h-16 bg-[#3d2b1f] rounded-lg border-2 border-[#2a1d15] shadow-2xl flex items-center",children:[l.jsx("div",{className:"absolute inset-0 opacity-30 bg-[url('/images/textures/bark.png')] bg-cover mix-blend-overlay"}),l.jsx("div",{className:`absolute top-1/2 left-1/2 -translate-y-1/2 -translate-x-1/2 transition-transform duration-300 ${a?"-rotate-12 translate-x-4":"rotate-12 -translate-x-4"}`,children:l.jsx("div",{className:"text-6xl filter drop-shadow-[0_0_15px_rgba(255,255,255,0.3)]",children:""})}),l.jsxs("div",{className:"absolute bottom-0 left-1/2 -translate-x-1/2 flex gap-1 opacity-40",children:[l.jsx("div",{className:"w-1 h-1 bg-amber-200 rounded-full animate-ping"}),l.jsx("div",{className:"w-1 h-1 bg-amber-400 rounded-full animate-ping delay-75"}),l.jsx("div",{className:"w-1 h-1 bg-amber-100 rounded-full animate-ping delay-150"})]})]})]}),l.jsxs("div",{className:"relative z-10 mt-12 w-full max-w-md h-12 bg-black/40 rounded-full border border-white/10 p-1 flex items-center shadow-inner",children:[l.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 w-1/4 h-3/4 bg-amber-500/20 blur-sm rounded-full"}),l.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 w-[2px] h-full bg-amber-500/50"}),l.jsx("div",{className:"absolute w-8 h-8 bg-white rounded-full shadow-[0_0_20px_white] flex items-center justify-center transition-all duration-16 ease-linear",style:{left:`${c}%`,transform:"translateX(-50%)"},children:l.jsx("div",{className:"w-4 h-4 bg-indigo-500 rounded-full animate-pulse"})})]}),l.jsxs("div",{className:"relative z-10 mt-8",children:[l.jsxs("div",{className:"text-3xl font-black text-indigo-400 italic",children:[n.toFixed(0),"%"]}),l.jsxs("div",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mt-2",children:["Stroke: ",i]})]}),l.jsx("div",{className:"absolute inset-0 z-20 cursor-pointer",onClick:g})]})},jG=({onComplete:t,speedMultiplier:e=1})=>{const[n,s]=_.useState(20),[i]=_.useState({min:60,max:85}),[r,a]=_.useState(0),[o,c]=_.useState(!1),u=_.useRef(null),d=_.useRef(null),f=m=>{if(!o){if(d.current===void 0||d.current===null){d.current=m,u.current=requestAnimationFrame(f);return}if(d.current!==void 0){const g=m-d.current;s(b=>Math.max(0,b-.015*g*e)),s(b=>(b>=i.min&&b<=i.max&&a(x=>{const p=x+.01*g;return p>=100&&!o&&(c(!0),Ge.spawnFloatingText("PERFEKT TEMPERATUR! ",window.innerWidth/2,window.innerHeight/2,"text-orange-500 text-4xl font-black"),setTimeout(()=>t(1),1e3)),p}),b))}d.current=m,u.current=requestAnimationFrame(f)}};_.useEffect(()=>(u.current=requestAnimationFrame(f),()=>{u.current&&cancelAnimationFrame(u.current)}),[o]);const h=()=>{o||(s(m=>Math.min(100,m+12)),Ge.spawnParticles(window.innerWidth/2,window.innerHeight/2+100,"bg-orange-500"),Ge.spawnFloatingText("PUST!",window.innerWidth/2,window.innerHeight/2+50,"text-slate-400 font-bold text-xs uppercase"))};return l.jsxs("div",{onClick:h,className:"p-12 min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden cursor-pointer select-none",style:{backgroundImage:'url("/images/minigames/smeltery_bg.png")',backgroundSize:"cover"},children:[l.jsx("div",{className:"absolute inset-0 bg-black/80 z-0"}),l.jsxs("div",{className:"relative z-10 text-center mb-12",children:[l.jsx("h2",{className:"text-4xl font-black text-white uppercase tracking-tighter drop-shadow-xl",children:"Smelting"}),l.jsx("div",{className:"text-orange-500 font-black uppercase tracking-widest text-xs mt-2 bg-black/40 px-4 py-1 rounded-full border border-orange-500/20",children:"Hold varmen i den oransje sonen"})]}),l.jsxs("div",{className:"relative z-10 flex gap-12 items-end h-80",children:[l.jsxs("div",{className:"w-20 h-full bg-slate-900/80 rounded-full border-4 border-white/10 relative overflow-hidden shadow-2xl",children:[l.jsx("div",{className:"absolute w-full bg-orange-500/30 border-y-2 border-orange-500/50 flex items-center justify-center",style:{bottom:`${i.min}%`,height:`${i.max-i.min}%`},children:l.jsx("div",{className:"w-full h-full bg-orange-500/10 animate-pulse"})}),l.jsx("div",{className:`absolute bottom-0 w-full transition-all duration-75 shadow-[0_0_30px_rgba(249,115,22,0.5)] ${n>i.max?"bg-white":"bg-gradient-to-t from-red-600 via-orange-500 to-yellow-400"}`,style:{height:`${n}%`},children:l.jsx("div",{className:"absolute top-0 inset-x-0 h-4 bg-white/50 blur-[2px]"})})]}),l.jsxs("div",{className:"flex flex-col gap-4",children:[l.jsx("div",{className:"text-xs font-black text-slate-500 uppercase tracking-widest text-center",children:"Fremgang"}),l.jsx("div",{className:"w-12 h-64 bg-slate-900/80 rounded-2xl border-2 border-white/5 relative overflow-hidden",children:l.jsx("div",{className:"absolute bottom-0 w-full bg-indigo-500 transition-all duration-300",style:{height:`${r}%`}})}),l.jsxs("div",{className:"text-xl font-black text-white text-center",children:[Math.round(r),"%"]})]})]}),l.jsx("div",{className:"mt-16 text-slate-400 text-sm font-bold uppercase tracking-widest animate-pulse relative z-10 text-center max-w-xs",children:"Klikk for  pumpe blsebelgen og ke varmen"}),o&&l.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm animate-in fade-in zoom-in duration-300",children:l.jsx("div",{className:"text-6xl font-black text-orange-500 animate-bounce drop-shadow-[0_0_30px_rgba(249,115,22,0.5)]",children:"FERDIG! "})})]})},xa={WORK:[{id:"sickle",label:"Sigd",icon:"",desc:"Presisjons-hsting for hy kvalitet."},{id:"sweep",label:"Lj",icon:"",desc:"Rask innhsting av store omrder."}],CHOP:[{id:"axe",label:"ks",icon:"",desc:"Fell trr med r makt."}],FORAGE:[{id:"gather",label:"Sanking",icon:"",desc:"Let etter mat og urter i skogen."},{id:"traps",label:"Snarefangst",icon:"",desc:"Sett feller for smvilt."}],MINE:[{id:"pickaxe",label:"Hakke",icon:"",desc:"Hugg ut malm fra fjellet."}],QUARRY:[{id:"chisel",label:"Meisel",icon:"",desc:"Hugg ut steinblokker."}],CRAFT:[{id:"hammer",label:"Smiing",icon:"",desc:"Form metallet p ambolten."}],BAKE:[{id:"oven",label:"Steking",icon:"",desc:"Stek brd i ovnen."}],WEAVE:[{id:"loom",label:"Veving",icon:"",desc:"Vev trd til stoffer."}],MIX:[{id:"brew",label:"Brygging",icon:"",desc:"Bland urter til medisiner."}],SMELT:[{id:"furnace",label:"Smelting",icon:"",desc:"Smelt malm til barrer."}],PLANT:[{id:"manual",label:"Hndsing",icon:"",desc:"S fr for hnd."}],HUNT:[{id:"bow",label:"Bueskyting",icon:"",desc:"Presisjonsjakt fra avstand."},{id:"trap",label:"Fellefangst",icon:"",desc:"Sett ut snarer for smvilt."}],SAWMILL:[{id:"saw",label:"Saging",icon:"",desc:"Sag opp tmmer til planker."}],GATHER_WOOL:[{id:"shears",label:"Saks",icon:"",desc:"Klipp ullen av sauene."}]},OG=({item:t})=>{const e=t.durability/t.maxDurability*100;return l.jsx("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 z-[110] animate-in slide-in-from-bottom-4 fade-in duration-500",children:l.jsxs("div",{className:"bg-slate-900/90 border border-white/10 rounded-full px-6 py-3 flex items-center gap-4 backdrop-blur-md shadow-2xl",children:[l.jsx("div",{className:"text-3xl drop-shadow-[0_0_10px_rgba(255,255,255,0.2)]",children:t.icon}),l.jsxs("div",{className:"flex flex-col gap-1",children:[l.jsx("div",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:t.name}),l.jsxs("div",{className:"flex items-center gap-2 text-xs font-bold text-slate-300",children:[l.jsx("div",{className:`w-2 h-2 rounded-full ${e>20?"bg-emerald-500":"bg-rose-500"} animate-pulse`}),l.jsx("span",{children:"Slitasje"}),l.jsxs("span",{children:[Math.round(e),"%"]})]})]})]})})},MG=(t,e)=>{if(e)return e.find(n=>{var r;if(!n)return!1;const s=Object.keys(Te).find(a=>n.id===a||n.id.startsWith(a+"_")),i=s?Te[s]:null;return(r=i==null?void 0:i.relevantActions)==null?void 0:r.includes(t)})},DG=({type:t,onComplete:e,onCancel:n,equipment:s,skills:i,playerUpgrades:r,currentSeason:a="Spring",currentWeather:o="Clear",totalTicks:c=0,selectedMethod:u,action:d})=>{var E,N,T;const[f,h]=we.useState(u||null);we.useEffect(()=>{const w=xa[t];w&&w.length===1&&!f&&h(w[0].id)},[t,f]);const m=we.useMemo(()=>MG(t,s||[]),[t,s]),g=we.useMemo(()=>{var k,R;const w=An[a],A=_s[o];return{speedMultiplier:((A==null?void 0:A.speedMod)||1)*(((k=m==null?void 0:m.stats)==null?void 0:k.speedBonus)||1),staminaCostMod:((w==null?void 0:w.staminaMod)||1)*((A==null?void 0:A.staminaMod)||1),yieldMod:(((R=m==null?void 0:m.stats)==null?void 0:R.yieldBonus)||0)+((w==null?void 0:w.yieldMod)||1)}},[a,o,m]),b=we.useMemo(()=>{var B,z;const w={skills:i||{},equipment:{}};s&&s.forEach($=>{const K=$.slot||$.type;$&&K&&(w.equipment[K]=$)});let A=10,k="FARMING",R=t;switch(t){case"MINE":A=q.YIELD.MINE_ORE,k="MINING";break;case"QUARRY":A=q.YIELD.QUARRY_STONE,k="MINING";break;case"CHOP":A=q.YIELD.CHOP_WOOD,a==="Summer"&&(A+=q.YIELD.SUMMER_WOOD_BONUS),k="WOODCUTTING";break;case"WORK":case"HARVEST":A=q.YIELD.WORK_GRAIN,r!=null&&r.includes("iron_plow")&&(A+=q.YIELD.PLOW_BONUS),k="FARMING";break;case"FORAGE":A=q.YIELD.FORAGE_BREAD,k="FARMING";break}const C={season:((B=An[a])==null?void 0:B.yieldMod)||1,weather:((z=_s[o])==null?void 0:z.yieldMod)||1,actionType:R,upgrades:1};try{const $=Kn(w,A,k,C);return isNaN($)?1.5:$}catch($){return console.error("Yield Calc Error:",$),1.5}},[t,i,s,r,a,o]),x=we.useMemo(()=>{let w=10;switch(t){case"MINE":w=q.YIELD.MINE_ORE;break;case"QUARRY":w=q.YIELD.QUARRY_STONE;break;case"CHOP":w=q.YIELD.CHOP_WOOD;break;case"WORK":case"HARVEST":w=q.YIELD.WORK_GRAIN;break;case"FORAGE":w=q.YIELD.FORAGE_BREAD;break}return b<=2||b<w*.4},[b,t]),p=w=>{h(w)},[v,y]=we.useState(!1);return x&&!v&&(t==="MINE"||t==="QUARRY"||t==="CHOP"||t==="WORK"||t==="HARVEST"||t==="FORAGE")&&f?l.jsx("div",{className:"fixed inset-0 z-[150] flex items-center justify-center bg-black/80 backdrop-blur-md animate-in fade-in zoom-in duration-300",children:l.jsxs("div",{className:"bg-slate-900 border-2 border-rose-500 rounded-3xl p-8 max-w-md w-full text-center shadow-[0_0_50px_rgba(244,63,94,0.3)]",children:[l.jsx("div",{className:"text-6xl mb-6",children:""}),l.jsx("h2",{className:"text-3xl font-black text-white uppercase tracking-tighter mb-4",children:"Manglende Verkty!"}),l.jsxs("p",{className:"text-slate-300 font-medium mb-8 leading-relaxed",children:["Du forsker  utfre ",l.jsx("span",{className:"text-rose-400 font-bold",children:t})," uten riktig verkty. Effektiviteten din er redusert med 80%."]}),l.jsxs("div",{className:"flex flex-col gap-3",children:[l.jsx("button",{onClick:()=>y(!0),className:"w-full py-4 bg-rose-600 hover:bg-rose-500 text-white rounded-xl font-black uppercase tracking-widest shadow-lg active:scale-95 transition-all",children:"Fortsett likevel"}),l.jsx("button",{onClick:n,className:"w-full py-4 bg-white/5 hover:bg-white/10 text-slate-400 hover:text-white rounded-xl font-bold uppercase tracking-widest transition-all",children:"Avbryt"})]})]})}):!f&&xa[t]?l.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-slate-950/80 backdrop-blur-md animate-in fade-in duration-300",children:l.jsxs("div",{className:"max-w-4xl w-full p-8",children:[l.jsx("h2",{className:"text-4xl font-black text-white text-center mb-12 uppercase tracking-tighter drop-shadow-lg",children:"Velg Metode"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:xa[t].map(w=>l.jsxs("button",{onClick:()=>p(w.id),className:"group relative bg-slate-900 border-2 border-slate-700 hover:border-indigo-500 rounded-3xl p-8 transition-all hover:-translate-y-2 hover:shadow-[0_0_50px_rgba(79,70,229,0.3)] text-left overflow-hidden",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-500/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),l.jsxs("div",{className:"relative z-10 flex flex-col items-center text-center gap-6",children:[l.jsx("div",{className:"text-6xl group-hover:scale-110 transition-transform duration-300",children:w.icon}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-2xl font-black text-white mb-2 uppercase tracking-wide group-hover:text-indigo-400 transition-colors",children:w.label}),l.jsx("p",{className:"text-slate-400 font-medium leading-relaxed",children:w.desc})]}),l.jsx("div",{className:"mt-4 pt-4 border-t border-white/5 w-full",children:(()=>{const A=IS(t,a,o,c);return A?l.jsx("div",{className:"flex items-center justify-center gap-2 text-sm font-bold text-slate-500",children:l.jsx("span",{children:A})}):null})()})]})]},w.id))}),l.jsx("button",{onClick:n,className:"mt-12 mx-auto block text-slate-500 font-bold hover:text-white transition-colors uppercase tracking-widest text-sm",children:"Avbryt"})]})}):l.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-slate-950/90 backdrop-blur-xl animate-in fade-in duration-300",children:[l.jsx("div",{className:"absolute top-8 right-8 z-[110]",children:l.jsx("button",{onClick:n,className:"bg-black/40 hover:bg-rose-500/20 text-white/50 hover:text-rose-400 w-12 h-12 rounded-full flex items-center justify-center transition-all",children:""})}),l.jsx("div",{className:"absolute top-8 left-8 z-[110] flex gap-4",children:l.jsxs("div",{className:"bg-black/40 backdrop-blur-md px-4 py-2 rounded-2xl border border-white/5 flex items-center gap-3",children:[l.jsx("span",{className:"text-2xl",title:((E=An[a])==null?void 0:E.label)||a,children:a==="Winter"?"":a==="Summer"?"":a==="Autumn"?"":""}),l.jsx("span",{className:"text-2xl",title:((N=_s[o])==null?void 0:N.label)||o,children:(T=_s[o])==null?void 0:T.icon}),l.jsx("div",{className:"h-4 w-[1px] bg-white/10 mx-2"}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-[10px] uppercase font-bold text-slate-500 tracking-wider",children:"Forhold"}),l.jsxs("span",{className:`text-xs font-bold ${g.speedMultiplier<1?"text-rose-400":"text-emerald-400"}`,children:[Math.round(g.speedMultiplier*100),"% Hastighet"]})]})]})}),l.jsxs("div",{className:"w-full max-w-5xl bg-slate-900 rounded-[3rem] shadow-2xl relative overflow-hidden border border-white/5",children:[(()=>{var w,A;switch(t){case"PLANT":return l.jsx(_G,{onComplete:e});case"HARVEST":case"WORK":return f==="sweep"||f==="scythe"?l.jsx(H_,{onComplete:e,equipment:s,speedMultiplier:g.speedMultiplier}):l.jsx(Kc,{onComplete:e,equipment:s,speedMultiplier:g.speedMultiplier,possibleYield:b});case"CHOP":return l.jsx(SG,{onComplete:e,equipment:s,speedMultiplier:g.speedMultiplier,possibleYield:b});case"SAWMILL":return l.jsx(CG,{onComplete:e,speedMultiplier:g.speedMultiplier});case"FORAGE":return f==="traps"?l.jsx(AG,{onComplete:e,speedMultiplier:g.speedMultiplier}):l.jsx(Kc,{isForaging:!0,onComplete:e,equipment:s,speedMultiplier:g.speedMultiplier,resourceName:"Mat/Urter",possibleYield:b});case"MINE":return l.jsx(Kc,{isMining:!0,onComplete:e,equipment:s,speedMultiplier:g.speedMultiplier,resourceName:"Malm",possibleYield:b});case"QUARRY":return l.jsx(Kc,{isQuarrying:!0,onComplete:e,equipment:s,speedMultiplier:g.speedMultiplier,resourceName:"Stein",possibleYield:b});case"CRAFT":case"REPAIR":return l.jsx(EG,{onComplete:e,speedMultiplier:g.speedMultiplier});case"SMELT":return l.jsx(jG,{onComplete:e,speedMultiplier:g.speedMultiplier});case"BAKE":const k=d!=null&&d.subType?((w=Te[d.subType])==null?void 0:w.icon)||"":((A=mn[d==null?void 0:d.recipeId])==null?void 0:A.icon)||"";return l.jsx(NG,{onComplete:e,speedMultiplier:g.speedMultiplier,icon:k});case"WEAVE":return l.jsx(RG,{onComplete:e,speedMultiplier:g.speedMultiplier});case"MIX":return l.jsx(IG,{onComplete:e,speedMultiplier:g.speedMultiplier});case"GATHER_WOOL":return l.jsx(H_,{onComplete:e,equipment:s,speedMultiplier:g.speedMultiplier});default:return l.jsxs("div",{className:"p-12 text-center",children:[l.jsxs("h2",{className:"text-2xl font-bold text-white mb-4",children:["Ukjent Minispill: ",t]}),l.jsx("button",{onClick:()=>e(.5),className:"px-6 py-3 bg-indigo-600 rounded-xl font-bold text-white",children:"Fullfr (Skip)"})]})}})(),m&&l.jsx(OG,{item:m})]})]})},LG=({poi:t,player:e,room:n,viewingRegionId:s,onAction:i,onClose:r})=>{var T,w,A;const a=_.useRef(null),o=s==="region_ost"&&t.ost?t.ost.top:t.top,c=s==="region_ost"&&t.ost?t.ost.left:t.left,[u,d]=_.useState({x:"3rem",y:"-50%"}),[f,h]=_.useState(!1),m=((T=n.world)==null?void 0:T.season)||"Spring",g=((w=n.world)==null?void 0:w.weather)||"Clear",b=_.useMemo(()=>{var U,O,j;const k=t.id in Bt?t.id:t.parentId,R=Bt[k],B=((j=(O=(((U=n.world)==null?void 0:U.settlement)||{}).buildings)==null?void 0:O[k])==null?void 0:j.level)||1;let z=[];if(R)for(let I=1;I<=B;I++)R.levels[I]&&(z=[...z,...R.levels[I].unlocks]);const $=t.actions.filter(I=>{if(I.id==="TAX_PEASANTS"&&e.role!=="BARON"||I.id==="TAX_ROYAL"&&e.role!=="KING"||I.id==="DECREE"&&e.role!=="KING"||I.id==="RAID"&&e.role!=="BARON"||I.id==="FEAST"&&e.role!=="KING"&&e.role!=="BARON")return!1;const H=["OPEN_CRAFTING","CRAFT","REFINE","MARKET_VIEW","OPEN_GARRISON"];return!(R&&!I.id.startsWith("BUILDING_UPGRADE_")&&!H.includes(I.id)&&!z.includes(I.id))});return["windmill_stones","sawmill_blade","smeltery_furnace","bakery_oven","weavery_loom","forge_anvil"].includes(t.id)?$.filter(I=>I.id==="OPEN_CRAFTING"||I.id==="REFINE"||I.id==="CRAFT"||I.id.startsWith("REFINE_")||I.id.startsWith("CRAFT_")||I.id in Rn).slice(0,1):$},[t,e.role,(A=n.world)==null?void 0:A.settlement]);_.useLayoutEffect(()=>{if(!a.current)return;const k=a.current.getBoundingClientRect(),R=a.current.offsetParent;if(!R){h(!0);return}const C=R.getBoundingClientRect(),B=parseFloat(c),z=parseFloat(o),$=B<50?"3rem":"calc(-100% - 3rem)",K=z/100*C.height-k.height/2,U=K+k.height;let O="-50%";K<20?O=`calc(-50% + ${20-K}px)`:U>C.height-20&&(O=`calc(-50% - ${U-(C.height-20)}px)`),d({x:$,y:O}),h(!0)},[o,c,b.length]);const x=k=>{var K,U,O;const R=[],C=up(e,k);if(C.forEach(j=>{var I,H,X;(I=j.stats)!=null&&I.speedBonus&&j.stats.speedBonus!==1&&R.push({source:j.name,type:"Fart",value:`+${Math.round((j.stats.speedBonus-1)*100)}%`,icon:j.icon,isBonus:!0}),(H=j.stats)!=null&&H.yieldBonus&&R.push({source:j.name,type:"Utbytte",value:`+${j.stats.yieldBonus}`,icon:j.icon,isBonus:!0}),(X=j.stats)!=null&&X.luckBonus&&R.push({source:j.name,type:"Flaks",value:`+${Math.round(j.stats.luckBonus*100)}%`,icon:j.icon,isBonus:!0})}),e.upgrades){const j=C0[e.role]||[];e.upgrades.forEach(I=>{const H=j.find(X=>X.id===I);H&&(H.benefit==="YIELD_GRAIN"&&(k==="WORK"||k==="MILL")&&R.push({source:H.name,type:"Utbytte",value:"+5",icon:"",isBonus:!0}),H.benefit==="RAID_SPEED"&&k==="RAID"&&R.push({source:H.name,type:"Fart",value:"Raskere",icon:"",isBonus:!0}))})}const B=t.id==="tavern"||t.id==="bakery"||t.id==="great_forge"||t.id==="weavery"||t.id==="sawmill"||t.id==="windmill"||t.id==="smeltery"?t.id:t.parentId,$=((O=(U=(((K=n.world)==null?void 0:K.settlement)||{}).buildings)==null?void 0:U[B])==null?void 0:O.level)||1;if($>=2&&R.push({source:"Bygningsbonus (Lvl 2)",type:"Utbytte",value:"+10% XP",icon:"",isBonus:!0}),$>=3&&R.push({source:"Bygningsbonus (Lvl 3)",type:"Utbytte",value:"Master Tier",icon:"",isBonus:!0}),xa[k]){const j=xa[k][0];j.id==="manual"||j.id==="gather"||C.some(X=>{var oe;return((oe=X.type)==null?void 0:oe.toLowerCase().includes(j.id.toLowerCase()))||X.id.toLowerCase().includes(j.id.toLowerCase())})||R.push({source:"System",type:"ADVARSEL",value:`Du mangler ${j.label}, utbytte redusert med 80%`,icon:"",isBonus:!1})}return R},p=_.useMemo(()=>{var k;return(k=e.activeProcesses)==null?void 0:k.find(R=>!(R.locationId!==t.id||R.type==="COOP"||R.type==="WELL"&&R.readyAt<=Date.now()))},[e.activeProcesses,t.id]),v=()=>{if(!p)return 0;const k=Date.now();return Math.max(0,p.readyAt-k)},[y,E]=_.useState(v());_.useEffect(()=>{if(!p)return;const k=setInterval(()=>{const R=v();E(R),R<=0&&clearInterval(k)},1e3);return()=>clearInterval(k)},[p]);const N=k=>{const R=Math.floor(k/6e4),C=Math.floor(k%6e4/1e3);return`${R}m ${C}s`};return l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"absolute inset-0 z-[90]",onClick:r}),l.jsx("div",{ref:a,style:{top:o,left:c,transform:`translate(${u.x}, ${u.y})`,visibility:f?"visible":"hidden",opacity:f?1:0},className:`absolute z-[100] ${f?"animate-in fade-in zoom-in":""} duration-200 pointer-events-auto`,children:l.jsxs("div",{className:"bg-slate-900/90 backdrop-blur-3xl border border-white/10 rounded-[2.5rem] p-6 shadow-[0_40px_100px_rgba(0,0,0,0.8)] min-w-[320px] w-max max-w-[400px] relative transition-all duration-500 overflow-hidden group/tooltip",children:[l.jsx("div",{className:"absolute -top-24 -left-24 w-48 h-48 bg-indigo-500/10 blur-[80px] pointer-events-none group-hover/tooltip:bg-indigo-500/20 transition-all duration-1000"}),l.jsxs("div",{className:"flex items-center justify-between mb-6 relative z-10",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("div",{className:"w-14 h-14 rounded-2xl bg-white/5 border border-white/10 flex items-center justify-center text-3xl shadow-inner relative overflow-hidden group/icon",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-0 group-hover/icon:opacity-100 transition-opacity"}),t.icon]}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("h3",{className:"font-display font-black text-white text-xl uppercase tracking-tighter leading-none",children:t.label}),l.jsx("span",{className:"text-xs font-black text-indigo-400 uppercase tracking-[.2em] mt-1 opacity-90",children:"Landemerke"})]})]}),l.jsx("div",{className:"flex items-center gap-3",children:l.jsx("button",{onClick:r,className:"text-white/60 hover:text-white transition-all bg-white/10 hover:bg-white/20 rounded-full w-10 h-10 flex items-center justify-center border border-white/10 hover:border-white/30 active:scale-90",children:""})})]}),l.jsxs("div",{className:"space-y-3",children:[p?l.jsx("div",{className:"w-full relative py-4",children:y<=0?l.jsxs("div",{className:"relative group/harvest",children:[l.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-emerald-500 to-teal-500 rounded-3xl blur opacity-25 group-hover/harvest:opacity-50 transition duration-1000 group-hover:duration-200"}),l.jsxs("button",{onClick:()=>i({type:"HARVEST",locationId:t.id}),disabled:e.status.stamina<fs(15,m,g),className:`w-full relative px-6 py-8 border rounded-3xl flex items-center justify-between overflow-hidden active:scale-[0.98] transition-all
                                                ${e.status.stamina<fs(15,m,g)?"bg-red-900/20 border-red-500/30 cursor-not-allowed grayscale opacity-80":"bg-slate-900 border-emerald-500/50 hover:bg-emerald-950/30"}`,children:[l.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-emerald-500/10 blur-3xl -mr-16 -mt-16"}),l.jsxs("div",{className:"flex flex-col items-start z-10",children:[l.jsx("span",{className:`text-2xl font-black uppercase tracking-tighter italic ${e.status.stamina<fs(15,m,g)?"text-slate-500":"text-white"}`,children:"Innhsting"}),l.jsx("span",{className:`text-xs font-black uppercase tracking-[0.2em] mt-1 ${e.status.stamina<fs(15,m,g)?"text-red-400":"text-emerald-400"}`,children:e.status.stamina<fs(15,m,g)?`Mangler energi (${Math.ceil(e.status.stamina)}/${fs(15,m,g).toFixed(0)})`:"Klar til  hentes!"})]}),l.jsx("div",{className:`w-14 h-14 rounded-2xl flex items-center justify-center text-3xl shadow-[0_0_20px_rgba(16,185,129,0.3)] ${e.status.stamina<fs(15,m,g)?"bg-slate-800 text-slate-600":"bg-emerald-500/20 animate-bounce"}`,children:e.status.stamina<fs(15,m,g)?l.jsx(vP,{size:24,className:"text-red-500"}):""})]})]}):l.jsxs("div",{className:"p-8 bg-white/5 border border-white/10 rounded-[2rem] flex flex-col items-center gap-6 relative overflow-hidden group/timer",children:[l.jsx("div",{className:"absolute -bottom-12 -right-12 w-24 h-24 bg-indigo-500/5 blur-2xl rounded-full"}),l.jsxs("div",{className:"relative w-24 h-24",children:[l.jsxs("svg",{className:"w-full h-full -rotate-90",viewBox:"0 0 36 36",children:[l.jsx("circle",{cx:"18",cy:"18",r:"16",fill:"none",className:"stroke-white/5",strokeWidth:"2"}),l.jsx("circle",{cx:"18",cy:"18",r:"16",fill:"none",className:"stroke-emerald-500 transition-all duration-1000 ease-linear",strokeWidth:"2",strokeDasharray:"100",strokeDashoffset:100-(1-y/p.duration)*100,strokeLinecap:"round"})]}),l.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:l.jsx("span",{className:"text-3xl animate-pulse",children:p.type==="MILL"?"":p.type==="WELL"?"":""})})]}),l.jsxs("div",{className:"flex flex-col items-center gap-1",children:[l.jsx("span",{className:"text-sm font-black text-slate-400 uppercase tracking-widest leading-none",children:p.type==="WELL"?"Brnnen fyller seg med vann":"Venter p produksjon"}),l.jsx("span",{className:"text-2xl font-mono font-black text-white",children:N(y)})]}),l.jsx("div",{className:"w-full h-1 bg-white/5 rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-emerald-500 transition-all duration-1000 ease-linear",style:{width:`${(1-y/p.duration)*100}%`}})})]})}):l.jsx("div",{className:"space-y-6",children:b.map(k=>{var j,I,H,X;const R=((j=n.world)==null?void 0:j.season)||"Spring",C=((I=n.world)==null?void 0:I.weather)||"Clear",B=x(k.id);let z=!0,$="";const K=["CRAFT","REFINE","OPEN_CRAFTING","BAKE","SMELT","MILL","WEAVE","MIX","OPEN_CHICKEN_COOP","OPEN_DICE_GAME","MARKET_VIEW","OPEN_GARRISON"];if(s!==e.regionId&&e.role!=="KING"&&k.id!=="MARKET_VIEW")z=!1,$="Dette er ikke ditt baroni";else if(!K.includes(k.id)){const oe=RS(e,k.id,R,C,((H=n.world)==null?void 0:H.gameTick)||0);oe.success||(z=!1,$=oe.reason||"Krav ikke mtt")}const U=IS(k.id,R,C,((X=n.world)==null?void 0:X.gameTick)||0),O=xa[k.id];return l.jsxs("div",{className:"w-full animate-in fade-in slide-in-from-bottom-2 duration-500",children:[l.jsxs("div",{className:"flex items-center justify-between px-1 mb-3",children:[l.jsx("h4",{className:"text-xs font-black text-slate-300 uppercase tracking-[0.3em]",children:k.label}),U&&l.jsx("span",{className:"text-xs font-black text-indigo-400 uppercase tracking-widest",children:U})]}),O?l.jsx("div",{className:"grid grid-cols-1 gap-4",children:O.map(oe=>{const Ie=up(e,k.id),V=Ie.find(ne=>{var tt;return((tt=ne.type)==null?void 0:tt.toLowerCase().includes(oe.id.toLowerCase()))||ne.id.toLowerCase().includes(oe.id.toLowerCase())})||Ie[0],me=V?V.durability/V.maxDurability*100:null;return l.jsxs("button",{onClick:()=>i({type:k.id,method:oe.id,locationId:t.id}),disabled:!z,className:`group relative flex items-center gap-6 w-full p-5 rounded-[2rem] border transition-all duration-300 ${z?"bg-white/5 border-white/10 hover:border-indigo-500/50 hover:bg-indigo-500/5 active:scale-[0.98]":"bg-black/20 border-white/5 cursor-not-allowed"}`,children:[l.jsx("div",{className:`w-16 h-16 rounded-2xl bg-white/5 flex-shrink-0 flex items-center justify-center text-4xl group-hover:scale-110 transition-transform duration-500 ${!z&&"opacity-40"}`,children:oe.icon}),l.jsxs("div",{className:"flex-1 flex flex-col justify-center min-w-0 items-start",children:[l.jsx("span",{className:"font-display font-black text-white text-xl uppercase tracking-tighter group-hover:text-indigo-400 transition-colors truncate",children:oe.label}),z?l.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[l.jsx("span",{className:"text-[10px] text-slate-400 font-black uppercase tracking-widest truncate opacity-60",children:oe.desc}),B.length>0&&l.jsx("div",{className:"flex gap-1.5",children:B.filter(ne=>!ne.isBonus||ne.value.includes("+")).slice(0,1).map((ne,tt)=>l.jsx("span",{className:"text-[10px] text-emerald-400 font-black px-2 py-0.5 bg-emerald-400/10 rounded-full",children:ne.value},tt))})]}):l.jsx("span",{className:"text-xs font-black text-rose-500 uppercase tracking-widest mt-0.5",children:$})]}),l.jsxs("div",{className:"flex flex-col items-end gap-3 ml-2",children:[me!==null&&z&&l.jsx("div",{className:"w-10 h-1.5 bg-white/10 rounded-full overflow-hidden shadow-inner",children:l.jsx("div",{className:`h-full transition-all duration-1000 ${me>50?"bg-indigo-500 shadow-[0_0_8px_rgba(99,102,241,0.5)]":me>20?"bg-amber-500":"bg-rose-500"}`,style:{width:`${me}%`}})}),l.jsx(va,{size:22,className:`transition-all ${z?"text-white/20 group-hover:text-indigo-400 group-hover:translate-x-1":"text-white/5"}`})]})]},oe.id)})}):l.jsx("button",{onClick:()=>i({...k,type:k.id,locationId:t.id}),disabled:!z,className:`w-full group relative overflow-hidden p-5 rounded-3xl border transition-all duration-300 ${z?"bg-white/5 border-white/10 hover:border-indigo-500/50 hover:bg-indigo-500/5 active:scale-[0.98]":"bg-black/20 border-white/5 opacity-50 cursor-not-allowed"}`,children:l.jsxs("div",{className:"flex items-center justify-between relative z-10",children:[l.jsxs("div",{className:"flex flex-col items-start",children:[l.jsx("span",{className:"text-xl font-black text-white group-hover:text-indigo-400 transition-colors uppercase tracking-tight",children:k.label}),!z&&l.jsx("span",{className:"text-sm font-black text-rose-500 uppercase tracking-widest mt-1",children:$})]}),l.jsx(va,{size:20,className:"text-white/20 group-hover:text-indigo-400 group-hover:translate-x-1 transition-all"})]})})]},k.id)})}),(()=>{var $,K,U,O,j;const k=b.map(I=>I.id),R=Object.values(e.equipment||{}),z=Object.values(Te).filter(I=>{var H;return(H=I.relevantActions)==null?void 0:H.some(X=>k.includes(X))}).map(I=>{if(R.find(X=>X.id===I.id||X.id.startsWith(I.id+"_"))){const X=I.nextTierId;return X?Te[X]:null}else return I.level===1?I:null}).filter(Boolean).filter((I,H,X)=>X.findIndex(oe=>(oe==null?void 0:oe.id)===(I==null?void 0:I.id))===H).sort((I,H)=>{if(!I||!H)return 0;const X=I.type==="MAIN_HAND"||I.type==="AXE"||I.type==="PICKAXE"||I.type==="SCYTHE"||I.type==="BOW"||I.type==="CHISEL"?1:0;return(H.type==="MAIN_HAND"||H.type==="AXE"||H.type==="PICKAXE"||H.type==="SCYTHE"||H.type==="BOW"||H.type==="CHISEL"?1:0)-X});if(z.length>0){const I=z[0];if(!I)return null;const H=Object.values(Rn).find(zt=>zt.outputItemId===I.id),X=(($=n.world)==null?void 0:$.settlement)||{buildings:{}},oe=(H==null?void 0:H.buildingId)||"great_forge",Ie=((U=(K=X.buildings)==null?void 0:K[oe])==null?void 0:U.level)||1,V=(H==null?void 0:H.level)||1,me=Ie<V,ne=((O=Bt[oe])==null?void 0:O.name)||"Smien",tt=R.find(zt=>{var Yn;if(!zt)return!1;const On=Object.keys(Te).find(pn=>zt.id===pn||zt.id.startsWith(pn+"_")),Mt=On?Te[On]:null;return(Yn=Mt==null?void 0:Mt.relevantActions)==null?void 0:Yn.some(pn=>k.includes(pn))});return l.jsx("div",{className:"mt-8 pt-8 border-t border-white/5 relative z-10",children:l.jsxs("div",{className:"flex flex-col gap-4",children:[l.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[l.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-amber-500 to-transparent flex-1"}),l.jsx("span",{className:`text-xs font-black uppercase tracking-[0.2em] ${me?"text-slate-400":"text-amber-500 animate-pulse"}`,children:me?`Krever niv ${V}`:"Utvikling venter"}),l.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-amber-500 to-transparent flex-1"})]}),l.jsxs("div",{className:"flex items-center justify-between gap-6 px-4",children:[l.jsxs("div",{className:"flex flex-col items-center gap-2 group/evolve",children:[l.jsx("div",{className:"w-16 h-16 rounded-[1.5rem] bg-white/5 border border-white/10 flex items-center justify-center text-3xl opacity-40 transition-all group-hover/evolve:opacity-60",children:(tt==null?void 0:tt.icon)||""}),l.jsx("span",{className:"text-[9px] font-black text-slate-500 uppercase tracking-widest",children:"N"})]}),l.jsxs("div",{className:"flex flex-col items-center flex-1 gap-2 pt-2",children:[l.jsxs("div",{className:"relative w-full flex justify-center",children:[l.jsx("div",{className:"absolute top-1/2 left-0 w-full h-px bg-gradient-to-r from-indigo-500/0 via-indigo-500/30 to-indigo-500/0"}),l.jsx(va,{className:"text-indigo-500/50 w-6 h-6 animate-pulse relative z-10"})]}),((j=I.stats)==null?void 0:j.yieldBonus)&&l.jsxs("span",{className:"text-[10px] font-black text-emerald-400 bg-emerald-400/10 px-2 py-0.5 rounded-full border border-emerald-400/20",children:["+",I.stats.yieldBonus," Utbytte"]})]}),l.jsxs("div",{className:"flex flex-col items-center gap-2 group/next",children:[l.jsx("div",{className:`w-20 h-20 rounded-[2rem] flex items-center justify-center text-4xl border-2 shadow-2xl transition-all duration-500 ${me?"bg-slate-900/50 border-white/5 grayscale":"bg-indigo-600/20 border-indigo-500/50 shadow-indigo-500/20 hover:scale-110 active:scale-95"}`,children:I.icon}),l.jsx("span",{className:`text-xs font-black uppercase tracking-tight ${me?"text-slate-500":"text-amber-500"}`,children:I.name})]})]}),l.jsx("p",{className:"text-xs text-slate-400 text-center font-medium italic px-6 mt-2",children:me?`Forbedre ${ne} til niv ${V} for  lse opp.`:`Besk ${ne} i landsbyen for  smi din ${I.name}.`})]})})}return null})()]})]})})]})},PG=({weather:t,season:e,hideClouds:n,isInterior:s})=>{const i=_.useMemo(()=>Array.from({length:12}).map((d,f)=>({id:f,top:`${Math.random()*100}%`,delay:Math.random()*60,duration:40+Math.random()*60,scale:.5+Math.random()*1.5,opacity:.1+Math.random()*.3})),[]),r=_.useMemo(()=>Array.from({length:10}).map((d,f)=>({id:f,left:`${Math.random()*100}%`,delay:Math.random()*20,duration:10+Math.random()*20,size:5+Math.random()*10,rotation:Math.random()*360,drift:50+Math.random()*150})),[]),a=_.useMemo(()=>Array.from({length:5}).map((d,f)=>({id:f,left:`${10+Math.random()*80}%`,top:`${-10+Math.random()*40}%`,rotation:f*45+Math.random()*20,delay:f*2})),[]),o=()=>e==="Autumn"?"":e==="Spring"?"":e==="Winter"?"":"",u=100*(t==="Storm"?2.5:t==="Rain"?1.5:1);return l.jsxs("div",{className:"absolute inset-0 pointer-events-none overflow-hidden z-[5]",children:[t==="Clear"&&!s&&l.jsx("div",{className:"absolute inset-0 opacity-40",children:a.map(d=>l.jsx("div",{className:"absolute w-[400px] h-[800px] animate-sunbeam",style:{left:d.left,top:d.top,background:"radial-gradient(ellipse at top, rgba(253, 224, 71, 0.15) 0%, transparent 70%)",transform:`rotate(${d.rotation}deg)`,animationDelay:`${d.delay}s`}},d.id))}),!n&&!s&&l.jsx("div",{className:"absolute inset-0",children:i.map(d=>l.jsx("div",{className:"absolute text-white animate-cloud-drift select-none",style:{top:d.top,fontSize:`${d.scale*4}rem`,opacity:t==="Storm"?d.opacity*2:d.opacity,filter:"blur(8px)",animationDuration:`${t==="Storm"?d.duration/2:d.duration}s`,animationDelay:`-${d.delay}s`,color:t==="Storm"?"#475569":"white"},children:""},d.id))}),t==="Fog"&&!s&&l.jsx("div",{className:"absolute inset-0 bg-slate-400/10 backdrop-blur-[2px] animate-mist"}),!s&&l.jsx("div",{className:"absolute inset-0",children:r.map(d=>l.jsx("div",{className:"absolute animate-particle opacity-0",style:{left:d.left,fontSize:`${d.size}px`,animationDuration:`${d.duration}s`,animationDelay:`${d.delay}s`,filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.1))","--wind-drift":`${u+d.drift}px`,"--wind-rotation":`${720+d.rotation}deg`},children:o()},d.id))}),(t==="Clear"||s)&&l.jsx("div",{className:"absolute inset-0",children:Array.from({length:15}).map((d,f)=>l.jsx("div",{className:"absolute w-1 h-1 bg-white/40 rounded-full animate-dust-float",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDuration:`${6+Math.random()*8}s`,animationDelay:`${Math.random()*10}s`,filter:"blur(1px)"}},`dust-${f}`))}),(t==="Rain"||t==="Storm")&&!s&&l.jsx("div",{className:"absolute inset-0 bg-indigo-900/10 mix-blend-overlay"})]})},BG=({player:t,room:e})=>{const[n,s]=_.useState(Date.now()),{handleAction:i}=OS(e==null?void 0:e.pin,t,(e==null?void 0:e.world)||null,()=>{},()=>{},()=>{},null),[r,a]=_.useState({});_.useEffect(()=>{const m=setInterval(()=>{var b;const g=Date.now();if(s(g),Math.random()<.05){const x=((b=t.activeProcesses)==null?void 0:b.filter(p=>p.type==="CROP"&&p.readyAt>g))||[];if(x.length>0){const p=x[Math.floor(Math.random()*x.length)];if(!r[p.id]){const v=Math.random()>.5?"CROW":"WEED";a(y=>({...y,[p.id]:{type:v,expiresAt:g+1e4}}))}}}a(x=>{const p={...x};let v=!1;return Object.entries(p).forEach(([y,E])=>{E.expiresAt<g&&(delete p[y],v=!0)}),v?p:x})},1e3);return()=>clearInterval(m)},[t.activeProcesses,r]);const o=_.useCallback((m,g)=>{a(b=>{const x={...b};return delete x[m],x}),i({type:"MAINTAIN_CROP",processId:m,subType:g})},[i]),c=t.activeProcesses||[],u=n,d=c.filter(m=>!(!(m.type==="CROP"||m.type==="COOP"||m.type==="MILL"||m.type==="WELL")||m.type==="WELL"&&m.readyAt>0&&u>m.readyAt+1e4)),f=(t.activeBuffs||[]).filter(m=>m.expiresAt>u);if(d.length===0&&f.length===0)return null;d.sort((m,g)=>m.readyAt-g.readyAt);const h=m=>{const g=Math.floor(m/6e4),b=Math.floor(m%6e4/1e3);return`${g}m ${b}s`};return l.jsxs("div",{className:"absolute top-6 right-6 z-[60] flex flex-col gap-2 pointer-events-none items-end",children:[f.map(m=>{const g=Math.max(0,m.expiresAt-u);return l.jsxs("div",{className:"group bg-indigo-900/90 backdrop-blur-md border border-indigo-500/30 rounded-xl p-3 shadow-xl pointer-events-auto flex items-center gap-4 transition-all hover:bg-indigo-900/100 hover:scale-105 animate-in slide-in-from-right-4 duration-300 relative",children:[l.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center border bg-indigo-500/20 border-indigo-500 text-indigo-300",children:l.jsx("span",{className:"text-xl",children:""})}),l.jsxs("div",{className:"flex flex-col min-w-[120px]",children:[l.jsx("span",{className:"text-xs font-bold text-indigo-300 uppercase tracking-wider",children:m.label}),l.jsx("div",{className:"flex items-center gap-2",children:l.jsx("span",{className:"text-sm font-black text-white",children:h(g)})})]}),m.description&&l.jsx("div",{className:"absolute right-full top-1/2 -translate-y-1/2 mr-3 w-48 bg-slate-900/95 border border-indigo-500/30 p-3 rounded-xl shadow-2xl opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none translate-x-2 group-hover:translate-x-0",children:l.jsx("p",{className:"text-[10px] text-indigo-100 leading-tight",children:m.description})})]},m.id)}),d.map(m=>{const g=Math.max(0,m.readyAt-u),b=g<=0;let x="Avling Gror",p=l.jsx(vy,{size:20}),v="Innhsting Klar!";const y=mn[m.itemId];m.type==="COOP"?(x="Hner Spiser",p=l.jsx("span",{className:"text-xl",children:""}),v="Egg klare!"):m.type==="MILL"?(x="Kverner korn",p=l.jsx("span",{className:"text-xl",children:""}),v="Mel klart!"):m.type==="WELL"?(x="Brnnen fyller seg",p=l.jsx("span",{className:"text-xl",children:""}),v="Brnnen er klar!"):y?(p=l.jsx("span",{className:"text-xl",children:y.icon}),x=`${y.label} gror`,v=`${y.label} klar!`):p=b?l.jsx(O0,{size:20}):l.jsx(vy,{size:20});const E=r[m.id],N=!!E&&!b;return l.jsxs("div",{className:`relative bg-slate-900/90 backdrop-blur-md border rounded-xl p-3 shadow-xl pointer-events-auto flex items-center gap-4 transition-all hover:bg-slate-900/95 animate-in slide-in-from-right-4 duration-300 ${m.type==="WELL"&&b?"animate-pulse":""} ${N?"border-rose-500/50 hover:border-rose-400 cursor-pointer group":"border-white/10"}`,onClick:N?()=>o(m.id,E.type):void 0,children:[N&&l.jsx("div",{className:"absolute -top-3 -right-3 z-50 animate-bounce",children:l.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center shadow-lg border-2 border-white ${E.type==="CROW"?"bg-slate-800":"bg-emerald-700"}`,children:l.jsx("span",{className:"text-lg",children:E.type==="CROW"?"":""})})}),m.yieldBonus&&m.yieldBonus>0&&l.jsxs("div",{className:"absolute -bottom-2 -right-2 px-2 py-0.5 bg-emerald-600 text-white text-[10px] font-black rounded-full shadow-lg border border-emerald-400 z-10",children:["+",Math.round(m.yieldBonus*100),"%"]}),l.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center border ${b?"bg-emerald-500/20 border-emerald-500 text-emerald-400 animate-pulse":"bg-slate-800 border-white/10 text-slate-400"}`,children:p}),l.jsxs("div",{className:"flex flex-col min-w-[120px]",children:[l.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:b?v:N?E.type==="CROW"?"Fjern Krke!":"Luk ugress!":x}),l.jsx("div",{className:"flex items-center gap-2",children:l.jsx("span",{className:`text-sm font-black ${b?"text-emerald-400":N?"text-rose-400":"text-white"}`,children:b?"Hent n":h(g)})})]})]},m.id)})]})},Td=({title:t,subtitle:e,icon:n,headerRight:s,children:i,onClose:r,className:a,maxWidth:o})=>(_.useEffect(()=>{const c=u=>{u.key==="Escape"&&r()};return window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[r]),l.jsxs("div",{className:"absolute inset-0 z-40 flex items-center justify-center p-4 md:p-8",children:[l.jsx(De.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:r,className:"absolute inset-0 bg-black/20 backdrop-blur-[1px] cursor-pointer"}),l.jsxs(De.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{type:"spring",stiffness:260,damping:25,mass:1},className:`relative w-full ${o||"max-w-5xl"} max-h-full bg-slate-950/90 backdrop-blur-md border border-white/10 rounded-3xl shadow-2xl overflow-hidden flex flex-col pointer-events-auto will-change-transform`,children:[l.jsxs("div",{className:"flex-none flex justify-between items-center px-6 py-4 border-b border-white/10 bg-gradient-to-r from-white/5 to-transparent min-h-[72px]",children:[l.jsxs("div",{className:"flex items-center gap-5 overflow-hidden",children:[n&&l.jsx("div",{className:"w-12 h-12 bg-white/5 rounded-2xl flex items-center justify-center text-3xl shadow-inner border border-white/5 shrink-0",children:n}),l.jsxs("div",{className:"flex flex-col min-w-0",children:[t&&l.jsx("h2",{className:"text-xl font-display font-black text-white tracking-tighter uppercase truncate",children:t}),e&&l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest truncate opacity-80",children:e})]}),s&&l.jsx("div",{className:"hidden sm:flex items-center pl-4 border-l border-white/10 ml-2",children:s})]}),l.jsx("button",{onClick:r,className:"w-8 h-8 bg-white/5 hover:bg-rose-500/20 text-slate-400 hover:text-rose-500 rounded-full flex items-center justify-center transition-all group",title:"Lukk vindu",children:l.jsx("span",{className:"text-lg group-hover:rotate-90 transition-transform",children:""})})]}),l.jsx("div",{className:`flex-1 overflow-y-auto custom-scrollbar p-6 ${a||""}`,children:i})]})]})),UG=({player:t,activeProcesses:e,onAction:n,onClose:s})=>{const i=e.filter(b=>b.type==="COOP"&&b.locationId==="chicken_coop"),r=i.length>0,a=i[0],[o,c]=_.useState(0);_.useEffect(()=>{if(!a){c(0);return}const b=()=>{const p=Math.max(0,a.readyAt-Date.now());c(p)};b();const x=setInterval(b,1e3);return()=>clearInterval(x)},[a]);const u=r&&o<=0,d=t.resources.grain||0,f=()=>{n({type:"FEED_CHICKENS",locationId:"chicken_coop"})},h=()=>{n({type:"COLLECT_EGGS",locationId:"chicken_coop"})},m=a?a.readyAt-a.startedAt:1,g=a?1-o/m:0;return l.jsx(Td,{title:"Hnsehuset",icon:l.jsx("span",{className:"text-2xl",children:""}),onClose:s,children:l.jsxs("div",{className:"p-6 flex flex-col items-center gap-8 min-h-[400px]",children:[l.jsxs("div",{className:"relative w-full h-48 bg-slate-900/50 rounded-2xl overflow-hidden border border-white/10 flex items-center justify-center",children:[l.jsx("img",{src:"/Simulation_StandAlone_Pro/map_peasant_farm.png",className:"absolute inset-0 w-full h-full object-cover opacity-30 grayscale",alt:"Coop Background"}),l.jsxs("div",{className:"relative z-10 flex gap-4",children:[l.jsx(De.div,{animate:{y:[0,-5,0]},transition:{repeat:1/0,duration:2,ease:"easeInOut"},className:"text-6xl",children:""}),r&&!u&&l.jsx(De.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-6xl",children:""}),u&&l.jsx(De.div,{initial:{scale:0},animate:{scale:[1,1.2,1]},transition:{repeat:1/0,duration:1},className:"text-6xl drop-shadow-[0_0_15px_rgba(251,191,36,0.8)]",children:""})]})]}),l.jsxs("div",{className:"text-center space-y-4 max-w-sm",children:[!r&&l.jsxs(l.Fragment,{children:[l.jsx("h3",{className:"text-xl font-bold text-white",children:"Sultne Hner"}),l.jsx("p",{className:"text-slate-400 text-sm",children:"Hnene kakler utlmodig. Gi dem korn for  starte eggproduksjonen."}),l.jsxs("div",{className:"flex items-center justify-center gap-4 bg-slate-800/50 p-4 rounded-xl border border-white/5",children:[l.jsx(dp,{resource:"grain",amount:d,size:"lg"}),l.jsx("button",{onClick:f,disabled:d<5,className:`
                                        px-6 py-3 rounded-xl font-bold uppercase tracking-wider text-sm transition-all
                                        ${d>=5?"bg-amber-500 hover:bg-amber-400 text-amber-950 shadow-amber-500/20 shadow-lg":"bg-slate-700 text-slate-500 cursor-not-allowed"}
                                    `,children:"Fr Hner (5 Korn)"})]})]}),r&&!u&&l.jsxs(l.Fragment,{children:[l.jsx("h3",{className:"text-xl font-bold text-white",children:"Hnene Spiser"}),l.jsx("p",{className:"text-slate-400 text-sm",children:"Det tar tid  lage gode egg..."}),l.jsx("div",{className:"w-full h-4 bg-slate-800 rounded-full overflow-hidden border border-white/10",children:l.jsx(De.div,{className:"h-full bg-amber-500",initial:{width:`${g*100}%`},animate:{width:`${g*100}%`},transition:{duration:1,ease:"linear"}})}),l.jsxs("p",{className:"font-mono text-amber-400 font-bold",children:[Math.ceil(o/6e4)," minutter igjen"]})]}),u&&l.jsxs(l.Fragment,{children:[l.jsx("h3",{className:"text-xl font-bold text-white",children:"Eggene er klare!"}),l.jsx("p",{className:"text-slate-400 text-sm",children:"Redet er fullt av ferske egg."}),l.jsx("button",{onClick:h,className:"px-8 py-4 bg-emerald-500 hover:bg-emerald-400 text-white rounded-xl font-black uppercase tracking-widest text-lg shadow-emerald-500/30 shadow-2xl animate-pulse",children:"Samle Egg"})]})]})]})})},HG=({buildingId:t,player:e,room:n,onAction:s})=>{var d,f,h,m;const i=Bt[t];if(!i)return null;const r=t==="farm_house",a=r?((d=e.buildings)==null?void 0:d[t])||{level:1,progress:{}}:((m=(h=(f=n.world)==null?void 0:f.settlement)==null?void 0:h.buildings)==null?void 0:m[t])||{level:1,progress:{},contributions:{}},c=(a.level||1)+1,u=i.levels[c];return l.jsxs("div",{className:"space-y-8 py-4 relative",children:[l.jsxs("div",{className:"bg-slate-900/80 rounded-[2rem] p-8 w-full border border-white/5 text-center relative overflow-hidden",children:[l.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-indigo-500/5 blur-3xl rounded-full -mr-16 -mt-16"}),l.jsxs("p",{className:"text-indigo-300 text-sm font-bold mb-4 uppercase tracking-widest flex items-center justify-center gap-2",children:[l.jsx("span",{className:"w-2 h-2 bg-indigo-500 rounded-full animate-pulse"}),"Bonus ved neste niv: ",(u==null?void 0:u.bonus)||"Maksimal effekt"]}),l.jsxs("p",{className:"text-slate-400 text-sm leading-relaxed italic opacity-80",children:['"',i.description,'"']})]}),u?l.jsxs("div",{className:"w-full space-y-8",children:[l.jsxs("div",{className:"text-left",children:[l.jsxs("div",{className:"text-[10px] font-black text-slate-500 uppercase tracking-[0.2em] mb-4",children:["Byggeprogresjon (Niv ",c,")"]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(u.requirements||{}).map(([g,b])=>{var T,w;const x=Math.floor(((T=a.progress)==null?void 0:T[g])||0),p=Math.min(100,x/b*100),v=Math.floor(((w=e.resources)==null?void 0:w[g])||0),y=b-x,E=v>0&&y>0,N=Math.min(v,y);return l.jsxs("div",{className:"p-5 bg-slate-900/70 rounded-2xl border border-white/5 space-y-3",children:[l.jsxs("div",{className:"flex justify-between items-end",children:[l.jsx("span",{className:"text-xs font-black uppercase text-slate-300 tracking-widest",children:g}),l.jsxs("span",{className:"text-xs font-bold text-slate-500",children:[x," / ",b]})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("div",{className:"h-2.5 bg-black/40 rounded-full overflow-hidden border border-white/5 shadow-inner",children:l.jsx("div",{className:"h-full bg-gradient-to-r from-indigo-600 to-indigo-400 transition-all duration-1000 shadow-[0_0_15px_rgba(79,70,229,0.4)]",style:{width:`${p}%`}})}),y>0?E?l.jsxs("button",{onClick:()=>s({type:"CONTRIBUTE_TO_UPGRADE",buildingId:t,resource:g,amount:N}),className:"w-full py-2 bg-indigo-600/80 hover:bg-indigo-600 text-white text-[10px] font-black rounded-xl transition-all active:scale-95 shadow-lg shadow-indigo-600/20 uppercase tracking-widest",children:["Bidra ",N," ",g]}):l.jsxs("div",{className:"w-full py-2 bg-rose-900/10 border border-rose-500/10 text-rose-500/60 text-[9px] font-black rounded-xl text-center uppercase tracking-widest",children:["Mangler ",g]}):l.jsx("div",{className:"text-[10px] text-emerald-500 font-bold uppercase tracking-widest text-center py-1",children:"Krav mtt "})]})]},g)})})]}),!r&&a.contributions&&Object.keys(a.contributions).length>0&&l.jsxs("div",{className:"w-full bg-indigo-500/5 rounded-3xl p-6 border border-indigo-500/10",children:[l.jsxs("div",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-indigo-400 mb-4 flex items-center gap-2",children:[l.jsx("span",{className:"w-1.5 h-1.5 bg-indigo-500 rounded-full"}),"Siste bidrag fra riket"]}),l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:Object.entries(a.contributions).slice(0,4).map(([g,b])=>l.jsxs("div",{className:"flex justify-between items-center bg-black/20 px-4 py-3 rounded-xl border border-white/5",children:[l.jsx("span",{className:"text-xs font-bold text-slate-200",children:b.name}),l.jsx("div",{className:"flex gap-2",children:Object.entries(b.resources||{}).map(([x,p])=>l.jsxs("span",{className:"text-[10px] font-black text-emerald-400",children:["+",p]},x))})]},g))})]}),Object.entries(u.requirements).every(([b,x])=>{var p;return(((p=a.progress)==null?void 0:p[b])||0)>=x})?l.jsx("button",{onClick:()=>{s({type:"CONTRIBUTE_TO_UPGRADE",buildingId:t,resource:"dummy",amount:0})},className:"w-full py-6 bg-emerald-600 hover:bg-emerald-500 text-white font-black uppercase tracking-widest rounded-[1.5rem] shadow-2xl transition-all active:scale-95 flex items-center justify-center gap-3 animate-bounce mt-4 shadow-emerald-600/20",children:"Fullfr Oppgradering "}):null]}):l.jsxs("div",{className:"py-12 px-10 bg-emerald-500/5 border border-emerald-500/10 rounded-[2.5rem] text-center w-full",children:[l.jsx("div",{className:"text-emerald-400 font-black uppercase tracking-widest text-lg mb-2",children:"Mesterverk fullfrt! "}),l.jsx("div",{className:"text-slate-400 text-sm font-medium",children:"Denne bygningen har ndd sitt maksimale potensial."})]})]})},GG=({npc:t,step:e,setStep:n,onClose:s})=>{var i,r;return l.jsx("div",{className:"absolute inset-0 z-50 bg-black/80 backdrop-blur-sm flex items-center justify-center p-6 animate-in fade-in duration-300",children:l.jsxs("div",{className:"bg-slate-900 border-2 border-amber-600/30 rounded-2xl max-w-lg w-full overflow-hidden shadow-2xl",children:[l.jsxs("div",{className:"bg-slate-950 p-6 border-b border-white/5 flex gap-4 items-center",children:[l.jsx("div",{className:"w-16 h-16 rounded-full bg-slate-800 border-2 border-amber-500/50 flex items-center justify-center text-3xl shadow-inner",children:""}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-xl font-black text-amber-500",children:t.name}),l.jsx("p",{className:"text-sm text-slate-400 italic font-medium",children:t.role})]}),l.jsx("button",{onClick:s,className:"ml-auto w-8 h-8 bg-white/5 hover:bg-white/10 rounded-full flex items-center justify-center text-white transition-colors",children:""})]}),l.jsxs("div",{className:"p-8 space-y-6",children:[l.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-widest mb-2 opacity-50",children:t.description}),l.jsxs("p",{className:"text-slate-300 text-lg leading-relaxed italic border-l-4 border-amber-500/20 pl-4 py-2",children:['"',((i=t.conversation[e])==null?void 0:i.text)||"...",'"']}),l.jsx("div",{className:"grid gap-3 pt-4",children:(r=t.conversation[e])==null?void 0:r.options.map((a,o)=>l.jsxs("button",{onClick:()=>{a.nextId==="EXIT"?s():n(a.nextId)},className:"w-full text-left bg-white/5 hover:bg-amber-500/10 hover:border-amber-500/50 border border-white/10 p-4 rounded-xl transition-all font-medium text-slate-200 active:scale-[0.98]",children:[l.jsx("span",{className:"text-amber-500 mr-2",children:""})," ",a.label]},o))})]})]})})},VG=({viewMode:t,viewingRegionId:e,player:n,onSelect:s,onEnterHub:i,onPOIAction:r,room:a})=>t==="kingdom"?null:l.jsx(l.Fragment,{children:cr.map(o=>{var w,A,k,R;if(!(t==="global"?!o.parentId:o.parentId===t))return null;const u=o.roles.includes(n.role)||o.id==="market"||o.isHub,d=["grain_fields","forest_clearing","mine_shaft","quarry_poi","forest_forage"].includes(o.id),f=t==="global",h=f&&e==="region_ost",m=f&&(e==="region_vest"||e==="capital"),g=t==="village",b=Object.values(a.players||{});let x=o.top,p=o.left;g&&o.village?(x=o.village.top,p=o.village.left):h&&o.ost?(x=o.ost.top,p=o.ost.left):m&&o.vest&&(x=o.vest.top,p=o.vest.left);const v=o.id==="castle",y=v&&b.some(C=>C.role==="BARON"&&C.regionId===e||e==="capital"&&C.role==="KING"),E=v?e==="capital"?"throne_room":e==="region_ost"?"manor_ost":"manor_vest":"",T=(v&&((R=(k=(A=(w=a.world)==null?void 0:w.settlement)==null?void 0:A.buildings)==null?void 0:k[E])==null?void 0:R.level)||0)>=1||y;return l.jsx(De.div,{style:{top:x,left:p},initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"absolute -translate-x-1/2 -translate-y-1/2 group z-20 pointer-events-auto",children:l.jsxs("button",{onClick:()=>{if(v&&!T){r(o.id,"OPEN_CONSTRUCTION");return}o.isHub?i(o.id):s(o)},className:`flex flex-col items-center transition-all ${u?"scale-100":"scale-75 opacity-40 grayscale pointer-events-none"}`,children:[l.jsx("div",{className:"w-16 h-16 rounded-3xl flex items-center justify-center text-4xl shadow-2xl border-2 transition-all duration-300 group-hover:scale-110 bg-slate-900/90 backdrop-blur-xl border-white/10 hover:bg-slate-800",children:o.icon}),l.jsx("span",{className:"bg-indigo-600 text-white text-[10px] font-black uppercase tracking-widest px-3 py-1 rounded-full mt-2 shadow-2xl opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap shadow-indigo-600/30",children:d?"KLIKK FOR  STARTE":v?T?"G INN":"BIDRA TIL BYGGING":o.label})]})},o.id)})}),FG=({viewMode:t,viewingRegionId:e,worldEvents:n,onSelect:s})=>t==="kingdom"||!n?null:l.jsx(l.Fragment,{children:Object.values(n).map(i=>{const r=cr.find(m=>m.id===i.locationId);if(!r||!(t==="global"?!r.parentId:r.parentId===t))return null;const o=t==="global",c=o&&e==="region_ost",u=o&&(e==="region_vest"||e==="capital"),d=t==="village";let f=r.top,h=r.left;return d&&r.village?(f=r.village.top,h=r.village.left):c&&r.ost?(f=r.ost.top,h=r.ost.left):u&&r.vest&&(f=r.vest.top,h=r.vest.left),l.jsx(De.div,{style:{top:f,left:h},initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},className:"absolute -translate-x-1/2 -translate-y-[150%] z-30 pointer-events-auto",children:l.jsx("button",{onClick:()=>s(i),className:`w-14 h-14 rounded-full flex items-center justify-center text-3xl shadow-[0_0_30px_rgba(255,255,255,0.4)] border-4 animate-bounce hover:scale-110 transition-transform ${i.type==="RAID"?"bg-rose-600 border-rose-900 text-white":"bg-amber-400 border-amber-700 text-slate-800"}`,children:i.type==="RAID"?"":""})},i.id)})}),zG=({players:t,setViewingRegionId:e,setViewMode:n})=>{const s=Object.values(t||{}),i=s.find(a=>{var o;return a.role==="BARON"&&(a.regionId==="region_vest"||((o=a.regionId)==null?void 0:o.includes("vest")))}),r=s.find(a=>{var o;return a.role==="BARON"&&(a.regionId==="region_ost"||((o=a.regionId)==null?void 0:o.includes("ost")))});return l.jsxs(l.Fragment,{children:[l.jsx(De.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"absolute top-[35%] left-[50%] -translate-x-1/2 -translate-y-1/2 z-30 group pointer-events-auto",children:l.jsxs("button",{onClick:()=>{e("capital"),n("global")},className:"flex flex-col items-center hover:scale-110 transition-transform",children:[l.jsx("div",{className:"text-6xl drop-shadow-[0_0_15px_rgba(255,215,0,0.8)] animate-pulse",children:""}),l.jsx("div",{className:"bg-black/80 text-amber-400 px-4 py-2 rounded-xl mt-2 font-black uppercase tracking-widest text-xs border border-amber-500/50 shadow-xl backdrop-blur-md",children:"Kongeriket"})]})}),l.jsx(De.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"absolute top-[65%] left-[15%] -translate-x-1/2 -translate-y-1/2 z-30 group pointer-events-auto",children:l.jsxs("button",{onClick:()=>{e("region_vest"),n("global")},className:"flex flex-col items-center hover:scale-110 transition-transform",children:[l.jsx("div",{className:"text-5xl drop-shadow-[0_0_10px_rgba(255,255,255,0.5)]",children:""}),l.jsx("div",{className:"bg-black/80 text-indigo-300 px-3 py-1 rounded-xl mt-2 font-bold text-[10px] uppercase tracking-wider border border-white/10 shadow-xl backdrop-blur-md whitespace-nowrap",children:(i==null?void 0:i.name)||"Baroni Vest"})]})}),l.jsx(De.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"absolute top-[65%] left-[85%] -translate-x-1/2 -translate-y-1/2 z-30 group pointer-events-auto",children:l.jsxs("button",{onClick:()=>{e("region_ost"),n("global")},className:"flex flex-col items-center hover:scale-110 transition-transform",children:[l.jsx("div",{className:"text-5xl drop-shadow-[0_0_10px_rgba(255,255,255,0.5)]",children:""}),l.jsx("div",{className:"bg-black/80 text-emerald-300 px-3 py-1 rounded-xl mt-2 font-bold text-[10px] uppercase tracking-wider border border-white/10 shadow-xl backdrop-blur-md whitespace-nowrap",children:(r==null?void 0:r.name)||"Baroni st"})]})})]})},$G=({player:t,room:e,onAction:n,onClose:s,viewingRegionId:i})=>{var N,T,w,A;const r=i==="capital"||t.role==="BARON"||t.role==="KING"?["throne_room","manor_ost","manor_vest"]:i==="region_ost"?["manor_ost"]:["manor_vest"],[a,o]=_.useState(r[0]),c=((T=(N=e.world)==null?void 0:N.settlement)==null?void 0:T.buildings)||{},u=r.filter(k=>c[k]),d=u.includes(a)?a:u[0]||a,f=c[d],h=Bt[d];if(!f||!h)return l.jsx(Td,{title:"Gjenoppbygging",onClose:s,children:l.jsxs("div",{className:"flex flex-col items-center justify-center h-96 text-center p-12",children:[l.jsx("div",{className:"w-16 h-16 bg-slate-900 rounded-full flex items-center justify-center mb-6 text-2xl opacity-50",children:""}),l.jsx("h3",{className:"text-xl font-black text-white italic mb-2",children:"Ingen aktive byggeprosjekter"}),l.jsx("p",{className:"text-slate-500 text-sm max-w-xs",children:"Det er ingen storsltte prosjekter i dette omrdet som krever din hjelp akkurat n. Prv  dra til hovedstaden eller et av baroniene."}),l.jsx("button",{onClick:s,className:"mt-8 px-8 py-3 bg-white/5 hover:bg-white/10 rounded-xl text-[10px] font-black uppercase tracking-widest text-slate-400",children:"Lukk vindu"})]})});const m=(f.level||0)+1,g=((A=(w=h.levels)==null?void 0:w[m])==null?void 0:A.requirements)||{},b=f.contributions||{};let x=0,p=0;Object.entries(g).forEach(([k,R])=>{var C;x+=R,p+=((C=f.progress)==null?void 0:C[k])||0});const v=x>0?p/x*100:0,y=(k,R)=>{n({type:"CONTRIBUTE",buildingId:d,resource:k,amount:R})},E=Object.entries(b).map(([k,R])=>{const C=q.CONTRIBUTION_VALUES;let B=0;return Object.entries(R.resources||{}).forEach(([z,$])=>{B+=$*(C[z]||C.default)}),{id:k,name:R.name,total:B}}).sort((k,R)=>R.total-k.total);return l.jsx(Td,{title:"Gjenoppbygging & Lederskap",onClose:s,children:l.jsxs("div",{className:"max-h-[70vh] overflow-y-auto custom-scrollbar p-1",children:[u.length>1&&l.jsx("div",{className:"flex gap-2 mb-6 bg-slate-900/50 p-1.5 rounded-2xl border border-white/5 w-fit",children:u.map(k=>{var R;return l.jsx("button",{onClick:()=>o(k),className:`px-4 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all ${d===k?"bg-indigo-600 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:((R=Bt[k])==null?void 0:R.name)||k},k)})}),l.jsxs("div",{className:"relative h-48 rounded-3xl overflow-hidden mb-8 group border border-white/5",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-950 via-slate-900/40 to-transparent z-10"}),l.jsx("div",{className:"absolute inset-0 bg-cover bg-center opacity-40 group-hover:scale-105 transition-transform duration-1000 bg-[url('https://images.unsplash.com/photo-1599619351208-3e6c839d6828?q=80&w=2672&auto=format&fit=crop')]"}),l.jsxs("div",{className:"absolute bottom-6 left-8 z-20",children:[l.jsx("h3",{className:"text-3xl font-black text-white italic tracking-tighter uppercase",children:h.name}),l.jsx("p",{className:"text-slate-300 font-medium text-xs max-w-md",children:h.description})]}),l.jsx("div",{className:"absolute top-6 right-8 z-20 bg-emerald-500/20 backdrop-blur-md px-4 py-2 rounded-full border border-emerald-500/30",children:l.jsxs("span",{className:"text-emerald-400 font-black text-xs tabular-nums",children:[v.toFixed(0),"% FULLFRT"]})})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[l.jsx("div",{className:"space-y-6",children:l.jsxs("section",{children:[l.jsx("h4",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mb-4",children:"Mangler for ferdigstillelse"}),l.jsx("div",{className:"space-y-4",children:Object.entries(g).map(([k,R])=>{var U,O,j,I;const C=((U=f.progress)==null?void 0:U[k])||0,B=R,z=Math.min(100,C/B*100),$=C>=B,K=((O=t.resources)==null?void 0:O[k])||0;return l.jsxs("div",{className:`p-4 rounded-2xl border transition-all ${$?"bg-emerald-500/5 border-emerald-500/20":"bg-slate-900/50 border-white/5"}`,children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"text-xl",children:((j=mn[k])==null?void 0:j.icon)||""}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-bold text-white tracking-tight italic",children:((I=mn[k])==null?void 0:I.label)||k}),l.jsxs("p",{className:"text-[10px] text-slate-500 font-medium",children:["Beholdning: ",l.jsx("span",{className:"text-slate-300",children:K})]})]})]}),l.jsx("div",{className:"text-right",children:l.jsxs("span",{className:`text-xs font-black ${$?"text-emerald-400":"text-slate-300"}`,children:[C," / ",B]})})]}),l.jsx("div",{className:"h-1.5 w-full bg-slate-950 rounded-full overflow-hidden mb-4",children:l.jsx("div",{style:{width:`${z}%`},className:`h-full transition-all duration-500 ${$?"bg-emerald-500":"bg-indigo-500"}`})}),!$&&K>0&&l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>y(k,Math.min(10,K)),className:"flex-1 py-2 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl text-[10px] font-black text-white transition-all uppercase",children:"Gi 10"}),l.jsx("button",{onClick:()=>y(k,Math.min(50,K)),className:"flex-1 py-2 bg-indigo-600 hover:bg-indigo-500 rounded-xl text-[10px] font-black text-white transition-all uppercase",children:"Gi 50"})]})]},k)})})]})}),l.jsxs("div",{className:"space-y-8",children:[l.jsxs("section",{className:"bg-slate-900/50 border border-white/5 rounded-[2rem] p-6",children:[l.jsx("h4",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mb-6 px-2",children:"Toppbidragsytere"}),l.jsx("div",{className:"space-y-2",children:E.length===0?l.jsx("div",{className:"text-center py-8 text-slate-500 text-xs italic",children:"Ingen bidrag enda. Bli den frste!"}):E.slice(0,5).map((k,R)=>l.jsxs("div",{className:`flex items-center justify-between p-3 rounded-xl ${R===0?"bg-amber-500/10 border border-amber-500/20":"hover:bg-white/5 transition-colors"}`,children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:`w-6 h-6 rounded-lg flex items-center justify-center text-[10px] font-black ${R===0?"bg-amber-500 text-slate-950":"bg-slate-800 text-slate-400"}`,children:R+1}),l.jsx("span",{className:`text-sm font-bold ${R===0?"text-white":"text-slate-300"}`,children:k.name})]}),l.jsxs("span",{className:"text-xs font-mono text-slate-500",children:[k.total.toLocaleString()," poeng"]})]},k.id))})]}),l.jsxs("section",{className:"bg-indigo-600/10 border border-indigo-500/20 rounded-[2rem] p-6 relative overflow-hidden",children:[l.jsx("div",{className:"absolute -top-4 -right-4 w-24 h-24 bg-indigo-500/10 blur-2xl rounded-full"}),l.jsx("h4",{className:"text-[10px] font-black text-indigo-400 uppercase tracking-widest mb-4",children:"Gevinst"}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("span",{className:"text-4xl",children:a==="throne_room"?"":""}),l.jsxs("div",{children:[l.jsx("p",{className:"text-white font-black italic tracking-tight underline decoration-indigo-500/50",children:a==="throne_room"?"TITTEL: KONGE":"TITTEL: BARON"}),l.jsx("p",{className:"text-slate-400 text-xs mt-1",children:"Spilleren med hyest poengsum ved ferdigstillelse overtar styringen."})]})]})]})]})]})]})})},mA=we.memo(({player:t,room:e,world:n,worldEvents:s,players:i,onAction:r,onOpenMarket:a})=>{var Ie;const o=(n==null?void 0:n.season)||"Spring",{viewMode:c,setViewMode:u,viewingRegionId:d,setViewingRegionId:f,selectedPOI:h,setSelectedPOI:m,selectedEvent:g,setSelectedEvent:b,upgradingBuildingId:x,setUpgradingBuildingId:p,dialogNPC:v,setDialogNPC:y,dialogStep:E,setDialogStep:N,isDiceGameOpen:T,setIsDiceGameOpen:w,isChickenCoopOpen:A,setIsChickenCoopOpen:k,isConstructionOpen:R,setIsConstructionOpen:C,direction:B,handlePOIAction:z}=bG(t,r,a),$=(n==null?void 0:n.weather)||"Clear",U=(()=>{var zt,On,Mt,Yn,pn,Hi,Gi;const V=Ss(((zt=e.world)==null?void 0:zt.gameTick)||0)==="NIGHT",me=o==="Winter";let ne="";switch(c){case"kingdom":ne=me?V?"map_kingdom_169_winter_night":"map_kingdom_169_winter":V?"map_kingdom_169_night":"map_kingdom_169";break;case"village":ne=me?V?"map_village_hub_1610_winter_night":"map_village_hub_1610_winter":V?"map_village_hub_1610_night":"map_village_hub_1610";break;case"castle":ne="map_castle_interior";break;case"fields":ne=me?V?"map_farm_fields_winter_night":"map_farm_fields_winter":V?"map_farm_fields_night":"map_farm_fields";break;case"peasant_farm":{const qn=((Yn=(Mt=(On=n==null?void 0:n.settlement)==null?void 0:On.buildings)==null?void 0:Mt.farm_house)==null?void 0:Yn.level)||1;ne=qn>1?`map_peasant_farm_lvl${qn}`:"map_peasant_farm";break}case"farm_house":{const qn=((Gi=(Hi=(pn=n==null?void 0:n.settlement)==null?void 0:pn.buildings)==null?void 0:Hi.farm_house)==null?void 0:Gi.level)||1;ne=qn>1?`map_stugo_interior_lvl${qn}`:"map_stugo_interior";break}case"mine":ne=me?V?"map_mountain_pass_winter_night":"map_mountain_pass_winter":V?"map_mountain_pass_night":"map_mountain_pass";break;case"forest":ne=me?V?"map_forest_winter_night":"map_forest_winter":V?"map_forest_night":"map_forest";break;case"monastery":ne=me?V?"map_monastery_winter_night":"map_monastery_winter":V?"map_monastery_night":"map_monastery";break;case"tavern":ne="map_tavern_interior";break;case"great_forge":ne="map_forge_interior";break;case"bakery":ne="map_bakery_interior";break;case"windmill":ne="map_windmill_interior";break;case"sawmill":ne="map_sawmill_interior";break;case"smeltery":ne="map_smeltery_interior";break;case"weavery":ne="map_weavery_interior";break;case"stables":ne="map_stables_interior";break;case"watchtower":ne="map_watchtower_interior";break;case"well":ne=me?V?"map_well_interior_winter_night":"map_well_interior_winter":V?"map_well_interior_night":"map_well_interior";break;case"apothecary":ne="map_apothecary_interior";break;case"global":d==="region_ost"?ne=me?V?"map_barony_ost_169_winter_night":"map_barony_ost_169_winter":V?"map_barony_ost_169_night":"map_barony_ost_169":d==="capital"?ne=me?V?"map_hovedstad_169_winter_night":"map_hovedstad_169_winter":V?"map_hovedstad_169_night":"map_hovedstad_169":ne=me?V?"map_barony_vest_v2_1610_winter_night":"map_barony_vest_v2_1610_winter":V?"map_barony_vest_v2_1610_night":"map_barony_vest_v2_1610";break;default:ne="map_barony_vest_v2_1610"}const tt="/Simulation_StandAlone_Pro/";return{src:`${tt}${ne}.webp`,placeholder:`${tt}${ne}_tiny.webp`,original:`${tt}${ne}.png`}})(),j=c==="kingdom"||c==="global"&&(d==="region_ost"||d==="capital")?"aspect-video":"aspect-[16/10]",I={initial:V=>({opacity:0,scale:V==="in"?.9:1.1,filter:"blur(10px)"}),animate:{opacity:1,scale:1,filter:"blur(0px)",transition:{duration:.6,ease:[.16,1,.3,1],staggerChildren:.05}},exit:V=>({opacity:0,scale:V==="in"?1.1:.9,filter:"blur(10px)",transition:{duration:.4,ease:[.7,0,.84,0]}})},H=`${c}-${d}`,X=_.useMemo(()=>cr.find(V=>V.id===c),[c]),oe=!!(X!=null&&X.isInterior);return l.jsxs("div",{className:"relative w-full h-full flex flex-col items-center justify-center p-4",children:[l.jsxs("div",{className:`relative w-full max-w-full max-h-full mx-auto ${j} rounded-[2rem] overflow-hidden shadow-[0_0_80px_rgba(0,0,0,0.5)] border-4 border-white/5 bg-slate-950 transition-all duration-1000`,children:[l.jsx(Ei,{mode:"popLayout",custom:B,children:l.jsxs(De.div,{custom:B,variants:I,initial:"initial",animate:"animate",exit:"exit",className:"absolute inset-0 w-full h-full",children:[l.jsxs("div",{className:"w-full h-full relative",children:[l.jsx(hA,{src:U.src,placeholderSrc:U.placeholder,alt:"Map View",className:"w-full h-full",disableMotion:!0}),l.jsx("div",{className:`absolute inset-0 pointer-events-none transition-opacity duration-1000 ${$==="Fog"?"opacity-100 backdrop-blur-sm bg-white/10":"opacity-0"}`})]}),l.jsx(PG,{weather:$,season:o,isInterior:oe}),l.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[c==="kingdom"&&l.jsx(zG,{players:i||{},setViewingRegionId:f,setViewMode:u}),l.jsx(VG,{viewMode:c,viewingRegionId:d,player:t,room:e,onSelect:m,onEnterHub:u,onPOIAction:z}),l.jsx(FG,{viewMode:c,viewingRegionId:d,worldEvents:s,onSelect:b})]})]},H)}),l.jsx(BG,{player:t,room:e}),c!=="kingdom"&&l.jsxs("button",{onClick:()=>{if(c==="global")u("kingdom");else{const V=cr.find(me=>me.id===c);V!=null&&V.parentId?u(V.parentId):u("global")}},className:"absolute top-6 left-6 z-50 px-6 py-3 bg-slate-950/80 backdrop-blur-md border border-white/10 rounded-2xl text-[10px] font-black uppercase tracking-widest text-slate-400 hover:text-white hover:border-white/20 transition-all active:scale-95 flex items-center gap-2 group",children:[l.jsx("span",{className:"text-lg group-hover:-translate-x-1 transition-transform",children:""}),"Tilbake"]}),g&&l.jsx("div",{className:"absolute inset-x-6 bottom-6 z-40 animate-in slide-in-from-bottom-8 duration-500",children:l.jsxs("div",{className:"bg-slate-900/95 backdrop-blur-2xl rounded-[2.5rem] shadow-[0_30px_100px_rgba(0,0,0,0.8)] border border-white/10 p-8",children:[l.jsxs("div",{className:"flex justify-between items-start mb-6",children:[l.jsxs("div",{children:[l.jsx("span",{className:`text-[10px] font-black uppercase tracking-widest px-3 py-1 rounded-full ${g.type==="RAID"?"bg-rose-500/20 text-rose-400":"bg-amber-500/20 text-amber-500"}`,children:g.type==="RAID"?" Akutt Trussel":" Spesielt Oppdrag"}),l.jsx("h3",{className:"text-3xl font-black text-white mt-4 tracking-tighter",children:g.title})]}),l.jsx("button",{onClick:()=>b(null),className:"w-10 h-10 bg-white/5 hover:bg-white/10 text-white rounded-full flex items-center justify-center transition-colors",children:""})]}),l.jsxs("p",{className:"text-sm font-medium text-slate-400 mb-8 leading-relaxed italic opacity-80",children:['"',g.description,'"']}),l.jsx("button",{onClick:()=>{r({type:g.type==="RAID"?"DEFEND":"EXPLORE",eventId:g.id}),b(null)},className:`w-full py-5 rounded-2xl font-black uppercase tracking-widest text-sm shadow-2xl transition-all active:scale-95 ${g.type==="RAID"?"bg-rose-600 text-white shadow-rose-600/20":"bg-amber-500 text-slate-950 shadow-amber-500/20"}`,children:g.type==="RAID"?"TIL VPEN! ":"UTFORSK OMRDET! "})]})}),l.jsx(Ei,{children:h&&l.jsx(LG,{poi:h,player:t,room:e,onAction:V=>z(h.id,V),onClose:()=>m(null),viewingRegionId:d})})]}),l.jsxs(Ei,{children:[x&&l.jsx(Td,{title:"Bygg & Oppgrader",onClose:()=>p(null),children:l.jsx(HG,{buildingId:x,player:t,room:e,onAction:r})}),T&&l.jsx(xG,{playerGold:((Ie=t.resources)==null?void 0:Ie.gold)||0,onClose:()=>w(!1),onPlay:V=>r({type:"PLAY_DICE",...V})}),A&&l.jsx(UG,{player:t,activeProcesses:t.activeProcesses||[],onAction:r,onClose:()=>k(!1)}),v&&l.jsx(GG,{npc:v,step:E,setStep:N,onClose:()=>y(null)}),R&&l.jsx($G,{player:t,room:e,onAction:r,onClose:()=>C(!1),viewingRegionId:d})]})]})},(t,e)=>{var i,r,a,o,c,u;if(((i=t.world)==null?void 0:i.season)!==((r=e.world)==null?void 0:r.season)||((a=t.world)==null?void 0:a.weather)!==((o=e.world)==null?void 0:o.weather))return!1;const n=Ss(((c=t.world)==null?void 0:c.gameTick)||0),s=Ss(((u=e.world)==null?void 0:u.gameTick)||0);return n!==s||t.player.activeProcesses!==e.player.activeProcesses?!1:t.player===e.player&&t.room===e.room&&t.world===e.world&&t.worldEvents===e.worldEvents});mA.displayName="GameMap";const KG=({onClose:t})=>{const{currentTrackId:e,playlist:n,playNext:s,playPrevious:i,toggleIgnoreTrack:r,isIgnored:a,playMusic:o,stopMusic:c}=I0(),[u,d]=_.useState(!!e),f=n.find(m=>m.id===e)||n[0],h=()=>{u&&e?(c(),d(!1)):(e?o(e):s(),d(!0))};return l.jsxs("div",{className:"absolute inset-0 z-50 flex items-center justify-center p-4",children:[l.jsx(De.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:t,className:"absolute inset-0 bg-black/60 backdrop-blur-sm cursor-pointer"}),l.jsxs(De.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",bounce:.3},className:"relative w-full max-w-4xl h-[600px] bg-slate-950/80 backdrop-blur-2xl border border-white/10 rounded-[3rem] shadow-2xl overflow-hidden flex flex-col md:flex-row",children:[l.jsx("button",{onClick:t,className:"absolute top-6 right-6 z-20 p-2 rounded-full bg-white/5 hover:bg-white/10 text-white transition-colors",children:l.jsx(ji,{size:24})}),l.jsxs("div",{className:"flex-1 relative flex flex-col items-center justify-center p-12 bg-gradient-to-br from-indigo-900/40 to-slate-900/40 border-r border-white/5",children:[l.jsx("div",{className:`absolute inset-0 opacity-30 bg-gradient-to-tr ${(f==null?void 0:f.mood)==="Dark"?"from-rose-900/40":"from-indigo-600/20"} to-transparent transition-colors duration-1000`}),l.jsxs("div",{className:"relative z-10 mb-12 group",children:[l.jsxs("div",{className:`w-64 h-64 rounded-full bg-slate-900 border-4 border-white/10 shadow-[0_0_60px_rgba(0,0,0,0.6)] flex items-center justify-center relative overflow-hidden ${u&&e?"animate-[spin_8s_linear_infinite]":""}`,children:[l.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle,rgba(99,102,241,0.2)0%,transparent_70%)]"}),l.jsx("div",{className:"absolute inset-2 rounded-full border border-white/5 opacity-50"}),l.jsx("div",{className:"absolute inset-8 rounded-full border border-white/5 opacity-30"}),l.jsx(v3,{size:64,className:"text-white/20"})]}),l.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:l.jsx("button",{onClick:h,className:"w-20 h-20 bg-white/90 rounded-full flex items-center justify-center shadow-2xl hover:scale-105 active:scale-95 transition-all text-slate-900",children:u&&e?l.jsx(ap,{size:32,fill:"currentColor"}):l.jsx(yd,{size:32,fill:"currentColor",className:"ml-1"})})})]}),l.jsxs("div",{className:"text-center space-y-2 z-10",children:[l.jsx("p",{className:"text-xs font-black uppercase tracking-[0.3em] text-indigo-400",children:"N Spiller"}),l.jsx("h2",{className:"text-3xl font-black text-white tracking-tighter max-w-sm leading-tight",children:f?f.title:"Ingen Musikk"}),(f==null?void 0:f.mood)&&l.jsxs("span",{className:"inline-block px-3 py-1 bg-white/5 rounded-full text-[10px] font-bold text-slate-400 uppercase tracking-widest border border-white/5",children:[f.mood," Mood"]})]})]}),l.jsxs("div",{className:"w-full md:w-[400px] bg-black/20 flex flex-col",children:[l.jsxs("div",{className:"p-8 pb-4 border-b border-white/5 flex items-center justify-between",children:[l.jsxs("h3",{className:"text-sm font-black text-white uppercase tracking-widest flex items-center gap-2",children:[l.jsx(G3,{size:16,className:"text-indigo-400"})," Spilleliste"]}),l.jsxs("span",{className:"text-[10px] font-bold text-slate-500",children:[n.length," Spor"]})]}),l.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 space-y-2",children:n.map((m,g)=>{const b=e===m.id,x=a(m.id);return l.jsxs("div",{className:`group flex items-center justify-between p-4 rounded-xl border transition-all duration-300 ${b?"bg-indigo-600/10 border-indigo-500/50 shadow-lg shadow-indigo-900/20":x?"bg-transparent border-transparent opacity-40 grayscale hover:opacity-100 hover:bg-slate-800/50":"bg-transparent border-transparent hover:bg-white/5 hover:border-white/5"}`,children:[l.jsxs("button",{onClick:()=>{o(m.id),d(!0)},className:"flex items-center gap-4 flex-1 text-left min-w-0",children:[l.jsx("span",{className:`text-xs font-bold w-6 text-center ${b?"text-indigo-400":"text-slate-600"}`,children:b?l.jsx(mP,{size:14,className:"mx-auto animate-pulse"}):g+1}),l.jsx("div",{className:"min-w-0",children:l.jsx("p",{className:`text-sm font-bold truncate ${b?"text-white":"text-slate-400 group-hover:text-slate-200"}`,children:m.title})})]}),l.jsx("button",{onClick:p=>{p.stopPropagation(),r(m.id)},className:`p-2 rounded-lg opacity-0 group-hover:opacity-100 transition-all ${x?"opacity-100 text-rose-400 hover:bg-rose-500/10":"text-slate-500 hover:text-white hover:bg-white/10"}`,title:x?"Gjenoppta":"Ignorer",children:x?l.jsx(x3,{size:16}):l.jsx(_3,{size:16})})]},m.id)})}),l.jsxs("div",{className:"p-6 border-t border-white/5 bg-black/40 flex items-center justify-between",children:[l.jsx("button",{onClick:i,className:"p-4 rounded-full hover:bg-white/5 text-slate-400 hover:text-white transition-colors",children:l.jsx(nP,{size:20})}),l.jsx("div",{className:"h-10 w-[1px] bg-white/5"}),l.jsx("button",{onClick:h,className:"p-4 rounded-full hover:bg-white/5 text-white transition-colors scale-110 active:scale-95",children:u&&e?l.jsx(ap,{size:24,fill:"currentColor"}):l.jsx(yd,{size:24,fill:"currentColor",className:"ml-1"})}),l.jsx("div",{className:"h-10 w-[1px] bg-white/5"}),l.jsx("button",{onClick:s,className:"p-4 rounded-full hover:bg-white/5 text-slate-400 hover:text-white transition-colors",children:l.jsx(iP,{size:20})})]})]})]})]})},YG=({result:t,onClear:e})=>(_.useEffect(()=>{if(t){t.success&&t.utbytte&&t.utbytte.length>0&&t.utbytte.forEach((s,i)=>{s.amount>0&&setTimeout(()=>{Ge.spawnFlyingResource(s.resource,window.innerWidth/2,window.innerHeight/2,window.innerWidth-150,60)},i*200)});const n=setTimeout(()=>{e()},6e3);return()=>clearTimeout(n)}},[t,e]),l.jsx(Ei,{children:t&&l.jsxs(De.div,{initial:{opacity:0,y:-20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},className:"fixed top-[5%] left-1/2 transform -translate-x-1/2 bg-slate-900/95 border-2 border-amber-500/30 p-5 rounded-[2rem] shadow-[0_0_50px_rgba(0,0,0,0.5)] backdrop-blur-md min-w-[300px] text-center z-[300] overflow-hidden",children:[l.jsx("div",{className:"absolute bottom-0 left-0 h-1 bg-amber-500/20 w-full overflow-hidden",children:l.jsx(De.div,{initial:{width:"100%"},animate:{width:"0%"},transition:{duration:7,ease:"linear"},className:"h-full bg-amber-500"})}),l.jsx("button",{onClick:n=>{n.stopPropagation(),e()},className:"absolute top-4 right-4 text-slate-500 hover:text-white transition-colors p-1",children:l.jsx(ji,{className:"w-5 h-5"})}),l.jsxs("div",{className:"relative z-10",children:[l.jsx("div",{className:`text-lg font-black mb-3 tracking-tight ${t.success?"text-white":"text-rose-400"}`,children:t.message}),t.utbytte&&t.utbytte.length>0&&l.jsx("div",{className:"flex flex-wrap justify-center gap-2 mb-3",children:t.utbytte.map((n,s)=>{const i=mn[n.resource]||{label:n.resource,icon:""},r=n.name||i.label,a=n.icon||i.icon,o=n.amount>=0,c=n.jackpot;return l.jsxs(De.div,{initial:{scale:0,y:10},animate:{scale:1,y:0},transition:{delay:.2+s*.1,type:"spring"},className:`flex items-center gap-2 px-4 py-2 rounded-2xl text-sm font-black border shadow-lg ${c?"bg-gradient-to-r from-amber-200 to-yellow-400 border-yellow-300 text-yellow-900 shadow-amber-500/50 animate-pulse":o?"bg-emerald-500/10 border-emerald-500/30 text-emerald-400":"bg-rose-500/10 border-rose-500/30 text-rose-400"}`,children:[l.jsx("span",{className:"text-lg",children:a}),l.jsxs("span",{children:[o?"+":"",n.resource==="gold"?n.amount.toFixed(2):n.amount," ",c&&r]})]},`${n.resource}-${s}`)})}),t.xp&&t.xp.length>0&&l.jsx("div",{className:"flex flex-col gap-2 mb-2",children:t.xp.map((n,s)=>l.jsxs(De.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.4+s*.1},className:"text-xs font-black uppercase tracking-widest text-indigo-400 bg-indigo-500/5 py-1 rounded-lg",children:["+",n.amount," XP ",n.skill,n.levelUp&&l.jsxs(De.div,{initial:{scale:.5,opacity:0,rotate:-5},animate:{scale:[1,1.2,1],opacity:1,rotate:[0,5,-5,0],filter:["brightness(1)","brightness(2)","brightness(1)"]},transition:{duration:.6,times:[0,.5,1],repeat:1/0,repeatType:"reverse"},className:"mt-2 inline-flex items-center gap-2 bg-gradient-to-r from-amber-400 to-amber-600 text-black px-4 py-1.5 rounded-full text-[10px] font-black shadow-[0_0_20px_rgba(245,158,11,0.5)] border border-amber-300/50",children:[l.jsx("span",{children:""}),l.jsx("span",{className:"tracking-[0.2em]",children:"NIV OPPGGRADERT!"}),l.jsx("span",{children:""})]})]},`xp-${s}`))}),t.durability&&t.durability.length>0&&l.jsx("div",{className:"mt-4 pt-4 border-t border-white/5 flex flex-wrap justify-center gap-3",children:t.durability.map((n,s)=>l.jsxs("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider flex items-center gap-1",children:[" ",n.item,": ",l.jsxs("span",{className:n.amount>0?"text-rose-400":"text-emerald-400",children:[n.amount>0?"-":"+",Math.abs(n.amount),"%"]}),n.broken&&l.jsx("span",{className:"text-rose-500 font-black ml-1 animate-pulse",children:"(DELAGT!)"})]},`dura-${s}`))})]})]})})),qG=async(t,e,n,s)=>{if(e===n)return{success:!1,error:"Kan ikke gi gave til deg selv"};const i=D(L,`simulation_rooms/${t}/players/${e}`),r=D(L,`simulation_rooms/${t}/players/${n}`),a=await xe(i),o=await xe(r);if(!a.exists())return{success:!1,error:"Sender finnes ikke"};if(!o.exists())return{success:!1,error:"Mottaker finnes ikke"};const c=a.val(),u=o.val(),d=u.name;if(c.regionId!==u.regionId)return{success:!1,error:"Du kan kun sende gaver til spillere i din region."};let f=!1,h="";if(await Ae(i,b=>{if(b===null)return b;b.resources||(b.resources={});for(const[x,p]of Object.entries(s))if((b.resources[x]||0)<p)return;for(const[x,p]of Object.entries(s))b.resources[x]-=p,h+=`${p} ${x}, `;return f=!0,b}),!f)return{success:!1,error:"Ikke nok ressurser til  sende gaven."};let m=!1;if(await Ae(r,b=>{if(b===null)return b;b.resources||(b.resources={});for(const[x,p]of Object.entries(s))b.resources[x]=(b.resources[x]||0)+p;return m=!0,b}),!m)return console.error("CRITICAL: Gift transaction partial failure. Sender deducted but target failed.",e,n),{success:!1,error:"Transaksjonsfeil: Gaven gikk tapt i posten (Mottaker utilgjengelig i skrivende stund)."};const g=`Sendte gave (${h.slice(0,-2)}) til ${d}.`;return Et(t,`[GAVE] ${c.name} -> ${d}: ${h}`),{success:!0,data:{success:!0,timestamp:Date.now(),message:g}}},WG=async(t,e,n,s,i)=>{const r=D(L,`simulation_rooms/${t}/players/${e}`),a=D(L,`simulation_rooms/${t}/trades`),o=await xe(r),c=await xe(D(L,`simulation_rooms/${t}/players/${n}`));if(!o.exists()||!c.exists())return{success:!1,error:"Spiller finnes ikke"};const u=o.val(),d=c.val(),f=u.name,h=d.name;if(u.regionId!==d.regionId)return{success:!1,error:"Handel er kun tillatt med spillere i din region."};let m=!1;if(await Ae(r,x=>{var p;if(x===null)return x;for(const[v,y]of Object.entries(s))if((((p=x.resources)==null?void 0:p[v])||0)<y)return;for(const[v,y]of Object.entries(s))x.resources[v]-=y;return m=!0,x}),!m)return{success:!1,error:"Ikke nok ressurser til  opprette handelen."};const g=mS(a),b={id:g.key,senderId:e,senderName:f,receiverId:n,receiverName:h,offer:s,demand:i,status:"PENDING",createdAt:Date.now(),expiresAt:Date.now()+1e3*60*60*24};return await Ua(g,b),Et(t,`[HANDEL] ${f} tilbd handel til ${h}.`),{success:!0,message:"Handelstilbud sendt."}},XG=async(t,e,n,s)=>{const i=D(L,`simulation_rooms/${t}/trades/${n}`),r=await xe(i);if(!r.exists())return{success:!1,error:"Handelen finnes ikke lenger."};const a=r.val();if(a.status!=="PENDING")return{success:!1,error:"Handelen er ikke lenger aktiv."};if(a.receiverId!==e&&a.senderId!==e&&!(a.senderId===e&&s==="REJECT"))return{success:!1,error:"Du har ikke tilgang til denne handelen."};if(s==="REJECT"){const o=D(L,`simulation_rooms/${t}/players/${a.senderId}`);return await Ae(o,c=>{if(c===null)return c;c.resources||(c.resources={});for(const[u,d]of Object.entries(a.offer))c.resources[u]=(c.resources[u]||0)+d;return c}),await J(i,{status:a.senderId===e?"CANCELLED":"REJECTED"}),{success:!0,message:"Handel avbrutt/avsltt."}}if(s==="ACCEPT"){const o=D(L,`simulation_rooms/${t}/players/${e}`);let c=!1;if(await Ae(o,d=>{var f;if(d===null)return d;for(const[h,m]of Object.entries(a.demand))if((((f=d.resources)==null?void 0:f[h])||0)<m)return;for(const[h,m]of Object.entries(a.demand))d.resources[h]-=m;for(const[h,m]of Object.entries(a.offer))d.resources[h]=(d.resources[h]||0)+m;return c=!0,d}),!c)return{success:!1,error:"Du har ikke rd til denne handelen."};const u=D(L,`simulation_rooms/${t}/players/${a.senderId}`);return await Ae(u,d=>{if(d===null)return d;d.resources||(d.resources={});for(const[f,h]of Object.entries(a.demand))d.resources[f]=(d.resources[f]||0)+h;return d}),await J(i,{status:"ACCEPTED"}),Et(t,`[HANDEL] ${a.receiverName} godtok handelen fra ${a.senderName}.`),{success:!0,message:"Handel gjennomfrt!"}}},QG=({player:t,room:e,onAction:n,pin:s})=>{const[i,r]=_.useState([]),a=_.useRef({}),o=_.useRef(0),c=_.useMemo(()=>e.messages?Array.isArray(e.messages)?e.messages:Object.values(e.messages).sort((m,g)=>m.timestamp-g.timestamp):[],[e.messages]),u=m=>{r(b=>[...b,m]);const g=m.actions?1e4:5e3;setTimeout(()=>d(m.id),g)},d=m=>{r(g=>g.filter(b=>b.id!==m))},f=async(m,g)=>{const b=await XG(s,t.id,m,g);b&&b.success?(d(`trade-${m}`),u({id:`trade-res-${Date.now()}`,title:g==="ACCEPT"?"Handel Gjennomfrt":"Handel Avsltt",message:b.message||"Transaksjon fullfrt.",type:"TRADE"})):u({id:`trade-err-${Date.now()}`,title:"Feil ved handel",message:(b==null?void 0:b.error)||"Noe gikk galt.",type:"TRADE"})},h=(m,g,b)=>!b[m];return _.useEffect(()=>{const m=e.trades||{},g=a.current;Object.entries(m).forEach(([b,x])=>{if(h(b,x,g)&&x.receiverId===t.id&&x.status==="PENDING"){const p=Object.entries(x.offer).map(([y,E])=>`${E} ${y}`).join(", "),v=Object.entries(x.demand).map(([y,E])=>`${E} ${y}`).join(", ");u({id:`trade-${b}`,title:"Nytt Handelstilbud",message:`${x.senderName} tilbyr ${p} for ${v}.`,type:"TRADE",actions:[{label:"Aksepter",variant:"primary",icon:l.jsx(O0,{size:14}),onClick:()=>f(b,"ACCEPT")},{label:"Forhandle",variant:"neutral",icon:l.jsx(Ol,{size:14}),onClick:()=>{d(`trade-${b}`),alert("Forhandling er ikke implementert enn. Avsl handelen for  sende nytt tilbud.")}},{label:"Avsl",variant:"danger",icon:l.jsx(ji,{size:14}),onClick:()=>f(b,"REJECT")}]})}}),a.current=m},[e.trades,t.id,s]),_.useEffect(()=>{var b;const m=c;if(m.length===0)return;const g=m[m.length-1];if(o.current===0&&m.length>0){o.current=m[m.length-1].timestamp;return}if(g.timestamp>o.current){const x=g.content;if(x.startsWith("[GAVE]")&&x.includes(`-> ${t.name}`)){const v=x.split("->")[0].replace("[GAVE]","").trim(),y=((b=x.split(":")[1])==null?void 0:b.trim())||"";u({id:`gift-${g.timestamp}`,title:`Gave fra ${v}`,message:`Du mottok: ${y}`,type:"GIFT"})}o.current=g.timestamp}},[c,t.name]),i.length===0?null:l.jsx("div",{className:"absolute top-24 right-8 z-[100] flex flex-col gap-4 pointer-events-none",children:i.map(m=>l.jsxs("div",{className:"pointer-events-auto bg-slate-900/95 backdrop-blur-xl border border-white/10 p-4 rounded-xl shadow-2xl flex flex-col gap-3 animate-in slide-in-from-right duration-300 w-96",children:[l.jsxs("div",{className:"flex items-start gap-4",children:[l.jsx("div",{className:`p-3 rounded-lg ${m.type==="GIFT"?"bg-indigo-500/20 text-indigo-400":"bg-emerald-500/20 text-emerald-400"}`,children:m.type==="GIFT"?l.jsx(ES,{size:24}):l.jsx(M0,{size:24})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h4",{className:"font-bold text-white text-sm",children:m.title}),l.jsx("p",{className:"text-slate-400 text-xs mt-1 leading-relaxed",children:m.message})]}),l.jsx("button",{onClick:()=>d(m.id),className:"text-slate-600 hover:text-white transition-colors",children:l.jsx(ji,{size:16})})]}),m.actions&&l.jsx("div",{className:"flex gap-2 pt-2 border-t border-white/5",children:m.actions.map((g,b)=>l.jsxs("button",{onClick:g.onClick,className:`
                                        flex-1 py-2 px-3 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition-all active:scale-95
                                        ${g.variant==="primary"?"bg-emerald-600 hover:bg-emerald-500 text-white shadow-lg shadow-emerald-500/20":""}
                                        ${g.variant==="danger"?"bg-rose-600/20 hover:bg-rose-600/30 text-rose-400 border border-rose-500/30":""}
                                        ${g.variant==="neutral"?"bg-slate-700 hover:bg-slate-600 text-slate-200":""}
                                    `,children:[g.icon,g.label]},b))})]},m.id))})},JG=we.lazy(()=>Gt(()=>import("./SimulationMarket-D4oBpirc.js"),__vite__mapDeps([0,1,2,3])).then(t=>({default:t.SimulationMarket}))),ZG=we.lazy(()=>Gt(()=>import("./SimulationVault-DI9W4Bla.js"),__vite__mapDeps([4,5])).then(t=>({default:t.SimulationVault}))),eV=we.lazy(()=>Gt(()=>import("./SimulationSkills-TfYljZy_.js"),__vite__mapDeps([6,1,7])).then(t=>({default:t.SimulationSkills}))),tV=we.lazy(()=>Gt(()=>import("./SimulationProduction-D-_Sl8TO.js"),__vite__mapDeps([8,2,7])).then(t=>({default:t.SimulationProduction}))),nV=we.lazy(()=>Gt(()=>import("./SimulationActivity--hYSWTrG.js"),[]).then(t=>({default:t.SimulationActivity}))),sV=we.lazy(()=>Gt(()=>import("./SimulationDiplomacy-B0L-ZLTb.js"),[]).then(t=>({default:t.SimulationDiplomacy}))),iV=we.lazy(()=>Gt(()=>import("./SimulationHierarchy-gllXnqL0.js"),__vite__mapDeps([9,10,2,1,3,5])).then(t=>({default:t.SimulationHierarchy}))),rV=we.lazy(()=>Gt(()=>import("./SimulationProfile-BzI8BOrX.js"),__vite__mapDeps([11,3])).then(t=>({default:t.SimulationProfile}))),aV=we.lazy(()=>Gt(()=>import("./SimulationSettings-DqkrJvaz.js"),[]).then(t=>({default:t.SimulationSettings}))),oV=we.lazy(()=>Gt(()=>import("./PoliticalHub-CeVKIVtE.js"),__vite__mapDeps([10,2,1,3,5])).then(t=>({default:t.PoliticalHub}))),lV=we.lazy(()=>Gt(()=>import("./SimulationWarRoom-Dmb0uPmy.js"),__vite__mapDeps([12,2])).then(t=>({default:t.SimulationWarRoom}))),cV=we.lazy(()=>Gt(()=>import("./SiegeEngine-Xf9pdUjs.js"),__vite__mapDeps([13,2])).then(t=>({default:t.SiegeEngine}))),uV=({player:t,room:e,pin:n,onAction:s,actionResult:i,onClearActionResult:r})=>{var b,x;const{activeTab:a,setActiveTab:o,isMusicWindowOpen:c,setMusicWindowOpen:u,viewingRegionId:d}=gf(),[f,h]=we.useState(!1),m=async p=>{if(!f){h(!0);try{await J(D(L,`simulation_rooms/${n}/activeVote/votes`),{[t.id]:p})}catch(v){console.error("Voting failed",v)}finally{setTimeout(()=>h(!1),1500)}}},g=["MAP","PRODUCTION","MARKET","INVENTORY","SKILLS","DIPLOMACY","HIERARCHY","PROFILE","POLITICS"].includes(a);return l.jsxs("div",{className:"flex-1 relative flex flex-col overflow-hidden w-full h-full",children:[l.jsxs("div",{className:`flex-1 relative w-full h-full ${g?"p-4 md:p-6 overflow-hidden flex items-center justify-center":"p-4 md:p-8 overflow-y-auto overflow-x-hidden custom-scrollbar"}`,children:[g&&l.jsx("div",{className:"absolute inset-0 z-0",children:l.jsx(mA,{player:t,room:e,world:e.world,worldEvents:e.worldEvents,players:e.players,onAction:s,onOpenMarket:()=>o("MARKET")})}),l.jsxs(we.Suspense,{fallback:l.jsx("div",{className:"w-full h-full flex items-center justify-center pointer-events-none",children:l.jsx("div",{className:"w-8 h-8 border-2 border-white/20 border-t-white rounded-full animate-spin"})}),children:[(()=>{var y;const p=d||t.regionId||"",v=(y=e.regions[p])==null?void 0:y.activeSiege;return!v||!(a==="SIEGE"||g)?null:l.jsx("div",{className:`absolute inset-0 z-10 ${a!=="SIEGE"?"opacity-20 pointer-events-none blur-sm grayscale":""}`,children:l.jsx(cV,{player:t,siege:v,regionId:p,onAction:s,messages:Array.isArray(e.messages)?e.messages:Object.values(e.messages||{})})})})(),l.jsxs("div",{className:"absolute inset-0 z-20 pointer-events-none flex flex-col items-center justify-center",children:[a==="PRODUCTION"&&l.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-4xl md:h-auto md:max-h-[85vh] overflow-hidden",children:l.jsx(tV,{player:t,room:e,onAction:s,pin:n||""})}),a==="MARKET"&&l.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-5xl md:h-[90vh] overflow-hidden",children:l.jsx(JG,{player:t,market:((b=e.markets)==null?void 0:b[t.regionId||"capital"])||e.market,regions:e.regions,allMarkets:e.markets,onAction:s,pin:n||""})}),a==="INVENTORY"&&l.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-4xl md:h-[80vh] overflow-hidden",children:l.jsx(ZG,{player:t,onAction:s})}),a==="SKILLS"&&l.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-4xl md:h-[80vh] overflow-hidden",children:l.jsx(eV,{player:t})}),a==="DIPLOMACY"&&l.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-4xl md:h-[85vh] overflow-hidden",children:l.jsx(sV,{player:t,diplomacy:e.diplomacy,pin:n||""})}),a==="HIERARCHY"&&l.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-5xl md:h-[85vh] overflow-hidden",children:l.jsx(iV,{players:e.players,currentPlayer:t,regions:e.regions,onAction:s,pin:n||""})}),a==="PROFILE"&&l.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-2xl md:h-[85vh] overflow-hidden",children:l.jsx(rV,{player:t,regions:e.regions||{},allPlayers:e.players||{}})}),a==="POLITICS"&&l.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-6xl md:h-[90vh] overflow-hidden",children:l.jsx(oV,{player:t,room:e,onClose:()=>o("MAP")})}),a==="WAR_ROOM"&&l.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-4xl md:h-[85vh] overflow-hidden",children:l.jsx(lV,{player:t,regions:e.regions,onAction:s,onClose:()=>o("HIERARCHY")})})]}),a!=="MAP"&&!g&&l.jsx("div",{className:"max-w-4xl mx-auto w-full space-y-8 animate-in slide-in-from-bottom-4 duration-500 relative z-20",children:a==="SETTINGS"?l.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-slate-950/40 backdrop-blur-md p-8 animate-in fade-in duration-300",children:l.jsx(aV,{onClose:()=>o("MAP")})}):a==="ACTIVITY"?l.jsx(nV,{messages:e.messages}):null})]})]}),e.activeVote&&!((x=e.activeVote.votes)!=null&&x[t.id])&&l.jsx("div",{className:"absolute bottom-6 right-6 z-[50] w-96 animate-in slide-in-from-right duration-500",children:l.jsxs("div",{className:"bg-slate-900/95 backdrop-blur-xl rounded-2xl border border-indigo-500/50 p-6 shadow-2xl shadow-indigo-500/10",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-white font-bold text-lg leading-tight mb-1",children:"Tinget er satt"}),l.jsx("p",{className:"text-indigo-300 text-xs font-medium uppercase tracking-wider",children:"Avgi din stemme"})]}),l.jsx("div",{className:"bg-indigo-500/20 p-2 rounded-lg",children:l.jsx("span",{className:"text-2xl",children:""})})]}),l.jsxs("div",{className:"mb-6",children:[l.jsx("h4",{className:"text-white font-medium mb-2",children:e.activeVote.title}),l.jsx("p",{className:"text-slate-400 text-sm line-clamp-3 leading-relaxed",children:e.activeVote.description})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("button",{onClick:()=>m("YES"),disabled:f,className:`bg-emerald-600/80 hover:bg-emerald-500 text-white py-3 rounded-xl font-bold text-sm transition-all active:scale-95 flex items-center justify-center gap-2 ${f?"opacity-50 cursor-not-allowed":""}`,children:[l.jsx("span",{children:""})," VEDTA"]}),l.jsxs("button",{onClick:()=>m("NO"),disabled:f,className:`bg-rose-600/80 hover:bg-rose-500 text-white py-3 rounded-xl font-bold text-sm transition-all active:scale-95 flex items-center justify-center gap-2 ${f?"opacity-50 cursor-not-allowed":""}`,children:[l.jsx("span",{children:""})," AVSL"]})]})]})}),l.jsx(Ei,{}),l.jsx(Ei,{children:c&&l.jsx(KG,{onClose:()=>u(!1)})}),l.jsx(QG,{player:t,room:e,onAction:s,pin:n||""}),l.jsx(YG,{result:i,onClear:r})]})},dV=()=>{const[t,e]=_.useState([]);return _.useEffect(()=>Ge.subscribe(s=>{e(i=>[...i,s]),setTimeout(()=>{e(i=>i.filter(r=>r.id!==s.id))},s.duration+500)}),[]),l.jsx("div",{className:"fixed inset-0 pointer-events-none z-[200] overflow-hidden",children:l.jsx(Ei,{children:t.map(n=>{if(n.type==="FLOATING_TEXT")return l.jsx(De.div,{initial:{opacity:0,scale:.5,y:0,rotate:(Math.random()-.5)*20},animate:{opacity:1,scale:1.2,y:-120,x:(Math.random()-.5)*40,rotate:(Math.random()-.5)*40},exit:{opacity:0,scale:.8},transition:{duration:.8,ease:"easeOut"},className:`absolute font-black text-4xl drop-shadow-2xl ${n.color||"text-amber-500"}`,style:{left:`${n.x}%`,top:`${n.y}%`,transform:"translate(-50%, -50%)",zIndex:210},children:n.text},n.id);if(n.type==="FLYING_RESOURCE"){const s=mn[n.resource]||{icon:""};return l.jsx(De.div,{initial:{left:`${n.startPoint.x}px`,top:`${n.startPoint.y}px`,scale:.5,opacity:0},animate:{left:`${n.endPoint.x}px`,top:`${n.endPoint.y}px`,scale:[.5,1.5,1],opacity:1},exit:{opacity:0,scale:.5},transition:{duration:1,ease:"easeInOut"},className:"absolute text-4xl z-[220] drop-shadow-xl",children:s.icon},n.id)}return n.type==="PARTICLE"?l.jsx(we.Fragment,{children:[...Array(6)].map((s,i)=>l.jsx(De.div,{initial:{left:`${n.x}%`,top:`${n.y}%`,scale:1,opacity:1},animate:{left:`${n.x+(Math.random()-.5)*15}%`,top:`${n.y+(Math.random()-.5)*15}%`,scale:0,opacity:0},transition:{duration:.6,ease:"easeOut"},className:`absolute w-3 h-3 rounded-sm ${n.color||"bg-amber-400"} z-[205]`},`${n.id}-p-${i}`))},n.id):null})})})},fV=({level:t,title:e,onClose:n})=>l.jsxs("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-500",children:[l.jsx("div",{className:"bg-gradient-to-br from-amber-400 via-amber-500 to-amber-600 p-1 rounded-[2.5rem] shadow-[0_0_50px_rgba(245,158,11,0.5)] animate-in zoom-in duration-500",children:l.jsxs("div",{className:"bg-white rounded-[2.2rem] p-10 text-center relative overflow-hidden max-w-sm",children:[l.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-amber-200 via-yellow-400 to-amber-200"}),l.jsxs("div",{className:"relative z-10",children:[l.jsx("div",{className:"text-7xl mb-6 animate-bounce",children:""}),l.jsx("h2",{className:"text-sm font-black text-amber-600 uppercase tracking-[0.3em] mb-2",children:"Niv Oppndd!"}),l.jsxs("h3",{className:"text-6xl font-black text-slate-800 mb-4",children:["Niv ",t]}),l.jsx("div",{className:"h-0.5 w-16 bg-slate-200 mx-auto mb-6"}),l.jsx("p",{className:"text-slate-500 font-medium mb-1",children:"Ny Tittel:"}),l.jsx("p",{className:"text-3xl font-black text-indigo-600 mb-8",children:e}),l.jsx("button",{onClick:n,className:"w-full bg-slate-900 hover:bg-slate-800 text-white py-5 rounded-2xl font-black text-xl shadow-xl transition-all active:scale-95",children:"FORTSETT REISEN"})]}),l.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-20",children:[...Array(20)].map((s,i)=>l.jsx("div",{className:"absolute w-2 h-2 bg-amber-500 rounded-full animate-ping",style:{top:`${Math.random()*100}%`,left:`${Math.random()*100}%`,animationDelay:`${Math.random()*2}s`,animationDuration:`${2+Math.random()*2}s`}},i))})]})}),l.jsx("style",{dangerouslySetInnerHTML:{__html:`
                    @keyframes ping-slow {
                        0% { transform: scale(1); opacity: 0.8; }
                        100% { transform: scale(3); opacity: 0; }
                    }
                `}})]}),hV=({pin:t,account:e,onCreatePlayer:n,isCreating:s})=>{const i=Qa(),[r,a]=_.useState("WELCOME"),[o,c]=_.useState((e==null?void 0:e.displayName)||""),[u,d]=_.useState("PEASANT");return r==="WELCOME"?l.jsxs("div",{className:"bg-slate-900/40 backdrop-blur-3xl border border-white/5 p-12 md:p-16 rounded-[3.5rem] text-center space-y-10 shadow-2xl animate-in fade-in zoom-in duration-500",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsx("h1",{className:"text-6xl md:text-8xl font-black italic text-white tracking-tighter leading-none",children:"FEUDAL SIM"}),l.jsx("p",{className:"text-indigo-400 font-black uppercase tracking-[0.4em] text-xs",children:"En Levende Simulator"})]}),l.jsx("div",{className:"space-y-6",children:l.jsx("p",{className:"text-slate-400 text-lg md:text-xl font-medium max-w-md mx-auto leading-relaxed",children:"Dette er et spill om makt, ressurser og overlevelse i et feydalt samfunn."})}),l.jsxs("div",{className:"pt-4 space-y-4",children:[l.jsxs("button",{onClick:()=>a("CREATE"),className:"px-12 py-5 bg-indigo-600 hover:bg-indigo-500 text-white rounded-[2rem] font-black uppercase tracking-widest text-sm shadow-2xl shadow-indigo-600/40 transition-all hover:scale-105 active:scale-95 flex items-center justify-center gap-3 mx-auto w-64",children:["Skap din Karakter ",l.jsx(va,{size:20})]}),l.jsx("button",{onClick:()=>i("/sim"),className:"text-slate-500 hover:text-white font-black uppercase tracking-widest text-xs transition-colors",children:"G til Lobby"})]})]}):r==="CREATE"?l.jsxs("div",{className:"bg-slate-900 border border-white/10 p-12 rounded-[3.5rem] shadow-2xl space-y-10 animate-in slide-in-from-bottom-8 duration-500",children:[l.jsxs("div",{className:"text-center space-y-2",children:[l.jsx("h2",{className:"text-4xl font-black italic text-white tracking-tighter uppercase",children:"Hvem er du?"}),l.jsxs("p",{className:"text-slate-500 font-bold uppercase tracking-widest text-xs",children:["Opprett din karakter i ",t]})]}),l.jsxs("div",{className:"space-y-8",children:[l.jsxs("div",{className:"space-y-3",children:[l.jsx("label",{className:"text-xs font-black text-indigo-400 uppercase tracking-[0.2em] ml-2",children:"Ditt Navn i Riket"}),l.jsxs("div",{className:"relative group",children:[l.jsx("div",{className:"absolute inset-y-0 left-6 flex items-center text-slate-500 group-focus-within:text-indigo-400",children:l.jsx(bf,{size:20})}),l.jsx("input",{type:"text",value:o,onChange:f=>c(f.target.value),placeholder:"f.eks. Eirik den Rde",className:"w-full bg-slate-950 border-2 border-white/5 rounded-3xl py-5 pl-16 pr-6 text-xl font-black text-white outline-none focus:border-indigo-500/50 transition-all"})]})]}),t==="TEST"&&l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:["PEASANT","SOLDIER","MERCHANT","BARON"].map(f=>l.jsx("button",{onClick:()=>d(f),className:`py-4 rounded-2xl font-black uppercase tracking-widest text-xs border-2 transition-all ${u===f?"bg-indigo-600/20 border-indigo-500 text-white":"bg-white/5 border-transparent text-slate-500"}`,children:f},f))}),l.jsxs("div",{className:"pt-4 flex gap-4",children:[l.jsx("button",{onClick:()=>a("WELCOME"),className:"flex-1 py-5 bg-white/5 text-slate-400 rounded-3xl font-black uppercase tracking-widest text-xs",children:"Tilbake"}),l.jsx("button",{onClick:()=>{n(o,u),a("SUCCESS")},disabled:!o.trim()||s,className:"flex-[2] py-5 bg-indigo-600 text-white rounded-3xl font-black uppercase tracking-widest text-sm",children:s?"Oppretter...":"Start Reisen"})]})]})]}):l.jsxs("div",{className:"bg-emerald-500/10 backdrop-blur-3xl border border-emerald-500/30 p-16 rounded-[4rem] text-center space-y-8 shadow-2xl animate-in zoom-in duration-500",children:[l.jsx(O0,{size:48,className:"text-white mx-auto bg-emerald-500 rounded-[2rem] p-4 shadow-2xl"}),l.jsx("h2",{className:"text-4xl font-black italic text-white uppercase",children:"Velkommen inn!"})]})},mV={KING:vf,BARON:L0,PEASANT:S3,SOLDIER:op,MERCHANT:wS},pV={KING:["Sikre rikets stabilitet","Samle inn skatter fra baronene","Beskytte 'The Orb of Power'"],BARON:["Administrer din region","Krev inn skatter fra bndene","Bygg opp forsvaret mot invasjoner"],PEASANT:["Dyrk jorden og hst korn","Betal skatt for  unng fengsel","Overlev vinteren"],SOLDIER:["Beskytt riket mot farer","Tren deg opp i kamp","Adlyde ordrer fra Kongen"],MERCHANT:["Kjp og selg varer p markedet","Tjen deg rik p handel","Unng  bli plyndret"]},gV={KING:"Du er den verste lederen. Din makt er absolutt, men ditt ansvar er tungt. Riket hviler p dine skuldre.",BARON:"Du styrer et av rikets store landomrder. Du er bindeleddet mellom Kongen og folket.",PEASANT:"Du er ryggraden i samfunnet. Uten ditt harde arbeid ville riket sultet. Livet er hardt, men rlig.",SOLDIER:"Du er sverdets mester. Din plikt er  beskytte de svake og opprettholde lov og orden.",MERCHANT:"Du forstr verdien av gull. Mens andre slss eller dyrker, bygger du formuer gjennom smart handel."},vV=({player:t,pin:e,onComplete:n})=>{var d,f;const[s,i]=_.useState(0),[r,a]=_.useState(!1),o=mV[t.role]||bf,c=pV[t.role]||["Overlev","Utforsk","Lr"];_.useEffect(()=>{if(s===0){const h=setTimeout(()=>i(1),3e3);return()=>clearTimeout(h)}},[s]);const u=async()=>{a(!0);try{const h={};h[`simulation_rooms/${e}/players/${t.id}/hasSeenIntro`]=!0,await J(D(L),h),setTimeout(n,500)}catch(h){console.error("Failed to save intro state",h),n()}};return s===0?l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-950 text-white animate-in fade-in duration-1000",children:l.jsxs("div",{className:"text-center space-y-8 animate-in zoom-in duration-1000 slide-in-from-bottom-10 fill-mode-forwards",children:[l.jsxs("div",{className:"relative inline-block",children:[l.jsx("div",{className:"absolute inset-0 bg-indigo-500/20 blur-[100px] rounded-full animate-pulse"}),l.jsx(o,{size:120,className:"relative z-10 text-white drop-shadow-[0_0_30px_rgba(255,255,255,0.5)]"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"text-slate-400 font-bold uppercase tracking-[0.5em] text-sm animate-in fade-in delay-500 duration-1000",children:"Skjebnen har valgt..."}),l.jsx("h1",{className:"text-6xl md:text-8xl font-black italic tracking-tighter uppercase animate-in slide-in-from-bottom-5 delay-700 duration-500",children:((d=jl[t.role])==null?void 0:d.label)||t.role})]})]})}):l.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center bg-slate-950/90 backdrop-blur-3xl transition-opacity duration-500 ${r?"opacity-0":"opacity-100"}`,children:l.jsxs("div",{className:"max-w-4xl w-full mx-4 grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-16 items-center",children:[l.jsxs("div",{className:"text-center space-y-8 order-2 md:order-1 animate-in slide-in-from-left-10 duration-700",children:[l.jsxs("div",{className:"relative inline-block p-10 bg-gradient-to-br from-indigo-500/20 to-purple-500/20 rounded-[3rem] border border-white/10 shadow-2xl",children:[l.jsx(o,{size:180,className:"text-white drop-shadow-2xl"}),l.jsx("div",{className:"absolute -bottom-6 left-1/2 -translate-x-1/2 bg-slate-900 border border-white/20 px-6 py-2 rounded-full whitespace-nowrap",children:l.jsx("span",{className:"text-xs font-black uppercase tracking-widest text-indigo-300",children:"Din tildelte rolle"})})]}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-4xl font-black italic tracking-tighter uppercase mb-4",children:(f=jl[t.role])==null?void 0:f.label}),l.jsx("p",{className:"text-slate-400 font-medium leading-relaxed max-w-sm mx-auto",children:gV[t.role]})]})]}),l.jsxs("div",{className:"space-y-8 order-1 md:order-2 animate-in slide-in-from-right-10 duration-700 delay-200",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx("h3",{className:"text-sm font-black uppercase tracking-[0.3em] text-indigo-400",children:"Dine Ml"}),l.jsx("h1",{className:"text-5xl font-black italic tracking-tighter text-white",children:"Oppdrag"})]}),l.jsx("div",{className:"space-y-4",children:c.map((h,m)=>l.jsxs("div",{className:"flex items-center gap-4 bg-white/5 border border-white/5 p-4 rounded-2xl hover:bg-white/10 transition-colors group",children:[l.jsx("div",{className:"w-10 h-10 rounded-full bg-emerald-500/20 flex items-center justify-center text-emerald-400 border border-emerald-500/20 group-hover:scale-110 transition-transform",children:l.jsx("span",{className:"font-black text-sm",children:m+1})}),l.jsx("span",{className:"font-bold text-slate-200",children:h})]},m))}),l.jsx("div",{className:"pt-8",children:l.jsxs("button",{onClick:u,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white py-6 rounded-[2rem] font-black uppercase text-lg tracking-widest shadow-2xl shadow-indigo-600/30 hover:scale-105 active:scale-95 transition-all flex items-center justify-center gap-4 group",children:["Start Din Reise ",l.jsx(va,{className:"group-hover:translate-x-2 transition-transform"})]})})]})]})})},bV=(t,e)=>{const[n,s]=_.useState("global"),[i,r]=_.useState({}),[a,o]=_.useState({}),[c,u]=_.useState(!1);return _.useEffect(()=>{if(!e)return;const d={};if(d.global={id:"global",name:"Riket",type:"GLOBAL",unreadCount:0,description:"Offentlig torg"},e.role==="KING")d.region_vest={id:"region_vest",name:"Vest",type:"REGION",unreadCount:0,description:"Regional kanal for Vest"},d.region_ost={id:"region_ost",name:"st",type:"REGION",unreadCount:0,description:"Regional kanal for st"},d.capital={id:"capital",name:"Hovedstaden",type:"REGION",unreadCount:0,description:"Hovedstaden"};else if(e.regionId){const f=e.regionId==="capital"?"Hovedstaden":e.regionId==="region_vest"?"Vest":e.regionId==="region_ost"?"st":e.regionId;d[e.regionId]={id:e.regionId,name:f,type:"REGION",unreadCount:0,description:"Ditt hjemsted"}}(e.role==="BARON"||e.role==="KING")&&(d.diplomacy={id:"diplomacy",name:"Rdet",type:"DIPLOMACY",unreadCount:0,description:"Hemmelig kanal for ledere"}),r(f=>{const h={...d};return Object.keys(f).forEach(m=>{h[m]&&(h[m].unreadCount=f[m].unreadCount)}),h})},[e==null?void 0:e.regionId,e==null?void 0:e.role]),_.useEffect(()=>{if(!t||!n)return;u(!0);const d=D(L,`simulation_rooms/${t}/channels/${n}/messages`),f=T4(d,S4(50)),h=Ke(f,m=>{const g=m.val(),b=g?Object.values(g):[];b.sort((x,p)=>x.timestamp-p.timestamp),o(x=>({...x,[n]:b})),u(!1)});return()=>h()},[t,n]),{activeChannelId:n,setActiveChannelId:s,channels:i,messages:a[n]||[],isLoading:c}},Yc=(...t)=>t.filter(Boolean).join(" "),xV=({pin:t,player:e,onOpenProfile:n})=>{var p;const[s,i]=_.useState(!1),{activeChannelId:r,setActiveChannelId:a,channels:o,messages:c,isLoading:u}=bV(t,e),[d,f]=_.useState(""),[h,m]=_.useState(!1),g=_.useRef(null);_.useEffect(()=>{g.current&&g.current.scrollIntoView({behavior:"smooth"})},[c,s]),_.useEffect(()=>{const v=y=>{var E;["INPUT","TEXTAREA"].includes(((E=document.activeElement)==null?void 0:E.tagName)||"")||y.key.toLowerCase()==="c"&&i(N=>!N)};return window.addEventListener("keydown",v),()=>window.removeEventListener("keydown",v)},[]);const b=async()=>{if(!d.trim()||h)return;m(!0);const v=await LP(t,e.id,d,r);v.success?f(""):alert(v.error||"Feil ved sending."),m(!1)},x=v=>{switch(v){case"GLOBAL":return l.jsx(P0,{size:14});case"REGION":return l.jsx(NS,{size:14});case"DIPLOMACY":return l.jsx(vf,{size:14,className:"text-amber-400"});case"DM":return l.jsx(D0,{size:14});default:return l.jsx(Ol,{size:14})}};return s?l.jsxs("div",{className:"fixed bottom-6 left-6 z-50 w-[380px] h-[500px] flex flex-col bg-slate-950/95 border border-slate-800/80 rounded-2xl shadow-2xl backdrop-blur-xl animate-in slide-in-from-bottom-10 fade-in duration-300",children:[l.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-slate-800/50 bg-slate-900/50 rounded-t-2xl drag-handle cursor-grab active:cursor-grabbing",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500 animate-pulse"}),l.jsx("span",{className:"text-xs font-bold uppercase tracking-widest text-slate-400",children:"Comms Array"})]}),l.jsx("button",{onClick:()=>i(!1),className:"text-slate-500 hover:text-white transition-colors",children:l.jsx(d3,{size:18})})]}),l.jsx("div",{className:"flex gap-1 p-2 bg-slate-900/30 overflow-x-auto scrollbar-hide",children:Object.values(o).map(v=>l.jsxs("button",{onClick:()=>a(v.id),className:Yc("flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-semibold whitespace-nowrap transition-all",r===v.id?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"bg-slate-800/50 text-slate-400 hover:bg-slate-800 hover:text-slate-200"),children:[x(v.type),v.name]},v.id))}),l.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar bg-gradient-to-b from-slate-950/50 to-transparent",children:[u?l.jsx("div",{className:"flex justify-center p-4",children:l.jsx("div",{className:"w-6 h-6 border-2 border-indigo-500 border-t-transparent rounded-full animate-spin"})}):c.length===0?l.jsx("div",{className:"text-center text-slate-600 text-xs italic mt-10",children:"Ingen meldinger i denne kanalen enn."}):c.map(v=>{const y=v.senderId===e.id;return l.jsxs("div",{className:Yc("flex flex-col gap-1 max-w-[85%]",y?"ml-auto items-end":"mr-auto items-start"),children:[l.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-slate-500 px-1",children:[l.jsx("span",{onClick:()=>n&&n(v.senderId||""),className:Yc("font-bold hover:underline cursor-pointer",y?"text-indigo-400":"text-amber-500"),children:v.senderName}),l.jsxs("span",{className:"opacity-50",children:[" ",new Date(v.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),l.jsxs("div",{className:Yc("px-3 py-2 rounded-2xl text-sm leading-relaxed shadow-sm break-words relative group",y?"bg-indigo-600 text-white rounded-tr-sm":"bg-slate-800 text-slate-200 rounded-tl-sm border border-slate-700/50"),children:[v.content,!y&&v.senderRole!=="PEASANT"&&l.jsx("div",{className:"absolute -top-2 -right-2 bg-slate-950 border border-slate-700 text-[8px] font-black uppercase px-1.5 py-0.5 rounded shadow-xl scale-0 group-hover:scale-100 transition-transform",children:v.senderRole})]})]},v.id)}),l.jsx("div",{ref:g})]}),l.jsx("div",{className:"p-3 bg-slate-900/80 border-t border-slate-800 backdrop-blur-md",children:l.jsxs("div",{className:"relative flex items-center gap-2",children:[l.jsx("input",{value:d,onChange:v=>f(v.target.value),onKeyDown:v=>v.key==="Enter"&&!v.shiftKey&&b(),placeholder:`Melding til #${((p=o[r])==null?void 0:p.name)||"kanal"}...`,className:"flex-1 bg-slate-950 border border-slate-700 rounded-xl px-4 py-2.5 text-sm text-white placeholder:text-slate-600 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500 transition-all shadow-inner",disabled:h}),l.jsx("button",{onClick:b,disabled:!d.trim()||h,className:"bg-indigo-600 hover:bg-indigo-500 text-white p-2.5 rounded-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-indigo-500/20 active:scale-95",children:h?l.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):l.jsx(kS,{size:16})}),e.role!=="KING"&&r==="global"&&l.jsx("div",{className:"absolute -top-6 right-2 text-[10px] text-amber-500 font-mono bg-amber-950/30 px-2 py-0.5 rounded border border-amber-900/50",children:"Kostnad: 2 Gull"})]})})]}):l.jsx("button",{onClick:()=>i(!0),className:"fixed bottom-6 left-6 z-50 bg-slate-900/90 border border-slate-700/50 text-white p-3 rounded-full shadow-2xl hover:bg-indigo-600 hover:scale-105 transition-all group backdrop-blur-md",children:l.jsxs("div",{className:"relative",children:[l.jsx(Ol,{size:24,className:"group-hover:text-white text-slate-200"}),l.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full animate-pulse border-2 border-slate-900"})]})})},G_=["gold","grain","wood","iron_ore","stone","plank","iron_ingot","bread","swords","armor","cloth","wool"],yV=({isOpen:t,onClose:e,myPlayer:n,targetPlayer:s,pin:i})=>{const[r,a]=_.useState({gold:0}),[o,c]=_.useState({gold:0}),[u,d]=_.useState(!1),[f,h]=_.useState(null);if(!t)return null;we.useEffect(()=>{const p=v=>{v.key==="Escape"&&e()};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[e]);const m=async()=>{d(!0),h(null);try{const p=await WG(i,n.id,s.id,r,o);p.success?(h("Handelstilbud sendt!"),setTimeout(e,1500)):(h("Feil: "+p.error),d(!1))}catch(p){console.error(p),h("En ukjent feil oppstod."),d(!1)}},g=(p,v)=>{a(y=>({...y,[p]:Math.max(0,v)}))},b=(p,v)=>{c(y=>({...y,[p]:Math.max(0,v)}))},x=({label:p,values:v,onChange:y,max:E})=>l.jsxs("div",{className:"space-y-2",children:[l.jsx("h4",{className:"text-xs font-bold uppercase text-slate-400 tracking-wider mb-2",children:p}),l.jsxs("div",{className:"space-y-2 max-h-60 overflow-y-auto pr-2 custom-scrollbar",children:[G_.map(N=>{const T=v[N]||0,w=E?E(N):9999;return E&&w<=0&&T<=0?null:l.jsxs("div",{className:"flex items-center gap-2 bg-slate-900/50 p-2 rounded-lg border border-slate-700/50",children:[l.jsx("span",{className:"text-lg w-8 text-center",children:xd[N.toUpperCase()]||""}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:"text-xs text-slate-300 font-medium capitalize truncate",children:N.replace("_"," ")}),E&&l.jsxs("div",{className:"text-[10px] text-slate-500",children:["Du har: ",w]})]}),l.jsx("input",{type:"number",value:T||"",placeholder:"0",onChange:A=>y(N,parseInt(A.target.value)||0),className:"w-20 bg-slate-800 border border-slate-700 rounded px-2 py-1 text-right text-sm font-mono focus:outline-none focus:border-indigo-500"})]},N)}),!E&&l.jsx("div",{className:"text-xs text-slate-500 text-center italic mt-2",children:"Velg hva du krever"})]})]});return l.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:l.jsxs("div",{className:"w-full max-w-4xl bg-slate-900 border border-indigo-500/30 rounded-2xl shadow-2xl flex flex-col max-h-[90vh] overflow-hidden",children:[l.jsxs("div",{className:"p-6 bg-slate-900 border-b border-indigo-500/20 flex justify-between items-center relative overflow-hidden",children:[l.jsx("div",{className:"absolute inset-0 bg-indigo-600/5 opacity-0 group-hover:opacity-100 transition-opacity"}),l.jsxs("div",{children:[l.jsxs("h2",{className:"text-2xl font-black italic text-white flex items-center gap-3",children:[l.jsx(M0,{className:"text-indigo-400"}),"HANDELSKONTRAKT"]}),l.jsxs("p",{className:"text-slate-400 text-sm",children:["Opprett et tilbud til ",l.jsx("span",{className:"text-white font-bold",children:s.name})]})]}),l.jsx("button",{onClick:e,className:"relative z-10 p-2 hover:bg-slate-800 rounded-full transition-colors cursor-pointer",children:l.jsx(ji,{className:"text-slate-400"})})]}),l.jsxs("div",{className:"flex-1 overflow-hidden grid grid-cols-1 md:grid-cols-2 divide-y md:divide-y-0 md:divide-x divide-slate-800 bg-slate-950/50",children:[l.jsx("div",{className:"p-6 overflow-hidden flex flex-col",children:l.jsx(x,{label:"Ditt Tilbud (Assets)",values:r,onChange:g,max:p=>n.resources[p]||0})}),l.jsx("div",{className:"p-6 overflow-hidden flex flex-col",children:l.jsxs("div",{className:"space-y-2 max-h-[60vh] overflow-y-auto pr-2 custom-scrollbar",children:[l.jsx("h4",{className:"text-xs font-bold uppercase text-slate-400 tracking-wider mb-2",children:"Ditt Krav (Liabilities)"}),G_.map(p=>l.jsxs("div",{className:"flex items-center gap-2 bg-slate-900/50 p-2 rounded-lg border border-slate-700/50 hover:border-indigo-500/30 transition-colors",children:[l.jsx("span",{className:"text-lg w-8 text-center opacity-70",children:xd[p.toUpperCase()]||""}),l.jsx("span",{className:"flex-1 text-xs text-slate-300 font-medium capitalize truncate",children:p.replace("_"," ")}),l.jsx("input",{type:"number",value:o[p]||"",placeholder:"0",onChange:v=>b(p,parseInt(v.target.value)||0),className:"w-20 bg-slate-800 border border-slate-700 rounded px-2 py-1 text-right text-sm font-mono focus:outline-none focus:border-indigo-500"})]},p))]})})]}),l.jsxs("div",{className:"p-6 bg-slate-900 border-t border-indigo-500/20 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2 text-yellow-500/80 text-xs",children:[l.jsx(rp,{size:14}),l.jsx("span",{children:"Ressursene trekkes umiddelbart (Escrow)."})]}),l.jsxs("div",{className:"flex items-center gap-4",children:[f&&l.jsx("span",{className:`text-sm font-bold ${f.startsWith("Feil")?"text-red-400":"text-green-400"}`,children:f}),l.jsx("button",{onClick:m,disabled:u||f!==null,className:"px-6 py-3 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-xl flex items-center gap-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-indigo-500/20",children:u?"Signerer...":l.jsxs(l.Fragment,{children:[l.jsx(kS,{size:18}),"Send Kontrakt"]})})]})]})]})})},_V=["gold","grain","wood","iron_ore","bread"],wV=({isOpen:t,onClose:e,myPlayer:n,targetPlayer:s,pin:i})=>{const[r,a]=_.useState("INFO"),[o,c]=_.useState(!1);we.useEffect(()=>{const p=v=>{v.key==="Escape"&&e()};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[e]);const[u,d]=_.useState("gold"),[f,h]=_.useState(0),[m,g]=_.useState(null),b=p=>{switch(p){case"KING":return l.jsx(vf,{size:32,className:"text-yellow-400"});case"BARON":return l.jsx(L0,{size:32,className:"text-purple-400"});case"SOLDIER":return l.jsx(op,{size:32,className:"text-red-400"});case"MERCHANT":return l.jsx(wS,{size:32,className:"text-emerald-400"});default:return l.jsx(bf,{size:32,className:"text-slate-400"})}},x=async()=>{if(f<=0)return;g("Sender...");const p={};p[u]=f;const v=await qG(i,n.id,s.id,p);v.success?(g(`Sendte ${f} ${u}!`),setTimeout(()=>{g(null),a("INFO")},1500)):g("Feil: "+v.error)};return t?o?l.jsx(yV,{isOpen:!0,onClose:()=>c(!1),myPlayer:n,targetPlayer:s,pin:i}):l.jsx("div",{className:"fixed inset-0 z-[50] flex items-center justify-center p-4 bg-slate-950/60 backdrop-blur-sm animate-in fade-in duration-200",children:l.jsxs("div",{className:"w-full max-w-md bg-slate-900 border border-slate-700 rounded-3xl shadow-2xl overflow-hidden flex flex-col relative",children:[l.jsx("div",{className:`h-32 w-full relative bg-gradient-to-br ${s.role==="KING"?"from-yellow-900/40 to-slate-900":"from-indigo-900/40 to-slate-900"}`,children:l.jsx("div",{className:"absolute top-4 right-4",children:l.jsx("button",{onClick:e,className:"p-2 bg-black/20 hover:bg-black/40 rounded-full transition-colors backdrop-blur-sm text-white",children:l.jsx(ji,{size:20})})})}),l.jsxs("div",{className:"px-8 relative -mt-16 mb-4 flex flex-col items-center",children:[l.jsxs("div",{className:"w-32 h-32 rounded-full border-4 border-slate-900 bg-slate-800 flex items-center justify-center shadow-xl relative group overflow-hidden",children:[s.avatar?l.jsx("img",{src:s.avatar,alt:s.name,className:"w-full h-full object-cover"}):b(s.role),l.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"})]}),l.jsx("h2",{className:"text-2xl font-black text-white mt-4",children:s.name}),l.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-sm font-medium uppercase tracking-wider",children:[l.jsx("span",{className:"text-indigo-400",children:s.role}),l.jsx("span",{children:""}),l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx(NS,{size:12})," ",s.regionId||"Ukjent"]})]})]}),l.jsxs("div",{className:"flex-1 px-8 pb-8 space-y-6",children:[r==="INFO"&&l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{className:"bg-slate-950/50 p-4 rounded-2xl border border-slate-800 text-center",children:[l.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-widest font-bold mb-1",children:"Level"}),l.jsx("div",{className:"text-3xl font-black text-white",children:s.stats.level})]}),l.jsxs("div",{className:"bg-slate-950/50 p-4 rounded-2xl border border-slate-800 text-center",children:[l.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-widest font-bold mb-1",children:"Reputasjon"}),l.jsx("div",{className:"text-3xl font-black text-indigo-400",children:s.stats.reputation})]})]}),r==="GIFT"&&l.jsxs("div",{className:"bg-slate-950/50 p-6 rounded-2xl border border-slate-800 space-y-4 animate-in slide-in-from-bottom-4 duration-300",children:[l.jsx("h3",{className:"text-center text-slate-300 font-bold",children:"Send en gave"}),l.jsx("div",{className:"flex gap-2 justify-center",children:_V.map(p=>l.jsx("button",{onClick:()=>d(p),className:`p-2 rounded-lg border transition-all ${u===p?"bg-indigo-600 border-indigo-500":"bg-slate-900 border-slate-700 hover:border-slate-500"}`,children:l.jsx("span",{className:"text-xl",children:xd[p.toUpperCase()]||""})},p))}),l.jsxs("div",{className:"flex items-center gap-2 bg-slate-900 border border-slate-700 rounded-xl px-4 py-2",children:[l.jsx("input",{type:"number",className:"bg-transparent w-full text-center text-xl font-bold focus:outline-none",value:f,onChange:p=>h(parseInt(p.target.value)||0),placeholder:"0"}),l.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase",children:u})]}),l.jsx("button",{onClick:x,disabled:!!m,className:"w-full py-3 bg-emerald-600 hover:bg-emerald-500 text-white rounded-xl font-bold shadow-lg shadow-emerald-500/20 disabled:opacity-50",children:m||"Send Gave"})]}),l.jsx("div",{className:"flex gap-2",children:r==="INFO"?l.jsxs(l.Fragment,{children:[l.jsxs("button",{onClick:()=>a("GIFT"),className:"flex-1 py-3 bg-slate-800 hover:bg-slate-700 text-slate-200 rounded-xl font-bold flex items-center justify-center gap-2 transition-transform active:scale-95",children:[l.jsx(ES,{size:18}),l.jsx("span",{children:"Gave"})]}),l.jsxs("button",{onClick:()=>c(!0),className:"flex-1 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold flex items-center justify-center gap-2 transition-transform active:scale-95 shadow-lg shadow-indigo-500/20",children:[l.jsx(M0,{size:18}),l.jsx("span",{children:"Handel"})]})]}):l.jsx("button",{onClick:()=>a("INFO"),className:"w-full py-3 text-slate-400 hover:text-white font-bold",children:"Avbryt"})}),s.role==="SOLDIER"&&n.role==="SOLDIER"&&l.jsxs("button",{className:"w-full py-2 border border-red-500/30 text-red-400 hover:bg-red-500/10 rounded-xl font-bold uppercase tracking-widest text-xs flex items-center justify-center gap-2",children:[l.jsx(op,{size:14}),"Utfordre til Duell (Kommer snart)"]})]})]})}):null},EV=()=>{const{pin:t}=eN(),[e]=h2(),n=e.get("impersonate"),s=Qa(),{user:i,account:r,loading:a}=pf(),{activeMinigame:o,setActiveMinigame:c,activeMinigameAction:u,setActiveMinigameAction:d,activeMinigameMethod:f,setActiveMinigameMethod:h}=gf(),{setHideHeader:m,setFullWidth:g}=rN();we.useEffect(()=>(m(!0),g(!0),()=>{m(!1),g(!1)}),[m,g]);const{player:b,world:x,players:p,roomStatus:v,markets:y,messages:E,diplomacy:N,activeVote:T,worldEvents:w,trades:A,regions:k,hasAttemptedPlayerLoad:R,isRetired:C}=L6(t,n),{handleAction:B,actionResult:z,handleClearActionResult:$}=OS(t,b,x,c,h,d,o),[K,U]=_.useState(!1),[O,j]=_.useState(null),[I,H]=_.useState(null),X=async(Ie,V)=>{if(!(!t||!i)){U(!0);try{const me=D(L,`simulation_rooms/${t}`),ne=n||i.uid;let tt=Math.random()>.5?"region_ost":"region_vest";V==="BARON"?tt=`region_${ne}`:V==="KING"&&(tt="capital");const zt={id:ne,uid:i.uid,name:Ie,role:V,regionId:tt,resources:Rt[V]||Rt.PEASANT,skills:jn[V]||jn.PEASANT,stats:{xp:0,level:1,reputation:50,contribution:0},status:{hp:100,morale:100,stamina:50,legitimacy:100,authority:50,loyalty:100,isJailed:!1,isFrozen:!1},equipment:ip[V]||ip.PEASANT,upgrades:[],lastActive:Date.now()},On={id:ne,uid:i.uid,name:Ie,role:V,regionId:tt,stats:{level:1},status:{isJailed:!1,isFrozen:!1,legitimacy:100},online:!0,lastActive:Date.now()},Mt={};Mt[`players/${ne}`]=zt,Mt[`public_profiles/${ne}`]=On,await J(me,Mt)}catch(me){console.error("Failed to create player:",me),alert("Kunne ikke opprette karakter.")}finally{U(!1)}}},oe=_.useMemo(()=>({status:v,world:x,players:p||{},messages:E||[],markets:y||{},market:(y&&(b!=null&&b.regionId)?y[b.regionId]:Object.values(y||{})[0])||{},diplomacy:N||{},trades:A||{},activeVote:T,worldEvents:w||{},regions:k||{},settings:"feudal_europe",pin:t||""}),[v,x,p,E,y,N,T,w,A,k,t]);return a||!R?l.jsxs("div",{className:"min-h-screen bg-slate-950 flex flex-col items-center justify-center gap-8 p-12",children:[l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"w-24 h-24 border-4 border-indigo-500/20 rounded-full"}),l.jsx("div",{className:"absolute inset-0 w-24 h-24 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"})]}),l.jsx("h2",{className:"text-2xl font-black italic text-white animate-pulse",children:"Kaller p ndene..."})]}):C?l.jsx("div",{className:"fixed inset-0 z-[100] bg-slate-950/90 backdrop-blur-xl flex items-center justify-center p-6 text-center",children:l.jsxs("div",{className:"max-w-md bg-slate-900 border-2 border-indigo-500/30 rounded-[3rem] p-12 space-y-8 shadow-2xl",children:[l.jsx(uP,{size:48,className:"text-white mx-auto animate-bounce"}),l.jsx("h2",{className:"text-4xl font-black italic text-white",children:"ET LIV ER OVER"}),l.jsx("button",{onClick:()=>s("/sim"),className:"w-full py-4 bg-indigo-600 text-white rounded-2xl font-black uppercase",children:"Tilbake til Lobby"})]})}):b?x?l.jsxs("div",{className:"relative min-h-screen bg-slate-900 text-white overflow-hidden flex flex-col",children:[l.jsx("div",{className:"flex-1 flex flex-col relative",children:l.jsxs("div",{className:"fixed inset-0 top-0 bg-slate-950 text-slate-200 flex overflow-hidden",children:[l.jsx("div",{className:"fixed inset-0 pointer-events-none opacity-20",children:l.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-indigo-600/20 blur-[120px] rounded-full animate-pulse"})}),!b.hasSeenIntro&&l.jsx(vV,{player:b,pin:t||"",onComplete:()=>{b.hasSeenIntro=!0}}),o&&l.jsx(DG,{type:o,playerUpgrades:b.upgrades,equipment:Object.values(b.equipment||{}),skills:b.skills,selectedMethod:f||void 0,action:u,onComplete:Ie=>B({...u||{},performance:Ie,method:f}),onCancel:()=>{c(null),d(null),h(null)},currentSeason:(x==null?void 0:x.season)||"Spring",currentWeather:(x==null?void 0:x.weather)||"Clear",totalTicks:(x==null?void 0:x.totalTicks)||0}),l.jsx(dV,{}),l.jsxs("div",{className:"flex flex-col h-full w-full overflow-hidden",children:[l.jsx(pG,{room:oe,player:b,pin:t,onAction:B}),l.jsx("main",{className:"flex-1 relative overflow-hidden bg-slate-950/50",children:l.jsx(uV,{player:b,room:oe,pin:t,onAction:B,actionResult:z,onClearActionResult:$})})]})]})}),O&&l.jsx(fV,{level:O.level,title:O.title,onClose:()=>j(null)}),l.jsx(xV,{pin:t||"",player:b,onOpenProfile:Ie=>{const V=oe.players[Ie];V?H(V):console.warn("Spiller ikke funnet i rommet:",Ie)}}),I&&l.jsx(wV,{isOpen:!0,onClose:()=>H(null),myPlayer:b,targetPlayer:I,pin:t||""})]}):l.jsxs("div",{className:"min-h-screen bg-slate-950 flex flex-col items-center justify-center gap-4 text-white",children:[l.jsx("div",{className:"w-12 h-12 border-4 border-indigo-500 border-t-white rounded-full animate-spin"}),l.jsx("p",{className:"text-sm font-bold uppercase tracking-widest text-indigo-400",children:"Laster verden..."})]}):l.jsx("div",{className:"min-h-screen bg-slate-950 flex items-center justify-center p-6",children:l.jsx(hV,{pin:t||"",account:r,onCreatePlayer:X,isCreating:K})})},NV=()=>{const[t,e]=_.useState([]),[n,s]=_.useState(!0),[i,r]=_.useState(""),a=Qa();_.useEffect(()=>{const c=D(L,"simulation_server_metadata"),u=Ke(c,d=>{const f=d.val();if(f){const h=Object.values(f);e(h.filter(m=>m.isPublic&&(m.status==="LOBBY"||m.status==="PLAYING")).sort((m,g)=>g.lastUpdated-m.lastUpdated))}else e([]);s(!1)});return()=>u()},[]);const o=t.filter(c=>{var u;return c.pin.includes(i)||((u=c.name)==null?void 0:u.toLowerCase().includes(i.toLowerCase()))||c.hostName.toLowerCase().includes(i.toLowerCase())});return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"relative",children:[l.jsx(W3,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-white/40",size:16}),l.jsx("input",{type:"text",placeholder:"Sk i riker...",value:i,onChange:c=>r(c.target.value),className:"w-full bg-white/5 border border-white/10 focus:border-white/20 rounded-xl py-2.5 pl-10 pr-4 text-sm text-white placeholder:text-white/20 outline-none transition-all"})]}),n?l.jsxs("div",{className:"flex flex-col items-center justify-center p-12 gap-3 opacity-50",children:[l.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),l.jsx("span",{className:"text-[10px] uppercase tracking-widest text-white/50",children:"Laster verdener..."})]}):o.length===0?l.jsx("div",{className:"p-8 text-center border border-white/5 border-dashed rounded-xl",children:l.jsx("p",{className:"text-sm text-white/40 font-medium",children:"Ingen riker funnet."})}):l.jsx("div",{className:"space-y-2",children:o.map(c=>l.jsxs("button",{onClick:()=>a(`/sim/play/${c.pin}`),className:"group w-full flex items-center justify-between p-3 bg-white/5 hover:bg-white/10 border border-white/5 hover:border-white/20 rounded-xl transition-all text-left",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:`w-1.5 h-10 rounded-full ${c.status==="LOBBY"?"bg-emerald-500/50 shadow-[0_0_10px_rgba(16,185,129,0.5)]":"bg-amber-500/50"}`}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("h3",{className:"text-sm font-bold text-white group-hover:text-emerald-300 transition-colors",children:c.name||`Rike #${c.pin}`}),l.jsxs("div",{className:"flex items-center gap-3 text-[10px] font-medium text-white/40 uppercase tracking-widest",children:[l.jsx("span",{children:c.hostName}),l.jsx("span",{className:"w-1 h-1 bg-white/20 rounded-full"}),l.jsxs("span",{children:["PIN: ",c.pin]})]})]})]}),l.jsxs("div",{className:"flex items-center gap-6 pr-2",children:[l.jsxs("div",{className:"flex items-center gap-2 text-white/60",children:[l.jsx(P0,{size:14}),l.jsx("span",{className:"text-xs font-medium tabular-nums",children:c.playerCount})]}),l.jsxs("div",{className:"text-right hidden sm:block",children:[l.jsxs("div",{className:"text-[10px] text-white/30 uppercase tracking-wider",children:["r ",c.worldYear]}),l.jsx("div",{className:"text-[10px] text-white/50",children:c.season})]}),l.jsx("div",{className:"p-2 bg-white/5 rounded-lg text-white/40 group-hover:text-white group-hover:bg-emerald-500/20 transition-all",children:l.jsx(L0,{size:14})})]})]},c.pin))})]})},kV=({isOpen:t,onClose:e,initialMode:n="REGISTER"})=>{const{login:s,register:i,resetPassword:r,checkNameAvailability:a,error:o}=pf(),[c,u]=_.useState(n),[d,f]=_.useState(""),[h,m]=_.useState(""),[g,b]=_.useState(""),[x,p]=_.useState(!1),[v,y]=_.useState(null),[E,N]=_.useState(null),[T,w]=_.useState(null),[A,k]=_.useState(!1);if(_.useEffect(()=>{if(c!=="REGISTER"||g.length<3){w(null);return}const C=setTimeout(async()=>{k(!0);try{const B=await a(g);w(B)}catch(B){console.error(B)}finally{k(!1)}},500);return()=>clearTimeout(C)},[g,c,a]),!t)return null;const R=async C=>{C.preventDefault(),y(null),N(null),p(!0);try{if(c==="LOGIN")await s(d,h),e();else if(c==="REGISTER"){if(T===!1)throw new Error("Navnet er allerede tatt.");await i(d,h,g),e()}else c==="FORGOT"&&(await r(d),N("E-post for tilbakestilling er sendt!"))}catch(B){y(B.message||"Noe gikk galt. Vennligst prv igjen.")}finally{p(!1)}};return l.jsxs("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center p-4",children:[l.jsx("div",{className:"absolute inset-0 bg-slate-950/80 backdrop-blur-sm",onClick:e}),l.jsxs("div",{className:"relative w-full max-w-md bg-slate-900 border border-white/10 rounded-[2.5rem] shadow-2xl overflow-hidden animate-in fade-in zoom-in duration-300",children:[l.jsx("div",{className:"bg-indigo-600 h-2 w-full"}),l.jsxs("div",{className:"p-8 space-y-8",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-3xl font-black italic text-white tracking-tighter uppercase",children:c==="LOGIN"?"Velkommen tilbake":c==="REGISTER"?"Opprett Profil":"Glemt Passord"}),l.jsx("p",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mt-1",children:c==="LOGIN"?"Fortsett din reise i simulation":"Bli en del av historien"})]}),l.jsx("button",{onClick:e,className:"p-2 hover:bg-white/5 rounded-xl transition-colors",children:l.jsx(ji,{className:"text-slate-500",size:20})})]}),l.jsxs("form",{onSubmit:R,className:"space-y-4",children:[c==="REGISTER"&&l.jsxs("div",{className:"space-y-1.5",children:[l.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"Vises som (Unikt navn)"}),l.jsxs("div",{className:"relative group",children:[l.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:l.jsx(bf,{size:18,className:"text-slate-600 group-focus-within:text-indigo-400 transition-colors"})}),l.jsx("input",{type:"text",required:!0,placeholder:"Ditt kallenavn...",className:"w-full bg-slate-950/50 border border-white/5 focus:border-indigo-500/50 rounded-2xl py-3.5 pl-11 pr-4 text-white outline-none transition-all",value:g,onChange:C=>b(C.target.value)}),l.jsx("div",{className:"absolute inset-y-0 right-0 pr-4 flex items-center",children:A?l.jsx(by,{size:16,className:"text-slate-500 animate-spin"}):T===!0?l.jsx(xy,{size:16,className:"text-emerald-500"}):T===!1?l.jsx(rp,{size:16,className:"text-rose-500"}):null})]}),T===!1&&l.jsx("p",{className:"text-[10px] text-rose-400 font-bold px-1 italic",children:"Dette navnet er dessverre opptatt."})]}),l.jsxs("div",{className:"space-y-1.5",children:[l.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"E-post"}),l.jsxs("div",{className:"relative group",children:[l.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:l.jsx(O3,{size:18,className:"text-slate-600 group-focus-within:text-indigo-400 transition-colors"})}),l.jsx("input",{type:"email",required:!0,placeholder:"navn@epost.no",className:"w-full bg-slate-950/50 border border-white/5 focus:border-indigo-500/50 rounded-2xl py-3.5 pl-11 pr-4 text-white outline-none transition-all",value:d,onChange:C=>f(C.target.value)})]})]}),c!=="FORGOT"&&l.jsxs("div",{className:"space-y-1.5",children:[l.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"Passord"}),l.jsxs("div",{className:"relative group",children:[l.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:l.jsx(D0,{size:18,className:"text-slate-600 group-focus-within:text-indigo-400 transition-colors"})}),l.jsx("input",{type:"password",required:!0,placeholder:"Min. 8 tegn...",className:"w-full bg-slate-950/50 border border-white/5 focus:border-indigo-500/50 rounded-2xl py-3.5 pl-11 pr-4 text-white outline-none transition-all",value:h,onChange:C=>m(C.target.value)})]})]}),(v||o)&&l.jsxs("div",{className:"bg-rose-500/10 border border-rose-500/20 p-4 rounded-2xl flex items-center gap-3 text-rose-400",children:[l.jsx(rp,{size:18}),l.jsx("p",{className:"text-xs font-bold",children:v||o})]}),E&&l.jsxs("div",{className:"bg-emerald-500/10 border border-emerald-500/20 p-4 rounded-2xl flex items-center gap-3 text-emerald-400",children:[l.jsx(xy,{size:18}),l.jsx("p",{className:"text-xs font-bold",children:E})]}),l.jsxs("div",{className:"pt-4 space-y-4",children:[l.jsx("button",{type:"submit",disabled:x||c==="REGISTER"&&T===!1,className:"w-full bg-indigo-600 hover:bg-indigo-500 disabled:bg-slate-800 disabled:text-slate-500 text-white rounded-2xl py-4 font-black uppercase tracking-widest text-sm flex items-center justify-center gap-2 transition-all active:scale-95 shadow-lg shadow-indigo-600/20",children:x?l.jsx(by,{className:"animate-spin",size:20}):l.jsxs(l.Fragment,{children:[c==="LOGIN"?"Logg Inn":c==="REGISTER"?"Opprett Profil":"Send E-post",l.jsx(va,{size:18})]})}),l.jsx("div",{className:"flex items-center justify-between px-2",children:c==="LOGIN"?l.jsxs(l.Fragment,{children:[l.jsx("button",{type:"button",onClick:()=>u("REGISTER"),className:"text-[10px] font-black text-indigo-400 uppercase tracking-widest hover:text-white transition-colors",children:"Ny her? Opprett profil"}),l.jsx("button",{type:"button",onClick:()=>u("FORGOT"),className:"text-[10px] font-medium text-slate-500 hover:text-white transition-colors",children:"Glemt passord?"})]}):l.jsx("button",{type:"button",onClick:()=>u("LOGIN"),className:"w-full text-center text-[10px] font-black text-indigo-400 uppercase tracking-widest hover:text-white transition-colors",children:"Har du allerede profil? Logg inn"})})]})]})]})]})]})},SV=()=>{const{user:t,isAnonymous:e,logout:n}=pf(),[s,i]=_.useState(!1),[r,a]=_.useState("LOGIN"),o=Qa(),{startPlaylist:c,resume:u}=I0(),[d,f]=_.useState(!1);_.useEffect(()=>{c()},[c]);const h=()=>{d||(u(),c(),f(!0))},m=g=>{h(),a(g),i(!0)};return l.jsxs("div",{onClick:h,className:"min-h-screen relative font-sans text-slate-200 overflow-x-hidden",children:[l.jsxs("div",{className:"absolute inset-0 z-0",children:[l.jsx("img",{src:"/Simulation_StandAlone_Pro/makthjulet_landingpage_bakgrunn.png",alt:"Background",className:"w-full h-full object-cover"}),l.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-950 via-slate-950/60 to-transparent"}),l.jsx("div",{className:"absolute inset-0 bg-black/40"})]}),l.jsxs("div",{className:"relative z-10 flex flex-col min-h-screen",children:[l.jsxs("header",{className:"w-full px-8 py-8 flex justify-between items-center",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(vf,{className:"text-white/90",size:24,strokeWidth:1.5}),l.jsx("span",{className:"text-sm font-black tracking-[0.2em] text-white/90 uppercase",children:"Simuleringshallen"})]}),l.jsx("div",{className:"flex items-center gap-6 text-xs font-bold tracking-widest uppercase",children:t&&!e?l.jsxs("div",{className:"flex items-center gap-6",children:[l.jsxs("span",{className:"text-white/70",children:["Velkommen, ",l.jsx("span",{className:"text-white",children:t.displayName})]}),l.jsx("button",{onClick:()=>n(),className:"hover:text-amber-400 transition-colors",children:"Logg ut"})]}):l.jsxs("div",{className:"flex items-center gap-6",children:[l.jsx("button",{onClick:()=>m("LOGIN"),className:"hover:text-white transition-colors text-white/70",children:"Logg Inn"}),l.jsx("button",{onClick:()=>m("REGISTER"),className:"px-5 py-2 bg-white/10 hover:bg-white/20 backdrop-blur-sm border border-white/20 rounded-full transition-all text-white",children:"Bli Med"})]})})]}),l.jsxs("main",{className:"flex-1 flex flex-col items-center justify-center w-full max-w-7xl mx-auto px-6 py-12",children:[l.jsxs("div",{className:"text-center mb-16 space-y-6 max-w-3xl",children:[l.jsx("h1",{className:"text-7xl md:text-9xl font-black text-white tracking-tighter leading-none drop-shadow-2xl",children:"MAKTHJULET"}),l.jsx("p",{className:"text-lg md:text-xl text-white/80 font-light tracking-wide max-w-xl mx-auto leading-relaxed",children:"Skjebnen er ikke skrevet. Den smis i ilden av ambisjoner."})]}),l.jsxs("div",{className:"w-full max-w-4xl bg-black/40 backdrop-blur-xl border border-white/10 rounded-3xl p-8 shadow-2xl",children:[l.jsxs("div",{className:"mb-6 flex items-center justify-between border-b border-white/5 pb-4",children:[l.jsxs("h3",{className:"text-xs font-bold tracking-[0.2em] text-white/60 uppercase flex items-center gap-2",children:[l.jsx(yd,{size:12,className:"text-emerald-500"}),"Aktive Verdener"]}),l.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-white/40 uppercase tracking-widest",children:[l.jsx("span",{className:"w-2 h-2 rounded-full bg-emerald-500 animate-pulse"}),"Live Feed"]})]}),l.jsx("div",{className:"max-h-[400px] overflow-y-auto custom-scrollbar",children:l.jsx(NV,{})})]})]}),l.jsxs("footer",{className:"w-full p-8 relative flex justify-center text-[10px] uppercase tracking-[0.2em] text-white/30",children:[l.jsx("span",{children:" 2026 Eiriksbok  Maktens Pris"}),l.jsx("button",{onClick:()=>o("/sim/host"),className:"absolute right-8 bottom-8 text-white/10 hover:text-white/50 transition-colors duration-500 font-bold",children:"Admin"})]})]}),l.jsx(kV,{isOpen:s,onClose:()=>i(!1),initialMode:r})]})},TV=()=>l.jsx(f2,{children:l.jsx(m2,{children:l.jsx(z4,{children:l.jsx($4,{children:l.jsx("div",{className:"min-h-screen bg-slate-950 text-white",children:l.jsxs(l2,{children:[l.jsx(Ao,{path:"/",element:l.jsx(SV,{})}),l.jsx(Ao,{path:"/sim/host",element:l.jsx(D6,{})}),l.jsx(Ao,{path:"/sim/play/:pin/*",element:l.jsx(K4,{children:l.jsx(EV,{})})}),l.jsx(Ao,{path:"*",element:l.jsx(a2,{to:"/",replace:!0})})]})})})})})});class AV extends we.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,n){console.error("Uncaught error:",e,n)}render(){return this.state.hasError?l.jsxs("div",{style:{padding:"2rem",backgroundColor:"#1a1a1a",color:"#ff5555",height:"100vh",fontFamily:"monospace"},children:[l.jsx("h1",{children:"Noe gikk galt (Kritisk Feil)"}),l.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:this.state.error&&this.state.error.toString()+`

`+this.state.error.stack})]}):this.props.children}}gC.createRoot(document.getElementById("root")).render(l.jsx(we.StrictMode,{children:l.jsx(AV,{children:l.jsx(TV,{})})}));export{sp as $,fc as A,eN as B,Rn as C,CV as D,OV as E,DV as F,q as G,S3 as H,MV as I,Te as J,GA as K,bd as L,Ol as M,P0 as N,W3 as O,F3 as P,vf as Q,wr as R,Td as S,oP as T,bf as U,Bt as V,wV as W,J3 as X,fs as Y,vP as Z,va as _,mn as a,RS as a0,we as b,ae as c,J as d,X4 as e,Q4 as f,_ as g,W4 as h,D0 as i,l as j,yy as k,dp as l,De as m,wS as n,op as o,L0 as p,I0 as q,D as r,L as s,mP as t,gf as u,G3 as v,Ei as w,Y3 as x,IV as y,jV as z};
