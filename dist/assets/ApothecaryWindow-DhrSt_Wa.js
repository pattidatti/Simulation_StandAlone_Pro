import{P as T,d as O,h as i,R as V,j as e,S as D,a4 as A,a5 as H,o as W,a as Y,Z as U,w as Z}from"./index-DLzf93r1.js";import{R as X}from"./RecipeCard-CNGgA5XU.js";import{T as J}from"./timer-ClOolqBk.js";/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M4.5 3h15",key:"c7n0jr"}],["path",{d:"M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3",key:"m1uhx7"}],["path",{d:"M6 14h12",key:"4cwo0f"}]],P=T("beaker",K);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],S=T("flask-conical",Q),re=({player:d,room:c,onAction:j})=>{var v,N,w,y,k;const{setActiveTab:L,actionLoading:B}=O(),[a,g]=i.useState(null),[o,F]=i.useState(Date.now());i.useEffect(()=>{const s=setInterval(()=>F(Date.now()),1e3);return()=>clearInterval(s)},[]);const p="apothecary",f=((w=(N=(((v=c==null?void 0:c.world)==null?void 0:v.settlement)||{}).buildings)==null?void 0:N[p])==null?void 0:w.level)||1,x=i.useMemo(()=>Object.entries(V).filter(([s,t])=>t.buildingId===p).map(([s,t])=>[s,t]),[]),G=i.useMemo(()=>{const s={};return x.forEach(([t,r])=>{const n=r.requiredLevel||1;s[n]||(s[n]=[]),s[n].push([t,r])}),Object.entries(s).sort(([t],[r])=>parseInt(t)-parseInt(r))},[x]),l=i.useMemo(()=>{if(!a)return null;const s=x.find(t=>t[0]===a);return s?s[1]:null},[a,x]);i.useEffect(()=>{!a&&x.length>0&&g(x[0][0])},[x,a]);const u=i.useMemo(()=>(d.activeProcesses||[]).filter(s=>s.locationId===p),[d.activeProcesses]),b=i.useMemo(()=>u.find(s=>s.readyAt<=o),[u,o]),m=i.useMemo(()=>a?u.find(s=>s.itemId===a&&s.readyAt>o):null,[u,a,o]),_=()=>{if(b){j({type:"HARVEST",locationId:p});return}!a||!l||(l.requiredLevel||1)>f||j({type:"REFINE",recipeId:a})},$=(s,t)=>({id:s,name:t.label,icon:t.icon||"üß™",description:t.description||`Produserer ${t.label}`});return e.jsx(D,{title:"Apoteket",subtitle:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"opacity-60",children:"Urtemedisin, tinkturer og eliksirer."}),e.jsx("span",{className:"w-1 h-1 bg-white/20 rounded-full"}),e.jsxs("span",{className:"text-emerald-400",children:["Niv√• ",f," Mester-apoteker"]})]}),icon:"üß™",onClose:()=>L("MAP"),maxWidth:"max-w-6xl",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 h-full py-2",children:[e.jsx("div",{className:"flex-1 space-y-8 overflow-y-auto custom-scrollbar pr-2",children:G.map(([s,t])=>{const r=parseInt(s),n=r>f;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:`px-4 py-1 rounded-full text-[10px] font-black tracking-[0.2em] uppercase ${n?"bg-slate-800 text-slate-500":"bg-emerald-600/20 text-emerald-400 border border-emerald-500/30"}`,children:["Tier ",s," ",r===1?"Medisin":r===2?"Tinkturer":"Eliksirer"]}),e.jsx("div",{className:"flex-1 h-px bg-white/5"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map(([h,C])=>{var I,R,E;const q=A(d,{type:"REFINE",recipeId:h},(I=c.world)==null?void 0:I.season,(R=c.world)==null?void 0:R.weather,((E=c.world)==null?void 0:E.gameTick)||0),z=u.some(M=>M.itemId===h&&M.readyAt<=o);return e.jsx(X,{id:h,isSelected:a===h,isLocked:n,canAfford:q.success,isReady:z,info:$(h,C),onSelect:g},h)})})]},s)})}),e.jsx("div",{className:"w-full lg:w-[400px] shrink-0",children:e.jsxs("div",{className:"bg-slate-900/60 backdrop-blur-2xl border border-white/10 rounded-[3rem] p-8 relative overflow-hidden h-full flex flex-col",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-emerald-500/10 blur-[60px] rounded-full -mr-16 -mt-16"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-32 h-32 bg-purple-500/10 blur-[60px] rounded-full -ml-16 -mb-16"}),l?e.jsxs("div",{className:"relative z-10 flex flex-col h-full space-y-6",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsxs("div",{className:"relative inline-block",children:[e.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-emerald-500/20 to-teal-500/20 rounded-[2.5rem] flex items-center justify-center text-6xl shadow-inner border border-white/10 group-hover:scale-105 transition-transform duration-500",children:l.icon}),e.jsx("div",{className:"absolute -top-2 -right-2 bg-emerald-500 rounded-full p-2 shadow-lg shadow-emerald-500/20",children:e.jsx(H,{className:"w-4 h-4 text-white animate-pulse"})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-3xl font-black text-white tracking-tighter",children:l.label}),e.jsx("p",{className:"text-slate-400 text-sm italic font-medium mt-1 leading-relaxed",children:l.description||"En n√∏ye sammensatt brygg som kan endre skjebnen din."})]})]}),e.jsxs("div",{className:"bg-black/40 rounded-3xl p-6 border border-white/5 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500",children:"N√∏dvendige Ingredienser"}),e.jsx(P,{className:"w-3 h-3 text-emerald-500"})]}),e.jsxs("div",{className:"space-y-3",children:[Object.entries(l.input).map(([s,t])=>{var n;const r=d.resources[s]>=t;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{resource:s,size:"sm"}),e.jsx("span",{className:"text-sm font-bold text-slate-300",children:((n=Y[s])==null?void 0:n.label)||s})]}),e.jsxs("span",{className:`text-sm font-black ${r?"text-white":"text-rose-500"}`,children:[d.resources[s]||0," / ",t]})]},s)}),e.jsxs("div",{className:"pt-2 border-t border-white/5 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-7 h-7 bg-amber-500/10 rounded-lg flex items-center justify-center text-xs",children:"‚ö°"}),e.jsx("span",{className:"text-sm font-bold text-slate-300",children:"Stamina"})]}),e.jsxs("span",{className:`text-sm font-black ${d.status.stamina>=(l.stamina||0)?"text-white":"text-rose-500"}`,children:[l.stamina,"‚ö°"]})]})]})]}),e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"bg-emerald-500/5 rounded-2xl p-4 border border-emerald-500/10 flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-emerald-500/20 rounded-xl flex items-center justify-center text-emerald-400",children:e.jsx(J,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] font-black uppercase text-emerald-500/60",children:"Produksjonstid"}),e.jsxs("div",{className:"text-sm font-bold text-white",children:[Math.ceil((l.duration||6e4)/6e4)," minutter"]})]})]}),e.jsxs("div",{className:"bg-purple-500/5 rounded-2xl p-4 border border-purple-500/10 flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-500/20 rounded-xl flex items-center justify-center text-purple-400",children:e.jsx(U,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] font-black uppercase text-purple-500/60",children:"Gevinster"}),e.jsxs("div",{className:"text-xs font-bold text-white",children:["+",l.xp||10," Alkymi XP"]})]})]})]}),e.jsxs(Z,{variant:"primary",size:"lg",className:`h-24 text-xl w-full relative overflow-hidden group transition-all duration-500 ${b?"bg-emerald-600 hover:bg-emerald-500 border-emerald-400/50":"bg-slate-800 hover:bg-slate-700 border-white/10"}`,onClick:_,disabled:!!B||!b&&!m&&((l.requiredLevel||1)>f||!A(d,{type:"REFINE",recipeId:a},(y=c.world)==null?void 0:y.season,(k=c.world)==null?void 0:k.weather).success),children:[m&&e.jsx("div",{className:"absolute inset-0 bg-emerald-500/20 transition-all duration-1000 ease-linear",style:{width:`${Math.min(100,(1-(m.readyAt-o)/(m.duration||1e3))*100)}%`}}),e.jsx("div",{className:"relative z-10 flex flex-col items-center gap-1",children:b?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"w-6 h-6 animate-bounce"}),e.jsx("span",{children:"HENT BRYGG"})]}):m?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-emerald-400 rounded-full animate-ping"}),e.jsxs("span",{className:"font-mono text-3xl",children:[Math.ceil((m.readyAt-o)/1e3),"s"]})]}),e.jsx("span",{className:"text-[10px] uppercase font-black tracking-widest opacity-60 text-emerald-400",children:"Brygging p√•g√•r..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{className:"w-6 h-6 group-hover:rotate-12 transition-transform"}),e.jsx("span",{children:"START BRYGGING"})]}),e.jsx("div",{className:"text-[10px] uppercase font-black tracking-[0.2em] opacity-40",children:"Mini-spill venter"})]})})]})]}):e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center space-y-6 opacity-30",children:[e.jsx(P,{className:"w-20 h-20 text-slate-500"}),e.jsx("p",{className:"text-xl font-black text-slate-400 tracking-tighter",children:"Velg en oppskrift for √• begynne √• brygge."})]})]})})]})})};export{re as ApothecaryWindow};
