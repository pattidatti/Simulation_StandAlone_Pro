const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SimulationMarket-BPWa-msp.js","assets/GameCard-D4DU2RET.js","assets/GameButton-BJIX4TWv.js","assets/Badge-BZGSWCgY.js","assets/SimulationVault-Ck65IOxc.js","assets/timer-CovC_gbK.js","assets/SimulationSkills-Ds2jgMYV.js","assets/chevron-right-z-WQ_u5P.js","assets/SimulationProduction-BTOkKE8N.js","assets/SimulationHierarchy-CpdyNqAu.js","assets/PoliticalHub-BvpYHfXd.js","assets/SimulationProfile-CIovhCEv.js","assets/SimulationWarRoom-jnrLfQZW.js","assets/SiegeEngine-DytfLFS-.js"])))=>i.map(i=>d[i]);
var dA=Object.defineProperty;var fA=(t,e,n)=>e in t?dA(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var $e=(t,e,n)=>fA(t,typeof e!="symbol"?e+"":e,n);function hA(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const i in s)if(i!=="default"&&!(i in t)){const r=Object.getOwnPropertyDescriptor(s,i);r&&Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:()=>s[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();function G_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var V_={exports:{}},Rd={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mA=Symbol.for("react.transitional.element"),pA=Symbol.for("react.fragment");function F_(t,e,n){var s=null;if(n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),"key"in e){n={};for(var i in e)i!=="key"&&(n[i]=e[i])}else n=e;return e=n.ref,{$$typeof:mA,type:t,key:s,ref:e!==void 0?e:null,props:n}}Rd.Fragment=pA;Rd.jsx=F_;Rd.jsxs=F_;V_.exports=Rd;var c=V_.exports,z_={exports:{}},le={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ip=Symbol.for("react.transitional.element"),gA=Symbol.for("react.portal"),vA=Symbol.for("react.fragment"),bA=Symbol.for("react.strict_mode"),xA=Symbol.for("react.profiler"),yA=Symbol.for("react.consumer"),_A=Symbol.for("react.context"),wA=Symbol.for("react.forward_ref"),EA=Symbol.for("react.suspense"),NA=Symbol.for("react.memo"),$_=Symbol.for("react.lazy"),kA=Symbol.for("react.activity"),mv=Symbol.iterator;function SA(t){return t===null||typeof t!="object"?null:(t=mv&&t[mv]||t["@@iterator"],typeof t=="function"?t:null)}var K_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Y_=Object.assign,q_={};function Va(t,e,n){this.props=t,this.context=e,this.refs=q_,this.updater=n||K_}Va.prototype.isReactComponent={};Va.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Va.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function W_(){}W_.prototype=Va.prototype;function Cp(t,e,n){this.props=t,this.context=e,this.refs=q_,this.updater=n||K_}var jp=Cp.prototype=new W_;jp.constructor=Cp;Y_(jp,Va.prototype);jp.isPureReactComponent=!0;var pv=Array.isArray;function Bh(){}var Ve={H:null,A:null,T:null,S:null},X_=Object.prototype.hasOwnProperty;function Op(t,e,n){var s=n.ref;return{$$typeof:Ip,type:t,key:e,ref:s!==void 0?s:null,props:n}}function TA(t,e){return Op(t.type,e,t.props)}function Mp(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ip}function AA(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var gv=/\/+/g;function Sf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?AA(""+t.key):e.toString(36)}function RA(t){switch(t.status){case"fulfilled":return t.value;case"rejected":throw t.reason;default:switch(typeof t.status=="string"?t.then(Bh,Bh):(t.status="pending",t.then(function(e){t.status==="pending"&&(t.status="fulfilled",t.value=e)},function(e){t.status==="pending"&&(t.status="rejected",t.reason=e)})),t.status){case"fulfilled":return t.value;case"rejected":throw t.reason}}throw t}function Pr(t,e,n,s,i){var r=typeof t;(r==="undefined"||r==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(r){case"bigint":case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Ip:case gA:a=!0;break;case $_:return a=t._init,Pr(a(t._payload),e,n,s,i)}}if(a)return i=i(t),a=s===""?"."+Sf(t,0):s,pv(i)?(n="",a!=null&&(n=a.replace(gv,"$&/")+"/"),Pr(i,e,n,"",function(u){return u})):i!=null&&(Mp(i)&&(i=TA(i,n+(i.key==null||t&&t.key===i.key?"":(""+i.key).replace(gv,"$&/")+"/")+a)),e.push(i)),1;a=0;var o=s===""?".":s+":";if(pv(t))for(var l=0;l<t.length;l++)s=t[l],r=o+Sf(s,l),a+=Pr(s,e,n,r,i);else if(l=SA(t),typeof l=="function")for(t=l.call(t),l=0;!(s=t.next()).done;)s=s.value,r=o+Sf(s,l++),a+=Pr(s,e,n,r,i);else if(r==="object"){if(typeof t.then=="function")return Pr(RA(t),e,n,s,i);throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.")}return a}function wc(t,e,n){if(t==null)return t;var s=[],i=0;return Pr(t,s,"","",function(r){return e.call(n,r,i++)}),s}function IA(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var vv=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},CA={map:wc,forEach:function(t,e,n){wc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return wc(t,function(){e++}),e},toArray:function(t){return wc(t,function(e){return e})||[]},only:function(t){if(!Mp(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};le.Activity=kA;le.Children=CA;le.Component=Va;le.Fragment=vA;le.Profiler=xA;le.PureComponent=Cp;le.StrictMode=bA;le.Suspense=EA;le.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Ve;le.__COMPILER_RUNTIME={__proto__:null,c:function(t){return Ve.H.useMemoCache(t)}};le.cache=function(t){return function(){return t.apply(null,arguments)}};le.cacheSignal=function(){return null};le.cloneElement=function(t,e,n){if(t==null)throw Error("The argument must be a React element, but you passed "+t+".");var s=Y_({},t.props),i=t.key;if(e!=null)for(r in e.key!==void 0&&(i=""+e.key),e)!X_.call(e,r)||r==="key"||r==="__self"||r==="__source"||r==="ref"&&e.ref===void 0||(s[r]=e[r]);var r=arguments.length-2;if(r===1)s.children=n;else if(1<r){for(var a=Array(r),o=0;o<r;o++)a[o]=arguments[o+2];s.children=a}return Op(t.type,i,s)};le.createContext=function(t){return t={$$typeof:_A,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null},t.Provider=t,t.Consumer={$$typeof:yA,_context:t},t};le.createElement=function(t,e,n){var s,i={},r=null;if(e!=null)for(s in e.key!==void 0&&(r=""+e.key),e)X_.call(e,s)&&s!=="key"&&s!=="__self"&&s!=="__source"&&(i[s]=e[s]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var o=Array(a),l=0;l<a;l++)o[l]=arguments[l+2];i.children=o}if(t&&t.defaultProps)for(s in a=t.defaultProps,a)i[s]===void 0&&(i[s]=a[s]);return Op(t,r,i)};le.createRef=function(){return{current:null}};le.forwardRef=function(t){return{$$typeof:wA,render:t}};le.isValidElement=Mp;le.lazy=function(t){return{$$typeof:$_,_payload:{_status:-1,_result:t},_init:IA}};le.memo=function(t,e){return{$$typeof:NA,type:t,compare:e===void 0?null:e}};le.startTransition=function(t){var e=Ve.T,n={};Ve.T=n;try{var s=t(),i=Ve.S;i!==null&&i(n,s),typeof s=="object"&&s!==null&&typeof s.then=="function"&&s.then(Bh,vv)}catch(r){vv(r)}finally{e!==null&&n.types!==null&&(e.types=n.types),Ve.T=e}};le.unstable_useCacheRefresh=function(){return Ve.H.useCacheRefresh()};le.use=function(t){return Ve.H.use(t)};le.useActionState=function(t,e,n){return Ve.H.useActionState(t,e,n)};le.useCallback=function(t,e){return Ve.H.useCallback(t,e)};le.useContext=function(t){return Ve.H.useContext(t)};le.useDebugValue=function(){};le.useDeferredValue=function(t,e){return Ve.H.useDeferredValue(t,e)};le.useEffect=function(t,e){return Ve.H.useEffect(t,e)};le.useEffectEvent=function(t){return Ve.H.useEffectEvent(t)};le.useId=function(){return Ve.H.useId()};le.useImperativeHandle=function(t,e,n){return Ve.H.useImperativeHandle(t,e,n)};le.useInsertionEffect=function(t,e){return Ve.H.useInsertionEffect(t,e)};le.useLayoutEffect=function(t,e){return Ve.H.useLayoutEffect(t,e)};le.useMemo=function(t,e){return Ve.H.useMemo(t,e)};le.useOptimistic=function(t,e){return Ve.H.useOptimistic(t,e)};le.useReducer=function(t,e,n){return Ve.H.useReducer(t,e,n)};le.useRef=function(t){return Ve.H.useRef(t)};le.useState=function(t){return Ve.H.useState(t)};le.useSyncExternalStore=function(t,e,n){return Ve.H.useSyncExternalStore(t,e,n)};le.useTransition=function(){return Ve.H.useTransition()};le.version="19.2.3";z_.exports=le;var _=z_.exports;const Ee=G_(_),jA=hA({__proto__:null,default:Ee},[_]);var Q_={exports:{}},Id={},J_={exports:{}},Z_={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(B,j){var O=B.length;B.push(j);e:for(;0<O;){var C=O-1>>>1,F=B[C];if(0<i(F,j))B[C]=j,B[O]=F,O=C;else break e}}function n(B){return B.length===0?null:B[0]}function s(B){if(B.length===0)return null;var j=B[0],O=B.pop();if(O!==j){B[0]=O;e:for(var C=0,F=B.length,Q=F>>>1;C<Q;){var oe=2*(C+1)-1,be=B[oe],H=oe+1,me=B[H];if(0>i(be,O))H<F&&0>i(me,be)?(B[C]=me,B[H]=O,C=H):(B[C]=be,B[oe]=O,C=oe);else if(H<F&&0>i(me,O))B[C]=me,B[H]=O,C=H;else break e}}return j}function i(B,j){var O=B.sortIndex-j.sortIndex;return O!==0?O:B.id-j.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;t.unstable_now=function(){return r.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],u=[],d=1,f=null,h=3,m=!1,v=!1,b=!1,y=!1,p=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;function w(B){for(var j=n(u);j!==null;){if(j.callback===null)s(u);else if(j.startTime<=B)s(u),j.sortIndex=j.expirationTime,e(l,j);else break;j=n(u)}}function N(B){if(b=!1,w(B),!v)if(n(l)!==null)v=!0,T||(T=!0,P());else{var j=n(u);j!==null&&K(N,j.startTime-B)}}var T=!1,E=-1,A=5,k=-1;function R(){return y?!0:!(t.unstable_now()-k<A)}function I(){if(y=!1,T){var B=t.unstable_now();k=B;var j=!0;try{e:{v=!1,b&&(b=!1,g(E),E=-1),m=!0;var O=h;try{t:{for(w(B),f=n(l);f!==null&&!(f.expirationTime>B&&R());){var C=f.callback;if(typeof C=="function"){f.callback=null,h=f.priorityLevel;var F=C(f.expirationTime<=B);if(B=t.unstable_now(),typeof F=="function"){f.callback=F,w(B),j=!0;break t}f===n(l)&&s(l),w(B)}else s(l);f=n(l)}if(f!==null)j=!0;else{var Q=n(u);Q!==null&&K(N,Q.startTime-B),j=!1}}break e}finally{f=null,h=O,m=!1}j=void 0}}finally{j?P():T=!1}}}var P;if(typeof x=="function")P=function(){x(I)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,$=V.port2;V.port1.onmessage=I,P=function(){$.postMessage(null)}}else P=function(){p(I,0)};function K(B,j){E=p(function(){B(t.unstable_now())},j)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(B){B.callback=null},t.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<B?Math.floor(1e3/B):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_next=function(B){switch(h){case 1:case 2:case 3:var j=3;break;default:j=h}var O=h;h=j;try{return B()}finally{h=O}},t.unstable_requestPaint=function(){y=!0},t.unstable_runWithPriority=function(B,j){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var O=h;h=B;try{return j()}finally{h=O}},t.unstable_scheduleCallback=function(B,j,O){var C=t.unstable_now();switch(typeof O=="object"&&O!==null?(O=O.delay,O=typeof O=="number"&&0<O?C+O:C):O=C,B){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=O+F,B={id:d++,callback:j,priorityLevel:B,startTime:O,expirationTime:F,sortIndex:-1},O>C?(B.sortIndex=O,e(u,B),n(l)===null&&B===n(u)&&(b?(g(E),E=-1):b=!0,K(N,O-C))):(B.sortIndex=F,e(l,B),v||m||(v=!0,T||(T=!0,P()))),B},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(B){var j=h;return function(){var O=h;h=j;try{return B.apply(this,arguments)}finally{h=O}}}})(Z_);J_.exports=Z_;var OA=J_.exports,e1={exports:{}},Vt={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MA=_;function t1(t){var e="https://react.dev/errors/"+t;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Gs(){}var Pt={d:{f:Gs,r:function(){throw Error(t1(522))},D:Gs,C:Gs,L:Gs,m:Gs,X:Gs,S:Gs,M:Gs},p:0,findDOMNode:null},DA=Symbol.for("react.portal");function LA(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:DA,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}var Oo=MA.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function Cd(t,e){if(t==="font")return"";if(typeof e=="string")return e==="use-credentials"?e:""}Vt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Pt;Vt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)throw Error(t1(299));return LA(t,e,null,n)};Vt.flushSync=function(t){var e=Oo.T,n=Pt.p;try{if(Oo.T=null,Pt.p=2,t)return t()}finally{Oo.T=e,Pt.p=n,Pt.d.f()}};Vt.preconnect=function(t,e){typeof t=="string"&&(e?(e=e.crossOrigin,e=typeof e=="string"?e==="use-credentials"?e:"":void 0):e=null,Pt.d.C(t,e))};Vt.prefetchDNS=function(t){typeof t=="string"&&Pt.d.D(t)};Vt.preinit=function(t,e){if(typeof t=="string"&&e&&typeof e.as=="string"){var n=e.as,s=Cd(n,e.crossOrigin),i=typeof e.integrity=="string"?e.integrity:void 0,r=typeof e.fetchPriority=="string"?e.fetchPriority:void 0;n==="style"?Pt.d.S(t,typeof e.precedence=="string"?e.precedence:void 0,{crossOrigin:s,integrity:i,fetchPriority:r}):n==="script"&&Pt.d.X(t,{crossOrigin:s,integrity:i,fetchPriority:r,nonce:typeof e.nonce=="string"?e.nonce:void 0})}};Vt.preinitModule=function(t,e){if(typeof t=="string")if(typeof e=="object"&&e!==null){if(e.as==null||e.as==="script"){var n=Cd(e.as,e.crossOrigin);Pt.d.M(t,{crossOrigin:n,integrity:typeof e.integrity=="string"?e.integrity:void 0,nonce:typeof e.nonce=="string"?e.nonce:void 0})}}else e==null&&Pt.d.M(t)};Vt.preload=function(t,e){if(typeof t=="string"&&typeof e=="object"&&e!==null&&typeof e.as=="string"){var n=e.as,s=Cd(n,e.crossOrigin);Pt.d.L(t,n,{crossOrigin:s,integrity:typeof e.integrity=="string"?e.integrity:void 0,nonce:typeof e.nonce=="string"?e.nonce:void 0,type:typeof e.type=="string"?e.type:void 0,fetchPriority:typeof e.fetchPriority=="string"?e.fetchPriority:void 0,referrerPolicy:typeof e.referrerPolicy=="string"?e.referrerPolicy:void 0,imageSrcSet:typeof e.imageSrcSet=="string"?e.imageSrcSet:void 0,imageSizes:typeof e.imageSizes=="string"?e.imageSizes:void 0,media:typeof e.media=="string"?e.media:void 0})}};Vt.preloadModule=function(t,e){if(typeof t=="string")if(e){var n=Cd(e.as,e.crossOrigin);Pt.d.m(t,{as:typeof e.as=="string"&&e.as!=="script"?e.as:void 0,crossOrigin:n,integrity:typeof e.integrity=="string"?e.integrity:void 0})}else Pt.d.m(t)};Vt.requestFormReset=function(t){Pt.d.r(t)};Vt.unstable_batchedUpdates=function(t,e){return t(e)};Vt.useFormState=function(t,e,n){return Oo.H.useFormState(t,e,n)};Vt.useFormStatus=function(){return Oo.H.useHostTransitionStatus()};Vt.version="19.2.3";function n1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n1)}catch(t){console.error(t)}}n1(),e1.exports=Vt;var PA=e1.exports;/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mt=OA,s1=_,BA=PA;function U(t){var e="https://react.dev/errors/"+t;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Hl(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function r1(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function a1(t){if(t.tag===31){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function bv(t){if(Hl(t)!==t)throw Error(U(188))}function UA(t){var e=t.alternate;if(!e){if(e=Hl(t),e===null)throw Error(U(188));return e!==t?null:t}for(var n=t,s=e;;){var i=n.return;if(i===null)break;var r=i.alternate;if(r===null){if(s=i.return,s!==null){n=s;continue}break}if(i.child===r.child){for(r=i.child;r;){if(r===n)return bv(i),t;if(r===s)return bv(i),e;r=r.sibling}throw Error(U(188))}if(n.return!==s.return)n=i,s=r;else{for(var a=!1,o=i.child;o;){if(o===n){a=!0,n=i,s=r;break}if(o===s){a=!0,s=i,n=r;break}o=o.sibling}if(!a){for(o=r.child;o;){if(o===n){a=!0,n=r,s=i;break}if(o===s){a=!0,s=r,n=i;break}o=o.sibling}if(!a)throw Error(U(189))}}if(n.alternate!==s)throw Error(U(190))}if(n.tag!==3)throw Error(U(188));return n.stateNode.current===n?t:e}function o1(t){var e=t.tag;if(e===5||e===26||e===27||e===6)return t;for(t=t.child;t!==null;){if(e=o1(t),e!==null)return e;t=t.sibling}return null}var ze=Object.assign,HA=Symbol.for("react.element"),Ec=Symbol.for("react.transitional.element"),wo=Symbol.for("react.portal"),Hr=Symbol.for("react.fragment"),l1=Symbol.for("react.strict_mode"),Uh=Symbol.for("react.profiler"),c1=Symbol.for("react.consumer"),hs=Symbol.for("react.context"),Dp=Symbol.for("react.forward_ref"),Hh=Symbol.for("react.suspense"),Gh=Symbol.for("react.suspense_list"),Lp=Symbol.for("react.memo"),zs=Symbol.for("react.lazy"),Vh=Symbol.for("react.activity"),GA=Symbol.for("react.memo_cache_sentinel"),xv=Symbol.iterator;function co(t){return t===null||typeof t!="object"?null:(t=xv&&t[xv]||t["@@iterator"],typeof t=="function"?t:null)}var VA=Symbol.for("react.client.reference");function Fh(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===VA?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Hr:return"Fragment";case Uh:return"Profiler";case l1:return"StrictMode";case Hh:return"Suspense";case Gh:return"SuspenseList";case Vh:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case wo:return"Portal";case hs:return t.displayName||"Context";case c1:return(t._context.displayName||"Context")+".Consumer";case Dp:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Lp:return e=t.displayName||null,e!==null?e:Fh(t.type)||"Memo";case zs:e=t._payload,t=t._init;try{return Fh(t(e))}catch{}}return null}var Eo=Array.isArray,ie=s1.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ke=BA.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,tr={pending:!1,data:null,method:null,action:null},zh=[],Gr=-1;function ns(t){return{current:t}}function _t(t){0>Gr||(t.current=zh[Gr],zh[Gr]=null,Gr--)}function Be(t,e){Gr++,zh[Gr]=t.current,t.current=e}var Xn=ns(null),il=ns(null),li=ns(null),bu=ns(null);function xu(t,e){switch(Be(li,e),Be(il,t),Be(Xn,null),e.nodeType){case 9:case 11:t=(t=e.documentElement)&&(t=t.namespaceURI)?kb(t):0;break;default:if(t=e.tagName,e=e.namespaceURI)e=kb(e),t=RE(e,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}_t(Xn),Be(Xn,t)}function xa(){_t(Xn),_t(il),_t(li)}function $h(t){t.memoizedState!==null&&Be(bu,t);var e=Xn.current,n=RE(e,t.type);e!==n&&(Be(il,t),Be(Xn,n))}function yu(t){il.current===t&&(_t(Xn),_t(il)),bu.current===t&&(_t(bu),pl._currentValue=tr)}var Tf,yv;function zi(t){if(Tf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Tf=e&&e[1]||"",yv=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Tf+t+yv}var Af=!1;function Rf(t,e){if(!t||Af)return"";Af=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var s={DetermineComponentFrameRoot:function(){try{if(e){var f=function(){throw Error()};if(Object.defineProperty(f.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(f,[])}catch(m){var h=m}Reflect.construct(t,[],f)}else{try{f.call()}catch(m){h=m}t.call(f.prototype)}}else{try{throw Error()}catch(m){h=m}(f=t())&&typeof f.catch=="function"&&f.catch(function(){})}}catch(m){if(m&&h&&typeof m.stack=="string")return[m.stack,h.stack]}return[null,null]}};s.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var i=Object.getOwnPropertyDescriptor(s.DetermineComponentFrameRoot,"name");i&&i.configurable&&Object.defineProperty(s.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var r=s.DetermineComponentFrameRoot(),a=r[0],o=r[1];if(a&&o){var l=a.split(`
`),u=o.split(`
`);for(i=s=0;s<l.length&&!l[s].includes("DetermineComponentFrameRoot");)s++;for(;i<u.length&&!u[i].includes("DetermineComponentFrameRoot");)i++;if(s===l.length||i===u.length)for(s=l.length-1,i=u.length-1;1<=s&&0<=i&&l[s]!==u[i];)i--;for(;1<=s&&0<=i;s--,i--)if(l[s]!==u[i]){if(s!==1||i!==1)do if(s--,i--,0>i||l[s]!==u[i]){var d=`
`+l[s].replace(" at new "," at ");return t.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",t.displayName)),d}while(1<=s&&0<=i);break}}}finally{Af=!1,Error.prepareStackTrace=n}return(n=t?t.displayName||t.name:"")?zi(n):""}function FA(t,e){switch(t.tag){case 26:case 27:case 5:return zi(t.type);case 16:return zi("Lazy");case 13:return t.child!==e&&e!==null?zi("Suspense Fallback"):zi("Suspense");case 19:return zi("SuspenseList");case 0:case 15:return Rf(t.type,!1);case 11:return Rf(t.type.render,!1);case 1:return Rf(t.type,!0);case 31:return zi("Activity");default:return""}}function _v(t){try{var e="",n=null;do e+=FA(t,n),n=t,t=t.return;while(t);return e}catch(s){return`
Error generating stack: `+s.message+`
`+s.stack}}var Kh=Object.prototype.hasOwnProperty,Pp=mt.unstable_scheduleCallback,If=mt.unstable_cancelCallback,zA=mt.unstable_shouldYield,$A=mt.unstable_requestPaint,rn=mt.unstable_now,KA=mt.unstable_getCurrentPriorityLevel,u1=mt.unstable_ImmediatePriority,d1=mt.unstable_UserBlockingPriority,_u=mt.unstable_NormalPriority,YA=mt.unstable_LowPriority,f1=mt.unstable_IdlePriority,qA=mt.log,WA=mt.unstable_setDisableYieldValue,Gl=null,an=null;function ei(t){if(typeof qA=="function"&&WA(t),an&&typeof an.setStrictMode=="function")try{an.setStrictMode(Gl,t)}catch{}}var on=Math.clz32?Math.clz32:JA,XA=Math.log,QA=Math.LN2;function JA(t){return t>>>=0,t===0?32:31-(XA(t)/QA|0)|0}var Nc=256,kc=262144,Sc=4194304;function $i(t){var e=t&42;if(e!==0)return e;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function jd(t,e,n){var s=t.pendingLanes;if(s===0)return 0;var i=0,r=t.suspendedLanes,a=t.pingedLanes;t=t.warmLanes;var o=s&134217727;return o!==0?(s=o&~r,s!==0?i=$i(s):(a&=o,a!==0?i=$i(a):n||(n=o&~t,n!==0&&(i=$i(n))))):(o=s&~r,o!==0?i=$i(o):a!==0?i=$i(a):n||(n=s&~t,n!==0&&(i=$i(n)))),i===0?0:e!==0&&e!==i&&!(e&r)&&(r=i&-i,n=e&-e,r>=n||r===32&&(n&4194048)!==0)?e:i}function Vl(t,e){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&e)===0}function ZA(t,e){switch(t){case 1:case 2:case 4:case 8:case 64:return e+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function h1(){var t=Sc;return Sc<<=1,!(Sc&62914560)&&(Sc=4194304),t}function Cf(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Fl(t,e){t.pendingLanes|=e,e!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function eR(t,e,n,s,i,r){var a=t.pendingLanes;t.pendingLanes=n,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=n,t.entangledLanes&=n,t.errorRecoveryDisabledLanes&=n,t.shellSuspendCounter=0;var o=t.entanglements,l=t.expirationTimes,u=t.hiddenUpdates;for(n=a&~n;0<n;){var d=31-on(n),f=1<<d;o[d]=0,l[d]=-1;var h=u[d];if(h!==null)for(u[d]=null,d=0;d<h.length;d++){var m=h[d];m!==null&&(m.lane&=-536870913)}n&=~f}s!==0&&m1(t,s,0),r!==0&&i===0&&t.tag!==0&&(t.suspendedLanes|=r&~(a&~e))}function m1(t,e,n){t.pendingLanes|=e,t.suspendedLanes&=~e;var s=31-on(e);t.entangledLanes|=e,t.entanglements[s]=t.entanglements[s]|1073741824|n&261930}function p1(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-on(n),i=1<<s;i&e|t[s]&e&&(t[s]|=e),n&=~i}}function g1(t,e){var n=e&-e;return n=n&42?1:Bp(n),n&(t.suspendedLanes|e)?0:n}function Bp(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function Up(t){return t&=-t,2<t?8<t?t&134217727?32:268435456:8:2}function v1(){var t=ke.p;return t!==0?t:(t=window.event,t===void 0?32:HE(t.type))}function wv(t,e){var n=ke.p;try{return ke.p=t,e()}finally{ke.p=n}}var Di=Math.random().toString(36).slice(2),St="__reactFiber$"+Di,Qt="__reactProps$"+Di,Fa="__reactContainer$"+Di,Yh="__reactEvents$"+Di,tR="__reactListeners$"+Di,nR="__reactHandles$"+Di,Ev="__reactResources$"+Di,zl="__reactMarker$"+Di;function Hp(t){delete t[St],delete t[Qt],delete t[Yh],delete t[tR],delete t[nR]}function Vr(t){var e=t[St];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Fa]||n[St]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Ib(t);t!==null;){if(n=t[St])return n;t=Ib(t)}return e}t=n,n=t.parentNode}return null}function za(t){if(t=t[St]||t[Fa]){var e=t.tag;if(e===5||e===6||e===13||e===31||e===26||e===27||e===3)return t}return null}function No(t){var e=t.tag;if(e===5||e===26||e===27||e===6)return t.stateNode;throw Error(U(33))}function ra(t){var e=t[Ev];return e||(e=t[Ev]={hoistableStyles:new Map,hoistableScripts:new Map}),e}function xt(t){t[zl]=!0}var b1=new Set,x1={};function wr(t,e){ya(t,e),ya(t+"Capture",e)}function ya(t,e){for(x1[t]=e,t=0;t<e.length;t++)b1.add(e[t])}var sR=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Nv={},kv={};function iR(t){return Kh.call(kv,t)?!0:Kh.call(Nv,t)?!1:sR.test(t)?kv[t]=!0:(Nv[t]=!0,!1)}function Wc(t,e,n){if(iR(e))if(n===null)t.removeAttribute(e);else{switch(typeof n){case"undefined":case"function":case"symbol":t.removeAttribute(e);return;case"boolean":var s=e.toLowerCase().slice(0,5);if(s!=="data-"&&s!=="aria-"){t.removeAttribute(e);return}}t.setAttribute(e,""+n)}}function Tc(t,e,n){if(n===null)t.removeAttribute(e);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(e);return}t.setAttribute(e,""+n)}}function as(t,e,n,s){if(s===null)t.removeAttribute(n);else{switch(typeof s){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(n);return}t.setAttributeNS(e,n,""+s)}}function xn(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function y1(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function rR(t,e,n){var s=Object.getOwnPropertyDescriptor(t.constructor.prototype,e);if(!t.hasOwnProperty(e)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var i=s.get,r=s.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,r.call(this,a)}}),Object.defineProperty(t,e,{enumerable:s.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function qh(t){if(!t._valueTracker){var e=y1(t)?"checked":"value";t._valueTracker=rR(t,e,""+t[e])}}function _1(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=y1(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function wu(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var aR=/[\n"\\]/g;function wn(t){return t.replace(aR,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function Wh(t,e,n,s,i,r,a,o){t.name="",a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"?t.type=a:t.removeAttribute("type"),e!=null?a==="number"?(e===0&&t.value===""||t.value!=e)&&(t.value=""+xn(e)):t.value!==""+xn(e)&&(t.value=""+xn(e)):a!=="submit"&&a!=="reset"||t.removeAttribute("value"),e!=null?Xh(t,a,xn(e)):n!=null?Xh(t,a,xn(n)):s!=null&&t.removeAttribute("value"),i==null&&r!=null&&(t.defaultChecked=!!r),i!=null&&(t.checked=i&&typeof i!="function"&&typeof i!="symbol"),o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"?t.name=""+xn(o):t.removeAttribute("name")}function w1(t,e,n,s,i,r,a,o){if(r!=null&&typeof r!="function"&&typeof r!="symbol"&&typeof r!="boolean"&&(t.type=r),e!=null||n!=null){if(!(r!=="submit"&&r!=="reset"||e!=null)){qh(t);return}n=n!=null?""+xn(n):"",e=e!=null?""+xn(e):n,o||e===t.value||(t.value=e),t.defaultValue=e}s=s??i,s=typeof s!="function"&&typeof s!="symbol"&&!!s,t.checked=o?t.checked:!!s,t.defaultChecked=!!s,a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"&&(t.name=a),qh(t)}function Xh(t,e,n){e==="number"&&wu(t.ownerDocument)===t||t.defaultValue===""+n||(t.defaultValue=""+n)}function aa(t,e,n,s){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&s&&(t[n].defaultSelected=!0)}else{for(n=""+xn(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,s&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function E1(t,e,n){if(e!=null&&(e=""+xn(e),e!==t.value&&(t.value=e),n==null)){t.defaultValue!==e&&(t.defaultValue=e);return}t.defaultValue=n!=null?""+xn(n):""}function N1(t,e,n,s){if(e==null){if(s!=null){if(n!=null)throw Error(U(92));if(Eo(s)){if(1<s.length)throw Error(U(93));s=s[0]}n=s}n==null&&(n=""),e=n}n=xn(e),t.defaultValue=n,s=t.textContent,s===n&&s!==""&&s!==null&&(t.value=s),qh(t)}function _a(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var oR=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Sv(t,e,n){var s=e.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?s?t.setProperty(e,""):e==="float"?t.cssFloat="":t[e]="":s?t.setProperty(e,n):typeof n!="number"||n===0||oR.has(e)?e==="float"?t.cssFloat=n:t[e]=(""+n).trim():t[e]=n+"px"}function k1(t,e,n){if(e!=null&&typeof e!="object")throw Error(U(62));if(t=t.style,n!=null){for(var s in n)!n.hasOwnProperty(s)||e!=null&&e.hasOwnProperty(s)||(s.indexOf("--")===0?t.setProperty(s,""):s==="float"?t.cssFloat="":t[s]="");for(var i in e)s=e[i],e.hasOwnProperty(i)&&n[i]!==s&&Sv(t,i,s)}else for(var r in e)e.hasOwnProperty(r)&&Sv(t,r,e[r])}function Gp(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var lR=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),cR=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Xc(t){return cR.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function ms(){}var Qh=null;function Vp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Fr=null,oa=null;function Tv(t){var e=za(t);if(e&&(t=e.stateNode)){var n=t[Qt]||null;e:switch(t=e.stateNode,e.type){case"input":if(Wh(t,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+wn(""+e)+'"][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var i=s[Qt]||null;if(!i)throw Error(U(90));Wh(s,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(e=0;e<n.length;e++)s=n[e],s.form===t.form&&_1(s)}break e;case"textarea":E1(t,n.value,n.defaultValue);break e;case"select":e=n.value,e!=null&&aa(t,!!n.multiple,e,!1)}}}var jf=!1;function S1(t,e,n){if(jf)return t(e,n);jf=!0;try{var s=t(e);return s}finally{if(jf=!1,(Fr!==null||oa!==null)&&(zd(),Fr&&(e=Fr,t=oa,oa=Fr=null,Tv(e),t)))for(e=0;e<t.length;e++)Tv(t[e])}}function rl(t,e){var n=t.stateNode;if(n===null)return null;var s=n[Qt]||null;if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(U(231,e,typeof n));return n}var Ts=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Jh=!1;if(Ts)try{var uo={};Object.defineProperty(uo,"passive",{get:function(){Jh=!0}}),window.addEventListener("test",uo,uo),window.removeEventListener("test",uo,uo)}catch{Jh=!1}var ti=null,Fp=null,Qc=null;function T1(){if(Qc)return Qc;var t,e=Fp,n=e.length,s,i="value"in ti?ti.value:ti.textContent,r=i.length;for(t=0;t<n&&e[t]===i[t];t++);var a=n-t;for(s=1;s<=a&&e[n-s]===i[r-s];s++);return Qc=i.slice(t,1<s?1-s:void 0)}function Jc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ac(){return!0}function Av(){return!1}function Jt(t){function e(n,s,i,r,a){this._reactName=n,this._targetInst=i,this.type=s,this.nativeEvent=r,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(n=t[o],this[o]=n?n(r):r[o]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?Ac:Av,this.isPropagationStopped=Av,this}return ze(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ac)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ac)},persist:function(){},isPersistent:Ac}),e}var Er={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Od=Jt(Er),$l=ze({},Er,{view:0,detail:0}),uR=Jt($l),Of,Mf,fo,Md=ze({},$l,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zp,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==fo&&(fo&&t.type==="mousemove"?(Of=t.screenX-fo.screenX,Mf=t.screenY-fo.screenY):Mf=Of=0,fo=t),Of)},movementY:function(t){return"movementY"in t?t.movementY:Mf}}),Rv=Jt(Md),dR=ze({},Md,{dataTransfer:0}),fR=Jt(dR),hR=ze({},$l,{relatedTarget:0}),Df=Jt(hR),mR=ze({},Er,{animationName:0,elapsedTime:0,pseudoElement:0}),pR=Jt(mR),gR=ze({},Er,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),vR=Jt(gR),bR=ze({},Er,{data:0}),Iv=Jt(bR),xR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_R={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wR(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=_R[t])?!!e[t]:!1}function zp(){return wR}var ER=ze({},$l,{key:function(t){if(t.key){var e=xR[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Jc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?yR[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zp,charCode:function(t){return t.type==="keypress"?Jc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Jc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),NR=Jt(ER),kR=ze({},Md,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Cv=Jt(kR),SR=ze({},$l,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zp}),TR=Jt(SR),AR=ze({},Er,{propertyName:0,elapsedTime:0,pseudoElement:0}),RR=Jt(AR),IR=ze({},Md,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),CR=Jt(IR),jR=ze({},Er,{newState:0,oldState:0}),OR=Jt(jR),MR=[9,13,27,32],$p=Ts&&"CompositionEvent"in window,Mo=null;Ts&&"documentMode"in document&&(Mo=document.documentMode);var DR=Ts&&"TextEvent"in window&&!Mo,A1=Ts&&(!$p||Mo&&8<Mo&&11>=Mo),jv=" ",Ov=!1;function R1(t,e){switch(t){case"keyup":return MR.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function I1(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var zr=!1;function LR(t,e){switch(t){case"compositionend":return I1(e);case"keypress":return e.which!==32?null:(Ov=!0,jv);case"textInput":return t=e.data,t===jv&&Ov?null:t;default:return null}}function PR(t,e){if(zr)return t==="compositionend"||!$p&&R1(t,e)?(t=T1(),Qc=Fp=ti=null,zr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return A1&&e.locale!=="ko"?null:e.data;default:return null}}var BR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!BR[t.type]:e==="textarea"}function C1(t,e,n,s){Fr?oa?oa.push(s):oa=[s]:Fr=s,e=Hu(e,"onChange"),0<e.length&&(n=new Od("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var Do=null,al=null;function UR(t){SE(t,0)}function Dd(t){var e=No(t);if(_1(e))return t}function Dv(t,e){if(t==="change")return e}var j1=!1;if(Ts){var Lf;if(Ts){var Pf="oninput"in document;if(!Pf){var Lv=document.createElement("div");Lv.setAttribute("oninput","return;"),Pf=typeof Lv.oninput=="function"}Lf=Pf}else Lf=!1;j1=Lf&&(!document.documentMode||9<document.documentMode)}function Pv(){Do&&(Do.detachEvent("onpropertychange",O1),al=Do=null)}function O1(t){if(t.propertyName==="value"&&Dd(al)){var e=[];C1(e,al,t,Vp(t)),S1(UR,e)}}function HR(t,e,n){t==="focusin"?(Pv(),Do=e,al=n,Do.attachEvent("onpropertychange",O1)):t==="focusout"&&Pv()}function GR(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Dd(al)}function VR(t,e){if(t==="click")return Dd(e)}function FR(t,e){if(t==="input"||t==="change")return Dd(e)}function zR(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var un=typeof Object.is=="function"?Object.is:zR;function ol(t,e){if(un(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var i=n[s];if(!Kh.call(e,i)||!un(t[i],e[i]))return!1}return!0}function Bv(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Uv(t,e){var n=Bv(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Bv(n)}}function M1(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?M1(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function D1(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var e=wu(t.document);e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=wu(t.document)}return e}function Kp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}var $R=Ts&&"documentMode"in document&&11>=document.documentMode,$r=null,Zh=null,Lo=null,em=!1;function Hv(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;em||$r==null||$r!==wu(s)||(s=$r,"selectionStart"in s&&Kp(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Lo&&ol(Lo,s)||(Lo=s,s=Hu(Zh,"onSelect"),0<s.length&&(e=new Od("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=$r)))}function Vi(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Kr={animationend:Vi("Animation","AnimationEnd"),animationiteration:Vi("Animation","AnimationIteration"),animationstart:Vi("Animation","AnimationStart"),transitionrun:Vi("Transition","TransitionRun"),transitionstart:Vi("Transition","TransitionStart"),transitioncancel:Vi("Transition","TransitionCancel"),transitionend:Vi("Transition","TransitionEnd")},Bf={},L1={};Ts&&(L1=document.createElement("div").style,"AnimationEvent"in window||(delete Kr.animationend.animation,delete Kr.animationiteration.animation,delete Kr.animationstart.animation),"TransitionEvent"in window||delete Kr.transitionend.transition);function Nr(t){if(Bf[t])return Bf[t];if(!Kr[t])return t;var e=Kr[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in L1)return Bf[t]=e[n];return t}var P1=Nr("animationend"),B1=Nr("animationiteration"),U1=Nr("animationstart"),KR=Nr("transitionrun"),YR=Nr("transitionstart"),qR=Nr("transitioncancel"),H1=Nr("transitionend"),G1=new Map,tm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");tm.push("scrollEnd");function Fn(t,e){G1.set(t,e),wr(e,[t])}var Eu=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},bn=[],Yr=0,Yp=0;function Ld(){for(var t=Yr,e=Yp=Yr=0;e<t;){var n=bn[e];bn[e++]=null;var s=bn[e];bn[e++]=null;var i=bn[e];bn[e++]=null;var r=bn[e];if(bn[e++]=null,s!==null&&i!==null){var a=s.pending;a===null?i.next=i:(i.next=a.next,a.next=i),s.pending=i}r!==0&&V1(n,i,r)}}function Pd(t,e,n,s){bn[Yr++]=t,bn[Yr++]=e,bn[Yr++]=n,bn[Yr++]=s,Yp|=s,t.lanes|=s,t=t.alternate,t!==null&&(t.lanes|=s)}function qp(t,e,n,s){return Pd(t,e,n,s),Nu(t)}function kr(t,e){return Pd(t,null,null,e),Nu(t)}function V1(t,e,n){t.lanes|=n;var s=t.alternate;s!==null&&(s.lanes|=n);for(var i=!1,r=t.return;r!==null;)r.childLanes|=n,s=r.alternate,s!==null&&(s.childLanes|=n),r.tag===22&&(t=r.stateNode,t===null||t._visibility&1||(i=!0)),t=r,r=r.return;return t.tag===3?(r=t.stateNode,i&&e!==null&&(i=31-on(n),t=r.hiddenUpdates,s=t[i],s===null?t[i]=[e]:s.push(e),e.lane=n|536870912),r):null}function Nu(t){if(50<$o)throw $o=0,wm=null,Error(U(185));for(var e=t.return;e!==null;)t=e,e=t.return;return t.tag===3?t.stateNode:null}var qr={};function WR(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function tn(t,e,n,s){return new WR(t,e,n,s)}function Wp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function ys(t,e){var n=t.alternate;return n===null?(n=tn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&65011712,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n.refCleanup=t.refCleanup,n}function F1(t,e){t.flags&=65011714;var n=t.alternate;return n===null?(t.childLanes=0,t.lanes=e,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,t.type=n.type,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),t}function Zc(t,e,n,s,i,r){var a=0;if(s=t,typeof t=="function")Wp(t)&&(a=1);else if(typeof t=="string")a=eC(t,n,Xn.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case Vh:return t=tn(31,n,e,i),t.elementType=Vh,t.lanes=r,t;case Hr:return nr(n.children,i,r,e);case l1:a=8,i|=24;break;case Uh:return t=tn(12,n,e,i|2),t.elementType=Uh,t.lanes=r,t;case Hh:return t=tn(13,n,e,i),t.elementType=Hh,t.lanes=r,t;case Gh:return t=tn(19,n,e,i),t.elementType=Gh,t.lanes=r,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case hs:a=10;break e;case c1:a=9;break e;case Dp:a=11;break e;case Lp:a=14;break e;case zs:a=16,s=null;break e}a=29,n=Error(U(130,t===null?"null":typeof t,"")),s=null}return e=tn(a,n,e,i),e.elementType=t,e.type=s,e.lanes=r,e}function nr(t,e,n,s){return t=tn(7,t,s,e),t.lanes=n,t}function Uf(t,e,n){return t=tn(6,t,null,e),t.lanes=n,t}function z1(t){var e=tn(18,null,null,0);return e.stateNode=t,e}function Hf(t,e,n){return e=tn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}var Gv=new WeakMap;function En(t,e){if(typeof t=="object"&&t!==null){var n=Gv.get(t);return n!==void 0?n:(e={value:t,source:e,stack:_v(e)},Gv.set(t,e),e)}return{value:t,source:e,stack:_v(e)}}var Wr=[],Xr=0,ku=null,ll=0,yn=[],_n=0,Ni=null,Yn=1,qn="";function ds(t,e){Wr[Xr++]=ll,Wr[Xr++]=ku,ku=t,ll=e}function $1(t,e,n){yn[_n++]=Yn,yn[_n++]=qn,yn[_n++]=Ni,Ni=t;var s=Yn;t=qn;var i=32-on(s)-1;s&=~(1<<i),n+=1;var r=32-on(e)+i;if(30<r){var a=i-i%5;r=(s&(1<<a)-1).toString(32),s>>=a,i-=a,Yn=1<<32-on(e)+i|n<<i|s,qn=r+t}else Yn=1<<r|n<<i|s,qn=t}function Xp(t){t.return!==null&&(ds(t,1),$1(t,1,0))}function Qp(t){for(;t===ku;)ku=Wr[--Xr],Wr[Xr]=null,ll=Wr[--Xr],Wr[Xr]=null;for(;t===Ni;)Ni=yn[--_n],yn[_n]=null,qn=yn[--_n],yn[_n]=null,Yn=yn[--_n],yn[_n]=null}function K1(t,e){yn[_n++]=Yn,yn[_n++]=qn,yn[_n++]=Ni,Yn=e.id,qn=e.overflow,Ni=t}var Tt=null,He=null,xe=!1,ci=null,Nn=!1,nm=Error(U(519));function ki(t){var e=Error(U(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw cl(En(e,t)),nm}function Vv(t){var e=t.stateNode,n=t.type,s=t.memoizedProps;switch(e[St]=t,e[Qt]=s,n){case"dialog":pe("cancel",e),pe("close",e);break;case"iframe":case"object":case"embed":pe("load",e);break;case"video":case"audio":for(n=0;n<hl.length;n++)pe(hl[n],e);break;case"source":pe("error",e);break;case"img":case"image":case"link":pe("error",e),pe("load",e);break;case"details":pe("toggle",e);break;case"input":pe("invalid",e),w1(e,s.value,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name,!0);break;case"select":pe("invalid",e);break;case"textarea":pe("invalid",e),N1(e,s.value,s.defaultValue,s.children)}n=s.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||e.textContent===""+n||s.suppressHydrationWarning===!0||AE(e.textContent,n)?(s.popover!=null&&(pe("beforetoggle",e),pe("toggle",e)),s.onScroll!=null&&pe("scroll",e),s.onScrollEnd!=null&&pe("scrollend",e),s.onClick!=null&&(e.onclick=ms),e=!0):e=!1,e||ki(t,!0)}function Fv(t){for(Tt=t.return;Tt;)switch(Tt.tag){case 5:case 31:case 13:Nn=!1;return;case 27:case 3:Nn=!0;return;default:Tt=Tt.return}}function jr(t){if(t!==Tt)return!1;if(!xe)return Fv(t),xe=!0,!1;var e=t.tag,n;if((n=e!==3&&e!==27)&&((n=e===5)&&(n=t.type,n=!(n!=="form"&&n!=="button")||Tm(t.type,t.memoizedProps)),n=!n),n&&He&&ki(t),Fv(t),e===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(U(317));He=Rb(t)}else if(e===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(U(317));He=Rb(t)}else e===27?(e=He,Li(t.type)?(t=Cm,Cm=null,He=t):He=e):He=Tt?Tn(t.stateNode.nextSibling):null;return!0}function cr(){He=Tt=null,xe=!1}function Gf(){var t=ci;return t!==null&&(Yt===null?Yt=t:Yt.push.apply(Yt,t),ci=null),t}function cl(t){ci===null?ci=[t]:ci.push(t)}var sm=ns(null),Sr=null,ps=null;function Ks(t,e,n){Be(sm,e._currentValue),e._currentValue=n}function _s(t){t._currentValue=sm.current,_t(sm)}function im(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function rm(t,e,n,s){var i=t.child;for(i!==null&&(i.return=t);i!==null;){var r=i.dependencies;if(r!==null){var a=i.child;r=r.firstContext;e:for(;r!==null;){var o=r;r=i;for(var l=0;l<e.length;l++)if(o.context===e[l]){r.lanes|=n,o=r.alternate,o!==null&&(o.lanes|=n),im(r.return,n,t),s||(a=null);break e}r=o.next}}else if(i.tag===18){if(a=i.return,a===null)throw Error(U(341));a.lanes|=n,r=a.alternate,r!==null&&(r.lanes|=n),im(a,n,t),a=null}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===t){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}}function $a(t,e,n,s){t=null;for(var i=e,r=!1;i!==null;){if(!r){if(i.flags&524288)r=!0;else if(i.flags&262144)break}if(i.tag===10){var a=i.alternate;if(a===null)throw Error(U(387));if(a=a.memoizedProps,a!==null){var o=i.type;un(i.pendingProps.value,a.value)||(t!==null?t.push(o):t=[o])}}else if(i===bu.current){if(a=i.alternate,a===null)throw Error(U(387));a.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(t!==null?t.push(pl):t=[pl])}i=i.return}t!==null&&rm(e,t,n,s),e.flags|=262144}function Su(t){for(t=t.firstContext;t!==null;){if(!un(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function ur(t){Sr=t,ps=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function Rt(t){return Y1(Sr,t)}function Rc(t,e){return Sr===null&&ur(t),Y1(t,e)}function Y1(t,e){var n=e._currentValue;if(e={context:e,memoizedValue:n,next:null},ps===null){if(t===null)throw Error(U(308));ps=e,t.dependencies={lanes:0,firstContext:e},t.flags|=524288}else ps=ps.next=e;return n}var XR=typeof AbortController<"u"?AbortController:function(){var t=[],e=this.signal={aborted:!1,addEventListener:function(n,s){t.push(s)}};this.abort=function(){e.aborted=!0,t.forEach(function(n){return n()})}},QR=mt.unstable_scheduleCallback,JR=mt.unstable_NormalPriority,lt={$$typeof:hs,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Jp(){return{controller:new XR,data:new Map,refCount:0}}function Kl(t){t.refCount--,t.refCount===0&&QR(JR,function(){t.controller.abort()})}var Po=null,am=0,wa=0,la=null;function ZR(t,e){if(Po===null){var n=Po=[];am=0,wa=Eg(),la={status:"pending",value:void 0,then:function(s){n.push(s)}}}return am++,e.then(zv,zv),e}function zv(){if(--am===0&&Po!==null){la!==null&&(la.status="fulfilled");var t=Po;Po=null,wa=0,la=null;for(var e=0;e<t.length;e++)(0,t[e])()}}function eI(t,e){var n=[],s={status:"pending",value:null,reason:null,then:function(i){n.push(i)}};return t.then(function(){s.status="fulfilled",s.value=e;for(var i=0;i<n.length;i++)(0,n[i])(e)},function(i){for(s.status="rejected",s.reason=i,i=0;i<n.length;i++)(0,n[i])(void 0)}),s}var $v=ie.S;ie.S=function(t,e){oE=rn(),typeof e=="object"&&e!==null&&typeof e.then=="function"&&ZR(t,e),$v!==null&&$v(t,e)};var sr=ns(null);function Zp(){var t=sr.current;return t!==null?t:Le.pooledCache}function eu(t,e){e===null?Be(sr,sr.current):Be(sr,e.pool)}function q1(){var t=Zp();return t===null?null:{parent:lt._currentValue,pool:t}}var Ka=Error(U(460)),eg=Error(U(474)),Bd=Error(U(542)),Tu={then:function(){}};function Kv(t){return t=t.status,t==="fulfilled"||t==="rejected"}function W1(t,e,n){switch(n=t[n],n===void 0?t.push(e):n!==e&&(e.then(ms,ms),e=n),e.status){case"fulfilled":return e.value;case"rejected":throw t=e.reason,qv(t),t;default:if(typeof e.status=="string")e.then(ms,ms);else{if(t=Le,t!==null&&100<t.shellSuspendCounter)throw Error(U(482));t=e,t.status="pending",t.then(function(s){if(e.status==="pending"){var i=e;i.status="fulfilled",i.value=s}},function(s){if(e.status==="pending"){var i=e;i.status="rejected",i.reason=s}})}switch(e.status){case"fulfilled":return e.value;case"rejected":throw t=e.reason,qv(t),t}throw ir=e,Ka}}function Ki(t){try{var e=t._init;return e(t._payload)}catch(n){throw n!==null&&typeof n=="object"&&typeof n.then=="function"?(ir=n,Ka):n}}var ir=null;function Yv(){if(ir===null)throw Error(U(459));var t=ir;return ir=null,t}function qv(t){if(t===Ka||t===Bd)throw Error(U(483))}var ca=null,ul=0;function Ic(t){var e=ul;return ul+=1,ca===null&&(ca=[]),W1(ca,t,e)}function ho(t,e){e=e.props.ref,t.ref=e!==void 0?e:null}function Cc(t,e){throw e.$$typeof===HA?Error(U(525)):(t=Object.prototype.toString.call(e),Error(U(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)))}function X1(t){function e(p,g){if(t){var x=p.deletions;x===null?(p.deletions=[g],p.flags|=16):x.push(g)}}function n(p,g){if(!t)return null;for(;g!==null;)e(p,g),g=g.sibling;return null}function s(p){for(var g=new Map;p!==null;)p.key!==null?g.set(p.key,p):g.set(p.index,p),p=p.sibling;return g}function i(p,g){return p=ys(p,g),p.index=0,p.sibling=null,p}function r(p,g,x){return p.index=x,t?(x=p.alternate,x!==null?(x=x.index,x<g?(p.flags|=67108866,g):x):(p.flags|=67108866,g)):(p.flags|=1048576,g)}function a(p){return t&&p.alternate===null&&(p.flags|=67108866),p}function o(p,g,x,w){return g===null||g.tag!==6?(g=Uf(x,p.mode,w),g.return=p,g):(g=i(g,x),g.return=p,g)}function l(p,g,x,w){var N=x.type;return N===Hr?d(p,g,x.props.children,w,x.key):g!==null&&(g.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===zs&&Ki(N)===g.type)?(g=i(g,x.props),ho(g,x),g.return=p,g):(g=Zc(x.type,x.key,x.props,null,p.mode,w),ho(g,x),g.return=p,g)}function u(p,g,x,w){return g===null||g.tag!==4||g.stateNode.containerInfo!==x.containerInfo||g.stateNode.implementation!==x.implementation?(g=Hf(x,p.mode,w),g.return=p,g):(g=i(g,x.children||[]),g.return=p,g)}function d(p,g,x,w,N){return g===null||g.tag!==7?(g=nr(x,p.mode,w,N),g.return=p,g):(g=i(g,x),g.return=p,g)}function f(p,g,x){if(typeof g=="string"&&g!==""||typeof g=="number"||typeof g=="bigint")return g=Uf(""+g,p.mode,x),g.return=p,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Ec:return x=Zc(g.type,g.key,g.props,null,p.mode,x),ho(x,g),x.return=p,x;case wo:return g=Hf(g,p.mode,x),g.return=p,g;case zs:return g=Ki(g),f(p,g,x)}if(Eo(g)||co(g))return g=nr(g,p.mode,x,null),g.return=p,g;if(typeof g.then=="function")return f(p,Ic(g),x);if(g.$$typeof===hs)return f(p,Rc(p,g),x);Cc(p,g)}return null}function h(p,g,x,w){var N=g!==null?g.key:null;if(typeof x=="string"&&x!==""||typeof x=="number"||typeof x=="bigint")return N!==null?null:o(p,g,""+x,w);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Ec:return x.key===N?l(p,g,x,w):null;case wo:return x.key===N?u(p,g,x,w):null;case zs:return x=Ki(x),h(p,g,x,w)}if(Eo(x)||co(x))return N!==null?null:d(p,g,x,w,null);if(typeof x.then=="function")return h(p,g,Ic(x),w);if(x.$$typeof===hs)return h(p,g,Rc(p,x),w);Cc(p,x)}return null}function m(p,g,x,w,N){if(typeof w=="string"&&w!==""||typeof w=="number"||typeof w=="bigint")return p=p.get(x)||null,o(g,p,""+w,N);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Ec:return p=p.get(w.key===null?x:w.key)||null,l(g,p,w,N);case wo:return p=p.get(w.key===null?x:w.key)||null,u(g,p,w,N);case zs:return w=Ki(w),m(p,g,x,w,N)}if(Eo(w)||co(w))return p=p.get(x)||null,d(g,p,w,N,null);if(typeof w.then=="function")return m(p,g,x,Ic(w),N);if(w.$$typeof===hs)return m(p,g,x,Rc(g,w),N);Cc(g,w)}return null}function v(p,g,x,w){for(var N=null,T=null,E=g,A=g=0,k=null;E!==null&&A<x.length;A++){E.index>A?(k=E,E=null):k=E.sibling;var R=h(p,E,x[A],w);if(R===null){E===null&&(E=k);break}t&&E&&R.alternate===null&&e(p,E),g=r(R,g,A),T===null?N=R:T.sibling=R,T=R,E=k}if(A===x.length)return n(p,E),xe&&ds(p,A),N;if(E===null){for(;A<x.length;A++)E=f(p,x[A],w),E!==null&&(g=r(E,g,A),T===null?N=E:T.sibling=E,T=E);return xe&&ds(p,A),N}for(E=s(E);A<x.length;A++)k=m(E,p,A,x[A],w),k!==null&&(t&&k.alternate!==null&&E.delete(k.key===null?A:k.key),g=r(k,g,A),T===null?N=k:T.sibling=k,T=k);return t&&E.forEach(function(I){return e(p,I)}),xe&&ds(p,A),N}function b(p,g,x,w){if(x==null)throw Error(U(151));for(var N=null,T=null,E=g,A=g=0,k=null,R=x.next();E!==null&&!R.done;A++,R=x.next()){E.index>A?(k=E,E=null):k=E.sibling;var I=h(p,E,R.value,w);if(I===null){E===null&&(E=k);break}t&&E&&I.alternate===null&&e(p,E),g=r(I,g,A),T===null?N=I:T.sibling=I,T=I,E=k}if(R.done)return n(p,E),xe&&ds(p,A),N;if(E===null){for(;!R.done;A++,R=x.next())R=f(p,R.value,w),R!==null&&(g=r(R,g,A),T===null?N=R:T.sibling=R,T=R);return xe&&ds(p,A),N}for(E=s(E);!R.done;A++,R=x.next())R=m(E,p,A,R.value,w),R!==null&&(t&&R.alternate!==null&&E.delete(R.key===null?A:R.key),g=r(R,g,A),T===null?N=R:T.sibling=R,T=R);return t&&E.forEach(function(P){return e(p,P)}),xe&&ds(p,A),N}function y(p,g,x,w){if(typeof x=="object"&&x!==null&&x.type===Hr&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Ec:e:{for(var N=x.key;g!==null;){if(g.key===N){if(N=x.type,N===Hr){if(g.tag===7){n(p,g.sibling),w=i(g,x.props.children),w.return=p,p=w;break e}}else if(g.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===zs&&Ki(N)===g.type){n(p,g.sibling),w=i(g,x.props),ho(w,x),w.return=p,p=w;break e}n(p,g);break}else e(p,g);g=g.sibling}x.type===Hr?(w=nr(x.props.children,p.mode,w,x.key),w.return=p,p=w):(w=Zc(x.type,x.key,x.props,null,p.mode,w),ho(w,x),w.return=p,p=w)}return a(p);case wo:e:{for(N=x.key;g!==null;){if(g.key===N)if(g.tag===4&&g.stateNode.containerInfo===x.containerInfo&&g.stateNode.implementation===x.implementation){n(p,g.sibling),w=i(g,x.children||[]),w.return=p,p=w;break e}else{n(p,g);break}else e(p,g);g=g.sibling}w=Hf(x,p.mode,w),w.return=p,p=w}return a(p);case zs:return x=Ki(x),y(p,g,x,w)}if(Eo(x))return v(p,g,x,w);if(co(x)){if(N=co(x),typeof N!="function")throw Error(U(150));return x=N.call(x),b(p,g,x,w)}if(typeof x.then=="function")return y(p,g,Ic(x),w);if(x.$$typeof===hs)return y(p,g,Rc(p,x),w);Cc(p,x)}return typeof x=="string"&&x!==""||typeof x=="number"||typeof x=="bigint"?(x=""+x,g!==null&&g.tag===6?(n(p,g.sibling),w=i(g,x),w.return=p,p=w):(n(p,g),w=Uf(x,p.mode,w),w.return=p,p=w),a(p)):n(p,g)}return function(p,g,x,w){try{ul=0;var N=y(p,g,x,w);return ca=null,N}catch(E){if(E===Ka||E===Bd)throw E;var T=tn(29,E,null,p.mode);return T.lanes=w,T.return=p,T}finally{}}}var dr=X1(!0),Q1=X1(!1),$s=!1;function tg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function om(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function ui(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function di(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,Ne&2){var i=s.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),s.pending=e,e=Nu(t),V1(t,null,n),e}return Pd(t,s,e,n),Nu(t)}function Bo(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194048)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,p1(t,n)}}function Vf(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var i=null,r=null;if(n=n.firstBaseUpdate,n!==null){do{var a={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};r===null?i=r=a:r=r.next=a,n=n.next}while(n!==null);r===null?i=r=e:r=r.next=e}else i=r=e;n={baseState:s.baseState,firstBaseUpdate:i,lastBaseUpdate:r,shared:s.shared,callbacks:s.callbacks},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}var lm=!1;function Uo(){if(lm){var t=la;if(t!==null)throw t}}function Ho(t,e,n,s){lm=!1;var i=t.updateQueue;$s=!1;var r=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?r=u:a.next=u,a=l;var d=t.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==a&&(o===null?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=l))}if(r!==null){var f=i.baseState;a=0,d=u=l=null,o=r;do{var h=o.lane&-536870913,m=h!==o.lane;if(m?(ve&h)===h:(s&h)===h){h!==0&&h===wa&&(lm=!0),d!==null&&(d=d.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var v=t,b=o;h=e;var y=n;switch(b.tag){case 1:if(v=b.payload,typeof v=="function"){f=v.call(y,f,h);break e}f=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=b.payload,h=typeof v=="function"?v.call(y,f,h):v,h==null)break e;f=ze({},f,h);break e;case 2:$s=!0}}h=o.callback,h!==null&&(t.flags|=64,m&&(t.flags|=8192),m=i.callbacks,m===null?i.callbacks=[h]:m.push(h))}else m={lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(u=d=m,l=f):d=d.next=m,a|=h;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;m=o,o=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);d===null&&(l=f),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=d,r===null&&(i.shared.lanes=0),Ti|=a,t.lanes=a,t.memoizedState=f}}function J1(t,e){if(typeof t!="function")throw Error(U(191,t));t.call(e)}function Z1(t,e){var n=t.callbacks;if(n!==null)for(t.callbacks=null,t=0;t<n.length;t++)J1(n[t],e)}var Ea=ns(null),Au=ns(0);function Wv(t,e){t=Cs,Be(Au,t),Be(Ea,e),Cs=t|e.baseLanes}function cm(){Be(Au,Cs),Be(Ea,Ea.current)}function ng(){Cs=Au.current,_t(Ea),_t(Au)}var dn=ns(null),Sn=null;function Ys(t){var e=t.alternate;Be(it,it.current&1),Be(dn,t),Sn===null&&(e===null||Ea.current!==null||e.memoizedState!==null)&&(Sn=t)}function um(t){Be(it,it.current),Be(dn,t),Sn===null&&(Sn=t)}function ew(t){t.tag===22?(Be(it,it.current),Be(dn,t),Sn===null&&(Sn=t)):qs()}function qs(){Be(it,it.current),Be(dn,dn.current)}function en(t){_t(dn),Sn===t&&(Sn=null),_t(it)}var it=ns(0);function Ru(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||Rm(n)||Im(n)))return e}else if(e.tag===19&&(e.memoizedProps.revealOrder==="forwards"||e.memoizedProps.revealOrder==="backwards"||e.memoizedProps.revealOrder==="unstable_legacy-backwards"||e.memoizedProps.revealOrder==="together")){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var As=0,ce=null,Oe=null,at=null,Iu=!1,ua=!1,fr=!1,Cu=0,dl=0,da=null,tI=0;function Je(){throw Error(U(321))}function sg(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!un(t[n],e[n]))return!1;return!0}function ig(t,e,n,s,i,r){return As=r,ce=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ie.H=t===null||t.memoizedState===null?Cw:pg,fr=!1,r=n(s,i),fr=!1,ua&&(r=nw(e,n,s,i)),tw(t),r}function tw(t){ie.H=fl;var e=Oe!==null&&Oe.next!==null;if(As=0,at=Oe=ce=null,Iu=!1,dl=0,da=null,e)throw Error(U(300));t===null||ct||(t=t.dependencies,t!==null&&Su(t)&&(ct=!0))}function nw(t,e,n,s){ce=t;var i=0;do{if(ua&&(da=null),dl=0,ua=!1,25<=i)throw Error(U(301));if(i+=1,at=Oe=null,t.updateQueue!=null){var r=t.updateQueue;r.lastEffect=null,r.events=null,r.stores=null,r.memoCache!=null&&(r.memoCache.index=0)}ie.H=jw,r=e(n,s)}while(ua);return r}function nI(){var t=ie.H,e=t.useState()[0];return e=typeof e.then=="function"?Yl(e):e,t=t.useState()[0],(Oe!==null?Oe.memoizedState:null)!==t&&(ce.flags|=1024),e}function rg(){var t=Cu!==0;return Cu=0,t}function ag(t,e,n){e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~n}function og(t){if(Iu){for(t=t.memoizedState;t!==null;){var e=t.queue;e!==null&&(e.pending=null),t=t.next}Iu=!1}As=0,at=Oe=ce=null,ua=!1,dl=Cu=0,da=null}function Lt(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return at===null?ce.memoizedState=at=t:at=at.next=t,at}function rt(){if(Oe===null){var t=ce.alternate;t=t!==null?t.memoizedState:null}else t=Oe.next;var e=at===null?ce.memoizedState:at.next;if(e!==null)at=e,Oe=t;else{if(t===null)throw ce.alternate===null?Error(U(467)):Error(U(310));Oe=t,t={memoizedState:Oe.memoizedState,baseState:Oe.baseState,baseQueue:Oe.baseQueue,queue:Oe.queue,next:null},at===null?ce.memoizedState=at=t:at=at.next=t}return at}function Ud(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Yl(t){var e=dl;return dl+=1,da===null&&(da=[]),t=W1(da,t,e),e=ce,(at===null?e.memoizedState:at.next)===null&&(e=e.alternate,ie.H=e===null||e.memoizedState===null?Cw:pg),t}function Hd(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return Yl(t);if(t.$$typeof===hs)return Rt(t)}throw Error(U(438,String(t)))}function lg(t){var e=null,n=ce.updateQueue;if(n!==null&&(e=n.memoCache),e==null){var s=ce.alternate;s!==null&&(s=s.updateQueue,s!==null&&(s=s.memoCache,s!=null&&(e={data:s.data.map(function(i){return i.slice()}),index:0})))}if(e==null&&(e={data:[],index:0}),n===null&&(n=Ud(),ce.updateQueue=n),n.memoCache=e,n=e.data[e.index],n===void 0)for(n=e.data[e.index]=Array(t),s=0;s<t;s++)n[s]=GA;return e.index++,n}function Rs(t,e){return typeof e=="function"?e(t):e}function tu(t){var e=rt();return cg(e,Oe,t)}function cg(t,e,n){var s=t.queue;if(s===null)throw Error(U(311));s.lastRenderedReducer=n;var i=t.baseQueue,r=s.pending;if(r!==null){if(i!==null){var a=i.next;i.next=r.next,r.next=a}e.baseQueue=i=r,s.pending=null}if(r=t.baseState,i===null)t.memoizedState=r;else{e=i.next;var o=a=null,l=null,u=e,d=!1;do{var f=u.lane&-536870913;if(f!==u.lane?(ve&f)===f:(As&f)===f){var h=u.revertLane;if(h===0)l!==null&&(l=l.next={lane:0,revertLane:0,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),f===wa&&(d=!0);else if((As&h)===h){u=u.next,h===wa&&(d=!0);continue}else f={lane:0,revertLane:u.revertLane,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},l===null?(o=l=f,a=r):l=l.next=f,ce.lanes|=h,Ti|=h;f=u.action,fr&&n(r,f),r=u.hasEagerState?u.eagerState:n(r,f)}else h={lane:f,revertLane:u.revertLane,gesture:u.gesture,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},l===null?(o=l=h,a=r):l=l.next=h,ce.lanes|=f,Ti|=f;u=u.next}while(u!==null&&u!==e);if(l===null?a=r:l.next=o,!un(r,t.memoizedState)&&(ct=!0,d&&(n=la,n!==null)))throw n;t.memoizedState=r,t.baseState=a,t.baseQueue=l,s.lastRenderedState=r}return i===null&&(s.lanes=0),[t.memoizedState,s.dispatch]}function Ff(t){var e=rt(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var s=n.dispatch,i=n.pending,r=e.memoizedState;if(i!==null){n.pending=null;var a=i=i.next;do r=t(r,a.action),a=a.next;while(a!==i);un(r,e.memoizedState)||(ct=!0),e.memoizedState=r,e.baseQueue===null&&(e.baseState=r),n.lastRenderedState=r}return[r,s]}function sw(t,e,n){var s=ce,i=rt(),r=xe;if(r){if(n===void 0)throw Error(U(407));n=n()}else n=e();var a=!un((Oe||i).memoizedState,n);if(a&&(i.memoizedState=n,ct=!0),i=i.queue,ug(aw.bind(null,s,i,t),[t]),i.getSnapshot!==e||a||at!==null&&at.memoizedState.tag&1){if(s.flags|=2048,Na(9,{destroy:void 0},rw.bind(null,s,i,n,e),null),Le===null)throw Error(U(349));r||As&127||iw(s,e,n)}return n}function iw(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ce.updateQueue,e===null?(e=Ud(),ce.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function rw(t,e,n,s){e.value=n,e.getSnapshot=s,ow(e)&&lw(t)}function aw(t,e,n){return n(function(){ow(e)&&lw(t)})}function ow(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!un(t,n)}catch{return!0}}function lw(t){var e=kr(t,2);e!==null&&Xt(e,t,2)}function dm(t){var e=Lt();if(typeof t=="function"){var n=t;if(t=n(),fr){ei(!0);try{n()}finally{ei(!1)}}}return e.memoizedState=e.baseState=t,e.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Rs,lastRenderedState:t},e}function cw(t,e,n,s){return t.baseState=n,cg(t,Oe,typeof s=="function"?s:Rs)}function sI(t,e,n,s,i){if(Vd(t))throw Error(U(485));if(t=e.action,t!==null){var r={payload:i,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(a){r.listeners.push(a)}};ie.T!==null?n(!0):r.isTransition=!1,s(r),n=e.pending,n===null?(r.next=e.pending=r,uw(e,r)):(r.next=n.next,e.pending=n.next=r)}}function uw(t,e){var n=e.action,s=e.payload,i=t.state;if(e.isTransition){var r=ie.T,a={};ie.T=a;try{var o=n(i,s),l=ie.S;l!==null&&l(a,o),Xv(t,e,o)}catch(u){fm(t,e,u)}finally{r!==null&&a.types!==null&&(r.types=a.types),ie.T=r}}else try{r=n(i,s),Xv(t,e,r)}catch(u){fm(t,e,u)}}function Xv(t,e,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(s){Qv(t,e,s)},function(s){return fm(t,e,s)}):Qv(t,e,n)}function Qv(t,e,n){e.status="fulfilled",e.value=n,dw(e),t.state=n,e=t.pending,e!==null&&(n=e.next,n===e?t.pending=null:(n=n.next,e.next=n,uw(t,n)))}function fm(t,e,n){var s=t.pending;if(t.pending=null,s!==null){s=s.next;do e.status="rejected",e.reason=n,dw(e),e=e.next;while(e!==s)}t.action=null}function dw(t){t=t.listeners;for(var e=0;e<t.length;e++)(0,t[e])()}function fw(t,e){return e}function Jv(t,e){if(xe){var n=Le.formState;if(n!==null){e:{var s=ce;if(xe){if(He){t:{for(var i=He,r=Nn;i.nodeType!==8;){if(!r){i=null;break t}if(i=Tn(i.nextSibling),i===null){i=null;break t}}r=i.data,i=r==="F!"||r==="F"?i:null}if(i){He=Tn(i.nextSibling),s=i.data==="F!";break e}}ki(s)}s=!1}s&&(e=n[0])}}return n=Lt(),n.memoizedState=n.baseState=e,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:fw,lastRenderedState:e},n.queue=s,n=Aw.bind(null,ce,s),s.dispatch=n,s=dm(!1),r=mg.bind(null,ce,!1,s.queue),s=Lt(),i={state:e,dispatch:null,action:t,pending:null},s.queue=i,n=sI.bind(null,ce,i,r,n),i.dispatch=n,s.memoizedState=t,[e,n,!1]}function Zv(t){var e=rt();return hw(e,Oe,t)}function hw(t,e,n){if(e=cg(t,e,fw)[0],t=tu(Rs)[0],typeof e=="object"&&e!==null&&typeof e.then=="function")try{var s=Yl(e)}catch(a){throw a===Ka?Bd:a}else s=e;e=rt();var i=e.queue,r=i.dispatch;return n!==e.memoizedState&&(ce.flags|=2048,Na(9,{destroy:void 0},iI.bind(null,i,n),null)),[s,r,t]}function iI(t,e){t.action=e}function eb(t){var e=rt(),n=Oe;if(n!==null)return hw(e,n,t);rt(),e=e.memoizedState,n=rt();var s=n.queue.dispatch;return n.memoizedState=t,[e,s,!1]}function Na(t,e,n,s){return t={tag:t,create:n,deps:s,inst:e,next:null},e=ce.updateQueue,e===null&&(e=Ud(),ce.updateQueue=e),n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t),t}function mw(){return rt().memoizedState}function nu(t,e,n,s){var i=Lt();ce.flags|=t,i.memoizedState=Na(1|e,{destroy:void 0},n,s===void 0?null:s)}function Gd(t,e,n,s){var i=rt();s=s===void 0?null:s;var r=i.memoizedState.inst;Oe!==null&&s!==null&&sg(s,Oe.memoizedState.deps)?i.memoizedState=Na(e,r,n,s):(ce.flags|=t,i.memoizedState=Na(1|e,r,n,s))}function tb(t,e){nu(8390656,8,t,e)}function ug(t,e){Gd(2048,8,t,e)}function rI(t){ce.flags|=4;var e=ce.updateQueue;if(e===null)e=Ud(),ce.updateQueue=e,e.events=[t];else{var n=e.events;n===null?e.events=[t]:n.push(t)}}function pw(t){var e=rt().memoizedState;return rI({ref:e,nextImpl:t}),function(){if(Ne&2)throw Error(U(440));return e.impl.apply(void 0,arguments)}}function gw(t,e){return Gd(4,2,t,e)}function vw(t,e){return Gd(4,4,t,e)}function bw(t,e){if(typeof e=="function"){t=t();var n=e(t);return function(){typeof n=="function"?n():e(null)}}if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function xw(t,e,n){n=n!=null?n.concat([t]):null,Gd(4,4,bw.bind(null,e,t),n)}function dg(){}function yw(t,e){var n=rt();e=e===void 0?null:e;var s=n.memoizedState;return e!==null&&sg(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function _w(t,e){var n=rt();e=e===void 0?null:e;var s=n.memoizedState;if(e!==null&&sg(e,s[1]))return s[0];if(s=t(),fr){ei(!0);try{t()}finally{ei(!1)}}return n.memoizedState=[s,e],s}function fg(t,e,n){return n===void 0||As&1073741824&&!(ve&261930)?t.memoizedState=e:(t.memoizedState=n,t=cE(),ce.lanes|=t,Ti|=t,n)}function ww(t,e,n,s){return un(n,e)?n:Ea.current!==null?(t=fg(t,n,s),un(t,e)||(ct=!0),t):!(As&42)||As&1073741824&&!(ve&261930)?(ct=!0,t.memoizedState=n):(t=cE(),ce.lanes|=t,Ti|=t,e)}function Ew(t,e,n,s,i){var r=ke.p;ke.p=r!==0&&8>r?r:8;var a=ie.T,o={};ie.T=o,mg(t,!1,e,n);try{var l=i(),u=ie.S;if(u!==null&&u(o,l),l!==null&&typeof l=="object"&&typeof l.then=="function"){var d=eI(l,s);Go(t,e,d,ln(t))}else Go(t,e,s,ln(t))}catch(f){Go(t,e,{then:function(){},status:"rejected",reason:f},ln())}finally{ke.p=r,a!==null&&o.types!==null&&(a.types=o.types),ie.T=a}}function aI(){}function hm(t,e,n,s){if(t.tag!==5)throw Error(U(476));var i=Nw(t).queue;Ew(t,i,e,tr,n===null?aI:function(){return kw(t),n(s)})}function Nw(t){var e=t.memoizedState;if(e!==null)return e;e={memoizedState:tr,baseState:tr,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Rs,lastRenderedState:tr},next:null};var n={};return e.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Rs,lastRenderedState:n},next:null},t.memoizedState=e,t=t.alternate,t!==null&&(t.memoizedState=e),e}function kw(t){var e=Nw(t);e.next===null&&(e=t.alternate.memoizedState),Go(t,e.next.queue,{},ln())}function hg(){return Rt(pl)}function Sw(){return rt().memoizedState}function Tw(){return rt().memoizedState}function oI(t){for(var e=t.return;e!==null;){switch(e.tag){case 24:case 3:var n=ln();t=ui(n);var s=di(e,t,n);s!==null&&(Xt(s,e,n),Bo(s,e,n)),e={cache:Jp()},t.payload=e;return}e=e.return}}function lI(t,e,n){var s=ln();n={lane:s,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},Vd(t)?Rw(e,n):(n=qp(t,e,n,s),n!==null&&(Xt(n,t,s),Iw(n,e,s)))}function Aw(t,e,n){var s=ln();Go(t,e,n,s)}function Go(t,e,n,s){var i={lane:s,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(Vd(t))Rw(e,i);else{var r=t.alternate;if(t.lanes===0&&(r===null||r.lanes===0)&&(r=e.lastRenderedReducer,r!==null))try{var a=e.lastRenderedState,o=r(a,n);if(i.hasEagerState=!0,i.eagerState=o,un(o,a))return Pd(t,e,i,0),Le===null&&Ld(),!1}catch{}finally{}if(n=qp(t,e,i,s),n!==null)return Xt(n,t,s),Iw(n,e,s),!0}return!1}function mg(t,e,n,s){if(s={lane:2,revertLane:Eg(),gesture:null,action:s,hasEagerState:!1,eagerState:null,next:null},Vd(t)){if(e)throw Error(U(479))}else e=qp(t,n,s,2),e!==null&&Xt(e,t,2)}function Vd(t){var e=t.alternate;return t===ce||e!==null&&e===ce}function Rw(t,e){ua=Iu=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Iw(t,e,n){if(n&4194048){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,p1(t,n)}}var fl={readContext:Rt,use:Hd,useCallback:Je,useContext:Je,useEffect:Je,useImperativeHandle:Je,useLayoutEffect:Je,useInsertionEffect:Je,useMemo:Je,useReducer:Je,useRef:Je,useState:Je,useDebugValue:Je,useDeferredValue:Je,useTransition:Je,useSyncExternalStore:Je,useId:Je,useHostTransitionStatus:Je,useFormState:Je,useActionState:Je,useOptimistic:Je,useMemoCache:Je,useCacheRefresh:Je};fl.useEffectEvent=Je;var Cw={readContext:Rt,use:Hd,useCallback:function(t,e){return Lt().memoizedState=[t,e===void 0?null:e],t},useContext:Rt,useEffect:tb,useImperativeHandle:function(t,e,n){n=n!=null?n.concat([t]):null,nu(4194308,4,bw.bind(null,e,t),n)},useLayoutEffect:function(t,e){return nu(4194308,4,t,e)},useInsertionEffect:function(t,e){nu(4,2,t,e)},useMemo:function(t,e){var n=Lt();e=e===void 0?null:e;var s=t();if(fr){ei(!0);try{t()}finally{ei(!1)}}return n.memoizedState=[s,e],s},useReducer:function(t,e,n){var s=Lt();if(n!==void 0){var i=n(e);if(fr){ei(!0);try{n(e)}finally{ei(!1)}}}else i=e;return s.memoizedState=s.baseState=i,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:i},s.queue=t,t=t.dispatch=lI.bind(null,ce,t),[s.memoizedState,t]},useRef:function(t){var e=Lt();return t={current:t},e.memoizedState=t},useState:function(t){t=dm(t);var e=t.queue,n=Aw.bind(null,ce,e);return e.dispatch=n,[t.memoizedState,n]},useDebugValue:dg,useDeferredValue:function(t,e){var n=Lt();return fg(n,t,e)},useTransition:function(){var t=dm(!1);return t=Ew.bind(null,ce,t.queue,!0,!1),Lt().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,e,n){var s=ce,i=Lt();if(xe){if(n===void 0)throw Error(U(407));n=n()}else{if(n=e(),Le===null)throw Error(U(349));ve&127||iw(s,e,n)}i.memoizedState=n;var r={value:n,getSnapshot:e};return i.queue=r,tb(aw.bind(null,s,r,t),[t]),s.flags|=2048,Na(9,{destroy:void 0},rw.bind(null,s,r,n,e),null),n},useId:function(){var t=Lt(),e=Le.identifierPrefix;if(xe){var n=qn,s=Yn;n=(s&~(1<<32-on(s)-1)).toString(32)+n,e="_"+e+"R_"+n,n=Cu++,0<n&&(e+="H"+n.toString(32)),e+="_"}else n=tI++,e="_"+e+"r_"+n.toString(32)+"_";return t.memoizedState=e},useHostTransitionStatus:hg,useFormState:Jv,useActionState:Jv,useOptimistic:function(t){var e=Lt();e.memoizedState=e.baseState=t;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return e.queue=n,e=mg.bind(null,ce,!0,n),n.dispatch=e,[t,e]},useMemoCache:lg,useCacheRefresh:function(){return Lt().memoizedState=oI.bind(null,ce)},useEffectEvent:function(t){var e=Lt(),n={impl:t};return e.memoizedState=n,function(){if(Ne&2)throw Error(U(440));return n.impl.apply(void 0,arguments)}}},pg={readContext:Rt,use:Hd,useCallback:yw,useContext:Rt,useEffect:ug,useImperativeHandle:xw,useInsertionEffect:gw,useLayoutEffect:vw,useMemo:_w,useReducer:tu,useRef:mw,useState:function(){return tu(Rs)},useDebugValue:dg,useDeferredValue:function(t,e){var n=rt();return ww(n,Oe.memoizedState,t,e)},useTransition:function(){var t=tu(Rs)[0],e=rt().memoizedState;return[typeof t=="boolean"?t:Yl(t),e]},useSyncExternalStore:sw,useId:Sw,useHostTransitionStatus:hg,useFormState:Zv,useActionState:Zv,useOptimistic:function(t,e){var n=rt();return cw(n,Oe,t,e)},useMemoCache:lg,useCacheRefresh:Tw};pg.useEffectEvent=pw;var jw={readContext:Rt,use:Hd,useCallback:yw,useContext:Rt,useEffect:ug,useImperativeHandle:xw,useInsertionEffect:gw,useLayoutEffect:vw,useMemo:_w,useReducer:Ff,useRef:mw,useState:function(){return Ff(Rs)},useDebugValue:dg,useDeferredValue:function(t,e){var n=rt();return Oe===null?fg(n,t,e):ww(n,Oe.memoizedState,t,e)},useTransition:function(){var t=Ff(Rs)[0],e=rt().memoizedState;return[typeof t=="boolean"?t:Yl(t),e]},useSyncExternalStore:sw,useId:Sw,useHostTransitionStatus:hg,useFormState:eb,useActionState:eb,useOptimistic:function(t,e){var n=rt();return Oe!==null?cw(n,Oe,t,e):(n.baseState=t,[t,n.queue.dispatch])},useMemoCache:lg,useCacheRefresh:Tw};jw.useEffectEvent=pw;function zf(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:ze({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var mm={enqueueSetState:function(t,e,n){t=t._reactInternals;var s=ln(),i=ui(s);i.payload=e,n!=null&&(i.callback=n),e=di(t,i,s),e!==null&&(Xt(e,t,s),Bo(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=ln(),i=ui(s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=di(t,i,s),e!==null&&(Xt(e,t,s),Bo(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ln(),s=ui(n);s.tag=2,e!=null&&(s.callback=e),e=di(t,s,n),e!==null&&(Xt(e,t,n),Bo(e,t,n))}};function nb(t,e,n,s,i,r,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,r,a):e.prototype&&e.prototype.isPureReactComponent?!ol(n,s)||!ol(i,r):!0}function sb(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&mm.enqueueReplaceState(e,e.state,null)}function hr(t,e){var n=e;if("ref"in e){n={};for(var s in e)s!=="ref"&&(n[s]=e[s])}if(t=t.defaultProps){n===e&&(n=ze({},n));for(var i in t)n[i]===void 0&&(n[i]=t[i])}return n}function Ow(t){Eu(t)}function Mw(t){console.error(t)}function Dw(t){Eu(t)}function ju(t,e){try{var n=t.onUncaughtError;n(e.value,{componentStack:e.stack})}catch(s){setTimeout(function(){throw s})}}function ib(t,e,n){try{var s=t.onCaughtError;s(n.value,{componentStack:n.stack,errorBoundary:e.tag===1?e.stateNode:null})}catch(i){setTimeout(function(){throw i})}}function pm(t,e,n){return n=ui(n),n.tag=3,n.payload={element:null},n.callback=function(){ju(t,e)},n}function Lw(t){return t=ui(t),t.tag=3,t}function Pw(t,e,n,s){var i=n.type.getDerivedStateFromError;if(typeof i=="function"){var r=s.value;t.payload=function(){return i(r)},t.callback=function(){ib(e,n,s)}}var a=n.stateNode;a!==null&&typeof a.componentDidCatch=="function"&&(t.callback=function(){ib(e,n,s),typeof i!="function"&&(fi===null?fi=new Set([this]):fi.add(this));var o=s.stack;this.componentDidCatch(s.value,{componentStack:o!==null?o:""})})}function cI(t,e,n,s,i){if(n.flags|=32768,s!==null&&typeof s=="object"&&typeof s.then=="function"){if(e=n.alternate,e!==null&&$a(e,n,i,!0),n=dn.current,n!==null){switch(n.tag){case 31:case 13:return Sn===null?Pu():n.alternate===null&&et===0&&(et=3),n.flags&=-257,n.flags|=65536,n.lanes=i,s===Tu?n.flags|=16384:(e=n.updateQueue,e===null?n.updateQueue=new Set([s]):e.add(s),th(t,s,i)),!1;case 22:return n.flags|=65536,s===Tu?n.flags|=16384:(e=n.updateQueue,e===null?(e={transitions:null,markerInstances:null,retryQueue:new Set([s])},n.updateQueue=e):(n=e.retryQueue,n===null?e.retryQueue=new Set([s]):n.add(s)),th(t,s,i)),!1}throw Error(U(435,n.tag))}return th(t,s,i),Pu(),!1}if(xe)return e=dn.current,e!==null?(!(e.flags&65536)&&(e.flags|=256),e.flags|=65536,e.lanes=i,s!==nm&&(t=Error(U(422),{cause:s}),cl(En(t,n)))):(s!==nm&&(e=Error(U(423),{cause:s}),cl(En(e,n))),t=t.current.alternate,t.flags|=65536,i&=-i,t.lanes|=i,s=En(s,n),i=pm(t.stateNode,s,i),Vf(t,i),et!==4&&(et=2)),!1;var r=Error(U(520),{cause:s});if(r=En(r,n),zo===null?zo=[r]:zo.push(r),et!==4&&(et=2),e===null)return!0;s=En(s,n),n=e;do{switch(n.tag){case 3:return n.flags|=65536,t=i&-i,n.lanes|=t,t=pm(n.stateNode,s,t),Vf(n,t),!1;case 1:if(e=n.type,r=n.stateNode,(n.flags&128)===0&&(typeof e.getDerivedStateFromError=="function"||r!==null&&typeof r.componentDidCatch=="function"&&(fi===null||!fi.has(r))))return n.flags|=65536,i&=-i,n.lanes|=i,i=Lw(i),Pw(i,t,n,s),Vf(n,i),!1}n=n.return}while(n!==null);return!1}var gg=Error(U(461)),ct=!1;function kt(t,e,n,s){e.child=t===null?Q1(e,null,n,s):dr(e,t.child,n,s)}function rb(t,e,n,s,i){n=n.render;var r=e.ref;if("ref"in s){var a={};for(var o in s)o!=="ref"&&(a[o]=s[o])}else a=s;return ur(e),s=ig(t,e,n,a,r,i),o=rg(),t!==null&&!ct?(ag(t,e,i),Is(t,e,i)):(xe&&o&&Xp(e),e.flags|=1,kt(t,e,s,i),e.child)}function ab(t,e,n,s,i){if(t===null){var r=n.type;return typeof r=="function"&&!Wp(r)&&r.defaultProps===void 0&&n.compare===null?(e.tag=15,e.type=r,Bw(t,e,r,s,i)):(t=Zc(n.type,null,s,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(r=t.child,!vg(t,i)){var a=r.memoizedProps;if(n=n.compare,n=n!==null?n:ol,n(a,s)&&t.ref===e.ref)return Is(t,e,i)}return e.flags|=1,t=ys(r,s),t.ref=e.ref,t.return=e,e.child=t}function Bw(t,e,n,s,i){if(t!==null){var r=t.memoizedProps;if(ol(r,s)&&t.ref===e.ref)if(ct=!1,e.pendingProps=s=r,vg(t,i))t.flags&131072&&(ct=!0);else return e.lanes=t.lanes,Is(t,e,i)}return gm(t,e,n,s,i)}function Uw(t,e,n,s){var i=s.children,r=t!==null?t.memoizedState:null;if(t===null&&e.stateNode===null&&(e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.mode==="hidden"){if(e.flags&128){if(r=r!==null?r.baseLanes|n:n,t!==null){for(s=e.child=t.child,i=0;s!==null;)i=i|s.lanes|s.childLanes,s=s.sibling;s=i&~r}else s=0,e.child=null;return ob(t,e,r,n,s)}if(n&536870912)e.memoizedState={baseLanes:0,cachePool:null},t!==null&&eu(e,r!==null?r.cachePool:null),r!==null?Wv(e,r):cm(),ew(e);else return s=e.lanes=536870912,ob(t,e,r!==null?r.baseLanes|n:n,n,s)}else r!==null?(eu(e,r.cachePool),Wv(e,r),qs(),e.memoizedState=null):(t!==null&&eu(e,null),cm(),qs());return kt(t,e,i,n),e.child}function ko(t,e){return t!==null&&t.tag===22||e.stateNode!==null||(e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),e.sibling}function ob(t,e,n,s,i){var r=Zp();return r=r===null?null:{parent:lt._currentValue,pool:r},e.memoizedState={baseLanes:n,cachePool:r},t!==null&&eu(e,null),cm(),ew(e),t!==null&&$a(t,e,s,!0),e.childLanes=i,null}function su(t,e){return e=Ou({mode:e.mode,children:e.children},t.mode),e.ref=t.ref,t.child=e,e.return=t,e}function lb(t,e,n){return dr(e,t.child,null,n),t=su(e,e.pendingProps),t.flags|=2,en(e),e.memoizedState=null,t}function uI(t,e,n){var s=e.pendingProps,i=(e.flags&128)!==0;if(e.flags&=-129,t===null){if(xe){if(s.mode==="hidden")return t=su(e,s),e.lanes=536870912,ko(null,t);if(um(e),(t=He)?(t=CE(t,Nn),t=t!==null&&t.data==="&"?t:null,t!==null&&(e.memoizedState={dehydrated:t,treeContext:Ni!==null?{id:Yn,overflow:qn}:null,retryLane:536870912,hydrationErrors:null},n=z1(t),n.return=e,e.child=n,Tt=e,He=null)):t=null,t===null)throw ki(e);return e.lanes=536870912,null}return su(e,s)}var r=t.memoizedState;if(r!==null){var a=r.dehydrated;if(um(e),i)if(e.flags&256)e.flags&=-257,e=lb(t,e,n);else if(e.memoizedState!==null)e.child=t.child,e.flags|=128,e=null;else throw Error(U(558));else if(ct||$a(t,e,n,!1),i=(n&t.childLanes)!==0,ct||i){if(s=Le,s!==null&&(a=g1(s,n),a!==0&&a!==r.retryLane))throw r.retryLane=a,kr(t,a),Xt(s,t,a),gg;Pu(),e=lb(t,e,n)}else t=r.treeContext,He=Tn(a.nextSibling),Tt=e,xe=!0,ci=null,Nn=!1,t!==null&&K1(e,t),e=su(e,s),e.flags|=4096;return e}return t=ys(t.child,{mode:s.mode,children:s.children}),t.ref=e.ref,e.child=t,t.return=e,t}function iu(t,e){var n=e.ref;if(n===null)t!==null&&t.ref!==null&&(e.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(U(284));(t===null||t.ref!==n)&&(e.flags|=4194816)}}function gm(t,e,n,s,i){return ur(e),n=ig(t,e,n,s,void 0,i),s=rg(),t!==null&&!ct?(ag(t,e,i),Is(t,e,i)):(xe&&s&&Xp(e),e.flags|=1,kt(t,e,n,i),e.child)}function cb(t,e,n,s,i,r){return ur(e),e.updateQueue=null,n=nw(e,s,n,i),tw(t),s=rg(),t!==null&&!ct?(ag(t,e,r),Is(t,e,r)):(xe&&s&&Xp(e),e.flags|=1,kt(t,e,n,r),e.child)}function ub(t,e,n,s,i){if(ur(e),e.stateNode===null){var r=qr,a=n.contextType;typeof a=="object"&&a!==null&&(r=Rt(a)),r=new n(s,r),e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=mm,e.stateNode=r,r._reactInternals=e,r=e.stateNode,r.props=s,r.state=e.memoizedState,r.refs={},tg(e),a=n.contextType,r.context=typeof a=="object"&&a!==null?Rt(a):qr,r.state=e.memoizedState,a=n.getDerivedStateFromProps,typeof a=="function"&&(zf(e,n,a,s),r.state=e.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(a=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),a!==r.state&&mm.enqueueReplaceState(r,r.state,null),Ho(e,s,r,i),Uo(),r.state=e.memoizedState),typeof r.componentDidMount=="function"&&(e.flags|=4194308),s=!0}else if(t===null){r=e.stateNode;var o=e.memoizedProps,l=hr(n,o);r.props=l;var u=r.context,d=n.contextType;a=qr,typeof d=="object"&&d!==null&&(a=Rt(d));var f=n.getDerivedStateFromProps;d=typeof f=="function"||typeof r.getSnapshotBeforeUpdate=="function",o=e.pendingProps!==o,d||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(o||u!==a)&&sb(e,r,s,a),$s=!1;var h=e.memoizedState;r.state=h,Ho(e,s,r,i),Uo(),u=e.memoizedState,o||h!==u||$s?(typeof f=="function"&&(zf(e,n,f,s),u=e.memoizedState),(l=$s||nb(e,n,l,s,h,u,a))?(d||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount()),typeof r.componentDidMount=="function"&&(e.flags|=4194308)):(typeof r.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=u),r.props=s,r.state=u,r.context=a,s=l):(typeof r.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{r=e.stateNode,om(t,e),a=e.memoizedProps,d=hr(n,a),r.props=d,f=e.pendingProps,h=r.context,u=n.contextType,l=qr,typeof u=="object"&&u!==null&&(l=Rt(u)),o=n.getDerivedStateFromProps,(u=typeof o=="function"||typeof r.getSnapshotBeforeUpdate=="function")||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(a!==f||h!==l)&&sb(e,r,s,l),$s=!1,h=e.memoizedState,r.state=h,Ho(e,s,r,i),Uo();var m=e.memoizedState;a!==f||h!==m||$s||t!==null&&t.dependencies!==null&&Su(t.dependencies)?(typeof o=="function"&&(zf(e,n,o,s),m=e.memoizedState),(d=$s||nb(e,n,d,s,h,m,l)||t!==null&&t.dependencies!==null&&Su(t.dependencies))?(u||typeof r.UNSAFE_componentWillUpdate!="function"&&typeof r.componentWillUpdate!="function"||(typeof r.componentWillUpdate=="function"&&r.componentWillUpdate(s,m,l),typeof r.UNSAFE_componentWillUpdate=="function"&&r.UNSAFE_componentWillUpdate(s,m,l)),typeof r.componentDidUpdate=="function"&&(e.flags|=4),typeof r.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof r.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=m),r.props=s,r.state=m,r.context=l,s=d):(typeof r.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),s=!1)}return r=s,iu(t,e),s=(e.flags&128)!==0,r||s?(r=e.stateNode,n=s&&typeof n.getDerivedStateFromError!="function"?null:r.render(),e.flags|=1,t!==null&&s?(e.child=dr(e,t.child,null,i),e.child=dr(e,null,n,i)):kt(t,e,n,i),e.memoizedState=r.state,t=e.child):t=Is(t,e,i),t}function db(t,e,n,s){return cr(),e.flags|=256,kt(t,e,n,s),e.child}var $f={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Kf(t){return{baseLanes:t,cachePool:q1()}}function Yf(t,e,n){return t=t!==null?t.childLanes&~n:0,e&&(t|=sn),t}function Hw(t,e,n){var s=e.pendingProps,i=!1,r=(e.flags&128)!==0,a;if((a=r)||(a=t!==null&&t.memoizedState===null?!1:(it.current&2)!==0),a&&(i=!0,e.flags&=-129),a=(e.flags&32)!==0,e.flags&=-33,t===null){if(xe){if(i?Ys(e):qs(),(t=He)?(t=CE(t,Nn),t=t!==null&&t.data!=="&"?t:null,t!==null&&(e.memoizedState={dehydrated:t,treeContext:Ni!==null?{id:Yn,overflow:qn}:null,retryLane:536870912,hydrationErrors:null},n=z1(t),n.return=e,e.child=n,Tt=e,He=null)):t=null,t===null)throw ki(e);return Im(t)?e.lanes=32:e.lanes=536870912,null}var o=s.children;return s=s.fallback,i?(qs(),i=e.mode,o=Ou({mode:"hidden",children:o},i),s=nr(s,i,n,null),o.return=e,s.return=e,o.sibling=s,e.child=o,s=e.child,s.memoizedState=Kf(n),s.childLanes=Yf(t,a,n),e.memoizedState=$f,ko(null,s)):(Ys(e),vm(e,o))}var l=t.memoizedState;if(l!==null&&(o=l.dehydrated,o!==null)){if(r)e.flags&256?(Ys(e),e.flags&=-257,e=qf(t,e,n)):e.memoizedState!==null?(qs(),e.child=t.child,e.flags|=128,e=null):(qs(),o=s.fallback,i=e.mode,s=Ou({mode:"visible",children:s.children},i),o=nr(o,i,n,null),o.flags|=2,s.return=e,o.return=e,s.sibling=o,e.child=s,dr(e,t.child,null,n),s=e.child,s.memoizedState=Kf(n),s.childLanes=Yf(t,a,n),e.memoizedState=$f,e=ko(null,s));else if(Ys(e),Im(o)){if(a=o.nextSibling&&o.nextSibling.dataset,a)var u=a.dgst;a=u,s=Error(U(419)),s.stack="",s.digest=a,cl({value:s,source:null,stack:null}),e=qf(t,e,n)}else if(ct||$a(t,e,n,!1),a=(n&t.childLanes)!==0,ct||a){if(a=Le,a!==null&&(s=g1(a,n),s!==0&&s!==l.retryLane))throw l.retryLane=s,kr(t,s),Xt(a,t,s),gg;Rm(o)||Pu(),e=qf(t,e,n)}else Rm(o)?(e.flags|=192,e.child=t.child,e=null):(t=l.treeContext,He=Tn(o.nextSibling),Tt=e,xe=!0,ci=null,Nn=!1,t!==null&&K1(e,t),e=vm(e,s.children),e.flags|=4096);return e}return i?(qs(),o=s.fallback,i=e.mode,l=t.child,u=l.sibling,s=ys(l,{mode:"hidden",children:s.children}),s.subtreeFlags=l.subtreeFlags&65011712,u!==null?o=ys(u,o):(o=nr(o,i,n,null),o.flags|=2),o.return=e,s.return=e,s.sibling=o,e.child=s,ko(null,s),s=e.child,o=t.child.memoizedState,o===null?o=Kf(n):(i=o.cachePool,i!==null?(l=lt._currentValue,i=i.parent!==l?{parent:l,pool:l}:i):i=q1(),o={baseLanes:o.baseLanes|n,cachePool:i}),s.memoizedState=o,s.childLanes=Yf(t,a,n),e.memoizedState=$f,ko(t.child,s)):(Ys(e),n=t.child,t=n.sibling,n=ys(n,{mode:"visible",children:s.children}),n.return=e,n.sibling=null,t!==null&&(a=e.deletions,a===null?(e.deletions=[t],e.flags|=16):a.push(t)),e.child=n,e.memoizedState=null,n)}function vm(t,e){return e=Ou({mode:"visible",children:e},t.mode),e.return=t,t.child=e}function Ou(t,e){return t=tn(22,t,null,e),t.lanes=0,t}function qf(t,e,n){return dr(e,t.child,null,n),t=vm(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function fb(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),im(t.return,e,n)}function Wf(t,e,n,s,i,r){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:i,treeForkCount:r}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=s,a.tail=n,a.tailMode=i,a.treeForkCount=r)}function Gw(t,e,n){var s=e.pendingProps,i=s.revealOrder,r=s.tail;s=s.children;var a=it.current,o=(a&2)!==0;if(o?(a=a&1|2,e.flags|=128):a&=1,Be(it,a),kt(t,e,s,n),s=xe?ll:0,!o&&t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&fb(t,n,e);else if(t.tag===19)fb(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Ru(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Wf(e,!1,i,n,r,s);break;case"backwards":case"unstable_legacy-backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Ru(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Wf(e,!0,n,null,r,s);break;case"together":Wf(e,!1,null,null,void 0,s);break;default:e.memoizedState=null}return e.child}function Is(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ti|=e.lanes,!(n&e.childLanes))if(t!==null){if($a(t,e,n,!1),(n&e.childLanes)===0)return null}else return null;if(t!==null&&e.child!==t.child)throw Error(U(153));if(e.child!==null){for(t=e.child,n=ys(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ys(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function vg(t,e){return t.lanes&e?!0:(t=t.dependencies,!!(t!==null&&Su(t)))}function dI(t,e,n){switch(e.tag){case 3:xu(e,e.stateNode.containerInfo),Ks(e,lt,t.memoizedState.cache),cr();break;case 27:case 5:$h(e);break;case 4:xu(e,e.stateNode.containerInfo);break;case 10:Ks(e,e.type,e.memoizedProps.value);break;case 31:if(e.memoizedState!==null)return e.flags|=128,um(e),null;break;case 13:var s=e.memoizedState;if(s!==null)return s.dehydrated!==null?(Ys(e),e.flags|=128,null):n&e.child.childLanes?Hw(t,e,n):(Ys(e),t=Is(t,e,n),t!==null?t.sibling:null);Ys(e);break;case 19:var i=(t.flags&128)!==0;if(s=(n&e.childLanes)!==0,s||($a(t,e,n,!1),s=(n&e.childLanes)!==0),i){if(s)return Gw(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Be(it,it.current),s)break;return null;case 22:return e.lanes=0,Uw(t,e,n,e.pendingProps);case 24:Ks(e,lt,t.memoizedState.cache)}return Is(t,e,n)}function Vw(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps)ct=!0;else{if(!vg(t,n)&&!(e.flags&128))return ct=!1,dI(t,e,n);ct=!!(t.flags&131072)}else ct=!1,xe&&e.flags&1048576&&$1(e,ll,e.index);switch(e.lanes=0,e.tag){case 16:e:{var s=e.pendingProps;if(t=Ki(e.elementType),e.type=t,typeof t=="function")Wp(t)?(s=hr(t,s),e.tag=1,e=ub(null,e,t,s,n)):(e.tag=0,e=gm(null,e,t,s,n));else{if(t!=null){var i=t.$$typeof;if(i===Dp){e.tag=11,e=rb(null,e,t,s,n);break e}else if(i===Lp){e.tag=14,e=ab(null,e,t,s,n);break e}}throw e=Fh(t)||t,Error(U(306,e,""))}}return e;case 0:return gm(t,e,e.type,e.pendingProps,n);case 1:return s=e.type,i=hr(s,e.pendingProps),ub(t,e,s,i,n);case 3:e:{if(xu(e,e.stateNode.containerInfo),t===null)throw Error(U(387));s=e.pendingProps;var r=e.memoizedState;i=r.element,om(t,e),Ho(e,s,null,n);var a=e.memoizedState;if(s=a.cache,Ks(e,lt,s),s!==r.cache&&rm(e,[lt],n,!0),Uo(),s=a.element,r.isDehydrated)if(r={element:s,isDehydrated:!1,cache:a.cache},e.updateQueue.baseState=r,e.memoizedState=r,e.flags&256){e=db(t,e,s,n);break e}else if(s!==i){i=En(Error(U(424)),e),cl(i),e=db(t,e,s,n);break e}else{switch(t=e.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(He=Tn(t.firstChild),Tt=e,xe=!0,ci=null,Nn=!0,n=Q1(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(cr(),s===i){e=Is(t,e,n);break e}kt(t,e,s,n)}e=e.child}return e;case 26:return iu(t,e),t===null?(n=jb(e.type,null,e.pendingProps,null))?e.memoizedState=n:xe||(n=e.type,t=e.pendingProps,s=Gu(li.current).createElement(n),s[St]=e,s[Qt]=t,It(s,n,t),xt(s),e.stateNode=s):e.memoizedState=jb(e.type,t.memoizedProps,e.pendingProps,t.memoizedState),null;case 27:return $h(e),t===null&&xe&&(s=e.stateNode=jE(e.type,e.pendingProps,li.current),Tt=e,Nn=!0,i=He,Li(e.type)?(Cm=i,He=Tn(s.firstChild)):He=i),kt(t,e,e.pendingProps.children,n),iu(t,e),t===null&&(e.flags|=4194304),e.child;case 5:return t===null&&xe&&((i=s=He)&&(s=GI(s,e.type,e.pendingProps,Nn),s!==null?(e.stateNode=s,Tt=e,He=Tn(s.firstChild),Nn=!1,i=!0):i=!1),i||ki(e)),$h(e),i=e.type,r=e.pendingProps,a=t!==null?t.memoizedProps:null,s=r.children,Tm(i,r)?s=null:a!==null&&Tm(i,a)&&(e.flags|=32),e.memoizedState!==null&&(i=ig(t,e,nI,null,null,n),pl._currentValue=i),iu(t,e),kt(t,e,s,n),e.child;case 6:return t===null&&xe&&((t=n=He)&&(n=VI(n,e.pendingProps,Nn),n!==null?(e.stateNode=n,Tt=e,He=null,t=!0):t=!1),t||ki(e)),null;case 13:return Hw(t,e,n);case 4:return xu(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=dr(e,null,s,n):kt(t,e,s,n),e.child;case 11:return rb(t,e,e.type,e.pendingProps,n);case 7:return kt(t,e,e.pendingProps,n),e.child;case 8:return kt(t,e,e.pendingProps.children,n),e.child;case 12:return kt(t,e,e.pendingProps.children,n),e.child;case 10:return s=e.pendingProps,Ks(e,e.type,s.value),kt(t,e,s.children,n),e.child;case 9:return i=e.type._context,s=e.pendingProps.children,ur(e),i=Rt(i),s=s(i),e.flags|=1,kt(t,e,s,n),e.child;case 14:return ab(t,e,e.type,e.pendingProps,n);case 15:return Bw(t,e,e.type,e.pendingProps,n);case 19:return Gw(t,e,n);case 31:return uI(t,e,n);case 22:return Uw(t,e,n,e.pendingProps);case 24:return ur(e),s=Rt(lt),t===null?(i=Zp(),i===null&&(i=Le,r=Jp(),i.pooledCache=r,r.refCount++,r!==null&&(i.pooledCacheLanes|=n),i=r),e.memoizedState={parent:s,cache:i},tg(e),Ks(e,lt,i)):(t.lanes&n&&(om(t,e),Ho(e,null,null,n),Uo()),i=t.memoizedState,r=e.memoizedState,i.parent!==s?(i={parent:s,cache:s},e.memoizedState=i,e.lanes===0&&(e.memoizedState=e.updateQueue.baseState=i),Ks(e,lt,s)):(s=r.cache,Ks(e,lt,s),s!==i.cache&&rm(e,[lt],n,!0))),kt(t,e,e.pendingProps.children,n),e.child;case 29:throw e.pendingProps}throw Error(U(156,e.tag))}function os(t){t.flags|=4}function Xf(t,e,n,s,i){if((e=(t.mode&32)!==0)&&(e=!1),e){if(t.flags|=16777216,(i&335544128)===i)if(t.stateNode.complete)t.flags|=8192;else if(fE())t.flags|=8192;else throw ir=Tu,eg}else t.flags&=-16777217}function hb(t,e){if(e.type!=="stylesheet"||e.state.loading&4)t.flags&=-16777217;else if(t.flags|=16777216,!DE(e))if(fE())t.flags|=8192;else throw ir=Tu,eg}function jc(t,e){e!==null&&(t.flags|=4),t.flags&16384&&(e=t.tag!==22?h1():536870912,t.lanes|=e,ka|=e)}function mo(t,e){if(!xe)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function Ue(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,s|=i.subtreeFlags&65011712,s|=i.flags&65011712,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,s|=i.subtreeFlags,s|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function fI(t,e,n){var s=e.pendingProps;switch(Qp(e),e.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ue(e),null;case 1:return Ue(e),null;case 3:return n=e.stateNode,s=null,t!==null&&(s=t.memoizedState.cache),e.memoizedState.cache!==s&&(e.flags|=2048),_s(lt),xa(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(jr(e)?os(e):t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Gf())),Ue(e),null;case 26:var i=e.type,r=e.memoizedState;return t===null?(os(e),r!==null?(Ue(e),hb(e,r)):(Ue(e),Xf(e,i,null,s,n))):r?r!==t.memoizedState?(os(e),Ue(e),hb(e,r)):(Ue(e),e.flags&=-16777217):(t=t.memoizedProps,t!==s&&os(e),Ue(e),Xf(e,i,t,s,n)),null;case 27:if(yu(e),n=li.current,i=e.type,t!==null&&e.stateNode!=null)t.memoizedProps!==s&&os(e);else{if(!s){if(e.stateNode===null)throw Error(U(166));return Ue(e),null}t=Xn.current,jr(e)?Vv(e):(t=jE(i,s,n),e.stateNode=t,os(e))}return Ue(e),null;case 5:if(yu(e),i=e.type,t!==null&&e.stateNode!=null)t.memoizedProps!==s&&os(e);else{if(!s){if(e.stateNode===null)throw Error(U(166));return Ue(e),null}if(r=Xn.current,jr(e))Vv(e);else{var a=Gu(li.current);switch(r){case 1:r=a.createElementNS("http://www.w3.org/2000/svg",i);break;case 2:r=a.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;default:switch(i){case"svg":r=a.createElementNS("http://www.w3.org/2000/svg",i);break;case"math":r=a.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;case"script":r=a.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof s.is=="string"?a.createElement("select",{is:s.is}):a.createElement("select"),s.multiple?r.multiple=!0:s.size&&(r.size=s.size);break;default:r=typeof s.is=="string"?a.createElement(i,{is:s.is}):a.createElement(i)}}r[St]=e,r[Qt]=s;e:for(a=e.child;a!==null;){if(a.tag===5||a.tag===6)r.appendChild(a.stateNode);else if(a.tag!==4&&a.tag!==27&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===e)break e;for(;a.sibling===null;){if(a.return===null||a.return===e)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}e.stateNode=r;e:switch(It(r,i,s),i){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&os(e)}}return Ue(e),Xf(e,e.type,t===null?null:t.memoizedProps,e.pendingProps,n),null;case 6:if(t&&e.stateNode!=null)t.memoizedProps!==s&&os(e);else{if(typeof s!="string"&&e.stateNode===null)throw Error(U(166));if(t=li.current,jr(e)){if(t=e.stateNode,n=e.memoizedProps,s=null,i=Tt,i!==null)switch(i.tag){case 27:case 5:s=i.memoizedProps}t[St]=e,t=!!(t.nodeValue===n||s!==null&&s.suppressHydrationWarning===!0||AE(t.nodeValue,n)),t||ki(e,!0)}else t=Gu(t).createTextNode(s),t[St]=e,e.stateNode=t}return Ue(e),null;case 31:if(n=e.memoizedState,t===null||t.memoizedState!==null){if(s=jr(e),n!==null){if(t===null){if(!s)throw Error(U(318));if(t=e.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(U(557));t[St]=e}else cr(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ue(e),t=!1}else n=Gf(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=n),t=!0;if(!t)return e.flags&256?(en(e),e):(en(e),null);if(e.flags&128)throw Error(U(558))}return Ue(e),null;case 13:if(s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(i=jr(e),s!==null&&s.dehydrated!==null){if(t===null){if(!i)throw Error(U(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(U(317));i[St]=e}else cr(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ue(e),i=!1}else i=Gf(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=i),i=!0;if(!i)return e.flags&256?(en(e),e):(en(e),null)}return en(e),e.flags&128?(e.lanes=n,e):(n=s!==null,t=t!==null&&t.memoizedState!==null,n&&(s=e.child,i=null,s.alternate!==null&&s.alternate.memoizedState!==null&&s.alternate.memoizedState.cachePool!==null&&(i=s.alternate.memoizedState.cachePool.pool),r=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(r=s.memoizedState.cachePool.pool),r!==i&&(s.flags|=2048)),n!==t&&n&&(e.child.flags|=8192),jc(e,e.updateQueue),Ue(e),null);case 4:return xa(),t===null&&Ng(e.stateNode.containerInfo),Ue(e),null;case 10:return _s(e.type),Ue(e),null;case 19:if(_t(it),s=e.memoizedState,s===null)return Ue(e),null;if(i=(e.flags&128)!==0,r=s.rendering,r===null)if(i)mo(s,!1);else{if(et!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(r=Ru(t),r!==null){for(e.flags|=128,mo(s,!1),t=r.updateQueue,e.updateQueue=t,jc(e,t),e.subtreeFlags=0,t=n,n=e.child;n!==null;)F1(n,t),n=n.sibling;return Be(it,it.current&1|2),xe&&ds(e,s.treeForkCount),e.child}t=t.sibling}s.tail!==null&&rn()>Du&&(e.flags|=128,i=!0,mo(s,!1),e.lanes=4194304)}else{if(!i)if(t=Ru(r),t!==null){if(e.flags|=128,i=!0,t=t.updateQueue,e.updateQueue=t,jc(e,t),mo(s,!0),s.tail===null&&s.tailMode==="hidden"&&!r.alternate&&!xe)return Ue(e),null}else 2*rn()-s.renderingStartTime>Du&&n!==536870912&&(e.flags|=128,i=!0,mo(s,!1),e.lanes=4194304);s.isBackwards?(r.sibling=e.child,e.child=r):(t=s.last,t!==null?t.sibling=r:e.child=r,s.last=r)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=rn(),t.sibling=null,n=it.current,Be(it,i?n&1|2:n&1),xe&&ds(e,s.treeForkCount),t):(Ue(e),null);case 22:case 23:return en(e),ng(),s=e.memoizedState!==null,t!==null?t.memoizedState!==null!==s&&(e.flags|=8192):s&&(e.flags|=8192),s?n&536870912&&!(e.flags&128)&&(Ue(e),e.subtreeFlags&6&&(e.flags|=8192)):Ue(e),n=e.updateQueue,n!==null&&jc(e,n.retryQueue),n=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(n=t.memoizedState.cachePool.pool),s=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(s=e.memoizedState.cachePool.pool),s!==n&&(e.flags|=2048),t!==null&&_t(sr),null;case 24:return n=null,t!==null&&(n=t.memoizedState.cache),e.memoizedState.cache!==n&&(e.flags|=2048),_s(lt),Ue(e),null;case 25:return null;case 30:return null}throw Error(U(156,e.tag))}function hI(t,e){switch(Qp(e),e.tag){case 1:return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return _s(lt),xa(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 26:case 27:case 5:return yu(e),null;case 31:if(e.memoizedState!==null){if(en(e),e.alternate===null)throw Error(U(340));cr()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 13:if(en(e),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(U(340));cr()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return _t(it),null;case 4:return xa(),null;case 10:return _s(e.type),null;case 22:case 23:return en(e),ng(),t!==null&&_t(sr),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 24:return _s(lt),null;case 25:return null;default:return null}}function Fw(t,e){switch(Qp(e),e.tag){case 3:_s(lt),xa();break;case 26:case 27:case 5:yu(e);break;case 4:xa();break;case 31:e.memoizedState!==null&&en(e);break;case 13:en(e);break;case 19:_t(it);break;case 10:_s(e.type);break;case 22:case 23:en(e),ng(),t!==null&&_t(sr);break;case 24:_s(lt)}}function ql(t,e){try{var n=e.updateQueue,s=n!==null?n.lastEffect:null;if(s!==null){var i=s.next;n=i;do{if((n.tag&t)===t){s=void 0;var r=n.create,a=n.inst;s=r(),a.destroy=s}n=n.next}while(n!==i)}}catch(o){Ae(e,e.return,o)}}function Si(t,e,n){try{var s=e.updateQueue,i=s!==null?s.lastEffect:null;if(i!==null){var r=i.next;s=r;do{if((s.tag&t)===t){var a=s.inst,o=a.destroy;if(o!==void 0){a.destroy=void 0,i=e;var l=n,u=o;try{u()}catch(d){Ae(i,l,d)}}}s=s.next}while(s!==r)}}catch(d){Ae(e,e.return,d)}}function zw(t){var e=t.updateQueue;if(e!==null){var n=t.stateNode;try{Z1(e,n)}catch(s){Ae(t,t.return,s)}}}function $w(t,e,n){n.props=hr(t.type,t.memoizedProps),n.state=t.memoizedState;try{n.componentWillUnmount()}catch(s){Ae(t,e,s)}}function Vo(t,e){try{var n=t.ref;if(n!==null){switch(t.tag){case 26:case 27:case 5:var s=t.stateNode;break;case 30:s=t.stateNode;break;default:s=t.stateNode}typeof n=="function"?t.refCleanup=n(s):n.current=s}}catch(i){Ae(t,e,i)}}function Wn(t,e){var n=t.ref,s=t.refCleanup;if(n!==null)if(typeof s=="function")try{s()}catch(i){Ae(t,e,i)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(i){Ae(t,e,i)}else n.current=null}function Kw(t){var e=t.type,n=t.memoizedProps,s=t.stateNode;try{e:switch(e){case"button":case"input":case"select":case"textarea":n.autoFocus&&s.focus();break e;case"img":n.src?s.src=n.src:n.srcSet&&(s.srcset=n.srcSet)}}catch(i){Ae(t,t.return,i)}}function Qf(t,e,n){try{var s=t.stateNode;DI(s,t.type,n,e),s[Qt]=e}catch(i){Ae(t,t.return,i)}}function Yw(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&Li(t.type)||t.tag===4}function Jf(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Yw(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&Li(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function bm(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(t,e):(e=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,e.appendChild(t),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=ms));else if(s!==4&&(s===27&&Li(t.type)&&(n=t.stateNode,e=null),t=t.child,t!==null))for(bm(t,e,n),t=t.sibling;t!==null;)bm(t,e,n),t=t.sibling}function Mu(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(s===27&&Li(t.type)&&(n=t.stateNode),t=t.child,t!==null))for(Mu(t,e,n),t=t.sibling;t!==null;)Mu(t,e,n),t=t.sibling}function qw(t){var e=t.stateNode,n=t.memoizedProps;try{for(var s=t.type,i=e.attributes;i.length;)e.removeAttributeNode(i[0]);It(e,s,n),e[St]=t,e[Qt]=n}catch(r){Ae(t,t.return,r)}}var fs=!1,ot=!1,Zf=!1,mb=typeof WeakSet=="function"?WeakSet:Set,gt=null;function mI(t,e){if(t=t.containerInfo,km=$u,t=D1(t),Kp(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var i=s.anchorOffset,r=s.focusNode;s=s.focusOffset;try{n.nodeType,r.nodeType}catch{n=null;break e}var a=0,o=-1,l=-1,u=0,d=0,f=t,h=null;t:for(;;){for(var m;f!==n||i!==0&&f.nodeType!==3||(o=a+i),f!==r||s!==0&&f.nodeType!==3||(l=a+s),f.nodeType===3&&(a+=f.nodeValue.length),(m=f.firstChild)!==null;)h=f,f=m;for(;;){if(f===t)break t;if(h===n&&++u===i&&(o=a),h===r&&++d===s&&(l=a),(m=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=m}n=o===-1||l===-1?null:{start:o,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Sm={focusedElem:t,selectionRange:n},$u=!1,gt=e;gt!==null;)if(e=gt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,gt=t;else for(;gt!==null;){switch(e=gt,r=e.alternate,t=e.flags,e.tag){case 0:if(t&4&&(t=e.updateQueue,t=t!==null?t.events:null,t!==null))for(n=0;n<t.length;n++)i=t[n],i.ref.impl=i.nextImpl;break;case 11:case 15:break;case 1:if(t&1024&&r!==null){t=void 0,n=e,i=r.memoizedProps,r=r.memoizedState,s=n.stateNode;try{var v=hr(n.type,i);t=s.getSnapshotBeforeUpdate(v,r),s.__reactInternalSnapshotBeforeUpdate=t}catch(b){Ae(n,n.return,b)}}break;case 3:if(t&1024){if(t=e.stateNode.containerInfo,n=t.nodeType,n===9)Am(t);else if(n===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":Am(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(t&1024)throw Error(U(163))}if(t=e.sibling,t!==null){t.return=e.return,gt=t;break}gt=e.return}}function Ww(t,e,n){var s=n.flags;switch(n.tag){case 0:case 11:case 15:cs(t,n),s&4&&ql(5,n);break;case 1:if(cs(t,n),s&4)if(t=n.stateNode,e===null)try{t.componentDidMount()}catch(a){Ae(n,n.return,a)}else{var i=hr(n.type,e.memoizedProps);e=e.memoizedState;try{t.componentDidUpdate(i,e,t.__reactInternalSnapshotBeforeUpdate)}catch(a){Ae(n,n.return,a)}}s&64&&zw(n),s&512&&Vo(n,n.return);break;case 3:if(cs(t,n),s&64&&(t=n.updateQueue,t!==null)){if(e=null,n.child!==null)switch(n.child.tag){case 27:case 5:e=n.child.stateNode;break;case 1:e=n.child.stateNode}try{Z1(t,e)}catch(a){Ae(n,n.return,a)}}break;case 27:e===null&&s&4&&qw(n);case 26:case 5:cs(t,n),e===null&&s&4&&Kw(n),s&512&&Vo(n,n.return);break;case 12:cs(t,n);break;case 31:cs(t,n),s&4&&Jw(t,n);break;case 13:cs(t,n),s&4&&Zw(t,n),s&64&&(t=n.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(n=EI.bind(null,n),FI(t,n))));break;case 22:if(s=n.memoizedState!==null||fs,!s){e=e!==null&&e.memoizedState!==null||ot,i=fs;var r=ot;fs=s,(ot=e)&&!r?us(t,n,(n.subtreeFlags&8772)!==0):cs(t,n),fs=i,ot=r}break;case 30:break;default:cs(t,n)}}function Xw(t){var e=t.alternate;e!==null&&(t.alternate=null,Xw(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&Hp(e)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var Ke=null,Kt=!1;function ls(t,e,n){for(n=n.child;n!==null;)Qw(t,e,n),n=n.sibling}function Qw(t,e,n){if(an&&typeof an.onCommitFiberUnmount=="function")try{an.onCommitFiberUnmount(Gl,n)}catch{}switch(n.tag){case 26:ot||Wn(n,e),ls(t,e,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:ot||Wn(n,e);var s=Ke,i=Kt;Li(n.type)&&(Ke=n.stateNode,Kt=!1),ls(t,e,n),Ko(n.stateNode),Ke=s,Kt=i;break;case 5:ot||Wn(n,e);case 6:if(s=Ke,i=Kt,Ke=null,ls(t,e,n),Ke=s,Kt=i,Ke!==null)if(Kt)try{(Ke.nodeType===9?Ke.body:Ke.nodeName==="HTML"?Ke.ownerDocument.body:Ke).removeChild(n.stateNode)}catch(r){Ae(n,e,r)}else try{Ke.removeChild(n.stateNode)}catch(r){Ae(n,e,r)}break;case 18:Ke!==null&&(Kt?(t=Ke,Tb(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,n.stateNode),Ra(t)):Tb(Ke,n.stateNode));break;case 4:s=Ke,i=Kt,Ke=n.stateNode.containerInfo,Kt=!0,ls(t,e,n),Ke=s,Kt=i;break;case 0:case 11:case 14:case 15:Si(2,n,e),ot||Si(4,n,e),ls(t,e,n);break;case 1:ot||(Wn(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"&&$w(n,e,s)),ls(t,e,n);break;case 21:ls(t,e,n);break;case 22:ot=(s=ot)||n.memoizedState!==null,ls(t,e,n),ot=s;break;default:ls(t,e,n)}}function Jw(t,e){if(e.memoizedState===null&&(t=e.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{Ra(t)}catch(n){Ae(e,e.return,n)}}}function Zw(t,e){if(e.memoizedState===null&&(t=e.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{Ra(t)}catch(n){Ae(e,e.return,n)}}function pI(t){switch(t.tag){case 31:case 13:case 19:var e=t.stateNode;return e===null&&(e=t.stateNode=new mb),e;case 22:return t=t.stateNode,e=t._retryCache,e===null&&(e=t._retryCache=new mb),e;default:throw Error(U(435,t.tag))}}function Oc(t,e){var n=pI(t);e.forEach(function(s){if(!n.has(s)){n.add(s);var i=NI.bind(null,t,s);s.then(i,i)}})}function zt(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var i=n[s],r=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 27:if(Li(o.type)){Ke=o.stateNode,Kt=!1;break e}break;case 5:Ke=o.stateNode,Kt=!1;break e;case 3:case 4:Ke=o.stateNode.containerInfo,Kt=!0;break e}o=o.return}if(Ke===null)throw Error(U(160));Qw(r,a,i),Ke=null,Kt=!1,r=i.alternate,r!==null&&(r.return=null),i.return=null}if(e.subtreeFlags&13886)for(e=e.child;e!==null;)eE(e,t),e=e.sibling}var Ln=null;function eE(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:zt(e,t),$t(t),s&4&&(Si(3,t,t.return),ql(3,t),Si(5,t,t.return));break;case 1:zt(e,t),$t(t),s&512&&(ot||n===null||Wn(n,n.return)),s&64&&fs&&(t=t.updateQueue,t!==null&&(s=t.callbacks,s!==null&&(n=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=n===null?s:n.concat(s))));break;case 26:var i=Ln;if(zt(e,t),$t(t),s&512&&(ot||n===null||Wn(n,n.return)),s&4){var r=n!==null?n.memoizedState:null;if(s=t.memoizedState,n===null)if(s===null)if(t.stateNode===null){e:{s=t.type,n=t.memoizedProps,i=i.ownerDocument||i;t:switch(s){case"title":r=i.getElementsByTagName("title")[0],(!r||r[zl]||r[St]||r.namespaceURI==="http://www.w3.org/2000/svg"||r.hasAttribute("itemprop"))&&(r=i.createElement(s),i.head.insertBefore(r,i.querySelector("head > title"))),It(r,s,n),r[St]=t,xt(r),s=r;break e;case"link":var a=Mb("link","href",i).get(s+(n.href||""));if(a){for(var o=0;o<a.length;o++)if(r=a[o],r.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&r.getAttribute("rel")===(n.rel==null?null:n.rel)&&r.getAttribute("title")===(n.title==null?null:n.title)&&r.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){a.splice(o,1);break t}}r=i.createElement(s),It(r,s,n),i.head.appendChild(r);break;case"meta":if(a=Mb("meta","content",i).get(s+(n.content||""))){for(o=0;o<a.length;o++)if(r=a[o],r.getAttribute("content")===(n.content==null?null:""+n.content)&&r.getAttribute("name")===(n.name==null?null:n.name)&&r.getAttribute("property")===(n.property==null?null:n.property)&&r.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&r.getAttribute("charset")===(n.charSet==null?null:n.charSet)){a.splice(o,1);break t}}r=i.createElement(s),It(r,s,n),i.head.appendChild(r);break;default:throw Error(U(468,s))}r[St]=t,xt(r),s=r}t.stateNode=s}else Db(i,t.type,t.stateNode);else t.stateNode=Ob(i,s,t.memoizedProps);else r!==s?(r===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):r.count--,s===null?Db(i,t.type,t.stateNode):Ob(i,s,t.memoizedProps)):s===null&&t.stateNode!==null&&Qf(t,t.memoizedProps,n.memoizedProps)}break;case 27:zt(e,t),$t(t),s&512&&(ot||n===null||Wn(n,n.return)),n!==null&&s&4&&Qf(t,t.memoizedProps,n.memoizedProps);break;case 5:if(zt(e,t),$t(t),s&512&&(ot||n===null||Wn(n,n.return)),t.flags&32){i=t.stateNode;try{_a(i,"")}catch(v){Ae(t,t.return,v)}}s&4&&t.stateNode!=null&&(i=t.memoizedProps,Qf(t,i,n!==null?n.memoizedProps:i)),s&1024&&(Zf=!0);break;case 6:if(zt(e,t),$t(t),s&4){if(t.stateNode===null)throw Error(U(162));s=t.memoizedProps,n=t.stateNode;try{n.nodeValue=s}catch(v){Ae(t,t.return,v)}}break;case 3:if(ou=null,i=Ln,Ln=Vu(e.containerInfo),zt(e,t),Ln=i,$t(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{Ra(e.containerInfo)}catch(v){Ae(t,t.return,v)}Zf&&(Zf=!1,tE(t));break;case 4:s=Ln,Ln=Vu(t.stateNode.containerInfo),zt(e,t),$t(t),Ln=s;break;case 12:zt(e,t),$t(t);break;case 31:zt(e,t),$t(t),s&4&&(s=t.updateQueue,s!==null&&(t.updateQueue=null,Oc(t,s)));break;case 13:zt(e,t),$t(t),t.child.flags&8192&&t.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(Fd=rn()),s&4&&(s=t.updateQueue,s!==null&&(t.updateQueue=null,Oc(t,s)));break;case 22:i=t.memoizedState!==null;var l=n!==null&&n.memoizedState!==null,u=fs,d=ot;if(fs=u||i,ot=d||l,zt(e,t),ot=d,fs=u,$t(t),s&8192)e:for(e=t.stateNode,e._visibility=i?e._visibility&-2:e._visibility|1,i&&(n===null||l||fs||ot||Yi(t)),n=null,e=t;;){if(e.tag===5||e.tag===26){if(n===null){l=n=e;try{if(r=l.stateNode,i)a=r.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none";else{o=l.stateNode;var f=l.memoizedProps.style,h=f!=null&&f.hasOwnProperty("display")?f.display:null;o.style.display=h==null||typeof h=="boolean"?"":(""+h).trim()}}catch(v){Ae(l,l.return,v)}}}else if(e.tag===6){if(n===null){l=e;try{l.stateNode.nodeValue=i?"":l.memoizedProps}catch(v){Ae(l,l.return,v)}}}else if(e.tag===18){if(n===null){l=e;try{var m=l.stateNode;i?Ab(m,!0):Ab(l.stateNode,!1)}catch(v){Ae(l,l.return,v)}}}else if((e.tag!==22&&e.tag!==23||e.memoizedState===null||e===t)&&e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;n===e&&(n=null),e=e.return}n===e&&(n=null),e.sibling.return=e.return,e=e.sibling}s&4&&(s=t.updateQueue,s!==null&&(n=s.retryQueue,n!==null&&(s.retryQueue=null,Oc(t,n))));break;case 19:zt(e,t),$t(t),s&4&&(s=t.updateQueue,s!==null&&(t.updateQueue=null,Oc(t,s)));break;case 30:break;case 21:break;default:zt(e,t),$t(t)}}function $t(t){var e=t.flags;if(e&2){try{for(var n,s=t.return;s!==null;){if(Yw(s)){n=s;break}s=s.return}if(n==null)throw Error(U(160));switch(n.tag){case 27:var i=n.stateNode,r=Jf(t);Mu(t,r,i);break;case 5:var a=n.stateNode;n.flags&32&&(_a(a,""),n.flags&=-33);var o=Jf(t);Mu(t,o,a);break;case 3:case 4:var l=n.stateNode.containerInfo,u=Jf(t);bm(t,u,l);break;default:throw Error(U(161))}}catch(d){Ae(t,t.return,d)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function tE(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var e=t;tE(e),e.tag===5&&e.flags&1024&&e.stateNode.reset(),t=t.sibling}}function cs(t,e){if(e.subtreeFlags&8772)for(e=e.child;e!==null;)Ww(t,e.alternate,e),e=e.sibling}function Yi(t){for(t=t.child;t!==null;){var e=t;switch(e.tag){case 0:case 11:case 14:case 15:Si(4,e,e.return),Yi(e);break;case 1:Wn(e,e.return);var n=e.stateNode;typeof n.componentWillUnmount=="function"&&$w(e,e.return,n),Yi(e);break;case 27:Ko(e.stateNode);case 26:case 5:Wn(e,e.return),Yi(e);break;case 22:e.memoizedState===null&&Yi(e);break;case 30:Yi(e);break;default:Yi(e)}t=t.sibling}}function us(t,e,n){for(n=n&&(e.subtreeFlags&8772)!==0,e=e.child;e!==null;){var s=e.alternate,i=t,r=e,a=r.flags;switch(r.tag){case 0:case 11:case 15:us(i,r,n),ql(4,r);break;case 1:if(us(i,r,n),s=r,i=s.stateNode,typeof i.componentDidMount=="function")try{i.componentDidMount()}catch(u){Ae(s,s.return,u)}if(s=r,i=s.updateQueue,i!==null){var o=s.stateNode;try{var l=i.shared.hiddenCallbacks;if(l!==null)for(i.shared.hiddenCallbacks=null,i=0;i<l.length;i++)J1(l[i],o)}catch(u){Ae(s,s.return,u)}}n&&a&64&&zw(r),Vo(r,r.return);break;case 27:qw(r);case 26:case 5:us(i,r,n),n&&s===null&&a&4&&Kw(r),Vo(r,r.return);break;case 12:us(i,r,n);break;case 31:us(i,r,n),n&&a&4&&Jw(i,r);break;case 13:us(i,r,n),n&&a&4&&Zw(i,r);break;case 22:r.memoizedState===null&&us(i,r,n),Vo(r,r.return);break;case 30:break;default:us(i,r,n)}e=e.sibling}}function bg(t,e){var n=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(n=t.memoizedState.cachePool.pool),t=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(t=e.memoizedState.cachePool.pool),t!==n&&(t!=null&&t.refCount++,n!=null&&Kl(n))}function xg(t,e){t=null,e.alternate!==null&&(t=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==t&&(e.refCount++,t!=null&&Kl(t))}function On(t,e,n,s){if(e.subtreeFlags&10256)for(e=e.child;e!==null;)nE(t,e,n,s),e=e.sibling}function nE(t,e,n,s){var i=e.flags;switch(e.tag){case 0:case 11:case 15:On(t,e,n,s),i&2048&&ql(9,e);break;case 1:On(t,e,n,s);break;case 3:On(t,e,n,s),i&2048&&(t=null,e.alternate!==null&&(t=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==t&&(e.refCount++,t!=null&&Kl(t)));break;case 12:if(i&2048){On(t,e,n,s),t=e.stateNode;try{var r=e.memoizedProps,a=r.id,o=r.onPostCommit;typeof o=="function"&&o(a,e.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(l){Ae(e,e.return,l)}}else On(t,e,n,s);break;case 31:On(t,e,n,s);break;case 13:On(t,e,n,s);break;case 23:break;case 22:r=e.stateNode,a=e.alternate,e.memoizedState!==null?r._visibility&2?On(t,e,n,s):Fo(t,e):r._visibility&2?On(t,e,n,s):(r._visibility|=2,Br(t,e,n,s,(e.subtreeFlags&10256)!==0||!1)),i&2048&&bg(a,e);break;case 24:On(t,e,n,s),i&2048&&xg(e.alternate,e);break;default:On(t,e,n,s)}}function Br(t,e,n,s,i){for(i=i&&((e.subtreeFlags&10256)!==0||!1),e=e.child;e!==null;){var r=t,a=e,o=n,l=s,u=a.flags;switch(a.tag){case 0:case 11:case 15:Br(r,a,o,l,i),ql(8,a);break;case 23:break;case 22:var d=a.stateNode;a.memoizedState!==null?d._visibility&2?Br(r,a,o,l,i):Fo(r,a):(d._visibility|=2,Br(r,a,o,l,i)),i&&u&2048&&bg(a.alternate,a);break;case 24:Br(r,a,o,l,i),i&&u&2048&&xg(a.alternate,a);break;default:Br(r,a,o,l,i)}e=e.sibling}}function Fo(t,e){if(e.subtreeFlags&10256)for(e=e.child;e!==null;){var n=t,s=e,i=s.flags;switch(s.tag){case 22:Fo(n,s),i&2048&&bg(s.alternate,s);break;case 24:Fo(n,s),i&2048&&xg(s.alternate,s);break;default:Fo(n,s)}e=e.sibling}}var So=8192;function Or(t,e,n){if(t.subtreeFlags&So)for(t=t.child;t!==null;)sE(t,e,n),t=t.sibling}function sE(t,e,n){switch(t.tag){case 26:Or(t,e,n),t.flags&So&&t.memoizedState!==null&&tC(n,Ln,t.memoizedState,t.memoizedProps);break;case 5:Or(t,e,n);break;case 3:case 4:var s=Ln;Ln=Vu(t.stateNode.containerInfo),Or(t,e,n),Ln=s;break;case 22:t.memoizedState===null&&(s=t.alternate,s!==null&&s.memoizedState!==null?(s=So,So=16777216,Or(t,e,n),So=s):Or(t,e,n));break;default:Or(t,e,n)}}function iE(t){var e=t.alternate;if(e!==null&&(t=e.child,t!==null)){e.child=null;do e=t.sibling,t.sibling=null,t=e;while(t!==null)}}function po(t){var e=t.deletions;if(t.flags&16){if(e!==null)for(var n=0;n<e.length;n++){var s=e[n];gt=s,aE(s,t)}iE(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)rE(t),t=t.sibling}function rE(t){switch(t.tag){case 0:case 11:case 15:po(t),t.flags&2048&&Si(9,t,t.return);break;case 3:po(t);break;case 12:po(t);break;case 22:var e=t.stateNode;t.memoizedState!==null&&e._visibility&2&&(t.return===null||t.return.tag!==13)?(e._visibility&=-3,ru(t)):po(t);break;default:po(t)}}function ru(t){var e=t.deletions;if(t.flags&16){if(e!==null)for(var n=0;n<e.length;n++){var s=e[n];gt=s,aE(s,t)}iE(t)}for(t=t.child;t!==null;){switch(e=t,e.tag){case 0:case 11:case 15:Si(8,e,e.return),ru(e);break;case 22:n=e.stateNode,n._visibility&2&&(n._visibility&=-3,ru(e));break;default:ru(e)}t=t.sibling}}function aE(t,e){for(;gt!==null;){var n=gt;switch(n.tag){case 0:case 11:case 15:Si(8,n,e);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var s=n.memoizedState.cachePool.pool;s!=null&&s.refCount++}break;case 24:Kl(n.memoizedState.cache)}if(s=n.child,s!==null)s.return=n,gt=s;else e:for(n=t;gt!==null;){s=gt;var i=s.sibling,r=s.return;if(Xw(s),s===n){gt=null;break e}if(i!==null){i.return=r,gt=i;break e}gt=r}}}var gI={getCacheForType:function(t){var e=Rt(lt),n=e.data.get(t);return n===void 0&&(n=t(),e.data.set(t,n)),n},cacheSignal:function(){return Rt(lt).controller.signal}},vI=typeof WeakMap=="function"?WeakMap:Map,Ne=0,Le=null,ge=null,ve=0,Te=0,Zt=null,ni=!1,Ya=!1,yg=!1,Cs=0,et=0,Ti=0,rr=0,_g=0,sn=0,ka=0,zo=null,Yt=null,xm=!1,Fd=0,oE=0,Du=1/0,Lu=null,fi=null,ft=0,hi=null,Sa=null,ws=0,ym=0,_m=null,lE=null,$o=0,wm=null;function ln(){return Ne&2&&ve!==0?ve&-ve:ie.T!==null?Eg():v1()}function cE(){if(sn===0)if(!(ve&536870912)||xe){var t=kc;kc<<=1,!(kc&3932160)&&(kc=262144),sn=t}else sn=536870912;return t=dn.current,t!==null&&(t.flags|=32),sn}function Xt(t,e,n){(t===Le&&(Te===2||Te===9)||t.cancelPendingCommit!==null)&&(Ta(t,0),si(t,ve,sn,!1)),Fl(t,n),(!(Ne&2)||t!==Le)&&(t===Le&&(!(Ne&2)&&(rr|=n),et===4&&si(t,ve,sn,!1)),ss(t))}function uE(t,e,n){if(Ne&6)throw Error(U(327));var s=!n&&(e&127)===0&&(e&t.expiredLanes)===0||Vl(t,e),i=s?yI(t,e):eh(t,e,!0),r=s;do{if(i===0){Ya&&!s&&si(t,e,0,!1);break}else{if(n=t.current.alternate,r&&!bI(n)){i=eh(t,e,!1),r=!1;continue}if(i===2){if(r=e,t.errorRecoveryDisabledLanes&r)var a=0;else a=t.pendingLanes&-536870913,a=a!==0?a:a&536870912?536870912:0;if(a!==0){e=a;e:{var o=t;i=zo;var l=o.current.memoizedState.isDehydrated;if(l&&(Ta(o,a).flags|=256),a=eh(o,a,!1),a!==2){if(yg&&!l){o.errorRecoveryDisabledLanes|=r,rr|=r,i=4;break e}r=Yt,Yt=i,r!==null&&(Yt===null?Yt=r:Yt.push.apply(Yt,r))}i=a}if(r=!1,i!==2)continue}}if(i===1){Ta(t,0),si(t,e,0,!0);break}e:{switch(s=t,r=i,r){case 0:case 1:throw Error(U(345));case 4:if((e&4194048)!==e)break;case 6:si(s,e,sn,!ni);break e;case 2:Yt=null;break;case 3:case 5:break;default:throw Error(U(329))}if((e&62914560)===e&&(i=Fd+300-rn(),10<i)){if(si(s,e,sn,!ni),jd(s,0,!0)!==0)break e;ws=e,s.timeoutHandle=IE(pb.bind(null,s,n,Yt,Lu,xm,e,sn,rr,ka,ni,r,"Throttled",-0,0),i);break e}pb(s,n,Yt,Lu,xm,e,sn,rr,ka,ni,r,null,-0,0)}}break}while(!0);ss(t)}function pb(t,e,n,s,i,r,a,o,l,u,d,f,h,m){if(t.timeoutHandle=-1,f=e.subtreeFlags,f&8192||(f&16785408)===16785408){f={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ms},sE(e,r,f);var v=(r&62914560)===r?Fd-rn():(r&4194048)===r?oE-rn():0;if(v=nC(f,v),v!==null){ws=r,t.cancelPendingCommit=v(vb.bind(null,t,e,r,n,s,i,a,o,l,d,f,null,h,m)),si(t,r,a,!u);return}}vb(t,e,r,n,s,i,a,o,l)}function bI(t){for(var e=t;;){var n=e.tag;if((n===0||n===11||n===15)&&e.flags&16384&&(n=e.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var s=0;s<n.length;s++){var i=n[s],r=i.getSnapshot;i=i.value;try{if(!un(r(),i))return!1}catch{return!1}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function si(t,e,n,s){e&=~_g,e&=~rr,t.suspendedLanes|=e,t.pingedLanes&=~e,s&&(t.warmLanes|=e),s=t.expirationTimes;for(var i=e;0<i;){var r=31-on(i),a=1<<r;s[r]=-1,i&=~a}n!==0&&m1(t,n,e)}function zd(){return Ne&6?!0:(Wl(0),!1)}function wg(){if(ge!==null){if(Te===0)var t=ge.return;else t=ge,ps=Sr=null,og(t),ca=null,ul=0,t=ge;for(;t!==null;)Fw(t.alternate,t),t=t.return;ge=null}}function Ta(t,e){var n=t.timeoutHandle;n!==-1&&(t.timeoutHandle=-1,BI(n)),n=t.cancelPendingCommit,n!==null&&(t.cancelPendingCommit=null,n()),ws=0,wg(),Le=t,ge=n=ys(t.current,null),ve=e,Te=0,Zt=null,ni=!1,Ya=Vl(t,e),yg=!1,ka=sn=_g=rr=Ti=et=0,Yt=zo=null,xm=!1,e&8&&(e|=e&32);var s=t.entangledLanes;if(s!==0)for(t=t.entanglements,s&=e;0<s;){var i=31-on(s),r=1<<i;e|=t[i],s&=~r}return Cs=e,Ld(),n}function dE(t,e){ce=null,ie.H=fl,e===Ka||e===Bd?(e=Yv(),Te=3):e===eg?(e=Yv(),Te=4):Te=e===gg?8:e!==null&&typeof e=="object"&&typeof e.then=="function"?6:1,Zt=e,ge===null&&(et=1,ju(t,En(e,t.current)))}function fE(){var t=dn.current;return t===null?!0:(ve&4194048)===ve?Sn===null:(ve&62914560)===ve||ve&536870912?t===Sn:!1}function hE(){var t=ie.H;return ie.H=fl,t===null?fl:t}function mE(){var t=ie.A;return ie.A=gI,t}function Pu(){et=4,ni||(ve&4194048)!==ve&&dn.current!==null||(Ya=!0),!(Ti&134217727)&&!(rr&134217727)||Le===null||si(Le,ve,sn,!1)}function eh(t,e,n){var s=Ne;Ne|=2;var i=hE(),r=mE();(Le!==t||ve!==e)&&(Lu=null,Ta(t,e)),e=!1;var a=et;e:do try{if(Te!==0&&ge!==null){var o=ge,l=Zt;switch(Te){case 8:wg(),a=6;break e;case 3:case 2:case 9:case 6:dn.current===null&&(e=!0);var u=Te;if(Te=0,Zt=null,Qr(t,o,l,u),n&&Ya){a=0;break e}break;default:u=Te,Te=0,Zt=null,Qr(t,o,l,u)}}xI(),a=et;break}catch(d){dE(t,d)}while(!0);return e&&t.shellSuspendCounter++,ps=Sr=null,Ne=s,ie.H=i,ie.A=r,ge===null&&(Le=null,ve=0,Ld()),a}function xI(){for(;ge!==null;)pE(ge)}function yI(t,e){var n=Ne;Ne|=2;var s=hE(),i=mE();Le!==t||ve!==e?(Lu=null,Du=rn()+500,Ta(t,e)):Ya=Vl(t,e);e:do try{if(Te!==0&&ge!==null){e=ge;var r=Zt;t:switch(Te){case 1:Te=0,Zt=null,Qr(t,e,r,1);break;case 2:case 9:if(Kv(r)){Te=0,Zt=null,gb(e);break}e=function(){Te!==2&&Te!==9||Le!==t||(Te=7),ss(t)},r.then(e,e);break e;case 3:Te=7;break e;case 4:Te=5;break e;case 7:Kv(r)?(Te=0,Zt=null,gb(e)):(Te=0,Zt=null,Qr(t,e,r,7));break;case 5:var a=null;switch(ge.tag){case 26:a=ge.memoizedState;case 5:case 27:var o=ge;if(a?DE(a):o.stateNode.complete){Te=0,Zt=null;var l=o.sibling;if(l!==null)ge=l;else{var u=o.return;u!==null?(ge=u,$d(u)):ge=null}break t}}Te=0,Zt=null,Qr(t,e,r,5);break;case 6:Te=0,Zt=null,Qr(t,e,r,6);break;case 8:wg(),et=6;break e;default:throw Error(U(462))}}_I();break}catch(d){dE(t,d)}while(!0);return ps=Sr=null,ie.H=s,ie.A=i,Ne=n,ge!==null?0:(Le=null,ve=0,Ld(),et)}function _I(){for(;ge!==null&&!zA();)pE(ge)}function pE(t){var e=Vw(t.alternate,t,Cs);t.memoizedProps=t.pendingProps,e===null?$d(t):ge=e}function gb(t){var e=t,n=e.alternate;switch(e.tag){case 15:case 0:e=cb(n,e,e.pendingProps,e.type,void 0,ve);break;case 11:e=cb(n,e,e.pendingProps,e.type.render,e.ref,ve);break;case 5:og(e);default:Fw(n,e),e=ge=F1(e,Cs),e=Vw(n,e,Cs)}t.memoizedProps=t.pendingProps,e===null?$d(t):ge=e}function Qr(t,e,n,s){ps=Sr=null,og(e),ca=null,ul=0;var i=e.return;try{if(cI(t,i,e,n,ve)){et=1,ju(t,En(n,t.current)),ge=null;return}}catch(r){if(i!==null)throw ge=i,r;et=1,ju(t,En(n,t.current)),ge=null;return}e.flags&32768?(xe||s===1?t=!0:Ya||ve&536870912?t=!1:(ni=t=!0,(s===2||s===9||s===3||s===6)&&(s=dn.current,s!==null&&s.tag===13&&(s.flags|=16384))),gE(e,t)):$d(e)}function $d(t){var e=t;do{if(e.flags&32768){gE(e,ni);return}t=e.return;var n=fI(e.alternate,e,Cs);if(n!==null){ge=n;return}if(e=e.sibling,e!==null){ge=e;return}ge=e=t}while(e!==null);et===0&&(et=5)}function gE(t,e){do{var n=hI(t.alternate,t);if(n!==null){n.flags&=32767,ge=n;return}if(n=t.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!e&&(t=t.sibling,t!==null)){ge=t;return}ge=t=n}while(t!==null);et=6,ge=null}function vb(t,e,n,s,i,r,a,o,l){t.cancelPendingCommit=null;do Kd();while(ft!==0);if(Ne&6)throw Error(U(327));if(e!==null){if(e===t.current)throw Error(U(177));if(r=e.lanes|e.childLanes,r|=Yp,eR(t,n,r,a,o,l),t===Le&&(ge=Le=null,ve=0),Sa=e,hi=t,ws=n,ym=r,_m=i,lE=s,e.subtreeFlags&10256||e.flags&10256?(t.callbackNode=null,t.callbackPriority=0,kI(_u,function(){return _E(),null})):(t.callbackNode=null,t.callbackPriority=0),s=(e.flags&13878)!==0,e.subtreeFlags&13878||s){s=ie.T,ie.T=null,i=ke.p,ke.p=2,a=Ne,Ne|=4;try{mI(t,e,n)}finally{Ne=a,ke.p=i,ie.T=s}}ft=1,vE(),bE(),xE()}}function vE(){if(ft===1){ft=0;var t=hi,e=Sa,n=(e.flags&13878)!==0;if(e.subtreeFlags&13878||n){n=ie.T,ie.T=null;var s=ke.p;ke.p=2;var i=Ne;Ne|=4;try{eE(e,t);var r=Sm,a=D1(t.containerInfo),o=r.focusedElem,l=r.selectionRange;if(a!==o&&o&&o.ownerDocument&&M1(o.ownerDocument.documentElement,o)){if(l!==null&&Kp(o)){var u=l.start,d=l.end;if(d===void 0&&(d=u),"selectionStart"in o)o.selectionStart=u,o.selectionEnd=Math.min(d,o.value.length);else{var f=o.ownerDocument||document,h=f&&f.defaultView||window;if(h.getSelection){var m=h.getSelection(),v=o.textContent.length,b=Math.min(l.start,v),y=l.end===void 0?b:Math.min(l.end,v);!m.extend&&b>y&&(a=y,y=b,b=a);var p=Uv(o,b),g=Uv(o,y);if(p&&g&&(m.rangeCount!==1||m.anchorNode!==p.node||m.anchorOffset!==p.offset||m.focusNode!==g.node||m.focusOffset!==g.offset)){var x=f.createRange();x.setStart(p.node,p.offset),m.removeAllRanges(),b>y?(m.addRange(x),m.extend(g.node,g.offset)):(x.setEnd(g.node,g.offset),m.addRange(x))}}}}for(f=[],m=o;m=m.parentNode;)m.nodeType===1&&f.push({element:m,left:m.scrollLeft,top:m.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<f.length;o++){var w=f[o];w.element.scrollLeft=w.left,w.element.scrollTop=w.top}}$u=!!km,Sm=km=null}finally{Ne=i,ke.p=s,ie.T=n}}t.current=e,ft=2}}function bE(){if(ft===2){ft=0;var t=hi,e=Sa,n=(e.flags&8772)!==0;if(e.subtreeFlags&8772||n){n=ie.T,ie.T=null;var s=ke.p;ke.p=2;var i=Ne;Ne|=4;try{Ww(t,e.alternate,e)}finally{Ne=i,ke.p=s,ie.T=n}}ft=3}}function xE(){if(ft===4||ft===3){ft=0,$A();var t=hi,e=Sa,n=ws,s=lE;e.subtreeFlags&10256||e.flags&10256?ft=5:(ft=0,Sa=hi=null,yE(t,t.pendingLanes));var i=t.pendingLanes;if(i===0&&(fi=null),Up(n),e=e.stateNode,an&&typeof an.onCommitFiberRoot=="function")try{an.onCommitFiberRoot(Gl,e,void 0,(e.current.flags&128)===128)}catch{}if(s!==null){e=ie.T,i=ke.p,ke.p=2,ie.T=null;try{for(var r=t.onRecoverableError,a=0;a<s.length;a++){var o=s[a];r(o.value,{componentStack:o.stack})}}finally{ie.T=e,ke.p=i}}ws&3&&Kd(),ss(t),i=t.pendingLanes,n&261930&&i&42?t===wm?$o++:($o=0,wm=t):$o=0,Wl(0)}}function yE(t,e){(t.pooledCacheLanes&=e)===0&&(e=t.pooledCache,e!=null&&(t.pooledCache=null,Kl(e)))}function Kd(){return vE(),bE(),xE(),_E()}function _E(){if(ft!==5)return!1;var t=hi,e=ym;ym=0;var n=Up(ws),s=ie.T,i=ke.p;try{ke.p=32>n?32:n,ie.T=null,n=_m,_m=null;var r=hi,a=ws;if(ft=0,Sa=hi=null,ws=0,Ne&6)throw Error(U(331));var o=Ne;if(Ne|=4,rE(r.current),nE(r,r.current,a,n),Ne=o,Wl(0,!1),an&&typeof an.onPostCommitFiberRoot=="function")try{an.onPostCommitFiberRoot(Gl,r)}catch{}return!0}finally{ke.p=i,ie.T=s,yE(t,e)}}function bb(t,e,n){e=En(n,e),e=pm(t.stateNode,e,2),t=di(t,e,2),t!==null&&(Fl(t,2),ss(t))}function Ae(t,e,n){if(t.tag===3)bb(t,t,n);else for(;e!==null;){if(e.tag===3){bb(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(fi===null||!fi.has(s))){t=En(n,t),n=Lw(2),s=di(e,n,2),s!==null&&(Pw(n,s,e,t),Fl(s,2),ss(s));break}}e=e.return}}function th(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new vI;var i=new Set;s.set(e,i)}else i=s.get(e),i===void 0&&(i=new Set,s.set(e,i));i.has(n)||(yg=!0,i.add(n),t=wI.bind(null,t,e,n),e.then(t,t))}function wI(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),t.pingedLanes|=t.suspendedLanes&n,t.warmLanes&=~n,Le===t&&(ve&n)===n&&(et===4||et===3&&(ve&62914560)===ve&&300>rn()-Fd?!(Ne&2)&&Ta(t,0):_g|=n,ka===ve&&(ka=0)),ss(t)}function wE(t,e){e===0&&(e=h1()),t=kr(t,e),t!==null&&(Fl(t,e),ss(t))}function EI(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),wE(t,n)}function NI(t,e){var n=0;switch(t.tag){case 31:case 13:var s=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:s=t.stateNode;break;case 22:s=t.stateNode._retryCache;break;default:throw Error(U(314))}s!==null&&s.delete(e),wE(t,n)}function kI(t,e){return Pp(t,e)}var Bu=null,Ur=null,Em=!1,Uu=!1,nh=!1,ii=0;function ss(t){t!==Ur&&t.next===null&&(Ur===null?Bu=Ur=t:Ur=Ur.next=t),Uu=!0,Em||(Em=!0,TI())}function Wl(t,e){if(!nh&&Uu){nh=!0;do for(var n=!1,s=Bu;s!==null;){if(t!==0){var i=s.pendingLanes;if(i===0)var r=0;else{var a=s.suspendedLanes,o=s.pingedLanes;r=(1<<31-on(42|t)+1)-1,r&=i&~(a&~o),r=r&201326741?r&201326741|1:r?r|2:0}r!==0&&(n=!0,xb(s,r))}else r=ve,r=jd(s,s===Le?r:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),!(r&3)||Vl(s,r)||(n=!0,xb(s,r));s=s.next}while(n);nh=!1}}function SI(){EE()}function EE(){Uu=Em=!1;var t=0;ii!==0&&PI()&&(t=ii);for(var e=rn(),n=null,s=Bu;s!==null;){var i=s.next,r=NE(s,e);r===0?(s.next=null,n===null?Bu=i:n.next=i,i===null&&(Ur=n)):(n=s,(t!==0||r&3)&&(Uu=!0)),s=i}ft!==0&&ft!==5||Wl(t),ii!==0&&(ii=0)}function NE(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,i=t.expirationTimes,r=t.pendingLanes&-62914561;0<r;){var a=31-on(r),o=1<<a,l=i[a];l===-1?(!(o&n)||o&s)&&(i[a]=ZA(o,e)):l<=e&&(t.expiredLanes|=o),r&=~o}if(e=Le,n=ve,n=jd(t,t===e?n:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),s=t.callbackNode,n===0||t===e&&(Te===2||Te===9)||t.cancelPendingCommit!==null)return s!==null&&s!==null&&If(s),t.callbackNode=null,t.callbackPriority=0;if(!(n&3)||Vl(t,n)){if(e=n&-n,e===t.callbackPriority)return e;switch(s!==null&&If(s),Up(n)){case 2:case 8:n=d1;break;case 32:n=_u;break;case 268435456:n=f1;break;default:n=_u}return s=kE.bind(null,t),n=Pp(n,s),t.callbackPriority=e,t.callbackNode=n,e}return s!==null&&s!==null&&If(s),t.callbackPriority=2,t.callbackNode=null,2}function kE(t,e){if(ft!==0&&ft!==5)return t.callbackNode=null,t.callbackPriority=0,null;var n=t.callbackNode;if(Kd()&&t.callbackNode!==n)return null;var s=ve;return s=jd(t,t===Le?s:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),s===0?null:(uE(t,s,e),NE(t,rn()),t.callbackNode!=null&&t.callbackNode===n?kE.bind(null,t):null)}function xb(t,e){if(Kd())return null;uE(t,e,!0)}function TI(){UI(function(){Ne&6?Pp(u1,SI):EE()})}function Eg(){if(ii===0){var t=wa;t===0&&(t=Nc,Nc<<=1,!(Nc&261888)&&(Nc=256)),ii=t}return ii}function yb(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:Xc(""+t)}function _b(t,e){var n=e.ownerDocument.createElement("input");return n.name=e.name,n.value=e.value,t.id&&n.setAttribute("form",t.id),e.parentNode.insertBefore(n,e),t=new FormData(t),n.parentNode.removeChild(n),t}function AI(t,e,n,s,i){if(e==="submit"&&n&&n.stateNode===i){var r=yb((i[Qt]||null).action),a=s.submitter;a&&(e=(e=a[Qt]||null)?yb(e.formAction):a.getAttribute("formAction"),e!==null&&(r=e,a=null));var o=new Od("action","action",null,s,i);t.push({event:o,listeners:[{instance:null,listener:function(){if(s.defaultPrevented){if(ii!==0){var l=a?_b(i,a):new FormData(i);hm(n,{pending:!0,data:l,method:i.method,action:r},null,l)}}else typeof r=="function"&&(o.preventDefault(),l=a?_b(i,a):new FormData(i),hm(n,{pending:!0,data:l,method:i.method,action:r},r,l))},currentTarget:i}]})}}for(var sh=0;sh<tm.length;sh++){var ih=tm[sh],RI=ih.toLowerCase(),II=ih[0].toUpperCase()+ih.slice(1);Fn(RI,"on"+II)}Fn(P1,"onAnimationEnd");Fn(B1,"onAnimationIteration");Fn(U1,"onAnimationStart");Fn("dblclick","onDoubleClick");Fn("focusin","onFocus");Fn("focusout","onBlur");Fn(KR,"onTransitionRun");Fn(YR,"onTransitionStart");Fn(qR,"onTransitionCancel");Fn(H1,"onTransitionEnd");ya("onMouseEnter",["mouseout","mouseover"]);ya("onMouseLeave",["mouseout","mouseover"]);ya("onPointerEnter",["pointerout","pointerover"]);ya("onPointerLeave",["pointerout","pointerover"]);wr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));wr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));wr("onBeforeInput",["compositionend","keypress","textInput","paste"]);wr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));wr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));wr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),CI=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(hl));function SE(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],i=s.event;s=s.listeners;e:{var r=void 0;if(e)for(var a=s.length-1;0<=a;a--){var o=s[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==r&&i.isPropagationStopped())break e;r=o,i.currentTarget=u;try{r(i)}catch(d){Eu(d)}i.currentTarget=null,r=l}else for(a=0;a<s.length;a++){if(o=s[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==r&&i.isPropagationStopped())break e;r=o,i.currentTarget=u;try{r(i)}catch(d){Eu(d)}i.currentTarget=null,r=l}}}}function pe(t,e){var n=e[Yh];n===void 0&&(n=e[Yh]=new Set);var s=t+"__bubble";n.has(s)||(TE(e,t,2,!1),n.add(s))}function rh(t,e,n){var s=0;e&&(s|=4),TE(n,t,s,e)}var Mc="_reactListening"+Math.random().toString(36).slice(2);function Ng(t){if(!t[Mc]){t[Mc]=!0,b1.forEach(function(n){n!=="selectionchange"&&(CI.has(n)||rh(n,!1,t),rh(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Mc]||(e[Mc]=!0,rh("selectionchange",!1,e))}}function TE(t,e,n,s){switch(HE(e)){case 2:var i=rC;break;case 8:i=aC;break;default:i=Ag}n=i.bind(null,e,n,t),i=void 0,!Jh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),s?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function ah(t,e,n,s,i){var r=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var a=s.tag;if(a===3||a===4){var o=s.stateNode.containerInfo;if(o===i)break;if(a===4)for(a=s.return;a!==null;){var l=a.tag;if((l===3||l===4)&&a.stateNode.containerInfo===i)return;a=a.return}for(;o!==null;){if(a=Vr(o),a===null)return;if(l=a.tag,l===5||l===6||l===26||l===27){s=r=a;continue e}o=o.parentNode}}s=s.return}S1(function(){var u=r,d=Vp(n),f=[];e:{var h=G1.get(t);if(h!==void 0){var m=Od,v=t;switch(t){case"keypress":if(Jc(n)===0)break e;case"keydown":case"keyup":m=NR;break;case"focusin":v="focus",m=Df;break;case"focusout":v="blur",m=Df;break;case"beforeblur":case"afterblur":m=Df;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Rv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=fR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=TR;break;case P1:case B1:case U1:m=pR;break;case H1:m=RR;break;case"scroll":case"scrollend":m=uR;break;case"wheel":m=CR;break;case"copy":case"cut":case"paste":m=vR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Cv;break;case"toggle":case"beforetoggle":m=OR}var b=(e&4)!==0,y=!b&&(t==="scroll"||t==="scrollend"),p=b?h!==null?h+"Capture":null:h;b=[];for(var g=u,x;g!==null;){var w=g;if(x=w.stateNode,w=w.tag,w!==5&&w!==26&&w!==27||x===null||p===null||(w=rl(g,p),w!=null&&b.push(ml(g,w,x))),y)break;g=g.return}0<b.length&&(h=new m(h,v,null,n,d),f.push({event:h,listeners:b}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",h&&n!==Qh&&(v=n.relatedTarget||n.fromElement)&&(Vr(v)||v[Fa]))break e;if((m||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,m?(v=n.relatedTarget||n.toElement,m=u,v=v?Vr(v):null,v!==null&&(y=Hl(v),b=v.tag,v!==y||b!==5&&b!==27&&b!==6)&&(v=null)):(m=null,v=u),m!==v)){if(b=Rv,w="onMouseLeave",p="onMouseEnter",g="mouse",(t==="pointerout"||t==="pointerover")&&(b=Cv,w="onPointerLeave",p="onPointerEnter",g="pointer"),y=m==null?h:No(m),x=v==null?h:No(v),h=new b(w,g+"leave",m,n,d),h.target=y,h.relatedTarget=x,w=null,Vr(d)===u&&(b=new b(p,g+"enter",v,n,d),b.target=x,b.relatedTarget=y,w=b),y=w,m&&v)t:{for(b=jI,p=m,g=v,x=0,w=p;w;w=b(w))x++;w=0;for(var N=g;N;N=b(N))w++;for(;0<x-w;)p=b(p),x--;for(;0<w-x;)g=b(g),w--;for(;x--;){if(p===g||g!==null&&p===g.alternate){b=p;break t}p=b(p),g=b(g)}b=null}else b=null;m!==null&&wb(f,h,m,b,!1),v!==null&&y!==null&&wb(f,y,v,b,!0)}}e:{if(h=u?No(u):window,m=h.nodeName&&h.nodeName.toLowerCase(),m==="select"||m==="input"&&h.type==="file")var T=Dv;else if(Mv(h))if(j1)T=FR;else{T=GR;var E=HR}else m=h.nodeName,!m||m.toLowerCase()!=="input"||h.type!=="checkbox"&&h.type!=="radio"?u&&Gp(u.elementType)&&(T=Dv):T=VR;if(T&&(T=T(t,u))){C1(f,T,n,d);break e}E&&E(t,h,u),t==="focusout"&&u&&h.type==="number"&&u.memoizedProps.value!=null&&Xh(h,"number",h.value)}switch(E=u?No(u):window,t){case"focusin":(Mv(E)||E.contentEditable==="true")&&($r=E,Zh=u,Lo=null);break;case"focusout":Lo=Zh=$r=null;break;case"mousedown":em=!0;break;case"contextmenu":case"mouseup":case"dragend":em=!1,Hv(f,n,d);break;case"selectionchange":if($R)break;case"keydown":case"keyup":Hv(f,n,d)}var A;if($p)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else zr?R1(t,n)&&(k="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&(A1&&n.locale!=="ko"&&(zr||k!=="onCompositionStart"?k==="onCompositionEnd"&&zr&&(A=T1()):(ti=d,Fp="value"in ti?ti.value:ti.textContent,zr=!0)),E=Hu(u,k),0<E.length&&(k=new Iv(k,t,null,n,d),f.push({event:k,listeners:E}),A?k.data=A:(A=I1(n),A!==null&&(k.data=A)))),(A=DR?LR(t,n):PR(t,n))&&(k=Hu(u,"onBeforeInput"),0<k.length&&(E=new Iv("onBeforeInput","beforeinput",null,n,d),f.push({event:E,listeners:k}),E.data=A)),AI(f,t,u,n,d)}SE(f,e)})}function ml(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Hu(t,e){for(var n=e+"Capture",s=[];t!==null;){var i=t,r=i.stateNode;if(i=i.tag,i!==5&&i!==26&&i!==27||r===null||(i=rl(t,n),i!=null&&s.unshift(ml(t,i,r)),i=rl(t,e),i!=null&&s.push(ml(t,i,r))),t.tag===3)return s;t=t.return}return[]}function jI(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function wb(t,e,n,s,i){for(var r=e._reactName,a=[];n!==null&&n!==s;){var o=n,l=o.alternate,u=o.stateNode;if(o=o.tag,l!==null&&l===s)break;o!==5&&o!==26&&o!==27||u===null||(l=u,i?(u=rl(n,r),u!=null&&a.unshift(ml(n,u,l))):i||(u=rl(n,r),u!=null&&a.push(ml(n,u,l)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var OI=/\r\n?/g,MI=/\u0000|\uFFFD/g;function Eb(t){return(typeof t=="string"?t:""+t).replace(OI,`
`).replace(MI,"")}function AE(t,e){return e=Eb(e),Eb(t)===e}function Ce(t,e,n,s,i,r){switch(n){case"children":typeof s=="string"?e==="body"||e==="textarea"&&s===""||_a(t,s):(typeof s=="number"||typeof s=="bigint")&&e!=="body"&&_a(t,""+s);break;case"className":Tc(t,"class",s);break;case"tabIndex":Tc(t,"tabindex",s);break;case"dir":case"role":case"viewBox":case"width":case"height":Tc(t,n,s);break;case"style":k1(t,s,r);break;case"data":if(e!=="object"){Tc(t,"data",s);break}case"src":case"href":if(s===""&&(e!=="a"||n!=="href")){t.removeAttribute(n);break}if(s==null||typeof s=="function"||typeof s=="symbol"||typeof s=="boolean"){t.removeAttribute(n);break}s=Xc(""+s),t.setAttribute(n,s);break;case"action":case"formAction":if(typeof s=="function"){t.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof r=="function"&&(n==="formAction"?(e!=="input"&&Ce(t,e,"name",i.name,i,null),Ce(t,e,"formEncType",i.formEncType,i,null),Ce(t,e,"formMethod",i.formMethod,i,null),Ce(t,e,"formTarget",i.formTarget,i,null)):(Ce(t,e,"encType",i.encType,i,null),Ce(t,e,"method",i.method,i,null),Ce(t,e,"target",i.target,i,null)));if(s==null||typeof s=="symbol"||typeof s=="boolean"){t.removeAttribute(n);break}s=Xc(""+s),t.setAttribute(n,s);break;case"onClick":s!=null&&(t.onclick=ms);break;case"onScroll":s!=null&&pe("scroll",t);break;case"onScrollEnd":s!=null&&pe("scrollend",t);break;case"dangerouslySetInnerHTML":if(s!=null){if(typeof s!="object"||!("__html"in s))throw Error(U(61));if(n=s.__html,n!=null){if(i.children!=null)throw Error(U(60));t.innerHTML=n}}break;case"multiple":t.multiple=s&&typeof s!="function"&&typeof s!="symbol";break;case"muted":t.muted=s&&typeof s!="function"&&typeof s!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(s==null||typeof s=="function"||typeof s=="boolean"||typeof s=="symbol"){t.removeAttribute("xlink:href");break}n=Xc(""+s),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":s!=null&&typeof s!="function"&&typeof s!="symbol"?t.setAttribute(n,""+s):t.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":s&&typeof s!="function"&&typeof s!="symbol"?t.setAttribute(n,""):t.removeAttribute(n);break;case"capture":case"download":s===!0?t.setAttribute(n,""):s!==!1&&s!=null&&typeof s!="function"&&typeof s!="symbol"?t.setAttribute(n,s):t.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":s!=null&&typeof s!="function"&&typeof s!="symbol"&&!isNaN(s)&&1<=s?t.setAttribute(n,s):t.removeAttribute(n);break;case"rowSpan":case"start":s==null||typeof s=="function"||typeof s=="symbol"||isNaN(s)?t.removeAttribute(n):t.setAttribute(n,s);break;case"popover":pe("beforetoggle",t),pe("toggle",t),Wc(t,"popover",s);break;case"xlinkActuate":as(t,"http://www.w3.org/1999/xlink","xlink:actuate",s);break;case"xlinkArcrole":as(t,"http://www.w3.org/1999/xlink","xlink:arcrole",s);break;case"xlinkRole":as(t,"http://www.w3.org/1999/xlink","xlink:role",s);break;case"xlinkShow":as(t,"http://www.w3.org/1999/xlink","xlink:show",s);break;case"xlinkTitle":as(t,"http://www.w3.org/1999/xlink","xlink:title",s);break;case"xlinkType":as(t,"http://www.w3.org/1999/xlink","xlink:type",s);break;case"xmlBase":as(t,"http://www.w3.org/XML/1998/namespace","xml:base",s);break;case"xmlLang":as(t,"http://www.w3.org/XML/1998/namespace","xml:lang",s);break;case"xmlSpace":as(t,"http://www.w3.org/XML/1998/namespace","xml:space",s);break;case"is":Wc(t,"is",s);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=lR.get(n)||n,Wc(t,n,s))}}function Nm(t,e,n,s,i,r){switch(n){case"style":k1(t,s,r);break;case"dangerouslySetInnerHTML":if(s!=null){if(typeof s!="object"||!("__html"in s))throw Error(U(61));if(n=s.__html,n!=null){if(i.children!=null)throw Error(U(60));t.innerHTML=n}}break;case"children":typeof s=="string"?_a(t,s):(typeof s=="number"||typeof s=="bigint")&&_a(t,""+s);break;case"onScroll":s!=null&&pe("scroll",t);break;case"onScrollEnd":s!=null&&pe("scrollend",t);break;case"onClick":s!=null&&(t.onclick=ms);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!x1.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(i=n.endsWith("Capture"),e=n.slice(2,i?n.length-7:void 0),r=t[Qt]||null,r=r!=null?r[n]:null,typeof r=="function"&&t.removeEventListener(e,r,i),typeof s=="function")){typeof r!="function"&&r!==null&&(n in t?t[n]=null:t.hasAttribute(n)&&t.removeAttribute(n)),t.addEventListener(e,s,i);break e}n in t?t[n]=s:s===!0?t.setAttribute(n,""):Wc(t,n,s)}}}function It(t,e,n){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":pe("error",t),pe("load",t);var s=!1,i=!1,r;for(r in n)if(n.hasOwnProperty(r)){var a=n[r];if(a!=null)switch(r){case"src":s=!0;break;case"srcSet":i=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(U(137,e));default:Ce(t,e,r,a,n,null)}}i&&Ce(t,e,"srcSet",n.srcSet,n,null),s&&Ce(t,e,"src",n.src,n,null);return;case"input":pe("invalid",t);var o=r=a=i=null,l=null,u=null;for(s in n)if(n.hasOwnProperty(s)){var d=n[s];if(d!=null)switch(s){case"name":i=d;break;case"type":a=d;break;case"checked":l=d;break;case"defaultChecked":u=d;break;case"value":r=d;break;case"defaultValue":o=d;break;case"children":case"dangerouslySetInnerHTML":if(d!=null)throw Error(U(137,e));break;default:Ce(t,e,s,d,n,null)}}w1(t,r,o,l,u,a,i,!1);return;case"select":pe("invalid",t),s=a=r=null;for(i in n)if(n.hasOwnProperty(i)&&(o=n[i],o!=null))switch(i){case"value":r=o;break;case"defaultValue":a=o;break;case"multiple":s=o;default:Ce(t,e,i,o,n,null)}e=r,n=a,t.multiple=!!s,e!=null?aa(t,!!s,e,!1):n!=null&&aa(t,!!s,n,!0);return;case"textarea":pe("invalid",t),r=i=s=null;for(a in n)if(n.hasOwnProperty(a)&&(o=n[a],o!=null))switch(a){case"value":s=o;break;case"defaultValue":i=o;break;case"children":r=o;break;case"dangerouslySetInnerHTML":if(o!=null)throw Error(U(91));break;default:Ce(t,e,a,o,n,null)}N1(t,s,i,r);return;case"option":for(l in n)if(n.hasOwnProperty(l)&&(s=n[l],s!=null))switch(l){case"selected":t.selected=s&&typeof s!="function"&&typeof s!="symbol";break;default:Ce(t,e,l,s,n,null)}return;case"dialog":pe("beforetoggle",t),pe("toggle",t),pe("cancel",t),pe("close",t);break;case"iframe":case"object":pe("load",t);break;case"video":case"audio":for(s=0;s<hl.length;s++)pe(hl[s],t);break;case"image":pe("error",t),pe("load",t);break;case"details":pe("toggle",t);break;case"embed":case"source":case"link":pe("error",t),pe("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&(s=n[u],s!=null))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(U(137,e));default:Ce(t,e,u,s,n,null)}return;default:if(Gp(e)){for(d in n)n.hasOwnProperty(d)&&(s=n[d],s!==void 0&&Nm(t,e,d,s,n,void 0));return}}for(o in n)n.hasOwnProperty(o)&&(s=n[o],s!=null&&Ce(t,e,o,s,n,null))}function DI(t,e,n,s){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,r=null,a=null,o=null,l=null,u=null,d=null;for(m in n){var f=n[m];if(n.hasOwnProperty(m)&&f!=null)switch(m){case"checked":break;case"value":break;case"defaultValue":l=f;default:s.hasOwnProperty(m)||Ce(t,e,m,null,s,f)}}for(var h in s){var m=s[h];if(f=n[h],s.hasOwnProperty(h)&&(m!=null||f!=null))switch(h){case"type":r=m;break;case"name":i=m;break;case"checked":u=m;break;case"defaultChecked":d=m;break;case"value":a=m;break;case"defaultValue":o=m;break;case"children":case"dangerouslySetInnerHTML":if(m!=null)throw Error(U(137,e));break;default:m!==f&&Ce(t,e,h,m,s,f)}}Wh(t,a,o,l,u,d,r,i);return;case"select":m=a=o=h=null;for(r in n)if(l=n[r],n.hasOwnProperty(r)&&l!=null)switch(r){case"value":break;case"multiple":m=l;default:s.hasOwnProperty(r)||Ce(t,e,r,null,s,l)}for(i in s)if(r=s[i],l=n[i],s.hasOwnProperty(i)&&(r!=null||l!=null))switch(i){case"value":h=r;break;case"defaultValue":o=r;break;case"multiple":a=r;default:r!==l&&Ce(t,e,i,r,s,l)}e=o,n=a,s=m,h!=null?aa(t,!!n,h,!1):!!s!=!!n&&(e!=null?aa(t,!!n,e,!0):aa(t,!!n,n?[]:"",!1));return;case"textarea":m=h=null;for(o in n)if(i=n[o],n.hasOwnProperty(o)&&i!=null&&!s.hasOwnProperty(o))switch(o){case"value":break;case"children":break;default:Ce(t,e,o,null,s,i)}for(a in s)if(i=s[a],r=n[a],s.hasOwnProperty(a)&&(i!=null||r!=null))switch(a){case"value":h=i;break;case"defaultValue":m=i;break;case"children":break;case"dangerouslySetInnerHTML":if(i!=null)throw Error(U(91));break;default:i!==r&&Ce(t,e,a,i,s,r)}E1(t,h,m);return;case"option":for(var v in n)if(h=n[v],n.hasOwnProperty(v)&&h!=null&&!s.hasOwnProperty(v))switch(v){case"selected":t.selected=!1;break;default:Ce(t,e,v,null,s,h)}for(l in s)if(h=s[l],m=n[l],s.hasOwnProperty(l)&&h!==m&&(h!=null||m!=null))switch(l){case"selected":t.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:Ce(t,e,l,h,s,m)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var b in n)h=n[b],n.hasOwnProperty(b)&&h!=null&&!s.hasOwnProperty(b)&&Ce(t,e,b,null,s,h);for(u in s)if(h=s[u],m=n[u],s.hasOwnProperty(u)&&h!==m&&(h!=null||m!=null))switch(u){case"children":case"dangerouslySetInnerHTML":if(h!=null)throw Error(U(137,e));break;default:Ce(t,e,u,h,s,m)}return;default:if(Gp(e)){for(var y in n)h=n[y],n.hasOwnProperty(y)&&h!==void 0&&!s.hasOwnProperty(y)&&Nm(t,e,y,void 0,s,h);for(d in s)h=s[d],m=n[d],!s.hasOwnProperty(d)||h===m||h===void 0&&m===void 0||Nm(t,e,d,h,s,m);return}}for(var p in n)h=n[p],n.hasOwnProperty(p)&&h!=null&&!s.hasOwnProperty(p)&&Ce(t,e,p,null,s,h);for(f in s)h=s[f],m=n[f],!s.hasOwnProperty(f)||h===m||h==null&&m==null||Ce(t,e,f,h,s,m)}function Nb(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function LI(){if(typeof performance.getEntriesByType=="function"){for(var t=0,e=0,n=performance.getEntriesByType("resource"),s=0;s<n.length;s++){var i=n[s],r=i.transferSize,a=i.initiatorType,o=i.duration;if(r&&o&&Nb(a)){for(a=0,o=i.responseEnd,s+=1;s<n.length;s++){var l=n[s],u=l.startTime;if(u>o)break;var d=l.transferSize,f=l.initiatorType;d&&Nb(f)&&(l=l.responseEnd,a+=d*(l<o?1:(o-u)/(l-u)))}if(--s,e+=8*(r+a)/(i.duration/1e3),t++,10<t)break}}if(0<t)return e/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var km=null,Sm=null;function Gu(t){return t.nodeType===9?t:t.ownerDocument}function kb(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function RE(t,e){if(t===0)switch(e){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&e==="foreignObject"?0:t}function Tm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.children=="bigint"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var oh=null;function PI(){var t=window.event;return t&&t.type==="popstate"?t===oh?!1:(oh=t,!0):(oh=null,!1)}var IE=typeof setTimeout=="function"?setTimeout:void 0,BI=typeof clearTimeout=="function"?clearTimeout:void 0,Sb=typeof Promise=="function"?Promise:void 0,UI=typeof queueMicrotask=="function"?queueMicrotask:typeof Sb<"u"?function(t){return Sb.resolve(null).then(t).catch(HI)}:IE;function HI(t){setTimeout(function(){throw t})}function Li(t){return t==="head"}function Tb(t,e){var n=e,s=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"||n==="/&"){if(s===0){t.removeChild(i),Ra(e);return}s--}else if(n==="$"||n==="$?"||n==="$~"||n==="$!"||n==="&")s++;else if(n==="html")Ko(t.ownerDocument.documentElement);else if(n==="head"){n=t.ownerDocument.head,Ko(n);for(var r=n.firstChild;r;){var a=r.nextSibling,o=r.nodeName;r[zl]||o==="SCRIPT"||o==="STYLE"||o==="LINK"&&r.rel.toLowerCase()==="stylesheet"||n.removeChild(r),r=a}}else n==="body"&&Ko(t.ownerDocument.body);n=i}while(n);Ra(e)}function Ab(t,e){var n=t;t=0;do{var s=n.nextSibling;if(n.nodeType===1?e?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",n.getAttribute("style")===""&&n.removeAttribute("style")):n.nodeType===3&&(e?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(t===0)break;t--}else n!=="$"&&n!=="$?"&&n!=="$~"&&n!=="$!"||t++;n=s}while(n)}function Am(t){var e=t.firstChild;for(e&&e.nodeType===10&&(e=e.nextSibling);e;){var n=e;switch(e=e.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":Am(n),Hp(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}t.removeChild(n)}}function GI(t,e,n,s){for(;t.nodeType===1;){var i=n;if(t.nodeName.toLowerCase()!==e.toLowerCase()){if(!s&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(s){if(!t[zl])switch(e){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(r=t.getAttribute("rel"),r==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(r!==i.rel||t.getAttribute("href")!==(i.href==null||i.href===""?null:i.href)||t.getAttribute("crossorigin")!==(i.crossOrigin==null?null:i.crossOrigin)||t.getAttribute("title")!==(i.title==null?null:i.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(r=t.getAttribute("src"),(r!==(i.src==null?null:i.src)||t.getAttribute("type")!==(i.type==null?null:i.type)||t.getAttribute("crossorigin")!==(i.crossOrigin==null?null:i.crossOrigin))&&r&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(e==="input"&&t.type==="hidden"){var r=i.name==null?null:""+i.name;if(i.type==="hidden"&&t.getAttribute("name")===r)return t}else return t;if(t=Tn(t.nextSibling),t===null)break}return null}function VI(t,e,n){if(e==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!n||(t=Tn(t.nextSibling),t===null))return null;return t}function CE(t,e){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!e||(t=Tn(t.nextSibling),t===null))return null;return t}function Rm(t){return t.data==="$?"||t.data==="$~"}function Im(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function FI(t,e){var n=t.ownerDocument;if(t.data==="$~")t._reactRetry=e;else if(t.data!=="$?"||n.readyState!=="loading")e();else{var s=function(){e(),n.removeEventListener("DOMContentLoaded",s)};n.addEventListener("DOMContentLoaded",s),t._reactRetry=s}}function Tn(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?"||e==="$~"||e==="&"||e==="F!"||e==="F")break;if(e==="/$"||e==="/&")return null}}return t}var Cm=null;function Rb(t){t=t.nextSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"||n==="/&"){if(e===0)return Tn(t.nextSibling);e--}else n!=="$"&&n!=="$!"&&n!=="$?"&&n!=="$~"&&n!=="&"||e++}t=t.nextSibling}return null}function Ib(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"){if(e===0)return t;e--}else n!=="/$"&&n!=="/&"||e++}t=t.previousSibling}return null}function jE(t,e,n){switch(e=Gu(n),t){case"html":if(t=e.documentElement,!t)throw Error(U(452));return t;case"head":if(t=e.head,!t)throw Error(U(453));return t;case"body":if(t=e.body,!t)throw Error(U(454));return t;default:throw Error(U(451))}}function Ko(t){for(var e=t.attributes;e.length;)t.removeAttributeNode(e[0]);Hp(t)}var In=new Map,Cb=new Set;function Vu(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var Ps=ke.d;ke.d={f:zI,r:$I,D:KI,C:YI,L:qI,m:WI,X:QI,S:XI,M:JI};function zI(){var t=Ps.f(),e=zd();return t||e}function $I(t){var e=za(t);e!==null&&e.tag===5&&e.type==="form"?kw(e):Ps.r(t)}var qa=typeof document>"u"?null:document;function OE(t,e,n){var s=qa;if(s&&typeof e=="string"&&e){var i=wn(e);i='link[rel="'+t+'"][href="'+i+'"]',typeof n=="string"&&(i+='[crossorigin="'+n+'"]'),Cb.has(i)||(Cb.add(i),t={rel:t,crossOrigin:n,href:e},s.querySelector(i)===null&&(e=s.createElement("link"),It(e,"link",t),xt(e),s.head.appendChild(e)))}}function KI(t){Ps.D(t),OE("dns-prefetch",t,null)}function YI(t,e){Ps.C(t,e),OE("preconnect",t,e)}function qI(t,e,n){Ps.L(t,e,n);var s=qa;if(s&&t&&e){var i='link[rel="preload"][as="'+wn(e)+'"]';e==="image"&&n&&n.imageSrcSet?(i+='[imagesrcset="'+wn(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(i+='[imagesizes="'+wn(n.imageSizes)+'"]')):i+='[href="'+wn(t)+'"]';var r=i;switch(e){case"style":r=Aa(t);break;case"script":r=Wa(t)}In.has(r)||(t=ze({rel:"preload",href:e==="image"&&n&&n.imageSrcSet?void 0:t,as:e},n),In.set(r,t),s.querySelector(i)!==null||e==="style"&&s.querySelector(Xl(r))||e==="script"&&s.querySelector(Ql(r))||(e=s.createElement("link"),It(e,"link",t),xt(e),s.head.appendChild(e)))}}function WI(t,e){Ps.m(t,e);var n=qa;if(n&&t){var s=e&&typeof e.as=="string"?e.as:"script",i='link[rel="modulepreload"][as="'+wn(s)+'"][href="'+wn(t)+'"]',r=i;switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":r=Wa(t)}if(!In.has(r)&&(t=ze({rel:"modulepreload",href:t},e),In.set(r,t),n.querySelector(i)===null)){switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Ql(r)))return}s=n.createElement("link"),It(s,"link",t),xt(s),n.head.appendChild(s)}}}function XI(t,e,n){Ps.S(t,e,n);var s=qa;if(s&&t){var i=ra(s).hoistableStyles,r=Aa(t);e=e||"default";var a=i.get(r);if(!a){var o={loading:0,preload:null};if(a=s.querySelector(Xl(r)))o.loading=5;else{t=ze({rel:"stylesheet",href:t,"data-precedence":e},n),(n=In.get(r))&&kg(t,n);var l=a=s.createElement("link");xt(l),It(l,"link",t),l._p=new Promise(function(u,d){l.onload=u,l.onerror=d}),l.addEventListener("load",function(){o.loading|=1}),l.addEventListener("error",function(){o.loading|=2}),o.loading|=4,au(a,e,s)}a={type:"stylesheet",instance:a,count:1,state:o},i.set(r,a)}}}function QI(t,e){Ps.X(t,e);var n=qa;if(n&&t){var s=ra(n).hoistableScripts,i=Wa(t),r=s.get(i);r||(r=n.querySelector(Ql(i)),r||(t=ze({src:t,async:!0},e),(e=In.get(i))&&Sg(t,e),r=n.createElement("script"),xt(r),It(r,"link",t),n.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},s.set(i,r))}}function JI(t,e){Ps.M(t,e);var n=qa;if(n&&t){var s=ra(n).hoistableScripts,i=Wa(t),r=s.get(i);r||(r=n.querySelector(Ql(i)),r||(t=ze({src:t,async:!0,type:"module"},e),(e=In.get(i))&&Sg(t,e),r=n.createElement("script"),xt(r),It(r,"link",t),n.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},s.set(i,r))}}function jb(t,e,n,s){var i=(i=li.current)?Vu(i):null;if(!i)throw Error(U(446));switch(t){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(e=Aa(n.href),n=ra(i).hoistableStyles,s=n.get(e),s||(s={type:"style",instance:null,count:0,state:null},n.set(e,s)),s):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){t=Aa(n.href);var r=ra(i).hoistableStyles,a=r.get(t);if(a||(i=i.ownerDocument||i,a={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},r.set(t,a),(r=i.querySelector(Xl(t)))&&!r._p&&(a.instance=r,a.state.loading=5),In.has(t)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},In.set(t,n),r||ZI(i,t,n,a.state))),e&&s===null)throw Error(U(528,""));return a}if(e&&s!==null)throw Error(U(529,""));return null;case"script":return e=n.async,n=n.src,typeof n=="string"&&e&&typeof e!="function"&&typeof e!="symbol"?(e=Wa(n),n=ra(i).hoistableScripts,s=n.get(e),s||(s={type:"script",instance:null,count:0,state:null},n.set(e,s)),s):{type:"void",instance:null,count:0,state:null};default:throw Error(U(444,t))}}function Aa(t){return'href="'+wn(t)+'"'}function Xl(t){return'link[rel="stylesheet"]['+t+"]"}function ME(t){return ze({},t,{"data-precedence":t.precedence,precedence:null})}function ZI(t,e,n,s){t.querySelector('link[rel="preload"][as="style"]['+e+"]")?s.loading=1:(e=t.createElement("link"),s.preload=e,e.addEventListener("load",function(){return s.loading|=1}),e.addEventListener("error",function(){return s.loading|=2}),It(e,"link",n),xt(e),t.head.appendChild(e))}function Wa(t){return'[src="'+wn(t)+'"]'}function Ql(t){return"script[async]"+t}function Ob(t,e,n){if(e.count++,e.instance===null)switch(e.type){case"style":var s=t.querySelector('style[data-href~="'+wn(n.href)+'"]');if(s)return e.instance=s,xt(s),s;var i=ze({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return s=(t.ownerDocument||t).createElement("style"),xt(s),It(s,"style",i),au(s,n.precedence,t),e.instance=s;case"stylesheet":i=Aa(n.href);var r=t.querySelector(Xl(i));if(r)return e.state.loading|=4,e.instance=r,xt(r),r;s=ME(n),(i=In.get(i))&&kg(s,i),r=(t.ownerDocument||t).createElement("link"),xt(r);var a=r;return a._p=new Promise(function(o,l){a.onload=o,a.onerror=l}),It(r,"link",s),e.state.loading|=4,au(r,n.precedence,t),e.instance=r;case"script":return r=Wa(n.src),(i=t.querySelector(Ql(r)))?(e.instance=i,xt(i),i):(s=n,(i=In.get(r))&&(s=ze({},n),Sg(s,i)),t=t.ownerDocument||t,i=t.createElement("script"),xt(i),It(i,"link",s),t.head.appendChild(i),e.instance=i);case"void":return null;default:throw Error(U(443,e.type))}else e.type==="stylesheet"&&!(e.state.loading&4)&&(s=e.instance,e.state.loading|=4,au(s,n.precedence,t));return e.instance}function au(t,e,n){for(var s=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),i=s.length?s[s.length-1]:null,r=i,a=0;a<s.length;a++){var o=s[a];if(o.dataset.precedence===e)r=o;else if(r!==i)break}r?r.parentNode.insertBefore(t,r.nextSibling):(e=n.nodeType===9?n.head:n,e.insertBefore(t,e.firstChild))}function kg(t,e){t.crossOrigin==null&&(t.crossOrigin=e.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=e.referrerPolicy),t.title==null&&(t.title=e.title)}function Sg(t,e){t.crossOrigin==null&&(t.crossOrigin=e.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=e.referrerPolicy),t.integrity==null&&(t.integrity=e.integrity)}var ou=null;function Mb(t,e,n){if(ou===null){var s=new Map,i=ou=new Map;i.set(n,s)}else i=ou,s=i.get(n),s||(s=new Map,i.set(n,s));if(s.has(t))return s;for(s.set(t,null),n=n.getElementsByTagName(t),i=0;i<n.length;i++){var r=n[i];if(!(r[zl]||r[St]||t==="link"&&r.getAttribute("rel")==="stylesheet")&&r.namespaceURI!=="http://www.w3.org/2000/svg"){var a=r.getAttribute(e)||"";a=t+a;var o=s.get(a);o?o.push(r):s.set(a,[r])}}return s}function Db(t,e,n){t=t.ownerDocument||t,t.head.insertBefore(n,e==="title"?t.querySelector("head > title"):null)}function eC(t,e,n){if(n===1||e.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof e.precedence!="string"||typeof e.href!="string"||e.href==="")break;return!0;case"link":if(typeof e.rel!="string"||typeof e.href!="string"||e.href===""||e.onLoad||e.onError)break;switch(e.rel){case"stylesheet":return t=e.disabled,typeof e.precedence=="string"&&t==null;default:return!0}case"script":if(e.async&&typeof e.async!="function"&&typeof e.async!="symbol"&&!e.onLoad&&!e.onError&&e.src&&typeof e.src=="string")return!0}return!1}function DE(t){return!(t.type==="stylesheet"&&!(t.state.loading&3))}function tC(t,e,n,s){if(n.type==="stylesheet"&&(typeof s.media!="string"||matchMedia(s.media).matches!==!1)&&!(n.state.loading&4)){if(n.instance===null){var i=Aa(s.href),r=e.querySelector(Xl(i));if(r){e=r._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(t.count++,t=Fu.bind(t),e.then(t,t)),n.state.loading|=4,n.instance=r,xt(r);return}r=e.ownerDocument||e,s=ME(s),(i=In.get(i))&&kg(s,i),r=r.createElement("link"),xt(r);var a=r;a._p=new Promise(function(o,l){a.onload=o,a.onerror=l}),It(r,"link",s),n.instance=r}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(n,e),(e=n.state.preload)&&!(n.state.loading&3)&&(t.count++,n=Fu.bind(t),e.addEventListener("load",n),e.addEventListener("error",n))}}var lh=0;function nC(t,e){return t.stylesheets&&t.count===0&&lu(t,t.stylesheets),0<t.count||0<t.imgCount?function(n){var s=setTimeout(function(){if(t.stylesheets&&lu(t,t.stylesheets),t.unsuspend){var r=t.unsuspend;t.unsuspend=null,r()}},6e4+e);0<t.imgBytes&&lh===0&&(lh=62500*LI());var i=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&lu(t,t.stylesheets),t.unsuspend)){var r=t.unsuspend;t.unsuspend=null,r()}},(t.imgBytes>lh?50:800)+e);return t.unsuspend=n,function(){t.unsuspend=null,clearTimeout(s),clearTimeout(i)}}:null}function Fu(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)lu(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var zu=null;function lu(t,e){t.stylesheets=null,t.unsuspend!==null&&(t.count++,zu=new Map,e.forEach(sC,t),zu=null,Fu.call(t))}function sC(t,e){if(!(e.state.loading&4)){var n=zu.get(t);if(n)var s=n.get(null);else{n=new Map,zu.set(t,n);for(var i=t.querySelectorAll("link[data-precedence],style[data-precedence]"),r=0;r<i.length;r++){var a=i[r];(a.nodeName==="LINK"||a.getAttribute("media")!=="not all")&&(n.set(a.dataset.precedence,a),s=a)}s&&n.set(null,s)}i=e.instance,a=i.getAttribute("data-precedence"),r=n.get(a)||s,r===s&&n.set(null,i),n.set(a,i),this.count++,s=Fu.bind(this),i.addEventListener("load",s),i.addEventListener("error",s),r?r.parentNode.insertBefore(i,r.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(i,t.firstChild)),e.state.loading|=4}}var pl={$$typeof:hs,Provider:null,Consumer:null,_currentValue:tr,_currentValue2:tr,_threadCount:0};function iC(t,e,n,s,i,r,a,o,l){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Cf(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Cf(0),this.hiddenUpdates=Cf(null),this.identifierPrefix=s,this.onUncaughtError=i,this.onCaughtError=r,this.onRecoverableError=a,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=l,this.incompleteTransitions=new Map}function LE(t,e,n,s,i,r,a,o,l,u,d,f){return t=new iC(t,e,n,a,l,u,d,f,o),e=1,r===!0&&(e|=24),r=tn(3,null,null,e),t.current=r,r.stateNode=t,e=Jp(),e.refCount++,t.pooledCache=e,e.refCount++,r.memoizedState={element:s,isDehydrated:n,cache:e},tg(r),t}function PE(t){return t?(t=qr,t):qr}function BE(t,e,n,s,i,r){i=PE(i),s.context===null?s.context=i:s.pendingContext=i,s=ui(e),s.payload={element:n},r=r===void 0?null:r,r!==null&&(s.callback=r),n=di(t,s,e),n!==null&&(Xt(n,t,e),Bo(n,t,e))}function Lb(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Tg(t,e){Lb(t,e),(t=t.alternate)&&Lb(t,e)}function UE(t){if(t.tag===13||t.tag===31){var e=kr(t,67108864);e!==null&&Xt(e,t,67108864),Tg(t,67108864)}}function Pb(t){if(t.tag===13||t.tag===31){var e=ln();e=Bp(e);var n=kr(t,e);n!==null&&Xt(n,t,e),Tg(t,e)}}var $u=!0;function rC(t,e,n,s){var i=ie.T;ie.T=null;var r=ke.p;try{ke.p=2,Ag(t,e,n,s)}finally{ke.p=r,ie.T=i}}function aC(t,e,n,s){var i=ie.T;ie.T=null;var r=ke.p;try{ke.p=8,Ag(t,e,n,s)}finally{ke.p=r,ie.T=i}}function Ag(t,e,n,s){if($u){var i=jm(s);if(i===null)ah(t,e,s,Ku,n),Bb(t,s);else if(lC(i,t,e,n,s))s.stopPropagation();else if(Bb(t,s),e&4&&-1<oC.indexOf(t)){for(;i!==null;){var r=za(i);if(r!==null)switch(r.tag){case 3:if(r=r.stateNode,r.current.memoizedState.isDehydrated){var a=$i(r.pendingLanes);if(a!==0){var o=r;for(o.pendingLanes|=2,o.entangledLanes|=2;a;){var l=1<<31-on(a);o.entanglements[1]|=l,a&=~l}ss(r),!(Ne&6)&&(Du=rn()+500,Wl(0))}}break;case 31:case 13:o=kr(r,2),o!==null&&Xt(o,r,2),zd(),Tg(r,2)}if(r=jm(s),r===null&&ah(t,e,s,Ku,n),r===i)break;i=r}i!==null&&s.stopPropagation()}else ah(t,e,s,null,n)}}function jm(t){return t=Vp(t),Rg(t)}var Ku=null;function Rg(t){if(Ku=null,t=Vr(t),t!==null){var e=Hl(t);if(e===null)t=null;else{var n=e.tag;if(n===13){if(t=r1(e),t!==null)return t;t=null}else if(n===31){if(t=a1(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null)}}return Ku=t,null}function HE(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(KA()){case u1:return 2;case d1:return 8;case _u:case YA:return 32;case f1:return 268435456;default:return 32}default:return 32}}var Om=!1,mi=null,pi=null,gi=null,gl=new Map,vl=new Map,Ws=[],oC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Bb(t,e){switch(t){case"focusin":case"focusout":mi=null;break;case"dragenter":case"dragleave":pi=null;break;case"mouseover":case"mouseout":gi=null;break;case"pointerover":case"pointerout":gl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":vl.delete(e.pointerId)}}function go(t,e,n,s,i,r){return t===null||t.nativeEvent!==r?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:r,targetContainers:[i]},e!==null&&(e=za(e),e!==null&&UE(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function lC(t,e,n,s,i){switch(e){case"focusin":return mi=go(mi,t,e,n,s,i),!0;case"dragenter":return pi=go(pi,t,e,n,s,i),!0;case"mouseover":return gi=go(gi,t,e,n,s,i),!0;case"pointerover":var r=i.pointerId;return gl.set(r,go(gl.get(r)||null,t,e,n,s,i)),!0;case"gotpointercapture":return r=i.pointerId,vl.set(r,go(vl.get(r)||null,t,e,n,s,i)),!0}return!1}function GE(t){var e=Vr(t.target);if(e!==null){var n=Hl(e);if(n!==null){if(e=n.tag,e===13){if(e=r1(n),e!==null){t.blockedOn=e,wv(t.priority,function(){Pb(n)});return}}else if(e===31){if(e=a1(n),e!==null){t.blockedOn=e,wv(t.priority,function(){Pb(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function cu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=jm(t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);Qh=s,n.target.dispatchEvent(s),Qh=null}else return e=za(n),e!==null&&UE(e),t.blockedOn=n,!1;e.shift()}return!0}function Ub(t,e,n){cu(t)&&n.delete(e)}function cC(){Om=!1,mi!==null&&cu(mi)&&(mi=null),pi!==null&&cu(pi)&&(pi=null),gi!==null&&cu(gi)&&(gi=null),gl.forEach(Ub),vl.forEach(Ub)}function Dc(t,e){t.blockedOn===e&&(t.blockedOn=null,Om||(Om=!0,mt.unstable_scheduleCallback(mt.unstable_NormalPriority,cC)))}var Lc=null;function Hb(t){Lc!==t&&(Lc=t,mt.unstable_scheduleCallback(mt.unstable_NormalPriority,function(){Lc===t&&(Lc=null);for(var e=0;e<t.length;e+=3){var n=t[e],s=t[e+1],i=t[e+2];if(typeof s!="function"){if(Rg(s||n)===null)continue;break}var r=za(n);r!==null&&(t.splice(e,3),e-=3,hm(r,{pending:!0,data:i,method:n.method,action:s},s,i))}}))}function Ra(t){function e(l){return Dc(l,t)}mi!==null&&Dc(mi,t),pi!==null&&Dc(pi,t),gi!==null&&Dc(gi,t),gl.forEach(e),vl.forEach(e);for(var n=0;n<Ws.length;n++){var s=Ws[n];s.blockedOn===t&&(s.blockedOn=null)}for(;0<Ws.length&&(n=Ws[0],n.blockedOn===null);)GE(n),n.blockedOn===null&&Ws.shift();if(n=(t.ownerDocument||t).$$reactFormReplay,n!=null)for(s=0;s<n.length;s+=3){var i=n[s],r=n[s+1],a=i[Qt]||null;if(typeof r=="function")a||Hb(n);else if(a){var o=null;if(r&&r.hasAttribute("formAction")){if(i=r,a=r[Qt]||null)o=a.formAction;else if(Rg(i)!==null)continue}else o=a.action;typeof o=="function"?n[s+1]=o:(n.splice(s,3),s-=3),Hb(n)}}}function VE(){function t(r){r.canIntercept&&r.info==="react-transition"&&r.intercept({handler:function(){return new Promise(function(a){return i=a})},focusReset:"manual",scroll:"manual"})}function e(){i!==null&&(i(),i=null),s||setTimeout(n,20)}function n(){if(!s&&!navigation.transition){var r=navigation.currentEntry;r&&r.url!=null&&navigation.navigate(r.url,{state:r.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var s=!1,i=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",e),navigation.addEventListener("navigateerror",e),setTimeout(n,100),function(){s=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",e),navigation.removeEventListener("navigateerror",e),i!==null&&(i(),i=null)}}}function Ig(t){this._internalRoot=t}Yd.prototype.render=Ig.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(U(409));var n=e.current,s=ln();BE(n,s,t,e,null,null)};Yd.prototype.unmount=Ig.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;BE(t.current,2,null,t,null,null),zd(),e[Fa]=null}};function Yd(t){this._internalRoot=t}Yd.prototype.unstable_scheduleHydration=function(t){if(t){var e=v1();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ws.length&&e!==0&&e<Ws[n].priority;n++);Ws.splice(n,0,t),n===0&&GE(t)}};var Gb=s1.version;if(Gb!=="19.2.3")throw Error(U(527,Gb,"19.2.3"));ke.findDOMNode=function(t){var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(U(188)):(t=Object.keys(t).join(","),Error(U(268,t)));return t=UA(e),t=t!==null?o1(t):null,t=t===null?null:t.stateNode,t};var uC={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:ie,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Pc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pc.isDisabled&&Pc.supportsFiber)try{Gl=Pc.inject(uC),an=Pc}catch{}}Id.createRoot=function(t,e){if(!i1(t))throw Error(U(299));var n=!1,s="",i=Ow,r=Mw,a=Dw;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onUncaughtError!==void 0&&(i=e.onUncaughtError),e.onCaughtError!==void 0&&(r=e.onCaughtError),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=LE(t,1,!1,null,null,n,s,null,i,r,a,VE),t[Fa]=e.current,Ng(t),new Ig(e)};Id.hydrateRoot=function(t,e,n){if(!i1(t))throw Error(U(299));var s=!1,i="",r=Ow,a=Mw,o=Dw,l=null;return n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onUncaughtError!==void 0&&(r=n.onUncaughtError),n.onCaughtError!==void 0&&(a=n.onCaughtError),n.onRecoverableError!==void 0&&(o=n.onRecoverableError),n.formState!==void 0&&(l=n.formState)),e=LE(t,1,!0,e,n??null,s,i,l,r,a,o,VE),e.context=PE(null),n=e.current,s=ln(),s=Bp(s),i=ui(s),i.callback=null,di(n,i,s),n=s,e.current.lanes=n,Fl(e,n),ss(e),t[Fa]=e.current,Ng(t),new Yd(e)};Id.version="19.2.3";function FE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(FE)}catch(t){console.error(t)}}FE(),Q_.exports=Id;var dC=Q_.exports;const fC=G_(dC);/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function bl(){return bl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},bl.apply(this,arguments)}var ri;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(ri||(ri={}));const Vb="popstate";function hC(t){t===void 0&&(t={});function e(s,i){let{pathname:r,search:a,hash:o}=s.location;return Mm("",{pathname:r,search:a,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(s,i){return typeof i=="string"?i:zE(i)}return pC(e,n,null,t)}function ut(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Cg(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function mC(){return Math.random().toString(36).substr(2,8)}function Fb(t,e){return{usr:t.state,key:t.key,idx:e}}function Mm(t,e,n,s){return n===void 0&&(n=null),bl({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Xa(e):e,{state:n,key:e&&e.key||s||mC()})}function zE(t){let{pathname:e="/",search:n="",hash:s=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function Xa(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function pC(t,e,n,s){s===void 0&&(s={});let{window:i=document.defaultView,v5Compat:r=!1}=s,a=i.history,o=ri.Pop,l=null,u=d();u==null&&(u=0,a.replaceState(bl({},a.state,{idx:u}),""));function d(){return(a.state||{idx:null}).idx}function f(){o=ri.Pop;let y=d(),p=y==null?null:y-u;u=y,l&&l({action:o,location:b.location,delta:p})}function h(y,p){o=ri.Push;let g=Mm(b.location,y,p);u=d()+1;let x=Fb(g,u),w=b.createHref(g);try{a.pushState(x,"",w)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;i.location.assign(w)}r&&l&&l({action:o,location:b.location,delta:1})}function m(y,p){o=ri.Replace;let g=Mm(b.location,y,p);u=d();let x=Fb(g,u),w=b.createHref(g);a.replaceState(x,"",w),r&&l&&l({action:o,location:b.location,delta:0})}function v(y){let p=i.location.origin!=="null"?i.location.origin:i.location.href,g=typeof y=="string"?y:zE(y);return g=g.replace(/ $/,"%20"),ut(p,"No window.location.(origin|href) available to create URL for href: "+g),new URL(g,p)}let b={get action(){return o},get location(){return t(i,a)},listen(y){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(Vb,f),l=y,()=>{i.removeEventListener(Vb,f),l=null}},createHref(y){return e(i,y)},createURL:v,encodeLocation(y){let p=v(y);return{pathname:p.pathname,search:p.search,hash:p.hash}},push:h,replace:m,go(y){return a.go(y)}};return b}var zb;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(zb||(zb={}));function gC(t,e,n){return n===void 0&&(n="/"),vC(t,e,n)}function vC(t,e,n,s){let i=typeof e=="string"?Xa(e):e,r=YE(i.pathname||"/",n);if(r==null)return null;let a=$E(t);bC(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let u=IC(r);o=TC(a[l],u)}return o}function $E(t,e,n,s){e===void 0&&(e=[]),n===void 0&&(n=[]),s===void 0&&(s="");let i=(r,a,o)=>{let l={relativePath:o===void 0?r.path||"":o,caseSensitive:r.caseSensitive===!0,childrenIndex:a,route:r};l.relativePath.startsWith("/")&&(ut(l.relativePath.startsWith(s),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(s.length));let u=ar([s,l.relativePath]),d=n.concat(l);r.children&&r.children.length>0&&(ut(r.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),$E(r.children,e,d,u)),!(r.path==null&&!r.index)&&e.push({path:u,score:kC(u,r.index),routesMeta:d})};return t.forEach((r,a)=>{var o;if(r.path===""||!((o=r.path)!=null&&o.includes("?")))i(r,a);else for(let l of KE(r.path))i(r,a,l)}),e}function KE(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,i=n.endsWith("?"),r=n.replace(/\?$/,"");if(s.length===0)return i?[r,""]:[r];let a=KE(s.join("/")),o=[];return o.push(...a.map(l=>l===""?r:[r,l].join("/"))),i&&o.push(...a),o.map(l=>t.startsWith("/")&&l===""?"/":l)}function bC(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:SC(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const xC=/^:[\w-]+$/,yC=3,_C=2,wC=1,EC=10,NC=-2,$b=t=>t==="*";function kC(t,e){let n=t.split("/"),s=n.length;return n.some($b)&&(s+=NC),e&&(s+=_C),n.filter(i=>!$b(i)).reduce((i,r)=>i+(xC.test(r)?yC:r===""?wC:EC),s)}function SC(t,e){return t.length===e.length&&t.slice(0,-1).every((s,i)=>s===e[i])?t[t.length-1]-e[e.length-1]:0}function TC(t,e,n){let{routesMeta:s}=t,i={},r="/",a=[];for(let o=0;o<s.length;++o){let l=s[o],u=o===s.length-1,d=r==="/"?e:e.slice(r.length)||"/",f=AC({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},d),h=l.route;if(!f)return null;Object.assign(i,f.params),a.push({params:i,pathname:ar([r,f.pathname]),pathnameBase:DC(ar([r,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(r=ar([r,f.pathnameBase]))}return a}function AC(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=RC(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let r=i[0],a=r.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:s.reduce((u,d,f)=>{let{paramName:h,isOptional:m}=d;if(h==="*"){let b=o[f]||"";a=r.slice(0,r.length-b.length).replace(/(.)\/+$/,"$1")}const v=o[f];return m&&!v?u[h]=void 0:u[h]=(v||"").replace(/%2F/g,"/"),u},{}),pathname:r,pathnameBase:a,pattern:t}}function RC(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Cg(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(s.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),s]}function IC(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Cg(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function YE(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}const CC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,jC=t=>CC.test(t);function OC(t,e){e===void 0&&(e="/");let{pathname:n,search:s="",hash:i=""}=typeof t=="string"?Xa(t):t,r;if(n)if(jC(n))r=n;else{if(n.includes("//")){let a=n;n=n.replace(/\/\/+/g,"/"),Cg(!1,"Pathnames cannot have embedded double slashes - normalizing "+(a+" -> "+n))}n.startsWith("/")?r=Kb(n.substring(1),"/"):r=Kb(n,e)}else r=e;return{pathname:r,search:LC(s),hash:PC(i)}}function Kb(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function ch(t,e,n,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function MC(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function qE(t,e){let n=MC(t);return e?n.map((s,i)=>i===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function WE(t,e,n,s){s===void 0&&(s=!1);let i;typeof t=="string"?i=Xa(t):(i=bl({},t),ut(!i.pathname||!i.pathname.includes("?"),ch("?","pathname","search",i)),ut(!i.pathname||!i.pathname.includes("#"),ch("#","pathname","hash",i)),ut(!i.search||!i.search.includes("#"),ch("#","search","hash",i)));let r=t===""||i.pathname==="",a=r?"/":i.pathname,o;if(a==null)o=n;else{let f=e.length-1;if(!s&&a.startsWith("..")){let h=a.split("/");for(;h[0]==="..";)h.shift(),f-=1;i.pathname=h.join("/")}o=f>=0?e[f]:"/"}let l=OC(i,o),u=a&&a!=="/"&&a.endsWith("/"),d=(r||a===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||d)&&(l.pathname+="/"),l}const ar=t=>t.join("/").replace(/\/\/+/g,"/"),DC=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),LC=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,PC=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function BC(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const XE=["post","put","patch","delete"];new Set(XE);const UC=["get",...XE];new Set(UC);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function xl(){return xl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},xl.apply(this,arguments)}const jg=_.createContext(null),HC=_.createContext(null),Jl=_.createContext(null),qd=_.createContext(null),Pi=_.createContext({outlet:null,matches:[],isDataRoute:!1}),QE=_.createContext(null);function Zl(){return _.useContext(qd)!=null}function Wd(){return Zl()||ut(!1),_.useContext(qd).location}function JE(t){_.useContext(Jl).static||_.useLayoutEffect(t)}function Qa(){let{isDataRoute:t}=_.useContext(Pi);return t?ZC():GC()}function GC(){Zl()||ut(!1);let t=_.useContext(jg),{basename:e,future:n,navigator:s}=_.useContext(Jl),{matches:i}=_.useContext(Pi),{pathname:r}=Wd(),a=JSON.stringify(qE(i,n.v7_relativeSplatPath)),o=_.useRef(!1);return JE(()=>{o.current=!0}),_.useCallback(function(u,d){if(d===void 0&&(d={}),!o.current)return;if(typeof u=="number"){s.go(u);return}let f=WE(u,JSON.parse(a),r,d.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:ar([e,f.pathname])),(d.replace?s.replace:s.push)(f,d.state,d)},[e,s,a,r,t])}function ZE(){let{matches:t}=_.useContext(Pi),e=t[t.length-1];return e?e.params:{}}function VC(t,e){return FC(t,e)}function FC(t,e,n,s){Zl()||ut(!1);let{navigator:i}=_.useContext(Jl),{matches:r}=_.useContext(Pi),a=r[r.length-1],o=a?a.params:{};a&&a.pathname;let l=a?a.pathnameBase:"/";a&&a.route;let u=Wd(),d;if(e){var f;let y=typeof e=="string"?Xa(e):e;l==="/"||(f=y.pathname)!=null&&f.startsWith(l)||ut(!1),d=y}else d=u;let h=d.pathname||"/",m=h;if(l!=="/"){let y=l.replace(/^\//,"").split("/");m="/"+h.replace(/^\//,"").split("/").slice(y.length).join("/")}let v=gC(t,{pathname:m}),b=qC(v&&v.map(y=>Object.assign({},y,{params:Object.assign({},o,y.params),pathname:ar([l,i.encodeLocation?i.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?l:ar([l,i.encodeLocation?i.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),r,n,s);return e&&b?_.createElement(qd.Provider,{value:{location:xl({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:ri.Pop}},b):b}function zC(){let t=JC(),e=BC(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return _.createElement(_.Fragment,null,_.createElement("h2",null,"Unexpected Application Error!"),_.createElement("h3",{style:{fontStyle:"italic"}},e),n?_.createElement("pre",{style:i},n):null,null)}const $C=_.createElement(zC,null);class KC extends _.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?_.createElement(Pi.Provider,{value:this.props.routeContext},_.createElement(QE.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function YC(t){let{routeContext:e,match:n,children:s}=t,i=_.useContext(jg);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),_.createElement(Pi.Provider,{value:e},s)}function qC(t,e,n,s){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),s===void 0&&(s=null),t==null){var r;if(!n)return null;if(n.errors)t=n.matches;else if((r=s)!=null&&r.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let a=t,o=(i=n)==null?void 0:i.errors;if(o!=null){let d=a.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);d>=0||ut(!1),a=a.slice(0,Math.min(a.length,d+1))}let l=!1,u=-1;if(n&&s&&s.v7_partialHydration)for(let d=0;d<a.length;d++){let f=a[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=d),f.route.id){let{loaderData:h,errors:m}=n,v=f.route.loader&&h[f.route.id]===void 0&&(!m||m[f.route.id]===void 0);if(f.route.lazy||v){l=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((d,f,h)=>{let m,v=!1,b=null,y=null;n&&(m=o&&f.route.id?o[f.route.id]:void 0,b=f.route.errorElement||$C,l&&(u<0&&h===0?(e2("route-fallback"),v=!0,y=null):u===h&&(v=!0,y=f.route.hydrateFallbackElement||null)));let p=e.concat(a.slice(0,h+1)),g=()=>{let x;return m?x=b:v?x=y:f.route.Component?x=_.createElement(f.route.Component,null):f.route.element?x=f.route.element:x=d,_.createElement(YC,{match:f,routeContext:{outlet:d,matches:p,isDataRoute:n!=null},children:x})};return n&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?_.createElement(KC,{location:n.location,revalidation:n.revalidation,component:b,error:m,children:g(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):g()},null)}var eN=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(eN||{}),tN=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(tN||{});function WC(t){let e=_.useContext(jg);return e||ut(!1),e}function XC(t){let e=_.useContext(HC);return e||ut(!1),e}function QC(t){let e=_.useContext(Pi);return e||ut(!1),e}function nN(t){let e=QC(),n=e.matches[e.matches.length-1];return n.route.id||ut(!1),n.route.id}function JC(){var t;let e=_.useContext(QE),n=XC(),s=nN();return e!==void 0?e:(t=n.errors)==null?void 0:t[s]}function ZC(){let{router:t}=WC(eN.UseNavigateStable),e=nN(tN.UseNavigateStable),n=_.useRef(!1);return JE(()=>{n.current=!0}),_.useCallback(function(i,r){r===void 0&&(r={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,xl({fromRouteId:e},r)))},[t,e])}const Yb={};function e2(t,e,n){Yb[t]||(Yb[t]=!0)}function t2(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function n2(t){let{to:e,replace:n,state:s,relative:i}=t;Zl()||ut(!1);let{future:r,static:a}=_.useContext(Jl),{matches:o}=_.useContext(Pi),{pathname:l}=Wd(),u=Qa(),d=WE(e,qE(o,r.v7_relativeSplatPath),l,i==="path"),f=JSON.stringify(d);return _.useEffect(()=>u(JSON.parse(f),{replace:n,state:s,relative:i}),[u,f,i,n,s]),null}function To(t){ut(!1)}function s2(t){let{basename:e="/",children:n=null,location:s,navigationType:i=ri.Pop,navigator:r,static:a=!1,future:o}=t;Zl()&&ut(!1);let l=e.replace(/^\/*/,"/"),u=_.useMemo(()=>({basename:l,navigator:r,static:a,future:xl({v7_relativeSplatPath:!1},o)}),[l,o,r,a]);typeof s=="string"&&(s=Xa(s));let{pathname:d="/",search:f="",hash:h="",state:m=null,key:v="default"}=s,b=_.useMemo(()=>{let y=YE(d,l);return y==null?null:{location:{pathname:y,search:f,hash:h,state:m,key:v},navigationType:i}},[l,d,f,h,m,v,i]);return b==null?null:_.createElement(Jl.Provider,{value:u},_.createElement(qd.Provider,{children:n,value:b}))}function i2(t){let{children:e,location:n}=t;return VC(Dm(e),n)}new Promise(()=>{});function Dm(t,e){e===void 0&&(e=[]);let n=[];return _.Children.forEach(t,(s,i)=>{if(!_.isValidElement(s))return;let r=[...e,i];if(s.type===_.Fragment){n.push.apply(n,Dm(s.props.children,r));return}s.type!==To&&ut(!1),!s.props.index||!s.props.children||ut(!1);let a={id:s.props.id||r.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(a.children=Dm(s.props.children,r)),n.push(a)}),n}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Lm(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let s=t[n];return e.concat(Array.isArray(s)?s.map(i=>[n,i]):[[n,s]])},[]))}function r2(t,e){let n=Lm(t);return e&&e.forEach((s,i)=>{n.has(i)||e.getAll(i).forEach(r=>{n.append(i,r)})}),n}const a2="6";try{window.__reactRouterVersion=a2}catch{}const o2="startTransition",qb=jA[o2];function l2(t){let{basename:e,children:n,future:s,window:i}=t,r=_.useRef();r.current==null&&(r.current=hC({window:i,v5Compat:!0}));let a=r.current,[o,l]=_.useState({action:a.action,location:a.location}),{v7_startTransition:u}=s||{},d=_.useCallback(f=>{u&&qb?qb(()=>l(f)):l(f)},[l,u]);return _.useLayoutEffect(()=>a.listen(d),[a,d]),_.useEffect(()=>t2(s),[s]),_.createElement(s2,{basename:e,children:n,location:o.location,navigationType:o.action,navigator:a,future:s})}var Wb;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Wb||(Wb={}));var Xb;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Xb||(Xb={}));function c2(t){let e=_.useRef(Lm(t)),n=_.useRef(!1),s=Wd(),i=_.useMemo(()=>r2(s.search,n.current?null:e.current),[s.search]),r=Qa(),a=_.useCallback((o,l)=>{const u=Lm(typeof o=="function"?o(i):o);n.current=!0,r("?"+u,l)},[r,i]);return[i,a]}const sN=_.createContext({setFullWidth:()=>{},setHideHeader:()=>{}}),iN=()=>_.useContext(sN),u2=({children:t})=>{const[,e]=_.useState(!1),[,n]=_.useState(!1);return c.jsx(sN.Provider,{value:{setFullWidth:e,setHideHeader:n},children:t})},d2=()=>{};var Qb={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rN={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z=function(t,e){if(!t)throw Ja(e)},Ja=function(t){return new Error("Firebase Database ("+rN.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aN=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let i=t.charCodeAt(s);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},f2=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const i=t[n++];if(i<128)e[s++]=String.fromCharCode(i);else if(i>191&&i<224){const r=t[n++];e[s++]=String.fromCharCode((i&31)<<6|r&63)}else if(i>239&&i<365){const r=t[n++],a=t[n++],o=t[n++],l=((i&7)<<18|(r&63)<<12|(a&63)<<6|o&63)-65536;e[s++]=String.fromCharCode(55296+(l>>10)),e[s++]=String.fromCharCode(56320+(l&1023))}else{const r=t[n++],a=t[n++];e[s++]=String.fromCharCode((i&15)<<12|(r&63)<<6|a&63)}}return e.join("")},Og={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let i=0;i<t.length;i+=3){const r=t[i],a=i+1<t.length,o=a?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,d=r>>2,f=(r&3)<<4|o>>4;let h=(o&15)<<2|u>>6,m=u&63;l||(m=64,a||(h=64)),s.push(n[d],n[f],n[h],n[m])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(aN(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):f2(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let i=0;i<t.length;){const r=n[t.charAt(i++)],o=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const f=i<t.length?n[t.charAt(i)]:64;if(++i,r==null||o==null||u==null||f==null)throw new h2;const h=r<<2|o>>4;if(s.push(h),u!==64){const m=o<<4&240|u>>2;if(s.push(m),f!==64){const v=u<<6&192|f;s.push(v)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class h2 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const oN=function(t){const e=aN(t);return Og.encodeByteArray(e,!0)},Yu=function(t){return oN(t).replace(/\./g,"")},qu=function(t){try{return Og.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m2(t){return lN(void 0,t)}function lN(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!p2(n)||(t[n]=lN(t[n],e[n]));return t}function p2(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g2(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v2=()=>g2().__FIREBASE_DEFAULTS__,b2=()=>{if(typeof process>"u"||typeof Qb>"u")return;const t=Qb.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},x2=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&qu(t[1]);return e&&JSON.parse(e)},Mg=()=>{try{return d2()||v2()||b2()||x2()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},cN=t=>{var e,n;return(n=(e=Mg())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},y2=t=>{const e=cN(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),s]:[e.substring(0,n),s]},uN=()=>{var t;return(t=Mg())===null||t===void 0?void 0:t.config},dN=t=>{var e;return(e=Mg())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Za(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function fN(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _2(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",i=t.iat||0,r=t.sub||t.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Yu(JSON.stringify(n)),Yu(JSON.stringify(a)),""].join(".")}const Yo={};function w2(){const t={prod:[],emulator:[]};for(const e of Object.keys(Yo))Yo[e]?t.emulator.push(e):t.prod.push(e);return t}function E2(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Jb=!1;function hN(t,e){if(typeof window>"u"||typeof document>"u"||!Za(window.location.host)||Yo[t]===e||Yo[t]||Jb)return;Yo[t]=e;function n(h){return`__firebase__banner__${h}`}const s="__firebase__banner",r=w2().prod.length>0;function a(){const h=document.getElementById(s);h&&h.remove()}function o(h){h.style.display="flex",h.style.background="#7faaf0",h.style.position="fixed",h.style.bottom="5px",h.style.left="5px",h.style.padding=".5em",h.style.borderRadius="5px",h.style.alignItems="center"}function l(h,m){h.setAttribute("width","24"),h.setAttribute("id",m),h.setAttribute("height","24"),h.setAttribute("viewBox","0 0 24 24"),h.setAttribute("fill","none"),h.style.marginLeft="-6px"}function u(){const h=document.createElement("span");return h.style.cursor="pointer",h.style.marginLeft="16px",h.style.fontSize="24px",h.innerHTML=" &times;",h.onclick=()=>{Jb=!0,a()},h}function d(h,m){h.setAttribute("id",m),h.innerText="Learn more",h.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",h.setAttribute("target","__blank"),h.style.paddingLeft="5px",h.style.textDecoration="underline"}function f(){const h=E2(s),m=n("text"),v=document.getElementById(m)||document.createElement("span"),b=n("learnmore"),y=document.getElementById(b)||document.createElement("a"),p=n("preprendIcon"),g=document.getElementById(p)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(h.created){const x=h.element;o(x),d(y,b);const w=u();l(g,p),x.append(g,v,y,w),document.body.appendChild(x)}r?(v.innerText="Preview backend disconnected.",g.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(g.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,v.innerText="Preview backend running in this workspace."),v.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Dg(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Gt())}function N2(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function k2(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function mN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function S2(){const t=Gt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function T2(){return rN.NODE_ADMIN===!0}function A2(){try{return typeof indexedDB=="object"}catch{return!1}}function R2(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(s);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var r;e(((r=i.error)===null||r===void 0?void 0:r.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I2="FirebaseError";class Bi extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=I2,Object.setPrototypeOf(this,Bi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ec.prototype.create)}}class ec{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},i=`${this.service}/${e}`,r=this.errors[e],a=r?C2(r,s):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new Bi(i,o,s)}}function C2(t,e){return t.replace(j2,(n,s)=>{const i=e[s];return i!=null?String(i):`<${s}?>`})}const j2=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yl(t){return JSON.parse(t)}function ht(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pN=function(t){let e={},n={},s={},i="";try{const r=t.split(".");e=yl(qu(r[0])||""),n=yl(qu(r[1])||""),i=r[2],s=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:s,signature:i}},O2=function(t){const e=pN(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},M2=function(t){const e=pN(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function mr(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function Wu(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Xu(t,e,n){const s={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(s[i]=e.call(n,t[i],i,t));return s}function pr(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const i of n){if(!s.includes(i))return!1;const r=t[i],a=e[i];if(Zb(r)&&Zb(a)){if(!pr(r,a))return!1}else if(r!==a)return!1}for(const i of s)if(!n.includes(i))return!1;return!0}function Zb(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eo(t){const e=[];for(const[n,s]of Object.entries(t))Array.isArray(s)?s.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function Ao(t){const e={};return t.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[i,r]=s.split("=");e[decodeURIComponent(i)]=decodeURIComponent(r)}}),e}function Ro(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D2{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const s=this.W_;if(typeof e=="string")for(let f=0;f<16;f++)s[f]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let f=0;f<16;f++)s[f]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let f=16;f<80;f++){const h=s[f-3]^s[f-8]^s[f-14]^s[f-16];s[f]=(h<<1|h>>>31)&4294967295}let i=this.chain_[0],r=this.chain_[1],a=this.chain_[2],o=this.chain_[3],l=this.chain_[4],u,d;for(let f=0;f<80;f++){f<40?f<20?(u=o^r&(a^o),d=1518500249):(u=r^a^o,d=1859775393):f<60?(u=r&a|o&(r|a),d=2400959708):(u=r^a^o,d=3395469782);const h=(i<<5|i>>>27)+u+l+d+s[f]&4294967295;l=o,o=a,a=(r<<30|r>>>2)&4294967295,r=i,i=h}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+r&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+o&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const s=n-this.blockSize;let i=0;const r=this.buf_;let a=this.inbuf_;for(;i<n;){if(a===0)for(;i<=s;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<n;)if(r[a]=e.charCodeAt(i),++a,++i,a===this.blockSize){this.compress_(r),a=0;break}}else for(;i<n;)if(r[a]=e[i],++a,++i,a===this.blockSize){this.compress_(r),a=0;break}}this.inbuf_=a,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=n&255,n/=256;this.compress_(this.buf_);let s=0;for(let i=0;i<5;i++)for(let r=24;r>=0;r-=8)e[s]=this.chain_[i]>>r&255,++s;return e}}function L2(t,e){const n=new P2(t,e);return n.subscribe.bind(n)}class P2{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,s){let i;if(e===void 0&&n===void 0&&s===void 0)throw new Error("Missing Observer.");B2(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:s},i.next===void 0&&(i.next=uh),i.error===void 0&&(i.error=uh),i.complete===void 0&&(i.complete=uh);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),r}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function B2(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function uh(){}function Ia(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U2=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let i=t.charCodeAt(s);if(i>=55296&&i<=56319){const r=i-55296;s++,z(s<t.length,"Surrogate pair missing trail surrogate.");const a=t.charCodeAt(s)-56320;i=65536+(r<<10)+a}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},Xd=function(t){let e=0;for(let n=0;n<t.length;n++){const s=t.charCodeAt(n);s<128?e++:s<2048?e+=2:s>=55296&&s<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dt(t){return t&&t._delegate?t._delegate:t}class gr{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H2{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new Pn;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&s.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(V2(e))try{this.getOrInitializeService({instanceIdentifier:qi})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const r=this.getOrInitializeService({instanceIdentifier:i});s.resolve(r)}catch{}}}}clearInstance(e=qi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=qi){return this.instances.has(e)}getOptions(e=qi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[r,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(r);s===o&&a.resolve(i)}return i}onInit(e,n){var s;const i=this.normalizeInstanceIdentifier(n),r=(s=this.onInitCallbacks.get(i))!==null&&s!==void 0?s:new Set;r.add(e),this.onInitCallbacks.set(i,r);const a=this.instances.get(i);return a&&e(a,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(s)for(const i of s)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:G2(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=qi){return this.component?this.component.multipleInstances?e:qi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function G2(t){return t===qi?void 0:t}function V2(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F2{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new H2(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var je;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(je||(je={}));const z2={debug:je.DEBUG,verbose:je.VERBOSE,info:je.INFO,warn:je.WARN,error:je.ERROR,silent:je.SILENT},$2=je.INFO,K2={[je.DEBUG]:"log",[je.VERBOSE]:"log",[je.INFO]:"info",[je.WARN]:"warn",[je.ERROR]:"error"},Y2=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),i=K2[e];if(i)console[i](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Lg{constructor(e){this.name=e,this._logLevel=$2,this._logHandler=Y2,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in je))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?z2[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,je.DEBUG,...e),this._logHandler(this,je.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,je.VERBOSE,...e),this._logHandler(this,je.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,je.INFO,...e),this._logHandler(this,je.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,je.WARN,...e),this._logHandler(this,je.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,je.ERROR,...e),this._logHandler(this,je.ERROR,...e)}}const q2=(t,e)=>e.some(n=>t instanceof n);let ex,tx;function W2(){return ex||(ex=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function X2(){return tx||(tx=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const gN=new WeakMap,Pm=new WeakMap,vN=new WeakMap,dh=new WeakMap,Pg=new WeakMap;function Q2(t){const e=new Promise((n,s)=>{const i=()=>{t.removeEventListener("success",r),t.removeEventListener("error",a)},r=()=>{n(vi(t.result)),i()},a=()=>{s(t.error),i()};t.addEventListener("success",r),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&gN.set(n,t)}).catch(()=>{}),Pg.set(e,t),e}function J2(t){if(Pm.has(t))return;const e=new Promise((n,s)=>{const i=()=>{t.removeEventListener("complete",r),t.removeEventListener("error",a),t.removeEventListener("abort",a)},r=()=>{n(),i()},a=()=>{s(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",r),t.addEventListener("error",a),t.addEventListener("abort",a)});Pm.set(t,e)}let Bm={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Pm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||vN.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return vi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Z2(t){Bm=t(Bm)}function ej(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(fh(this),e,...n);return vN.set(s,e.sort?e.sort():[e]),vi(s)}:X2().includes(t)?function(...e){return t.apply(fh(this),e),vi(gN.get(this))}:function(...e){return vi(t.apply(fh(this),e))}}function tj(t){return typeof t=="function"?ej(t):(t instanceof IDBTransaction&&J2(t),q2(t,W2())?new Proxy(t,Bm):t)}function vi(t){if(t instanceof IDBRequest)return Q2(t);if(dh.has(t))return dh.get(t);const e=tj(t);return e!==t&&(dh.set(t,e),Pg.set(e,t)),e}const fh=t=>Pg.get(t);function nj(t,e,{blocked:n,upgrade:s,blocking:i,terminated:r}={}){const a=indexedDB.open(t,e),o=vi(a);return s&&a.addEventListener("upgradeneeded",l=>{s(vi(a.result),l.oldVersion,l.newVersion,vi(a.transaction),l)}),n&&a.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),o.then(l=>{r&&l.addEventListener("close",()=>r()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),o}const sj=["get","getKey","getAll","getAllKeys","count"],ij=["put","add","delete","clear"],hh=new Map;function nx(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(hh.get(e))return hh.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,i=ij.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(i||sj.includes(n)))return;const r=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let u=l.store;return s&&(u=u.index(o.shift())),(await Promise.all([u[n](...o),i&&l.done]))[0]};return hh.set(e,r),r}Z2(t=>({...t,get:(e,n,s)=>nx(e,n)||t.get(e,n,s),has:(e,n)=>!!nx(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rj{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(aj(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function aj(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Um="@firebase/app",sx="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const js=new Lg("@firebase/app"),oj="@firebase/app-compat",lj="@firebase/analytics-compat",cj="@firebase/analytics",uj="@firebase/app-check-compat",dj="@firebase/app-check",fj="@firebase/auth",hj="@firebase/auth-compat",mj="@firebase/database",pj="@firebase/data-connect",gj="@firebase/database-compat",vj="@firebase/functions",bj="@firebase/functions-compat",xj="@firebase/installations",yj="@firebase/installations-compat",_j="@firebase/messaging",wj="@firebase/messaging-compat",Ej="@firebase/performance",Nj="@firebase/performance-compat",kj="@firebase/remote-config",Sj="@firebase/remote-config-compat",Tj="@firebase/storage",Aj="@firebase/storage-compat",Rj="@firebase/firestore",Ij="@firebase/ai",Cj="@firebase/firestore-compat",jj="firebase",Oj="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hm="[DEFAULT]",Mj={[Um]:"fire-core",[oj]:"fire-core-compat",[cj]:"fire-analytics",[lj]:"fire-analytics-compat",[dj]:"fire-app-check",[uj]:"fire-app-check-compat",[fj]:"fire-auth",[hj]:"fire-auth-compat",[mj]:"fire-rtdb",[pj]:"fire-data-connect",[gj]:"fire-rtdb-compat",[vj]:"fire-fn",[bj]:"fire-fn-compat",[xj]:"fire-iid",[yj]:"fire-iid-compat",[_j]:"fire-fcm",[wj]:"fire-fcm-compat",[Ej]:"fire-perf",[Nj]:"fire-perf-compat",[kj]:"fire-rc",[Sj]:"fire-rc-compat",[Tj]:"fire-gcs",[Aj]:"fire-gcs-compat",[Rj]:"fire-fst",[Cj]:"fire-fst-compat",[Ij]:"fire-vertex","fire-js":"fire-js",[jj]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qu=new Map,Dj=new Map,Gm=new Map;function ix(t,e){try{t.container.addComponent(e)}catch(n){js.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ca(t){const e=t.name;if(Gm.has(e))return js.debug(`There were multiple attempts to register component ${e}.`),!1;Gm.set(e,t);for(const n of Qu.values())ix(n,t);for(const n of Dj.values())ix(n,t);return!0}function Bg(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function nn(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lj={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},bi=new ec("app","Firebase",Lj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pj{constructor(e,n,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new gr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw bi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const to=Oj;function bN(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const s=Object.assign({name:Hm,automaticDataCollectionEnabled:!0},e),i=s.name;if(typeof i!="string"||!i)throw bi.create("bad-app-name",{appName:String(i)});if(n||(n=uN()),!n)throw bi.create("no-options");const r=Qu.get(i);if(r){if(pr(n,r.options)&&pr(s,r.config))return r;throw bi.create("duplicate-app",{appName:i})}const a=new F2(i);for(const l of Gm.values())a.addComponent(l);const o=new Pj(n,s,a);return Qu.set(i,o),o}function xN(t=Hm){const e=Qu.get(t);if(!e&&t===Hm&&uN())return bN();if(!e)throw bi.create("no-app",{appName:t});return e}function xi(t,e,n){var s;let i=(s=Mj[t])!==null&&s!==void 0?s:t;n&&(i+=`-${n}`);const r=i.match(/\s|\//),a=e.match(/\s|\//);if(r||a){const o=[`Unable to register library "${i}" with version "${e}":`];r&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),js.warn(o.join(" "));return}Ca(new gr(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bj="firebase-heartbeat-database",Uj=1,_l="firebase-heartbeat-store";let mh=null;function yN(){return mh||(mh=nj(Bj,Uj,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(_l)}catch(n){console.warn(n)}}}}).catch(t=>{throw bi.create("idb-open",{originalErrorMessage:t.message})})),mh}async function Hj(t){try{const n=(await yN()).transaction(_l),s=await n.objectStore(_l).get(_N(t));return await n.done,s}catch(e){if(e instanceof Bi)js.warn(e.message);else{const n=bi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});js.warn(n.message)}}}async function rx(t,e){try{const s=(await yN()).transaction(_l,"readwrite");await s.objectStore(_l).put(e,_N(t)),await s.done}catch(n){if(n instanceof Bi)js.warn(n.message);else{const s=bi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});js.warn(s.message)}}}function _N(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gj=1024,Vj=30;class Fj{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new $j(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=ax();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(a=>a.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:i}),this._heartbeatsCache.heartbeats.length>Vj){const a=Kj(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){js.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=ax(),{heartbeatsToSend:s,unsentEntries:i}=zj(this._heartbeatsCache.heartbeats),r=Yu(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(n){return js.warn(n),""}}}function ax(){return new Date().toISOString().substring(0,10)}function zj(t,e=Gj){const n=[];let s=t.slice();for(const i of t){const r=n.find(a=>a.agent===i.agent);if(r){if(r.dates.push(i.date),ox(n)>e){r.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),ox(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class $j{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return A2()?R2().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Hj(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return rx(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return rx(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function ox(t){return Yu(JSON.stringify({version:2,heartbeats:t})).length}function Kj(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let s=1;s<t.length;s++)t[s].date<n&&(n=t[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yj(t){Ca(new gr("platform-logger",e=>new rj(e),"PRIVATE")),Ca(new gr("heartbeat",e=>new Fj(e),"PRIVATE")),xi(Um,sx,t),xi(Um,sx,"esm2017"),xi("fire-js","")}Yj("");function Ug(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(t);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(t,s[i])&&(n[s[i]]=t[s[i]]);return n}function wN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const qj=wN,EN=new ec("auth","Firebase",wN());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ju=new Lg("@firebase/auth");function Wj(t,...e){Ju.logLevel<=je.WARN&&Ju.warn(`Auth (${to}): ${t}`,...e)}function uu(t,...e){Ju.logLevel<=je.ERROR&&Ju.error(`Auth (${to}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vn(t,...e){throw Hg(t,...e)}function Qn(t,...e){return Hg(t,...e)}function NN(t,e,n){const s=Object.assign(Object.assign({},qj()),{[e]:n});return new ec("auth","Firebase",s).create(e,{appName:t.name})}function Jn(t){return NN(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Hg(t,...e){if(typeof t!="string"){const n=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=t.name),t._errorFactory.create(n,...s)}return EN.create(t,...e)}function te(t,e,...n){if(!t)throw Hg(e,...n)}function gs(t){const e="INTERNAL ASSERTION FAILED: "+t;throw uu(e),new Error(e)}function Os(t,e){t||gs(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vm(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Xj(){return lx()==="http:"||lx()==="https:"}function lx(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qj(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Xj()||k2()||"connection"in navigator)?navigator.onLine:!0}function Jj(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc{constructor(e,n){this.shortDelay=e,this.longDelay=n,Os(n>e,"Short delay should be less than long delay!"),this.isMobile=Dg()||mN()}get(){return Qj()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gg(t,e){Os(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kN{static initialize(e,n,s){this.fetchImpl=e,n&&(this.headersImpl=n),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;gs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;gs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;gs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zj={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e5=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],t5=new tc(3e4,6e4);function Bs(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Us(t,e,n,s,i={}){return SN(t,i,async()=>{let r={},a={};s&&(e==="GET"?a=s:r={body:JSON.stringify(s)});const o=eo(Object.assign({key:t.config.apiKey},a)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:l},r);return N2()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&Za(t.emulatorConfig.host)&&(u.credentials="include"),kN.fetch()(await TN(t,t.config.apiHost,n,o),u)})}async function SN(t,e,n){t._canInitEmulator=!1;const s=Object.assign(Object.assign({},Zj),e);try{const i=new s5(t),r=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const a=await r.json();if("needConfirmation"in a)throw Bc(t,"account-exists-with-different-credential",a);if(r.ok&&!("errorMessage"in a))return a;{const o=r.ok?a.errorMessage:a.error.message,[l,u]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Bc(t,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw Bc(t,"email-already-in-use",a);if(l==="USER_DISABLED")throw Bc(t,"user-disabled",a);const d=s[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw NN(t,d,u);Vn(t,d)}}catch(i){if(i instanceof Bi)throw i;Vn(t,"network-request-failed",{message:String(i)})}}async function nc(t,e,n,s,i={}){const r=await Us(t,e,n,s,i);return"mfaPendingCredential"in r&&Vn(t,"multi-factor-auth-required",{_serverResponse:r}),r}async function TN(t,e,n,s){const i=`${e}${n}?${s}`,r=t,a=r.config.emulator?Gg(t.config,i):`${t.config.apiScheme}://${i}`;return e5.includes(n)&&(await r._persistenceManagerAvailable,r._getPersistenceType()==="COOKIE")?r._getPersistence()._getFinalTarget(a).toString():a}function n5(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class s5{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,s)=>{this.timer=setTimeout(()=>s(Qn(this.auth,"network-request-failed")),t5.get())})}}function Bc(t,e,n){const s={appName:t.name};n.email&&(s.email=n.email),n.phoneNumber&&(s.phoneNumber=n.phoneNumber);const i=Qn(t,e,s);return i.customData._tokenResponse=n,i}function cx(t){return t!==void 0&&t.enterprise!==void 0}class i5{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return n5(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function r5(t,e){return Us(t,"GET","/v2/recaptchaConfig",Bs(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function a5(t,e){return Us(t,"POST","/v1/accounts:delete",e)}async function Zu(t,e){return Us(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qo(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function o5(t,e=!1){const n=dt(t),s=await n.getIdToken(e),i=Vg(s);te(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const r=typeof i.firebase=="object"?i.firebase:void 0,a=r==null?void 0:r.sign_in_provider;return{claims:i,token:s,authTime:qo(ph(i.auth_time)),issuedAtTime:qo(ph(i.iat)),expirationTime:qo(ph(i.exp)),signInProvider:a||null,signInSecondFactor:(r==null?void 0:r.sign_in_second_factor)||null}}function ph(t){return Number(t)*1e3}function Vg(t){const[e,n,s]=t.split(".");if(e===void 0||n===void 0||s===void 0)return uu("JWT malformed, contained fewer than 3 sections"),null;try{const i=qu(n);return i?JSON.parse(i):(uu("Failed to decode base64 JWT payload"),null)}catch(i){return uu("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function ux(t){const e=Vg(t);return te(e,"internal-error"),te(typeof e.exp<"u","internal-error"),te(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wl(t,e,n=!1){if(n)return e;try{return await e}catch(s){throw s instanceof Bi&&l5(s)&&t.auth.currentUser===t&&await t.auth.signOut(),s}}function l5({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c5{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fm{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=qo(this.lastLoginAt),this.creationTime=qo(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function El(t){var e;const n=t.auth,s=await t.getIdToken(),i=await wl(t,Zu(n,{idToken:s}));te(i==null?void 0:i.users.length,n,"internal-error");const r=i.users[0];t._notifyReloadListener(r);const a=!((e=r.providerUserInfo)===null||e===void 0)&&e.length?AN(r.providerUserInfo):[],o=d5(t.providerData,a),l=t.isAnonymous,u=!(t.email&&r.passwordHash)&&!(o!=null&&o.length),d=l?u:!1,f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new Fm(r.createdAt,r.lastLoginAt),isAnonymous:d};Object.assign(t,f)}async function u5(t){const e=dt(t);await El(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function d5(t,e){return[...t.filter(s=>!e.some(i=>i.providerId===s.providerId)),...e]}function AN(t){return t.map(e=>{var{providerId:n}=e,s=Ug(e,["providerId"]);return{providerId:n,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f5(t,e){const n=await SN(t,{},async()=>{const s=eo({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:r}=t.config,a=await TN(t,i,"/v1/token",`key=${r}`),o=await t._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:o,body:s};return t.emulatorConfig&&Za(t.emulatorConfig.host)&&(l.credentials="include"),kN.fetch()(a,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function h5(t,e){return Us(t,"POST","/v2/accounts:revokeToken",Bs(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fa{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){te(e.idToken,"internal-error"),te(typeof e.idToken<"u","internal-error"),te(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ux(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){te(e.length!==0,"internal-error");const n=ux(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(te(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:s,refreshToken:i,expiresIn:r}=await f5(e,n);this.updateTokensAndExpiration(s,i,Number(r))}updateTokensAndExpiration(e,n,s){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,n){const{refreshToken:s,accessToken:i,expirationTime:r}=n,a=new fa;return s&&(te(typeof s=="string","internal-error",{appName:e}),a.refreshToken=s),i&&(te(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),r&&(te(typeof r=="number","internal-error",{appName:e}),a.expirationTime=r),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new fa,this.toJSON())}_performRefresh(){return gs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vs(t,e){te(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Un{constructor(e){var{uid:n,auth:s,stsTokenManager:i}=e,r=Ug(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new c5(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=s,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Fm(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const n=await wl(this,this.stsTokenManager.getToken(this.auth,e));return te(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return o5(this,e)}reload(){return u5(this)}_assign(e){this!==e&&(te(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Un(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){te(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),n&&await El(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(nn(this.auth.app))return Promise.reject(Jn(this.auth));const e=await this.getIdToken();return await wl(this,a5(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var s,i,r,a,o,l,u,d;const f=(s=n.displayName)!==null&&s!==void 0?s:void 0,h=(i=n.email)!==null&&i!==void 0?i:void 0,m=(r=n.phoneNumber)!==null&&r!==void 0?r:void 0,v=(a=n.photoURL)!==null&&a!==void 0?a:void 0,b=(o=n.tenantId)!==null&&o!==void 0?o:void 0,y=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,p=(u=n.createdAt)!==null&&u!==void 0?u:void 0,g=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:x,emailVerified:w,isAnonymous:N,providerData:T,stsTokenManager:E}=n;te(x&&E,e,"internal-error");const A=fa.fromJSON(this.name,E);te(typeof x=="string",e,"internal-error"),Vs(f,e.name),Vs(h,e.name),te(typeof w=="boolean",e,"internal-error"),te(typeof N=="boolean",e,"internal-error"),Vs(m,e.name),Vs(v,e.name),Vs(b,e.name),Vs(y,e.name),Vs(p,e.name),Vs(g,e.name);const k=new Un({uid:x,auth:e,email:h,emailVerified:w,displayName:f,isAnonymous:N,photoURL:v,phoneNumber:m,tenantId:b,stsTokenManager:A,createdAt:p,lastLoginAt:g});return T&&Array.isArray(T)&&(k.providerData=T.map(R=>Object.assign({},R))),y&&(k._redirectEventId=y),k}static async _fromIdTokenResponse(e,n,s=!1){const i=new fa;i.updateFromServerResponse(n);const r=new Un({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:s});return await El(r),r}static async _fromGetAccountInfoResponse(e,n,s){const i=n.users[0];te(i.localId!==void 0,"internal-error");const r=i.providerUserInfo!==void 0?AN(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(r!=null&&r.length),o=new fa;o.updateFromIdToken(s);const l=new Un({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:r,metadata:new Fm(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(r!=null&&r.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dx=new Map;function vs(t){Os(t instanceof Function,"Expected a class definition");let e=dx.get(t);return e?(Os(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,dx.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}RN.type="NONE";const fx=RN;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function du(t,e,n){return`firebase:${t}:${e}:${n}`}class ha{constructor(e,n,s){this.persistence=e,this.auth=n,this.userKey=s;const{config:i,name:r}=this.auth;this.fullUserKey=du(this.userKey,i.apiKey,r),this.fullPersistenceKey=du("persistence",i.apiKey,r),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Zu(this.auth,{idToken:e}).catch(()=>{});return n?Un._fromGetAccountInfoResponse(this.auth,n,e):null}return Un._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,s="authUser"){if(!n.length)return new ha(vs(fx),e,s);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let r=i[0]||vs(fx);const a=du(s,e.config.apiKey,e.name);let o=null;for(const u of n)try{const d=await u._get(a);if(d){let f;if(typeof d=="string"){const h=await Zu(e,{idToken:d}).catch(()=>{});if(!h)break;f=await Un._fromGetAccountInfoResponse(e,h,d)}else f=Un._fromJSON(e,d);u!==r&&(o=f),r=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!r._shouldAllowMigration||!l.length?new ha(r,e,s):(r=l[0],o&&await r._set(a,o.toJSON()),await Promise.all(n.map(async u=>{if(u!==r)try{await u._remove(a)}catch{}})),new ha(r,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hx(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(ON(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(IN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(DN(e))return"Blackberry";if(LN(e))return"Webos";if(CN(e))return"Safari";if((e.includes("chrome/")||jN(e))&&!e.includes("edge/"))return"Chrome";if(MN(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=t.match(n);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function IN(t=Gt()){return/firefox\//i.test(t)}function CN(t=Gt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function jN(t=Gt()){return/crios\//i.test(t)}function ON(t=Gt()){return/iemobile/i.test(t)}function MN(t=Gt()){return/android/i.test(t)}function DN(t=Gt()){return/blackberry/i.test(t)}function LN(t=Gt()){return/webos/i.test(t)}function Fg(t=Gt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function m5(t=Gt()){var e;return Fg(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function p5(){return S2()&&document.documentMode===10}function PN(t=Gt()){return Fg(t)||MN(t)||LN(t)||DN(t)||/windows phone/i.test(t)||ON(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BN(t,e=[]){let n;switch(t){case"Browser":n=hx(Gt());break;case"Worker":n=`${hx(Gt())}-${t}`;break;default:n=t}const s=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${to}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g5{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const s=r=>new Promise((a,o)=>{try{const l=e(r);a(l)}catch(l){o(l)}});s.onAbort=n,this.queue.push(s);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const s of this.queue)await s(e),s.onAbort&&n.push(s.onAbort)}catch(s){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v5(t,e={}){return Us(t,"GET","/v2/passwordPolicy",Bs(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b5=6;class x5{constructor(e){var n,s,i,r;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=a.minPasswordLength)!==null&&n!==void 0?n:b5,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(s=e.allowedNonAlphanumericCharacters)===null||s===void 0?void 0:s.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(r=e.forceUpgradeOnSignin)!==null&&r!==void 0?r:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,s,i,r,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(n=l.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(s=l.meetsMaxPasswordLength)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(r=l.containsUppercaseLetter)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,n){const s=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;s&&(n.meetsMinPasswordLength=e.length>=s),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let s;for(let i=0;i<e.length;i++)s=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,n,s,i,r){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y5{constructor(e,n,s,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=s,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new mx(this),this.idTokenSubscription=new mx(this),this.beforeStateQueue=new g5(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=EN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(r=>this._resolvePersistenceManagerAvailable=r)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=vs(n)),this._initializationPromise=this.queue(async()=>{var s,i,r;if(!this._deleted&&(this.persistenceManager=await ha.create(this,e),(s=this._resolvePersistenceManagerAvailable)===null||s===void 0||s.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((r=this.currentUser)===null||r===void 0?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Zu(this,{idToken:e}),s=await Un._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(s)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(nn(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const s=await this.assertedPersistence.getCurrentUser();let i=s,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,o=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(i=l.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return te(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await El(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Jj()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(nn(this.app))return Promise.reject(Jn(this));const n=e?dt(e):null;return n&&te(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&te(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return nn(this.app)?Promise.reject(Jn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return nn(this.app)?Promise.reject(Jn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(vs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await v5(this),n=new x5(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ec("auth","Firebase",e())}onAuthStateChanged(e,n,s){return this.registerStateListener(this.authStateSubscription,e,n,s)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,s){return this.registerStateListener(this.idTokenSubscription,e,n,s)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(s.tenantId=this.tenantId),await h5(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const s=await this.getOrInitRedirectPersistenceManager(n);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&vs(e)||this._popupRedirectResolver;te(n,this,"argument-error"),this.redirectPersistenceManager=await ha.create(this,[vs(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,s;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,s,i){if(this._deleted)return()=>{};const r=typeof n=="function"?n:n.next.bind(n);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(te(o,this,"internal-error"),o.then(()=>{a||r(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,s,i);return()=>{a=!0,l()}}else{const l=e.addObserver(n);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return te(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=BN(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());s&&(n["X-Firebase-Client"]=s);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;if(nn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&Wj(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Hs(t){return dt(t)}class mx{constructor(e){this.auth=e,this.observer=null,this.addObserver=L2(n=>this.observer=n)}get next(){return te(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function _5(t){Qd=t}function UN(t){return Qd.loadJS(t)}function w5(){return Qd.recaptchaEnterpriseScript}function E5(){return Qd.gapiScript}function N5(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class k5{constructor(){this.enterprise=new S5}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class S5{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const T5="recaptcha-enterprise",HN="NO_RECAPTCHA";class A5{constructor(e){this.type=T5,this.auth=Hs(e)}async verify(e="verify",n=!1){async function s(r){if(!n){if(r.tenantId==null&&r._agentRecaptchaConfig!=null)return r._agentRecaptchaConfig.siteKey;if(r.tenantId!=null&&r._tenantRecaptchaConfigs[r.tenantId]!==void 0)return r._tenantRecaptchaConfigs[r.tenantId].siteKey}return new Promise(async(a,o)=>{r5(r,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const u=new i5(l);return r.tenantId==null?r._agentRecaptchaConfig=u:r._tenantRecaptchaConfigs[r.tenantId]=u,a(u.siteKey)}}).catch(l=>{o(l)})})}function i(r,a,o){const l=window.grecaptcha;cx(l)?l.enterprise.ready(()=>{l.enterprise.execute(r,{action:e}).then(u=>{a(u)}).catch(()=>{a(HN)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new k5().execute("siteKey",{action:"verify"}):new Promise((r,a)=>{s(this.auth).then(o=>{if(!n&&cx(window.grecaptcha))i(o,r,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let l=w5();l.length!==0&&(l+=o),UN(l).then(()=>{i(o,r,a)}).catch(u=>{a(u)})}}).catch(o=>{a(o)})})}}async function px(t,e,n,s=!1,i=!1){const r=new A5(t);let a;if(i)a=HN;else try{a=await r.verify(n)}catch{a=await r.verify(n,!0)}const o=Object.assign({},e);if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in o){const l=o.phoneEnrollmentInfo.phoneNumber,u=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:u,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const l=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return s?Object.assign(o,{captchaResp:a}):Object.assign(o,{captchaResponse:a}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function ed(t,e,n,s,i){var r;if(!((r=t._getRecaptchaConfig())===null||r===void 0)&&r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await px(t,e,n,n==="getOobCode");return s(t,a)}else return s(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await px(t,e,n,n==="getOobCode");return s(t,o)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R5(t,e){const n=Bg(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),r=n.getOptions();if(pr(r,e??{}))return i;Vn(i,"already-initialized")}return n.initialize({options:e})}function I5(t,e){const n=(e==null?void 0:e.persistence)||[],s=(Array.isArray(n)?n:[n]).map(vs);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function C5(t,e,n){const s=Hs(t);te(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const i=!1,r=GN(e),{host:a,port:o}=j5(e),l=o===null?"":`:${o}`,u={url:`${r}//${a}${l}/`},d=Object.freeze({host:a,port:o,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!s._canInitEmulator){te(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),te(pr(u,s.config.emulator)&&pr(d,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=u,s.emulatorConfig=d,s.settings.appVerificationDisabledForTesting=!0,Za(a)?(fN(`${r}//${a}${l}`),hN("Auth",!0)):O5()}function GN(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function j5(t){const e=GN(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const s=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(s);if(i){const r=i[1];return{host:r,port:gx(s.substr(r.length+1))}}else{const[r,a]=s.split(":");return{host:r,port:gx(a)}}}function gx(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function O5(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zg{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return gs("not implemented")}_getIdTokenResponse(e){return gs("not implemented")}_linkToIdToken(e,n){return gs("not implemented")}_getReauthenticationResolver(e){return gs("not implemented")}}async function M5(t,e){return Us(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D5(t,e){return nc(t,"POST","/v1/accounts:signInWithPassword",Bs(t,e))}async function L5(t,e){return Us(t,"POST","/v1/accounts:sendOobCode",Bs(t,e))}async function P5(t,e){return L5(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B5(t,e){return nc(t,"POST","/v1/accounts:signInWithEmailLink",Bs(t,e))}async function U5(t,e){return nc(t,"POST","/v1/accounts:signInWithEmailLink",Bs(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nl extends zg{constructor(e,n,s,i=null){super("password",s),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new Nl(e,n,"password")}static _fromEmailAndCode(e,n,s=null){return new Nl(e,n,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ed(e,n,"signInWithPassword",D5);case"emailLink":return B5(e,{email:this._email,oobCode:this._password});default:Vn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const s={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ed(e,s,"signUpPassword",M5);case"emailLink":return U5(e,{idToken:n,email:this._email,oobCode:this._password});default:Vn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ma(t,e){return nc(t,"POST","/v1/accounts:signInWithIdp",Bs(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H5="http://localhost";class vr extends zg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new vr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Vn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:i}=n,r=Ug(n,["providerId","signInMethod"]);if(!s||!i)return null;const a=new vr(s,i);return a.idToken=r.idToken||void 0,a.accessToken=r.accessToken||void 0,a.secret=r.secret,a.nonce=r.nonce,a.pendingToken=r.pendingToken||null,a}_getIdTokenResponse(e){const n=this.buildRequest();return ma(e,n)}_linkToIdToken(e,n){const s=this.buildRequest();return s.idToken=n,ma(e,s)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ma(e,n)}buildRequest(){const e={requestUri:H5,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=eo(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G5(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function V5(t){const e=Ao(Ro(t)).link,n=e?Ao(Ro(e)).deep_link_id:null,s=Ao(Ro(t)).deep_link_id;return(s?Ao(Ro(s)).link:null)||s||n||e||t}class $g{constructor(e){var n,s,i,r,a,o;const l=Ao(Ro(e)),u=(n=l.apiKey)!==null&&n!==void 0?n:null,d=(s=l.oobCode)!==null&&s!==void 0?s:null,f=G5((i=l.mode)!==null&&i!==void 0?i:null);te(u&&d&&f,"argument-error"),this.apiKey=u,this.operation=f,this.code=d,this.continueUrl=(r=l.continueUrl)!==null&&r!==void 0?r:null,this.languageCode=(a=l.lang)!==null&&a!==void 0?a:null,this.tenantId=(o=l.tenantId)!==null&&o!==void 0?o:null}static parseLink(e){const n=V5(e);try{return new $g(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(){this.providerId=Tr.PROVIDER_ID}static credential(e,n){return Nl._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const s=$g.parseLink(n);return te(s,"argument-error"),Nl._fromEmailAndCode(e,s.code,s.tenantId)}}Tr.PROVIDER_ID="password";Tr.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Tr.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VN{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc extends VN{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xs extends sc{constructor(){super("facebook.com")}static credential(e){return vr._fromParams({providerId:Xs.PROVIDER_ID,signInMethod:Xs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xs.credentialFromTaggedObject(e)}static credentialFromError(e){return Xs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Xs.credential(e.oauthAccessToken)}catch{return null}}}Xs.FACEBOOK_SIGN_IN_METHOD="facebook.com";Xs.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs extends sc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return vr._fromParams({providerId:Qs.PROVIDER_ID,signInMethod:Qs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Qs.credentialFromTaggedObject(e)}static credentialFromError(e){return Qs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:s}=e;if(!n&&!s)return null;try{return Qs.credential(n,s)}catch{return null}}}Qs.GOOGLE_SIGN_IN_METHOD="google.com";Qs.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js extends sc{constructor(){super("github.com")}static credential(e){return vr._fromParams({providerId:Js.PROVIDER_ID,signInMethod:Js.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Js.credentialFromTaggedObject(e)}static credentialFromError(e){return Js.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Js.credential(e.oauthAccessToken)}catch{return null}}}Js.GITHUB_SIGN_IN_METHOD="github.com";Js.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zs extends sc{constructor(){super("twitter.com")}static credential(e,n){return vr._fromParams({providerId:Zs.PROVIDER_ID,signInMethod:Zs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Zs.credentialFromTaggedObject(e)}static credentialFromError(e){return Zs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:s}=e;if(!n||!s)return null;try{return Zs.credential(n,s)}catch{return null}}}Zs.TWITTER_SIGN_IN_METHOD="twitter.com";Zs.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FN(t,e){return nc(t,"POST","/v1/accounts:signUp",Bs(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,s,i=!1){const r=await Un._fromIdTokenResponse(e,s,i),a=vx(s);return new Ms({user:r,providerId:a,_tokenResponse:s,operationType:n})}static async _forOperation(e,n,s){await e._updateTokensIfNecessary(s,!0);const i=vx(s);return new Ms({user:e,providerId:i,_tokenResponse:s,operationType:n})}}function vx(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F5(t){var e;if(nn(t.app))return Promise.reject(Jn(t));const n=Hs(t);if(await n._initializationPromise,!((e=n.currentUser)===null||e===void 0)&&e.isAnonymous)return new Ms({user:n.currentUser,providerId:null,operationType:"signIn"});const s=await FN(n,{returnSecureToken:!0}),i=await Ms._fromIdTokenResponse(n,"signIn",s,!0);return await n._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td extends Bi{constructor(e,n,s,i){var r;super(n.code,n.message),this.operationType=s,this.user=i,Object.setPrototypeOf(this,td.prototype),this.customData={appName:e.name,tenantId:(r=e.tenantId)!==null&&r!==void 0?r:void 0,_serverResponse:n.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,n,s,i){return new td(e,n,s,i)}}function zN(t,e,n,s){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(r=>{throw r.code==="auth/multi-factor-auth-required"?td._fromErrorAndOperation(t,r,e,s):r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z5(t){return new Set(t.map(({providerId:e})=>e).filter(e=>!!e))}async function $N(t,e,n=!1){const s=await wl(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Ms._forOperation(t,"link",s)}async function $5(t,e,n){await El(e);const s=z5(e.providerData);te(s.has(n)===t,e.auth,"provider-already-linked")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K5(t,e,n=!1){const{auth:s}=t;if(nn(s.app))return Promise.reject(Jn(s));const i="reauthenticate";try{const r=await wl(t,zN(s,i,e,t),n);te(r.idToken,s,"internal-error");const a=Vg(r.idToken);te(a,s,"internal-error");const{sub:o}=a;return te(t.uid===o,s,"user-mismatch"),Ms._forOperation(t,i,r)}catch(r){throw(r==null?void 0:r.code)==="auth/user-not-found"&&Vn(s,"user-mismatch"),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KN(t,e,n=!1){if(nn(t.app))return Promise.reject(Jn(t));const s="signIn",i=await zN(t,s,e),r=await Ms._fromIdTokenResponse(t,s,i);return n||await t._updateCurrentUser(r.user),r}async function Y5(t,e){return KN(Hs(t),e)}async function q5(t,e){const n=dt(t);return await $5(!1,n,e.providerId),$N(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YN(t){const e=Hs(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function W5(t,e,n){const s=Hs(t);await ed(s,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",P5)}async function X5(t,e,n){if(nn(t.app))return Promise.reject(Jn(t));const s=Hs(t),a=await ed(s,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",FN).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&YN(t),l}),o=await Ms._fromIdTokenResponse(s,"signIn",a);return await s._updateCurrentUser(o.user),o}function Q5(t,e,n){return nn(t.app)?Promise.reject(Jn(t)):Y5(dt(t),Tr.credential(e,n)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&YN(t),s})}function J5(t,e,n,s){return dt(t).onIdTokenChanged(e,n,s)}function Z5(t,e,n){return dt(t).beforeAuthStateChanged(e,n)}function eO(t,e,n,s){return dt(t).onAuthStateChanged(e,n,s)}function tO(t){return dt(t).signOut()}const nd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qN{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(nd,"1"),this.storage.removeItem(nd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nO=1e3,sO=10;class WN extends qN{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=PN(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const s=this.storage.getItem(n),i=this.localCache[n];s!==i&&e(n,i,s)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const s=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(s);!n&&this.localCache[s]===a||this.notifyListeners(s,a)},r=this.storage.getItem(s);p5()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,sO):i()}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:s}),!0)})},nO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}WN.type="LOCAL";const iO=WN;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XN extends qN{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}XN.type="SESSION";const QN=XN;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rO(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const s=new Jd(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:s,eventType:i,data:r}=n.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;n.ports[0].postMessage({status:"ack",eventId:s,eventType:i});const o=Array.from(a).map(async u=>u(n.origin,r)),l=await rO(o);n.ports[0].postMessage({status:"done",eventId:s,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Jd.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kg(t="",e=10){let n="";for(let s=0;s<e;s++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aO{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,s=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,a;return new Promise((o,l)=>{const u=Kg("",20);i.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},s);a={messageChannel:i,onMessage(f){const h=f;if(h.data.eventId===u)switch(h.data.status){case"ack":clearTimeout(d),r=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),o(h.data.response);break;default:clearTimeout(d),clearTimeout(r),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zn(){return window}function oO(t){Zn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JN(){return typeof Zn().WorkerGlobalScope<"u"&&typeof Zn().importScripts=="function"}async function lO(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function cO(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function uO(){return JN()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZN="firebaseLocalStorageDb",dO=1,sd="firebaseLocalStorage",ek="fbase_key";class ic{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Zd(t,e){return t.transaction([sd],e?"readwrite":"readonly").objectStore(sd)}function fO(){const t=indexedDB.deleteDatabase(ZN);return new ic(t).toPromise()}function zm(){const t=indexedDB.open(ZN,dO);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const s=t.result;try{s.createObjectStore(sd,{keyPath:ek})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const s=t.result;s.objectStoreNames.contains(sd)?e(s):(s.close(),await fO(),e(await zm()))})})}async function bx(t,e,n){const s=Zd(t,!0).put({[ek]:e,value:n});return new ic(s).toPromise()}async function hO(t,e){const n=Zd(t,!1).get(e),s=await new ic(n).toPromise();return s===void 0?null:s.value}function xx(t,e){const n=Zd(t,!0).delete(e);return new ic(n).toPromise()}const mO=800,pO=3;class tk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await zm(),this.db)}async _withRetries(e){let n=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(n++>pO)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return JN()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Jd._getInstance(uO()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await lO(),!this.activeServiceWorker)return;this.sender=new aO(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);s&&!((e=s[0])===null||e===void 0)&&e.fulfilled&&!((n=s[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||cO()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await zm();return await bx(e,nd,"1"),await xx(e,nd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(s=>bx(s,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(s=>hO(s,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>xx(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const r=Zd(i,!1).getAll();return new ic(r).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],s=new Set;if(e.length!==0)for(const{fbase_key:i,value:r}of e)s.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!s.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),mO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}tk.type="LOCAL";const gO=tk;new tc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vO(t,e){return e?vs(e):(te(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yg extends zg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ma(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ma(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ma(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function bO(t){return KN(t.auth,new Yg(t),t.bypassAuthState)}function xO(t){const{auth:e,user:n}=t;return te(n,e,"internal-error"),K5(n,new Yg(t),t.bypassAuthState)}async function yO(t){const{auth:e,user:n}=t;return te(n,e,"internal-error"),$N(n,new Yg(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nk{constructor(e,n,s,i,r=!1){this.auth=e,this.resolver=s,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:s,postBody:i,tenantId:r,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:n,sessionId:s,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return bO;case"linkViaPopup":case"linkViaRedirect":return yO;case"reauthViaPopup":case"reauthViaRedirect":return xO;default:Vn(this.auth,"internal-error")}}resolve(e){Os(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Os(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _O=new tc(2e3,1e4);class Jr extends nk{constructor(e,n,s,i,r){super(e,n,i,r),this.provider=s,this.authWindow=null,this.pollId=null,Jr.currentPopupAction&&Jr.currentPopupAction.cancel(),Jr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return te(e,this.auth,"internal-error"),e}async onExecution(){Os(this.filter.length===1,"Popup operations only handle one event");const e=Kg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Qn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Qn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Jr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,s;if(!((s=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Qn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,_O.get())};e()}}Jr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wO="pendingRedirect",fu=new Map;class EO extends nk{constructor(e,n,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,s),this.eventId=null}async execute(){let e=fu.get(this.auth._key());if(!e){try{const s=await NO(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(n){e=()=>Promise.reject(n)}fu.set(this.auth._key(),e)}return this.bypassAuthState||fu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function NO(t,e){const n=TO(e),s=SO(t);if(!await s._isAvailable())return!1;const i=await s._get(n)==="true";return await s._remove(n),i}function kO(t,e){fu.set(t._key(),e)}function SO(t){return vs(t._redirectPersistence)}function TO(t){return du(wO,t.config.apiKey,t.name)}async function AO(t,e,n=!1){if(nn(t.app))return Promise.reject(Jn(t));const s=Hs(t),i=vO(s,e),a=await new EO(s,i,n).execute();return a&&!n&&(delete a.user._redirectEventId,await s._persistUserIfCurrent(a.user),await s._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RO=10*60*1e3;class IO{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(n=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!CO(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var s;if(e.error&&!sk(e)){const i=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";n.onError(Qn(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const s=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=RO&&this.cachedEventUids.clear(),this.cachedEventUids.has(yx(e))}saveEventToCache(e){this.cachedEventUids.add(yx(e)),this.lastProcessedEventTime=Date.now()}}function yx(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function sk({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function CO(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return sk(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jO(t,e={}){return Us(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OO=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,MO=/^https?/;async function DO(t){if(t.config.emulator)return;const{authorizedDomains:e}=await jO(t);for(const n of e)try{if(LO(n))return}catch{}Vn(t,"unauthorized-domain")}function LO(t){const e=Vm(),{protocol:n,hostname:s}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&s===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&a.hostname===s}if(!MO.test(n))return!1;if(OO.test(t))return s===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PO=new tc(3e4,6e4);function _x(){const t=Zn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function BO(t){return new Promise((e,n)=>{var s,i,r;function a(){_x(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{_x(),n(Qn(t,"network-request-failed"))},timeout:PO.get()})}if(!((i=(s=Zn().gapi)===null||s===void 0?void 0:s.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((r=Zn().gapi)===null||r===void 0)&&r.load)a();else{const o=N5("iframefcb");return Zn()[o]=()=>{gapi.load?a():n(Qn(t,"network-request-failed"))},UN(`${E5()}?onload=${o}`).catch(l=>n(l))}}).catch(e=>{throw hu=null,e})}let hu=null;function UO(t){return hu=hu||BO(t),hu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HO=new tc(5e3,15e3),GO="__/auth/iframe",VO="emulator/auth/iframe",FO={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},zO=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function $O(t){const e=t.config;te(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Gg(e,VO):`https://${t.config.authDomain}/${GO}`,s={apiKey:e.apiKey,appName:t.name,v:to},i=zO.get(t.config.apiHost);i&&(s.eid=i);const r=t._getFrameworks();return r.length&&(s.fw=r.join(",")),`${n}?${eo(s).slice(1)}`}async function KO(t){const e=await UO(t),n=Zn().gapi;return te(n,t,"internal-error"),e.open({where:document.body,url:$O(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:FO,dontclear:!0},s=>new Promise(async(i,r)=>{await s.restyle({setHideOnLeave:!1});const a=Qn(t,"network-request-failed"),o=Zn().setTimeout(()=>{r(a)},HO.get());function l(){Zn().clearTimeout(o),i(s)}s.ping(l).then(l,()=>{r(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YO={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},qO=500,WO=600,XO="_blank",QO="http://localhost";class wx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function JO(t,e,n,s=qO,i=WO){const r=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-s)/2,0).toString();let o="";const l=Object.assign(Object.assign({},YO),{width:s.toString(),height:i.toString(),top:r,left:a}),u=Gt().toLowerCase();n&&(o=jN(u)?XO:n),IN(u)&&(e=e||QO,l.scrollbars="yes");const d=Object.entries(l).reduce((h,[m,v])=>`${h}${m}=${v},`,"");if(m5(u)&&o!=="_self")return ZO(e||"",o),new wx(null);const f=window.open(e||"",o,d);te(f,t,"popup-blocked");try{f.focus()}catch{}return new wx(f)}function ZO(t,e){const n=document.createElement("a");n.href=t,n.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eM="__/auth/handler",tM="emulator/auth/handler",nM=encodeURIComponent("fac");async function Ex(t,e,n,s,i,r){te(t.config.authDomain,t,"auth-domain-config-required"),te(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:s,v:to,eventId:i};if(e instanceof VN){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",Wu(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries({}))a[d]=f}if(e instanceof sc){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(a.scopes=d.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const d of Object.keys(o))o[d]===void 0&&delete o[d];const l=await t._getAppCheckToken(),u=l?`#${nM}=${encodeURIComponent(l)}`:"";return`${sM(t)}?${eo(o).slice(1)}${u}`}function sM({config:t}){return t.emulator?Gg(t,tM):`https://${t.authDomain}/${eM}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gh="webStorageSupport";class iM{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=QN,this._completeRedirectFn=AO,this._overrideRedirectResult=kO}async _openPopup(e,n,s,i){var r;Os((r=this.eventManagers[e._key()])===null||r===void 0?void 0:r.manager,"_initialize() not called before _openPopup()");const a=await Ex(e,n,s,Vm(),i);return JO(e,a,Kg())}async _openRedirect(e,n,s,i){await this._originValidation(e);const r=await Ex(e,n,s,Vm(),i);return oO(r),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:r}=this.eventManagers[n];return i?Promise.resolve(i):(Os(r,"If manager is not set, promise should be"),r)}const s=this.initAndGetManager(e);return this.eventManagers[n]={promise:s},s.catch(()=>{delete this.eventManagers[n]}),s}async initAndGetManager(e){const n=await KO(e),s=new IO(e);return n.register("authEvent",i=>(te(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:s.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=n,s}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(gh,{type:gh},i=>{var r;const a=(r=i==null?void 0:i[0])===null||r===void 0?void 0:r[gh];a!==void 0&&n(!!a),Vn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=DO(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return PN()||CN()||Fg()}}const rM=iM;var Nx="@firebase/auth",kx="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aM{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){te(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oM(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function lM(t){Ca(new gr("auth",(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),r=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=s.options;te(a&&!a.includes(":"),"invalid-api-key",{appName:s.name});const l={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:BN(t)},u=new y5(s,i,r,l);return I5(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,s)=>{e.getProvider("auth-internal").initialize()})),Ca(new gr("auth-internal",e=>{const n=Hs(e.getProvider("auth").getImmediate());return(s=>new aM(s))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),xi(Nx,kx,oM(t)),xi(Nx,kx,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cM=5*60,uM=dN("authIdTokenMaxAge")||cM;let Sx=null;const dM=t=>async e=>{const n=e&&await e.getIdTokenResult(),s=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(s&&s>uM)return;const i=n==null?void 0:n.token;Sx!==i&&(Sx=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function fM(t=xN()){const e=Bg(t,"auth");if(e.isInitialized())return e.getImmediate();const n=R5(t,{popupRedirectResolver:rM,persistence:[gO,iO,QN]}),s=dN("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const r=new URL(s,location.origin);if(location.origin===r.origin){const a=dM(r.toString());Z5(n,a,()=>a(n.currentUser)),J5(n,o=>a(o))}}const i=cN("auth");return i&&C5(n,`http://${i}`),n}function hM(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}_5({loadJS(t){return new Promise((e,n)=>{const s=document.createElement("script");s.setAttribute("src",t),s.onload=e,s.onerror=i=>{const r=Qn("internal-error");r.customData=i,n(r)},s.type="text/javascript",s.charset="UTF-8",hM().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});lM("Browser");var Tx={};const Ax="@firebase/database",Rx="1.0.20";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ik="";function mM(t){ik=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pM{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),ht(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:yl(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gM{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return zn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rk=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new pM(e)}}catch{}return new gM},Zi=rk("localStorage"),vM=rk("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pa=new Lg("@firebase/database"),ak=function(){let t=1;return function(){return t++}}(),ok=function(t){const e=U2(t),n=new D2;n.update(e);const s=n.digest();return Og.encodeByteArray(s)},rc=function(...t){let e="";for(let n=0;n<t.length;n++){const s=t[n];Array.isArray(s)||s&&typeof s=="object"&&typeof s.length=="number"?e+=rc.apply(null,s):typeof s=="object"?e+=ht(s):e+=s,e+=" "}return e};let Wo=null,Ix=!0;const bM=function(t,e){z(!0,"Can't turn on custom loggers persistently."),pa.logLevel=je.VERBOSE,Wo=pa.log.bind(pa)},yt=function(...t){if(Ix===!0&&(Ix=!1,Wo===null&&vM.get("logging_enabled")===!0&&bM()),Wo){const e=rc.apply(null,t);Wo(e)}},ac=function(t){return function(...e){yt(t,...e)}},$m=function(...t){const e="FIREBASE INTERNAL ERROR: "+rc(...t);pa.error(e)},Ds=function(...t){const e=`FIREBASE FATAL ERROR: ${rc(...t)}`;throw pa.error(e),new Error(e)},Ht=function(...t){const e="FIREBASE WARNING: "+rc(...t);pa.warn(e)},xM=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Ht("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},ef=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},yM=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},ja="[MIN_NAME]",br="[MAX_NAME]",Ar=function(t,e){if(t===e)return 0;if(t===ja||e===br)return-1;if(e===ja||t===br)return 1;{const n=Cx(t),s=Cx(e);return n!==null?s!==null?n-s===0?t.length-e.length:n-s:-1:s!==null?1:t<e?-1:1}},_M=function(t,e){return t===e?0:t<e?-1:1},vo=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+ht(e))},qg=function(t){if(typeof t!="object"||t===null)return ht(t);const e=[];for(const s in t)e.push(s);e.sort();let n="{";for(let s=0;s<e.length;s++)s!==0&&(n+=","),n+=ht(e[s]),n+=":",n+=qg(t[e[s]]);return n+="}",n},lk=function(t,e){const n=t.length;if(n<=e)return[t];const s=[];for(let i=0;i<n;i+=e)i+e>n?s.push(t.substring(i,n)):s.push(t.substring(i,i+e));return s};function Et(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const ck=function(t){z(!ef(t),"Invalid JSON number");const e=11,n=52,s=(1<<e-1)-1;let i,r,a,o,l;t===0?(r=0,a=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-s)?(o=Math.min(Math.floor(Math.log(t)/Math.LN2),s),r=o+s,a=Math.round(t*Math.pow(2,n-o)-Math.pow(2,n))):(r=0,a=Math.round(t/Math.pow(2,1-s-n))));const u=[];for(l=n;l;l-=1)u.push(a%2?1:0),a=Math.floor(a/2);for(l=e;l;l-=1)u.push(r%2?1:0),r=Math.floor(r/2);u.push(i?1:0),u.reverse();const d=u.join("");let f="";for(l=0;l<64;l+=8){let h=parseInt(d.substr(l,8),2).toString(16);h.length===1&&(h="0"+h),f=f+h}return f.toLowerCase()},wM=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},EM=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function NM(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const s=new Error(t+" at "+e._path.toString()+": "+n);return s.code=t.toUpperCase(),s}const kM=new RegExp("^-?(0*)\\d{1,10}$"),SM=-2147483648,TM=2147483647,Cx=function(t){if(kM.test(t)){const e=Number(t);if(e>=SM&&e<=TM)return e}return null},no=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw Ht("Exception was thrown by user callback.",n),e},Math.floor(0))}},AM=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Xo=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RM{constructor(e,n){this.appCheckProvider=n,this.appName=e.name,nn(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(s=>this.appCheck=s)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((n,s)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(s=>s.addTokenListener(e))}notifyForInvalidToken(){Ht(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IM{constructor(e,n,s){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=s,this.auth_=null,this.auth_=s.getImmediate({optional:!0}),this.auth_||s.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(yt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,s)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Ht(e)}}class mu{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}mu.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wg="5",uk="v",dk="s",fk="r",hk="f",mk=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,pk="ls",gk="p",Km="ac",vk="websocket",bk="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xk{constructor(e,n,s,i,r=!1,a="",o=!1,l=!1,u=null){this.secure=n,this.namespace=s,this.webSocketOnly=i,this.nodeAdmin=r,this.persistenceKey=a,this.includeNamespaceInQueryParams=o,this.isUsingEmulator=l,this.emulatorOptions=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Zi.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Zi.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function CM(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function yk(t,e,n){z(typeof e=="string","typeof type must == string"),z(typeof n=="object","typeof params must == object");let s;if(e===vk)s=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===bk)s=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);CM(t)&&(n.ns=t.namespace);const i=[];return Et(n,(r,a)=>{i.push(r+"="+a)}),s+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jM{constructor(){this.counters_={}}incrementCounter(e,n=1){zn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return m2(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vh={},bh={};function Xg(t){const e=t.toString();return vh[e]||(vh[e]=new jM),vh[e]}function OM(t,e){const n=t.toString();return bh[n]||(bh[n]=e()),bh[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MM{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const s=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<s.length;++i)s[i]&&no(()=>{this.onMessage_(s[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jx="start",DM="close",LM="pLPCommand",PM="pRTLPCB",_k="id",wk="pw",Ek="ser",BM="cb",UM="seg",HM="ts",GM="d",VM="dframe",Nk=1870,kk=30,FM=Nk-kk,zM=25e3,$M=3e4;class Zr{constructor(e,n,s,i,r,a,o){this.connId=e,this.repoInfo=n,this.applicationId=s,this.appCheckToken=i,this.authToken=r,this.transportSessionId=a,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=ac(e),this.stats_=Xg(n),this.urlFn=l=>(this.appCheckToken&&(l[Km]=this.appCheckToken),yk(n,bk,l))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new MM(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor($M)),yM(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Qg((...r)=>{const[a,o,l,u,d]=r;if(this.incrementIncomingBytes_(r),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,a===jx)this.id=o,this.password=l;else if(a===DM)o?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(o,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+a)},(...r)=>{const[a,o]=r;this.incrementIncomingBytes_(r),this.myPacketOrderer.handleResponse(a,o)},()=>{this.onClosed_()},this.urlFn);const s={};s[jx]="t",s[Ek]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(s[BM]=this.scriptTagHolder.uniqueCallbackIdentifier),s[uk]=Wg,this.transportSessionId&&(s[dk]=this.transportSessionId),this.lastSessionId&&(s[pk]=this.lastSessionId),this.applicationId&&(s[gk]=this.applicationId),this.appCheckToken&&(s[Km]=this.appCheckToken),typeof location<"u"&&location.hostname&&mk.test(location.hostname)&&(s[fk]=hk);const i=this.urlFn(s);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Zr.forceAllow_=!0}static forceDisallow(){Zr.forceDisallow_=!0}static isAvailable(){return Zr.forceAllow_?!0:!Zr.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!wM()&&!EM()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=ht(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=oN(n),i=lk(s,FM);for(let r=0;r<i.length;r++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[r]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const s={};s[VM]="t",s[_k]=e,s[wk]=n,this.myDisconnFrame.src=this.urlFn(s),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=ht(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class Qg{constructor(e,n,s,i){this.onDisconnect=s,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=ak(),window[LM+this.uniqueCallbackIdentifier]=e,window[PM+this.uniqueCallbackIdentifier]=n,this.myIFrame=Qg.createIFrame_();let r="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(r='<script>document.domain="'+document.domain+'";<\/script>');const a="<html><body>"+r+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(o){yt("frame writing exception"),o.stack&&yt(o.stack),yt(o)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||yt("No IE domain setting required")}catch{const s=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+s+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[_k]=this.myID,e[wk]=this.myPW,e[Ek]=this.currentSerial;let n=this.urlFn(e),s="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+kk+s.length<=Nk;){const a=this.pendingSegs.shift();s=s+"&"+UM+i+"="+a.seg+"&"+HM+i+"="+a.ts+"&"+GM+i+"="+a.d,i++}return n=n+s,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,s){this.pendingSegs.push({seg:e,ts:n,d:s}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const s=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(s,Math.floor(zM)),r=()=>{clearTimeout(i),s()};this.addTag(e,r)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const s=this.myIFrame.doc.createElement("script");s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){const i=s.readyState;(!i||i==="loaded"||i==="complete")&&(s.onload=s.onreadystatechange=null,s.parentNode&&s.parentNode.removeChild(s),n())},s.onerror=()=>{yt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(s)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KM=16384,YM=45e3;let id=null;typeof MozWebSocket<"u"?id=MozWebSocket:typeof WebSocket<"u"&&(id=WebSocket);class Bn{constructor(e,n,s,i,r,a,o){this.connId=e,this.applicationId=s,this.appCheckToken=i,this.authToken=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=ac(this.connId),this.stats_=Xg(n),this.connURL=Bn.connectionURL_(n,a,o,i,s),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,s,i,r){const a={};return a[uk]=Wg,typeof location<"u"&&location.hostname&&mk.test(location.hostname)&&(a[fk]=hk),n&&(a[dk]=n),s&&(a[pk]=s),i&&(a[Km]=i),r&&(a[gk]=r),yk(e,vk,a)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Zi.set("previous_websocket_failure",!0);try{let s;T2(),this.mySock=new id(this.connURL,[],s)}catch(s){this.log_("Error instantiating WebSocket.");const i=s.message||s.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=s=>{this.handleIncomingFrame(s)},this.mySock.onerror=s=>{this.log_("WebSocket error.  Closing connection.");const i=s.message||s.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){Bn.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,s=navigator.userAgent.match(n);s&&s.length>1&&parseFloat(s[1])<4.4&&(e=!0)}return!e&&id!==null&&!Bn.forceDisallow_}static previouslyFailed(){return Zi.isInMemoryStorage||Zi.get("previous_websocket_failure")===!0}markConnectionHealthy(){Zi.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const s=yl(n);this.onMessage(s)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(z(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const s=this.extractFrameCount_(n);s!==null&&this.appendFrame_(s)}}send(e){this.resetKeepAlive();const n=ht(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=lk(n,KM);s.length>1&&this.sendString_(String(s.length));for(let i=0;i<s.length;i++)this.sendString_(s[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(YM))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Bn.responsesRequiredToBeHealthy=2;Bn.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{static get ALL_TRANSPORTS(){return[Zr,Bn]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const n=Bn&&Bn.isAvailable();let s=n&&!Bn.previouslyFailed();if(e.webSocketOnly&&(n||Ht("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[Bn];else{const i=this.transports_=[];for(const r of kl.ALL_TRANSPORTS)r&&r.isAvailable()&&i.push(r);kl.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}kl.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qM=6e4,WM=5e3,XM=10*1024,QM=100*1024,xh="t",Ox="d",JM="s",Mx="r",ZM="e",Dx="o",Lx="a",Px="n",Bx="p",eD="h";class tD{constructor(e,n,s,i,r,a,o,l,u,d){this.id=e,this.repoInfo_=n,this.applicationId_=s,this.appCheckToken_=i,this.authToken_=r,this.onMessage_=a,this.onReady_=o,this.onDisconnect_=l,this.onKill_=u,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=ac("c:"+this.id+":"),this.transportManager_=new kl(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),s=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,s)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Xo(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>QM?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>XM?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(xh in e){const n=e[xh];n===Lx?this.upgradeIfSecondaryHealthy_():n===Mx?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===Dx&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=vo("t",e),s=vo("d",e);if(n==="c")this.onSecondaryControl_(s);else if(n==="d")this.pendingDataMessages.push(s);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Bx,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Lx,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Px,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=vo("t",e),s=vo("d",e);n==="c"?this.onControl_(s):n==="d"&&this.onDataMessage_(s)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=vo(xh,e);if(Ox in e){const s=e[Ox];if(n===eD){const i=Object.assign({},s);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===Px){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===JM?this.onConnectionShutdown_(s):n===Mx?this.onReset_(s):n===ZM?$m("Server Error: "+s):n===Dx?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):$m("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,s=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Wg!==s&&Ht("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),s=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,s),Xo(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(qM))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Xo(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(WM))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Bx,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Zi.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sk{put(e,n,s,i){}merge(e,n,s,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,s){}onDisconnectMerge(e,n,s){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tk{constructor(e){this.allowedEvents_=e,this.listeners_={},z(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const s=[...this.listeners_[e]];for(let i=0;i<s.length;i++)s[i].callback.apply(s[i].context,n)}}on(e,n,s){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:s});const i=this.getInitialEvent(e);i&&n.apply(s,i)}off(e,n,s){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let r=0;r<i.length;r++)if(i[r].callback===n&&(!s||s===i[r].context)){i.splice(r,1);return}}validateEventType_(e){z(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rd extends Tk{static getInstance(){return new rd}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Dg()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return z(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ux=32,Hx=768;class Ie{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let s=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[s]=this.pieces_[i],s++);this.pieces_.length=s,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function we(){return new Ie("")}function ue(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Ai(t){return t.pieces_.length-t.pieceNum_}function Me(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Ie(t.pieces_,e)}function Jg(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function nD(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Sl(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function Ak(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Ie(e,0)}function Xe(t,e){const n=[];for(let s=t.pieceNum_;s<t.pieces_.length;s++)n.push(t.pieces_[s]);if(e instanceof Ie)for(let s=e.pieceNum_;s<e.pieces_.length;s++)n.push(e.pieces_[s]);else{const s=e.split("/");for(let i=0;i<s.length;i++)s[i].length>0&&n.push(s[i])}return new Ie(n,0)}function fe(t){return t.pieceNum_>=t.pieces_.length}function Bt(t,e){const n=ue(t),s=ue(e);if(n===null)return e;if(n===s)return Bt(Me(t),Me(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function sD(t,e){const n=Sl(t,0),s=Sl(e,0);for(let i=0;i<n.length&&i<s.length;i++){const r=Ar(n[i],s[i]);if(r!==0)return r}return n.length===s.length?0:n.length<s.length?-1:1}function Zg(t,e){if(Ai(t)!==Ai(e))return!1;for(let n=t.pieceNum_,s=e.pieceNum_;n<=t.pieces_.length;n++,s++)if(t.pieces_[n]!==e.pieces_[s])return!1;return!0}function kn(t,e){let n=t.pieceNum_,s=e.pieceNum_;if(Ai(t)>Ai(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[s])return!1;++n,++s}return!0}class iD{constructor(e,n){this.errorPrefix_=n,this.parts_=Sl(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let s=0;s<this.parts_.length;s++)this.byteLength_+=Xd(this.parts_[s]);Rk(this)}}function rD(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Xd(e),Rk(t)}function aD(t){const e=t.parts_.pop();t.byteLength_-=Xd(e),t.parts_.length>0&&(t.byteLength_-=1)}function Rk(t){if(t.byteLength_>Hx)throw new Error(t.errorPrefix_+"has a key path longer than "+Hx+" bytes ("+t.byteLength_+").");if(t.parts_.length>Ux)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Ux+") or object contains a cycle "+Wi(t))}function Wi(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e0 extends Tk{static getInstance(){return new e0}constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const s=!document[e];s!==this.visible_&&(this.visible_=s,this.trigger("visible",s))},!1)}getInitialEvent(e){return z(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bo=1e3,oD=60*5*1e3,Gx=30*1e3,lD=1.3,cD=3e4,uD="server_kill",Vx=3;class Es extends Sk{constructor(e,n,s,i,r,a,o,l){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=s,this.onConnectStatus_=i,this.onServerInfoUpdate_=r,this.authTokenProvider_=a,this.appCheckTokenProvider_=o,this.authOverride_=l,this.id=Es.nextPersistentConnectionId_++,this.log_=ac("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=bo,this.maxReconnectDelay_=oD,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");e0.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&rd.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,s){const i=++this.requestNumber_,r={r:i,a:e,b:n};this.log_(ht(r)),z(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),s&&(this.requestCBHash_[i]=s)}get(e){this.initConnection_();const n=new Pn,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:a=>{const o=a.d;a.s==="ok"?n.resolve(o):n.reject(o)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),n.promise}listen(e,n,s,i){this.initConnection_();const r=e._queryIdentifier,a=e._path.toString();this.log_("Listen called for "+a+" "+r),this.listens.has(a)||this.listens.set(a,new Map),z(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),z(!this.listens.get(a).has(r),"listen() called twice for same path/queryId.");const o={onComplete:i,hashFn:n,query:e,tag:s};this.listens.get(a).set(r,o),this.connected_&&this.sendListen_(o)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,s=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(s)})}sendListen_(e){const n=e.query,s=n._path.toString(),i=n._queryIdentifier;this.log_("Listen on "+s+" for "+i);const r={p:s},a="q";e.tag&&(r.q=n._queryObject,r.t=e.tag),r.h=e.hashFn(),this.sendRequest(a,r,o=>{const l=o.d,u=o.s;Es.warnOnListenWarnings_(l,n),(this.listens.get(s)&&this.listens.get(s).get(i))===e&&(this.log_("listen response",o),u!=="ok"&&this.removeListen_(s,i),e.onComplete&&e.onComplete(u,l))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&zn(e,"w")){const s=mr(e,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){const i='".indexOn": "'+n._queryParams.getIndex().toString()+'"',r=n._path.toString();Ht(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${r} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||M2(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Gx)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=O2(e)?"auth":"gauth",s={cred:e};this.authOverride_===null?s.noauth=!0:typeof this.authOverride_=="object"&&(s.authvar=this.authOverride_),this.sendRequest(n,s,i=>{const r=i.s,a=i.d||"error";this.authToken_===e&&(r==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(r,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,s=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,s)})}unlisten(e,n){const s=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+s+" "+i),z(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,i)&&this.connected_&&this.sendUnlisten_(s,i,e._queryObject,n)}sendUnlisten_(e,n,s,i){this.log_("Unlisten on "+e+" for "+n);const r={p:e},a="n";i&&(r.q=s,r.t=i),this.sendRequest(a,r)}onDisconnectPut(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:s})}onDisconnectMerge(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:s})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,s,i){const r={p:n,d:s};this.log_("onDisconnect "+e,r),this.sendRequest(e,r,a=>{i&&setTimeout(()=>{i(a.s,a.d)},Math.floor(0))})}put(e,n,s,i){this.putInternal("p",e,n,s,i)}merge(e,n,s,i){this.putInternal("m",e,n,s,i)}putInternal(e,n,s,i,r){this.initConnection_();const a={p:n,d:s};r!==void 0&&(a.h=r),this.outstandingPuts_.push({action:e,request:a,onComplete:i}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,s=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,s,r=>{this.log_(n+" response",r),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(r.s,r.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,s=>{if(s.s!=="ok"){const r=s.d;this.log_("reportStats","Error sending stats: "+r)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+ht(e));const n=e.r,s=this.requestCBHash_[n];s&&(delete this.requestCBHash_[n],s(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):$m("Unrecognized action received from server: "+ht(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){z(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=bo,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=bo,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>cD&&(this.reconnectDelay_=bo),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*lD)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),s=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+Es.nextConnectionId_++,r=this.lastSessionId;let a=!1,o=null;const l=function(){o?o.close():(a=!0,s())},u=function(f){z(o,"sendRequest call when we're not connected not allowed."),o.sendRequest(f)};this.realtime_={close:l,sendRequest:u};const d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[f,h]=await Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);a?yt("getToken() completed but was canceled"):(yt("getToken() completed. Creating connection."),this.authToken_=f&&f.accessToken,this.appCheckToken_=h&&h.token,o=new tD(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,s,m=>{Ht(m+" ("+this.repoInfo_.toString()+")"),this.interrupt(uD)},r))}catch(f){this.log_("Failed to get token: "+f),a||(this.repoInfo_.nodeAdmin&&Ht(f),l())}}}interrupt(e){yt("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){yt("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Wu(this.interruptReasons_)&&(this.reconnectDelay_=bo,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let s;n?s=n.map(r=>qg(r)).join("$"):s="default";const i=this.removeListen_(e,s);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,n){const s=new Ie(e).toString();let i;if(this.listens.has(s)){const r=this.listens.get(s);i=r.get(n),r.delete(n),r.size===0&&this.listens.delete(s)}else i=void 0;return i}onAuthRevoked_(e,n){yt("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Vx&&(this.reconnectDelay_=Gx,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){yt("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Vx&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+ik.replace(/\./g,"-")]=1,Dg()?e["framework.cordova"]=1:mN()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=rd.getInstance().currentlyOnline();return Wu(this.interruptReasons_)&&e}}Es.nextPersistentConnectionId_=0;Es.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class he{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new he(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const s=new he(ja,e),i=new he(ja,n);return this.compare(s,i)!==0}minPost(){return he.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Uc;class Ik extends tf{static get __EMPTY_NODE(){return Uc}static set __EMPTY_NODE(e){Uc=e}compare(e,n){return Ar(e.name,n.name)}isDefinedOn(e){throw Ja("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return he.MIN}maxPost(){return new he(br,Uc)}makePost(e,n){return z(typeof e=="string","KeyIndex indexValue must always be a string."),new he(e,Uc)}toString(){return".key"}}const ga=new Ik;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hc{constructor(e,n,s,i,r=null){this.isReverse_=i,this.resultGenerator_=r,this.nodeStack_=[];let a=1;for(;!e.isEmpty();)if(e=e,a=n?s(e.key,n):1,i&&(a*=-1),a<0)this.isReverse_?e=e.left:e=e.right;else if(a===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class vt{constructor(e,n,s,i,r){this.key=e,this.value=n,this.color=s??vt.RED,this.left=i??qt.EMPTY_NODE,this.right=r??qt.EMPTY_NODE}copy(e,n,s,i,r){return new vt(e??this.key,n??this.value,s??this.color,i??this.left,r??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let i=this;const r=s(e,i.key);return r<0?i=i.copy(null,null,null,i.left.insert(e,n,s),null):r===0?i=i.copy(null,n,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,n,s)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return qt.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let s,i;if(s=this,n(e,s.key)<0)!s.left.isEmpty()&&!s.left.isRed_()&&!s.left.left.isRed_()&&(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),!s.right.isEmpty()&&!s.right.isRed_()&&!s.right.left.isRed_()&&(s=s.moveRedRight_()),n(e,s.key)===0){if(s.right.isEmpty())return qt.EMPTY_NODE;i=s.right.min_(),s=s.copy(i.key,i.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,vt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,vt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}vt.RED=!0;vt.BLACK=!1;class dD{copy(e,n,s,i,r){return this}insert(e,n,s){return new vt(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class qt{constructor(e,n=qt.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new qt(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,vt.BLACK,null,null))}remove(e){return new qt(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,vt.BLACK,null,null))}get(e){let n,s=this.root_;for(;!s.isEmpty();){if(n=this.comparator_(e,s.key),n===0)return s.value;n<0?s=s.left:n>0&&(s=s.right)}return null}getPredecessorKey(e){let n,s=this.root_,i=null;for(;!s.isEmpty();)if(n=this.comparator_(e,s.key),n===0){if(s.left.isEmpty())return i?i.key:null;for(s=s.left;!s.right.isEmpty();)s=s.right;return s.key}else n<0?s=s.left:n>0&&(i=s,s=s.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Hc(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Hc(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Hc(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Hc(this.root_,null,this.comparator_,!0,e)}}qt.EMPTY_NODE=new dD;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fD(t,e){return Ar(t.name,e.name)}function t0(t,e){return Ar(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ym;function hD(t){Ym=t}const Ck=function(t){return typeof t=="number"?"number:"+ck(t):"string:"+t},jk=function(t){if(t.isLeafNode()){const e=t.val();z(typeof e=="string"||typeof e=="number"||typeof e=="object"&&zn(e,".sv"),"Priority must be a string or number.")}else z(t===Ym||t.isEmpty(),"priority of unexpected type.");z(t===Ym||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fx;class pt{static set __childrenNodeConstructor(e){Fx=e}static get __childrenNodeConstructor(){return Fx}constructor(e,n=pt.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,z(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),jk(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new pt(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:pt.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return fe(e)?this:ue(e)===".priority"?this.priorityNode_:pt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:pt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const s=ue(e);return s===null?n:n.isEmpty()&&s!==".priority"?this:(z(s!==".priority"||Ai(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(s,pt.__childrenNodeConstructor.EMPTY_NODE.updateChild(Me(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Ck(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=ck(this.value_):e+=this.value_,this.lazyHash_=ok(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===pt.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof pt.__childrenNodeConstructor?-1:(z(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,s=typeof this.value_,i=pt.VALUE_TYPE_ORDER.indexOf(n),r=pt.VALUE_TYPE_ORDER.indexOf(s);return z(i>=0,"Unknown leaf type: "+n),z(r>=0,"Unknown leaf type: "+s),i===r?s==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:r-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}pt.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ok,Mk;function mD(t){Ok=t}function pD(t){Mk=t}class gD extends tf{compare(e,n){const s=e.node.getPriority(),i=n.node.getPriority(),r=s.compareTo(i);return r===0?Ar(e.name,n.name):r}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return he.MIN}maxPost(){return new he(br,new pt("[PRIORITY-POST]",Mk))}makePost(e,n){const s=Ok(e);return new he(n,new pt("[PRIORITY-POST]",s))}toString(){return".priority"}}const qe=new gD;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vD=Math.log(2);class bD{constructor(e){const n=r=>parseInt(Math.log(r)/vD,10),s=r=>parseInt(Array(r+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const i=s(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const ad=function(t,e,n,s){t.sort(e);const i=function(l,u){const d=u-l;let f,h;if(d===0)return null;if(d===1)return f=t[l],h=n?n(f):f,new vt(h,f.node,vt.BLACK,null,null);{const m=parseInt(d/2,10)+l,v=i(l,m),b=i(m+1,u);return f=t[m],h=n?n(f):f,new vt(h,f.node,vt.BLACK,v,b)}},r=function(l){let u=null,d=null,f=t.length;const h=function(v,b){const y=f-v,p=f;f-=v;const g=i(y+1,p),x=t[y],w=n?n(x):x;m(new vt(w,x.node,b,null,g))},m=function(v){u?(u.left=v,u=v):(d=v,u=v)};for(let v=0;v<l.count;++v){const b=l.nextBitIsOne(),y=Math.pow(2,l.count-(v+1));b?h(y,vt.BLACK):(h(y,vt.BLACK),h(y,vt.RED))}return d},a=new bD(t.length),o=r(a);return new qt(s||e,o)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yh;const Mr={};class bs{static get Default(){return z(Mr&&qe,"ChildrenNode.ts has not been loaded"),yh=yh||new bs({".priority":Mr},{".priority":qe}),yh}constructor(e,n){this.indexes_=e,this.indexSet_=n}get(e){const n=mr(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof qt?n:null}hasIndex(e){return zn(this.indexSet_,e.toString())}addIndex(e,n){z(e!==ga,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const s=[];let i=!1;const r=n.getIterator(he.Wrap);let a=r.getNext();for(;a;)i=i||e.isDefinedOn(a.node),s.push(a),a=r.getNext();let o;i?o=ad(s,e.getCompare()):o=Mr;const l=e.toString(),u=Object.assign({},this.indexSet_);u[l]=e;const d=Object.assign({},this.indexes_);return d[l]=o,new bs(d,u)}addToIndexes(e,n){const s=Xu(this.indexes_,(i,r)=>{const a=mr(this.indexSet_,r);if(z(a,"Missing index implementation for "+r),i===Mr)if(a.isDefinedOn(e.node)){const o=[],l=n.getIterator(he.Wrap);let u=l.getNext();for(;u;)u.name!==e.name&&o.push(u),u=l.getNext();return o.push(e),ad(o,a.getCompare())}else return Mr;else{const o=n.get(e.name);let l=i;return o&&(l=l.remove(new he(e.name,o))),l.insert(e,e.node)}});return new bs(s,this.indexSet_)}removeFromIndexes(e,n){const s=Xu(this.indexes_,i=>{if(i===Mr)return i;{const r=n.get(e.name);return r?i.remove(new he(e.name,r)):i}});return new bs(s,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xo;class ne{static get EMPTY_NODE(){return xo||(xo=new ne(new qt(t0),null,bs.Default))}constructor(e,n,s){this.children_=e,this.priorityNode_=n,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&jk(this.priorityNode_),this.children_.isEmpty()&&z(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||xo}updatePriority(e){return this.children_.isEmpty()?this:new ne(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?xo:n}}getChild(e){const n=ue(e);return n===null?this:this.getImmediateChild(n).getChild(Me(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(z(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const s=new he(e,n);let i,r;n.isEmpty()?(i=this.children_.remove(e),r=this.indexMap_.removeFromIndexes(s,this.children_)):(i=this.children_.insert(e,n),r=this.indexMap_.addToIndexes(s,this.children_));const a=i.isEmpty()?xo:this.priorityNode_;return new ne(i,a,r)}}updateChild(e,n){const s=ue(e);if(s===null)return n;{z(ue(e)!==".priority"||Ai(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(s).updateChild(Me(e),n);return this.updateImmediateChild(s,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let s=0,i=0,r=!0;if(this.forEachChild(qe,(a,o)=>{n[a]=o.val(e),s++,r&&ne.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):r=!1}),!e&&r&&i<2*s){const a=[];for(const o in n)a[o]=n[o];return a}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+Ck(this.getPriority().val())+":"),this.forEachChild(qe,(n,s)=>{const i=s.hash();i!==""&&(e+=":"+n+":"+i)}),this.lazyHash_=e===""?"":ok(e)}return this.lazyHash_}getPredecessorChildName(e,n,s){const i=this.resolveIndex_(s);if(i){const r=i.getPredecessorKey(new he(e,n));return r?r.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.minKey();return s&&s.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new he(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.maxKey();return s&&s.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new he(n,this.children_.get(n)):null}forEachChild(e,n){const s=this.resolveIndex_(e);return s?s.inorderTraversal(i=>n(i.name,i.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,he.Wrap);let r=i.peek();for(;r!=null&&n.compare(r,e)<0;)i.getNext(),r=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,he.Wrap);let r=i.peek();for(;r!=null&&n.compare(r,e)>0;)i.getNext(),r=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===oc?-1:0}withIndex(e){if(e===ga||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new ne(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===ga||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const s=this.getIterator(qe),i=n.getIterator(qe);let r=s.getNext(),a=i.getNext();for(;r&&a;){if(r.name!==a.name||!r.node.equals(a.node))return!1;r=s.getNext(),a=i.getNext()}return r===null&&a===null}else return!1;else return!1}}resolveIndex_(e){return e===ga?null:this.indexMap_.get(e.toString())}}ne.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class xD extends ne{constructor(){super(new qt(t0),ne.EMPTY_NODE,bs.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ne.EMPTY_NODE}isEmpty(){return!1}}const oc=new xD;Object.defineProperties(he,{MIN:{value:new he(ja,ne.EMPTY_NODE)},MAX:{value:new he(br,oc)}});Ik.__EMPTY_NODE=ne.EMPTY_NODE;pt.__childrenNodeConstructor=ne;hD(oc);pD(oc);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yD=!0;function We(t,e=null){if(t===null)return ne.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),z(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new pt(n,We(e))}if(!(t instanceof Array)&&yD){const n=[];let s=!1;if(Et(t,(a,o)=>{if(a.substring(0,1)!=="."){const l=We(o);l.isEmpty()||(s=s||!l.getPriority().isEmpty(),n.push(new he(a,l)))}}),n.length===0)return ne.EMPTY_NODE;const r=ad(n,fD,a=>a.name,t0);if(s){const a=ad(n,qe.getCompare());return new ne(r,We(e),new bs({".priority":a},{".priority":qe}))}else return new ne(r,We(e),bs.Default)}else{let n=ne.EMPTY_NODE;return Et(t,(s,i)=>{if(zn(t,s)&&s.substring(0,1)!=="."){const r=We(i);(r.isLeafNode()||!r.isEmpty())&&(n=n.updateImmediateChild(s,r))}}),n.updatePriority(We(e))}}mD(We);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _D extends tf{constructor(e){super(),this.indexPath_=e,z(!fe(e)&&ue(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const s=this.extractChild(e.node),i=this.extractChild(n.node),r=s.compareTo(i);return r===0?Ar(e.name,n.name):r}makePost(e,n){const s=We(e),i=ne.EMPTY_NODE.updateChild(this.indexPath_,s);return new he(n,i)}maxPost(){const e=ne.EMPTY_NODE.updateChild(this.indexPath_,oc);return new he(br,e)}toString(){return Sl(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wD extends tf{compare(e,n){const s=e.node.compareTo(n.node);return s===0?Ar(e.name,n.name):s}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return he.MIN}maxPost(){return he.MAX}makePost(e,n){const s=We(e);return new he(n,s)}toString(){return".value"}}const ED=new wD;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dk(t){return{type:"value",snapshotNode:t}}function Oa(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Tl(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Al(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function ND(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n0{constructor(e){this.index_=e}updateChild(e,n,s,i,r,a){z(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const o=e.getImmediateChild(n);return o.getChild(i).equals(s.getChild(i))&&o.isEmpty()===s.isEmpty()||(a!=null&&(s.isEmpty()?e.hasChild(n)?a.trackChildChange(Tl(n,o)):z(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?a.trackChildChange(Oa(n,s)):a.trackChildChange(Al(n,s,o))),e.isLeafNode()&&s.isEmpty())?e:e.updateImmediateChild(n,s).withIndex(this.index_)}updateFullNode(e,n,s){return s!=null&&(e.isLeafNode()||e.forEachChild(qe,(i,r)=>{n.hasChild(i)||s.trackChildChange(Tl(i,r))}),n.isLeafNode()||n.forEachChild(qe,(i,r)=>{if(e.hasChild(i)){const a=e.getImmediateChild(i);a.equals(r)||s.trackChildChange(Al(i,r,a))}else s.trackChildChange(Oa(i,r))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?ne.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rl{constructor(e){this.indexedFilter_=new n0(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Rl.getStartPost_(e),this.endPost_=Rl.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,s=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&s}updateChild(e,n,s,i,r,a){return this.matches(new he(n,s))||(s=ne.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,s,i,r,a)}updateFullNode(e,n,s){n.isLeafNode()&&(n=ne.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(ne.EMPTY_NODE);const r=this;return n.forEachChild(qe,(a,o)=>{r.matches(new he(a,o))||(i=i.updateImmediateChild(a,ne.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kD{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const s=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?s<=0:s<0},this.withinEndPost=n=>{const s=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?s<=0:s<0},this.rangedFilter_=new Rl(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,s,i,r,a){return this.rangedFilter_.matches(new he(n,s))||(s=ne.EMPTY_NODE),e.getImmediateChild(n).equals(s)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,s,i,r,a):this.fullLimitUpdateChild_(e,n,s,r,a)}updateFullNode(e,n,s){let i;if(n.isLeafNode()||n.isEmpty())i=ne.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=ne.EMPTY_NODE.withIndex(this.index_);let r;this.reverse_?r=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):r=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let a=0;for(;r.hasNext()&&a<this.limit_;){const o=r.getNext();if(this.withinDirectionalStart(o))if(this.withinDirectionalEnd(o))i=i.updateImmediateChild(o.name,o.node),a++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(ne.EMPTY_NODE);let r;this.reverse_?r=i.getReverseIterator(this.index_):r=i.getIterator(this.index_);let a=0;for(;r.hasNext();){const o=r.getNext();a<this.limit_&&this.withinDirectionalStart(o)&&this.withinDirectionalEnd(o)?a++:i=i.updateImmediateChild(o.name,ne.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,s,i,r){let a;if(this.reverse_){const f=this.index_.getCompare();a=(h,m)=>f(m,h)}else a=this.index_.getCompare();const o=e;z(o.numChildren()===this.limit_,"");const l=new he(n,s),u=this.reverse_?o.getFirstChild(this.index_):o.getLastChild(this.index_),d=this.rangedFilter_.matches(l);if(o.hasChild(n)){const f=o.getImmediateChild(n);let h=i.getChildAfterChild(this.index_,u,this.reverse_);for(;h!=null&&(h.name===n||o.hasChild(h.name));)h=i.getChildAfterChild(this.index_,h,this.reverse_);const m=h==null?1:a(h,l);if(d&&!s.isEmpty()&&m>=0)return r!=null&&r.trackChildChange(Al(n,s,f)),o.updateImmediateChild(n,s);{r!=null&&r.trackChildChange(Tl(n,f));const b=o.updateImmediateChild(n,ne.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(r!=null&&r.trackChildChange(Oa(h.name,h.node)),b.updateImmediateChild(h.name,h.node)):b}}else return s.isEmpty()?e:d&&a(u,l)>=0?(r!=null&&(r.trackChildChange(Tl(u.name,u.node)),r.trackChildChange(Oa(n,s))),o.updateImmediateChild(n,s).updateImmediateChild(u.name,ne.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s0{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=qe}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return z(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return z(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ja}hasEnd(){return this.endSet_}getIndexEndValue(){return z(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return z(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:br}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return z(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===qe}copy(){const e=new s0;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function SD(t){return t.loadsAllData()?new n0(t.getIndex()):t.hasLimit()?new kD(t):new Rl(t)}function TD(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function zx(t){const e={};if(t.isDefault())return e;let n;if(t.index_===qe?n="$priority":t.index_===ED?n="$value":t.index_===ga?n="$key":(z(t.index_ instanceof _D,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=ht(n),t.startSet_){const s=t.startAfterSet_?"startAfter":"startAt";e[s]=ht(t.indexStartValue_),t.startNameSet_&&(e[s]+=","+ht(t.indexStartName_))}if(t.endSet_){const s=t.endBeforeSet_?"endBefore":"endAt";e[s]=ht(t.indexEndValue_),t.endNameSet_&&(e[s]+=","+ht(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function $x(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==qe&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od extends Sk{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(z(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,n,s,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=s,this.appCheckTokenProvider_=i,this.log_=ac("p:rest:"),this.listens_={}}listen(e,n,s,i){const r=e._path.toString();this.log_("Listen called for "+r+" "+e._queryIdentifier);const a=od.getListenId_(e,s),o={};this.listens_[a]=o;const l=zx(e._queryParams);this.restRequest_(r+".json",l,(u,d)=>{let f=d;if(u===404&&(f=null,u=null),u===null&&this.onDataUpdate_(r,f,!1,s),mr(this.listens_,a)===o){let h;u?u===401?h="permission_denied":h="rest_error:"+u:h="ok",i(h,null)}})}unlisten(e,n){const s=od.getListenId_(e,n);delete this.listens_[s]}get(e){const n=zx(e._queryParams),s=e._path.toString(),i=new Pn;return this.restRequest_(s+".json",n,(r,a)=>{let o=a;r===404&&(o=null,r=null),r===null?(this.onDataUpdate_(s,o,!1,null),i.resolve(o)):i.reject(new Error(o))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},s){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,r])=>{i&&i.accessToken&&(n.auth=i.accessToken),r&&r.token&&(n.ac=r.token);const a=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+eo(n);this.log_("Sending REST request for "+a);const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(s&&o.readyState===4){this.log_("REST Response for "+a+" received. status:",o.status,"response:",o.responseText);let l=null;if(o.status>=200&&o.status<300){try{l=yl(o.responseText)}catch{Ht("Failed to parse JSON response for "+a+": "+o.responseText)}s(null,l)}else o.status!==401&&o.status!==404&&Ht("Got unsuccessful REST response for "+a+" Status: "+o.status),s(o.status);s=null}},o.open("GET",a,!0),o.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AD{constructor(){this.rootNode_=ne.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ld(){return{value:null,children:new Map}}function so(t,e,n){if(fe(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const s=ue(e);t.children.has(s)||t.children.set(s,ld());const i=t.children.get(s);e=Me(e),so(i,e,n)}}function qm(t,e){if(fe(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(qe,(s,i)=>{so(t,new Ie(s),i)}),qm(t,e)}}else if(t.children.size>0){const n=ue(e);return e=Me(e),t.children.has(n)&&qm(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function Wm(t,e,n){t.value!==null?n(e,t.value):RD(t,(s,i)=>{const r=new Ie(e.toString()+"/"+s);Wm(i,r,n)})}function RD(t,e){t.children.forEach((n,s)=>{e(s,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ID{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&Et(this.last_,(s,i)=>{n[s]=n[s]-i}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kx=10*1e3,CD=30*1e3,jD=5*60*1e3;class OD{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new ID(e);const s=Kx+(CD-Kx)*Math.random();Xo(this.reportStats_.bind(this),Math.floor(s))}reportStats_(){const e=this.statsListener_.get(),n={};let s=!1;Et(e,(i,r)=>{r>0&&zn(this.statsToReport_,i)&&(n[i]=r,s=!0)}),s&&this.server_.reportStats(n),Xo(this.reportStats_.bind(this),Math.floor(Math.random()*2*jD))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Hn;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Hn||(Hn={}));function i0(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function r0(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function a0(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cd{constructor(e,n,s){this.path=e,this.affectedTree=n,this.revert=s,this.type=Hn.ACK_USER_WRITE,this.source=i0()}operationForChild(e){if(fe(this.path)){if(this.affectedTree.value!=null)return z(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Ie(e));return new cd(we(),n,this.revert)}}else return z(ue(this.path)===e,"operationForChild called for unrelated child."),new cd(Me(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Il{constructor(e,n){this.source=e,this.path=n,this.type=Hn.LISTEN_COMPLETE}operationForChild(e){return fe(this.path)?new Il(this.source,we()):new Il(this.source,Me(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr{constructor(e,n,s){this.source=e,this.path=n,this.snap=s,this.type=Hn.OVERWRITE}operationForChild(e){return fe(this.path)?new xr(this.source,we(),this.snap.getImmediateChild(e)):new xr(this.source,Me(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{constructor(e,n,s){this.source=e,this.path=n,this.children=s,this.type=Hn.MERGE}operationForChild(e){if(fe(this.path)){const n=this.children.subtree(new Ie(e));return n.isEmpty()?null:n.value?new xr(this.source,we(),n.value):new Ma(this.source,we(),n)}else return z(ue(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Ma(this.source,Me(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(e,n,s){this.node_=e,this.fullyInitialized_=n,this.filtered_=s}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(fe(e))return this.isFullyInitialized()&&!this.filtered_;const n=ue(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MD{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function DD(t,e,n,s){const i=[],r=[];return e.forEach(a=>{a.type==="child_changed"&&t.index_.indexedValueChanged(a.oldSnap,a.snapshotNode)&&r.push(ND(a.childName,a.snapshotNode))}),yo(t,i,"child_removed",e,s,n),yo(t,i,"child_added",e,s,n),yo(t,i,"child_moved",r,s,n),yo(t,i,"child_changed",e,s,n),yo(t,i,"value",e,s,n),i}function yo(t,e,n,s,i,r){const a=s.filter(o=>o.type===n);a.sort((o,l)=>PD(t,o,l)),a.forEach(o=>{const l=LD(t,o,r);i.forEach(u=>{u.respondsTo(o.type)&&e.push(u.createEvent(l,t.query_))})})}function LD(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function PD(t,e,n){if(e.childName==null||n.childName==null)throw Ja("Should only compare child_ events.");const s=new he(e.childName,e.snapshotNode),i=new he(n.childName,n.snapshotNode);return t.index_.compare(s,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nf(t,e){return{eventCache:t,serverCache:e}}function Qo(t,e,n,s){return nf(new Ri(e,n,s),t.serverCache)}function Lk(t,e,n,s){return nf(t.eventCache,new Ri(e,n,s))}function ud(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function yr(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _h;const BD=()=>(_h||(_h=new qt(_M)),_h);class Pe{static fromObject(e){let n=new Pe(null);return Et(e,(s,i)=>{n=n.set(new Ie(s),i)}),n}constructor(e,n=BD()){this.value=e,this.children=n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:we(),value:this.value};if(fe(e))return null;{const s=ue(e),i=this.children.get(s);if(i!==null){const r=i.findRootMostMatchingPathAndValue(Me(e),n);return r!=null?{path:Xe(new Ie(s),r.path),value:r.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(fe(e))return this;{const n=ue(e),s=this.children.get(n);return s!==null?s.subtree(Me(e)):new Pe(null)}}set(e,n){if(fe(e))return new Pe(n,this.children);{const s=ue(e),r=(this.children.get(s)||new Pe(null)).set(Me(e),n),a=this.children.insert(s,r);return new Pe(this.value,a)}}remove(e){if(fe(e))return this.children.isEmpty()?new Pe(null):new Pe(null,this.children);{const n=ue(e),s=this.children.get(n);if(s){const i=s.remove(Me(e));let r;return i.isEmpty()?r=this.children.remove(n):r=this.children.insert(n,i),this.value===null&&r.isEmpty()?new Pe(null):new Pe(this.value,r)}else return this}}get(e){if(fe(e))return this.value;{const n=ue(e),s=this.children.get(n);return s?s.get(Me(e)):null}}setTree(e,n){if(fe(e))return n;{const s=ue(e),r=(this.children.get(s)||new Pe(null)).setTree(Me(e),n);let a;return r.isEmpty()?a=this.children.remove(s):a=this.children.insert(s,r),new Pe(this.value,a)}}fold(e){return this.fold_(we(),e)}fold_(e,n){const s={};return this.children.inorderTraversal((i,r)=>{s[i]=r.fold_(Xe(e,i),n)}),n(e,this.value,s)}findOnPath(e,n){return this.findOnPath_(e,we(),n)}findOnPath_(e,n,s){const i=this.value?s(n,this.value):!1;if(i)return i;if(fe(e))return null;{const r=ue(e),a=this.children.get(r);return a?a.findOnPath_(Me(e),Xe(n,r),s):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,we(),n)}foreachOnPath_(e,n,s){if(fe(e))return this;{this.value&&s(n,this.value);const i=ue(e),r=this.children.get(i);return r?r.foreachOnPath_(Me(e),Xe(n,i),s):new Pe(null)}}foreach(e){this.foreach_(we(),e)}foreach_(e,n){this.children.inorderTraversal((s,i)=>{i.foreach_(Xe(e,s),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,s)=>{s.value&&e(n,s.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e){this.writeTree_=e}static empty(){return new Gn(new Pe(null))}}function Jo(t,e,n){if(fe(e))return new Gn(new Pe(n));{const s=t.writeTree_.findRootMostValueAndPath(e);if(s!=null){const i=s.path;let r=s.value;const a=Bt(i,e);return r=r.updateChild(a,n),new Gn(t.writeTree_.set(i,r))}else{const i=new Pe(n),r=t.writeTree_.setTree(e,i);return new Gn(r)}}}function Xm(t,e,n){let s=t;return Et(n,(i,r)=>{s=Jo(s,Xe(e,i),r)}),s}function Yx(t,e){if(fe(e))return Gn.empty();{const n=t.writeTree_.setTree(e,new Pe(null));return new Gn(n)}}function Qm(t,e){return Rr(t,e)!=null}function Rr(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Bt(n.path,e)):null}function qx(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(qe,(s,i)=>{e.push(new he(s,i))}):t.writeTree_.children.inorderTraversal((s,i)=>{i.value!=null&&e.push(new he(s,i.value))}),e}function yi(t,e){if(fe(e))return t;{const n=Rr(t,e);return n!=null?new Gn(new Pe(n)):new Gn(t.writeTree_.subtree(e))}}function Jm(t){return t.writeTree_.isEmpty()}function Da(t,e){return Pk(we(),t.writeTree_,e)}function Pk(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let s=null;return e.children.inorderTraversal((i,r)=>{i===".priority"?(z(r.value!==null,"Priority writes must always be leaf nodes"),s=r.value):n=Pk(Xe(t,i),r,n)}),!n.getChild(t).isEmpty()&&s!==null&&(n=n.updateChild(Xe(t,".priority"),s)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sf(t,e){return Gk(e,t)}function UD(t,e,n,s,i){z(s>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:s,visible:i}),i&&(t.visibleWrites=Jo(t.visibleWrites,e,n)),t.lastWriteId=s}function HD(t,e,n,s){z(s>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:s,visible:!0}),t.visibleWrites=Xm(t.visibleWrites,e,n),t.lastWriteId=s}function GD(t,e){for(let n=0;n<t.allWrites.length;n++){const s=t.allWrites[n];if(s.writeId===e)return s}return null}function VD(t,e){const n=t.allWrites.findIndex(o=>o.writeId===e);z(n>=0,"removeWrite called with nonexistent writeId.");const s=t.allWrites[n];t.allWrites.splice(n,1);let i=s.visible,r=!1,a=t.allWrites.length-1;for(;i&&a>=0;){const o=t.allWrites[a];o.visible&&(a>=n&&FD(o,s.path)?i=!1:kn(s.path,o.path)&&(r=!0)),a--}if(i){if(r)return zD(t),!0;if(s.snap)t.visibleWrites=Yx(t.visibleWrites,s.path);else{const o=s.children;Et(o,l=>{t.visibleWrites=Yx(t.visibleWrites,Xe(s.path,l))})}return!0}else return!1}function FD(t,e){if(t.snap)return kn(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&kn(Xe(t.path,n),e))return!0;return!1}function zD(t){t.visibleWrites=Bk(t.allWrites,$D,we()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function $D(t){return t.visible}function Bk(t,e,n){let s=Gn.empty();for(let i=0;i<t.length;++i){const r=t[i];if(e(r)){const a=r.path;let o;if(r.snap)kn(n,a)?(o=Bt(n,a),s=Jo(s,o,r.snap)):kn(a,n)&&(o=Bt(a,n),s=Jo(s,we(),r.snap.getChild(o)));else if(r.children){if(kn(n,a))o=Bt(n,a),s=Xm(s,o,r.children);else if(kn(a,n))if(o=Bt(a,n),fe(o))s=Xm(s,we(),r.children);else{const l=mr(r.children,ue(o));if(l){const u=l.getChild(Me(o));s=Jo(s,we(),u)}}}else throw Ja("WriteRecord should have .snap or .children")}}return s}function Uk(t,e,n,s,i){if(!s&&!i){const r=Rr(t.visibleWrites,e);if(r!=null)return r;{const a=yi(t.visibleWrites,e);if(Jm(a))return n;if(n==null&&!Qm(a,we()))return null;{const o=n||ne.EMPTY_NODE;return Da(a,o)}}}else{const r=yi(t.visibleWrites,e);if(!i&&Jm(r))return n;if(!i&&n==null&&!Qm(r,we()))return null;{const a=function(u){return(u.visible||i)&&(!s||!~s.indexOf(u.writeId))&&(kn(u.path,e)||kn(e,u.path))},o=Bk(t.allWrites,a,e),l=n||ne.EMPTY_NODE;return Da(o,l)}}}function KD(t,e,n){let s=ne.EMPTY_NODE;const i=Rr(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(qe,(r,a)=>{s=s.updateImmediateChild(r,a)}),s;if(n){const r=yi(t.visibleWrites,e);return n.forEachChild(qe,(a,o)=>{const l=Da(yi(r,new Ie(a)),o);s=s.updateImmediateChild(a,l)}),qx(r).forEach(a=>{s=s.updateImmediateChild(a.name,a.node)}),s}else{const r=yi(t.visibleWrites,e);return qx(r).forEach(a=>{s=s.updateImmediateChild(a.name,a.node)}),s}}function YD(t,e,n,s,i){z(s||i,"Either existingEventSnap or existingServerSnap must exist");const r=Xe(e,n);if(Qm(t.visibleWrites,r))return null;{const a=yi(t.visibleWrites,r);return Jm(a)?i.getChild(n):Da(a,i.getChild(n))}}function qD(t,e,n,s){const i=Xe(e,n),r=Rr(t.visibleWrites,i);if(r!=null)return r;if(s.isCompleteForChild(n)){const a=yi(t.visibleWrites,i);return Da(a,s.getNode().getImmediateChild(n))}else return null}function WD(t,e){return Rr(t.visibleWrites,e)}function XD(t,e,n,s,i,r,a){let o;const l=yi(t.visibleWrites,e),u=Rr(l,we());if(u!=null)o=u;else if(n!=null)o=Da(l,n);else return[];if(o=o.withIndex(a),!o.isEmpty()&&!o.isLeafNode()){const d=[],f=a.getCompare(),h=r?o.getReverseIteratorFrom(s,a):o.getIteratorFrom(s,a);let m=h.getNext();for(;m&&d.length<i;)f(m,s)!==0&&d.push(m),m=h.getNext();return d}else return[]}function QD(){return{visibleWrites:Gn.empty(),allWrites:[],lastWriteId:-1}}function dd(t,e,n,s){return Uk(t.writeTree,t.treePath,e,n,s)}function o0(t,e){return KD(t.writeTree,t.treePath,e)}function Wx(t,e,n,s){return YD(t.writeTree,t.treePath,e,n,s)}function fd(t,e){return WD(t.writeTree,Xe(t.treePath,e))}function JD(t,e,n,s,i,r){return XD(t.writeTree,t.treePath,e,n,s,i,r)}function l0(t,e,n){return qD(t.writeTree,t.treePath,e,n)}function Hk(t,e){return Gk(Xe(t.treePath,e),t.writeTree)}function Gk(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZD{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,s=e.childName;z(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),z(s!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(s);if(i){const r=i.type;if(n==="child_added"&&r==="child_removed")this.changeMap.set(s,Al(s,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&r==="child_added")this.changeMap.delete(s);else if(n==="child_removed"&&r==="child_changed")this.changeMap.set(s,Tl(s,i.oldSnap));else if(n==="child_changed"&&r==="child_added")this.changeMap.set(s,Oa(s,e.snapshotNode));else if(n==="child_changed"&&r==="child_changed")this.changeMap.set(s,Al(s,e.snapshotNode,i.oldSnap));else throw Ja("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(s,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL{getCompleteChild(e){return null}getChildAfterChild(e,n,s){return null}}const Vk=new eL;class c0{constructor(e,n,s=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=s}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const s=this.optCompleteServerCache_!=null?new Ri(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return l0(this.writes_,e,s)}}getChildAfterChild(e,n,s){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:yr(this.viewCache_),r=JD(this.writes_,i,n,1,s,e);return r.length===0?null:r[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tL(t){return{filter:t}}function nL(t,e){z(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),z(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function sL(t,e,n,s,i){const r=new ZD;let a,o;if(n.type===Hn.OVERWRITE){const u=n;u.source.fromUser?a=Zm(t,e,u.path,u.snap,s,i,r):(z(u.source.fromServer,"Unknown source."),o=u.source.tagged||e.serverCache.isFiltered()&&!fe(u.path),a=hd(t,e,u.path,u.snap,s,i,o,r))}else if(n.type===Hn.MERGE){const u=n;u.source.fromUser?a=rL(t,e,u.path,u.children,s,i,r):(z(u.source.fromServer,"Unknown source."),o=u.source.tagged||e.serverCache.isFiltered(),a=ep(t,e,u.path,u.children,s,i,o,r))}else if(n.type===Hn.ACK_USER_WRITE){const u=n;u.revert?a=lL(t,e,u.path,s,i,r):a=aL(t,e,u.path,u.affectedTree,s,i,r)}else if(n.type===Hn.LISTEN_COMPLETE)a=oL(t,e,n.path,s,r);else throw Ja("Unknown operation type: "+n.type);const l=r.getChanges();return iL(e,a,l),{viewCache:a,changes:l}}function iL(t,e,n){const s=e.eventCache;if(s.isFullyInitialized()){const i=s.getNode().isLeafNode()||s.getNode().isEmpty(),r=ud(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!s.getNode().equals(r)||!s.getNode().getPriority().equals(r.getPriority()))&&n.push(Dk(ud(e)))}}function Fk(t,e,n,s,i,r){const a=e.eventCache;if(fd(s,n)!=null)return e;{let o,l;if(fe(n))if(z(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const u=yr(e),d=u instanceof ne?u:ne.EMPTY_NODE,f=o0(s,d);o=t.filter.updateFullNode(e.eventCache.getNode(),f,r)}else{const u=dd(s,yr(e));o=t.filter.updateFullNode(e.eventCache.getNode(),u,r)}else{const u=ue(n);if(u===".priority"){z(Ai(n)===1,"Can't have a priority with additional path components");const d=a.getNode();l=e.serverCache.getNode();const f=Wx(s,n,d,l);f!=null?o=t.filter.updatePriority(d,f):o=a.getNode()}else{const d=Me(n);let f;if(a.isCompleteForChild(u)){l=e.serverCache.getNode();const h=Wx(s,n,a.getNode(),l);h!=null?f=a.getNode().getImmediateChild(u).updateChild(d,h):f=a.getNode().getImmediateChild(u)}else f=l0(s,u,e.serverCache);f!=null?o=t.filter.updateChild(a.getNode(),u,f,d,i,r):o=a.getNode()}}return Qo(e,o,a.isFullyInitialized()||fe(n),t.filter.filtersNodes())}}function hd(t,e,n,s,i,r,a,o){const l=e.serverCache;let u;const d=a?t.filter:t.filter.getIndexedFilter();if(fe(n))u=d.updateFullNode(l.getNode(),s,null);else if(d.filtersNodes()&&!l.isFiltered()){const m=l.getNode().updateChild(n,s);u=d.updateFullNode(l.getNode(),m,null)}else{const m=ue(n);if(!l.isCompleteForPath(n)&&Ai(n)>1)return e;const v=Me(n),y=l.getNode().getImmediateChild(m).updateChild(v,s);m===".priority"?u=d.updatePriority(l.getNode(),y):u=d.updateChild(l.getNode(),m,y,v,Vk,null)}const f=Lk(e,u,l.isFullyInitialized()||fe(n),d.filtersNodes()),h=new c0(i,f,r);return Fk(t,f,n,i,h,o)}function Zm(t,e,n,s,i,r,a){const o=e.eventCache;let l,u;const d=new c0(i,e,r);if(fe(n))u=t.filter.updateFullNode(e.eventCache.getNode(),s,a),l=Qo(e,u,!0,t.filter.filtersNodes());else{const f=ue(n);if(f===".priority")u=t.filter.updatePriority(e.eventCache.getNode(),s),l=Qo(e,u,o.isFullyInitialized(),o.isFiltered());else{const h=Me(n),m=o.getNode().getImmediateChild(f);let v;if(fe(h))v=s;else{const b=d.getCompleteChild(f);b!=null?Jg(h)===".priority"&&b.getChild(Ak(h)).isEmpty()?v=b:v=b.updateChild(h,s):v=ne.EMPTY_NODE}if(m.equals(v))l=e;else{const b=t.filter.updateChild(o.getNode(),f,v,h,d,a);l=Qo(e,b,o.isFullyInitialized(),t.filter.filtersNodes())}}}return l}function Xx(t,e){return t.eventCache.isCompleteForChild(e)}function rL(t,e,n,s,i,r,a){let o=e;return s.foreach((l,u)=>{const d=Xe(n,l);Xx(e,ue(d))&&(o=Zm(t,o,d,u,i,r,a))}),s.foreach((l,u)=>{const d=Xe(n,l);Xx(e,ue(d))||(o=Zm(t,o,d,u,i,r,a))}),o}function Qx(t,e,n){return n.foreach((s,i)=>{e=e.updateChild(s,i)}),e}function ep(t,e,n,s,i,r,a,o){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,u;fe(n)?u=s:u=new Pe(null).setTree(n,s);const d=e.serverCache.getNode();return u.children.inorderTraversal((f,h)=>{if(d.hasChild(f)){const m=e.serverCache.getNode().getImmediateChild(f),v=Qx(t,m,h);l=hd(t,l,new Ie(f),v,i,r,a,o)}}),u.children.inorderTraversal((f,h)=>{const m=!e.serverCache.isCompleteForChild(f)&&h.value===null;if(!d.hasChild(f)&&!m){const v=e.serverCache.getNode().getImmediateChild(f),b=Qx(t,v,h);l=hd(t,l,new Ie(f),b,i,r,a,o)}}),l}function aL(t,e,n,s,i,r,a){if(fd(i,n)!=null)return e;const o=e.serverCache.isFiltered(),l=e.serverCache;if(s.value!=null){if(fe(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return hd(t,e,n,l.getNode().getChild(n),i,r,o,a);if(fe(n)){let u=new Pe(null);return l.getNode().forEachChild(ga,(d,f)=>{u=u.set(new Ie(d),f)}),ep(t,e,n,u,i,r,o,a)}else return e}else{let u=new Pe(null);return s.foreach((d,f)=>{const h=Xe(n,d);l.isCompleteForPath(h)&&(u=u.set(d,l.getNode().getChild(h)))}),ep(t,e,n,u,i,r,o,a)}}function oL(t,e,n,s,i){const r=e.serverCache,a=Lk(e,r.getNode(),r.isFullyInitialized()||fe(n),r.isFiltered());return Fk(t,a,n,s,Vk,i)}function lL(t,e,n,s,i,r){let a;if(fd(s,n)!=null)return e;{const o=new c0(s,e,i),l=e.eventCache.getNode();let u;if(fe(n)||ue(n)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=dd(s,yr(e));else{const f=e.serverCache.getNode();z(f instanceof ne,"serverChildren would be complete if leaf node"),d=o0(s,f)}d=d,u=t.filter.updateFullNode(l,d,r)}else{const d=ue(n);let f=l0(s,d,e.serverCache);f==null&&e.serverCache.isCompleteForChild(d)&&(f=l.getImmediateChild(d)),f!=null?u=t.filter.updateChild(l,d,f,Me(n),o,r):e.eventCache.getNode().hasChild(d)?u=t.filter.updateChild(l,d,ne.EMPTY_NODE,Me(n),o,r):u=l,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(a=dd(s,yr(e)),a.isLeafNode()&&(u=t.filter.updateFullNode(u,a,r)))}return a=e.serverCache.isFullyInitialized()||fd(s,we())!=null,Qo(e,u,a,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cL{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const s=this.query_._queryParams,i=new n0(s.getIndex()),r=SD(s);this.processor_=tL(r);const a=n.serverCache,o=n.eventCache,l=i.updateFullNode(ne.EMPTY_NODE,a.getNode(),null),u=r.updateFullNode(ne.EMPTY_NODE,o.getNode(),null),d=new Ri(l,a.isFullyInitialized(),i.filtersNodes()),f=new Ri(u,o.isFullyInitialized(),r.filtersNodes());this.viewCache_=nf(f,d),this.eventGenerator_=new MD(this.query_)}get query(){return this.query_}}function uL(t){return t.viewCache_.serverCache.getNode()}function dL(t){return ud(t.viewCache_)}function fL(t,e){const n=yr(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!fe(e)&&!n.getImmediateChild(ue(e)).isEmpty())?n.getChild(e):null}function Jx(t){return t.eventRegistrations_.length===0}function hL(t,e){t.eventRegistrations_.push(e)}function Zx(t,e,n){const s=[];if(n){z(e==null,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach(r=>{const a=r.createCancelEvent(n,i);a&&s.push(a)})}if(e){let i=[];for(let r=0;r<t.eventRegistrations_.length;++r){const a=t.eventRegistrations_[r];if(!a.matches(e))i.push(a);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(r+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return s}function ey(t,e,n,s){e.type===Hn.MERGE&&e.source.queryId!==null&&(z(yr(t.viewCache_),"We should always have a full cache before handling merges"),z(ud(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,r=sL(t.processor_,i,e,n,s);return nL(t.processor_,r.viewCache),z(r.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=r.viewCache,zk(t,r.changes,r.viewCache.eventCache.getNode(),null)}function mL(t,e){const n=t.viewCache_.eventCache,s=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(qe,(r,a)=>{s.push(Oa(r,a))}),n.isFullyInitialized()&&s.push(Dk(n.getNode())),zk(t,s,n.getNode(),e)}function zk(t,e,n,s){const i=s?[s]:t.eventRegistrations_;return DD(t.eventGenerator_,e,n,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let md;class $k{constructor(){this.views=new Map}}function pL(t){z(!md,"__referenceConstructor has already been defined"),md=t}function gL(){return z(md,"Reference.ts has not been loaded"),md}function vL(t){return t.views.size===0}function u0(t,e,n,s){const i=e.source.queryId;if(i!==null){const r=t.views.get(i);return z(r!=null,"SyncTree gave us an op for an invalid query."),ey(r,e,n,s)}else{let r=[];for(const a of t.views.values())r=r.concat(ey(a,e,n,s));return r}}function Kk(t,e,n,s,i){const r=e._queryIdentifier,a=t.views.get(r);if(!a){let o=dd(n,i?s:null),l=!1;o?l=!0:s instanceof ne?(o=o0(n,s),l=!1):(o=ne.EMPTY_NODE,l=!1);const u=nf(new Ri(o,l,!1),new Ri(s,i,!1));return new cL(e,u)}return a}function bL(t,e,n,s,i,r){const a=Kk(t,e,s,i,r);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,a),hL(a,n),mL(a,n)}function xL(t,e,n,s){const i=e._queryIdentifier,r=[];let a=[];const o=Ii(t);if(i==="default")for(const[l,u]of t.views.entries())a=a.concat(Zx(u,n,s)),Jx(u)&&(t.views.delete(l),u.query._queryParams.loadsAllData()||r.push(u.query));else{const l=t.views.get(i);l&&(a=a.concat(Zx(l,n,s)),Jx(l)&&(t.views.delete(i),l.query._queryParams.loadsAllData()||r.push(l.query)))}return o&&!Ii(t)&&r.push(new(gL())(e._repo,e._path)),{removed:r,events:a}}function Yk(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function _i(t,e){let n=null;for(const s of t.views.values())n=n||fL(s,e);return n}function qk(t,e){if(e._queryParams.loadsAllData())return rf(t);{const s=e._queryIdentifier;return t.views.get(s)}}function Wk(t,e){return qk(t,e)!=null}function Ii(t){return rf(t)!=null}function rf(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pd;function yL(t){z(!pd,"__referenceConstructor has already been defined"),pd=t}function _L(){return z(pd,"Reference.ts has not been loaded"),pd}let wL=1;class ty{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Pe(null),this.pendingWriteTree_=QD(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function d0(t,e,n,s,i){return UD(t.pendingWriteTree_,e,n,s,i),i?io(t,new xr(i0(),e,n)):[]}function EL(t,e,n,s){HD(t.pendingWriteTree_,e,n,s);const i=Pe.fromObject(n);return io(t,new Ma(i0(),e,i))}function ai(t,e,n=!1){const s=GD(t.pendingWriteTree_,e);if(VD(t.pendingWriteTree_,e)){let r=new Pe(null);return s.snap!=null?r=r.set(we(),!0):Et(s.children,a=>{r=r.set(new Ie(a),!0)}),io(t,new cd(s.path,r,n))}else return[]}function lc(t,e,n){return io(t,new xr(r0(),e,n))}function NL(t,e,n){const s=Pe.fromObject(n);return io(t,new Ma(r0(),e,s))}function kL(t,e){return io(t,new Il(r0(),e))}function SL(t,e,n){const s=f0(t,n);if(s){const i=h0(s),r=i.path,a=i.queryId,o=Bt(r,e),l=new Il(a0(a),o);return m0(t,r,l)}else return[]}function gd(t,e,n,s,i=!1){const r=e._path,a=t.syncPointTree_.get(r);let o=[];if(a&&(e._queryIdentifier==="default"||Wk(a,e))){const l=xL(a,e,n,s);vL(a)&&(t.syncPointTree_=t.syncPointTree_.remove(r));const u=l.removed;if(o=l.events,!i){const d=u.findIndex(h=>h._queryParams.loadsAllData())!==-1,f=t.syncPointTree_.findOnPath(r,(h,m)=>Ii(m));if(d&&!f){const h=t.syncPointTree_.subtree(r);if(!h.isEmpty()){const m=RL(h);for(let v=0;v<m.length;++v){const b=m[v],y=b.query,p=Zk(t,b);t.listenProvider_.startListening(Zo(y),Cl(t,y),p.hashFn,p.onComplete)}}}!f&&u.length>0&&!s&&(d?t.listenProvider_.stopListening(Zo(e),null):u.forEach(h=>{const m=t.queryToTagMap.get(of(h));t.listenProvider_.stopListening(Zo(h),m)}))}IL(t,u)}return o}function Xk(t,e,n,s){const i=f0(t,s);if(i!=null){const r=h0(i),a=r.path,o=r.queryId,l=Bt(a,e),u=new xr(a0(o),l,n);return m0(t,a,u)}else return[]}function TL(t,e,n,s){const i=f0(t,s);if(i){const r=h0(i),a=r.path,o=r.queryId,l=Bt(a,e),u=Pe.fromObject(n),d=new Ma(a0(o),l,u);return m0(t,a,d)}else return[]}function tp(t,e,n,s=!1){const i=e._path;let r=null,a=!1;t.syncPointTree_.foreachOnPath(i,(h,m)=>{const v=Bt(h,i);r=r||_i(m,v),a=a||Ii(m)});let o=t.syncPointTree_.get(i);o?(a=a||Ii(o),r=r||_i(o,we())):(o=new $k,t.syncPointTree_=t.syncPointTree_.set(i,o));let l;r!=null?l=!0:(l=!1,r=ne.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((m,v)=>{const b=_i(v,we());b&&(r=r.updateImmediateChild(m,b))}));const u=Wk(o,e);if(!u&&!e._queryParams.loadsAllData()){const h=of(e);z(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");const m=CL();t.queryToTagMap.set(h,m),t.tagToQueryMap.set(m,h)}const d=sf(t.pendingWriteTree_,i);let f=bL(o,e,n,d,r,l);if(!u&&!a&&!s){const h=qk(o,e);f=f.concat(jL(t,e,h))}return f}function af(t,e,n){const i=t.pendingWriteTree_,r=t.syncPointTree_.findOnPath(e,(a,o)=>{const l=Bt(a,e),u=_i(o,l);if(u)return u});return Uk(i,e,r,n,!0)}function AL(t,e){const n=e._path;let s=null;t.syncPointTree_.foreachOnPath(n,(u,d)=>{const f=Bt(u,n);s=s||_i(d,f)});let i=t.syncPointTree_.get(n);i?s=s||_i(i,we()):(i=new $k,t.syncPointTree_=t.syncPointTree_.set(n,i));const r=s!=null,a=r?new Ri(s,!0,!1):null,o=sf(t.pendingWriteTree_,e._path),l=Kk(i,e,o,r?a.getNode():ne.EMPTY_NODE,r);return dL(l)}function io(t,e){return Qk(e,t.syncPointTree_,null,sf(t.pendingWriteTree_,we()))}function Qk(t,e,n,s){if(fe(t.path))return Jk(t,e,n,s);{const i=e.get(we());n==null&&i!=null&&(n=_i(i,we()));let r=[];const a=ue(t.path),o=t.operationForChild(a),l=e.children.get(a);if(l&&o){const u=n?n.getImmediateChild(a):null,d=Hk(s,a);r=r.concat(Qk(o,l,u,d))}return i&&(r=r.concat(u0(i,t,s,n))),r}}function Jk(t,e,n,s){const i=e.get(we());n==null&&i!=null&&(n=_i(i,we()));let r=[];return e.children.inorderTraversal((a,o)=>{const l=n?n.getImmediateChild(a):null,u=Hk(s,a),d=t.operationForChild(a);d&&(r=r.concat(Jk(d,o,l,u)))}),i&&(r=r.concat(u0(i,t,s,n))),r}function Zk(t,e){const n=e.query,s=Cl(t,n);return{hashFn:()=>(uL(e)||ne.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return s?SL(t,n._path,s):kL(t,n._path);{const r=NM(i,n);return gd(t,n,null,r)}}}}function Cl(t,e){const n=of(e);return t.queryToTagMap.get(n)}function of(t){return t._path.toString()+"$"+t._queryIdentifier}function f0(t,e){return t.tagToQueryMap.get(e)}function h0(t){const e=t.indexOf("$");return z(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Ie(t.substr(0,e))}}function m0(t,e,n){const s=t.syncPointTree_.get(e);z(s,"Missing sync point for query tag that we're tracking");const i=sf(t.pendingWriteTree_,e);return u0(s,n,i,null)}function RL(t){return t.fold((e,n,s)=>{if(n&&Ii(n))return[rf(n)];{let i=[];return n&&(i=Yk(n)),Et(s,(r,a)=>{i=i.concat(a)}),i}})}function Zo(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(_L())(t._repo,t._path):t}function IL(t,e){for(let n=0;n<e.length;++n){const s=e[n];if(!s._queryParams.loadsAllData()){const i=of(s),r=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(r)}}}function CL(){return wL++}function jL(t,e,n){const s=e._path,i=Cl(t,e),r=Zk(t,n),a=t.listenProvider_.startListening(Zo(e),i,r.hashFn,r.onComplete),o=t.syncPointTree_.subtree(s);if(i)z(!Ii(o.value),"If we're adding a query, it shouldn't be shadowed");else{const l=o.fold((u,d,f)=>{if(!fe(u)&&d&&Ii(d))return[rf(d).query];{let h=[];return d&&(h=h.concat(Yk(d).map(m=>m.query))),Et(f,(m,v)=>{h=h.concat(v)}),h}});for(let u=0;u<l.length;++u){const d=l[u];t.listenProvider_.stopListening(Zo(d),Cl(t,d))}}return a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p0{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new p0(n)}node(){return this.node_}}class g0{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=Xe(this.path_,e);return new g0(this.syncTree_,n)}node(){return af(this.syncTree_,this.path_)}}const OL=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},ny=function(t,e,n){if(!t||typeof t!="object")return t;if(z(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return ML(t[".sv"],e,n);if(typeof t[".sv"]=="object")return DL(t[".sv"],e);z(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},ML=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:z(!1,"Unexpected server value: "+t)}},DL=function(t,e,n){t.hasOwnProperty("increment")||z(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const s=t.increment;typeof s!="number"&&z(!1,"Unexpected increment value: "+s);const i=e.node();if(z(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return s;const a=i.getValue();return typeof a!="number"?s:a+s},eS=function(t,e,n,s){return b0(e,new g0(n,t),s)},v0=function(t,e,n){return b0(t,new p0(e),n)};function b0(t,e,n){const s=t.getPriority().val(),i=ny(s,e.getImmediateChild(".priority"),n);let r;if(t.isLeafNode()){const a=t,o=ny(a.getValue(),e,n);return o!==a.getValue()||i!==a.getPriority().val()?new pt(o,We(i)):t}else{const a=t;return r=a,i!==a.getPriority().val()&&(r=r.updatePriority(new pt(i))),a.forEachChild(qe,(o,l)=>{const u=b0(l,e.getImmediateChild(o),n);u!==l&&(r=r.updateImmediateChild(o,u))}),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x0{constructor(e="",n=null,s={children:{},childCount:0}){this.name=e,this.parent=n,this.node=s}}function lf(t,e){let n=e instanceof Ie?e:new Ie(e),s=t,i=ue(n);for(;i!==null;){const r=mr(s.node.children,i)||{children:{},childCount:0};s=new x0(i,s,r),n=Me(n),i=ue(n)}return s}function Ir(t){return t.node.value}function y0(t,e){t.node.value=e,np(t)}function tS(t){return t.node.childCount>0}function LL(t){return Ir(t)===void 0&&!tS(t)}function cf(t,e){Et(t.node.children,(n,s)=>{e(new x0(n,t,s))})}function nS(t,e,n,s){n&&e(t),cf(t,i=>{nS(i,e,!0)})}function PL(t,e,n){let s=t.parent;for(;s!==null;){if(e(s))return!0;s=s.parent}return!1}function cc(t){return new Ie(t.parent===null?t.name:cc(t.parent)+"/"+t.name)}function np(t){t.parent!==null&&BL(t.parent,t.name,t)}function BL(t,e,n){const s=LL(n),i=zn(t.node.children,e);s&&i?(delete t.node.children[e],t.node.childCount--,np(t)):!s&&!i&&(t.node.children[e]=n.node,t.node.childCount++,np(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UL=/[\[\].#$\/\u0000-\u001F\u007F]/,HL=/[\[\].#$\u0000-\u001F\u007F]/,wh=10*1024*1024,_0=function(t){return typeof t=="string"&&t.length!==0&&!UL.test(t)},sS=function(t){return typeof t=="string"&&t.length!==0&&!HL.test(t)},GL=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),sS(t)},w0=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!ef(t)||t&&typeof t=="object"&&zn(t,".sv")},vd=function(t,e,n,s){s&&e===void 0||uc(Ia(t,"value"),e,n)},uc=function(t,e,n){const s=n instanceof Ie?new iD(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Wi(s));if(typeof e=="function")throw new Error(t+"contains a function "+Wi(s)+" with contents = "+e.toString());if(ef(e))throw new Error(t+"contains "+e.toString()+" "+Wi(s));if(typeof e=="string"&&e.length>wh/3&&Xd(e)>wh)throw new Error(t+"contains a string greater than "+wh+" utf8 bytes "+Wi(s)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,r=!1;if(Et(e,(a,o)=>{if(a===".value")i=!0;else if(a!==".priority"&&a!==".sv"&&(r=!0,!_0(a)))throw new Error(t+" contains an invalid key ("+a+") "+Wi(s)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);rD(s,a),uc(t,o,s),aD(s)}),i&&r)throw new Error(t+' contains ".value" child '+Wi(s)+" in addition to actual children.")}},VL=function(t,e){let n,s;for(n=0;n<e.length;n++){s=e[n];const r=Sl(s);for(let a=0;a<r.length;a++)if(!(r[a]===".priority"&&a===r.length-1)){if(!_0(r[a]))throw new Error(t+"contains an invalid key ("+r[a]+") in path "+s.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(sD);let i=null;for(n=0;n<e.length;n++){if(s=e[n],i!==null&&kn(i,s))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+s.toString());i=s}},iS=function(t,e,n,s){const i=Ia(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const r=[];Et(e,(a,o)=>{const l=new Ie(a);if(uc(i,o,Xe(n,l)),Jg(l)===".priority"&&!w0(o))throw new Error(i+"contains an invalid value for '"+l.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");r.push(l)}),VL(i,r)},FL=function(t,e,n){if(ef(e))throw new Error(Ia(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!w0(e))throw new Error(Ia(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},rS=function(t,e,n,s){if(!sS(n))throw new Error(Ia(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},zL=function(t,e,n,s){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),rS(t,e,n)},oi=function(t,e){if(ue(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},$L=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!_0(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!GL(n))throw new Error(Ia(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KL{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function uf(t,e){let n=null;for(let s=0;s<e.length;s++){const i=e[s],r=i.getPath();n!==null&&!Zg(r,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:r}),n.events.push(i)}n&&t.eventLists_.push(n)}function aS(t,e,n){uf(t,n),oS(t,s=>Zg(s,e))}function fn(t,e,n){uf(t,n),oS(t,s=>kn(s,e)||kn(e,s))}function oS(t,e){t.recursionDepth_++;let n=!0;for(let s=0;s<t.eventLists_.length;s++){const i=t.eventLists_[s];if(i){const r=i.path;e(r)?(YL(t.eventLists_[s]),t.eventLists_[s]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function YL(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const s=n.getEventRunner();Wo&&yt("event: "+n.toString()),no(s)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qL="repo_interrupt",WL=25;class XL{constructor(e,n,s,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=s,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new KL,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=ld(),this.transactionQueueTree_=new x0,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function QL(t,e,n){if(t.stats_=Xg(t.repoInfo_),t.forceRestClient_||AM())t.server_=new od(t.repoInfo_,(s,i,r,a)=>{sy(t,s,i,r,a)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>iy(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{ht(n)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}t.persistentConnection_=new Es(t.repoInfo_,e,(s,i,r,a)=>{sy(t,s,i,r,a)},s=>{iy(t,s)},s=>{JL(t,s)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(s=>{t.server_.refreshAuthToken(s)}),t.appCheckProvider_.addTokenChangeListener(s=>{t.server_.refreshAppCheckToken(s.token)}),t.statsReporter_=OM(t.repoInfo_,()=>new OD(t.stats_,t.server_)),t.infoData_=new AD,t.infoSyncTree_=new ty({startListening:(s,i,r,a)=>{let o=[];const l=t.infoData_.getNode(s._path);return l.isEmpty()||(o=lc(t.infoSyncTree_,s._path,l),setTimeout(()=>{a("ok")},0)),o},stopListening:()=>{}}),E0(t,"connected",!1),t.serverSyncTree_=new ty({startListening:(s,i,r,a)=>(t.server_.listen(s,r,i,(o,l)=>{const u=a(o,l);fn(t.eventQueue_,s._path,u)}),[]),stopListening:(s,i)=>{t.server_.unlisten(s,i)}})}function lS(t){const n=t.infoData_.getNode(new Ie(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function dc(t){return OL({timestamp:lS(t)})}function sy(t,e,n,s,i){t.dataUpdateCount++;const r=new Ie(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let a=[];if(i)if(s){const l=Xu(n,u=>We(u));a=TL(t.serverSyncTree_,r,l,i)}else{const l=We(n);a=Xk(t.serverSyncTree_,r,l,i)}else if(s){const l=Xu(n,u=>We(u));a=NL(t.serverSyncTree_,r,l)}else{const l=We(n);a=lc(t.serverSyncTree_,r,l)}let o=r;a.length>0&&(o=La(t,r)),fn(t.eventQueue_,o,a)}function iy(t,e){E0(t,"connected",e),e===!1&&n4(t)}function JL(t,e){Et(e,(n,s)=>{E0(t,n,s)})}function E0(t,e,n){const s=new Ie("/.info/"+e),i=We(n);t.infoData_.updateSnapshot(s,i);const r=lc(t.infoSyncTree_,s,i);fn(t.eventQueue_,s,r)}function df(t){return t.nextWriteId_++}function ZL(t,e,n){const s=AL(t.serverSyncTree_,e);return s!=null?Promise.resolve(s):t.server_.get(e).then(i=>{const r=We(i).withIndex(e._queryParams.getIndex());tp(t.serverSyncTree_,e,n,!0);let a;if(e._queryParams.loadsAllData())a=lc(t.serverSyncTree_,e._path,r);else{const o=Cl(t.serverSyncTree_,e);a=Xk(t.serverSyncTree_,e._path,r,o)}return fn(t.eventQueue_,e._path,a),gd(t.serverSyncTree_,e,n,null,!0),r},i=>(ro(t,"get for query "+ht(e)+" failed: "+i),Promise.reject(new Error(i))))}function e4(t,e,n,s,i){ro(t,"set",{path:e.toString(),value:n,priority:s});const r=dc(t),a=We(n,s),o=af(t.serverSyncTree_,e),l=v0(a,o,r),u=df(t),d=d0(t.serverSyncTree_,e,l,u,!0);uf(t.eventQueue_,d),t.server_.put(e.toString(),a.val(!0),(h,m)=>{const v=h==="ok";v||Ht("set at "+e+" failed: "+h);const b=ai(t.serverSyncTree_,u,!v);fn(t.eventQueue_,e,b),Ci(t,i,h,m)});const f=k0(t,e);La(t,f),fn(t.eventQueue_,f,[])}function t4(t,e,n,s){ro(t,"update",{path:e.toString(),value:n});let i=!0;const r=dc(t),a={};if(Et(n,(o,l)=>{i=!1,a[o]=eS(Xe(e,o),We(l),t.serverSyncTree_,r)}),i)yt("update() called with empty data.  Don't do anything."),Ci(t,s,"ok",void 0);else{const o=df(t),l=EL(t.serverSyncTree_,e,a,o);uf(t.eventQueue_,l),t.server_.merge(e.toString(),n,(u,d)=>{const f=u==="ok";f||Ht("update at "+e+" failed: "+u);const h=ai(t.serverSyncTree_,o,!f),m=h.length>0?La(t,e):e;fn(t.eventQueue_,m,h),Ci(t,s,u,d)}),Et(n,u=>{const d=k0(t,Xe(e,u));La(t,d)}),fn(t.eventQueue_,e,[])}}function n4(t){ro(t,"onDisconnectEvents");const e=dc(t),n=ld();Wm(t.onDisconnect_,we(),(i,r)=>{const a=eS(i,r,t.serverSyncTree_,e);so(n,i,a)});let s=[];Wm(n,we(),(i,r)=>{s=s.concat(lc(t.serverSyncTree_,i,r));const a=k0(t,i);La(t,a)}),t.onDisconnect_=ld(),fn(t.eventQueue_,we(),s)}function s4(t,e,n){t.server_.onDisconnectCancel(e.toString(),(s,i)=>{s==="ok"&&qm(t.onDisconnect_,e),Ci(t,n,s,i)})}function ry(t,e,n,s){const i=We(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(r,a)=>{r==="ok"&&so(t.onDisconnect_,e,i),Ci(t,s,r,a)})}function i4(t,e,n,s,i){const r=We(n,s);t.server_.onDisconnectPut(e.toString(),r.val(!0),(a,o)=>{a==="ok"&&so(t.onDisconnect_,e,r),Ci(t,i,a,o)})}function r4(t,e,n,s){if(Wu(n)){yt("onDisconnect().update() called with empty data.  Don't do anything."),Ci(t,s,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,r)=>{i==="ok"&&Et(n,(a,o)=>{const l=We(o);so(t.onDisconnect_,Xe(e,a),l)}),Ci(t,s,i,r)})}function a4(t,e,n){let s;ue(e._path)===".info"?s=tp(t.infoSyncTree_,e,n):s=tp(t.serverSyncTree_,e,n),aS(t.eventQueue_,e._path,s)}function o4(t,e,n){let s;ue(e._path)===".info"?s=gd(t.infoSyncTree_,e,n):s=gd(t.serverSyncTree_,e,n),aS(t.eventQueue_,e._path,s)}function l4(t){t.persistentConnection_&&t.persistentConnection_.interrupt(qL)}function ro(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),yt(n,...e)}function Ci(t,e,n,s){e&&no(()=>{if(n==="ok")e(null);else{const i=(n||"error").toUpperCase();let r=i;s&&(r+=": "+s);const a=new Error(r);a.code=i,e(a)}})}function c4(t,e,n,s,i,r){ro(t,"transaction on "+e);const a={path:e,update:n,onComplete:s,status:null,order:ak(),applyLocally:r,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},o=N0(t,e,void 0);a.currentInputSnapshot=o;const l=a.update(o.val());if(l===void 0)a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete&&a.onComplete(null,!1,a.currentInputSnapshot);else{uc("transaction failed: Data returned ",l,a.path),a.status=0;const u=lf(t.transactionQueueTree_,e),d=Ir(u)||[];d.push(a),y0(u,d);let f;typeof l=="object"&&l!==null&&zn(l,".priority")?(f=mr(l,".priority"),z(w0(f),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):f=(af(t.serverSyncTree_,e)||ne.EMPTY_NODE).getPriority().val();const h=dc(t),m=We(l,f),v=v0(m,o,h);a.currentOutputSnapshotRaw=m,a.currentOutputSnapshotResolved=v,a.currentWriteId=df(t);const b=d0(t.serverSyncTree_,e,v,a.currentWriteId,a.applyLocally);fn(t.eventQueue_,e,b),ff(t,t.transactionQueueTree_)}}function N0(t,e,n){return af(t.serverSyncTree_,e,n)||ne.EMPTY_NODE}function ff(t,e=t.transactionQueueTree_){if(e||hf(t,e),Ir(e)){const n=uS(t,e);z(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&u4(t,cc(e),n)}else tS(e)&&cf(e,n=>{ff(t,n)})}function u4(t,e,n){const s=n.map(u=>u.currentWriteId),i=N0(t,e,s);let r=i;const a=i.hash();for(let u=0;u<n.length;u++){const d=n[u];z(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;const f=Bt(e,d.path);r=r.updateChild(f,d.currentOutputSnapshotRaw)}const o=r.val(!0),l=e;t.server_.put(l.toString(),o,u=>{ro(t,"transaction put response",{path:l.toString(),status:u});let d=[];if(u==="ok"){const f=[];for(let h=0;h<n.length;h++)n[h].status=2,d=d.concat(ai(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&f.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();hf(t,lf(t.transactionQueueTree_,e)),ff(t,t.transactionQueueTree_),fn(t.eventQueue_,e,d);for(let h=0;h<f.length;h++)no(f[h])}else{if(u==="datastale")for(let f=0;f<n.length;f++)n[f].status===3?n[f].status=4:n[f].status=0;else{Ht("transaction at "+l.toString()+" failed: "+u);for(let f=0;f<n.length;f++)n[f].status=4,n[f].abortReason=u}La(t,e)}},a)}function La(t,e){const n=cS(t,e),s=cc(n),i=uS(t,n);return d4(t,i,s),s}function d4(t,e,n){if(e.length===0)return;const s=[];let i=[];const a=e.filter(o=>o.status===0).map(o=>o.currentWriteId);for(let o=0;o<e.length;o++){const l=e[o],u=Bt(n,l.path);let d=!1,f;if(z(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)d=!0,f=l.abortReason,i=i.concat(ai(t.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=WL)d=!0,f="maxretry",i=i.concat(ai(t.serverSyncTree_,l.currentWriteId,!0));else{const h=N0(t,l.path,a);l.currentInputSnapshot=h;const m=e[o].update(h.val());if(m!==void 0){uc("transaction failed: Data returned ",m,l.path);let v=We(m);typeof m=="object"&&m!=null&&zn(m,".priority")||(v=v.updatePriority(h.getPriority()));const y=l.currentWriteId,p=dc(t),g=v0(v,h,p);l.currentOutputSnapshotRaw=v,l.currentOutputSnapshotResolved=g,l.currentWriteId=df(t),a.splice(a.indexOf(y),1),i=i.concat(d0(t.serverSyncTree_,l.path,g,l.currentWriteId,l.applyLocally)),i=i.concat(ai(t.serverSyncTree_,y,!0))}else d=!0,f="nodata",i=i.concat(ai(t.serverSyncTree_,l.currentWriteId,!0))}fn(t.eventQueue_,n,i),i=[],d&&(e[o].status=2,function(h){setTimeout(h,Math.floor(0))}(e[o].unwatcher),e[o].onComplete&&(f==="nodata"?s.push(()=>e[o].onComplete(null,!1,e[o].currentInputSnapshot)):s.push(()=>e[o].onComplete(new Error(f),!1,null))))}hf(t,t.transactionQueueTree_);for(let o=0;o<s.length;o++)no(s[o]);ff(t,t.transactionQueueTree_)}function cS(t,e){let n,s=t.transactionQueueTree_;for(n=ue(e);n!==null&&Ir(s)===void 0;)s=lf(s,n),e=Me(e),n=ue(e);return s}function uS(t,e){const n=[];return dS(t,e,n),n.sort((s,i)=>s.order-i.order),n}function dS(t,e,n){const s=Ir(e);if(s)for(let i=0;i<s.length;i++)n.push(s[i]);cf(e,i=>{dS(t,i,n)})}function hf(t,e){const n=Ir(e);if(n){let s=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[s]=n[i],s++);n.length=s,y0(e,n.length>0?n:void 0)}cf(e,s=>{hf(t,s)})}function k0(t,e){const n=cc(cS(t,e)),s=lf(t.transactionQueueTree_,e);return PL(s,i=>{Eh(t,i)}),Eh(t,s),nS(s,i=>{Eh(t,i)}),n}function Eh(t,e){const n=Ir(e);if(n){const s=[];let i=[],r=-1;for(let a=0;a<n.length;a++)n[a].status===3||(n[a].status===1?(z(r===a-1,"All SENT items should be at beginning of queue."),r=a,n[a].status=3,n[a].abortReason="set"):(z(n[a].status===0,"Unexpected transaction status in abort"),n[a].unwatcher(),i=i.concat(ai(t.serverSyncTree_,n[a].currentWriteId,!0)),n[a].onComplete&&s.push(n[a].onComplete.bind(null,new Error("set"),!1,null))));r===-1?y0(e,void 0):n.length=r+1,fn(t.eventQueue_,cc(e),i);for(let a=0;a<s.length;a++)no(s[a])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f4(t){let e="";const n=t.split("/");for(let s=0;s<n.length;s++)if(n[s].length>0){let i=n[s];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function h4(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const s=n.split("=");s.length===2?e[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):Ht(`Invalid query segment '${n}' in query '${t}'`)}return e}const ay=function(t,e){const n=m4(t),s=n.namespace;n.domain==="firebase.com"&&Ds(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!s||s==="undefined")&&n.domain!=="localhost"&&Ds("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||xM();const i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new xk(n.host,n.secure,s,i,e,"",s!==n.subdomain),path:new Ie(n.pathString)}},m4=function(t){let e="",n="",s="",i="",r="",a=!0,o="https",l=443;if(typeof t=="string"){let u=t.indexOf("//");u>=0&&(o=t.substring(0,u-1),t=t.substring(u+2));let d=t.indexOf("/");d===-1&&(d=t.length);let f=t.indexOf("?");f===-1&&(f=t.length),e=t.substring(0,Math.min(d,f)),d<f&&(i=f4(t.substring(d,f)));const h=h4(t.substring(Math.min(t.length,f)));u=e.indexOf(":"),u>=0?(a=o==="https"||o==="wss",l=parseInt(e.substring(u+1),10)):u=e.length;const m=e.slice(0,u);if(m.toLowerCase()==="localhost")n="localhost";else if(m.split(".").length<=2)n=m;else{const v=e.indexOf(".");s=e.substring(0,v).toLowerCase(),n=e.substring(v+1),r=s}"ns"in h&&(r=h.ns)}return{host:e,port:l,domain:n,subdomain:s,secure:a,scheme:o,pathString:i,namespace:r}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oy="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",p4=function(){let t=0;const e=[];return function(n){const s=n===t;t=n;let i;const r=new Array(8);for(i=7;i>=0;i--)r[i]=oy.charAt(n%64),n=Math.floor(n/64);z(n===0,"Cannot push at time == 0");let a=r.join("");if(s){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)a+=oy.charAt(e[i]);return z(a.length===20,"nextPushId: Length should be 20."),a}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g4{constructor(e,n,s,i){this.eventType=e,this.eventRegistration=n,this.snapshot=s,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+ht(this.snapshot.exportVal())}}class v4{constructor(e,n,s){this.eventRegistration=e,this.error=n,this.path=s}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return z(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b4{constructor(e,n){this._repo=e,this._path=n}cancel(){const e=new Pn;return s4(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){oi("OnDisconnect.remove",this._path);const e=new Pn;return ry(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){oi("OnDisconnect.set",this._path),vd("OnDisconnect.set",e,this._path,!1);const n=new Pn;return ry(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){oi("OnDisconnect.setWithPriority",this._path),vd("OnDisconnect.setWithPriority",e,this._path,!1),FL("OnDisconnect.setWithPriority",n);const s=new Pn;return i4(this._repo,this._path,e,n,s.wrapCallback(()=>{})),s.promise}update(e){oi("OnDisconnect.update",this._path),iS("OnDisconnect.update",e,this._path);const n=new Pn;return r4(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf{constructor(e,n,s,i){this._repo=e,this._path=n,this._queryParams=s,this._orderByCalled=i}get key(){return fe(this._path)?null:Jg(this._path)}get ref(){return new is(this._repo,this._path)}get _queryIdentifier(){const e=$x(this._queryParams),n=qg(e);return n==="{}"?"default":n}get _queryObject(){return $x(this._queryParams)}isEqual(e){if(e=dt(e),!(e instanceof mf))return!1;const n=this._repo===e._repo,s=Zg(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&s&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+nD(this._path)}}class is extends mf{constructor(e,n){super(e,n,new s0,!1)}get parent(){const e=Ak(this._path);return e===null?null:new is(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class Pa{constructor(e,n,s){this._node=e,this.ref=n,this._index=s}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new Ie(e),s=jl(this.ref,e);return new Pa(this._node.getChild(n),s,qe)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(s,i)=>e(new Pa(i,jl(this.ref,s),qe)))}hasChild(e){const n=new Ie(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function D(t,e){return t=dt(t),t._checkNotDeleted("ref"),e!==void 0?jl(t._root,e):t._root}function jl(t,e){return t=dt(t),ue(t._path)===null?zL("child","path",e):rS("child","path",e),new is(t._repo,Xe(t._path,e))}function ly(t){return t=dt(t),new b4(t._repo,t._path)}function hS(t,e){t=dt(t),oi("push",t._path),vd("push",e,t._path,!0);const n=lS(t._repo),s=p4(n),i=jl(t,s),r=jl(t,s);let a;return a=Promise.resolve(r),i.then=a.then.bind(a),i.catch=a.then.bind(a,void 0),i}function cy(t){return oi("remove",t._path),Ba(t,null)}function Ba(t,e){t=dt(t),oi("set",t._path),vd("set",e,t._path,!1);const n=new Pn;return e4(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function J(t,e){iS("update",e,t._path);const n=new Pn;return t4(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function ye(t){t=dt(t);const e=new fS(()=>{}),n=new pf(e);return ZL(t._repo,t,n).then(s=>new Pa(s,new is(t._repo,t._path),t._queryParams.getIndex()))}class pf{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const s=n._queryParams.getIndex();return new g4("value",this,new Pa(e.snapshotNode,new is(n._repo,n._path),s))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new v4(this,e,n):null}matches(e){return e instanceof pf?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function x4(t,e,n,s,i){const r=new fS(n,void 0),a=new pf(r);return a4(t._repo,t,a),()=>o4(t._repo,t,a)}function Ye(t,e,n,s){return x4(t,"value",e)}class y4{}class _4 extends y4{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new mf(e._repo,e._path,TD(e._queryParams,this._limit),e._orderByCalled)}}function w4(t){if(Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new _4(t)}function E4(t,...e){let n=dt(t);for(const s of e)n=s._apply(n);return n}pL(is);yL(is);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N4="FIREBASE_DATABASE_EMULATOR_HOST",sp={};let k4=!1;function S4(t,e,n,s){const i=e.lastIndexOf(":"),r=e.substring(0,i),a=Za(r);t.repoInfo_=new xk(e,a,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0,n),s&&(t.authTokenProvider_=s)}function T4(t,e,n,s,i){let r=s||t.options.databaseURL;r===void 0&&(t.options.projectId||Ds("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),yt("Using default host for project ",t.options.projectId),r=`${t.options.projectId}-default-rtdb.firebaseio.com`);let a=ay(r,i),o=a.repoInfo,l;typeof process<"u"&&Tx&&(l=Tx[N4]),l?(r=`http://${l}?ns=${o.namespace}`,a=ay(r,i),o=a.repoInfo):a.repoInfo.secure;const u=new IM(t.name,t.options,e);$L("Invalid Firebase Database URL",a),fe(a.path)||Ds("Database URL must point to the root of a Firebase Database (not including a child path).");const d=R4(o,t,u,new RM(t,n));return new I4(d,t)}function A4(t,e){const n=sp[e];(!n||n[t.key]!==t)&&Ds(`Database ${e}(${t.repoInfo_}) has already been deleted.`),l4(t),delete n[t.key]}function R4(t,e,n,s){let i=sp[e.name];i||(i={},sp[e.name]=i);let r=i[t.toURLString()];return r&&Ds("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new XL(t,k4,n,s),i[t.toURLString()]=r,r}class I4{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(QL(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new is(this._repo,we())),this._rootInternal}_delete(){return this._rootInternal!==null&&(A4(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Ds("Cannot call "+e+" on a deleted database.")}}function C4(t=xN(),e){const n=Bg(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const s=y2("database");s&&j4(n,...s)}return n}function j4(t,e,n,s={}){t=dt(t),t._checkNotDeleted("useEmulator");const i=`${e}:${n}`,r=t._repoInternal;if(t._instanceStarted){if(i===t._repoInternal.repoInfo_.host&&pr(s,r.repoInfo_.emulatorOptions))return;Ds("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let a;if(r.repoInfo_.nodeAdmin)s.mockUserToken&&Ds('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new mu(mu.OWNER);else if(s.mockUserToken){const o=typeof s.mockUserToken=="string"?s.mockUserToken:_2(s.mockUserToken,t.app.options.projectId);a=new mu(o)}Za(e)&&(fN(e),hN("Database",!0)),S4(r,i,s,a)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O4(t){mM(to),Ca(new gr("database",(e,{instanceIdentifier:n})=>{const s=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),r=e.getProvider("app-check-internal");return T4(s,i,r,n)},"PUBLIC").setMultipleInstances(!0)),xi(Ax,Rx,t),xi(Ax,Rx,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M4={".sv":"timestamp"};function D4(){return M4}function mS(t){return{".sv":{increment:t}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L4{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function Re(t,e,n){var s;if(t=dt(t),oi("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";const i=(s=void 0)!==null&&s!==void 0?s:!0,r=new Pn,a=(l,u,d)=>{let f=null;l?r.reject(l):(f=new Pa(d,new is(t._repo,t._path),qe),r.resolve(new L4(u,f)))},o=Ye(t,()=>{});return c4(t._repo,t._path,e,a,o,i),r.promise}Es.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Es.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};O4();var P4="firebase",B4="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */xi(P4,B4,"app");const U4={apiKey:"AIzaSyBU11CvtAaUkADomFxcMuN6fH9ipx-VtAs",authDomain:"eiriksbok-simuleringfeudal.firebaseapp.com",databaseURL:"https://eiriksbok-simuleringfeudal-default-rtdb.europe-west1.firebasedatabase.app",projectId:"eiriksbok-simuleringfeudal",storageBucket:"eiriksbok-simuleringfeudal.firebasestorage.app",messagingSenderId:"772081963542",appId:"1:772081963542:web:05edb87535f629fd36db37",measurementId:"G-NDR8LNVQNX"},pS=bN(U4,"simulationApp"),L=C4(pS),Dr=fM(pS),gS=_.createContext(void 0),H4=({children:t})=>{const[e,n]=_.useState(null),[s,i]=_.useState(null),[r,a]=_.useState(!0),[o,l]=_.useState(null),[u,d]=_.useState(!0);_.useEffect(()=>{const y=eO(Dr,async p=>{if(p){n(p),d(p.isAnonymous);const g=D(L,`simulation_accounts/${p.uid}`),x=Ye(g,async w=>{if(w.exists())i(w.val()),a(!1);else{const N={uid:p.uid,displayName:p.displayName||`Eventyrer_${p.uid.slice(0,4)}`,globalXp:0,globalLevel:1,totalGoldEarned:0,unlockedAchievements:[],characterHistory:[],lastActive:Date.now()};await Ba(g,N),i(N),a(!1)}});return()=>x()}else{d(!0);try{await F5(Dr)}catch(g){console.error("Auth failed:",g),a(!1)}}});return()=>y()},[]);const f=async(y,p)=>{l(null);try{await Q5(Dr,y,p)}catch(g){throw l(g.message),g}},h=async y=>{const p=y.trim().toLowerCase();if(!p||p.length<3)return!1;const g=D(L,`simulation_reserved_names/${p}`);return!(await ye(g)).exists()},m=async(y,p,g)=>{l(null);const x=g.trim(),w=x.toLowerCase();try{if(!await h(x))throw new Error("Navnet er allerede tatt.");if(e&&e.isAnonymous){const T=Tr.credential(y,p);await q5(e,T);const E={};E[`simulation_accounts/${e.uid}/displayName`]=x,E[`simulation_reserved_names/${w}`]=e.uid,await J(D(L),E)}else{const T=await X5(Dr,y,p),E={};E[`simulation_reserved_names/${w}`]=T.user.uid;const A={uid:T.user.uid,displayName:x,globalXp:0,globalLevel:1,totalGoldEarned:0,unlockedAchievements:[],characterHistory:[],lastActive:Date.now()};E[`simulation_accounts/${T.user.uid}`]=A,await J(D(L),E)}}catch(N){throw l(N.message),N}},v=async()=>{await tO(Dr)},b=async y=>{try{await W5(Dr,y)}catch(p){throw l(p.message),p}};return c.jsx(gS.Provider,{value:{user:e,account:s,loading:r,isAnonymous:u,error:o,login:f,register:m,logout:v,resetPassword:b,checkNameAvailability:h},children:t})},gf=()=>{const t=_.useContext(gS);if(!t)throw new Error("useSimulationAuth must be used within a SimulationAuthProvider");return t},vS=[{id:"Ashes of the Keep.mp3",title:"Festningens Aske",mood:"Dark"},{id:"Banner at the Old Stone Keep.mp3",title:"Gamle Steiner",mood:"Epic"},{id:"Banner at the Old Stone Keep (1).mp3",title:"Steinhallens Hymne",mood:"Epic"},{id:"Burning Banners Over Stone.mp3",title:"Brennende Bannere",mood:"Dark"},{id:"Candlelit Keep.mp3",title:"Lys i Hallen",mood:"Calm"},{id:"Candlelit Keep (1).mp3",title:"Nattens Vakt",mood:"Calm"},{id:"Crown of Quiet Rooms.mp3",title:"Stillhetens Krone",mood:"Mysterious"},{id:"Crown of Quiet Rooms (1).mp3",title:"Kongens Tvil",mood:"Mysterious"}],Ji=class Ji{constructor(){$e(this,"sfxVolume",.5);$e(this,"musicVolume",.3);$e(this,"currentMusic",null);$e(this,"currentMusicKey",null);$e(this,"playlist",[]);$e(this,"playlistIndex",0);$e(this,"isPlaylistActive",!1);$e(this,"ignoredTracks",new Set);$e(this,"audioContext",null);$e(this,"filterNode",null);$e(this,"isMuffledState",!1);$e(this,"activeFades",new Map);const e=localStorage.getItem("sim_sfx_volume"),n=localStorage.getItem("sim_music_volume"),s=localStorage.getItem("sim_music_muffled"),i=localStorage.getItem("sim_music_ignored");if(e&&(this.sfxVolume=parseFloat(e)),n&&(this.musicVolume=parseFloat(n)),s&&(this.isMuffledState=s==="true"),i)try{this.ignoredTracks=new Set(JSON.parse(i))}catch(r){console.error("Failed to parse ignored tracks",r)}this.playlist=vS.map(r=>r.id),this.shufflePlaylist()}shufflePlaylist(){this.playlist=this.playlist.sort(()=>Math.random()-.5)}initAudioContext(){if(!this.audioContext)try{this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.filterNode=this.audioContext.createBiquadFilter(),this.filterNode.type="lowpass",this.filterNode.frequency.setValueAtTime(this.isMuffledState?12e3:2e4,this.audioContext.currentTime),this.filterNode.connect(this.audioContext.destination)}catch(e){console.error("Failed to initialize AudioContext",e)}this.audioContext&&this.audioContext.state==="suspended"&&this.audioContext.resume()}static getInstance(){return Ji.instance||(Ji.instance=new Ji),Ji.instance}setSfxVolume(e){this.sfxVolume=Math.max(0,Math.min(1,e)),localStorage.setItem("sim_sfx_volume",this.sfxVolume.toString())}setMusicVolume(e){this.musicVolume=Math.max(0,Math.min(1,e)),localStorage.setItem("sim_music_volume",this.musicVolume.toString()),this.currentMusic&&(this.currentMusic.volume=this.musicVolume)}setMuffled(e){this.isMuffledState=e,localStorage.setItem("sim_music_muffled",e.toString()),this.filterNode&&this.audioContext&&this.filterNode.frequency.setTargetAtTime(e?15e3:2e4,this.audioContext.currentTime,.1)}toggleIgnoreTrack(e){this.ignoredTracks.has(e)?this.ignoredTracks.delete(e):this.ignoredTracks.add(e),localStorage.setItem("sim_music_ignored",JSON.stringify(Array.from(this.ignoredTracks))),this.ignoredTracks.has(e)&&this.currentMusicKey===e&&this.isPlaylistActive&&this.playNextInPlaylist()}isIgnored(e){return this.ignoredTracks.has(e)}getSfxVolume(){return this.sfxVolume}getMusicVolume(){return this.musicVolume}isMuffled(){return this.isMuffledState}getCurrentTrackId(){return this.currentMusicKey}playSfx(e){if(this.sfxVolume===0)return;const i=`/Simulation_StandAlone_Pro//sounds/sfx/${e.includes(".")?e:`${e}.mp3`}`.replace("//","/"),r=new Audio(i);r.volume=this.sfxVolume,r.play().catch(()=>{})}startPlaylist(){this.isPlaylistActive&&this.currentMusic||(this.isPlaylistActive=!0,this.currentMusic||this.playNextInPlaylist())}playNextInPlaylist(){if(!this.isPlaylistActive)return;let e=0,n=!1;for(;e<this.playlist.length;){this.playlistIndex=(this.playlistIndex+1)%this.playlist.length;const s=this.playlist[this.playlistIndex];if(!this.ignoredTracks.has(s)){this.playMusic(s,2e3,!1),n=!0;break}e++}n||(console.warn("All tracks are ignored! Playing fallback."),this.playMusic(this.playlist[0],2e3,!1))}playPreviousInPlaylist(){if(!this.isPlaylistActive)return;let e=0,n=!1;for(;e<this.playlist.length;){this.playlistIndex=(this.playlistIndex-1+this.playlist.length)%this.playlist.length;const s=this.playlist[this.playlistIndex];if(!this.ignoredTracks.has(s)){this.playMusic(s,2e3,!1),n=!0;break}e++}n||this.playMusic(this.playlist[0],2e3,!1)}async resume(){this.audioContext||this.initAudioContext(),this.audioContext&&this.audioContext.state==="suspended"&&await this.audioContext.resume()}playMusic(e,n=1e3,s=!0){if(s&&(this.isPlaylistActive=!1),this.currentMusicKey===e&&this.currentMusic&&!this.currentMusic.paused){this.fadeIn(this.currentMusic,this.musicVolume,500);return}const a=`/Simulation_StandAlone_Pro//sounds/music/${e.includes(".")?e:`${e}.mp3`}`.replace("//","/"),o=new Audio(a);if(o.loop=!this.isPlaylistActive,o.volume=0,this.initAudioContext(),this.audioContext&&this.filterNode)try{this.audioContext.createMediaElementSource(o).connect(this.filterNode)}catch(l){console.warn("Could not route through Web Audio API",l)}this.isPlaylistActive&&(o.onended=()=>{this.playNextInPlaylist()}),this.currentMusic&&this.fadeOut(this.currentMusic,n),this.currentMusic=o,this.currentMusicKey=e,o.play().then(()=>{this.fadeIn(o,this.musicVolume,n),this.audioContext&&this.audioContext.state==="suspended"&&this.audioContext.resume()}).catch(l=>{console.warn(`Failed to play music: ${e}`,l),this.currentMusic===o&&(this.currentMusic=null,this.currentMusicKey=null),this.isPlaylistActive&&setTimeout(()=>this.playNextInPlaylist(),2e3)})}stopMusic(e=1e3){this.isPlaylistActive=!1,this.currentMusic&&(this.fadeOut(this.currentMusic,e),this.currentMusic=null,this.currentMusicKey=null)}fadeOut(e,n){this.activeFades.has(e)&&clearInterval(this.activeFades.get(e));const s=e.volume,i=20,r=n/i,a=s/i;let o=0;const l=setInterval(()=>{o++;const u=Math.max(0,s-a*o);e.volume=u,u<=0&&(e.pause(),e.src="",clearInterval(l),this.activeFades.delete(e))},r);this.activeFades.set(e,l)}fadeIn(e,n,s){this.activeFades.has(e)&&(clearInterval(this.activeFades.get(e)),this.activeFades.delete(e));const i=20,r=s/i,a=n/i;let o=0;const l=setInterval(()=>{o++;const u=Math.min(n,a*o);e.volume=u,(u>=n||e.paused)&&clearInterval(l)},r)}};$e(Ji,"instance");let ip=Ji;const nt=ip.getInstance(),G4=Object.freeze(Object.defineProperty({__proto__:null,audioManager:nt},Symbol.toStringTag,{value:"Module"})),bS=_.createContext(void 0),V4=({children:t})=>{const[e,n]=_.useState(nt.getSfxVolume()),[s,i]=_.useState(nt.getMusicVolume()),[r,a]=_.useState(nt.isMuffled()),[o,l]=_.useState(nt.getCurrentTrackId()),[u,d]=_.useState(0);_.useEffect(()=>{const E=setInterval(()=>{const A=nt.getCurrentTrackId();A!==o&&l(A)},1e3);return()=>clearInterval(E)},[o]);const f=_.useCallback(E=>{nt.setSfxVolume(E),n(E)},[]),h=_.useCallback(E=>{nt.setMusicVolume(E),i(E)},[]),m=_.useCallback(E=>{nt.setMuffled(E),a(E)},[]),v=_.useCallback(E=>{nt.playSfx(E)},[]),b=_.useCallback(E=>{nt.playMusic(E),l(E)},[]),y=_.useCallback(()=>{nt.stopMusic(),l(null)},[]),p=_.useCallback(()=>{nt.startPlaylist(),l(nt.getCurrentTrackId())},[]),g=_.useCallback(()=>{nt.playNextInPlaylist(),l(nt.getCurrentTrackId())},[]),x=_.useCallback(()=>{nt.playPreviousInPlaylist(),l(nt.getCurrentTrackId())},[]),w=_.useCallback(E=>{nt.toggleIgnoreTrack(E),d(A=>A+1)},[]),N=_.useCallback(E=>nt.isIgnored(E),[u]),T=_.useCallback(()=>{nt.resume()},[]);return c.jsx(bS.Provider,{value:{playSfx:v,playMusic:b,startPlaylist:p,stopMusic:y,playNext:g,playPrevious:x,toggleIgnoreTrack:w,isIgnored:N,currentTrackId:o,playlist:vS,sfxVolume:e,setSfxVolume:f,musicVolume:s,setMusicVolume:h,isMuffled:r,setMuffled:m,resume:T},children:t})},S0=()=>{const t=_.useContext(bS);if(!t)throw new Error("useAudio must be used within a SimulationAudioProvider");return t},xS=_.createContext(void 0),F4=({children:t})=>{const{pin:e,tab:n}=ZE(),s=I=>{if(!I)return"MAP";const P=I.toUpperCase();return P==="ACTIVITY"||P==="LOG"?"ACTIVITY":P},i=I=>I.toLowerCase(),[r,a]=_.useState(()=>s(n)),[o,l]=_.useState("global"),[u,d]=_.useState(null),[f,h]=_.useState(!1),[m,v]=_.useState(!1),[b,y]=_.useState(null),[p,g]=_.useState(null),[x,w]=_.useState(null),[N,T]=_.useState(null),[E,A]=_.useState(null),k=I=>{a(I);const P=i(I),V=`/sim/play/${e}/${P}`;window.history.replaceState({...window.history.state,idx:window.history.length},"",V)},R=I=>{h(I),I?k("MARKET"):r==="MARKET"&&k("MAP")};return c.jsx(xS.Provider,{value:{activeTab:r,setActiveTab:k,viewMode:o,setViewMode:l,viewingRegionId:u,setViewingRegionId:d,isMarketOpen:f,setMarketOpen:R,isMusicWindowOpen:m,setMusicWindowOpen:v,activeMinigame:b,setActiveMinigame:y,activeMinigameMethod:p,setActiveMinigameMethod:g,activeMinigameAction:x,setActiveMinigameAction:w,actionLoading:N,setActionLoading:T,productionContext:E,setProductionContext:A},children:t})},vf=()=>{const t=_.useContext(xS);if(!t)throw new Error("useSimulation must be used within a SimulationProvider");return t},z4="modulepreload",$4=function(t){return"/Simulation_StandAlone_Pro/"+t},uy={},Mt=function(e,n,s){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(n.map(l=>{if(l=$4(l),l in uy)return;uy[l]=!0;const u=l.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":z4,u||(f.as="script"),f.crossOrigin="",f.href=l,o&&f.setAttribute("nonce",o),document.head.appendChild(f),u)return new Promise((h,m)=>{f.addEventListener("load",h),f.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}function r(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&r(o.reason);return e().catch(r)})},q={MARKET:{SELL_RATIO:.8,PRICE_IMPACT_BUY:.005,PRICE_IMPACT_SELL:.005,MIN_PRICE_MULTIPLIER:.2,MAX_PRICE_MULTIPLIER:5,VISCOSITY:100},CONTRIBUTION_VALUES:{gold:1,wood:.5,stone:1,iron_ore:1,iron_ingot:5,plank:2,grain:.1,flour:.5,bread:1,meat:1,honey:1,cloth:1,wool:.5,default:.1},CAREERS:{SOLDIER:{COST:200,LEVEL_REQ:3},MERCHANT:{COST:500,LEVEL_REQ:3}},TAX:{PEASANT_RATE_DEFAULT:.15,PEASANT_RATE_CUT:.07,ROYAL_RATE:.2,LOYALTY_PENALTY_PEASANT:10,LOYALTY_PENALTY_BARON:5},GATHERING:{NO_TOOL_PENALTY:.75},YIELD:{WORK_GRAIN:12,CHOP_WOOD:8,MINE_ORE:6,QUARRY_STONE:10,FORAGE_BREAD:1,PLOW_BONUS:5,SUMMER_WOOD_BONUS:3},DURABILITY:{MAX:100,LOSS_WORK:5,LOSS_COMBAT_WEAPON:10,LOSS_COMBAT_ARMOR:15,REPAIR_AMOUNT:30},MINIGAME:{BASE_MULTIPLIER:.5,PERFORMANCE_WEIGHT:1,CRAFTING_WEIGHT:1.5,THRESHOLD_GREAT:.8},RELIGION:{PRAY_MIN:1,PRAY_MAX:5,XP_PRAY:2},COMBAT:{RAID_LOOT_FACTOR:.4,DEFEND_GOLD_BASE:20,XP_WIN:20,XP_LOSS:0},LUCKY_DROP:{CHANCE:.05,MULTIPLIER:2},PASSIVE_INCOME:{COW:2,ACCOUNTING_BOOKS:5,CARAVAN:10},SKILLS:{GATHERING_BONUS:.1,REFINING_BONUS:.1,CRAFTING_XP:25,REFINING_XP:10},COUP:{BASE_BRIBE_COST:500,HONEYMOON_DURATION:6e5,VACANCY_DURATION:3e5,RESTORE_ORDER_COST:600,LEGITIMACY_SHIELD_MULT:2,KING_VOTE_WEIGHT:15,PEASANT_VOTE_WEIGHT:1}},fc={WORK:{xp:5},CHOP:{xp:5},FORAGE:{xp:2}},bd=[0,100,300,700,1500,3e3,6e3],An={Spring:{label:"Vr",yieldMod:1,staminaMod:1,color:"#4ade80"},Summer:{label:"Sommer",yieldMod:1.2,staminaMod:1,color:"#fbbf24"},Autumn:{label:"Hst",yieldMod:1.5,staminaMod:1,color:"#f97316"},Winter:{label:"Vinter",yieldMod:.2,staminaMod:1.5,color:"#38bdf8"}},xs={Clear:{label:"Klart Vr",desc:"Ideelle forhold for alt arbeid.",mod:1,icon:"",speedMod:1,staminaMod:1},Rain:{label:"Regn",desc:"Glatte forhold. Minispill gr litt fortere.",mod:.9,icon:"",speedMod:1.2,staminaMod:1},Storm:{label:"Storm",desc:"Farlig vr. Hy stamina-kostnad og lavt utbytte!",mod:.5,icon:"",speedMod:1.5,staminaMod:2},Fog:{label:"Tke",desc:"Drlig sikt. Vanskeligere  treffe blinker.",mod:.8,icon:"",speedMod:.8,staminaMod:1}},hc={WORK:{bread:1,stamina:10},CHOP:{bread:1,stamina:15},FORAGE:{stamina:40},MINE:{bread:1,stamina:25},RAID:{bread:3,stamina:40},TAX:{stamina:20},TAX_PEASANTS:{stamina:25},TAX_ROYAL:{stamina:30},MILL:{grain:10},SMELT:{iron_ore:5,wood:2},SAWMILL:{wood:5},BAKERY:{flour:5},REFINE:{},CRAFT:{},QUARRY:{bread:1,stamina:20},REPAIR:{stamina:15},HUNT:{stamina:30},GATHER_WOOL:{stamina:15},GATHER_HONEY:{stamina:20},PRAY:{stamina:15},FEAST:{bread:30,gold:100,stamina:10},CONTRIBUTE:{stamina:10},CONSTRUCT:{stamina:20},SLEEP:{stamina:0},EAT:{bread:1,stamina:0},PLANT:{grain:5,stamina:25},HARVEST:{stamina:15},BAKE:{},WEAVE:{},MIX:{},DEFEND:{stamina:30},EXPLORE:{stamina:25},PATROL:{stamina:10},MAINTAIN_CROP:{stamina:5}},rp={great_forge:{material:"iron_ingot",goldCost:20,staminaCost:15,slots:["MAIN_HAND","OFF_HAND","HEAD","BODY","FEET","AXE","PICKAXE","SCYTHE","HAMMER","BOW","TRAP"]},weavery:{material:"cloth",goldCost:10,staminaCost:10,slots:["BODY","FEET","HEAD"]},sawmill:{material:"plank",goldCost:5,staminaCost:10,slots:["OFF_HAND","MAIN_HAND"]}},xd={GOLD:"",GRAIN:"",WOOD:"",IRON_ORE:"",STONE:"",PLANK:"",IRON_INGOT:"",BREAD:"",SWORDS:"",ARMOR:"",CLOTH:"",WOOL:"",MEAT:"",HONEY:"",GLASS:"",FLOUR:"",EGG:"",OMELETTE:"",MANPOWER:"",FAVOR:""},hn={gold:{label:"Gull",icon:""},grain:{label:"Korn",icon:""},flour:{label:"Mel",icon:""},bread:{label:"Brd",icon:""},wood:{label:"Ved",icon:""},plank:{label:"Planker",icon:""},iron_ore:{label:"Jernmalm",icon:""},iron_ingot:{label:"Jernbarre",icon:""},stone:{label:"Stein",icon:""},swords:{label:"Beleiringsvpen",icon:""},armor:{label:"Beleiringsrustning",icon:""},favor:{label:"Gunst",icon:""},honey:{label:"Honning",icon:""},meat:{label:"Kjtt",icon:""},wool:{label:"Ull",icon:""},cloth:{label:"Stoff",icon:""},glass:{label:"Glass",icon:""},egg:{label:"Egg",icon:""},omelette:{label:"Omelett",icon:""}},At={KING:{gold:1e3,grain:500,flour:200,bread:50,wood:200,plank:50,iron_ore:0,iron_ingot:20,stone:100,swords:50,armor:20,favor:0,wool:50,cloth:20,honey:0,meat:0,glass:0,manpower:0,egg:0,omelette:0},BARON:{gold:300,grain:100,flour:50,bread:20,wood:50,plank:20,iron_ore:0,iron_ingot:10,stone:20,swords:10,armor:10,favor:0,wool:20,cloth:5,honey:0,meat:0,glass:0,manpower:0,egg:0,omelette:0},PEASANT:{gold:20,grain:30,flour:5,bread:10,wood:0,plank:0,iron_ore:0,iron_ingot:0,stone:0,swords:0,armor:0,favor:0,wool:10,cloth:0,honey:0,meat:0,glass:0,manpower:0,egg:0,omelette:0},SOLDIER:{gold:50,grain:10,flour:10,bread:10,wood:0,plank:0,iron_ore:0,iron_ingot:0,stone:0,swords:5,armor:2,favor:0,wool:0,cloth:0,honey:0,meat:0,glass:0,manpower:0,egg:0,omelette:0},MERCHANT:{gold:500,grain:50,flour:50,bread:20,wood:50,plank:20,iron_ore:0,iron_ingot:5,stone:50,swords:5,armor:2,favor:0,wool:20,cloth:10,honey:0,meat:0,glass:0,manpower:0,egg:0,omelette:0}},T0={PEASANT:[{id:"iron_plow",name:"Jernplog",description:"ker kornhst med +5.",cost:{gold:50,wood:10},benefit:"YIELD_GRAIN"},{id:"fence",name:"Solid Gjerde",description:"Beskytter mot smtyveri.",cost:{wood:50},benefit:"DEFENSE_REGION"},{id:"cow",name:"Melkeku",description:"Gir passivt 2 gull per minutt (simulert via actions).",cost:{gold:80},benefit:"PASSIVE_GOLD"},{id:"roof",name:"Tett Tak",description:"Bedre hvile. Mer utholdenhet.",cost:{wood:20,gold:10},benefit:"STAMINA_REGEN"}],BARON:[{id:"stone_keep",name:"Steintrn",description:"Gjr raiding av deg mye vanskeligere.",cost:{gold:200,wood:100},benefit:"FORTRESS"},{id:"armory",name:"Vpenkammer",description:"Dobbelt s effektiv rekruttering.",cost:{gold:150},benefit:"DRAFT_BONUS"},{id:"stables",name:"Staller",description:"Raskere raids.",cost:{gold:100,wood:50},benefit:"RAID_SPEED"}],KING:[{id:"cathedral",name:"Katedral",description:"ker din legitimitet og skattevilje.",cost:{gold:500,stone:200},benefit:"ROYAL_AUTHORITY"},{id:"royal_guard",name:"Kongelig Garde",description:"Uovervinnelig defensiv styrke.",cost:{gold:400,iron:100},benefit:"ELITE_DEFENSE"}],SOLDIER:[{id:"knight_armor",name:"Ridderrustning",description:"Du tar mindre skade og ser tffere ut.",cost:{gold:100,swords:5},benefit:"ARMOR"},{id:"warhorse",name:"Stridshest",description:"Gjr deg til en Ridder. 2x XP fra kamp.",cost:{gold:200,grain:100},benefit:"KNIGHT"}],MERCHANT:[{id:"trade_license",name:"Handelsbrev",description:"Bedre salgspriser p markedet.",cost:{gold:150},benefit:"MARKET_BONUS"},{id:"accounting_books",name:"Regnskapsbker",description:"Gir passivt 5 gull per minutt.",cost:{gold:200,wood:20},benefit:"PASSIVE_GOLD_HIGH"},{id:"caravan",name:"Karavane",description:"Tjen penger p handel med utlandet.",cost:{gold:300,wood:50},benefit:"CARAVAN"}]},Cn={PEASANT:{FARMING:{level:1,xp:0,maxXp:100},WOODCUTTING:{level:1,xp:0,maxXp:100},MINING:{level:0,xp:0,maxXp:100},CRAFTING:{level:0,xp:0,maxXp:100},STEWARDSHIP:{level:0,xp:0,maxXp:100},COMBAT:{level:0,xp:0,maxXp:100},TRADING:{level:0,xp:0,maxXp:100},THEOLOGY:{level:0,xp:0,maxXp:100}},BARON:{FARMING:{level:3,xp:0,maxXp:300},WOODCUTTING:{level:3,xp:0,maxXp:300},MINING:{level:1,xp:0,maxXp:100},CRAFTING:{level:1,xp:0,maxXp:100},STEWARDSHIP:{level:5,xp:0,maxXp:1e3},COMBAT:{level:3,xp:0,maxXp:300},TRADING:{level:3,xp:0,maxXp:300},THEOLOGY:{level:1,xp:0,maxXp:100}},KING:{FARMING:{level:1,xp:0,maxXp:100},WOODCUTTING:{level:1,xp:0,maxXp:100},MINING:{level:1,xp:0,maxXp:100},CRAFTING:{level:1,xp:0,maxXp:100},STEWARDSHIP:{level:10,xp:0,maxXp:5e3},COMBAT:{level:5,xp:0,maxXp:1500},TRADING:{level:5,xp:0,maxXp:1500},THEOLOGY:{level:5,xp:0,maxXp:1500}},SOLDIER:{FARMING:{level:1,xp:0,maxXp:100},WOODCUTTING:{level:1,xp:0,maxXp:100},MINING:{level:0,xp:0,maxXp:100},CRAFTING:{level:1,xp:0,maxXp:100},STEWARDSHIP:{level:0,xp:0,maxXp:100},COMBAT:{level:5,xp:0,maxXp:1500},TRADING:{level:0,xp:0,maxXp:100},THEOLOGY:{level:0,xp:0,maxXp:100}},MERCHANT:{FARMING:{level:1,xp:0,maxXp:100},WOODCUTTING:{level:1,xp:0,maxXp:100},MINING:{level:0,xp:0,maxXp:100},CRAFTING:{level:2,xp:0,maxXp:200},STEWARDSHIP:{level:1,xp:0,maxXp:100},COMBAT:{level:0,xp:0,maxXp:100},TRADING:{level:5,xp:0,maxXp:1500},THEOLOGY:{level:0,xp:0,maxXp:100}}},K4={FARMING:{label:"Jordbruk",description:"Dyrking av mark, hsting av avlinger og husdyrhold.",color:"#10b981",bonuses:{2:"10% raskere hsting.",5:"Avlinger gir 20% mer utbytte.",10:"Mesterbonde: Lser opp avanserte avlinger."}},WOODCUTTING:{label:"Vedhogging",description:"Kunsten  felle trr og bearbeide tmmer.",color:"#8b5cf6",bonuses:{3:"15% raskere tmmerhogst.",7:"Sjanse for  finne sjelden kvae.",12:"Skovens vokter: kt utbytte fra alle trr."}},MINING:{label:"Gruvedrift",description:"Uthenting av malm og edle metaller fra fjellet.",color:"#f59e0b",bonuses:{4:"Bedre verktyeffektivitet i gruver.",8:"Lser opp utvinning av edelstener.",15:"Fjellkonge: Maksimalt utbytte fra dype rer."}},CRAFTING:{label:"Hndverk",description:"Smiing, snekring og tilvirking av avansert utstyr.",color:"#3b82f6",bonuses:{2:"Mindre materialsvinn ved refining.",5:"Bedre sjanse for hyere kvalitet.",10:"Stormester: Kan smie legendarisk utstyr."}},STEWARDSHIP:{label:"Godsforvaltning",description:"Administrasjon av land, folk og ressurser.",color:"#ec4899",bonuses:{5:"Redusert skattetrykk fra overordnede.",10:"kt passiv inntekt fra oppgraderinger.",20:"Rikets forvalter: Maksimal konomisk innsikt."}},COMBAT:{label:"Kamp",description:"Ferdighet i sverd, bue og forsvar av riket.",color:"#ef4444",bonuses:{3:"kt angrepskraft (+10%).",6:"Bedre forsvarsevne i beleiringer.",12:"Krigsherre: Fryktinngytende p slagmarken."}},TRADING:{label:"Handel",description:"Kjp, salg og markedsspekulering.",color:"#facc15",bonuses:{2:"Lavere gebyrer p markedet.",5:"Bedre priser ved handel med NPCs.",10:"Handelsfyrste: Kontroll over handelsruter."}},THEOLOGY:{label:"Teologi",description:"Tro, bnn og forstelse av det guddommelige.",color:"#6366f1",bonuses:{5:"Bnner gir mer stamina.",10:"Guddommelig beskyttelse mot ulykker.",15:"Helgen: Utstrler en aura av ro og verdighet."}}},ap={PEASANT:{},BARON:{MAIN_HAND:{id:"iron_sword",name:"Jernsverd",icon:"",type:"MAIN_HAND",durability:100,maxDurability:100,level:5,stats:{attack:10}},BODY:{id:"fine_clothes",name:"Fie Klr",icon:"",type:"BODY",durability:50,maxDurability:50,level:5,stats:{defense:2,speedBonus:1.1}}},KING:{MAIN_HAND:{id:"royal_scepter",name:"Kongens Septer",icon:"",type:"MAIN_HAND",durability:200,maxDurability:200,level:10,stats:{luckBonus:.2}},HEAD:{id:"crown",name:"Krone",icon:"",type:"HEAD",durability:100,maxDurability:100,level:10,stats:{luckBonus:.1}}},SOLDIER:{MAIN_HAND:{id:"iron_sword",name:"Jernsverd",icon:"",type:"MAIN_HAND",durability:100,maxDurability:100,level:3,stats:{attack:8}},OFF_HAND:{id:"wooden_shield",name:"Treskjold",icon:"",type:"OFF_HAND",durability:50,maxDurability:50,level:2,stats:{defense:5}},BODY:{id:"leather_armor",name:"Lrrustning",icon:"",type:"BODY",durability:80,maxDurability:80,level:2,stats:{defense:5}}},MERCHANT:{MAIN_HAND:{id:"walking_stick",name:"Vandrestav",icon:"",type:"MAIN_HAND",durability:50,maxDurability:50,level:2,stats:{speedBonus:1.05}},TRINKET:{id:"abacus",name:"Kuleramme",icon:"",type:"TRINKET",durability:100,maxDurability:100,level:3,stats:{yieldBonus:2}}}},Se={tools:{id:"tools",name:"Verkty",icon:"",type:"MAIN_HAND",durability:100,maxDurability:100,level:1,description:"Grunnleggende verkty."},weapon:{id:"weapon",name:"Enkelt Sverd",icon:"",type:"MAIN_HAND",durability:100,maxDurability:100,level:1,description:"Et enkelt sverd."},armor:{id:"armor",name:"Enkel Rustning",icon:"",type:"BODY",durability:100,maxDurability:100,level:1,description:"Beskyttende rustning."},stone_axe:{id:"stone_axe",name:"Steinks",icon:"",type:"AXE",durability:30,maxDurability:30,level:1,description:"Primitiv ks hugget fra mrke fjell. Sagnet sier at de frste fedrene brukte slike til  bane vei gjennom de tette skogene fr sivilisasjonens inntog. +1 Utbytte.",stats:{yieldBonus:1},relevantActions:["CHOP"],nextTierId:"iron_axe"},stone_pickaxe:{id:"stone_pickaxe",name:"Steinhakke",icon:"",type:"PICKAXE",durability:30,maxDurability:30,level:1,description:"En enkel hakke i flint og tre. Brukt i generasjoner av de som sker fjellets hemmeligheter. +1 Utbytte.",stats:{yieldBonus:1},relevantActions:["MINE"],nextTierId:"iron_pickaxe"},rusty_axe:{id:"rusty_axe",name:"Rusten ks",icon:"",type:"AXE",durability:50,maxDurability:50,level:1,description:"Et glemt relikvie fra en svunnen tid, n bare en skygge av sin fordums prakt. Slv og uplitelig.",stats:{yieldBonus:0},relevantActions:["CHOP"],nextTierId:"stone_axe"},iron_axe:{id:"iron_axe",name:"Jernks",icon:"",type:"AXE",durability:100,maxDurability:100,level:3,description:"Smid i landsbyens esse under fullmnen. Jernet synger nr det treffer treverket. +3 Utbytte.",stats:{yieldBonus:3},relevantActions:["CHOP"],nextTierId:"steel_axe"},iron_pickaxe:{id:"iron_pickaxe",name:"Jernhakke",icon:"",type:"PICKAXE",durability:100,maxDurability:100,level:3,description:"Tung og balansert. Laget for  trenge dypt inn i rikets rike rer. +3 Utbytte.",stats:{yieldBonus:3},relevantActions:["MINE"],nextTierId:"steel_pickaxe"},stone_chisel:{id:"stone_chisel",name:"Steinmeisel",icon:"",type:"CHISEL",durability:30,maxDurability:30,level:1,description:"En enkel meisel av herdet stein. Perfekt for  forme steinblokker. +1 Utbytte.",stats:{yieldBonus:1},relevantActions:["QUARRY"],nextTierId:"iron_chisel"},iron_chisel:{id:"iron_chisel",name:"Jernmeisel",icon:"",type:"CHISEL",durability:80,maxDurability:80,level:3,description:"Smid i landsbyens esse. Gjr steinhugging til en lek. +3 Utbytte.",stats:{yieldBonus:3},relevantActions:["QUARRY"],nextTierId:"steel_chisel"},royal_scepter:{id:"royal_scepter",name:"Kongens Septer",icon:"",type:"MAIN_HAND",durability:200,maxDurability:200,level:10,description:"Et symbol p guddommelig rett og folkets vilje. Det glitrer med en makt som kan bye selve skjebnen. +20% Flaks.",stats:{luckBonus:.2}},steel_axe:{id:"steel_axe",name:"Stlks",icon:"",type:"AXE",durability:200,maxDurability:200,level:8,description:"Mesterlig stl. +8 Utbytte, 20% raskere arbeid.",stats:{yieldBonus:8,speedBonus:1.2},relevantActions:["CHOP"]},steel_hja:{id:"steel_hja",name:"Stlhj",icon:"",type:"SCYTHE",durability:120,maxDurability:120,level:4,description:"Sylskarp hj. +5 Utbytte, 10% raskere hsting.",stats:{yieldBonus:5,speedBonus:1.1},relevantActions:["WORK","HST"]},stone_sickle:{id:"stone_sickle",name:"Steinsigd",icon:"",type:"SCYTHE",durability:40,maxDurability:40,level:1,description:"Enkel sigd for jordbruk. +1 Utbytte ved kornhsting.",stats:{yieldBonus:1},relevantActions:["WORK"]},blacksmith_hammer:{id:"blacksmith_hammer",name:"Smedhammer",icon:"",type:"HAMMER",durability:200,maxDurability:200,level:5,description:"Mesterverkty. 20% raskere smiing.",stats:{speedBonus:1.2},relevantActions:["CRAFT","REFINE","SMELT"]},shears:{id:"shears",name:"Saks",icon:"",type:"MAIN_HAND",durability:50,maxDurability:50,level:1,description:"Brukt til  klippe sauer. Helt ndvendig for ull-produksjon.",stats:{yieldBonus:2},relevantActions:["GATHER_WOOL"]},iron_sword:{id:"iron_sword",name:"Jernsverd",icon:"",type:"MAIN_HAND",durability:100,maxDurability:100,level:5,description:"Standard sverd. +10 Angrepskraft.",stats:{attack:10},relevantActions:["DEFEND","PATROL","EXPLORE","HUNT"],nextTierId:"steel_sword"},steel_sword:{id:"steel_sword",name:"Stlsverd",icon:"",type:"MAIN_HAND",durability:250,maxDurability:250,level:10,description:"Ddelig stl. +25 Angrep, 10% raskere hugg.",stats:{attack:25,speedBonus:1.1},relevantActions:["DEFEND","PATROL","EXPLORE","HUNT"]},tunic:{id:"tunic",name:"Slitt Tunika",icon:"",type:"BODY",durability:20,maxDurability:20,level:1,description:"Gammel og hullete. Minimal beskyttelse.",stats:{defense:1},relevantActions:["DEFEND","PATROL"],nextTierId:"leather_armor"},leather_armor:{id:"leather_armor",name:"Lrrustning",icon:"",type:"BODY",durability:80,maxDurability:80,level:3,description:"Herdet skinn. +5 Forsvar.",stats:{defense:5},relevantActions:["DEFEND","PATROL"],nextTierId:"iron_armor"},whetstone:{id:"whetstone",name:"Bryne",icon:"",type:"OFF_HAND",durability:10,maxDurability:10,level:1,description:"Bruk bryne for  holde verkty skarpe. Gir +1 i utbytte p de fleste sanke-oppgaver.",stats:{yieldBonus:1},relevantActions:["CHOP","MINE","QUARRY","WORK","GATHER_WOOL"]},hunting_bow:{id:"hunting_bow",name:"Jaktbue",icon:"",type:"BOW",durability:80,maxDurability:80,level:1,description:"En stdig bue av barlind. +2 Utbytte.",stats:{yieldBonus:2},relevantActions:["HUNT"],nextTierId:"longbow"},longbow:{id:"longbow",name:"Langbue",icon:"",type:"BOW",durability:150,maxDurability:150,level:5,description:"En mektig langbue som krever styrke  spenne. +5 Utbytte, 10% raskere.",stats:{yieldBonus:5,speedBonus:1.1},relevantActions:["HUNT"]},hunting_trap:{id:"hunting_trap",name:"Jaktfelle",icon:"",type:"TRAP",durability:30,maxDurability:30,level:1,description:"En enkel snarefangst-felle. +1 Utbytte ved smviltjakt.",stats:{yieldBonus:1},relevantActions:["HUNT","FORAGE"]},omelette:{id:"omelette",name:"Omelett",icon:"",type:"CONSUMABLE",durability:1,maxDurability:1,level:1,description:'En nringsrik frokost. Gir buff: "Lett til beins" (20% mindre stamina kostnad i 15 min).',stats:{},relevantActions:["CONSUME"]},bread:{id:"bread",name:"Brd",icon:"",type:"CONSUMABLE",durability:1,maxDurability:1,level:1,description:"Ferskt brd fra bakeriet. Gjenoppretter +20 Stamina.",stats:{},relevantActions:["CONSUME"]}},A0={grain:{label:"Kornker",seed:"grain",yieldResource:"grain",duration:3*60*1e3,minYield:15,maxYield:25,xp:20}},Ut={farm_house:{id:"farm_house",name:"Grdshuset",icon:"",locationId:"peasant_farm",description:"Ditt personlige hjem. Oppgraderinger gir bedre hvile og mer matlagingsplass.",levels:{1:{requirements:{},unlocks:["SLEEP","EAT"],bonus:"Base hvile"},2:{requirements:{wood:50,gold:100},unlocks:["FARM_UPGRADE"],bonus:"+20% Stamina fra peisen"},3:{requirements:{plank:20,stone:50,gold:300},unlocks:["FARM_UPGRADE_MASTER"],bonus:"+30% Stamina fra senga"},4:{requirements:{plank:50,stone:100,gold:600},unlocks:["FARM_UPGRADE_ELITE"],bonus:"+50% Stamina fra hvile"},5:{requirements:{plank:100,stone:200,gold:1e3,iron_ingot:20},unlocks:["FARM_UPGRADE_GODLY"],bonus:"Restaurerer all Stamina ved hvile"}}},sawmill:{id:"sawmill",name:"Sagbruk",icon:"",locationId:"village",description:"Gjr det mulig  foredle Ved til Tmmer.",levels:{1:{requirements:{},unlocks:["REFINE_PLANK_BASIC","hunting_bow"],bonus:"Base produksjon"},2:{requirements:{wood:100,stone:50,gold:100},unlocks:["REFINE_PLANK_FAST"],bonus:"+10% Woodcutting XP"},3:{requirements:{plank:50,stone:150,gold:300},unlocks:["REFINE_PLANK_MASTER","longbow"],bonus:"Lser opp Tier 3 verkty og Langbue"}}},windmill:{id:"windmill",name:"Vindmlle",icon:"",locationId:"village",description:"Gjr det mulig  foredle Korn til Mel mer effektivt.",levels:{1:{requirements:{},unlocks:["REFINE_FLOUR_BASIC"],bonus:"Base produksjon"},2:{requirements:{plank:30,stone:50,gold:150},unlocks:["REFINE_FLOUR_FAST"],bonus:"+10% Farming XP"},3:{requirements:{plank:100,stone:200,gold:500},unlocks:["REFINE_FLOUR_AUTO"],bonus:"Sjanse for dobbel avling"}}},smeltery:{id:"smeltery",name:"Smeltehytte",icon:"",locationId:"village",description:"Gjr det mulig  smelte Jernmalm til Jernbarrer.",levels:{1:{requirements:{},unlocks:["REFINE_IRON_BASIC"],bonus:"Base produksjon"},2:{requirements:{stone:150,wood:100,gold:200},unlocks:["REFINE_IRON_FAST"],bonus:"+10% Mining XP"},3:{requirements:{stone:300,plank:50,gold:600},unlocks:["REFINE_STEEL","glass"],bonus:"Lser opp Stl og Glass"}}},great_forge:{id:"great_forge",name:"Storsmie",icon:"",locationId:"village",description:"Gjr det mulig  lage avanserte verkty og vpen.",levels:{1:{requirements:{},unlocks:["stone_axe","stone_pickaxe","stone_sickle","whetstone","hunting_trap"],bonus:"Base produksjon"},2:{requirements:{iron_ingot:20,plank:30,gold:300},unlocks:["iron_axe","iron_pickaxe","iron_sword","leather_armor","shears","siege_swords","siege_armor"],bonus:"+10% Crafting XP"},3:{requirements:{iron_ingot:100,plank:100,gold:1e3},unlocks:["steel_axe","steel_sword","blacksmith_hammer","repair_advanced"],bonus:"Lser opp Mester-utstyr"}}},bakery:{id:"bakery",name:"Bakeri",icon:"",locationId:"village",description:"Gjr det mulig  bake Brd fra Mel.",levels:{1:{requirements:{},unlocks:["CRAFT_BREAD","CRAFT_omelette"],bonus:"Base produksjon"},2:{requirements:{stone:50,plank:20,gold:100},unlocks:["CRAFT_PIE"],bonus:"Bedre stamina fra mat"},3:{requirements:{stone:150,plank:50,gold:400},unlocks:["CRAFT_FEAST"],bonus:"Lser opp Gildemltid"}}},tavern:{id:"tavern",name:"Vertshuset",icon:"",locationId:"village",description:"Et sted for hvile og rykter. ker stamina-regenerering.",levels:{1:{requirements:{},unlocks:["ENTER_TAVERN","REST_BASIC","BUY_MEAL","OPEN_DICE_GAME","CHAT_LOCAL"],bonus:"Standard hvile"},2:{requirements:{wood:100,stone:50,gold:250},unlocks:["REST_COMFY"],bonus:"Dobbel stamina-regen"},3:{requirements:{plank:50,stone:150,gold:750},unlocks:["REST_ROYAL"],bonus:"Gjenoppretter all stamina raskt"}}},weavery:{id:"weavery",name:"Veveri",icon:"",locationId:"village",description:"Foredler Ull til Stoff for videre salg eller klr.",levels:{1:{requirements:{},unlocks:["REFINE_CLOTH_BASIC"],bonus:"Base produksjon"},2:{requirements:{plank:40,stone:30,gold:150},unlocks:["REFINE_CLOTH_FAST"],bonus:"+10% Trading XP"},3:{requirements:{plank:100,stone:100,gold:400},unlocks:["REFINE_CLOTH_MASTER"],bonus:"Lser opp Silke-produksjon"}}},well:{id:"well",name:"Bybrnn",icon:"",locationId:"village",description:"Gir tilgang til ferskvann for baking og hygiene.",levels:{1:{requirements:{},unlocks:["GATHER_WATER"],bonus:"Basiskilde"},2:{requirements:{stone:50,gold:50},unlocks:["GATHER_WATER_FAST"],bonus:"Bedre vanntilgang"},3:{requirements:{stone:150,gold:200},unlocks:["GATHER_WATER_MASTER"],bonus:"Hellig kilde: +5 Stamina ved drikking"}}},apothecary:{id:"apothecary",name:"Apoteker",icon:"",locationId:"village",description:"Fremstiller medisin og salver.",levels:{1:{requirements:{},unlocks:["CRAFT_MEDICINE"],bonus:"Basis urter"},2:{requirements:{plank:20,wood:50,gold:150},unlocks:["CRAFT_POISON"],bonus:"Kunnskap om gift"},3:{requirements:{plank:50,glass:20,gold:500},unlocks:["CRAFT_ELIXIR"],bonus:"Livseliksir"}}},watchtower:{id:"watchtower",name:"Vaktrn",icon:"",locationId:"village",description:"Bedre oversikt og forsvar av landsbyen.",levels:{1:{requirements:{},unlocks:["PATROL"],bonus:"+5 Forsvar"},2:{requirements:{stone:100,plank:50,gold:200},unlocks:["SCOUT"],bonus:"+15 Forsvar"},3:{requirements:{stone:300,plank:100,gold:800},unlocks:["VOLLEY"],bonus:"Bueskytter-sttte i kamp"}}},stables:{id:"stables",name:"Stall",icon:"",locationId:"village",description:"Muliggjr raskere reise og kavaleri.",levels:{1:{requirements:{},unlocks:["MOUNT_HORSE"],bonus:"Transport"},2:{requirements:{plank:50,wood:50,gold:150},unlocks:["BREED_WARHORSE"],bonus:"Stridshester"},3:{requirements:{plank:150,iron_ingot:20,gold:400},unlocks:["KNIGHT_TRAINING"],bonus:"Riddere"}}},manor_ost:{id:"manor_ost",name:"Slott st",icon:"",locationId:"castle",description:"Setet til den stlige herre. Krever enorme ressurser  bygge.",levels:{1:{requirements:{stone:500,plank:300,iron_ingot:50,gold:1e3},unlocks:["BARON_STATUS"],bonus:"Krav p regionen"}}},manor_vest:{id:"manor_vest",name:"Slott Vest",icon:"",locationId:"castle",description:"Setet til den vestlige herre. Krever enorme ressurser  bygge.",levels:{1:{requirements:{stone:500,plank:300,iron_ingot:50,gold:1e3},unlocks:["BARON_STATUS"],bonus:"Krav p regionen"}}},throne_room:{id:"throne_room",name:"Slottet",icon:"",locationId:"castle",description:"Kongens stol. Den frste Baronen som fullfrer denne blir Konge.",levels:{1:{requirements:{stone:2e3,plank:1e3,iron_ingot:200,gold:5e3},unlocks:["KING_STATUS"],bonus:"Krav p riket"}}}},_r={plank:{label:"Planker",icon:"",input:{wood:5},outputResource:"plank",outputAmount:1,buildingId:"sawmill",stamina:10,xp:5,skill:"WOODCUTTING"},flour:{label:"Fint Mel",icon:"",input:{grain:10},outputResource:"flour",outputAmount:10,buildingId:"windmill",stamina:15,xp:8,skill:"FARMING",duration:12e4},iron_ingot:{label:"Jernbarre",icon:"",input:{iron_ore:5,wood:2},outputResource:"iron_ingot",outputAmount:1,buildingId:"smeltery",stamina:20,xp:12,skill:"CRAFTING"},bread:{label:"Bondebrd",icon:"",input:{flour:2},outputResource:"bread",outputAmount:5,buildingId:"bakery",stamina:5,xp:3,skill:"CRAFTING"},pie:{label:"Kjttpai",icon:"",input:{flour:4,meat:2},outputResource:"bread",outputAmount:15,buildingId:"bakery",stamina:15,xp:10,skill:"CRAFTING"},mead:{label:"Mjd",icon:"",input:{honey:5},outputResource:"stamina",outputAmount:20,buildingId:"tavern",stamina:5,xp:5,skill:"CRAFTING"},cloth:{label:"Lin-stoff",icon:"",input:{wool:5},outputResource:"cloth",outputAmount:1,buildingId:"weavery",stamina:15,xp:10,skill:"CRAFTING"},glass:{label:"Glass",icon:"",input:{stone:10,wood:5},outputResource:"glass",outputAmount:1,buildingId:"smeltery",requiredLevel:3,stamina:25,xp:15,skill:"CRAFTING"},elixir:{label:"Livseliksir",icon:"",input:{honey:10,glass:1},outputResource:"stamina",outputAmount:100,buildingId:"apothecary",requiredLevel:3,stamina:30,xp:25,skill:"CRAFTING"}},Rn={stone_axe:{label:"Steinks",icon:"",input:{stone:10,wood:5,gold:5},outputItemId:"stone_axe",buildingId:"great_forge",level:1,stamina:15,xp:10,description:"Et enkelt redskap for tmmerhogst.",skill:"CRAFTING"},stone_pickaxe:{label:"Steinhakke",icon:"",input:{stone:10,wood:5,gold:5},outputItemId:"stone_pickaxe",buildingId:"great_forge",level:1,stamina:15,xp:10,description:"En primitiv hakke for gruvearbeid.",skill:"CRAFTING"},stone_sickle:{label:"Steinsigd",icon:"",input:{stone:5,wood:5,gold:10},outputItemId:"stone_sickle",buildingId:"great_forge",level:1,stamina:10,xp:5,description:"Enkel sigd for kornhsting.",skill:"CRAFTING"},whetstone:{label:"Bryne",icon:"",input:{stone:15,gold:20},outputItemId:"whetstone",buildingId:"great_forge",level:1,stamina:10,xp:5,description:"Brukt for  slipe verkty og ke utbyttet.",skill:"CRAFTING"},stone_chisel:{label:"Steinmeisel",icon:"",input:{stone:10,gold:10},outputItemId:"stone_chisel",buildingId:"great_forge",level:1,stamina:10,xp:8,description:"Ndvendig for  hugge stein i steinhuggeriet.",skill:"CRAFTING"},iron_chisel:{label:"Jernmeisel",icon:"",input:{iron_ingot:5,gold:80},outputItemId:"iron_chisel",buildingId:"great_forge",level:2,stamina:20,xp:15,description:"Effektiv mesiel for steinhugging.",skill:"CRAFTING"},iron_axe:{label:"Jernks",icon:"",input:{iron_ingot:5,plank:2,gold:50},outputItemId:"iron_axe",buildingId:"great_forge",level:2,stamina:25,xp:20,description:"Et solid verkty av jern.",skill:"CRAFTING"},iron_pickaxe:{label:"Jernhakke",icon:"",input:{iron_ingot:5,plank:2,gold:50},outputItemId:"iron_pickaxe",buildingId:"great_forge",level:2,stamina:25,xp:20,description:"Effektiv hakke for dypere graving.",skill:"CRAFTING"},iron_sword:{label:"Jernsverd",icon:"",input:{iron_ingot:10,plank:2,gold:100},outputItemId:"iron_sword",buildingId:"great_forge",level:2,stamina:40,xp:35,description:"Et skarpt sverd for krigere.",skill:"CRAFTING"},leather_armor:{label:"Lrrustning",icon:"",input:{cloth:10,gold:150},outputItemId:"leather_armor",buildingId:"great_forge",level:2,stamina:30,xp:25,description:"God beskyttelse for en reisende.",skill:"CRAFTING"},shears:{label:"Saks",icon:"",input:{iron_ingot:5,gold:100},outputItemId:"shears",buildingId:"great_forge",level:2,stamina:20,xp:15,description:"Ndvendig for  klippe sauer og f ull.",skill:"CRAFTING"},siege_swords:{label:"Beleiringsvpen (x10)",icon:"",input:{iron_ingot:5,plank:5,gold:50},outputItemId:"swords",outputAmount:10,buildingId:"great_forge",level:2,stamina:40,xp:30,description:"En kasse med vpen til garnisonen.",skill:"CRAFTING"},siege_armor:{label:"Beleiringsrustning (x10)",icon:"",input:{iron_ingot:5,cloth:5,gold:50},outputItemId:"armor",outputAmount:10,buildingId:"great_forge",level:2,stamina:40,xp:30,description:"En kasse med rustninger til garnisonen.",skill:"CRAFTING"},steel_axe:{label:"Stlks",icon:"",input:{iron_ingot:20,plank:10,gold:250},outputItemId:"steel_axe",buildingId:"great_forge",level:3,stamina:50,xp:50,description:"Mesterlig utformet ks av herdet stl.",skill:"CRAFTING"},steel_sword:{label:"Stlsverd",icon:"",input:{iron_ingot:30,plank:5,gold:500},outputItemId:"steel_sword",buildingId:"great_forge",level:3,stamina:80,xp:100,description:"Det ultimate vpenet for en herre.",skill:"CRAFTING"},blacksmith_hammer:{label:"Smedhammer",icon:"",input:{iron_ingot:15,plank:5,gold:200},outputItemId:"blacksmith_hammer",buildingId:"great_forge",level:3,stamina:40,xp:50,description:"Mesterverkty for en ekte smed.",skill:"CRAFTING"},omelette:{label:"Omelett",icon:"",input:{egg:3},outputItemId:"omelette",buildingId:"bakery",level:1,stamina:10,xp:8,description:"En mettende frokost. Gir energi-buff.",skill:"CRAFTING"},hunting_trap:{label:"Jaktfelle",icon:"",input:{wood:10,iron_ingot:2,gold:30},outputItemId:"hunting_trap",buildingId:"great_forge",level:1,stamina:20,xp:15,description:"En enkel snare for smvilt.",skill:"CRAFTING"},hunting_bow:{label:"Jaktbue",icon:"",input:{plank:5,cloth:5,gold:50},outputItemId:"hunting_bow",buildingId:"sawmill",level:1,stamina:25,xp:20,description:"En stdig bue for jakt.",skill:"CRAFTING"},longbow:{label:"Langbue",icon:"",input:{plank:15,cloth:10,iron_ingot:1,gold:250},outputItemId:"longbow",buildingId:"sawmill",level:3,stamina:40,xp:45,description:"En kraftig bue med lang rekkevidde.",skill:"CRAFTING"}},Ol={KING:{label:"Konge",description:"Styrer riket, krever skatt og dmmer i store saker."},BARON:{label:"Baron",description:"Styrer en region, krever inn skatt fra bnder, og beskytter mot krig."},PEASANT:{label:"Bonde",description:"Produserer mat og ressurser. Betaler skatt."},SOLDIER:{label:"Soldat",description:"Beskytter riket og deltar i raids."},MERCHANT:{label:"Kjpmann",description:"Tjener penger p handel og markedsspekulasjon."}},Y4={PEASANT:["Trell","Leilending","Selveier","Storbondi","Odalbonde"],BARON:["Landmann","Vpner","Ridder","Baron","Grev"],KING:["Prins","Hertug","Konungr"],SOLDIER:["Rekrutt","Vakt","Kjempe","Hvding"],MERCHANT:["Gutt","Svenn","Mester","Hanseat"]},q4={PEASANT:[["Basis rettigheter som bonde."],["+10% resurseffektivitet ved innhsting."],["Redusert skattetreff (-5%) fra din lensherre."],["Lser opp bruk av spesialverkty og ploger."],["Fullstendig selveie: Maksimal frihet og prestisje."]],BARON:[["Rett til  kreve inn skatt i din region."],["+20% forsvarsstyrke for dine vakter."],["Lser opp bygging av avanserte steinborger."],["Hyere status i Tinget: Dine stemmer teller mer."],["Maksimal autoritet og kontroll over landegrenser."]],KING:[["Gunst fra understtene og rett til tronen."],["Nasjonal autoritet: Kan passere lover uten Tinget."],["Gudegitt makt: Maksimal legitimitet og kontroll."]],SOLDIER:[["Grunnleggende kamptrening og utstyr."],["+15% skade i raids og forsvar."],["Lser opp bruk av tunge rustninger og hester."],["Elite-kriger: Fryktet over hele riket."]],MERCHANT:[["Rett til  drive handel p markedsplassen."],["Bedre priser ved kjp og salg (+10%)."],["Lser opp utlandshandel og karavaner."],["Finansfyrste: Kontrollerer markedstrender."]]},bt={grain:{price:10,stock:500,demand:1},flour:{price:15,stock:100,demand:1},bread:{price:25,stock:50,demand:1},wood:{price:15,stock:300,demand:1},plank:{price:25,stock:100,demand:1},iron_ore:{price:30,stock:100,demand:1},iron_ingot:{price:60,stock:50,demand:1},stone:{price:20,stock:200,demand:1},swords:{price:80,stock:20,demand:1},armor:{price:120,stock:10,demand:1},wool:{price:12,stock:200,demand:1},cloth:{price:45,stock:50,demand:1},honey:{price:30,stock:50,demand:1},meat:{price:25,stock:100,demand:1},glass:{price:50,stock:20,demand:1},iron:{price:40,stock:0,demand:1}},W4=[{type:"RAID",title:"Vikinger p horisonten!",description:"Et vikingskip er sett nr kysten. Forsvar jordene fr de stjeler kornet!",locationId:"fields"},{type:"RAID",title:"Bandittleir funnet",description:"Banditter har sltt seg ned i skogen. De stjeler ved hver time!",locationId:"forest"},{type:"QUEST",title:"Den Hellige Gral?",description:"Rykter sier en eremitt ved klosteret har funnet noe verdifullt.",locationId:"village"},{type:"QUEST",title:"Markedsdag i nabolaget",description:"En sjelden mulighet for god handel p grensen.",locationId:"marketplace"}],X4=[{id:"tax_cut",label:"Skattekutt",description:"Alle skatter halveres i 10 minutter. Lojaliteten stiger."},{id:"peace",label:"Fredsavtale",description:"Ingen raids tillatt de neste 10 minuttene."},{id:"salt_tax",label:"Saltskatt",description:"ker kornprisene, men reduserer lojalitet."},{id:"conscription",label:"Verneplikt",description:"Soldater koster mindre  verve, men bnder jobber 20% tregere."}],dy=Object.freeze(Object.defineProperty({__proto__:null,ACTION_COSTS:hc,ACTION_ICONS:xd,CRAFTING_RECIPES:Rn,CROP_DATA:A0,GAME_BALANCE:q,INITIAL_EQUIPMENT:ap,INITIAL_MARKET:bt,INITIAL_RESOURCES:At,INITIAL_SKILLS:Cn,ITEM_TEMPLATES:Se,LAW_TEMPLATES:X4,LEVEL_XP:bd,RANK_BENEFITS:q4,REFINERY_RECIPES:_r,REPAIR_CONFIG:rp,RESOURCE_DETAILS:hn,REWARDS:fc,ROLE_DEFINITIONS:Ol,ROLE_TITLES:Y4,SEASONS:An,SKILL_DETAILS:K4,UPGRADES_LIST:T0,VILLAGE_BUILDINGS:Ut,WEATHER:xs,WORLD_EVENT_TEMPLATES:W4},Symbol.toStringTag,{value:"Module"}));/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q4=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),J4=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,s)=>s?s.toUpperCase():n.toLowerCase()),fy=t=>{const e=J4(t);return e.charAt(0).toUpperCase()+e.slice(1)},yS=(...t)=>t.filter((e,n,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===n).join(" ").trim(),Z4=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var e3={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t3=_.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:i="",children:r,iconNode:a,...o},l)=>_.createElement("svg",{ref:l,...e3,width:e,height:e,stroke:t,strokeWidth:s?Number(n)*24/Number(e):n,className:yS("lucide",i),...!r&&!Z4(o)&&{"aria-hidden":"true"},...o},[...a.map(([u,d])=>_.createElement(u,d)),...Array.isArray(r)?r:[r]]));/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=(t,e)=>{const n=_.forwardRef(({className:s,...i},r)=>_.createElement(t3,{ref:r,iconNode:e,className:yS(`lucide-${Q4(fy(t))}`,`lucide-${t}`,s),...i}));return n.displayName=fy(t),n};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n3=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],hy=ae("activity",n3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s3=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],va=ae("arrow-right",s3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i3=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],r3=ae("brain",i3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a3=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],R0=ae("check",a3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o3=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],l3=ae("chevron-down",o3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],op=ae("circle-alert",c3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u3=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],my=ae("clock",u3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d3=[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]],_S=ae("coins",d3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f3=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],bf=ae("crown",f3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],m3=ae("disc",h3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p3=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],g3=ae("eye-off",p3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v3=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],b3=ae("eye",v3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x3=[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]],wS=ae("gift",x3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],_3=ae("globe",y3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w3=[["path",{d:"m15 12-9.373 9.373a1 1 0 0 1-3.001-3L12 9",key:"1hayfq"}],["path",{d:"m18 15 4-4",key:"16gjal"}],["path",{d:"m21.5 11.5-1.914-1.914A2 2 0 0 1 19 8.172v-.344a2 2 0 0 0-.586-1.414l-1.657-1.657A6 6 0 0 0 12.516 3H9l1.243 1.243A6 6 0 0 1 12 8.485V10l2 2h1.172a2 2 0 0 1 1.414.586L18.5 14.5",key:"15ts47"}]],E3=ae("hammer",w3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N3=[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]],I0=ae("handshake",N3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k3=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],S3=ae("layout-grid",k3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T3=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],py=ae("loader-circle",T3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A3=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],C0=ae("lock",A3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R3=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],I3=ae("mail",R3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C3=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],ES=ae("map-pin",C3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j3=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],O3=ae("map",j3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M3=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],D3=ae("menu",M3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L3=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],Ml=ae("message-square",L3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P3=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],B3=ae("music",P3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U3=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],H3=ae("package",U3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G3=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],lp=ae("pause",G3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V3=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],yd=ae("play",V3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F3=[["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]],z3=ae("scroll",F3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $3=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],K3=ae("search",$3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y3=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],NS=ae("send",Y3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q3=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],W3=ae("settings",q3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X3=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],gy=ae("shield-check",X3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q3=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],j0=ae("shield",Q3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J3=[["path",{d:"M17.971 4.285A2 2 0 0 1 21 6v12a2 2 0 0 1-3.029 1.715l-9.997-5.998a2 2 0 0 1-.003-3.432z",key:"15892j"}],["path",{d:"M3 20V4",key:"1ptbpl"}]],Z3=ae("skip-back",J3);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eP=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],tP=ae("skip-forward",eP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nP=[["path",{d:"m11 19-6-6",key:"s7kpr"}],["path",{d:"m5 21-2-2",key:"1kw20b"}],["path",{d:"m8 16-4 4",key:"1oqv8h"}],["path",{d:"M9.5 17.5 21 6V3h-3L6.5 14.5",key:"pkxemp"}]],cp=ae("sword",nP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sP=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],iP=ae("trending-up",sP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rP=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],vy=ae("triangle-alert",rP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aP=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],oP=ae("trophy",aP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lP=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],xf=ae("user",lP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cP=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],O0=ae("users",cP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uP=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],dP=ae("volume-2",uP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fP=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ji=ae("x",fP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hP=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],mP=ae("zap",hP),pP=t=>{const e=Object.keys(t),n=[...e].sort(()=>Math.random()-.5),s={...t};if(e.length===0)return s;const r=n.shift();r&&(s[r]={...s[r],role:"KING",resources:JSON.parse(JSON.stringify(At.KING)),regionId:"capital",status:{hp:100,stamina:100,morale:100,legitimacy:100,authority:100,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:1,xp:0,reputation:50,contribution:0},equipment:{MAIN_HAND:{id:"tools",name:"Kongens Verkty",icon:"",type:"MAIN_HAND",level:1,durability:100,maxDurability:100},OFF_HAND:{id:"weapon",name:"Kongens Sverd",icon:"",type:"OFF_HAND",level:1,durability:100,maxDurability:100},BODY:{id:"armor",name:"Kongens Rustning",icon:"",type:"BODY",level:1,durability:100,maxDurability:100}}});const o=Math.min(2,n.length);for(let m=0;m<o;m++){const v=n.shift();if(v){const b=m===0?"region_ost":"region_vest";s[v]={...s[v],role:"BARON",resources:JSON.parse(JSON.stringify(At.BARON)),regionId:b,status:{hp:100,stamina:100,morale:100,legitimacy:80,authority:50,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:1,xp:0,reputation:40,contribution:0},equipment:{MAIN_HAND:{id:"tools",name:"Baronens Verkty",icon:"",type:"MAIN_HAND",level:1,durability:100,maxDurability:100},OFF_HAND:{id:"weapon",name:"Baronens Sverd",icon:"",type:"OFF_HAND",level:1,durability:100,maxDurability:100},BODY:{id:"armor",name:"Baronens Rustning",icon:"",type:"BODY",level:1,durability:100,maxDurability:100}}}}}let l=0;const u=()=>{const m=l%2===0?"region_ost":"region_vest";return l++,m},d=n.length;let f=0,h=0;d>=4?(f=Math.max(1,Math.floor(d/6)),h=Math.max(1,Math.floor(d/5))):d>0&&d<4&&(f=0,h=0);for(let m=0;m<f;m++){const v=n.shift();v&&(s[v]={...s[v],role:"MERCHANT",resources:JSON.parse(JSON.stringify(At.MERCHANT)),regionId:u(),status:{hp:100,stamina:100,morale:100,legitimacy:100,authority:30,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:1,xp:0,reputation:30,contribution:0},equipment:{MAIN_HAND:{id:"tools",name:"Hndverkty",icon:"",type:"MAIN_HAND",level:1,durability:100,maxDurability:100},OFF_HAND:{id:"weapon",name:"Kort sverd",icon:"",type:"OFF_HAND",level:1,durability:100,maxDurability:100},BODY:{id:"armor",name:"Kjpmannskappe",icon:"",type:"BODY",level:1,durability:100,maxDurability:100}}})}for(let m=0;m<h;m++){const v=n.shift();v&&(s[v]={...s[v],role:"SOLDIER",resources:JSON.parse(JSON.stringify(At.SOLDIER)),regionId:u(),status:{hp:100,stamina:100,morale:100,legitimacy:100,authority:50,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:1,xp:0,reputation:20,contribution:0},equipment:{MAIN_HAND:{id:"tools",name:"Feltverkty",icon:"",type:"MAIN_HAND",level:1,durability:100,maxDurability:100},OFF_HAND:{id:"weapon",name:"Soldatens Sverd",icon:"",type:"OFF_HAND",level:1,durability:100,maxDurability:100},BODY:{id:"armor",name:"Brynjekofte",icon:"",type:"BODY",level:1,durability:100,maxDurability:100}}})}for(;n.length>0;){const m=n.shift();m&&(s[m]={...s[m],role:"PEASANT",resources:JSON.parse(JSON.stringify(At.PEASANT)),regionId:u(),status:{hp:100,stamina:100,morale:80,legitimacy:100,authority:10,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:1,xp:0,reputation:10,contribution:0},equipment:{}})}return s},gP=(t,e)=>{const n={...t},s=[];return Object.values(n).forEach(i=>{if(i.role==="PEASANT"){const a=Math.ceil((i.resources.grain||0)*.15),o=Math.ceil((i.resources.gold||0)*(15/100));if(a>0||o>0){const l=Object.values(n).find(u=>u.role==="BARON"&&(u.regionId===i.regionId||i.regionId==="test_region"&&u.regionId==="test_region"));l&&(i.resources.grain=Math.max(0,i.resources.grain-a),i.resources.gold=Math.max(0,i.resources.gold-o),n[l.id].resources.grain+=a,n[l.id].resources.gold+=o,s.push(`${i.name} betalte ${a} korn og ${o} gull i skatt til ${l.name}`))}}}),Object.values(n).forEach(i=>{if(i.role==="BARON"){const r=Math.ceil((i.resources.grain||0)*(e/100)),a=Math.ceil((i.resources.gold||0)*(e/100));if(r>0||a>0){const o=Object.values(n).find(l=>l.role==="KING");o&&(i.resources.grain=Math.max(0,i.resources.grain-r),i.resources.gold=Math.max(0,i.resources.gold-a),n[o.id].resources.grain+=r,n[o.id].resources.gold+=a,s.push(`${i.name} betalte ${r} korn og ${a} gull i skatt til Kongen`))}}}),Object.values(n).forEach(i=>{if(i.role==="MERCHANT"||i.role==="SOLDIER"){const r=i.role==="MERCHANT"?e/50:e/100,a=Math.ceil((i.resources.gold||0)*r);if(a>0){const o=Object.values(n).find(l=>l.role==="KING");o&&(i.resources.gold=Math.max(0,i.resources.gold-a),n[o.id].resources.gold+=a,s.push(`${i.name} (${i.role}) betalte ${a} gull i skatt til Kongen`))}}}),{updatedPlayers:n,results:s}},vP=(t,e)=>{if(!t||Object.keys(t).length===0)return null;const n=q.CONTRIBUTION_VALUES,s=Object.entries(t).map(([a,o])=>{let l=0;return Object.entries(o.resources||{}).forEach(([u,d])=>{l+=d*(n[u]||.1)}),{pid:a,score:l,name:o.name}});s.sort((a,o)=>o.score-a.score);const i=s[0];if(!i)return null;const r=e==="throne_room"?"KING":"BARON";return{winningPlayerId:i.pid,role:r}},bP=(t,e)=>({pin:t,name:e,status:"PLAYING",settings:"feudal_europe",hostName:"Host",isPublic:!0,market:JSON.parse(JSON.stringify(bt)),world:{year:1100,season:"Spring",weather:"Clear",gameTick:0,lastTickAt:Date.now(),taxRateDetails:{kingTax:20},settlement:{buildings:Object.entries(Ut).reduce((n,[s])=>({...n,[s]:{id:s,level:0,progress:{},target:200,contributions:{}}}),{})}},markets:{capital:{...bt},region_vest:{...bt},region_ost:{...bt}},players:{},public_profiles:{},messages:[],regions:{region_vest:{id:"region_vest",name:"Baroniet Vest",taxRate:10,defenseLevel:50,rulerName:"Ingen"},region_ost:{id:"region_ost",name:"Baroniet st",taxRate:10,defenseLevel:50,rulerName:"Ingen"}},diplomacy:{},worldEvents:{}}),Gc=async(t,e)=>{var s,i;if(!t||!e)return;const n=D(L,`simulation_server_metadata/${t}`);if(e.isPublic===!1){await Ba(n,null);return}await Ba(n,{pin:t,name:e.name||`Rike #${t}`,status:e.status,playerCount:Object.keys(e.players||{}).length,worldYear:((s=e.world)==null?void 0:s.year)||1100,season:((i=e.world)==null?void 0:i.season)||"Spring",isPublic:e.isPublic??!0,hostName:e.hostName||"Anonym Host",lastUpdated:Date.now()})},up=30,xP=21,yP=120,kS=480,_P=["Spring","Summer","Autumn","Winter"],wP=t=>t%up,Ns=t=>wP(t)<xP?"DAY":"NIGHT",EP=(t,e=0)=>{let n=t;if(e>0){const o=(Date.now()-e)/6e4;n+=Math.min(1,Math.max(0,o))}const i=n%up/up*24,r=(6+Math.floor(i))%24,a=Math.floor(i%1*60);return`${r.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`},NP=t=>{const e=Math.floor(t%kS/yP);return _P[e]||"Spring"},kP=(t,e=1)=>e+Math.floor(t/kS),wi=t=>!t||!t.id?null:Se[t.id]?t.id:Object.keys(Se).sort((s,i)=>i.length-s.length).find(s=>t.id.startsWith(s+"_"))||null,SS=(t,e)=>{if(!e)return;const s=(Array.isArray(e)?e:Object.values(e)).filter(i=>{if(!i)return!1;const r=wi(i),a=r?Se[r]:null,o=i.relevantActions||(a==null?void 0:a.relevantActions);return o==null?void 0:o.includes(t)}).filter(i=>!!i);if(s.length!==0)return s.sort((i,r)=>{var h,m;const a=wi(i),o=wi(r),l=i.stats||(a?(h=Se[a])==null?void 0:h.stats:{}),u=r.stats||(o?(m=Se[o])==null?void 0:m.stats:{}),d=(l==null?void 0:l.yieldBonus)||0;return((u==null?void 0:u.yieldBonus)||0)-d})[0]},wt=async(t,e)=>{const n=D(L,`simulation_rooms/${t}/messages`);await Re(n,s=>{let i=[];Array.isArray(s)?i=s:s&&typeof s=="object"&&(i=Object.values(s));const r={id:`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,content:e,timestamp:Date.now(),type:"SYSTEM"};return i.push(r),i.length>50&&(i=i.sort((a,o)=>a.timestamp-o.timestamp).slice(i.length-50)),i})},rs=(t,e,n,s={})=>{var m,v;let i=0,r=!1;t.equipment&&Object.keys(t.equipment).forEach(y=>{var w,N;const p=t.equipment[y];if(!p)return;let g=p.relevantActions;if(!g&&p.id){const T=wi(p);T&&(g=(w=Se[T])==null?void 0:w.relevantActions)}if(!s.actionType||(g==null?void 0:g.includes(s.actionType))){const T=p.stats||(wi(p)?(N=Se[wi(p)])==null?void 0:N.stats:void 0);T!=null&&T.yieldBonus&&(i+=T.yieldBonus),(y==="AXE"||y==="PICKAXE"||y==="SCYTHE"||y==="MAIN_HAND"||y==="OFF_HAND"||y==="BOW"||y==="TRAP"||y==="CHISEL")&&(r=!0)}});let a=e+i;const o=((m=t.skills)==null?void 0:m[n])||{level:0},l=s.isRefining?q.SKILLS.REFINING_BONUS:q.SKILLS.GATHERING_BONUS,u=1+o.level*l;a*=u;const d=s.actionType==="FORAGE"||s.actionType==="GATHER_HONEY";if(!s.isRefining&&!r&&!d){if(s.requiresTool)return 0;const b=(v=q.GATHERING)==null?void 0:v.NO_TOOL_PENALTY;a*=1-b}let f=1;s.regionId&&(s.actionType==="MINE"&&(s.regionId==="region_vest"?f=1.2:s.regionId==="region_ost"&&(f=.8)),s.actionType==="CHOP"&&(s.regionId==="region_vest"?f=.8:s.regionId==="region_ost"&&(f=1.2)));const h=(s.season||1)*(s.weather||1)*(s.law||1)*(s.upgrades||1)*f;if(a=Math.floor(a*h),s.performance!==void 0){const b=q.MINIGAME.BASE_MULTIPLIER+s.performance*q.MINIGAME.PERFORMANCE_WEIGHT;a=Math.ceil(a*b)}return Math.max(0,a)},Dn=(t,e,n,s,i=0)=>{const r=An[e],a=xs[n],o=(r==null?void 0:r.staminaMod)||1,l=(a==null?void 0:a.staminaMod)||1,d=Ns(i)==="NIGHT"?1.2:1;let h=t*o*l*d;if(s&&s.length>0){const m=Date.now(),v=s.find(b=>b.type==="STAMINA_SAVE"&&b.expiresAt>m);v&&(h*=1-v.value)}return Math.ceil(h)},Wt=(t,e,n,s=1)=>{if(!t||!e||!n)return;const i=n.replace(/\./g,"_"),r=D(L,`simulation_rooms/${t}/stats/${e}`);J(r,{[i]:mS(s)}).catch(a=>console.error("Failed to log systemic stat:",a))},SP=async(t,e,n)=>{const{resource:s,type:i}=n,r=D(L,`simulation_rooms/${t}/players/${e}`),a=await ye(r);if(!a.exists())return{success:!1,error:"Player not found"};const o=a.val(),l=o.regionId||"capital",u=D(L,`simulation_rooms/${t}/markets/${l}/${s}`);let d={success:!1,amount:0};if(await Re(u,m=>{if(m){if(i==="BUY"){if(m.stock<=0)return;d.price=m.price,d.cost=m.price,d.amount=1,m.stock-=1,m.price+=m.price*q.MARKET.PRICE_IMPACT_BUY,d.success=!0}else if(i==="SELL"){d.price=m.price;const v=m.price*q.MARKET.SELL_RATIO;d.revenue=v,d.amount=1,m.stock+=1,m.price-=m.price*q.MARKET.PRICE_IMPACT_SELL,d.success=!0}return m}}),!d.success)return{success:!1,error:"Handel feilet (Vare mangler eller utsolgt)"};let f=!1,h="";return await Re(r,m=>{if(!m)return;m.resources||(m.resources={}),m.inventory||(m.inventory=[]);const v=s==="swords"||s==="armor",b={swords:"iron_sword",armor:"leather_armor"};if(i==="BUY"){const y=d.cost||0;if((m.resources.gold||0)<y)return;if(m.resources.gold=(m.resources.gold||0)-y,v){const p=b[s],g=Se[p];if(g){const x=JSON.parse(JSON.stringify(g));m.inventory.push(x),h=`Kjpte 1 ${g.name} for ${y.toFixed(2)}g`}else m.resources[s]=(m.resources[s]||0)+1,h=`Kjpte 1 ${s} (Resource) for ${y.toFixed(2)}g`}else m.resources[s]=(m.resources[s]||0)+1,h=`Kjpte 1 ${s} for ${y.toFixed(2)}g`;f=!0}else if(i==="SELL"){const y=d.revenue||0;if(v){const p=b[s],g=m.inventory.findIndex(w=>w.id===p);if(g===-1)return;m.inventory.splice(g,1),m.resources.gold=(m.resources.gold||0)+y;const x=Se[p];h=`Solgte 1 ${x?x.name:s} for ${y.toFixed(2)}g`,f=!0}else{if((m.resources[s]||0)<1)return;m.resources[s]-=1,m.resources.gold=(m.resources.gold||0)+y,h=`Solgte 1 ${s} for ${y.toFixed(2)}g`,f=!0}}return m}),f?(wt(t,`[${new Date().toLocaleTimeString()}] ${o.name}: ${h}`),{success:!0,data:{success:!0,timestamp:Date.now(),message:h,utbytte:i==="BUY"?[{resource:s,amount:1}]:[{resource:"gold",amount:d.revenue}],xp:[],durability:[]}}):{success:!1,error:"Transaksjon avbrutt (Mangler ressurser)"}},TP=async(t,e,n)=>{var p;const{buildingId:s,resource:i,amount:r}=n,a=D(L,`simulation_rooms/${t}/world/settlement/buildings/${s}`),o=D(L,`simulation_rooms/${t}/players/${e}`),l=await ye(o);if(!l.exists())return{success:!1,error:"Player missing"};const u=l.val();if((((p=u.resources)==null?void 0:p[i])||0)<r)return{success:!1,error:"Not enough resources"};let d=!1,f=0,h="",m=!1,v=0,b="Ukjent feil i transaksjon";if(await Re(a,g=>{var V,$,K;g||(g={id:s,level:1,progress:{},contributions:{}});const x=Ut[s];if(!x){b=`Systemfeil: BuildingDef mangler for ID: ${s}`;return}h=(x==null?void 0:x.name)||s;const w=g.level??1,N=Math.max(1,w),T=N+1,E=(V=x==null?void 0:x.levels)==null?void 0:V[T];if(!E){b=`Maksimalt niv ndd (Level ${N})`;return}const A=(($=E.requirements)==null?void 0:$[i])||0,k=((K=g.progress)==null?void 0:K[i])||0,R=A-k;if(R<=0){b=`Fullt lager for ${i}. (Krav: ${A}, Har: ${k}, Niv: ${N}->${T})`;return}f=Math.min(r,R),g.progress||(g.progress={}),g.progress[i]=k+f,g.contributions||(g.contributions={}),g.contributions[e]||(g.contributions[e]={name:u.name,resources:{}});const I=g.contributions[e].resources;I[i]=(I[i]||0)+f;let P=!0;if(Object.entries(E.requirements).forEach(([B,j])=>{(g.progress[B]||0)<j&&(P=!1)}),P){g.level=T,g.progress={};const B=E.unlocks||[];if(B.includes("BARON_STATUS")||B.includes("KING_STATUS")){const j=vP(g.contributions,s);j&&(g.pendingWinnerId=j.winningPlayerId,g.pendingRole=j.role)}g.contributions={},m=!0,v=T}return d=!0,Wt(t,"contributions",i,f),g}),!d)return{success:!1,error:`${b}`};if(m){const x=(await ye(a)).val();if(x.pendingWinnerId){const w=x.pendingWinnerId,N=x.pendingRole,T=D(L,`simulation_rooms/${t}/players/${w}`),A=(await ye(T)).val(),k={};if(k[`${w}/role`]=N,N==="BARON"){const I=s==="manor_ost"?"region_ost":"region_vest";k[`${w}/regionId`]=I;const P=D(L,`simulation_rooms/${t}/regions/${I}`);await J(P,{rulerId:w,rulerName:A.name})}else N==="KING"&&(k[`${w}/regionId`]="capital");await J(D(L,`simulation_rooms/${t}/players`),k),await J(D(L,`simulation_rooms/${t}/public_profiles`),k);const R=` ${A.name} har fullfrt ${h} og er n utnevnt til ${N==="BARON"?"Baron":"Konge"}!`;wt(t,R),await J(a,{pendingWinnerId:null,pendingRole:null})}}let y=`Bidro med ${f} ${i} til ${h}`;return m&&(y+=`  ${h} ndde niv ${v}!`),await Re(o,g=>{var x;if(g)return((x=g.resources)==null?void 0:x[i])>=f&&(g.resources[i]-=f),g}),wt(t,`[${new Date().toLocaleTimeString()}] ${u.name}: ${y}`),{success:!0,data:{success:!0,timestamp:Date.now(),message:y,utbytte:[{resource:i,amount:-f}],xp:[],durability:[]}}},AP=async(t,e,n)=>{const s=D(L,`simulation_rooms/${t}/players`),i=await ye(s);if(!i.exists())return{success:!1,error:"No players"};const r=i.val();let a=0,o=0;const l=Object.keys(r).map(async f=>{const h=D(L,`simulation_rooms/${t}/players/${f}`);let m={gold:0,grain:0};await Re(h,v=>{if(!v||v.role!=="PEASANT"||v.regionId!==e)return;const b=Math.floor((v.resources.gold||0)*q.TAX.PEASANT_RATE_DEFAULT),y=Math.floor((v.resources.grain||0)*q.TAX.PEASANT_RATE_DEFAULT);return b>0&&(v.resources.gold-=b,m.gold=b),y>0&&(v.resources.grain-=y,m.grain=y),v}),m.gold>0&&(a+=m.gold),m.grain>0&&(o+=m.grain)});await Promise.all(l);const u=D(L,`simulation_rooms/${t}/players/${e}`);await Re(u,f=>{if(f)return f.resources.gold=(f.resources.gold||0)+a,f.resources.grain=(f.resources.grain||0)+o,f.status.legitimacy=Math.max(0,(f.status.legitimacy||100)-5),f});const d=`Skatteinnkreving fullfrt: ${a}g og ${o} korn.`;return wt(t,`[${new Date().toLocaleTimeString()}] ${d}`),{success:!0,data:{success:!0,timestamp:Date.now(),message:d,utbytte:[{resource:"gold",amount:a},{resource:"grain",amount:o}],xp:[],durability:[]}}},bV=async(t,e,n)=>{const s=D(L,`simulation_rooms/${t}/players/${e}`),i=await ye(s);if(!i.exists())return{success:!1,error:"Fant ikke spilleren."};const r=i.val();if(r.role!=="PEASANT")return{success:!1,error:"Du har alt en karriere."};if(n!=="SOLDIER"&&n!=="MERCHANT")return{success:!1,error:"Ugyldig karrierevalg."};const a=q.CAREERS[n];if(r.stats.level<a.LEVEL_REQ)return{success:!1,error:`Du m vre level ${a.LEVEL_REQ} for  bli ${n==="SOLDIER"?"Soldat":"Kjpmann"}.`};if((r.resources.gold||0)<a.COST)return{success:!1,error:`Du mangler ${a.COST-(r.resources.gold||0)} gull.`};let o=!1;return await Re(s,l=>{if(l&&!(l.resources.gold<a.COST))return l.resources.gold-=a.COST,l.role=n,o=!0,l}),o?(wt(t,`[KARRIERE] ${r.name} er n en ${n}!`),{success:!0,message:`Gratulerer! Du er n en ${n==="SOLDIER"?"Soldat":"Kjpmann"}.`}):{success:!1,error:"Transaksjon feilet."}},RP=async(t,e)=>{var y,p;Wt(t,"coups","start",1);const n=D(L,`simulation_rooms/${t}/regions/${e}`),i=(await ye(n)).val(),r=i.rulerId,a=i.rulerName;if(r){const g=D(L,`simulation_rooms/${t}/players/${r}`);await Re(g,x=>{if(x)return x.role="PEASANT",x.status.legitimacy=0,x}),await J(D(L,`simulation_rooms/${t}/public_profiles/${r}`),{role:"PEASANT"})}const o={},l=((y=i.coup)==null?void 0:y.contributions)||{},u=((p=i.coup)==null?void 0:p.preVotes)||{};Object.entries(l).sort((g,x)=>x[1].amount-g[1].amount).slice(0,3).forEach(([g,x])=>{o[g]={id:g,name:x.name,votes:0,weightedVotes:0,contribution:x.amount}});const d=Date.now(),f={startedAt:d,expiresAt:d+q.COUP.VACANCY_DURATION,candidates:o,votes:{}};let h=0;const m=D(L,`simulation_rooms/${t}/players`),b=(await ye(m)).val()||{};Object.entries(u).forEach(([g,x])=>{if(o[x]){const w=b[g];if(w){let N=q.COUP.PEASANT_VOTE_WEIGHT;w.role==="KING"&&(N=q.COUP.KING_VOTE_WEIGHT),f.votes[g]={candidateId:x,weight:N},o[x].votes+=1,o[x].weightedVotes+=N,h++}}}),await J(n,{rulerId:null,rulerName:"VAKANT",activeElection:f,"coup/bribeProgress":0,"coup/preVotes":null}),wt(t,` REVOLUSJON i ${i.name}! ${a} er styrtet. ${h} skyggelfter ble automatisk talt opp!`)},xV=async(t,e,n)=>{var x,w;const{regionId:s,amount:i}=n,r=D(L,`simulation_rooms/${t}/regions/${s}`),a=D(L,`simulation_rooms/${t}/players/${e}`),o=await ye(a);if(!o.exists())return{success:!1,error:"Fant ikke spilleren."};const l=o.val();if((((x=l.resources)==null?void 0:x.gold)||0)<i)return{success:!1,error:"Du har ikke nok gull."};const d=(await ye(r)).val();if(!d)return{success:!1,error:"Region finnes ikke."};const f=((w=d.coup)==null?void 0:w.lastRulerChange)||0,h=Date.now();if(h-f<q.COUP.HONEYMOON_DURATION&&l.role!=="KING")return{success:!1,error:`Regionen er for stabil. Prv igjen om ${Math.ceil((q.COUP.HONEYMOON_DURATION-(h-f))/6e4)} minutter.`};if(d.activeElection)return{success:!1,error:"Et valg pgr allerede."};let m=0,v=!1;if(await Re(r,N=>{N||(N={id:s,name:s==="capital"?"Kongeriket":s==="region_vest"?"Baroniet Vest":"Baroniet st",rulerName:"Ingen",coup:{lastRulerChange:0,bribeProgress:0,contributions:{}}}),N.coup||(N.coup={lastRulerChange:0,bribeProgress:0,contributions:{}}),N.garrison||(N.garrison={swords:0,armor:0,morale:100}),N.fortification||(N.fortification={hp:1e3,maxHp:1e3,level:1});const T=N.coup.bribeProgress||0,E=i/q.COUP.BASE_BRIBE_COST*10;return e===d.rulerId?N.coup.bribeProgress=Math.max(0,T-E):(N.coup.bribeProgress=Math.min(100,T+E),N.coup.challengerId=e,N.coup.challengerName=l.name),N.coup.contributions||(N.coup.contributions={}),N.coup.contributions[e]||(N.coup.contributions[e]={name:l.name,amount:0}),N.coup.contributions[e].amount+=i,m=N.coup.bribeProgress,v=!0,N}),!v)return{success:!1,error:"Transaksjon feilet (Region oppdatert)."};await Re(a,N=>{if(N)return N.resources.gold=(N.resources.gold||0)-i,N});const b=D(L,`simulation_rooms/${t}/players`),y=await ye(b);let p={};y.exists()&&(p=y.val());let g=d.rulerId;if(!g&&Object.keys(p).length>0){if(s==="capital"){const N=Object.values(p).find(T=>T.role==="KING");N&&(g=N.id)}else{const N=Object.values(p).find(T=>T.role==="BARON"&&T.regionId===s);N&&(g=N.id)}g&&await J(r,{rulerId:g})}if(g){const N=D(L,`simulation_rooms/${t}/players/${g}`),T=Math.floor(i/100);if(await Re(N,E=>{if(E)return E.status&&(E.status.legitimacy=Math.max(0,(E.status.legitimacy||0)-T)),E}),Object.keys(p).length>0){const E=Object.keys(p).filter(A=>p[A].regionId===s&&A!==e&&(p[A].role==="PEASANT"||p[A].role==="SOLDIER"));if(E.length>0){const A=Math.floor(i/E.length);A>0&&await Promise.all(E.map(k=>{const R=D(L,`simulation_rooms/${t}/players/${k}/resources`);return J(R,{gold:mS(A)})})),wt(t,`[FOLKEGAVE] ${l.name} donerte ${i}g. ${E.length} innbyggere fikk ${A}g hver! (Opprr: ${m.toFixed(0)}%)`)}else wt(t,`[FOLKEGAVE] ${l.name} donerte ${i}g til saken, men fant ingen trengende i ${d.name}. (Opprr: ${m.toFixed(0)}%)`)}else wt(t,`[FOLKEGAVE] ${l.name} donerte ${i}g. (Opprr: ${m.toFixed(0)}%)`);return m>=100&&await RP(t,s),{success:!0,message:`Besteikkelse gjennomfrt! Opprr: ${m.toFixed(1)}%`}}return{success:!0,message:"Besteikkelse registrert."}},yV=async(t,e,n,s)=>{const i=D(L,`simulation_rooms/${t}/regions/${n}`);let r=!1;return await Re(i,a=>{if(a)return a.coup||(a.coup={bribeProgress:0,contributions:{},preVotes:{}}),a.coup.preVotes||(a.coup.preVotes={}),a.coup.preVotes[e]=s,r=!0,a}),r?{success:!0,message:"Skyggelfte avgitt!"}:{success:!1,error:"Kunne ikke avgi lfte."}},_V=async(t,e,n)=>{const s=D(L,`simulation_rooms/${t}/regions/${n}`),i=D(L,`simulation_rooms/${t}/players/${e}`),r=q.COUP.RESTORE_ORDER_COST,a=await ye(i);if(!a.exists())return{success:!1,error:"Spiller mangler"};const o=a.val();if(o.resources.gold<r)return{success:!1,error:`Trenger ${r}g for  gjenopprette ro.`};let l=!1;return await Re(s,u=>{if(!(!u||u.rulerId!==e)&&u.coup)return u.coup.bribeProgress=Math.max(0,(u.coup.bribeProgress||0)-25),l=!0,u}),l?(await Re(i,u=>{if(u)return u.resources.gold-=r,u.status.legitimacy=Math.min(100,(u.status.legitimacy||0)+10),u}),wt(t,` ${o.name} har gjenopprettet ro i ${n} ved  dele ut midler til vaktene.`),{success:!0,message:"Ro gjenopprettet (-25% opprr)"}):{success:!1,error:"Kunne ikke gjenopprette ro."}},wV=async(t,e,n)=>{const{regionId:s,candidateId:i}=n,r=D(L,`simulation_rooms/${t}/regions/${s}`),a=D(L,`simulation_rooms/${t}/players/${e}`),o=await ye(a);if(!o.exists())return{success:!1};const l=o.val();let u=q.COUP.PEASANT_VOTE_WEIGHT;l.role==="KING"&&(u=q.COUP.KING_VOTE_WEIGHT);let d=!1;return await Re(r,f=>{if(!f||!f.activeElection||Date.now()>f.activeElection.expiresAt)return;f.activeElection.votes||(f.activeElection.votes={});const h=f.activeElection.votes[e];if(h){const v=f.activeElection.candidates[h.candidateId];v&&(v.votes=Math.max(0,(v.votes||0)-1),v.weightedVotes=Math.max(0,(v.weightedVotes||0)-h.weight))}f.activeElection.votes[e]={candidateId:i,weight:u};const m=f.activeElection.candidates[i];return m&&(m.votes=(m.votes||0)+1,m.weightedVotes=(m.weightedVotes||0)+u),d=!0,f}),{success:d}},EV=async(t,e)=>{const n=D(L,`simulation_rooms/${t}/regions/${e}`),i=(await ye(n)).val(),r=(i==null?void 0:i.name)||e;let a=null;if(await Re(n,o=>{if(!o||!o.activeElection||Date.now()<o.activeElection.expiresAt)return;const l=Object.values(o.activeElection.candidates);if(l.length===0)return o.rulerId=null,o.rulerName="Ingen Hersker",o.activeElection=null,o;const u=l.sort((d,f)=>f.weightedVotes-d.weightedVotes)[0];return a={winnerId:u.id,winnerName:u.name},o.rulerId=u.id,o.rulerName=u.name,o.activeElection=null,o.coup||(o.coup={lastRulerChange:Date.now(),bribeProgress:0,contributions:{}}),o.coup.lastRulerChange=Date.now(),o.coup.bribeProgress=0,o.coup.contributions={},o}),a){Wt(t,"coups","success",1);const o=a.winnerId,l=D(L,`simulation_rooms/${t}/players/${o}`),d=(await ye(l)).val(),f={};return f[`${o}/role`]="BARON",f[`${o}/regionId`]=e,await J(D(L,`simulation_rooms/${t}/players`),f),await J(D(L,`simulation_rooms/${t}/public_profiles`),f),wt(t,` KRONING: ${d.name} har vunnet valget og er n Baron av ${r}!`),{success:!0}}return{success:!1}},IP=async(t,e,n)=>{const s=D(L,`simulation_rooms/${t}/players/${e}`);let i=!1;return await Re(s,r=>{if(r)return r.resources||(r.resources={}),r.resources.gold=(r.resources.gold||0)+n,i=!0,r}),i&&wt(t,` ADMIN: Gitt ${n}g til en spiller.`),{success:i}},CP=async(t,e,n,s)=>{const i=D(L,`simulation_rooms/${t}/players/${e}`),r=Se[n];if(!r)return{success:!1,error:"Invalid Item ID"};let a=!1;return await Re(i,o=>{if(o){o.inventory||(o.inventory=[]);for(let l=0;l<s;l++){const u=JSON.parse(JSON.stringify(r));u.instanceId=`${n}_${Date.now()}_${Math.random().toString(36).substr(2,5)}`,o.inventory.push(u)}return a=!0,o}}),a&&wt(t,` ADMIN: Gitt ${s}x ${r.name} til en spiller.`),{success:a}},jP=async(t,e,n,s)=>{const i=D(L,`simulation_rooms/${t}/players/${e}`);let r=!1;return await Re(i,a=>{if(a)return a.resources||(a.resources={}),a.resources[n]=(a.resources[n]||0)+s,a.resources[n]<0&&(a.resources[n]=0),r=!0,a}),r&&wt(t,` ADMIN: Gitt ${s}x ${n} til en spiller.`),{success:r}},OP=async(t,e,n,s)=>{var d;const i=D(L,`simulation_rooms/${t}/players/${e}`),r=D(L,`simulation_rooms/${t}/channels/${s}/messages`),a=await ye(i);if(!a.exists())return{success:!1,error:"Spiller mangler"};const o=a.val();let l=0;if(o.role!=="KING"&&(s==="global"?l=2:s!==o.regionId&&s!=="diplomacy"&&s.includes(e)&&s.length>20&&(l=5)),(((d=o.resources)==null?void 0:d.gold)||0)<l)return{success:!1,error:`Trenger ${l}g for  sende denne meldingen.`};let u=!1;if(l>0?await Re(i,f=>{if(f&&!((f.resources.gold||0)<l))return f.resources.gold-=l,u=!0,f}):u=!0,!u)return{success:!1,error:"Har ikke rd."};try{const f=hS(r);return await J(f,{id:f.key,senderId:e,senderName:o.name,senderRole:o.role,content:n.trim(),timestamp:D4(),isPremiere:l>0}),{success:!0}}catch(f){return console.error("Chat Send Error:",f),{success:!1,error:`Kunne ikke sende melding: ${f.message||"Ukjent feil"}`}}},TS=(t,e,n)=>{_.useEffect(()=>{if(!t||e==="LOBBY")return;const s=setInterval(async()=>{const i=Date.now(),r=(n==null?void 0:n.lastTickAt)||0;if(!(i-r<1e3))if(i-r>=6e4){const a=D(L,`simulation_rooms/${t}/world`);try{await Re(a,o=>{if(!o)return;const l=o.lastTickAt||0;if(Date.now()-l>=6e4){const u=(o.gameTick||0)+1;return o.gameTick=u,o.lastTickAt=Date.now(),o.season=NP(u),o.year=kP(u,1100),o}else return})}catch{}}else n!=null&&n.lastTickAt||J(D(L,`simulation_rooms/${t}/world`),{lastTickAt:Date.now()})},5e3);return()=>clearInterval(s)},[t,e,n==null?void 0:n.lastTickAt,n==null?void 0:n.gameTick])};class MP{constructor(e){$e(this,"genome");this.genome=e}decide(e,n){var l;const s=[],i=e.status.stamina,r=(1-i/100)*this.genome.weights.hungerThreshold*5;e.resources.bread>0&&i<80&&s.push({action:{type:"EAT"},score:r,reason:"Sulten"}),i<50&&s.push({action:{type:"SLEEP"},score:(1-i/100)*this.genome.weights.restFocus*3,reason:"Trtt"}),s.push({action:{type:"CHOP"},score:this.genome.weights.gatherWood*this.getNeedMultiplier(e,"wood"),reason:"Trengte ved"}),s.push({action:{type:"QUARRY"},score:this.genome.weights.gatherStone*this.getNeedMultiplier(e,"stone"),reason:"Trengte stein"}),s.push({action:{type:"MINE"},score:this.genome.weights.gatherIron*this.getNeedMultiplier(e,"iron_ore"),reason:"Trengte jernmalm"}),s.push({action:{type:"WORK"},score:this.genome.weights.gatherGrain*this.getNeedMultiplier(e,"grain"),reason:"Trengte korn"});const a=((l=n.markets)==null?void 0:l[e.regionId])||n.market;a&&Object.entries(e.resources).forEach(([u,d])=>{if(u==="gold")return;const f=a[u];if(f&&d>10){const h=f.price;s.push({action:{type:"SELL",itemId:u,amount:Math.floor(d/2)},score:this.genome.weights.marketAggression*(h/20)*(d/50),reason:`Selger ${u} for gull`})}}),e.resources.gold>200&&s.push({action:{type:"CONTRIBUTE_TO_UPGRADE",buildingId:"great_hall"},score:this.genome.weights.promotionFocus*(e.resources.gold/1e3),reason:"Vil bli mektigere"});const o=s.filter(u=>{const d=typeof u.action=="string"?u.action:u.action.type,f=hc[d];if(!f)return!0;if(i<(f.stamina||0))return!1;for(const[h,m]of Object.entries(f))if(h!=="stamina"&&(e.resources[h]||0)<m)return!1;return!0});return o.length===0?{action:"IDLE",score:0,reason:"Ingenting  gjre"}:(o.sort((u,d)=>d.score-u.score),o[0])}getNeedMultiplier(e,n){const s=e.resources[n]||0;return s<5?2:s<20?1.2:s>100?.5:1}}const DP=(t=0)=>({id:`genome_${Date.now()}_${Math.floor(Math.random()*1e3)}`,generation:t,weights:{gatherWood:Math.random()*2,gatherStone:Math.random()*2,gatherIron:Math.random()*2,gatherGrain:Math.random()*2,marketAggression:Math.random()*2,savingsFocus:Math.random()*2,upgradeFocus:Math.random()*2,hungerThreshold:.2+Math.random()*.6,restFocus:Math.random()*2,promotionFocus:Math.random()*2,contributionFocus:Math.random()*2}}),LP=(t,e=.1)=>{const n={...t.weights};return Object.keys(n).forEach(s=>{if(Math.random()<.2){const i=(Math.random()*2-1)*e;n[s]=Math.max(0,Math.min(2,n[s]+i))}}),{...t,id:`genome_${Date.now()}_${Math.floor(Math.random()*1e3)}`,weights:n,generation:t.generation+1,parents:[t.id],fitness:void 0}},by="eiriksbok_ai_top_genomes";class dp{static calculateFitness(e,n){const s=(e.resources.gold||0)+Object.values(e.resources).reduce((o,l)=>o+(typeof l=="number"?l:0),0)*.5,r={PEASANT:1,SOLDIER:5,MERCHANT:10,BARON:50,KING:200}[e.role]||1,a=Math.max(1,(Date.now()-n)/6e4);return(s+r*100)/a}static saveTopGenomes(e){const n=[...e].filter(s=>s.fitness!==void 0).sort((s,i)=>(i.fitness||0)-(s.fitness||0)).slice(0,3);localStorage.setItem(by,JSON.stringify(n))}static getTopGenomes(){const e=localStorage.getItem(by);if(!e)return[];try{return JSON.parse(e)}catch{return[]}}static getNextGenerationGenome(){const e=this.getTopGenomes();if(e.length===0)return DP(0);const n=e[Math.floor(Math.random()*e.length)];return LP(n)}}const AS={CHOP:["AXE","OFF_HAND"],MINE:["PICKAXE","OFF_HAND"],QUARRY:["CHISEL","OFF_HAND"],WORK:["SCYTHE","OFF_HAND"],RAID:["MAIN_HAND","OFF_HAND","BODY","HEAD","FEET"],DEFEND:["MAIN_HAND","OFF_HAND","BODY","HEAD","FEET"],PATROL:["MAIN_HAND","OFF_HAND","BODY"],EXPLORE:["MAIN_HAND","OFF_HAND","BODY","HEAD","FEET"],CRAFT:["MAIN_HAND","AXE","PICKAXE","SCYTHE","HAMMER"],HUNT:["MAIN_HAND","BOW","TRAP"],FORAGE:["MAIN_HAND","TRAP"],GATHER_WOOL:["MAIN_HAND","OFF_HAND"],SAWMILL:["MAIN_HAND","OFF_HAND"],PLANT:["MAIN_HAND","OFF_HAND"],HARVEST:["SCYTHE","OFF_HAND","MAIN_HAND"]},fp=(t,e)=>{const n=AS[e];return!n||!t.equipment?[]:n.map(s=>{var i;return(i=t.equipment)==null?void 0:i[s]}).filter(s=>{var i,r;if(!s)return!1;if((i=s.relevantActions)!=null&&i.includes(e))return!0;if(!s.relevantActions){const a=s.id.split("_").slice(0,2).join("_"),o=Se[s.id]||Se[a]||Object.values(Se).find(l=>s.id.startsWith(l.id));return(r=o==null?void 0:o.relevantActions)!=null&&r.includes(e)?!0:!o||!o.relevantActions}return!1})},ao=(t,e)=>{const n=AS[e];return!n||!t.equipment?[]:n.filter(s=>{var r,a,o;const i=(r=t.equipment)==null?void 0:r[s];if(!i)return!1;if((a=i.relevantActions)!=null&&a.includes(e))return!0;if(!i.relevantActions){const l=i.id.split("_").slice(0,2).join("_"),u=Se[i.id]||Se[l]||Object.values(Se).find(d=>i.id.startsWith(d.id));return(o=u==null?void 0:u.relevantActions)!=null&&o.includes(e)?!0:!u||!u.relevantActions}return!1})},RS=(t,e,n="Spring",s="Clear",i=0)=>{var d;let r=typeof e=="string"?e:e.type,a=typeof e=="object"?{...e}:{};r.startsWith("REFINE_")&&!_r[r]?(a.recipeId=r.replace("REFINE_","").toLowerCase(),r="REFINE"):r.startsWith("CRAFT_")&&!Rn[r]?(a.subType=r.replace("CRAFT_","").toLowerCase(),r="CRAFT"):Rn[r]&&(a.subType=r,r="CRAFT");const o=fp(t,r);for(const f of o)if(f.durability<=0)return{success:!1,reason:`delagt: ${f.name}`};if(r==="GATHER_WOOL"&&o.length===0)return{success:!1,reason:"Du mangler Saks"};let l={};const u=hc[r];if(u&&(l={...u}),r==="REFINE"||r==="CRAFT"){let f;r==="REFINE"&&(f=_r[a.recipeId]),r==="CRAFT"&&(f=Rn[a.subType]),f&&(f.stamina!==void 0&&(l.stamina=f.stamina),f.input&&Object.entries(f.input).forEach(([h,m])=>{l[h]=(l[h]||0)+m}))}if(Object.keys(l).length>0){const f=An[n],h=xs[s],m=(f==null?void 0:f.staminaMod)||1,v=(h==null?void 0:h.staminaMod)||1,b=Ns(i)==="NIGHT",y=b?1.2:1,p=l.stamina||0;if(r==="SLEEP"&&!b)return{success:!1,reason:"Du kan bare sove nr det er natt"};if(r==="PLANT"&&n==="Winter")return{success:!1,reason:"Bakken er frossen - du kan ikke s om vinteren"};if(a.locationId==="farm_well"||a.locationId==="well_water"||r==="GATHER_WATER"){const N=a.locationId||(r==="GATHER_WATER"?"well_water":null);if(N){const T=(d=t.activeProcesses)==null?void 0:d.find(E=>E.type==="WELL"&&E.locationId===N);if(T&&T.readyAt>Date.now())return{success:!1,reason:"Brnnen fyller seg med vann..."}}}const x=Math.ceil(p*m*v*y);if((t.status.stamina||0)<x)return{success:!1,reason:`Du mangler ${Math.ceil(x-(t.status.stamina||0))} energi`};const w={bread:"brd",gold:"gull",wood:"tre",flour:"mel",grain:"korn",iron_ingot:"jernbarrer",plank:"planker",stone:"stein",meat:"kjtt",honey:"honning",wool:"ull",iron_ore:"jernmalm",cloth:"stoff",stamina:"energi"};for(const[N,T]of Object.entries(l)){if(N==="stamina")continue;const E=t.resources[N]||0;if(E<T){const A=w[N]||N;return{success:!1,reason:`Du mangler ${T-E} ${A}`}}}}return{success:!0}},IS=(t,e="Spring",n="Clear",s=0)=>{let i=typeof t=="string"?t:t.type,r=typeof t=="object"?{...t}:{};i.startsWith("REFINE_")&&!_r[i]?(r.recipeId=i.replace("REFINE_","").toLowerCase(),i="REFINE"):i.startsWith("CRAFT_")&&!Rn[i]?(r.subType=i.replace("CRAFT_","").toLowerCase(),i="CRAFT"):Rn[i]&&(r.subType=i,i="CRAFT");let a={};const o=hc[i];if(o&&(a={...o}),i==="REFINE"||i==="CRAFT"){let d;i==="REFINE"&&(d=_r[r.recipeId]),i==="CRAFT"&&(d=Rn[r.subType]),d&&(d.stamina!==void 0&&(a.stamina=d.stamina),d.input&&Object.entries(d.input).forEach(([f,h])=>{a[f]=(a[f]||0)+h}))}if(Object.keys(a).length===0)return null;const l=[];if(a.stamina){const d=An[e],f=xs[n],m=Ns(s)==="NIGHT"?1.2:1,v=((d==null?void 0:d.staminaMod)||1)*((f==null?void 0:f.staminaMod)||1)*m,b=Math.ceil(a.stamina*v);let y="-";a.stamina<0&&(y="+"),l.push(`${y}${Math.abs(b)}`)}const u={bread:"",gold:"",wood:"",flour:"",grain:"",iron_ingot:"",plank:"",stone:"",meat:"",honey:"",wool:"",iron_ore:"",cloth:""};for(const[d,f]of Object.entries(a)){if(d==="stamina")continue;const h=f,m=u[d]||d;l.push(`-${h}${m}`)}return l.join(" ")},PP=(t,e,n)=>{t.activeProcesses||(t.activeProcesses=[]),t.activeProcesses.push({id:`cd_${Date.now()}_${Math.random().toString(36).substr(2,5)}`,type:"COOLDOWN",locationId:e,itemId:"cooldown",notified:!1,startedAt:Date.now(),readyAt:Date.now()+n,duration:n})},BP=t=>{const{actor:e,action:n,localResult:s}=t,i=n.processId;if(!e.activeProcesses)return s.success=!1,s.message="Ingen aktive prosesser.",!1;const r=e.activeProcesses.find(o=>o.id===i);if(!r)return s.success=!1,s.message="Fant ikke avlingen (kanskje den allerede er ferdig?).",!1;if(r.type!=="CROP")return s.success=!1,s.message="Kan bare vedlikeholde avlinger.",!1;if(r.maintainCount===void 0&&(r.maintainCount=0),r.yieldBonus===void 0&&(r.yieldBonus=0),r.maintainCount>=3)return s.success=!1,s.message="Denne keren er allerede perfekt vedlikeholdt.",!1;r.maintainCount+=1,r.yieldBonus+=.05;const a=n.subType==="WEED"?"Lukte ugress":"Skremte vekk krka";return s.message=`${a}! (+5% Utbytte).`,!0},UP=t=>{var f;const{actor:e,action:n,localResult:s,timestamp:i}=t,r=n.cropId||"grain",a=A0[r];if(!a)return s.success=!1,s.message=`Ukjent grde: ${r}`,!1;if((((f=t.room.world)==null?void 0:f.season)||"Spring")==="Winter")return s.success=!1,s.message="Du kan ikke s om vinteren - bakken er frossen.",!1;e.activeProcesses||(e.activeProcesses=[]);const l=n.locationId||"grain_fields";if(e.activeProcesses.find(h=>h.type==="CROP"&&h.locationId===l))return s.success=!1,s.message="Det vokser allerede noe her.",!1;const d={id:Math.random().toString(36).substr(2,9),type:"CROP",itemId:r,locationId:l,startedAt:Date.now(),duration:a.duration,readyAt:Date.now()+a.duration,notified:!1};return e.activeProcesses.push(d),s.message=`Sdde ${a.label}. Klar om ${Math.ceil(a.duration/6e4)} min.`,!0},HP=t=>{var g,x,w;const{actor:e,action:n,localResult:s,trackXp:i,damageTool:r,room:a}=t,o=Date.now(),l=n.locationId||"grain_fields",u=(g=e.activeProcesses)==null?void 0:g.findIndex(N=>N.locationId===l&&N.readyAt<=o);if(u===void 0||u===-1)return s.success=!1,s.message="Ingenting er klart til innhsting her.",!1;const d=e.activeProcesses[u];let f="",h=0,m="",v=0,b="FARMING";const y=A0[d.itemId],p=_r[d.itemId];if(y){m=y.label,f=y.yieldResource;const N=n.performance||.5,T=y.minYield+(y.maxYield-y.minYield)*N,E=((x=a.world)==null?void 0:x.season)||"Spring",A=An[E],k=1+(d.yieldBonus||0);h=Math.ceil(T*((A==null?void 0:A.yieldMod)||1)*k),v=Math.ceil(y.xp*(1+N))}else if(p){m=p.label,f=p.outputResource;const N=((w=p.output)==null?void 0:w.amount)||p.outputAmount||1,T=n.performance||.5;h=rs(e,N,"CRAFTING",{performance:T,isRefining:!0}),v=p.xp||10,b=p.skill||"CRAFTING"}else return s.success=!1,s.message="Ugyldig prosess-data.",!1;return e.activeProcesses.splice(u,1),ao(e,"WORK").forEach(N=>{r(N,q.DURABILITY.LOSS_WORK)}),e.resources[f]||(e.resources[f]=0),e.resources[f]+=h,s.utbytte.push({resource:f,amount:h}),s.message=`Hstet ${h} ${m}`,i(b,v),!0},GP=t=>{var y,p,g,x,w,N,T;const{actor:e,room:n,action:s,localResult:i,trackXp:r,damageTool:a}=t,o=((y=n.world)==null?void 0:y.activeLaws)||[];ao(e,"WORK").forEach(E=>{a(E,q.DURABILITY.LOSS_WORK)});let l=1;o.includes("conscription")&&(l=.8);const u=q.YIELD.WORK_GRAIN+((p=e.upgrades)!=null&&p.includes("iron_plow")?5:0),d=((g=n.world)==null?void 0:g.season)||"Spring",f=((x=n.world)==null?void 0:x.weather)||"Clear",h=An[d],m=xs[f],v=s.performance||.5,b=rs(e,u,"FARMING",{season:(h==null?void 0:h.yieldMod)||1,weather:(m==null?void 0:m.yieldMod)||1,law:l,performance:v,actionType:"WORK",regionId:e.regionId});if(e.resources.grain=(e.resources.grain||0)+b,i.utbytte.push({resource:"grain",amount:b}),i.message=`Hstet ${b} korn`,r("FARMING",Math.ceil(fc.WORK.xp*(1+v))),Math.random()<q.LUCKY_DROP.CHANCE+(((T=(N=(w=e.equipment)==null?void 0:w.HEAD)==null?void 0:N.stats)==null?void 0:T.luckBonus)||0)){const E=Math.ceil(b*.5),A=b+E;e.resources.grain+=E,i.utbytte.push({resource:"grain",amount:E,bonus:!0}),i.message=`Innhstet ${A} korn! (inkl. ${E} flaks)`}return!0},VP=t=>{var f,h,m,v;const{actor:e,room:n,action:s,localResult:i,trackXp:r,damageTool:a}=t,o=((f=n.world)==null?void 0:f.season)||"Spring";ao(e,"CHOP").forEach(b=>{a(b,q.DURABILITY.LOSS_WORK)});let l=q.YIELD.CHOP_WOOD;o==="Summer"&&(l+=q.YIELD.SUMMER_WOOD_BONUS);const u=s.performance||.5,d=rs(e,l,"WOODCUTTING",{performance:u,actionType:"CHOP",regionId:e.regionId});if(e.resources.wood=(e.resources.wood||0)+d,i.utbytte.push({resource:"wood",amount:d}),i.message=`Felte ${d} ved`,r("WOODCUTTING",Math.ceil(fc.CHOP.xp*(1+u))),Math.random()<q.LUCKY_DROP.CHANCE+(((v=(m=(h=e.equipment)==null?void 0:h.HEAD)==null?void 0:m.stats)==null?void 0:v.luckBonus)||0)){const b=Math.ceil(d*.5),y=d+b;e.resources.wood+=b,i.utbytte.push({resource:"wood",amount:b,bonus:!0}),i.message=`Felte ${y} ved! (inkl. ${b} flaks)`}return!0},xy=t=>{const{actor:e,action:n,localResult:s,trackXp:i,damageTool:r}=t,a=typeof n=="string"?n:n.type;ao(e,a).forEach(h=>{r(h,q.DURABILITY.LOSS_WORK)});const o="MINING",l=a==="MINE"?q.YIELD.MINE_ORE:q.YIELD.QUARRY_STONE,u=a==="MINE"?"iron_ore":"stone",d=n.performance||.5,f=rs(e,l,o,{performance:d,actionType:a,regionId:e.regionId});return e.resources[u]=(e.resources[u]||0)+f,s.utbytte.push({resource:u,amount:f}),s.message=a==="MINE"?`Utvant ${f} jernmalm`:`Hogde ${f} stein`,i(o,Math.ceil(fc.WORK.xp*(1+d))),!0},FP=t=>{const{actor:e,action:n,localResult:s,trackXp:i,damageTool:r}=t;ao(e,"FORAGE").forEach(u=>{r(u,1)});const a=q.YIELD.FORAGE_BREAD,o=n.performance||.5,l=rs(e,a,"FARMING",{performance:o,actionType:"FORAGE"});return e.resources||(e.resources={}),e.resources.bread=(e.resources.bread||0)+l,s.utbytte.push({resource:"bread",amount:l}),s.message=`Sanket ${l} ndproviant (brd/br)`,i("FARMING",Math.ceil(fc.FORAGE.xp*(1+o))),!0},zP=t=>{const{actor:e,action:n,localResult:s,trackXp:i,damageTool:r}=t;ao(e,"HUNT").forEach(u=>{r(u,2)});const a=8,o=n.performance||.5,l=rs(e,a,"COMBAT",{performance:o,actionType:"HUNT"});return e.resources.meat=(e.resources.meat||0)+l,s.utbytte.push({resource:"meat",amount:l}),s.message=`Felte bytte og fikk ${l} kjtt`,i("COMBAT",Math.ceil(15*(1+o))),!0},$P=t=>{const{actor:e,action:n,localResult:s,trackXp:i}=t,r=6,a=n.performance||.5,o=rs(e,r,"FARMING",{performance:a,actionType:"GATHER_WOOL",requiresTool:!0});return o===0?(s.message="Du trenger en Saks for  klippe sauene!",!1):(e.resources.wool=(e.resources.wool||0)+o,s.utbytte.push({resource:"wool",amount:o}),s.message=`Klippet sauer og fikk ${o} ull`,i("FARMING",Math.ceil(10*(1+a))),!0)},KP=t=>{const{actor:e,action:n,localResult:s,trackXp:i}=t,r=4,a=n.performance||.5,o=rs(e,r,"FARMING",{performance:a,actionType:"GATHER_HONEY"});return e.resources.honey=(e.resources.honey||0)+o,s.utbytte.push({resource:"honey",amount:o}),s.message=`Hentet ${o} honning fra bikubene`,i("FARMING",Math.ceil(12*(1+a))),!0},YP=t=>{const{actor:e,localResult:n}=t,s=5;if((e.resources.grain||0)<s)return n.success=!1,n.message=`Mangler korn. Trenger ${s} korn for  mate hnene.`,!1;if(e.activeProcesses||(e.activeProcesses=[]),e.activeProcesses.find(o=>o.type==="COOP"&&o.locationId==="chicken_coop"&&o.readyAt>Date.now()))return n.success=!1,n.message="Hnene har allerede mat.",!1;e.resources.grain-=s,n.utbytte.push({resource:"grain",amount:-s});const r=24e4,a={id:Math.random().toString(36).substr(2,9),type:"COOP",itemId:"egg",locationId:"chicken_coop",startedAt:Date.now(),duration:r,readyAt:Date.now()+r,notified:!1};return e.activeProcesses.push(a),n.message="Matet hnene. Egg klare om 4 minutter.",!0},qP=t=>{var o;const{actor:e,localResult:n,trackXp:s}=t,i=Date.now(),r=(o=e.activeProcesses)==null?void 0:o.findIndex(l=>l.type==="COOP"&&l.locationId==="chicken_coop"&&l.readyAt<=i);if(r===void 0||r===-1)return n.success=!1,n.message="Ingen egg  hente enn.",!1;e.activeProcesses.splice(r,1);const a=Math.floor(Math.random()*3)+3;return e.resources.egg||(e.resources.egg=0),e.resources.egg+=a,n.utbytte.push({resource:"egg",amount:a}),n.message=`Samlet ${a} egg.`,s("FARMING",15),!0},WP=t=>{var l,u,d,f,h,m,v;const{actor:e,room:n,action:s,localResult:i,trackXp:r}=t,a=s.subType,o=Rn[a];if(o){if((((f=(d=(u=(l=n.world)==null?void 0:l.settlement)==null?void 0:u.buildings)==null?void 0:d[o.buildingId])==null?void 0:f.level)||1)<o.level)return i.success=!1,i.message=`Mangler bygningsniv ${o.level} for  lage dette.`,!1;let y=!0;if(Object.entries(o.input).forEach(([p,g])=>{e.resources[p]<g&&(y=!1)}),y){Object.entries(o.input).forEach(([x,w])=>{e.resources[x]-=w});const p=o.outputItemId;if(hn[p]||p==="omelette"){const x=o.outputAmount||1;e.resources[p]=(e.resources[p]||0)+x,i.utbytte.push({resource:p,amount:x});const w=Se[p];i.message=`Laget ${x}x ${(w==null?void 0:w.name)||p}!`,r("CRAFTING",25*o.level),Wt(n.pin,"crafted",p,x)}else{const x=Se[p];if(x){const w={...x,id:`${x.id}_${Date.now()}_${Math.floor(Math.random()*1e3)}`};e.inventory||(e.inventory=[]),e.inventory.push(w),i.utbytte.push({resource:p,amount:1}),i.message=`Smidde ${w.name}!`,r("CRAFTING",25*o.level),Wt(n.pin,"crafted",p,1)}}if(o.stamina){const x=((h=n.world)==null?void 0:h.season)||"Spring",w=((m=n.world)==null?void 0:m.weather)||"Clear",N=Dn(o.stamina,x,w,e.activeBuffs,((v=n.world)==null?void 0:v.gameTick)||0);(e.status.stamina||0)<N?(i.success=!1,i.message=`For lite stamina! Krever ${N}`):e.status.stamina-=N}}else return i.success=!1,i.message="Mangler ressurser for  smi.",!1}return!0},Lr=t=>{var l,u,d,f,h,m,v,b,y;const{actor:e,room:n,action:s,localResult:i,trackXp:r}=t,a=s.recipeId,o=_r[a];if(o){const p=((f=(d=(u=(l=n.world)==null?void 0:l.settlement)==null?void 0:u.buildings)==null?void 0:d[o.buildingId])==null?void 0:f.level)||1;if(o.requiredLevel&&p<o.requiredLevel)return i.success=!1,i.message=`Utvidelse kreves: ${o.buildingId} m vre Niv ${o.requiredLevel}.`,!1;let g=!0;Object.entries(o.input).forEach(([E,A])=>{e.resources[E]<A&&(g=!1)});const x=((h=n.world)==null?void 0:h.season)||"Spring",w=((m=n.world)==null?void 0:m.weather)||"Clear",N=o.stamina||0,T=Dn(N,x,w,e.activeBuffs,((v=n.world)==null?void 0:v.gameTick)||0);if((e.status.stamina||0)<T)return g=!1,i.message=`For lite stamina! Krever ${T}`,i.success=!1,!1;if(g){if(o.duration){e.activeProcesses||(e.activeProcesses=[]);const P=s.locationId||o.buildingId;if(e.activeProcesses.find(K=>K.locationId===P))return i.success=!1,i.message="Det pgr allerede en prosess her.",!1;Object.entries(o.input).forEach(([K,B])=>{e.resources[K]-=B}),e.status.stamina-=T;const $={id:Math.random().toString(36).substr(2,9),type:a==="flour"?"MILL":"CRAFT",itemId:a,locationId:P,startedAt:Date.now(),duration:o.duration,readyAt:Date.now()+o.duration,notified:!1};return e.activeProcesses.push($),i.message=`Startet ${o.label.toLowerCase()}. Ferdig om ${Math.ceil(o.duration/6e4)} minutter (-${T}).`,!0}Object.entries(o.input).forEach(([P,V])=>{e.resources[P]-=V}),e.status.stamina-=T;const E=s.performance||.5,A=((b=o.output)==null?void 0:b.amount)||o.outputAmount||1,k=rs(e,A,"CRAFTING",{performance:E,isRefining:!0}),R=e.resources[o.outputResource]||0;e.resources[o.outputResource]=R+k;const I=((y=hn[o.outputResource])==null?void 0:y.label)||o.outputResource;i.utbytte.push({resource:o.outputResource,amount:k}),i.message=`Produserte ${k} ${I}`,r("CRAFTING",q.SKILLS.REFINING_XP),Wt(n.pin,"crafted",o.outputResource,k)}else return i.success=!1,i.message="Mangler ressurser til raffinering.",!1}return!0},XP=t=>{var m;const{actor:e,action:n,localResult:s}=t,i=n.targetSlot,r=n.buildingId;if(!r||!rp[r])return s.success=!1,s.message="Ugyldig reparasjonsstasjon.",!1;const a=rp[r];if(!a.slots.includes(i))return s.success=!1,s.message=`Denne stasjonen kan ikke reparere ${i}.`,!1;const o=e.equipment[i];if(!o)return s.success=!1,s.message="Ingen gjenstand i dette sporet.",!1;if(o.durability>=o.maxDurability)return s.success=!1,s.message=`${o.name} er allerede i perfekt stand.`,!1;const l=a.goldCost,u=1,d=a.material,f=(e.resources.gold||0)>=l,h=(e.resources[d]||0)>=u;if(f&&h){e.resources.gold-=l,e.resources[d]-=u;const v=q.DURABILITY.REPAIR_AMOUNT,b=o.durability;o.durability=Math.min(o.maxDurability,o.durability+v);const y=o.durability-b;s.durability.push({slot:i,item:o.name,amount:y}),s.message=`Reparerte ${o.name} (+${y} holdbarhet).`}else{s.success=!1;const v=((m=hn[d])==null?void 0:m.label)||d;return s.message=`Mangler ${f?"":`${l} gull`}${!f&&!h?" og ":""}${h?"":`${u} ${v}`}.`,!1}return!0},QP=t=>{const{actor:e,action:n,localResult:s}=t,{itemId:i,slot:r}=n;e.inventory&&!Array.isArray(e.inventory)&&(e.inventory=Object.values(e.inventory)),e.inventory||(e.inventory=[]);const a=e.inventory.findIndex(o=>o.id===i);if(a!==-1){const o=e.inventory[a],l=e.equipment[r];e.inventory.splice(a,1),e.equipment[r]=o,l&&e.inventory.push(l),s.message=`Utstyrte ${o.name}`}return!0},JP=t=>{const{actor:e,action:n,localResult:s}=t,{slot:i}=n,r=e.equipment[i];return r&&(e.equipment[i]=null,e.inventory&&!Array.isArray(e.inventory)&&(e.inventory=Object.values(e.inventory)),e.inventory||(e.inventory=[]),e.inventory.push(r),s.message=`Tok av ${r.name}`),!0},ZP=t=>{const{actor:e,room:n,localResult:s}=t;if(e.role!=="BARON"&&e.role!=="KING")return s.success=!1,!1;let i=0,r=0;return Object.values(n.players).forEach(a=>{if(a.role==="PEASANT"&&a.id!==e.id){const o=Math.floor((a.resources.gold||0)*q.TAX.PEASANT_RATE_DEFAULT),l=Math.floor((a.resources.grain||0)*q.TAX.PEASANT_RATE_DEFAULT);o>0&&(a.resources.gold-=o,i+=o),l>0&&(a.resources.grain-=l,r+=l)}}),e.resources.gold=(e.resources.gold||0)+i,e.resources.grain=(e.resources.grain||0)+r,i>0||r>0?(s.utbytte.push({resource:"gold",amount:i}),s.utbytte.push({resource:"grain",amount:r}),s.message=`Krevde inn skatt: ${i}g og ${r} korn fra bndene.`):s.message="Ingen skatt  kreve inn (bndene er blakke).",e.status.legitimacy=Math.max(0,(e.status.legitimacy||100)-5),!0},e6=t=>{const{actor:e,localResult:n}=t;if(e.role!=="BARON"&&e.role!=="KING")return n.success=!1,!1;const s=5,i=10;if((e.resources.gold||0)>=s&&(e.resources.grain||0)>=i)e.resources.gold-=s,e.resources.grain-=i,e.resources.manpower=(e.resources.manpower||0)+10,n.utbytte.push({resource:"manpower",amount:10}),n.message="Mobiliserte tropper (+10 Manpower).";else return n.success=!1,n.message="Mangler ressurser for  mobilisere.",!1;return!0},t6=t=>{const{actor:e,room:n,localResult:s}=t;if(e.role!=="KING")return!1;s.message="UTSTEDTE KONGELIG DEKRET: Ekstraskatt!";let i=0;return Object.values(n.players).forEach(r=>{r.role==="BARON"&&r.resources.gold>=20&&(r.resources.gold-=20,i+=20)}),e.resources.gold=(e.resources.gold||0)+i,s.utbytte.push({resource:"gold",amount:i}),!0},Nh=t=>{const{actor:e,room:n,action:s,localResult:i}=t,{buildingId:r,resource:a,amount:o}=s,l=Ut[r];if(!l)return i.success=!1,i.message=`Fant ikke bygning med ID: ${r}`,!1;const u=r==="farm_house";let d;u?(e.buildings||(e.buildings={}),e.buildings[r]||(e.buildings[r]={level:1,progress:{}}),d=e.buildings[r]):(n.world||(n.world={season:"Spring",weather:"Clear",year:1066,gameTick:0,lastTickAt:Date.now(),taxRateDetails:{kingTax:.1},settlement:{buildings:{}}}),n.world.settlement||(n.world.settlement={buildings:{}}),n.world.settlement.buildings||(n.world.settlement.buildings={}),n.world.settlement.buildings[r]||(n.world.settlement.buildings[r]={id:r,level:1,progress:{},contributions:{}}),d=n.world.settlement.buildings[r]),d.progress||(d.progress={}),e.resources||(e.resources=JSON.parse(JSON.stringify(At.PEASANT))),(!d.level||d.level<1)&&(d.level=1);const f=d.level+1,h=l.levels[f];if(!h)return i.success=!1,i.message="Maksimalt niv ndd.",!1;const v=(h.requirements||{})[a]||0,b=d.progress[a]||0,y=v-b;if(y<=0)return i.success=!1,i.message="Ressurskravet er allerede oppfylt.",!1;const p=e.resources[a]||0,g=Math.min(o,y,p);if(g<=0)return i.success=!1,i.message=`Kan ikke bidra 0 (Har: ${p}, Trenger: ${y}, Bud: ${o})`,!1;if(e.resources[a]=p-g,d.progress[a]=b+g,!u){d.contributions||(d.contributions={}),d.contributions[e.id]||(d.contributions[e.id]={name:e.name,resources:{}});const w=d.contributions[e.id].resources;w[a]=(w[a]||0)+g}i.message=`Bidro med ${g} ${a} til ${l.name}.`,i.utbytte.push({resource:a,amount:-g});let x=!0;return Object.entries(h.requirements).forEach(([w,N])=>{(d.progress[w]||0)<N&&(x=!1)}),x&&(d.level=f,d.progress={},u||(d.contributions={}),i.message+=`  NYTT NIV: ${l.name} ndde Niv ${f}!`),!0},n6=t=>{var l;const{actor:e,room:n,action:s,localResult:i}=t,r=typeof s=="string"?s:s.type,a=s.buildingId||r.replace("UPGRADE_BUILDING_",""),o=Ut[a];if(o){n.world.settlement||(n.world.settlement={buildings:{}});const d=(((l=n.world.settlement.buildings[a])==null?void 0:l.level)||1)+1,f=o.levels[d];if(f){let h=!0;if(Object.entries(f.requirements||{}).forEach(([m,v])=>{(e.resources[m]||0)<v&&(h=!1)}),h)Object.entries(f.requirements||{}).forEach(([m,v])=>{e.resources[m]-=v}),n.world.settlement.buildings[a]||(n.world.settlement.buildings[a]={id:a,level:1,progress:{},contributions:{}}),n.world.settlement.buildings[a].level=d,i.message=`Oppgraderte ${o.name} til Niv ${d}!`;else return i.success=!1,i.message="Mangler ressurser for oppgradering.",!1}}return!0},s6=t=>{var o;const{actor:e,action:n,localResult:s}=t,i=n.upgradeId,r=e.role,a=T0[r];if(a){const l=a.find(u=>u.id===i);if(l&&!((o=e.upgrades)!=null&&o.includes(i))){let u=!0;if(Object.entries(l.cost).forEach(([d,f])=>{e.resources[d]<f&&(u=!1)}),u)Object.entries(l.cost).forEach(([d,f])=>{e.resources[d]-=f}),e.upgrades||(e.upgrades=[]),e.upgrades.push(i),s.message=`Oppgradering fullfrt: ${l.name}`;else return s.success=!1,s.message="Har ikke rd til oppgradering.",!1}}return!0},i6=t=>{var l,u;const{actor:e,action:n,localResult:s}=t,i=n.targetRole;if(!i)return s.success=!1,s.message="Ingen rolle spesifisert.",!1;if(e.role===i)return s.success=!1,s.message=`Du er allerede ${i}.`,!1;if(["SOLDIER","MERCHANT","BARON","KING"].includes(i)&&i!=="BARON"&&i!=="KING"){const d=(l=e.roleStats)==null?void 0:l.PEASANT,f=(d==null?void 0:d.level)||(e.role==="PEASANT"?e.stats.level:1),h=q.CAREERS[i];if(h&&f<h.LEVEL_REQ)return s.success=!1,s.message=`Du m vre Bonde Niv ${h.LEVEL_REQ} for  bli ${i}. (N: ${f})`,!1}const a=((u=q.CAREERS[i])==null?void 0:u.COST)||0;if((e.resources.gold||0)<a)return s.success=!1,s.message=`Det koster ${a}g  bli ${i}. (Har: ${e.resources.gold}g)`,!1;e.roleStats||(e.roleStats={}),e.roleStats[e.role]={level:e.stats.level,xp:e.stats.xp,skills:JSON.parse(JSON.stringify(e.skills))},a>0&&(e.resources.gold-=a,s.utbytte.push({resource:"gold",amount:-a}));const o=e.roleStats[i];return o?(e.stats.level=o.level,e.stats.xp=o.xp,e.skills=o.skills):(e.stats.level=1,e.stats.xp=0,e.skills=JSON.parse(JSON.stringify(Cn[i]||Cn.PEASANT))),e.role=i,s.message=`Gratulerer! Du er n ${i}.`,!0},r6=t=>{const{actor:e,room:n,action:s,localResult:i}=t,{amount:r,resource:a}=s;if(e.role!=="BARON"&&e.role!=="KING")return!1;const o=e.regionId||"capital";n.regions||(n.regions={}),n.regions[o]||(n.regions[o]={id:o,name:o,defenseLevel:1,taxRate:10,rulerName:e.name});const l=n.regions[o];if(l.garrison||(l.garrison={swords:0,armor:0,morale:100}),e.inventory){const u=a==="swords"?"iron_sword":"leather_armor";let d=0;for(let h=0;h<e.inventory.length&&!((e.inventory[h].id===u||a==="swords"&&e.inventory[h].type==="MAIN_HAND"||a==="armor"&&e.inventory[h].type==="BODY")&&e.inventory[h].id===u&&(d++,d>=r));h++);if(d<r)return i.success=!1,i.message=`Mangler ${r-d} ${a==="swords"?"Jernsverd":"Lrrustninger"} i inventory.`,!1;let f=0;return e.inventory=e.inventory.filter(h=>f<r&&h.id===u?(f++,!1):!0),l.garrison[a]+=r,i.message=`Forsterket garnisonen med ${r} ${a==="swords"?"sverd":"rustninger"}.`,!0}return!1},a6=t=>{const{actor:e,room:n,localResult:s}=t;if(e.role!=="BARON"&&e.role!=="KING")return!1;const i=10,r=10,a=50;if((e.resources.stone||0)<i||(e.resources.wood||0)<r)return s.success=!1,s.message="Mangler stein eller ved for reparasjon.",!1;const o=e.regionId||"capital";if(!n.regions[o])return!1;const l=n.regions[o];return l.fortification||(l.fortification={hp:1e3,maxHp:1e3,level:1}),l.fortification.hp>=l.fortification.maxHp?(s.success=!1,s.message="Murene er allerede feilfrie.",!1):(e.resources.stone-=i,e.resources.wood-=r,l.fortification.hp=Math.min(l.fortification.maxHp,l.fortification.hp+a),s.message=`Reparerte murer (+${a} HP).`,s.utbytte.push({resource:"stone",amount:-i}),!0)},o6=t=>{const{actor:e,room:n,action:s,localResult:i}=t,{newRate:r}=s;if(e.role!=="BARON"&&e.role!=="KING")return!1;const a=Math.max(0,Math.min(20,r)),o=e.regionId||"capital";return n.regions||(n.regions={}),n.regions[o]||(n.regions[o]={id:o,name:o,defenseLevel:1,taxRate:10,rulerName:e.name}),n.regions[o].taxRate=a,i.message=`Skatteniv satt til ${a}%.`,!0},l6=.15,yy=15,c6=t=>{var u,d,f;const{actor:e,room:n,localResult:s,action:i}=t,r=((u=i.payload)==null?void 0:u.targetRegionId)||e.regionId;if(!r||r==="capital"||r==="unassigned")return s.success=!1,s.message="Du m angi en gyldig region for  starte beleiring.",!1;if(!n.regions)return console.error("CRITICAL: room.regions is undefined in handleStartSiege",n),s.success=!1,s.message="Systemfeil: Kunne ikke hente regiondata.",!1;const a=n.regions[r];if(!a)return s.success=!1,s.message="Regionen eksisterer ikke.",!1;if(a.activeSiege)return s.success=!1,s.message="Beleiring pgr allerede!",!1;if(a.rulerName===e.name)return s.success=!1,s.message="Du kan ikke beleire ditt eget slott!",!1;const o=((d=e.resources)==null?void 0:d.swords)||0;if(o<500)return s.success=!1,s.message=`Du trenger minst 500 sverd i forsyninger for  starte en beleiring! (Eier: ${o})`,!1;const l=((f=a.fortification)==null?void 0:f.hp)||1e3;return a.activeSiege={phase:"BREACH",startedAt:Date.now(),lastTick:Date.now(),attackers:{[e.id]:{lane:1,hp:100,name:e.name}},defenders:{},gateHp:l,maxGateHp:l},s.message=`Beleiringen av ${a.name} har startet!`,!0},u6=t=>{var m,v,b;const{actor:e,room:n,localResult:s,action:i}=t,r=((m=i.payload)==null?void 0:m.targetRegionId)||e.regionId;if(!r||!((v=n.regions[r])!=null&&v.activeSiege))return s.success=!1,s.message="Ingen aktiv beleiring her.",!1;const a=n.regions[r].activeSiege,o=a.attackers||{},l=a.defenders||{};if(o[e.id]||l[e.id])return s.message="Du deltar allerede.",!1;const u=e.regionId===r,d=["BARON","KING"].includes(e.role);if(!u&&!d)return s.success=!1,s.message="Bare innbyggere eller adelen kan delta i krigfring i dette omrdet.",!1;const f=((b=i.payload)==null?void 0:b.side)==="DEFENDER",h={damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0};return f?(a.defenders||(a.defenders={}),a.defenders[e.id]={lane:1,hp:100,name:e.name,stats:h},s.message="Du forsvarer murene!"):(a.attackers||(a.attackers={}),a.attackers[e.id]={lane:1,hp:100,name:e.name,stats:h},s.message="Du har sluttet deg til beleiringen!"),!0},d6=t=>{var d,f,h,m,v,b,y,p,g,x,w,N,T,E,A;const{actor:e,room:n,action:s,localResult:i}=t,r=((d=s.payload)==null?void 0:d.targetRegionId)||e.regionId;if(!r||!((f=n.regions[r])!=null&&f.activeSiege))return i.success=!1,i.message="Ingen aktiv beleiring funnet i dette omrdet.",!1;const a=n.regions[r].activeSiege,o=a.attackers||{},l=a.defenders||{},u=o[e.id]||l[e.id];if(!u)return i.message="Du m vre deltaker i beleiringen (angriper eller forsvarer) for  delta i kapplpet.",!1;if(a.phase==="BREACH"){if(s.subType==="ATTACK_GATE"){const R=(((h=e.resources)==null?void 0:h.swords)||0)>0,I=R?25:2;return R&&(e.resources.swords-=1),a.gateHp=Math.max(0,(a.gateHp||1e3)-I),u.stats=u.stats||{damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0},u.stats.damageDealt+=I,i.message=R?` Du hugger ls p porten! (-${I} HP). Du har ${e.resources.swords} sverd igjen.`:` Du slr p porten med nevene... det gjr nesten ingen skade. (-${I} HP)`,R&&i.utbytte.push({resource:"swords",amount:-1}),a.gateHp<=0&&(a.phase="COURTYARD",a.gateHp=0,i.message="PORTEN ER KNUST! Storm borggrden!"),!0}if(s.subType==="SHIELD_WALL")return!0}if(a.phase==="COURTYARD"){const k=a;if(k.bossHp||(k.bossHp=1e4,k.maxBossHp=1e4,k.bossTargetLane=1,k.nextBossAttack=Date.now()+5e3),s.subType==="MOVE_LANE"){const P=(m=s.payload)==null?void 0:m.lane;P>=0&&P<=2&&(u.lane=P,i.message=`Forflyttet til bane ${P===0?"Venstre":P===1?"Midten":"Hyre"}.`)}s.subType==="ATTACK_BOSS"&&(k.bossHp-=25,u.stats=u.stats||{damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0},u.stats.damageDealt+=25,i.message=`Angrep Bossen! HP: ${k.bossHp}`);const R=((b=(v=n.regions[r])==null?void 0:v.fortification)==null?void 0:b.level)||1,I=l6+R*.05;if(Date.now()>k.nextBossAttack){const P=k.bossTargetLane,V=u.lane===P,$=Math.random()<I;if(V||$){const K=(V?20:0)+($?yy:0),B=((y=e.resources)==null?void 0:y.armor)||0,j=Math.min(B,K),O=K-j;j>0&&(e.resources.armor-=j,i.utbytte.push({resource:"armor",amount:-j})),u.hp-=O,u.stats=u.stats||{damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0},u.stats.damageTaken+=K,V&&(i.message+=j>=20?"  Rustningen din tok sttet fra bossen!":"  AU! Bossen traff deg!"),$&&(i.message+=j>=yy?"  Rustningen din stoppet pilene!":`  Piler fra murene traff deg! (-${O} HP)`),O>0&&j>0&&(i.message+=` (Rustningen absorberte ${j} skade)`)}k.bossTargetLane=Math.floor(Math.random()*3),k.nextBossAttack=Date.now()+5e3}if(k.bossHp<=0){a.phase="THRONE_ROOM";const P=n.regions[r].rulerId,V=n.players[P||""],$=V&&Date.now()-(V.lastActive||0)<6e4,K={};$&&P&&V&&(K[P]={id:P,name:V.name,armor:100,progress:20,joinedAt:Date.now()}),a.throne={mode:$?"PVP":"PVE",occupation:0,plundered:!1,bossHp:$?(((p=V==null?void 0:V.status)==null?void 0:p.hp)||100)*5:5e3,maxBossHp:$?(((g=V==null?void 0:V.status)==null?void 0:g.hp)||100)*5:5e3,defendingPlayerId:P,occupiers:K},i.message="GARNISONSSJEFEN ER BESEIRET! Drene til Tronsalen sls opp!"}return!0}if(a.phase==="THRONE_ROOM"||a.phase==="THRONE"){let k=a.throne;(!k||!k.occupiers)&&(k=k||{},k.occupiers=k.occupiers||{},k.lastTick=Date.now(),a.throne=k);const R=Date.now();if(R-(k.lastTick||0)>1e3){const I=Math.floor((R-(k.lastTick||0))/1e3);k.lastTick=R;const P=Object.values(k.occupiers||{}),V=((w=(x=n.regions[r])==null?void 0:x.garrison)==null?void 0:w.armor)||0,$=Math.min(.8,V/100*.1);P.forEach(K=>{var oe;const j=K.id===n.regions[r].rulerId?1*(1-$):1;K.armor=Math.max(0,K.armor-j*I);const O=o[K.id]||l[K.id],Q=1*(1+(((oe=O==null?void 0:O.stats)==null?void 0:oe.damageDealt)||0)/200)*I;if(K.progress=Math.min(100,K.progress+Q),O&&(O.stats=O.stats||{damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0},O.stats.ticksOnThrone+=I),K.armor<=0)delete k.occupiers[K.id],i.message=`${K.name} falt fra tronen! (0 Beleiringsrustning)`;else if(K.progress>=100){delete n.regions[r].activeSiege;const be=n.regions[r];K.id===be.rulerId?i.message=` ${K.name} har knust opprret og gjenopprettet kontroll over ${be.name}!`:(i.message=` ${K.name} har vunnet kappelpet og TATT TRONEN med makt!`,i.siegeWinnerId=K.id,i.targetRegionId=r)}})}if(s.subType==="CLAIM_THRONE"){k.occupiers||(k.occupiers={});const I=10,P=e.resources.armor||0;return P<I?(i.message=`Mangler Beleiringsrustning! Du har ${P}, men trenger ${I}.`,!1):(e.resources.armor=0,k.occupiers[e.id]={id:e.id,name:e.name,armor:P,progress:0,joinedAt:Date.now()},i.message=`${e.name} kastet seg inn i kampen om tronen med ${P} rustning!`,!0)}if(s.subType==="DONATE_ARMOR"){const I=(N=s.payload)==null?void 0:N.targetId,P=k.occupiers[I];if(!P)return i.message="Ugyldig ml.",!1;const V=e.resources.armor||0;return V<1?(i.message="Du har ingen beleiringsrustning  gi!",!1):(e.resources.armor=V-1,P.armor+=1,u.stats=u.stats||{damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0},u.stats.armorDonated+=1,i.message=`Donerte rustning til ${P.name}`,!0)}if(s.subType==="SUNDER_ARMOR"){const I=(T=s.payload)==null?void 0:T.targetId,P=k.occupiers[I];if(!P)return i.success=!1,i.message="Ingen p tronen  angripe!",!1;P.armor=Math.max(0,P.armor-1),u.stats=u.stats||{damageDealt:0,damageTaken:0,armorDonated:0,ticksOnThrone:0},u.stats.damageDealt+=1;const V=I===n.regions[r].rulerId,$=((A=(E=n.regions[r])==null?void 0:E.garrison)==null?void 0:A.armor)||0;return V&&$>0?i.message=` Du angriper ${P.name}! Angrepet er mindre effektivt pga. slottets garnison-skjold.`:i.message=` Angrep ${P.name} p tronen!`,!0}return s.subType==="TICK",!0}return!1},f6=t=>{var o,l,u,d,f,h;const{actor:e,room:n,localResult:s,trackXp:i,damageTool:r}=t;if(e.role!=="BARON")return s.success=!1,!1;const a=Object.values(n.players).find(m=>m.role==="BARON"&&m.id!==e.id);if(a){if((((o=n.world)==null?void 0:o.activeLaws)||[]).includes("peace"))return s.success=!1,s.message="Fredsavtale blokkerer raid!",!1;const v=e.resources.manpower||0;let b=a.resources.manpower||0,y=Math.random()*.5+.75;if((l=a.upgrades)!=null&&l.includes("stone_keep")&&(b+=30),(u=a.upgrades)!=null&&u.includes("fence")&&(b+=10),(d=e.upgrades)!=null&&d.includes("stables")&&(y+=.1),(f=e.equipment)!=null&&f.MAIN_HAND&&r("MAIN_HAND",q.DURABILITY.LOSS_COMBAT_WEAPON),(h=e.equipment)!=null&&h.BODY&&r("BODY",q.DURABILITY.LOSS_COMBAT_ARMOR),v*y>b){const p=Math.floor((a.resources.gold||0)*q.COMBAT.RAID_LOOT_FACTOR),g=Math.floor((a.resources.grain||0)*q.COMBAT.RAID_LOOT_FACTOR);a.resources.gold=Math.max(0,(a.resources.gold||0)-p),a.resources.grain=Math.max(0,(a.resources.grain||0)-g),e.resources.gold=(e.resources.gold||0)+p,e.resources.grain=(e.resources.grain||0)+g,e.resources.manpower=Math.max(0,e.resources.manpower-5),a.resources.manpower=Math.max(0,a.resources.manpower-8),s.utbytte.push({resource:"gold",amount:p}),s.utbytte.push({resource:"grain",amount:g}),s.message=`Plyndret ${a.name} for ${p}g og ${g} korn!`,i("COMBAT",50)}else return e.resources.manpower=Math.max(0,e.resources.manpower-10),s.success=!1,s.message=`Angrepet p ${a.name} ble sltt tilbake.`,i("COMBAT",10),!1}else return s.success=!1,s.message="Fant ingen annen baron  raide.",!1;return!0},h6=t=>{const{actor:e,action:n,localResult:s,trackXp:i}=t,r=n.performance||.5,a=Math.ceil(15*r);return e.resources.gold=(e.resources.gold||0)+a,i("COMBAT",10),s.utbytte.push({resource:"gold",amount:a}),s.message="Utfrte patrulje.",!0},m6=t=>{var d;const{actor:e,room:n,action:s,localResult:i}=t,{resource:r}=s,a=e.regionId||"capital";let o=((d=n.markets)==null?void 0:d[a])||n.market;if(o||(n.markets||(n.markets={}),o=JSON.parse(JSON.stringify(bt)),n.markets[a]=o),!o)return i.success=!1,i.message="Markedet er ikke tilgjengelig.",!1;if(!o[r]&&bt[r]&&(o[r]={...bt[r]}),!o[r])return i.success=!1,i.message="Markedet tilbyr ikke denne varen her.",!1;const l=o[r];if(!l)return i.success=!1,i.message="Varen finnes ikke p dette markedet.",!1;const u=l.price;return l.stock<=0?(i.success=!1,i.message="Varen er utsolgt.",!1):(e.resources.gold||0)<u?(i.success=!1,i.message="Du har ikke nok gull.",!1):(e.resources.gold=(e.resources.gold||0)-u,e.resources[r]=(e.resources[r]||0)+1,l.stock-=1,l.price+=l.price*q.MARKET.PRICE_IMPACT_BUY,i.message=`Kjpte 1 ${r} for ${u.toFixed(2)}g`,i.utbytte.push({resource:r,amount:1}),!0)},p6=t=>{var d;const{actor:e,room:n,action:s,localResult:i}=t,{resource:r}=s,a=e.regionId||"capital";let o=((d=n.markets)==null?void 0:d[a])||n.market;if(o||(n.markets||(n.markets={}),o=JSON.parse(JSON.stringify(bt)),n.markets[a]=o),!o)return i.success=!1,i.message="Markedet er ikke tilgjengelig.",!1;if(!o[r]&&bt[r]&&(console.log(`Lazy patching market: Adding missing ${r}`),o[r]={...bt[r]}),!o[r])return i.success=!1,i.message="Markedet tar ikke imot denne varen her.",!1;if((e.resources[r]||0)<1)return i.success=!1,i.message=`Du har ingen ${r}  selge.`,!1;const l=o[r];if(!l)return i.success=!1,i.message="Markedet tar ikke imot denne varen.",!1;const u=l.price*q.MARKET.SELL_RATIO;return e.resources[r]-=1,e.resources.gold=(e.resources.gold||0)+u,l.stock+=1,l.price-=l.price*q.MARKET.PRICE_IMPACT_SELL,i.message=`Solgte 1 ${r} for ${u.toFixed(2)}g`,!0},g6=t=>{var v,b;const{actor:e,room:n,action:s,localResult:i,trackXp:r}=t,{resource:a,targetRegionId:o,action:l}=s,u=e.regionId||"capital",d=((v=n.markets)==null?void 0:v[u])||n.market,f=(b=n.markets)==null?void 0:b[o];if(!d||!f||!d[a]||!f[a])return i.success=!1,i.message="Ugyldig handelsrute eller vare.",!1;const h=d[a],m=f[a];if(!h||!m)return i.success=!1,i.message="Varen handles ikke p disse markedene.",!1;if(l==="IMPORT"){const p=m.price*5;if((e.resources.gold||0)<p)return i.success=!1,i.message="Ikke nok gull til bulk-import.",!1;if(m.stock<5)return i.success=!1,i.message="Mangler bulk-lager ved kilden.",!1;e.resources.gold-=p,e.resources[a]=(e.resources[a]||0)+5,m.stock-=5,m.price+=m.price*.02,i.message=`Importerte 5 ${a} fra ${o} for ${p.toFixed(2)}g`}else{if((e.resources[a]||0)<5)return i.success=!1,i.message=`Mangler 5 ${a} for eksport.`,!1;const p=m.price*q.MARKET.SELL_RATIO*5;e.resources[a]-=5,e.resources.gold+=p,m.stock+=5,m.price-=m.price*.02,i.message=`Eksporterte 5 ${a} til ${o} for ${p.toFixed(2)}g`}return r("TRADING",25),!0},v6=t=>{var o;const{actor:e,room:n,localResult:s}=t;if(!(Ns(((o=n.world)==null?void 0:o.gameTick)||0)==="NIGHT"))return s.success=!1,s.message=" Du kan bare sove nr det er natt.",!1;const a=100-(e.status.stamina||0);return e.status.stamina=100,e.status.hp=Math.min(100,(e.status.hp||100)+20),e.activeBuffs||(e.activeBuffs=[]),e.activeBuffs=e.activeBuffs.filter(l=>l.type!=="STAMINA_SAVE"||l.label!=="Godt utvilt"),e.activeBuffs.push({id:"well_rested_"+Date.now(),type:"STAMINA_SAVE",value:.5,label:"Godt utvilt",description:"50% mindre stamina-forbruk etter en god natts svn.",expiresAt:Date.now()+3e5}),s.message="Du sov tungt gjennom natten. Vknet opp uthvilt og full av energi!",s.utbytte.push({resource:"stamina",amount:a}),!0},Vc=t=>{var d;const{actor:e,action:n,localResult:s}=t,i=typeof n=="string"?n:n.type,r=n.locationId;let a=30,o=0,l="Hvilte.";if(i==="EAT"&&(a=40,l="Satt ved varmen og spiste."),i==="FEAST"&&(a=100,o=20,l="Holdt gjestebud!"),i==="GATHER_WATER"||r==="farm_well"||r==="well_water"){e.activeProcesses||(e.activeProcesses=[]);const f=r||(i==="GATHER_WATER"?"well_water":null);if(f){const h=e.activeProcesses.find(m=>m.type==="WELL"&&m.locationId===f);if(h){if(h.readyAt>Date.now())return s.success=!1,s.message="Brnnen er tom. Den fyller seg med vann...",!1;e.activeProcesses=e.activeProcesses.filter(m=>m.id!==h.id)}a=5,l="Drakk friskt vann fra brnnen.",e.activeProcesses.push({id:"well_"+Date.now(),type:"WELL",itemId:"water",locationId:f,startedAt:Date.now(),duration:3e5,readyAt:Date.now()+3e5,notified:!1})}}return r==="village_square"&&(a=10,l="Hvilte p torget.",PP(e,"REST_SQUARE",6*60*1e3)),(d=e.upgrades)!=null&&d.includes("roof")&&(a+=20),r==="royal_chambers"&&(a=100,o=100,l="Hvilte ut i de kongelige kamrene. Fler deg som en konge igjen!",e.activeBuffs||(e.activeBuffs=[]),e.activeBuffs=e.activeBuffs.filter(f=>f.label!=="Kongelig Velvre"),e.activeBuffs.push({id:"royal_wellness_"+Date.now(),type:"STAMINA_SAVE",value:.6,label:"Kongelig Velvre",description:"Fyrstelig velvre reduserer stamina-forbruk med 60%.",expiresAt:Date.now()+6e5})),e.status.stamina=Math.min(100,(e.status.stamina||0)+a),o>0&&(e.status.hp=Math.min(100,(e.status.hp||100)+o)),s.utbytte.push({resource:"stamina",amount:a}),s.message=l,!0},b6=t=>{const{actor:e,localResult:n,trackXp:s}=t,i=Math.floor(Math.random()*5)+1;return e.resources.favor=(e.resources.favor||0)+i,n.utbytte.push({resource:"favor",amount:i}),s("THEOLOGY",10),n.message=`Ba til gudene. (+${i} velvilje)`,!0},x6=t=>{const{localResult:e}=t,n=["Baronen ser nervs ut i dag.","Hrte du ulvene i natt?","Prisen p korn gr opp.","Kongens soldater er p vei."];return e.message=`Sladder: "${n[Math.floor(Math.random()*n.length)]}"`,!0},_y=t=>{const{actor:e,action:n,localResult:s}=t,{amount:i,isWin:r,playerRoll:a,houseRoll:o}=n;return r?(e.resources.gold=(e.resources.gold||0)+i,s.utbytte.push({resource:"gold",amount:i}),s.message=`Vant ${i}g p terninger! (${a} mot ${o})`):(e.resources.gold=Math.max(0,(e.resources.gold||0)-i),s.message=`Tapte ${i}g p terninger. (${a} mot ${o})`),!0},y6=t=>{const{actor:e,localResult:n}=t,s=5;if((e.resources.gold||0)>=s){e.resources.gold-=s;const i=10;e.status.stamina=Math.min(100,(e.status.stamina||0)+i),n.utbytte.push({resource:"stamina",amount:i}),n.message="Kjpte et mltid i baren. (+10 Stamina)"}else return n.success=!1,n.message="Har ikke rd til mat (koster 5g).",!1;return!0},_6=t=>{const{actor:e,room:n,localResult:s}=t;return s.message=`${e.name} har valgt  trekke seg tilbake fra dette livet.`,delete n.players[e.id],!0},w6=t=>{const{actor:e,action:n,localResult:s,room:i}=t,r=n.itemId;if(n.isResource)return(e.resources[r]||0)<1?(s.success=!1,s.message="Du har ikke mer igjen.",!1):r==="omelette"?(e.activeBuffs||(e.activeBuffs=[]),e.activeBuffs=e.activeBuffs.filter(d=>d.type!=="STAMINA_SAVE"),e.activeBuffs.push({id:Math.random().toString(36).substr(2,9),type:"STAMINA_SAVE",value:.2,label:"Lett til beins",description:"Reduserer stamina-kostnad med 20%.",expiresAt:Date.now()+9e5,sourceItem:"omelette"}),e.resources.omelette--,s.message="Spiste Omelett. (20% stamina-spare buff)",s.utbytte.push({resource:"omelette",amount:-1}),Wt(i.pin,"consumed","omelette",1),!0):r==="bread"?(e.status.stamina=Math.min(100,(e.status.stamina||0)+20),e.resources.bread--,s.message="Spiste Brd. (+20 Stamina)",s.utbytte.push({resource:"stamina",amount:20}),s.utbytte.push({resource:"bread",amount:-1}),Wt(i.pin,"consumed","bread",1),!0):(s.success=!1,s.message="Kan ikke spises (ukjent ressurs).",!1);if(!e.inventory)return s.success=!1,s.message="Ryggsekk er tom.",!1;const o=e.inventory.findIndex(u=>u.id===r);if(o===-1)return s.success=!1,s.message="Fant ikke gjenstanden.",!1;const l=e.inventory[o];return l.id==="omelette"||l.id.startsWith("omelette_")?(e.activeBuffs||(e.activeBuffs=[]),e.activeBuffs=e.activeBuffs.filter(u=>u.type!=="STAMINA_SAVE"),e.activeBuffs.push({id:Math.random().toString(36).substr(2,9),type:"STAMINA_SAVE",value:.2,label:"Lett til beins",description:"Reduserer stamina-kostnad med 20%.",expiresAt:Date.now()+9e5,sourceItem:"omelette"}),e.inventory.splice(o,1),s.message="Spiste Omelett (Gjenstand).",s.utbytte.push({resource:"omelette",amount:-1}),Wt(i.pin,"consumed","omelette",1),!0):l.id==="bread"||l.id.startsWith("bread_")?(e.status.stamina=Math.min(100,(e.status.stamina||0)+20),e.inventory.splice(o,1),s.message="Spiste Brd (Gjenstand). (+20 Stamina)",s.utbytte.push({resource:"stamina",amount:20}),s.utbytte.push({resource:"stamina",amount:20}),s.utbytte.push({resource:"bread",amount:-1}),Wt(i.pin,"consumed","bread",1),!0):(s.success=!1,s.message="Kan ikke spises.",!1)},CS={WORK:GP,CHOP:VP,MINE:xy,QUARRY:xy,FORAGE:FP,HUNT:zP,GATHER_WOOL:$P,GATHER_HONEY:KP,PLANT:UP,HARVEST:HP,MAINTAIN_CROP:BP,CRAFT:WP,REFINE:Lr,BAKE:Lr,MILL:Lr,SMELT:Lr,WEAVE:Lr,MIX:Lr,REPAIR:XP,EQUIP_ITEM:QP,UNEQUIP_ITEM:JP,TAX:ZP,DRAFT:e6,DECREE:t6,CONSTRUCT:Nh,CONTRIBUTE_TO_UPGRADE:Nh,CONTRIBUTE_TO_PRIVATE_UPGRADE:Nh,UPGRADE_BUILDING:n6,UPGRADE:s6,JOIN_ROLE:i6,REINFORCE_GARRISON:r6,REPAIR_WALLS:a6,SET_TAX:o6,START_SIEGE:c6,JOIN_SIEGE:u6,SIEGE_ACTION:d6,RAID:f6,PATROL:h6,SLEEP:v6,REST:Vc,EAT:Vc,FEAST:Vc,PRAY:b6,CHAT_LOCAL:x6,GAMBLE_RESULT:_y,PLAY_DICE:_y,BUY_MEAL:y6,RETIRE:_6,CONSUME:w6,FEED_CHICKENS:YP,COLLECT_EGGS:qP,GATHER_WATER:Vc,TRADE_ROUTE:g6,BUY:m6,SELL:p6},E6=(t,e,n,s)=>{var u,d;t.roleStats||(t.roleStats={});const i=t.role;t.roleStats[i]||(t.roleStats[i]={level:((u=t.stats)==null?void 0:u.level)||1,xp:((d=t.stats)==null?void 0:d.xp)||0,skills:JSON.parse(JSON.stringify(t.skills||Cn[i]||Cn.PEASANT))});const r=t.roleStats[i],a=r.skills[e];a&&(a.xp+=n||0,a.xp>=a.maxXp&&(a.level+=1,a.xp-=a.maxXp,a.maxXp=Math.floor(a.maxXp*1.5),s.push(` ${t.name} ble bedre i ${e}! (Niv ${a.level})`))),r.xp=(r.xp||0)+(n||0);const l=(f=>{const h=bd.findIndex(m=>f<m);return h===-1?bd.length:h})(r.xp);l>r.level&&(r.level=l,s.push(` ${t.name} har steget i rang som ${i} til Niv ${l}!`)),t.stats.xp=r.xp,t.stats.level=r.level,t.skills=r.skills};async function N6(t,e,n){var i,r,a;if(!t||!n)return;const s=D(L,`simulation_accounts/${t}`);try{const o=await ye(s);if(!o.exists())return;const l=o.val(),u=l.characterHistory||[],d={name:n.name,role:n.role,level:((i=n.stats)==null?void 0:i.level)||1,xp:((r=n.stats)==null?void 0:r.xp)||0,roomPin:e,timestamp:Date.now()},f=[...u,d],h=((a=n.stats)==null?void 0:a.xp)||0,m=(l.globalXp||0)+h,v=Math.floor(Math.sqrt(m/100))+1;await J(s,{characterHistory:f,globalXp:m,globalLevel:v,lastActive:Date.now()}),console.log(`Character life recorded for ${n.name} (${t})`)}catch(o){console.error("Failed to record character life:",o)}}async function k6(t,e,n){const s=typeof n=="string"?n:n.type,i=D(L,`simulation_rooms/${t}/players/${e}`),r=D(L,`simulation_rooms/${t}/regions`),a=D(L,`simulation_rooms/${t}/world`);try{const[o,l,u]=await Promise.all([ye(i),ye(r),ye(a)]);if(!o.exists())return{success:!1,error:"Spiller finnes ikke"};const d=o.val();d.resources||(d.resources=At[d.role]||At.PEASANT);const f=l.val()||{},h=u.val()||{},m={success:!0,timestamp:Date.now(),message:"",utbytte:[],xp:[],durability:[]},v={world:h,regions:f,players:{[e]:d},markets:{},messages:[]},b={actor:d,room:v,pin:t,action:n,timestamp:new Date().toLocaleTimeString(),localResult:m,trackXp:(N,T)=>{},damageTool:()=>!0},y=CS[s];if(!y)return{success:!1,error:"Ukjent handling"};if(!y(b)||!m.success)return{success:!1,data:m};const g={};g[`players/${e}`]=d;const x=m.siegeWinnerId,w=m.targetRegionId;if(x&&w){const N=f[w],T=N.rulerId;if(T&&T!==x){const A=await ye(D(L,`simulation_rooms/${t}/players/${T}`));if(A.exists()){const k=A.val();k.role="PEASANT",k.status&&(k.status.legitimacy=0),g[`players/${T}`]=k,g[`public_profiles/${T}/role`]="PEASANT",Wt(t,"roleChanges","PEASANT (Demoted)",1)}}const E=await ye(D(L,`simulation_rooms/${t}/players/${x}`));if(E.exists()){const A=E.val();A.role="BARON",A.regionId=w,A.status&&(A.status.legitimacy=100),g[`players/${x}`]=A,g[`public_profiles/${x}/role`]="BARON",g[`public_profiles/${x}/regionId`]=w,N.rulerId=x,N.rulerName=A.name}}return g.regions=f,await J(D(L,`simulation_rooms/${t}`),g),{success:!0,data:m}}catch(o){return console.error("Siege Transaction Failed",o),{success:!1,error:o.message||"Beleiring feilet"}}}const S6=["RAID","TAX","TAX_PEASANTS","TAX_ROYAL","TRADE","TRADE_ROUTE","CONTRIBUTE_TO_UPGRADE","BUY","SELL","CONTRIBUTE","CONSTRUCT","UPGRADE_BUILDING","START_SIEGE","JOIN_SIEGE","SIEGE_ACTION"],jS=async(t,e,n)=>{const s=typeof n=="string"?n:n.type;return S6.includes(s)?A6(t,e,n):T6(t,e,n)};async function T6(t,e,n){const s=D(L,`simulation_rooms/${t}/players/${e}`),i=D(L,`simulation_rooms/${t}/world`);let r=null;try{const a=await ye(i),o=a.exists()?a.val():{season:"Spring",weather:"Clear",activeLaws:[]};if(await Re(s,l=>{var w,N,T;if(!l)return l;l.resources||(l.resources=JSON.parse(JSON.stringify(At[l.role]||At.PEASANT))),l.skills||(l.skills=JSON.parse(JSON.stringify(Cn[l.role]||Cn.PEASANT))),l.status||(l.status={stamina:100,hp:100,authority:0,gold:l.resources.gold||0,level:1,xp:0}),l.equipment||(l.equipment={HEAD:null,BODY:null,MAIN_HAND:null,OFF_HAND:null,FEET:null,TRINKET:null,AXE:null,PICKAXE:null,SCYTHE:null,HAMMER:null}),l.stats||(l.stats={level:1,xp:0}),l.activeBuffs||(l.activeBuffs=[]);const u={success:!0,timestamp:Date.now(),message:"",utbytte:[],xp:[],durability:[]},d=(E,A)=>{var P,V,$,K;const k=((V=(P=l.skills)==null?void 0:P[E])==null?void 0:V.level)||0,R=[];E6(l,E,A,R),R.length>0&&(u.message+=" "+R.join(" "));const I=((K=($=l.skills)==null?void 0:$[E])==null?void 0:K.level)||0;u.xp.push({skill:E,amount:A,levelUp:I>k})},f=l.stats.level||1,h=(E,A)=>{var R;const k=(R=l.equipment)==null?void 0:R[E];return k&&(k.durability=Math.max(0,k.durability-A),u.durability.push({slot:E,item:k.name||"Gjenstand",amount:A,broken:k.durability<=0}),k.durability<=0)?(u.message=` ${k.name} ble delagt!`,u.success=!1,!1):!0},m=Date.now(),v=m-(l.lastActive||m),b=Math.min(60,isNaN(v)?0:v/6e4);if(b>.1){let E=0;(w=l.upgrades)!=null&&w.includes("cow")&&(E+=b*q.PASSIVE_INCOME.COW),(N=l.upgrades)!=null&&N.includes("accounting_books")&&(E+=b*q.PASSIVE_INCOME.ACCOUNTING_BOOKS),(T=l.upgrades)!=null&&T.includes("caravan")&&(E+=b*q.PASSIVE_INCOME.CARAVAN),E>0&&(l.resources.gold=(l.resources.gold||0)+Math.floor(E));const A=b*2;l.status.stamina=Math.min(100,(l.status.stamina||0)+A)}const y=l.role,p=typeof n=="string"?n:n.type,g=hc[p];if(g){const E=Dn(g.stamina||0,o.season,o.weather,l.activeBuffs,o.gameTick||0);for(const[A,k]of Object.entries(g)){if(A==="stamina")continue;const R=A;if((l.resources[R]||0)<k)return u.success=!1,u.message=` Mangler ${k} ${A}!`,r=u,l}if((l.status.stamina||0)<E)return u.success=!1,u.message=` For sliten! (${E} kreves)`,r=u,l;for(const[A,k]of Object.entries(g)){if(A==="stamina")continue;const R=A;l.resources[R]=(l.resources[R]||0)-k,Wt(t,"consumed",A,k)}l.status.stamina-=E}const x=CS[p];if(x){const E={actor:l,room:{world:o,players:{[e]:l},messages:[]},pin:t,action:n,timestamp:new Date().toLocaleTimeString(),localResult:u,trackXp:d,damageTool:h};if(x(E)===!1)return r=u,l}else u.success=!1,u.message=`Ukjent handling: ${p}`;return u.message||(u.message="Handling utfrt."),u.success&&Math.random()<.005&&(l.resources.gold=(l.resources.gold||0)+150,u.utbytte.push({id:"ancient_relic",name:"Gammel Relikvie",type:"ITEM",icon:"",amount:1,jackpot:!0}),u.message+="  ET JORDFUNN! Du fant en eldgammel relikvie!"),l.lastActive=Date.now(),r=u,p==="RETIRE"&&u.success&&(r.characterSnapshot=JSON.parse(JSON.stringify(l))),l.stats.level>f&&(r.newLevel=l.stats.level),l.role!==y&&Wt(t,"roleChanges",l.role,1),l}),r&&r.success){if(r.message&&await wt(t,`[${new Date().toLocaleTimeString()}] ${r.message}`),r.utbytte&&r.utbytte.length>0&&r.utbytte.forEach(l=>{const u=l.type==="ITEM"?"crafted":"produced";Wt(t,u,l.id||l.resource,l.amount||1)}),r.characterSnapshot){const l=r.characterSnapshot.uid||e;await N6(l,t,r.characterSnapshot)}if(r.newLevel)try{await J(D(L,`simulation_rooms/${t}/public_profiles/${e}`),{"stats/level":r.newLevel,lastActive:Date.now()})}catch(l){console.error("Failed to sync level",l)}}return{success:!!(r!=null&&r.success),data:r||void 0}}catch(a){return console.error("Action error:",a),{success:!1,error:a.message||"Handling feilet"}}}async function A6(t,e,n){const s=typeof n=="string"?n:n.type;try{return s==="BUY"||s==="SELL"||s==="TRADE_ROUTE"?await SP(t,e,n):s==="CONTRIBUTE"||s==="CONTRIBUTE_TO_UPGRADE"||s==="CONSTRUCT"||s==="UPGRADE_BUILDING"?await TP(t,e,n):s==="TAX"||s==="TAX_PEASANTS"||s==="TAX_ROYAL"?await AP(t,e,n):s==="START_SIEGE"||s==="JOIN_SIEGE"||s==="SIEGE_ACTION"?await k6(t,e,n):{success:!1,error:"Global handling not available."}}catch(i){return console.error("Global Action ERROR:",i),{success:!1,error:i.message||"Global handling feilet"}}}class R6{constructor(e,n){$e(this,"player");$e(this,"genome");$e(this,"brain");$e(this,"startTime");$e(this,"history",[]);$e(this,"status","RUNNING");$e(this,"lastActionAt",0);$e(this,"stuckThreshold",6e4);this.player=e,this.genome=n,this.brain=new MP(n),this.startTime=Date.now()}async tick(e,n){if(this.status!=="RUNNING")return;const s=this.brain.decide(this.player,e);if(this.history.push(s),this.history.length>20&&this.history.shift(),s.action==="IDLE"){Date.now()-this.lastActionAt>this.stuckThreshold&&(this.status="STUCK",this.dumpLog("Bottleneck detected: Stuck for > 60s"));return}this.lastActionAt=Date.now(),(await jS(n,this.player.id,s.action)).success,this.player.role==="KING"&&(this.status="SUCCESS")}getFitness(){return dp.calculateFitness(this.player,this.startTime)}dumpLog(e){const n={reason:e,genome:this.genome,history:this.history,playerState:this.player,timestamp:Date.now()};console.error("AI Training Lab - Game Balance Issue:",n),window.lastAILog=n}}const I6=({roomData:t,pin:e})=>{var N;const[n,s]=_.useState([]),[i,r]=_.useState(0),[a,o]=_.useState(!1),[l,u]=_.useState([]),[d,f]=_.useState({}),[h,m]=_.useState({}),[v,b]=_.useState(null),y=_.useRef(t);_.useEffect(()=>{y.current=t},[t]);const p=_.useRef(null),g=async()=>{const T={};for(let E=1;E<=5;E++){const A=`bot_${Date.now()}_${E}`,k={id:A,name:`BOT Alpha ${E}`,role:"PEASANT",regionId:Math.random()>.5?"region_ost":"region_vest",resources:{...At.PEASANT},status:{hp:100,stamina:100,morale:100,legitimacy:100,authority:50,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:1,xp:0,reputation:10,contribution:0},skills:{...Cn.PEASANT},lastActive:Date.now(),online:!0};T[`simulation_rooms/${e}/players/${A}`]=k,T[`simulation_rooms/${e}/public_profiles/${A}`]={id:A,stats:{level:1},status:k.status,online:!0,lastActive:Date.now()}}try{await J(D(L),T)}catch(E){console.error("Failed to spawn bots",E)}},x=()=>{t.players&&o(!0)},w=()=>{o(!1),p.current&&cancelIdleCallback(p.current)};return _.useEffect(()=>{if(a){const T=async()=>{const E=y.current,A=Object.values(E.players||{}).filter(k=>k.name.includes("BOT"));await Promise.all(A.map(async k=>{let R=n.find(I=>I.player.id===k.id);if(R)R.player=k;else{const I=dp.getNextGenerationGenome();R=new R6(k,I),s(P=>[...P,R]),r(I.generation)}if(await R.tick(E,e),R.history.length>0){const I=R.history[R.history.length-1];let P=I.action.type||"IDLE";P==="SELL"&&I.action.itemId?P=`SELL (${I.action.itemId})`:P==="BUY"&&I.action.itemId&&(P=`BUY (${I.action.itemId})`),f(V=>({...V,[P]:(V[P]||0)+1})),m(V=>({...V,[R.player.id]:{name:R.player.name,action:P,reason:I.reason,score:I.score.toFixed(2),fitness:R.getFitness().toFixed(1),resources:{...R.player.resources},stamina:R.player.status.stamina}}))}if((R.status==="STUCK"||R.status==="DEAD")&&b(window.lastAILog),R.status==="SUCCESS"||R.status==="DEAD"||R.status==="STUCK"){const I=R.getFitness();R.genome.fitness=I,dp.saveTopGenomes([R.genome]),u(P=>[...P.slice(-19),I])}})),p.current=window.setTimeout(()=>T(),1e3)};T()}return()=>{p.current&&clearTimeout(p.current)}},[a,e]),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-center bg-slate-900/50 p-6 rounded-2xl border border-white/10",children:[c.jsxs("div",{children:[c.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[c.jsx(r3,{className:"text-indigo-400"})," AI Training Lab"]}),c.jsx("p",{className:"text-slate-400 text-sm",children:"Genetisk Algoritme-optimalisering av spillbalanse"})]}),c.jsx("div",{className:"flex gap-3",children:a?c.jsxs("button",{onClick:w,className:"bg-red-600 hover:bg-red-500 px-4 py-2 rounded-lg flex items-center gap-2 font-bold transition-all",children:[c.jsx(lp,{size:18})," Stopp Trening"]}):c.jsxs("button",{onClick:x,className:"bg-indigo-600 hover:bg-indigo-500 px-4 py-2 rounded-lg flex items-center gap-2 font-bold transition-all",children:[c.jsx(yd,{size:18})," Start Trening"]})})]}),a&&Object.values(t.players||{}).filter(T=>T.name.includes("BOT")||T.id.startsWith("bot_")).length===0&&c.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/20 p-6 rounded-2xl flex items-center justify-between animate-in slide-in-from-top-2",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"bg-amber-500/20 p-3 rounded-full text-amber-500",children:c.jsx(O0,{size:24})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-amber-500 font-black uppercase text-sm",children:"Ingen bot-subjekter funnet"}),c.jsx("p",{className:"text-amber-200/60 text-xs",children:"AI-en trenger kropper  kontrollere (navn med 'BOT' eller ID 'bot_')."})]})]}),c.jsx("button",{onClick:g,className:"bg-amber-500 hover:bg-amber-400 text-black px-6 py-3 rounded-xl font-black uppercase text-xs tracking-widest transition-all shadow-lg hover:scale-105",children:" Spawn Alpha Squad (5 stk)"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"bg-slate-900/50 p-6 rounded-2xl border border-white/10",children:[c.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-xs uppercase font-black mb-2",children:[c.jsx(hy,{size:14})," Generasjon"]}),c.jsx("div",{className:"text-4xl font-black",children:i})]}),c.jsxs("div",{className:"bg-slate-900/50 p-6 rounded-2xl border border-white/10 flex flex-col justify-between",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-xs uppercase font-black mb-2",children:[c.jsx(iP,{size:14})," Fitness Trend"]}),c.jsx("div",{className:"text-4xl font-black mb-4",children:l.length>0?(l.reduce((T,E)=>T+E,0)/l.length).toFixed(1):"0.0"})]}),c.jsxs("div",{className:"h-12 flex items-end gap-1 px-1",children:[l.map((T,E)=>{const A=Math.max(...l,1),k=T/A*100;return c.jsx("div",{className:"flex-1 bg-indigo-500/50 rounded-t-sm transition-all duration-500 hover:bg-indigo-400",style:{height:`${k}%`},title:`Fitness: ${T.toFixed(1)}`},E)}),l.length===0&&c.jsx("div",{className:"w-full h-[1px] bg-white/10"})]})]}),c.jsxs("div",{className:"bg-slate-900/50 p-6 rounded-2xl border border-white/10 text-amber-500",children:[c.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-xs uppercase font-black mb-2",children:[c.jsx(vy,{size:14})," Bottlenecks"]}),c.jsx("div",{className:"text-4xl font-black text-amber-500",children:n.filter(T=>T.status==="STUCK").length})]})]}),c.jsxs("div",{className:"bg-slate-900/50 p-6 rounded-2xl border border-white/10",children:[c.jsx("h3",{className:"text-sm font-bold uppercase tracking-widest text-slate-400 mb-4",children:"Decision Heatmap"}),c.jsxs("div",{className:"flex flex-wrap gap-4",children:[Object.entries(d).sort((T,E)=>E[1]-T[1]).map(([T,E])=>c.jsxs("div",{className:"bg-white/5 p-3 rounded-lg border border-white/5 flex flex-col items-center min-w-[80px]",children:[c.jsx("span",{className:"text-xs text-slate-500 uppercase",children:T}),c.jsx("span",{className:"text-lg font-bold",children:E})]},T)),Object.keys(d).length===0&&c.jsx("p",{className:"text-slate-600 italic",children:"Ingen data enn..."})]})]}),c.jsxs("div",{className:"bg-slate-900/50 p-6 rounded-2xl border border-white/10",children:[c.jsxs("h3",{className:"text-sm font-bold uppercase tracking-widest text-slate-400 mb-4 flex items-center gap-2",children:[c.jsx(hy,{size:16,className:"text-indigo-400"})," Live Neural Feed"]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full text-left border-collapse",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"text-xs uppercase text-slate-500 border-b border-white/10",children:[c.jsx("th",{className:"p-3",children:"Subject"}),c.jsx("th",{className:"p-3",children:"Last Decision"}),c.jsx("th",{className:"p-3",children:"Reasoning"}),c.jsx("th",{className:"p-3",children:"Score"}),c.jsx("th",{className:"p-3",children:"Fitness"}),c.jsx("th",{className:"p-3",children:"Gold"}),c.jsx("th",{className:"p-3",children:"Stamina"})]})}),c.jsxs("tbody",{className:"text-sm",children:[Object.entries(h).map(([T,E])=>c.jsxs("tr",{className:"border-b border-white/5 hover:bg-white/5 transition-colors font-mono",children:[c.jsx("td",{className:"p-3 font-bold text-indigo-300",children:E.name}),c.jsx("td",{className:"p-3",children:c.jsx("span",{className:"bg-indigo-500/20 text-indigo-300 px-2 py-1 rounded text-xs font-bold border border-indigo-500/30",children:E.action})}),c.jsxs("td",{className:"p-3 text-slate-400 italic text-xs",children:['"',E.reason,'"']}),c.jsx("td",{className:"p-3 text-slate-300",children:E.score}),c.jsx("td",{className:"p-3 font-bold text-white",children:E.fitness}),c.jsx("td",{className:"p-3 text-amber-400",children:E.resources.gold}),c.jsx("td",{className:"p-3",children:c.jsx("div",{className:"w-16 h-1 bg-slate-700 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-emerald-500",style:{width:`${E.stamina}%`}})})})]},T)),Object.keys(h).length===0&&c.jsx("tr",{children:c.jsx("td",{colSpan:7,className:"p-8 text-center text-slate-600 italic",children:"Venter p telemetri..."})})]})]})})]}),v&&c.jsxs("div",{className:"bg-red-950/30 border border-red-500/30 p-6 rounded-2xl",children:[c.jsxs("h3",{className:"text-red-400 font-bold flex items-center gap-2 mb-4",children:[c.jsx(vy,{size:18})," Game Balance Issue Detected"]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[c.jsxs("div",{className:"bg-black/40 p-4 rounded-lg",children:[c.jsx("p",{className:"text-slate-400 text-xs uppercase mb-2",children:"Grunn"}),c.jsx("p",{className:"font-mono",children:v.reason})]}),c.jsxs("div",{className:"bg-black/40 p-4 rounded-lg",children:[c.jsx("p",{className:"text-slate-400 text-xs uppercase mb-2",children:"Siste Handling"}),c.jsx("p",{className:"font-mono",children:((N=v.history[v.history.length-1])==null?void 0:N.action.type)||"None"})]})]}),c.jsx("pre",{className:"mt-4 p-4 bg-black/40 rounded-lg overflow-x-auto text-[10px] text-slate-300 custom-scrollbar",children:JSON.stringify(v,null,2)})]})]})},C6=()=>{var Dt,$n,pn,Hi,Gi,Kn,bc,xc,yc;const[t,e]=_.useState(""),[n,s]=_.useState(null),[i,r]=_.useState([]),[a,o]=_.useState(!1),[l,u]=_.useState("LIST"),[d,f]=_.useState({}),[h,m]=_.useState({}),[v,b]=_.useState({}),{setFullWidth:y,setHideHeader:p}=iN(),[g,x]=_.useState(null);_.useEffect(()=>{Mt(()=>import("./SimulationEconomyBlueprint-BfOI74He.js"),[]).then(S=>{x(()=>S.SimulationEconomyBlueprint)})},[]);const w=async S=>{if(window.confirm(`ER DU SIKKER? Dette vil slette rommet ${S} permanent! Denne handlingen kan ikke angres.`)){o(!0);try{await cy(D(L,`simulation_rooms/${S}`)),await cy(D(L,`simulation_server_metadata/${S}`))}catch(M){console.error(M),alert("Kunne ikke slette rommet.")}finally{o(!1)}}};_.useEffect(()=>(y(!0),p(!0),()=>{y(!1),p(!1)}),[y,p]),_.useEffect(()=>{const S=D(L,"simulation_rooms"),M=Ye(S,G=>{const X=G.val();if(X){const re=Object.entries(X).map(([Z,Y])=>({...Y,pin:Y.pin||Z}));r(re.reverse())}else r([])});return()=>M()},[]),_.useEffect(()=>{if(!t)return;const S=`simulation_rooms/${t}`,M=Ye(D(L,`${S}/status`),Z=>{s(Y=>Y?{...Y,status:Z.val()||"LOBBY"}:null)}),G=Ye(D(L,`${S}/world`),Z=>{s(Y=>Y?{...Y,world:Z.val()}:null)}),X=Ye(D(L,`${S}/markets`),Z=>{const Y=Z.val()||{};s(de=>de?{...de,markets:Y}:null)}),re=Ye(D(L,`${S}/regions`),Z=>{s(Y=>Y?{...Y,regions:Z.val()||{}}:null)});return()=>{M(),G(),X(),re()}},[t]),TS(t,(n==null?void 0:n.status)||"LOBBY",n==null?void 0:n.world),_.useEffect(()=>{if(!t)return;const S=`simulation_rooms/${t}`,M=Ye(D(L,`${S}/messages`),G=>{s(X=>X?{...X,messages:G.val()||[]}:null)});return()=>M()},[t]),_.useEffect(()=>{if(!t)return;const S=`simulation_rooms/${t}`,M=Ye(D(L,`${S}/players`),Z=>{const Y=Z.val()||{};s(de=>{if(!de)return null;const W=Object.keys(Y).length,_e=D(L,`simulation_server_metadata/${t}`);return setTimeout(()=>{ye(_e).then(Ct=>{Ct.exists()&&Ct.val().playerCount!==W&&J(_e,{playerCount:W})})},5e3),{...de,players:Y}})}),G=Ye(D(L,`${S}/worldEvents`),Z=>{s(Y=>Y?{...Y,worldEvents:Z.val()||{}}:null)}),X=Ye(D(L,`${S}/activeVote`),Z=>{s(Y=>Y?{...Y,activeVote:Z.val()}:null)}),re=Ye(D(L,`${S}/regions`),Z=>{s(Y=>Y?{...Y,regions:Z.val()||{}}:null)});return ye(D(L,S)).then(Z=>{if(Z.exists()){const Y=Z.val();s(de=>({...de,pin:Y.pin,status:Y.status,settings:Y.settings,hostName:Y.hostName,isPublic:Y.isPublic??!0,world:Y.world,markets:Y.markets||{},market:Y.market||bt,players:(de==null?void 0:de.players)||{},messages:(de==null?void 0:de.messages)||[],regions:Y.regions||{},diplomacy:{},worldEvents:{}}))}}),()=>{M(),G(),X(),re()}},[t]),_.useEffect(()=>(t&&l==="MANAGE"?document.title=`Host: ${t} | Eiriksbok`:document.title="Simuleringshallen | Eiriksbok",()=>{document.title="Eiriksbok"}),[t,l]);const N=async()=>{const S=prompt("Hva skal riket hete? (La st tomt for automatisk navn)");if(S===null)return;o(!0);const M=Math.floor(1e3+Math.random()*9e3).toString(),G=S.trim()||`Rike #${M}`,X=bP(M,G);try{await Ba(D(L,`simulation_rooms/${M}`),X),await Gc(M,X),e(M),u("MANAGE")}catch(re){console.error(re),alert("Kunne ikke opprette rom.")}finally{o(!1)}},T=async()=>{if(!(!n||!n.players)){o(!0);try{const S=pP(n.players),M={region_vest:{id:"region_vest",name:"Baroniet Vest",taxRate:10,defenseLevel:50,rulerName:"Ingen"},region_ost:{id:"region_ost",name:"Baroniet st",taxRate:10,defenseLevel:50,rulerName:"Ingen"}},G={...n.markets};G.capital||(G.capital=JSON.parse(JSON.stringify(bt))),["region_vest","region_ost"].forEach(Y=>{G[Y]||(G[Y]=JSON.parse(JSON.stringify(bt)))}),Object.values(S).forEach(Y=>{if(Y.role==="BARON"){M[Y.regionId]={...M[Y.regionId],rulerName:Y.name};const de=JSON.parse(JSON.stringify(bt));Object.keys(de).forEach(W=>{const _e=de[W];_e.price=Math.floor(_e.price*(.8+Math.random()*.4)),_e.stock=Math.floor(_e.stock*(.8+Math.random()*.4))}),G[Y.regionId]=de}});const X={};Object.values(S).forEach(Y=>{X[Y.id]={id:Y.id,name:Y.name,role:Y.role,regionId:Y.regionId,stats:{level:Y.stats.level||1},status:{isJailed:!1,isFrozen:!1,legitimacy:100},online:!0,lastActive:Y.lastActive}});const re={};re[`simulation_rooms/${t}/players`]=S,re[`simulation_rooms/${t}/public_profiles`]=X,re[`simulation_rooms/${t}/regions`]=M,re[`simulation_rooms/${t}/markets`]=G,re[`simulation_rooms/${t}/status`]="PLAYING",await J(D(L),re);const Z={...n,status:"PLAYING"};await Gc(t,Z)}catch(S){console.error(S),alert("Klarte ikke starte.")}finally{o(!1)}}},E=async()=>{var S,M;if(!(!n||!n.players)){o(!0);try{const G=((M=(S=n.world)==null?void 0:S.taxRateDetails)==null?void 0:M.kingTax)||20,{updatedPlayers:X,results:re}=gP(n.players,G);await J(D(L,`simulation_rooms/${t}/players`),X),alert(`Suksess! ${re.length} bnder og baroner ble skattlagt.`)}catch(G){console.error(G)}finally{o(!1)}}},A=async()=>{if(n!=null&&n.regions&&window.confirm("Vil du nullstille all politisk uro (bestikkelser) i alle regioner?")){o(!0);try{const S={};Object.keys(n.regions).forEach(M=>{S[`simulation_rooms/${t}/regions/${M}/coup/bribeProgress`]=0,S[`simulation_rooms/${t}/regions/${M}/coup/contributions`]={},S[`simulation_rooms/${t}/regions/${M}/coup/challengerId`]=null,S[`simulation_rooms/${t}/regions/${M}/coup/challengerName`]=null}),await J(D(L),S),alert("Politisk ro er gjenopprettet i alle regioner!")}catch(S){console.error(S)}finally{o(!1)}}},k=async()=>{if(!(!n||!n.players)){o(!0);try{const S={};Object.keys(n.players).forEach(M=>{S[`simulation_rooms/${t}/players/${M}/status/stamina`]=100}),await J(D(L),S),alert("All energi er gjenopprettet!")}catch(S){console.error(S)}finally{o(!1)}}},R=S=>S?Array.isArray(S)?S:Object.values(S).sort((M,G)=>M.timestamp-G.timestamp):[],I=async()=>{var re,Z;if(!n)return;const S=["Spring","Summer","Autumn","Winter"],G=(S.indexOf(((re=n.world)==null?void 0:re.season)||"Spring")+1)%S.length,X=S[G];o(!0);try{const de=` rstiden har skiftet til ${((Z=An[X])==null?void 0:Z.label)||X}!`,W={id:`msg_${Date.now()}`,content:de,timestamp:Date.now(),type:"SEASON_CHANGE"},Ct=[...R(n.messages),W].slice(-50),_c={};_c[`simulation_rooms/${t}/world/season`]=X,_c[`simulation_rooms/${t}/messages`]=Ct,await J(D(L),_c)}catch(Y){console.error(Y)}finally{o(!1)}},P=async()=>{if(!n)return;const S=["Clear","Rain","Storm","Fog"],G=(S.indexOf(n.world.weather||"Clear")+1)%S.length,X=S[G];try{const Y=` Vret har skiftet til ${{Clear:"Klart",Rain:"Regn",Storm:"Storm",Fog:"Tke"}[X]||X}!`,de={id:`msg_${Date.now()}`,content:Y,timestamp:Date.now(),type:"WEATHER_CHANGE"},_e=[...R(n.messages),de].slice(-50),Ct={};Ct[`simulation_rooms/${t}/world/weather`]=X,Ct[`simulation_rooms/${t}/messages`]=_e,await J(D(L),Ct)}catch(re){console.error(re)}},V=async()=>{if(!n)return;const{LAW_TEMPLATES:S}=await Mt(async()=>{const{LAW_TEMPLATES:X}=await Promise.resolve().then(()=>dy);return{LAW_TEMPLATES:X}},void 0),M=S[Math.floor(Math.random()*S.length)],G={lawId:M.id,title:M.label,votes:{},expiresAt:Date.now()+60*1e3};try{await J(D(L,`simulation_rooms/${t}`),{activeVote:G});const X=` TINGET ER SATT! Det skal stemmes over loven: "${M.label}"!`,re={id:`msg_${Date.now()}`,content:X,timestamp:Date.now(),type:"VOTE_START"},Y=[...R(n.messages),re].slice(-50);await J(D(L,`simulation_rooms/${t}`),{messages:Y}),setTimeout(()=>$(M.id),6e4)}catch(X){console.error(X)}},$=async S=>{var _e;const M=await ye(D(L,`simulation_rooms/${t}/activeVote`));if(!M.exists())return;const G=M.val(),X=Object.values(G.votes||{}),re=X.filter(Ct=>Ct==="YES").length,Z=X.filter(Ct=>Ct==="NO").length;let Y="",de=((_e=n==null?void 0:n.world)==null?void 0:_e.activeLaws)||[];re>Z?(Y=` LOVEN ER VEDTATT! "${G.title}" er n gjeldende.`,de=[...de,S]):Y=` LOVEN BLE FORKASTET. "${G.title}" ble nedstemt.`;const W={id:`msg_${Date.now()}`,content:Y,timestamp:Date.now(),type:"VOTE_RESULT"};try{await J(D(L,`simulation_rooms/${t}/world`),{activeLaws:de});const Ct=R(n==null?void 0:n.messages);await J(D(L,`simulation_rooms/${t}`),{activeVote:null,messages:[...Ct,W].slice(-50)})}catch(Ct){console.error(Ct)}},K=async()=>{if(!n)return;const{WORLD_EVENT_TEMPLATES:S}=await Mt(async()=>{const{WORLD_EVENT_TEMPLATES:re}=await Promise.resolve().then(()=>dy);return{WORLD_EVENT_TEMPLATES:re}},void 0),M=S[Math.floor(Math.random()*S.length)],G=`event_${Date.now()}`,X={...M,id:G,expiresAt:Date.now()+5*60*1e3};try{await J(D(L,`simulation_rooms/${t}/worldEvents`),{[G]:X});const re=` HENDELSE: ${M.title}! Sjekk kartet!`,Z={id:`msg_${Date.now()}`,content:re,timestamp:Date.now(),type:"EVENT_SPAWN"},de=[...R(n.messages),Z].slice(-50);await J(D(L,`simulation_rooms/${t}`),{messages:de})}catch(re){console.error(re)}},B=async(S,M)=>{var re,Z,Y;if(!((Y=(Z=(re=n==null?void 0:n.world)==null?void 0:re.settlement)==null?void 0:Z.buildings)!=null&&Y[S]))return;const G=n.world.settlement.buildings[S],X=Math.max(0,G.level+M);try{await J(D(L,`simulation_rooms/${t}/world/settlement/buildings/${S}`),{level:X,progress:{}})}catch(de){console.error(de)}},[j,O]=_.useState({name:"",role:"PEASANT",level:1}),C=async()=>{if(!j.name){alert("Vennligst oppgi et navn.");return}o(!0);try{const S=`char_${Math.random().toString(36).substr(2,9)}`,M={id:S,name:j.name,role:j.role||"PEASANT",regionId:j.role==="KING"?"capital":Math.random()>.5?"region_ost":"region_vest",resources:At[j.role]||At.PEASANT,status:{hp:100,stamina:100,morale:100,legitimacy:100,authority:50,loyalty:100,isJailed:!1,isFrozen:!1},stats:{level:j.level,xp:0,reputation:10,contribution:0},skills:Cn[j.role]||Cn.PEASANT,lastActive:Date.now(),online:!0},G={};G[`simulation_rooms/${t}/players/${S}`]=M,G[`simulation_rooms/${t}/public_profiles/${S}`]={id:S,name:M.name,role:M.role,regionId:M.regionId,stats:{level:M.stats.level},status:{isJailed:!1,isFrozen:!1,legitimacy:100},online:!0,lastActive:M.lastActive},await J(D(L),G),O({name:"",role:"PEASANT",level:1})}catch(S){console.error(S),alert("Kunne ikke opprette karakter.")}finally{o(!1)}},F=async(S,M)=>{try{const G={};G[`simulation_rooms/${t}/players/${S}/stats/level`]=M,G[`simulation_rooms/${t}/public_profiles/${S}/stats/level`]=M,await J(D(L),G)}catch(G){console.error(G)}},Q=async()=>{if(n){o(!0);try{await J(D(L,`simulation_rooms/${t}/world`),{settlement:{buildings:Object.entries(Ut).reduce((S,[M])=>({...S,[M]:{id:M,level:0,progress:{},target:200,contributions:{}}}),{})}})}catch(S){console.error(S)}finally{o(!1)}}},oe=async()=>{if(console.log("Attempting resetGame..."),!window.confirm("Er du sikker p at du vil starte spillet p nytt? Alle fremdrift slettes.")){console.log("Reset cancelled by user.");return}console.log("Reset confirmed. Pin:",t),o(!0);try{const S={};S[`simulation_rooms/${t}/status`]="LOBBY",S[`simulation_rooms/${t}/worldEvents`]={},S[`simulation_rooms/${t}/messages`]=[],S[`simulation_rooms/${t}/market`]=bt,S[`simulation_rooms/${t}/markets`]={capital:bt},S[`simulation_rooms/${t}/regions`]={},S[`simulation_rooms/${t}/world/monumentProgress`]=0,S[`simulation_rooms/${t}/world/activeLaws`]=[],S[`simulation_rooms/${t}/world/settlement`]={buildings:Object.entries(Ut).reduce((M,[G])=>({...M,[G]:{id:G,level:0,progress:{},target:200,contributions:{}}}),{})},Object.keys((n==null?void 0:n.players)||{}).forEach(M=>{S[`simulation_rooms/${t}/players/${M}/role`]="PEASANT",S[`simulation_rooms/${t}/players/${M}/regionId`]="capital",S[`simulation_rooms/${t}/players/${M}/resources`]=At.PEASANT,S[`simulation_rooms/${t}/players/${M}/status`]={stamina:100,legitimacy:100,authority:50},S[`simulation_rooms/${t}/players/${M}/equipment`]={};const G=`simulation_rooms/${t}/public_profiles/${M}`;S[`${G}/role`]="PEASANT",S[`${G}/regionId`]="capital",S[`${G}/stats/level`]=1,S[`simulation_rooms/${t}/players/${M}/roleStats`]=null}),console.log("Constructed updates:",S),await J(D(L),S),n&&s({...n,status:"LOBBY",messages:[]}),console.log("Update successful!"),alert("Spillet er nullstilt!")}catch(S){console.error("Reset failed:",S),alert("Kunne ikke nullstille spill: "+S)}finally{o(!1)}},be=async(S,M)=>{if(window.confirm(`Er du sikker p at du vil kaste ut ${M}?`))try{const G={};G[`simulation_rooms/${t}/players/${S}`]=null,G[`simulation_rooms/${t}/public_profiles/${S}`]=null,await J(D(L),G)}catch(G){console.error(G),alert("Kunne ikke kaste ut spiller.")}},H=async()=>{if(window.confirm("ER DU SIKKER? Dette vil kaste ut ALLE spillere fra rommet!"))try{const S={};S[`simulation_rooms/${t}/players`]={},await J(D(L),S),alert("Alle spillere er kastet ut.")}catch(S){console.error(S),alert("Kunne ikke utfre handlingen.")}},me=S=>{const M=`${window.location.origin}/Simulation_StandAlone_Pro/play/${t}?impersonate=${S}`;window.open(M,"_blank")},se=async(S,M)=>{try{const G={};G[`simulation_rooms/${t}/players/${S}/role`]=M,G[`simulation_rooms/${t}/public_profiles/${S}/role`]=M,await J(D(L),G)}catch(G){console.error(G),alert("Kunne ikke endre rolle.")}},tt=async(S,M)=>{try{const G={};G[`simulation_rooms/${t}/players/${S}/regionId`]=M,G[`simulation_rooms/${t}/public_profiles/${S}/regionId`]=M,await J(D(L),G)}catch(G){console.error(G),alert("Kunne ikke endre baroni.")}},Ft=async()=>{if(!n)return;const S=!n.isPublic;try{await J(D(L,`simulation_rooms/${t}`),{isPublic:S}),await Gc(t,{...n,isPublic:S})}catch(M){console.error(M)}};if(l==="LIST")return c.jsxs("div",{className:"fixed inset-0 top-0 bg-slate-950 text-slate-200 p-12 overflow-y-auto custom-scrollbar font-sans z-20",children:[c.jsxs("div",{className:"fixed inset-0 pointer-events-none opacity-20",children:[c.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-indigo-600/20 blur-[120px] rounded-full"}),c.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-amber-600/10 blur-[120px] rounded-full"})]}),c.jsxs("div",{className:"max-w-5xl mx-auto relative z-10",children:[c.jsxs("div",{className:"flex justify-between items-center mb-12",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-5xl font-black text-white px-2 tracking-tighter",children:"Simuleringshallen"}),c.jsx("p",{className:"text-slate-500 font-bold uppercase tracking-widest text-[10px] mt-2 px-2",children:"Sentralt kontrollpanel for administratoren"})]}),c.jsxs("div",{className:"flex gap-4",children:[c.jsx("button",{onClick:async()=>{o(!0);try{const S=D(L,"simulation_server_metadata"),M=D(L,"simulation_rooms"),[G,X]=await Promise.all([ye(S),ye(M)]),re=G.val()||{},Z=X.val()||{};let Y=0;const de={};Object.keys(re).forEach(W=>{Z[W]||(de[`simulation_server_metadata/${W}`]=null,Y++)}),Y>0?(await J(D(L),de),alert(`Ryddet opp ${Y} dde serverkoblinger!`)):alert("Alt ser ryddig ut! Ingen dde linker funnet.")}catch(S){console.error(S),alert("Kunne ikke rydde opp "+S)}finally{o(!1)}},disabled:a,className:"bg-slate-800 hover:bg-rose-500/20 text-slate-400 hover:text-rose-400 border border-slate-700 hover:border-rose-500/50 px-6 py-5 rounded-2xl font-black text-xs uppercase tracking-widest transition-all",children:" Vask Serverlisten"}),c.jsx("button",{onClick:N,disabled:a,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-10 py-5 rounded-2xl font-black text-lg shadow-2xl shadow-indigo-600/30 transition-all hover:scale-105 active:scale-95",children:"+ Opprett Nytt Rike"})]})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map(S=>{var M,G;return c.jsxs("div",{className:"bg-slate-900/50 backdrop-blur-xl border border-white/5 p-8 rounded-[2.5rem] group hover:border-indigo-500/50 transition-all shadow-xl flex flex-col justify-between",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between items-start mb-2",children:[c.jsx("h2",{className:"text-2xl font-black text-white group-hover:text-indigo-400 transition-colors truncate pr-4",title:S.name||`Rike #${S.pin}`,children:S.name||`Rike #${S.pin}`}),c.jsx("span",{className:`px-2 py-0.5 rounded-full text-[8px] font-black uppercase tracking-widest ${S.status==="PLAYING"?"bg-emerald-500/20 text-emerald-400":"bg-amber-500/20 text-amber-400"} shrink-0`,children:typeof S.status=="string"?S.status:"KORRUPT"})]}),c.jsxs("div",{className:"text-[10px] font-mono text-slate-600 mb-6 uppercase tracking-widest",children:["PIN: ",c.jsx("span",{className:"text-slate-400 font-bold",children:S.pin})]}),c.jsxs("div",{className:"space-y-4 mb-8",children:[c.jsxs("div",{className:"flex items-center justify-between text-sm font-bold text-slate-500",children:[c.jsx("span",{children:"Innbyggere:"}),c.jsxs("span",{className:"text-white",children:[Object.keys(S.players||{}).length," sjeler"]})]}),c.jsxs("div",{className:"flex items-center justify-between text-sm font-bold text-slate-500",children:[c.jsx("span",{children:"rstid:"}),c.jsx("span",{className:"text-indigo-300",children:bt[(M=S.world)==null?void 0:M.season]||((G=S.world)==null?void 0:G.season)||"Ukjent"})]})]})]}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:()=>{e(S.pin),u("MANAGE")},className:"flex-1 bg-white/5 hover:bg-white/10 text-white py-4 rounded-2xl font-black uppercase tracking-widest text-xs transition-all border border-white/5",children:"Administrer "}),c.jsx("button",{onClick:()=>w(S.pin),className:"bg-rose-500/10 hover:bg-rose-500/20 text-rose-500 w-16 rounded-2xl flex items-center justify-center border border-rose-500/20 transition-all hover:scale-105 active:scale-95",title:"Slett rom",children:""})]})]},S.pin)})})]})]});if(!n)return null;const jn=async()=>{if(window.confirm("Er du sikker? Dette vil regenerere 'public_profiles' basert p 'players'. Bruk kun hvis listen er tom.")){o(!0);try{const S=await ye(D(L,`simulation_rooms/${t}`));if(!S.exists())return;const M=S.val(),G=M.players||{},X={};Object.entries(G).forEach(([re,Z])=>{var Y,de,W,_e;X[`simulation_rooms/${t}/public_profiles/${re}`]={id:re,uid:Z.uid||null,name:Z.name,role:Z.role,regionId:Z.regionId,stats:{level:((Y=Z.stats)==null?void 0:Y.level)||1},status:{isJailed:((de=Z.status)==null?void 0:de.isJailed)||!1,isFrozen:((W=Z.status)==null?void 0:W.isFrozen)||!1,legitimacy:((_e=Z.status)==null?void 0:_e.legitimacy)||100},online:!0,lastActive:Z.lastActive||Date.now()}}),M.status||(X[`simulation_rooms/${t}/status`]="LOBBY"),M.world||(X[`simulation_rooms/${t}/world`]={year:1100,season:"Spring",weather:"Clear",gameTick:0,lastTickAt:Date.now(),taxRateDetails:{kingTax:20},settlement:{buildings:Object.entries(Ut).reduce((re,[Z])=>({...re,[Z]:{id:Z,level:0,progress:{},target:200,contributions:{}}}),{})}}),await J(D(L),X),alert("Data reparert! Profiler er synkronisert."),await Gc(t,{...M,players:G})}catch(S){console.error(S),alert("Reparasjon feilet: "+S)}finally{o(!1)}}};return c.jsxs("div",{className:"fixed inset-0 top-0 bg-slate-950 text-slate-200 flex overflow-hidden font-sans selection:bg-indigo-500/30 z-20",children:[c.jsxs("div",{className:"fixed inset-0 pointer-events-none opacity-20",children:[c.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-indigo-600/20 blur-[120px] rounded-full animate-pulse"}),c.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-amber-600/10 blur-[120px] rounded-full"})]}),c.jsxs("aside",{className:"w-80 border-r border-white/10 bg-slate-900/50 backdrop-blur-xl flex flex-col z-20 shadow-2xl overflow-y-auto no-scrollbar",children:[c.jsxs("div",{className:"p-8 border-b border-white/5 bg-black/20",children:[c.jsx("button",{onClick:()=>u("LIST"),className:"text-indigo-400 font-black text-[10px] uppercase tracking-widest mb-4 hover:text-white transition-colors flex items-center gap-2",children:" Tilbake til oversikt"}),c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("h1",{className:"text-4xl font-mono font-black text-white",children:t}),c.jsx("span",{className:"text-[10px] font-black uppercase text-indigo-500 tracking-widest bg-indigo-500/10 px-3 py-1 rounded-full",children:"Admin"})]}),c.jsxs("p",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-6",children:[typeof n.status=="string"?n.status:"FEIL: DATA KORRUPT"," MODUS"]}),c.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[c.jsx("button",{onClick:T,disabled:n.status==="PLAYING"||a,className:`w-full py-4 rounded-xl font-black uppercase tracking-widest text-sm transition-all shadow-lg ${n.status==="PLAYING"?"bg-emerald-600/20 text-emerald-500 cursor-default":"bg-emerald-600 hover:bg-emerald-500 text-white shadow-emerald-600/20"}`,children:n.status==="PLAYING"?" SPILL AKTIVT":" START SPILL"}),c.jsxs("button",{onClick:Ft,disabled:a,className:`w-full py-3 rounded-xl font-black uppercase tracking-widest text-[10px] transition-all border flex items-center justify-center gap-2 ${n.isPublic?"bg-indigo-600/10 text-indigo-400 border-indigo-500/20 hover:bg-indigo-600 hover:text-white":"bg-slate-800 text-slate-500 border-white/5 hover:border-indigo-500/20"}`,children:[n.isPublic?c.jsx(_3,{size:14}):c.jsx(C0,{size:14}),n.isPublic?"OFFENTLIG SERVER":"PRIVAT (KUN PIN)"]}),c.jsx("button",{onClick:jn,disabled:a,className:"w-full py-3 rounded-xl font-black uppercase tracking-widest text-[10px] bg-amber-600/10 text-amber-500 hover:bg-amber-600 hover:text-white transition-all border border-amber-500/20",children:" REPARER DATA"}),c.jsx("button",{onClick:oe,disabled:a,className:"w-full py-3 rounded-xl font-black uppercase tracking-widest text-[10px] bg-rose-600/10 text-rose-500 hover:bg-rose-600 hover:text-white transition-all border border-rose-500/20",children:" NULLSTILL ALT"})]})]}),c.jsxs("div",{className:"p-8 space-y-8 flex-1 overflow-y-auto custom-scrollbar",children:[c.jsxs("section",{children:[c.jsx("h3",{className:"text-[10px] font-black uppercase text-slate-500 tracking-[0.2em] mb-4",children:"Verdensstyring"}),c.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[c.jsxs("div",{className:"bg-white/5 p-4 rounded-2xl border border-white/5 group",children:[c.jsxs("div",{className:"flex justify-between items-center mb-3",children:[c.jsxs("span",{className:"text-xs font-bold text-slate-400 italic",children:["rstid: ",(($n=An[(Dt=n.world)==null?void 0:Dt.season])==null?void 0:$n.label)||"Ukjent"]}),c.jsx("span",{className:"text-2xl group-hover:rotate-12 transition-transform",children:{Spring:"",Summer:"",Autumn:"",Winter:""}[((pn=n.world)==null?void 0:pn.season)||"Spring"]})]}),c.jsx("button",{onClick:I,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white py-2 rounded-lg font-black uppercase text-[10px] transition-all",children:"Neste rstid"})]}),c.jsxs("div",{className:"bg-white/5 p-4 rounded-2xl border border-white/5 group",children:[c.jsxs("div",{className:"flex justify-between items-center mb-3",children:[c.jsxs("span",{className:"text-xs font-bold text-slate-400 italic",children:["Vr: ",((Hi=n.world)==null?void 0:Hi.weather)||"Klart"]}),c.jsx("span",{className:"text-2xl group-hover:scale-110 transition-transform",children:""})]}),c.jsx("button",{onClick:P,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white py-2 rounded-lg font-black uppercase text-[10px] transition-all",children:"Endre Vr"})]})]})]}),c.jsxs("section",{children:[c.jsx("h3",{className:"text-[10px] font-black uppercase text-slate-500 tracking-[0.2em] mb-4",children:"Massehandlinger"}),c.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[c.jsx("button",{onClick:E,className:"w-full bg-amber-600/10 hover:bg-amber-600 text-amber-500 hover:text-white border border-amber-600/20 py-4 rounded-2xl font-black uppercase text-[10px] transition-all flex items-center justify-center gap-2",children:" Skattlegg Riket"}),c.jsx("button",{onClick:k,className:"w-full bg-blue-600/10 hover:bg-blue-600 text-blue-500 hover:text-white border border-blue-600/20 py-4 rounded-2xl font-black uppercase text-[10px] transition-all flex items-center justify-center gap-2 text-center",children:" Gjenopprett Stamina"}),c.jsx("button",{onClick:A,className:"w-full bg-indigo-600/10 hover:bg-indigo-600 text-indigo-500 hover:text-white border border-indigo-600/20 py-4 rounded-2xl font-black uppercase text-[10px] transition-all flex items-center justify-center gap-2 text-center",children:" Nullstill Politisk Uro"}),c.jsx("button",{onClick:H,className:"w-full bg-rose-600/10 hover:bg-rose-600 text-rose-500 hover:text-white border border-rose-600/20 py-4 rounded-2xl font-black uppercase text-[10px] transition-all flex items-center justify-center gap-2 text-center mt-2",children:" Kast ut alle"})]})]}),c.jsxs("section",{children:[c.jsx("h3",{className:"text-[10px] font-black uppercase text-slate-500 tracking-[0.2em] mb-4 text-center",children:"Intervensjoner"}),c.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsx("button",{onClick:K,className:"bg-rose-600/80 hover:bg-rose-600 text-white py-4 rounded-2xl font-black uppercase text-[10px] shadow-lg shadow-rose-600/20 transition-all active:scale-95",children:" Event"}),c.jsx("button",{onClick:V,disabled:!!n.activeVote,className:"bg-amber-600/80 hover:bg-amber-600 text-white py-4 rounded-2xl font-black uppercase text-[10px] shadow-lg shadow-amber-600/20 disabled:opacity-20 text-center transition-all active:scale-95",children:" Tinget"})]}),c.jsxs("section",{className:"bg-white/5 border border-white/5 rounded-[2.5rem] p-6 space-y-4 shadow-inner",children:[c.jsx("h3",{className:"text-[10px] font-black uppercase text-indigo-400 tracking-[0.2em] mb-2 px-2",children:"Legg til Karakter"}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("input",{type:"text",placeholder:"Navn...",value:j.name,onChange:S=>O({...j,name:S.target.value}),className:"w-full bg-black/40 border border-white/5 rounded-xl px-4 py-3 text-xs font-bold text-white placeholder:text-slate-600 focus:border-indigo-500/50 focus:ring-0 transition-all"}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsx("select",{value:j.role,onChange:S=>O({...j,role:S.target.value}),className:"bg-black/40 border border-white/5 rounded-xl px-3 py-2 text-[10px] font-black uppercase text-slate-400 focus:ring-0",children:Object.keys(Ol).map(S=>c.jsx("option",{value:S,children:S},S))}),c.jsxs("div",{className:"flex items-center gap-2 bg-black/40 border border-white/5 rounded-xl px-3 py-2",children:[c.jsx("span",{className:"text-[8px] font-black text-slate-600",children:"LVL"}),c.jsx("input",{type:"number",value:j.level,onChange:S=>O({...j,level:parseInt(S.target.value)}),className:"w-full bg-transparent border-none p-0 text-xs font-black text-white focus:ring-0 font-mono"})]})]}),c.jsx("button",{onClick:C,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-xl font-black uppercase text-[10px] shadow-lg shadow-indigo-600/20 transition-all active:scale-95",children:" SKAP KARAKTER"})]})]})]})]}),c.jsxs("section",{children:[c.jsx("h3",{className:"text-[10px] font-black uppercase text-slate-500 tracking-[0.2em] mb-4",children:"Landsby-fokus"}),(Gi=n.world)!=null&&Gi.settlement?c.jsx("div",{className:"text-xs text-slate-500 italic",children:"Landsbyen er initialisert."}):c.jsx("button",{onClick:Q,className:"w-full bg-amber-500 text-black py-4 rounded-2xl font-black uppercase text-[10px] animate-pulse",children:"Initialiser Landsby"})]})]})]}),c.jsxs("main",{className:"flex-1 relative flex flex-col bg-slate-900/10 overflow-hidden no-scrollbar",children:[c.jsxs("header",{className:"h-16 border-b border-white/5 bg-slate-950/30 backdrop-blur-md flex items-center justify-between px-8 shrink-0 z-10",children:[c.jsxs("div",{className:"flex items-center gap-8",children:[c.jsxs("nav",{className:"flex items-center bg-white/5 p-1 rounded-xl border border-white/10",children:[c.jsx("button",{onClick:()=>u("MANAGE"),className:`px-4 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${l==="MANAGE"?"bg-indigo-600 text-white shadow-lg":"text-slate-500 hover:text-white"}`,children:"Overvking"}),c.jsx("button",{onClick:()=>u("ECONOMY"),className:`px-4 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${l==="ECONOMY"?"bg-indigo-600 text-white shadow-lg":"text-slate-500 hover:text-white"}`,children:"Blueprint"}),c.jsx("button",{onClick:()=>u("AI_LAB"),className:`px-4 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${l==="AI_LAB"?"bg-indigo-600 text-white shadow-lg":"text-slate-500 hover:text-white"}`,children:"AI Training Lab"})]}),c.jsx("div",{className:"h-4 w-[1px] bg-white/10 mx-2"}),c.jsxs("div",{className:"flex items-center gap-8",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Innbyggere:"}),c.jsx("span",{className:"text-sm font-bold text-white",children:Object.keys(n.players||{}).length})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"r i Riket:"}),c.jsx("span",{className:"text-sm font-bold text-white",children:((Kn=n.world)==null?void 0:Kn.year)||1100})]})]})]}),a&&c.jsx("div",{className:"text-[10px] font-black uppercase tracking-widest text-indigo-400 animate-pulse",children:"Prosesserer Endringer..."})]}),c.jsx("div",{className:"flex-1 p-8 overflow-y-auto custom-scrollbar no-scrollbar",children:l==="ECONOMY"?g?c.jsx(g,{}):c.jsx("div",{className:"p-20 text-center animate-pulse text-slate-500 font-black uppercase tracking-widest",children:"Laster Blueprint..."}):l==="AI_LAB"?c.jsx(I6,{roomData:n,pin:t}):c.jsxs("div",{className:"space-y-12 pb-20",children:[c.jsxs("section",{children:[c.jsx("h2",{className:"text-3xl font-black text-white px-2 mb-8 tracking-tighter",children:"Innbyggere i Riket"}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[Object.values(n.players||{}).map(S=>{var M,G,X,re,Z,Y,de;return c.jsxs("div",{className:"relative bg-slate-900/80 border border-white/5 p-6 rounded-[2rem] hover:border-indigo-500/30 transition-all group",children:[c.jsx("button",{onClick:W=>{W.stopPropagation(),be(S.id,S.name)},className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-rose-500/10 text-rose-500 opacity-0 group-hover:opacity-100 transition-all hover:bg-rose-500 hover:text-white flex items-center justify-center font-bold text-xs",title:"Kast ut spiller",children:""}),c.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[c.jsx("div",{className:"w-12 h-12 bg-indigo-600/20 rounded-xl flex items-center justify-center text-2xl shrink-0 group-hover:scale-110 transition-transform overflow-hidden",children:S.avatar?c.jsx("img",{src:S.avatar,alt:S.role,className:"w-full h-full object-cover"}):{KING:"",BARON:"",PEASANT:"",SOLDIER:"",MERCHANT:""}[S.role]||""}),c.jsxs("div",{className:"min-w-0 flex-1",children:[c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsx("h3",{className:"text-lg font-black text-white truncate leading-tight",children:S.name}),c.jsxs("div",{className:"flex items-center gap-1 bg-white/5 px-2 py-0.5 rounded-lg border border-white/5",children:[c.jsx("span",{className:"text-[8px] font-black text-slate-500 uppercase",children:"LVL"}),c.jsx("input",{type:"number",value:((M=S.stats)==null?void 0:M.level)||1,onChange:W=>F(S.id,parseInt(W.target.value)),className:"w-8 bg-transparent border-none p-0 text-[10px] font-black text-indigo-400 focus:ring-0 text-center font-mono"})]})]}),c.jsxs("div",{className:"flex flex-col gap-1 mt-1",children:[c.jsx("select",{value:S.role,onChange:W=>se(S.id,W.target.value),className:"bg-indigo-500/10 text-indigo-400 text-[10px] font-black uppercase tracking-widest border-none p-0 focus:ring-0 cursor-pointer hover:text-white transition-colors w-full text-left",children:Object.entries(Ol).map(([W,_e])=>c.jsx("option",{value:W,className:"bg-slate-900",children:_e.label},W))}),c.jsxs("select",{value:S.regionId||"region_ost",onChange:W=>tt(S.id,W.target.value),className:"bg-white/5 text-slate-500 text-[9px] font-bold uppercase tracking-wider border-none p-0 focus:ring-0 cursor-pointer hover:text-slate-300 transition-colors w-full text-left",children:[c.jsx("option",{value:"capital",className:"bg-slate-900",children:"Hovedstaden"}),c.jsx("option",{value:"region_ost",className:"bg-slate-900",children:"Baroniet st"}),c.jsx("option",{value:"region_vest",className:"bg-slate-900",children:"Baroniet Vest"})]})]})]})]}),S.id.startsWith("bot_")&&((G=S.status)==null?void 0:G.thought)&&c.jsxs("div",{className:"mb-4 p-3 bg-indigo-500/10 rounded-xl border border-indigo-500/20",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[c.jsx("span",{className:"text-[8px] font-black text-indigo-400 uppercase tracking-widest",children:"Mental Tilstand"}),c.jsx("div",{className:"flex-1 h-[1px] bg-indigo-500/20"})]}),c.jsxs("p",{className:"text-[10px] text-white/90 font-bold leading-relaxed mb-2",children:['"',S.status.thought,'"']}),c.jsxs("div",{className:"flex justify-between items-center text-[8px] font-black uppercase tracking-tighter text-indigo-400/60",children:[c.jsxs("span",{children:["Handling: ",S.status.lastAction]}),c.jsxs("span",{children:["Tid: ",S.status.lastTick?new Date(S.status.lastTick).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"N"]})]})]}),c.jsxs("div",{className:"space-y-3 mb-6",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between text-[8px] font-black uppercase text-slate-500 mb-1",children:[c.jsx("span",{children:"Stamina"}),c.jsxs("span",{className:"text-white",children:[S.status.stamina,"%"]})]}),c.jsx("div",{className:"h-1 bg-slate-800 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-emerald-500",style:{width:`${S.status.stamina}%`}})})]}),c.jsxs("div",{className:"flex justify-between items-center text-xs font-bold",children:[c.jsx("span",{className:"text-slate-500",children:"Gull:"}),c.jsxs("span",{className:"text-amber-500 font-black",children:[S.resources.gold,""]})]})]}),c.jsxs("div",{className:"flex flex-wrap gap-1 mb-6",children:[(X=S.upgrades)==null?void 0:X.map(W=>c.jsx("span",{className:"text-[7px] font-black bg-indigo-500/10 text-indigo-400 px-1.5 py-0.5 rounded border border-indigo-500/20 uppercase tracking-tighter",children:W},W)),(!S.upgrades||S.upgrades.length===0)&&c.jsx("span",{className:"text-[7px] font-bold text-slate-700 uppercase italic",children:"Ingen oppgraderinger"})]}),c.jsxs("button",{onClick:()=>me(S.id),className:"w-full py-4 rounded-2xl bg-indigo-600/10 hover:bg-indigo-600 text-indigo-400 hover:text-white font-black uppercase text-[10px] tracking-widest transition-all border border-indigo-500/20 flex items-center justify-center gap-2 group/btn",children:[c.jsx("span",{className:"group-hover/btn:scale-125 transition-transform",children:""}),"Styr spiller"]}),c.jsxs("div",{className:"mt-4 pt-4 border-t border-white/5 flex flex-col gap-2",children:[c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{type:"number",placeholder:"Gull...",value:d[S.id]||"",onChange:W=>f({...d,[S.id]:parseInt(W.target.value)||0}),className:"flex-1 bg-black/40 border border-white/5 rounded-xl px-3 py-2 text-[10px] font-black text-white focus:border-indigo-500/50 transition-all font-mono"}),c.jsx("button",{onClick:()=>{const W=d[S.id]||0;W>0&&(IP(t,S.id,W),f({...d,[S.id]:0}))},className:"bg-emerald-600/20 hover:bg-emerald-600 text-emerald-400 hover:text-white border border-emerald-500/30 px-3 py-2 rounded-xl text-[8px] font-black uppercase transition-all",children:"GI GULL"})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("select",{value:((re=v[S.id])==null?void 0:re.resourceId)||"",onChange:W=>{var _e;return b({...v,[S.id]:{resourceId:W.target.value,amount:((_e=v[S.id])==null?void 0:_e.amount)||10}})},className:"flex-[2] bg-black/40 border border-white/5 rounded-xl px-2 py-2 text-[10px] font-bold text-amber-300 focus:border-amber-500/50 transition-all cursor-pointer",children:[c.jsx("option",{value:"",children:"Velg Ressurs..."}),Object.entries(hn).map(([W,_e])=>c.jsxs("option",{value:W,children:[_e.icon," ",_e.label]},W))]}),c.jsx("input",{type:"number",placeholder:"#",value:((Z=v[S.id])==null?void 0:Z.amount)||10,onChange:W=>{var _e;return b({...v,[S.id]:{resourceId:((_e=v[S.id])==null?void 0:_e.resourceId)||"",amount:parseInt(W.target.value)||1}})},className:"w-12 bg-black/40 border border-white/5 rounded-xl px-2 py-2 text-[10px] font-black text-white focus:border-amber-500/50 transition-all font-mono text-center"}),c.jsx("button",{onClick:()=>{const W=v[S.id];W&&W.resourceId&&W.amount>0&&(jP(t,S.id,W.resourceId,W.amount),b({...v,[S.id]:{resourceId:"",amount:10}}))},className:"bg-amber-600/20 hover:bg-amber-600 text-amber-400 hover:text-white border border-amber-500/30 px-3 py-2 rounded-xl text-[8px] font-black uppercase transition-all",children:"GI RESSURS"})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("select",{value:((Y=h[S.id])==null?void 0:Y.itemId)||"",onChange:W=>{var _e;return m({...h,[S.id]:{itemId:W.target.value,amount:((_e=h[S.id])==null?void 0:_e.amount)||1}})},className:"flex-[2] bg-black/40 border border-white/5 rounded-xl px-2 py-2 text-[10px] font-bold text-slate-300 focus:border-indigo-500/50 transition-all cursor-pointer",children:[c.jsx("option",{value:"",children:"Velg Gjenstand..."}),Object.values(Se).map(W=>c.jsxs("option",{value:W.id,children:[W.icon," ",W.name]},W.id))]}),c.jsx("input",{type:"number",placeholder:"#",value:((de=h[S.id])==null?void 0:de.amount)||1,onChange:W=>{var _e;return m({...h,[S.id]:{itemId:((_e=h[S.id])==null?void 0:_e.itemId)||"",amount:parseInt(W.target.value)||1}})},className:"w-12 bg-black/40 border border-white/5 rounded-xl px-2 py-2 text-[10px] font-black text-white focus:border-indigo-500/50 transition-all font-mono text-center"}),c.jsx("button",{onClick:()=>{const W=h[S.id];W&&W.itemId&&W.amount>0&&(CP(t,S.id,W.itemId,W.amount),m({...h,[S.id]:{itemId:"",amount:1}}))},className:"bg-indigo-600/20 hover:bg-indigo-600 text-indigo-400 hover:text-white border border-indigo-500/30 px-3 py-2 rounded-xl text-[8px] font-black uppercase transition-all",children:"GI ITEM"})]})]})]},S.id)}),Object.keys(n.players||{}).length===0&&c.jsxs("div",{className:"col-span-full py-20 text-center border-2 border-dashed border-white/5 rounded-[3rem]",children:[c.jsx("span",{className:"text-6xl block mb-4 opacity-20",children:""}),c.jsx("p",{className:"text-slate-500 font-bold uppercase tracking-widest text-xs",children:"Venter p at understter skal ankomme..."})]})]})]}),((bc=n.world)==null?void 0:bc.settlement)&&c.jsxs("section",{className:"bg-indigo-900/10 border border-indigo-500/10 p-10 rounded-[3rem] relative overflow-hidden group",children:[c.jsxs("div",{className:"relative z-10",children:[c.jsxs("h2",{className:"text-3xl font-black text-white mb-8 tracking-tighter flex items-center justify-between",children:["Landsbyutvikling",c.jsx("span",{className:"text-xs font-black uppercase tracking-widest text-indigo-400 bg-indigo-500/10 px-4 py-2 rounded-full",children:"Status Rapport"})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:Object.values(((yc=(xc=n.world)==null?void 0:xc.settlement)==null?void 0:yc.buildings)||{}).map(S=>{const M=Ut[S.id],G=S.progress/(S.target||200)*100;return c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex justify-between items-end",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"text-sm font-black text-white uppercase",children:M==null?void 0:M.name}),c.jsxs("p",{className:"text-[10px] text-slate-500 font-bold tracking-tight",children:["Niv ",S.level]})]}),c.jsxs("span",{className:"text-xs font-mono text-indigo-500",children:[Object.values(S.progress||{}).reduce((X,re)=>X+re,0)," / ",S.target||200]})]}),c.jsxs("div",{className:"h-4 bg-black/40 rounded-full overflow-hidden border border-white/5 relative group/progress",children:[c.jsx("div",{className:"h-full bg-gradient-to-r from-indigo-600 via-indigo-400 to-fuchsia-500 transition-all duration-1000 shadow-[0_0_15px_rgba(99,102,241,0.4)] relative",style:{width:`${G}%`},children:c.jsx("div",{className:"absolute inset-0 bg-white/20 animate-pulse"})}),c.jsxs("div",{className:"absolute inset-0 opacity-0 group-hover/progress:opacity-100 transition-opacity flex justify-between items-center px-1 pointer-events-none",children:[c.jsx("button",{onClick:X=>{X.stopPropagation(),B(S.id,-1)},className:"w-5 h-5 bg-white/10 hover:bg-rose-500 text-white rounded-full flex items-center justify-center text-[10px] font-black pointer-events-auto transition-all",children:"-"}),c.jsx("button",{onClick:X=>{X.stopPropagation(),B(S.id,1)},className:"w-5 h-5 bg-white/10 hover:bg-emerald-500 text-white rounded-full flex items-center justify-center text-[10px] font-black pointer-events-auto transition-all",children:"+"})]})]})]},S.id)})})]}),c.jsx("div",{className:"absolute top-[-20%] right-[-10%] text-[15rem] text-indigo-500 opacity-[0.03] pointer-events-none group-hover:rotate-6 transition-transform duration-[3000ms]",children:""})]})]})})]}),c.jsxs("aside",{className:"w-80 border-l border-white/10 bg-slate-900/50 backdrop-blur-xl flex flex-col z-20 shadow-2xl overflow-hidden",children:[c.jsxs("div",{className:"p-8 border-b border-white/5 bg-black/20 shrink-0",children:[c.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-amber-500 mb-6 flex items-center justify-between",children:["Rikets Formue",c.jsx("div",{className:"w-2 h-2 bg-amber-500 rounded-full animate-pulse shadow-[0_0_10px_rgba(245,158,11,0.5)]"})]}),c.jsxs("div",{className:"space-y-4",children:[Object.values(n.players||{}).sort((S,M)=>(M.resources.gold||0)-(S.resources.gold||0)).slice(0,5).map((S,M)=>c.jsxs("div",{className:"flex justify-between items-center group",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("span",{className:"text-xs font-black text-slate-600 font-mono",children:["#",M+1]}),c.jsx("span",{className:"text-sm font-bold text-white group-hover:translate-x-1 transition-transform",children:S.name})]}),c.jsxs("span",{className:"text-sm font-black text-amber-400",children:[S.resources.gold,""]})]},S.id)),Object.keys(n.players||{}).length===0&&c.jsx("p",{className:"text-[10px] text-slate-600 font-bold italic text-center py-4",children:"Ingen data tilgjengelig..."})]})]}),c.jsxs("div",{className:"p-8 border-b border-white/5 shrink-0",children:[c.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-indigo-400 mb-6",children:"Markedsanalyse"}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[Object.entries(n.market||{}).slice(0,4).map(([S,M])=>{const G=hn[S]||{label:S};return c.jsxs("div",{className:"bg-white/5 p-3 rounded-xl border border-white/5",children:[c.jsx("div",{className:"text-[8px] font-black uppercase text-slate-500 mb-1",children:G.label}),c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-xs font-black text-white",children:M.stock}),c.jsxs("span",{className:"text-[10px] font-mono text-emerald-400",children:[M.price.toFixed(1),"g"]})]})]},S)}),Object.entries(n.market||{}).slice(0,4).length===0&&c.jsx("div",{className:"col-span-2 text-[10px] text-slate-600 font-bold italic text-center py-4",children:"Ingen markedsdata..."})]})]}),c.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[c.jsx("div",{className:"p-8 pb-4 shrink-0",children:c.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-rose-500 flex items-center gap-2",children:[c.jsx("span",{className:"w-2 h-2 bg-rose-600 rounded-full animate-pulse shadow-[0_0_10px_rgba(225,29,72,0.5)]"}),"Global Logg"]})}),c.jsxs("div",{className:"flex-1 overflow-y-auto px-6 space-y-3 pb-8 custom-scrollbar",children:[R(n.messages).slice().reverse().map((S,M)=>c.jsx("div",{className:"bg-indigo-950/20 border-l-2 border-indigo-500/50 p-4 rounded-r-2xl animate-in slide-in-from-right-4 duration-300",children:c.jsx("p",{className:"text-[10px] font-medium leading-relaxed text-slate-400 antialiased italic font-serif opacity-80",children:typeof S=="object"?JSON.stringify(S):S})},M)),R(n.messages).length===0&&c.jsxs("div",{className:"h-full flex flex-col items-center justify-center opacity-20 py-20",children:[c.jsx("span",{className:"text-4xl mb-4",children:""}),c.jsx("p",{className:"text-[8px] font-black uppercase tracking-[0.2em]",children:"Arkivet er tomt"})]})]})]})]}),c.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .custom-scrollbar::-webkit-scrollbar {
                    width: 4px;
                }
                .custom-scrollbar::-webkit-scrollbar-track {
                    background: transparent;
                }
                .custom-scrollbar::-webkit-scrollbar-thumb {
                    background: rgba(255, 255, 255, 0.1);
                    border-radius: 10px;
                }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover {
                    background: rgba(255, 255, 255, 0.2);
                }
                .no-scrollbar::-webkit-scrollbar {
                    display: none;
                }
            `}})]})};function j6(t,e){const{user:n,authLoading:s}=gf(),[i,r]=_.useState(null),[a,o]=_.useState(null),[l,u]=_.useState({}),[d,f]=_.useState("LOBBY"),[h,m]=_.useState({}),[v,b]=_.useState({}),[y,p]=_.useState([]),[g,x]=_.useState(null),[w,N]=_.useState({}),[T,E]=_.useState({}),[A,k]=_.useState(!1),[R,I]=_.useState(!1),[P,V]=_.useState(!1),$=_.useRef(null),K=_.useRef(null);return _.useEffect(()=>{if(s)return;const B=localStorage.getItem("sim_player_id");let j=e;if(j||(n!=null&&n.uid?j=n.uid:j=B),!j||!t)return;const O=`simulation_rooms/${t}`,C=D(L,`${O}/players/${j}`),F=Ye(C,S=>{if(k(!0),S.exists()){$.current&&(clearTimeout($.current),$.current=null);const M=S.val();if(t==="TEST"&&M.regionId==="unassigned"&&M.role!=="KING"){const X=Math.random()>.5?"region_east":"region_west";J(C,{regionId:X})}const G={...M,id:j};r(G),K.current=G,I(!0)}else R?$.current||($.current=setTimeout(()=>{V(!0),r(null),I(!1),K.current=null},5e3)):r(null)}),Q=D(L,`${O}/world`),oe=Ye(Q,S=>{const M=S.val();M&&o(M)}),be=D(L,`${O}/status`),H=Ye(be,S=>{const M=S.val();M&&f(M||"LOBBY")}),me=D(L,`${O}/markets`),se=Ye(me,S=>{const M=S.val();M&&m(M)}),tt=D(L,`${O}/messages`),Ft=Ye(tt,S=>{const M=S.val();M&&p(M)}),jn=D(L,`${O}/activeVote`),Dt=Ye(jn,S=>{x(S.val())}),$n=D(L,`${O}/diplomacy`),pn=Ye($n,S=>{N(S.val()||{})}),Hi=D(L,`${O}/trades`),Gi=Ye(Hi,S=>{E(S.val()||{})}),Kn=D(L,`${O}/public_profiles`),bc=Ye(Kn,S=>{const M=S.val()||{};u(M)}),xc=D(L,`${O}/regions`),yc=Ye(xc,S=>{b(S.val()||{})});return()=>{F(),oe(),H(),se(),Ft(),Dt(),pn(),bc(),Gi(),yc()}},[t,e,n==null?void 0:n.uid,s,R]),_.useEffect(()=>{if(!i||!t)return;const B=D(L,`simulation_rooms/${t}/players/${i.id}`),j=D(L,`simulation_rooms/${t}/public_profiles/${i.id}`);ly(B).update({online:!1}),ly(j).update({online:!1});const O=setInterval(()=>{const C=Date.now();J(B,{lastActive:C,online:!0}),J(j,{lastActive:C,online:!0})},3e4);return J(B,{lastActive:Date.now(),online:!0}),J(j,{lastActive:Date.now(),online:!0}),()=>clearInterval(O)},[t,i==null?void 0:i.id]),_.useEffect(()=>{if(!t||!t.startsWith("v"))return;const B=localStorage.getItem("nexus_active_vessel");if(B)try{const j=JSON.parse(B);if(j.id===t){console.log("Nexus Vessel Detected. Injecting Mock Data...",j);const O={id:j.id,uid:(n==null?void 0:n.uid)||"nexus_user",name:j.name,role:j.role.toUpperCase(),regionId:"nexus_region",resources:{gold:j.gold,grain:100,flour:0,bread:5,wood:50,plank:0,iron_ore:0,iron_ingot:0,stone:0,swords:0,armor:0,favor:0,wool:0,cloth:0,honey:0,meat:0,glass:0,manpower:10,egg:0,omelette:0},stats:{xp:0,level:1,reputation:50,contribution:0},status:{hp:j.health,morale:100,stamina:100,legitimacy:100,authority:100,loyalty:100,isJailed:!1,isFrozen:!1},equipment:{},skills:{FARMING:{level:1,xp:0,maxXp:100},WOODCUTTING:{level:1,xp:0,maxXp:100},MINING:{level:1,xp:0,maxXp:100},CRAFTING:{level:1,xp:0,maxXp:100},STEWARDSHIP:{level:1,xp:0,maxXp:100},COMBAT:{level:1,xp:0,maxXp:100},TRADING:{level:1,xp:0,maxXp:100},THEOLOGY:{level:1,xp:0,maxXp:100}},upgrades:[],lastActive:Date.now()};r(O),I(!0),k(!0),f("PLAYING"),o({year:1250,season:"Spring",weather:"Clear",gameTick:100,lastTickAt:Date.now(),taxRateDetails:{kingTax:10},settlement:{buildings:{}}})}}catch(j){console.error("Failed to parse Nexus vessel data",j)}},[t,n==null?void 0:n.uid]),TS(t,d,a),{player:i,world:a,players:l,roomStatus:d,markets:h,regions:v,messages:y,activeVote:g,diplomacy:w,trades:T,hasAttemptedPlayerLoad:A,hasActiveSession:R,isRetired:P,setIsRetired:V,setPlayer:r,lastValidPlayer:K.current}}function OS(t,e,n,s,i,r,a){const[o,l]=_.useState(null),[u,d]=_.useState(null),f=_.useCallback(()=>{d(null)},[]),h=_.useCallback(async m=>{var x;if(!t||!e||o)return;const v=typeof m=="string"?m:m.type,b=typeof m=="object"?m.method:null;if(["WORK","CHOP","CRAFT","DEFEND","EXPLORE","MINE","QUARRY","PATROL","FORAGE","REFINE","SMELT","BAKE","WEAVE","MIX","PLANT","HARVEST","GATHER_WOOL","HUNT","SAWMILL"].includes(v)&&!a&&!m.performance){const w=(n==null?void 0:n.season)||"Spring",N=(n==null?void 0:n.weather)||"Clear",T=(n==null?void 0:n.gameTick)||0,E=RS(e,m,w,N,T);if(!E.success){alert(`Du har ikke rd til dette: ${E.reason}`),d({success:!1,timestamp:Date.now(),message:`Kan ikke utfre: ${E.reason}`,utbytte:[],xp:[],durability:[]});return}let A=v;if(v==="REFINE"){const I=m.recipeId;(I==="iron_ingot"||I==="glass"||I==="smelt")&&(A="SMELT"),(I==="bread"||I==="pie"||I==="mead"||I==="bake")&&(A="BAKE"),(I==="cloth"||I==="weave")&&(A="WEAVE"),I==="plank"&&(A="SAWMILL")}v==="CRAFT"&&m.subType==="omelette"&&(A="BAKE");const R=(e.activeProcesses||[]).find(I=>{var P;return(I.locationId===m.locationId||m.locationId&&((P=I.locationId)==null?void 0:P.startsWith(m.locationId)))&&I.readyAt<=Date.now()});if(!(v==="REFINE"&&m.recipeId==="flour"||v==="HARVEST"&&((R==null?void 0:R.type)==="MILL"||(R==null?void 0:R.type)==="CRAFT"))){s(A),b&&i(b),r(m),d(null);return}}const p=v==="EQUIP_ITEM"||v==="UNEQUIP_ITEM";m.performance&&!p&&(s(null),r(null),i(null)),p||l(v);const g=new Promise((w,N)=>{setTimeout(()=>N(new Error("Handlingen tok for lang tid (Timeout)")),3e4)});try{const w=await Promise.race([jS(t,e.id,m),g]);p||(w.data?d(w.data):w.success||d({success:!1,timestamp:Date.now(),message:`Handlingen feilet: ${((x=w.error)==null?void 0:x.message)||w.error||"Ukjent feil"}`,utbytte:[],xp:[],durability:[]}))}catch(w){console.error("Action Timeout/Error:",w),p||d({success:!1,timestamp:Date.now(),message:` ${w.message||"Ukjent feil"}`,utbytte:[],xp:[],durability:[]})}p||l(null),s(null),r(null),i(null)},[t,e,o,n,a,s,i,r]);return{actionLoading:o,actionResult:u,handleAction:h,handleClearActionResult:f,setActionLoading:l}}const hp=({resource:t,amount:e,size:n="md",showLabel:s=!1})=>{const i=hn[t]||{label:t,icon:""},r={sm:"text-xl",md:"text-3xl",lg:"text-7xl"};return c.jsxs("div",{className:"flex items-center gap-2",title:i.label,children:[c.jsx("span",{className:`${r[n]}`,children:i.icon}),c.jsxs("div",{className:"flex flex-col",children:[s&&c.jsx("span",{className:"text-xs uppercase text-game-stone_light font-bold tracking-wider",children:i.label}),e!==void 0&&c.jsx("span",{className:`font-mono font-bold text-white ${n==="lg"?"text-xl":"text-sm"}`,children:e.toLocaleString()})]})]})},M0=_.createContext({});function D0(t){const e=_.useRef(null);return e.current===null&&(e.current=t()),e.current}const yf=_.createContext(null),L0=_.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class O6 extends _.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const s=this.props.sizeRef.current;s.height=n.offsetHeight||0,s.width=n.offsetWidth||0,s.top=n.offsetTop,s.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function M6({children:t,isPresent:e}){const n=_.useId(),s=_.useRef(null),i=_.useRef({width:0,height:0,top:0,left:0}),{nonce:r}=_.useContext(L0);return _.useInsertionEffect(()=>{const{width:a,height:o,top:l,left:u}=i.current;if(e||!s.current||!a||!o)return;s.current.dataset.motionPopId=n;const d=document.createElement("style");return r&&(d.nonce=r),document.head.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${o}px !important;
            top: ${l}px !important;
            left: ${u}px !important;
          }
        `),()=>{document.head.removeChild(d)}},[e]),c.jsx(O6,{isPresent:e,childRef:s,sizeRef:i,children:_.cloneElement(t,{ref:s})})}const D6=({children:t,initial:e,isPresent:n,onExitComplete:s,custom:i,presenceAffectsLayout:r,mode:a})=>{const o=D0(L6),l=_.useId(),u=_.useCallback(f=>{o.set(f,!0);for(const h of o.values())if(!h)return;s&&s()},[o,s]),d=_.useMemo(()=>({id:l,initial:e,isPresent:n,custom:i,onExitComplete:u,register:f=>(o.set(f,!1),()=>o.delete(f))}),r?[Math.random(),u]:[n,u]);return _.useMemo(()=>{o.forEach((f,h)=>o.set(h,!1))},[n]),_.useEffect(()=>{!n&&!o.size&&s&&s()},[n]),a==="popLayout"&&(t=c.jsx(M6,{isPresent:n,children:t})),c.jsx(yf.Provider,{value:d,children:t})};function L6(){return new Map}function MS(t=!0){const e=_.useContext(yf);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:s,register:i}=e,r=_.useId();_.useEffect(()=>{t&&i(r)},[t]);const a=_.useCallback(()=>t&&s&&s(r),[r,s,t]);return!n&&s?[!1,a]:[!0]}const Fc=t=>t.key||"";function wy(t){const e=[];return _.Children.forEach(t,n=>{_.isValidElement(n)&&e.push(n)}),e}const P0=typeof window<"u",DS=P0?_.useLayoutEffect:_.useEffect,Ei=({children:t,custom:e,initial:n=!0,onExitComplete:s,presenceAffectsLayout:i=!0,mode:r="sync",propagate:a=!1})=>{const[o,l]=MS(a),u=_.useMemo(()=>wy(t),[t]),d=a&&!o?[]:u.map(Fc),f=_.useRef(!0),h=_.useRef(u),m=D0(()=>new Map),[v,b]=_.useState(u),[y,p]=_.useState(u);DS(()=>{f.current=!1,h.current=u;for(let w=0;w<y.length;w++){const N=Fc(y[w]);d.includes(N)?m.delete(N):m.get(N)!==!0&&m.set(N,!1)}},[y,d.length,d.join("-")]);const g=[];if(u!==v){let w=[...u];for(let N=0;N<y.length;N++){const T=y[N],E=Fc(T);d.includes(E)||(w.splice(N,0,T),g.push(T))}r==="wait"&&g.length&&(w=g),p(wy(w)),b(u);return}const{forceRender:x}=_.useContext(M0);return c.jsx(c.Fragment,{children:y.map(w=>{const N=Fc(w),T=a&&!o?!1:u===y||d.includes(N),E=()=>{if(m.has(N))m.set(N,!0);else return;let A=!0;m.forEach(k=>{k||(A=!1)}),A&&(x==null||x(),p(h.current),a&&(l==null||l()),s&&s())};return c.jsx(D6,{isPresent:T,initial:!f.current||n?void 0:!1,custom:T?void 0:e,presenceAffectsLayout:i,mode:r,onExitComplete:T?void 0:E,children:w},N)})})},cn=t=>t;let LS=cn;function B0(t){let e;return()=>(e===void 0&&(e=t()),e)}const Ua=(t,e,n)=>{const s=e-t;return s===0?1:(n-t)/s},ks=t=>t*1e3,Ss=t=>t/1e3,P6={useManualTiming:!1};function B6(t){let e=new Set,n=new Set,s=!1,i=!1;const r=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function o(u){r.has(u)&&(l.schedule(u),t()),u(a)}const l={schedule:(u,d=!1,f=!1)=>{const m=f&&s?e:n;return d&&r.add(u),m.has(u)||m.add(u),u},cancel:u=>{n.delete(u),r.delete(u)},process:u=>{if(a=u,s){i=!0;return}s=!0,[e,n]=[n,e],e.forEach(o),e.clear(),s=!1,i&&(i=!1,l.process(u))}};return l}const zc=["read","resolveKeyframes","update","preRender","render","postRender"],U6=40;function PS(t,e){let n=!1,s=!0;const i={delta:0,timestamp:0,isProcessing:!1},r=()=>n=!0,a=zc.reduce((p,g)=>(p[g]=B6(r),p),{}),{read:o,resolveKeyframes:l,update:u,preRender:d,render:f,postRender:h}=a,m=()=>{const p=performance.now();n=!1,i.delta=s?1e3/60:Math.max(Math.min(p-i.timestamp,U6),1),i.timestamp=p,i.isProcessing=!0,o.process(i),l.process(i),u.process(i),d.process(i),f.process(i),h.process(i),i.isProcessing=!1,n&&e&&(s=!1,t(m))},v=()=>{n=!0,s=!0,i.isProcessing||t(m)};return{schedule:zc.reduce((p,g)=>{const x=a[g];return p[g]=(w,N=!1,T=!1)=>(n||v(),x.schedule(w,N,T)),p},{}),cancel:p=>{for(let g=0;g<zc.length;g++)a[zc[g]].cancel(p)},state:i,steps:a}}const{schedule:Fe,cancel:Oi,state:Nt,steps:kh}=PS(typeof requestAnimationFrame<"u"?requestAnimationFrame:cn,!0),BS=_.createContext({strict:!1}),Ey={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Ha={};for(const t in Ey)Ha[t]={isEnabled:e=>Ey[t].some(n=>!!e[n])};function H6(t){for(const e in t)Ha[e]={...Ha[e],...t[e]}}const G6=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function _d(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||G6.has(t)}let US=t=>!_d(t);function V6(t){t&&(US=e=>e.startsWith("on")?!_d(e):t(e))}try{V6(require("@emotion/is-prop-valid").default)}catch{}function F6(t,e,n){const s={};for(const i in t)i==="values"&&typeof t.values=="object"||(US(i)||n===!0&&_d(i)||!e&&!_d(i)||t.draggable&&i.startsWith("onDrag"))&&(s[i]=t[i]);return s}function z6(t){if(typeof Proxy>"u")return t;const e=new Map,n=(...s)=>t(...s);return new Proxy(n,{get:(s,i)=>i==="create"?t:(e.has(i)||e.set(i,t(i)),e.get(i))})}const _f=_.createContext({});function Dl(t){return typeof t=="string"||Array.isArray(t)}function wf(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const U0=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],H0=["initial",...U0];function Ef(t){return wf(t.animate)||H0.some(e=>Dl(t[e]))}function HS(t){return!!(Ef(t)||t.variants)}function $6(t,e){if(Ef(t)){const{initial:n,animate:s}=t;return{initial:n===!1||Dl(n)?n:void 0,animate:Dl(s)?s:void 0}}return t.inherit!==!1?e:{}}function K6(t){const{initial:e,animate:n}=$6(t,_.useContext(_f));return _.useMemo(()=>({initial:e,animate:n}),[Ny(e),Ny(n)])}function Ny(t){return Array.isArray(t)?t.join(" "):t}const Y6=Symbol.for("motionComponentSymbol");function ea(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function q6(t,e,n){return _.useCallback(s=>{s&&t.onMount&&t.onMount(s),e&&(s?e.mount(s):e.unmount()),n&&(typeof n=="function"?n(s):ea(n)&&(n.current=s))},[e])}const G0=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),W6="framerAppearId",GS="data-"+G0(W6),{schedule:V0}=PS(queueMicrotask,!1),VS=_.createContext({});function X6(t,e,n,s,i){var r,a;const{visualElement:o}=_.useContext(_f),l=_.useContext(BS),u=_.useContext(yf),d=_.useContext(L0).reducedMotion,f=_.useRef(null);s=s||l.renderer,!f.current&&s&&(f.current=s(t,{visualState:e,parent:o,props:n,presenceContext:u,blockInitialAnimation:u?u.initial===!1:!1,reducedMotionConfig:d}));const h=f.current,m=_.useContext(VS);h&&!h.projection&&i&&(h.type==="html"||h.type==="svg")&&Q6(f.current,n,i,m);const v=_.useRef(!1);_.useInsertionEffect(()=>{h&&v.current&&h.update(n,u)});const b=n[GS],y=_.useRef(!!b&&!(!((r=window.MotionHandoffIsComplete)===null||r===void 0)&&r.call(window,b))&&((a=window.MotionHasOptimisedAnimation)===null||a===void 0?void 0:a.call(window,b)));return DS(()=>{h&&(v.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),V0.render(h.render),y.current&&h.animationState&&h.animationState.animateChanges())}),_.useEffect(()=>{h&&(!y.current&&h.animationState&&h.animationState.animateChanges(),y.current&&(queueMicrotask(()=>{var p;(p=window.MotionHandoffMarkAsComplete)===null||p===void 0||p.call(window,b)}),y.current=!1))}),h}function Q6(t,e,n,s){const{layoutId:i,layout:r,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:u}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:FS(t.parent)),t.projection.setOptions({layoutId:i,layout:r,alwaysMeasureLayout:!!a||o&&ea(o),visualElement:t,animationType:typeof r=="string"?r:"both",initialPromotionConfig:s,layoutScroll:l,layoutRoot:u})}function FS(t){if(t)return t.options.allowProjection!==!1?t.projection:FS(t.parent)}function J6({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:s,Component:i}){var r,a;t&&H6(t);function o(u,d){let f;const h={..._.useContext(L0),...u,layoutId:Z6(u)},{isStatic:m}=h,v=K6(u),b=s(u,m);if(!m&&P0){eB();const y=tB(h);f=y.MeasureLayout,v.visualElement=X6(i,b,h,e,y.ProjectionNode)}return c.jsxs(_f.Provider,{value:v,children:[f&&v.visualElement?c.jsx(f,{visualElement:v.visualElement,...h}):null,n(i,u,q6(b,v.visualElement,d),b,m,v.visualElement)]})}o.displayName=`motion.${typeof i=="string"?i:`create(${(a=(r=i.displayName)!==null&&r!==void 0?r:i.name)!==null&&a!==void 0?a:""})`}`;const l=_.forwardRef(o);return l[Y6]=i,l}function Z6({layoutId:t}){const e=_.useContext(M0).id;return e&&t!==void 0?e+"-"+t:t}function eB(t,e){_.useContext(BS).strict}function tB(t){const{drag:e,layout:n}=Ha;if(!e&&!n)return{};const s={...e,...n};return{MeasureLayout:e!=null&&e.isEnabled(t)||n!=null&&n.isEnabled(t)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}const nB=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function F0(t){return typeof t!="string"||t.includes("-")?!1:!!(nB.indexOf(t)>-1||/[A-Z]/u.test(t))}function ky(t){const e=[{},{}];return t==null||t.values.forEach((n,s)=>{e[0][s]=n.get(),e[1][s]=n.getVelocity()}),e}function z0(t,e,n,s){if(typeof e=="function"){const[i,r]=ky(s);e=e(n!==void 0?n:t.custom,i,r)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[i,r]=ky(s);e=e(n!==void 0?n:t.custom,i,r)}return e}const mp=t=>Array.isArray(t),sB=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),iB=t=>mp(t)?t[t.length-1]||0:t,Ot=t=>!!(t&&t.getVelocity);function pu(t){const e=Ot(t)?t.get():t;return sB(e)?e.toValue():e}function rB({scrapeMotionValuesFromProps:t,createRenderState:e,onUpdate:n},s,i,r){const a={latestValues:aB(s,i,r,t),renderState:e()};return n&&(a.onMount=o=>n({props:s,current:o,...a}),a.onUpdate=o=>n(o)),a}const zS=t=>(e,n)=>{const s=_.useContext(_f),i=_.useContext(yf),r=()=>rB(t,e,s,i);return n?r():D0(r)};function aB(t,e,n,s){const i={},r=s(t,{});for(const h in r)i[h]=pu(r[h]);let{initial:a,animate:o}=t;const l=Ef(t),u=HS(t);e&&u&&!l&&t.inherit!==!1&&(a===void 0&&(a=e.initial),o===void 0&&(o=e.animate));let d=n?n.initial===!1:!1;d=d||a===!1;const f=d?o:a;if(f&&typeof f!="boolean"&&!wf(f)){const h=Array.isArray(f)?f:[f];for(let m=0;m<h.length;m++){const v=z0(t,h[m]);if(v){const{transitionEnd:b,transition:y,...p}=v;for(const g in p){let x=p[g];if(Array.isArray(x)){const w=d?x.length-1:0;x=x[w]}x!==null&&(i[g]=x)}for(const g in b)i[g]=b[g]}}}return i}const oo=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Cr=new Set(oo),$S=t=>e=>typeof e=="string"&&e.startsWith(t),KS=$S("--"),oB=$S("var(--"),$0=t=>oB(t)?lB.test(t.split("/*")[0].trim()):!1,lB=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,YS=(t,e)=>e&&typeof t=="number"?e.transform(t):t,Ls=(t,e,n)=>n>e?e:n<t?t:n,lo={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Ll={...lo,transform:t=>Ls(0,1,t)},$c={...lo,default:1},mc=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Fs=mc("deg"),es=mc("%"),ee=mc("px"),cB=mc("vh"),uB=mc("vw"),Sy={...es,parse:t=>es.parse(t)/100,transform:t=>es.transform(t*100)},dB={borderWidth:ee,borderTopWidth:ee,borderRightWidth:ee,borderBottomWidth:ee,borderLeftWidth:ee,borderRadius:ee,radius:ee,borderTopLeftRadius:ee,borderTopRightRadius:ee,borderBottomRightRadius:ee,borderBottomLeftRadius:ee,width:ee,maxWidth:ee,height:ee,maxHeight:ee,top:ee,right:ee,bottom:ee,left:ee,padding:ee,paddingTop:ee,paddingRight:ee,paddingBottom:ee,paddingLeft:ee,margin:ee,marginTop:ee,marginRight:ee,marginBottom:ee,marginLeft:ee,backgroundPositionX:ee,backgroundPositionY:ee},fB={rotate:Fs,rotateX:Fs,rotateY:Fs,rotateZ:Fs,scale:$c,scaleX:$c,scaleY:$c,scaleZ:$c,skew:Fs,skewX:Fs,skewY:Fs,distance:ee,translateX:ee,translateY:ee,translateZ:ee,x:ee,y:ee,z:ee,perspective:ee,transformPerspective:ee,opacity:Ll,originX:Sy,originY:Sy,originZ:ee},Ty={...lo,transform:Math.round},K0={...dB,...fB,zIndex:Ty,size:ee,fillOpacity:Ll,strokeOpacity:Ll,numOctaves:Ty},hB={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},mB=oo.length;function pB(t,e,n){let s="",i=!0;for(let r=0;r<mB;r++){const a=oo[r],o=t[a];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(a.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||n){const u=YS(o,K0[a]);if(!l){i=!1;const d=hB[a]||a;s+=`${d}(${u}) `}n&&(e[a]=u)}}return s=s.trim(),n?s=n(e,i?"":s):i&&(s="none"),s}function Y0(t,e,n){const{style:s,vars:i,transformOrigin:r}=t;let a=!1,o=!1;for(const l in e){const u=e[l];if(Cr.has(l)){a=!0;continue}else if(KS(l)){i[l]=u;continue}else{const d=YS(u,K0[l]);l.startsWith("origin")?(o=!0,r[l]=d):s[l]=d}}if(e.transform||(a||n?s.transform=pB(e,t.transform,n):s.transform&&(s.transform="none")),o){const{originX:l="50%",originY:u="50%",originZ:d=0}=r;s.transformOrigin=`${l} ${u} ${d}`}}const gB={offset:"stroke-dashoffset",array:"stroke-dasharray"},vB={offset:"strokeDashoffset",array:"strokeDasharray"};function bB(t,e,n=1,s=0,i=!0){t.pathLength=1;const r=i?gB:vB;t[r.offset]=ee.transform(-s);const a=ee.transform(e),o=ee.transform(n);t[r.array]=`${a} ${o}`}function Ay(t,e,n){return typeof t=="string"?t:ee.transform(e+n*t)}function xB(t,e,n){const s=Ay(e,t.x,t.width),i=Ay(n,t.y,t.height);return`${s} ${i}`}function q0(t,{attrX:e,attrY:n,attrScale:s,originX:i,originY:r,pathLength:a,pathSpacing:o=1,pathOffset:l=0,...u},d,f){if(Y0(t,u,f),d){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:h,style:m,dimensions:v}=t;h.transform&&(v&&(m.transform=h.transform),delete h.transform),v&&(i!==void 0||r!==void 0||m.transform)&&(m.transformOrigin=xB(v,i!==void 0?i:.5,r!==void 0?r:.5)),e!==void 0&&(h.x=e),n!==void 0&&(h.y=n),s!==void 0&&(h.scale=s),a!==void 0&&bB(h,a,o,l,!1)}const W0=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),qS=()=>({...W0(),attrs:{}}),X0=t=>typeof t=="string"&&t.toLowerCase()==="svg";function WS(t,{style:e,vars:n},s,i){Object.assign(t.style,e,i&&i.getProjectionStyles(s));for(const r in n)t.style.setProperty(r,n[r])}const XS=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function QS(t,e,n,s){WS(t,e,void 0,s);for(const i in e.attrs)t.setAttribute(XS.has(i)?i:G0(i),e.attrs[i])}const wd={};function yB(t){Object.assign(wd,t)}function JS(t,{layout:e,layoutId:n}){return Cr.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!wd[t]||t==="opacity")}function Q0(t,e,n){var s;const{style:i}=t,r={};for(const a in i)(Ot(i[a])||e.style&&Ot(e.style[a])||JS(a,t)||((s=n==null?void 0:n.getValue(a))===null||s===void 0?void 0:s.liveStyle)!==void 0)&&(r[a]=i[a]);return r}function ZS(t,e,n){const s=Q0(t,e,n);for(const i in t)if(Ot(t[i])||Ot(e[i])){const r=oo.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;s[r]=t[i]}return s}function _B(t,e){try{e.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const Ry=["x","y","width","height","cx","cy","r"],wB={useVisualState:zS({scrapeMotionValuesFromProps:ZS,createRenderState:qS,onUpdate:({props:t,prevProps:e,current:n,renderState:s,latestValues:i})=>{if(!n)return;let r=!!t.drag;if(!r){for(const o in i)if(Cr.has(o)){r=!0;break}}if(!r)return;let a=!e;if(e)for(let o=0;o<Ry.length;o++){const l=Ry[o];t[l]!==e[l]&&(a=!0)}a&&Fe.read(()=>{_B(n,s),Fe.render(()=>{q0(s,i,X0(n.tagName),t.transformTemplate),QS(n,s)})})}})},EB={useVisualState:zS({scrapeMotionValuesFromProps:Q0,createRenderState:W0})};function eT(t,e,n){for(const s in e)!Ot(e[s])&&!JS(s,n)&&(t[s]=e[s])}function NB({transformTemplate:t},e){return _.useMemo(()=>{const n=W0();return Y0(n,e,t),Object.assign({},n.vars,n.style)},[e])}function kB(t,e){const n=t.style||{},s={};return eT(s,n,t),Object.assign(s,NB(t,e)),s}function SB(t,e){const n={},s=kB(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=s,n}function TB(t,e,n,s){const i=_.useMemo(()=>{const r=qS();return q0(r,e,X0(s),t.transformTemplate),{...r.attrs,style:{...r.style}}},[e]);if(t.style){const r={};eT(r,t.style,t),i.style={...r,...i.style}}return i}function AB(t=!1){return(n,s,i,{latestValues:r},a)=>{const l=(F0(n)?TB:SB)(s,r,a,n),u=F6(s,typeof n=="string",t),d=n!==_.Fragment?{...u,...l,ref:i}:{},{children:f}=s,h=_.useMemo(()=>Ot(f)?f.get():f,[f]);return _.createElement(n,{...d,children:h})}}function RB(t,e){return function(s,{forwardMotionProps:i}={forwardMotionProps:!1}){const a={...F0(s)?wB:EB,preloadedFeatures:t,useRender:AB(i),createVisualElement:e,Component:s};return J6(a)}}function tT(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let s=0;s<n;s++)if(e[s]!==t[s])return!1;return!0}function Nf(t,e,n){const s=t.getProps();return z0(s,e,n!==void 0?n:s.custom,t)}const IB=B0(()=>window.ScrollTimeline!==void 0);class CB{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,n){for(let s=0;s<this.animations.length;s++)this.animations[s][e]=n}attachTimeline(e,n){const s=this.animations.map(i=>{if(IB()&&i.attachTimeline)return i.attachTimeline(e);if(typeof n=="function")return n(i)});return()=>{s.forEach((i,r)=>{i&&i(),this.animations[r].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let n=0;n<this.animations.length;n++)e=Math.max(e,this.animations[n].duration);return e}runAll(e){this.animations.forEach(n=>n[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class jB extends CB{then(e,n){return Promise.all(this.animations).then(e).catch(n)}}function J0(t,e){return t?t[e]||t.default||t:void 0}const pp=2e4;function nT(t){let e=0;const n=50;let s=t.next(e);for(;!s.done&&e<pp;)e+=n,s=t.next(e);return e>=pp?1/0:e}function Z0(t){return typeof t=="function"}function Iy(t,e){t.timeline=e,t.onfinish=null}const ev=t=>Array.isArray(t)&&typeof t[0]=="number",OB={linearEasing:void 0};function MB(t,e){const n=B0(t);return()=>{var s;return(s=OB[e])!==null&&s!==void 0?s:n()}}const Ed=MB(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),sT=(t,e,n=10)=>{let s="";const i=Math.max(Math.round(e/n),2);for(let r=0;r<i;r++)s+=t(Ua(0,i-1,r))+", ";return`linear(${s.substring(0,s.length-2)})`};function iT(t){return!!(typeof t=="function"&&Ed()||!t||typeof t=="string"&&(t in gp||Ed())||ev(t)||Array.isArray(t)&&t.every(iT))}const Io=([t,e,n,s])=>`cubic-bezier(${t}, ${e}, ${n}, ${s})`,gp={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Io([0,.65,.55,1]),circOut:Io([.55,0,1,.45]),backIn:Io([.31,.01,.66,-.59]),backOut:Io([.33,1.53,.69,.99])};function rT(t,e){if(t)return typeof t=="function"&&Ed()?sT(t,e):ev(t)?Io(t):Array.isArray(t)?t.map(n=>rT(n,e)||gp.easeOut):gp[t]}const Mn={x:!1,y:!1};function aT(){return Mn.x||Mn.y}function DB(t,e,n){var s;if(t instanceof Element)return[t];if(typeof t=="string"){let i=document;const r=(s=void 0)!==null&&s!==void 0?s:i.querySelectorAll(t);return r?Array.from(r):[]}return Array.from(t)}function oT(t,e){const n=DB(t),s=new AbortController,i={passive:!0,...e,signal:s.signal};return[n,i,()=>s.abort()]}function Cy(t){return e=>{e.pointerType==="touch"||aT()||t(e)}}function LB(t,e,n={}){const[s,i,r]=oT(t,n),a=Cy(o=>{const{target:l}=o,u=e(o);if(typeof u!="function"||!l)return;const d=Cy(f=>{u(f),l.removeEventListener("pointerleave",d)});l.addEventListener("pointerleave",d,i)});return s.forEach(o=>{o.addEventListener("pointerenter",a,i)}),r}const lT=(t,e)=>e?t===e?!0:lT(t,e.parentElement):!1,tv=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,PB=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function BB(t){return PB.has(t.tagName)||t.tabIndex!==-1}const Co=new WeakSet;function jy(t){return e=>{e.key==="Enter"&&t(e)}}function Sh(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const UB=(t,e)=>{const n=t.currentTarget;if(!n)return;const s=jy(()=>{if(Co.has(n))return;Sh(n,"down");const i=jy(()=>{Sh(n,"up")}),r=()=>Sh(n,"cancel");n.addEventListener("keyup",i,e),n.addEventListener("blur",r,e)});n.addEventListener("keydown",s,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",s),e)};function Oy(t){return tv(t)&&!aT()}function HB(t,e,n={}){const[s,i,r]=oT(t,n),a=o=>{const l=o.currentTarget;if(!Oy(o)||Co.has(l))return;Co.add(l);const u=e(o),d=(m,v)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",h),!(!Oy(m)||!Co.has(l))&&(Co.delete(l),typeof u=="function"&&u(m,{success:v}))},f=m=>{d(m,n.useGlobalTarget||lT(l,m.target))},h=m=>{d(m,!1)};window.addEventListener("pointerup",f,i),window.addEventListener("pointercancel",h,i)};return s.forEach(o=>{!BB(o)&&o.getAttribute("tabindex")===null&&(o.tabIndex=0),(n.useGlobalTarget?window:o).addEventListener("pointerdown",a,i),o.addEventListener("focus",u=>UB(u,i),i)}),r}function GB(t){return t==="x"||t==="y"?Mn[t]?null:(Mn[t]=!0,()=>{Mn[t]=!1}):Mn.x||Mn.y?null:(Mn.x=Mn.y=!0,()=>{Mn.x=Mn.y=!1})}const cT=new Set(["width","height","top","left","right","bottom",...oo]);let gu;function VB(){gu=void 0}const ts={now:()=>(gu===void 0&&ts.set(Nt.isProcessing||P6.useManualTiming?Nt.timestamp:performance.now()),gu),set:t=>{gu=t,queueMicrotask(VB)}};function nv(t,e){t.indexOf(e)===-1&&t.push(e)}function sv(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class iv{constructor(){this.subscriptions=[]}add(e){return nv(this.subscriptions,e),()=>sv(this.subscriptions,e)}notify(e,n,s){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,n,s);else for(let r=0;r<i;r++){const a=this.subscriptions[r];a&&a(e,n,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function uT(t,e){return e?t*(1e3/e):0}const My=30,FB=t=>!isNaN(parseFloat(t));class zB{constructor(e,n={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(s,i=!0)=>{const r=ts.now();this.updatedAt!==r&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=ts.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=FB(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new iv);const s=this.events[e].add(n);return e==="change"?()=>{s(),Fe.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,s){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-s}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=ts.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>My)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,My);return uT(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Pl(t,e){return new zB(t,e)}function $B(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Pl(n))}function KB(t,e){const n=Nf(t,e);let{transitionEnd:s={},transition:i={},...r}=n||{};r={...r,...s};for(const a in r){const o=iB(r[a]);$B(t,a,o)}}function YB(t){return!!(Ot(t)&&t.add)}function vp(t,e){const n=t.getValue("willChange");if(YB(n))return n.add(e)}function dT(t){return t.props[GS]}const fT=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,qB=1e-7,WB=12;function XB(t,e,n,s,i){let r,a,o=0;do a=e+(n-e)/2,r=fT(a,s,i)-t,r>0?n=a:e=a;while(Math.abs(r)>qB&&++o<WB);return a}function pc(t,e,n,s){if(t===e&&n===s)return cn;const i=r=>XB(r,0,1,t,n);return r=>r===0||r===1?r:fT(i(r),e,s)}const hT=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,mT=t=>e=>1-t(1-e),pT=pc(.33,1.53,.69,.99),rv=mT(pT),gT=hT(rv),vT=t=>(t*=2)<1?.5*rv(t):.5*(2-Math.pow(2,-10*(t-1))),av=t=>1-Math.sin(Math.acos(t)),bT=mT(av),xT=hT(av),yT=t=>/^0[^.\s]+$/u.test(t);function QB(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||yT(t):!0}const el=t=>Math.round(t*1e5)/1e5,ov=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function JB(t){return t==null}const ZB=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,lv=(t,e)=>n=>!!(typeof n=="string"&&ZB.test(n)&&n.startsWith(t)||e&&!JB(n)&&Object.prototype.hasOwnProperty.call(n,e)),_T=(t,e,n)=>s=>{if(typeof s!="string")return s;const[i,r,a,o]=s.match(ov);return{[t]:parseFloat(i),[e]:parseFloat(r),[n]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},eU=t=>Ls(0,255,t),Th={...lo,transform:t=>Math.round(eU(t))},er={test:lv("rgb","red"),parse:_T("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:s=1})=>"rgba("+Th.transform(t)+", "+Th.transform(e)+", "+Th.transform(n)+", "+el(Ll.transform(s))+")"};function tU(t){let e="",n="",s="",i="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),s=t.substring(5,7),i=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),s=t.substring(3,4),i=t.substring(4,5),e+=e,n+=n,s+=s,i+=i),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(s,16),alpha:i?parseInt(i,16)/255:1}}const bp={test:lv("#"),parse:tU,transform:er.transform},ta={test:lv("hsl","hue"),parse:_T("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:s=1})=>"hsla("+Math.round(t)+", "+es.transform(el(e))+", "+es.transform(el(n))+", "+el(Ll.transform(s))+")"},jt={test:t=>er.test(t)||bp.test(t)||ta.test(t),parse:t=>er.test(t)?er.parse(t):ta.test(t)?ta.parse(t):bp.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?er.transform(t):ta.transform(t)},nU=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function sU(t){var e,n;return isNaN(t)&&typeof t=="string"&&(((e=t.match(ov))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(nU))===null||n===void 0?void 0:n.length)||0)>0}const wT="number",ET="color",iU="var",rU="var(",Dy="${}",aU=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Bl(t){const e=t.toString(),n=[],s={color:[],number:[],var:[]},i=[];let r=0;const o=e.replace(aU,l=>(jt.test(l)?(s.color.push(r),i.push(ET),n.push(jt.parse(l))):l.startsWith(rU)?(s.var.push(r),i.push(iU),n.push(l)):(s.number.push(r),i.push(wT),n.push(parseFloat(l))),++r,Dy)).split(Dy);return{values:n,split:o,indexes:s,types:i}}function NT(t){return Bl(t).values}function kT(t){const{split:e,types:n}=Bl(t),s=e.length;return i=>{let r="";for(let a=0;a<s;a++)if(r+=e[a],i[a]!==void 0){const o=n[a];o===wT?r+=el(i[a]):o===ET?r+=jt.transform(i[a]):r+=i[a]}return r}}const oU=t=>typeof t=="number"?0:t;function lU(t){const e=NT(t);return kT(t)(e.map(oU))}const Mi={test:sU,parse:NT,createTransformer:kT,getAnimatableNone:lU},cU=new Set(["brightness","contrast","saturate","opacity"]);function uU(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[s]=n.match(ov)||[];if(!s)return t;const i=n.replace(s,"");let r=cU.has(e)?1:0;return s!==n&&(r*=100),e+"("+r+i+")"}const dU=/\b([a-z-]*)\(.*?\)/gu,xp={...Mi,getAnimatableNone:t=>{const e=t.match(dU);return e?e.map(uU).join(" "):t}},fU={...K0,color:jt,backgroundColor:jt,outlineColor:jt,fill:jt,stroke:jt,borderColor:jt,borderTopColor:jt,borderRightColor:jt,borderBottomColor:jt,borderLeftColor:jt,filter:xp,WebkitFilter:xp},cv=t=>fU[t];function ST(t,e){let n=cv(t);return n!==xp&&(n=Mi),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const hU=new Set(["auto","none","0"]);function mU(t,e,n){let s=0,i;for(;s<t.length&&!i;){const r=t[s];typeof r=="string"&&!hU.has(r)&&Bl(r).values.length&&(i=t[s]),s++}if(i&&n)for(const r of e)t[r]=ST(n,i)}const Ly=t=>t===lo||t===ee,Py=(t,e)=>parseFloat(t.split(", ")[e]),By=(t,e)=>(n,{transform:s})=>{if(s==="none"||!s)return 0;const i=s.match(/^matrix3d\((.+)\)$/u);if(i)return Py(i[1],e);{const r=s.match(/^matrix\((.+)\)$/u);return r?Py(r[1],t):0}},pU=new Set(["x","y","z"]),gU=oo.filter(t=>!pU.has(t));function vU(t){const e=[];return gU.forEach(n=>{const s=t.getValue(n);s!==void 0&&(e.push([n,s.get()]),s.set(n.startsWith("scale")?1:0))}),e}const Ga={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:By(4,13),y:By(5,14)};Ga.translateX=Ga.x;Ga.translateY=Ga.y;const or=new Set;let yp=!1,_p=!1;function TT(){if(_p){const t=Array.from(or).filter(s=>s.needsMeasurement),e=new Set(t.map(s=>s.element)),n=new Map;e.forEach(s=>{const i=vU(s);i.length&&(n.set(s,i),s.render())}),t.forEach(s=>s.measureInitialState()),e.forEach(s=>{s.render();const i=n.get(s);i&&i.forEach(([r,a])=>{var o;(o=s.getValue(r))===null||o===void 0||o.set(a)})}),t.forEach(s=>s.measureEndState()),t.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}_p=!1,yp=!1,or.forEach(t=>t.complete()),or.clear()}function AT(){or.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(_p=!0)})}function bU(){AT(),TT()}class uv{constructor(e,n,s,i,r,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=s,this.motionValue=i,this.element=r,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(or.add(this),yp||(yp=!0,Fe.read(AT),Fe.resolveKeyframes(TT))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:s,motionValue:i}=this;for(let r=0;r<e.length;r++)if(e[r]===null)if(r===0){const a=i==null?void 0:i.get(),o=e[e.length-1];if(a!==void 0)e[0]=a;else if(s&&n){const l=s.readValue(n,o);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=o),i&&a===void 0&&i.set(e[0])}else e[r]=e[r-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),or.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,or.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const RT=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),xU=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function yU(t){const e=xU.exec(t);if(!e)return[,];const[,n,s,i]=e;return[`--${n??s}`,i]}function IT(t,e,n=1){const[s,i]=yU(t);if(!s)return;const r=window.getComputedStyle(e).getPropertyValue(s);if(r){const a=r.trim();return RT(a)?parseFloat(a):a}return $0(i)?IT(i,e,n+1):i}const CT=t=>e=>e.test(t),_U={test:t=>t==="auto",parse:t=>t},jT=[lo,ee,es,Fs,uB,cB,_U],Uy=t=>jT.find(CT(t));class OT extends uv{constructor(e,n,s,i,r){super(e,n,s,i,r,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:s}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let u=e[l];if(typeof u=="string"&&(u=u.trim(),$0(u))){const d=IT(u,n.current);d!==void 0&&(e[l]=d),l===e.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!cT.has(s)||e.length!==2)return;const[i,r]=e,a=Uy(i),o=Uy(r);if(a!==o)if(Ly(a)&&Ly(o))for(let l=0;l<e.length;l++){const u=e[l];typeof u=="string"&&(e[l]=parseFloat(u))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,s=[];for(let i=0;i<e.length;i++)QB(e[i])&&s.push(i);s.length&&mU(e,s,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:s}=this;if(!e||!e.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Ga[s](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const i=n[n.length-1];i!==void 0&&e.getValue(s,i).jump(i,!1)}measureEndState(){var e;const{element:n,name:s,unresolvedKeyframes:i}=this;if(!n||!n.current)return;const r=n.getValue(s);r&&r.jump(this.measuredOrigin,!1);const a=i.length-1,o=i[a];i[a]=Ga[s](n.measureViewportBox(),window.getComputedStyle(n.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,u])=>{n.getValue(l).set(u)}),this.resolveNoneKeyframes()}}const Hy=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Mi.test(t)||t==="0")&&!t.startsWith("url("));function wU(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function EU(t,e,n,s){const i=t[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const r=t[t.length-1],a=Hy(i,e),o=Hy(r,e);return!a||!o?!1:wU(t)||(n==="spring"||Z0(n))&&s}const NU=t=>t!==null;function kf(t,{repeat:e,repeatType:n="loop"},s){const i=t.filter(NU),r=e&&n!=="loop"&&e%2===1?0:i.length-1;return!r||s===void 0?i[r]:s}const kU=40;class MT{constructor({autoplay:e=!0,delay:n=0,type:s="keyframes",repeat:i=0,repeatDelay:r=0,repeatType:a="loop",...o}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=ts.now(),this.options={autoplay:e,delay:n,type:s,repeat:i,repeatDelay:r,repeatType:a,...o},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>kU?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&bU(),this._resolved}onKeyframesResolved(e,n){this.resolvedAt=ts.now(),this.hasAttemptedResolve=!0;const{name:s,type:i,velocity:r,delay:a,onComplete:o,onUpdate:l,isGenerator:u}=this.options;if(!u&&!EU(e,s,i,r))if(a)this.options.duration=0;else{l&&l(kf(e,this.options,n)),o&&o(),this.resolveFinishedPromise();return}const d=this.initPlayback(e,n);d!==!1&&(this._resolved={keyframes:e,finalKeyframe:n,...d},this.onPostResolved())}onPostResolved(){}then(e,n){return this.currentFinishedPromise.then(e,n)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Qe=(t,e,n)=>t+(e-t)*n;function Ah(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function SU({hue:t,saturation:e,lightness:n,alpha:s}){t/=360,e/=100,n/=100;let i=0,r=0,a=0;if(!e)i=r=a=n;else{const o=n<.5?n*(1+e):n+e-n*e,l=2*n-o;i=Ah(l,o,t+1/3),r=Ah(l,o,t),a=Ah(l,o,t-1/3)}return{red:Math.round(i*255),green:Math.round(r*255),blue:Math.round(a*255),alpha:s}}function Nd(t,e){return n=>n>0?e:t}const Rh=(t,e,n)=>{const s=t*t,i=n*(e*e-s)+s;return i<0?0:Math.sqrt(i)},TU=[bp,er,ta],AU=t=>TU.find(e=>e.test(t));function Gy(t){const e=AU(t);if(!e)return!1;let n=e.parse(t);return e===ta&&(n=SU(n)),n}const Vy=(t,e)=>{const n=Gy(t),s=Gy(e);if(!n||!s)return Nd(t,e);const i={...n};return r=>(i.red=Rh(n.red,s.red,r),i.green=Rh(n.green,s.green,r),i.blue=Rh(n.blue,s.blue,r),i.alpha=Qe(n.alpha,s.alpha,r),er.transform(i))},RU=(t,e)=>n=>e(t(n)),gc=(...t)=>t.reduce(RU),wp=new Set(["none","hidden"]);function IU(t,e){return wp.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function CU(t,e){return n=>Qe(t,e,n)}function dv(t){return typeof t=="number"?CU:typeof t=="string"?$0(t)?Nd:jt.test(t)?Vy:MU:Array.isArray(t)?DT:typeof t=="object"?jt.test(t)?Vy:jU:Nd}function DT(t,e){const n=[...t],s=n.length,i=t.map((r,a)=>dv(r)(r,e[a]));return r=>{for(let a=0;a<s;a++)n[a]=i[a](r);return n}}function jU(t,e){const n={...t,...e},s={};for(const i in n)t[i]!==void 0&&e[i]!==void 0&&(s[i]=dv(t[i])(t[i],e[i]));return i=>{for(const r in s)n[r]=s[r](i);return n}}function OU(t,e){var n;const s=[],i={color:0,var:0,number:0};for(let r=0;r<e.values.length;r++){const a=e.types[r],o=t.indexes[a][i[a]],l=(n=t.values[o])!==null&&n!==void 0?n:0;s[r]=l,i[a]++}return s}const MU=(t,e)=>{const n=Mi.createTransformer(e),s=Bl(t),i=Bl(e);return s.indexes.var.length===i.indexes.var.length&&s.indexes.color.length===i.indexes.color.length&&s.indexes.number.length>=i.indexes.number.length?wp.has(t)&&!i.values.length||wp.has(e)&&!s.values.length?IU(t,e):gc(DT(OU(s,i),i.values),n):Nd(t,e)};function LT(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?Qe(t,e,n):dv(t)(t,e)}const DU=5;function PT(t,e,n){const s=Math.max(e-DU,0);return uT(n-t(s),e-s)}const Ze={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Ih=.001;function LU({duration:t=Ze.duration,bounce:e=Ze.bounce,velocity:n=Ze.velocity,mass:s=Ze.mass}){let i,r,a=1-e;a=Ls(Ze.minDamping,Ze.maxDamping,a),t=Ls(Ze.minDuration,Ze.maxDuration,Ss(t)),a<1?(i=u=>{const d=u*a,f=d*t,h=d-n,m=Ep(u,a),v=Math.exp(-f);return Ih-h/m*v},r=u=>{const f=u*a*t,h=f*n+n,m=Math.pow(a,2)*Math.pow(u,2)*t,v=Math.exp(-f),b=Ep(Math.pow(u,2),a);return(-i(u)+Ih>0?-1:1)*((h-m)*v)/b}):(i=u=>{const d=Math.exp(-u*t),f=(u-n)*t+1;return-Ih+d*f},r=u=>{const d=Math.exp(-u*t),f=(n-u)*(t*t);return d*f});const o=5/t,l=BU(i,r,o);if(t=ks(t),isNaN(l))return{stiffness:Ze.stiffness,damping:Ze.damping,duration:t};{const u=Math.pow(l,2)*s;return{stiffness:u,damping:a*2*Math.sqrt(s*u),duration:t}}}const PU=12;function BU(t,e,n){let s=n;for(let i=1;i<PU;i++)s=s-t(s)/e(s);return s}function Ep(t,e){return t*Math.sqrt(1-e*e)}const UU=["duration","bounce"],HU=["stiffness","damping","mass"];function Fy(t,e){return e.some(n=>t[n]!==void 0)}function GU(t){let e={velocity:Ze.velocity,stiffness:Ze.stiffness,damping:Ze.damping,mass:Ze.mass,isResolvedFromDuration:!1,...t};if(!Fy(t,HU)&&Fy(t,UU))if(t.visualDuration){const n=t.visualDuration,s=2*Math.PI/(n*1.2),i=s*s,r=2*Ls(.05,1,1-(t.bounce||0))*Math.sqrt(i);e={...e,mass:Ze.mass,stiffness:i,damping:r}}else{const n=LU(t);e={...e,...n,mass:Ze.mass},e.isResolvedFromDuration=!0}return e}function BT(t=Ze.visualDuration,e=Ze.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:s,restDelta:i}=n;const r=n.keyframes[0],a=n.keyframes[n.keyframes.length-1],o={done:!1,value:r},{stiffness:l,damping:u,mass:d,duration:f,velocity:h,isResolvedFromDuration:m}=GU({...n,velocity:-Ss(n.velocity||0)}),v=h||0,b=u/(2*Math.sqrt(l*d)),y=a-r,p=Ss(Math.sqrt(l/d)),g=Math.abs(y)<5;s||(s=g?Ze.restSpeed.granular:Ze.restSpeed.default),i||(i=g?Ze.restDelta.granular:Ze.restDelta.default);let x;if(b<1){const N=Ep(p,b);x=T=>{const E=Math.exp(-b*p*T);return a-E*((v+b*p*y)/N*Math.sin(N*T)+y*Math.cos(N*T))}}else if(b===1)x=N=>a-Math.exp(-p*N)*(y+(v+p*y)*N);else{const N=p*Math.sqrt(b*b-1);x=T=>{const E=Math.exp(-b*p*T),A=Math.min(N*T,300);return a-E*((v+b*p*y)*Math.sinh(A)+N*y*Math.cosh(A))/N}}const w={calculatedDuration:m&&f||null,next:N=>{const T=x(N);if(m)o.done=N>=f;else{let E=0;b<1&&(E=N===0?ks(v):PT(x,N,T));const A=Math.abs(E)<=s,k=Math.abs(a-T)<=i;o.done=A&&k}return o.value=o.done?a:T,o},toString:()=>{const N=Math.min(nT(w),pp),T=sT(E=>w.next(N*E).value,N,30);return N+"ms "+T}};return w}function zy({keyframes:t,velocity:e=0,power:n=.8,timeConstant:s=325,bounceDamping:i=10,bounceStiffness:r=500,modifyTarget:a,min:o,max:l,restDelta:u=.5,restSpeed:d}){const f=t[0],h={done:!1,value:f},m=A=>o!==void 0&&A<o||l!==void 0&&A>l,v=A=>o===void 0?l:l===void 0||Math.abs(o-A)<Math.abs(l-A)?o:l;let b=n*e;const y=f+b,p=a===void 0?y:a(y);p!==y&&(b=p-f);const g=A=>-b*Math.exp(-A/s),x=A=>p+g(A),w=A=>{const k=g(A),R=x(A);h.done=Math.abs(k)<=u,h.value=h.done?p:R};let N,T;const E=A=>{m(h.value)&&(N=A,T=BT({keyframes:[h.value,v(h.value)],velocity:PT(x,A,h.value),damping:i,stiffness:r,restDelta:u,restSpeed:d}))};return E(0),{calculatedDuration:null,next:A=>{let k=!1;return!T&&N===void 0&&(k=!0,w(A),E(A)),N!==void 0&&A>=N?T.next(A-N):(!k&&w(A),h)}}}const VU=pc(.42,0,1,1),FU=pc(0,0,.58,1),UT=pc(.42,0,.58,1),zU=t=>Array.isArray(t)&&typeof t[0]!="number",$U={linear:cn,easeIn:VU,easeInOut:UT,easeOut:FU,circIn:av,circInOut:xT,circOut:bT,backIn:rv,backInOut:gT,backOut:pT,anticipate:vT},$y=t=>{if(ev(t)){LS(t.length===4);const[e,n,s,i]=t;return pc(e,n,s,i)}else if(typeof t=="string")return $U[t];return t};function KU(t,e,n){const s=[],i=n||LT,r=t.length-1;for(let a=0;a<r;a++){let o=i(t[a],t[a+1]);if(e){const l=Array.isArray(e)?e[a]||cn:e;o=gc(l,o)}s.push(o)}return s}function YU(t,e,{clamp:n=!0,ease:s,mixer:i}={}){const r=t.length;if(LS(r===e.length),r===1)return()=>e[0];if(r===2&&e[0]===e[1])return()=>e[1];const a=t[0]===t[1];t[0]>t[r-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=KU(e,s,i),l=o.length,u=d=>{if(a&&d<t[0])return e[0];let f=0;if(l>1)for(;f<t.length-2&&!(d<t[f+1]);f++);const h=Ua(t[f],t[f+1],d);return o[f](h)};return n?d=>u(Ls(t[0],t[r-1],d)):u}function qU(t,e){const n=t[t.length-1];for(let s=1;s<=e;s++){const i=Ua(0,e,s);t.push(Qe(n,1,i))}}function WU(t){const e=[0];return qU(e,t.length-1),e}function XU(t,e){return t.map(n=>n*e)}function QU(t,e){return t.map(()=>e||UT).splice(0,t.length-1)}function kd({duration:t=300,keyframes:e,times:n,ease:s="easeInOut"}){const i=zU(s)?s.map($y):$y(s),r={done:!1,value:e[0]},a=XU(n&&n.length===e.length?n:WU(e),t),o=YU(a,e,{ease:Array.isArray(i)?i:QU(e,i)});return{calculatedDuration:t,next:l=>(r.value=o(l),r.done=l>=t,r)}}const JU=t=>{const e=({timestamp:n})=>t(n);return{start:()=>Fe.update(e,!0),stop:()=>Oi(e),now:()=>Nt.isProcessing?Nt.timestamp:ts.now()}},ZU={decay:zy,inertia:zy,tween:kd,keyframes:kd,spring:BT},e8=t=>t/100;class fv extends MT{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:n,motionValue:s,element:i,keyframes:r}=this.options,a=(i==null?void 0:i.KeyframeResolver)||uv,o=(l,u)=>this.onKeyframesResolved(l,u);this.resolver=new a(r,o,n,s,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:n="keyframes",repeat:s=0,repeatDelay:i=0,repeatType:r,velocity:a=0}=this.options,o=Z0(n)?n:ZU[n]||kd;let l,u;o!==kd&&typeof e[0]!="number"&&(l=gc(e8,LT(e[0],e[1])),e=[0,100]);const d=o({...this.options,keyframes:e});r==="mirror"&&(u=o({...this.options,keyframes:[...e].reverse(),velocity:-a})),d.calculatedDuration===null&&(d.calculatedDuration=nT(d));const{calculatedDuration:f}=d,h=f+i,m=h*(s+1)-i;return{generator:d,mirroredGenerator:u,mapPercentToKeyframes:l,calculatedDuration:f,resolvedDuration:h,totalDuration:m}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,n=!1){const{resolved:s}=this;if(!s){const{keyframes:A}=this.options;return{done:!0,value:A[A.length-1]}}const{finalKeyframe:i,generator:r,mirroredGenerator:a,mapPercentToKeyframes:o,keyframes:l,calculatedDuration:u,totalDuration:d,resolvedDuration:f}=s;if(this.startTime===null)return r.next(0);const{delay:h,repeat:m,repeatType:v,repeatDelay:b,onUpdate:y}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-d/this.speed,this.startTime)),n?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const p=this.currentTime-h*(this.speed>=0?1:-1),g=this.speed>=0?p<0:p>d;this.currentTime=Math.max(p,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=d);let x=this.currentTime,w=r;if(m){const A=Math.min(this.currentTime,d)/f;let k=Math.floor(A),R=A%1;!R&&A>=1&&(R=1),R===1&&k--,k=Math.min(k,m+1),!!(k%2)&&(v==="reverse"?(R=1-R,b&&(R-=b/f)):v==="mirror"&&(w=a)),x=Ls(0,1,R)*f}const N=g?{done:!1,value:l[0]}:w.next(x);o&&(N.value=o(N.value));let{done:T}=N;!g&&u!==null&&(T=this.speed>=0?this.currentTime>=d:this.currentTime<=0);const E=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&T);return E&&i!==void 0&&(N.value=kf(l,this.options,i)),y&&y(N.value),E&&this.finish(),N}get duration(){const{resolved:e}=this;return e?Ss(e.calculatedDuration):0}get time(){return Ss(this.currentTime)}set time(e){e=ks(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=Ss(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=JU,onPlay:n,startTime:s}=this.options;this.driver||(this.driver=e(r=>this.tick(r))),n&&n();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=s??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const t8=new Set(["opacity","clipPath","filter","transform"]);function n8(t,e,n,{delay:s=0,duration:i=300,repeat:r=0,repeatType:a="loop",ease:o="easeInOut",times:l}={}){const u={[e]:n};l&&(u.offset=l);const d=rT(o,i);return Array.isArray(d)&&(u.easing=d),t.animate(u,{delay:s,duration:i,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:r+1,direction:a==="reverse"?"alternate":"normal"})}const s8=B0(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Sd=10,i8=2e4;function r8(t){return Z0(t.type)||t.type==="spring"||!iT(t.ease)}function a8(t,e){const n=new fv({...e,keyframes:t,repeat:0,delay:0,isGenerator:!0});let s={done:!1,value:t[0]};const i=[];let r=0;for(;!s.done&&r<i8;)s=n.sample(r),i.push(s.value),r+=Sd;return{times:void 0,keyframes:i,duration:r-Sd,ease:"linear"}}const HT={anticipate:vT,backInOut:gT,circInOut:xT};function o8(t){return t in HT}class Ky extends MT{constructor(e){super(e);const{name:n,motionValue:s,element:i,keyframes:r}=this.options;this.resolver=new OT(r,(a,o)=>this.onKeyframesResolved(a,o),n,s,i),this.resolver.scheduleResolve()}initPlayback(e,n){let{duration:s=300,times:i,ease:r,type:a,motionValue:o,name:l,startTime:u}=this.options;if(!o.owner||!o.owner.current)return!1;if(typeof r=="string"&&Ed()&&o8(r)&&(r=HT[r]),r8(this.options)){const{onComplete:f,onUpdate:h,motionValue:m,element:v,...b}=this.options,y=a8(e,b);e=y.keyframes,e.length===1&&(e[1]=e[0]),s=y.duration,i=y.times,r=y.ease,a="keyframes"}const d=n8(o.owner.current,l,e,{...this.options,duration:s,times:i,ease:r});return d.startTime=u??this.calcStartTime(),this.pendingTimeline?(Iy(d,this.pendingTimeline),this.pendingTimeline=void 0):d.onfinish=()=>{const{onComplete:f}=this.options;o.set(kf(e,this.options,n)),f&&f(),this.cancel(),this.resolveFinishedPromise()},{animation:d,duration:s,times:i,type:a,ease:r,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:n}=e;return Ss(n)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:n}=e;return Ss(n.currentTime||0)}set time(e){const{resolved:n}=this;if(!n)return;const{animation:s}=n;s.currentTime=ks(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:n}=e;return n.playbackRate}set speed(e){const{resolved:n}=this;if(!n)return;const{animation:s}=n;s.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:n}=e;return n.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:n}=e;return n.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:n}=this;if(!n)return cn;const{animation:s}=n;Iy(s,e)}return cn}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.playState==="finished"&&this.updateFinishedPromise(),n.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:n,keyframes:s,duration:i,type:r,ease:a,times:o}=e;if(n.playState==="idle"||n.playState==="finished")return;if(this.time){const{motionValue:u,onUpdate:d,onComplete:f,element:h,...m}=this.options,v=new fv({...m,keyframes:s,duration:i,type:r,ease:a,times:o,isGenerator:!0}),b=ks(this.time);u.setWithVelocity(v.sample(b-Sd).value,v.sample(b).value,Sd)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:n,name:s,repeatDelay:i,repeatType:r,damping:a,type:o}=e;if(!n||!n.owner||!(n.owner.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:u}=n.owner.getProps();return s8()&&s&&t8.has(s)&&!l&&!u&&!i&&r!=="mirror"&&a!==0&&o!=="inertia"}}const l8={type:"spring",stiffness:500,damping:25,restSpeed:10},c8=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),u8={type:"keyframes",duration:.8},d8={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},f8=(t,{keyframes:e})=>e.length>2?u8:Cr.has(t)?t.startsWith("scale")?c8(e[1]):l8:d8;function h8({when:t,delay:e,delayChildren:n,staggerChildren:s,staggerDirection:i,repeat:r,repeatType:a,repeatDelay:o,from:l,elapsed:u,...d}){return!!Object.keys(d).length}const hv=(t,e,n,s={},i,r)=>a=>{const o=J0(s,t)||{},l=o.delay||s.delay||0;let{elapsed:u=0}=s;u=u-ks(l);let d={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...o,delay:-u,onUpdate:h=>{e.set(h),o.onUpdate&&o.onUpdate(h)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:t,motionValue:e,element:r?void 0:i};h8(o)||(d={...d,...f8(t,d)}),d.duration&&(d.duration=ks(d.duration)),d.repeatDelay&&(d.repeatDelay=ks(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let f=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(d.duration=0,d.delay===0&&(f=!0)),f&&!r&&e.get()!==void 0){const h=kf(d.keyframes,o);if(h!==void 0)return Fe.update(()=>{d.onUpdate(h),d.onComplete()}),new jB([])}return!r&&Ky.supports(d)?new Ky(d):new fv(d)};function m8({protectedKeys:t,needsAnimating:e},n){const s=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,s}function GT(t,e,{delay:n=0,transitionOverride:s,type:i}={}){var r;let{transition:a=t.getDefaultTransition(),transitionEnd:o,...l}=e;s&&(a=s);const u=[],d=i&&t.animationState&&t.animationState.getState()[i];for(const f in l){const h=t.getValue(f,(r=t.latestValues[f])!==null&&r!==void 0?r:null),m=l[f];if(m===void 0||d&&m8(d,f))continue;const v={delay:n,...J0(a||{},f)};let b=!1;if(window.MotionHandoffAnimation){const p=dT(t);if(p){const g=window.MotionHandoffAnimation(p,f,Fe);g!==null&&(v.startTime=g,b=!0)}}vp(t,f),h.start(hv(f,h,m,t.shouldReduceMotion&&cT.has(f)?{type:!1}:v,t,b));const y=h.animation;y&&u.push(y)}return o&&Promise.all(u).then(()=>{Fe.update(()=>{o&&KB(t,o)})}),u}function Np(t,e,n={}){var s;const i=Nf(t,e,n.type==="exit"?(s=t.presenceContext)===null||s===void 0?void 0:s.custom:void 0);let{transition:r=t.getDefaultTransition()||{}}=i||{};n.transitionOverride&&(r=n.transitionOverride);const a=i?()=>Promise.all(GT(t,i,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(u=0)=>{const{delayChildren:d=0,staggerChildren:f,staggerDirection:h}=r;return p8(t,e,d+u,f,h,n)}:()=>Promise.resolve(),{when:l}=r;if(l){const[u,d]=l==="beforeChildren"?[a,o]:[o,a];return u().then(()=>d())}else return Promise.all([a(),o(n.delay)])}function p8(t,e,n=0,s=0,i=1,r){const a=[],o=(t.variantChildren.size-1)*s,l=i===1?(u=0)=>u*s:(u=0)=>o-u*s;return Array.from(t.variantChildren).sort(g8).forEach((u,d)=>{u.notify("AnimationStart",e),a.push(Np(u,e,{...r,delay:n+l(d)}).then(()=>u.notify("AnimationComplete",e)))}),Promise.all(a)}function g8(t,e){return t.sortNodePosition(e)}function v8(t,e,n={}){t.notify("AnimationStart",e);let s;if(Array.isArray(e)){const i=e.map(r=>Np(t,r,n));s=Promise.all(i)}else if(typeof e=="string")s=Np(t,e,n);else{const i=typeof e=="function"?Nf(t,e,n.custom):e;s=Promise.all(GT(t,i,n))}return s.then(()=>{t.notify("AnimationComplete",e)})}const b8=H0.length;function VT(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?VT(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<b8;n++){const s=H0[n],i=t.props[s];(Dl(i)||i===!1)&&(e[s]=i)}return e}const x8=[...U0].reverse(),y8=U0.length;function _8(t){return e=>Promise.all(e.map(({animation:n,options:s})=>v8(t,n,s)))}function w8(t){let e=_8(t),n=Yy(),s=!0;const i=l=>(u,d)=>{var f;const h=Nf(t,d,l==="exit"?(f=t.presenceContext)===null||f===void 0?void 0:f.custom:void 0);if(h){const{transition:m,transitionEnd:v,...b}=h;u={...u,...b,...v}}return u};function r(l){e=l(t)}function a(l){const{props:u}=t,d=VT(t.parent)||{},f=[],h=new Set;let m={},v=1/0;for(let y=0;y<y8;y++){const p=x8[y],g=n[p],x=u[p]!==void 0?u[p]:d[p],w=Dl(x),N=p===l?g.isActive:null;N===!1&&(v=y);let T=x===d[p]&&x!==u[p]&&w;if(T&&s&&t.manuallyAnimateOnMount&&(T=!1),g.protectedKeys={...m},!g.isActive&&N===null||!x&&!g.prevProp||wf(x)||typeof x=="boolean")continue;const E=E8(g.prevProp,x);let A=E||p===l&&g.isActive&&!T&&w||y>v&&w,k=!1;const R=Array.isArray(x)?x:[x];let I=R.reduce(i(p),{});N===!1&&(I={});const{prevResolvedValues:P={}}=g,V={...P,...I},$=j=>{A=!0,h.has(j)&&(k=!0,h.delete(j)),g.needsAnimating[j]=!0;const O=t.getValue(j);O&&(O.liveStyle=!1)};for(const j in V){const O=I[j],C=P[j];if(m.hasOwnProperty(j))continue;let F=!1;mp(O)&&mp(C)?F=!tT(O,C):F=O!==C,F?O!=null?$(j):h.add(j):O!==void 0&&h.has(j)?$(j):g.protectedKeys[j]=!0}g.prevProp=x,g.prevResolvedValues=I,g.isActive&&(m={...m,...I}),s&&t.blockInitialAnimation&&(A=!1),A&&(!(T&&E)||k)&&f.push(...R.map(j=>({animation:j,options:{type:p}})))}if(h.size){const y={};h.forEach(p=>{const g=t.getBaseTarget(p),x=t.getValue(p);x&&(x.liveStyle=!0),y[p]=g??null}),f.push({animation:y})}let b=!!f.length;return s&&(u.initial===!1||u.initial===u.animate)&&!t.manuallyAnimateOnMount&&(b=!1),s=!1,b?e(f):Promise.resolve()}function o(l,u){var d;if(n[l].isActive===u)return Promise.resolve();(d=t.variantChildren)===null||d===void 0||d.forEach(h=>{var m;return(m=h.animationState)===null||m===void 0?void 0:m.setActive(l,u)}),n[l].isActive=u;const f=a(l);for(const h in n)n[h].protectedKeys={};return f}return{animateChanges:a,setActive:o,setAnimateFunction:r,getState:()=>n,reset:()=>{n=Yy(),s=!0}}}function E8(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!tT(e,t):!1}function Fi(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Yy(){return{animate:Fi(!0),whileInView:Fi(),whileHover:Fi(),whileTap:Fi(),whileDrag:Fi(),whileFocus:Fi(),exit:Fi()}}class Ui{constructor(e){this.isMounted=!1,this.node=e}update(){}}class N8 extends Ui{constructor(e){super(e),e.animationState||(e.animationState=w8(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();wf(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let k8=0;class S8 extends Ui{constructor(){super(...arguments),this.id=k8++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===s)return;const i=this.node.animationState.setActive("exit",!e);n&&!e&&i.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const T8={animation:{Feature:N8},exit:{Feature:S8}};function Ul(t,e,n,s={passive:!0}){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n)}function vc(t){return{point:{x:t.pageX,y:t.pageY}}}const A8=t=>e=>tv(e)&&t(e,vc(e));function tl(t,e,n,s){return Ul(t,e,A8(n),s)}const qy=(t,e)=>Math.abs(t-e);function R8(t,e){const n=qy(t.x,e.x),s=qy(t.y,e.y);return Math.sqrt(n**2+s**2)}class FT{constructor(e,n,{transformPagePoint:s,contextWindow:i,dragSnapToOrigin:r=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=jh(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,m=R8(f.offset,{x:0,y:0})>=3;if(!h&&!m)return;const{point:v}=f,{timestamp:b}=Nt;this.history.push({...v,timestamp:b});const{onStart:y,onMove:p}=this.handlers;h||(y&&y(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),p&&p(this.lastMoveEvent,f)},this.handlePointerMove=(f,h)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=Ch(h,this.transformPagePoint),Fe.update(this.updatePoint,!0)},this.handlePointerUp=(f,h)=>{this.end();const{onEnd:m,onSessionEnd:v,resumeAnimation:b}=this.handlers;if(this.dragSnapToOrigin&&b&&b(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const y=jh(f.type==="pointercancel"?this.lastMoveEventInfo:Ch(h,this.transformPagePoint),this.history);this.startEvent&&m&&m(f,y),v&&v(f,y)},!tv(e))return;this.dragSnapToOrigin=r,this.handlers=n,this.transformPagePoint=s,this.contextWindow=i||window;const a=vc(e),o=Ch(a,this.transformPagePoint),{point:l}=o,{timestamp:u}=Nt;this.history=[{...l,timestamp:u}];const{onSessionStart:d}=n;d&&d(e,jh(o,this.history)),this.removeListeners=gc(tl(this.contextWindow,"pointermove",this.handlePointerMove),tl(this.contextWindow,"pointerup",this.handlePointerUp),tl(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Oi(this.updatePoint)}}function Ch(t,e){return e?{point:e(t.point)}:t}function Wy(t,e){return{x:t.x-e.x,y:t.y-e.y}}function jh({point:t},e){return{point:t,delta:Wy(t,zT(e)),offset:Wy(t,I8(e)),velocity:C8(e,.1)}}function I8(t){return t[0]}function zT(t){return t[t.length-1]}function C8(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,s=null;const i=zT(t);for(;n>=0&&(s=t[n],!(i.timestamp-s.timestamp>ks(e)));)n--;if(!s)return{x:0,y:0};const r=Ss(i.timestamp-s.timestamp);if(r===0)return{x:0,y:0};const a={x:(i.x-s.x)/r,y:(i.y-s.y)/r};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}const $T=1e-4,j8=1-$T,O8=1+$T,KT=.01,M8=0-KT,D8=0+KT;function mn(t){return t.max-t.min}function L8(t,e,n){return Math.abs(t-e)<=n}function Xy(t,e,n,s=.5){t.origin=s,t.originPoint=Qe(e.min,e.max,t.origin),t.scale=mn(n)/mn(e),t.translate=Qe(n.min,n.max,t.origin)-t.originPoint,(t.scale>=j8&&t.scale<=O8||isNaN(t.scale))&&(t.scale=1),(t.translate>=M8&&t.translate<=D8||isNaN(t.translate))&&(t.translate=0)}function nl(t,e,n,s){Xy(t.x,e.x,n.x,s?s.originX:void 0),Xy(t.y,e.y,n.y,s?s.originY:void 0)}function Qy(t,e,n){t.min=n.min+e.min,t.max=t.min+mn(e)}function P8(t,e,n){Qy(t.x,e.x,n.x),Qy(t.y,e.y,n.y)}function Jy(t,e,n){t.min=e.min-n.min,t.max=t.min+mn(e)}function sl(t,e,n){Jy(t.x,e.x,n.x),Jy(t.y,e.y,n.y)}function B8(t,{min:e,max:n},s){return e!==void 0&&t<e?t=s?Qe(e,t,s.min):Math.max(t,e):n!==void 0&&t>n&&(t=s?Qe(n,t,s.max):Math.min(t,n)),t}function Zy(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function U8(t,{top:e,left:n,bottom:s,right:i}){return{x:Zy(t.x,n,i),y:Zy(t.y,e,s)}}function e_(t,e){let n=e.min-t.min,s=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,s]=[s,n]),{min:n,max:s}}function H8(t,e){return{x:e_(t.x,e.x),y:e_(t.y,e.y)}}function G8(t,e){let n=.5;const s=mn(t),i=mn(e);return i>s?n=Ua(e.min,e.max-s,t.min):s>i&&(n=Ua(t.min,t.max-i,e.min)),Ls(0,1,n)}function V8(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const kp=.35;function F8(t=kp){return t===!1?t=0:t===!0&&(t=kp),{x:t_(t,"left","right"),y:t_(t,"top","bottom")}}function t_(t,e,n){return{min:n_(t,e),max:n_(t,n)}}function n_(t,e){return typeof t=="number"?t:t[e]||0}const s_=()=>({translate:0,scale:1,origin:0,originPoint:0}),na=()=>({x:s_(),y:s_()}),i_=()=>({min:0,max:0}),st=()=>({x:i_(),y:i_()});function vn(t){return[t("x"),t("y")]}function YT({top:t,left:e,right:n,bottom:s}){return{x:{min:e,max:n},y:{min:t,max:s}}}function z8({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function $8(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),s=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:s.y,right:s.x}}function Oh(t){return t===void 0||t===1}function Sp({scale:t,scaleX:e,scaleY:n}){return!Oh(t)||!Oh(e)||!Oh(n)}function Xi(t){return Sp(t)||qT(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function qT(t){return r_(t.x)||r_(t.y)}function r_(t){return t&&t!=="0%"}function Td(t,e,n){const s=t-n,i=e*s;return n+i}function a_(t,e,n,s,i){return i!==void 0&&(t=Td(t,i,s)),Td(t,n,s)+e}function Tp(t,e=0,n=1,s,i){t.min=a_(t.min,e,n,s,i),t.max=a_(t.max,e,n,s,i)}function WT(t,{x:e,y:n}){Tp(t.x,e.translate,e.scale,e.originPoint),Tp(t.y,n.translate,n.scale,n.originPoint)}const o_=.999999999999,l_=1.0000000000001;function K8(t,e,n,s=!1){const i=n.length;if(!i)return;e.x=e.y=1;let r,a;for(let o=0;o<i;o++){r=n[o],a=r.projectionDelta;const{visualElement:l}=r.options;l&&l.props.style&&l.props.style.display==="contents"||(s&&r.options.layoutScroll&&r.scroll&&r!==r.root&&ia(t,{x:-r.scroll.offset.x,y:-r.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,WT(t,a)),s&&Xi(r.latestValues)&&ia(t,r.latestValues))}e.x<l_&&e.x>o_&&(e.x=1),e.y<l_&&e.y>o_&&(e.y=1)}function sa(t,e){t.min=t.min+e,t.max=t.max+e}function c_(t,e,n,s,i=.5){const r=Qe(t.min,t.max,i);Tp(t,e,n,r,s)}function ia(t,e){c_(t.x,e.x,e.scaleX,e.scale,e.originX),c_(t.y,e.y,e.scaleY,e.scale,e.originY)}function XT(t,e){return YT($8(t.getBoundingClientRect(),e))}function Y8(t,e,n){const s=XT(t,n),{scroll:i}=e;return i&&(sa(s.x,i.offset.x),sa(s.y,i.offset.y)),s}const QT=({current:t})=>t?t.ownerDocument.defaultView:null,q8=new WeakMap;class W8{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=st(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const i=d=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(vc(d).point)},r=(d,f)=>{const{drag:h,dragPropagation:m,onDragStart:v}=this.getProps();if(h&&!m&&(this.openDragLock&&this.openDragLock(),this.openDragLock=GB(h),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),vn(y=>{let p=this.getAxisMotionValue(y).get()||0;if(es.test(p)){const{projection:g}=this.visualElement;if(g&&g.layout){const x=g.layout.layoutBox[y];x&&(p=mn(x)*(parseFloat(p)/100))}}this.originPoint[y]=p}),v&&Fe.postRender(()=>v(d,f)),vp(this.visualElement,"transform");const{animationState:b}=this.visualElement;b&&b.setActive("whileDrag",!0)},a=(d,f)=>{const{dragPropagation:h,dragDirectionLock:m,onDirectionLock:v,onDrag:b}=this.getProps();if(!h&&!this.openDragLock)return;const{offset:y}=f;if(m&&this.currentDirection===null){this.currentDirection=X8(y),this.currentDirection!==null&&v&&v(this.currentDirection);return}this.updateAxis("x",f.point,y),this.updateAxis("y",f.point,y),this.visualElement.render(),b&&b(d,f)},o=(d,f)=>this.stop(d,f),l=()=>vn(d=>{var f;return this.getAnimationState(d)==="paused"&&((f=this.getAxisMotionValue(d).animation)===null||f===void 0?void 0:f.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new FT(e,{onSessionStart:i,onStart:r,onMove:a,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:QT(this.visualElement)})}stop(e,n){const s=this.isDragging;if(this.cancel(),!s)return;const{velocity:i}=n;this.startAnimation(i);const{onDragEnd:r}=this.getProps();r&&Fe.postRender(()=>r(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,s){const{drag:i}=this.getProps();if(!s||!Kc(e,i,this.currentDirection))return;const r=this.getAxisMotionValue(e);let a=this.originPoint[e]+s[e];this.constraints&&this.constraints[e]&&(a=B8(a,this.constraints[e],this.elastic[e])),r.set(a)}resolveConstraints(){var e;const{dragConstraints:n,dragElastic:s}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,r=this.constraints;n&&ea(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&i?this.constraints=U8(i.layoutBox,n):this.constraints=!1,this.elastic=F8(s),r!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&vn(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=V8(i.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!ea(e))return!1;const s=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const r=Y8(s,i.root,this.visualElement.getTransformPagePoint());let a=H8(i.layout.layoutBox,r);if(n){const o=n(z8(a));this.hasMutatedConstraints=!!o,o&&(a=YT(o))}return a}startAnimation(e){const{drag:n,dragMomentum:s,dragElastic:i,dragTransition:r,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},u=vn(d=>{if(!Kc(d,n,this.currentDirection))return;let f=l&&l[d]||{};a&&(f={min:0,max:0});const h=i?200:1e6,m=i?40:1e7,v={type:"inertia",velocity:s?e[d]:0,bounceStiffness:h,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...r,...f};return this.startAxisValueAnimation(d,v)});return Promise.all(u).then(o)}startAxisValueAnimation(e,n){const s=this.getAxisMotionValue(e);return vp(this.visualElement,e),s.start(hv(e,s,0,n,this.visualElement,!1))}stopAnimation(){vn(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){vn(e=>{var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,s=this.visualElement.getProps(),i=s[n];return i||this.visualElement.getValue(e,(s.initial?s.initial[e]:void 0)||0)}snapToCursor(e){vn(n=>{const{drag:s}=this.getProps();if(!Kc(n,s,this.currentDirection))return;const{projection:i}=this.visualElement,r=this.getAxisMotionValue(n);if(i&&i.layout){const{min:a,max:o}=i.layout.layoutBox[n];r.set(e[n]-Qe(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:s}=this.visualElement;if(!ea(n)||!s||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};vn(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const l=o.get();i[a]=G8({min:l,max:l},this.constraints[a])}});const{transformTemplate:r}=this.visualElement.getProps();this.visualElement.current.style.transform=r?r({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),vn(a=>{if(!Kc(a,e,null))return;const o=this.getAxisMotionValue(a),{min:l,max:u}=this.constraints[a];o.set(Qe(l,u,i[a]))})}addListeners(){if(!this.visualElement.current)return;q8.set(this.visualElement,this);const e=this.visualElement.current,n=tl(e,"pointerdown",l=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(l)}),s=()=>{const{dragConstraints:l}=this.getProps();ea(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,r=i.addEventListener("measure",s);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),Fe.read(s);const a=Ul(window,"resize",()=>this.scalePositionWithinConstraints()),o=i.addEventListener("didUpdate",({delta:l,hasLayoutChanged:u})=>{this.isDragging&&u&&(vn(d=>{const f=this.getAxisMotionValue(d);f&&(this.originPoint[d]+=l[d].translate,f.set(f.get()+l[d].translate))}),this.visualElement.render())});return()=>{a(),n(),r(),o&&o()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:s=!1,dragPropagation:i=!1,dragConstraints:r=!1,dragElastic:a=kp,dragMomentum:o=!0}=e;return{...e,drag:n,dragDirectionLock:s,dragPropagation:i,dragConstraints:r,dragElastic:a,dragMomentum:o}}}function Kc(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function X8(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class Q8 extends Ui{constructor(e){super(e),this.removeGroupControls=cn,this.removeListeners=cn,this.controls=new W8(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||cn}unmount(){this.removeGroupControls(),this.removeListeners()}}const u_=t=>(e,n)=>{t&&Fe.postRender(()=>t(e,n))};class J8 extends Ui{constructor(){super(...arguments),this.removePointerDownListener=cn}onPointerDown(e){this.session=new FT(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:QT(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:s,onPanEnd:i}=this.node.getProps();return{onSessionStart:u_(e),onStart:u_(n),onMove:s,onEnd:(r,a)=>{delete this.session,i&&Fe.postRender(()=>i(r,a))}}}mount(){this.removePointerDownListener=tl(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const vu={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function d_(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const _o={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(ee.test(t))t=parseFloat(t);else return t;const n=d_(t,e.target.x),s=d_(t,e.target.y);return`${n}% ${s}%`}},Z8={correct:(t,{treeScale:e,projectionDelta:n})=>{const s=t,i=Mi.parse(t);if(i.length>5)return s;const r=Mi.createTransformer(t),a=typeof i[0]!="number"?1:0,o=n.x.scale*e.x,l=n.y.scale*e.y;i[0+a]/=o,i[1+a]/=l;const u=Qe(o,l,.5);return typeof i[2+a]=="number"&&(i[2+a]/=u),typeof i[3+a]=="number"&&(i[3+a]/=u),r(i)}};class eH extends _.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:s,layoutId:i}=this.props,{projection:r}=e;yB(tH),r&&(n.group&&n.group.add(r),s&&s.register&&i&&s.register(r),r.root.didUpdate(),r.addEventListener("animationComplete",()=>{this.safeToRemove()}),r.setOptions({...r.options,onExitComplete:()=>this.safeToRemove()})),vu.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:s,drag:i,isPresent:r}=this.props,a=s.projection;return a&&(a.isPresent=r,i||e.layoutDependency!==n||n===void 0?a.willUpdate():this.safeToRemove(),e.isPresent!==r&&(r?a.promote():a.relegate()||Fe.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),V0.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:s}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(i),s&&s.deregister&&s.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function JT(t){const[e,n]=MS(),s=_.useContext(M0);return c.jsx(eH,{...t,layoutGroup:s,switchLayoutGroup:_.useContext(VS),isPresent:e,safeToRemove:n})}const tH={borderRadius:{..._o,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:_o,borderTopRightRadius:_o,borderBottomLeftRadius:_o,borderBottomRightRadius:_o,boxShadow:Z8};function nH(t,e,n){const s=Ot(t)?t:Pl(t);return s.start(hv("",s,e,n)),s.animation}function sH(t){return t instanceof SVGElement&&t.tagName!=="svg"}const iH=(t,e)=>t.depth-e.depth;class rH{constructor(){this.children=[],this.isDirty=!1}add(e){nv(this.children,e),this.isDirty=!0}remove(e){sv(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(iH),this.isDirty=!1,this.children.forEach(e)}}function aH(t,e){const n=ts.now(),s=({timestamp:i})=>{const r=i-n;r>=e&&(Oi(s),t(r-e))};return Fe.read(s,!0),()=>Oi(s)}const ZT=["TopLeft","TopRight","BottomLeft","BottomRight"],oH=ZT.length,f_=t=>typeof t=="string"?parseFloat(t):t,h_=t=>typeof t=="number"||ee.test(t);function lH(t,e,n,s,i,r){i?(t.opacity=Qe(0,n.opacity!==void 0?n.opacity:1,cH(s)),t.opacityExit=Qe(e.opacity!==void 0?e.opacity:1,0,uH(s))):r&&(t.opacity=Qe(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,s));for(let a=0;a<oH;a++){const o=`border${ZT[a]}Radius`;let l=m_(e,o),u=m_(n,o);if(l===void 0&&u===void 0)continue;l||(l=0),u||(u=0),l===0||u===0||h_(l)===h_(u)?(t[o]=Math.max(Qe(f_(l),f_(u),s),0),(es.test(u)||es.test(l))&&(t[o]+="%")):t[o]=u}(e.rotate||n.rotate)&&(t.rotate=Qe(e.rotate||0,n.rotate||0,s))}function m_(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const cH=eA(0,.5,bT),uH=eA(.5,.95,cn);function eA(t,e,n){return s=>s<t?0:s>e?1:n(Ua(t,e,s))}function p_(t,e){t.min=e.min,t.max=e.max}function gn(t,e){p_(t.x,e.x),p_(t.y,e.y)}function g_(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function v_(t,e,n,s,i){return t-=e,t=Td(t,1/n,s),i!==void 0&&(t=Td(t,1/i,s)),t}function dH(t,e=0,n=1,s=.5,i,r=t,a=t){if(es.test(e)&&(e=parseFloat(e),e=Qe(a.min,a.max,e/100)-a.min),typeof e!="number")return;let o=Qe(r.min,r.max,s);t===r&&(o-=e),t.min=v_(t.min,e,n,o,i),t.max=v_(t.max,e,n,o,i)}function b_(t,e,[n,s,i],r,a){dH(t,e[n],e[s],e[i],e.scale,r,a)}const fH=["x","scaleX","originX"],hH=["y","scaleY","originY"];function x_(t,e,n,s){b_(t.x,e,fH,n?n.x:void 0,s?s.x:void 0),b_(t.y,e,hH,n?n.y:void 0,s?s.y:void 0)}function y_(t){return t.translate===0&&t.scale===1}function tA(t){return y_(t.x)&&y_(t.y)}function __(t,e){return t.min===e.min&&t.max===e.max}function mH(t,e){return __(t.x,e.x)&&__(t.y,e.y)}function w_(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function nA(t,e){return w_(t.x,e.x)&&w_(t.y,e.y)}function E_(t){return mn(t.x)/mn(t.y)}function N_(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class pH{constructor(){this.members=[]}add(e){nv(this.members,e),e.scheduleRender()}remove(e){if(sv(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(i=>e===i);if(n===0)return!1;let s;for(let i=n;i>=0;i--){const r=this.members[i];if(r.isPresent!==!1){s=r;break}}return s?(this.promote(s),!0):!1}promote(e,n){const s=this.lead;if(e!==s&&(this.prevLead=s,this.lead=e,e.show(),s)){s.instance&&s.scheduleRender(),e.scheduleRender(),e.resumeFrom=s,n&&(e.resumeFrom.preserveOpacity=!0),s.snapshot&&(e.snapshot=s.snapshot,e.snapshot.latestValues=s.animationValues||s.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:s}=e;n.onExitComplete&&n.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function gH(t,e,n){let s="";const i=t.x.translate/e.x,r=t.y.translate/e.y,a=(n==null?void 0:n.z)||0;if((i||r||a)&&(s=`translate3d(${i}px, ${r}px, ${a}px) `),(e.x!==1||e.y!==1)&&(s+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:u,rotate:d,rotateX:f,rotateY:h,skewX:m,skewY:v}=n;u&&(s=`perspective(${u}px) ${s}`),d&&(s+=`rotate(${d}deg) `),f&&(s+=`rotateX(${f}deg) `),h&&(s+=`rotateY(${h}deg) `),m&&(s+=`skewX(${m}deg) `),v&&(s+=`skewY(${v}deg) `)}const o=t.x.scale*e.x,l=t.y.scale*e.y;return(o!==1||l!==1)&&(s+=`scale(${o}, ${l})`),s||"none"}const Qi={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},jo=typeof window<"u"&&window.MotionDebug!==void 0,Mh=["","X","Y","Z"],vH={visibility:"hidden"},k_=1e3;let bH=0;function Dh(t,e,n,s){const{latestValues:i}=e;i[t]&&(n[t]=i[t],e.setStaticValue(t,0),s&&(s[t]=0))}function sA(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=dT(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:i,layoutId:r}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",Fe,!(i||r))}const{parent:s}=t;s&&!s.hasCheckedOptimisedAppear&&sA(s)}function iA({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:s,resetTransform:i}){return class{constructor(a={},o=e==null?void 0:e()){this.id=bH++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,jo&&(Qi.totalNodes=Qi.resolvedTargetDeltas=Qi.recalculatedProjection=0),this.nodes.forEach(_H),this.nodes.forEach(SH),this.nodes.forEach(TH),this.nodes.forEach(wH),jo&&window.MotionDebug.record(Qi)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new rH)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new iv),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,o=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=sH(a),this.instance=a;const{layoutId:l,layout:u,visualElement:d}=this.options;if(d&&!d.current&&d.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),o&&(u||l)&&(this.isLayoutDirty=!0),t){let f;const h=()=>this.root.updateBlockedByResize=!1;t(a,()=>{this.root.updateBlockedByResize=!0,f&&f(),f=aH(h,250),vu.hasAnimatedSinceResize&&(vu.hasAnimatedSinceResize=!1,this.nodes.forEach(T_))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&d&&(l||u)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:h,hasRelativeTargetChanged:m,layout:v})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const b=this.options.transition||d.getDefaultTransition()||jH,{onLayoutAnimationStart:y,onLayoutAnimationComplete:p}=d.getProps(),g=!this.targetLayout||!nA(this.targetLayout,v)||m,x=!h&&m;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||x||h&&(g||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(f,x);const w={...J0(b,"layout"),onPlay:y,onComplete:p};(d.shouldReduceMotion||this.options.layoutRoot)&&(w.delay=0,w.type=!1),this.startAnimation(w)}else h||T_(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=v})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Oi(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(AH),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&sA(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const f=this.path[d];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(S_);return}this.isUpdating||this.nodes.forEach(NH),this.isUpdating=!1,this.nodes.forEach(kH),this.nodes.forEach(xH),this.nodes.forEach(yH),this.clearAllSnapshots();const o=ts.now();Nt.delta=Ls(0,1e3/60,o-Nt.timestamp),Nt.timestamp=o,Nt.isProcessing=!0,kh.update.process(Nt),kh.preRender.process(Nt),kh.render.process(Nt),Nt.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,V0.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(EH),this.sharedNodes.forEach(RH)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Fe.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Fe.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=st(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o){const l=s(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!tA(this.projectionDelta),l=this.getTransformTemplate(),u=l?l(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;a&&(o||Xi(this.latestValues)||d)&&(i(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),OH(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var a;const{visualElement:o}=this.options;if(!o)return st();const l=o.measureViewportBox();if(!(((a=this.scroll)===null||a===void 0?void 0:a.wasRoot)||this.path.some(MH))){const{scroll:d}=this.root;d&&(sa(l.x,d.offset.x),sa(l.y,d.offset.y))}return l}removeElementScroll(a){var o;const l=st();if(gn(l,a),!((o=this.scroll)===null||o===void 0)&&o.wasRoot)return l;for(let u=0;u<this.path.length;u++){const d=this.path[u],{scroll:f,options:h}=d;d!==this.root&&f&&h.layoutScroll&&(f.wasRoot&&gn(l,a),sa(l.x,f.offset.x),sa(l.y,f.offset.y))}return l}applyTransform(a,o=!1){const l=st();gn(l,a);for(let u=0;u<this.path.length;u++){const d=this.path[u];!o&&d.options.layoutScroll&&d.scroll&&d!==d.root&&ia(l,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),Xi(d.latestValues)&&ia(l,d.latestValues)}return Xi(this.latestValues)&&ia(l,this.latestValues),l}removeTransform(a){const o=st();gn(o,a);for(let l=0;l<this.path.length;l++){const u=this.path[l];if(!u.instance||!Xi(u.latestValues))continue;Sp(u.latestValues)&&u.updateSnapshot();const d=st(),f=u.measurePageBox();gn(d,f),x_(o,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return Xi(this.latestValues)&&x_(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Nt.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var o;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==l;if(!(a||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:f,layoutId:h}=this.options;if(!(!this.layout||!(f||h))){if(this.resolvedRelativeTargetAt=Nt.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=st(),this.relativeTargetOrigin=st(),sl(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),gn(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=st(),this.targetWithTransforms=st()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),P8(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):gn(this.target,this.layout.layoutBox),WT(this.target,this.targetDelta)):gn(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=st(),this.relativeTargetOrigin=st(),sl(this.relativeTargetOrigin,this.target,m.target),gn(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}jo&&Qi.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||Sp(this.parent.latestValues)||qT(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const o=this.getLead(),l=!!this.resumingFrom||this!==o;let u=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(u=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===Nt.timestamp&&(u=!1),u)return;const{layout:d,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||f))return;gn(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,m=this.treeScale.y;K8(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=st());const{target:v}=o;if(!v){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(g_(this.prevProjectionDelta.x,this.projectionDelta.x),g_(this.prevProjectionDelta.y,this.projectionDelta.y)),nl(this.projectionDelta,this.layoutCorrected,v,this.latestValues),(this.treeScale.x!==h||this.treeScale.y!==m||!N_(this.projectionDelta.x,this.prevProjectionDelta.x)||!N_(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",v)),jo&&Qi.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var o;if((o=this.options.visualElement)===null||o===void 0||o.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=na(),this.projectionDelta=na(),this.projectionDeltaWithTransform=na()}setAnimationOrigin(a,o=!1){const l=this.snapshot,u=l?l.latestValues:{},d={...this.latestValues},f=na();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const h=st(),m=l?l.source:void 0,v=this.layout?this.layout.source:void 0,b=m!==v,y=this.getStack(),p=!y||y.members.length<=1,g=!!(b&&!p&&this.options.crossfade===!0&&!this.path.some(CH));this.animationProgress=0;let x;this.mixTargetDelta=w=>{const N=w/1e3;A_(f.x,a.x,N),A_(f.y,a.y,N),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(sl(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),IH(this.relativeTarget,this.relativeTargetOrigin,h,N),x&&mH(this.relativeTarget,x)&&(this.isProjectionDirty=!1),x||(x=st()),gn(x,this.relativeTarget)),b&&(this.animationValues=d,lH(d,u,this.latestValues,N,g,p)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=N},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Oi(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Fe.update(()=>{vu.hasAnimatedSinceResize=!0,this.currentAnimation=nH(0,k_,{...a,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(k_),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:u,latestValues:d}=a;if(!(!o||!l||!u)){if(this!==a&&this.layout&&u&&rA(this.options.animationType,this.layout.layoutBox,u.layoutBox)){l=this.target||st();const f=mn(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+f;const h=mn(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+h}gn(o,l),ia(o,d),nl(this.projectionDeltaWithTransform,this.layoutCorrected,o,d)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new pH),this.sharedNodes.get(a).add(o);const u=o.options.initialPromotionConfig;o.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const u=this.getStack();u&&u.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const u={};l.z&&Dh("z",a,u,this.animationValues);for(let d=0;d<Mh.length;d++)Dh(`rotate${Mh[d]}`,a,u,this.animationValues),Dh(`skew${Mh[d]}`,a,u,this.animationValues);a.render();for(const d in u)a.setStaticValue(d,u[d]),this.animationValues&&(this.animationValues[d]=u[d]);a.scheduleRender()}getProjectionStyles(a){var o,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return vH;const u={visibility:""},d=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=pu(a==null?void 0:a.pointerEvents)||"",u.transform=d?d(this.latestValues,""):"none",u;const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){const b={};return this.options.layoutId&&(b.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,b.pointerEvents=pu(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!Xi(this.latestValues)&&(b.transform=d?d({},""):"none",this.hasProjected=!1),b}const h=f.animationValues||f.latestValues;this.applyTransformsToTarget(),u.transform=gH(this.projectionDeltaWithTransform,this.treeScale,h),d&&(u.transform=d(h,u.transform));const{x:m,y:v}=this.projectionDelta;u.transformOrigin=`${m.origin*100}% ${v.origin*100}% 0`,f.animationValues?u.opacity=f===this?(l=(o=h.opacity)!==null&&o!==void 0?o:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:u.opacity=f===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const b in wd){if(h[b]===void 0)continue;const{correct:y,applyTo:p}=wd[b],g=u.transform==="none"?h[b]:y(h[b],f);if(p){const x=p.length;for(let w=0;w<x;w++)u[p[w]]=g}else u[b]=g}return this.options.layoutId&&(u.pointerEvents=f===this?pu(a==null?void 0:a.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)===null||o===void 0?void 0:o.stop()}),this.root.nodes.forEach(S_),this.root.sharedNodes.clear()}}}function xH(t){t.updateLayout()}function yH(t){var e;const n=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:i}=t.layout,{animationType:r}=t.options,a=n.source!==t.layout.source;r==="size"?vn(f=>{const h=a?n.measuredBox[f]:n.layoutBox[f],m=mn(h);h.min=s[f].min,h.max=h.min+m}):rA(r,n.layoutBox,s)&&vn(f=>{const h=a?n.measuredBox[f]:n.layoutBox[f],m=mn(s[f]);h.max=h.min+m,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[f].max=t.relativeTarget[f].min+m)});const o=na();nl(o,s,n.layoutBox);const l=na();a?nl(l,t.applyTransform(i,!0),n.measuredBox):nl(l,s,n.layoutBox);const u=!tA(o);let d=!1;if(!t.resumeFrom){const f=t.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:h,layout:m}=f;if(h&&m){const v=st();sl(v,n.layoutBox,h.layoutBox);const b=st();sl(b,s,m.layoutBox),nA(v,b)||(d=!0),f.options.layoutRoot&&(t.relativeTarget=b,t.relativeTargetOrigin=v,t.relativeParent=f)}}}t.notifyListeners("didUpdate",{layout:s,snapshot:n,delta:l,layoutDelta:o,hasLayoutChanged:u,hasRelativeTargetChanged:d})}else if(t.isLead()){const{onExitComplete:s}=t.options;s&&s()}t.options.transition=void 0}function _H(t){jo&&Qi.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function wH(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function EH(t){t.clearSnapshot()}function S_(t){t.clearMeasurements()}function NH(t){t.isLayoutDirty=!1}function kH(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function T_(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function SH(t){t.resolveTargetDelta()}function TH(t){t.calcProjection()}function AH(t){t.resetSkewAndRotation()}function RH(t){t.removeLeadSnapshot()}function A_(t,e,n){t.translate=Qe(e.translate,0,n),t.scale=Qe(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function R_(t,e,n,s){t.min=Qe(e.min,n.min,s),t.max=Qe(e.max,n.max,s)}function IH(t,e,n,s){R_(t.x,e.x,n.x,s),R_(t.y,e.y,n.y,s)}function CH(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const jH={duration:.45,ease:[.4,0,.1,1]},I_=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),C_=I_("applewebkit/")&&!I_("chrome/")?Math.round:cn;function j_(t){t.min=C_(t.min),t.max=C_(t.max)}function OH(t){j_(t.x),j_(t.y)}function rA(t,e,n){return t==="position"||t==="preserve-aspect"&&!L8(E_(e),E_(n),.2)}function MH(t){var e;return t!==t.root&&((e=t.scroll)===null||e===void 0?void 0:e.wasRoot)}const DH=iA({attachResizeListener:(t,e)=>Ul(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Lh={current:void 0},aA=iA({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!Lh.current){const t=new DH({});t.mount(window),t.setOptions({layoutScroll:!0}),Lh.current=t}return Lh.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),LH={pan:{Feature:J8},drag:{Feature:Q8,ProjectionNode:aA,MeasureLayout:JT}};function O_(t,e,n){const{props:s}=t;t.animationState&&s.whileHover&&t.animationState.setActive("whileHover",n==="Start");const i="onHover"+n,r=s[i];r&&Fe.postRender(()=>r(e,vc(e)))}class PH extends Ui{mount(){const{current:e}=this.node;e&&(this.unmount=LB(e,n=>(O_(this.node,n,"Start"),s=>O_(this.node,s,"End"))))}unmount(){}}class BH extends Ui{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=gc(Ul(this.node.current,"focus",()=>this.onFocus()),Ul(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function M_(t,e,n){const{props:s}=t;t.animationState&&s.whileTap&&t.animationState.setActive("whileTap",n==="Start");const i="onTap"+(n==="End"?"":n),r=s[i];r&&Fe.postRender(()=>r(e,vc(e)))}class UH extends Ui{mount(){const{current:e}=this.node;e&&(this.unmount=HB(e,n=>(M_(this.node,n,"Start"),(s,{success:i})=>M_(this.node,s,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Ap=new WeakMap,Ph=new WeakMap,HH=t=>{const e=Ap.get(t.target);e&&e(t)},GH=t=>{t.forEach(HH)};function VH({root:t,...e}){const n=t||document;Ph.has(n)||Ph.set(n,{});const s=Ph.get(n),i=JSON.stringify(e);return s[i]||(s[i]=new IntersectionObserver(GH,{root:t,...e})),s[i]}function FH(t,e,n){const s=VH(e);return Ap.set(t,n),s.observe(t),()=>{Ap.delete(t),s.unobserve(t)}}const zH={some:0,all:1};class $H extends Ui{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:s,amount:i="some",once:r}=e,a={root:n?n.current:void 0,rootMargin:s,threshold:typeof i=="number"?i:zH[i]},o=l=>{const{isIntersecting:u}=l;if(this.isInView===u||(this.isInView=u,r&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:f}=this.node.getProps(),h=u?d:f;h&&h(l)};return FH(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(KH(e,n))&&this.startObserver()}unmount(){}}function KH({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const YH={inView:{Feature:$H},tap:{Feature:UH},focus:{Feature:BH},hover:{Feature:PH}},qH={layout:{ProjectionNode:aA,MeasureLayout:JT}},Rp={current:null},oA={current:!1};function WH(){if(oA.current=!0,!!P0)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>Rp.current=t.matches;t.addListener(e),e()}else Rp.current=!1}const XH=[...jT,jt,Mi],QH=t=>XH.find(CT(t)),D_=new WeakMap;function JH(t,e,n){for(const s in e){const i=e[s],r=n[s];if(Ot(i))t.addValue(s,i);else if(Ot(r))t.addValue(s,Pl(i,{owner:t}));else if(r!==i)if(t.hasValue(s)){const a=t.getValue(s);a.liveStyle===!0?a.jump(i):a.hasAnimated||a.set(i)}else{const a=t.getStaticValue(s);t.addValue(s,Pl(a!==void 0?a:i,{owner:t}))}}for(const s in n)e[s]===void 0&&t.removeValue(s);return e}const L_=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class ZH{scrapeMotionValuesFromProps(e,n,s){return{}}constructor({parent:e,props:n,presenceContext:s,reducedMotionConfig:i,blockInitialAnimation:r,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=uv,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=ts.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,Fe.render(this.render,!1,!0))};const{latestValues:l,renderState:u,onUpdate:d}=a;this.onUpdate=d,this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=u,this.parent=e,this.props=n,this.presenceContext=s,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=o,this.blockInitialAnimation=!!r,this.isControllingVariants=Ef(n),this.isVariantNode=HS(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:f,...h}=this.scrapeMotionValuesFromProps(n,{},this);for(const m in h){const v=h[m];l[m]!==void 0&&Ot(v)&&v.set(l[m],!1)}}mount(e){this.current=e,D_.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,s)=>this.bindToMotionValue(s,n)),oA.current||WH(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Rp.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){D_.delete(this.current),this.projection&&this.projection.unmount(),Oi(this.notifyUpdate),Oi(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const n=this.features[e];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const s=Cr.has(e),i=n.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&Fe.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0)}),r=n.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{i(),r(),a&&a(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Ha){const n=Ha[e];if(!n)continue;const{isEnabled:s,Feature:i}=n;if(!this.features[e]&&i&&s(this.props)&&(this.features[e]=new i(this)),this.features[e]){const r=this.features[e];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):st()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let s=0;s<L_.length;s++){const i=L_[s];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const r="on"+i,a=e[r];a&&(this.propEventSubscriptions[i]=this.on(i,a))}this.prevMotionValues=JH(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const s=this.values.get(e);n!==s&&(s&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let s=this.values.get(e);return s===void 0&&n!==void 0&&(s=Pl(n===null?void 0:n,{owner:this}),this.addValue(e,s)),s}readValue(e,n){var s;let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(s=this.getBaseTargetFromProps(this.props,e))!==null&&s!==void 0?s:this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(RT(i)||yT(i))?i=parseFloat(i):!QH(i)&&Mi.test(n)&&(i=ST(e,n)),this.setBaseTarget(e,Ot(i)?i.get():i)),Ot(i)?i.get():i}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:s}=this.props;let i;if(typeof s=="string"||typeof s=="object"){const a=z0(this.props,s,(n=this.presenceContext)===null||n===void 0?void 0:n.custom);a&&(i=a[e])}if(s&&i!==void 0)return i;const r=this.getBaseTargetFromProps(this.props,e);return r!==void 0&&!Ot(r)?r:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new iv),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class lA extends ZH{constructor(){super(...arguments),this.KeyframeResolver=OT}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:s}){delete n[e],delete s[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Ot(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function eG(t){return window.getComputedStyle(t)}class tG extends lA{constructor(){super(...arguments),this.type="html",this.renderInstance=WS}readValueFromInstance(e,n){if(Cr.has(n)){const s=cv(n);return s&&s.default||0}else{const s=eG(e),i=(KS(n)?s.getPropertyValue(n):s[n])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:n}){return XT(e,n)}build(e,n,s){Y0(e,n,s.transformTemplate)}scrapeMotionValuesFromProps(e,n,s){return Q0(e,n,s)}}class nG extends lA{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=st}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(Cr.has(n)){const s=cv(n);return s&&s.default||0}return n=XS.has(n)?n:G0(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,s){return ZS(e,n,s)}build(e,n,s){q0(e,n,this.isSVGTag,s.transformTemplate)}renderInstance(e,n,s,i){QS(e,n,s,i)}mount(e){this.isSVGTag=X0(e.tagName),super.mount(e)}}const sG=(t,e)=>F0(t)?new nG(e):new tG(e,{allowProjection:t!==_.Fragment}),iG=RB({...T8,...YH,...LH,...qH},sG),De=z6(iG),P_=(t,e=800)=>{const[n,s]=_.useState(t),i=_.useRef(t);return _.useEffect(()=>{if(i.current===t)return;const r=i.current,a=t;let o=null;const l=u=>{o||(o=u);const d=Math.min((u-o)/e,1);s(r+(a-r)*d),d<1?requestAnimationFrame(l):i.current=t};requestAnimationFrame(l)},[t,e]),n},rG=({room:t,player:e,onAction:n})=>{var A,k,R,I,P,V,$,K,B,j,O;const{activeTab:s,setActiveTab:i}=vf(),{playSfx:r}=S0(),[a,o]=_.useState(!1),[l,u]=_.useState({tick:((A=t.world)==null?void 0:A.gameTick)||0,time:Date.now()});_.useEffect(()=>{var C,F;((C=t.world)==null?void 0:C.gameTick)!==l.tick&&u({tick:((F=t.world)==null?void 0:F.gameTick)||0,time:Date.now()})},[(k=t.world)==null?void 0:k.gameTick,l.tick]);const d=(R=t.regions)==null?void 0:R[e.regionId||"capital"],f=(((I=d==null?void 0:d.coup)==null?void 0:I.bribeProgress)||0)>0||!!(d!=null&&d.activeElection);_.useEffect(()=>{const C=F=>{if(F.target instanceof HTMLInputElement||F.target instanceof HTMLTextAreaElement)return;const Q=F.key.toLowerCase(),oe={m:"MAP",l:"ACTIVITY",p:"PROFILE",i:"INVENTORY",f:"SKILLS",d:"DIPLOMACY",h:"HIERARCHY"};if(oe[Q]){if(Q==="d"&&e.role==="PEASANT")return;i(oe[Q]),r("ui_click.ogg")}};return window.addEventListener("keydown",C),()=>window.removeEventListener("keydown",C)},[i,e.role,r]);const[,h]=_.useState(0);_.useEffect(()=>{const C=setInterval(()=>h(F=>F+1),1e3);return()=>clearInterval(C)},[]);const m=e.status.stamina||0,v=e.status.hp||0,b=e.stats.xp||0,y=e.stats.level||1,p=bd[y]||1e3,g=Math.min(100,b/p*100),x=P_(m),w=P_(v),N=[{id:"MAP",label:"Kart",icon:O3,short:"M"},{id:"ACTIVITY",label:"Live",icon:Ml,short:"L"},{id:"INVENTORY",label:"Eiendeler",icon:H3,short:"I"},{id:"SKILLS",label:"Ferdigheter",icon:z3,short:"F"},...e.role!=="PEASANT"?[{id:"DIPLOMACY",label:"Diplomati",icon:Ml,short:"D"}]:[],{id:"HIERARCHY",label:"Samfunn",icon:S3,short:"H"}],T=((P=t.world)==null?void 0:P.year)||1100,E=(($=An[(V=t.world)==null?void 0:V.season])==null?void 0:$.label)||((K=t.world)==null?void 0:K.season);return c.jsxs("header",{className:"flex-none h-14 md:h-16 border-b border-white/5 bg-slate-950/80 backdrop-blur-xl flex items-center justify-between px-4 md:px-6 z-50 relative shrink-0 transition-all",children:[c.jsxs("div",{className:"flex items-center gap-4 md:gap-6",children:[c.jsxs("div",{className:"flex flex-col",children:[c.jsxs("div",{className:"flex items-baseline gap-2",children:[c.jsx("span",{className:"text-2xl md:text-3xl font-black text-white tracking-tighter leading-none tabular-nums shadow-indigo-500/50 drop-shadow-lg",children:EP(l.tick,l.time)}),c.jsxs("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest hidden sm:inline",children:["R ",T]})]}),c.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold uppercase tracking-widest text-slate-400 mt-0.5",children:[c.jsxs("div",{className:"flex items-center gap-1.5",children:[c.jsx("span",{className:((B=t.world)==null?void 0:B.season)==="Winter"?"text-blue-300 drop-shadow-[0_0_8px_rgba(147,197,253,0.5)]":"text-amber-400 drop-shadow-[0_0_8px_rgba(251,191,36,0.5)]",children:E}),c.jsx("span",{className:"text-slate-600",children:""}),c.jsx("span",{className:"",title:Ns(((j=t.world)==null?void 0:j.gameTick)||0)==="DAY"?"Dag":"Natt",children:Ns(((O=t.world)==null?void 0:O.gameTick)||0)==="DAY"?" Dag":" Natt"})]}),f&&c.jsx("button",{onClick:()=>{i("POLITICS"),r("ui_click.ogg")},className:"flex items-center gap-2 bg-rose-600/20 border border-rose-500/50 px-2 py-0.5 rounded-full animate-pulse group hover:bg-rose-500 hover:text-white transition-all ml-2",title:"Uro i regionen! Klikk for  se politisk status.",children:c.jsx("span",{className:"text-[9px] font-black italic tracking-tighter",children:" URO"})})]})]}),c.jsx("nav",{className:"hidden md:flex items-center gap-1 bg-white/5 p-1 rounded-xl border border-white/5",children:N.map(C=>{const F=s===C.id,Q=C.icon;return c.jsxs("button",{onClick:()=>{i(C.id),r("ui_click.ogg")},className:`
                                    relative px-3 py-1.5 md:py-2 rounded-lg flex items-center gap-2 transition-all group overflow-hidden
                                    ${F?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-400 hover:text-white hover:bg-white/5"}
                                `,title:C.label,children:[c.jsx(Q,{size:16,className:F?"animate-pulse":""}),c.jsx("span",{className:"hidden xl:block text-xs font-bold uppercase tracking-wider ",children:C.label}),C.short&&c.jsx("span",{className:`text-[9px] absolute top-0.5 right-1 font-mono font-bold transition-opacity hidden xl:block ${F?"text-indigo-300":"text-slate-700 group-hover:text-slate-500"}`,children:C.short})]},C.id)})})]}),c.jsxs("div",{className:"flex items-center gap-3 md:gap-5",children:[e.activeBuffs&&e.activeBuffs.length>0&&c.jsx("div",{className:"flex items-center gap-1 mr-1",children:e.activeBuffs.map(C=>c.jsx(oG,{buff:C},C.id))}),c.jsxs("div",{className:"hidden md:flex items-center bg-slate-900/50 rounded-full border border-white/5 overflow-hidden transition-all duration-300",children:[c.jsxs("button",{onClick:()=>{i("INVENTORY"),r("ui_click.ogg")},className:"flex items-center gap-2 hover:bg-white/5 px-3 py-1.5 transition-colors cursor-pointer group active:scale-95",title:"pne Eiendeler (I)",children:[c.jsx(hp,{resource:"gold",amount:e.resources.gold,size:"sm"}),c.jsx("span",{className:"hidden xl:inline text-[10px] font-black uppercase tracking-widest text-slate-500 group-hover:text-slate-300 transition-colors ml-1",children:"Gull"})]}),c.jsx("div",{className:"w-px h-3 bg-white/10"}),c.jsxs("button",{onClick:()=>{e.resources.bread?(n==null||n({type:"CONSUME",itemId:"bread",isResource:!0}),r("eat.ogg")):(i("INVENTORY"),r("ui_click.ogg"))},disabled:!e.resources.bread,className:`flex items-center gap-2 px-3 py-1.5 transition-all cursor-pointer group border-l border-white/0 active:scale-95 ${e.resources.bread?"hover:bg-emerald-500/10 hover:border-emerald-500/20":"opacity-40 cursor-not-allowed"}`,title:e.resources.bread?"Spis Brd (+20 Stamina)":"Tomt for brd",children:[c.jsx(hp,{resource:"bread",amount:e.resources.bread||0,size:"sm"}),c.jsx("div",{className:"hidden xl:flex flex-col items-start -space-y-1",children:c.jsx("span",{className:`text-[10px] font-black uppercase tracking-widest transition-colors ${e.resources.bread?"text-slate-500 group-hover:text-emerald-400":"text-slate-600"}`,children:e.resources.bread?"Spis":"Tom"})})]})]}),c.jsxs("div",{className:"flex flex-col gap-1 w-20 md:w-24",children:[c.jsxs("div",{className:"h-1 bg-slate-800 rounded-full overflow-hidden relative group",children:[c.jsx(De.div,{className:"absolute inset-y-0 left-0 bg-rose-500 rounded-full",initial:{width:0},animate:{width:`${w}%`}}),c.jsxs("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 flex items-center justify-center text-[8px] font-black text-white bg-black/50 transition-opacity",children:["HP ",Math.round(w),"%"]})]}),c.jsxs("div",{className:"h-1 bg-slate-800 rounded-full overflow-hidden relative group",children:[c.jsx(De.div,{className:"absolute inset-y-0 left-0 bg-amber-400 shadow-[0_0_10px_rgba(251,191,36,0.5)]",initial:{width:0},animate:{width:`${x}%`}}),c.jsxs("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 flex items-center justify-center text-[8px] font-black text-black bg-white/50 transition-opacity",children:["STA ",Math.round(x),"%"]})]}),c.jsx("div",{className:"h-0.5 bg-slate-800/50 rounded-full overflow-hidden relative group mt-0.5",children:c.jsx(De.div,{className:"absolute inset-y-0 left-0 bg-indigo-500",initial:{width:0},animate:{width:`${g}%`}})})]}),c.jsxs("button",{onClick:()=>{i("PROFILE"),r("ui_click.ogg")},className:"group flex items-center gap-3 bg-white/0 hover:bg-white/5 pl-2 pr-1 py-1 rounded-2xl border border-transparent hover:border-white/10 transition-all active:scale-95",title:"Min Karakter (P)",children:[c.jsx("div",{className:"hidden 2xl:flex flex-col items-end",children:c.jsx("span",{className:"text-sm font-black italic tracking-tighter text-white leading-none",children:e.name})}),c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"w-8 h-8 md:w-9 md:h-9 rounded-lg bg-gradient-to-br from-indigo-500 to-purple-600 p-0.5 shadow-lg overflow-hidden group-hover:shadow-indigo-500/20",children:e.avatar?c.jsx("img",{src:e.avatar,alt:"Profile",className:"w-full h-full object-cover rounded-[6px]"}):c.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-900 rounded-[6px] text-base",children:e.role==="KING"?"":""})}),c.jsx("div",{className:"absolute -bottom-1 -right-1 w-4 h-4 bg-slate-900 rounded-full flex items-center justify-center border border-white/10 text-[8px] font-black text-white z-10",children:y})]})]}),c.jsx(aG,{icon:W3,onClick:()=>i("SETTINGS"),title:"Innstillinger"}),c.jsx("button",{className:"md:hidden text-white p-2",onClick:()=>o(!a),children:a?c.jsx(ji,{}):c.jsx(D3,{})})]}),c.jsx(Ei,{children:a&&c.jsxs(De.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"absolute top-16 left-0 right-0 bg-slate-900 border-b border-white/10 p-4 shadow-2xl md:hidden flex flex-col gap-2 z-40",children:[N.map(C=>c.jsxs("button",{onClick:()=>{i(C.id),o(!1)},className:`w-full p-4 rounded-xl text-left font-black uppercase flex items-center gap-4 ${s===C.id?"bg-indigo-600 text-white":"bg-white/5 text-slate-400"}`,children:[c.jsx(C.icon,{size:20}),C.label]},C.id)),c.jsx("div",{className:"h-px bg-white/5 my-2"}),c.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 font-bold uppercase tracking-widest px-2",children:[c.jsxs("span",{children:["r ",T]}),c.jsx("span",{children:E})]})]})})]})},aG=({icon:t,onClick:e,title:n,className:s})=>c.jsx("button",{onClick:e,title:n,className:`hidden md:flex p-2 text-slate-400 hover:text-white hover:bg-white/5 rounded-lg transition-all ${s}`,children:c.jsx(t,{size:20})}),oG=({buff:t})=>{const[e,n]=_.useState(Math.max(0,Math.ceil((t.expiresAt-Date.now())/6e4)));return _.useEffect(()=>{const s=setInterval(()=>{const i=Math.max(0,Math.ceil((t.expiresAt-Date.now())/6e4));n(i)},1e4);return()=>clearInterval(s)},[t.expiresAt]),Date.now()>t.expiresAt?null:c.jsxs("div",{className:"group relative flex items-center justify-center w-8 h-8 rounded-full bg-emerald-500/10 border border-emerald-500/30 text-emerald-400 cursor-help",children:[c.jsx("span",{className:"text-lg",children:""}),c.jsxs("span",{className:"absolute -bottom-1 -right-1 text-[8px] font-black bg-slate-900 px-1 rounded-full border border-white/10",children:[e,"m"]}),c.jsxs("div",{className:"absolute top-full mt-2 left-1/2 -translate-x-1/2 bg-slate-900 p-2 rounded-lg border border-white/10 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none w-32 text-center z-50",children:[c.jsx("p",{className:"text-[10px] font-bold text-white mb-0.5",children:t.label}),c.jsxs("p",{className:"text-[9px] text-emerald-400",children:[t.value*100,"% mindre stamina"]})]})]})},cA=Ee.memo(({src:t,placeholderSrc:e,alt:n,className:s,imgClassName:i="object-cover w-full h-full",priority:r=!1,disableMotion:a=!1})=>{const[o,l]=_.useState(!1),[u,d]=_.useState(e||t);return _.useEffect(()=>{l(!1),e&&d(e);const f=new Image;f.src=t,f.onload=()=>{d(t),l(!0)}},[t,e]),c.jsx("div",{className:`relative overflow-hidden ${s}`,children:c.jsx(De.img,{src:u,alt:n,loading:r?"eager":"lazy",className:`${i} transition-all duration-700 ease-in-out`,initial:{filter:"blur(20px)",scale:a?1:1.1},animate:{filter:o?"blur(0px)":"blur(20px)",scale:a||o?1:1.1},style:{willChange:"filter, transform"}},t)})});cA.displayName="ProgressiveImage";const lr=[{id:"fields",label:"krene",icon:"",top:"22%",left:"42%",vest:{top:"35%",left:"70%"},ost:{top:"35%",left:"45%"},roles:["PEASANT","BARON","KING"],actions:[],isHub:!0},{id:"forest",label:"Skogen",icon:"",top:"25%",left:"80%",vest:{top:"15%",left:"60%"},ost:{top:"27%",left:"14%"},roles:["PEASANT","BARON","KING"],actions:[],isHub:!0},{id:"castle",label:"Slottet",icon:"",top:"66%",left:"86%",vest:{top:"40%",left:"30%"},ost:{top:"40%",left:"68%"},roles:["PEASANT","BARON","KING","SOLDIER"],actions:[{id:"OPEN_CONSTRUCTION",label:"Bidra til bygging",cost:"Ressurser"}],isHub:!0},{id:"peasant_farm",label:"Husmannsplassen",icon:"",top:"30%",left:"60%",vest:{top:"85%",left:"72%"},ost:{top:"75%",left:"30%"},roles:["PEASANT","BARON","KING"],actions:[],isHub:!0},{id:"market",label:"Markedet",icon:"",top:"70%",left:"25%",vest:{top:"70%",left:"37%"},ost:{top:"70%",left:"63%"},roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],actions:[{id:"MARKET_VIEW",label:"pne Handel",cost:"Gratis"},{id:"JOIN_ROLE",label:"Bli Kjpmann",cost:"500g + Niv 3",targetRole:"MERCHANT"}]},{id:"village",label:"Landsbyen",icon:"",top:"42%",left:"42%",vest:{top:"50%",left:"52%"},ost:{top:"55%",left:"44%"},roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],actions:[],isHub:!0},{id:"mine",label:"Gruve-distriktet",icon:"",top:"12%",left:"25%",vest:{top:"13%",left:"39%"},ost:{top:"20%",left:"60%"},roles:["PEASANT","BARON","KING"],actions:[],isHub:!0},{id:"monastery",label:"Klosteret",icon:"",top:"16%",left:"55%",vest:{top:"50%",left:"78%"},ost:{top:"50%",left:"27%"},roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],actions:[],isHub:!0},{id:"border",label:"Grensen",icon:"",top:"85%",left:"80%",vest:{top:"15%",left:"10%"},ost:{top:"15%",left:"10%"},roles:["BARON"],actions:[{id:"RAID",label:"Plyndre Nabo",cost:"-40"}]},{id:"throne_room",label:"Tronsalen",icon:"",top:"40%",left:"50%",roles:["KING"],parentId:"castle",actions:[{id:"TAX_ROYAL",label:"Kongelig Skatt",cost:"King Only"},{id:"DECREE",label:"Utsted Dekret",cost:"King Only"}]},{id:"barracks",label:"Kasernen",icon:"",top:"60%",left:"30%",roles:["PEASANT","BARON","KING","SOLDIER"],parentId:"castle",actions:[{id:"DRAFT",label:"Verve Soldater",cost:"-5g -10"},{id:"JOIN_ROLE",label:"Bli Soldat",cost:"200g + Niv 3",targetRole:"SOLDIER"}]},{id:"royal_chambers",label:"Kongens Kammer",icon:"",top:"30%",left:"70%",roles:["BARON","KING"],parentId:"castle",actions:[{id:"REST",label:"Hvile i Kammeret",cost:"Full rest + Velvre"}]},{id:"castle_construction",label:"Byggeplass",icon:"",top:"75%",left:"80%",roles:["PEASANT","BARON","KING","SOLDIER"],parentId:"castle",actions:[{id:"OPEN_CONSTRUCTION",label:"Bidra til bygging",cost:"Ressurser"}]},{id:"village_square",label:"Landsbytorg",icon:"",top:"50%",left:"50%",village:{top:"48%",left:"50%"},roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],parentId:"village",actions:[{id:"REST",label:"Hvile p torget",cost:"+10"}]},{id:"tavern",label:"Vertshuset",icon:"",top:"35%",left:"75%",village:{top:"75%",left:"80%"},roles:["PEASANT","BARON","KING","SOLDIER"],parentId:"village",actions:[{id:"ENTER_TAVERN",label:"G inn",cost:"Gratis"},{id:"REST_BASIC",label:"Hvile i Salen",cost:"Gratis"},{id:"REST_COMFY",label:"Bestille Kammer",cost:"-5g"},{id:"REST_ROYAL",label:"Kongelig Suite",cost:"-20g"}],isHub:!0,isInterior:!0},{id:"bakery",label:"Bakeri",icon:"",top:"80%",left:"30%",village:{top:"38%",left:"35%"},roles:["PEASANT","BARON"],parentId:"village",actions:[],isHub:!0,isInterior:!0},{id:"great_forge",label:"Storsmie",icon:"",top:"35%",left:"15%",village:{top:"48%",left:"23%"},roles:["PEASANT","BARON"],parentId:"village",actions:[],isHub:!0,isInterior:!0},{id:"windmill",label:"Vindmlle",icon:"",top:"20%",left:"37%",village:{top:"25%",left:"17%"},roles:["PEASANT","BARON","KING"],parentId:"village",actions:[{id:"REFINE_flour",label:"Male Mel",cost:"-15 -10korn"}],isHub:!0,isInterior:!0},{id:"smeltery",label:"Smeltehytte",icon:"",top:"60%",left:"95%",village:{top:"75%",left:"12%"},roles:["PEASANT","BARON"],parentId:"village",actions:[{id:"REFINE_IRON_BASIC",label:"Smelte Jern",cost:"-20 -5malm"},{id:"REFINE_IRON_FAST",label:"Industri-smelting",cost:"-30 -10malm"},{id:"REFINE_STEEL",label:"Smelte Stl",cost:"-50 -20malm"}],isHub:!0,isInterior:!0},{id:"sawmill",label:"Sagbruk",icon:"",top:"55%",left:"15%",village:{top:"70%",left:"45%"},roles:["PEASANT","BARON"],parentId:"village",actions:[{id:"REFINE_PLANK_BASIC",label:"Sag Planker",cost:"-10 -5ved"},{id:"REFINE_PLANK_FAST",label:"Hurtig-saging",cost:"-15 -5ved"}],isHub:!0,isInterior:!0},{id:"weavery",label:"Veveri",icon:"",top:"50%",left:"85%",village:{top:"45%",left:"65%"},roles:["PEASANT","BARON","MERCHANT"],parentId:"village",actions:[],isHub:!0,isInterior:!0},{id:"watchtower",label:"Vaktrn",icon:"",top:"15%",left:"68%",village:{top:"25%",left:"82%"},roles:["BARON","SOLDIER"],parentId:"village",actions:[],isHub:!0,isInterior:!0},{id:"stables",label:"Stall",icon:"",top:"80%",left:"80%",village:{top:"45%",left:"90%"},roles:["BARON","SOLDIER","KING"],parentId:"village",actions:[],isHub:!0,isInterior:!0},{id:"well",label:"Bybrnn",icon:"",top:"69%",left:"60%",village:{top:"48%",left:"50%"},roles:["PEASANT","BARON"],parentId:"village",actions:[],isHub:!0},{id:"apothecary",label:"Apoteker",icon:"",top:"20%",left:"82%",village:{top:"60%",left:"92%"},roles:["PEASANT","BARON","KING","MERCHANT"],parentId:"village",actions:[],isHub:!0,isInterior:!0},{id:"forge_anvil",label:"Ambolt",icon:"",top:"50%",left:"40%",roles:["PEASANT","BARON"],parentId:"great_forge",actions:[{id:"OPEN_CRAFTING",label:"pne Smia",cost:"Gratis"}]},{id:"forge_upgrades",label:"Tegneark",icon:"",top:"40%",left:"75%",roles:["PEASANT","BARON"],parentId:"great_forge",actions:[{id:"BUILDING_UPGRADE_great_forge",label:"Oppgrader Smia",cost:"Varierer"}]},{id:"bakery_oven",label:"Bakerovn",icon:"",top:"50%",left:"50%",roles:["PEASANT","BARON"],parentId:"bakery",actions:[{id:"REFINE",label:"pne Bakeriet",cost:"Gratis"}]},{id:"bakery_upgrades",label:"Tegneark",icon:"",top:"30%",left:"80%",roles:["PEASANT","BARON"],parentId:"bakery",actions:[{id:"BUILDING_UPGRADE_bakery",label:"Oppgrader Bakeriet",cost:"Varierer"}]},{id:"windmill_stones",label:"Kvernsteiner",icon:"",top:"50%",left:"40%",roles:["PEASANT","BARON"],parentId:"windmill",actions:[{id:"REFINE",label:"pne Mlla",cost:"Gratis"}]},{id:"windmill_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON"],parentId:"windmill",actions:[{id:"BUILDING_UPGRADE_windmill",label:"Oppgrader Mlla",cost:"Varierer"}]},{id:"sawmill_blade",label:"Saga",icon:"",top:"50%",left:"40%",roles:["PEASANT","BARON"],parentId:"sawmill",actions:[{id:"REFINE",label:"pne Sagbruket",cost:"Gratis"}]},{id:"sawmill_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON"],parentId:"sawmill",actions:[{id:"BUILDING_UPGRADE_sawmill",label:"Oppgrader Sagbruket",cost:"Varierer"}]},{id:"smeltery_furnace",label:"Smelteovn",icon:"",top:"50%",left:"30%",roles:["PEASANT","BARON"],parentId:"smeltery",actions:[{id:"REFINE",label:"pne Smeltehytta",cost:"Gratis"}]},{id:"smeltery_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON"],parentId:"smeltery",actions:[{id:"BUILDING_UPGRADE_smeltery",label:"Oppgrader Smeltehytta",cost:"Varierer"}]},{id:"weavery_loom",label:"Vevstol",icon:"",top:"50%",left:"40%",roles:["PEASANT","BARON","MERCHANT"],parentId:"weavery",actions:[{id:"REFINE",label:"pne Veveriet",cost:"Gratis"}]},{id:"weavery_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON"],parentId:"weavery",actions:[{id:"BUILDING_UPGRADE_weavery",label:"Oppgrader Veveriet",cost:"Varierer"}]},{id:"stables_stall",label:"Stallplass",icon:"",top:"50%",left:"40%",roles:["BARON","SOLDIER","KING"],parentId:"stables",actions:[{id:"MOUNT_HORSE",label:"Ri ut",cost:"-5"}]},{id:"stables_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["BARON","KING"],parentId:"stables",actions:[{id:"BUILDING_UPGRADE_stables",label:"Oppgrader Stallen",cost:"Varierer"}]},{id:"watchtower_top",label:"Vaktpost",icon:"",top:"30%",left:"50%",roles:["PEASANT","BARON","SOLDIER"],parentId:"watchtower",actions:[{id:"OPEN_GARRISON",label:"pne Garnisonen",cost:"Gratis"},{id:"PATROL",label:"Patruljer",cost:"-30"}]},{id:"watchtower_upgrades",label:"Tegneark",icon:"",top:"50%",left:"80%",roles:["BARON"],parentId:"watchtower",actions:[{id:"BUILDING_UPGRADE_watchtower",label:"Oppgrader Trnet",cost:"Varierer"}]},{id:"apothecary_bench",label:"Arbeidsbenk",icon:"",top:"50%",left:"40%",roles:["PEASANT","BARON"],parentId:"apothecary",actions:[{id:"OPEN_CRAFTING",label:"pne Apoteket",cost:"Gratis"}]},{id:"apothecary_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON"],parentId:"apothecary",actions:[{id:"BUILDING_UPGRADE_apothecary",label:"Oppgrader Apoteket",cost:"Varierer"}]},{id:"well_water",label:"Brnnkum",icon:"",top:"50%",left:"50%",roles:["PEASANT","BARON"],parentId:"well",actions:[{id:"GATHER_WATER",label:"Hent Vann",cost:"-10"}]},{id:"well_upgrades",label:"Tegneark",icon:"",top:"40%",left:"80%",roles:["PEASANT","BARON"],parentId:"well",actions:[{id:"BUILDING_UPGRADE_well",label:"Oppgrader Brnnen",cost:"Varierer"}]},{id:"tavern_bar",label:"Baren",icon:"",top:"30%",left:"30%",roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],parentId:"tavern",actions:[{id:"BUY_MEAL",label:"Kjp Mltid",cost:"-5g +10"},{id:"REST_BASIC",label:"Hvile i Salen",cost:"Gratis"},{id:"REST_COMFY",label:"Bestille Kammer",cost:"-5g"},{id:"REST_ROYAL",label:"Kongelig Suite",cost:"-20g"}]},{id:"tavern_gambling",label:"Spillebordet",icon:"",top:"50%",left:"50%",roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],parentId:"tavern",actions:[{id:"OPEN_DICE_GAME",label:"Spill Terninger",cost:"Min. 0.5g"}]},{id:"tavern_gossip",label:"Lokalbefolkningen",icon:"",top:"40%",left:"70%",roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],parentId:"tavern",actions:[{id:"CHAT_LOCAL",label:"Snakk med folk",cost:"Gratis"}]},{id:"tavern_upgrades",label:"Tegneark",icon:"",top:"25%",left:"85%",roles:["PEASANT","BARON","KING"],parentId:"tavern",actions:[{id:"BUILDING_UPGRADE_tavern",label:"Oppgrader Vertshuset",cost:"Varierer"}]},{id:"grain_fields",label:"Kornker",icon:"",top:"50%",left:"20%",roles:["PEASANT","BARON","KING"],parentId:"fields",actions:[{id:"PLANT",label:"S Korn",cost:"-5 korn -25"}]},{id:"sheep_pasture",label:"Sauebeite",icon:"",top:"35%",left:"65%",roles:["PEASANT","BARON","KING"],parentId:"fields",actions:[{id:"GATHER_WOOL",label:"Klipp Sauer",cost:"-15"}]},{id:"beehives",label:"Bikuber",icon:"",top:"75%",left:"70%",roles:["PEASANT","BARON","KING"],parentId:"fields",actions:[{id:"GATHER_HONEY",label:"Samle Honning",cost:"-20"}]},{id:"mine_shaft",label:"Jern-gruva",icon:"",top:"50%",left:"12%",roles:["PEASANT","BARON","KING"],parentId:"mine",actions:[{id:"MINE",label:"Bryte Malm",cost:"-25 -1"}]},{id:"quarry_poi",label:"Steinhuggeriet",icon:"",top:"40%",left:"85%",roles:["PEASANT","BARON","KING"],parentId:"mine",actions:[{id:"QUARRY",label:"Hugge Stein",cost:"-20 -1"}]},{id:"forest_clearing",label:"Hogstfeltet",icon:"",top:"60%",left:"30%",roles:["PEASANT","BARON","KING"],parentId:"forest",actions:[{id:"CHOP",label:"Hugge Ved",cost:"-15 -1"}]},{id:"hunting_grounds",label:"Jaktmarker",icon:"",top:"30%",left:"75%",roles:["PEASANT","BARON","KING"],parentId:"forest",actions:[{id:"HUNT",label:"Dra p Jakt",cost:"-30"}]},{id:"forest_forage",label:"Brplukking",icon:"",top:"60%",left:"90%",roles:["PEASANT","BARON","KING"],parentId:"forest",actions:[{id:"FORAGE",label:"Sanke Mat (Nd)",cost:"-40"}]},{id:"monastery_chapel",label:"Klosterkirken",icon:"",top:"50%",left:"50%",roles:["PEASANT","BARON","KING","SOLDIER","MERCHANT"],parentId:"monastery",actions:[{id:"PRAY",label:"Be en Bnn",cost:"-15"}]},{id:"farm_house",label:"Inne i Stugo",icon:"",top:"52%",left:"58%",roles:["PEASANT"],parentId:"peasant_farm",actions:[],isHub:!0,isInterior:!0},{id:"stugo_bed",label:"Senga",icon:"",top:"65%",left:"42%",roles:["PEASANT"],parentId:"farm_house",actions:[{id:"SLEEP",label:"Sove tungt",cost:"Full "}]},{id:"stugo_fireplace",label:"Peisen",icon:"",top:"55%",left:"80%",roles:["PEASANT"],parentId:"farm_house",actions:[{id:"EAT",label:"Sitte ved varmen",cost:"-1 +40"}]},{id:"farm_well",label:"Brnnen",icon:"",top:"60%",left:"27%",roles:["PEASANT"],parentId:"peasant_farm",actions:[{id:"REST",label:"Drikke vann",cost:"+5"}]},{id:"farm_upgrade_spot",label:"Tegneark",icon:"",top:"40%",left:"15%",roles:["PEASANT"],parentId:"farm_house",actions:[{id:"BUILDING_UPGRADE_farm_house",label:"Bygg ut grden",cost:"Varierer"}]},{id:"chicken_coop",label:"Hnsehus",icon:"",top:"40%",left:"75%",roles:["PEASANT"],parentId:"peasant_farm",actions:[{id:"OPEN_CHICKEN_COOP",label:"G inn til hnene",cost:"Gratis"}]}],B_=[{id:"pilegrim",name:"Sigurd Pilegrim",role:"Vandrer mot Nidaros",description:"Han sitter masserer sine sre ftter. En bredbremmet hatt med et kamskjell ligger p bordet, og vandringsstaven er slitt glatt av tusenvis av grep.",conversation:{start:{text:"Fred vre med deg, reisende. Kjenner du veien nordover? Mine ftter verker som om jeg har gtt p gldende kull, men sjelen... sjelen trekkes mot Hellig Olavs by.",options:[{label:"Hvorfor denne lange reisen?",nextId:"why"},{label:"Er det farlig langs veien?",nextId:"danger"},{label:"Fortell om kamskjellet.",nextId:"shell"},{label:"Lykke til videre. (G)",nextId:"EXIT"}]},why:{text:"For bot og bedring! Vi brer alle synder, min venn. Men i Nidaros, ved kongens skrin, er himmelen nrmere jorden. Det sies at en pilegrimsferd kan korte ned tiden i skjrsilden med mange r.",options:[{label:"Tror du virkelig p det?",nextId:"believe"},{label:"Hva hper du  finne?",nextId:"hope"}]},believe:{text:"Jeg *m* tro. Jeg har sett halte kaste krykkene og blinde f synet tilbake ved katedralen. Olavs kraft er sterk, selv om han har vrt dd i hundrevis av r. Han er Norges evige konge.",options:[{label:"Fortell om Olav.",nextId:"olav"}]},hope:{text:"Tilgivelse. Og kanskje litt sjelefred. Livet er hardt, vinteren er lang.  vite at man har gjort denne ofringen... det gir styrke.",options:[{label:"Forstelig.",nextId:"start"}]},danger:{text:" ja! Dovrefjell er ndelst. Snstormer kan komme midt p sommeren. Og i dalene lurer landeveisrvere som ser p oss pilegrimer som vandrende pengesekker. Men vi reiser ofte i flokk for beskyttelse.",options:[{label:"Har du blitt ranet?",nextId:"robbed"},{label:"Hvor sover dere?",nextId:"sjelehus"}]},robbed:{text:"Nesten. En gang, nr Gudbrandsdalen, s vi skygger i skogen. Vi sang salmer s hyt vi kunne, og drev dem bort med troens styrke! ...og kanskje fordi vi var frti stykker.",options:[{label:"God taktikk.",nextId:"danger"}]},sjelehus:{text:"Det finnes sjelehus  herberger bygget for Guds skyld  langs ruten. Der fr vi tak over hodet og enkel mat. Ofte deler vi rom med dyrene for varmen.",options:[{label:"Hres... koselig ut.",nextId:"danger"}]},shell:{text:"Ah, Ib-skjellet! Symbolet p St. Jakob. Dette viser at jeg har vandret helt til Santiago de Compostela i Spania. Jeg har sett verden, min venn. Fra nordlyset her til de solbrente slettene i sr.",options:[{label:"Du er en bereist mann.",nextId:"start"}]},olav:{text:"Han falt p Stiklestad i 1030. De sier at da de gravde ham opp et r senere, var kroppen like frisk, og hret og neglene hadde vokst! Det var beviset. Han kristnet oss med sverd, men reddet oss med sin hellighet.",options:[{label:"En mektig legende.",nextId:"start"}]}}},{id:"hansa",name:"Gerhard fra Lbeck",role:"Hansa-kjpmann",description:"Kledd i kostbar ull og pels. Han studerer en lang regnskapsrull med rynket panne og nipper til en vin som ser langt bedre ut enn husets vanlige.",conversation:{start:{text:"*Mumler p tysk* ...zwei schock, drei stck... Ah! En lokal? Si meg, har fiskerne i nord ftt opp farten? Mine skip venter i Bergen. Tid er penger, som vi sier i Lbeck.",options:[{label:"Hvem er du?",nextId:"intro"},{label:"Hvorfor er trrfisken s viktig?",nextId:"stockfish"},{label:"Hva er Hansaen egentlig?",nextId:"hansa_deep"},{label:"Jeg lar deg arbeide. (G)",nextId:"EXIT"}]},intro:{text:"Gerhard, handelsmann av Det Tyske Hanseforbund. Vi srger for at dere fr korn og mel, og at dere fr solgt den... vel, illeluktende fisken deres. En god byttehandel, *nicht wahr*?",options:[{label:"Vi klarer oss vel selv?",nextId:"monitor"},{label:"Takk for kornet.",nextId:"grain"}]},grain:{text:"Ja, det burde dere. Uten vrt baltiske korn ville mange nordmenn sultet nr avlingene svikter. Vi binder Nord-Europa sammen med vre kogger.",options:[{label:"Kogger?",nextId:"cog"}]},monitor:{text:"Haha! Tror du det? Uten oss ville fisken deres rtnet p stranden. Vi har nettverket. Vi har markedene i sr  katolikkene trenger fisk til fasten, og vi leverer.",options:[{label:"Dere tar stor fortjeneste.",nextId:"monopoly"}]},monopoly:{text:"Risiko koster! Stormer, pirater, kriger. Vi tar risikoen, vi tar profitten. Og vi har Kongens velsignelse... og privilegier. Vi dmmer vre egne p Bryggen.",options:[{label:"Egne lover?",nextId:"laws"}]},laws:{text:"Ja. En hanseat dmmes etter hansas lov, ikke norsk lov. Det... skaper litt friksjon med byborgerne, innrmmer jeg. Men handelen m flyte!",options:[{label:"Hres urettferdig ut.",nextId:"start"}]},stockfish:{text:'Det er "Det hvite gullet"! Trket i den kalde norske vinden blir den hard som tre og holder i revis. Perfekt mat for soldater og munker i hele Europa. Vi bytter det mot korn, klr, vin og krydder.',options:[{label:"En viktig ressurs.",nextId:"start"}]},hansa_deep:{text:"Et brorskap av handelsbyer. Lbeck, Hamburg, Rostock, Visby... og vrt kontor i Bergen. Vi beskytter hverandre mot konger som vil skattlegge oss for hardt, og mot sjrvere. Sammen er vi sterkere enn noe kongerike.",options:[{label:"Morsomt at du nevner pirater...",nextId:"pirates"},{label:"Imponerende.",nextId:"start"}]},pirates:{text:"Vitaliebrdrene... en plage! De herjer i stersjen. Men Hansaen har sine egne skip. Vi kan bite fra oss. Ikke tro at en kjpmann ikke kan svinge et sverd.",options:[{label:"Notert.",nextId:"EXIT"}]},cog:{text:"Vre skip. Brede, hye, med plass til enorme mengder last. De er ikke raske som vikingenes langskip, men de bygget vr rikdom. Ett skip kan f hele Bergen med korn.",options:[{label:"Teknologi er makt.",nextId:"start"}]}}},{id:"leilending",name:"Tormod",role:"Sliten Leilending",description:"Hendene hans er grove som bark, og ryggen er byd av r med plying. Han drikker tynt l og ser tankefullt ned i kruset.",conversation:{start:{text:"Enda en hst, enda en landskyld  betale. Livet til en leilending er  s for andre og hste smuler selv. Skl for det.",options:[{label:"Hva er landskyld?",nextId:"rent"},{label:"Hvorfor eier du ikke jorda?",nextId:"own"},{label:"Hvordan var det fr?",nextId:"plague"},{label:"Gr det s drlig? (G)",nextId:"EXIT"}]},rent:{text:"Leieavgiften. Jeg driver grden, men Kirken eier grunnen. Hvert r m jeg gi dem en fjerdedel av kornet, tre skippund smr og to kyr. Det som er igjen... det skal f familien min gjennom vinteren.",options:[{label:"Hva hvis avlingen svikter?",nextId:"fail"},{label:"Hvem bestemmer prisen?",nextId:"laws"}]},fail:{text:"Da sulter vi. Eller vi m lne skorn av jordeieren, og da havner vi dypere i gjeld. Det er en sirkel det er vanskelig  bryte.",options:[{label:"Trist skjebne.",nextId:"start"}]},own:{text:"F bnder eier sin egen jord n. Adelen og Kirken har kjpt opp nesten alt. Men jeg har i det minste *bygslebrev*. S lenge jeg betaler og driver jorda, kan de ikke kaste meg ut. Det er norsk lov.",options:[{label:"En viss trygghet.",nextId:"laws"}]},laws:{text:"Ja, Landsloven til Magnus Lagabte. Den gir oss rettigheter. Jordeieren kan ikke bare ta grden fordi han vil. Og jeg kan kreve at snnen min fr overta bygselen. Vi er ikke slaver, vi er frie menn... bare fattige.",options:[{label:"Viktig forskjell.",nextId:"start"}]},plague:{text:"*Han senker stemmen* Bestefar fortalte om Den Store Dden. Da to av tre dde. Etterp... etterp var det gode tider for de som overlevde. Masse ledig jord! Lav landskyld! N? N er vi mange igjen, og jordeierne strammer grepet.",options:[{label:"degrder?",nextId:"deserted"},{label:"Tidene skifter.",nextId:"start"}]},deserted:{text:"Ja, du kan fortsatt se ruinene i skogen. Grder der folk bodde fr, som n er grodd igjen. Noen sier det spker der, at de dde gr igjen og passer p arveslvet sitt.",options:[{label:"Grss.",nextId:"start"}]}}},{id:"steinhugger",name:"Master William",role:"Engelsk Steinhugger",description:"Han tegner geometriske figurer i slt l p bordet. Fingrene er hvite av steinstv.",conversation:{start:{text:"Ser du? Hvis du lfter buen *her*, og krysser hvelvet *slik*... da kan du bygge hyere enn fjellene! Ah, unnskyld. Jeg drmmer om stein.",options:[{label:"Bygger du katedralen?",nextId:"nidaros"},{label:"Du er ikke herfra?",nextId:"english"},{label:"Stein er bare stein. (G)",nextId:"EXIT"}]},nidaros:{text:"Kristkirken i Nidaros, ja! Verdens nordligste gotiske katedral. Vi hugger Kleberstein. Den er myk som smr nr den brytes, men blir hard som jern i luften. Et mirakulst materiale.",options:[{label:"Fortell om stilen.",nextId:"gothic"},{label:"Hvor lenge holder dere p?",nextId:"time"}]},gothic:{text:"Gotikk! Det er lysets arkitektur. I gamle dager bygget de tykke vegger og sm vinduer (romansk stil). N? Vi bruker strebepilarer p utsiden til  bre taket, s vi kan fylle veggene med glassmalerier. Guds lys strmmer inn!",options:[{label:"Hres vakkert ut.",nextId:"symbolism"}]},symbolism:{text:"Det er mer enn vakkert. Kirken er et bilde p himmelen. Hver syle, hver bue peker oppover. Nr bonden kommer inn fra gjrma, skal han fle at han trer inn i Guds rike.",options:[{label:"Mektig.",nextId:"start"}]},english:{text:"Nei, jeg kom fra Lincoln. Erkebiskopen hentet hndverkere fra England. Vi tar med oss kunnskapen om de nye stilene. Det er et internasjonalt laug, steinhuggerne. Vi reiser dit Gud og gullet kaller oss.",options:[{label:"Et reisende liv.",nextId:"start"}]},time:{text:'Haha! "Hvor lenge?" Min oldefar begynte. Jeg fortsetter. Mine barnebarn vil kanskje se spiret reise seg. En katedral bygges ikke for oss, men for evigheten.',options:[{label:"En tlmodighetsprve.",nextId:"EXIT"}]}}},{id:"vaering",name:"Halvdan",role:"Veteran fra Vringgarden",description:"Han brer en kappe av falmet, men kostbar silke. Et stygt arr deler venstre yenbryn i to. Han drikker ikke l, men vin fra en liten flaske.",conversation:{start:{text:"Dette stedet... det er kaldt, mrkt og lukter av vt hund. I Miklagard skinte solen p gulltakene hver dag, og keiserens hager duftet av sjasmin.",options:[{label:"Hvor er Miklagard?",nextId:"miklagard"},{label:"Var du en kriger?",nextId:"guard"},{label:"Hjemme best. (G)",nextId:"EXIT"}]},miklagard:{text:'"Den Store Byen". Konstantinopel! Verdens sentrum. Der mtes st og vest. Gatene er brolagt med marmor, og de har badehus med varmt vann i veggene! Kan du tenke deg? Varmt vann uten  koke det over bl!',options:[{label:"Utrolig.",nextId:"hagia"},{label:"Savner du det?",nextId:"miss"}]},hagia:{text:"Og Hagia Sofia... Guds Helligdoms Kirke. Kuppelen er s stor at den ser ut som om den henger i en gullkjede fra himmelen. Jeg har sett menn grte bare av  g inn der.",options:[{label:"M vre et syn.",nextId:"start"}]},guard:{text:'Vringgarden. Keiserens livvakt. Vi nordboere er hye, sterke og... vel, vi sviker ikke for penger. Grekerne er slueste folk, men de stoler bare p vre kser. "Pelekysphoroi" kaller de oss. ksebrere.',options:[{label:"Mtte dere slss?",nextId:"fight"},{label:"Ble du rik?",nextId:"rich"}]},fight:{text:"Mot sarasenere, mot bulgarere, mot opprrske generaler. Jeg har sett gresk ild  flytende flammer som brenner p vann! Det er djevelens verk, men effektivt.",options:[{label:"Gresk ild?",nextId:"start"}]},rich:{text:'Keiseren er sjeners. Nr han dr, har vi rett til  g gjennom skattkammeret og ta det vi kan bre. "Polutasvarf", kaller vi det. Palass-plyndring. Det er slik jeg fikk denne kappen... og denne ringen.',options:[{label:"En god pensjon.",nextId:"start"}]},miss:{text:"Hver vinter. Men her er min slekt, min jord. Og her snakker folk et sprk man kan forst. Men jeg vil alltid drmme om det Gyldne Horn.",options:[{label:"Skl for minnene.",nextId:"EXIT"}]}}},{id:"munk",name:"Broder Johannes",role:"Lrd Skrivermunk",description:"Fingrene hans er flekkete av blekk. Han myser, som om han er vant til  lese i drlig lys, og snakker lavmelt.",conversation:{start:{text:"Hysj. Hrer du stillheten? Nei, selvsagt ikke. Her er det sty. I skriptoriet hrer man bare fjrpennens skraping mot pergamentet. Guds ord som festes til huden.",options:[{label:"Hva skriver du?",nextId:"write"},{label:"Er du ikke ensom?",nextId:"lonely"},{label:"Jeg lar deg vre i fred. (G)",nextId:"EXIT"}]},write:{text:'Akkurat n? En kopi av "Kongespeilet"  *Konungs skuggsj*. En lrebok for prinser. Den forteller om hflighet, handel, stjernene og Guds orden. En klok konge m vre lrd, ikke bare sterk.',options:[{label:"Er bker dyre?",nextId:"expensive"},{label:"Hvem leser disse?",nextId:"readers"}]},expensive:{text:"Ufattelig. Et stort bibelverk krever skinnet fra 300 kalver! Tenk p flokken... og arbeidet.  forberede skinnet, blande blekket, male initialene med bladgull. En bok kan koste mer enn en grd.",options:[{label:"En skatt alts.",nextId:"start"}]},readers:{text:"De geistlige, kongen, og noen f adelige. Men kunnskapen risler nedover. Det vi bevarer i bibliotekene, er verdens hukommelse. Uten oss ville historien forsvinne i mrket.",options:[{label:"Et viktig ansvar.",nextId:"start"}]},lonely:{text:"Aldri. Jeg er omgitt av apostler, helgener og kirkefedrene. Augustin, Thomas Aquinas... de taler til meg gjennom sidene. Og brdrene i klosteret er min familie. Vi ber sammen, arbeider sammen.",options:[{label:"Ora et labora?",nextId:"rule"},{label:"Hres fredelig ut.",nextId:"start"}]},rule:{text:"Be og arbeid. Ja. Det er St. Benedikts regel. Lediggang er fienden av sjelen. S vi dyrker urter, brygger l (som dette, Guds gave!), og kopierer bker.",options:[{label:"Skl for let.",nextId:"EXIT"}]}}},{id:"pestlege",name:"Doktor Pestus",role:"Pestlege",description:"Han sitter litt for seg selv. En merkelig maske med nebb henger rundt halsen hans, og han lukter sterkt av eddik og trkede blomster.",conversation:{start:{text:"Ikke kom for nr! Balansen i vskene dine ser... urolig ut. Er du sangvinsk? Eller melankolsk? Luften her er tykk av miasma.",options:[{label:"Miasma?",nextId:"miasma"},{label:"Hva er masken til?",nextId:"mask"},{label:"Jeg er frisk! (G)",nextId:"EXIT"}]},miasma:{text:"Drlig luft! Sykdom kommer av rtten luft som stiger opp fra jorden eller fra syke kropper. Den forstyrrer balansen i kroppen  blod, slim, gul og svart galle. Pesten... den er den verste ubalansen.",options:[{label:"Svartedauden?",nextId:"plague"},{label:"Hvordan kurerer man det?",nextId:"cure"}]},plague:{text:"Den store dden. Den kom med et skip til Bergen i 1349. Jeg s hele landsbyer tmmes. Prester dde mens de ga den siste olje. Det var som om Gud hadde forlatt oss. De som overlevde... vi er merket.",options:[{label:"Forferdelig.",nextId:"social"}]},social:{text:"Men se rundt deg! De frre vi er, jo mer verdt er hver mann. Bndene krever bedre lnn n. Tjenestepikene gr med silke. Verden er snudd p hodet etter pesten.",options:[{label:"En ny tid.",nextId:"start"}]},mask:{text:"Nebbet fylles med urter. Nellik, roser, mynte. Sterk lukt motvirker den drlige luften. Det er som et filter mot dden selv. Og kappen er innsatt med voks s pestloppene glir av.",options:[{label:"Smart oppfinnelse.",nextId:"cure"}]},cure:{text:'relating for  fjerne ondt blod. Kopping. Og Theriak  en blanding av over 60 ingredienser, inkludert ormekjtt og opium. Det beste rdet? "Cito, longe, tarde." Dra fort, dra langt, kom sent tilbake.',options:[{label:"Skal huske det.",nextId:"EXIT"}]}}},{id:"birkebeiner",name:"Gunnar",role:"Birkebeiner-opprrer",description:"En hardfr mann med slitte klr, men sverdet ved beltet er velstelt. Han ser mistenksomt mot dren hver gang den pnes.",conversation:{start:{text:"Hvem holder du med? Kongen eller Kirken? Baglerne eller Birkebeinerne? Svar fort, fr let blir varmt.",options:[{label:"Birkebeinerne!",nextId:"birkebeiner"},{label:"Jeg blander meg ikke.",nextId:"neutral"},{label:"Baglerne?",nextId:"bagler"},{label:"Ingen. (G)",nextId:"EXIT"}]},birkebeiner:{text:"Godt svar! Vi er kong Sverres menn. Mange av oss startet med ingenting, med never rundt leggene i snen. Men vi kjemper for norges rettmessige konge mot biskopenes tyranni!",options:[{label:"Hvorfor hater dere biskopene?",nextId:"church"},{label:"Fortell om Kong Sverre.",nextId:"sverre"}]},bagler:{text:"*Han spytter p gulvet* Kirkens lpegutter. De vil at paven i Roma skal styre Norge, ikke kongen. Pass deg, ellers tror jeg du er en spion.",options:[{label:"Jeg mente det ikke snn.",nextId:"start"}]},neutral:{text:"Ingen kan vre nytrale i borgerkrig. Nr bror dreper bror, m man velge side. Men kanskje det er klokest  holde kjeft, ja.",options:[{label:"Nettopp.",nextId:"start"}]},church:{text:'Erkebiskopen vil ha makt. Han nekter  krone Sverre! Han lyste ham i bann! Men Sverre talte Roma midt imot. "En tale mot biskopene", kalte han det. Han sa at kirken er rtten, og at kongen er innsatt av Gud, ikke av Paven.',options:[{label:"Sterke ord.",nextId:"start"}]},sverre:{text:"En prest fra Fryene som ble konge! Han er liten av vekst, men en kjempe i klkt. Han lrte oss  slss p en ny mte. Ikke bare storme frem, men bruke terrenget, sl til og forsvinne. Gerilja, kaller de det visst i sr.",options:[{label:"En taktiker.",nextId:"EXIT"}]}}},{id:"kone",name:"Ragnhild",role:"Klok Kone",description:"En eldre kvinne med grtt hr flettet med fargerike bnd. Hun har en kurv full av trkede planter og rtter p bordet.",conversation:{start:{text:"Har du en plage, ungen min? En verkebyll? Kjrlighetssorg? Eller kanskje kua di har sluttet  melke? Naturen har en bot for alt, hvis man vet hvor man skal lete.",options:[{label:"Er du en heks?",nextId:"witch"},{label:"Har du noe mot sr?",nextId:"herbs"},{label:"Jeg tror p bnner. (G)",nextId:"EXIT"}]},witch:{text:"Hysj! Ikke bruk det ordet. Prestene brenner folk for mindre. Jeg er en hjelper. Jeg bruker bare Guds skaperverk. Er det trolldom  vite at groblad stanser bldning? Nei, det er kunnskap.",options:[{label:"Unnskyld.",nextId:"signs"},{label:"Hva med magi?",nextId:"magic"}]},herbs:{text:"Groblad for sr. Ryllik for feber. Og johannesurt for de tunge tankene som kommer om vinteren. Og honning... honning er bra for alt. Det holder betennelsen borte.",options:[{label:"Nyttig  vite.",nextId:"start"}]},signs:{text:"Man m lese tegnene. Hvis rogna brer mye br, blir vinteren sntung. Hvis krka skriker mot nord, kommer det gjester. Det er ikke magi, det er  lytte til verden.",options:[{label:"Klokt.",nextId:"start"}]},magic:{text:"*Hun lener seg frem* Det finnes krefter... de underjordiske. Nissen p lven, Huldra i skogen. Man m vise dem respekt. Ofre litt grt, litt l. Kirken liker det ikke, men bonden vet at det er best  holde seg inne med dem.",options:[{label:"Best  vre forsiktig.",nextId:"EXIT"}]}}},{id:"skald",name:"Einar Skald",role:"Hoff-poet",description:"Han sitter med lukkede yne og trommer rytmisk p bordet. Plutselig slr han ut med hnden og deklamerer en strofe.",conversation:{start:{text:'"Sverdets sang, blodets brang, ravnens fang..." Nei, nei. Det mangler bokstavrim. En god drpa skal vre som et vevd teppe, hver ord skal lse det neste.',options:[{label:"Hva er en drpa?",nextId:"drapa"},{label:"Fortell en saga!",nextId:"saga"},{label:"Du virker intens. (G)",nextId:"EXIT"}]},drapa:{text:'Det ypperste av kvad! Et hyllingsdikt til en fyrste eller konge. Det m ha "stef"  et omkved som gjentas. Hvis jeg gjr en feil i versefoten foran Jarlen, kan jeg miste hodet. Eller verre, miste min re.',options:[{label:"Hres vanskelig ut.",nextId:"oral"},{label:"Hva er versefot?",nextId:"poetry"}]},saga:{text:'Ah, historiene. Ikke bare dikt, men sannheten om vre forfedre. Som historien om Egil Skallagrimsson... kriger og poet. Han reddet sitt eget liv ved  dikte "Hodelsningen" til Eirik Blodks. Ord er makt, min venn.',options:[{label:"Fortell om Egil.",nextId:"egil"}]},egil:{text:"Han var stygg som juling, men sterk som en bjrn. Og han kunne drepe med et sverd i n hnd og dikte med den andre. En gang spydde han over en hirdmann som prvde  fornrme ham! En ekte helt.",options:[{label:"Fargerik type.",nextId:"start"}]},oral:{text:"Vi brer historien i hodet. Bker kan brenne, men et godt kvede lever p folkemunne i tusen r. Det er min oppgave.  srge for at kongens bedrifter aldri glemmes. Jeg er levende historie.",options:[{label:"Imponerende hukommelse.",nextId:"start"}]},poetry:{text:'Det er regler! Fornyrdislag, Ljogahtt... du m bruke "Kenninger". Du sier ikke "sverd", du sier "sr-isl". Du sier ikke "blod", du sier "sverd-vann". Det gjr sprket rikt og gtefullt.',options:[{label:"Vakkert sprk.",nextId:"EXIT"}]}}}];function lG(t,e,n){const{setActiveTab:s,setProductionContext:i,viewMode:r,setViewMode:a,viewingRegionId:o,setViewingRegionId:l,activeTab:u}=vf(),d=o||t.regionId||"capital",[f,h]=_.useState(null),[m,v]=_.useState(null),[b,y]=_.useState(null),[p,g]=_.useState(null),[x,w]=_.useState("start"),[N,T]=_.useState(!1),[E,A]=_.useState(!1),[k,R]=_.useState(!1),I=_.useCallback(j=>{if(j==="kingdom")return 0;if(j==="global")return 1;const O=lr.find(C=>C.id===j);return O!=null&&O.parentId?3:2},[]),[P,V]=_.useState(r),[$,K]=_.useState("in");if(r!==P){const j=I(P),O=I(r);O>j?K("in"):O<j&&K("out"),V(r)}_.useEffect(()=>{const j=O=>{if(O.key==="Escape"){if(u!=="MAP")return;if(b){y(null);return}if(N){T(!1);return}if(E){A(!1);return}if(p){g(null);return}if(m){v(null);return}if(f){h(null);return}if(r!=="kingdom"){const C=lr.find(Q=>Q.id===r),F=C!=null&&C.parentId?lr.find(Q=>Q.id===C.parentId):null;a(r==="global"?"kingdom":F?F.id:"global")}}};return window.addEventListener("keydown",j),()=>window.removeEventListener("keydown",j)},[r,b,N,E,p,m,f,a,u]);const B=_.useCallback((j,O)=>{const C=typeof O=="string"?O:O.type||O.id,F=H=>H==="windmill_stones"?{buildingId:"windmill",type:"REFINE"}:H==="sawmill_blade"?{buildingId:"sawmill",type:"REFINE"}:H==="smeltery_furnace"?{buildingId:"smeltery",type:"REFINE"}:H==="bakery_oven"?{buildingId:"bakery",type:"REFINE"}:H==="weavery_loom"?{buildingId:"weavery",type:"REFINE"}:H==="forge_anvil"?{buildingId:"great_forge",type:"CRAFT"}:H==="apothecary_bench"?{buildingId:"apothecary",type:"CRAFT"}:null;if(C==="OPEN_CHICKEN_COOP"){A(!0),h(null);return}if(C==="OPEN_GARRISON"){i({buildingId:"watchtower",type:"CRAFT",initialView:"PRODUCE"}),s("PRODUCTION"),h(null);return}if(C==="OPEN_CONSTRUCTION"){R(!0),h(null);return}const Q=F(j);if(Q&&(C==="OPEN_CRAFTING"||C==="CRAFT"||C==="REFINE"||C.startsWith("REFINE_")||C.startsWith("CRAFT_")||Rn[C]||C==="REPAIR")){i({...Q,initialView:C==="REPAIR"?"REPAIR":"PRODUCE"}),s("PRODUCTION"),h(null);return}const oe=d===t.regionId,be=t.role==="KING";if(!oe&&!be&&C!=="MARKET_VIEW"){alert("Du har ingen myndighet i dette baroniet.");return}if(C==="MARKET_VIEW")n();else if(C.startsWith("REFINE_")){const H=C.replace("REFINE_","").split("_")[0].toLowerCase();e({type:"REFINE",recipeId:{plank:"plank",flour:"flour",iron:"iron_ingot",steel:"iron_ingot",cloth:"cloth"}[H]||H})}else if(C.startsWith("CRAFT_")){const H=C.replace("CRAFT_","").toLowerCase();e(H==="bread"||H==="pie"||H==="mead"?{type:"REFINE",recipeId:H}:{type:"CRAFT",subType:H})}else if(C in Rn)e({type:"CRAFT",subType:C});else if(C.startsWith("BUILDING_UPGRADE_")){const H=C.replace("BUILDING_UPGRADE_","");y(H)}else if(C==="OPEN_DICE_GAME")T(!0);else if(C==="CHAT_LOCAL"){const H=B_[Math.floor(Math.random()*B_.length)];g(H),w("start")}else e(C==="BUY_MEAL"?{type:"BUY_MEAL"}:O);h(null)},[d,t,e,n,s,i,h]);return{viewMode:r,setViewMode:a,viewingRegionId:d,setViewingRegionId:l,selectedPOI:f,setSelectedPOI:h,selectedEvent:m,setSelectedEvent:v,upgradingBuildingId:b,setUpgradingBuildingId:y,dialogNPC:p,setDialogNPC:g,dialogStep:x,setDialogStep:w,isDiceGameOpen:N,setIsDiceGameOpen:T,isChickenCoopOpen:E,setIsChickenCoopOpen:A,isConstructionOpen:k,setIsConstructionOpen:R,direction:$,handlePOIAction:B}}const cG=({playerGold:t,onClose:e,onPlay:n})=>{const[s,i]=_.useState(1),[r,a]=_.useState(!1),[o,l]=_.useState([1,1]),[u,d]=_.useState([1,1]),[f,h]=_.useState("Plasser din innsats..."),[m,v]=_.useState(t);Ee.useEffect(()=>{v(t)},[t]);const b=()=>Math.floor(Math.random()*6)+1,y=()=>{if(r)return;if(s>t){h("Du har ikke nok gull!");return}if(s<.5){h("Minstesats er 0.5g");return}a(!0),h("Terningene ruller...");let x=0;const w=10,N=setInterval(()=>{l([b(),b()]),d([b(),b()]),x++,x>=w&&(clearInterval(N),p())},100)},p=()=>{const x=b(),w=b(),N=b(),T=b(),E=x+w,A=N+T;l([x,w]),d([N,T]);const k=E>A;k?(h(`DU VANT! ${E} mot ${A}`),v(R=>R+s)):(h(`HUSET VANT. ${A} mot ${E}`),v(R=>Math.max(0,R-s))),n({amount:s,isWin:k,playerRoll:E,houseRoll:A}),a(!1)},g=(x,w)=>c.jsx("div",{className:`w-16 h-16 rounded-xl shadow-[inset_0_0_10px_rgba(0,0,0,0.5)] flex bg-gradient-to-br ${w==="player"?"from-white to-slate-200 text-black":"from-red-600 to-red-800 text-white"} relative transition-transform duration-100 ${r?"animate-bounce":""}`,children:c.jsx("div",{className:"grid grid-cols-3 grid-rows-3 w-full h-full p-2 gap-1",children:[...Array(9)].map((N,T)=>{let E=!1;return x===1&&T===4&&(E=!0),x===2&&(T===0||T===8)&&(E=!0),x===3&&(T===0||T===4||T===8)&&(E=!0),x===4&&(T===0||T===2||T===6||T===8)&&(E=!0),x===5&&(T===0||T===2||T===4||T===6||T===8)&&(E=!0),x===6&&(T===0||T===2||T===3||T===5||T===6||T===8)&&(E=!0),c.jsx("div",{className:"flex items-center justify-center",children:E&&c.jsx("div",{className:`w-3 h-3 rounded-full ${w==="player"?"bg-black":"bg-white"} shadow-sm`})},T)})})});return c.jsxs("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/90 backdrop-blur-sm animate-in fade-in duration-500",children:[c.jsxs("div",{className:"absolute inset-0 z-0 opacity-50",children:[c.jsx("img",{src:"/Simulation_StandAlone_Pro/poi/tavern_dice_bg.png",alt:"Tavern Table",className:"w-full h-full object-cover"}),c.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-transparent to-black"})]}),c.jsxs("div",{className:"relative z-10 bg-[#1a472a]/90 border-[4px] border-[#5d4037] rounded-[2rem] shadow-[0_50px_100px_rgba(0,0,0,0.8)] w-full max-w-2xl overflow-hidden backdrop-blur-md",children:[c.jsx("div",{className:"absolute inset-0 border-2 border-[#8d6e63] rounded-[1.2rem] pointer-events-none opacity-50"}),c.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-[#d7ccc8] hover:text-white transition-colors bg-black/20 hover:bg-black/40 rounded-full w-8 h-8 flex items-center justify-center font-bold z-50",children:""}),c.jsxs("div",{className:"p-8 flex flex-col items-center gap-8 relative",children:[c.jsxs("div",{className:"text-center space-y-1",children:[c.jsx("h2",{className:"text-3xl font-black text-[#ffecb3] uppercase tracking-widest drop-shadow-md",style:{fontFamily:"serif"},children:"Spillebordet"}),c.jsx("div",{className:"text-[#a5d6a7] font-bold tracking-wider text-sm",children:"Huset vinner ved uavgjort"}),c.jsx("div",{className:"text-xs text-white/50 uppercase tracking-widest font-black",children:"Lykke til!"})]}),c.jsxs("div",{className:"flex justify-between w-full px-8 gap-8",children:[c.jsxs("div",{className:"flex flex-col items-center gap-4",children:[c.jsxs("span",{className:"text-[#90caf9] font-black uppercase tracking-widest text-xs",children:["Deg (",o[0]+o[1],")"]}),c.jsxs("div",{className:"flex gap-3",children:[g(o[0],"player"),g(o[1],"player")]})]}),c.jsx("div",{className:"flex items-center justify-center",children:c.jsx("span",{className:"text-2xl font-black text-white/20",children:"VS"})}),c.jsxs("div",{className:"flex flex-col items-center gap-4",children:[c.jsxs("span",{className:"text-[#ef9a9a] font-black uppercase tracking-widest text-xs",children:["Huset (",u[0]+u[1],")"]}),c.jsxs("div",{className:"flex gap-3",children:[g(u[0],"house"),g(u[1],"house")]})]})]}),c.jsx("div",{className:`h-12 flex items-center justify-center w-full bg-black/30 rounded-xl border border-white/5 transition-all ${f.includes("VANT")?"bg-green-900/40 border-green-500/30":f.includes("tapte")?"bg-red-900/40 border-red-500/30":""}`,children:c.jsx("span",{className:"font-bold text-lg text-[#fff8e1] tracking-wide",children:f})}),c.jsxs("div",{className:"w-full bg-black/20 p-6 rounded-2xl border border-white/5 flex flex-col gap-4",children:[c.jsxs("div",{className:"flex justify-between items-center text-[#d7ccc8] font-bold text-sm uppercase tracking-widest",children:[c.jsx("span",{children:"Innsats"}),c.jsxs("span",{children:["Din Saldo: ",c.jsxs("span",{className:"text-[#ffd54f]",children:[m.toFixed(1),"g"]})]})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("input",{type:"range",min:.5,max:Math.min(t,100),step:.5,value:s,onChange:x=>i(parseFloat(x.target.value)),className:"w-full h-3 bg-black/50 rounded-lg appearance-none cursor-pointer accent-[#ffb74d]",disabled:r}),c.jsxs("div",{className:"bg-black/40 px-4 py-2 rounded-xl text-[#ffd54f] font-black min-w-[5rem] text-center border border-white/10",children:[s,"g"]})]}),c.jsx("div",{className:"grid grid-cols-4 gap-2",children:[1,5,10,50].map(x=>c.jsxs("button",{onClick:()=>i(x),disabled:x>t||r,className:`py-1 rounded-lg text-xs font-bold uppercase tracking-widest transition-colors ${s===x?"bg-[#ffb74d] text-black":"bg-white/5 text-[#d7ccc8] hover:bg-white/10"}`,children:[x,"g"]},x))}),c.jsx("button",{onClick:y,disabled:r||t<s,className:`w-full py-4 rounded-xl font-black uppercase tracking-widest text-lg shadow-lg transform transition-all active:scale-[0.98] ${r?"bg-gray-600 cursor-not-allowed opacity-50":"bg-gradient-to-r from-[#ffca28] to-[#ff6f00] text-black hover:brightness-110 shadow-orange-900/40"}`,children:r?"Ruller...":"KAST TERNINGENE!"})]})]})]})]})};class uG{constructor(){$e(this,"listeners",[])}subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(n=>n!==e)}}emit(e){this.listeners.forEach(n=>n(e))}spawnFloatingText(e,n,s,i){const r=(Math.random()-.5)*4,a=(Math.random()-.5)*4;this.emit({id:Math.random().toString(36).substr(2,9),type:"FLOATING_TEXT",text:e,x:n+r,y:s+a,color:i,duration:1500})}spawnFlyingResource(e,n,s,i,r){this.emit({id:Math.random().toString(36).substr(2,9),type:"FLYING_RESOURCE",resource:e,startPoint:{x:n,y:s},endPoint:{x:i,y:r},duration:1e3})}spawnParticles(e,n,s){this.emit({id:Math.random().toString(36).substr(2,9),type:"PARTICLE",x:e,y:n,color:s,duration:800})}}const Ge=new uG,dG=({onComplete:t})=>{const[e,n]=_.useState([]),[s,i]=_.useState(!1),r=20,a=o=>{if(s)return;const l=o.currentTarget.getBoundingClientRect(),u=(o.clientX-l.left)/l.width*100,d=(o.clientY-l.top)/l.height*100,f={x:u,y:d,id:Date.now()};Ge.spawnParticles(u,d,"bg-emerald-400"),n(h=>{const m=[...h,f];return m.length>=r&&(i(!0),setTimeout(()=>t(1),1500)),m})};return c.jsxs("div",{onClick:a,className:"w-full h-[600px] relative overflow-hidden cursor-crosshair group active:scale-[0.99] transition-transform select-none",style:{backgroundImage:'url("/images/minigames/agriculture_bg.png")',backgroundSize:"cover",backgroundPosition:"center"},children:[c.jsx("div",{className:"absolute inset-0 bg-black/40 z-0 pointer-events-none"}),c.jsx("div",{className:"absolute top-10 left-1/2 -translate-x-1/2 pointer-events-none z-20 text-center",children:s?c.jsx("div",{className:"animate-in zoom-in duration-300",children:c.jsx("h2",{className:"text-5xl font-black text-emerald-400 drop-shadow-[0_4px_0_rgba(0,0,0,0.5)] uppercase tracking-tighter animate-bounce",children:"Mestrerlig Sdd! "})}):c.jsxs(c.Fragment,{children:[c.jsx("h2",{className:"text-3xl font-black text-white drop-shadow-md mb-2",children:"S dine fr"}),c.jsxs("div",{className:"bg-black/40 px-4 py-1 rounded-full text-emerald-400 font-bold uppercase tracking-widest text-sm inline-block",children:[e.length," / ",r]})]})}),e.map(o=>c.jsx("div",{className:"absolute w-4 h-4 bg-emerald-400 rounded-full shadow-[0_0_10px_rgba(52,211,153,0.8)] animate-in zoom-in duration-300",style:{left:`${o.x}%`,top:`${o.y}%`,transform:"translate(-50%, -50%)"},children:c.jsx("div",{className:"absolute -top-4 left-1/2 -translate-x-1/2 w-0.5 h-3 bg-white/50"})},o.id)),c.jsx("div",{className:"absolute inset-0 pointer-events-none z-10 hidden group-hover:block",children:c.jsx("div",{className:"absolute w-8 h-8 border-2 border-white/50 rounded-full -translate-x-1/2 -translate-y-1/2"})})]})},Yc=({onComplete:t,equipment:e=[],isMining:n,isQuarrying:s,isForaging:i,speedMultiplier:r=1,possibleYield:a=10,resourceName:o="Ressurs"})=>{const[l,u]=_.useState(0),[d,f]=_.useState([]),[h,m]=_.useState(!1),[v,b]=_.useState(!1),[y,p]=_.useState(!1),g=_.useRef(1),[x,w]=_.useState(50),N=_.useRef(1);_.useEffect(()=>{const A=k=>{k.code==="Space"&&(k.preventDefault(),T())};return window.addEventListener("keydown",A),()=>window.removeEventListener("keydown",A)},[d,h,l,x,e,r,y]),_.useEffect(()=>{if(d.length>=5||h||y)return;const A=setInterval(()=>{u(k=>{let R=2/r,I=k+R*g.current;return I>100?(g.current=-1,100):I<0?(g.current=1,0):I}),w(k=>{let I=k+.3*N.current;return Math.random()<.02&&(N.current*=-1),I>80?(N.current=-1,80):I<20?(N.current=1,20):I})},16);return()=>clearInterval(A)},[d.length,h,r,y]);const T=()=>{var B,j,O;if(d.length>=5||h||y)return;const A=Math.abs(l-x);let k=A<5?1:A<15?.7:A<25?.4:.1;const R=n?"MINE":s?"QUARRY":i?"FORAGE":"WORK",I=SS(R,e||[]);console.log(`[HarvestingGame] Init. Action: ${R}. Equipment Count: ${e==null?void 0:e.length}. Best Tool:`,I);const P=((B=I==null?void 0:I.stats)==null?void 0:B.yieldBonus)||(I&&wi(I)?(O=(j=Se[wi(I)])==null?void 0:j.stats)==null?void 0:O.yieldBonus:0)||0,V=Math.ceil(a/5*(.5+k)),$=Math.ceil(P/5*(.5+k));A<15?(b(!0),p(!0),Ge.spawnParticles(50,40,A<5?"bg-amber-400":"bg-white"),A<5?Ge.spawnFloatingText(`PERFEKT! + ${V} ${$>0?`(+${$})`:""} `,50,40,"text-amber-400 font-black text-2xl"):Ge.spawnFloatingText(`Bra! +${V}`,50,40,"text-white font-bold"),setTimeout(()=>{b(!1),p(!1)},100)):Ge.spawnFloatingText("Svakt...",50,40,"text-slate-500 font-bold");const K=[...d,k];f(K),K.length===5&&(m(!0),setTimeout(()=>t(K.reduce((C,F)=>C+F,0)/5),800))},E=n||s?'url("/images/minigames/mining_bg.png")':i?'url("/images/minigames/foraging_bg.png")':'url("/images/minigames/agriculture_bg.png")';return c.jsxs("div",{className:`p-8 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden ${v?"animate-shake":""} `,style:{backgroundImage:E,backgroundSize:"cover",backgroundPosition:"center"},children:[c.jsx("div",{className:`absolute inset-0 bg-black/70 z-0 transition-all duration-75 ${y?"bg-indigo-900/50 mix-blend-hard-light":""}`}),c.jsxs("div",{className:`relative z-10 w-full flex flex-col items-center transition-all duration-75 ${y?"scale-105 brightness-150 contrast-125":""}`,children:[c.jsx("h2",{className:"text-4xl font-black text-white mb-8 drop-shadow-lg tracking-tighter uppercase",children:n?"Gruvedrift":s?"Steinhugger":i?"Sanking":"Kornhsting"}),h?c.jsx("div",{className:"py-12 animate-bounce text-5xl font-black text-amber-500 uppercase tracking-tighter drop-shadow-[0_0_20px_rgba(245,158,11,0.5)]",children:"FERDIG! "}):c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"mb-4 text-xs font-black text-amber-500 uppercase tracking-widest",children:o}),c.jsxs("div",{className:"w-full h-8 bg-white/5 rounded-full mb-12 relative border border-white/10 overflow-hidden shadow-inner",children:[c.jsx("div",{className:"absolute inset-y-0 bg-amber-500/30 border-x border-amber-500/50 transition-all duration-75 linear",style:{left:`${x-8}%`,right:`${100-(x+8)}%`}}),c.jsx("div",{className:"absolute inset-y-0 w-0.5 bg-amber-400/80 z-0",style:{left:`${x}%`}}),c.jsx("div",{className:"absolute inset-y-0 w-1 bg-white shadow-[0_0_20px_white] z-10",style:{left:`${l}% `}})]}),c.jsx("button",{onClick:T,className:`w-full bg-amber-500 hover:bg-amber-400 text-slate-950 py-7 rounded-[2rem] font-black text-2xl shadow-2xl transition-all uppercase tracking-widest border-b-4 border-amber-700 ${y?"scale-95 brightness-125":"active:scale-95"}`,children:"KLIKK N! "})]})]})]})},fG=({onComplete:t,speedMultiplier:e=1})=>{const[n,s]=_.useState(50),[i,r]=_.useState(50),[a,o]=_.useState(0),[l,u]=_.useState(!1),[d,f]=_.useState(!1),[h,m]=_.useState(!1),v=_.useRef(1);_.useEffect(()=>{if(l||h)return;const y=setInterval(()=>{s(p=>{let g=p+.8*v.current*e;return g>90?(v.current=-1,90):g<10?(v.current=1,10):g})},16);return()=>clearInterval(y)},[l,e,h]),_.useEffect(()=>{const y=p=>{p.code==="Space"&&(p.preventDefault(),b({clientX:window.innerWidth/2,clientY:window.innerHeight/2}))};return window.addEventListener("keydown",y),()=>window.removeEventListener("keydown",y)},[l,i,n,h]);const b=y=>{if(l||h)return;const p=Math.abs(i-n),g=y.clientX,x=y.clientY;p<12?(f(!0),m(!0),o(w=>{const N=w+1;return N>=5&&(u(!0),Ge.spawnFloatingText("MESTERVERK! ",g,x-60,"text-amber-400 text-3xl font-black"),setTimeout(()=>t(1),1200)),N}),Ge.spawnParticles(g,x,"bg-amber-400"),Ge.spawnFloatingText("KLANG!",g,x-40,"text-amber-500 font-black"),setTimeout(()=>{f(!1),m(!1)},100)):p<25?(Ge.spawnFloatingText("Treff",g,x-40,"text-white font-bold"),Ge.spawnParticles(g,x,"bg-white")):Ge.spawnFloatingText("BOM!",g,x-40,"text-slate-500 font-bold")};return c.jsxs("div",{onMouseMove:y=>{const p=y.currentTarget.getBoundingClientRect();r((y.clientX-p.left)/p.width*100)},onClick:b,className:`p-12 min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden cursor-crosshair ${d?"animate-shake":""}`,style:{backgroundImage:'url("/images/minigames/smithing_bg.png")',backgroundSize:"cover"},children:[c.jsx("div",{className:`absolute inset-0 bg-black/70 z-0 transition-all duration-75 ${h?"bg-amber-900/40 mix-blend-hard-light":""}`}),c.jsxs("div",{className:`relative z-10 text-center mb-12 transition-all duration-75 ${h?"scale-105 brightness-150 contrast-125":""}`,children:[c.jsx("h2",{className:"text-4xl font-black text-white uppercase tracking-tighter drop-shadow-xl",children:"Smedarbeid"}),c.jsxs("div",{className:"text-amber-500 font-black uppercase tracking-widest text-xs mt-2 bg-black/40 px-4 py-1 rounded-full border border-amber-500/20",children:["Slag: ",a," / 5"]})]}),c.jsxs("div",{className:`relative z-10 w-full max-w-2xl space-y-4 transition-all duration-75 ${h?"scale-105":""}`,children:[c.jsxs("div",{className:"w-full h-24 bg-slate-900/50 rounded-2xl border-2 border-white/10 shadow-2xl flex items-center px-4 overflow-hidden",children:[c.jsx("div",{className:"absolute inset-0 bg-amber-500/5 transition-all duration-1000",style:{opacity:a/5}}),c.jsxs("div",{className:"relative w-full h-4 bg-white/5 rounded-full overflow-hidden",children:[c.jsx("div",{className:"absolute inset-y-0 w-24 bg-amber-500/40 blur-sm mix-blend-screen transition-all duration-75",style:{left:`${n}%`,transform:"translateX(-50%)"}}),c.jsx("div",{className:"absolute inset-y-0 w-12 bg-white/40 blur-[2px]",style:{left:`${n}%`,transform:"translateX(-50%)"}}),c.jsx("div",{className:"absolute inset-y-0 w-1 bg-white shadow-[0_0_15px_white] z-20",style:{left:`${i}%`,transform:"translateX(-50%)"}})]})]}),c.jsxs("div",{className:"flex items-center gap-4 px-2",children:[c.jsx("div",{className:"flex-1 h-2 bg-black/40 rounded-full overflow-hidden border border-white/5",children:c.jsx("div",{className:"h-full bg-gradient-to-r from-amber-600 to-amber-400 transition-all duration-500",style:{width:`${a/5*100}%`}})}),c.jsxs("span",{className:"text-[10px] font-black text-amber-500 uppercase tracking-widest",children:[Math.round(a/5*100),"%"]})]})]}),l&&c.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm animate-in fade-in zoom-in duration-300",children:c.jsx("div",{className:"text-6xl font-black text-amber-500 animate-bounce drop-shadow-[0_0_30px_rgba(245,158,11,0.5)]",children:"FERDIG! "})}),c.jsx("div",{className:`mt-12 text-slate-400 text-sm font-bold uppercase tracking-widest animate-pulse relative z-10 transition-opacity ${h?"opacity-0":"opacity-100"}`,children:"Klikk nr markren er over den gldende sonen"})]})},hG=({onComplete:t,speedMultiplier:e=1,icon:n=""})=>{const[s,i]=_.useState(0),[r,a]=_.useState(!1),[o,l]=_.useState(null),[u,d]=_.useState(0),[f,h]=_.useState(80),m=_.useRef(-1);_.useEffect(()=>{if(r||o)return;const b=setInterval(()=>{i(p=>{const g=p+1*e;return g>=100?(l("BRENT! "),setTimeout(()=>{l(null),i(0)},1e3),0):g})},50),y=setInterval(()=>{h(p=>{let x=p+.8*m.current;return x>90?(m.current=-1,90):x<40?(m.current=1,40):x})},50);return()=>{clearInterval(b),clearInterval(y)}},[r,o,e]),_.useEffect(()=>{const b=y=>{y.code==="Space"&&(y.preventDefault(),v())};return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[r,o,s,f]);const v=()=>{if(r||o)return;const b=f-10,y=f+10;s>b&&s<y?(l("PERFEKT GYLLEN! "),d(p=>{const g=p+1;return g>=3&&(a(!0),setTimeout(()=>t(1),1e3)),g})):s<b?l("R... "):l("LITT BRENT... "),setTimeout(()=>{l(null),i(0)},1e3)};return c.jsxs("div",{className:"p-12 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden",style:{backgroundImage:'url("/images/minigames/bakery_bg.png")',backgroundSize:"cover"},children:[c.jsx("div",{className:"absolute inset-0 bg-black/70 z-0"}),c.jsx("h2",{className:"relative z-10 text-4xl font-black text-white mb-8 tracking-tighter uppercase italic",children:"Bakeri: Steking "}),c.jsxs("div",{className:"relative z-10 w-64 h-64 bg-slate-900 border-8 border-amber-900 rounded-3xl flex items-center justify-center overflow-hidden mb-12 shadow-2xl",children:[c.jsx("div",{className:"absolute inset-0 bg-orange-500/10 animate-pulse"}),c.jsx("div",{className:"text-8xl transition-all duration-300 transform",style:{filter:`grayscale(${100-s}%) sepia(${s}%)`,transform:`scale(${.8+s/500})`},children:n}),o&&c.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center text-white font-black text-2xl p-4 animate-in zoom-in",children:o})]}),c.jsxs("div",{className:`relative z-10 w-full max-w-sm h-8 bg-white/10 rounded-full mb-12 border ${s>f-10&&s<f+10?"border-emerald-500 shadow-[0_0_15px_rgba(16,185,129,0.5)]":"border-white/10"} overflow-hidden transition-all shadow-2xl`,children:[c.jsx("div",{className:"absolute inset-y-0 bg-emerald-500/30 border-x border-emerald-500/50 transition-all duration-75 ease-linear",style:{left:`${f-10}%`,right:`${100-(f+10)}%`},children:s>f-10&&s<f+10&&c.jsx("div",{className:"absolute inset-0 bg-emerald-400/20 animate-pulse"})}),c.jsx("div",{className:"h-full bg-orange-500 transition-all duration-75 relative z-10 opacity-80",style:{width:`${s}% `}}),c.jsx("div",{className:"absolute top-0 bottom-0 w-1 bg-white/50 z-20",style:{left:`${f}%`}})]}),c.jsx("div",{className:"relative z-10 flex gap-4 mb-8",children:[...Array(3)].map((b,y)=>c.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center text-2xl border-2 transition-all ${u>y?"bg-amber-500 border-amber-300 scale-110 shadow-lg":"bg-white/5 border-white/10 opacity-30"} `,children:n},y))}),c.jsx("button",{onClick:v,className:"relative z-10 w-full max-w-sm bg-amber-600 hover:bg-amber-500 text-white py-6 rounded-2xl font-black text-2xl shadow-xl active:scale-95 transition-all uppercase tracking-widest border-b-8 border-amber-800",children:"TA UT N! "})]})},mG=(t,e)=>{if(e)return e.find(n=>{var r;if(!n)return!1;const s=Object.keys(Se).find(a=>n.id===a||n.id.startsWith(a+"_")),i=s?Se[s]:null;return(r=i==null?void 0:i.relevantActions)==null?void 0:r.includes(t)})},pG=({onComplete:t,equipment:e=[]})=>{const[n,s]=_.useState(0),[i,r]=_.useState(!1),[a,o]=_.useState(!1),[l,u]=_.useState(0),[d,f]=_.useState({x:50,y:50}),[h,m]=_.useState(!1),v=()=>f({x:20+Math.random()*60,y:20+Math.random()*60}),b=p=>{if(a)return;o(!0),r(!0);const g=n+1;s(g);const x=g>5,w=g>2?`${g}x COMBO!`:x?"FLAWLESS!":"TREFF!",N=x?"text-amber-400 font-display":"text-white";Ge.spawnFloatingText(w,p.clientX,p.clientY-40,N),Ge.spawnParticles(p.clientX,p.clientY,x?"bg-amber-400":"bg-white"),setTimeout(()=>{o(!1),r(!1),u(T=>(T+1>=10&&(m(!0),Ge.spawnFloatingText("FULLFRT! ",p.clientX,p.clientY-100,"text-emerald-400 text-2xl"),setTimeout(()=>t(1),1200)),T+1)),v()},80)},y=mG("CHOP",e);return c.jsxs("div",{className:`p-8 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden ${i?"animate-shake":""} `,style:{backgroundImage:'url("/images/minigames/forestry_bg.png")',backgroundSize:"cover"},children:[c.jsx("div",{className:"absolute inset-0 bg-black/60 z-0"}),c.jsx("div",{className:"relative z-10 w-full mb-8",children:c.jsxs("div",{className:"flex flex-col items-center gap-2",children:[c.jsx("h2",{className:"text-4xl font-black text-white drop-shadow-lg tracking-tighter uppercase",children:"Tmmerhogging"}),c.jsxs("div",{className:"flex gap-4",children:[c.jsxs("div",{className:"text-amber-400 font-black uppercase tracking-widest text-xs px-4 py-1 bg-black/40 rounded-full inline-block border border-amber-500/20",children:["Framdrift: ",l,"/10"]}),n>0&&c.jsxs("div",{className:"text-rose-500 font-black uppercase tracking-widest text-xs px-4 py-1 bg-rose-500/10 rounded-full inline-block border border-rose-500/30 animate-bounce",children:["COMBO: x",n]}),y&&c.jsxs("div",{className:"text-indigo-400 font-black uppercase tracking-widest text-xs px-4 py-1 bg-indigo-500/10 rounded-full inline-block border border-indigo-500/30",children:[y.icon," ",y.name]})]})]})}),c.jsxs("div",{className:`relative z-10 w-full h-96 bg-white/5 rounded-[3rem] border border-white/10 shadow-inner overflow-hidden ${a?"opacity-90 grayscale-[0.5]":""}`,children:[c.jsx("div",{className:"absolute bottom-0 left-0 h-2 bg-indigo-500/50 transition-all duration-300 z-0",style:{width:`${l/10*100}%`}}),h?c.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-4",children:[c.jsx("div",{className:"animate-bounce text-5xl font-black text-amber-500 uppercase tracking-tighter drop-shadow-2xl",children:"VEDHOGST FERDIG! "}),c.jsxs("div",{className:"text-xl font-black text-white uppercase tracking-widest bg-indigo-600 px-8 py-2 rounded-full shadow-lg",children:["Maks Combo: ",n]})]}):c.jsx("button",{onClick:b,className:`absolute w-20 h-20 bg-rose-500 rounded-full border-4 border-white shadow-[0_0_30px_rose] transition-all active:scale-90 ${a?"scale-110 brightness-150":"animate-pulse cursor-pointer"}`,style:{left:`${d.x}%`,top:`${d.y}%`,transform:"translate(-50%, -50%)"},children:""})]})]})},gG=(t,e)=>{if(e)return e.find(n=>{var r;if(!n)return!1;const s=Object.keys(Se).find(a=>n.id===a||n.id.startsWith(a+"_")),i=s?Se[s]:null;return(r=i==null?void 0:i.relevantActions)==null?void 0:r.includes(t)})},U_=({onComplete:t,equipment:e=[],speedMultiplier:n=1,possibleYield:s=10,resourceName:i="Korn"})=>{const[r,a]=_.useState(0),[o,l]=_.useState(0),[u,d]=_.useState(!1),[f,h]=_.useState(!1),[m,v]=_.useState(!1),b=()=>{u||m||a(y=>{var g;const p=y+2*n;if(p>=100){const x=gG("WORK",e),w=((g=x==null?void 0:x.stats)==null?void 0:g.yieldBonus)||0,N=Math.ceil(s/5*1.25),T=Math.ceil(w/5*1.25);return h(!0),v(!0),Ge.spawnFloatingText(`+ ${N} ${i} ${T>0?`(+${T})`:""} `,50,40,"text-amber-400 font-black text-xl"),Ge.spawnParticles(50,50,"bg-emerald-400"),setTimeout(()=>{h(!1),v(!1)},100),l(E=>(E+1>=5&&(d(!0),setTimeout(()=>t(1),800)),E+1)),0}return p})};return c.jsxs("div",{onMouseMove:b,className:`p-8 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden ${f?"animate-shake":""} `,style:{backgroundImage:'url("/images/minigames/agriculture_bg.png")',backgroundSize:"cover"},children:[c.jsx("div",{className:`absolute inset-0 bg-black/50 z-0 transition-all duration-75 ${m?"bg-emerald-900/40 mix-blend-hard-light":""}`}),c.jsxs("div",{className:`relative z-10 w-full flex flex-col items-center transition-all duration-75 ${m?"scale-105 brightness-150 contrast-125":""}`,children:[c.jsx("h2",{className:"text-3xl font-black text-white mb-4",children:"Scythe Sweep"}),c.jsx("div",{className:"w-full h-4 bg-white/10 rounded-full mb-8 border border-white/20 overflow-hidden",children:c.jsx("div",{className:"h-full bg-amber-400 transition-all duration-75",style:{width:`${r}% `}})}),c.jsx("div",{className:"grid grid-cols-5 gap-2",children:[...Array(5)].map((y,p)=>c.jsx("div",{className:`w-8 h-8 rounded-lg border-2 ${o>p?"bg-amber-500 border-amber-300":"border-white/20"} `},p))}),c.jsx("div",{className:"mt-8 text-slate-400 text-sm font-bold uppercase tracking-widest animate-pulse",children:"Beveg musen raskt frem og tilbake!"})]})]})},vG=({onComplete:t,speedMultiplier:e=1})=>{const[n,s]=_.useState(0),[i,r]=_.useState(0),[a,o]=_.useState(!1),[l,u]=_.useState(50),[d,f]=_.useState(1);_.useEffect(()=>{if(a)return;const m=setInterval(()=>{s(v=>{let b=3/e,y=v+b*d;return y>100?(f(-1),100):y<0?(f(1),0):y})},16);return()=>clearInterval(m)},[d,a,e]);const h=()=>{Math.abs(n-l)<10&&(r(v=>(Ge.spawnFloatingText("FANT DEN! ",50,40,"text-sky-400"),v+1>=3&&(o(!0),setTimeout(()=>t(1),800)),v+1)),u(20+Math.random()*60))};return c.jsxs("div",{className:"p-12 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden",style:{backgroundImage:'url("/images/minigames/foraging_bg.png")',backgroundSize:"cover"},children:[c.jsx("div",{className:"absolute inset-0 bg-black/70 z-0"}),c.jsx("h2",{className:"relative z-10 text-4xl font-black text-white mb-12 tracking-tighter uppercase italic",children:"Snarefiske "}),c.jsxs("div",{className:"relative z-10 w-full max-w-sm h-12 bg-white/5 rounded-full border border-white/10 mb-12 shadow-inner",children:[c.jsx("div",{className:"absolute inset-y-0 w-20 bg-amber-500/40 border-x-2 border-amber-500/50 rounded-lg blur-[2px]",style:{left:`${l}% `,transform:"translateX(-50%)"}}),c.jsx("div",{className:"absolute inset-y-0 w-2 bg-white shadow-[0_0_15px_white]",style:{left:`${n}% `}})]}),c.jsx("div",{className:"relative z-10 flex gap-4 mb-12",children:[...Array(3)].map((m,v)=>c.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center text-2xl border-2 transition-all ${i>v?"bg-amber-500 border-amber-300 scale-110":"bg-white/5 border-white/10 opacity-30 shadow-inner"} `,children:""},v))}),c.jsx("button",{onClick:h,className:"relative z-10 w-full max-w-md bg-sky-500 hover:bg-sky-400 text-white py-7 rounded-[2rem] font-black text-2xl shadow-2xl active:scale-95 transition-all uppercase tracking-widest border-b-4 border-sky-700",children:"HAL INN! "})]})},bG=({onComplete:t,speedMultiplier:e=1})=>{const[n,s]=_.useState("right"),[i,r]=_.useState(0),[a,o]=_.useState(!1),[l,u]=_.useState(null),d=f=>{a||f!==n&&(s(f),r(h=>{const m=h+5*e;return m>=100?(o(!0),setTimeout(()=>t(1),1e3),100):m}),u(f==="left"?"":""),setTimeout(()=>u(null),200))};return _.useEffect(()=>{const f=h=>{(h.key==="ArrowLeft"||h.key==="a"||h.key==="A")&&d("left"),(h.key==="ArrowRight"||h.key==="d"||h.key==="D")&&d("right")};return window.addEventListener("keydown",f),()=>window.removeEventListener("keydown",f)},[n,a]),c.jsxs("div",{className:"p-12 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden",style:{backgroundImage:'url("/images/minigames/weavery_bg.png")',backgroundSize:"cover"},children:[c.jsx("div",{className:"absolute inset-0 bg-black/70 z-0"}),c.jsx("h2",{className:"relative z-10 text-4xl font-black text-white mb-8 tracking-tighter uppercase italic",children:"Veveri: Vevstol "}),c.jsxs("div",{className:`relative z-10 w-full max-w-lg aspect-video bg-slate-900/50 border-4 rounded-3xl p-8 mb-12 flex flex-col justify-between overflow-hidden transition-all ${l?"brightness-125":""} ${n==="left"?"border-indigo-500/50 shadow-[inset_20px_0_40px_rgba(99,102,241,0.1)]":"border-emerald-500/50 shadow-[inset_-20px_0_40px_rgba(16,185,129,0.1)]"} `,children:[c.jsxs("div",{className:"flex justify-between items-center mb-8 relative h-32",children:[c.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 text-6xl transition-all duration-300 ease-out z-20",style:{left:n==="left"?"0%":"calc(100% - 4rem)",transform:`translateY(-50%) rotate(${n==="left"?"0deg":"180deg"})`},children:""}),c.jsx("div",{className:`text-6xl transition-all duration-500 ${n==="left"?"scale-110 opacity-100 rotate-12":"scale-75 opacity-20"} `,children:""}),c.jsx("div",{className:"absolute inset-x-0 h-1 bg-white/20 top-1/2 -translate-y-1/2 pointer-events-none"}),c.jsx("div",{className:`text-6xl transition-all duration-500 ${n==="right"?"scale-110 opacity-100 -rotate-12":"scale-75 opacity-20"} `,children:""})]}),c.jsx("div",{className:"text-sm font-black text-indigo-300 uppercase tracking-[0.3em] h-8 animate-pulse",children:l||"Veksle mellom Venstre / Hyre"})]}),c.jsxs("div",{className:"relative z-10 flex gap-12 mb-8",children:[c.jsx("button",{onClick:()=>d("left"),className:`w-28 h-28 rounded-[2rem] flex items-center justify-center text-4xl border-4 transition-all active:scale-90 ${n==="right"?"bg-indigo-600 border-indigo-400 scale-110 shadow-[0_0_30px_rgba(99,102,241,0.5)]":"bg-white/5 border-white/10 opacity-30 shadow-inner"} `,children:""}),c.jsx("button",{onClick:()=>d("right"),className:`w-28 h-28 rounded-[2rem] flex items-center justify-center text-4xl border-4 transition-all active:scale-90 ${n==="left"?"bg-emerald-600 border-emerald-400 scale-110 shadow-[0_0_30px_rgba(16,185,129,0.5)]":"bg-white/5 border-white/10 opacity-30 shadow-inner"} `,children:""})]}),c.jsx("div",{className:"relative z-10 w-full max-w-sm h-4 bg-white/10 rounded-full border border-white/10 overflow-hidden",children:c.jsx("div",{className:"h-full bg-indigo-500 transition-all duration-300",style:{width:`${i}% `}})})]})},xG=({onComplete:t,speedMultiplier:e=1})=>{var v;const[n,s]=_.useState([]),[i,r]=_.useState([]),[a,o]=_.useState(0),[l,u]=_.useState(!1),[d,f]=_.useState(null),h=[{id:"red",icon:"",label:"Rdurt"},{id:"blue",icon:"",label:"Blbr"},{id:"green",icon:"",label:"Grnnmose"},{id:"yellow",icon:"",label:"Gulrot"}];_.useEffect(()=>{const b=[];for(let y=0;y<5;y++)b.push(h[Math.floor(Math.random()*h.length)].id);s(b)},[]);const m=b=>{if(!(l||d))if(b===n[a]){const y=a+1;r(p=>[...p,b]),o(y),f("RIKTIG! "),setTimeout(()=>f(null),500),y>=n.length&&(u(!0),setTimeout(()=>t(1),1e3))}else f("FEIL... "),o(0),r([]),setTimeout(()=>f(null),1e3)};return c.jsxs("div",{className:"p-12 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden",style:{backgroundImage:'url("/images/minigames/apothecary_bg.png")',backgroundSize:"cover"},children:[c.jsx("div",{className:"absolute inset-0 bg-black/70 z-0"}),c.jsx("h2",{className:"relative z-10 text-4xl font-black text-white mb-8 tracking-tighter uppercase italic",children:"Apoteker: Brygging "}),c.jsx("div",{className:"relative z-10 mb-12 flex gap-4 h-24 items-center",children:n.map((b,y)=>{var p;return c.jsx("div",{className:`w-16 h-16 rounded-2xl flex items-center justify-center text-3xl transition-all border-2 border-white/10 ${a>y?"opacity-10 scale-90":"bg-black/40 scale-100"} `,children:(p=h.find(g=>g.id===b))==null?void 0:p.icon},y)})}),d&&c.jsx("div",{className:`relative z-10 text-3xl font-black mb-8 animate-in zoom-in ${d.includes("FEIL")?"text-rose-500":"text-emerald-400"} `,children:d}),c.jsxs("div",{className:"relative z-10 w-48 h-64 bg-white/5 border-4 border-white/20 rounded-b-[4rem] rounded-t-3xl overflow-hidden mb-12 shadow-inner",children:[c.jsx("div",{className:"absolute bottom-0 inset-x-0 transition-all duration-1000 ease-out",style:{height:`${a/n.length*100}%`,backgroundColor:a>0?(v=h.find(b=>b.id===n[a-1]))==null?void 0:v.id:"transparent",opacity:.6},children:c.jsx("div",{className:"absolute top-0 inset-x-0 h-4 bg-white/20 animate-pulse pointer-events-none"})}),c.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-6xl opacity-20 transition-transform duration-500 scale-125",children:""})]}),c.jsx("div",{className:"relative z-10 grid grid-cols-2 gap-4",children:h.map(b=>c.jsxs("button",{onClick:()=>m(b.id),className:`w-32 h-32 bg-slate-900/80 border-2 rounded-3xl flex flex-col items-center justify-center transition-all active:scale-90 shadow-xl group ${d==="RIKTIG! "&&n[a-1]===b.id?"border-emerald-500 scale-105 shadow-emerald-500/20":"border-white/20 hover:border-white/40"} `,children:[c.jsx("span",{className:"text-4xl mb-2 group-hover:scale-110 transition-transform",children:b.icon}),c.jsx("span",{className:"font-bold text-white uppercase text-sm",children:b.label})]},b.id))})]})},yG=({onComplete:t,speedMultiplier:e=1})=>{const[n,s]=_.useState(0),[i,r]=_.useState(0),[a,o]=_.useState(!0),[l,u]=_.useState(0),[d,f]=_.useState(!1),[h,m]=_.useState(1);_.useEffect(()=>{if(d)return;const b=setInterval(()=>{u(y=>{let p=y+h*3*e;return p>=100?(m(-1),100):p<=0?(m(1),0):p})},16);return()=>clearInterval(b)},[h,d,e]);const v=_.useCallback(b=>{if(d)return;const y=Math.abs(l-50),p=y<15,g=y>35;let x=0,w="",N="";p?(x=1,w="PERFEKT!",N="text-amber-400"):g?(x=.1,w="BOM!",N="text-rose-400"):(x=.5,w="BRA!",N="text-emerald-400");const T="clientX"in b?b.clientX:b.touches[0].clientX,E="clientY"in b?b.clientY:b.touches[0].clientY;Ge.spawnFloatingText(w,T,E-40,N),x>.1&&Ge.spawnParticles(T,E,x===1?"bg-amber-400":"bg-emerald-400"),r(k=>k+1),o(!a);const A=x*10;s(k=>{const R=k+A;return R>=100?(f(!0),Ge.spawnFloatingText("PLANKER FERDIG! ",T,E-100,"text-emerald-400 text-2xl font-black"),setTimeout(()=>t(1),1e3),100):R})},[l,d,a,t]);return c.jsxs("div",{className:"p-12 text-center min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden",children:[c.jsxs("div",{className:"absolute inset-0 bg-slate-950 z-0",children:[c.jsx("div",{className:"absolute inset-0 opacity-20 bg-[url('/images/textures/wood_pattern.png')] bg-repeat"}),c.jsx("div",{className:"absolute inset-x-0 bottom-0 h-32 bg-gradient-to-t from-indigo-500/10 to-transparent"})]}),c.jsxs("div",{className:"relative z-10 w-full mb-12",children:[c.jsx("h2",{className:"text-5xl font-black text-white uppercase tracking-tighter mb-2 italic drop-shadow-[0_0_20px_rgba(255,255,255,0.2)]",children:"Saging"}),c.jsx("p",{className:"text-slate-400 font-bold uppercase tracking-[0.3em] text-xs",children:"Pull og Push i takt for perfekte planker"})]}),c.jsxs("div",{className:"relative z-10 w-full max-w-2xl h-64 bg-slate-900/50 rounded-[3rem] border border-white/5 shadow-2xl overflow-hidden flex items-center justify-center group cursor-pointer",onClick:v,children:[c.jsx("div",{className:"absolute inset-y-0 left-0 bg-indigo-500/20 transition-all duration-500 z-0",style:{width:`${n}%`}}),c.jsxs("div",{className:"relative w-4/5 h-16 bg-[#3d2b1f] rounded-lg border-2 border-[#2a1d15] shadow-2xl flex items-center",children:[c.jsx("div",{className:"absolute inset-0 opacity-30 bg-[url('/images/textures/bark.png')] bg-cover mix-blend-overlay"}),c.jsx("div",{className:`absolute top-1/2 left-1/2 -translate-y-1/2 -translate-x-1/2 transition-transform duration-300 ${a?"-rotate-12 translate-x-4":"rotate-12 -translate-x-4"}`,children:c.jsx("div",{className:"text-6xl filter drop-shadow-[0_0_15px_rgba(255,255,255,0.3)]",children:""})}),c.jsxs("div",{className:"absolute bottom-0 left-1/2 -translate-x-1/2 flex gap-1 opacity-40",children:[c.jsx("div",{className:"w-1 h-1 bg-amber-200 rounded-full animate-ping"}),c.jsx("div",{className:"w-1 h-1 bg-amber-400 rounded-full animate-ping delay-75"}),c.jsx("div",{className:"w-1 h-1 bg-amber-100 rounded-full animate-ping delay-150"})]})]})]}),c.jsxs("div",{className:"relative z-10 mt-12 w-full max-w-md h-12 bg-black/40 rounded-full border border-white/10 p-1 flex items-center shadow-inner",children:[c.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 w-1/4 h-3/4 bg-amber-500/20 blur-sm rounded-full"}),c.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 w-[2px] h-full bg-amber-500/50"}),c.jsx("div",{className:"absolute w-8 h-8 bg-white rounded-full shadow-[0_0_20px_white] flex items-center justify-center transition-all duration-16 ease-linear",style:{left:`${l}%`,transform:"translateX(-50%)"},children:c.jsx("div",{className:"w-4 h-4 bg-indigo-500 rounded-full animate-pulse"})})]}),c.jsxs("div",{className:"relative z-10 mt-8",children:[c.jsxs("div",{className:"text-3xl font-black text-indigo-400 italic",children:[n.toFixed(0),"%"]}),c.jsxs("div",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mt-2",children:["Stroke: ",i]})]}),c.jsx("div",{className:"absolute inset-0 z-20 cursor-pointer",onClick:v})]})},_G=({onComplete:t,speedMultiplier:e=1})=>{const[n,s]=_.useState(20),[i]=_.useState({min:60,max:85}),[r,a]=_.useState(0),[o,l]=_.useState(!1),u=_.useRef(null),d=_.useRef(null),f=m=>{if(!o){if(d.current===void 0||d.current===null){d.current=m,u.current=requestAnimationFrame(f);return}if(d.current!==void 0){const v=m-d.current;s(b=>Math.max(0,b-.015*v*e)),s(b=>(b>=i.min&&b<=i.max&&a(y=>{const p=y+.01*v;return p>=100&&!o&&(l(!0),Ge.spawnFloatingText("PERFEKT TEMPERATUR! ",window.innerWidth/2,window.innerHeight/2,"text-orange-500 text-4xl font-black"),setTimeout(()=>t(1),1e3)),p}),b))}d.current=m,u.current=requestAnimationFrame(f)}};_.useEffect(()=>(u.current=requestAnimationFrame(f),()=>{u.current&&cancelAnimationFrame(u.current)}),[o]);const h=()=>{o||(s(m=>Math.min(100,m+12)),Ge.spawnParticles(window.innerWidth/2,window.innerHeight/2+100,"bg-orange-500"),Ge.spawnFloatingText("PUST!",window.innerWidth/2,window.innerHeight/2+50,"text-slate-400 font-bold text-xs uppercase"))};return c.jsxs("div",{onClick:h,className:"p-12 min-h-[600px] relative flex flex-col items-center justify-center overflow-hidden cursor-pointer select-none",style:{backgroundImage:'url("/images/minigames/smeltery_bg.png")',backgroundSize:"cover"},children:[c.jsx("div",{className:"absolute inset-0 bg-black/80 z-0"}),c.jsxs("div",{className:"relative z-10 text-center mb-12",children:[c.jsx("h2",{className:"text-4xl font-black text-white uppercase tracking-tighter drop-shadow-xl",children:"Smelting"}),c.jsx("div",{className:"text-orange-500 font-black uppercase tracking-widest text-xs mt-2 bg-black/40 px-4 py-1 rounded-full border border-orange-500/20",children:"Hold varmen i den oransje sonen"})]}),c.jsxs("div",{className:"relative z-10 flex gap-12 items-end h-80",children:[c.jsxs("div",{className:"w-20 h-full bg-slate-900/80 rounded-full border-4 border-white/10 relative overflow-hidden shadow-2xl",children:[c.jsx("div",{className:"absolute w-full bg-orange-500/30 border-y-2 border-orange-500/50 flex items-center justify-center",style:{bottom:`${i.min}%`,height:`${i.max-i.min}%`},children:c.jsx("div",{className:"w-full h-full bg-orange-500/10 animate-pulse"})}),c.jsx("div",{className:`absolute bottom-0 w-full transition-all duration-75 shadow-[0_0_30px_rgba(249,115,22,0.5)] ${n>i.max?"bg-white":"bg-gradient-to-t from-red-600 via-orange-500 to-yellow-400"}`,style:{height:`${n}%`},children:c.jsx("div",{className:"absolute top-0 inset-x-0 h-4 bg-white/50 blur-[2px]"})})]}),c.jsxs("div",{className:"flex flex-col gap-4",children:[c.jsx("div",{className:"text-xs font-black text-slate-500 uppercase tracking-widest text-center",children:"Fremgang"}),c.jsx("div",{className:"w-12 h-64 bg-slate-900/80 rounded-2xl border-2 border-white/5 relative overflow-hidden",children:c.jsx("div",{className:"absolute bottom-0 w-full bg-indigo-500 transition-all duration-300",style:{height:`${r}%`}})}),c.jsxs("div",{className:"text-xl font-black text-white text-center",children:[Math.round(r),"%"]})]})]}),c.jsx("div",{className:"mt-16 text-slate-400 text-sm font-bold uppercase tracking-widest animate-pulse relative z-10 text-center max-w-xs",children:"Klikk for  pumpe blsebelgen og ke varmen"}),o&&c.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm animate-in fade-in zoom-in duration-300",children:c.jsx("div",{className:"text-6xl font-black text-orange-500 animate-bounce drop-shadow-[0_0_30px_rgba(249,115,22,0.5)]",children:"FERDIG! "})})]})},ba={WORK:[{id:"sickle",label:"Sigd",icon:"",desc:"Presisjons-hsting for hy kvalitet."},{id:"sweep",label:"Lj",icon:"",desc:"Rask innhsting av store omrder."}],CHOP:[{id:"axe",label:"ks",icon:"",desc:"Fell trr med r makt."}],FORAGE:[{id:"gather",label:"Sanking",icon:"",desc:"Let etter mat og urter i skogen."},{id:"traps",label:"Snarefangst",icon:"",desc:"Sett feller for smvilt."}],MINE:[{id:"pickaxe",label:"Hakke",icon:"",desc:"Hugg ut malm fra fjellet."}],QUARRY:[{id:"chisel",label:"Meisel",icon:"",desc:"Hugg ut steinblokker."}],CRAFT:[{id:"hammer",label:"Smiing",icon:"",desc:"Form metallet p ambolten."}],BAKE:[{id:"oven",label:"Steking",icon:"",desc:"Stek brd i ovnen."}],WEAVE:[{id:"loom",label:"Veving",icon:"",desc:"Vev trd til stoffer."}],MIX:[{id:"brew",label:"Brygging",icon:"",desc:"Bland urter til medisiner."}],SMELT:[{id:"furnace",label:"Smelting",icon:"",desc:"Smelt malm til barrer."}],PLANT:[{id:"manual",label:"Hndsing",icon:"",desc:"S fr for hnd."}],HUNT:[{id:"bow",label:"Bueskyting",icon:"",desc:"Presisjonsjakt fra avstand."},{id:"trap",label:"Fellefangst",icon:"",desc:"Sett ut snarer for smvilt."}],SAWMILL:[{id:"saw",label:"Saging",icon:"",desc:"Sag opp tmmer til planker."}],GATHER_WOOL:[{id:"shears",label:"Saks",icon:"",desc:"Klipp ullen av sauene."}]},wG=({item:t})=>{const e=t.durability/t.maxDurability*100;return c.jsx("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 z-[110] animate-in slide-in-from-bottom-4 fade-in duration-500",children:c.jsxs("div",{className:"bg-slate-900/90 border border-white/10 rounded-full px-6 py-3 flex items-center gap-4 backdrop-blur-md shadow-2xl",children:[c.jsx("div",{className:"text-3xl drop-shadow-[0_0_10px_rgba(255,255,255,0.2)]",children:t.icon}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("div",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:t.name}),c.jsxs("div",{className:"flex items-center gap-2 text-xs font-bold text-slate-300",children:[c.jsx("div",{className:`w-2 h-2 rounded-full ${e>20?"bg-emerald-500":"bg-rose-500"} animate-pulse`}),c.jsx("span",{children:"Slitasje"}),c.jsxs("span",{children:[Math.round(e),"%"]})]})]})]})})},EG=({type:t,onComplete:e,onCancel:n,equipment:s,skills:i,playerUpgrades:r,currentSeason:a="Spring",currentWeather:o="Clear",totalTicks:l=0,selectedMethod:u,action:d})=>{var w,N,T;const[f,h]=Ee.useState(u||null);Ee.useEffect(()=>{const E=ba[t];E&&E.length===1&&!f&&h(E[0].id)},[t,f]);const m=Ee.useMemo(()=>SS(t,s||[]),[t,s]),v=Ee.useMemo(()=>{var k,R;const E=An[a],A=xs[o];return{speedMultiplier:((A==null?void 0:A.speedMod)||1)*(((k=m==null?void 0:m.stats)==null?void 0:k.speedBonus)||1),staminaCostMod:((E==null?void 0:E.staminaMod)||1)*((A==null?void 0:A.staminaMod)||1),yieldMod:(((R=m==null?void 0:m.stats)==null?void 0:R.yieldBonus)||0)+((E==null?void 0:E.yieldMod)||1)}},[a,o,m]),b=Ee.useMemo(()=>{var P,V;const E={skills:i||{},equipment:{}};s&&s.forEach($=>{const K=$.slot||$.type;$&&K&&(E.equipment[K]=$)});let A=10,k="FARMING",R=t;switch(t){case"MINE":A=q.YIELD.MINE_ORE,k="MINING";break;case"QUARRY":A=q.YIELD.QUARRY_STONE,k="MINING";break;case"CHOP":A=q.YIELD.CHOP_WOOD,a==="Summer"&&(A+=q.YIELD.SUMMER_WOOD_BONUS),k="WOODCUTTING";break;case"WORK":case"HARVEST":A=q.YIELD.WORK_GRAIN,r!=null&&r.includes("iron_plow")&&(A+=q.YIELD.PLOW_BONUS),k="FARMING";break;case"FORAGE":A=q.YIELD.FORAGE_BREAD,k="FARMING";break}const I={season:((P=An[a])==null?void 0:P.yieldMod)||1,weather:((V=xs[o])==null?void 0:V.yieldMod)||1,actionType:R,upgrades:1};try{const $=rs(E,A,k,I);return console.log(`[MinigameOverlay] Yield Calc. Type: ${t}, Base: ${A}. Result: ${$}. Equipment:`,E.equipment),isNaN($)?1.5:$}catch($){return console.error("Yield Calc Error:",$),1.5}},[t,i,s,r,a,o]),y=Ee.useMemo(()=>{let E=10;switch(t){case"MINE":E=q.YIELD.MINE_ORE;break;case"QUARRY":E=q.YIELD.QUARRY_STONE;break;case"CHOP":E=q.YIELD.CHOP_WOOD;break;case"WORK":case"HARVEST":E=q.YIELD.WORK_GRAIN;break;case"FORAGE":E=q.YIELD.FORAGE_BREAD;break}return b<=2||b<E*.4},[b,t]),p=E=>{h(E)},[g,x]=Ee.useState(!1);return y&&!g&&(t==="MINE"||t==="QUARRY"||t==="CHOP"||t==="WORK"||t==="HARVEST"||t==="FORAGE")&&f?c.jsx("div",{className:"fixed inset-0 z-[150] flex items-center justify-center bg-black/80 backdrop-blur-md animate-in fade-in zoom-in duration-300",children:c.jsxs("div",{className:"bg-slate-900 border-2 border-rose-500 rounded-3xl p-8 max-w-md w-full text-center shadow-[0_0_50px_rgba(244,63,94,0.3)]",children:[c.jsx("div",{className:"text-6xl mb-6",children:""}),c.jsx("h2",{className:"text-3xl font-black text-white uppercase tracking-tighter mb-4",children:"Manglende Verkty!"}),c.jsxs("p",{className:"text-slate-300 font-medium mb-8 leading-relaxed",children:["Du forsker  utfre ",c.jsx("span",{className:"text-rose-400 font-bold",children:t})," uten riktig verkty. Effektiviteten din er redusert med 80%."]}),c.jsxs("div",{className:"flex flex-col gap-3",children:[c.jsx("button",{onClick:()=>x(!0),className:"w-full py-4 bg-rose-600 hover:bg-rose-500 text-white rounded-xl font-black uppercase tracking-widest shadow-lg active:scale-95 transition-all",children:"Fortsett likevel"}),c.jsx("button",{onClick:n,className:"w-full py-4 bg-white/5 hover:bg-white/10 text-slate-400 hover:text-white rounded-xl font-bold uppercase tracking-widest transition-all",children:"Avbryt"})]})]})}):!f&&ba[t]?c.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-slate-950/80 backdrop-blur-md animate-in fade-in duration-300",children:c.jsxs("div",{className:"max-w-4xl w-full p-8",children:[c.jsx("h2",{className:"text-4xl font-black text-white text-center mb-12 uppercase tracking-tighter drop-shadow-lg",children:"Velg Metode"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:ba[t].map(E=>c.jsxs("button",{onClick:()=>p(E.id),className:"group relative bg-slate-900 border-2 border-slate-700 hover:border-indigo-500 rounded-3xl p-8 transition-all hover:-translate-y-2 hover:shadow-[0_0_50px_rgba(79,70,229,0.3)] text-left overflow-hidden",children:[c.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-500/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),c.jsxs("div",{className:"relative z-10 flex flex-col items-center text-center gap-6",children:[c.jsx("div",{className:"text-6xl group-hover:scale-110 transition-transform duration-300",children:E.icon}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-2xl font-black text-white mb-2 uppercase tracking-wide group-hover:text-indigo-400 transition-colors",children:E.label}),c.jsx("p",{className:"text-slate-400 font-medium leading-relaxed",children:E.desc})]}),c.jsx("div",{className:"mt-4 pt-4 border-t border-white/5 w-full",children:(()=>{const A=IS(t,a,o,l);return A?c.jsx("div",{className:"flex items-center justify-center gap-2 text-sm font-bold text-slate-500",children:c.jsx("span",{children:A})}):null})()})]})]},E.id))}),c.jsx("button",{onClick:n,className:"mt-12 mx-auto block text-slate-500 font-bold hover:text-white transition-colors uppercase tracking-widest text-sm",children:"Avbryt"})]})}):c.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-slate-950/90 backdrop-blur-xl animate-in fade-in duration-300",children:[c.jsx("div",{className:"absolute top-8 right-8 z-[110]",children:c.jsx("button",{onClick:n,className:"bg-black/40 hover:bg-rose-500/20 text-white/50 hover:text-rose-400 w-12 h-12 rounded-full flex items-center justify-center transition-all",children:""})}),c.jsx("div",{className:"absolute top-8 left-8 z-[110] flex gap-4",children:c.jsxs("div",{className:"bg-black/40 backdrop-blur-md px-4 py-2 rounded-2xl border border-white/5 flex items-center gap-3",children:[c.jsx("span",{className:"text-2xl",title:((w=An[a])==null?void 0:w.label)||a,children:a==="Winter"?"":a==="Summer"?"":a==="Autumn"?"":""}),c.jsx("span",{className:"text-2xl",title:((N=xs[o])==null?void 0:N.label)||o,children:(T=xs[o])==null?void 0:T.icon}),c.jsx("div",{className:"h-4 w-[1px] bg-white/10 mx-2"}),c.jsxs("div",{className:"flex flex-col",children:[c.jsx("span",{className:"text-[10px] uppercase font-bold text-slate-500 tracking-wider",children:"Forhold"}),c.jsxs("span",{className:`text-xs font-bold ${v.speedMultiplier<1?"text-rose-400":"text-emerald-400"}`,children:[Math.round(v.speedMultiplier*100),"% Hastighet"]})]})]})}),c.jsxs("div",{className:"w-full max-w-5xl bg-slate-900 rounded-[3rem] shadow-2xl relative overflow-hidden border border-white/5",children:[(()=>{var E,A;switch(t){case"PLANT":return c.jsx(dG,{onComplete:e});case"HARVEST":case"WORK":return f==="sweep"||f==="scythe"?c.jsx(U_,{onComplete:e,equipment:s,speedMultiplier:v.speedMultiplier}):c.jsx(Yc,{onComplete:e,equipment:s,speedMultiplier:v.speedMultiplier,possibleYield:b});case"CHOP":return c.jsx(pG,{onComplete:e,equipment:s,speedMultiplier:v.speedMultiplier,possibleYield:b});case"SAWMILL":return c.jsx(yG,{onComplete:e,speedMultiplier:v.speedMultiplier});case"FORAGE":return f==="traps"?c.jsx(vG,{onComplete:e,speedMultiplier:v.speedMultiplier}):c.jsx(Yc,{isForaging:!0,onComplete:e,equipment:s,speedMultiplier:v.speedMultiplier,resourceName:"Mat/Urter",possibleYield:b});case"MINE":return c.jsx(Yc,{isMining:!0,onComplete:e,equipment:s,speedMultiplier:v.speedMultiplier,resourceName:"Malm",possibleYield:b});case"QUARRY":return c.jsx(Yc,{isQuarrying:!0,onComplete:e,equipment:s,speedMultiplier:v.speedMultiplier,resourceName:"Stein",possibleYield:b});case"CRAFT":case"REPAIR":return c.jsx(fG,{onComplete:e,speedMultiplier:v.speedMultiplier});case"SMELT":return c.jsx(_G,{onComplete:e,speedMultiplier:v.speedMultiplier});case"BAKE":const k=d!=null&&d.subType?((E=Se[d.subType])==null?void 0:E.icon)||"":((A=hn[d==null?void 0:d.recipeId])==null?void 0:A.icon)||"";return c.jsx(hG,{onComplete:e,speedMultiplier:v.speedMultiplier,icon:k});case"WEAVE":return c.jsx(bG,{onComplete:e,speedMultiplier:v.speedMultiplier});case"MIX":return c.jsx(xG,{onComplete:e,speedMultiplier:v.speedMultiplier});case"GATHER_WOOL":return c.jsx(U_,{onComplete:e,equipment:s,speedMultiplier:v.speedMultiplier});default:return c.jsxs("div",{className:"p-12 text-center",children:[c.jsxs("h2",{className:"text-2xl font-bold text-white mb-4",children:["Ukjent Minispill: ",t]}),c.jsx("button",{onClick:()=>e(.5),className:"px-6 py-3 bg-indigo-600 rounded-xl font-bold text-white",children:"Fullfr (Skip)"})]})}})(),m&&c.jsx(wG,{item:m})]})]})},NG=({poi:t,player:e,room:n,viewingRegionId:s,onAction:i,onClose:r})=>{var T,E,A;const a=_.useRef(null),o=s==="region_ost"&&t.ost?t.ost.top:t.top,l=s==="region_ost"&&t.ost?t.ost.left:t.left,[u,d]=_.useState({x:"3rem",y:"-50%"}),[f,h]=_.useState(!1),m=((T=n.world)==null?void 0:T.season)||"Spring",v=((E=n.world)==null?void 0:E.weather)||"Clear",b=_.useMemo(()=>{var B,j,O;const k=t.id in Ut?t.id:t.parentId,R=Ut[k],P=((O=(j=(((B=n.world)==null?void 0:B.settlement)||{}).buildings)==null?void 0:j[k])==null?void 0:O.level)||1;let V=[];if(R)for(let C=1;C<=P;C++)R.levels[C]&&(V=[...V,...R.levels[C].unlocks]);const $=t.actions.filter(C=>{if(C.id==="TAX_PEASANTS"&&e.role!=="BARON"||C.id==="TAX_ROYAL"&&e.role!=="KING"||C.id==="DECREE"&&e.role!=="KING"||C.id==="RAID"&&e.role!=="BARON"||C.id==="FEAST"&&e.role!=="KING"&&e.role!=="BARON")return!1;const F=["OPEN_CRAFTING","CRAFT","REFINE","MARKET_VIEW","OPEN_GARRISON"];return!(R&&!C.id.startsWith("BUILDING_UPGRADE_")&&!F.includes(C.id)&&!V.includes(C.id))});return["windmill_stones","sawmill_blade","smeltery_furnace","bakery_oven","weavery_loom","forge_anvil"].includes(t.id)?$.filter(C=>C.id==="OPEN_CRAFTING"||C.id==="REFINE"||C.id==="CRAFT"||C.id.startsWith("REFINE_")||C.id.startsWith("CRAFT_")||C.id in Rn).slice(0,1):$},[t,e.role,(A=n.world)==null?void 0:A.settlement]);_.useLayoutEffect(()=>{if(!a.current)return;const k=a.current.getBoundingClientRect(),R=a.current.offsetParent;if(!R){h(!0);return}const I=R.getBoundingClientRect(),P=parseFloat(l),V=parseFloat(o),$=P<50?"3rem":"calc(-100% - 3rem)",K=V/100*I.height-k.height/2,B=K+k.height;let j="-50%";K<20?j=`calc(-50% + ${20-K}px)`:B>I.height-20&&(j=`calc(-50% - ${B-(I.height-20)}px)`),d({x:$,y:j}),h(!0)},[o,l,b.length]);const y=k=>{var K,B,j;const R=[],I=fp(e,k);if(I.forEach(O=>{var C,F,Q;(C=O.stats)!=null&&C.speedBonus&&O.stats.speedBonus!==1&&R.push({source:O.name,type:"Fart",value:`+${Math.round((O.stats.speedBonus-1)*100)}%`,icon:O.icon,isBonus:!0}),(F=O.stats)!=null&&F.yieldBonus&&R.push({source:O.name,type:"Utbytte",value:`+${O.stats.yieldBonus}`,icon:O.icon,isBonus:!0}),(Q=O.stats)!=null&&Q.luckBonus&&R.push({source:O.name,type:"Flaks",value:`+${Math.round(O.stats.luckBonus*100)}%`,icon:O.icon,isBonus:!0})}),e.upgrades){const O=T0[e.role]||[];e.upgrades.forEach(C=>{const F=O.find(Q=>Q.id===C);F&&(F.benefit==="YIELD_GRAIN"&&(k==="WORK"||k==="MILL")&&R.push({source:F.name,type:"Utbytte",value:"+5",icon:"",isBonus:!0}),F.benefit==="RAID_SPEED"&&k==="RAID"&&R.push({source:F.name,type:"Fart",value:"Raskere",icon:"",isBonus:!0}))})}const P=t.id==="tavern"||t.id==="bakery"||t.id==="great_forge"||t.id==="weavery"||t.id==="sawmill"||t.id==="windmill"||t.id==="smeltery"?t.id:t.parentId,$=((j=(B=(((K=n.world)==null?void 0:K.settlement)||{}).buildings)==null?void 0:B[P])==null?void 0:j.level)||1;if($>=2&&R.push({source:"Bygningsbonus (Lvl 2)",type:"Utbytte",value:"+10% XP",icon:"",isBonus:!0}),$>=3&&R.push({source:"Bygningsbonus (Lvl 3)",type:"Utbytte",value:"Master Tier",icon:"",isBonus:!0}),ba[k]){const O=ba[k][0];O.id==="manual"||O.id==="gather"||I.some(Q=>{var oe;return((oe=Q.type)==null?void 0:oe.toLowerCase().includes(O.id.toLowerCase()))||Q.id.toLowerCase().includes(O.id.toLowerCase())})||R.push({source:"System",type:"ADVARSEL",value:`Du mangler ${O.label}, utbytte redusert med 80%`,icon:"",isBonus:!1})}return R},p=_.useMemo(()=>{var k;return(k=e.activeProcesses)==null?void 0:k.find(R=>!(R.locationId!==t.id||R.type==="COOP"||R.type==="WELL"&&R.readyAt<=Date.now()))},[e.activeProcesses,t.id]),g=()=>{if(!p)return 0;const k=Date.now();return Math.max(0,p.readyAt-k)},[x,w]=_.useState(g());_.useEffect(()=>{if(!p)return;const k=setInterval(()=>{const R=g();w(R),R<=0&&clearInterval(k)},1e3);return()=>clearInterval(k)},[p]);const N=k=>{const R=Math.floor(k/6e4),I=Math.floor(k%6e4/1e3);return`${R}m ${I}s`};return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"absolute inset-0 z-[90]",onClick:r}),c.jsx("div",{ref:a,style:{top:o,left:l,transform:`translate(${u.x}, ${u.y})`,visibility:f?"visible":"hidden",opacity:f?1:0},className:`absolute z-[100] ${f?"animate-in fade-in zoom-in":""} duration-200 pointer-events-auto`,children:c.jsxs("div",{className:"bg-slate-900/90 backdrop-blur-3xl border border-white/10 rounded-[2.5rem] p-6 shadow-[0_40px_100px_rgba(0,0,0,0.8)] min-w-[320px] w-max max-w-[400px] relative transition-all duration-500 overflow-hidden group/tooltip",children:[c.jsx("div",{className:"absolute -top-24 -left-24 w-48 h-48 bg-indigo-500/10 blur-[80px] pointer-events-none group-hover/tooltip:bg-indigo-500/20 transition-all duration-1000"}),c.jsxs("div",{className:"flex items-center justify-between mb-6 relative z-10",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("div",{className:"w-14 h-14 rounded-2xl bg-white/5 border border-white/10 flex items-center justify-center text-3xl shadow-inner relative overflow-hidden group/icon",children:[c.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-0 group-hover/icon:opacity-100 transition-opacity"}),t.icon]}),c.jsxs("div",{className:"flex flex-col",children:[c.jsx("h3",{className:"font-display font-black text-white text-xl uppercase tracking-tighter leading-none",children:t.label}),c.jsx("span",{className:"text-xs font-black text-indigo-400 uppercase tracking-[.2em] mt-1 opacity-90",children:"Landemerke"})]})]}),c.jsx("div",{className:"flex items-center gap-3",children:c.jsx("button",{onClick:r,className:"text-white/60 hover:text-white transition-all bg-white/10 hover:bg-white/20 rounded-full w-10 h-10 flex items-center justify-center border border-white/10 hover:border-white/30 active:scale-90",children:""})})]}),c.jsxs("div",{className:"space-y-3",children:[p?c.jsx("div",{className:"w-full relative py-4",children:x<=0?c.jsxs("div",{className:"relative group/harvest",children:[c.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-emerald-500 to-teal-500 rounded-3xl blur opacity-25 group-hover/harvest:opacity-50 transition duration-1000 group-hover:duration-200"}),c.jsxs("button",{onClick:()=>i({type:"HARVEST",locationId:t.id}),disabled:e.status.stamina<Dn(15,m,v),className:`w-full relative px-6 py-8 border rounded-3xl flex items-center justify-between overflow-hidden active:scale-[0.98] transition-all
                                                ${e.status.stamina<Dn(15,m,v)?"bg-red-900/20 border-red-500/30 cursor-not-allowed grayscale opacity-80":"bg-slate-900 border-emerald-500/50 hover:bg-emerald-950/30"}`,children:[c.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-emerald-500/10 blur-3xl -mr-16 -mt-16"}),c.jsxs("div",{className:"flex flex-col items-start z-10",children:[c.jsx("span",{className:`text-2xl font-black uppercase tracking-tighter italic ${e.status.stamina<Dn(15,m,v)?"text-slate-500":"text-white"}`,children:"Innhsting"}),c.jsx("span",{className:`text-xs font-black uppercase tracking-[0.2em] mt-1 ${e.status.stamina<Dn(15,m,v)?"text-red-400":"text-emerald-400"}`,children:e.status.stamina<Dn(15,m,v)?`Mangler energi (${Math.ceil(e.status.stamina)}/${Dn(15,m,v).toFixed(0)})`:"Klar til  hentes!"})]}),c.jsx("div",{className:`w-14 h-14 rounded-2xl flex items-center justify-center text-3xl shadow-[0_0_20px_rgba(16,185,129,0.3)] ${e.status.stamina<Dn(15,m,v)?"bg-slate-800 text-slate-600":"bg-emerald-500/20 animate-bounce"}`,children:e.status.stamina<Dn(15,m,v)?c.jsx(mP,{size:24,className:"text-red-500"}):""})]})]}):c.jsxs("div",{className:"p-8 bg-white/5 border border-white/10 rounded-[2rem] flex flex-col items-center gap-6 relative overflow-hidden group/timer",children:[c.jsx("div",{className:"absolute -bottom-12 -right-12 w-24 h-24 bg-indigo-500/5 blur-2xl rounded-full"}),c.jsxs("div",{className:"relative w-24 h-24",children:[c.jsxs("svg",{className:"w-full h-full -rotate-90",viewBox:"0 0 36 36",children:[c.jsx("circle",{cx:"18",cy:"18",r:"16",fill:"none",className:"stroke-white/5",strokeWidth:"2"}),c.jsx("circle",{cx:"18",cy:"18",r:"16",fill:"none",className:"stroke-emerald-500 transition-all duration-1000 ease-linear",strokeWidth:"2",strokeDasharray:"100",strokeDashoffset:100-(1-x/p.duration)*100,strokeLinecap:"round"})]}),c.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:c.jsx("span",{className:"text-3xl animate-pulse",children:p.type==="MILL"?"":p.type==="WELL"?"":""})})]}),c.jsxs("div",{className:"flex flex-col items-center gap-1",children:[c.jsx("span",{className:"text-sm font-black text-slate-400 uppercase tracking-widest leading-none",children:p.type==="WELL"?"Brnnen fyller seg med vann":"Venter p produksjon"}),c.jsx("span",{className:"text-2xl font-mono font-black text-white",children:N(x)})]}),c.jsx("div",{className:"w-full h-1 bg-white/5 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-emerald-500 transition-all duration-1000 ease-linear",style:{width:`${(1-x/p.duration)*100}%`}})})]})}):c.jsx("div",{className:"space-y-6",children:b.map(k=>{var O,C,F,Q;const R=((O=n.world)==null?void 0:O.season)||"Spring",I=((C=n.world)==null?void 0:C.weather)||"Clear",P=y(k.id);let V=!0,$="";const K=["CRAFT","REFINE","OPEN_CRAFTING","BAKE","SMELT","MILL","WEAVE","MIX","OPEN_CHICKEN_COOP","OPEN_DICE_GAME","MARKET_VIEW","OPEN_GARRISON"];if(s!==e.regionId&&e.role!=="KING"&&k.id!=="MARKET_VIEW")V=!1,$="Dette er ikke ditt baroni";else if(!K.includes(k.id)){const oe=RS(e,k.id,R,I,((F=n.world)==null?void 0:F.gameTick)||0);oe.success||(V=!1,$=oe.reason||"Krav ikke mtt")}const B=IS(k.id,R,I,((Q=n.world)==null?void 0:Q.gameTick)||0),j=ba[k.id];return c.jsxs("div",{className:"w-full animate-in fade-in slide-in-from-bottom-2 duration-500",children:[c.jsxs("div",{className:"flex items-center justify-between px-1 mb-3",children:[c.jsx("h4",{className:"text-xs font-black text-slate-300 uppercase tracking-[0.3em]",children:k.label}),B&&c.jsx("span",{className:"text-xs font-black text-indigo-400 uppercase tracking-widest",children:B})]}),j?c.jsx("div",{className:"grid grid-cols-1 gap-4",children:j.map(oe=>{const be=fp(e,k.id),H=be.find(se=>{var tt;return((tt=se.type)==null?void 0:tt.toLowerCase().includes(oe.id.toLowerCase()))||se.id.toLowerCase().includes(oe.id.toLowerCase())})||be[0],me=H?H.durability/H.maxDurability*100:null;return c.jsxs("button",{onClick:()=>i({type:k.id,method:oe.id,locationId:t.id}),disabled:!V,className:`group relative flex items-center gap-6 w-full p-5 rounded-[2rem] border transition-all duration-300 ${V?"bg-white/5 border-white/10 hover:border-indigo-500/50 hover:bg-indigo-500/5 active:scale-[0.98]":"bg-black/20 border-white/5 cursor-not-allowed"}`,children:[c.jsx("div",{className:`w-16 h-16 rounded-2xl bg-white/5 flex-shrink-0 flex items-center justify-center text-4xl group-hover:scale-110 transition-transform duration-500 ${!V&&"opacity-40"}`,children:oe.icon}),c.jsxs("div",{className:"flex-1 flex flex-col justify-center min-w-0 items-start",children:[c.jsx("span",{className:"font-display font-black text-white text-xl uppercase tracking-tighter group-hover:text-indigo-400 transition-colors truncate",children:oe.label}),V?c.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[c.jsx("span",{className:"text-[10px] text-slate-400 font-black uppercase tracking-widest truncate opacity-60",children:oe.desc}),P.length>0&&c.jsx("div",{className:"flex gap-1.5",children:P.filter(se=>!se.isBonus||se.value.includes("+")).slice(0,1).map((se,tt)=>c.jsx("span",{className:"text-[10px] text-emerald-400 font-black px-2 py-0.5 bg-emerald-400/10 rounded-full",children:se.value},tt))})]}):c.jsx("span",{className:"text-xs font-black text-rose-500 uppercase tracking-widest mt-0.5",children:$})]}),c.jsxs("div",{className:"flex flex-col items-end gap-3 ml-2",children:[me!==null&&V&&c.jsx("div",{className:"w-10 h-1.5 bg-white/10 rounded-full overflow-hidden shadow-inner",children:c.jsx("div",{className:`h-full transition-all duration-1000 ${me>50?"bg-indigo-500 shadow-[0_0_8px_rgba(99,102,241,0.5)]":me>20?"bg-amber-500":"bg-rose-500"}`,style:{width:`${me}%`}})}),c.jsx(va,{size:22,className:`transition-all ${V?"text-white/20 group-hover:text-indigo-400 group-hover:translate-x-1":"text-white/5"}`})]})]},oe.id)})}):c.jsx("button",{onClick:()=>i({...k,type:k.id,locationId:t.id}),disabled:!V,className:`w-full group relative overflow-hidden p-5 rounded-3xl border transition-all duration-300 ${V?"bg-white/5 border-white/10 hover:border-indigo-500/50 hover:bg-indigo-500/5 active:scale-[0.98]":"bg-black/20 border-white/5 opacity-50 cursor-not-allowed"}`,children:c.jsxs("div",{className:"flex items-center justify-between relative z-10",children:[c.jsxs("div",{className:"flex flex-col items-start",children:[c.jsx("span",{className:"text-xl font-black text-white group-hover:text-indigo-400 transition-colors uppercase tracking-tight",children:k.label}),!V&&c.jsx("span",{className:"text-sm font-black text-rose-500 uppercase tracking-widest mt-1",children:$})]}),c.jsx(va,{size:20,className:"text-white/20 group-hover:text-indigo-400 group-hover:translate-x-1 transition-all"})]})})]},k.id)})}),(()=>{var $,K,B,j,O;const k=b.map(C=>C.id),R=Object.values(e.equipment||{}),V=Object.values(Se).filter(C=>{var F;return(F=C.relevantActions)==null?void 0:F.some(Q=>k.includes(Q))}).map(C=>{if(R.find(Q=>Q.id===C.id||Q.id.startsWith(C.id+"_"))){const Q=C.nextTierId;return Q?Se[Q]:null}else return C.level===1?C:null}).filter(Boolean).filter((C,F,Q)=>Q.findIndex(oe=>(oe==null?void 0:oe.id)===(C==null?void 0:C.id))===F).sort((C,F)=>{if(!C||!F)return 0;const Q=C.type==="MAIN_HAND"||C.type==="AXE"||C.type==="PICKAXE"||C.type==="SCYTHE"||C.type==="BOW"||C.type==="CHISEL"?1:0;return(F.type==="MAIN_HAND"||F.type==="AXE"||F.type==="PICKAXE"||F.type==="SCYTHE"||F.type==="BOW"||F.type==="CHISEL"?1:0)-Q});if(V.length>0){const C=V[0];if(!C)return null;const F=Object.values(Rn).find(Ft=>Ft.outputItemId===C.id),Q=(($=n.world)==null?void 0:$.settlement)||{buildings:{}},oe=(F==null?void 0:F.buildingId)||"great_forge",be=((B=(K=Q.buildings)==null?void 0:K[oe])==null?void 0:B.level)||1,H=(F==null?void 0:F.level)||1,me=be<H,se=((j=Ut[oe])==null?void 0:j.name)||"Smien",tt=R.find(Ft=>{var $n;if(!Ft)return!1;const jn=Object.keys(Se).find(pn=>Ft.id===pn||Ft.id.startsWith(pn+"_")),Dt=jn?Se[jn]:null;return($n=Dt==null?void 0:Dt.relevantActions)==null?void 0:$n.some(pn=>k.includes(pn))});return c.jsx("div",{className:"mt-8 pt-8 border-t border-white/5 relative z-10",children:c.jsxs("div",{className:"flex flex-col gap-4",children:[c.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[c.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-amber-500 to-transparent flex-1"}),c.jsx("span",{className:`text-xs font-black uppercase tracking-[0.2em] ${me?"text-slate-400":"text-amber-500 animate-pulse"}`,children:me?`Krever niv ${H}`:"Utvikling venter"}),c.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-amber-500 to-transparent flex-1"})]}),c.jsxs("div",{className:"flex items-center justify-between gap-6 px-4",children:[c.jsxs("div",{className:"flex flex-col items-center gap-2 group/evolve",children:[c.jsx("div",{className:"w-16 h-16 rounded-[1.5rem] bg-white/5 border border-white/10 flex items-center justify-center text-3xl opacity-40 transition-all group-hover/evolve:opacity-60",children:(tt==null?void 0:tt.icon)||""}),c.jsx("span",{className:"text-[9px] font-black text-slate-500 uppercase tracking-widest",children:"N"})]}),c.jsxs("div",{className:"flex flex-col items-center flex-1 gap-2 pt-2",children:[c.jsxs("div",{className:"relative w-full flex justify-center",children:[c.jsx("div",{className:"absolute top-1/2 left-0 w-full h-px bg-gradient-to-r from-indigo-500/0 via-indigo-500/30 to-indigo-500/0"}),c.jsx(va,{className:"text-indigo-500/50 w-6 h-6 animate-pulse relative z-10"})]}),((O=C.stats)==null?void 0:O.yieldBonus)&&c.jsxs("span",{className:"text-[10px] font-black text-emerald-400 bg-emerald-400/10 px-2 py-0.5 rounded-full border border-emerald-400/20",children:["+",C.stats.yieldBonus," Utbytte"]})]}),c.jsxs("div",{className:"flex flex-col items-center gap-2 group/next",children:[c.jsx("div",{className:`w-20 h-20 rounded-[2rem] flex items-center justify-center text-4xl border-2 shadow-2xl transition-all duration-500 ${me?"bg-slate-900/50 border-white/5 grayscale":"bg-indigo-600/20 border-indigo-500/50 shadow-indigo-500/20 hover:scale-110 active:scale-95"}`,children:C.icon}),c.jsx("span",{className:`text-xs font-black uppercase tracking-tight ${me?"text-slate-500":"text-amber-500"}`,children:C.name})]})]}),c.jsx("p",{className:"text-xs text-slate-400 text-center font-medium italic px-6 mt-2",children:me?`Forbedre ${se} til niv ${H} for  lse opp.`:`Besk ${se} i landsbyen for  smi din ${C.name}.`})]})})}return null})()]})]})})]})},kG=({weather:t,season:e,hideClouds:n,isInterior:s})=>{const i=_.useMemo(()=>Array.from({length:12}).map((d,f)=>({id:f,top:`${Math.random()*100}%`,delay:Math.random()*60,duration:40+Math.random()*60,scale:.5+Math.random()*1.5,opacity:.1+Math.random()*.3})),[]),r=_.useMemo(()=>Array.from({length:10}).map((d,f)=>({id:f,left:`${Math.random()*100}%`,delay:Math.random()*20,duration:10+Math.random()*20,size:5+Math.random()*10,rotation:Math.random()*360,drift:50+Math.random()*150})),[]),a=_.useMemo(()=>Array.from({length:5}).map((d,f)=>({id:f,left:`${10+Math.random()*80}%`,top:`${-10+Math.random()*40}%`,rotation:f*45+Math.random()*20,delay:f*2})),[]),o=()=>e==="Autumn"?"":e==="Spring"?"":e==="Winter"?"":"",u=100*(t==="Storm"?2.5:t==="Rain"?1.5:1);return c.jsxs("div",{className:"absolute inset-0 pointer-events-none overflow-hidden z-[5]",children:[t==="Clear"&&!s&&c.jsx("div",{className:"absolute inset-0 opacity-40",children:a.map(d=>c.jsx("div",{className:"absolute w-[400px] h-[800px] animate-sunbeam",style:{left:d.left,top:d.top,background:"radial-gradient(ellipse at top, rgba(253, 224, 71, 0.15) 0%, transparent 70%)",transform:`rotate(${d.rotation}deg)`,animationDelay:`${d.delay}s`}},d.id))}),!n&&!s&&c.jsx("div",{className:"absolute inset-0",children:i.map(d=>c.jsx("div",{className:"absolute text-white animate-cloud-drift select-none",style:{top:d.top,fontSize:`${d.scale*4}rem`,opacity:t==="Storm"?d.opacity*2:d.opacity,filter:"blur(8px)",animationDuration:`${t==="Storm"?d.duration/2:d.duration}s`,animationDelay:`-${d.delay}s`,color:t==="Storm"?"#475569":"white"},children:""},d.id))}),t==="Fog"&&!s&&c.jsx("div",{className:"absolute inset-0 bg-slate-400/10 backdrop-blur-[2px] animate-mist"}),!s&&c.jsx("div",{className:"absolute inset-0",children:r.map(d=>c.jsx("div",{className:"absolute animate-particle opacity-0",style:{left:d.left,fontSize:`${d.size}px`,animationDuration:`${d.duration}s`,animationDelay:`${d.delay}s`,filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.1))","--wind-drift":`${u+d.drift}px`,"--wind-rotation":`${720+d.rotation}deg`},children:o()},d.id))}),(t==="Clear"||s)&&c.jsx("div",{className:"absolute inset-0",children:Array.from({length:15}).map((d,f)=>c.jsx("div",{className:"absolute w-1 h-1 bg-white/40 rounded-full animate-dust-float",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDuration:`${6+Math.random()*8}s`,animationDelay:`${Math.random()*10}s`,filter:"blur(1px)"}},`dust-${f}`))}),(t==="Rain"||t==="Storm")&&!s&&c.jsx("div",{className:"absolute inset-0 bg-indigo-900/10 mix-blend-overlay"})]})},SG=({player:t,room:e})=>{const[n,s]=_.useState(Date.now()),{handleAction:i}=OS(e==null?void 0:e.pin,t,(e==null?void 0:e.world)||null,()=>{},()=>{},()=>{},null),[r,a]=_.useState({});_.useEffect(()=>{const m=setInterval(()=>{var b;const v=Date.now();if(s(v),Math.random()<.05){const y=((b=t.activeProcesses)==null?void 0:b.filter(p=>p.type==="CROP"&&p.readyAt>v))||[];if(y.length>0){const p=y[Math.floor(Math.random()*y.length)];if(!r[p.id]){const g=Math.random()>.5?"CROW":"WEED";a(x=>({...x,[p.id]:{type:g,expiresAt:v+1e4}}))}}}a(y=>{const p={...y};let g=!1;return Object.entries(p).forEach(([x,w])=>{w.expiresAt<v&&(delete p[x],g=!0)}),g?p:y})},1e3);return()=>clearInterval(m)},[t.activeProcesses,r]);const o=_.useCallback((m,v)=>{a(b=>{const y={...b};return delete y[m],y}),i({type:"MAINTAIN_CROP",processId:m,subType:v})},[i]),l=t.activeProcesses||[],u=n,d=l.filter(m=>!(!(m.type==="CROP"||m.type==="COOP"||m.type==="MILL"||m.type==="WELL")||m.type==="WELL"&&m.readyAt>0&&u>m.readyAt+1e4)),f=(t.activeBuffs||[]).filter(m=>m.expiresAt>u);if(d.length===0&&f.length===0)return null;d.sort((m,v)=>m.readyAt-v.readyAt);const h=m=>{const v=Math.floor(m/6e4),b=Math.floor(m%6e4/1e3);return`${v}m ${b}s`};return c.jsxs("div",{className:"absolute top-6 right-6 z-[60] flex flex-col gap-2 pointer-events-none items-end",children:[f.map(m=>{const v=Math.max(0,m.expiresAt-u);return c.jsxs("div",{className:"group bg-indigo-900/90 backdrop-blur-md border border-indigo-500/30 rounded-xl p-3 shadow-xl pointer-events-auto flex items-center gap-4 transition-all hover:bg-indigo-900/100 hover:scale-105 animate-in slide-in-from-right-4 duration-300 relative",children:[c.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center border bg-indigo-500/20 border-indigo-500 text-indigo-300",children:c.jsx("span",{className:"text-xl",children:""})}),c.jsxs("div",{className:"flex flex-col min-w-[120px]",children:[c.jsx("span",{className:"text-xs font-bold text-indigo-300 uppercase tracking-wider",children:m.label}),c.jsx("div",{className:"flex items-center gap-2",children:c.jsx("span",{className:"text-sm font-black text-white",children:h(v)})})]}),m.description&&c.jsx("div",{className:"absolute right-full top-1/2 -translate-y-1/2 mr-3 w-48 bg-slate-900/95 border border-indigo-500/30 p-3 rounded-xl shadow-2xl opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none translate-x-2 group-hover:translate-x-0",children:c.jsx("p",{className:"text-[10px] text-indigo-100 leading-tight",children:m.description})})]},m.id)}),d.map(m=>{const v=Math.max(0,m.readyAt-u),b=v<=0;let y="Avling Gror",p=c.jsx(my,{size:20}),g="Innhsting Klar!";const x=hn[m.itemId];m.type==="COOP"?(y="Hner Spiser",p=c.jsx("span",{className:"text-xl",children:""}),g="Egg klare!"):m.type==="MILL"?(y="Kverner korn",p=c.jsx("span",{className:"text-xl",children:""}),g="Mel klart!"):m.type==="WELL"?(y="Brnnen fyller seg",p=c.jsx("span",{className:"text-xl",children:""}),g="Brnnen er klar!"):x?(p=c.jsx("span",{className:"text-xl",children:x.icon}),y=`${x.label} gror`,g=`${x.label} klar!`):p=b?c.jsx(R0,{size:20}):c.jsx(my,{size:20});const w=r[m.id],N=!!w&&!b;return c.jsxs("div",{className:`relative bg-slate-900/90 backdrop-blur-md border rounded-xl p-3 shadow-xl pointer-events-auto flex items-center gap-4 transition-all hover:bg-slate-900/95 animate-in slide-in-from-right-4 duration-300 ${m.type==="WELL"&&b?"animate-pulse":""} ${N?"border-rose-500/50 hover:border-rose-400 cursor-pointer group":"border-white/10"}`,onClick:N?()=>o(m.id,w.type):void 0,children:[N&&c.jsx("div",{className:"absolute -top-3 -right-3 z-50 animate-bounce",children:c.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center shadow-lg border-2 border-white ${w.type==="CROW"?"bg-slate-800":"bg-emerald-700"}`,children:c.jsx("span",{className:"text-lg",children:w.type==="CROW"?"":""})})}),m.yieldBonus&&m.yieldBonus>0&&c.jsxs("div",{className:"absolute -bottom-2 -right-2 px-2 py-0.5 bg-emerald-600 text-white text-[10px] font-black rounded-full shadow-lg border border-emerald-400 z-10",children:["+",Math.round(m.yieldBonus*100),"%"]}),c.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center border ${b?"bg-emerald-500/20 border-emerald-500 text-emerald-400 animate-pulse":"bg-slate-800 border-white/10 text-slate-400"}`,children:p}),c.jsxs("div",{className:"flex flex-col min-w-[120px]",children:[c.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:b?g:N?w.type==="CROW"?"Fjern Krke!":"Luk ugress!":y}),c.jsx("div",{className:"flex items-center gap-2",children:c.jsx("span",{className:`text-sm font-black ${b?"text-emerald-400":N?"text-rose-400":"text-white"}`,children:b?"Hent n":h(v)})})]})]},m.id)})]})},Ad=({title:t,subtitle:e,icon:n,headerRight:s,children:i,onClose:r,className:a,maxWidth:o})=>(_.useEffect(()=>{const l=u=>{u.key==="Escape"&&r()};return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)},[r]),c.jsxs("div",{className:"absolute inset-0 z-40 flex items-center justify-center p-4 md:p-8",children:[c.jsx(De.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:r,className:"absolute inset-0 bg-black/20 backdrop-blur-[1px] cursor-pointer"}),c.jsxs(De.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{type:"spring",stiffness:260,damping:25,mass:1},className:`relative w-full ${o||"max-w-5xl"} max-h-full bg-slate-950/90 backdrop-blur-md border border-white/10 rounded-3xl shadow-2xl overflow-hidden flex flex-col pointer-events-auto will-change-transform`,children:[c.jsxs("div",{className:"flex-none flex justify-between items-center px-6 py-4 border-b border-white/10 bg-gradient-to-r from-white/5 to-transparent min-h-[72px]",children:[c.jsxs("div",{className:"flex items-center gap-5 overflow-hidden",children:[n&&c.jsx("div",{className:"w-12 h-12 bg-white/5 rounded-2xl flex items-center justify-center text-3xl shadow-inner border border-white/5 shrink-0",children:n}),c.jsxs("div",{className:"flex flex-col min-w-0",children:[t&&c.jsx("h2",{className:"text-xl font-display font-black text-white tracking-tighter uppercase truncate",children:t}),e&&c.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest truncate opacity-80",children:e})]}),s&&c.jsx("div",{className:"hidden sm:flex items-center pl-4 border-l border-white/10 ml-2",children:s})]}),c.jsx("button",{onClick:r,className:"w-8 h-8 bg-white/5 hover:bg-rose-500/20 text-slate-400 hover:text-rose-500 rounded-full flex items-center justify-center transition-all group",title:"Lukk vindu",children:c.jsx("span",{className:"text-lg group-hover:rotate-90 transition-transform",children:""})})]}),c.jsx("div",{className:`flex-1 overflow-y-auto custom-scrollbar p-6 ${a||""}`,children:i})]})]})),TG=({player:t,activeProcesses:e,onAction:n,onClose:s})=>{const i=e.filter(b=>b.type==="COOP"&&b.locationId==="chicken_coop"),r=i.length>0,a=i[0],[o,l]=_.useState(0);_.useEffect(()=>{if(!a){l(0);return}const b=()=>{const p=Math.max(0,a.readyAt-Date.now());l(p)};b();const y=setInterval(b,1e3);return()=>clearInterval(y)},[a]);const u=r&&o<=0,d=t.resources.grain||0,f=()=>{n({type:"FEED_CHICKENS",locationId:"chicken_coop"})},h=()=>{n({type:"COLLECT_EGGS",locationId:"chicken_coop"})},m=a?a.readyAt-a.startedAt:1,v=a?1-o/m:0;return c.jsx(Ad,{title:"Hnsehuset",icon:c.jsx("span",{className:"text-2xl",children:""}),onClose:s,children:c.jsxs("div",{className:"p-6 flex flex-col items-center gap-8 min-h-[400px]",children:[c.jsxs("div",{className:"relative w-full h-48 bg-slate-900/50 rounded-2xl overflow-hidden border border-white/10 flex items-center justify-center",children:[c.jsx("img",{src:"/Simulation_StandAlone_Pro/map_peasant_farm.png",className:"absolute inset-0 w-full h-full object-cover opacity-30 grayscale",alt:"Coop Background"}),c.jsxs("div",{className:"relative z-10 flex gap-4",children:[c.jsx(De.div,{animate:{y:[0,-5,0]},transition:{repeat:1/0,duration:2,ease:"easeInOut"},className:"text-6xl",children:""}),r&&!u&&c.jsx(De.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-6xl",children:""}),u&&c.jsx(De.div,{initial:{scale:0},animate:{scale:[1,1.2,1]},transition:{repeat:1/0,duration:1},className:"text-6xl drop-shadow-[0_0_15px_rgba(251,191,36,0.8)]",children:""})]})]}),c.jsxs("div",{className:"text-center space-y-4 max-w-sm",children:[!r&&c.jsxs(c.Fragment,{children:[c.jsx("h3",{className:"text-xl font-bold text-white",children:"Sultne Hner"}),c.jsx("p",{className:"text-slate-400 text-sm",children:"Hnene kakler utlmodig. Gi dem korn for  starte eggproduksjonen."}),c.jsxs("div",{className:"flex items-center justify-center gap-4 bg-slate-800/50 p-4 rounded-xl border border-white/5",children:[c.jsx(hp,{resource:"grain",amount:d,size:"lg"}),c.jsx("button",{onClick:f,disabled:d<5,className:`
                                        px-6 py-3 rounded-xl font-bold uppercase tracking-wider text-sm transition-all
                                        ${d>=5?"bg-amber-500 hover:bg-amber-400 text-amber-950 shadow-amber-500/20 shadow-lg":"bg-slate-700 text-slate-500 cursor-not-allowed"}
                                    `,children:"Fr Hner (5 Korn)"})]})]}),r&&!u&&c.jsxs(c.Fragment,{children:[c.jsx("h3",{className:"text-xl font-bold text-white",children:"Hnene Spiser"}),c.jsx("p",{className:"text-slate-400 text-sm",children:"Det tar tid  lage gode egg..."}),c.jsx("div",{className:"w-full h-4 bg-slate-800 rounded-full overflow-hidden border border-white/10",children:c.jsx(De.div,{className:"h-full bg-amber-500",initial:{width:`${v*100}%`},animate:{width:`${v*100}%`},transition:{duration:1,ease:"linear"}})}),c.jsxs("p",{className:"font-mono text-amber-400 font-bold",children:[Math.ceil(o/6e4)," minutter igjen"]})]}),u&&c.jsxs(c.Fragment,{children:[c.jsx("h3",{className:"text-xl font-bold text-white",children:"Eggene er klare!"}),c.jsx("p",{className:"text-slate-400 text-sm",children:"Redet er fullt av ferske egg."}),c.jsx("button",{onClick:h,className:"px-8 py-4 bg-emerald-500 hover:bg-emerald-400 text-white rounded-xl font-black uppercase tracking-widest text-lg shadow-emerald-500/30 shadow-2xl animate-pulse",children:"Samle Egg"})]})]})]})})},AG=({buildingId:t,player:e,room:n,onAction:s})=>{var d,f,h,m;const i=Ut[t];if(!i)return null;const r=t==="farm_house",a=r?((d=e.buildings)==null?void 0:d[t])||{level:1,progress:{}}:((m=(h=(f=n.world)==null?void 0:f.settlement)==null?void 0:h.buildings)==null?void 0:m[t])||{level:1,progress:{},contributions:{}},l=(a.level||1)+1,u=i.levels[l];return c.jsxs("div",{className:"space-y-8 py-4 relative",children:[c.jsxs("div",{className:"bg-slate-900/80 rounded-[2rem] p-8 w-full border border-white/5 text-center relative overflow-hidden",children:[c.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-indigo-500/5 blur-3xl rounded-full -mr-16 -mt-16"}),c.jsxs("p",{className:"text-indigo-300 text-sm font-bold mb-4 uppercase tracking-widest flex items-center justify-center gap-2",children:[c.jsx("span",{className:"w-2 h-2 bg-indigo-500 rounded-full animate-pulse"}),"Bonus ved neste niv: ",(u==null?void 0:u.bonus)||"Maksimal effekt"]}),c.jsxs("p",{className:"text-slate-400 text-sm leading-relaxed italic opacity-80",children:['"',i.description,'"']})]}),u?c.jsxs("div",{className:"w-full space-y-8",children:[c.jsxs("div",{className:"text-left",children:[c.jsxs("div",{className:"text-[10px] font-black text-slate-500 uppercase tracking-[0.2em] mb-4",children:["Byggeprogresjon (Niv ",l,")"]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(u.requirements||{}).map(([v,b])=>{var T,E;const y=Math.floor(((T=a.progress)==null?void 0:T[v])||0),p=Math.min(100,y/b*100),g=Math.floor(((E=e.resources)==null?void 0:E[v])||0),x=b-y,w=g>0&&x>0,N=Math.min(g,x);return c.jsxs("div",{className:"p-5 bg-slate-900/70 rounded-2xl border border-white/5 space-y-3",children:[c.jsxs("div",{className:"flex justify-between items-end",children:[c.jsx("span",{className:"text-xs font-black uppercase text-slate-300 tracking-widest",children:v}),c.jsxs("span",{className:"text-xs font-bold text-slate-500",children:[y," / ",b]})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("div",{className:"h-2.5 bg-black/40 rounded-full overflow-hidden border border-white/5 shadow-inner",children:c.jsx("div",{className:"h-full bg-gradient-to-r from-indigo-600 to-indigo-400 transition-all duration-1000 shadow-[0_0_15px_rgba(79,70,229,0.4)]",style:{width:`${p}%`}})}),x>0?w?c.jsxs("button",{onClick:()=>s({type:r?"CONTRIBUTE_TO_PRIVATE_UPGRADE":"CONTRIBUTE_TO_UPGRADE",buildingId:t,resource:v,amount:N}),className:"w-full py-2 bg-indigo-600/80 hover:bg-indigo-600 text-white text-[10px] font-black rounded-xl transition-all active:scale-95 shadow-lg shadow-indigo-600/20 uppercase tracking-widest",children:["Bidra ",N," ",v]}):c.jsxs("div",{className:"w-full py-2 bg-rose-900/10 border border-rose-500/10 text-rose-500/60 text-[9px] font-black rounded-xl text-center uppercase tracking-widest",children:["Mangler ",v]}):c.jsx("div",{className:"text-[10px] text-emerald-500 font-bold uppercase tracking-widest text-center py-1",children:"Krav mtt "})]})]},v)})})]}),!r&&a.contributions&&Object.keys(a.contributions).length>0&&c.jsxs("div",{className:"w-full bg-indigo-500/5 rounded-3xl p-6 border border-indigo-500/10",children:[c.jsxs("div",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-indigo-400 mb-4 flex items-center gap-2",children:[c.jsx("span",{className:"w-1.5 h-1.5 bg-indigo-500 rounded-full"}),"Siste bidrag fra riket"]}),c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:Object.entries(a.contributions).slice(0,4).map(([v,b])=>c.jsxs("div",{className:"flex justify-between items-center bg-black/20 px-4 py-3 rounded-xl border border-white/5",children:[c.jsx("span",{className:"text-xs font-bold text-slate-200",children:b.name}),c.jsx("div",{className:"flex gap-2",children:Object.entries(b.resources||{}).map(([y,p])=>c.jsxs("span",{className:"text-[10px] font-black text-emerald-400",children:["+",p]},y))})]},v))})]}),Object.entries(u.requirements).every(([b,y])=>{var p;return(((p=a.progress)==null?void 0:p[b])||0)>=y})?c.jsx("button",{onClick:()=>{s({type:r?"CONTRIBUTE_TO_PRIVATE_UPGRADE":"CONTRIBUTE_TO_UPGRADE",buildingId:t,resource:"dummy",amount:0})},className:"w-full py-6 bg-emerald-600 hover:bg-emerald-500 text-white font-black uppercase tracking-widest rounded-[1.5rem] shadow-2xl transition-all active:scale-95 flex items-center justify-center gap-3 animate-bounce mt-4 shadow-emerald-600/20",children:"Fullfr Oppgradering "}):null]}):c.jsxs("div",{className:"py-12 px-10 bg-emerald-500/5 border border-emerald-500/10 rounded-[2.5rem] text-center w-full",children:[c.jsx("div",{className:"text-emerald-400 font-black uppercase tracking-widest text-lg mb-2",children:"Mesterverk fullfrt! "}),c.jsx("div",{className:"text-slate-400 text-sm font-medium",children:"Denne bygningen har ndd sitt maksimale potensial."})]})]})},RG=({npc:t,step:e,setStep:n,onClose:s})=>{var i,r;return c.jsx("div",{className:"absolute inset-0 z-50 bg-black/80 backdrop-blur-sm flex items-center justify-center p-6 animate-in fade-in duration-300",children:c.jsxs("div",{className:"bg-slate-900 border-2 border-amber-600/30 rounded-2xl max-w-lg w-full overflow-hidden shadow-2xl",children:[c.jsxs("div",{className:"bg-slate-950 p-6 border-b border-white/5 flex gap-4 items-center",children:[c.jsx("div",{className:"w-16 h-16 rounded-full bg-slate-800 border-2 border-amber-500/50 flex items-center justify-center text-3xl shadow-inner",children:""}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-black text-amber-500",children:t.name}),c.jsx("p",{className:"text-sm text-slate-400 italic font-medium",children:t.role})]}),c.jsx("button",{onClick:s,className:"ml-auto w-8 h-8 bg-white/5 hover:bg-white/10 rounded-full flex items-center justify-center text-white transition-colors",children:""})]}),c.jsxs("div",{className:"p-8 space-y-6",children:[c.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-widest mb-2 opacity-50",children:t.description}),c.jsxs("p",{className:"text-slate-300 text-lg leading-relaxed italic border-l-4 border-amber-500/20 pl-4 py-2",children:['"',((i=t.conversation[e])==null?void 0:i.text)||"...",'"']}),c.jsx("div",{className:"grid gap-3 pt-4",children:(r=t.conversation[e])==null?void 0:r.options.map((a,o)=>c.jsxs("button",{onClick:()=>{a.nextId==="EXIT"?s():n(a.nextId)},className:"w-full text-left bg-white/5 hover:bg-amber-500/10 hover:border-amber-500/50 border border-white/10 p-4 rounded-xl transition-all font-medium text-slate-200 active:scale-[0.98]",children:[c.jsx("span",{className:"text-amber-500 mr-2",children:""})," ",a.label]},o))})]})]})})},IG=({viewMode:t,viewingRegionId:e,player:n,onSelect:s,onEnterHub:i,onPOIAction:r,room:a})=>t==="kingdom"?null:c.jsx(c.Fragment,{children:lr.map(o=>{var E,A,k,R;if(!(t==="global"?!o.parentId:o.parentId===t))return null;const u=o.roles.includes(n.role)||o.id==="market"||o.isHub,d=["grain_fields","forest_clearing","mine_shaft","quarry_poi","forest_forage"].includes(o.id),f=t==="global",h=f&&e==="region_ost",m=f&&(e==="region_vest"||e==="capital"),v=t==="village",b=Object.values(a.players||{});let y=o.top,p=o.left;v&&o.village?(y=o.village.top,p=o.village.left):h&&o.ost?(y=o.ost.top,p=o.ost.left):m&&o.vest&&(y=o.vest.top,p=o.vest.left);const g=o.id==="castle",x=g&&b.some(I=>I.role==="BARON"&&I.regionId===e||e==="capital"&&I.role==="KING"),w=g?e==="capital"?"throne_room":e==="region_ost"?"manor_ost":"manor_vest":"",T=(g&&((R=(k=(A=(E=a.world)==null?void 0:E.settlement)==null?void 0:A.buildings)==null?void 0:k[w])==null?void 0:R.level)||0)>=1||x;return c.jsx(De.div,{style:{top:y,left:p},initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"absolute -translate-x-1/2 -translate-y-1/2 group z-20 pointer-events-auto",children:c.jsxs("button",{onClick:()=>{if(g&&!T){r(o.id,"OPEN_CONSTRUCTION");return}o.isHub?i(o.id):s(o)},className:`flex flex-col items-center transition-all ${u?"scale-100":"scale-75 opacity-40 grayscale pointer-events-none"}`,children:[c.jsx("div",{className:"w-16 h-16 rounded-3xl flex items-center justify-center text-4xl shadow-2xl border-2 transition-all duration-300 group-hover:scale-110 bg-slate-900/90 backdrop-blur-xl border-white/10 hover:bg-slate-800",children:o.icon}),c.jsx("span",{className:"bg-indigo-600 text-white text-[10px] font-black uppercase tracking-widest px-3 py-1 rounded-full mt-2 shadow-2xl opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap shadow-indigo-600/30",children:d?"KLIKK FOR  STARTE":g?T?"G INN":"BIDRA TIL BYGGING":o.label})]})},o.id)})}),CG=({viewMode:t,viewingRegionId:e,worldEvents:n,onSelect:s})=>t==="kingdom"||!n?null:c.jsx(c.Fragment,{children:Object.values(n).map(i=>{const r=lr.find(m=>m.id===i.locationId);if(!r||!(t==="global"?!r.parentId:r.parentId===t))return null;const o=t==="global",l=o&&e==="region_ost",u=o&&(e==="region_vest"||e==="capital"),d=t==="village";let f=r.top,h=r.left;return d&&r.village?(f=r.village.top,h=r.village.left):l&&r.ost?(f=r.ost.top,h=r.ost.left):u&&r.vest&&(f=r.vest.top,h=r.vest.left),c.jsx(De.div,{style:{top:f,left:h},initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},className:"absolute -translate-x-1/2 -translate-y-[150%] z-30 pointer-events-auto",children:c.jsx("button",{onClick:()=>s(i),className:`w-14 h-14 rounded-full flex items-center justify-center text-3xl shadow-[0_0_30px_rgba(255,255,255,0.4)] border-4 animate-bounce hover:scale-110 transition-transform ${i.type==="RAID"?"bg-rose-600 border-rose-900 text-white":"bg-amber-400 border-amber-700 text-slate-800"}`,children:i.type==="RAID"?"":""})},i.id)})}),jG=({players:t,setViewingRegionId:e,setViewMode:n})=>{const s=Object.values(t||{}),i=s.find(a=>{var o;return a.role==="BARON"&&(a.regionId==="region_vest"||((o=a.regionId)==null?void 0:o.includes("vest")))}),r=s.find(a=>{var o;return a.role==="BARON"&&(a.regionId==="region_ost"||((o=a.regionId)==null?void 0:o.includes("ost")))});return c.jsxs(c.Fragment,{children:[c.jsx(De.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"absolute top-[35%] left-[50%] -translate-x-1/2 -translate-y-1/2 z-30 group pointer-events-auto",children:c.jsxs("button",{onClick:()=>{e("capital"),n("global")},className:"flex flex-col items-center hover:scale-110 transition-transform",children:[c.jsx("div",{className:"text-6xl drop-shadow-[0_0_15px_rgba(255,215,0,0.8)] animate-pulse",children:""}),c.jsx("div",{className:"bg-black/80 text-amber-400 px-4 py-2 rounded-xl mt-2 font-black uppercase tracking-widest text-xs border border-amber-500/50 shadow-xl backdrop-blur-md",children:"Kongeriket"})]})}),c.jsx(De.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"absolute top-[65%] left-[15%] -translate-x-1/2 -translate-y-1/2 z-30 group pointer-events-auto",children:c.jsxs("button",{onClick:()=>{e("region_vest"),n("global")},className:"flex flex-col items-center hover:scale-110 transition-transform",children:[c.jsx("div",{className:"text-5xl drop-shadow-[0_0_10px_rgba(255,255,255,0.5)]",children:""}),c.jsx("div",{className:"bg-black/80 text-indigo-300 px-3 py-1 rounded-xl mt-2 font-bold text-[10px] uppercase tracking-wider border border-white/10 shadow-xl backdrop-blur-md whitespace-nowrap",children:(i==null?void 0:i.name)||"Baroni Vest"})]})}),c.jsx(De.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"absolute top-[65%] left-[85%] -translate-x-1/2 -translate-y-1/2 z-30 group pointer-events-auto",children:c.jsxs("button",{onClick:()=>{e("region_ost"),n("global")},className:"flex flex-col items-center hover:scale-110 transition-transform",children:[c.jsx("div",{className:"text-5xl drop-shadow-[0_0_10px_rgba(255,255,255,0.5)]",children:""}),c.jsx("div",{className:"bg-black/80 text-emerald-300 px-3 py-1 rounded-xl mt-2 font-bold text-[10px] uppercase tracking-wider border border-white/10 shadow-xl backdrop-blur-md whitespace-nowrap",children:(r==null?void 0:r.name)||"Baroni st"})]})})]})},OG=({player:t,room:e,onAction:n,onClose:s,viewingRegionId:i})=>{var N,T,E,A;const r=i==="capital"||t.role==="BARON"||t.role==="KING"?["throne_room","manor_ost","manor_vest"]:i==="region_ost"?["manor_ost"]:["manor_vest"],[a,o]=_.useState(r[0]),l=((T=(N=e.world)==null?void 0:N.settlement)==null?void 0:T.buildings)||{},u=r.filter(k=>l[k]),d=u.includes(a)?a:u[0]||a,f=l[d],h=Ut[d];if(!f||!h)return c.jsx(Ad,{title:"Gjenoppbygging",onClose:s,children:c.jsxs("div",{className:"flex flex-col items-center justify-center h-96 text-center p-12",children:[c.jsx("div",{className:"w-16 h-16 bg-slate-900 rounded-full flex items-center justify-center mb-6 text-2xl opacity-50",children:""}),c.jsx("h3",{className:"text-xl font-black text-white italic mb-2",children:"Ingen aktive byggeprosjekter"}),c.jsx("p",{className:"text-slate-500 text-sm max-w-xs",children:"Det er ingen storsltte prosjekter i dette omrdet som krever din hjelp akkurat n. Prv  dra til hovedstaden eller et av baroniene."}),c.jsx("button",{onClick:s,className:"mt-8 px-8 py-3 bg-white/5 hover:bg-white/10 rounded-xl text-[10px] font-black uppercase tracking-widest text-slate-400",children:"Lukk vindu"})]})});const m=(f.level||0)+1,v=((A=(E=h.levels)==null?void 0:E[m])==null?void 0:A.requirements)||{},b=f.contributions||{};let y=0,p=0;Object.entries(v).forEach(([k,R])=>{var I;y+=R,p+=((I=f.progress)==null?void 0:I[k])||0});const g=y>0?p/y*100:0,x=(k,R)=>{n({type:"CONTRIBUTE",buildingId:d,resource:k,amount:R})},w=Object.entries(b).map(([k,R])=>{const I=q.CONTRIBUTION_VALUES;let P=0;return Object.entries(R.resources||{}).forEach(([V,$])=>{P+=$*(I[V]||I.default)}),{id:k,name:R.name,total:P}}).sort((k,R)=>R.total-k.total);return c.jsx(Ad,{title:"Gjenoppbygging & Lederskap",onClose:s,children:c.jsxs("div",{className:"max-h-[70vh] overflow-y-auto custom-scrollbar p-1",children:[u.length>1&&c.jsx("div",{className:"flex gap-2 mb-6 bg-slate-900/50 p-1.5 rounded-2xl border border-white/5 w-fit",children:u.map(k=>{var R;return c.jsx("button",{onClick:()=>o(k),className:`px-4 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all ${d===k?"bg-indigo-600 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:((R=Ut[k])==null?void 0:R.name)||k},k)})}),c.jsxs("div",{className:"relative h-48 rounded-3xl overflow-hidden mb-8 group border border-white/5",children:[c.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-950 via-slate-900/40 to-transparent z-10"}),c.jsx("div",{className:"absolute inset-0 bg-cover bg-center opacity-40 group-hover:scale-105 transition-transform duration-1000 bg-[url('https://images.unsplash.com/photo-1599619351208-3e6c839d6828?q=80&w=2672&auto=format&fit=crop')]"}),c.jsxs("div",{className:"absolute bottom-6 left-8 z-20",children:[c.jsx("h3",{className:"text-3xl font-black text-white italic tracking-tighter uppercase",children:h.name}),c.jsx("p",{className:"text-slate-300 font-medium text-xs max-w-md",children:h.description})]}),c.jsx("div",{className:"absolute top-6 right-8 z-20 bg-emerald-500/20 backdrop-blur-md px-4 py-2 rounded-full border border-emerald-500/30",children:c.jsxs("span",{className:"text-emerald-400 font-black text-xs tabular-nums",children:[g.toFixed(0),"% FULLFRT"]})})]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[c.jsx("div",{className:"space-y-6",children:c.jsxs("section",{children:[c.jsx("h4",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mb-4",children:"Mangler for ferdigstillelse"}),c.jsx("div",{className:"space-y-4",children:Object.entries(v).map(([k,R])=>{var B,j,O,C;const I=((B=f.progress)==null?void 0:B[k])||0,P=R,V=Math.min(100,I/P*100),$=I>=P,K=((j=t.resources)==null?void 0:j[k])||0;return c.jsxs("div",{className:`p-4 rounded-2xl border transition-all ${$?"bg-emerald-500/5 border-emerald-500/20":"bg-slate-900/50 border-white/5"}`,children:[c.jsxs("div",{className:"flex justify-between items-center mb-2",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("span",{className:"text-xl",children:((O=hn[k])==null?void 0:O.icon)||""}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-bold text-white tracking-tight italic",children:((C=hn[k])==null?void 0:C.label)||k}),c.jsxs("p",{className:"text-[10px] text-slate-500 font-medium",children:["Beholdning: ",c.jsx("span",{className:"text-slate-300",children:K})]})]})]}),c.jsx("div",{className:"text-right",children:c.jsxs("span",{className:`text-xs font-black ${$?"text-emerald-400":"text-slate-300"}`,children:[I," / ",P]})})]}),c.jsx("div",{className:"h-1.5 w-full bg-slate-950 rounded-full overflow-hidden mb-4",children:c.jsx("div",{style:{width:`${V}%`},className:`h-full transition-all duration-500 ${$?"bg-emerald-500":"bg-indigo-500"}`})}),!$&&K>0&&c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>x(k,Math.min(10,K)),className:"flex-1 py-2 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl text-[10px] font-black text-white transition-all uppercase",children:"Gi 10"}),c.jsx("button",{onClick:()=>x(k,Math.min(50,K)),className:"flex-1 py-2 bg-indigo-600 hover:bg-indigo-500 rounded-xl text-[10px] font-black text-white transition-all uppercase",children:"Gi 50"})]})]},k)})})]})}),c.jsxs("div",{className:"space-y-8",children:[c.jsxs("section",{className:"bg-slate-900/50 border border-white/5 rounded-[2rem] p-6",children:[c.jsx("h4",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mb-6 px-2",children:"Toppbidragsytere"}),c.jsx("div",{className:"space-y-2",children:w.length===0?c.jsx("div",{className:"text-center py-8 text-slate-500 text-xs italic",children:"Ingen bidrag enda. Bli den frste!"}):w.slice(0,5).map((k,R)=>c.jsxs("div",{className:`flex items-center justify-between p-3 rounded-xl ${R===0?"bg-amber-500/10 border border-amber-500/20":"hover:bg-white/5 transition-colors"}`,children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:`w-6 h-6 rounded-lg flex items-center justify-center text-[10px] font-black ${R===0?"bg-amber-500 text-slate-950":"bg-slate-800 text-slate-400"}`,children:R+1}),c.jsx("span",{className:`text-sm font-bold ${R===0?"text-white":"text-slate-300"}`,children:k.name})]}),c.jsxs("span",{className:"text-xs font-mono text-slate-500",children:[k.total.toLocaleString()," poeng"]})]},k.id))})]}),c.jsxs("section",{className:"bg-indigo-600/10 border border-indigo-500/20 rounded-[2rem] p-6 relative overflow-hidden",children:[c.jsx("div",{className:"absolute -top-4 -right-4 w-24 h-24 bg-indigo-500/10 blur-2xl rounded-full"}),c.jsx("h4",{className:"text-[10px] font-black text-indigo-400 uppercase tracking-widest mb-4",children:"Gevinst"}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("span",{className:"text-4xl",children:a==="throne_room"?"":""}),c.jsxs("div",{children:[c.jsx("p",{className:"text-white font-black italic tracking-tight underline decoration-indigo-500/50",children:a==="throne_room"?"TITTEL: KONGE":"TITTEL: BARON"}),c.jsx("p",{className:"text-slate-400 text-xs mt-1",children:"Spilleren med hyest poengsum ved ferdigstillelse overtar styringen."})]})]})]})]})]})]})})},uA=Ee.memo(({player:t,room:e,world:n,worldEvents:s,players:i,onAction:r,onOpenMarket:a})=>{var be;const o=(n==null?void 0:n.season)||"Spring",{viewMode:l,setViewMode:u,viewingRegionId:d,setViewingRegionId:f,selectedPOI:h,setSelectedPOI:m,selectedEvent:v,setSelectedEvent:b,upgradingBuildingId:y,setUpgradingBuildingId:p,dialogNPC:g,setDialogNPC:x,dialogStep:w,setDialogStep:N,isDiceGameOpen:T,setIsDiceGameOpen:E,isChickenCoopOpen:A,setIsChickenCoopOpen:k,isConstructionOpen:R,setIsConstructionOpen:I,direction:P,handlePOIAction:V}=lG(t,r,a),$=(n==null?void 0:n.weather)||"Clear",B=(()=>{var Ft,jn,Dt,$n,pn,Hi,Gi;const H=Ns(((Ft=e.world)==null?void 0:Ft.gameTick)||0)==="NIGHT",me=o==="Winter";let se="";switch(l){case"kingdom":se=me?H?"map_kingdom_169_winter_night":"map_kingdom_169_winter":H?"map_kingdom_169_night":"map_kingdom_169";break;case"village":se=me?H?"map_village_hub_1610_winter_night":"map_village_hub_1610_winter":H?"map_village_hub_1610_night":"map_village_hub_1610";break;case"castle":se="map_castle_interior";break;case"fields":se=me?H?"map_farm_fields_winter_night":"map_farm_fields_winter":H?"map_farm_fields_night":"map_farm_fields";break;case"peasant_farm":{const Kn=(($n=(Dt=(jn=n==null?void 0:n.settlement)==null?void 0:jn.buildings)==null?void 0:Dt.farm_house)==null?void 0:$n.level)||1;se=Kn>1?`map_peasant_farm_lvl${Kn}`:"map_peasant_farm";break}case"farm_house":{const Kn=((Gi=(Hi=(pn=n==null?void 0:n.settlement)==null?void 0:pn.buildings)==null?void 0:Hi.farm_house)==null?void 0:Gi.level)||1;se=Kn>1?`map_stugo_interior_lvl${Kn}`:"map_stugo_interior";break}case"mine":se=me?H?"map_mountain_pass_winter_night":"map_mountain_pass_winter":H?"map_mountain_pass_night":"map_mountain_pass";break;case"forest":se=me?H?"map_forest_winter_night":"map_forest_winter":H?"map_forest_night":"map_forest";break;case"monastery":se=me?H?"map_monastery_winter_night":"map_monastery_winter":H?"map_monastery_night":"map_monastery";break;case"tavern":se="map_tavern_interior";break;case"great_forge":se="map_forge_interior";break;case"bakery":se="map_bakery_interior";break;case"windmill":se="map_windmill_interior";break;case"sawmill":se="map_sawmill_interior";break;case"smeltery":se="map_smeltery_interior";break;case"weavery":se="map_weavery_interior";break;case"stables":se="map_stables_interior";break;case"watchtower":se="map_watchtower_interior";break;case"well":se=me?H?"map_well_interior_winter_night":"map_well_interior_winter":H?"map_well_interior_night":"map_well_interior";break;case"apothecary":se="map_apothecary_interior";break;case"global":d==="region_ost"?se=me?H?"map_barony_ost_169_winter_night":"map_barony_ost_169_winter":H?"map_barony_ost_169_night":"map_barony_ost_169":d==="capital"?se=me?H?"map_hovedstad_169_winter_night":"map_hovedstad_169_winter":H?"map_hovedstad_169_night":"map_hovedstad_169":se=me?H?"map_barony_vest_v2_1610_winter_night":"map_barony_vest_v2_1610_winter":H?"map_barony_vest_v2_1610_night":"map_barony_vest_v2_1610";break;default:se="map_barony_vest_v2_1610"}const tt="/Simulation_StandAlone_Pro/";return{src:`${tt}${se}.webp`,placeholder:`${tt}${se}_tiny.webp`,original:`${tt}${se}.png`}})(),O=l==="kingdom"||l==="global"&&(d==="region_ost"||d==="capital")?"aspect-video":"aspect-[16/10]",C={initial:H=>({opacity:0,scale:H==="in"?.9:1.1,filter:"blur(10px)"}),animate:{opacity:1,scale:1,filter:"blur(0px)",transition:{duration:.6,ease:[.16,1,.3,1],staggerChildren:.05}},exit:H=>({opacity:0,scale:H==="in"?1.1:.9,filter:"blur(10px)",transition:{duration:.4,ease:[.7,0,.84,0]}})},F=`${l}-${d}`,Q=_.useMemo(()=>lr.find(H=>H.id===l),[l]),oe=!!(Q!=null&&Q.isInterior);return c.jsxs("div",{className:"relative w-full h-full flex flex-col items-center justify-center p-0",children:[c.jsxs("div",{className:`relative w-full max-w-full max-h-full mx-auto ${O} rounded-[2rem] overflow-hidden shadow-[0_0_80px_rgba(0,0,0,0.5)] border-4 border-white/5 bg-slate-950 transition-all duration-1000`,children:[c.jsx(Ei,{mode:"popLayout",custom:P,children:c.jsxs(De.div,{custom:P,variants:C,initial:"initial",animate:"animate",exit:"exit",className:"absolute inset-0 w-full h-full",children:[c.jsxs("div",{className:"w-full h-full relative",children:[c.jsx(cA,{src:B.src,placeholderSrc:B.placeholder,alt:"Map View",className:"w-full h-full",disableMotion:!0}),c.jsx("div",{className:`absolute inset-0 pointer-events-none transition-opacity duration-1000 ${$==="Fog"?"opacity-100 backdrop-blur-sm bg-white/10":"opacity-0"}`})]}),c.jsx(kG,{weather:$,season:o,isInterior:oe}),c.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[l==="kingdom"&&c.jsx(jG,{players:i||{},setViewingRegionId:f,setViewMode:u}),c.jsx(IG,{viewMode:l,viewingRegionId:d,player:t,room:e,onSelect:m,onEnterHub:u,onPOIAction:V}),c.jsx(CG,{viewMode:l,viewingRegionId:d,worldEvents:s,onSelect:b})]})]},F)}),c.jsx(SG,{player:t,room:e}),l!=="kingdom"&&c.jsxs("button",{onClick:()=>{if(l==="global")u("kingdom");else{const H=lr.find(me=>me.id===l);H!=null&&H.parentId?u(H.parentId):u("global")}},className:"absolute top-6 left-6 z-50 px-6 py-3 bg-slate-950/80 backdrop-blur-md border border-white/10 rounded-2xl text-[10px] font-black uppercase tracking-widest text-slate-400 hover:text-white hover:border-white/20 transition-all active:scale-95 flex items-center gap-2 group",children:[c.jsx("span",{className:"text-lg group-hover:-translate-x-1 transition-transform",children:""}),"Tilbake"]}),v&&c.jsx("div",{className:"absolute inset-x-6 bottom-6 z-40 animate-in slide-in-from-bottom-8 duration-500",children:c.jsxs("div",{className:"bg-slate-900/95 backdrop-blur-2xl rounded-[2.5rem] shadow-[0_30px_100px_rgba(0,0,0,0.8)] border border-white/10 p-8",children:[c.jsxs("div",{className:"flex justify-between items-start mb-6",children:[c.jsxs("div",{children:[c.jsx("span",{className:`text-[10px] font-black uppercase tracking-widest px-3 py-1 rounded-full ${v.type==="RAID"?"bg-rose-500/20 text-rose-400":"bg-amber-500/20 text-amber-500"}`,children:v.type==="RAID"?" Akutt Trussel":" Spesielt Oppdrag"}),c.jsx("h3",{className:"text-3xl font-black text-white mt-4 tracking-tighter",children:v.title})]}),c.jsx("button",{onClick:()=>b(null),className:"w-10 h-10 bg-white/5 hover:bg-white/10 text-white rounded-full flex items-center justify-center transition-colors",children:""})]}),c.jsxs("p",{className:"text-sm font-medium text-slate-400 mb-8 leading-relaxed italic opacity-80",children:['"',v.description,'"']}),c.jsx("button",{onClick:()=>{r({type:v.type==="RAID"?"DEFEND":"EXPLORE",eventId:v.id}),b(null)},className:`w-full py-5 rounded-2xl font-black uppercase tracking-widest text-sm shadow-2xl transition-all active:scale-95 ${v.type==="RAID"?"bg-rose-600 text-white shadow-rose-600/20":"bg-amber-500 text-slate-950 shadow-amber-500/20"}`,children:v.type==="RAID"?"TIL VPEN! ":"UTFORSK OMRDET! "})]})}),c.jsx(Ei,{children:h&&c.jsx(NG,{poi:h,player:t,room:e,onAction:H=>V(h.id,H),onClose:()=>m(null),viewingRegionId:d})})]}),c.jsxs(Ei,{children:[y&&c.jsx(Ad,{title:"Bygg & Oppgrader",onClose:()=>p(null),children:c.jsx(AG,{buildingId:y,player:t,room:e,onAction:r})}),T&&c.jsx(cG,{playerGold:((be=t.resources)==null?void 0:be.gold)||0,onClose:()=>E(!1),onPlay:H=>r({type:"PLAY_DICE",...H})}),A&&c.jsx(TG,{player:t,activeProcesses:t.activeProcesses||[],onAction:r,onClose:()=>k(!1)}),g&&c.jsx(RG,{npc:g,step:w,setStep:N,onClose:()=>x(null)}),R&&c.jsx(OG,{player:t,room:e,onAction:r,onClose:()=>I(!1),viewingRegionId:d})]})]})},(t,e)=>{var i,r,a,o,l,u;if(((i=t.world)==null?void 0:i.season)!==((r=e.world)==null?void 0:r.season)||((a=t.world)==null?void 0:a.weather)!==((o=e.world)==null?void 0:o.weather))return!1;const n=Ns(((l=t.world)==null?void 0:l.gameTick)||0),s=Ns(((u=e.world)==null?void 0:u.gameTick)||0);return n!==s||t.player.activeProcesses!==e.player.activeProcesses?!1:t.player===e.player&&t.room===e.room&&t.world===e.world&&t.worldEvents===e.worldEvents});uA.displayName="GameMap";const MG=({onClose:t})=>{const{currentTrackId:e,playlist:n,playNext:s,playPrevious:i,toggleIgnoreTrack:r,isIgnored:a,playMusic:o,stopMusic:l}=S0(),[u,d]=_.useState(!!e),f=n.find(m=>m.id===e)||n[0],h=()=>{u&&e?(l(),d(!1)):(e?o(e):s(),d(!0))};return c.jsxs("div",{className:"absolute inset-0 z-50 flex items-center justify-center p-4",children:[c.jsx(De.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:t,className:"absolute inset-0 bg-black/60 backdrop-blur-sm cursor-pointer"}),c.jsxs(De.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",bounce:.3},className:"relative w-full max-w-4xl h-[600px] bg-slate-950/80 backdrop-blur-2xl border border-white/10 rounded-[3rem] shadow-2xl overflow-hidden flex flex-col md:flex-row",children:[c.jsx("button",{onClick:t,className:"absolute top-6 right-6 z-20 p-2 rounded-full bg-white/5 hover:bg-white/10 text-white transition-colors",children:c.jsx(ji,{size:24})}),c.jsxs("div",{className:"flex-1 relative flex flex-col items-center justify-center p-12 bg-gradient-to-br from-indigo-900/40 to-slate-900/40 border-r border-white/5",children:[c.jsx("div",{className:`absolute inset-0 opacity-30 bg-gradient-to-tr ${(f==null?void 0:f.mood)==="Dark"?"from-rose-900/40":"from-indigo-600/20"} to-transparent transition-colors duration-1000`}),c.jsxs("div",{className:"relative z-10 mb-12 group",children:[c.jsxs("div",{className:`w-64 h-64 rounded-full bg-slate-900 border-4 border-white/10 shadow-[0_0_60px_rgba(0,0,0,0.6)] flex items-center justify-center relative overflow-hidden ${u&&e?"animate-[spin_8s_linear_infinite]":""}`,children:[c.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle,rgba(99,102,241,0.2)0%,transparent_70%)]"}),c.jsx("div",{className:"absolute inset-2 rounded-full border border-white/5 opacity-50"}),c.jsx("div",{className:"absolute inset-8 rounded-full border border-white/5 opacity-30"}),c.jsx(m3,{size:64,className:"text-white/20"})]}),c.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:c.jsx("button",{onClick:h,className:"w-20 h-20 bg-white/90 rounded-full flex items-center justify-center shadow-2xl hover:scale-105 active:scale-95 transition-all text-slate-900",children:u&&e?c.jsx(lp,{size:32,fill:"currentColor"}):c.jsx(yd,{size:32,fill:"currentColor",className:"ml-1"})})})]}),c.jsxs("div",{className:"text-center space-y-2 z-10",children:[c.jsx("p",{className:"text-xs font-black uppercase tracking-[0.3em] text-indigo-400",children:"N Spiller"}),c.jsx("h2",{className:"text-3xl font-black text-white tracking-tighter max-w-sm leading-tight",children:f?f.title:"Ingen Musikk"}),(f==null?void 0:f.mood)&&c.jsxs("span",{className:"inline-block px-3 py-1 bg-white/5 rounded-full text-[10px] font-bold text-slate-400 uppercase tracking-widest border border-white/5",children:[f.mood," Mood"]})]})]}),c.jsxs("div",{className:"w-full md:w-[400px] bg-black/20 flex flex-col",children:[c.jsxs("div",{className:"p-8 pb-4 border-b border-white/5 flex items-center justify-between",children:[c.jsxs("h3",{className:"text-sm font-black text-white uppercase tracking-widest flex items-center gap-2",children:[c.jsx(B3,{size:16,className:"text-indigo-400"})," Spilleliste"]}),c.jsxs("span",{className:"text-[10px] font-bold text-slate-500",children:[n.length," Spor"]})]}),c.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 space-y-2",children:n.map((m,v)=>{const b=e===m.id,y=a(m.id);return c.jsxs("div",{className:`group flex items-center justify-between p-4 rounded-xl border transition-all duration-300 ${b?"bg-indigo-600/10 border-indigo-500/50 shadow-lg shadow-indigo-900/20":y?"bg-transparent border-transparent opacity-40 grayscale hover:opacity-100 hover:bg-slate-800/50":"bg-transparent border-transparent hover:bg-white/5 hover:border-white/5"}`,children:[c.jsxs("button",{onClick:()=>{o(m.id),d(!0)},className:"flex items-center gap-4 flex-1 text-left min-w-0",children:[c.jsx("span",{className:`text-xs font-bold w-6 text-center ${b?"text-indigo-400":"text-slate-600"}`,children:b?c.jsx(dP,{size:14,className:"mx-auto animate-pulse"}):v+1}),c.jsx("div",{className:"min-w-0",children:c.jsx("p",{className:`text-sm font-bold truncate ${b?"text-white":"text-slate-400 group-hover:text-slate-200"}`,children:m.title})})]}),c.jsx("button",{onClick:p=>{p.stopPropagation(),r(m.id)},className:`p-2 rounded-lg opacity-0 group-hover:opacity-100 transition-all ${y?"opacity-100 text-rose-400 hover:bg-rose-500/10":"text-slate-500 hover:text-white hover:bg-white/10"}`,title:y?"Gjenoppta":"Ignorer",children:y?c.jsx(g3,{size:16}):c.jsx(b3,{size:16})})]},m.id)})}),c.jsxs("div",{className:"p-6 border-t border-white/5 bg-black/40 flex items-center justify-between",children:[c.jsx("button",{onClick:i,className:"p-4 rounded-full hover:bg-white/5 text-slate-400 hover:text-white transition-colors",children:c.jsx(Z3,{size:20})}),c.jsx("div",{className:"h-10 w-[1px] bg-white/5"}),c.jsx("button",{onClick:h,className:"p-4 rounded-full hover:bg-white/5 text-white transition-colors scale-110 active:scale-95",children:u&&e?c.jsx(lp,{size:24,fill:"currentColor"}):c.jsx(yd,{size:24,fill:"currentColor",className:"ml-1"})}),c.jsx("div",{className:"h-10 w-[1px] bg-white/5"}),c.jsx("button",{onClick:s,className:"p-4 rounded-full hover:bg-white/5 text-slate-400 hover:text-white transition-colors",children:c.jsx(tP,{size:20})})]})]})]})]})},DG=({result:t,onClear:e})=>(_.useEffect(()=>{if(t){t.success&&t.utbytte&&t.utbytte.length>0&&t.utbytte.forEach((s,i)=>{s.amount>0&&setTimeout(()=>{Ge.spawnFlyingResource(s.resource,window.innerWidth/2,window.innerHeight/2,window.innerWidth-150,60)},i*200)});const n=setTimeout(()=>{e()},6e3);return()=>clearTimeout(n)}},[t,e]),c.jsx(Ei,{children:t&&c.jsxs(De.div,{initial:{opacity:0,y:-20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},className:"fixed top-[5%] left-1/2 transform -translate-x-1/2 bg-slate-900/95 border-2 border-amber-500/30 p-5 rounded-[2rem] shadow-[0_0_50px_rgba(0,0,0,0.5)] backdrop-blur-md min-w-[300px] text-center z-[300] overflow-hidden",children:[c.jsx("div",{className:"absolute bottom-0 left-0 h-1 bg-amber-500/20 w-full overflow-hidden",children:c.jsx(De.div,{initial:{width:"100%"},animate:{width:"0%"},transition:{duration:7,ease:"linear"},className:"h-full bg-amber-500"})}),c.jsx("button",{onClick:n=>{n.stopPropagation(),e()},className:"absolute top-4 right-4 text-slate-500 hover:text-white transition-colors p-1",children:c.jsx(ji,{className:"w-5 h-5"})}),c.jsxs("div",{className:"relative z-10",children:[c.jsx("div",{className:`text-lg font-black mb-3 tracking-tight ${t.success?"text-white":"text-rose-400"}`,children:t.message}),t.utbytte&&t.utbytte.length>0&&c.jsx("div",{className:"flex flex-wrap justify-center gap-2 mb-3",children:t.utbytte.map((n,s)=>{const i=hn[n.resource]||{label:n.resource,icon:""},r=n.name||i.label,a=n.icon||i.icon,o=n.amount>=0,l=n.jackpot;return c.jsxs(De.div,{initial:{scale:0,y:10},animate:{scale:1,y:0},transition:{delay:.2+s*.1,type:"spring"},className:`flex items-center gap-2 px-4 py-2 rounded-2xl text-sm font-black border shadow-lg ${l?"bg-gradient-to-r from-amber-200 to-yellow-400 border-yellow-300 text-yellow-900 shadow-amber-500/50 animate-pulse":o?"bg-emerald-500/10 border-emerald-500/30 text-emerald-400":"bg-rose-500/10 border-rose-500/30 text-rose-400"}`,children:[c.jsx("span",{className:"text-lg",children:a}),c.jsxs("span",{children:[o?"+":"",n.resource==="gold"?n.amount.toFixed(2):n.amount," ",l&&r]})]},`${n.resource}-${s}`)})}),t.xp&&t.xp.length>0&&c.jsx("div",{className:"flex flex-col gap-2 mb-2",children:t.xp.map((n,s)=>c.jsxs(De.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.4+s*.1},className:"text-xs font-black uppercase tracking-widest text-indigo-400 bg-indigo-500/5 py-1 rounded-lg",children:["+",n.amount," XP ",n.skill,n.levelUp&&c.jsxs(De.div,{initial:{scale:.5,opacity:0,rotate:-5},animate:{scale:[1,1.2,1],opacity:1,rotate:[0,5,-5,0],filter:["brightness(1)","brightness(2)","brightness(1)"]},transition:{duration:.6,times:[0,.5,1],repeat:1/0,repeatType:"reverse"},className:"mt-2 inline-flex items-center gap-2 bg-gradient-to-r from-amber-400 to-amber-600 text-black px-4 py-1.5 rounded-full text-[10px] font-black shadow-[0_0_20px_rgba(245,158,11,0.5)] border border-amber-300/50",children:[c.jsx("span",{children:""}),c.jsx("span",{className:"tracking-[0.2em]",children:"NIV OPPGGRADERT!"}),c.jsx("span",{children:""})]})]},`xp-${s}`))}),t.durability&&t.durability.length>0&&c.jsx("div",{className:"mt-4 pt-4 border-t border-white/5 flex flex-wrap justify-center gap-3",children:t.durability.map((n,s)=>c.jsxs("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider flex items-center gap-1",children:[" ",n.item,": ",c.jsxs("span",{className:n.amount>0?"text-rose-400":"text-emerald-400",children:[n.amount>0?"-":"+",Math.abs(n.amount),"%"]}),n.broken&&c.jsx("span",{className:"text-rose-500 font-black ml-1 animate-pulse",children:"(DELAGT!)"})]},`dura-${s}`))})]})]})})),LG=async(t,e,n,s)=>{if(e===n)return{success:!1,error:"Kan ikke gi gave til deg selv"};const i=D(L,`simulation_rooms/${t}/players/${e}`),r=D(L,`simulation_rooms/${t}/players/${n}`),a=await ye(i),o=await ye(r);if(!a.exists())return{success:!1,error:"Sender finnes ikke"};if(!o.exists())return{success:!1,error:"Mottaker finnes ikke"};const l=a.val(),u=o.val(),d=u.name;if(l.regionId!==u.regionId)return{success:!1,error:"Du kan kun sende gaver til spillere i din region."};let f=!1,h="";if(await Re(i,b=>{if(b===null)return b;b.resources||(b.resources={});for(const[y,p]of Object.entries(s))if((b.resources[y]||0)<p)return;for(const[y,p]of Object.entries(s))b.resources[y]-=p,h+=`${p} ${y}, `;return f=!0,b}),!f)return{success:!1,error:"Ikke nok ressurser til  sende gaven."};let m=!1;if(await Re(r,b=>{if(b===null)return b;b.resources||(b.resources={});for(const[y,p]of Object.entries(s))b.resources[y]=(b.resources[y]||0)+p;return m=!0,b}),!m)return console.error("CRITICAL: Gift transaction partial failure. Sender deducted but target failed.",e,n),{success:!1,error:"Transaksjonsfeil: Gaven gikk tapt i posten (Mottaker utilgjengelig i skrivende stund)."};const v=`Sendte gave (${h.slice(0,-2)}) til ${d}.`;return wt(t,`[GAVE] ${l.name} -> ${d}: ${h}`),{success:!0,data:{success:!0,timestamp:Date.now(),message:v}}},PG=async(t,e,n,s,i)=>{const r=D(L,`simulation_rooms/${t}/players/${e}`),a=D(L,`simulation_rooms/${t}/trades`),o=await ye(r),l=await ye(D(L,`simulation_rooms/${t}/players/${n}`));if(!o.exists()||!l.exists())return{success:!1,error:"Spiller finnes ikke"};const u=o.val(),d=l.val(),f=u.name,h=d.name;if(u.regionId!==d.regionId)return{success:!1,error:"Handel er kun tillatt med spillere i din region."};let m=!1;if(await Re(r,y=>{var p;if(y===null)return y;for(const[g,x]of Object.entries(s))if((((p=y.resources)==null?void 0:p[g])||0)<x)return;for(const[g,x]of Object.entries(s))y.resources[g]-=x;return m=!0,y}),!m)return{success:!1,error:"Ikke nok ressurser til  opprette handelen."};const v=hS(a),b={id:v.key,senderId:e,senderName:f,receiverId:n,receiverName:h,offer:s,demand:i,status:"PENDING",createdAt:Date.now(),expiresAt:Date.now()+1e3*60*60*24};return await Ba(v,b),wt(t,`[HANDEL] ${f} tilbd handel til ${h}.`),{success:!0,message:"Handelstilbud sendt."}},BG=async(t,e,n,s)=>{const i=D(L,`simulation_rooms/${t}/trades/${n}`),r=await ye(i);if(!r.exists())return{success:!1,error:"Handelen finnes ikke lenger."};const a=r.val();if(a.status!=="PENDING")return{success:!1,error:"Handelen er ikke lenger aktiv."};if(a.receiverId!==e&&a.senderId!==e&&!(a.senderId===e&&s==="REJECT"))return{success:!1,error:"Du har ikke tilgang til denne handelen."};if(s==="REJECT"){const o=D(L,`simulation_rooms/${t}/players/${a.senderId}`);return await Re(o,l=>{if(l===null)return l;l.resources||(l.resources={});for(const[u,d]of Object.entries(a.offer))l.resources[u]=(l.resources[u]||0)+d;return l}),await J(i,{status:a.senderId===e?"CANCELLED":"REJECTED"}),{success:!0,message:"Handel avbrutt/avsltt."}}if(s==="ACCEPT"){const o=D(L,`simulation_rooms/${t}/players/${e}`);let l=!1;if(await Re(o,d=>{var f;if(d===null)return d;for(const[h,m]of Object.entries(a.demand))if((((f=d.resources)==null?void 0:f[h])||0)<m)return;for(const[h,m]of Object.entries(a.demand))d.resources[h]-=m;for(const[h,m]of Object.entries(a.offer))d.resources[h]=(d.resources[h]||0)+m;return l=!0,d}),!l)return{success:!1,error:"Du har ikke rd til denne handelen."};const u=D(L,`simulation_rooms/${t}/players/${a.senderId}`);return await Re(u,d=>{if(d===null)return d;d.resources||(d.resources={});for(const[f,h]of Object.entries(a.demand))d.resources[f]=(d.resources[f]||0)+h;return d}),await J(i,{status:"ACCEPTED"}),wt(t,`[HANDEL] ${a.receiverName} godtok handelen fra ${a.senderName}.`),{success:!0,message:"Handel gjennomfrt!"}}},UG=({player:t,room:e,onAction:n,pin:s})=>{const[i,r]=_.useState([]),a=_.useRef({}),o=_.useRef(0),l=_.useMemo(()=>e.messages?Array.isArray(e.messages)?e.messages:Object.values(e.messages).sort((m,v)=>m.timestamp-v.timestamp):[],[e.messages]),u=m=>{r(b=>[...b,m]);const v=m.actions?1e4:5e3;setTimeout(()=>d(m.id),v)},d=m=>{r(v=>v.filter(b=>b.id!==m))},f=async(m,v)=>{const b=await BG(s,t.id,m,v);b&&b.success?(d(`trade-${m}`),u({id:`trade-res-${Date.now()}`,title:v==="ACCEPT"?"Handel Gjennomfrt":"Handel Avsltt",message:b.message||"Transaksjon fullfrt.",type:"TRADE"})):u({id:`trade-err-${Date.now()}`,title:"Feil ved handel",message:(b==null?void 0:b.error)||"Noe gikk galt.",type:"TRADE"})},h=(m,v,b)=>!b[m];return _.useEffect(()=>{const m=e.trades||{},v=a.current;Object.entries(m).forEach(([b,y])=>{if(h(b,y,v)&&y.receiverId===t.id&&y.status==="PENDING"){const p=Object.entries(y.offer).map(([x,w])=>`${w} ${x}`).join(", "),g=Object.entries(y.demand).map(([x,w])=>`${w} ${x}`).join(", ");u({id:`trade-${b}`,title:"Nytt Handelstilbud",message:`${y.senderName} tilbyr ${p} for ${g}.`,type:"TRADE",actions:[{label:"Aksepter",variant:"primary",icon:c.jsx(R0,{size:14}),onClick:()=>f(b,"ACCEPT")},{label:"Forhandle",variant:"neutral",icon:c.jsx(Ml,{size:14}),onClick:()=>{d(`trade-${b}`),alert("Forhandling er ikke implementert enn. Avsl handelen for  sende nytt tilbud.")}},{label:"Avsl",variant:"danger",icon:c.jsx(ji,{size:14}),onClick:()=>f(b,"REJECT")}]})}}),a.current=m},[e.trades,t.id,s]),_.useEffect(()=>{var b;const m=l;if(m.length===0)return;const v=m[m.length-1];if(o.current===0&&m.length>0){o.current=m[m.length-1].timestamp;return}if(v.timestamp>o.current){const y=v.content;if(y.startsWith("[GAVE]")&&y.includes(`-> ${t.name}`)){const g=y.split("->")[0].replace("[GAVE]","").trim(),x=((b=y.split(":")[1])==null?void 0:b.trim())||"";u({id:`gift-${v.timestamp}`,title:`Gave fra ${g}`,message:`Du mottok: ${x}`,type:"GIFT"})}o.current=v.timestamp}},[l,t.name]),i.length===0?null:c.jsx("div",{className:"absolute top-24 right-8 z-[100] flex flex-col gap-4 pointer-events-none",children:i.map(m=>c.jsxs("div",{className:"pointer-events-auto bg-slate-900/95 backdrop-blur-xl border border-white/10 p-4 rounded-xl shadow-2xl flex flex-col gap-3 animate-in slide-in-from-right duration-300 w-96",children:[c.jsxs("div",{className:"flex items-start gap-4",children:[c.jsx("div",{className:`p-3 rounded-lg ${m.type==="GIFT"?"bg-indigo-500/20 text-indigo-400":"bg-emerald-500/20 text-emerald-400"}`,children:m.type==="GIFT"?c.jsx(wS,{size:24}):c.jsx(I0,{size:24})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("h4",{className:"font-bold text-white text-sm",children:m.title}),c.jsx("p",{className:"text-slate-400 text-xs mt-1 leading-relaxed",children:m.message})]}),c.jsx("button",{onClick:()=>d(m.id),className:"text-slate-600 hover:text-white transition-colors",children:c.jsx(ji,{size:16})})]}),m.actions&&c.jsx("div",{className:"flex gap-2 pt-2 border-t border-white/5",children:m.actions.map((v,b)=>c.jsxs("button",{onClick:v.onClick,className:`
                                        flex-1 py-2 px-3 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition-all active:scale-95
                                        ${v.variant==="primary"?"bg-emerald-600 hover:bg-emerald-500 text-white shadow-lg shadow-emerald-500/20":""}
                                        ${v.variant==="danger"?"bg-rose-600/20 hover:bg-rose-600/30 text-rose-400 border border-rose-500/30":""}
                                        ${v.variant==="neutral"?"bg-slate-700 hover:bg-slate-600 text-slate-200":""}
                                    `,children:[v.icon,v.label]},b))})]},m.id))})},HG=Ee.lazy(()=>Mt(()=>import("./SimulationMarket-BPWa-msp.js"),__vite__mapDeps([0,1,2,3])).then(t=>({default:t.SimulationMarket}))),GG=Ee.lazy(()=>Mt(()=>import("./SimulationVault-Ck65IOxc.js"),__vite__mapDeps([4,5])).then(t=>({default:t.SimulationVault}))),VG=Ee.lazy(()=>Mt(()=>import("./SimulationSkills-Ds2jgMYV.js"),__vite__mapDeps([6,1,7])).then(t=>({default:t.SimulationSkills}))),FG=Ee.lazy(()=>Mt(()=>import("./SimulationProduction-BTOkKE8N.js"),__vite__mapDeps([8,2,7])).then(t=>({default:t.SimulationProduction}))),zG=Ee.lazy(()=>Mt(()=>import("./SimulationActivity-BybQUKsi.js"),[]).then(t=>({default:t.SimulationActivity}))),$G=Ee.lazy(()=>Mt(()=>import("./SimulationDiplomacy-uVsQJion.js"),[]).then(t=>({default:t.SimulationDiplomacy}))),KG=Ee.lazy(()=>Mt(()=>import("./SimulationHierarchy-CpdyNqAu.js"),__vite__mapDeps([9,10,2,1,3,5])).then(t=>({default:t.SimulationHierarchy}))),YG=Ee.lazy(()=>Mt(()=>import("./SimulationProfile-CIovhCEv.js"),__vite__mapDeps([11,3])).then(t=>({default:t.SimulationProfile}))),qG=Ee.lazy(()=>Mt(()=>import("./SimulationSettings-CziULCJC.js"),[]).then(t=>({default:t.SimulationSettings}))),WG=Ee.lazy(()=>Mt(()=>import("./PoliticalHub-BvpYHfXd.js"),__vite__mapDeps([10,2,1,3,5])).then(t=>({default:t.PoliticalHub}))),XG=Ee.lazy(()=>Mt(()=>import("./SimulationWarRoom-jnrLfQZW.js"),__vite__mapDeps([12,2])).then(t=>({default:t.SimulationWarRoom}))),QG=Ee.lazy(()=>Mt(()=>import("./SiegeEngine-DytfLFS-.js"),__vite__mapDeps([13,2])).then(t=>({default:t.SiegeEngine}))),JG=({player:t,room:e,pin:n,onAction:s,actionResult:i,onClearActionResult:r})=>{var b,y;const{activeTab:a,setActiveTab:o,isMusicWindowOpen:l,setMusicWindowOpen:u,viewingRegionId:d}=vf(),[f,h]=Ee.useState(!1),m=async p=>{if(!f){h(!0);try{await J(D(L,`simulation_rooms/${n}/activeVote/votes`),{[t.id]:p})}catch(g){console.error("Voting failed",g)}finally{setTimeout(()=>h(!1),1500)}}},v=["MAP","PRODUCTION","MARKET","INVENTORY","SKILLS","DIPLOMACY","HIERARCHY","PROFILE","POLITICS"].includes(a);return c.jsxs("div",{className:"flex-1 relative flex flex-col overflow-hidden w-full h-full",children:[c.jsxs("div",{className:`flex-1 relative w-full h-full ${v?"p-2 md:p-3 overflow-hidden flex items-center justify-center":"p-4 md:p-8 overflow-y-auto overflow-x-hidden custom-scrollbar"}`,children:[v&&c.jsx("div",{className:"absolute inset-0 z-0",children:c.jsx(uA,{player:t,room:e,world:e.world,worldEvents:e.worldEvents,players:e.players,onAction:s,onOpenMarket:()=>o("MARKET")})}),c.jsxs(Ee.Suspense,{fallback:c.jsx("div",{className:"w-full h-full flex items-center justify-center pointer-events-none",children:c.jsx("div",{className:"w-8 h-8 border-2 border-white/20 border-t-white rounded-full animate-spin"})}),children:[(()=>{var x;const p=d||t.regionId||"",g=(x=e.regions[p])==null?void 0:x.activeSiege;return!g||!(a==="SIEGE"||v)?null:c.jsx("div",{className:`absolute inset-0 z-10 ${a!=="SIEGE"?"opacity-20 pointer-events-none blur-sm grayscale":""}`,children:c.jsx(QG,{player:t,siege:g,regionId:p,onAction:s,messages:Array.isArray(e.messages)?e.messages:Object.values(e.messages||{})})})})(),c.jsxs("div",{className:"absolute inset-0 z-20 pointer-events-none flex flex-col items-center justify-center",children:[a==="PRODUCTION"&&c.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-4xl md:h-auto md:max-h-[85vh] overflow-hidden",children:c.jsx(FG,{player:t,room:e,onAction:s,pin:n||""})}),a==="MARKET"&&c.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-5xl md:h-[90vh] overflow-hidden",children:c.jsx(HG,{player:t,market:((b=e.markets)==null?void 0:b[t.regionId||"capital"])||e.market,regions:e.regions,allMarkets:e.markets,onAction:s,pin:n||""})}),a==="INVENTORY"&&c.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-4xl md:h-[80vh] overflow-hidden",children:c.jsx(GG,{player:t,onAction:s})}),a==="SKILLS"&&c.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-4xl md:h-[80vh] overflow-hidden",children:c.jsx(VG,{player:t})}),a==="DIPLOMACY"&&c.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-4xl md:h-[85vh] overflow-hidden",children:c.jsx($G,{player:t,diplomacy:e.diplomacy,pin:n||""})}),a==="HIERARCHY"&&c.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-5xl md:h-[85vh] overflow-hidden",children:c.jsx(KG,{players:e.players,currentPlayer:t,regions:e.regions,onAction:s,pin:n||""})}),a==="PROFILE"&&c.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-2xl md:h-[85vh] overflow-hidden",children:c.jsx(YG,{player:t,regions:e.regions||{},allPlayers:e.players||{}})}),a==="POLITICS"&&c.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-6xl md:h-[90vh] overflow-hidden",children:c.jsx(WG,{player:t,room:e,onClose:()=>o("MAP")})}),a==="WAR_ROOM"&&c.jsx("div",{className:"pointer-events-auto w-full h-full md:max-w-4xl md:h-[85vh] overflow-hidden",children:c.jsx(XG,{player:t,regions:e.regions,onAction:s,onClose:()=>o("HIERARCHY")})})]}),a!=="MAP"&&!v&&c.jsx("div",{className:"max-w-4xl mx-auto w-full space-y-8 animate-in slide-in-from-bottom-4 duration-500 relative z-20",children:a==="SETTINGS"?c.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-slate-950/40 backdrop-blur-md p-8 animate-in fade-in duration-300",children:c.jsx(qG,{onClose:()=>o("MAP")})}):a==="ACTIVITY"?c.jsx(zG,{messages:e.messages}):null})]})]}),e.activeVote&&!((y=e.activeVote.votes)!=null&&y[t.id])&&c.jsx("div",{className:"absolute bottom-6 right-6 z-[50] w-96 animate-in slide-in-from-right duration-500",children:c.jsxs("div",{className:"bg-slate-900/95 backdrop-blur-xl rounded-2xl border border-indigo-500/50 p-6 shadow-2xl shadow-indigo-500/10",children:[c.jsxs("div",{className:"flex items-start justify-between mb-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-white font-bold text-lg leading-tight mb-1",children:"Tinget er satt"}),c.jsx("p",{className:"text-indigo-300 text-xs font-medium uppercase tracking-wider",children:"Avgi din stemme"})]}),c.jsx("div",{className:"bg-indigo-500/20 p-2 rounded-lg",children:c.jsx("span",{className:"text-2xl",children:""})})]}),c.jsxs("div",{className:"mb-6",children:[c.jsx("h4",{className:"text-white font-medium mb-2",children:e.activeVote.title}),c.jsx("p",{className:"text-slate-400 text-sm line-clamp-3 leading-relaxed",children:e.activeVote.description})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("button",{onClick:()=>m("YES"),disabled:f,className:`bg-emerald-600/80 hover:bg-emerald-500 text-white py-3 rounded-xl font-bold text-sm transition-all active:scale-95 flex items-center justify-center gap-2 ${f?"opacity-50 cursor-not-allowed":""}`,children:[c.jsx("span",{children:""})," VEDTA"]}),c.jsxs("button",{onClick:()=>m("NO"),disabled:f,className:`bg-rose-600/80 hover:bg-rose-500 text-white py-3 rounded-xl font-bold text-sm transition-all active:scale-95 flex items-center justify-center gap-2 ${f?"opacity-50 cursor-not-allowed":""}`,children:[c.jsx("span",{children:""})," AVSL"]})]})]})}),c.jsx(Ei,{}),c.jsx(Ei,{children:l&&c.jsx(MG,{onClose:()=>u(!1)})}),c.jsx(UG,{player:t,room:e,onAction:s,pin:n||""}),c.jsx(DG,{result:i,onClear:r})]})},ZG=()=>{const[t,e]=_.useState([]);return _.useEffect(()=>Ge.subscribe(s=>{e(i=>[...i,s]),setTimeout(()=>{e(i=>i.filter(r=>r.id!==s.id))},s.duration+500)}),[]),c.jsx("div",{className:"fixed inset-0 pointer-events-none z-[200] overflow-hidden",children:c.jsx(Ei,{children:t.map(n=>{if(n.type==="FLOATING_TEXT")return c.jsx(De.div,{initial:{opacity:0,scale:.5,y:0,rotate:(Math.random()-.5)*20},animate:{opacity:1,scale:1.2,y:-120,x:(Math.random()-.5)*40,rotate:(Math.random()-.5)*40},exit:{opacity:0,scale:.8},transition:{duration:.8,ease:"easeOut"},className:`absolute font-black text-4xl drop-shadow-2xl ${n.color||"text-amber-500"}`,style:{left:`${n.x}%`,top:`${n.y}%`,transform:"translate(-50%, -50%)",zIndex:210},children:n.text},n.id);if(n.type==="FLYING_RESOURCE"){const s=hn[n.resource]||{icon:""};return c.jsx(De.div,{initial:{left:`${n.startPoint.x}px`,top:`${n.startPoint.y}px`,scale:.5,opacity:0},animate:{left:`${n.endPoint.x}px`,top:`${n.endPoint.y}px`,scale:[.5,1.5,1],opacity:1},exit:{opacity:0,scale:.5},transition:{duration:1,ease:"easeInOut"},className:"absolute text-4xl z-[220] drop-shadow-xl",children:s.icon},n.id)}return n.type==="PARTICLE"?c.jsx(Ee.Fragment,{children:[...Array(6)].map((s,i)=>c.jsx(De.div,{initial:{left:`${n.x}%`,top:`${n.y}%`,scale:1,opacity:1},animate:{left:`${n.x+(Math.random()-.5)*15}%`,top:`${n.y+(Math.random()-.5)*15}%`,scale:0,opacity:0},transition:{duration:.6,ease:"easeOut"},className:`absolute w-3 h-3 rounded-sm ${n.color||"bg-amber-400"} z-[205]`},`${n.id}-p-${i}`))},n.id):null})})})},eV=({level:t,title:e,onClose:n})=>c.jsxs("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-500",children:[c.jsx("div",{className:"bg-gradient-to-br from-amber-400 via-amber-500 to-amber-600 p-1 rounded-[2.5rem] shadow-[0_0_50px_rgba(245,158,11,0.5)] animate-in zoom-in duration-500",children:c.jsxs("div",{className:"bg-white rounded-[2.2rem] p-10 text-center relative overflow-hidden max-w-sm",children:[c.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-amber-200 via-yellow-400 to-amber-200"}),c.jsxs("div",{className:"relative z-10",children:[c.jsx("div",{className:"text-7xl mb-6 animate-bounce",children:""}),c.jsx("h2",{className:"text-sm font-black text-amber-600 uppercase tracking-[0.3em] mb-2",children:"Niv Oppndd!"}),c.jsxs("h3",{className:"text-6xl font-black text-slate-800 mb-4",children:["Niv ",t]}),c.jsx("div",{className:"h-0.5 w-16 bg-slate-200 mx-auto mb-6"}),c.jsx("p",{className:"text-slate-500 font-medium mb-1",children:"Ny Tittel:"}),c.jsx("p",{className:"text-3xl font-black text-indigo-600 mb-8",children:e}),c.jsx("button",{onClick:n,className:"w-full bg-slate-900 hover:bg-slate-800 text-white py-5 rounded-2xl font-black text-xl shadow-xl transition-all active:scale-95",children:"FORTSETT REISEN"})]}),c.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-20",children:[...Array(20)].map((s,i)=>c.jsx("div",{className:"absolute w-2 h-2 bg-amber-500 rounded-full animate-ping",style:{top:`${Math.random()*100}%`,left:`${Math.random()*100}%`,animationDelay:`${Math.random()*2}s`,animationDuration:`${2+Math.random()*2}s`}},i))})]})}),c.jsx("style",{dangerouslySetInnerHTML:{__html:`
                    @keyframes ping-slow {
                        0% { transform: scale(1); opacity: 0.8; }
                        100% { transform: scale(3); opacity: 0; }
                    }
                `}})]}),tV=({pin:t,account:e,onCreatePlayer:n,isCreating:s})=>{const i=Qa(),[r,a]=_.useState("WELCOME"),[o,l]=_.useState((e==null?void 0:e.displayName)||""),[u,d]=_.useState("PEASANT");return r==="WELCOME"?c.jsxs("div",{className:"bg-slate-900/40 backdrop-blur-3xl border border-white/5 p-12 md:p-16 rounded-[3.5rem] text-center space-y-10 shadow-2xl animate-in fade-in zoom-in duration-500",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsx("h1",{className:"text-6xl md:text-8xl font-black italic text-white tracking-tighter leading-none",children:"FEUDAL SIM"}),c.jsx("p",{className:"text-indigo-400 font-black uppercase tracking-[0.4em] text-xs",children:"En Levende Simulator"})]}),c.jsx("div",{className:"space-y-6",children:c.jsx("p",{className:"text-slate-400 text-lg md:text-xl font-medium max-w-md mx-auto leading-relaxed",children:"Dette er et spill om makt, ressurser og overlevelse i et feydalt samfunn."})}),c.jsxs("div",{className:"pt-4 space-y-4",children:[c.jsxs("button",{onClick:()=>a("CREATE"),className:"px-12 py-5 bg-indigo-600 hover:bg-indigo-500 text-white rounded-[2rem] font-black uppercase tracking-widest text-sm shadow-2xl shadow-indigo-600/40 transition-all hover:scale-105 active:scale-95 flex items-center justify-center gap-3 mx-auto w-64",children:["Skap din Karakter ",c.jsx(va,{size:20})]}),c.jsx("button",{onClick:()=>i("/sim"),className:"text-slate-500 hover:text-white font-black uppercase tracking-widest text-xs transition-colors",children:"G til Lobby"})]})]}):r==="CREATE"?c.jsxs("div",{className:"bg-slate-900 border border-white/10 p-12 rounded-[3.5rem] shadow-2xl space-y-10 animate-in slide-in-from-bottom-8 duration-500",children:[c.jsxs("div",{className:"text-center space-y-2",children:[c.jsx("h2",{className:"text-4xl font-black italic text-white tracking-tighter uppercase",children:"Hvem er du?"}),c.jsxs("p",{className:"text-slate-500 font-bold uppercase tracking-widest text-xs",children:["Opprett din karakter i ",t]})]}),c.jsxs("div",{className:"space-y-8",children:[c.jsxs("div",{className:"space-y-3",children:[c.jsx("label",{className:"text-xs font-black text-indigo-400 uppercase tracking-[0.2em] ml-2",children:"Ditt Navn i Riket"}),c.jsxs("div",{className:"relative group",children:[c.jsx("div",{className:"absolute inset-y-0 left-6 flex items-center text-slate-500 group-focus-within:text-indigo-400",children:c.jsx(xf,{size:20})}),c.jsx("input",{type:"text",value:o,onChange:f=>l(f.target.value),placeholder:"f.eks. Eirik den Rde",className:"w-full bg-slate-950 border-2 border-white/5 rounded-3xl py-5 pl-16 pr-6 text-xl font-black text-white outline-none focus:border-indigo-500/50 transition-all"})]})]}),t==="TEST"&&c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:["PEASANT","SOLDIER","MERCHANT","BARON"].map(f=>c.jsx("button",{onClick:()=>d(f),className:`py-4 rounded-2xl font-black uppercase tracking-widest text-xs border-2 transition-all ${u===f?"bg-indigo-600/20 border-indigo-500 text-white":"bg-white/5 border-transparent text-slate-500"}`,children:f},f))}),c.jsxs("div",{className:"pt-4 flex gap-4",children:[c.jsx("button",{onClick:()=>a("WELCOME"),className:"flex-1 py-5 bg-white/5 text-slate-400 rounded-3xl font-black uppercase tracking-widest text-xs",children:"Tilbake"}),c.jsx("button",{onClick:()=>{n(o,u),a("SUCCESS")},disabled:!o.trim()||s,className:"flex-[2] py-5 bg-indigo-600 text-white rounded-3xl font-black uppercase tracking-widest text-sm",children:s?"Oppretter...":"Start Reisen"})]})]})]}):c.jsxs("div",{className:"bg-emerald-500/10 backdrop-blur-3xl border border-emerald-500/30 p-16 rounded-[4rem] text-center space-y-8 shadow-2xl animate-in zoom-in duration-500",children:[c.jsx(R0,{size:48,className:"text-white mx-auto bg-emerald-500 rounded-[2rem] p-4 shadow-2xl"}),c.jsx("h2",{className:"text-4xl font-black italic text-white uppercase",children:"Velkommen inn!"})]})},nV={KING:bf,BARON:j0,PEASANT:E3,SOLDIER:cp,MERCHANT:_S},sV={KING:["Sikre rikets stabilitet","Samle inn skatter fra baronene","Beskytte 'The Orb of Power'"],BARON:["Administrer din region","Krev inn skatter fra bndene","Bygg opp forsvaret mot invasjoner"],PEASANT:["Dyrk jorden og hst korn","Betal skatt for  unng fengsel","Overlev vinteren"],SOLDIER:["Beskytt riket mot farer","Tren deg opp i kamp","Adlyde ordrer fra Kongen"],MERCHANT:["Kjp og selg varer p markedet","Tjen deg rik p handel","Unng  bli plyndret"]},iV={KING:"Du er den verste lederen. Din makt er absolutt, men ditt ansvar er tungt. Riket hviler p dine skuldre.",BARON:"Du styrer et av rikets store landomrder. Du er bindeleddet mellom Kongen og folket.",PEASANT:"Du er ryggraden i samfunnet. Uten ditt harde arbeid ville riket sultet. Livet er hardt, men rlig.",SOLDIER:"Du er sverdets mester. Din plikt er  beskytte de svake og opprettholde lov og orden.",MERCHANT:"Du forstr verdien av gull. Mens andre slss eller dyrker, bygger du formuer gjennom smart handel."},rV=({player:t,pin:e,onComplete:n})=>{var d,f;const[s,i]=_.useState(0),[r,a]=_.useState(!1),o=nV[t.role]||xf,l=sV[t.role]||["Overlev","Utforsk","Lr"];_.useEffect(()=>{if(s===0){const h=setTimeout(()=>i(1),3e3);return()=>clearTimeout(h)}},[s]);const u=async()=>{a(!0);try{const h={};h[`simulation_rooms/${e}/players/${t.id}/hasSeenIntro`]=!0,await J(D(L),h),setTimeout(n,500)}catch(h){console.error("Failed to save intro state",h),n()}};return s===0?c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-950 text-white animate-in fade-in duration-1000",children:c.jsxs("div",{className:"text-center space-y-8 animate-in zoom-in duration-1000 slide-in-from-bottom-10 fill-mode-forwards",children:[c.jsxs("div",{className:"relative inline-block",children:[c.jsx("div",{className:"absolute inset-0 bg-indigo-500/20 blur-[100px] rounded-full animate-pulse"}),c.jsx(o,{size:120,className:"relative z-10 text-white drop-shadow-[0_0_30px_rgba(255,255,255,0.5)]"})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"text-slate-400 font-bold uppercase tracking-[0.5em] text-sm animate-in fade-in delay-500 duration-1000",children:"Skjebnen har valgt..."}),c.jsx("h1",{className:"text-6xl md:text-8xl font-black italic tracking-tighter uppercase animate-in slide-in-from-bottom-5 delay-700 duration-500",children:((d=Ol[t.role])==null?void 0:d.label)||t.role})]})]})}):c.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center bg-slate-950/90 backdrop-blur-3xl transition-opacity duration-500 ${r?"opacity-0":"opacity-100"}`,children:c.jsxs("div",{className:"max-w-4xl w-full mx-4 grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-16 items-center",children:[c.jsxs("div",{className:"text-center space-y-8 order-2 md:order-1 animate-in slide-in-from-left-10 duration-700",children:[c.jsxs("div",{className:"relative inline-block p-10 bg-gradient-to-br from-indigo-500/20 to-purple-500/20 rounded-[3rem] border border-white/10 shadow-2xl",children:[c.jsx(o,{size:180,className:"text-white drop-shadow-2xl"}),c.jsx("div",{className:"absolute -bottom-6 left-1/2 -translate-x-1/2 bg-slate-900 border border-white/20 px-6 py-2 rounded-full whitespace-nowrap",children:c.jsx("span",{className:"text-xs font-black uppercase tracking-widest text-indigo-300",children:"Din tildelte rolle"})})]}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-4xl font-black italic tracking-tighter uppercase mb-4",children:(f=Ol[t.role])==null?void 0:f.label}),c.jsx("p",{className:"text-slate-400 font-medium leading-relaxed max-w-sm mx-auto",children:iV[t.role]})]})]}),c.jsxs("div",{className:"space-y-8 order-1 md:order-2 animate-in slide-in-from-right-10 duration-700 delay-200",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx("h3",{className:"text-sm font-black uppercase tracking-[0.3em] text-indigo-400",children:"Dine Ml"}),c.jsx("h1",{className:"text-5xl font-black italic tracking-tighter text-white",children:"Oppdrag"})]}),c.jsx("div",{className:"space-y-4",children:l.map((h,m)=>c.jsxs("div",{className:"flex items-center gap-4 bg-white/5 border border-white/5 p-4 rounded-2xl hover:bg-white/10 transition-colors group",children:[c.jsx("div",{className:"w-10 h-10 rounded-full bg-emerald-500/20 flex items-center justify-center text-emerald-400 border border-emerald-500/20 group-hover:scale-110 transition-transform",children:c.jsx("span",{className:"font-black text-sm",children:m+1})}),c.jsx("span",{className:"font-bold text-slate-200",children:h})]},m))}),c.jsx("div",{className:"pt-8",children:c.jsxs("button",{onClick:u,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white py-6 rounded-[2rem] font-black uppercase text-lg tracking-widest shadow-2xl shadow-indigo-600/30 hover:scale-105 active:scale-95 transition-all flex items-center justify-center gap-4 group",children:["Start Din Reise ",c.jsx(va,{className:"group-hover:translate-x-2 transition-transform"})]})})]})]})})},aV=(t,e)=>{const[n,s]=_.useState("global"),[i,r]=_.useState({}),[a,o]=_.useState({}),[l,u]=_.useState(!1);return _.useEffect(()=>{if(!e)return;const d={};if(d.global={id:"global",name:"Riket",type:"GLOBAL",unreadCount:0,description:"Offentlig torg"},e.role==="KING")d.region_vest={id:"region_vest",name:"Vest",type:"REGION",unreadCount:0,description:"Regional kanal for Vest"},d.region_ost={id:"region_ost",name:"st",type:"REGION",unreadCount:0,description:"Regional kanal for st"},d.capital={id:"capital",name:"Hovedstaden",type:"REGION",unreadCount:0,description:"Hovedstaden"};else if(e.regionId){const f=e.regionId==="capital"?"Hovedstaden":e.regionId==="region_vest"?"Vest":e.regionId==="region_ost"?"st":e.regionId;d[e.regionId]={id:e.regionId,name:f,type:"REGION",unreadCount:0,description:"Ditt hjemsted"}}(e.role==="BARON"||e.role==="KING")&&(d.diplomacy={id:"diplomacy",name:"Rdet",type:"DIPLOMACY",unreadCount:0,description:"Hemmelig kanal for ledere"}),r(f=>{const h={...d};return Object.keys(f).forEach(m=>{h[m]&&(h[m].unreadCount=f[m].unreadCount)}),h})},[e==null?void 0:e.regionId,e==null?void 0:e.role]),_.useEffect(()=>{if(!t||!n)return;u(!0);const d=D(L,`simulation_rooms/${t}/channels/${n}/messages`),f=E4(d,w4(50)),h=Ye(f,m=>{const v=m.val(),b=v?Object.values(v):[];b.sort((y,p)=>y.timestamp-p.timestamp),o(y=>({...y,[n]:b})),u(!1)});return()=>h()},[t,n]),{activeChannelId:n,setActiveChannelId:s,channels:i,messages:a[n]||[],isLoading:l}},qc=(...t)=>t.filter(Boolean).join(" "),oV=({pin:t,player:e,onOpenProfile:n})=>{var p;const[s,i]=_.useState(!1),{activeChannelId:r,setActiveChannelId:a,channels:o,messages:l,isLoading:u}=aV(t,e),[d,f]=_.useState(""),[h,m]=_.useState(!1),v=_.useRef(null);_.useEffect(()=>{v.current&&v.current.scrollIntoView({behavior:"smooth"})},[l,s]),_.useEffect(()=>{const g=x=>{var w;["INPUT","TEXTAREA"].includes(((w=document.activeElement)==null?void 0:w.tagName)||"")||x.key.toLowerCase()==="c"&&i(N=>!N)};return window.addEventListener("keydown",g),()=>window.removeEventListener("keydown",g)},[]);const b=async()=>{if(!d.trim()||h)return;m(!0);const g=await OP(t,e.id,d,r);g.success?f(""):alert(g.error||"Feil ved sending."),m(!1)},y=g=>{switch(g){case"GLOBAL":return c.jsx(O0,{size:14});case"REGION":return c.jsx(ES,{size:14});case"DIPLOMACY":return c.jsx(bf,{size:14,className:"text-amber-400"});case"DM":return c.jsx(C0,{size:14});default:return c.jsx(Ml,{size:14})}};return s?c.jsxs("div",{className:"fixed bottom-6 left-6 z-50 w-[380px] h-[500px] flex flex-col bg-slate-950/95 border border-slate-800/80 rounded-2xl shadow-2xl backdrop-blur-xl animate-in slide-in-from-bottom-10 fade-in duration-300",children:[c.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-slate-800/50 bg-slate-900/50 rounded-t-2xl drag-handle cursor-grab active:cursor-grabbing",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500 animate-pulse"}),c.jsx("span",{className:"text-xs font-bold uppercase tracking-widest text-slate-400",children:"Comms Array"})]}),c.jsx("button",{onClick:()=>i(!1),className:"text-slate-500 hover:text-white transition-colors",children:c.jsx(l3,{size:18})})]}),c.jsx("div",{className:"flex gap-1 p-2 bg-slate-900/30 overflow-x-auto scrollbar-hide",children:Object.values(o).map(g=>c.jsxs("button",{onClick:()=>a(g.id),className:qc("flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-semibold whitespace-nowrap transition-all",r===g.id?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"bg-slate-800/50 text-slate-400 hover:bg-slate-800 hover:text-slate-200"),children:[y(g.type),g.name]},g.id))}),c.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar bg-gradient-to-b from-slate-950/50 to-transparent",children:[u?c.jsx("div",{className:"flex justify-center p-4",children:c.jsx("div",{className:"w-6 h-6 border-2 border-indigo-500 border-t-transparent rounded-full animate-spin"})}):l.length===0?c.jsx("div",{className:"text-center text-slate-600 text-xs italic mt-10",children:"Ingen meldinger i denne kanalen enn."}):l.map(g=>{const x=g.senderId===e.id;return c.jsxs("div",{className:qc("flex flex-col gap-1 max-w-[85%]",x?"ml-auto items-end":"mr-auto items-start"),children:[c.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-slate-500 px-1",children:[c.jsx("span",{onClick:()=>n&&n(g.senderId||""),className:qc("font-bold hover:underline cursor-pointer",x?"text-indigo-400":"text-amber-500"),children:g.senderName}),c.jsxs("span",{className:"opacity-50",children:[" ",new Date(g.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),c.jsxs("div",{className:qc("px-3 py-2 rounded-2xl text-sm leading-relaxed shadow-sm break-words relative group",x?"bg-indigo-600 text-white rounded-tr-sm":"bg-slate-800 text-slate-200 rounded-tl-sm border border-slate-700/50"),children:[g.content,!x&&g.senderRole!=="PEASANT"&&c.jsx("div",{className:"absolute -top-2 -right-2 bg-slate-950 border border-slate-700 text-[8px] font-black uppercase px-1.5 py-0.5 rounded shadow-xl scale-0 group-hover:scale-100 transition-transform",children:g.senderRole})]})]},g.id)}),c.jsx("div",{ref:v})]}),c.jsx("div",{className:"p-3 bg-slate-900/80 border-t border-slate-800 backdrop-blur-md",children:c.jsxs("div",{className:"relative flex items-center gap-2",children:[c.jsx("input",{value:d,onChange:g=>f(g.target.value),onKeyDown:g=>g.key==="Enter"&&!g.shiftKey&&b(),placeholder:`Melding til #${((p=o[r])==null?void 0:p.name)||"kanal"}...`,className:"flex-1 bg-slate-950 border border-slate-700 rounded-xl px-4 py-2.5 text-sm text-white placeholder:text-slate-600 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500 transition-all shadow-inner",disabled:h}),c.jsx("button",{onClick:b,disabled:!d.trim()||h,className:"bg-indigo-600 hover:bg-indigo-500 text-white p-2.5 rounded-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-indigo-500/20 active:scale-95",children:h?c.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):c.jsx(NS,{size:16})}),e.role!=="KING"&&r==="global"&&c.jsx("div",{className:"absolute -top-6 right-2 text-[10px] text-amber-500 font-mono bg-amber-950/30 px-2 py-0.5 rounded border border-amber-900/50",children:"Kostnad: 2 Gull"})]})})]}):c.jsx("button",{onClick:()=>i(!0),className:"fixed bottom-6 left-6 z-50 bg-slate-900/90 border border-slate-700/50 text-white p-3 rounded-full shadow-2xl hover:bg-indigo-600 hover:scale-105 transition-all group backdrop-blur-md",children:c.jsxs("div",{className:"relative",children:[c.jsx(Ml,{size:24,className:"group-hover:text-white text-slate-200"}),c.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full animate-pulse border-2 border-slate-900"})]})})},H_=["gold","grain","wood","iron_ore","stone","plank","iron_ingot","bread","swords","armor","cloth","wool"],lV=({isOpen:t,onClose:e,myPlayer:n,targetPlayer:s,pin:i})=>{const[r,a]=_.useState({gold:0}),[o,l]=_.useState({gold:0}),[u,d]=_.useState(!1),[f,h]=_.useState(null);if(!t)return null;Ee.useEffect(()=>{const p=g=>{g.key==="Escape"&&e()};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[e]);const m=async()=>{d(!0),h(null);try{const p=await PG(i,n.id,s.id,r,o);p.success?(h("Handelstilbud sendt!"),setTimeout(e,1500)):(h("Feil: "+p.error),d(!1))}catch(p){console.error(p),h("En ukjent feil oppstod."),d(!1)}},v=(p,g)=>{a(x=>({...x,[p]:Math.max(0,g)}))},b=(p,g)=>{l(x=>({...x,[p]:Math.max(0,g)}))},y=({label:p,values:g,onChange:x,max:w})=>c.jsxs("div",{className:"space-y-2",children:[c.jsx("h4",{className:"text-xs font-bold uppercase text-slate-400 tracking-wider mb-2",children:p}),c.jsxs("div",{className:"space-y-2 max-h-60 overflow-y-auto pr-2 custom-scrollbar",children:[H_.map(N=>{const T=g[N]||0,E=w?w(N):9999;return w&&E<=0&&T<=0?null:c.jsxs("div",{className:"flex items-center gap-2 bg-slate-900/50 p-2 rounded-lg border border-slate-700/50",children:[c.jsx("span",{className:"text-lg w-8 text-center",children:xd[N.toUpperCase()]||""}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("div",{className:"text-xs text-slate-300 font-medium capitalize truncate",children:N.replace("_"," ")}),w&&c.jsxs("div",{className:"text-[10px] text-slate-500",children:["Du har: ",E]})]}),c.jsx("input",{type:"number",value:T||"",placeholder:"0",onChange:A=>x(N,parseInt(A.target.value)||0),className:"w-20 bg-slate-800 border border-slate-700 rounded px-2 py-1 text-right text-sm font-mono focus:outline-none focus:border-indigo-500"})]},N)}),!w&&c.jsx("div",{className:"text-xs text-slate-500 text-center italic mt-2",children:"Velg hva du krever"})]})]});return c.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:c.jsxs("div",{className:"w-full max-w-4xl bg-slate-900 border border-indigo-500/30 rounded-2xl shadow-2xl flex flex-col max-h-[90vh] overflow-hidden",children:[c.jsxs("div",{className:"p-6 bg-slate-900 border-b border-indigo-500/20 flex justify-between items-center relative overflow-hidden",children:[c.jsx("div",{className:"absolute inset-0 bg-indigo-600/5 opacity-0 group-hover:opacity-100 transition-opacity"}),c.jsxs("div",{children:[c.jsxs("h2",{className:"text-2xl font-black italic text-white flex items-center gap-3",children:[c.jsx(I0,{className:"text-indigo-400"}),"HANDELSKONTRAKT"]}),c.jsxs("p",{className:"text-slate-400 text-sm",children:["Opprett et tilbud til ",c.jsx("span",{className:"text-white font-bold",children:s.name})]})]}),c.jsx("button",{onClick:e,className:"relative z-10 p-2 hover:bg-slate-800 rounded-full transition-colors cursor-pointer",children:c.jsx(ji,{className:"text-slate-400"})})]}),c.jsxs("div",{className:"flex-1 overflow-hidden grid grid-cols-1 md:grid-cols-2 divide-y md:divide-y-0 md:divide-x divide-slate-800 bg-slate-950/50",children:[c.jsx("div",{className:"p-6 overflow-hidden flex flex-col",children:c.jsx(y,{label:"Ditt Tilbud (Assets)",values:r,onChange:v,max:p=>n.resources[p]||0})}),c.jsx("div",{className:"p-6 overflow-hidden flex flex-col",children:c.jsxs("div",{className:"space-y-2 max-h-[60vh] overflow-y-auto pr-2 custom-scrollbar",children:[c.jsx("h4",{className:"text-xs font-bold uppercase text-slate-400 tracking-wider mb-2",children:"Ditt Krav (Liabilities)"}),H_.map(p=>c.jsxs("div",{className:"flex items-center gap-2 bg-slate-900/50 p-2 rounded-lg border border-slate-700/50 hover:border-indigo-500/30 transition-colors",children:[c.jsx("span",{className:"text-lg w-8 text-center opacity-70",children:xd[p.toUpperCase()]||""}),c.jsx("span",{className:"flex-1 text-xs text-slate-300 font-medium capitalize truncate",children:p.replace("_"," ")}),c.jsx("input",{type:"number",value:o[p]||"",placeholder:"0",onChange:g=>b(p,parseInt(g.target.value)||0),className:"w-20 bg-slate-800 border border-slate-700 rounded px-2 py-1 text-right text-sm font-mono focus:outline-none focus:border-indigo-500"})]},p))]})})]}),c.jsxs("div",{className:"p-6 bg-slate-900 border-t border-indigo-500/20 flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2 text-yellow-500/80 text-xs",children:[c.jsx(op,{size:14}),c.jsx("span",{children:"Ressursene trekkes umiddelbart (Escrow)."})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[f&&c.jsx("span",{className:`text-sm font-bold ${f.startsWith("Feil")?"text-red-400":"text-green-400"}`,children:f}),c.jsx("button",{onClick:m,disabled:u||f!==null,className:"px-6 py-3 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-xl flex items-center gap-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-indigo-500/20",children:u?"Signerer...":c.jsxs(c.Fragment,{children:[c.jsx(NS,{size:18}),"Send Kontrakt"]})})]})]})]})})},cV=["gold","grain","wood","iron_ore","bread"],uV=({isOpen:t,onClose:e,myPlayer:n,targetPlayer:s,pin:i})=>{const[r,a]=_.useState("INFO"),[o,l]=_.useState(!1);Ee.useEffect(()=>{const p=g=>{g.key==="Escape"&&e()};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[e]);const[u,d]=_.useState("gold"),[f,h]=_.useState(0),[m,v]=_.useState(null),b=p=>{switch(p){case"KING":return c.jsx(bf,{size:32,className:"text-yellow-400"});case"BARON":return c.jsx(j0,{size:32,className:"text-purple-400"});case"SOLDIER":return c.jsx(cp,{size:32,className:"text-red-400"});case"MERCHANT":return c.jsx(_S,{size:32,className:"text-emerald-400"});default:return c.jsx(xf,{size:32,className:"text-slate-400"})}},y=async()=>{if(f<=0)return;v("Sender...");const p={};p[u]=f;const g=await LG(i,n.id,s.id,p);g.success?(v(`Sendte ${f} ${u}!`),setTimeout(()=>{v(null),a("INFO")},1500)):v("Feil: "+g.error)};return t?o?c.jsx(lV,{isOpen:!0,onClose:()=>l(!1),myPlayer:n,targetPlayer:s,pin:i}):c.jsx("div",{className:"fixed inset-0 z-[50] flex items-center justify-center p-4 bg-slate-950/60 backdrop-blur-sm animate-in fade-in duration-200",children:c.jsxs("div",{className:"w-full max-w-md bg-slate-900 border border-slate-700 rounded-3xl shadow-2xl overflow-hidden flex flex-col relative",children:[c.jsx("div",{className:`h-32 w-full relative bg-gradient-to-br ${s.role==="KING"?"from-yellow-900/40 to-slate-900":"from-indigo-900/40 to-slate-900"}`,children:c.jsx("div",{className:"absolute top-4 right-4",children:c.jsx("button",{onClick:e,className:"p-2 bg-black/20 hover:bg-black/40 rounded-full transition-colors backdrop-blur-sm text-white",children:c.jsx(ji,{size:20})})})}),c.jsxs("div",{className:"px-8 relative -mt-16 mb-4 flex flex-col items-center",children:[c.jsxs("div",{className:"w-32 h-32 rounded-full border-4 border-slate-900 bg-slate-800 flex items-center justify-center shadow-xl relative group overflow-hidden",children:[s.avatar?c.jsx("img",{src:s.avatar,alt:s.name,className:"w-full h-full object-cover"}):b(s.role),c.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"})]}),c.jsx("h2",{className:"text-2xl font-black text-white mt-4",children:s.name}),c.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-sm font-medium uppercase tracking-wider",children:[c.jsx("span",{className:"text-indigo-400",children:s.role}),c.jsx("span",{children:""}),c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx(ES,{size:12})," ",s.regionId||"Ukjent"]})]})]}),c.jsxs("div",{className:"flex-1 px-8 pb-8 space-y-6",children:[r==="INFO"&&c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"bg-slate-950/50 p-4 rounded-2xl border border-slate-800 text-center",children:[c.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-widest font-bold mb-1",children:"Level"}),c.jsx("div",{className:"text-3xl font-black text-white",children:s.stats.level})]}),c.jsxs("div",{className:"bg-slate-950/50 p-4 rounded-2xl border border-slate-800 text-center",children:[c.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-widest font-bold mb-1",children:"Reputasjon"}),c.jsx("div",{className:"text-3xl font-black text-indigo-400",children:s.stats.reputation})]})]}),r==="GIFT"&&c.jsxs("div",{className:"bg-slate-950/50 p-6 rounded-2xl border border-slate-800 space-y-4 animate-in slide-in-from-bottom-4 duration-300",children:[c.jsx("h3",{className:"text-center text-slate-300 font-bold",children:"Send en gave"}),c.jsx("div",{className:"flex gap-2 justify-center",children:cV.map(p=>c.jsx("button",{onClick:()=>d(p),className:`p-2 rounded-lg border transition-all ${u===p?"bg-indigo-600 border-indigo-500":"bg-slate-900 border-slate-700 hover:border-slate-500"}`,children:c.jsx("span",{className:"text-xl",children:xd[p.toUpperCase()]||""})},p))}),c.jsxs("div",{className:"flex items-center gap-2 bg-slate-900 border border-slate-700 rounded-xl px-4 py-2",children:[c.jsx("input",{type:"number",className:"bg-transparent w-full text-center text-xl font-bold focus:outline-none",value:f,onChange:p=>h(parseInt(p.target.value)||0),placeholder:"0"}),c.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase",children:u})]}),c.jsx("button",{onClick:y,disabled:!!m,className:"w-full py-3 bg-emerald-600 hover:bg-emerald-500 text-white rounded-xl font-bold shadow-lg shadow-emerald-500/20 disabled:opacity-50",children:m||"Send Gave"})]}),c.jsx("div",{className:"flex gap-2",children:r==="INFO"?c.jsxs(c.Fragment,{children:[c.jsxs("button",{onClick:()=>a("GIFT"),className:"flex-1 py-3 bg-slate-800 hover:bg-slate-700 text-slate-200 rounded-xl font-bold flex items-center justify-center gap-2 transition-transform active:scale-95",children:[c.jsx(wS,{size:18}),c.jsx("span",{children:"Gave"})]}),c.jsxs("button",{onClick:()=>l(!0),className:"flex-1 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold flex items-center justify-center gap-2 transition-transform active:scale-95 shadow-lg shadow-indigo-500/20",children:[c.jsx(I0,{size:18}),c.jsx("span",{children:"Handel"})]})]}):c.jsx("button",{onClick:()=>a("INFO"),className:"w-full py-3 text-slate-400 hover:text-white font-bold",children:"Avbryt"})}),s.role==="SOLDIER"&&n.role==="SOLDIER"&&c.jsxs("button",{className:"w-full py-2 border border-red-500/30 text-red-400 hover:bg-red-500/10 rounded-xl font-bold uppercase tracking-widest text-xs flex items-center justify-center gap-2",children:[c.jsx(cp,{size:14}),"Utfordre til Duell (Kommer snart)"]})]})]})}):null},dV=()=>{const{pin:t}=ZE(),[e]=c2(),n=e.get("impersonate"),s=Qa(),{user:i,account:r,loading:a}=gf(),{activeMinigame:o,setActiveMinigame:l,activeMinigameAction:u,setActiveMinigameAction:d,activeMinigameMethod:f,setActiveMinigameMethod:h}=vf(),{setHideHeader:m,setFullWidth:v}=iN();Ee.useEffect(()=>{m(!0),v(!0);const be=()=>{Mt(async()=>{const{audioManager:H}=await Promise.resolve().then(()=>G4);return{audioManager:H}},void 0).then(({audioManager:H})=>{H.resume()}),window.removeEventListener("click",be),window.removeEventListener("keydown",be)};return window.addEventListener("click",be),window.addEventListener("keydown",be),()=>{m(!1),v(!1),window.removeEventListener("click",be),window.removeEventListener("keydown",be)}},[m,v]);const{player:b,world:y,players:p,roomStatus:g,markets:x,messages:w,diplomacy:N,activeVote:T,worldEvents:E,trades:A,regions:k,hasAttemptedPlayerLoad:R,isRetired:I}=j6(t,n),{handleAction:P,actionResult:V,handleClearActionResult:$}=OS(t,b,y,l,h,d,o),[K,B]=_.useState(!1),[j,O]=_.useState(null),[C,F]=_.useState(null),Q=async(be,H)=>{if(!(!t||!i)){B(!0);try{const me=D(L,`simulation_rooms/${t}`),se=n||i.uid;let tt=Math.random()>.5?"region_ost":"region_vest";H==="BARON"?tt=`region_${se}`:H==="KING"&&(tt="capital");const Ft={id:se,uid:i.uid,name:be,role:H,regionId:tt,resources:At[H]||At.PEASANT,skills:Cn[H]||Cn.PEASANT,stats:{xp:0,level:1,reputation:50,contribution:0},status:{hp:100,morale:100,stamina:50,legitimacy:100,authority:50,loyalty:100,isJailed:!1,isFrozen:!1},equipment:ap[H]||ap.PEASANT,upgrades:[],lastActive:Date.now()},jn={id:se,uid:i.uid,name:be,role:H,regionId:tt,stats:{level:1},status:{isJailed:!1,isFrozen:!1,legitimacy:100},online:!0,lastActive:Date.now()},Dt={};Dt[`players/${se}`]=Ft,Dt[`public_profiles/${se}`]=jn,await J(me,Dt)}catch(me){console.error("Failed to create player:",me),alert("Kunne ikke opprette karakter.")}finally{B(!1)}}},oe=_.useMemo(()=>({status:g,world:y,players:p||{},messages:w||[],markets:x||{},market:(x&&(b!=null&&b.regionId)?x[b.regionId]:Object.values(x||{})[0])||{},diplomacy:N||{},trades:A||{},activeVote:T,worldEvents:E||{},regions:k||{},settings:"feudal_europe",pin:t||""}),[g,y,p,w,x,N,T,E,A,k,t]);return a||!R?c.jsxs("div",{className:"min-h-screen bg-slate-950 flex flex-col items-center justify-center gap-8 p-12",children:[c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"w-24 h-24 border-4 border-indigo-500/20 rounded-full"}),c.jsx("div",{className:"absolute inset-0 w-24 h-24 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"})]}),c.jsx("h2",{className:"text-2xl font-black italic text-white animate-pulse",children:"Kaller p ndene..."})]}):I?c.jsx("div",{className:"fixed inset-0 z-[100] bg-slate-950/90 backdrop-blur-xl flex items-center justify-center p-6 text-center",children:c.jsxs("div",{className:"max-w-md bg-slate-900 border-2 border-indigo-500/30 rounded-[3rem] p-12 space-y-8 shadow-2xl",children:[c.jsx(oP,{size:48,className:"text-white mx-auto animate-bounce"}),c.jsx("h2",{className:"text-4xl font-black italic text-white",children:"ET LIV ER OVER"}),c.jsx("button",{onClick:()=>s("/sim"),className:"w-full py-4 bg-indigo-600 text-white rounded-2xl font-black uppercase",children:"Tilbake til Lobby"})]})}):b?y?c.jsxs("div",{className:"relative min-h-screen bg-slate-900 text-white overflow-hidden flex flex-col",children:[c.jsx("div",{className:"flex-1 flex flex-col relative",children:c.jsxs("div",{className:"fixed inset-0 top-0 bg-slate-950 text-slate-200 flex overflow-hidden",children:[c.jsx("div",{className:"fixed inset-0 pointer-events-none opacity-20",children:c.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-indigo-600/20 blur-[120px] rounded-full animate-pulse"})}),!b.hasSeenIntro&&c.jsx(rV,{player:b,pin:t||"",onComplete:()=>{b.hasSeenIntro=!0}}),o&&c.jsx(EG,{type:o,playerUpgrades:b.upgrades,equipment:Object.values(b.equipment||{}),skills:b.skills,selectedMethod:f||void 0,action:u,onComplete:be=>P({...u||{},performance:be,method:f}),onCancel:()=>{l(null),d(null),h(null)},currentSeason:(y==null?void 0:y.season)||"Spring",currentWeather:(y==null?void 0:y.weather)||"Clear",totalTicks:(y==null?void 0:y.totalTicks)||0}),c.jsx(ZG,{}),c.jsxs("div",{className:"flex flex-col h-full w-full overflow-hidden",children:[c.jsx(rG,{room:oe,player:b,pin:t,onAction:P}),c.jsx("main",{className:"flex-1 relative overflow-hidden bg-slate-950/50",children:c.jsx(JG,{player:b,room:oe,pin:t,onAction:P,actionResult:V,onClearActionResult:$})})]})]})}),j&&c.jsx(eV,{level:j.level,title:j.title,onClose:()=>O(null)}),c.jsx(oV,{pin:t||"",player:b,onOpenProfile:be=>{const H=oe.players[be];H?F(H):console.warn("Spiller ikke funnet i rommet:",be)}}),C&&c.jsx(uV,{isOpen:!0,onClose:()=>F(null),myPlayer:b,targetPlayer:C,pin:t||""})]}):c.jsxs("div",{className:"min-h-screen bg-slate-950 flex flex-col items-center justify-center gap-4 text-white",children:[c.jsx("div",{className:"w-12 h-12 border-4 border-indigo-500 border-t-white rounded-full animate-spin"}),c.jsx("p",{className:"text-sm font-bold uppercase tracking-widest text-indigo-400",children:"Laster verden..."})]}):c.jsx("div",{className:"min-h-screen bg-slate-950 flex items-center justify-center p-6",children:c.jsx(tV,{pin:t||"",account:r,onCreatePlayer:Q,isCreating:K})})},fV=()=>{const[t,e]=_.useState([]),[n,s]=_.useState(!0),[i,r]=_.useState(""),a=Qa();_.useEffect(()=>{const l=D(L,"simulation_server_metadata"),u=Ye(l,d=>{const f=d.val();if(f){const h=Object.values(f);e(h.filter(m=>m.isPublic&&(m.status==="LOBBY"||m.status==="PLAYING")).sort((m,v)=>v.lastUpdated-m.lastUpdated))}else e([]);s(!1)});return()=>u()},[]);const o=t.filter(l=>{var u;return l.pin.includes(i)||((u=l.name)==null?void 0:u.toLowerCase().includes(i.toLowerCase()))||l.hostName.toLowerCase().includes(i.toLowerCase())});return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"relative",children:[c.jsx(K3,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-white/40",size:16}),c.jsx("input",{type:"text",placeholder:"Sk i riker...",value:i,onChange:l=>r(l.target.value),className:"w-full bg-white/5 border border-white/10 focus:border-white/20 rounded-xl py-2.5 pl-10 pr-4 text-sm text-white placeholder:text-white/20 outline-none transition-all"})]}),n?c.jsxs("div",{className:"flex flex-col items-center justify-center p-12 gap-3 opacity-50",children:[c.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),c.jsx("span",{className:"text-[10px] uppercase tracking-widest text-white/50",children:"Laster verdener..."})]}):o.length===0?c.jsx("div",{className:"p-8 text-center border border-white/5 border-dashed rounded-xl",children:c.jsx("p",{className:"text-sm text-white/40 font-medium",children:"Ingen riker funnet."})}):c.jsx("div",{className:"space-y-2",children:o.map(l=>c.jsxs("button",{onClick:()=>a(`/play/${l.pin}`),className:"group w-full flex items-center justify-between p-3 bg-white/5 hover:bg-white/10 border border-white/5 hover:border-white/20 rounded-xl transition-all text-left",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:`w-1.5 h-10 rounded-full ${l.status==="LOBBY"?"bg-emerald-500/50 shadow-[0_0_10px_rgba(16,185,129,0.5)]":"bg-amber-500/50"}`}),c.jsxs("div",{className:"flex flex-col",children:[c.jsx("h3",{className:"text-sm font-bold text-white group-hover:text-emerald-300 transition-colors",children:l.name||`Rike #${l.pin}`}),c.jsxs("div",{className:"flex items-center gap-3 text-[10px] font-medium text-white/40 uppercase tracking-widest",children:[c.jsx("span",{children:l.hostName}),c.jsx("span",{className:"w-1 h-1 bg-white/20 rounded-full"}),c.jsxs("span",{children:["PIN: ",l.pin]})]})]})]}),c.jsxs("div",{className:"flex items-center gap-6 pr-2",children:[c.jsxs("div",{className:"flex items-center gap-2 text-white/60",children:[c.jsx(O0,{size:14}),c.jsx("span",{className:"text-xs font-medium tabular-nums",children:l.playerCount})]}),c.jsxs("div",{className:"text-right hidden sm:block",children:[c.jsxs("div",{className:"text-[10px] text-white/30 uppercase tracking-wider",children:["r ",l.worldYear]}),c.jsx("div",{className:"text-[10px] text-white/50",children:l.season})]}),c.jsx("div",{className:"p-2 bg-white/5 rounded-lg text-white/40 group-hover:text-white group-hover:bg-emerald-500/20 transition-all",children:c.jsx(j0,{size:14})})]})]},l.pin))})]})},hV=({isOpen:t,onClose:e,initialMode:n="REGISTER"})=>{const{login:s,register:i,resetPassword:r,checkNameAvailability:a,error:o}=gf(),[l,u]=_.useState(n),[d,f]=_.useState(""),[h,m]=_.useState(""),[v,b]=_.useState(""),[y,p]=_.useState(!1),[g,x]=_.useState(null),[w,N]=_.useState(null),[T,E]=_.useState(null),[A,k]=_.useState(!1);if(_.useEffect(()=>{if(l!=="REGISTER"||v.length<3){E(null);return}const I=setTimeout(async()=>{k(!0);try{const P=await a(v);E(P)}catch(P){console.error(P)}finally{k(!1)}},500);return()=>clearTimeout(I)},[v,l,a]),!t)return null;const R=async I=>{I.preventDefault(),x(null),N(null),p(!0);try{if(l==="LOGIN")await s(d,h),e();else if(l==="REGISTER"){if(T===!1)throw new Error("Navnet er allerede tatt.");await i(d,h,v),e()}else l==="FORGOT"&&(await r(d),N("E-post for tilbakestilling er sendt!"))}catch(P){x(P.message||"Noe gikk galt. Vennligst prv igjen.")}finally{p(!1)}};return c.jsxs("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center p-4",children:[c.jsx("div",{className:"absolute inset-0 bg-slate-950/80 backdrop-blur-sm",onClick:e}),c.jsxs("div",{className:"relative w-full max-w-md bg-slate-900 border border-white/10 rounded-[2.5rem] shadow-2xl overflow-hidden animate-in fade-in zoom-in duration-300",children:[c.jsx("div",{className:"bg-indigo-600 h-2 w-full"}),c.jsxs("div",{className:"p-8 space-y-8",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-3xl font-black italic text-white tracking-tighter uppercase",children:l==="LOGIN"?"Velkommen tilbake":l==="REGISTER"?"Opprett Profil":"Glemt Passord"}),c.jsx("p",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mt-1",children:l==="LOGIN"?"Fortsett din reise i simulation":"Bli en del av historien"})]}),c.jsx("button",{onClick:e,className:"p-2 hover:bg-white/5 rounded-xl transition-colors",children:c.jsx(ji,{className:"text-slate-500",size:20})})]}),c.jsxs("form",{onSubmit:R,className:"space-y-4",children:[l==="REGISTER"&&c.jsxs("div",{className:"space-y-1.5",children:[c.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"Vises som (Unikt navn)"}),c.jsxs("div",{className:"relative group",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:c.jsx(xf,{size:18,className:"text-slate-600 group-focus-within:text-indigo-400 transition-colors"})}),c.jsx("input",{type:"text",required:!0,placeholder:"Ditt kallenavn...",className:"w-full bg-slate-950/50 border border-white/5 focus:border-indigo-500/50 rounded-2xl py-3.5 pl-11 pr-4 text-white outline-none transition-all",value:v,onChange:I=>b(I.target.value)}),c.jsx("div",{className:"absolute inset-y-0 right-0 pr-4 flex items-center",children:A?c.jsx(py,{size:16,className:"text-slate-500 animate-spin"}):T===!0?c.jsx(gy,{size:16,className:"text-emerald-500"}):T===!1?c.jsx(op,{size:16,className:"text-rose-500"}):null})]}),T===!1&&c.jsx("p",{className:"text-[10px] text-rose-400 font-bold px-1 italic",children:"Dette navnet er dessverre opptatt."})]}),c.jsxs("div",{className:"space-y-1.5",children:[c.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"E-post"}),c.jsxs("div",{className:"relative group",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:c.jsx(I3,{size:18,className:"text-slate-600 group-focus-within:text-indigo-400 transition-colors"})}),c.jsx("input",{type:"email",required:!0,placeholder:"navn@epost.no",className:"w-full bg-slate-950/50 border border-white/5 focus:border-indigo-500/50 rounded-2xl py-3.5 pl-11 pr-4 text-white outline-none transition-all",value:d,onChange:I=>f(I.target.value)})]})]}),l!=="FORGOT"&&c.jsxs("div",{className:"space-y-1.5",children:[c.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"Passord"}),c.jsxs("div",{className:"relative group",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:c.jsx(C0,{size:18,className:"text-slate-600 group-focus-within:text-indigo-400 transition-colors"})}),c.jsx("input",{type:"password",required:!0,placeholder:"Min. 8 tegn...",className:"w-full bg-slate-950/50 border border-white/5 focus:border-indigo-500/50 rounded-2xl py-3.5 pl-11 pr-4 text-white outline-none transition-all",value:h,onChange:I=>m(I.target.value)})]})]}),(g||o)&&c.jsxs("div",{className:"bg-rose-500/10 border border-rose-500/20 p-4 rounded-2xl flex items-center gap-3 text-rose-400",children:[c.jsx(op,{size:18}),c.jsx("p",{className:"text-xs font-bold",children:g||o})]}),w&&c.jsxs("div",{className:"bg-emerald-500/10 border border-emerald-500/20 p-4 rounded-2xl flex items-center gap-3 text-emerald-400",children:[c.jsx(gy,{size:18}),c.jsx("p",{className:"text-xs font-bold",children:w})]}),c.jsxs("div",{className:"pt-4 space-y-4",children:[c.jsx("button",{type:"submit",disabled:y||l==="REGISTER"&&T===!1,className:"w-full bg-indigo-600 hover:bg-indigo-500 disabled:bg-slate-800 disabled:text-slate-500 text-white rounded-2xl py-4 font-black uppercase tracking-widest text-sm flex items-center justify-center gap-2 transition-all active:scale-95 shadow-lg shadow-indigo-600/20",children:y?c.jsx(py,{className:"animate-spin",size:20}):c.jsxs(c.Fragment,{children:[l==="LOGIN"?"Logg Inn":l==="REGISTER"?"Opprett Profil":"Send E-post",c.jsx(va,{size:18})]})}),c.jsx("div",{className:"flex items-center justify-between px-2",children:l==="LOGIN"?c.jsxs(c.Fragment,{children:[c.jsx("button",{type:"button",onClick:()=>u("REGISTER"),className:"text-[10px] font-black text-indigo-400 uppercase tracking-widest hover:text-white transition-colors",children:"Ny her? Opprett profil"}),c.jsx("button",{type:"button",onClick:()=>u("FORGOT"),className:"text-[10px] font-medium text-slate-500 hover:text-white transition-colors",children:"Glemt passord?"})]}):c.jsx("button",{type:"button",onClick:()=>u("LOGIN"),className:"w-full text-center text-[10px] font-black text-indigo-400 uppercase tracking-widest hover:text-white transition-colors",children:"Har du allerede profil? Logg inn"})})]})]})]})]})]})},mV=()=>{const{user:t,isAnonymous:e,logout:n}=gf(),[s,i]=_.useState(!1),[r,a]=_.useState("LOGIN"),o=Qa(),{startPlaylist:l,resume:u}=S0(),[d,f]=_.useState(!1);_.useEffect(()=>{l()},[l]);const h=()=>{d||(u(),l(),f(!0))},m=v=>{h(),a(v),i(!0)};return c.jsxs("div",{onClick:h,className:"min-h-screen relative font-sans text-slate-200 overflow-x-hidden",children:[c.jsxs("div",{className:"absolute inset-0 z-0",children:[c.jsx("img",{src:"/Simulation_StandAlone_Pro/makthjulet_landingpage_bakgrunn.png",alt:"Background",className:"w-full h-full object-cover"}),c.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-950 via-slate-950/60 to-transparent"}),c.jsx("div",{className:"absolute inset-0 bg-black/40"})]}),c.jsxs("div",{className:"relative z-10 flex flex-col min-h-screen",children:[c.jsxs("header",{className:"w-full px-8 py-8 flex justify-between items-center",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(bf,{className:"text-white/90",size:24,strokeWidth:1.5}),c.jsx("span",{className:"text-sm font-black tracking-[0.2em] text-white/90 uppercase",children:"Simuleringshallen"})]}),c.jsx("div",{className:"flex items-center gap-6 text-xs font-bold tracking-widest uppercase",children:t&&!e?c.jsxs("div",{className:"flex items-center gap-6",children:[c.jsxs("span",{className:"text-white/70",children:["Velkommen, ",c.jsx("span",{className:"text-white",children:t.displayName})]}),c.jsx("button",{onClick:()=>n(),className:"hover:text-amber-400 transition-colors",children:"Logg ut"})]}):c.jsxs("div",{className:"flex items-center gap-6",children:[c.jsx("button",{onClick:()=>m("LOGIN"),className:"hover:text-white transition-colors text-white/70",children:"Logg Inn"}),c.jsx("button",{onClick:()=>m("REGISTER"),className:"px-5 py-2 bg-white/10 hover:bg-white/20 backdrop-blur-sm border border-white/20 rounded-full transition-all text-white",children:"Bli Med"})]})})]}),c.jsxs("main",{className:"flex-1 flex flex-col items-center justify-center w-full max-w-7xl mx-auto px-6 py-12",children:[c.jsxs("div",{className:"text-center mb-16 space-y-6 max-w-3xl",children:[c.jsx("h1",{className:"text-7xl md:text-9xl font-black text-white tracking-tighter leading-none drop-shadow-2xl",children:"MAKTHJULET"}),c.jsx("p",{className:"text-lg md:text-xl text-white/80 font-light tracking-wide max-w-xl mx-auto leading-relaxed",children:"Skjebnen er ikke skrevet. Den smis i ilden av ambisjoner."})]}),c.jsxs("div",{className:"w-full max-w-4xl bg-black/40 backdrop-blur-xl border border-white/10 rounded-3xl p-8 shadow-2xl",children:[c.jsxs("div",{className:"mb-6 flex items-center justify-between border-b border-white/5 pb-4",children:[c.jsxs("h3",{className:"text-xs font-bold tracking-[0.2em] text-white/60 uppercase flex items-center gap-2",children:[c.jsx(yd,{size:12,className:"text-emerald-500"}),"Aktive Verdener"]}),c.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-white/40 uppercase tracking-widest",children:[c.jsx("span",{className:"w-2 h-2 rounded-full bg-emerald-500 animate-pulse"}),"Live Feed"]})]}),c.jsx("div",{className:"max-h-[400px] overflow-y-auto custom-scrollbar",children:c.jsx(fV,{})})]})]}),c.jsxs("footer",{className:"w-full p-8 relative flex justify-center text-[10px] uppercase tracking-[0.2em] text-white/30",children:[c.jsx("span",{children:" 2026 Eiriksbok  Maktens Pris"}),c.jsx("button",{onClick:()=>o("/host"),className:"absolute right-8 bottom-8 text-white/10 hover:text-white/50 transition-colors duration-500 font-bold",children:"Admin"})]})]}),c.jsx(hV,{isOpen:s,onClose:()=>i(!1),initialMode:r})]})},pV=()=>c.jsx(l2,{basename:"/Simulation_StandAlone_Pro/",children:c.jsx(u2,{children:c.jsx(H4,{children:c.jsx(V4,{children:c.jsx("div",{className:"min-h-screen bg-slate-950 text-white",children:c.jsxs(i2,{children:[c.jsx(To,{path:"/",element:c.jsx(mV,{})}),c.jsx(To,{path:"/host",element:c.jsx(C6,{})}),c.jsx(To,{path:"/play/:pin/*",element:c.jsx(F4,{children:c.jsx(dV,{})})}),c.jsx(To,{path:"*",element:c.jsx(n2,{to:"/",replace:!0})})]})})})})})});class gV extends Ee.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,n){console.error("Uncaught error:",e,n)}render(){return this.state.hasError?c.jsxs("div",{style:{padding:"2rem",backgroundColor:"#1a1a1a",color:"#ff5555",height:"100vh",fontFamily:"monospace"},children:[c.jsx("h1",{children:"Noe gikk galt (Kritisk Feil)"}),c.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:this.state.error&&this.state.error.toString()+`

`+this.state.error.stack})]}):this.props.children}}fC.createRoot(document.getElementById("root")).render(c.jsx(Ee.StrictMode,{children:c.jsx(gV,{children:c.jsx(pV,{})})}));export{rp as $,hc as A,ZE as B,Rn as C,xV as D,_V as E,EV as F,q as G,E3 as H,wV as I,Se as J,PA as K,bd as L,Ml as M,O0 as N,K3 as O,H3 as P,bf as Q,_r as R,Ad as S,iP as T,xf as U,Ut as V,uV as W,W3 as X,Dn as Y,mP as Z,va as _,hn as a,RS as a0,Ee as b,ae as c,J as d,Y4 as e,q4 as f,_ as g,K4 as h,C0 as i,c as j,vy as k,hp as l,De as m,_S as n,cp as o,j0 as p,S0 as q,D as r,L as s,dP as t,vf as u,B3 as v,Ei as w,z3 as x,bV as y,yV as z};
