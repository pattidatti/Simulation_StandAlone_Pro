const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DLzf93r1.js","assets/index-BY9mc2a4.css"])))=>i.map(i=>d[i]);
import{P as Z,h as V,G as j,a as b,Y as G,_ as H,c as B,r as ee,s as te,u as se,j as e,$ as ae,q as re,d as le,S as ie,w as z,a0 as q,a1 as J,a2 as ne,a3 as oe,o as ce}from"./index-DLzf93r1.js";import{B as de}from"./Badge-DSI_Uam3.js";/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}],["path",{d:"M3.103 6.034h17.794",key:"awc11p"}],["path",{d:"M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z",key:"o988cm"}]],me=Z("shopping-bag",xe),he=({player:s,market:C,onAction:m,onClose:R,viewingRegionId:v,pin:N})=>{const O=v&&v!==s.regionId,[l,U]=V.useState(null),[d,D]=V.useState("BUY"),[h,S]=V.useState(1),[f,o]=V.useState("CARAVAN"),[i,E]=V.useState(null),g=s.caravan||{level:1,inventory:{}},_=j.CARAVAN.LEVELS.find(t=>t.level===g.level)||j.CARAVAN.LEVELS[0],n=Object.values(g.inventory).reduce((t,a)=>t+(a||0),0),I=_.capacity,p=l?b[l]:null,w=p==null?void 0:p.isCommodity,k=l?C[l]:null,u=k&&h>0?G(k,h,d==="BUY"):0,P=k?H(k):0,L=d==="BUY"?P*h:P*j.MARKET.SELL_RATIO*h,$=Math.abs(u-L),F=$>.1;B.useEffect(()=>{if(!s.homeRegionId&&N){const t=ee(te,`simulation_rooms/${N}/players/${s.id}`);se(t,{homeRegionId:s.regionId}).catch(console.error)}},[s.homeRegionId,s.id,s.regionId,N]);const y=s.homeRegionId||s.regionId,r=(v||s.regionId)!==y;B.useEffect(()=>{if(l){if(r){f!=="CARAVAN"&&o("CARAVAN");return}const t=w?"CARAVAN":"BACKPACK";f!==t&&(o(t),E(t),setTimeout(()=>E(null),600))}},[l,w,r]);const K=()=>{if(l)if(d==="BUY"){if(s.resources.gold<u)return;m({type:"MARKET_BUY",resource:l,amount:h,target:f})}else m({type:"MARKET_SELL",resource:l,amount:h,source:f})},c=(t,a=1)=>{m({type:"LOAD_CARAVAN",resource:t,amount:a})},M=(t,a=1)=>{m({type:"UNLOAD_CARAVAN",resource:t,amount:a})},X=()=>{Object.entries(s.resources).forEach(([t,a])=>{var x;a&&a>0&&((x=b[t])!=null&&x.isCommodity)&&m({type:"LOAD_CARAVAN",resource:t,amount:a})})};return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-slate-950/90 backdrop-blur-md p-4 animate-in fade-in duration-300",children:e.jsxs("div",{className:"w-full max-w-7xl h-[85vh] bg-slate-900 border border-slate-700 rounded-[2rem] shadow-2xl overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"h-20 bg-slate-950 px-8 flex items-center justify-between border-b border-slate-800",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-amber-500/10 rounded-xl flex items-center justify-center text-2xl border border-amber-500/20",children:"âš–ï¸"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-black text-white uppercase italic tracking-tighter",children:"Handelskammeret"}),e.jsx("p",{className:"text-xs text-slate-500 font-bold uppercase tracking-widest",children:"Grossist-oversikt"})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"px-6 py-2 bg-slate-900 rounded-lg border border-slate-800",children:[e.jsx("span",{className:"text-slate-400 text-xs font-bold uppercase mr-2",children:"Din Formue:"}),e.jsxs("span",{className:"text-amber-400 font-black text-lg",children:[Number(s.resources.gold).toLocaleString("nb-NO",{maximumFractionDigits:2})," gull"]})]}),e.jsx("button",{onClick:R,className:"w-10 h-10 rounded-full bg-slate-800 text-slate-400 hover:bg-rose-500 hover:text-white transition-colors flex items-center justify-center",children:"âœ•"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/3 border-r border-slate-800 flex flex-col bg-slate-900/50",children:[e.jsx("div",{className:"p-6 border-b border-slate-800 bg-slate-950/20",children:e.jsx("h2",{className:"text-sm font-black text-slate-400 uppercase tracking-widest",children:"Markedstilbud"})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar space-y-2",children:Object.entries(C).map(([t,a])=>{const x=b[t];if(!x)return null;const A=l===t;return e.jsxs("button",{onClick:()=>{U(t),S(1)},className:`w-full p-4 rounded-xl border transition-all flex items-center justify-between group ${A?"bg-amber-500/10 border-amber-500/50 shadow-[0_0_20px_rgba(245,158,11,0.1)]":"bg-slate-800/30 border-slate-700/50 hover:bg-slate-800 hover:border-slate-600"}`,children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-3xl filter drop-shadow-lg",children:ae[t.toUpperCase()]||x.icon}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-white font-bold uppercase text-sm group-hover:text-amber-300 transition-colors",children:x.label}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[x.isCommodity&&e.jsx("span",{className:"text-[9px] bg-slate-800 text-slate-400 px-1.5 py-0.5 rounded border border-slate-700",children:"Vare"}),e.jsxs("span",{className:"text-[10px] text-slate-500",children:["Lager: ",a.stock]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`font-black text-xl transition-all duration-700 ease-[cubic-bezier(0.17,0.89,0.32,1.49)] ${(()=>{const T=H(a),Q=a.basePrice;if(!Q)return"text-amber-400";const W=T/Q;return W<.8?"text-[hsl(150,60%,55%)]":W>1.5?"text-[hsl(355,75%,60%)]":"text-amber-400"})()}`,children:[Number(H(a)).toLocaleString("nb-NO",{maximumFractionDigits:2}),"g"]}),e.jsx("div",{className:"text-[10px] text-emerald-500/50 font-bold uppercase tracking-wider",children:"pr. stk"})]})]},t)})})]}),e.jsxs("div",{className:"w-1/3 border-r border-slate-800 flex flex-col bg-slate-950 relative",children:[e.jsx("div",{className:"absolute inset-0 opacity-5 pointer-events-none flex items-center justify-center text-9xl",children:"âš–ï¸"}),l?e.jsx("div",{className:"flex-1 flex flex-col p-8 relative z-10",children:e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center space-y-8",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx(re.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},className:"text-8xl drop-shadow-[0_10px_30px_rgba(0,0,0,0.5)]",children:b[l].icon},l),e.jsx("h3",{className:"text-3xl font-black text-white italic uppercase",children:b[l].label}),w?e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 bg-amber-500/10 border border-amber-500/20 rounded-full text-amber-500 text-xs font-bold uppercase",children:[e.jsx("span",{children:"ðŸ“¦"})," Tung Handelsvare"]}):e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 bg-emerald-500/10 border border-emerald-500/20 rounded-full text-emerald-500 text-xs font-bold uppercase",children:[e.jsx("span",{children:"ðŸŽ’"})," Forbruksvare"]})]}),O?e.jsxs("div",{className:"flex-1 w-full flex flex-col items-center justify-center space-y-6 animate-in slide-in-from-bottom-4",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h4",{className:"text-amber-500 font-bold uppercase tracking-widest text-xs",children:"Dette markedet er langt unna"}),e.jsx("p",{className:"text-slate-400 text-sm max-w-[200px] mx-auto",children:"Du mÃ¥ reise hit med karavanen for Ã¥ handle varer."})]}),e.jsxs("button",{onClick:()=>m({type:"OPEN_CARAVAN",targetRegionId:v}),className:"w-full max-w-xs py-6 rounded-xl bg-indigo-600 hover:bg-indigo-500 text-white font-black uppercase tracking-[0.2em] shadow-2xl shadow-indigo-500/20 transition-all active:scale-95 flex flex-col items-center group",children:[e.jsx("span",{className:"text-2xl mb-1 group-hover:scale-110 transition-transform",children:"ðŸ´"}),"Reis Hit"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex bg-slate-900 p-1 rounded-xl border border-slate-800 w-full max-w-xs",children:["BUY","SELL"].map(t=>e.jsx("button",{onClick:()=>D(t),className:`flex-1 py-3 rounded-lg text-xs font-black uppercase tracking-widest transition-all ${d===t?t==="BUY"?"bg-emerald-600 text-white shadow-lg":"bg-rose-600 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:t==="BUY"?"KjÃ¸p":"Selg"},t))}),e.jsxs("div",{className:"w-full max-w-xs space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center px-1",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 tracking-widest",children:d==="BUY"?"Leveres til:":"Hentes fra:"}),r&&e.jsx("span",{className:"text-[9px] font-black text-amber-500 uppercase tracking-wide flex items-center gap-1 animate-pulse",children:"âš ï¸ Fremmed Marked"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>!r&&o("BACKPACK"),disabled:r,className:`p-3 rounded-xl border text-left transition-all relative overflow-hidden ${f==="BACKPACK"?"bg-slate-800 border-white/20 ring-2 ring-white/10":"bg-slate-900/50 border-slate-800 text-slate-600"} ${i==="BACKPACK"?"ring-4 ring-emerald-500/50 scale-[1.02]":""} 
                                                            ${r?"opacity-30 cursor-not-allowed grayscale":""}`,children:[e.jsx("div",{className:"text-xl mb-1",children:"ðŸŽ’"}),e.jsx("div",{className:"text-[10px] font-black uppercase",children:"Sekk"}),i==="BACKPACK"&&e.jsx("div",{className:"absolute inset-0 bg-emerald-500/20 animate-pulse"})]}),e.jsxs("button",{onClick:()=>o("CARAVAN"),className:`p-3 rounded-xl border text-left transition-all relative overflow-hidden ${f==="CARAVAN"?"bg-amber-900/40 border-amber-500/50 ring-2 ring-amber-500/20":"bg-slate-900/50 border-slate-800 text-slate-600"} ${i==="CARAVAN"?"ring-4 ring-amber-500/50 scale-[1.02]":""}`,children:[e.jsx("div",{className:"text-xl mb-1",children:"ðŸ›’"}),e.jsx("div",{className:"text-[10px] font-black uppercase text-amber-500",children:"Vogn"}),i==="CARAVAN"&&e.jsx("div",{className:"absolute inset-0 bg-amber-500/20 animate-pulse"})]})]}),r&&e.jsx("p",{className:"text-[9px] text-amber-500/80 text-center font-medium leading-tight px-2",children:"Handel fra ryggsekk er kun tillatt i din hjemregion."})]}),e.jsxs("div",{className:"w-full max-w-xs p-6 bg-slate-900 rounded-2xl border border-slate-800 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsx("span",{className:"text-xs font-bold text-slate-400",children:"Antall"}),e.jsx("input",{type:"number",value:h,onChange:t=>S(Math.max(1,parseInt(t.target.value)||1)),className:"w-20 bg-slate-950 border border-slate-700 rounded-lg py-1 px-2 text-right text-white font-bold"})]}),e.jsx("input",{type:"range",min:"1",max:"100",value:h,onChange:t=>S(parseInt(t.target.value)),className:"w-full accent-amber-500"}),e.jsxs("div",{className:"pt-4 border-t border-slate-800 flex justify-between items-center group relative",children:[e.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase",children:"Totalsum"}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("span",{className:`text-xl font-black transition-all duration-500 ease-[cubic-bezier(0.17,0.89,0.32,1.49)] ${s.resources.gold<u&&d==="BUY"?"text-rose-500":"text-white"}`,children:[Number(u).toLocaleString("nb-NO",{maximumFractionDigits:2}),"g"]}),F&&h>1&&e.jsxs("span",{className:"text-[9px] font-bold text-amber-500/60 animate-in fade-in slide-in-from-right-1 duration-500 uppercase tracking-tighter",children:["+",$.toFixed(1),"g glidning"]})]})]})]}),e.jsx("button",{onClick:K,disabled:d==="BUY"&&s.resources.gold<u,className:`w-full max-w-xs py-4 rounded-xl font-black uppercase tracking-[0.2em] shadow-2xl transition-all active:scale-95 ${d==="BUY"?s.resources.gold<u?"bg-slate-800 text-slate-600 cursor-not-allowed":"bg-emerald-500 text-slate-950 hover:bg-emerald-400":"bg-amber-500 text-slate-950 hover:bg-amber-400"}`,children:d==="BUY"?`Bekreft KjÃ¸p | ${u.toFixed(1)}g`:`Bekreft Salg | ${u.toFixed(1)}g`})]})]})}):e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-slate-600 space-y-4",children:[e.jsx("div",{className:"text-6xl opacity-20",children:"ðŸ›’"}),e.jsx("p",{className:"text-xs font-bold uppercase tracking-widest",children:"Velg en vare fra markedet"})]})]}),e.jsxs("div",{className:"w-1/3 flex flex-col bg-slate-900/50",children:[e.jsx("div",{className:"p-6 border-b border-slate-800 bg-slate-950/20",children:e.jsx("h2",{className:"text-sm font-black text-slate-400 uppercase tracking-widest",children:"Dine Lager"})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8 custom-scrollbar",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-xs font-black text-amber-500 uppercase flex items-center gap-2",children:["ðŸ›’ Karavane (Lvl ",g.level,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>m({type:"OPEN_CARAVAN"}),className:"text-[10px] bg-slate-800 hover:bg-slate-700 text-white px-2 py-1 rounded border border-slate-700 transition-colors uppercase font-bold",children:"Ã…pne"}),e.jsxs("span",{className:`text-[10px] font-bold px-2 py-1 rounded ${n>=I?"text-rose-400":"text-slate-500"}`,children:[n," / ",I]})]})]}),e.jsxs("div",{className:"bg-slate-950/50 rounded-xl border border-slate-800 p-2 min-h-[100px]",children:[Object.entries(g.inventory).length===0&&e.jsx("p",{className:"text-[10px] text-slate-700 font-bold uppercase text-center mt-8",children:"Tomt lasterom"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:Object.entries(g.inventory).map(([t,a])=>{var x,A;return a&&a>0&&b[t]?e.jsxs("div",{className:"relative group bg-slate-900 p-2 rounded-lg border border-slate-800 flex flex-col items-center gap-1 hover:border-slate-600 transition-colors",title:(x=b[t])==null?void 0:x.label,children:[e.jsx("span",{className:"text-lg",children:(A=b[t])==null?void 0:A.icon}),e.jsx("span",{className:"text-[10px] font-bold text-amber-400",children:a}),e.jsx("button",{onClick:T=>{T.stopPropagation(),!r&&M(t)},disabled:r,className:`absolute -top-1 -right-1 w-5 h-5 ${r?"bg-slate-800 text-slate-600 cursor-not-allowed":"bg-slate-700 text-white hover:bg-rose-500"} rounded-full flex items-center justify-center text-[10px] opacity-0 group-hover:opacity-100 transition-opacity shadow-lg z-10`,title:r?"Kun tillatt i hjemregion":"Last av (til ryggsekk)",children:"â¬‡ï¸"})]},t):null})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-xs font-black text-emerald-500 uppercase flex items-center gap-2",children:"ðŸŽ’ Ryggsekk"}),e.jsxs("button",{onClick:r?void 0:X,disabled:r,className:`text-[9px] font-bold uppercase tracking-wider px-2 py-1 rounded-lg transition-all flex items-center gap-1 ${r?"bg-slate-800 text-slate-600 border border-slate-700 cursor-not-allowed":"text-amber-500 bg-amber-500/10 border border-amber-500/20 hover:bg-amber-500 hover:text-slate-900"}`,title:r?"Kun tillatt i hjemregion":"Flytt alle handelsvarer til vognen",children:[e.jsx("span",{children:"ðŸ“¦"})," Last Alt"]})]}),e.jsx("div",{className:"bg-slate-950/50 rounded-xl border border-slate-800 p-2",children:e.jsx("div",{className:"grid grid-cols-4 gap-2",children:Object.entries(s.resources).map(([t,a])=>{var x,A;return a&&a>0&&t!=="gold"&&b[t]?e.jsxs("div",{className:"relative group bg-slate-900 p-2 rounded-lg border border-slate-800 flex flex-col items-center gap-1 hover:border-slate-600 transition-colors",title:(x=b[t])==null?void 0:x.label,children:[e.jsx("span",{className:"text-lg",children:(A=b[t])==null?void 0:A.icon}),e.jsx("span",{className:"text-[10px] font-bold text-slate-300",children:a}),e.jsx("button",{onClick:T=>{T.stopPropagation(),c(t)},className:"absolute -top-1 -right-1 w-5 h-5 bg-amber-500 text-slate-900 rounded-full flex items-center justify-center text-[10px] opacity-0 group-hover:opacity-100 transition-opacity shadow-lg z-10 hover:bg-amber-400",title:"Last pÃ¥ vogn",children:"â¬†ï¸"})]},t):null})})})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t border-slate-800 opacity-75 hover:opacity-100 transition-opacity",children:[e.jsx("h3",{className:"text-xs font-black text-indigo-400 uppercase flex items-center gap-2",children:"ðŸ—ºï¸ Vegvalg"}),e.jsx("div",{className:"space-y-2",children:["region_ost","region_vest","capital"].map(t=>{if(t===s.regionId)return null;const a=t==="capital"?"Hovedstaden":t==="region_vest"?"Vestfjella":"Ã˜stlandet";return e.jsxs("button",{onClick:()=>{m({type:"TRAVEL_START",targetRegionId:t}),R()},className:"w-full p-3 bg-indigo-900/10 hover:bg-indigo-900/30 border border-indigo-500/20 hover:border-indigo-400/50 rounded-xl flex items-center justify-between group transition-all",children:[e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{className:"text-[10px] text-indigo-300 font-bold uppercase tracking-wider",children:"Reis til"}),e.jsx("span",{className:"text-sm font-black text-white italic",children:a})]}),e.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-950 flex items-center justify-center text-indigo-400 group-hover:bg-indigo-500 group-hover:text-white transition-colors",children:"âž”"})]},t)})})]})]})]})]})]})})},be=B.memo(({player:s,market:C,regions:m,onAction:R,pin:v})=>{var h,S,f;const{actionLoading:N,setActiveTab:O,viewingRegionId:l}=le(),[U,d]=B.useState(!1);if(s.role==="MERCHANT")return e.jsx(he,{player:s,market:C||{},onAction:R,onClose:()=>O("MAP"),viewingRegionId:l||s.regionId,pin:v});const D=s.regionId==="capital"?"Hovedstaden":((h=m==null?void 0:m[s.regionId])==null?void 0:h.name)||s.regionId;return e.jsx(ie,{title:`Marked ${D}`,subtitle:"Handel & Handelsruter",icon:e.jsx(me,{className:"w-8 h-8"}),onClose:()=>O("MAP"),headerRight:e.jsxs("div",{className:"flex items-center gap-3 bg-black/40 px-5 py-2 rounded-xl border border-game-gold/30 shadow-inner mr-4",children:[e.jsx("span",{className:"text-xs font-black text-game-stone_light uppercase tracking-wider",children:"Saldo:"}),e.jsx(ce,{resource:"gold",amount:(S=s.resources)==null?void 0:S.gold,size:"sm"})]}),maxWidth:"max-w-7xl",children:e.jsxs("div",{className:"space-y-3",children:[s.role==="PEASANT"&&e.jsxs("div",{className:"bg-gradient-to-r from-emerald-950/40 via-blue-950/40 to-indigo-950/40 border border-emerald-500/20 rounded-xl p-2.5 flex items-center justify-between gap-6 relative overflow-hidden group shadow-lg",children:[e.jsxs("div",{className:"relative z-10 flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-emerald-900/60 rounded-lg flex items-center justify-center border border-emerald-500/30",children:e.jsx("span",{className:"text-xl",children:"ðŸ“œ"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-black text-white uppercase tracking-tight leading-none mb-1",children:"Handelslisens"}),e.jsx("p",{className:"text-emerald-100/60 text-[9px] font-medium uppercase tracking-widest",children:"Nasjonale handelsruter"})]})]}),e.jsxs("div",{className:"relative z-10 flex items-center gap-4",children:[e.jsxs(de,{variant:"outline",className:"text-emerald-400 border-emerald-500/20 bg-emerald-500/5 px-2 py-0.5 text-[9px]",children:["Lvl ",j.CAREERS.MERCHANT.LEVEL_REQ," + ",j.CAREERS.MERCHANT.COST,"g"]}),e.jsx(z,{variant:"primary",onClick:()=>d(!0),disabled:((f=s.resources)==null?void 0:f.gold)<j.CAREERS.MERCHANT.COST||(s.stats.level||1)<j.CAREERS.MERCHANT.LEVEL_REQ||!!N,className:"bg-emerald-600 hover:bg-emerald-500 border-emerald-400/50 px-4 h-8 text-[9px]",children:"AKTIVER"})]})]}),e.jsx("div",{className:"bg-black/20 border border-white/10 rounded-2xl overflow-x-auto backdrop-blur-md shadow-2xl",children:e.jsxs("div",{className:"min-w-[800px]",children:[" ",e.jsxs("div",{className:"grid grid-cols-12 gap-1 px-6 py-3 border-b border-white/10 bg-white/[0.03]",children:[e.jsx("div",{className:"col-span-3 text-xs font-black text-game-stone_light uppercase tracking-[0.2em]",children:"Ressurs"}),e.jsx("div",{className:"col-span-1 text-xs font-black text-game-stone_light uppercase tracking-[0.2em] text-center",children:"Pris"}),e.jsx("div",{className:"col-span-1 text-xs font-black text-game-stone_light uppercase tracking-[0.2em] text-center",children:"Lager"}),e.jsx("div",{className:"col-span-1 text-xs font-black text-game-stone_light uppercase tracking-[0.2em] text-center",children:"Eier"}),e.jsx("div",{className:"col-span-6 text-xs font-black text-game-stone_light uppercase tracking-[0.2em] text-right pr-4",children:"Kontroller"})]}),e.jsx("div",{className:"divide-y divide-white/10",children:Array.from(new Set([...Object.keys(q),...Object.keys(C||{})])).filter(o=>!["iron","swords","armor"].includes(o)).map(o=>{var Y,r,K;const i=(C||{})[o]||q[o],E=b[o];if(!i||!E)return null;const g=i.stock||0,_=((Y=s.resources)==null?void 0:Y[o])||0,[n,I]=B.useState(1),p=H(i),w=G(i,n,!0),k=G(i,n,!1),u=w>p*n*1.15,P=k<p*j.MARKET.SELL_RATIO*n*.85;let L="text-game-gold";i.basePrice&&(p<i.basePrice*.8&&(L="text-[hsl(150,60%,55%)]"),p>i.basePrice*1.5&&(L="text-[hsl(355,75%,60%)]"));const $=Math.min(g,Math.floor((((r=s.resources)==null?void 0:r.gold)||0)/p)),F=_,y=c=>{I(Math.max(1,isNaN(c)?1:c))};return e.jsxs("div",{className:"grid grid-cols-12 gap-1 px-6 py-2 items-center group hover:bg-white/[0.02] transition-colors relative",children:[e.jsxs("div",{className:"col-span-3 flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 bg-black/40 rounded-xl flex items-center justify-center text-4xl shadow-inner border border-white/5 group-hover:scale-105 transition-transform duration-500",children:E.icon}),e.jsx("div",{className:"overflow-hidden",children:e.jsx("h4",{className:"text-white font-black uppercase text-2xl truncate tracking-tight leading-none group-hover:text-game-gold transition-colors",children:E.label})})]}),e.jsx("div",{className:"col-span-1 flex flex-col items-center",children:e.jsxs("div",{className:`text-xl font-black tabular-nums tracking-tight transition-all duration-700 ease-[cubic-bezier(0.17,0.89,0.32,1.49)] ${L}`,children:[p.toFixed(1),"g"]})}),e.jsxs("div",{className:"col-span-1 flex flex-col items-center relative group",children:[e.jsx("span",{className:`text-xl font-black tabular-nums tracking-tighter z-10 ${g>0?"text-white":"text-rose-500/50"}`,children:g.toLocaleString()}),i.baseStock&&e.jsx("div",{className:"absolute inset-x-2 bottom-0 h-1 bg-white/5 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-game-gold/30 transition-all duration-700",style:{width:`${Math.min(100,g/i.baseStock*100)}%`}})})]}),e.jsx("div",{className:"col-span-1 flex flex-col items-center",children:e.jsx("span",{className:`text-xl font-black tabular-nums tracking-tighter ${_>0?"text-white border-b border-game-gold/50":"text-white/40"}`,children:_.toLocaleString()})}),e.jsxs("div",{className:"col-span-6 flex items-center justify-end gap-3 p-1 pl-4 bg-black/20 rounded-xl border border-white/5 group-hover:border-white/10 transition-colors h-14",children:[e.jsxs("div",{className:"flex items-center bg-white/5 backdrop-blur-sm border border-white/10 rounded-lg px-2 py-1",children:[e.jsx("button",{onClick:()=>y(n-1),className:"w-8 h-8 flex items-center justify-center text-white/30 hover:text-white hover:bg-white/10 rounded font-bold transition-colors",type:"button",children:"âˆ’"}),e.jsx("input",{type:"number",value:n,onChange:c=>y(parseInt(c.target.value)),className:"w-16 bg-transparent text-center font-black text-game-gold border-none outline-none focus:ring-0 tabular-nums text-base p-0"}),e.jsx("button",{onClick:()=>y(n+1),className:"w-8 h-8 flex items-center justify-center text-white/30 hover:text-white hover:bg-white/10 rounded font-bold transition-colors",type:"button",children:"+"})]}),e.jsxs("div",{className:"flex gap-1.5",children:[e.jsx("button",{onClick:()=>y(n+10),className:"px-3 h-8 text-xs font-black bg-white/5 border border-white/10 rounded uppercase hover:bg-white/15 transition-colors whitespace-nowrap",type:"button",children:"+10"}),e.jsx("button",{onClick:()=>y(Math.max($,F,1)),className:"px-3 h-8 text-xs font-black bg-game-gold/10 border border-game-gold/30 text-game-gold rounded uppercase hover:bg-game-gold/30 transition-colors whitespace-nowrap",type:"button",children:"Max"})]}),e.jsx("div",{className:"w-px h-5 bg-white/10 mx-0.5"}),e.jsxs("div",{className:"flex gap-2 flex-1 max-w-[200px]",children:[e.jsxs(z,{variant:"primary",onClick:()=>{J(async()=>{const{audioManager:c}=await import("./index-DLzf93r1.js").then(M=>M.am);return{audioManager:c}},__vite__mapDeps([0,1])).then(({audioManager:c})=>c.playSfx("coin")),R({type:"BUY",resource:o,amount:n})},disabled:(((K=s.resources)==null?void 0:K.gold)||0)<w||g<n||!!N,className:`flex-1 py-0 h-10 font-black text-[11px] whitespace-nowrap tracking-tight transition-all duration-300 ${u?"ring-2 ring-amber-500/50 shadow-[0_0_15px_rgba(245,158,11,0.4)]":""}`,children:["KJÃ˜P | ",w.toFixed(1),"g"]}),e.jsxs(z,{variant:"wood",onClick:()=>{J(async()=>{const{audioManager:c}=await import("./index-DLzf93r1.js").then(M=>M.am);return{audioManager:c}},__vite__mapDeps([0,1])).then(({audioManager:c})=>c.playSfx("coin")),R({type:"SELL",resource:o,amount:n})},disabled:_<n||!!N,className:`flex-1 py-0 h-10 font-black text-[11px] whitespace-nowrap tracking-tight transition-all duration-300 ${P?"ring-2 ring-amber-500/50 shadow-[0_0_15px_rgba(245,158,11,0.4)]":""}`,children:["SELG | ",k.toFixed(1),"g"]})]})]})]},o)})})]})}),e.jsx(ne,{isOpen:U,onClose:()=>d(!1),onConfirm:()=>{oe(v,s.id,"MERCHANT"),d(!1)},roleId:"MERCHANT",cost:`${j.CAREERS.MERCHANT.COST}g`})]})})});be.displayName="SimulationMarket";export{be as SimulationMarket};
