import{c as q,j as e,m as T,J as k,l as $,P,K as F,b as X,u as U,g as C,S as Y,w as z,p as K}from"./index-ESuys20i.js";import{T as Q}from"./timer-DDCYOrv2.js";/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],V=q("box",W),S=({item:a,resource:c,isEmpty:n,isEquipped:o,onClick:i,onMouseEnter:l,onMouseLeave:r,onMouseMove:p,slotType:d,isDraggable:g,onDragStart:N,onDragEnd:w,layoutId:E})=>{const t=()=>{if(a){let s=a;if(typeof a=="string")s=k[a]||{id:a,name:a,icon:"ðŸ“¦"};else if(a&&!s.icon&&s.id){const h=s.id.split("_")[0],A=k[h];A&&(s={...A,...a})}return e.jsxs("div",{className:"relative w-full h-full flex items-center justify-center group/item overflow-visible",children:[e.jsx("span",{className:"text-5xl filter drop-shadow-2xl group-hover/item:scale-110 group-hover/item:rotate-3 transition-transform duration-500",children:s.icon||"ðŸ“¦"}),s.durability<s.maxDurability&&e.jsx("div",{className:"absolute bottom-1 left-3 right-3 h-1 bg-black/60 rounded-full overflow-hidden border border-white/10",children:e.jsx("div",{className:`h-full transition-all duration-1000 ${s.durability/s.maxDurability<.2?"bg-red-500 shadow-[0_0_8px_rgba(239,68,68,0.5)]":s.durability/s.maxDurability<.5?"bg-yellow-500":"bg-indigo-400"}`,style:{width:`${s.durability/s.maxDurability*100}%`}})}),s.level>1&&e.jsxs("div",{className:"absolute top-1 right-2 px-1.5 py-0.5 bg-black/60 backdrop-blur-md rounded-md border border-white/10 text-[8px] font-black text-indigo-300 uppercase tracking-tighter",children:["Lvl ",s.level]})]})}if(c)return e.jsxs("div",{className:"relative w-full h-full flex flex-col items-center justify-center p-1 group/res",children:[e.jsx("div",{className:"group-hover/res:scale-110 group-hover/res:-rotate-3 transition-transform duration-500",children:e.jsx($,{resource:c.id,size:"lg"})}),e.jsx("span",{className:"absolute bottom-1 right-2 text-2xl font-black text-white drop-shadow-[0_4px_8px_rgba(0,0,0,1)] shadow-black",children:c.amount})]});if(d){const s=()=>{switch(d){case"HEAD":return"ðŸ‘¤";case"BODY":return"ðŸ‘•";case"FEET":return"ðŸ‘Ÿ";case"MAIN_HAND":return"âš”ï¸";case"OFF_HAND":return"ðŸ›¡ï¸";case"AXE":return"ðŸª“";case"PICKAXE":return"â›ï¸";case"SCYTHE":return"ðŸŒ¾";case"HAMMER":return"ðŸ”¨";case"CHISEL":return"ðŸ”¨";default:return null}};return e.jsxs("div",{className:"opacity-15 flex flex-col items-center justify-center grayscale group-hover:grayscale-0 group-hover:opacity-30 transition-all duration-700",children:[e.jsx("span",{className:"text-4xl mb-1",children:s()}),e.jsx("span",{className:"text-[8px] font-black uppercase tracking-widest text-white/60",children:d.replace("_"," ")})]})}return e.jsx("div",{className:"opacity-5 flex items-center justify-center",children:e.jsx(P,{className:"w-8 h-8 text-white"})})};return e.jsxs(T.button,{layoutId:E,drag:!!(g&&t()),dragSnapToOrigin:!0,onDragStart:N,onDragEnd:w,whileHover:{scale:1.05,zIndex:50},whileDrag:{scale:1.2,zIndex:100,pointerEvents:"none",boxShadow:"0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1)"},onClick:i,onMouseEnter:l,onMouseLeave:r,onMouseMove:p,className:`
                relative aspect-square w-full rounded-2xl border-2 transition-all duration-300
                ${n||!t()?"bg-white/5 border-white/5 border-dashed":"bg-white/10 border-white/10 hover:bg-slate-800/80 hover:border-indigo-500/30"}
                ${o?"ring-2 ring-indigo-500 border-indigo-500/50 bg-indigo-500/20 shadow-[0_0_20px_rgba(79,70,229,0.2)]":""}
                group overflow-hidden cursor-grab active:cursor-grabbing will-change-transform
            `,children:[t(),(a||c)&&e.jsx("div",{className:"absolute inset-0 bg-indigo-500/5 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none"})]})},G=({player:a,onSlotClick:c,onSlotHover:n,onSlotLeave:o,onDragStart:i,onDragEnd:l})=>{const r=Object.entries(a.resources||{}).filter(([t,s])=>s>0&&t!=="manpower"&&t!=="tools").map(([t,s])=>({type:"resource",data:{id:t,amount:s}})),d=((Array.isArray(a.inventory)?a.inventory:Object.values(a.inventory||{}))||[]).filter(t=>!(!t||typeof t=="object"&&Object.keys(t).length===0)).map(t=>{let s=t;if(typeof t=="string")s=k[t]||{id:t,name:t,icon:"ðŸ“¦"};else if(t&&typeof t=="object"&&t.id){const h=t.id.split("_")[0],A=k[h];A&&(s={...A,...t,icon:t.icon||A.icon||"ðŸ“¦"})}return{type:"equipment",data:s}}),g=[...r,...d],N=25,w=[...g];for(;w.length<N;)w.push(null);const E={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.03,delayChildren:.1}}};return e.jsx(T.div,{className:"grid grid-cols-5 gap-5",variants:E,initial:"hidden",animate:"visible","data-inventory-grid":!0,children:w.map((t,s)=>t?t.type==="resource"?e.jsx(S,{resource:t.data,onClick:()=>c(s,t),onMouseEnter:h=>n(h,t),onMouseLeave:o},`inv-${s}`):e.jsx(S,{item:t.data,layoutId:t.data.id,isDraggable:!0,onDragStart:()=>i==null?void 0:i(t),onDragEnd:(h,A)=>l==null?void 0:l(h,t,A),onClick:()=>c(s,t),onMouseEnter:h=>n(h,t),onMouseLeave:o,onMouseMove:h=>n(h,t)},`inv-${s}`):e.jsx(S,{},`empty-${s}`))})},Z=({content:a,position:c})=>{if(!a)return null;const{type:n,data:o}=a,i=n==="resource",l=o!=null&&o.id?k[o.id]:null,r={...o,name:o.name||(l==null?void 0:l.name)||o.id,icon:o.icon||(l==null?void 0:l.icon)||"ðŸ“¦",description:o.description||(l==null?void 0:l.description)||(i?"En verdifull ressurs brukt til hÃ¥ndverk og handel.":""),type:o.type||(l==null?void 0:l.type)||(i?"RESOURCE":"ITEM"),stats:o.stats||(l==null?void 0:l.stats),durability:o.durability,maxDurability:o.maxDurability||(l==null?void 0:l.maxDurability)};return F.createPortal(e.jsx("div",{className:"fixed z-[9999] pointer-events-none transition-transform duration-75 ease-out",style:{left:c.x+15,top:c.y+15,transform:"translate3d(0, 0, 0)"},children:e.jsxs("div",{className:"bg-slate-950/95 backdrop-blur-xl border border-white/20 rounded-2xl p-5 shadow-[0_20px_50px_rgba(0,0,0,0.5)] min-w-[240px] animate-in fade-in zoom-in-95 duration-150",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-white/5 border border-white/10 flex items-center justify-center text-3xl",children:r.icon}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-bold text-white leading-tight",children:r.name}),e.jsx("span",{className:"text-xs font-black uppercase text-indigo-400 tracking-[0.2em]",children:r.type==="CONSUMABLE"?"Matvare":i?"Ressurs":"Gjenstand"})]})]}),r.description&&e.jsx("p",{className:"text-xs text-slate-300 leading-relaxed italic mb-4 opacity-80",children:r.description}),!i&&r.stats&&e.jsxs("div",{className:"space-y-2 border-t border-white/10 pt-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(V,{className:"w-3 h-3 text-slate-500"}),e.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest",children:"Egenskaper"})]}),Object.entries(r.stats).map(([p,d])=>e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsx("span",{className:"text-slate-400 capitalize",children:p.replace("Bonus","")}),e.jsx("span",{className:"text-emerald-400 font-mono font-bold",children:typeof d=="number"&&d>1?`x${d}`:typeof d=="number"&&d<1?`+${Math.round(d*100)}%`:`+${d}`})]},p))]}),!i&&r.durability!==void 0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center text-xs font-bold uppercase tracking-widest text-slate-500",children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(Q,{className:"w-3 h-3"})," Holdbarhet"]}),e.jsxs("span",{children:[r.durability," / ",r.maxDurability]})]}),e.jsx("div",{className:"h-1.5 w-full bg-black/40 rounded-full overflow-hidden p-[1px]",children:e.jsx("div",{className:`h-full rounded-full transition-all ${r.durability/r.maxDurability<.2?"bg-red-500":r.durability/r.maxDurability<.5?"bg-yellow-500":"bg-emerald-500"}`,style:{width:`${r.durability/r.maxDurability*100}%`}})})]}),i&&e.jsx("div",{className:"mt-2 p-3 rounded-xl bg-indigo-500/10 border border-indigo-500/20",children:e.jsxs("p",{className:"text-xs text-indigo-300 font-bold uppercase tracking-widest",children:["Beholdning: ",e.jsx("span",{className:"text-white ml-2",children:o.amount})]})}),r.type==="CONSUMABLE"&&e.jsx("div",{className:"mt-4 text-center",children:e.jsx("span",{className:"inline-block text-[10px] font-black uppercase tracking-widest text-emerald-400 bg-emerald-500/10 px-3 py-1.5 rounded-full border border-emerald-500/20 animate-pulse shadow-lg shadow-emerald-500/10",children:"Trykk for Ã¥ spise"})})]})}),document.body)},v={HEAD:"Hode",BODY:"Kropp",FEET:"FÃ¸tter",MAIN_HAND:"HovedhÃ¥nd",OFF_HAND:"SidehÃ¥nd",TRINKET:"TilbehÃ¸r",AXE:"Ã˜ks",PICKAXE:"Hakke",SCYTHE:"Ljom / Sigd",HAMMER:"Smedhammer",BOW:"Bue",TRAP:"Felle",CHISEL:"Meisel"},J=X.memo(({player:a,onAction:c})=>{const{setActiveTab:n}=U(),[o,i]=C.useState(null),[l,r]=C.useState({x:0,y:0}),[p,d]=C.useState(null),g=(b,u)=>{if(u){if(u.type==="resource"){const x=u.data.id,I=k[x];if(I&&I.type==="CONSUMABLE"){c({type:"CONSUME",itemId:x,isResource:!0});return}}if(u.type==="equipment"){const x=u.data;if(x&&x.type==="CONSUMABLE"){c({type:"CONSUME",itemId:x.id});return}u.slot?c({type:"UNEQUIP_ITEM",slot:u.slot}):x&&x.type&&c({type:"EQUIP_ITEM",itemId:x.id,slot:x.type})}}},N=(b,u)=>{if(!u){i(null);return}i(u),r({x:b.clientX,y:b.clientY})},w=()=>{i(null)},E=(b,u)=>{u&&r({x:b.clientX,y:b.clientY})},t=b=>{d(b),i(null)},s=(b,u,x)=>{var O,R;const I=((O=x==null?void 0:x.point)==null?void 0:O.x)??b.clientX,B=((R=x==null?void 0:x.point)==null?void 0:R.y)??b.clientY,D=document.elementsFromPoint(I,B);let H=null;for(const M of D){const j=M.closest("[data-equipment-slot]");if(j){H=j;break}}if(H){const M=H.getAttribute("data-equipment-slot");if(M&&u.type==="equipment"){const j=u.data;["AXE","PICKAXE","SCYTHE","HAMMER","BOW","TRAP","CHISEL"].includes(j.type)&&M==="MAIN_HAND"?c({type:"EQUIP_ITEM",itemId:j.id,slot:j.type}):(j.type===M||M==="MAIN_HAND"&&j.relevantActions)&&c({type:"EQUIP_ITEM",itemId:j.id,slot:M})}}else D.some(j=>j.closest("[data-inventory-grid]")||j.closest(".inventory-container"))&&u.type==="equipment"&&u.slot&&c({type:"UNEQUIP_ITEM",slot:u.slot});d(null)},h=Array.isArray(a.inventory)?a.inventory:Object.values(a.inventory||{}),A=Object.values(a.resources||{}).filter(b=>b>0).length,L=h.length+A,m=a.equipment||{},_=!!(p!=null&&p.slot),f={onClick:b=>g(-1,b),onMouseEnter:N,onMouseLeave:w,onMouseMove:E,onDragStart:t,onDragEnd:s,draggedItem:p};return e.jsx(Y,{title:"Eiendeler & Utrustning",icon:e.jsx(P,{className:"w-8 h-8"}),onClose:()=>n("MAP"),headerRight:e.jsxs("div",{className:"text-slate-500 text-xs font-bold uppercase tracking-widest bg-white/5 px-4 py-2 rounded-full border border-white/5",children:[L," / 25 plasser brukt"]}),children:e.jsxs("div",{className:"space-y-4 relative min-h-[600px] pt-4",children:[e.jsx(Z,{content:o,position:l}),e.jsx(z,{children:p&&e.jsx("div",{className:"fixed inset-0 pointer-events-none z-[100] bg-indigo-500/5 animate-pulse"})}),e.jsxs("div",{className:`flex flex-col xl:flex-row gap-6 items-start relative ${p?"z-[100]":"z-10"}`,children:[e.jsx("div",{className:`flex-1 w-full xl:w-[500px] shrink-0 ${_?"z-50 relative":"z-10"}`,children:e.jsxs("div",{className:"bg-slate-900/80 backdrop-blur-xl border border-white/5 group/ragdoll h-[600px] flex items-center justify-center p-0 rounded-[2rem] shadow-2xl relative will-change-transform",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none rounded-[2rem]",children:[e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[400px] h-[400px] bg-indigo-500/10 blur-[100px] rounded-full opacity-50"}),e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_center,rgba(255,255,255,0.03)_0%,transparent_80%)]"}),e.jsx("div",{className:"absolute inset-0 opacity-[0.03]",style:{backgroundImage:"radial-gradient(circle, #4f46e5 1px, transparent 1px)",backgroundSize:"32px 32px"}})]}),e.jsxs("div",{className:"relative w-full h-full flex items-center justify-center max-w-5xl scale-90",children:[e.jsx("svg",{className:"absolute inset-0 w-full h-full pointer-events-none z-10 overflow-visible",children:e.jsxs("g",{className:"opacity-20 stroke-indigo-400/30 fill-none",strokeWidth:"1.5",strokeDasharray:"4 4",children:[e.jsx("path",{d:"M 350,120 Q 350,80 350,45"}),e.jsx("path",{d:"M 180,300 Q 250,300 300,300"}),e.jsx("path",{d:"M 520,300 Q 450,300 400,300"}),e.jsx("path",{d:"M 180,550 Q 250,550 320,500"}),e.jsx("path",{d:"M 520,550 Q 450,550 380,500"})]})}),e.jsx("div",{className:"relative z-10 w-[450px] h-[650px] opacity-[0.2] pointer-events-none select-none",children:e.jsxs("svg",{viewBox:"0 0 200 500",className:"w-full h-full text-indigo-300 fill-current filter blur-[1px]",children:[e.jsx("path",{d:"M100,15 c20,0,30,12,30,35 s-10,35-30,35 s-30-12-30-35 s10-35,30-35"}),e.jsx("path",{d:"M85,85 h30 l15,10 c15,10,35,15,45,25 s15,40,15,60 v120 c0,15-10,25-25,25 h-10 v140 c0,20-12,30-30,30 h-5 c-15,0-20-10-20-20 v-150 h-10 v150 c0,10-5,20-20,20 h-5 c-18,0-30-10-30-30 v-140 h-10 c-15,0-25-10-25-25 v-120 c0-20,5-50,15-60 s30-15,45-25 Z"})]})}),e.jsx("div",{className:"absolute top-10 left-10 z-30 opacity-10 group-hover/ragdoll:opacity-30 transition-all duration-1000",children:e.jsx(K,{className:"w-24 h-24 text-indigo-400 rotate-[-12deg]"})}),e.jsx("div",{className:"absolute inset-0 z-20 flex items-center justify-center",children:e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("div",{className:"absolute top-[6%] left-1/2 -translate-x-1/2 w-24",children:e.jsx(y,{slot:"HEAD",label:v.HEAD,item:m.HEAD,...f})}),e.jsx("div",{className:"absolute top-[35%] left-1/2 -translate-x-1/2 w-24",children:e.jsx(y,{slot:"BODY",label:v.BODY,item:m.BODY,...f})}),e.jsx("div",{className:"absolute bottom-[8%] left-1/2 -translate-x-1/2 w-24",children:e.jsx(y,{slot:"FEET",label:v.FEET,item:m.FEET,...f})}),e.jsx("div",{className:"absolute top-[35%] left-[6%] w-24",children:e.jsx(y,{slot:"MAIN_HAND",label:v.MAIN_HAND,item:m.MAIN_HAND,...f})}),e.jsx("div",{className:"absolute top-[35%] right-[6%] w-24",children:e.jsx(y,{slot:"OFF_HAND",label:v.OFF_HAND,item:m.OFF_HAND,...f})}),e.jsxs("div",{className:"absolute bottom-[2%] left-[2%] flex flex-col gap-8",children:[e.jsx("div",{className:"w-20 -rotate-6",children:e.jsx(y,{slot:"AXE",label:v.AXE,item:m.AXE,compact:!0,...f})}),e.jsx("div",{className:"w-20 -rotate-3 ml-6",children:e.jsx(y,{slot:"PICKAXE",label:v.PICKAXE,item:m.PICKAXE,compact:!0,...f})}),e.jsx("div",{className:"w-20 -rotate-1 ml-12",children:e.jsx(y,{slot:"CHISEL",label:v.CHISEL,item:m.CHISEL,compact:!0,...f})})]}),e.jsxs("div",{className:"absolute bottom-[2%] right-[2%] flex flex-col gap-8 items-end",children:[e.jsx("div",{className:"w-20 rotate-6",children:e.jsx(y,{slot:"SCYTHE",label:v.SCYTHE,item:m.SCYTHE,compact:!0,...f})}),e.jsx("div",{className:"w-20 rotate-3 mr-6",children:e.jsx(y,{slot:"HAMMER",label:v.HAMMER,item:m.HAMMER,compact:!0,...f})})]}),e.jsx("div",{className:"absolute top-[20%] left-[8%] w-20",children:e.jsx(y,{slot:"BOW",label:v.BOW,item:m.BOW,compact:!0,...f})}),e.jsx("div",{className:"absolute top-[20%] right-[8%] w-20",children:e.jsx(y,{slot:"TRAP",label:v.TRAP,item:m.TRAP,compact:!0,...f})}),e.jsx("div",{className:"absolute top-[12%] right-[16%] w-16",children:e.jsx(y,{slot:"TRINKET",label:v.TRINKET,item:m.TRINKET,compact:!0,...f})})]})})]})]})}),e.jsx("div",{className:`flex-1 w-full space-y-6 ${p&&!_?"z-50 relative":"z-10"}`,children:e.jsx("div",{className:"bg-slate-950/70 p-6 rounded-[2rem] border border-white/5 backdrop-blur-xl shadow-2xl min-h-[600px] inventory-container",children:e.jsx(G,{player:a,onSlotClick:g,onSlotHover:N,onSlotLeave:w,onDragStart:t,onDragEnd:s})})})]})]})})}),y=({slot:a,label:c,item:n,compact:o,draggedItem:i,onClick:l,onMouseEnter:r,onMouseLeave:p,onMouseMove:d,onDragStart:g,onDragEnd:N})=>{var t;const w=["AXE","PICKAXE","SCYTHE","HAMMER","BOW","TRAP","CHISEL"].includes((t=i==null?void 0:i.data)==null?void 0:t.type),E=(i==null?void 0:i.type)==="equipment"&&(i.data.type===a||a==="MAIN_HAND"&&i.data.relevantActions&&!w);return e.jsxs(T.div,{className:`flex flex-col items-center gap-1 group/rslot ${o?"scale-90":""}`,"data-equipment-slot":a,animate:{scale:E?1.1:1},children:[e.jsxs("div",{className:`${o?"w-16 h-16":"w-24 h-24"} relative`,children:[e.jsx(z,{children:(E||!!n)&&e.jsx(T.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:`absolute -inset-4 rounded-full blur-2xl z-0 transition-colors
                                ${E?"bg-indigo-500/30 animate-pulse":"bg-indigo-500/10"}
                            `})}),e.jsx("div",{className:"relative z-10 w-full h-full group-hover/rslot:scale-105 transition-transform duration-500 will-change-transform",children:e.jsx(S,{slotType:a,item:n,isEquipped:!!n,onClick:()=>l({type:"equipment",data:n,slot:a}),onMouseEnter:s=>r(s,n?{type:"equipment",data:n,slot:a}:null),onMouseLeave:p,onMouseMove:s=>d(s,n?{type:"equipment",data:n,slot:a}:null),isDraggable:!!n,onDragStart:()=>g==null?void 0:g({type:"equipment",data:n,slot:a}),onDragEnd:(s,h)=>N==null?void 0:N(s,{type:"equipment",data:n,slot:a},h),layoutId:(n==null?void 0:n.id)||`ragdoll-${a}`})})]}),e.jsx("div",{className:"min-h-[1.75rem] flex items-center justify-center pointer-events-none z-20",children:e.jsx("span",{className:`text-xs font-black uppercase tracking-[0.15em] whitespace-nowrap px-4 py-1.5 rounded-full border shadow-xl backdrop-blur-md transition-all duration-500
                    ${E?"text-indigo-100 bg-indigo-600 border-indigo-400 scale-105 shadow-indigo-500/50":n?"text-slate-200 bg-slate-900/90 border-white/20":"text-slate-300 bg-black/60 border-white/10"}
                `,children:c})})]})};J.displayName="SimulationVault";export{J as SimulationVault};
